/*!
 * 
 *          iclient-plot-leaflet.(https://iclient.supermap.io)
 *          Copyright© 2000 - 2022 SuperMap Software Co.Ltd
 *          version: v10.2.0
 *         
 */!function(t){var e={};function o(i){if(e[i])return e[i].exports;var l=e[i]={i:i,l:!1,exports:{}};return t[i].call(l.exports,l,l.exports,o),l.l=!0,l.exports}o.m=t,o.c=e,o.d=function(t,e,i){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var l in t)o.d(i,l,function(e){return t[e]}.bind(null,l));return i},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=185)}([function(t,e,o){"use strict";o(0),L.supermap.plotting=L.supermap.plotting||{}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GraphicObject=void 0,o(0);var i=o(5),l=o(2),n=o(11),a=e.GraphicObject=i.PlottingObject.extend({surroundLineType:null,scaleByMap:null,latLngs:[],initialize:function(t,e,o,l){this.geoSymbolTexts=[],this.subAssociatedUuids=[],this.latLngs=o||[],i.PlottingObject.prototype.initialize.call(this,t,e,o,l),null===this.surroundLineType&&(this.surroundLineType=SuperMap.Plot.AlgoSurroundLineType.NONE)},destroy:function(){i.PlottingObject.prototype.destroy.call(this),this.surroundLineType=null,this.scaleByMap=null,this.latLngs=[]},setLatLngs:function(t){return this.latLngs=t,this.redraw()},getLatLngs:function(){return this.latLngs},addLatLng:function(t){if(this.latLngs[this.latLngs.length-1].lat!==t.lat||this.latLngs[this.latLngs.length-1].lng!==t.lng)return this.latLngs.push(t),this.redraw()},setScaleByMap:function(t){this.scaleByMap=t},getScaleByMap:function(){return this.scaleByMap},getSurroundLineType:function(){return this.surroundLineType},setSurroundLineType:function(){},_resizeLatLngs:function(t,e,o,i){if(this.symbolType!==SuperMap.Plot.SymbolType.SATELLITETIMEWINDOWS){var l=this._resizeBounds(t,e,o);if(!(SuperMap.Plot.PlottingUtil.equalFuzzy(l.getWest(),l.getEast())&&SuperMap.Plot.PlottingUtil.equalFuzzy(l.getNorth(),l.getSouth())||SuperMap.Plot.PlottingUtil.equalFuzzy(o.getWest(),o.getEast())&&SuperMap.Plot.PlottingUtil.equalFuzzy(o.getNorth(),o.getSouth()))){var n=SuperMap.Plot.PlottingUtil.equalFuzzy(o.getWest(),o.getEast())?0:(l.getEast()-l.getWest())/(o.getEast()-o.getWest()),a=SuperMap.Plot.PlottingUtil.equalFuzzy(o.getNorth(),o.getSouth())?0:(l.getNorth()-l.getSouth())/(o.getNorth()-o.getSouth()),s=L.latLng((o.getNorth()+o.getSouth())/2,(o.getWest()+o.getEast())/2),r=L.latLng((l.getNorth()+l.getSouth())/2,(l.getWest()+l.getEast())/2);if(this.symbolType===SuperMap.Plot.SymbolType.ANNOFRAMESYMBOL||this.symbolType===SuperMap.Plot.SymbolType.ANNOFRAMESYMBOLM||this.symbolType===SuperMap.Plot.SymbolType.SYMBOLTEXTBOX||this.symbolType===SuperMap.Plot.SymbolType.LINEMARKING)this.latLngs[0].lng=r.lng+(i[0].lng-s.lng)*n,this.latLngs[0].lat=r.lat+(i[0].lat-s.lat)*a,this.latLngs[1].lng=r.lng+(i[1].lng-s.lng)*n,this.latLngs[1].lat=r.lat+(i[1].lat-s.lat)*a;else if(this.symbolType===SuperMap.Plot.SymbolType.CONCENTRICCIRCLE)if(2===e||4===e||5===e||7===e){1===n&&(n=0),1===a&&(a=0);for(var u=Math.sqrt(n*n+a*a),p=L.Util.latLngsToSuperMapPoints(i),h=1;h<p.length;h++)p[h]=SuperMap.Plot.PlottingUtil.findPointInLine(p[0],p[h],SuperMap.Plot.PlottingUtil.distance(p[0],p[h])*u);this.latLngs=L.Util.superMapPointsToLatLngs(p)}else{for(var c=Math.sqrt(n*n+a*a)/Math.sqrt(2),g=L.Util.latLngsToSuperMapPoints(i),y=1;y<g.length;y++)g[y]=SuperMap.Plot.PlottingUtil.findPointInLine(g[0],g[y],SuperMap.Plot.PlottingUtil.distance(g[0],g[y])*c);this.latLngs=L.Util.superMapPointsToLatLngs(g)}else for(var f=0;f<i.length;f++)this.latLngs[f].lng=r.lng+(i[f].lng-s.lng)*n,this.latLngs[f].lat=r.lat+(i[f].lat-s.lat)*a}}},_getLatLng:function(t,e,o){var i=0,l=0;switch(t){case 1:i=e.getWest()+o.lng,l=e.getNorth()+o.lat;break;case 3:i=e.getEast()+o.lng,l=e.getNorth()+o.lat;break;case 6:i=e.getWest()+o.lng,l=e.getSouth()+o.lat;break;case 8:i=e.getEast()+o.lng,l=e.getSouth()+o.lat;break;case 2:i=(e.getEast()+e.getWest())/2,l=e.getNorth()+o.lat;break;case 4:i=e.getWest()+o.lng,l=(e.getNorth()+e.getSouth())/2;break;case 5:i=e.getEast()+o.lng,l=(e.getNorth()+e.getSouth())/2;break;case 7:i=(e.getEast()+e.getWest())/2,l=e.getSouth()+o.lat}return L.latLng(l,i)},_setSymbolData:function(t){if(i.PlottingObject.prototype._setSymbolData.call(this,t),this.symbolData){SuperMap.Plot.AnalysisSymbol.setStyle(this.style,this.symbolData,!0),this.symbolData.scaleByMap=this.scaleByMap,this.symbolData.surroundLineType=this.surroundLineType,this.symbolData.algoMaxEditPts=this.maxEditPts,this.symbolData.algoMinEditPts=this.minEditPts,this.symbolData.hasOwnProperty("localePoints")||(this.symbolData.localePoints=[]);for(var e=this.getLatLngs().length,o=0;o<e;o++)this.symbolData.localePoints.length>o?(this.symbolData.localePoints[o].x=this.getLatLngs()[o].lng,this.symbolData.localePoints[o].y=this.getLatLngs()[o].lat):this.symbolData.localePoints.push({x:this.getLatLngs()[o].lng,y:this.getLatLngs()[o].lat,z:0})}},_parseSymbolData:function(){if(i.PlottingObject.prototype._parseSymbolData.call(this),null!==this.symbolData&&(this.style=SuperMap.Plot.AnalysisSymbol.getStyle(this.symbolData,!0),this.maxEditPts=this.symbolData.algoMaxEditPts,this.minEditPts=this.symbolData.algoMinEditPts,void 0!==this.symbolData.isEdit&&(this.isEdit=this.symbolData.isEdit),void 0!==this.symbolData.scaleByMap&&(this.scaleByMap=this.symbolData.scaleByMap),this.surroundLineType=this.symbolData.surroundLineType,this.symbolData.localePoints)){this.latLngs=[];for(var t=0;t<this.symbolData.localePoints.length;t++)this.latLngs.push(L.latLng(this.symbolData.localePoints[t].y,this.symbolData.localePoints[t].x))}},_modifyPoint:function(){},_transSymbolCellsToLayers:function(t){var e=[],o="";null!==this._map&&this._map instanceof L.Map&&(o=this._map.options.crs.code);for(var i=0;i<t.length;i++)if(0!==this.surroundLineType||!0!==t[i].surroundLineFlag){L.Util.isMercatorProjection(o)&&(t[i].positionPoints=L.Util.conventProjectPts(L.Util.superMapPointsToLatLngs(t[i].positionPoints)));var l={type:t[i].type,positionPoints:SuperMap.Plot.PlottingUtil.clonePoints(t[i].positionPoints),style:SuperMap.Util.cloneObject(t[i].style),angle:t[i].angle,isCalculate:t[i].isCalculate,textContent:t[i].textContent};1===this.symbolType?l.positionPoints=SuperMap.Plot.Primitives.getSpatialData(l.type,l.positionPoints,l.angle,!1):l.positionPoints=SuperMap.Plot.Primitives.getSpatialData(l.type,l.positionPoints,l.angle,l.isCalculate),e.push(l)}0!==e.length&&this._addSurroundLineCells(e);for(var n=0;n<e.length;n++)L.Util.isMercatorProjection(o)?e[n].positionPoints=L.Util.unConventProjectPts(e[n].positionPoints):e[n].positionPoints=L.Util.superMapPointsToLatLngs(e[n].positionPoints),this._createAndDrawLayer(e[n].type,e[n].positionPoints,e[n].style,e[n].textContent)},_isPolylineType:function(t){switch(t){case 24:case 44:case 48:case 290:case 400:case 590:return!0;default:return!1}},_createAndDrawLayer:function(t,e,o,i,l){var n=this._createLayer(t,e,i,l);2e3===t&&this._addComponents(n),null==o&&(o={}),this._isPolylineType(t)&&(o.fillLimit=!0,o.fill=!1);var a={};if(a=SuperMap.Util.copyAttributes(a,o),this._copyStyleForCell(a,this.style,n),34===t&&!1===o.sizeFixed){var s=this._map.latLngToLayerPoint(e[0]),r=this._map.latLngToLayerPoint(L.latLng(e[0].lat+a.fontSize,e[0].lng));a.fontSize=Math.abs(r.y-s.y)}return L.setOptions(n,a),2e3===t?n.redraw():this._addComponents(n),n},_createLayer:function(t,e,o,i){var l=null;switch(t){case 24:case 44:case 48:case 290:case 400:case 590:l=L.polyline(e,{smoothFactor:0});break;case 29:case 31:case 32:case 28:case 410:case 370:case 380:case 390:case 320:case 321:case 350:case 360:l=L.polygon(e,{smoothFactor:0});break;case 26:l=L.rectangle(e);break;case 34:l=L.supermap.plotting.text(e,{text:o});break;case 2e3:l=L.circle(e[0],i)}return l},_addSurroundLineCells:function(t){if(this.symbolType!==SuperMap.Plot.SymbolType.DOTSYMBOL){if(this.symbolType===SuperMap.Plot.SymbolType.TEXTSYMBOL)return null;if(this._map)for(var e=[],o=[],i={},l={},n={},a={},s=this.surroundLineType===SuperMap.Plot.AlgoSurroundLineType.OUT?1:-1,r=0,u=t.length;r<u;r++)if((!t[r].style.lineWidthLimit||0!==t[r].style.weight)&&((i=SuperMap.Util.cloneObject(t[r].style)).surroundLineFlag=!0,i.fill=!1,i.fillLimit=!0,i.fillColorLimit=!0,!0!==t[r].style.surroundLineLimit?t[r].style.surroundLineType=this.surroundLineType:void 0===t[r].style.surroundLineType&&(t[r].style.surroundLineType=SuperMap.Plot.AlgoSurroundLineType.NONE),t[r].style.surroundLineType!==SuperMap.Plot.AlgoSurroundLineType.NONE&&t[r].type!==SuperMap.Plot.SymbolType.TEXTSYMBOL)){if(t[r].style.surroundLineType===SuperMap.Plot.AlgoSurroundLineType.INNER||t[r].style.surroundLineType===SuperMap.Plot.AlgoSurroundLineType.OUT){var p=this.style.surroundLineWidth/2+this.style.weight/2;!0===t[r].style.surroundLineLimit&&!0===t[r].style.lineWidthLimit?p=t[r].style.surroundLineWidth/2+t[r].style.weight/2:!0===t[r].style.surroundLineLimit&&!0!==t[r].style.lineWidthLimit?p=t[r].style.surroundLineWidth/2+this.style.weight/2:!0!==t[r].style.surroundLineLimit&&!0===t[r].style.lineWidthLimit&&(p=this.style.surroundLineWidth/2+t[r].style.weight/2);var h=this._map.layerPointToLatLng(L.point(0,0)),c=this._map.layerPointToLatLng(L.point(p,0)),g=new SuperMap.Geometry.Point(h.lng,h.lat),y=new SuperMap.Geometry.Point(c.lng,c.lat),f=SuperMap.Plot.PlottingUtil.distance(g,y),P=1;SuperMapAlgoPlot.AlgoSymbolFactory.calSurroundLineDir(this.libID,this.code)&&(P=SuperMap.Plot.PlottingUtil.innerOutlineDir(t[r].positionPoints));var d=P*s*f;if(this._isPolylineType(t[r].type)||t[r].positionPoints.push(t[r].positionPoints[0]),0===(e=SuperMap.Plot.PlottingUtil.getSurroundLinePts(t[r].positionPoints,d)).length)continue;l={type:t[r].type,positionPoints:e,style:i},t.splice(++r,0,l),++u}if(t[r].style.surroundLineType===SuperMap.Plot.AlgoSurroundLineType.ALL){if(0===(e=SuperMap.Plot.PlottingUtil.clonePoints(t[r].positionPoints)).length)continue;if(l={type:t[r].type,positionPoints:e,style:i},t.splice(++r,0,l),++u,0===(o=SuperMap.Plot.PlottingUtil.clonePoints(t[r].positionPoints)).length)continue;delete(a=SuperMap.Util.copyAttributes(a,this.style)).fillSymbolID,a.surroundLineFlag=!1,a.fill=!1,a.fillLimit=!0,a.fillColorLimit=!0,n={type:t[r].type,positionPoints:o,style:a},t.splice(++r,0,n),++u}}}},_updateSymbolTexts:function(){for(var t=0;t<this.geoSymbolTexts.length;t++){var e=this.geoSymbolTexts[t];if(null===e||void 0===e)return;null==e.layer||null!=e.layer.getVisibility&&!0!==e.layer.getVisibility()||(e.fromZoom=this.fromZoom,e.redraw())}},_updateCanvasFills:function(){for(var t=0,e=this.components.length;t<e;t++)!1!==this.components[t].options.fillLimit&&!1!==Boolean(this.components[t].options.fillLimit)||(!0!==this.components[t].options.fill||"LINEAR"!==this.style.fillGradientMode&&"RADIAL"!==this.style.fillGradientMode?this.components[t].options.fillSymbolID>=2&&new SuperMap.Plot.CalculateCanvasGradient(this,this.components[t].getBounds()).createFillMode(this.components[t].options):this._computeGradientInCanvas(this.components[t],this.components[t].options,this.style))},_rotate:function(t,e){for(var o in this.components)this.components[o]instanceof a?this.components[o]._rotate(t,e):(this.components[o]instanceof n.PointImage&&(this.components[o].options.rotation+=-t),this.components[o]instanceof l.Text&&(this.components[o].options.labelRotation?(this.components[o].options.labelRotation+=-t,this.symbolType===SuperMap.Plot.SymbolType.DOTSYMBOL&&0===this.components[o].options.labelRotation&&(this.components[o].options.labelRotation=360)):this.components[o].options.labelRotation=-t),L.Util.rotateLatLngs(this.components[o].getLatLngs(),e,t),this.components[o].setLatLngs(this.components[o].getLatLngs()));L.Util.rotateLatLngs(this.getLatLngs(),e,t)},_move:function(t,e){if(null!=this.graphic&&null!=this.graphic.layer&&!0===this.graphic.layer.getVisibility())L.Util.moveLatLngs(this.getLatLngs(),t,e),this.graphic.update();else if(null!=this.layer&&(null==this.layer.getVisibility||!0===this.layer.getVisibility())){for(var o=0,i=this.components.length;o<i;o++)L.Util.moveLatLngs(this.components[o].getLatLngs(),t,e),this.components[o].setLatLngs(this.components[o].getLatLngs());this._renderer instanceof L.Canvas&&this._updateCanvasFills(),L.Util.moveLatLngs(this.getLatLngs(),t,e),this.fire(SuperMap.Plot.Event.reseteditmarkersvalues)}},_resize:function(t,e){for(var o in isNaN(t)&&(t=1),this.symbolType===SuperMap.Plot.SymbolType.TEXTSYMBOL&&(this.style.fontSize*=t),this.components)this.components[o]instanceof a?this.components[o]._resize(t,e):(this.components[o]instanceof n.PointImage&&(this.components[o].options.graphicWidth*=t,this.components[o].options.graphicHeight*=t),this.components[o]instanceof l.Text&&(this.components[o].options.fontSize*=t),L.Util.resizeLatLngs(this.components[o].getLatLngs(),e,t),this.components[o].setLatLngs(this.components[o].getLatLngs()));L.Util.resizeLatLngs(this.getLatLngs(),e,t)},_computeGradientInCanvas:function(t,e){t.getBounds().isValid()&&(e.fillColor=new SuperMap.Plot.CalculateCanvasGradient(this,t.getBounds()).createGradient())},_computeGradientInSVG:function(t){t.fillColor="url(#"+new SuperMap.Plot.CalculateSVGGradient(this).createGradient()+")"},_dashArray:function(t,e){return 1===t?[2*e,2*e].join():2===t?[0,2*e].join():3===t?[2*e,2*e,0,2*e].join():4===t?[2*e,2*e,0,2*e,0,2*e].join():null},_lineSymbolID:function(t,e){return t===[2*e,2*e].join()?1:t===[0,2*e].join()?2:t===[2*e,2*e,0,2*e].join()?3:t===[2*e,2*e,0,2*e,0,2*e].join()?4:0},_copyStyleForFeature:function(t,e){if(!0===e.surroundLineLimit&&(t.surroundLineColor=e.surroundLineColor,t.surroundLineColorOpacity=e.surroundLineColorOpacity,t.surroundLineWidth=e.surroundLineWidth),e.lineWidthLimit&&(t.weight=e.weight),e.lineColorLimit&&(t.color=e.color,t.opacity=e.opacity),e.lineTypeLimit)if(null===e.dashArray||void 0===e.dashArray)t.lineSymbolID=0;else{var o=e.weight;t.lineSymbolID=this._lineSymbolID(e.dashArray,o)}e.fillLimit&&(void 0===e.fill||!1===e.fill?t.fillSymbolID=1:t.fillSymbolID=0,e.fillColorLimit?null===e.fillColor||void 0===e.fillColor?(t.fillColor=e.color,t.fillOpacity=e.opacity):(t.fillColor=e.fillColor,t.fillOpacity=e.opacity):(t.fillColor=e.color,t.fillOpacity=e.opacity),t.fillGradientMode=e.fillGradientMode),e.fontSizeLimit&&(t.fontSize=e.fontSize),e.fontColorLimit&&(t.fontColor=e.fontColor),void 0!==e.labelAlign&&(t.labelAlign=e.labelAlign),void 0!==e.labelRotation&&(t.labelRotation=e.labelRotation),(e.fontSizeLimit||e.fontColorLimit)&&(t.fontWeight=e.fontWeight,t.fontStyle=e.fontStyle,t.fontStroke=e.fontStroke,t.fontStrokeColor=e.fontStrokeColor,t.fontStrokeWidth=e.fontStrokeWidth,t.fontBackground=e.fontBackground,t.fontBackgroundColor=e.fontBackgroundColor,t.fontShadow=e.fontShadow,t.fontShadowColor=e.fontShadowColor,t.fontShadowOffsetX=e.fontShadowOffsetX,t.fontShadowOffsetY=e.fontShadowOffsetY,t.fontSpace=e.fontSpace,t.fontPercent=e.fontPercent,t.fontFamily=e.fontFamily,t.fontOpacity=e.fontOpacity),t.graphicWidth<0&&(t.graphicWidth=Math.abs(t.graphicWidth)),t.graphicHeight<0&&(t.graphicHeight=Math.abs(t.graphicHeight)),t.fontSize<0&&(t.fontSize=Math.abs(t.fontSize))},_copyStyleForCell:function(t,e,o){if(e.display&&"none"===e.display)t.display=e.display;else{if(!0===t.surroundLineFlag){var i=e.weight;!0===t.lineWidthLimit&&(i=t.weight),!0!==t.surroundLineLimit?(t.color=e.surroundLineColor,t.opacity=e.surroundLineColorOpacity,t.weight=e.surroundLineWidth):(t.color=t.surroundLineColor,t.opacity=t.surroundLineColorOpacity,t.weight=t.surroundLineWidth),this.surroundLineType===SuperMap.Plot.AlgoSurroundLineType.ALL&&(t.weight=2*t.weight+i),t.dashArray=null}else{if(t.lineWidthLimit||(t.weight=e.weight),t.lineColorLimit||(t.color=e.color,t.opacity=e.opacity),!t.lineTypeLimit){if(void 0!==e.lineSymbolID){e.lineSymbolID=parseInt(e.lineSymbolID);var n=e.weight;e.dashArray=this._dashArray(e.lineSymbolID,n)}t.dashArray=e.dashArray,t.lineCap||void 0===e.lineCap||(t.lineCap=e.lineCap),t.lineJoin||void 0===e.lineJoin||(t.lineJoin=e.lineJoin)}if(t.lineSymbolID){var a=t.weight;t.dashArray=this._dashArray(parseInt(t.lineSymbolID),a),delete t.lineSymbolID}}if(t.fillLimit||o instanceof l.Text)1===t.fillSymbolID?t.fill=!1:0===t.fillSymbolID&&(t.fill=!0),t.fillColorLimit||(t.fillColor=t.color,t.fillOpacity=t.opacity),!0===t.fillLimit&&!0===t.fillColorLimit&&(t.fillOpacity=1);else if("LINEAR"===e.fillGradientMode||"RADIAL"===e.fillGradientMode)t.fillOpacity=1,this._map.getRenderer(this.layer)instanceof L.Canvas?this._computeGradientInCanvas(o,t):this._map.getRenderer(this.layer)instanceof L.SVG&&(t.fillOpacity=1,this._computeGradientInSVG(t));else if(this._map.getRenderer(this.layer)instanceof L.SVG)new SuperMap.Plot.CalculateSVGGradient(this).createFillMode(t);else new SuperMap.Plot.CalculateCanvasGradient(this,o.getBounds()).createFillMode(t);t.fontSizeLimit&&!1!==t.fontSizeLimit||(t.fontSize=e.fontSize),t.fontColorLimit&&!1!==t.fontColorLimit||(t.fontColor=e.fontColor),void 0===t.labelAlign&&void 0!==e.labelAlign&&(t.labelAlign=e.labelAlign),void 0===t.labelRotation&&void 0!==e.labelRotation&&(t.labelRotation=e.labelRotation),!0!==t.fontSizeLimit&&!0!==t.fontColorLimit&&(void 0!==e.fontWeight&&(t.fontWeight=e.fontWeight),void 0!==e.fontStyle&&(t.fontStyle=e.fontStyle),void 0!==e.fontStroke&&(t.fontStroke=e.fontStroke),void 0!==!e.fontStrokeColor&&(t.fontStrokeColor=e.fontStrokeColor),void 0!==e.fontStrokeWidth&&(t.fontStrokeWidth=e.fontStrokeWidth),void 0!==e.fontBackground&&(t.fontBackground=e.fontBackground),void 0!==e.fontBackgroundColor&&(t.fontBackgroundColor=e.fontBackgroundColor),void 0!==e.fontShadow&&(t.fontShadow=e.fontShadow),void 0!==e.fontShadowColor&&(t.fontShadowColor=e.fontShadowColor),void 0!==e.fontShadowOffsetX&&(t.fontShadowOffsetX=e.fontShadowOffsetX),void 0!==e.fontShadowOffsetY&&(t.fontShadowOffsetY=e.fontShadowOffsetY),void 0!==e.fontSpace&&(t.fontSpace=e.fontSpace),void 0!==e.fontPercent&&(t.fontPercent=e.fontPercent),void 0!==e.fontFamily&&(t.fontFamily=e.fontFamily),void 0!==e.fontOpacity&&(t.fontOpacity=e.fontOpacity)),"none"===e.display?t.display=e.display:t.display="display",t.graphicWidth<0&&(t.graphicWidth=Math.abs(t.graphicWidth)),t.graphicHeight<0&&(t.graphicHeight=Math.abs(t.graphicHeight)),t.fontSize<0&&(t.fontSize=Math.abs(t.fontSize))}}});L.supermap.plotting.GraphicObject=a},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Text=void 0,o(0);var i=e.Text=L.Path.extend({options:{text:"",labelAlign:"cm",labelRotation:0,fontColor:"#000000",fontSize:14,fontOpacity:1,fontFamily:"微软雅黑",fontWeight:"normal",fontStyle:"",fontSpace:0,fontPercent:100,fontStroke:!1,fontStrokeColor:"#ff0000",fontStrokeWidth:2,fontBackground:!1,fontBackgroundColor:"#ff0000",fontShadow:!1,fontShadowColor:"#ff0000",fontShadowOffsetX:0,fontShadowOffsetY:0,interactive:!0},_textNode:null,_backgroundTextNode:null,_shadowTextNode:null,_tspanNodeObj:null,initialize:function(t,e){L.setOptions(this,e),this._latlng=L.latLng(t[0]),this._text=this.options.text,this._tspanNodeObj={}},onAdd:function(){L.Path.prototype.onAdd.call(this)},onRemove:function(){this._removeNode(),L.Path.prototype.onRemove.call(this)},_removeNode:function(){this._textNode&&this._textNode.parentNode&&(L.DomUtil.remove(this._textNode),this.removeInteractiveTarget(this._textNode),delete this._textNode,this._textNode=null),this._backgroundTextNode&&this._backgroundTextNode.parentNode&&(this._renderer._rootGroup.removeChild(this._backgroundTextNode),delete this._backgroundTextNode,this._backgroundTextNode=null),this._shadowTextNode&&this._shadowTextNode.parentNode&&(this._renderer._rootGroup.removeChild(this._shadowTextNode),delete this._shadowTextNode,this._shadowTextNode=null),this._tspanNodeObj={},this._textNode&&(L.DomUtil.remove(this._textNode),this.removeInteractiveTarget(this._textNode),delete this._textNode,this._textNode=null),this._backgroundTextNode&&(delete this._backgroundTextNode,this._backgroundTextNode=null),this._shadowTextNode&&(delete this._shadowTextNode,this._shadowTextNode=null)},setLatLngs:function(t){return this._latlng=L.latLng(t[0]),this.redraw(),this.fire("move",{latlng:this._latlng})},getLatLngs:function(){return[this._latlng]},setText:function(t){return this.options.text=this._text=t,this.redraw()},getText:function(){return this._text},setStyle:function(t){var e=t&&t.text||this._text;return L.Path.prototype.setStyle.call(this,t),this.setText(e),this},getBounds:function(){return this._updateBounds(),this._bounds},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},getPxBounds:function(t){this._point=this._map.latLngToLayerPoint(this._latlng);var e=1;this.options.fontPercent&&100!==this.options.fontPercent&&(e=this.options.fontPercent/100);var o=0,i=0,l=this.options.text.split("\n"),n=l.length;if(this._renderer instanceof L.Canvas){var a=[this.options.fontStyle?this.options.fontStyle:"normal","normal",this.options.fontWeight?this.options.fontWeight:"normal",this.options.fontSize?this.options.fontSize+"px":"1em",this.options.fontFamily?this.options.fontFamily:"sans-serif"].join(" ");this._renderer._ctx.font=a,this.options.fontSize=parseFloat(this.options.fontSize);var s=L.Canvas.LABEL_FACTOR[this.options.labelAlign[1]];null==s&&(s=-.5);var r=this._renderer._ctx.measureText("Mg").height||this._renderer._ctx.measureText("xx").width;i=r*s*(n-1)+r*n;for(var u=0;u<n;u++)if(this.options.fontSpace&&0!=this.options.fontSpace||this.options.fontPercent&&100!=this.options.fontPercent){var p=(this._renderer._ctx.measureText(l[u]).width+this.options.fontSpace*(l[u].length-1))*e;o<p&&(o=p)}else{var h=this._renderer._ctx.measureText(l[u]).width;o<h&&(o=h)}}else if(this._renderer instanceof L.SVG){var c=L.SVG.LABEL_VFACTOR[this.options.labelAlign[1]];null==c&&(c=-.5);var g=this.options.fontSize;i=g*c*(n-1)+g*n;for(var y=0;y<n;y++){var f=SuperMap.Plot.PlottingUtil.getTextWidth(this.options,l[y]);o<f&&(o=f)}}else{this.options.fontSize=parseFloat(this.options.fontSize);var P=this.options.fontSize;i=P*(n-1)+P*n;for(var d=0;d<n;d++){var S=SuperMap.Plot.PlottingUtil.getTextWidth(this.options,l[d]);o<S&&(o=S)}}this.options.fontSize<6&&(o=0);var m=0,b=0,v=0,M=0,A=this.options.labelAlign||"cm";for(var T in"lt"===A?(m=this._point.x,b="微软雅黑"==this.options.fontFamily||"Microsoft YaHei"==this.options.fontFamily?this._point.y:this._point.y-this.options.fontSize/2,v=this._point.x+o,M=this._point.y+i):"ct"===A?(m=this._point.x-o/2,b="微软雅黑"==this.options.fontFamily||"Microsoft YaHei"==this.options.fontFamily?this._point.y:this._point.y-this.options.fontSize/2,v=this._point.x+o/2,M=this._point.y+i):"rt"===A?(m=this._point.x-o,b="微软雅黑"==this.options.fontFamily||"Microsoft YaHei"==this.options.fontFamily?this._point.y:this._point.y-this.options.fontSize/2,v=this._point.x,M=this._point.y+i):"lb"===A?(m=this._point.x,b=this._point.y-i,v=this._point.x+o,M="微软雅黑"==this.options.fontFamily||"Microsoft YaHei"==this.options.fontFamily?this._point.y:this._point.y+this.options.fontSize/2):"cb"===A?(m=this._point.x-o/2,b=this._point.y-i,v=this._point.x+o/2,M=this._point.y,M="微软雅黑"==this.options.fontFamily||"Microsoft YaHei"==this.options.fontFamily?this._point.y:this._point.y+this.options.fontSize/2):"rb"===A?(m=this._point.x-o,b=this._point.y-i,v=this._point.x,M="微软雅黑"==this.options.fontFamily||"Microsoft YaHei"==this.options.fontFamily?this._point.y:this._point.y+this.options.fontSize/2):"lm"===A?(m=this._point.x,b=this._point.y-i/2,v=this._point.x+o,M=this._point.y+i/2):"cm"===A?(m=this._point.x-o/2,b=this._point.y-i/2,v=this._point.x+o/2,M=this._point.y+i/2):"rm"===A&&(m=this._point.x-o,b=this._point.y-i/2,v=this._point.x,M=this._point.y+i/2),t&&this.options.fontShadow&&(0!==this.options.fontShadowOffsetX||0!==this.options.fontShadowOffsetY)&&(this.options.fontShadowOffsetX>0?v+=this.options.fontShadowOffsetX:m+=this.options.fontShadowOffsetX,this.options.fontShadowOffsetY>0?M+=this.options.fontShadowOffsetY:b+=this.options.fontShadowOffsetY),this._eventParents)if(this._eventParents[T].symbolType===SuperMap.Plot.SymbolType.TEXTSYMBOL&&0===this.options.fontPercent&&0===this.options.fontPercent){var _=v-m,O=(_+this.options.fontSpace*(this.options.text.length-1))*this.options.fontPercent/100-_;switch(A){case"lt":case"lm":case"lb":v+=O;break;case"rt":case"rm":case"rb":m-=O;break;case"ct":case"cm":case"cb":m-=O/2,v+=O/2}}var x=new L.Bounds;if(this.options.labelRotation&&0!==this.options.labelRotation){var w=[];w.push(L.point(m,b)),w.push(L.point(m,M)),w.push(L.point(v,b)),w.push(L.point(v,M));for(var E=this.options.labelRotation*(Math.PI/180),C=0;C<w.length;C++)SuperMap.Plot.PlottingUtil.rotateAngle(this._point,E,w[C]),x.extend(w[C])}else x=L.bounds(L.point(m,b),L.point(v,M));return x},_updateBounds:function(){this._pxBounds=this.getPxBounds(!0);var t=this._map.layerPointToLatLng(this._pxBounds.min),e=this._map.layerPointToLatLng(this._pxBounds.max);this._bounds=L.latLngBounds(t,e)},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateText(this)},_empty:function(){return this._text&&!this._renderer._bounds.intersects(this._pxBounds)}});L.supermap.plotting.text=function(t,e){return new i(t,e)},L.supermap.plotting.Text=i},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GOAnimation=void 0,o(0);var i=e.GOAnimation=L.Evented.extend({startTime:0,duration:5,repeat:!1,name:null,animationState:SuperMap.Plot.GOAnimationState.UNKNOWN,goFeature:null,animationGOFeature:null,innerStartTime:0,lastExecute:!1,pauseTime:0,ratio:0,symbolTexts:[],initialize:function(t){SuperMap.Util.extend(this,t)},destroy:function(){this.showAnimationFeature(!1),this.removeAnimationFeature(),this.goFeature=null,this.animationGOFeature=null,this.name=null,this.animationState=SuperMap.Plot.GOAnimationState.UNKNOWN;for(var t=0;t<this.symbolTexts.length;t++)this.symbolTexts[t]=null;this.symbolTexts=[]},setGOFeature:function(t){if(void 0===t||null===t||null===t.layer)return!1;var e=L.supermap.plotting.getControl().getGOAnimationManager();if(null===e.goAnimationLayer)return!1;if(this.goFeature=t,this.animationGOFeature=this.cloneGOFeature(t),null===this.animationGOFeature)return!1;if(e.goAnimationLayer.addFeatures(this.animationGOFeature),this.getGOAnimationType()===SuperMap.Plot.GOAnimationType.ANIMATION_WAY&&0!==t.geoSymbolTexts.length)for(var o=0;o<t.geoSymbolTexts.length;o++){var i=t.geoSymbolTexts[o];if(null!==i){var l=i.getSymbolData();l.associatedUuid=this.animationGOFeature.uuid;var n={symbolData:l,map:i.map,serverUrl:i.serverUrl},a=L.supermap.plotting.PlottingObject.createSymbol(i.libID,i.code,null,n,null);this.symbolTexts.push(a),e.goAnimationLayer.addFeatures(a)}}return this.showAnimationFeature(!1),!0},getGOFeature:function(){return this.goFeature},play:function(){var t=new Date;this.animationState===SuperMap.Plot.GOAnimationState.PAUSE?this.innerStartTime+=t.getTime()/1e3-this.pauseTime:this.innerStartTime=t.getTime()/1e3,this.lastExecute=!1,this.animationState=SuperMap.Plot.GOAnimationState.PLAYING;var e=L.supermap.plotting.getControl().getGOAnimationManager();this.goFeature.isSelected&&e.map.getPlotEditControl()&&e.map.getPlotEditControl().unselectFeatures(this.goFeature),this.showAnimationFeature(!0)},stop:function(){this.animationState=SuperMap.Plot.GOAnimationState.STOP},pause:function(){this.animationState=SuperMap.Plot.GOAnimationState.PAUSE;var t=new Date;this.pauseTime=t.getTime()/1e3},reset:function(){this.animationState=SuperMap.Plot.GOAnimationState.RESET,this.showAnimationFeature(!1)},execute:function(){return!1},canExecute:function(){if(this.animationState!==SuperMap.Plot.GOAnimationState.PLAYING)return!1;var t=(new Date).getTime()/1e3;if(this.innerStartTime+this.startTime>t)return!1;var e=this.getRatioByTime();return!(e>1&&this.lastExecute||e<0)},getRatioByTime:function(){if(this.animationState!==SuperMap.Plot.GOAnimationState.PLAYING)return 0;var t=(new Date).getTime()/1e3;if(this.innerStartTime+this.startTime>t)return 0;var e=(t-this.innerStartTime-this.startTime)/this.duration;return e>=1&&!this.lastExecute?this.repeat?(this.innerStartTime=(new Date).getTime()/1e3,e=0,this.lastExecute=!1,this.animationState=SuperMap.Plot.GOAnimationState.PLAYING):(e=1,this.lastExecute=!0,this.animationState=SuperMap.Plot.GOAnimationState.STOP):e<0&&(e=0),this.ratio=e,e},showAnimationFeature:function(t){if(null!==this.animationGOFeature&&null!==this.animationGOFeature.style&&(this.resetAnimationFeature(t),this.animationGOFeature.redraw()),null!==this.goFeature&&null!==this.goFeature.style){if(t){this.goFeature.style.display="none";for(var e=0;e<this.goFeature.geoSymbolTexts.length;e++)this.goFeature.geoSymbolTexts[e].style.display="none"}else{this.goFeature.style.display="display";for(var o=0;o<this.goFeature.geoSymbolTexts.length;o++)this.goFeature.geoSymbolTexts[o].style.display="display"}this.goFeature.redraw();for(var i=0;i<this.goFeature.geoSymbolTexts.length;i++)this.goFeature.geoSymbolTexts[i].redraw()}},resetAnimationFeature:function(t){if(this.animationGOFeature.symbolData=SuperMap.Plot.PlottingUtil.cloneObject(this.goFeature.getSymbolData()),this.animationGOFeature.symbolData.uuid=this.animationGOFeature.uuid,SuperMap.Plot.AnalysisSymbol.parseSymbolData(this.animationGOFeature,this.animationGOFeature.symbolData,!0),t){this.animationGOFeature.style.display="display";for(var e=0;e<this.symbolTexts.length;e++)this.symbolTexts[e].style.display="display",this.symbolTexts[e].redraw()}else{this.animationGOFeature.style.display="none";for(var o=0;o<this.symbolTexts.length;o++)this.symbolTexts[o].style.display="none",this.symbolTexts[o].redraw();this.getGOAnimationType()===SuperMap.Plot.GOAnimationType.ANIMATION_WAY&&null!==this.pathFeature&&(this.pathFeature.options.opacity=0,this.pathFeature.redraw())}},cloneGOFeature:function(t){var e=null,o=L.supermap.plotting.getControl().getGOAnimationManager().goAnimations;if(null!==o)for(var i=0;i<o.length;i++){var l=o[i];if(l.goFeature===t){e=l.animationGOFeature;break}}return null===e&&((e=t.clone()).enableEdit=!1),e},removeAnimationFeature:function(){if(null!==this.animationGOFeature){var t=L.supermap.plotting.getControl().getGOAnimationManager(),e=t.goAnimations,o=!1;if(null!==e)for(var i=0;i<e.length;i++){var l=e[i];if(l!==this&&l.animationGOFeature===this.animationGOFeature){o=!0;break}}if(!o){t.goAnimationLayer.removeFeatures(this.animationGOFeature);for(;0<this.symbolTexts.length;)t.goAnimationLayer.removeFeatures(symbolTexts[0])}}},getJSONData:function(){var t={};return t.goFeatureUuid=this.goFeature.uuid,t.name=this.name,t.startTime=this.startTime,t.duration=this.duration,t.repeat=this.repeat,t.type=this.getGOAnimationType(),t},fromJSONData:function(t){this.startTime=t.startTime,this.duration=t.duration,this.repeat=t.repeat}});L.supermap.plotting.GOAnimation=i},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Route=void 0,o(0);var i=o(5),l=o(6),n=o(7),a=o(16),s=o(75),r=o(15),u=e.Route=i.PlottingObject.extend({routeNodes:[],nextRouteNodeType:SuperMap.Plot.RouteNodeType.TURNING,arrRoutePts:[],initialize:function(t,e,o,l){this.scaleByMap=!0,this.minEditPts=1,this.maxEditPts=9999,this.routeNodes=[],this.arrRoutePts=[],this.prevRouteNode=[],this.prevLiterateSign=[],i.PlottingObject.prototype.initialize.call(this,t,e,o,l)},destroy:function(){this.routeNodes=null,this.arrRoutePts=null,i.PlottingObject.prototype.destroy.apply(this,arguments)},highlight:function(t){for(var e in this.highlightFlag=!0,this.highlightStyle=t,this.components)if(this.components[e]instanceof n.AlgoSymbol){var o=SuperMap.Util.copyAttributes(this.components[e].style,t);this.components[e].setStyle(o)}},unhighlight:function(){for(var t in this.components)if(this.components[t]instanceof n.AlgoSymbol){var e=SuperMap.Util.copyAttributes(this.components[t].style,this.style);this.components[t].setStyle(e)}this.highlightFlag=!1,this.highlightStyle=null},blinkRoute:function(t,e,o,i){void 0===o&&(o=2),void 0===t&&(t={color:"#ff0000"}),void 0===e&&(e={color:"#0000ff"}),void 0===i&&(i=300);for(var l=[],a=0;a<o;a++)l.push(t),l.push(e);!0===this.highlightFlag&&this.highlightStyle&&null!==this.highlightStyle?l.push(this.highlightStyle):l.push(this.lineStyle);for(var s=this,r=l.length,u=0;u<r;u++)setTimeout(function(){for(var t in s.components)if(s.components[t]instanceof n.AlgoSymbol){var e=SuperMap.Util.copyAttributes(s.components[t].style,l[0]);s.components[t].setStyle(e)}l.splice(0,1)},i*u)},applyTextStyle:function(t){var e;for(var o in this.components)(this.components[o]instanceof a.LiterateSign||this.components[o]instanceof s.PathText)&&(this.components[o].setStyle(SuperMap.Util.copyAttributes(this.components[o].style,t)),e=this.components[o].style);for(var i=0;i<this.routeNodes.length;i++)for(var l=0;l<this.routeNodes[i].towardNodes.length;l++)this.routeNodes[i].towardNodes[l].style=SuperMap.Util.copyAttributes(this.routeNodes[i].towardNodes[l].style,e)},applyLineStyle:function(t){for(var e in this.components)this.components[e]instanceof a.LiterateSign||this.components[e]instanceof s.PathText||this.components[e]instanceof r.GeoRouteNode||this.components[e].setStyle(SuperMap.Util.copyAttributes(this.components[e].style,t));this.style=SuperMap.Util.copyAttributes(this.style,t)},applyNodeStyle:function(t){for(var e in this.components)this.components[e]instanceof r.GeoRouteNode&&this.components[e].setStyle(SuperMap.Util.copyAttributes(this.components[e].style,t));for(var o=0;o<this.routeNodes.length;o++)this.routeNodes[o].style=SuperMap.Util.copyAttributes(this.routeNodes[o].style,t)},deleteRouteNode:function(t){if(null!==this._getNodeByUuid(t.id)){var e=this._getNodeFeature(t);e.isSelected&&null!==this._map.getPlotEditControl()&&this._map.getPlotEditControl().unselectFeatures(e),this.arrRoutePts=[];for(var o=0;o<this.routeNodes.length;o++)for(var i=0;i<this.routeNodes[o].towardNodes.length;i++)if(this.routeNodes[o].towardNodes[i].routeNodeId!==t.id);else{this.routeNodes[o].towardNodes.splice(i,1);for(var l=0;l<t.towardNodes.length;l++)t.towardNodes[l].routeNodeId!==this.routeNodes[o].id&&this.routeNodes[o].towardNodes.push(t.towardNodes[l])}for(var n=0;n<this.routeNodes.length;n++)this.routeNodes[n].id===t.id&&this.routeNodes.splice(n,1);this.redraw()}},updateRouteNode:function(t){if(0!==this.arrRoutePts.length){this.arrRoutePts=[];var e=this._getNodeByUuid(t.id);if(null!==e?e=t:this.routeNodes.push(t),this.redraw(),this.highlightFlag){var o=SuperMap.Util.cloneObject(this.highlightStyle);this.highlightStyle&&SuperMap.Util.copyAttributes(o,this.highlightStyle),this.highlight(o)}}else{var i=this._getNodeFeature(t);if(null!==i){i.routeNode=t,i.redraw();for(var l=this._getFeatureStartWith(t),n=0;n<l.length;n++)l[n].latLngs[0]=L.latLng(t.y,t.x),l[n].redraw();for(var a=this._getFeatureEndWith(t),s=0;s<a.length;s++)a[s].latLngs[1]=L.latLng(t.y,t.x),a[s].redraw();return}}},insertRouteNode:function(t,e,o,i,l,n,a,s){if(void 0===i&&(i=!0),this.arrRoutePts=[],i&&o)for(var r=0;r<e.towardNodes.length;r++)e.towardNodes[r].routeNodeId===o.id&&e.towardNodes.splice(r,1);if(null===this._getNodeByUuid(t.id)&&this.routeNodes.push(t),e){for(var u=!1,p=0;p<e.towardNodes.length;p++)e.towardNodes[p].routeNodeId===t.id&&(u=!0);if(!1===u){var h=new SuperMap.Plot.TowardNode;h.routeNodeId=t.id,void 0!==l&&(h.textContent=l),void 0!==n&&(h.relLineText=n),e.towardNodes.push(h)}}if(o){for(var c=!1,g=0;g<t.towardNodes.length;g++)t.towardNodes[g].routeNodeId===o.id&&(c=!0);if(!1===c){var y=new SuperMap.Plot.TowardNode;y.routeNodeId=o.id,void 0!==a&&(y.textContent=a),void 0!==s&&(y.relLineText=s),t.towardNodes.push(y)}}this.redraw()},addRouteNode:function(t,e,o,i){if(null===this._getNodeByUuid(t.id)&&(this.arrRoutePts=[],this.routeNodes.push(t)),e){for(var l=!1,n=0;n<e.towardNodes.length;n++)e.towardNodes[n].routeNodeId===t.id&&(l=!0);if(!1===l){var a=new SuperMap.Plot.TowardNode;a.routeNodeId=t.id,void 0!==o&&(a.textContent=o),void 0!==i&&(a.relLineText=i),e.towardNodes.push(a)}}this.redraw()},_addRouteNodeByNode:function(t,e,o){if(null===this._getNodeByUuid(t.id))return null;var i=new SuperMap.Plot.RouteNode;if(i.x=t.x,i.y=t.y,i.name="",i.type=this.nextRouteNodeType,!0===e){var l=new SuperMap.Plot.TowardNode;l.routeNodeId=t.id,i.towardNodes.push(l)}else if(!0===o){var n=new SuperMap.Plot.TowardNode;n.routeNodeId=i.id,t.towardNodes.push(n)}return this.routeNodes.push(i),this.redraw(),this._getNodeFeature(i)},_addRouteNodeByPosWithoutLast:function(t,e){for(var o=0;o<this.routeNodes.length;o++){var i=this.routeNodes[o];if(null!==i&&(i.towardNodes&&null!==i.towardNodes))for(var l=0;l<i.towardNodes.length;l++){var n=this._getNodeByUuid(i.towardNodes[l].routeNodeId);if(null!==n){var a=SuperMap.Plot.PlottingUtil.computePointToLineMinDis({x:t.lng,y:t.lat},[{x:i.x,y:i.y},{x:n.x,y:n.y}]);if(-1!==a.index&&a.minDis<e){var s=new SuperMap.Plot.RouteNode;s.x=t.lng,s.y=t.lat,s.type=this.nextRouteNodeType,s.name="",s.towardNodes.push(i.towardNodes[l]),i.towardNodes.splice(l,1);var r=new SuperMap.Plot.TowardNode;return r.routeNodeId=s.id,i.towardNodes.push(r),this.arrRoutePts=[],this.routeNodes.push(s),this.redraw(),this._getNodeFeature(s)}}}}return null},_addRouteNodeByPos:function(t,e){for(var o=[],i=0;i<this.routeNodes.length;i++){var l=this.routeNodes[i];if(null!==l&&(l.towardNodes&&null!==l.towardNodes)){0===l.towardNodes.length&&o.push(l);for(var n=0;n<l.towardNodes.length;n++){var a=this._getNodeByUuid(l.towardNodes[n].routeNodeId);if(null!==a){var s=SuperMap.Plot.PlottingUtil.computePointToLineMinDis({x:t.lng,y:t.lat},[{x:l.x,y:l.y},{x:a.x,y:a.y}]);if(-1!==s.index&&s.minDis<e){var r=new SuperMap.Plot.RouteNode;r.x=t.lng,r.y=t.lat,r.type=this.nextRouteNodeType,r.name=(this.routeNodes.length+1).toString(),r.towardNodes.push(l.towardNodes[n]),l.towardNodes.splice(n,1);var u=new SuperMap.Plot.TowardNode;return u.routeNodeId=r.id,l.towardNodes.push(u),this.arrRoutePts=[],this.routeNodes.push(r),void this.redraw()}}}}}var p=new SuperMap.Plot.RouteNode;if(p.x=t.lng,p.y=t.lat,0!==this.routeNodes.length?p.type=this.nextRouteNodeType:p.type=SuperMap.Plot.RouteNodeType.AIMING,p.name=(this.routeNodes.length+1).toString(),0!==o.length){var h=new SuperMap.Plot.TowardNode;h.routeNodeId=p.id,o[0].towardNodes.push(h)}this.routeNodes.push(p),this.redraw()},setNextRouteNodeType:function(t){this.nextRouteNodeType=t},_getNodeFeature:function(t){for(var e in this.components)if(this.components[e]instanceof r.GeoRouteNode&&this.components[e].routeNode.id===t.id)return this.components[e];return null},_getFeatureStartWith:function(t){var e=[];for(var o in this.components)this.components[o]._startRouteNode&&this.components[o]._startRouteNode===t.id&&e.push(this.components[o]);return e},_getFeatureEndWith:function(t){var e=[];for(var o in this.components)this.components[o]._endRouteNode&&this.components[o]._endRouteNode===t.id&&e.push(this.components[o]);return e},_selectNodeLayer:function(t){for(var e in L.Util.isArray(t)||(t=[t]),this.components)if((this.components[e]instanceof r.GeoRouteNode||this.components[e]instanceof a.LiterateSign)&&this.components[e].getBounds().contains(t))return this.components[e];return null},redraw:function(){if(this._initRoute(),this.arrRoutePts&&0!==this.arrRoutePts.length)for(var t=0;t<this.arrRoutePts.length;t++){var e=this.arrRoutePts[t];if(!(e.length<2)){var o=L.supermap.plotting.PlottingObject.createSymbol(0,SuperMap.Plot.SymbolType.POLYLINESYMBOL,e,{enableEdit:!1},this.style);o.route=this,this._addComponents(o)}}for(var i=0;i<this.routeNodes.length;i++){var l=this.routeNodes[i];if(null!==l&&(l.towardNodes&&null!==l.towardNodes)){for(var n=0;n<l.towardNodes.length;n++){var a=this._getNodeByUuid(l.towardNodes[n].routeNodeId);if(null!==a){var s=[];if(s.push(L.latLng(l.y,l.x)),s.push(L.latLng(a.y,a.x)),0===this.arrRoutePts.length){var r=L.supermap.plotting.PlottingObject.createSymbol(0,SuperMap.Plot.SymbolType.POLYLINESYMBOL,s,{enableEdit:!1},this.style);this._addComponents(r),r._startRouteNode=l.id,r._endRouteNode=a.id}var u=l.towardNodes[n].textContent;if(null!==u){var p=l.towardNodes[n].relLineText;void 0!==p&&null!==p||(p=SuperMap.Plot.RelLineText.ONLEFTLINE);var h=SuperMap.Util.copyAttributes(SuperMap.Plot.PlottingUtil.cloneObject(this.style),l.towardNodes[n].style),c=L.supermap.plotting.PlottingObject.createSymbol(0,SuperMap.Plot.SymbolType.PATHTEXT,s,{relLineText:p,showPathLine:!1,textContent:u,enableEdit:!1},h);this._addComponents(c),c._startRouteNode=l.id,c._endRouteNode=a.id}}}this._createRouteNode(l)}}this._finishRoute()},_initRoute:function(){this.prevRouteNode.length=0,this.prevLiterateSign.length=0;for(var t=0;t<this.components.length;t++)this.components[t]instanceof r.GeoRouteNode?this.prevRouteNode.push(this.components[t]):this.components[t]instanceof a.LiterateSign?this.prevLiterateSign.push(this.components[t]):this.components[t]._clearComponents();this.components.length=0},_finishRoute:function(){for(var t=0;t<this.prevRouteNode.length;t++)this.prevRouteNode[t]._clearComponents();for(var e=0;e<this.prevLiterateSign.length;e++)this.prevLiterateSign[e]._clearComponents();this.prevRouteNode=[],this.prevLiterateSign=[]},_createRouteNode:function(t){if(SuperMap.Util.applyDefaults(t.style,this._defaultStyle),null!==t){for(var e=0;e<this.prevRouteNode.length;){if(this.prevRouteNode[e].routeNode.id===t.id)return this.prevRouteNode[e].routeNode=t,this.prevRouteNode[e].redraw(),this.components.push(this.prevRouteNode[e]),void this.prevRouteNode.splice(e,1);e++}var o=SuperMap.Util.copyAttributes(SuperMap.Plot.PlottingUtil.cloneObject(this.style),t.style),i=L.supermap.plotting.PlottingObject.createSymbol(0,SuperMap.Plot.SymbolType.ROUTENODE,[L.latLng(t.y,t.x)],{routeNode:t,route:this},o);this._addComponents(i)}},_addComponents:function(t){l.GroupObject.prototype._addComponents.call(this,t)},_clearComponents:function(){l.GroupObject.prototype._clearComponents.call(this)},clone:function(){var t=SuperMap.Plot.PlottingUtil.cloneObject(this.getSymbolData());return t.uuid=SuperMap.Plot.PlottingUtil.generateUuid(),L.supermap.plotting.PlottingObject.createSymbol(this.libID,this.code,null,{symbolData:t,serverUrl:this.serverUrl})},_parseSymbolData:function(){if(i.PlottingObject.prototype._parseSymbolData.call(this),this.symbolData){this.routeNodes=this.symbolData.routeNodes,this.routeNodes=[];for(var t=0;t<this.symbolData.routeNodes.length;t++){var e=new SuperMap.Plot.RouteNode;null===this.symbolData.routeNodes[t].id&&void 0===this.symbolData.routeNodes[t].id||(e.id=this.symbolData.routeNodes[t].id),e.type=this.symbolData.routeNodes[t].type,e.name=this.symbolData.routeNodes[t].name,e.rotate=this.symbolData.routeNodes[t].rotate,this.symbolData.routeNodes[t].hasOwnProperty("positionPoint")?(e.x=this.symbolData.routeNodes[t].positionPoint.x,e.y=this.symbolData.routeNodes[t].positionPoint.y):(e.x=this.symbolData.routeNodes[t].x,e.y=this.symbolData.routeNodes[t].y),e.towardNodes=[];for(var o=0;o<this.symbolData.routeNodes[t].towardNodes.length;o++){var l=new SuperMap.Plot.TowardNode;l.routeNodeId=this.symbolData.routeNodes[t].towardNodes[o].routeNodeId,l.relLineText=this.symbolData.routeNodes[t].towardNodes[o].relLineText,l.textContent=this.symbolData.routeNodes[t].towardNodes[o].textContent,l.offsetX=this.symbolData.routeNodes[t].towardNodes[o].offsetX,l.offsetY=this.symbolData.routeNodes[t].towardNodes[o].offsetY,l.style=this.symbolData.routeNodes[t].towardNodes[o].style,e.towardNodes.push(l)}e.style=this.symbolData.routeNodes[t].style,this.routeNodes.push(e)}this.arrRoutePts=[];for(var n=0;n<this.symbolData.arrRoutePts.length;n++){for(var a=[],s=0;s<this.symbolData.arrRoutePts[n].length;s++)this.symbolData.arrRoutePts[n][s].hasOwnProperty("x")&&this.symbolData.arrRoutePts[n][s].hasOwnProperty("y")?a.push(L.latLng(this.symbolData.arrRoutePts[n][s].y,this.symbolData.arrRoutePts[n][s].x)):a.push(L.latLng(this.symbolData.arrRoutePts[n][s].lat,this.symbolData.arrRoutePts[n][s].lng));this.arrRoutePts.push(a)}this.lineStyle=this.symbolData.lineStyle}},_setSymbolData:function(){i.PlottingObject.prototype._setSymbolData.call(this),this.symbolData&&(this.symbolData.routeNodes=this.routeNodes,this.symbolData.arrRoutePts=this.arrRoutePts,this.symbolData.lineStyle=this.lineStyle)},_getNodeByUuid:function(t){for(var e=0;e<this.routeNodes.length;e++)if(this.routeNodes[e].id===t)return this.routeNodes[e];return null},_reView:function(){if(this.fromZoom!==this._map.getZoom())for(var t in this.components)this.components[t].symbolType!==SuperMap.Plot.SymbolType.POLYLINESYMBOL&&this.components[t]._reView();this.fromZoom=this._map.getZoom(),this.fire(SuperMap.Plot.Event.reseteditmarkersvalues)}});L.supermap.plotting.Route=u},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PlottingObject=void 0,o(0);var i=o(10),l=o(2),n=o(43),a=e.PlottingObject=L.Evented.extend({dragging:null,uuid:null,libID:null,code:null,textDisplay:!0,minEditPts:1,maxEditPts:1,symbolType:null,symbolName:null,isSelected:!1,enableEdit:!0,note:"",extendProperty:null,custom:null,symbolData:null,dRotate:null,dScale:null,textContent:null,annotationPosition:4,subSymbols:null,fromZoom:null,style:null,isLocked:!1,anchorPoint:null,avoidRegions:null,ownerGroup:null,geoSymbolTexts:null,isEdit:!1,components:null,options:{},_defaultStyle:{display:"display",color:"#ff0000",lineSymbolID:0,opacity:"1.00",weight:2,lineCap:"square",lineJoin:"square",surroundLineColor:"#ffff00",surroundLineColorOpacity:"1.00",surroundLineWidth:4,fillSymbolID:1,fillColor:"#ff0000",fillOpacity:"0.31",fillBackColor:"#ff0000",fillBackOpacity:"1.00",fillGradientMode:"NONE",fontColor:"#000000",fontFamily:"Microsoft YaHei",fontSize:"12",fontStroke:!1,fontStrokeColor:"#ff0000",fontStrokeWidth:"2px",fontBackground:!1,fontBackgroundColor:"#ff0000",fontShadow:!1,fontShadowColor:"#ff0000",fontShadowOffsetX:0,fontShadowOffsetY:0,fontSpace:0,fontPercent:100,sizeFixed:!0,labelAlign:"lt",labelRotation:-0,labelXOffset:0,labelYOffset:0,fillAngle:0,fillCenterOffsetX:0,fillCenterOffsetY:0},initialize:function(t,e,o,i){this.components=[],this.libID=t,this.code=e,this.extendProperty=new SuperMap.Plot.ExtendProperty,this.avoidRegions=[],this.subSymbols=[],this.geoSymbolTexts=[],this.dRotate=0,this.dScale=1,this.textContent="",this.associatedUuid="",i&&i.symbolData&&(this._removeRedundancySymbolData(i.symbolData),this.symbolData=SuperMap.Plot.PlottingUtil.cloneObject(i.symbolData),SuperMap.Plot.AnalysisSymbol.parseSymbolData(this,this.symbolData,!0),SuperMap.Util.applyDefaults(this.style,this._defaultStyle),delete i.symbolData),this._mergeDefaultStyle(),SuperMap.Util.extend(this,i),null===this.uuid&&(this.uuid=SuperMap.Plot.PlottingUtil.generateUuid()),null===this.style&&(this.style=SuperMap.Plot.PlottingUtil.cloneObject(this._defaultStyle));for(var l=0;l<this.avoidRegions.length;l++)this.avoidRegions[l].associatedUuid=this.uuid},onAdd:function(t){this.layer=t,t instanceof n.MovingTargetLayer?this._renderer=t.getRenderer(this.symbolType):this._renderer=t._renderer,this._map=t._map,this.redraw(),this.isEdit=!0,i.PlottingObjectDrag&&(this.dragging||(this.dragging=new i.PlottingObjectDrag(this))),null===this.fromZoom&&(this.fromZoom=this._map.getZoom())},_clearComponents:function(){for(var t=0;t<this.components.length;t++)this.components[t].removeEventParent(this),this.components[t]instanceof a?this.components[t]._clearComponents():(null!=this.components[t]._renderer&&this.components[t].onRemove(),delete this.components[t]);this.components.length=0,this._map&&this.layer&&this._map.getRenderer(this.layer)instanceof L.SVG&&this._removeGradientNodeInSVG()},_removeGradientNodeInSVG:function(){if(this.uuid&&this.layer._renderer._container.defs){var t=document.getElementById("linearGradient_"+this.uuid);null!==t&&this.layer._renderer._container.defs.removeChild(t),null!==(t=document.getElementById("radialGradient_"+this.uuid))&&this.layer._renderer._container.defs.removeChild(t),null!==(t=document.getElementById("patternFill_"+this.uuid))&&this.layer._renderer._container.defs.removeChild(t)}},_addComponents:function(t){!0===this.movingTarget?(t._map=this._map,this.components.push(t)):(t._map=this._map,t._renderer=this._renderer,t.addEventParent(this),t instanceof a?t.onAdd(this.layer):t.onAdd(),this.components.push(t))},_project:function(){var t=this;t._pxBounds=new L.Bounds,t.components.map(function(e){return e instanceof a&&e._project(),e._pxBounds&&e._pxBounds.isValid()&&(t._pxBounds.extend(e._pxBounds.min),t._pxBounds.extend(e._pxBounds.max)),e})},getBounds:function(){var t=this;return t._bounds=new L.LatLngBounds,t.components.map(function(e){return t._bounds.extend(e.getBounds()),e}),t._bounds},clone:function(){this.symbolData=this.getSymbolData();var t=SuperMap.Plot.PlottingUtil.toJSON(this.symbolData),e=JSON.parse(t);e.uuid=SuperMap.Plot.PlottingUtil.generateUuid();var o=SuperMap.Plot.PlottingUtil.cloneObject(this.style);return L.supermap.plotting.PlottingObject.createSymbol(this.libID,this.code,null,{symbolData:e,serverUrl:this.serverUrl},o)},setStyle:function(t){if(SuperMap.Util.extend(this.style,t),this.redraw(),this.symbolType===SuperMap.Plot.SymbolType.ANNOFRAMESYMBOL&&this.ownerGroup&&(this.ownerGroup.symbolType===SuperMap.Plot.SymbolType.NAVYDEPLOYMENT||this.ownerGroup.symbolType===SuperMap.Plot.SymbolType.AIRDEPLOYMENT))for(var e in this.ownerGroup.subObjects)this.ownerGroup.subObjects[e].redraw();this.symbolType===SuperMap.Plot.SymbolType.TEXTSYMBOL&&this.isSelected&&"none"!==this.style.display&&this.fire(SuperMap.Plot.Event.reseteditmarkersvalues)},setScale:function(){},setRotate:function(){},setTextPosition:function(){},convertGraphicObjects:function(){},setTextContent:function(t){this.textContent=t,this.redraw(),this.symbolType===SuperMap.Plot.SymbolType.TEXTSYMBOL&&this.isSelected&&this.fire(SuperMap.Plot.Event.reseteditmarkersvalues)},getLocked:function(){return this.isLocked},setLocked:function(t){if(this.isLocked!==t){if(this.isLocked=t,this.symbolType===SuperMap.Plot.SymbolType.GROUPOBJECT)for(var e=0;e<this.components.length;e++)this.components[e].isLocked=t;this.fire(SuperMap.Plot.Event.reseteditmarkers)}},getScale:function(){return this.dScale},getScaleValues:function(){return this.scaleValues},setScaleValues:function(t){t&&null!==t&&(L.Util.isArray(t)||(t=[t]),this.scaleValues=t,this._calculateParts(),this.fire(SuperMap.Plot.Event.reseteditmarkers))},getRotate:function(){return this.dRotate},getSubSymbols:function(){return 0===this.libID&&this.code===SuperMap.Plot.SymbolType.NODECHAIN&&0===this.subSymbols.length?this.subSymbols.push(new SuperMap.Plot.SubSymbol(-1,-1)):(100!==this.libID||25200!==this.code&&3020901!==this.code&&23400!==this.code&&30800!==this.code&&26400!==this.code||0!==this.subSymbols.length)&&(123!==this.libID||5030101!==this.code&&5020801!==this.code&&50208!==this.code&&50331!==this.code||0!==this.subSymbols.length)||this.subSymbols.push(new SuperMap.Plot.SubSymbol(-1,-1)),this.subSymbols},getTextPosition:function(){return this.annotationPosition},getTextContent:function(){return this.textContent},getExtendProperty:function(){return this.extendProperty},addAvoidRegion:function(t){t.symbolType===SuperMap.Plot.SymbolType.AVOIDREGION&&(this.avoidRegions.push(t),t.associatedUuid=this.uuid,this.redraw())},removeAvoidRegions:function(t){void 0===t&&(t=this.avoidRegions.slice()),SuperMap.Util.isArray(t)||(t=[t]);for(var e=0;e<t.length;e++){var o=t[e];if(o.symbolType===SuperMap.Plot.SymbolType.AVOIDREGION)for(var i=0;i<this.avoidRegions.length;i++)if(this.avoidRegions[i]===o){this.avoidRegions.splice(i,1);break}}this.redraw(),this.fire(SuperMap.Plot.Event.reseteditmarkersvalues)},getSymbolData:function(){return SuperMap.Plot.AnalysisSymbol.setSymbolData(this,this.symbolData,!0),this.symbolData},redraw:function(){null!=this.graphic&&null!=this.graphic.layer&&!0===this.graphic.layer.getVisibility()?this.graphic.redraw():null!=this.layer&&(this._clearComponents(),null!=this.layer.getVisibility&&!0!==this.layer.getVisibility()||(this._redrawComponents(),this.fire(SuperMap.Plot.Event.reseteditmarkersvalues)))},_redrawComponents:function(){"none"===this.style.display||null!=this.layer&&"function"==typeof this.layer.getVisibility&&!1===this.layer.getVisibility()?this.symbolType!==SuperMap.Plot.SymbolType.DOTSYMBOL&&this.symbolType!==SuperMap.Plot.SymbolType.AlgoSymbol&&0!==this.libID||this._updateSymbolTexts():(this._calculateParts(),this._calculateAvoidRegions())},_calculateAvoidRegions:function(){if(0!==this.avoidRegions.length){for(var t=this.components.slice(),e=0;e<this.components.length;e++)this.components[e].removeEventParent(this),this.components[e]instanceof a||(this.components[e].onRemove(),delete this.components[e]);this.components.length=0;for(var o=0;o<this.avoidRegions.length;o++)if(0!==this.avoidRegions[o].getLatLngs().length){var i=this.avoidRegions[o];t=this._layersWithoutAvoidRegion(i,t)}for(var l=0;l<t.length;l++)this._addComponents(t[l])}},_layersWithoutAvoidRegion:function(t,e){for(var o=[],i=0;i<e.length;i++){var n=e[i];if(n instanceof a)o=o.concat(this._layersWithoutAvoidRegion(t,n.components)),n._clearComponents();else{if(1===t._relationToLayer(n))continue;if(n instanceof l.Text||0!==t._relationToLayer(n))o.push(n);else if(n instanceof L.Polygon){var s={};s=SuperMap.Util.copyAttributes(s,n.options);var r=L.Util.latLngsToSuperMapPoints(n.getLatLngs()[0][0]),u=L.Util.latLngsToSuperMapPoints(n.getLatLngs()[0][n.getLatLngs()[0].length-1]);SuperMap.Plot.PlottingUtil.isSamePt(r[0],u[0])||n.getLatLngs()[0].push(n.getLatLngs()[0][0]),r=L.Util.latLngsToSuperMapPoints(n.getLatLngs()[0][0]),u=L.Util.latLngsToSuperMapPoints(n.getLatLngs()[0][n.getLatLngs()[0].length-1]),SuperMap.Plot.PlottingUtil.isSamePt(r[0],u[0])||n.getLatLngs()[0].push(n.getLatLngs()[0][0]);for(var p=0;p<n.getLatLngs().length;p++)for(var h=t._getWithoutPts(n.getLatLngs()[p],!0),c=0;c<h.length;c++){var g=L.polyline(L.Util.superMapPointsToLatLngs(h[c]),s);o.push(g)}}else if(n instanceof L.Polyline){var y={};y=SuperMap.Util.copyAttributes(y,n.options);for(var f=t._getWithoutPts(n.getLatLngs(),!1),P=0;P<f.length;P++){y.fill=!1;var d=L.polyline(L.Util.superMapPointsToLatLngs(f[P]),y);o.push(d)}}}}return o},_isDot:function(){return this.symbolType===SuperMap.Plot.SymbolType.DOTSYMBOL||this.symbolType===SuperMap.Plot.SymbolType.GROUPOBJECT||this.symbolType===SuperMap.Plot.SymbolType.FLAGGROUP||this.symbolType===SuperMap.Plot.SymbolType.ROUTENODE||this.symbolType===SuperMap.Plot.SymbolType.AIRDEPLOYMENT||this.symbolType===SuperMap.Plot.SymbolType.NAVYDEPLOYMENT},_resizeOffset:function(t,e,o){var i=L.latLng(0,0);switch(e){case 1:i.lng=t.lng-o.getWest(),i.lat=t.lat-o.getNorth();break;case 3:i.lng=t.lng-o.getEast(),i.lat=t.lat-o.getNorth();break;case 6:i.lng=t.lng-o.getWest(),i.lat=t.lat-o.getSouth();break;case 8:i.lng=t.lng-o.getEast(),i.lat=t.lat-o.getSouth();break;case 2:i.lng=0,i.lat=t.lat-o.getNorth();break;case 4:i.lng=t.lng-o.getWest(),i.lat=0;break;case 5:i.lng=t.lng-o.getEast(),i.lat=0;break;case 7:i.lng=0,i.lat=t.lat-o.getSouth()}return i},_resizeBounds:function(t,e,o){var i=o.getWest(),l=o.getEast(),n=o.getNorth(),a=o.getSouth();switch(e){case 1:n=t.lat,i=t.lng;break;case 3:n=t.lat,l=t.lng;break;case 6:i=t.lng,a=t.lat;break;case 8:l=t.lng,a=t.lat;break;case 2:n=t.lat;break;case 4:i=t.lng;break;case 5:l=t.lng;break;case 7:a=t.lat}var s=new L.LatLngBounds;return s._southWest=L.latLng(a,i),s._northEast=L.latLng(n,l),s},_getHandleCount:function(){switch(this.symbolType){case SuperMap.Plot.SymbolType.ELLIPSESYMBOL:case SuperMap.Plot.SymbolType.CIRCLESYMBOL:case SuperMap.Plot.SymbolType.NEWARCSYMBOL:case SuperMap.Plot.SymbolType.NEWCHORDSYMBOL:case SuperMap.Plot.SymbolType.NEWPIESYMBOL:case SuperMap.Plot.SymbolType.ARCSYMBOL:case SuperMap.Plot.SymbolType.CHORDSYMBOL:case SuperMap.Plot.SymbolType.PIESYMBOL:case SuperMap.Plot.SymbolType.AVOIDREGION:case SuperMap.Plot.SymbolType.LINERELATION:case SuperMap.Plot.SymbolType.SYMBOLTEXT:case SuperMap.Plot.SymbolType.SYMBOLTEXT1:return this.getLatLngs().length+9;default:return 9}},_getHandlePointsByBounds:function(t){if(void 0!==t&&null!==t||(t=this.getBounds()),null!==t){var e=this._map.latLngToLayerPoint(L.latLng(t.getNorth(),t.getEast()));e.x+=5,e.y-=5;var o=this._map.latLngToLayerPoint(L.latLng(t.getNorth(),t.getWest()));o.x-=5,o.y-=5;var i=this._map.latLngToLayerPoint(L.latLng(t.getSouth(),t.getEast()));i.x+=5,i.y+=5;var l=this._map.latLngToLayerPoint(L.latLng(t.getSouth(),t.getWest()));l.x-=5,l.y+=5;for(var n=L.point((e.x+o.x)/2,e.y),a=L.point(e.x,(e.y+i.y)/2),s=L.point((i.x+l.x)/2,i.y),r=L.point(o.x,(o.y+l.y)/2),u=this._map.layerPointToLatLng(e),p=this._map.layerPointToLatLng(o),h=this._map.layerPointToLatLng(i),c=this._map.layerPointToLatLng(l),g=this._map.layerPointToLatLng(a),y=this._map.layerPointToLatLng(s),f=this._map.layerPointToLatLng(r),P=this._map.layerPointToLatLng(n),d=[p.clone(),P.clone(),u.clone(),f.clone(),g.clone(),c.clone(),y.clone(),h.clone()],S=1,m=0;m<d.length;m++)d[m].nHandle=S++;return d}},_getHandleAndRotatePoints:function(){var t={handlePoints:[],rotatePoints:[]},e=this.getBounds();if(!e.isValid())return t;if(this._getHandleCount()>9){if(this.symbolType===SuperMap.Plot.SymbolType.REGULARPOLYGON)t.handlePoints.push(this.getLatLngs()[0].clone()),t.handlePoints.push(this.getLatLngs()[this.getLatLngs().length-1].clone());else if(t.handlePoints=L.Util.cloneLatLngs(this.getLatLngs()),3801===this.code||4401===this.code||3701===this.code){var o=this.components[0]._latlngs;o.length>1?t.handlePoints[2]=o[1]:t.handlePoints[2]=o[0][1]}}else t.handlePoints=this._getHandlePointsByBounds(e);for(var i=0;i<t.handlePoints.length;i++)t.handlePoints[i].tag=i;if(!0===this.getLocked())return t;var l=15;if(L.Browser.touch&&L.supermap.plotting.getControl().getTouchMode()&&(l=20),this.symbolType!==SuperMap.Plot.SymbolType.ANNOFRAMESYMBOL&&this.symbolType!==SuperMap.Plot.SymbolType.LINERELATION&&this.symbolType!==SuperMap.Plot.SymbolType.SYMBOLTEXT&&this.symbolType!==SuperMap.Plot.SymbolType.SYMBOLTEXT1&&this.symbolType!==SuperMap.Plot.SymbolType.SYMBOLTEXTBOX&&this.symbolType!==SuperMap.Plot.SymbolType.LINEMARKING&&this.symbolType!==SuperMap.Plot.SymbolType.ANNOFRAMESYMBOLM&&this.symbolType!==SuperMap.Plot.SymbolType.ROUTENODE&&this.symbolType!==SuperMap.Plot.SymbolType.LITERATESIGN&&this.symbolType!==SuperMap.Plot.SymbolType.SATELLITE&&this.symbolType!==SuperMap.Plot.SymbolType.SATELLITETIMEWINDOWS&&this.symbolType!==SuperMap.Plot.SymbolType.AVOIDREGION&&this.symbolType!==SuperMap.Plot.SymbolType.NAVYDEPLOYMENT&&this.symbolType!==SuperMap.Plot.SymbolType.RECTANGLESYMBOL&&this.symbolType!==SuperMap.Plot.SymbolType.AIRDEPLOYMENT){var n=this._map.latLngToLayerPoint(L.latLng(e.getNorth(),e.getEast())),a=L.point(n.x+l,n.y-l),s=this._map.layerPointToLatLng(a);s.isRotatePoint=!0,t.rotatePoints=[s]}return t},_parseSymbolData:function(){if(null!==this.symbolData){if(this.libID=parseInt(this.symbolData.libID),this.code=parseInt(this.symbolData.code),this.symbolType=this.symbolData.symbolType,this.symbolName=this.symbolData.symbolName,this.textContent=this.symbolData.textContent,void 0!==this.symbolData.dScale?this.dScale=this.symbolData.dScale:this.dScale=this.symbolData.scale2D.x,void 0!==this.symbolData.dRotate?this.dRotate=this.symbolData.dRotate:this.dRotate=this.symbolData.rotate2D.x,void 0!==this.symbolData.uuid&&(this.uuid=this.symbolData.uuid),void 0!==this.symbolData.associatedUuid&&(this.associatedUuid=this.symbolData.associatedUuid),void 0!==this.symbolData.annotationPosition&&(this.annotationPosition=this.symbolData.annotationPosition),void 0!==this.symbolData.isLocked&&(this.isLocked=this.symbolData.isLocked),void 0!==this.symbolData.note&&(this.note=this.symbolData.note),void 0!==this.symbolData.custom&&(this.custom=this.symbolData.custom),this.symbolData.extendProperty)for(var t=0;t<this.symbolData.extendProperty.length;t++){var e=this.symbolData.extendProperty[t];this.extendProperty.addProperty(e.key,e.value)}if(this.symbolData.hasOwnProperty("subSymbols")&&this.symbolData.subSymbols&&0!==this.symbolData.subSymbols.length){this.subSymbols=[];for(var o=0;o<this.symbolData.subSymbols.length;o++){var i=this.symbolData.subSymbols[o].libID;void 0===i&&(i=this.libID);var l=this.symbolData.subSymbols[o].code;if(void 0!==l){var n={};void 0!==this.symbolData.subSymbols[o]&&(n.symbolData=this.symbolData.subSymbols[o].symbolData),void 0!==this.symbolData.subSymbols[o].textContent&&(n.textContent=this.symbolData.subSymbols[o].textContent),void 0!==this.symbolData.subSymbols[o].totalNum&&(n.totalNum=this.symbolData.subSymbols[o].totalNum),this.subSymbols.push(new SuperMap.Plot.SubSymbol(i,l,n))}}}if(this.symbolData.avoidRegions&&0!==this.symbolData.avoidRegions.length)for(var a=0;a<this.symbolData.avoidRegions.length;a++){var s={libID:0,code:SuperMap.Plot.SymbolType.AVOIDREGION,map:this._map,symbolData:this.symbolData.avoidRegions[a][0]},r=L.supermap.plotting.avoidRegion(0,SuperMap.Plot.SymbolType.AVOIDREGION,[],s);r.style=SuperMap.Plot.AnalysisSymbol.getStyle(this.symbolData.avoidRegions[a][1],!0),this.avoidRegions.push(r)}}},_setSymbolData:function(t){if(void 0===t&&(t=!0),null===this.symbolData&&(this.symbolData={}),this.symbolData.hasOwnProperty("type")||(this.symbolData.type="GRAPHICOBJECT"),this.symbolData.hasOwnProperty("rotate2D")?this.symbolData.rotate2D.x=this.dRotate:this.symbolData.rotate2D={x:this.dRotate,y:0,z:0},this.symbolData.hasOwnProperty("scale2D")?this.symbolData.scale2D.x=this.dScale:this.symbolData.scale2D={x:this.dScale,y:0,z:0},this.symbolData.libID=this.libID,this.symbolData.code=this.code,this.symbolData.isEdit=!0,this.symbolData.uuid=this.uuid,this.symbolData.symbolType=this.symbolType,this.symbolData.symbolName=this.symbolName,this.symbolData.associatedUuid=this.associatedUuid,this.symbolData.annotationPosition=this.annotationPosition,this.symbolData.textContent=this.textContent,this.symbolData.isLocked=this.isLocked,this.symbolData.note=this.note,this.symbolData.custom=this.custom,this.symbolType!==SuperMap.Plot.SymbolType.DOTSYMBOL&&this.symbolType!==SuperMap.Plot.SymbolType.GROUPOBJECT){this.symbolData.subSymbols=[];for(var e=0;e<this.getSubSymbols().length;e++){var o=this.getSubSymbols()[e];t?this.symbolData.subSymbols.push({libID:o.libID,code:o.code,symbolData:o.symbolData,textContent:o.textContent,totalNum:o.totalNum}):this.symbolData.subSymbols.push({libID:o.libID,code:o.code,textContent:o.textContent,totalNum:o.totalNum})}}this.symbolData.extendProperty=[];for(var i=this.getExtendProperty().getPropertyCount(),l=0;l<i;l++){var n=this.getExtendProperty().getPropertyByIndex(l);this.symbolData.extendProperty.push({key:n.key,value:n.value})}this.symbolData.avoidRegions=[];for(var a=0;a<this.avoidRegions.length;a++){var s={};SuperMap.Plot.AnalysisSymbol.setStyle(this.avoidRegions[a].style,s,!0),this.symbolData.avoidRegions.push([this.avoidRegions[a].getSymbolData(),s])}},_getSymbolWayType:function(){return 22===this.libID&&1016===this.code?0===this.getArrowBodyType()?SuperMap.Plot.AddPoint_WayType.POLYLINE:SuperMap.Plot.AddPoint_WayType.CURVE:SuperMap.Plot.AlgoSymbolFactory.getSymbolWayType(this.libID,this.code)},_reView:function(){},_mergeDefaultStyle:function(){var t=L.supermap.plotting.getControl(this._map,this.serverUrl).getDefaultStyle();if(t&&!0===t.defaultFlag&&!1===this.isEdit){if(this.symbolType===SuperMap.Plot.SymbolType.DOTSYMBOL){if(-1!==t.dotSymbolSize){var e=this.symbolSizeInLib.w;if(this.symbolSizeInLib.h>this.symbolSizeInLib.w&&(e=this.symbolSizeInLib.h),0===e||0===t.dotSymbolSize)0!==this.symbolSize.w&&0!==this.symbolSize.h||(this.symbolSize.w=this.symbolSizeInLib.w,this.symbolSize.h=this.symbolSizeInLib.h);else{var o=t.dotSymbolSize/e;this.symbolSize.w=o*this.symbolSizeInLib.w,this.symbolSize.h=o*this.symbolSizeInLib.h}}-1!==t.dotTextSpace&&(this.space=t.dotTextSpace),-1!==t.flagTextSize&&(this.flagTextSize=t.flagTextSize)}this.symbolType!==SuperMap.Plot.SymbolType.DOTSYMBOL&&this.symbolType!==SuperMap.Plot.SymbolType.ALGOSYMBOL||(-1!==t.maxScale&&(this.maxScale=t.maxScale),-1!==t.minScale&&(this.minScale=t.minScale)),-1!==t.scaleByMap&&(this.scaleByMap=t.scaleByMap)}},_removeRedundancySymbolData:function(t){null!==t&&(t.hasOwnProperty("center")&&delete t.center,t.hasOwnProperty("id")&&delete t.id,t.hasOwnProperty("parts")&&delete t.parts,t.hasOwnProperty("points")&&delete t.points,t.hasOwnProperty("position")&&delete t.position,t.hasOwnProperty("prjCoordSys")&&delete t.prjCoordSys,t.hasOwnProperty("rotationX")&&delete t.rotationX,t.hasOwnProperty("rotationY")&&delete t.rotationY,t.hasOwnProperty("rotationZ")&&delete t.rotationZ,t.hasOwnProperty("scaleX")&&delete t.scaleX,t.hasOwnProperty("scaleY")&&delete t.scaleY,t.hasOwnProperty("scaleZ")&&delete t.scaleZ)},destroy:function(){this.layer.removeFeatures(this)},toGeoJsonStr:function(){return this.getSymbolData(),SuperMap.Plot.PlottingUtil.toJSON(this.symbolData)}});L.supermap.plotting.PlottingObject=a,a.prototype._containsPoint=function(t){if(this.symbolType!==SuperMap.Plot.SymbolType.TEXTSYMBOL)return!1;for(var e in this.components)if(this.components[e]._containsPoint(t))return!0;return!1},L.supermap.plotting.PlottingObject.createSymbol=function(t,e,o,i,l,n){i||(i={}),i.custom=n;var a=null;if(i&&i.symbolData&&i.symbolData.textStyle2D&&void 0===i.symbolData.textStyle2D.sizeFixed&&(i.symbolData.textStyle2D.sizeFixed=!0),null==o||SuperMap.Util.isArray(o)||(o=[o]),0===t)switch(e){case SuperMap.Plot.SymbolType.ARCREGION:a=L.supermap.plotting.arcRegion(t,e,o,i);break;case SuperMap.Plot.SymbolType.MISSILEROUTE:a=L.supermap.plotting.missileRoute(t,e,o,i);break;case SuperMap.Plot.SymbolType.NAVYROUTE:a=L.supermap.plotting.navyRoute(t,e,o,i);break;case SuperMap.Plot.SymbolType.AIRROUTE:a=L.supermap.plotting.airRoute(t,e,o,i);break;case SuperMap.Plot.SymbolType.LITERATESIGN:a=L.supermap.plotting.literateSign(t,e,o,i);break;case SuperMap.Plot.SymbolType.ROUTENODE:a=L.supermap.plotting.routeNode(t,e,o,i);break;case SuperMap.Plot.SymbolType.PATHTEXT:a=L.supermap.plotting.pathText(t,e,o,i);break;case SuperMap.Plot.SymbolType.LINERELATION:a=L.supermap.plotting.lineRelation(t,e,o,i);break;case SuperMap.Plot.SymbolType.GROUPOBJECT:a=L.supermap.plotting.groupObject(t,e,o,i);break;case SuperMap.Plot.SymbolType.INTERFERENCEBEAM:a=L.supermap.plotting.interferenceBeam(t,e,o,i);break;case SuperMap.Plot.SymbolType.SATELLITE:a=L.supermap.plotting.satellite(t,e,o,i);break;case SuperMap.Plot.SymbolType.SATELLITETIMEWINDOWS:a=L.supermap.plotting.satelliteTimeWindows(t,e,o,i);break;case SuperMap.Plot.SymbolType.SYMBOLTEXT:a=L.supermap.plotting.symbolText(t,e,o,i);break;case SuperMap.Plot.SymbolType.SYMBOLTEXT1:a=L.supermap.plotting.symbolText1(t,e,o,i);break;case SuperMap.Plot.SymbolType.FLAGGROUP:a=L.supermap.plotting.flagGroup(t,e,o,i);break;case SuperMap.Plot.SymbolType.NAVYDEPLOYMENT:a=L.supermap.plotting.navyDeployment(t,e,o,i);break;case SuperMap.Plot.SymbolType.AIRDEPLOYMENT:a=L.supermap.plotting.airDeployment(t,e,o,i);break;case SuperMap.Plot.SymbolType.AVOIDREGION:return L.supermap.plotting.avoidRegion(t,e,o,i);case SuperMap.Plot.SymbolType.PICTURE:a=L.supermap.plotting.picture(t,e,o,i);break;default:a=L.supermap.plotting.algoSymbol(t,e,o,i)}else a=i.symbolData&&i.symbolData.symbolType===SuperMap.Plot.SymbolType.DOTSYMBOL?L.supermap.plotting.dotSymbol(t,e,o,i):L.supermap.plotting.algoSymbol(t,e,o,i);var s=L.supermap.plotting.getControl().getDefaultStyle();return SuperMap.Plot.AnalysisSymbol.mergeDefaultStyleToFeature(a,s,!0),l&&SuperMap.Util.extend(a.style,l),null!=o&&o.length>0&&(o.length>a.maxEditPts&&(o=o.slice(0,a.maxEditPts)),a.latLngs=L.Util.cloneLatLngs(o)),a}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.groupObject=e.GroupObject=void 0,o(0);var i=o(5),l=o(10),n=e.GroupObject=i.PlottingObject.extend({subObjects:[],initialize:function(t,e,o,l){this.subObjects=[],this.symbolName="组合对象",this.libID=0,this.code=SuperMap.Plot.SymbolType.GROUPOBJECT,this.symbolType=SuperMap.Plot.SymbolType.GROUPOBJECT,i.PlottingObject.prototype.initialize.call(this,t,e,o,l)},_addComponents:function(t){i.PlottingObject.prototype._addComponents.call(this,t),t.layer=this.layer,t.isEdit=!0,l.PlottingObjectDrag&&(t.dragging||(t.dragging=new l.PlottingObjectDrag(t))),null===t.fromZoom&&(t.fromZoom=this._map.getZoom()),this._map&&this._map.getPlotEditControl()&&t.enableEdit&&this._map.getPlotEditControl().enableEditFeatures(t)},_clearComponents:function(){this._map&&this._map.getPlotEditControl()&&this._map.getPlotEditControl().disableEditFeatures(this.components),i.PlottingObject.prototype._clearComponents.call(this)},_reView:function(){for(var t in this.components)this.components[t]._reView();this.fire(SuperMap.Plot.Event.reseteditmarkersvalues)},move:function(t,e){for(var o in this.subObjects)this.subObjects[o].move(t,e);this.fire(SuperMap.Plot.Event.reseteditmarkersvalues)},redraw:function(){if("none"===this.style.display||null!=this.layer&&"function"==typeof this.layer.getVisibility&&!1===this.layer.getVisibility())this._clearComponents();else if(0!==this.subObjects.length&&0===this.components.length)for(var t=0,e=this.subObjects.length;t<e;t++)void 0!==this.subObjects[t].layer&&this.subObjects[t].layer.removeFeatures(this.subObjects[t]),this.subObjects[t].ownerGroup=this,this.subObjects[t].enableEdit=!0,this._addComponents(this.subObjects[t])},setRotate:function(t){null===this.anchorPoint&&(this.anchorPoint=this.getBounds().getCenter()),this._rotate(t,this.anchorPoint),this.dRotate=t,this.fire(SuperMap.Plot.Event.reseteditmarkersvalues)},setScale:function(t){null===this.anchorPoint&&(this.anchorPoint=this.getBounds().getCenter()),this._resize(t/this.dScale,this.anchorPoint),this.dScale=t,this.fire(SuperMap.Plot.Event.reseteditmarkersvalues)},_unGroupObject:function(){var t=null;if(0!==this.subObjects.length){t=this.subObjects.slice(),this._clearComponents();for(var e=0,o=t.length;e<o;e++)this.layer.addFeatures(t[e]),t[e].ownerGroup=null}return t},removeComponents:function(t){SuperMap.Util.isArray(t)||(t=[t]);for(var e=[],o=0;o<t.length;o++){this.subObjects.splice(SuperMap.Util.indexOf(this.subObjects,t[o]),1);var i=SuperMap.Util.indexOf(this.components,t[o]);-1!==i&&(this.components[i]._clearComponents(),this.components.splice(i,1)),e.push(t[o])}for(var l=0;l<e.length;l++)e[l].addTo(this._map),e[l].ownerGroup=null;return e},setStyle:function(t){for(var e in SuperMap.Util.extend(this.style,t),this.components)this.components[e].symbolType===SuperMap.Plot.SymbolType.TEXTSYMBOL&&(t.labelAlign=this.components[e].style.labelAlign),this.components[e].setStyle(t)},_parseSymbolData:function(){if(null!==this.symbolData&&(i.PlottingObject.prototype._parseSymbolData.call(this),this.symbolData&&this.symbolData.subFeatures)){for(var t=[],e=0;e<this.symbolData.subFeatures.length;e++){var o=this.symbolData.subFeatures[e];o.uuid=SuperMap.Plot.PlottingUtil.generateUuid();var l=L.supermap.plotting.PlottingObject.createSymbol(o.libID,o.code,null,{symbolData:o});t.push(l)}this.subObjects=t}},_setSymbolData:function(){if(i.PlottingObject.prototype._setSymbolData.call(this),this.symbolData){this.symbolData.subFeatures=[];for(var t=0;t<this.subObjects.length;t++)this.symbolData.subFeatures.push(this.subObjects[t].getSymbolData())}},_rotate:function(t,e){for(var o=0;o<this.components.length;o++)this.components[o]._rotate(t,e)},_resize:function(t,e){for(var o=0;o<this.components.length;o++)this.components[o]instanceof n?this.components[o]._resize(t,e):0!==this.components[o].avoidRegions.length?(this.components[o]._resize(t,this.anchorPoint),this.components[o].redraw()):this.components[o]._resize(t,this.anchorPoint)},destroy:function(){i.PlottingObject.prototype.destroy.call(this),this.subObjects=[]}}),a=e.groupObject=function(t,e,o,i){return new n(t,e,o,i)};L.supermap.plotting.groupObject=a,L.supermap.plotting.GroupObject=n},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.algoSymbol=e.AlgoSymbol=void 0,o(0);var i=o(1),l=o(2),n=e.AlgoSymbol=i.GraphicObject.extend({superMapAlgoSymbol:null,scalePoints:null,scaleValues:null,polylineConnectLocationPoint:!1,islocationCircle:!1,roundBox:!1,textBoxType:null,arrowHeadType:0,arrowBodyType:0,arrowTailType:0,initialize:function(t,e,o,l){if(this.scaleByMap=!0,this.scalePoints=[],this.scaleValues=[],this.symbolType=0===t?e:SuperMap.Plot.SymbolType.ALGOSYMBOL,i.GraphicObject.prototype.initialize.call(this,t,e,o,l),0===this.libID&&this.symbolType===SuperMap.Plot.SymbolType.ARROWLINE)null!==this.arrowTypeStart&&void 0!==this.arrowTypeStart&&(this.scaleValues[1]=this.arrowTypeStart,delete this.arrowTypeStart),null!==this.arrowTypeEnd&&void 0!==this.arrowTypeEnd&&(this.scaleValues[2]=this.arrowTypeEnd,delete this.arrowTypeEnd);else if(0===this.libID&&this.symbolType===SuperMap.Plot.SymbolType.COMBINATIONALCIRCLE){if(null!=this.radius&&this.radius.length>0){for(var n in this.radius)this.scaleValues[n]=this.radius[n];delete this.radius}}else 0===this.libID&&this.symbolType===SuperMap.Plot.SymbolType.CONCENTRICCIRCLE?(null!==this.startAngle&&void 0!==this.startAngle&&(this.scaleValues[0]=this.startAngle,delete this.startAngle),null!==this.endAngle&&void 0!==this.endAngle&&(this.scaleValues[1]=this.endAngle,delete this.endAngle)):0===this.libID&&this.symbolType===SuperMap.Plot.SymbolType.POLYGONREGION&&(this.annotationPosition>this.getLatLngs()?this.scaleValues[1]=0:null==this.scaleValues[1]&&(this.scaleValues[1]=this.annotationPosition));SuperMap.Plot.AlgoSymbolFactory.isAccessServer(this.libID,this.code)||(this.minEditPts=SuperMap.Plot.AlgoSymbolFactory.getMinEditPts(this.libID,this.code),this.maxEditPts=SuperMap.Plot.AlgoSymbolFactory.getMaxEditPts(this.libID,this.code),0===this.subSymbols.length&&(this.subSymbols=SuperMap.Plot.AlgoSymbolFactory.getDefaultSubSymbols(this.libID,this.code)),null!==this.style&&!1===this.isEdit&&(this.style=SuperMap.Plot.PlottingUtil.copyAttributes(this.style,SuperMap.Plot.AlgoSymbolFactory.getDefaultStyle(this.libID,this.code))),this.controlPoints=L.Util.latLngsToSuperMapPoints(this.latLngs),this.superMapAlgoSymbol=SuperMap.Plot.AlgoSymbolFactory.getAlgoSymbol(this),this.scaleValues=this.superMapAlgoSymbol.scaleValues,0!==this.libID||this.symbolType!==SuperMap.Plot.SymbolType.SYMBOLTEXTBOX&&this.symbolType!==SuperMap.Plot.SymbolType.LINEMARKING||(this.textBoxType=this.superMapAlgoSymbol.textBoxType),delete this.controlPoints),this._setBasicSymbolName(),!0===this._isSupportAddAnnotation()&&(this.style.sizeFixed=!1)},onAdd:function(t){this.superMapAlgoSymbol&&(this.superMapAlgoSymbol.map=t._map),i.GraphicObject.prototype.onAdd.call(this,t)},getTextContent:function(){return this.textContent},getArrowHeadType:function(){return this.arrowHeadType},setArrowHeadType:function(t){1016===this.code&&this.arrowHeadType!==t&&(this.arrowHeadType=t,this.redraw())},getArrowTailType:function(){return this.arrowTailType},setArrowTailType:function(t){1016===this.code&&this.arrowTailType!==t&&(this.arrowTailType=t,this.redraw())},getArrowBodyType:function(){return this.arrowBodyType},setArrowBodyType:function(t){1016===this.code&&this.arrowBodyType!==t&&(this.arrowBodyType=t,this.redraw())},setRotate:function(t){this.dRotate+=t,0!==this.textContent.length&&(void 0===this.style.labelRotation?this.style.labelRotation=-t:this.style.labelRotation+=-t),null===this.anchorPoint&&this.symbolType!==SuperMap.Plot.SymbolType.TEXTSYMBOL&&this.symbolType!==SuperMap.Plot.SymbolType.CONCENTRICCIRCLE?this.anchorPoint=this.getBounds().getCenter():null===this.anchorPoint&&(this.anchorPoint=L.latLng(this.latLngs[0].lat,this.latLngs[0].lng)),this._rotate(t,this.anchorPoint);for(var e=0,o=this.avoidRegions.length;e<o;e++)L.Util.rotateLatLngs(this.avoidRegions[e].getLatLngs(),this.anchorPoint,t)},getScaleByMap:function(){return this.scaleByMap},setScaleByMap:function(t){this.scaleByMap=t},setSurroundLineType:function(t){this.surroundLineType=t,this.redraw()},setSubSymbol:function(t,e,o){if(null!==o&&void 0!==o||(o=this.libID),e<this.subSymbols.length)this.subSymbols[e].libID=o,this.subSymbols[e].code=t;else{if(this.subSymbols.length!==e)return;this.subSymbols.push(new SuperMap.Plot.SubSymbol(o,t))}if(this.superMapAlgoSymbol){var i=new SuperMap.GetSymbolInfoParameters;i.libID=this.subSymbols[e].libID,i.code=this.subSymbols[e].code,L.supermap.symbolInfoService(this.serverUrl).getSymbolInfo(i,function(t){this.subSymbols[e].symbolData=t.result,this.redraw()},this)}else{var l=new SuperMap.GetSymbolInfoParameters;l.libID=this.libID,l.code=this.code,l.inputPoints=L.Util.latLngsToSuperMapPoints(this.getLatLngs()),l.subSymbols=this.subSymbols,L.supermap.symbolInfoService(this.serverUrl).getSymbolInfo(l,function(t){this.symbolData.innerCells=t.result.innerCells,this.redraw()},this)}},move:function(t,e){if(this.symbolType===SuperMap.Plot.SymbolType.SYMBOLTEXTBOX||this.symbolType===SuperMap.Plot.SymbolType.LINEMARKING||this.symbolType===SuperMap.Plot.SymbolType.ANNOFRAMESYMBOLM||this.symbolType===SuperMap.Plot.SymbolType.ANNOFRAMESYMBOL)L.Util.moveLatLngs(this.getLatLngs()[0],t,e),L.Util.moveLatLngs(this.getLatLngs()[1],t,e),this.setLatLngs(this.getLatLngs());else{if(i.GraphicObject.prototype._move.call(this,t,e),0!==this.scalePoints.length&&L.Util.moveLatLngs(this.scalePoints,t,e),null!==this.symbolData&&this.symbolData.innerCells)for(var o=0;o<this.symbolData.innerCells.length;o++)for(var l=0;l<this.symbolData.innerCells[o].positionPoints.length;l++)this.symbolData.innerCells[o].positionPoints[l].x+=e,this.symbolData.innerCells[o].positionPoints[l].y+=t;if(null!==this.symbolData&&this.symbolData.innerCells)for(var n=0;n<this.symbolData.scalePoints.length;n++)this.symbolData.scalePoints[n].x+=e,this.symbolData.scalePoints[n].y+=t}for(var a=0,s=this.avoidRegions.length;a<s;a++)L.Util.moveLatLngs(this.avoidRegions[a].getLatLngs(),t,e);this._updateSymbolTexts()},_parseSymbolData:function(){if(i.GraphicObject.prototype._parseSymbolData.call(this),null!==this.symbolData){if(void 0!==this.symbolData.subSymbolScaleValue&&null!==this.symbolData.subSymbolScaleValue&&(this.subSymbolScaleValue=this.symbolData.subSymbolScaleValue),void 0!==this.symbolData.strokeWidth&&null!==this.symbolData.strokeWidth&&(this.strokeWidth=this.symbolData.strokeWidth),void 0!==this.symbolData.constantSize&&null!==this.symbolData.constantSize&&(this.constantSize=this.symbolData.constantSize),void 0!==this.symbolData.baseScale&&null!==this.symbolData.baseScale&&(this.baseScale=this.symbolData.baseScale),this.symbolData.scaleValues&&0!==this.symbolData.scaleValues.length){this.scaleValues=[];for(var t=0;t<this.symbolData.scaleValues.length;t++)this.scaleValues.push(this.symbolData.scaleValues[t])}this.symbolData.hasOwnProperty("arrowTailType")&&(this.arrowTailType=this.symbolData.arrowTailType),this.symbolData.hasOwnProperty("arrowBodyType")&&(this.arrowBodyType=this.symbolData.arrowBodyType),this.symbolData.hasOwnProperty("arrowHeadType")&&(this.arrowHeadType=this.symbolData.arrowHeadType)}},_setSymbolData:function(t){if(i.GraphicObject.prototype._setSymbolData.call(this,t),null!==this.symbolData&&this.superMapAlgoSymbol){if(this.symbolData.subSymbolScaleValue=this.subSymbolScaleValue,this.symbolData.baseScale=this.baseScale,this.symbolData.strokeWidth=this.strokeWidth,this.symbolData.constantSize=this.constantSize,null!==this.annotationPosition&&void 0!==this.annotationPosition&&(this.symbolData.annotationPosition=this.annotationPosition),this.symbolData.hasOwnProperty("scaleValues")&&null!==this.symbolData.scaleValues)for(var e=0;e<this.scaleValues.length;e++)this.symbolData.scaleValues.length>e?this.symbolData.scaleValues[e]=this.scaleValues[e]:this.symbolData.scaleValues.push(this.scaleValues[e]);else this.symbolData.scaleValues=[],this.symbolData.scaleValues=this.scaleValues;1016===this.code&&(this.symbolData.arrowTailType=this.arrowTailType,this.symbolData.arrowBodyType=this.arrowBodyType,this.symbolData.arrowHeadType=this.arrowHeadType)}},_calculateParts:function(){"none"===this.style.display||null!=this.layer&&"function"==typeof this.layer.getVisibility&&!1===this.layer.getVisibility()||(this.textContent&&""!==this.textContent&&"???"!==this.textContent||this.symbolType!==SuperMap.Plot.SymbolType.TEXTSYMBOL||(this.textContent="请输入文本"),0!==this.textContent.length&&this.dRotate!==this.style.labelRotation&&(this.style.labelRotation=-this.dRotate),this.superMapAlgoSymbol&&0!==this.getLatLngs().length?(this.superMapCalculateParts(),this._setBasicSymbolText()):!this.superMapAlgoSymbol&&this.getLatLngs().length>=this.minEditPts&&(this._calAccessServerSymbol(),this._setBasicSymbolText()))},_calAccessServerSymbol:function(){for(var t=SuperMap.Plot.AnalysisSymbol.analysisSymbolCells(this.symbolData,!0),e=0;e<t.length;e++)t[e].type===SuperMap.Plot.SymbolType.TEXTSYMBOL&&(t[e].style.fontSize*=2);this._transSymbolCellsToLayers(t),this._analysisAlgoBasicInfo(!1),0!==this.symbolData.subSymbols.length&&this.subSymbols.length!==this.symbolData.subSymbols.length&&this._analysisAlgoBasicInfo(!0)},_analysisAlgoBasicInfo:function(t){if(this.symbolData.scaleValues&&0!==this.symbolData.scaleValues.length){this.scaleValues=[];for(var e=0;e<this.symbolData.scaleValues.length;e++)this.scaleValues.push(this.symbolData.scaleValues[e])}if(t&&this.symbolData.subSymbols){this.subSymbols=[];for(var o=0;o<this.symbolData.subSymbols.length;o++)this.subSymbols.push(new SuperMap.Plot.SubSymbol(this.symbolData.libID,this.symbolData.subSymbols[o]))}if(this.symbolData.scalePoints&&0!==this.symbolData.scalePoints.length){this.scalePoints=[];for(var i=0;i<this.symbolData.scalePoints.length;i++)this.scalePoints.push(L.latLng(this.symbolData.scalePoints[i].y,this.symbolData.scalePoints[i].x))}},_modifyPoint:function(t,e){(e=new SuperMapAlgoPlot.Point(e.lng,e.lat)).isScalePoint=!0,this._clearComponents(),this.superMapModifyPoint(t,e),this._calculateAvoidRegions()},_reView:function(){if(void 0!==this.prevStrokeWidth&&this.prevStrokeWidth!==this.style.weight&&(this.strokeWidth=this.style.weight),this.fromZoom!==this._map.getZoom()){var t=this.getBounds();if(!0===this.isEdit&&t.isValid()){var e=this._map.getZoomScale(this._map.getZoom(),this.fromZoom);if(this.dScale*=e,void 0!==this.strokeWidth&&null!==this.strokeWidth||(this.strokeWidth=this.style.weight),void 0===this.baseScale){var o=Math.abs(t.getEast()-t.getWest()),i=Math.abs(t.getNorth()-t.getSouth());o<i&&(o=i);var n=this.strokeWidth/.5*5,a=this._map.layerPointToLatLng(L.point(0,0)),s=this._map.layerPointToLatLng(L.point(n,0)),r=Math.sqrt((a.lat-s.lat)*(a.lat-s.lat)+(a.lng-s.lng)*(a.lng-s.lng));this.baseScale=r/o}if(this.dScale<=this.baseScale){this.scaleStrokeWidth=!0;var u=this.strokeWidth/.5*5,p=this.dScale*u/this.baseScale;this.style.weight=Math.round(p/10),this.style.weight>=this.strokeWidth&&(this.style.weight=this.strokeWidth),this.style.weight<=.5&&(this.style.weight=.5)}else!0===this.scaleStrokeWidth&&(this.style.weight=this.strokeWidth,this.scaleStrokeWidth=!1),this.strokeWidth=this.style.weight;if(this.prevStrokeWidth=this.style.weight,(34===this.symbolType||!0===this._isSupportAddAnnotation())&&!1===this.style.sizeFixed||34!==this.symbolType&&!1===this._isSupportAddAnnotation())for(var h in this.textContent.length>0&&(this.style.fontSize*=e),this.components)this.components[h]instanceof l.Text&&(this.components[h].options.fontSize*=e);22!==this.libID||1012!==this.code&&1013!==this.code&&1014!==this.code&&1015!==this.code||this.dScale>=1&&this.redraw(),this.layer._map.getRenderer(this.layer)instanceof L.Canvas&&this._updateCanvasFills(),this._updateSymbolTexts(),this.fire(SuperMap.Plot.Event.reseteditmarkersvalues)}this.fromZoom=this._map.getZoom(),(1===this.surroundLineType||2===this.surroundLineType||SuperMap.Plot.AlgoSymbolFactory.zoomCalSymbol(this.libID,this.code))&&this.redraw(),this.symbolType===SuperMap.Plot.SymbolType.TEXTSYMBOL&&this.isSelected&&this._map.getPlotEditControl()&&this._map.getPlotEditControl().fire(SuperMap.Plot.Event.featuresmodified,{features:[this]})}},_rotate:function(t,e){if(this.symbolType===SuperMap.Plot.SymbolType.TEXTSYMBOL)for(var o in this.components)this.components[o].options.labelRotation=this.style.labelRotation,this.components[o].redraw();if(L.Util.rotateLatLngs(this.getLatLngs(),e,t),L.Util.rotateLatLngs(this.scalePoints,e,t),this.symbolType!==SuperMap.Plot.SymbolType.CONCENTRICCIRCLE||SuperMap.Plot.PlottingUtil.equalFuzzy(Math.abs(this.scaleValues[0]-this.scaleValues[1]),360)||(this.scaleValues[0]+=t,this.scaleValues[1]+=t),SuperMap.Plot.AlgoSymbolFactory.isAccessServer(this.libID,this.code)){var i=new SuperMap.GetSymbolInfoParameters;i.libID=this.libID,i.code=this.code,i.inputPoints=L.Util.latLngsToSuperMapPoints(this.getLatLngs()),i.scaleValues=this.scaleValues,i.subSymbols=this.subSymbols,L.supermap.symbolInfoService(this.serverUrl).getSymbolInfo(i,function(t){this.symbolData.innerCells=t.result.innerCells,this.symbolData.scalePoints=t.result.scalePoints,this.symbolData.scaleValues=t.result.scaleValues,this.redraw(),this._updateSymbolTexts()},this)}else this.superMapAlgoSymbol;this.redraw(),this._updateSymbolTexts()},_resize:function(t,e){i.GraphicObject.prototype._resize.call(this,t,e);var o=new SuperMapAlgoPlot.Point(e.lng,e.lat);if(this.superMapAlgoSymbol){for(var l=0;l<this.superMapAlgoSymbol.controlPoints.length;l++)SuperMap.Plot.PlottingUtil.resize(o,t,this.superMapAlgoSymbol.controlPoints[l]);for(var n=0;n<this.superMapAlgoSymbol.scalePoints.length;n++)SuperMap.Plot.PlottingUtil.resize(o,t,this.superMapAlgoSymbol.scalePoints[n])}else{for(var a=0;a<this.symbolData.innerCells.length;a++)for(var s=0;s<this.symbolData.innerCells[a].positionPoints.length;s++){var r=new SuperMapAlgoPlot.Point(this.symbolData.innerCells[a].positionPoints[s].x,this.symbolData.innerCells[a].positionPoints[s].y);SuperMap.Plot.PlottingUtil.resize(o,t,r),this.symbolData.innerCells[a].positionPoints[s].x=r.x,this.symbolData.innerCells[a].positionPoints[s].y=r.y}for(var u=0;u<this.symbolData.scalePoints.length;u++){var p=new SuperMapAlgoPlot.Point(this.symbolData.scalePoints[u].x,this.symbolData.scalePoints[u].y);SuperMap.Plot.PlottingUtil.resize(o,t,p),this.symbolData.scalePoints[u].x=p.x,this.symbolData.scalePoints[u].y=p.y}}},_setBasicSymbolName:function(){if(0===this.libID)this.symbolName=SuperMap.Plot.AlgoSymbolFactory.getSymbolName(this.libID,this.code);else{var t=L.supermap.plotting.getControl(this._map,this.serverUrl).getSymbolLibManager();this.symbolName=t.getSymbolName(this.libID,this.code)}},_isSupportAddAnnotation:function(){return 0===this.libID&&this.code===SuperMap.Plot.SymbolType.CIRCLESYMBOL||this.code===SuperMap.Plot.SymbolType.RECTANGLESYMBOL||this.code===SuperMap.Plot.SymbolType.ARCSYMBOL||this.code===SuperMap.Plot.SymbolType.CHORDSYMBOL||this.code===SuperMap.Plot.SymbolType.PIESYMBOL||this.code===SuperMap.Plot.SymbolType.ELLIPSESYMBOL||this.code===SuperMap.Plot.SymbolType.PARALLELOGRAM||this.code===SuperMap.Plot.SymbolType.ARBITRARYPOLYGONSYMBOL||this.code===SuperMap.Plot.SymbolType.POLYLINESYMBOL||this.code===SuperMap.Plot.SymbolType.POLYBEZIERSYMBOL||this.code===SuperMap.Plot.SymbolType.POLYBEZIERCLOSESYMBOL||this.code===SuperMap.Plot.SymbolType.PARALLELLINE||this.code===SuperMap.Plot.SymbolType.KIDNEY||this.code===SuperMap.Plot.SymbolType.REGULARPOLYGON||this.code===SuperMap.Plot.SymbolType.RUNWAY||this.code===SuperMap.Plot.SymbolType.CURVEEIGHT||this.code===SuperMap.Plot.SymbolType.BRACESYMBOL||this.code===SuperMap.Plot.SymbolType.ARROWLINE||this.code===SuperMap.Plot.SymbolType.CONCENTRICCIRCLE||this.code===SuperMap.Plot.SymbolType.COMBINATIONALCIRCLE||this.code===SuperMap.Plot.SymbolType.FREECURVE||this.code===SuperMap.Plot.SymbolType.NODECHAIN||this.code===SuperMap.Plot.SymbolType.TRAPEZOIDSYMBOL},_setBasicSymbolText:function(){if(!1!==this.textDisplay&&!0===this._isSupportAddAnnotation()){this.textContent=SuperMap.Plot.PlottingUtil.trim(this.textContent);var t=this.getBounds();if(this.textContent&&null!==this.textContent&&0!==this.textContent.length&&null!==t&&t.isValid()){var e=L.latLng((t.getSouth()+t.getNorth())/2,(t.getEast()+t.getWest())/2),o={surroundLineFlag:!1,labelAlign:"cm"};this._createAndDrawLayer(34,[e],o,this.textContent)}}},superMapCalculateParts:function(){this.toSuperMapAlgorithms(),this.superMapAlgoSymbol.calculateParts(),this.fromSuperMapAlgorithms()},superMapModifyPoint:function(t,e){this.toSuperMapAlgorithms(),this.superMapAlgoSymbol.modifyPoint(t,e),this.fromSuperMapAlgorithms()},toSuperMapAlgorithms:function(){this.superMapAlgoSymbol.isEdit=this.isEdit,this.superMapAlgoSymbol.controlPoints=L.Util.latLngsToSuperMapPoints(this.getLatLngs()),this.superMapAlgoSymbol.subSymbols=this.subSymbols,this.superMapAlgoSymbol.scaleValues=this.scaleValues,this.superMapAlgoSymbol.scalePoints=L.Util.latLngsToSuperMapPoints(this.scalePoints),this.superMapAlgoSymbol.polylineConnectLocationPoint=this.polylineConnectLocationPoint,this.superMapAlgoSymbol.textContent=this.textContent,this.superMapAlgoSymbol.style=this.style,22===this.libID&&1016===this.code&&(this.superMapAlgoSymbol.arrowHeadType=this.arrowHeadType,this.superMapAlgoSymbol.arrowBodyType=this.arrowBodyType,this.superMapAlgoSymbol.arrowTailType=this.arrowTailType),0===this.libID&&this.symbolType===SuperMap.Plot.SymbolType.SYMBOLTEXTBOX&&(this.superMapAlgoSymbol.textBoxType=this.textBoxType,this.superMapAlgoSymbol.roundBox=this.roundBox),0===this.libID&&this.symbolType===SuperMap.Plot.SymbolType.LINEMARKING&&(this.superMapAlgoSymbol.textBoxType=this.textBoxType,this.superMapAlgoSymbol.islocationCircle=this.islocationCircle)},fromSuperMapAlgorithms:function(){this._transSymbolCellsToLayers(this.superMapAlgoSymbol.components),this.scalePoints=L.Util.superMapPointsToLatLngs(this.superMapAlgoSymbol.scalePoints),this.scaleValues=this.superMapAlgoSymbol.scaleValues,this.subSymbols.length!==this.superMapAlgoSymbol.subSymbols.length&&(this.subSymbols=this.superMapAlgoSymbol.subSymbols),(this.latLngs.length!==this.superMapAlgoSymbol.controlPoints.length||100===this.libID&&13700===this.code)&&(this.latLngs=L.Util.superMapPointsToLatLngs(this.superMapAlgoSymbol.controlPoints))},convertGraphicObjects:function(){return this.convertCells(this)},convertCells:function(t){var e=[],o={},i=SuperMap.Util.cloneObject(this.style);o.uuid=t.uuid,o.serverUrl=t.serverUrl,o.serviceParams=t.options.serviceParams,o.custom=t.custom;var l={},n=t.options;if(t instanceof L.Polygon)this._copyStyleForFeature(i,n),(l=L.supermap.plotting.PlottingObject.createSymbol(0,32,t._latlngs[0],o,i,t.custom)).surroundLineType=n.surroundLineType;else if(t instanceof L.Polyline)this._copyStyleForFeature(i,n),(l=L.supermap.plotting.PlottingObject.createSymbol(0,24,t._latlngs,o,i,t.custom)).surroundLineType=n.surroundLineType;else if(t instanceof L.supermap.plotting.Text)this._copyStyleForFeature(i,n),(l=L.supermap.plotting.PlottingObject.createSymbol(0,SuperMap.Plot.SymbolType.TEXTSYMBOL,t._latlng,o,i,t.custom)).textContent=t._text,l.dRotate=-t.options.labelRotation;else if(t instanceof L.supermap.plotting.PlottingObject){for(var a=0;a<t.components.length;a++){var s=t.components[a];if(!0!==s.options.surroundLineFlag)for(var r=this.convertCells(s),u=0;u<r.length;u++)e.push(r[u])}return e}return e.push(l),e},setTextBoxType:function(t){this.textBoxType!==t&&(this.textBoxType=t,this.redraw(),this.fire(SuperMap.Plot.Event.reseteditmarkersvalues))},getTextBoxType:function(){return this.textBoxType},setRoundBox:function(t){this.roundBox!==t&&(this.roundBox=t,this.textBoxType!==SuperMap.Plot.TextBoxType.NONEBOX&&(this.redraw(),this.fire(SuperMap.Plot.Event.reseteditmarkersvalues)))},getRoundBox:function(){return this.roundBox},setLocationCircle:function(t){this.islocationCircle!==t&&(this.islocationCircle=t,this.textBoxType!==SuperMap.Plot.TextBoxType.NONEBOX&&(this.redraw(),this.fire(SuperMap.Plot.Event.reseteditmarkersvalues)))},getLocationCircle:function(){return this.islocationCircle},canPolylineConnectLocationPoint:function(){return SuperMap.Plot.AlgoSymbolFactory.canPolylineConnect(this.libID,this.code)},getPolylineConnectLocationPoint:function(){return this.polylineConnectLocationPoint},setPolylineConnectLocationPoint:function(t){this.polylineConnectLocationPoint!==t&&SuperMap.Plot.AlgoSymbolFactory.canPolylineConnect(this.libID,this.code)&&(this.polylineConnectLocationPoint=t,this.redraw(),this.fire(SuperMap.Plot.Event.reseteditmarkersvalues))},getStartArrowType:function(){return this.scaleValues[1]},setStartArrowType:function(t){this.scaleValues[1]!==t&&(this.scaleValues[1]=t,this.redraw(),this.fire(SuperMap.Plot.Event.reseteditmarkersvalues))},getEndArrowType:function(){return this.scaleValues[2]},setEndArrowType:function(t){this.scaleValues[2]!==t&&(this.scaleValues[2]=t,this.redraw(),this.fire(SuperMap.Plot.Event.reseteditmarkersvalues))},setFontAlign:function(t){this.style.labelAlign!==t&&(this.style.labelAlign=t,this.redraw(),this.fire(SuperMap.Plot.Event.reseteditmarkersvalues))},getTextPosition:function(){if(this.symbolType===SuperMap.Plot.SymbolType.POLYGONREGION)return this.scaleValues[1]},setTextPosition:function(t){this.symbolType===SuperMap.Plot.SymbolType.POLYGONREGION&&this.scaleValues[1]!==t&&(this.scaleValues[1]=t,0!==this.textContent.length&&this.redraw())}}),a=e.algoSymbol=function(t,e,o,i){return new n(t,e,o,i)};L.supermap.plotting.algoSymbol=a,L.supermap.plotting.AlgoSymbol=n},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PlottingLayerBase=void 0;var i=o(6),l=o(5),n=o(37),a=o(4);e.PlottingLayerBase=L.Path.extend({name:"",serverUrl:null,features:null,options:{serviceParams:{proxy:null,withCredentials:!1,crossOrigin:null,headers:null,serverType:null}},initialize:function(t,e,o){o=o||{},L.setOptions(this,o),this.name=t,this.serverUrl=e,this.features=[]},destroy:function(){this.name="",this.serverUrl=null,this.features=null},beforeAdd:function(t){L.Path.prototype.beforeAdd.call(this,t)},onAdd:function(t){L.Path.prototype.onAdd.call(this,t),this._map=t;var e=this;this._map.on("zoomend",function(){for(var t=0;t<e.features.length;t++)e.features[t]._reView()})},onRemove:function(){L.Path.prototype.onRemove.call(this),this.removeAllFeatures()},addFeatures:function(t){SuperMap.Util.isArray(t)||(t=[t]);for(var e=0;e<t.length;)t[e]instanceof l.PlottingObject||t[e]instanceof n.AvoidRegion?(this.features.push(t[e]),t[e].onAdd(this),e++):t.splice(e,1)},removeFeatures:function(t){SuperMap.Util.isArray(t)||(t=[t]);for(var e=0,o=t.length;e<o;e++){var s=t[e];if(-1!=SuperMap.Util.indexOf(this.features,s)&&(s instanceof l.PlottingObject||t[e]instanceof n.AvoidRegion)){(s instanceof i.GroupObject||s instanceof a.Route)&&this._map&&this._map.getPlotEditControl()&&this._map.getPlotEditControl().disableEditFeatures(s.components),this._map&&this._map.getPlotEditControl()&&this._map.getPlotEditControl().disableEditFeatures(s),s.symbolType===SuperMap.Plot.SymbolType.ROUTENODE&&s.route&&s.route.deleteRouteNode(s.routeNode),s.symbolType!==SuperMap.Plot.SymbolType.SYMBOLTEXT&&s.symbolType!==SuperMap.Plot.SymbolType.SYMBOLTEXT1||s.removeSymbolTextsFromDotSymbol(s.associatedUuid),s.symbolType===SuperMap.Plot.SymbolType.LINERELATION&&(s.startAssociatedUuid&&s.removeJoinLineFromDotSymbol(s.startAssociatedUuid),s.endAssociatedUuid&&s.removeJoinLineFromDotSymbol(s.endAssociatedUuid)),s.ownerGroup?(s.ownerGroup.removeComponents(),this.removeFeatures(s)):(s._clearComponents(),s.geoSymbolTexts&&s.geoSymbolTexts.length>0&&this.removeFeatures(s.geoSymbolTexts));var r=SuperMap.Util.indexOf(this.features,s);-1!==r&&this.features.splice(r,1),s.layer=null}}this._update()},getFeatures:function(){return this.features.slice()},removeAllFeatures:function(){this.removeFeatures(this.features.slice()),this.features=[]},_setCursorStyle:function(t){void 0===t&&(t="");var e=!1;if(this._map.getPlottingLayers().length>1){var o=this._map.getPlottingLayers();for(var i in o)if(o[i]._renderer instanceof L.Canvas)o[i]._renderer._container.style.cursor=t;else if(o[i]._renderer instanceof L.SVG)for(var l=0;l<o[i]._renderer._rootGroup.childNodes.length;l++)o[i]._renderer._rootGroup.childNodes[l].style.cursor=t;e=!0}if(!e)if(this._renderer instanceof L.Canvas)this._renderer._container.style.cursor=t;else if(this._renderer instanceof L.SVG&&!L.Browser.ie){for(var n=0;n<this._renderer._rootGroup.childNodes.length;n++)this._renderer._rootGroup.childNodes[n].style.cursor=t;this._map._panes.overlayPane.style.cursor=t,this._map._panes.overlayPane.style.width=this._renderer._svgSize.x+"px",this._map._panes.overlayPane.style.height=this._renderer._svgSize.y+"px"}},_update:function(){this._map&&this._updatePath()},_containsPoint:function(){return!1},_updatePath:function(){this._renderer._drawPlottingLayers(this._getLayersInBounds())},_project:function(){var t=this;t._pxBounds=L.bounds(L.point(0,0),L.point(0,0)),t._getLayersInBounds().map(function(e){return e._project(),t._pxBounds.extend(e._pxBounds.min),t._pxBounds.extend(e._pxBounds.max),e})},_getLayersInBounds:function(){var t=[],e=this._map.getBounds();return this.features.map(function(o){var i=o.getBounds();return i.isValid()&&e.contains(i)&&t.push(o),o}),t},bringToBack:function(){return L.Path.prototype.beforeAdd.call(this),this._map&&(L.DomUtil.toBack(this._getContainer()),this._setAutoZIndex(Math.max)),this},bringToFront:function(){return L.Path.prototype.bringToFront.call(this),this._map&&(L.DomUtil.toFront(this._getContainer()),this._setAutoZIndex(Math.min)),this},_setAutoZIndex:function(t){for(var e,o=this.getPane().children,i=-t(-1/0,1/0),l=0,n=o.length;l<n;l++)e=o[l].style.zIndex,o[l]!==this._container&&e&&(i=t(i,+e));isFinite(i)&&(this.options.zIndex=i+t(-1,1),this._updateZIndex())},_updateZIndex:function(){this._container&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._container.style.zIndex=this.options.zIndex)},_getContainer:function(){return this._renderer._container}})},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.plottingLayer=e.PlottingLayer=void 0,o(66),o(0),o(65),o(64);var i=o(6),l=o(1),n=o(17),a=o(8),s=o(13),r=o(5),u=o(4),p=e.PlottingLayer=a.PlottingLayerBase.extend({tolerancePixel:5,isLocked:!1,isEditable:!0,isSelected:!0,visibility:!0,getSelected:function(){return this.isSelected},setSelected:function(t){this.isSelected!==t&&(this.isSelected=t,this._map&&this._map.getPlotEditControl()&&(this.isSelected?this._map.getPlotEditControl().enableEditFeatures(this.features):this._map.getPlotEditControl().disableEditFeatures(this.features)))},getEditable:function(){return this.isEditable},setEditable:function(t){if(this.isEditable!==t&&(this.isEditable=t,this._map&&this._map.getPlotEditControl())){var e=this._map.getPlotEditControl().getSelectedFeatures();this._map.getPlotEditControl().unselectFeatures(this.features),this._map.getPlotEditControl().selectFeatures(e)}},getLocked:function(){return this.isLocked},setLocked:function(t){if(this.isLocked!==t&&(this.isLocked=t,this._map&&this._map.getPlotEditControl())){var e=this._map.getPlotEditControl().getSelectedFeatures();this._map.getPlotEditControl().unselectFeatures(this.features),this._map.getPlotEditControl().selectFeatures(e)}},getVisibility:function(){return this.visibility},setVisibility:function(t){if(this.visibility!==t){this.visibility=t;for(var e=0;e<this.features.length;e++)if(this.features[e].redraw(),this._map&&this._map.getPlotEditControl()){if(this._map.getPlotEditControl()._editMarkers.hasOwnProperty(this.features[e].uuid)){var o=this._map.getPlotEditControl()._editMarkers[this.features[e].uuid];for(var i in o)this.visibility?o[i].setOpacity(1):o[i].setOpacity(0)}null!=this.features[e].dragging&&null!=this.features[e].dragging.moveMarker&&(this.visibility?this.features[e].dragging.moveMarker.setOpacity(1):this.features[e].dragging.moveMarker.setOpacity(0))}}},initialize:function(t,e,o){a.PlottingLayerBase.prototype.initialize.call(this,t,e,o),this.setVisibility(this.visibility)},getFeatureByUuid:function(t){for(var e=0;e<this.features.length;e++){if(this.features[e].uuid===t)return this.features[e];if(this.features[e]instanceof L.supermap.plotting.GroupObject||this.features[e]instanceof L.supermap.plotting.Route)for(var o=0;o<this.features[e].components.length;o++)if(this.features[e].components[o].uuid===t)return this.features[e].components[o]}return null},addFeatures:function(t){SuperMap.Util.isArray(t)||(t=[t]),0!==t.length&&(this.fire(SuperMap.Plot.Event.beforefeaturesadded,{features:t}),a.PlottingLayerBase.prototype.addFeatures.call(this,t),this.fire(SuperMap.Plot.Event.featuresadded,{features:t}),this._map.getPlotEditControl()&&this.isSelected&&this._map.getPlotEditControl().enableEditFeatures(t))},removeFeatures:function(t){SuperMap.Util.isArray(t)||(t=[t]),this.fire(SuperMap.Plot.Event.beforefeaturesremoved,{features:t}),a.PlottingLayerBase.prototype.removeFeatures.call(this,t),this.fire(SuperMap.Plot.Event.featuresremoved,{features:t})},removeAllFeatures:function(){this.fire(SuperMap.Plot.Event.beforefeaturesremoved,{features:this.features}),a.PlottingLayerBase.prototype.removeAllFeatures.call(this),this.fire(SuperMap.Plot.Event.featuresremoved,{features:this.features})},createSymbol:function(t,e,o,i,l,n,a,s){var r;if(n||(n={}),n.uuid=i,n.serverUrl=this.serverUrl,n.serviceParams=this.options.serviceParams,void 0!==n.symbolData&&null!==n.symbolData||!SuperMap.Plot.AlgoSymbolFactory.isAccessServer(t,e))if((r=L.supermap.plotting.PlottingObject.createSymbol(t,e,o,n,l,s)).subSymbols&&0!==r.subSymbols.length&&!SuperMap.Plot.AlgoSymbolFactory.isAccessServer(t,e)){for(var u=[],p=0,h=r.subSymbols.length;p<h;p++)null===r.subSymbols[p].symbolData&&(r.subSymbols[p].symbolData=this._getSymbolDataFromCache(r.subSymbols[p].libID,r.subSymbols[p].code),null===r.subSymbols[p].symbolData&&-1===SuperMap.Util.indexOf(u,r.subSymbols[p])&&u.push(r.subSymbols[p]));for(var c=u.slice(),g=0;g<u.length;g++){var y=new SuperMap.GetSymbolInfoParameters({libID:u[g].libID,code:u[g].code});L.supermap.symbolInfoService(this.serverUrl,this.options.serviceParams).getSymbolInfo(y,function(t){this._cacheSymbolData(t.result);for(var e=0,o=r.subSymbols.length;e<o;e++)if(null===r.subSymbols[e].symbolData&&r.subSymbols[e].libID===t.result.libID&&r.subSymbols[e].code===t.result.code){var i=SuperMap.Util.indexOf(c,r.subSymbols[e]);-1!==i&&c.splice(i,1),r.subSymbols[e].symbolData=SuperMap.Plot.PlottingUtil.cloneObject(t.result),0===c.length&&(r.isEdit=!1,this.addFeatures(r),"function"==typeof a&&a({feature:r}))}},this)}if(0===u.length)return this.addFeatures(r),"function"==typeof a&&a({feature:r}),r}else{if(!SuperMap.Plot.AlgoSymbolFactory.isAccessServer(t,e)||r.symbolData.innerCells)return this.addFeatures(r),"function"==typeof a&&a({feature:r}),r;var f=Math.floor(1e3*Math.random()),P=new SuperMap.GetSymbolInfoParameters({libID:r.libID,code:r.code,surroundLineType:r.surroundLineType,scaleValues:r.scaleValues,subSymbols:r.subSymbols});P.inputPoints=L.Util.latLngsToSuperMapPoints(r.getLatLngs()),P.dynamicToken=f,L.supermap.symbolInfoService(this.serverUrl,this.options.serviceParams).getSymbolInfo(P,function(t){t.result.dynamicToken&&t.result.dynamicToken===SuperMap.MD5.md5(f.toString())&&(r.symbolData.innerCells=t.result.innerCells,this.addFeatures(r))},this)}else{var d=null,S=!1;if(n.hasOwnProperty("negativeImage")||n.hasOwnProperty("symbolRank")||n.hasOwnProperty("surroundLineType")?S=!0:d=this._getSymbolDataFromCache(t,e),!d||S){var m=new SuperMap.GetSymbolInfoParameters({libID:t,code:e});o&&(m.inputPoints=L.Util.latLngsToSuperMapPoints(o)),n.hasOwnProperty("negativeImage")&&(m.negativeImage=n.negativeImage),n.hasOwnProperty("symbolRank")&&(m.symbolRank=n.symbolRank),n.hasOwnProperty("surroundLineType")&&(m.surroundLineType=n.surroundLineType);var b=Math.floor(1e3*Math.random());m.dynamicToken=b,L.supermap.symbolInfoService(this.serverUrl,this.options.serviceParams).getSymbolInfo(m,function(i){i.result.dynamicToken&&i.result.dynamicToken===SuperMap.MD5.md5(b.toString())&&(S||i.result.symbolType!==SuperMap.Plot.SymbolType.DOTSYMBOL||(delete i.result.dynamicToken,this._cacheSymbolData(i.result)),n.symbolData=SuperMap.Plot.PlottingUtil.cloneObject(i.result),r=L.supermap.plotting.PlottingObject.createSymbol(t,e,o,n,l,s),this.addFeatures(r),"function"==typeof a&&a({feature:r}))},this)}else n.symbolData=d,r=L.supermap.plotting.PlottingObject.createSymbol(t,e,o,n,l,s),this.addFeatures(r),"function"==typeof a&&a({feature:r})}},createGroupObject:function(t,e){var o=[];for(var n in t)t[n]&&t[n]instanceof l.GraphicObject&&o.push(t[n]);if(o.length>1){var a=new i.GroupObject(0,SuperMap.Plot.SymbolType.GROUPOBJECT,[],{subObjects:o,uuid:e});return this.addFeatures(a),a}return null},unGroupObject:function(t){var e=[];return t.symbolType===SuperMap.Plot.SymbolType.GROUPOBJECT||t.symbolType===SuperMap.Plot.SymbolType.FLAGGROUP?(e=t._unGroupObject(),t.destroy()):e.push(t),e},createLineRelation:function(t,e,o,i,l,n,a){n||(n={}),n.startAssociatedUuid=t,n.endAssociatedUuid=e,n.lineRelationType=o,n.uuid=i,n.custom=a;var s=L.supermap.plotting.PlottingObject.createSymbol(0,SuperMap.Plot.SymbolType.LINERELATION,null,n,l,a);return this.addFeatures(s),s},createInterferenceBeam:function(t,e,o,i,l,n){l||(l={}),l.associatedUuid=t,l.uuid=o,l.custom=n;var a=L.supermap.plotting.PlottingObject.createSymbol(0,SuperMap.Plot.SymbolType.INTERFERENCEBEAM,e,l,i,n);return this.addFeatures(a),a},createSatellite:function(t,e,o,i,l,n,a,s,r){var u=this._getSymbolDataFromCache(t,e);if(null===u){var p=new SuperMap.GetSymbolInfoParameters({libID:t,code:e});L.supermap.symbolInfoService(this.serverUrl,this.options.serviceParams).getSymbolInfo(p,function(u){this._cacheSymbolData(u.result),a||(a={}),a.serverUrl=this.serverUrl,a.serviceParams=this.options.serviceParams,a.orbitPoints=o,a.textContent=i,a.uuid=l,a.custom=r,a.subSymbols=[{libID:t,code:e,symbolData:SuperMap.Plot.PlottingUtil.cloneObject(u.result),textContent:i}];var p=L.supermap.plotting.PlottingObject.createSymbol(0,SuperMap.Plot.SymbolType.SATELLITE,[],a,n,r);this.addFeatures(p),"function"==typeof s&&s({feature:p})},this)}else{a||(a={}),a.serverUrl=this.serverUrl,a.serviceParams=this.options.serviceParams,a.orbitPoints=o,a.textContent=i,a.uuid=l,a.custom=r,a.subSymbols=[{libID:t,code:e,symbolData:u,textContent:i}];var h=L.supermap.plotting.PlottingObject.createSymbol(0,SuperMap.Plot.SymbolType.SATELLITE,[],a,n,r);this.addFeatures(h),"function"==typeof s&&s({feature:h})}},createSatelliteTimeWindows:function(t,e,o,i,l,n){l||(l={}),l.associatedUuid=t,l.timeWindows=e,l.custom=n,l.uuid=o;var a=L.supermap.plotting.PlottingObject.createSymbol(0,SuperMap.Plot.SymbolType.SATELLITETIMEWINDOWS,[],l,i,n);return this.addFeatures(a),a},createSatelliteTimeWindows1:function(t,e,o,i,l,n){l||(l={}),l.associatedUuid=t;for(var a=0;a<e.length;a++)e[a].type="Number";l.timeWindows=e,l.custom=n,l.uuid=o;var s=L.supermap.plotting.PlottingObject.createSymbol(0,SuperMap.Plot.SymbolType.SATELLITETIMEWINDOWS,[],l,i,n);return this.addFeatures(s),s},createSatelliteTimeWindows2:function(t,e,o,i,l,n){l||(l={}),l.associatedUuid=t;for(var a=0;a<e.length;a++)e[a].type="Time";l.timeWindows=e,l.custom=n,l.uuid=o;var s=L.supermap.plotting.PlottingObject.createSymbol(0,SuperMap.Plot.SymbolType.SATELLITETIMEWINDOWS,[],l,i,n);return this.addFeatures(s),s},createSymbolText:function(t,e,o,i,l,n){l||(l={}),l.associatedUuid=t,l.symbolTexts=e,l.custom=n,l.uuid=o;var a=L.supermap.plotting.PlottingObject.createSymbol(0,SuperMap.Plot.SymbolType.SYMBOLTEXT,[],l,i,n);return this.addFeatures(a),a},createSymbolText1:function(t,e,o,i,l,n){l||(l={}),l.associatedUuid=t,l.textContent=e,l.custom=n,l.uuid=o;var a=L.supermap.plotting.PlottingObject.createSymbol(0,SuperMap.Plot.SymbolType.SYMBOLTEXT1,[],l,i,n);return this.addFeatures(a),a},createNavyDeployment:function(t,e,o,i,l,n,a){if(l||(l={}),l.associatedUuid=t,l.custom=a,l.serverUrl=this.serverUrl,l.serviceParams=this.options.serviceParams,e&&0!==e.length){for(var s=[],r=0,u=e.length;r<u;r++)null===e[r].symbolData&&(e[r].symbolData=this._getSymbolDataFromCache(e[r].libID,e[r].code),null===e[r].symbolData&&-1===SuperMap.Util.indexOf(s,e[r])&&s.push(e[r]));if(0!==s.length)for(var p=s.slice(),h=0;h<s.length;h++){var c=new SuperMap.GetSymbolInfoParameters({libID:s[h].libID,code:s[h].code});L.supermap.symbolInfoService(this.serverUrl,this.options.serviceParams).getSymbolInfo(c,function(t){this._cacheSymbolData(t.result);for(var o=0,s=e.length;o<s;o++)if(null===e[o].symbolData&&e[o].libID===t.result.libID&&e[o].code===t.result.code){var r=SuperMap.Util.indexOf(p,e[o]);-1!==r&&p.splice(r,1),e[o].symbolData=SuperMap.Plot.PlottingUtil.cloneObject(t.result)}if(0===p.length){l.subSymbols=e;var u=L.supermap.plotting.PlottingObject.createSymbol(0,SuperMap.Plot.SymbolType.NAVYDEPLOYMENT,[],l,i,a);this.addFeatures(u),"function"==typeof n&&n({feature:u})}},this)}else{l.subSymbols=e;var g=L.supermap.plotting.PlottingObject.createSymbol(0,SuperMap.Plot.SymbolType.NAVYDEPLOYMENT,[],l,i,a);this.addFeatures(g),"function"==typeof n&&n({feature:g})}}},createAirDeployment:function(t,e,o,i,l,n,a){if(l||(l={}),l.associatedUuid=t,l.custom=a,l.serverUrl=this.serverUrl,l.serviceParams=this.options.serviceParams,e&&0!==e.length){for(var s=[],r=0,u=e.length;r<u;r++)null===e[r].symbolData&&(e[r].symbolData=this._getSymbolDataFromCache(e[r].libID,e[r].code),null===e[r].symbolData&&-1===SuperMap.Util.indexOf(s,e[r])&&s.push(e[r]));if(0!==s.length)for(var p=s.slice(),h=0;h<s.length;h++){var c=new SuperMap.GetSymbolInfoParameters({libID:s[h].libID,code:s[h].code});L.supermap.symbolInfoService(this.serverUrl,this.options.serviceParams).getSymbolInfo(c,function(t){this._cacheSymbolData(t.result);for(var o=0,s=e.length;o<s;o++)if(null===e[o].symbolData&&e[o].libID===t.result.libID&&e[o].code===t.result.code){var r=SuperMap.Util.indexOf(p,e[o]);-1!==r&&p.splice(r,1),e[o].symbolData=SuperMap.Plot.PlottingUtil.cloneObject(t.result)}if(0===p.length){l.subSymbols=e;var u=L.supermap.plotting.PlottingObject.createSymbol(0,SuperMap.Plot.SymbolType.AIRDEPLOYMENT,[],l,i,a);this.addFeatures(u),"function"==typeof n&&n({feature:u})}},this)}else{l.subSymbols=e;var g=L.supermap.plotting.PlottingObject.createSymbol(0,SuperMap.Plot.SymbolType.AIRDEPLOYMENT,[],l,i,a);this.addFeatures(g),"function"==typeof n&&n({feature:g})}}},createNavyRoute:function(t,e,o,i,l,n){l||(l={}),l.routeNodes=e,l.uuid=o,l.custom=n,l.arrRoutePts=t;var a=L.supermap.plotting.PlottingObject.createSymbol(0,SuperMap.Plot.SymbolType.NAVYROUTE,[],l,i,n);return this.addFeatures(a),a},createMissileRoute:function(t,e,o,i,l,n){l||(l={}),l.routeNodes=e,l.uuid=o,l.custom=n,l.arrRoutePts=t;var a=L.supermap.plotting.PlottingObject.createSymbol(0,SuperMap.Plot.SymbolType.MISSILEROUTE,[],l,i,n);return this.addFeatures(a),a},createAirRoute:function(t,e,o,i,l,n){l||(l={}),l.routeNodes=e,l.uuid=o,l.custom=n,l.arrRoutePts=t;var a=L.supermap.plotting.PlottingObject.createSymbol(0,SuperMap.Plot.SymbolType.AIRROUTE,[],l,i,n);return this.addFeatures(a),a},createFlags:function(t,e,o){for(var i=[],l=0;l<t.length;l++)100===t[l].libID&&t[l].code>=2800&&t[l].code<=2900&&i.push(t[l]);var a=null;return i.length>1&&(a=new n.FlagGroup(0,SuperMap.Plot.SymbolType.FLAGGROUP,[],{subObjects:i,ratio:e,uuid:o}),this.addFeatures(a)),a},createArcRegion:function(t,e,o,i,l,n,a,s,r,u,p){r||(r={}),r.centerPoint=t,r.radius=e,r.startAngle=o,r.endAngle=i,r.textContent=l,r.textPosition=n,r.uuid=a,r.custom=p;var h=L.supermap.plotting.PlottingObject.createSymbol(0,SuperMap.Plot.SymbolType.ARCREGION,[],r,s,p);return this.addFeatures(h),h},geoJsonToFeature:function(t,e){var o=JSON.parse(t),i=parseInt(o.libID),l=parseInt(o.code);if(o.isEdit=!0,SuperMap.Plot.AlgoSymbolFactory.isAccessServer(i,l)){var n={};n.negativeImage=o.negativeImage,n.symbolRank=parseInt(o.symbolRank),n.surroundLineType=parseInt(o.surroundLineType);var a=!1;(n.negativeImage||0!==n.surroundLineType||0!==n.symbolRank)&&(a=!0);var s=this._getSymbolDataFromCache(i,l);if(a||null===s){var r=new SuperMap.GetSymbolInfoParameters({libID:i,code:l,negativeImage:n.negativeImage,symbolRank:n.symbolRank,surroundLineType:n.surroundLineType,inputPoints:o.localePoints,subSymbols:o.subSymbols});L.supermap.symbolInfoService(this.serverUrl,this.options.serviceParams).getSymbolInfo(r,function(t){if(t.result.libID&&t.result.code){t.result.symbolType!==SuperMap.Plot.SymbolType.DOTSYMBOL||a||this._cacheSymbolData(t.result),s=SuperMap.Util.cloneObject(t.result),SuperMap.Plot.AnalysisSymbol.mergeSymbolDataAndServerData(o,s);var n={symbolData:o,serverUrl:this.serverUrl,serviceParams:this.options.serviceParams,isGeoJSONData:!0},r=L.supermap.plotting.PlottingObject.createSymbol(i,l,null,n);this.addFeatures(r),"function"==typeof e&&e({feature:r})}},this)}else{SuperMap.Plot.AnalysisSymbol.mergeSymbolDataAndServerData(o,s);var u={symbolData:o,serverUrl:this.serverUrl,isGeoJSONData:!0},p=L.supermap.plotting.PlottingObject.createSymbol(i,l,null,u);this.addFeatures(p),"function"==typeof e&&e({feature:p})}}else if(o.subSymbols&&0!==o.subSymbols.length){for(var h=[],c=0,g=o.subSymbols.length;c<g;c++)if(!o.subSymbols[c].symbolData){var y=L.supermap.plotting.getControl(this._map,this.serverUrl,{serviceParams:this.options.serviceParams}).getSymbolLibManager().getSymbolLibByLibId(o.subSymbols[c].libID);if(y)y.querySymbolbyKey(l.toString()).length>0&&(o.subSymbols[c].symbolData=this._getSymbolDataFromCache(o.subSymbols[c].libID,o.subSymbols[c].code),null===o.subSymbols[c].symbolData&&-1===SuperMap.Util.indexOf(h,o.subSymbols[c])&&h.push(o.subSymbols[c]))}for(var f=h.slice(),P=0;P<h.length;P++){var d=new SuperMap.GetSymbolInfoParameters({libID:h[P].libID,code:h[P].code});L.supermap.symbolInfoService(this.serverUrl,this.options.serviceParams).getSymbolInfo(d,function(t){this._cacheSymbolData(t.result);for(var n=0,a=o.subSymbols.length;n<a;n++)if(null===o.subSymbols[n].symbolData&&o.subSymbols[n].libID===t.result.libID&&o.subSymbols[n].code===t.result.code){var s=SuperMap.Util.indexOf(f,o.subSymbols[n]);-1!==s&&f.splice(s,1),o.subSymbols[n].symbolData=SuperMap.Plot.PlottingUtil.cloneObject(t.result)}if(0===f.length){var r={symbolData:o,serverUrl:this.serverUrl,serviceParams:this.options.serviceParams,symbolType:o.symbolType,isGeoJSONData:!0},u=L.supermap.plotting.PlottingObject.createSymbol(i,l,null,r);this.addFeatures(u),"function"==typeof e&&e({feature:u})}},this)}if(0===h.length){var S={symbolData:o,serverUrl:this.serverUrl,serviceParams:this.options.serviceParams,symbolType:o.symbolType,isGeoJSONData:!0},m=L.supermap.plotting.PlottingObject.createSymbol(i,l,null,S);this.addFeatures(m),"function"==typeof e&&e({feature:m})}}else{var b={symbolData:o,serverUrl:this.serverUrl,serviceParams:this.options.serviceParams,symbolType:o.symbolType,isGeoJSONData:!0},v=L.supermap.plotting.PlottingObject.createSymbol(i,l,null,b);this.addFeatures(v),"function"==typeof e&&e({feature:v})}},_getFeatureFromEvent:function(t){var e=null;if(!this._map)return e;if(this.isSelected)for(var o=this._map.layerPointToLatLng(L.point(0,0)),i=this._map.layerPointToLatLng(L.point(this._clickTolerance(),0)),l=new SuperMap.Geometry.Point(o.lng,o.lat),n=new SuperMap.Geometry.Point(i.lng,i.lat),a=SuperMap.Plot.PlottingUtil.distance(l,n),s=this.features.length-1;s>=0&&null===(e=this._selectFeature(this.features[s],t.latlng,a));s--);return e},_getSymbolDataFromCache:function(t,e){var o=L.supermap.plotting.getControl(this._map,this.serverUrl,{serviceParams:this.options.serviceParams}).getSymbolLibManager().getSymbolLibByLibId(t);return null!==o?o.getSymbolData(e):null},_cacheSymbolData:function(t){var e=L.supermap.plotting.getControl(this._map,this.serverUrl,{serviceParams:this.options.serviceParams}).getSymbolLibManager().getSymbolLibByLibId(t.libID);null!==e&&e.cacheSymbolData(t)},_isAvoidRegion:function(){for(var t=arguments.length,e=Array(t),o=0;o<t;o++)e[o]=arguments[o];if(0!==e.length){var i=null;if(0===e[0].avoidRegions.length)return e[0];if(i=new s.AvoidRegionControl(e[0]),this._map.addControl(i),!0){for(var l=0,n=e[0].avoidRegions.length;l<n;l++)this.removeFeatures(e[0].avoidRegions[l]);return this._map.removeControl(i),!1,e[0]}}},_selectFeature:function(t,e,o){if(null==t)return null;if(void 0!==t.style&&null!==t.style&&"none"===t.style.display)return null;if(!(t instanceof r.PlottingObject))return null;if(t instanceof i.GroupObject){for(var l=0;l<t.components.length;l++)if(this._selectFeature(t.components[l],e,o))return t.isSelected?t.components[l]:t}else if(t instanceof u.Route){for(var n=0;n<t.components.length;n++)if(this._selectFeature(t.components[n],e,o))return t.components[n]===SuperMap.Plot.SymbolType.ROUTENODE||t.components[n]===SuperMap.Plot.SymbolType.LITERATESIGN?t.components[n]:t}else if(t.symbolType===SuperMap.Plot.SymbolType.SYMBOLTEXT){for(var a=0;a<t.components.length;a++)if(this._selectFeature(e,o,t.components[a]))return t}else if(t.symbolType===SuperMap.Plot.SymbolType.ROUTENODE||t.symbolType===SuperMap.Plot.SymbolType.LITERATESIGN){var s=t.getBounds();if(s&&s.isValid()&&e.lng>=s.getWest()&&e.lng<=s.getEast()&&e.lat>=s.getSouth()&&e.lat<=s.getNorth())return t}else for(var p=this._map.latLngToLayerPoint(e),h=0,c=t.components.length;h<c;h++)if(t.components[h]._containsPoint&&t.components[h]._containsPoint(p))return t;return null}}),h=e.plottingLayer=function(t,e,o){return new p(t,e,o)};L.supermap.plotting.plottingLayer=h},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PlottingObjectDrag=void 0;o(6);var i={mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},l={mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"};function n(t,e){var o=t.x-e.x,i=t.y-e.y;return Math.sqrt(o*o+i*i)}var a=e.PlottingObjectDrag=L.Handler.extend({statics:{DRAGGING_CLS:"leaflet-plottingObject-draggable"},initialize:function(t){this._plottingObject=t,this._startPoint=null,this._dragStartPoint=null,this._mapDraggingWasEnabled=!1,this.moveIcon=L.divIcon({className:"leaflet-supermap-plot-move-icon-path",iconSize:[30,30]}),this.moveMarker=null},addHooks:function(){if(L.Browser.touch&&L.supermap.plotting.getControl().getTouchMode()){var t=this._plottingObject.getBounds();this.moveMarker=L.marker(t.getCenter(),{icon:this.moveIcon}),this._addToMapAndBindMarker(this.moveMarker),this._plottingObject.on("reseteditmarkersvalues",this._onResetEditMarkersValues,this)}else this._plottingObject.on("mousedown",this._onDragStart,this),this._plottingObject.options.className=this._plottingObject.options.className?this._plottingObject.options.className+" "+a.DRAGGING_CLS:a.DRAGGING_CLS,this._plottingObject._plottingObject&&L.DomUtil.addClass(this._plottingObject._plottingObject,a.DRAGGING_CLS)},removeHooks:function(){L.Browser.touch&&L.supermap.plotting.getControl().getTouchMode()?(this._unbindMarkerEvents(this.moveMarker),this._plottingObject._map.removeLayer(this.moveMarker),this._plottingObject.off("reseteditmarkersvalues",this._onResetEditMarkersValues,this)):(this._plottingObject.off("mousedown",this._onDragStart,this),this._plottingObject.options.className=this._plottingObject.options.className.replace(new RegExp("\\s+"+a.DRAGGING_CLS),""),this._plottingObject._plottingObject&&L.DomUtil.removeClass(this._plottingObject._plottingObject,a.DRAGGING_CLS))},moved:function(){return this._plottingObject._dragMoved},_onDragStart:function(t){var e=t.originalEvent._simulated?"touchstart":t.originalEvent.type;this._mapDraggingWasEnabled=!1,this._startPoint=t.latlng.clone(),this._dragStartPoint=t.latlng.clone(),L.DomEvent.stop(t.originalEvent),L.DomEvent.on(document,l[e],this._onDrag,this).on(document,i[e],this._onDragEnd,this),this._plottingObject._map.dragging.enabled()&&(this._plottingObject._map.dragging.disable(),this._mapDraggingWasEnabled=!0),this._plottingObject._dragMoved=!1},_onDrag:function(t){L.DomEvent.stop(t);var e=t.touches&&t.touches.length>=1?t.touches[0]:t,o=this._plottingObject._map.mouseEventToLatLng(e);if("touchmove"===t.type&&!this._plottingObject._dragMoved){var i=this._plottingObject._map.latLngToLayerPoint(this._dragStartPoint),l=this._plottingObject._map.mouseEventToContainerPoint(e);if(i.distanceTo(l)<=this._plottingObject._map.options.tapTolerance)return}var n=o.lat,a=o.lng,s=n-this._startPoint.lat,r=a-this._startPoint.lng;(s||r)&&(this._plottingObject._dragMoved||(this._plottingObject._dragMoved=!0,this._plottingObject.fire("dragstart",t)),this._startPoint.lat=n,this._startPoint.lng=a,this._plottingObject.fire("predrag",t),t.dLat=s,t.dLng=r,this._plottingObject.fire("drag",t))},_onDragEnd:function(t){var e=this._plottingObject._map.mouseEventToLatLng(t),o=this.moved();if(o&&L.DomEvent.stop(t),L.DomEvent.off(document,"mousemove touchmove",this._onDrag,this),L.DomEvent.off(document,"mouseup touchend",this._onDragEnd,this),o){this._plottingObject.fire("dragend",{distance:n(this._dragStartPoint,e)});var i=this._plottingObject._containsPoint;this._plottingObject._containsPoint=L.Util.falseFn,L.Util.requestAnimFrame(function(){L.DomEvent.skipped({type:"click"}),this._plottingObject._containsPoint=i},this)}this._startPoint=null,this._dragStartPoint=null,this._plottingObject._dragMoved=!1,this._mapDraggingWasEnabled&&(o&&L.DomEvent.fakeStop({type:"click"}),this._plottingObject._map.dragging.enable()),o&&(this._plottingObject.moveend=!0)},_dragStart:function(t){this._startPoint=t.target._latlng.clone(),this._dragStartPoint=t.target._latlng.clone(),this._plottingObject._dragMoved=!1},_drag:function(t){var e=t.target._latlng,o=e.lat,i=e.lng,l=o-this._startPoint.lat,n=i-this._startPoint.lng;(l||n)&&(this._plottingObject._dragMoved||(this._plottingObject._dragMoved=!0,this._plottingObject.fire("dragstart",t)),this._startPoint.lat=o,this._startPoint.lng=i,this._plottingObject.fire("predrag",t),t.dLat=l,t.dLng=n,this._plottingObject.fire("drag",t))},_dragEnd:function(t){var e=t.target._latlng,o=this.moved();if(o){this._plottingObject.fire("dragend",{distance:n(this._dragStartPoint,e)});var i=this._plottingObject._containsPoint;this._plottingObject._containsPoint=L.Util.falseFn,L.Util.requestAnimFrame(function(){L.DomEvent.skipped({type:"click"}),this._plottingObject._containsPoint=i},this)}this._startPoint=null,this._dragStartPoint=null,this._plottingObject._dragMoved=!1,o&&(this._plottingObject.moveend=!0)},_addToMapAndBindMarker:function(t){t.addTo(this._plottingObject._map),t.on("dragstart",this._dragStart,this),t.on("drag",this._drag,this),t.on("dragend",this._dragEnd,this),t.dragging.enable()},_unbindMarkerEvents:function(t){t.off("dragstart",this._dragStart,this),t.off("drag",this._drag,this),t.off("dragend",this._dragEnd,this),t.dragging.disable()},_onResetEditMarkersValues:function(){var t=this._plottingObject.getBounds();this.moveMarker._latlng=t.getCenter(),this.moveMarker.update()}})},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PointImage=void 0,o(0);var i=e.PointImage=L.Path.extend({options:{externalGraphic:"",graphicWidth:0,graphicHeight:0,graphicOpacity:1,graphicXOffset:void 0,graphicYOffset:void 0,rotation:0,graphicTitle:"",interactive:!0},_imageNode:null,initialize:function(t,e){L.setOptions(this,e),this._latlng=L.latLng(t[0])},onAdd:function(){L.Path.prototype.onAdd.call(this),this._updatePath()},onRemove:function(){this._imageNode&&this._imageNode.parentNode&&(this._renderer._rootGroup.removeChild(this._imageNode),delete this._imageNode,this._imageNode=null),this._imageNode&&(delete this._imageNode,this._imageNode=null),L.Path.prototype.onRemove.call(this)},setLatLngs:function(t){return this._latlng=L.latLng(t[0]),this.redraw(),this.fire("move",{latlng:this._latlng})},getLatLngs:function(){return[this._latlng]},getBounds:function(){return this._updateBounds(),this._bounds},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},getPxBounds:function(){this._point=this._map.latLngToLayerPoint(this._latlng);var t=void 0!=this.options.graphicXOffset?this.options.graphicXOffset:-.5*this.options.graphicWidth,e=void 0!=this.options.graphicYOffset?this.options.graphicYOffset:-.5*this.options.graphicHeight,o=this._point.x+t,i=this._point.y+e,l=o+this.options.graphicWidth,n=i+this.options.graphicHeight,a=new L.Bounds;if(this.options.rotation&&0!==this.options.rotation){var s=[];s.push(L.point(o,i)),s.push(L.point(o,n)),s.push(L.point(l,i)),s.push(L.point(l,n));for(var r=this.options.rotation*(Math.PI/180),u=0;u<s.length;u++)SuperMap.Plot.PlottingUtil.rotateAngle(this._point,r,s[u]),a.extend(s[u])}else a=L.bounds(L.point(o,i),L.point(l,n));return a},_updateBounds:function(){this._pxBounds=this.getPxBounds();var t=this._map.layerPointToLatLng(this._pxBounds.min),e=this._map.layerPointToLatLng(this._pxBounds.max);this._bounds=L.latLngBounds(t,e)},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateImage(this)},_empty:function(){return this.options.externalGraphic&&!this._renderer._bounds.intersects(this._pxBounds)}});L.supermap.plotting.pointImage=function(t,e){return new i(t,e)},L.supermap.plotting.PointImage=i},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PlotControl=void 0,o(0);e.PlotControl=L.Evented.extend({options:{position:"topright"},initialize:function(t){L.setOptions(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this.remove(),this._map=t;var e=this._container=this.onAdd(t),o=this.getPosition(),i=t._controlCorners[o];return L.DomUtil.addClass(e,"leaflet-control"),-1!==o.indexOf("bottom")?i.insertBefore(e,i.firstChild):i.appendChild(e),this},remove:function(){return this._map?(L.DomUtil.remove(this._container),this.onRemove&&this.onRemove(this._map),this._map=null,this):this},_refocusOnMap:function(t){this._map&&t&&t.screenX>0&&t.screenY>0&&this._map.getContainer().focus()}});L.Map.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){var t=this._controlCorners={},e="leaflet-",o=this._controlContainer=L.DomUtil.create("div",e+"control-container",this._container);function i(i,l){var n=e+i+" "+e+l;t[i+l]=L.DomUtil.create("div",n,o)}i("top","left"),i("top","right"),i("bottom","left"),i("bottom","right")},_clearControlPos:function(){L.DomUtil.remove(this._controlContainer)}})},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AvoidRegionControl=void 0,o(0);var i=o(8);e.AvoidRegionControl=L.Control.extend({_mouseTolerance:10,_editMarkers:null,_editMode:SuperMap.Plot.EditMode.EDITCIRCUMRECTANGLE,feature:null,_temportary:null,options:{avoidRegionStyle:{fill:!1,color:"#0000ff",dashArray:"2, 2",opacity:1,weight:1},draggable:!0,avoidIcon:L.divIcon({className:"leaflet-supermap-plot-avoid-icon-path",iconSize:[8,8]}),icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"})},initialize:function(t,e){if(L.version<"0.7")throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");L.Browser.touch&&L.supermap.plotting.getControl().getTouchMode()&&(this.options.avoidIcon=L.divIcon({className:"leaflet-supermap-plot-avoid-icon-path",iconSize:[15,15]}),this.options.icon=new L.DivIcon({iconSize:new L.Point(15,15),className:"leaflet-div-icon leaflet-editing-icon"})),L.Control.prototype.initialize.call(this,e),L.setOptions(this,e),this._temportary=new i.PlottingLayerBase("avoidRegionControl-temportary",t.serverUrl,{serviceParams:t.serviceParams}),this._editMarkers={},this.feature=t},onAdd:function(t){if(this.feature&&!this.feature.getLocked())return this.controlDiv=L.DomUtil.create("div","supermap-iclient-avoidregion"),this._map=t,this._markers=[],this._latlngs=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._map.addLayer(this._temportary),this._map.on("mousemove",this._onMouseMove,this).on("click",this._onMapClick,this),this._showAvoidRegions(),this.controlDiv},onRemove:function(){this._hideAvoidRegions(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,delete this._latlngs,this.plotting&&(this._temportary.removeFeatures(this.plotting),delete this.plotting,this.plotting=null),this._map.removeLayer(this._temportary),delete this._temportary,this._map.off("mousemove",this._onMouseMove,this).off("click",this._onMapClick,this)},_showAvoidRegions:function(){for(var t=0;t<this.feature.avoidRegions.length;t++){var e=this.feature.avoidRegions[t];this._temportary.addFeatures(e),this._selectFeature(e)}},_hideAvoidRegions:function(){for(var t=0;t<this.feature.avoidRegions.length;t++){var e=this.feature.avoidRegions[t];this._unselectFeature(e),this._temportary.removeFeatures(e)}},_selectFeature:function(t){t.symbolType===SuperMap.Plot.SymbolType.AVOIDREGION&&(this._collectEditMarkers(t),t.on("mousemove",this._onMouseMove,this).on("mouseout",this._onMouseOut,this).on("dragstart",this._onDragStart,this).on("drag",this._onDrag,this).on("dragend",this._onDragEnd,this),t.dragging.enable())},_unselectFeature:function(t){t.symbolType===SuperMap.Plot.SymbolType.AVOIDREGION&&(this._removeMarkers(t),t.off("mousemove",this._onMouseMove,this).off("mouseout",this._onMouseOut,this).off("dragstart",this._onDragStart,this).off("drag",this._onDrag,this).off("dragend",this._onDragEnd,this),t.dragging.disable())},_onMouseOut:function(t){t.target.layer._renderer._container.style.cursor=""},_onMapClick:function(t){if(this.moveend)this.moveend=!1;else{var e=this._map.mouseEventToLayerPoint(t.originalEvent),o=this._map.layerPointToLatLng(e);this.plotting?this._addVertex(o):(this.plotting=L.supermap.plotting.avoidRegion(0,SuperMap.Plot.SymbolType.AVOIDREGION,[],{style:this.options.avoidRegionStyle}),this._temportary.addFeatures(this.plotting),this._addVertex(o)),L.DomEvent.preventDefault(t.originalEvent)}},_collectEditMarkers:function(t){var e=[];if(t.symbolType===SuperMap.Plot.SymbolType.AVOIDREGION)for(var o in t.getLatLngs()){var i=new L.LatLng(t.getLatLngs()[o].lat,t.getLatLngs()[o].lng),l=L.supermap.plotting.editMarker(i,{icon:this.options.avoidIcon,nHandle:-1,tag:o});this._addToMapAndBindMarker(l),e.push(l),l.owner=t}this._editMarkers[t.uuid]=e},_removeMarkers:function(t){var e=this._editMarkers[t.uuid];for(var o in e)this._unbindMarkerEvents(e[o]),this._map.removeLayer(e[o]);delete this._editMarkers[t.uuid]},_unbindMarkerEvents:function(t){t.off("mousemove",this._moveMove,this),t.off("mouseout",this._moveOut,this),t.off("click",this._removePoint,this),t.off("drag",this.redraw,this),t.dragging.disable()},_addToMapAndBindMarker:function(t){t.addTo(this._map),t.on("mousemove",this._moveMove,this),t.on("mouseout",this._moveOut,this),t.on("click",this._removePoint,this),t.on("drag",this._dragPoint,this),t.dragging.enable()},_removePoint:function(t){if(this._editMode===SuperMap.Plot.EditMode.ADDCONTROLPOINT&&t.target.owner.isSelected){var e=this._editMarkers[t.target.owner.uuid],o=e.indexOf(t.target);this._map.removeLayer(e[o]),e.splice(o,1),t.target.owner.latLngs.splice(o,1),t.target.owner.redraw()}},_dragPoint:function(t){var e=t.target.owner;if(e.symbolType===SuperMap.Plot.SymbolType.AVOIDREGION){var o=this._editMarkers[e.uuid],i=SuperMap.Util.indexOf(o,t.target);e.getLatLngs()[i]=t.latlng,e._modifyPoint(),this.moveend=!0}},_moveMove:function(t){t.target._icon.style.cursor="pointer"},_moveOut:function(t){t.target._icon.style.cursor=""},_addVertex:function(t){var e=new L.Marker(t,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});this._markerGroup.addLayer(e),this._markers.push(e),this._latlngs.push(t),this.plotting.setLatLngs(this._latlngs);var o=this._markers.length;o>1&&this._markers[o-1].on("click",this._finishShape,this),o>2&&this._markers[o-2].off("click",this._finishShape,this)},_finishShape:function(){this._markers.length>1&&this._markers[this._markers.length-1].off("click",this._finishShape,this),L.Browser.touch&&L.supermap.plotting.getControl().getTouchMode()&&this._latlngs.length+1<this.plotting.maxEditPts&&this._latlngs.length!==this.plotting.getLatLngs().length&&this.plotting.setLatLngs(this._latlngs);var t=this.plotting.clone();this._markerGroup.clearLayers(),this._markers=[],this._latlngs=[],this._temportary.removeFeatures(this.plotting),delete this.plotting,this.plotting=null,this._temportary.addFeatures(t),this.feature.addAvoidRegion(t),this._selectFeature(t);var e=new SuperMap.Plot.Transaction;e.transType=SuperMap.Plot.TransactionType.EDIT;var o=new SuperMap.Plot.TransactionInfo;o.layerId=this.feature.layer._leaflet_id,o.uuid=this.feature.uuid,o.functionName="addAvoidRegion",o.undoParams=[t],o.redoParams=[t],e.transInfos.push(o),L.supermap.plotting.getControl().getTransManager().add(e),t.on("contextmenu",function(){})},_onDragStart:function(t){var e=t.target,o=this._editMarkers[e.uuid];for(var i in o)o[i].setOpacity(0)},_onDrag:function(t){t.target.move(t.dLat,t.dLng)},_onDragEnd:function(t){var e=t.target;this._collectEditMarkers(e),this.moveend=!0},_onMouseMove:function(t){var e=this._map.mouseEventToLayerPoint(t.originalEvent),o=this._map.layerPointToLatLng(e);if(this.plotting){var i=L.Util.cloneLatLngs(this._latlngs);0===i.length?i.push(o):i[i.length-1].lat===o.lat&&i[i.length-1].lng===o.lng||i.push(o),this.plotting.setLatLngs(i)}L.DomEvent.preventDefault(t.originalEvent)}})},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.movingTargetLayer=e.MovingTargetLayer=void 0,o(0);var i=o(20),l=o(36),n=(o(19),e.MovingTargetLayer=L.Path.extend({serverUrl:null,features:null,isLocked:!1,isEditable:!0,isSelected:!0,visibility:!0,tolerancePixel:5,cacheImages:null,_editLayer:null,_vectorRenderer:null,options:{zIndex:300,vectorZIndex:200},getSelected:function(){return this.isSelected},setSelected:function(t){this.isSelected!==t&&(this.isSelected=t,!1===this.isSelected&&this.selectedFeatures.length>0&&(this._map&&this._map.getPlotEditControl()&&!0===this.isEditable&&!1===this.isLocked&&(this._editLayer.removeFeatures(this.selectedFeatures),this.addFeatures(this.selectedFeatures)),this.fire(SuperMap.Plot.Event.movingtargetsunselected,{features:this.selectedFeatures}),this.selectedFeatures.length=0))},getEditable:function(){return this.isEditable},setEditable:function(t){this.isEditable!==t&&(this.isEditable=t,!1===this.isEditable&&!1===this.isLocked&&this.selectedFeatures.length>0&&this._map&&this._map.getPlotEditControl()&&(this._editLayer.removeFeatures(this.selectedFeatures),this.addFeatures(this.selectedFeatures)))},getLocked:function(){return this.isLocked},setLocked:function(t){this.isLocked!==t&&(this.isLocked=t,!0===this.isEditable&&!0===this.isLocked&&this.selectedFeatures.length>0&&this._map&&this._map.getPlotEditControl()&&(this._editLayer.removeFeatures(this.selectedFeatures),this.addFeatures(this.selectedFeatures)))},getVisibility:function(){return this.visibility},setVisibility:function(t){this.visibility!==t&&(this.visibility=t,this.visibility?(this._renderer._container.style.visibility="visible",this._vectorRenderer._container.style.visibility="visible"):(this._renderer._container.style.visibility="hidden",this._vectorRenderer._container.style.visibility="hidden"),this._editLayer.setVisibility(this.visibility))},setGraphicZIndex:function(t){this.options.zIndex=t,this._renderer._container&&void 0!==this.options.zIndex&&null!==this.options.zIndex&&(this._renderer._container.style.zIndex=this.options.zIndex)},setVectorZIndex:function(t){this.options.vectorZIndex=t,this._vectorRenderer._container&&void 0!==this.options.vectorZIndex&&null!==this.options.vectorZIndex&&(this._vectorRenderer._container.style.zIndex=this.options.vectorZIndex)},initialize:function(t,e,o){this._editLayer=new l.GraphicEditLayer(t+"_temportary",e,{layer:this}),o=o||{},L.Util.setOptions(this,o),this.cacheImages={},this.selectedFeatures=[],this.name=t,this.serverUrl=e,this.features=[],this._graphics=[],this._vectors=[]},getEvents:function(){var t={click:this._handleClick,mousemove:this._onMapMouseMove,contextmenu:this._handleContextmenu};return this._map._zoomAnimated&&(t.zoomanim=this._zoomAnim),t},_zoomAnim:function(t){},_onMapMouseMove:function(t){var e=this._getGraphicsInBounds();if(0!==e.length)for(var o=0,i=e.length;o<i;o++){if(e[o]._containsPoint(this._map.latLngToLayerPoint(t.latlng))){this._renderer._container.style.cursor=e[o].feature.isSelected?"move":"pointer";break}this._renderer._container.style.cursor=""}var l=this._getLayersInBounds();if(0!==l.length)for(var n=0,a=l.length;n<a;n++){var s=!1;for(var r in l[n].components)if(l[n].components[r]._containsPoint(this._map.latLngToLayerPoint(t.latlng))){s=!0;break}if(s){this._vectorRenderer._container.style.cursor=l[n].isSelected?"move":"pointer";break}this._vectorRenderer._container.style.cursor=""}},supportTypes:function(t,e){return t===SuperMap.Plot.SymbolType.DOTSYMBOL||t===SuperMap.Plot.SymbolType.PICTURE||t===SuperMap.Plot.SymbolType.SYMBOLTEXT||t===SuperMap.Plot.SymbolType.SYMBOLTEXT1||t===SuperMap.Plot.SymbolType.LINERELATION||t===SuperMap.Plot.SymbolType.ALGOSYMBOL||null!=e&&0===e},isGraphic:function(t){return t===SuperMap.Plot.SymbolType.DOTSYMBOL||t===SuperMap.Plot.SymbolType.PICTURE||t===SuperMap.Plot.SymbolType.SYMBOLTEXT||t===SuperMap.Plot.SymbolType.SYMBOLTEXT1||t===SuperMap.Plot.SymbolType.TEXTSYMBOL},isVector:function(t,e){return t===SuperMap.Plot.SymbolType.LINERELATION||t===SuperMap.Plot.SymbolType.ALGOSYMBOL||null!=e&&0===e&&t!=SuperMap.Plot.SymbolType.TEXTSYMBOL},getFeatureByUuid:function(t){for(var e=0;e<this.features.length;e++)if(this.features[e].uuid===t)return this.features[e];return null},getFeatures:function(){return this.features.slice()},addFeatures:function(t){L.Util.isArray(t)||(t=[t]);for(var e=0,o=t.length;e<o;e++){var l=t[e];if(this.supportTypes(l.symbolType,l.libID))if(null!=this._map.getFeatureByUuid(l.uuid)&&(l.uuid=SuperMap.Plot.PlottingUtil.generateUuid()),this.features.push(l),this.isGraphic(l.symbolType)){var n=new i.PlottingGraphic(l);n.onAdd(this),this._graphics.push(n)}else l.onAdd(this),this._vectors.push(l)}this._update()},removeFeatures:function(t){SuperMap.Util.isArray(t)||(t=[t]);for(var e=[],o=0,i=t.length;o<i;o++){var l=t[o];-1!=SuperMap.Util.indexOf(this.features,l)&&e.push(l)}this.fire(SuperMap.Plot.Event.beforefeaturesremoved,{features:e});for(var n=0,a=e.length;n<a;n++){var s=e[n],r=SuperMap.Util.indexOf(this.selectedFeatures,s);if(-1!==r&&(this._editLayer.removeFeatures(s),this.selectedFeatures.splice(r,1)),this._map&&this._map.getPlotEditControl()&&this._map.getPlotEditControl().disableEditFeatures(s),s.symbolType!==SuperMap.Plot.SymbolType.SYMBOLTEXT&&s.symbolType!==SuperMap.Plot.SymbolType.SYMBOLTEXT1||s.removeSymbolTextsFromDotSymbol(s.associatedUuid),s.symbolType===SuperMap.Plot.SymbolType.LINERELATION&&(s.startAssociatedUuid&&s.removeJoinLineFromDotSymbol(s.startAssociatedUuid),s.endAssociatedUuid&&s.removeJoinLineFromDotSymbol(s.endAssociatedUuid)),null!=s.graphic&&s.graphic.layer===this){var u=s.graphic.getUuid();this.cacheImages[u]&&0==--this.cacheImages[u].imgCount&&delete this.cacheImages[u],-1!==(r=SuperMap.Util.indexOf(this._graphics,s.graphic))&&this._graphics.splice(r,1),s.graphic.onRemove()}else s._clearComponents();-1!==(r=SuperMap.Util.indexOf(this.features,s))&&this.features.splice(r,1),-1!==(r=SuperMap.Util.indexOf(this._vectors,s))&&this._vectors.splice(r,1)}this._update(),this.fire(SuperMap.Plot.Event.featuresremoved,{features:e})},removeAllFeatures:function(){this.fire(SuperMap.Plot.Event.beforefeaturesremoved,{features:this.features}),this.removeFeatures(this.features.slice()),this.fire(SuperMap.Plot.Event.featuresremoved,{features:this.features})},geoJsonToFeature:function(t,e){var o=this;o._editLayer.geoJsonToFeature(t,function(t){o._editLayer.removeFeatures(t.feature),o.addFeatures(t.feature),"function"==typeof e&&e({feature:t.feature})})},createSymbol:function(t,e,o,i,l,n,a,s){var r;if(n||(n={}),n.uuid=i,n.serverUrl=this.serverUrl,n.serviceParams=this.options.serviceParams,void 0!==n.symbolData&&null!==n.symbolData||!SuperMap.Plot.AlgoSymbolFactory.isAccessServer(t,e))if((r=L.supermap.plotting.PlottingObject.createSymbol(t,e,o,n,l,s)).subSymbols&&0!==r.subSymbols.length&&!SuperMap.Plot.AlgoSymbolFactory.isAccessServer(t,e)){for(var u=[],p=0,h=r.subSymbols.length;p<h;p++)null===r.subSymbols[p].symbolData&&(r.subSymbols[p].symbolData=this._getSymbolDataFromCache(r.subSymbols[p].libID,r.subSymbols[p].code),null===r.subSymbols[p].symbolData&&-1===SuperMap.Util.indexOf(u,r.subSymbols[p])&&u.push(r.subSymbols[p]));for(var c=u.slice(),g=0;g<u.length;g++){var y=new SuperMap.GetSymbolInfoParameters({libID:u[g].libID,code:u[g].code});L.supermap.symbolInfoService(this.serverUrl,this.options.serviceParams).getSymbolInfo(y,function(t){this._cacheSymbolData(t.result);for(var e=0,o=r.subSymbols.length;e<o;e++)if(null===r.subSymbols[e].symbolData&&r.subSymbols[e].libID===t.result.libID&&r.subSymbols[e].code===t.result.code){var i=SuperMap.Util.indexOf(c,r.subSymbols[e]);-1!==i&&c.splice(i,1),r.subSymbols[e].symbolData=SuperMap.Plot.PlottingUtil.cloneObject(t.result),0===c.length&&(r.isEdit=!1,this.addFeatures(r),"function"==typeof a&&a({feature:r}))}},this)}if(0===u.length)return this.addFeatures(r),"function"==typeof a&&a({feature:r}),r}else{if(!SuperMap.Plot.AlgoSymbolFactory.isAccessServer(t,e)||r.symbolData.innerCells)return this.addFeatures(r),"function"==typeof a&&a({feature:r}),r;var f=Math.floor(1e3*Math.random()),P=new SuperMap.GetSymbolInfoParameters({libID:r.libID,code:r.code,surroundLineType:r.surroundLineType,scaleValues:r.scaleValues,subSymbols:r.subSymbols});P.inputPoints=L.Util.latLngsToSuperMapPoints(r.getLatLngs()),P.dynamicToken=f,L.supermap.symbolInfoService(this.serverUrl,this.options.serviceParams).getSymbolInfo(P,function(t){t.result.dynamicToken&&t.result.dynamicToken===SuperMap.MD5.md5(f.toString())&&(r.symbolData.innerCells=t.result.innerCells,this.addFeatures(r))},this)}else{var d=null,S=!1;if(n.hasOwnProperty("negativeImage")||n.hasOwnProperty("symbolRank")||n.hasOwnProperty("surroundLineType")?S=!0:d=this._getSymbolDataFromCache(t,e),!d||S){var m=new SuperMap.GetSymbolInfoParameters({libID:t,code:e});o&&(m.inputPoints=L.Util.latLngsToSuperMapPoints(o)),n.hasOwnProperty("negativeImage")&&(m.negativeImage=n.negativeImage),n.hasOwnProperty("symbolRank")&&(m.symbolRank=n.symbolRank),n.hasOwnProperty("surroundLineType")&&(m.surroundLineType=n.surroundLineType);var b=Math.floor(1e3*Math.random());m.dynamicToken=b,L.supermap.symbolInfoService(this.serverUrl,this.options.serviceParams).getSymbolInfo(m,function(i){i.result.dynamicToken&&i.result.dynamicToken===SuperMap.MD5.md5(b.toString())&&(S||i.result.symbolType!==SuperMap.Plot.SymbolType.DOTSYMBOL||(delete i.result.dynamicToken,this._cacheSymbolData(i.result)),n.symbolData=SuperMap.Plot.PlottingUtil.cloneObject(i.result),r=L.supermap.plotting.PlottingObject.createSymbol(t,e,o,n,l,s),this.addFeatures(r),"function"==typeof a&&a({feature:r}))},this)}else n.symbolData=d,r=L.supermap.plotting.PlottingObject.createSymbol(t,e,o,n,l,s),this.addFeatures(r),"function"==typeof a&&a({feature:r})}},createSymbolText:function(t,e,o,i,l,n){l||(l={}),l.associatedUuid=t,l.symbolTexts=e,l.custom=n,l.uuid=o;var a=L.supermap.plotting.PlottingObject.createSymbol(0,SuperMap.Plot.SymbolType.SYMBOLTEXT,[],l,i,n);return this.addFeatures(a),a},createSymbolText1:function(t,e,o,i,l,n){l||(l={}),l.associatedUuid=t,l.textContent=e,l.custom=n,l.uuid=o;var a=L.supermap.plotting.PlottingObject.createSymbol(0,SuperMap.Plot.SymbolType.SYMBOLTEXT1,[],l,i,n);return this.addFeatures(a),a},createLineRelation:function(t,e,o,i,l,n,a){n||(n={}),n.startAssociatedUuid=t,n.endAssociatedUuid=e,n.lineRelationType=o,n.uuid=i,n.custom=a;var s=L.supermap.plotting.PlottingObject.createSymbol(0,SuperMap.Plot.SymbolType.LINERELATION,null,n,l,a);return this.addFeatures(s),s},updateFeatures:function(t){L.Util.isArray(t)||(t=[t]);var e=[],o=this;t.map(function(t){return o.isGraphic(t.symbolType)?(t.graphic.update(),e.push(t.graphic),t.symbolType===SuperMap.Plot.SymbolType.DOTSYMBOL&&(e=e.concat(t.graphic.getAssociatedGraphics())),t):t}),this._redraw(e)},update:function(){this._clearLayersOutBounds(),this._redrawLayersInBounds(),this._renderer._ctx.clearRect(this._renderer._bounds.min.x,this._renderer._bounds.min.y,this._renderer._ctx.canvas.width,this._renderer._ctx.canvas.height),this._renderer._drawPlottingGraphics(this._getGraphicsInBounds())},redraw:function(){this._clearLayersOutBounds(),this._redrawLayersInBounds(),this._renderer._ctx.clearRect(this._renderer._bounds.min.x,this._renderer._bounds.min.y,this._renderer._ctx.canvas.width,this._renderer._ctx.canvas.height),this._renderer._drawPlottingGraphics(this._getGraphicsInBounds())},beforeAdd:function(t){L.Path.prototype.beforeAdd.call(this,t),this._vectorRenderer=L.svg(),t.hasLayer(this._vectorRenderer)||t.addLayer(this._vectorRenderer),this._vectorRenderer._container.style.zIndex=this.options.vectorZIndex,this._renderer=L.canvas(),t.hasLayer(this._renderer)||t.addLayer(this._renderer),this._renderer._container.style.zIndex=this.options.zIndex},onAdd:function(){L.Path.prototype.onAdd.call(this),this._map.addLayer(this._editLayer)},onRemove:function(){L.Path.prototype.onRemove.call(this),map.hasLayer(this._vectorRenderer)&&map.removeLayer(this._vectorRenderer),map.hasLayer(this._renderer)&&map.removeLayer(this._renderer),this._map.removeLayer(this._editLayer)},getRenderer:function(t){return t!==SuperMap.Plot.SymbolType.DOTSYMBOL&&t!==SuperMap.Plot.SymbolType.SYMBOLTEXT&&t!==SuperMap.Plot.SymbolType.SYMBOLTEXT1&&t!==SuperMap.Plot.SymbolType.PICTURE&&t!==SuperMap.Plot.SymbolType.TEXTSYMBOL?this._vectorRenderer:this._renderer},getFeaturesInBounds:function(){var t=[],e=this,o=this._map.getBounds();return this._graphics.map(function(e){return"none"!==e.feature.style.display&&o.contains(e.getLatLng())?t.push(e.feature):"none"!==e.feature.style.display&&null!=e.feature.trajectory&&e.feature.trajectory.getDisplayLatLngs(o).length>0&&t.push(e.feature),e}),this._vectors.map(function(i){return i.getBounds().isValid()&&e._intersects(o,i.getLatLngs())&&t.push(i),i}),t},_redraw:function(t){var e=[];null!=t&&SuperMap.Util.isArray(t)?e=e.concat(t):null!=t&&t instanceof i.PlottingGraphic&&e.push(t);var o=this;o._renderer._redrawBounds&&(o._renderer._redrawBounds.min._floor(),o._renderer._redrawBounds.max._ceil(),o._renderer._clear(),o._graphics.map(function(t){return null!=t._pxBounds&&t._pxBounds.intersects(o._renderer._redrawBounds)&&-1===SuperMap.Util.indexOf(e,t)&&e.push(t),t}),o._renderer._drawPlottingGraphics(e))},_update:function(){this._map&&this.getVisibility()&&this._updatePath()},_containsPoint:function(){return!1},_updatePath:function(){this._clearLayersOutBounds(),this._redrawLayersInBounds(),this._renderer._ctx.clearRect(this._renderer._bounds.min.x,this._renderer._bounds.min.y,this._renderer._ctx.canvas.width,this._renderer._ctx.canvas.height),this._renderer._drawPlottingGraphics(this._getGraphicsInBounds())},_project:function(){var t=this;t._pxBounds=L.bounds(L.point(0,0),L.point(0,0)),t._getGraphicsInBounds().map(function(e){return e._project(),t._pxBounds.extend(e._pxBounds.min),t._pxBounds.extend(e._pxBounds.max),e}),t._getLayersInBounds().map(function(e){return e._project(),t._pxBounds.extend(e._pxBounds.min),t._pxBounds.extend(e._pxBounds.max),e})},_getGraphicsInBounds:function(){var t=[],e=this._map.getBounds();return this._graphics.map(function(o){return"none"!==o.feature.style.display&&e.contains(o.getLatLng())&&(null!=o.getImage()&&o.getUuid()===o.getImage().generateUuidFromFeature()||o.update(),t.push(o)),o}),t},_getLayersInBounds:function(){var t=this,e=[],o=t._map.getBounds();return this._vectors.map(function(i){return i.getBounds().isValid()&&t._intersects(o,i.getLatLngs())&&e.push(i),i}),e},_clearLayersOutBounds:function(){var t=this,e=t._map.getBounds();this._vectors.map(function(o){return o.getBounds().isValid()&&!t._intersects(e,o.getLatLngs())&&o._clearComponents(),o})},_redrawLayersInBounds:function(){var t=this,e=t._map.getBounds();this._vectors.map(function(o){return!o.getBounds().isValid()&&t._intersects(e,o.getLatLngs())&&o.redraw(),o})},_intersects:function(t,e){for(var o=0;o<e.length;o++)if(t.contains(e[o]))return!0;return!1},_addTrajectory:function(t){t._map=this._map,t._renderer=this._vectorRenderer,t.addEventParent(this),t.onAdd()},_removeTrajectory:function(t){t.removeEventParent(this),t.onRemove()},_handleClick:function(t){var e=this;if(!1!==this.isSelected&&!1!==this.visibility){var o=this.selectedFeatures.slice();this.selectedFeatures.length>0&&(!0===this.isEditable&&!1===this.isLocked&&e._map&&e._map.getPlotEditControl()&&(e._editLayer.removeFeatures(this.selectedFeatures),this.addFeatures(this.selectedFeatures)),this.selectedFeatures.length=0);for(var i=e.getFeaturesInBounds(),l=0,n=i.length;l<n;l++){var a=!1;if(null!=i[l].graphic&&i[l].graphic._containsPoint(this._map.latLngToLayerPoint(t.latlng))&&(a=!0),null==i[l].graphic&&i[l].components.length>0)for(var s in i[l].components)if(i[l].components[s]._containsPoint(this._map.latLngToLayerPoint(t.latlng))){a=!0;break}if(a){if(!0===t.originalEvent.altKey&&!0!==t.originalEvent.ctrlKey&&-1!==SuperMap.Util.indexOf(o,i[l]))continue;if(!0===this.isEditable&&!1===this.isLocked&&e._map&&e._map.getPlotEditControl()&&(e._map.getPlotEditControl().unselectFeatures(),this.removeFeatures(i[l]),e._editLayer.addFeatures(i[l]),i[l].enableEdit||e._map.getPlotEditControl().enableEditFeatures(i[l]),e._map.getPlotEditControl().selectFeatures(i[l])),this.selectedFeatures.push(i[l]),e._map&&e._map.getPlotEditControl()&&(e._map.getPlotEditControl()._onTriggerMapClick=!1),!0!==t.originalEvent.ctrlKey)break}}o.length>0&&(this.fire(SuperMap.Plot.Event.movingtargetsunselected,{features:o}),o.length=0),this.selectedFeatures.length>0&&this.fire(SuperMap.Plot.Event.movingtargetsselected,{features:this.selectedFeatures}),L.DomEvent.stopPropagation(t)}},_handleContextmenu:function(t){if(!1!==this.isSelected&&!1!==this.visibility){for(var e=this.getFeaturesInBounds(),o=0,i=e.length;o<i;o++){var l=!1;if(null!=e[o].graphic&&e[o].graphic._containsPoint(this._map.latLngToLayerPoint(t.latlng))&&(l=!0),null==e[o].graphic&&e[o].components.length>0)for(var n in e[o].components)if(e[o].components[n]._containsPoint(this._map.latLngToLayerPoint(t.latlng))){l=!0;break}if(l){this.fire(SuperMap.Plot.Event.movingtargetcontextmenu,{features:[e[o]]});break}}L.DomEvent.stopPropagation(t)}},_getSymbolDataFromCache:function(t,e){var o=L.supermap.plotting.getControl(this._map,this.serverUrl,{serviceParams:this.options.serviceParams}).getSymbolLibManager().getSymbolLibByLibId(t);return null!==o?o.getSymbolData(e):null},_cacheSymbolData:function(t){var e=L.supermap.plotting.getControl(this._map,this.serverUrl,{serviceParams:this.options.serviceParams}).getSymbolLibManager().getSymbolLibByLibId(t.libID);null!==e&&e.cacheSymbolData(t)},_generateFromFeature:function(t){var e="";if(t.symbolType===SuperMap.Plot.SymbolType.DOTSYMBOL){if(e=t.libID.toString()+"_"+t.code.toString()+"_"+Math.round(t.symbolSize.w).toString()+"_"+Math.round(t.symbolSize.h).toString()+"_"+t.textContent+"_"+t.annotationPosition.toString()+"_"+t.dRotate.toString()+this._styleToString(t.style)+"_"+t.textDisplay.toString()+"_"+t.surroundLineType.toString(),null!=t.symbolTexts&&t.symbolTexts.length>0)for(var o=0;o<t.symbolTexts.length;o++)e+=this._symbolTextToString(t.symbolTexts[o]);if(null!=t.bloodVolumes&&t.bloodVolumes.length>0)for(var i=0;i<t.bloodVolumes.length;i++)e+=this._bloodVolumeToString(t.bloodVolumes[i]);if(null!=t.pictureFrames&&t.pictureFrames.length>0)for(var l=0;l<t.pictureFrames.length;l++)e+=this._pictureFrameToString(t.pictureFrames[l])}else t.symbolType===SuperMap.Plot.SymbolType.SYMBOLTEXT?(e=t.libID.toString()+"_"+t.code.toString()+"_"+t.associatedUuid+"_"+t.addFrame.toString(),1===t.symbolTexts.length&&(e+=this._symbolTextToString(t.symbolTexts[0]))):t.symbolType===SuperMap.Plot.SymbolType.SYMBOLTEXT1&&(e=t.libID.toString()+"_"+t.code.toString()+"_"+t.associatedUuid+"_"+t.textContent+"_"+t.space.toString()+"_"+t.offsetX.toString()+"_"+t.offsetY.toString()+this._styleToString(t.style));return e},_symbolTextToString:function(t){var e="";return null!=t.textContent&&(e+="_"+t.textContent),null!=t.textPosition&&(e+="_"+t.textPosition.toString()),null!=t.offsetX&&(e+="_"+t.offsetX.toString()),null!=t.offsetY&&(e+="_"+t.offsetY.toString()),null!=t.border&&(e+="_"+t.border.toString()),null!=t.showRelationLine&&(e+="_"+t.showRelationLine.toString()),null!=t.paddingX&&(e+="_"+t.paddingX.toString()),null!=t.paddingY&&(e+="_"+t.paddingY.toString()),null!=t.style&&(e+=this._styleToString(t.style)),null!=t.lineStyle&&(null!=t.lineStyle.color&&(e+="_"+t.lineStyle.color),null!=t.lineStyle.lineSymbolID&&(e+="_"+t.lineStyle.lineSymbolID),null!=t.lineStyle.opacity&&(e+="_"+t.lineStyle.opacity),null!=t.lineStyle.weight&&(e+="_"+t.lineStyle.weight)),e},_bloodVolumeToString:function(t){var e="";return null!=t.volume&&(e+="_"+t.volume),null!=t.position&&(e+="_"+t.position.toString()),null!=t.offsetX&&(e+="_"+t.offsetX.toString()),null!=t.offsetY&&(e+="_"+t.offsetY.toString()),null!=t.width&&(e+="_"+t.width.toString()),null!=t.height&&(e+="_"+t.height.toString()),null!=t.style&&(null!=t.style.color&&(e+="_"+t.style.color),null!=t.style.opacity&&(e+="_"+t.style.opacity.toString()),null!=t.style.weight&&(e+="_"+t.style.weight.toString()),null!=t.style.remainingVolumeColor&&(e+="_"+t.style.remainingVolumeColor),null!=t.style.remainingVolumeOpacity&&(e+="_"+t.style.remainingVolumeOpacity.toString()),null!=t.style.consumeVolumeColor&&(e+="_"+t.style.consumeVolumeColor),null!=t.style.consumeVolumeOpacity&&(e+="_"+t.style.consumeVolumeOpacity.toString())),e},_pictureFrameToString:function(t){var e="";return null!=t.path&&(e+="_"+t.path),null!=t.position&&(e+="_"+t.position.toString()),null!=t.offsetX&&(e+="_"+t.offsetX.toString()),null!=t.offsetY&&(e+="_"+t.offsetY.toString()),null!=t.width&&(e+="_"+t.width.toString()),null!=t.height&&(e+="_"+t.height.toString()),e},_styleToString:function(t){var e="";return null!=t.fontFamily&&(e+="_"+t.fontFamily),null!=t.fontSize&&(e+="_"+t.fontSize),null!=t.fontColor&&(e+="_"+t.fontColor),null!=t.fontStroke&&(e+="_"+t.fontStroke),null!=t.fontStrokeColor&&(e+="_"+t.fontStrokeColor),null!=t.fontStrokeWidth&&(e+="_"+t.fontStrokeWidth),null!=t.fontBackground&&(e+="_"+t.fontBackground),null!=t.fontBackgroundColor&&(e+="_"+t.fontBackgroundColor),null!=t.fontShadow&&(e+="_"+t.fontShadow),null!=t.fontShadowColor&&(e+="_"+t.fontShadowColor),null!=t.fontShadowOffsetX&&(e+="_"+t.fontShadowOffsetX),null!=t.fontShadowOffsetY&&(e+="_"+t.fontShadowOffsetY),null!=t.color&&(e+="_"+t.color),null!=t.weight&&(e+="_"+t.weight),null!=t.opacity&&(e+="_"+t.opacity),null!=t.lineSymbolID&&(e+="_"+t.lineSymbolID),null!=t.dashArray&&(e+="_"+t.dashArray),null!=t.fill&&(e+="_"+t.fill),null!=t.fillSymbolID&&(e+="_"+t.fillSymbolID),null!=t.fillColor&&(e+="_"+t.fillColor),null!=t.fillOpacity&&(e+="_"+t.fillOpacity),null!=t.fillBackColor&&(e+="_"+t.fillBackColor),null!=t.fillBackOpacity&&(e+="_"+t.fillBackOpacity),null!=t.fillGradientMode&&(e+="_"+t.fillGradientMode),e}})),a=e.movingTargetLayer=function(t,e,o){return new n(t,e,o)};L.supermap.plotting.movingTargetLayer=a},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.geoRouteNode=e.GeoRouteNode=void 0,o(0);var i=o(1),l=o(16),n=e.GeoRouteNode=i.GraphicObject.extend({route:null,routeNode:null,_isFirstNode:function(){for(var t=0;t<this.route.routeNodes.length;t++)for(var e=0;e<this.route.routeNodes[t].towardNodes.length;e++)if(this.route.routeNodes[t].towardNodes[e].routeNodeId===this.routeNode.id)return!1;return!0},_isLastNode:function(){return 0===this.routeNode.towardNodes.length},setType:function(t){this.routeNode.type=t,this.redraw(),this.fire(SuperMap.Plot.Event.reseteditmarkersvalues)},setName:function(t){this.routeNode.name=t,this.redraw()},setPosition:function(t,e){this.routeNode.y=this.latLngs[0].lat=t,this.routeNode.x=this.latLngs[0].lng=e;for(var o=0;o<this.route.routeNodes.length;o++)this.route.routeNodes[o].routeNodeId===this.routeNode.id&&(this.route.routeNodes[o].x=this.routeNode.x,this.route.routeNodes[o].y=this.routeNode.y);if(0!==this.route.arrRoutePts.length){if(this.route.arrRoutePts=[],this.route.redraw(),this.route.highlightFlag){var i=SuperMap.Util.cloneObject(this.route.highlightStyle);this.route.highlightStyle&&SuperMap.Util.copyAttributes(i,this.route.highlightStyle),this.route.highlight(i)}}else{for(var n=this.route._getFeatureStartWith(this.routeNode),a=0;a<n.length;a++)n[a]instanceof l.LiterateSign||(n[a].latLngs[0]=L.latLng(t,e)),n[a].redraw();for(var s=this.route._getFeatureEndWith(this.routeNode),r=0;r<s.length;r++)s[r]instanceof l.LiterateSign||(s[r].latLngs[1]=L.latLng(t,e)),s[r].redraw();this.redraw(),this.fire(SuperMap.Plot.Event.reseteditmarkersvalues)}},setRotate:function(t){this.routeNode.type===SuperMap.Plot.RouteNodeType.STANDBY&&this.routeNode.rotate!==t&&(this.routeNode.rotate=t,this.redraw())},getRotate:function(){return this.routeNode.rotate},initialize:function(t,e,o,l){i.GraphicObject.prototype.initialize.call(this,t,e,o,l),this.symbolName=SuperMap.Plot.RouteNodePrimitives.getRouteNodeNameByType(this.routeNode.type),this.symbolType=SuperMap.Plot.SymbolType.ROUTENODE,this.anchorPoint=L.latLng(0,0)},destroy:function(){this.route=null,this.routeNode=null,i.GraphicObject.prototype.destroy.call(this)},_calculateParts:function(){if(0===this.getLatLngs().length?this.latLngs=[L.latLng(this.routeNode.y,this.routeNode.x)]:(this.latLngs[0].lat=this.routeNode.y,this.latLngs[0].lng=this.routeNode.x),this.latLngs.length>=this.minEditPts){if(this.routeNode.type===SuperMap.Plot.RouteNodeType.STANDBY){var t=SuperMap.Plot.RouteNodePrimitives.getRouteNodeCells(this.routeNode.type,!1,this.routeNode.rotate);this._transformSymbolCellsToGeometrys(t);var e=SuperMap.Plot.RouteNodePrimitives.getRouteNodeCells(this.routeNode.type,!0);this._transformSymbolCellsToGeometrys(e)}else{var o=SuperMap.Plot.RouteNodePrimitives.getRouteNodeCells(this.routeNode.type);this._transformSymbolCellsToGeometrys(o)}if(this.routeNode.style=this.style,null!==this.routeNode.name&&""!==this.routeNode.name){var i=this.getBounds(),l=L.latLng(i.getNorth(),i.getEast()),n=this.routeNode.style;n.labelAlign="lb",this._createAndDrawLayer(SuperMap.Plot.SymbolType.TEXTSYMBOL,[l],n,this.routeNode.name).isNameLayer=!0}}},_transformSymbolCellsToGeometrys:function(t){for(var e=this._map.latLngToLayerPoint(this.latLngs[0]),o=0;o<t.length;o++){var i=t[o];i.type===SuperMap.Plot.SymbolType.TEXTSYMBOL&&(i.style.fontSize=this.dScale*i.style.fontSize,i.style.labelRotation+=-this.dRotate);for(var l=0;l<i.positionPoints.length;l++){i.positionPoints[l].x=i.positionPoints[l].x*this.dScale,i.positionPoints[l].y=i.positionPoints[l].y*this.dScale;var n=this.dRotate*(Math.PI/180);SuperMap.Plot.PlottingUtil.rotateAngle({x:this.anchorPoint.lng,y:this.anchorPoint.lat},n,i.positionPoints[l]),i.positionPoints[l]=this._transitionPoint(i.positionPoints[l],e)}i.positionPoints=L.Util.latLngsToSuperMapPoints(i.positionPoints)}this._transSymbolCellsToLayers(t)},_transitionPoint:function(t,e){var o=e.x+t.x*(96/254),i=e.y-t.y*(96/254);return this._map.layerPointToLatLng(L.point(o,i))},move:function(t,e){this.routeNode.x+=e,this.routeNode.y+=t,this.setPosition(this.routeNode.y,this.routeNode.x)},getBounds:function(){var t=new L.LatLngBounds;for(var e in this.components){var o=this.components[e];o.isNameLayer||t.extend(o.getBounds?o.getBounds():o.getLatLng())}return t},_reView:function(){this.fromZoom!==this._map.getZoom()&&(this.scaleByMap&&!1!==this.scaleByMap?(this.dScale*=this._map.getZoomScale(this._map.getZoom(),this.fromZoom),this.dScale>5?this.dScale=5:this.dScale<1&&(this.dScale=1),this.redraw()):this.redraw(),this.fromZoom=this._map.getZoom(),this.fire(SuperMap.Plot.Event.reseteditmarkersvalues))}}),a=e.geoRouteNode=function(t,e,o,i){return new n(t,e,o,i)};L.supermap.plotting.routeNode=a,L.supermap.plotting.RouteNode=n},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.literateSign=e.LiterateSign=void 0,o(0);var i=o(1),l=e.LiterateSign=i.GraphicObject.extend({route:null,towardNode:null,startRouteNode:null,textAnchor:null,space:null,inner:null,setPosition:function(t){this.textPosition=t,this._calculateOffset()},initialize:function(t,e,o,l){this.symbolName="标牌文字",this.symbolType=SuperMap.Plot.SymbolType.LITERATESIGN,i.GraphicObject.prototype.initialize.call(this,t,e,o,l)},destroy:function(){this.space=null,this.inner=null,this.textAnchor=null,i.GraphicObject.prototype.destroy.call(this)},_calculateParts:function(){if(null!==this.startRouteNode&&null!==this.towardNode&&null!==this.towardNode.textContent&&0!==this.towardNode.textContent.length){for(var t=this.route._getNodeByUuid(this.towardNode.routeNodeId),e=new SuperMap.Geometry.Point(this.startRouteNode.x,this.startRouteNode.y),o=new SuperMap.Geometry.Point(t.x,t.y),i=L.latLng((e.y+o.y)/2,(e.x+o.x)/2),l=SuperMap.Plot.PlottingUtil.getTextCount(this.towardNode.textContent[0]),n=1;n<this.towardNode.textContent.length;n++){var a=SuperMap.Plot.PlottingUtil.getTextCount(this.towardNode.textContent[n]);l<a&&(l=a)}if(null===this.towardNode.offsetX||null===this.towardNode.offsetY){var s=this.space+(this.dScale*this.style.fontSize+1)*l/2,r=this._innerOutlineDir(),u=this._map.layerPointToLatLng(L.point(0,0)),p=this._map.layerPointToLatLng(L.point(s,0)),h=new SuperMap.Geometry.Point(u.lng,u.lat),c=new SuperMap.Geometry.Point(p.lng,p.lat),g=r*SuperMap.Plot.PlottingUtil.distance(h,c);!0===this.inner&&(g=-g);var y=SuperMap.Plot.PlottingUtil.parallel([e,o],g);this.latLngs=[];var f=L.latLng((y[0].y+y[1].y)/2,(y[0].x+y[1].x)/2);this.latLngs.push(f);var P=this._map.latLngToLayerPoint(i),d=this._map.latLngToLayerPoint(f);this.towardNode.offsetX=d.x-P.x,this.towardNode.offsetY=d.y-P.y}else{var S=this._map.latLngToLayerPoint(i),m=L.point(S.x+this.towardNode.offsetX,S.y+this.towardNode.offsetY),b=this._map.layerPointToLatLng(m);0===this.latLngs.length?this.latLngs.push(b):this.latLngs[0]=b}var v=180*SuperMap.Plot.PlottingUtil.radian(e,o)/Math.PI,M=this._getTextContentsCells(l),A="";null!==this._map&&this._map instanceof L.Map&&(A=this._map.options.crs.code);for(var T=0;T<M.length;T++){var _=M[T];L.Util.isMercatorProjection(A)&&(_.positionPoints=L.Util.conventProjectPts(L.Util.superMapPointsToLatLngs(_.positionPoints))),_.positionPoints=SuperMap.Plot.Primitives.getSpatialData(_.type,_.positionPoints,_.angle);for(var O=[],x=0;x<_.positionPoints.length;x++)O.push(SuperMap.Plot.PlottingUtil.coordinateTrans(new SuperMap.Geometry.Point(this.latLngs[0].lng,this.latLngs[0].lat),_.positionPoints[x],v));var w=null;if(L.Util.isMercatorProjection(A)){for(var E=[],C=0,I=(w=L.Util.unConventProjectPts(O)).length;C<I;C++)E.push(SuperMap.Plot.PlottingUtil.coordinateTrans(new SuperMap.Geometry.Point(this.latLngs[0].lng,this.latLngs[0].lat),L.Util.latLngsToSuperMapPoints(w[C])[0],0));w=L.Util.superMapPointsToLatLngs(E)}else w=L.Util.superMapPointsToLatLngs(O);_.type===SuperMap.Plot.SymbolType.TEXTSYMBOL?0!==_.textContent.length&&(_.style.labelRotation=90-v,this._createAndDrawLayer(SuperMap.Plot.SymbolType.TEXTSYMBOL,w,_.style,_.textContent)):this._createAndDrawLayer(_.type,w,_.style,_.textContent)}}},_innerOutlineDir:function(){for(var t=[],e=0;e<this.route.routeNodes.length;e++)t.push(new SuperMap.Geometry.Point(this.route.routeNodes[e].x,this.route.routeNodes[e].y));return SuperMap.Plot.PlottingUtil.innerOutlineDir(t)},move:function(t,e){for(var o in this.components)L.Util.moveLatLngs(this.components[o].getLatLngs(),t,e),this.components[o].setLatLngs(this.components[o].getLatLngs());L.Util.moveLatLngs(this.getLatLngs(),t,e),this._calculateOffset()},_reView:function(){this.scaleByMap&&!1!==this.scaleByMap?(this.dScale*=this._map.getZoomScale(this._map.getZoom(),this.fromZoom),this.dScale>5?this.dScale=5:this.dScale<1&&(this.dScale=1),this.redraw()):this.redraw(),this.fire(SuperMap.Plot.Event.reseteditmarkersvalues),this.fromZoom=this._map.getZoom()},_calculateOffset:function(){var t=this.route._getNodeByUuid(this.towardNode.routeNodeId),e=L.latLng((this.startRouteNode.y+t.y)/2,(this.startRouteNode.x+t.x)/2),o=this._map.latLngToLayerPoint(e),i=this._map.latLngToLayerPoint(this.latLngs[0]);this.towardNode.offsetX=i.x-o.x,this.towardNode.offsetY=i.y-o.y},_getTextContentsCells:function(t){var e=this.towardNode.textContent,o=this.dScale*this.style.fontSize+1,i=this._map.layerPointToLatLng(L.point(0,0)),l=this._map.layerPointToLatLng(L.point(o,0)),n=SuperMap.Plot.PlottingUtil.distance({x:i.lng,y:i.lat},{x:l.lng,y:l.lat}),a=n,s=n*t,r=e.length+2,u=[],p=r*a*.5,h=new Object;h.type=SuperMap.Plot.SymbolType.ARBITRARYPOLYGONSYMBOL,h.positionPoints=[],h.positionPoints.push(new SuperMap.Geometry.Point(p,0)),h.positionPoints.push(new SuperMap.Geometry.Point(-2*a+p,.5*s)),h.positionPoints.push(new SuperMap.Geometry.Point(-r*a+p,.5*s)),h.positionPoints.push(new SuperMap.Geometry.Point(-r*a+p,-.5*s)),h.positionPoints.push(new SuperMap.Geometry.Point(-2*a+p,-.5*s)),h.style={surroundLineFlag:!1,fontSize:12},u.push(h);for(var c=1;c<=e.length;c++){var g=new Object;g.type=SuperMap.Plot.SymbolType.POLYLINESYMBOL,g.positionPoints=[],g.positionPoints.push(new SuperMap.Geometry.Point(-(c+1)*a+p,.5*s)),g.positionPoints.push(new SuperMap.Geometry.Point(-(c+1)*a+p,-.5*s)),g.style={surroundLineFlag:!1,fontSize:12},u.push(g);var y=new Object;y.type=SuperMap.Plot.SymbolType.TEXTSYMBOL,y.positionPoints=[],y.positionPoints.push(new SuperMap.Geometry.Point(-(.5+c+1)*a+p,0)),y.textContent=e[c-1],y.style={surroundLineFlag:!1,fontSize:12,fontFamily:"Microsoft YaHei"},y.style.labelAlign="cm",u.push(y)}var f=new SuperMap.Geometry.Point(-1.4*a+p,0),P=new Object;P.type=SuperMap.Plot.SymbolType.TEXTSYMBOL,P.positionPoints=[],P.positionPoints.push(f),P.textContent=this.towardNode.index.toString(),P.style={surroundLineFlag:!1,fontSize:12,fontSizeLimit:!0,fontFamily:"Microsoft YaHei"},P.style.labelAlign="cm",u.push(P);var d=new Object;return d.type=SuperMap.Plot.SymbolType.CIRCLESYMBOL,d.positionPoints=[],d.positionPoints.push(f),d.positionPoints.push(new SuperMap.Geometry.Point(f.x,.4*a)),d.style={surroundLineFlag:!1,fontSize:12},u.push(d),u}}),n=e.literateSign=function(t,e,o,i){return new l(t,e,o,i)};L.supermap.plotting.literateSign=n,L.supermap.plotting.LiterateSign=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.flagGroup=e.FlagGroup=void 0,o(0);var i=o(6),l=e.FlagGroup=i.GroupObject.extend({ratio:null,scalePoints:null,scaleValues:null,initialize:function(t,e,o,l){i.GroupObject.prototype.initialize.call(this,t,e,o,l),this.libID=0,this.code=SuperMap.Plot.SymbolType.FLAGGROUP,this.symbolType=SuperMap.Plot.SymbolType.FLAGGROUP,this.symbolName="多旗",l.subObjects&&(this.subObjects=l.subObjects),null===this.ratio&&(this.ratio=.8)},destroy:function(){i.GroupObject.prototype.destroy.call(this),this.ratio=[]},setRotate:function(t){isNaN(t)||(this.dRotate+=t,this.redraw())},redraw:function(){if("none"===this.style.display||null!=this.layer&&"function"==typeof this.layer.getVisibility&&!1===this.layer.getVisibility())this._clearComponents();else{if(L.Util.isArray(this.ratio)||(this.ratio=[this.ratio]),0===this.components.length&&0!==this.subObjects.length)for(var t=0,e=this.subObjects.length;t<e;t++)this.layer&&this.layer.removeFeatures(this.subObjects[t]),this.subObjects[t].enableEdit=!0,this.subObjects[t].ownerGroup=this,this._addComponents(this.subObjects[t]);if(0!==this.components.length){this.scalePoints=[],this.components[0].setRotate(this.dRotate);var o=L.latLng(this.components[0].getLatLngs()[0].lat,this.components[0].getLatLngs()[0].lng),i=this._map.latLngToLayerPoint(o);!0===this.components[0].positionOffset&&(i.x+=this.components[0].positionOffsetX,i.y+=this.components[0].positionOffsetY),o=this._map.layerPointToLatLng(i),this.anchorPoint=o.clone();var l=new L.latLng(o);l.tag=0,this.scalePoints.push(l);for(var n=1,a=this.components.length;n<a;n++){for(;this.ratio.length<n;)this.ratio.push(this.ratio[this.ratio.length-1]);var s=this.ratio[n-1],r=this.components[n-1],u=this._calculateFlagTop(r),p=L.Util.cloneLatLngs(r.getLatLngs())[0],h=this._map.latLngToLayerPoint(p);!0===r.positionOffset&&(h.x+=r.positionOffsetX,h.y+=r.positionOffsetY),p=this._map.layerPointToLatLng(h),u=this._pointRotate(this.dRotate,p,u);var c=this._findPointOnLineByRatio(s,p,u);this.components[n].dRotate=this.dRotate,this.components[n].setLatLngs([c]);var g=new L.latLng(c);g.tag=n,this.scalePoints.push(g)}}}},_pointRotate:function(t,e,o){t*=Math.PI/180;var i=Math.sqrt(Math.pow(e.lng-o.lng,2)+Math.pow(e.lat-o.lat,2)),l=t+Math.atan2(o.lat-e.lat,o.lng-e.lng);return o.lng=e.lng+i*Math.cos(l),o.lat=e.lat+i*Math.sin(l),o},_findPointOnLineByRatio:function(t,e,o){var i=new L.latLng(0,0);return i.lng=e.lng+(o.lng-e.lng)*t,i.lat=e.lat+(o.lat-e.lat)*t,i},_calculateFlagTop:function(t){var e=t.dRotate;t.dRotate=0,0===t.dRotate&&(t.isNotRedrawText=!0,t.redraw(),delete t.isNotRedrawText);var o=t.getBounds();return t.dRotate=e,t.redraw(),t.initialScale.x>=0?t.negativeImage?new L.latLng(o.getNorth(),o.getEast()):new L.latLng(o.getNorth(),o.getWest()):t.negativeImage?new L.latLng(o.getSouth(),o.getWest()):new L.latLng(o.getSouth(),o.getEast())},_projectPoint:function(t,e,o){if(e===o)return e;var i=new L.latLng(0,0),l=o.lng-e.lng,n=e.lat-o.lat,a=l*l,s=n*n,r=l*n,u=l*l+n*n;return i.lng=(r*(e.lat-t.lat)+e.lng*s+t.lng*a)/u,i.lat=(r*(e.lng-t.lng)+e.lat*a+t.lat*s)/u,i},_modifyPoint:function(t,e){if(0===t)this.subObjects[0].setLatLngs([e]);else{var o=this.subObjects[t-1].latLngs[0],i=this._calculateFlagTop(this.subObjects[t-1]);i=this._pointRotate(this.dRotate,this.subObjects[0].latLngs[0],i);var l=Math.sqrt(Math.pow(o.lng-i.lng,2)+Math.pow(o.lat-i.lat,2)),n=this._projectPoint(e,o,i),a=Math.sqrt(Math.pow(o.lng-n.lng,2)+Math.pow(o.lat-n.lat,2));this.ratio[t-1]=a/l}this.redraw()},_reView:function(){for(var t in this.components)this.components[t].scaleByMap=this.scaleByMap,this.components[t]._reView();this.redraw(),this.fire(SuperMap.Plot.Event.reseteditmarkersvalues)},_parseSymbolData:function(){i.GroupObject.prototype._parseSymbolData.call(this),this.symbolData&&(this.ratio=this.symbolData.ratio)},_setSymbolData:function(){i.GroupObject.prototype._setSymbolData.call(this),this.symbolData&&(this.symbolData.ratio=this.ratio)}}),n=e.flagGroup=function(t,e,o,i){return new l(t,e,o,i)};L.supermap.plotting.flagGroup=n,L.supermap.plotting.FlagGroup=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Text=e.PointImage=e.PlottingObjectDrag=e.EditMarker=void 0;var i=o(79),l=o(10),n=o(11),a=o(2);e.EditMarker=i.EditMarker,e.PlottingObjectDrag=l.PlottingObjectDrag,e.PointImage=n.PointImage,e.Text=a.Text},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.geoSymbolText1=e.GeoSymbolText1=e.geoSymbolText=e.GeoSymbolText=e.satelliteTimeWindows=e.SatelliteTimeWindows=e.satellite=e.Satellite=e.lineRelation=e.LineRelation=e.interferenceBeam=e.InterferenceBeam=e.navyRoute=e.NavyRoute=e.missileRoute=e.MissileRoute=e.literateSign=e.LiterateSign=e.airRoute=e.AirRoute=e.geoRouteNode=e.GeoRouteNode=e.Route=e.avoidRegion=e.AvoidRegion=e.airDeployment=e.AirDeployment=e.navyDeployment=e.NavyDeployment=e.flagGroup=e.FlagGroup=e.groupObject=e.GroupObject=e.arcRegion=e.ArcRegion=e.picture=e.Picture=e.dotSymbol=e.DotSymbol=e.algoSymbol=e.AlgoSymbol=e.GraphicObject=e.PlottingObject=e.Text=e.PointImage=e.PlottingObjectDrag=e.EditMarker=void 0;var i=o(18),l=o(5),n=o(1),a=o(7),s=o(40),r=o(78),u=o(77),p=o(6),h=o(17),c=o(38),g=o(76),y=o(37),f=o(4),P=o(15),d=o(74),S=o(16),m=o(73),b=o(72),L=o(71),v=o(39),M=o(70),A=o(69),T=o(68),_=o(67);e.EditMarker=i.EditMarker,e.PlottingObjectDrag=i.PlottingObjectDrag,e.PointImage=i.PointImage,e.Text=i.Text,e.PlottingObject=l.PlottingObject,e.GraphicObject=n.GraphicObject,e.AlgoSymbol=a.AlgoSymbol,e.algoSymbol=a.algoSymbol,e.DotSymbol=s.DotSymbol,e.dotSymbol=s.dotSymbol,e.Picture=r.Picture,e.picture=r.picture,e.ArcRegion=u.ArcRegion,e.arcRegion=u.arcRegion,e.GroupObject=p.GroupObject,e.groupObject=p.groupObject,e.FlagGroup=h.FlagGroup,e.flagGroup=h.flagGroup,e.NavyDeployment=c.NavyDeployment,e.navyDeployment=c.navyDeployment,e.AirDeployment=g.AirDeployment,e.airDeployment=g.airDeployment,e.AvoidRegion=y.AvoidRegion,e.avoidRegion=y.avoidRegion,e.Route=f.Route,e.GeoRouteNode=P.GeoRouteNode,e.geoRouteNode=P.geoRouteNode,e.AirRoute=d.AirRoute,e.airRoute=d.airRoute,e.LiterateSign=S.LiterateSign,e.literateSign=S.literateSign,e.MissileRoute=m.MissileRoute,e.missileRoute=m.missileRoute,e.NavyRoute=b.NavyRoute,e.navyRoute=b.navyRoute,e.InterferenceBeam=L.InterferenceBeam,e.interferenceBeam=L.interferenceBeam,e.LineRelation=v.LineRelation,e.lineRelation=v.lineRelation,e.Satellite=M.Satellite,e.satellite=M.satellite,e.SatelliteTimeWindows=A.SatelliteTimeWindows,e.satelliteTimeWindows=A.satelliteTimeWindows,e.GeoSymbolText=T.GeoSymbolText,e.geoSymbolText=T.geoSymbolText,e.GeoSymbolText1=_.GeoSymbolText1,e.geoSymbolText1=_.geoSymbolText1},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PlottingGraphic=void 0;var i=o(42),l=o(19),n=o(14),a=o(21);e.PlottingGraphic=L.Class.extend({_image:null,_lastPos:null,_lastImage:null,_latlng:null,_uuid:null,_trajectoryLine:null,_trajectoryPoints:null,_trajectoryPointGraphic:{},_rotation:null,options:{graphicWidth:0,graphicHeight:0},initialize:function(t,e){e=e||{},this.feature=t,t.graphic=this,this._latlng=e._latlng,this._image=e._image,this._uuid=e._uuid,this._rotation=0,this._trajectoryPoints=[]},onAdd:function(t){this.feature.movingTarget=!0,this.feature._map=t._map,this.feature.layer=t,this.layer=t,this._renderer=t._renderer,this._map=t._map,this.update()},onRemove:function(){null!=this._trajectoryLine&&this.layer instanceof n.MovingTargetLayer&&this.layer._removeTrajectory(this._trajectoryLine);for(var t=0;t<this._trajectoryPoints.length;t++)this.layer._removeTrajectory(this._trajectoryPoints[t]);this.feature._clearComponents(),this.layer=null,this._renderer=null,this._map=null,delete this.feature.graphic,delete this.feature.movingTarget},redraw:function(){null!=this.layer&&null!=this._renderer&&this.layer.getVisibility()&&this.layer.updateFeatures(this.feature)},update:function(){if(null!=this.layer&&null!=this._renderer&&this.layer.isGraphic(this.feature.symbolType)){if(this.feature.symbolType===SuperMap.Plot.SymbolType.SYMBOLTEXT||this.feature.symbolType===SuperMap.Plot.SymbolType.SYMBOLTEXT1){var t=this._map.getFeatureByUuid(this.feature.associatedUuid);if(null==t||"none"===t.style.display)return}if(this._project(),this.layer._renderer._extendRedrawBounds(this),"none"!==this.feature.style.display&&this._map.getBounds().contains(this.feature.getLatLngs()[0])){var e=this._uuid,o="";null!=this._image&&(o=this._image.generateUuidFromFeature()),e!==o&&(this.layer.cacheImages[e]&&0==--this.layer.cacheImages[e].imgCount&&delete this.layer.cacheImages[e],this.layer.cacheImages[o]?this._cloneImage(o):(null==this._image&&(this._image=new i.DotSymbolStyle(this.feature)),this._image.render(),this.layer.cacheImages[o]={img:this._image.getCacheInfo(),imgCount:1}),this._uuid=o)}this.setLatLng(this.feature.getLatLngs()[0]),this.feature.symbolType===SuperMap.Plot.SymbolType.DOTSYMBOL&&(this._updateSymbolTexts(),this._updateJoinLines(),null==this._lastPos?this._lastPos=L.latLng(this._latlng.lat,this._latlng.lng):(this._lastPos.lat=this._latlng.lat,this._lastPos.lng=this._latlng.lng),null==this._lastImage&&null!=this._image?this._lastImage=[this._image.size[0],this._image.size[1]]:null!=this._image&&(this._lastImage[0]=this._image.size[0],this._lastImage[1]=this._image.size[1]))}},getAssociatedGraphics:function(){for(var t=[],e=0;e<this.feature.geoSymbolTexts.length;e++){var o=this.feature.geoSymbolTexts[e];null!==o&&(null!=o.graphic&&null!=o.graphic.layer&&t.push(o.graphic))}return t},_updateSymbolTexts:function(){if(null!=this.feature.geoSymbolTexts&&0!==this.feature.geoSymbolTexts.length&&(null==this._lastPos||this._lastPos.lat!==this._latlng.lat||this._lastPos.lng!==this._latlng.lng||null==this._lastImage||this._lastImage[0]!=this._image.size[0]||this._lastImage[1]!=this._image.size[1]))for(var t=0;t<this.feature.geoSymbolTexts.length;t++){var e=this.feature.geoSymbolTexts[t];null!==e&&(null!=e.graphic&&null!=e.graphic.layer&&"none"!==e.style.display&&(e.graphic._project(),this._renderer._extendRedrawBounds(e.graphic),e._calculatePositionPoints(),e.graphic.update()))}},_updateJoinLines:function(){if(null!=this.feature.joinLines&&0<this.feature.joinLines.length&&(null==this._lastPos||this._lastPos.lat!==this._latlng.lat||this._lastPos.lng!==this._latlng.lng))for(var t=0;t<this.joinLines.feature.length;t++){var e=this.feature.joinLines[t];null!==e&&null!=e.layer&&("none"!==e.style.display&&e instanceof l.LineRelation&&e.redraw())}},setLatLng:function(t){if(this._latlng=t,this.layer instanceof n.MovingTargetLayer&&(this.feature.symbolType===SuperMap.Plot.SymbolType.DOTSYMBOL||this.feature.symbolType===SuperMap.Plot.SymbolType.PICTURE)&&null!=this.feature.trajectory){if(this.feature.trajectory.addLatLng(t),"none"===this.feature.style.display){null!=this._trajectoryLine&&(this.layer._removeTrajectory(this._trajectoryLine),this._trajectoryLine=null);for(var e=0;e<this._trajectoryPoints.length;e++)this.layer._removeTrajectory(this._trajectoryPoints[e]),delete this._trajectoryPoints[e],this._trajectoryPoints[e]=null;return void(this._trajectoryPoints.length=0)}if(!0===this.feature.autoRotation&&this.feature.trajectory.latlngs.length>=2){var o=new SuperMap.Geometry.Point(this.feature.trajectory.latlngs[this.feature.trajectory.latlngs.length-2].lng,this.feature.trajectory.latlngs[this.feature.trajectory.latlngs.length-2].lat),i=new SuperMap.Geometry.Point(this.feature.trajectory.latlngs[this.feature.trajectory.latlngs.length-1].lng,this.feature.trajectory.latlngs[this.feature.trajectory.latlngs.length-1].lat),l=SuperMap.Plot.PlottingUtil.radian(o,i)*SuperMap.Plot.PlottingUtil.RTOD;this._rotation=l-90}var a=this.feature.trajectory.getDisplayLatLngs(this._map.getBounds());if(!0===this.feature.trajectory.showTrackingLine?a.length<=1&&null!=this._trajectoryLine?(this.layer._removeTrajectory(this._trajectoryLine),delete this._trajectoryLine,this._trajectoryLine=null):a.length>1&&null===this._trajectoryLine?(this._trajectoryLine=L.polyline(a,{color:this.feature.trajectory.style.color,weight:this.feature.trajectory.style.weight,opacity:this.feature.trajectory.style.opacity}),this.layer._addTrajectory(this._trajectoryLine)):a.length>1&&null!==this._trajectoryLine&&(this._trajectoryLine.options.color===this.feature.trajectory.style.color&&this._trajectoryLine.options.weight===this.feature.trajectory.style.weight&&this._trajectoryLine.options.opacity===this.feature.trajectory.style.opacity||this._trajectoryLine.setStyle({color:this.feature.trajectory.style.color,weight:this.feature.trajectory.style.weight,opacity:this.feature.trajectory.style.opacity}),this._trajectoryLine.setLatLngs(a)):null!=this._trajectoryLine&&(this.layer._removeTrajectory(this._trajectoryLine),this._trajectoryLine=null),!0===this.feature.trajectory.showTrackingPoint){if(0===a.length&&this._trajectoryPoints.length>0){for(var s=0;s<this._trajectoryPoints.length;s++)this.layer._removeTrajectory(this._trajectoryPoints[s]),delete this._trajectoryPoints[s],this._trajectoryPoints[s]=null;this._trajectoryPoints.length=0}else if(a.length>0){var r=this.feature.trajectory.generateUuidKey(),u=[];if(this._trajectoryPointGraphic.hasOwnProperty(r))for(var p=0;p<this._trajectoryPoints.length;){var h=SuperMap.Util.indexOf(a,this._trajectoryPoints[p].getLatLngs()[0]);-1!==h?(u.push(h),p++):(this.layer._removeTrajectory(this._trajectoryPoints[p]),delete this._trajectoryPoints[p],this._trajectoryPoints[p]=null,this._trajectoryPoints.splice(p,1))}else{for(var c=0;c<this._trajectoryPoints.length;c++)this.layer._removeTrajectory(this._trajectoryPoints[c]),delete this._trajectoryPoints[c],this._trajectoryPoints[c]=null;this._trajectoryPoints.length=0}for(var g=0;g<a.length;g++)if(-1===SuperMap.Util.indexOf(u,g)){var y={externalGraphic:this._generateTrackingPointImage(this.feature.trajectory.trackingPointStyle,this.feature.trajectory.trackingPointRadius,this.feature.trajectory.style,r),graphicWidth:2*this.feature.trajectory.trackingPointRadius,graphicHeight:2*this.feature.trajectory.trackingPointRadius},f=L.supermap.plotting.pointImage([a[g]],y);this.layer._addTrajectory(f),this._trajectoryPoints.push(f)}}}else{for(var P=0;P<this._trajectoryPoints.length;P++)this.layer._removeTrajectory(this._trajectoryPoints[P]),delete this._trajectoryPoints[P],this._trajectoryPoints[P]=null;this._trajectoryPoints.length=0}}},setImage:function(t){this._image=t},setUuid:function(t){this._uuid=t},getLatLng:function(){return this._latlng},getImage:function(){return this._image},getUuid:function(){return this._uuid},_cloneImage:function(t){if(this.layer.cacheImages[t]){this.layer.cacheImages[t].imgCount++,null==this._image&&(this._image=new i.DotSymbolStyle(this.feature)),this._image._ctx.clearRect(0,0,this._image._ctx.width,this._image._ctx.height),this._image.anchor=L.point(this.layer.cacheImages[t].img.anchor.x,this.layer.cacheImages[t].img.anchor.y),this._image.size=[this.layer.cacheImages[t].img.size[0],this.layer.cacheImages[t].img.size[1]],this._image.redrawSize=[this.layer.cacheImages[t].img.redrawSize[0],this.layer.cacheImages[t].img.redrawSize[1]],this._image.redrawAnchor=L.point(this.layer.cacheImages[t].img.redrawAnchor.x,this.layer.cacheImages[t].img.redrawAnchor.y),this._image.bounds=L.latLngBounds(this.layer.cacheImages[t].img.bounds.getSouthEast(),this.layer.cacheImages[t].img.bounds.getNorthWest()),this._image.latLng=L.latLng(this.layer.cacheImages[t].img.latLng.lat,this.layer.cacheImages[t].img.latLng.lng),this._image.fromZoom=this.layer.cacheImages[t].img.fromZoom,null!=this._image.componentLatLngs&&this._image.componentLatLngs.length>0&&(this._image.componentLatLngs.length=0),this._image.componentLatLngs=[];for(var e=0;e<this.layer.cacheImages[t].img.componentLatLngs.length;e++)this._image.componentLatLngs.push(L.Util.cloneLatLngs(this.layer.cacheImages[t].img.componentLatLngs[e]));this._image.canvasEle.width=this._image.size[0],this._image.canvasEle.height=this._image.size[1],this._image._ctx.drawImage(this.layer.cacheImages[t].img.canvas,0,0),this._image.canvas=this._image._ctx.canvas,null!=this.layer.cacheImages[t].img.annotation?(null==this._image.annotation&&(this._image.annotation=new a.ComponentStyle(this._image.feature)),this._image.annotation.clear(),this._image.annotation.anchor=L.point(this.layer.cacheImages[t].img.annotation.anchor.x,this.layer.cacheImages[t].img.annotation.anchor.y),this._image.annotation.size=[this.layer.cacheImages[t].img.annotation.size[0],this.layer.cacheImages[t].img.annotation.size[1]],this._image.annotation.position=this.layer.cacheImages[t].img.annotation.position,this._image.annotation.offsetX=this.layer.cacheImages[t].img.annotation.offsetX,this._image.annotation.offsetY=this.layer.cacheImages[t].img.annotation.offsetY,this._image.annotation.canvasEle.width=this._image.annotation.size[0],this._image.annotation.canvasEle.height=this._image.annotation.size[1],this._image.annotation._ctx.drawImage(this.layer.cacheImages[t].img.annotation.canvas,0,0),this._image.annotation.canvas=this._image.annotation._ctx.canvas):null!=this._image.annotation&&(delete this._image.annotation,this._image.annotation=null),null!=this._image.images&&this._image.images.length>0&&(this._image.images.length=0),this._image.images=[];for(var o=0;o<this.layer.cacheImages[t].img.images.length;o++){var l={};l=SuperMap.Util.copyAttributes(l,this.layer.cacheImages[t].img.images[o]),this._image.images.push(l)}null!=this._image.pictureFrames&&this._image.pictureFrames.length>0&&(this._image.pictureFrames.length=0),this._image.pictureFrames=[];for(var n=0;n<this.layer.cacheImages[t].img.pictureFrames.length;n++){var s={};s=SuperMap.Util.copyAttributes(s,this.layer.cacheImages[t].img.pictureFrames[n]),this._image.pictureFrames.push(s)}for(var r=0;r<this.layer.cacheImages[t].img.symbolTexts.length;r++)this._image.symbolTexts.length<=r&&this._image.symbolTexts.push(new a.ComponentStyle(this._image.feature)),this._image.symbolTexts[r].clear(),this._image.symbolTexts[r].anchor=L.point(this.layer.cacheImages[t].img.symbolTexts[r].anchor.x,this.layer.cacheImages[t].img.symbolTexts[r].anchor.y),this._image.symbolTexts[r].size=[this.layer.cacheImages[t].img.symbolTexts[r].size[0],this.layer.cacheImages[t].img.symbolTexts[r].size[1]],this._image.symbolTexts[r].position=this.layer.cacheImages[t].img.symbolTexts[r].position,this._image.symbolTexts[r].offsetX=this.layer.cacheImages[t].img.symbolTexts[r].offsetX,this._image.symbolTexts[r].offsetY=this.layer.cacheImages[t].img.symbolTexts[r].offsetY,this._image.symbolTexts[r].canvasEle.width=this._image.symbolTexts[r].size[0],this._image.symbolTexts[r].canvasEle.height=this._image.symbolTexts[r].size[1],this._image.symbolTexts[r]._ctx.drawImage(this.layer.cacheImages[t].img.symbolTexts[r].canvas,0,0),this._image.symbolTexts[r].canvas=this._image.symbolTexts[r]._ctx.canvas;for(var u=this.layer.cacheImages[t].img.symbolTexts.length;u<this._image.symbolTexts.length;)delete this._image.symbolTexts[u],this._image.symbolTexts.splice(u,1);for(var p=0;p<this.layer.cacheImages[t].img.bloodVolumes.length;p++)this._image.bloodVolumes.length<=p&&this._image.bloodVolumes.push(new a.ComponentStyle(this._image.feature)),this._image.bloodVolumes[p].clear(),this._image.bloodVolumes[p].anchor=L.point(this.layer.cacheImages[t].img.bloodVolumes[p].anchor.x,this.layer.cacheImages[t].img.bloodVolumes[p].anchor.y),this._image.bloodVolumes[p].size=[this.layer.cacheImages[t].img.bloodVolumes[p].size[0],this.layer.cacheImages[t].img.bloodVolumes[p].size[1]],this._image.bloodVolumes[p].position=this.layer.cacheImages[t].img.bloodVolumes[p].position,this._image.bloodVolumes[p].offsetX=this.layer.cacheImages[t].img.bloodVolumes[p].offsetX,this._image.bloodVolumes[p].offsetY=this.layer.cacheImages[t].img.bloodVolumes[p].offsetY,this._image.bloodVolumes[p].canvasEle.width=this._image.bloodVolumes[p].size[0],this._image.bloodVolumes[p].canvasEle.height=this._image.bloodVolumes[p].size[1],this._image.bloodVolumes[p]._ctx.drawImage(this.layer.cacheImages[t].img.bloodVolumes[p].canvas,0,0),this._image.bloodVolumes[p].canvas=this._image.bloodVolumes[p]._ctx.canvas;for(var h=this.layer.cacheImages[t].img.bloodVolumes.length;h<this._image.bloodVolumes.length;)delete this._image.bloodVolumes[h],this._image.bloodVolumes.splice(h,1)}},_containsPoint:function(t){if(null!=this._latlng&&null!=this._image){var e=this._map.latLngToLayerPoint(this._latlng),o=L.point(e.x-this._image.anchor.x,e.y-this._image.anchor.y),i=L.point(e.x+(this._image.size[0]-this._image.anchor.x),e.y+(this._image.size[1]-this._image.anchor.y)),l=L.bounds(o,i);if(l.min._floor(),l.max._ceil(),null!=l&&l.contains(t))return!0}return!1},_project:function(){if(null!=this._latlng&&null!=this._image){var t=this._map.latLngToLayerPoint(this._latlng),e=L.point(t.x-this._image.redrawAnchor.x,t.y-this._image.redrawAnchor.y),o=L.point(t.x+(this._image.redrawSize[0]-this._image.redrawAnchor.x),t.y+(this._image.redrawSize[1]-this._image.redrawAnchor.y));this._pxBounds=L.bounds(e,o),this._pxBounds.min._floor(),this._pxBounds.max._ceil()}},_generateTrackingPointImage:function(t,e,o,i){var l=null;if(this._trajectoryPointGraphic.hasOwnProperty(i))return this._trajectoryPointGraphic[i];delete this._trajectoryPointGraphic;var n=document.createElement("canvas");n.width=2*e+2*o.weight,n.height=2*e+2*o.weight,document.body.appendChild(n);var a=n.getContext("2d");return 0===t?(a.fillStyle=o.color,a.beginPath(),a.arc(e+o.weight,e+o.weight,e,0,2*Math.PI),a.fill()):1===t?(a.globalAlpha=o.opacity,a.strokeStyle=o.color,a.lineWidth=o.weight,a.beginPath(),a.arc(e+o.weight,e+o.weight,e,0,2*Math.PI),a.stroke()):2===t?(a.fillStyle=o.color,a.beginPath(),a.moveTo(o.weight,2*e+o.weight),a.lineTo(2*e+o.weight,2*e+o.weight),a.lineTo(e+o.weight,o.weight),a.lineTo(o.weight,2*e+o.weight),a.fill()):3===t?(a.globalAlpha=o.opacity,a.strokeStyle=o.color,a.lineWidth=o.weight,a.beginPath(),a.moveTo(o.weight,2*e+o.weight),a.lineTo(2*e+o.weight,2*e+o.weight),a.lineTo(e+o.weight,o.weight),a.lineTo(o.weight,2*e+o.weight),a.stroke()):4===t&&(a.globalAlpha=o.opacity,a.strokeStyle=o.color,a.lineWidth=o.weight,a.beginPath(),a.moveTo(o.weight,e+o.weight),a.lineTo(2*e+o.weight,e+o.weight),a.moveTo(e+o.weight,o.weight),a.lineTo(e+o.weight,2*e+o.weight),a.stroke()),l=n.toDataURL("image/png","image/octet-stream"),document.body.removeChild(n),this._trajectoryPointGraphic[i]=l,l}})},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.componentStyle=e.ComponentStyle=void 0;var i=o(2),l=o(22),n=e.ComponentStyle=l.SymbolStyle.extend({components:null,position:null,offsetX:null,offsetY:null,initialize:function(t,e,o,i,l,n,a){this.feature=t,this.components=e,this.latLng=o,this.position=i,this.offsetX=l,this.offsetY=n,a=a||{},L.Util.setOptions(this,a),this.canvasEle=document.createElement("canvas"),this.canvasEle.width=0,this.canvasEle.height=0,this._ctx=this.canvasEle.getContext("2d")},setComponents:function(t,e,o,i,l){delete this.bounds,this.bounds=null,this.components=t,this.latLng=e,this.position=o,this.offsetX=i,this.offsetY=l,this.render()},render:function(){this._computeImageSize(),this.canvasEle.width=this.size[0],this.canvasEle.height=this.size[1],this._ctx.clearRect(0,0,this.canvasEle.width,this.canvasEle.height),this.canvas=this._ctx.canvas,this._drawFeatures()},clear:function(){this._ctx.clearRect(0,0,this.canvasEle.width,this.canvasEle.height)},getCacheInfo:function(){var t=document.createElement("canvas"),e=t.getContext("2d");return t.width=this.canvas.width,t.height=this.canvas.height,e.clearRect(0,0,t.width,t.height),e.drawImage(this.canvas,0,0),{canvas:e.canvas,_ctx:e,position:this.position,offsetX:this.offsetX,offsetY:this.offsetY,anchor:L.point(this.anchor.x,this.anchor.y),size:[this.size[0],this.size[1]]}},_computeImageSize:function(){if(null==this.bounds){this.bounds=L.latLngBounds();for(var t=0;t<this.components.length;t++)this.bounds.extend(this.components[t].getBounds?this.components[t].getBounds():this.components[t].getLatLng())}var e=new L.Bounds;e.extend(this.feature._map.latLngToLayerPoint(this.bounds.getNorthEast())),e.extend(this.feature._map.latLngToLayerPoint(this.bounds.getNorthWest())),e.extend(this.feature._map.latLngToLayerPoint(this.bounds.getSouthEast())),e.extend(this.feature._map.latLngToLayerPoint(this.bounds.getSouthWest())),this.leftTopPixel=L.point(e.min.x,e.min.y);var o=e.getSize(),i=this.feature.style.weight;o.x+=2*i,o.y+=2*i,this.anchor=this._latlngToLayerPoint([this.latLng])[0],this.size=[o.x,o.y]},_latlngToLayerPoint:function(t){for(var e=[],o=0;o<t.length;o++){var i=this.feature._map.latLngToLayerPoint(L.latLng(t[o].lat,t[o].lng));i.x=i.x-this.leftTopPixel.x+this.feature.style.weight,i.y=i.y-this.leftTopPixel.y+this.feature.style.weight,e.push(i)}return e},_drawFeatures:function(){for(var t in this._ctx.translate(0,0),this.components){var e=this.components[t];i.Text&&e instanceof i.Text?this._drawText(e,this._ctx):L.Rectangle&&e instanceof L.Rectangle?this._drawRectangle(e,this._ctx):L.Polygon&&e instanceof L.Polygon?this._drawPolygon(e,this._ctx):L.Polyline&&e instanceof L.Polyline&&this._drawPolyline(e,this._ctx)}}}),a=e.componentStyle=function(t){return new n(t)};L.supermap.plotting.componentStyle=a},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.symbolStyle=e.SymbolStyle=void 0;o(2),o(11);var i=e.SymbolStyle=L.Class.extend({feature:null,canvas:null,anchor:null,size:null,fromZoom:null,latLng:null,bounds:null,options:{extent:0},initialize:function(t,e){this.feature=t,e=e||{},L.Util.setOptions(this,e),this.canvasEle=document.createElement("canvas"),this.canvasEle.width=0,this.canvasEle.height=0,this._ctx=this.canvasEle.getContext("2d")},_latlngToLayerPoint:function(t,e){null==e&&(e=this.fromZoom);for(var o=this.feature._map.getZoomScale(e,this.feature._map.getZoom()),i=this.latLng,l=[],n=0;n<t.length;n++){var a=i.lat+o*(t[n].lat-i.lat),s=i.lng+o*(t[n].lng-i.lng),r=this.feature._map.latLngToLayerPoint(L.latLng(a,s));r.x=r.x-this.leftTopPixel.x+this.feature.style.weight,r.y=r.y-this.leftTopPixel.y+this.feature.style.weight,l.push(r)}return l},_scaleBounds:function(t){if(this.fromZoom!==this.feature._map.getZoom()){var e=this.feature._map.getZoomScale(this.fromZoom,this.feature._map.getZoom()),o=this.latLng,i=o.lat+e*(t.getNorth()-o.lat),l=o.lat+e*(t.getSouth()-o.lat),n=o.lng+e*(t.getWest()-o.lng),a=o.lng+e*(t.getEast()-o.lng);return L.latLngBounds(L.latLng(i,n),L.latLng(l,a))}return L.latLngBounds(L.latLng(t.getNorth(),t.getWest()),L.latLng(t.getSouth(),t.getEast()))},_drawPolyline:function(t,e){var o=this._latlngToLayerPoint(t.getLatLngs(),t.fromZoom),i=t.options;e.beginPath(),e.globalAlpha=i.opacity,this._addDashArray(t),e.setLineDash&&e.setLineDash(t.options&&t.options._dashArray||[]),e.moveTo(o[0].x,o[0].y);for(var l=1,n=o.length;l<n;l++)e.lineTo(o[l].x,o[l].y);i.fill&&(e.globalCompositeOperation=!0===Boolean(this.feature.surroundLineType)?"destination-over":"source-over"),e.strokeStyle=SuperMap.Plot.PlottingUtil.colorRGBA(i.color,i.opacity),e.lineWidth=i.weight,e.stroke()},_drawRectangle:function(t,e){var o=this._latlngToLayerPoint(t.getLatLngs()[0],t.fromZoom),i=t.options;e.beginPath(),e.globalAlpha=!0===i.fill?i.fillOpacity:i.opacity,this._addDashArray(t),e.setLineDash&&e.setLineDash(t.options&&t.options._dashArray||[]),e.moveTo(o[0].x,o[0].y);for(var l=1,n=o.length;l<n;l++){var a=o[l].x,s=o[l].y;e.lineTo(a,s)}e.closePath(),i.fill&&(e.globalCompositeOperation=!0===Boolean(this.feature.surroundLineType)?"destination-over":"source-over",!0===i.fillLimit&&!0!==i.fillColorLimit?e.fillStyle=SuperMap.Plot.PlottingUtil.colorRGBA(i.color,i.opacity):e.fillStyle=SuperMap.Plot.PlottingUtil.colorRGBA(i.fillColor,i.fillOpacity),e.fill()),e.strokeStyle=SuperMap.Plot.PlottingUtil.colorRGBA(i.color,i.opacity),e.lineWidth=i.weight,e.stroke()},_drawPolygon:function(t,e){var o=this._latlngToLayerPoint(t.getLatLngs()[0],t.fromZoom),i=t.options;e.beginPath(),e.globalAlpha=!0===i.fill?i.fillOpacity:i.opacity,this._addDashArray(t),e.setLineDash&&e.setLineDash(t.options&&t.options._dashArray||[]),e.moveTo(o[0].x,o[0].y);for(var l=1,n=o.length;l<n;l++){var a=o[l].x,s=o[l].y;e.lineTo(a,s)}e.closePath(),i.fill&&(e.globalCompositeOperation=!0===Boolean(this.feature.surroundLineType)?"destination-over":"source-over",!0===i.fillLimit&&!0!==i.fillColorLimit?e.fillStyle=SuperMap.Plot.PlottingUtil.colorRGBA(i.color,i.opacity):e.fillStyle=SuperMap.Plot.PlottingUtil.colorRGBA(i.fillColor,i.fillOpacity),e.fill(i.fillRule||"evenodd")),e.strokeStyle=SuperMap.Plot.PlottingUtil.colorRGBA(i.color,i.opacity),e.lineWidth=i.weight,e.stroke()},_drawText:function(t,e){var o=this._latlngToLayerPoint(t.getLatLngs(),t.fromZoom)[0],i=t.options,l=(i=SuperMap.Util.extend({fontColor:"#000000",labelAlign:"cm"},i)).fontSize.toLocaleString()+"px",n=[i.fontStyle?i.fontStyle:"normal","normal",i.fontWeight?i.fontWeight:"normal",i.fontSize?l:"1em",i.fontFamily?i.fontFamily:"sans-serif"].join(" ");e.globalAlpha=i.fontOpacity,e.fillStyle=SuperMap.Plot.PlottingUtil.colorRGBA(i.fontColor,i.fontOpacity),e.font=n,e.fillText&&(e.textAlign=L.Canvas.LABEL_ALIGN[i.labelAlign[0]]||"center"),e.textBaseline=L.Canvas.LABEL_ALIGN[i.labelAlign[1]]||"middle";var a=L.Canvas.LABEL_FACTOR[i.labelAlign[1]];null==a&&(a=-.5);var s=e.measureText("Mg").height||e.measureText("xx").width,r=i.text.split("\n"),u=r.length;o.y+=s*a*(u-1);for(var p=0;p<u;p++)e.save(),e.translate(o.x,o.y),0!=i.labelRotation&&e.rotate(i.labelRotation*Math.PI/180),e.fillText(r[p],0,s*p),e.restore()},_drawImage:function(t,e){var o=this._latlngToLayerPoint(t.getLatLngs(),t.fromZoom)[0],i=t.options,l=null;if(!L.supermap.plotting.getControl().imageManager.hasOwnProperty(t.options.externalGraphic)){l=new Image,SuperMap.Browser.name;t.options.graphicTitle&&(l.title=t.options.graphicTitle),l.src=t.options.externalGraphic,L.supermap.plotting.getControl().imageManager[t.options.externalGraphic]=l}return{point:o,style:i,path:t.options.externalGraphic}},_addDashArray:function(t){if(t.options.dashArray){var e,o=t.options.dashArray.split(","),i=[];for(e=0;e<o.length;e++)i.push(Number(o[e]));t.options._dashArray=i}}}),l=e.symbolStyle=function(t){return new i(t)};L.supermap.plotting.symbolStyle=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.symbolLib=e.SymbolLib=void 0,o(0);var i=e.SymbolLib=L.Evented.extend({url:null,libID:null,symbolLibData:null,cachedSymbolList:null,needCacheList:null,symbolNames:null,options:{serviceParams:{proxy:null,withCredentials:!1,crossOrigin:null,headers:null,serverType:null}},initialize:function(t){this.cachedSymbolList={},this.needCacheList=[],t&&SuperMap.Util.extend(this.options,t),t&&t.url&&t.libID?(this.url=t.url,this.libID=t.libID):t&&t.symbolLibData&&(this.symbolLibData=t.symbolLibData,this.libID=this.symbolLibData.libID,this.initNeedCacheList())},destroy:function(){this.url=null,this.libID=null,this.symbolLibData=null},initializeAsync:function(){var t=new SuperMap.GetLibInfoParameter;t.libID=this.libID,L.supermap.symbolLibService(this.url,this.options.serviceParams).getLibInfo(t,function(t){t.result.succeed?(this.symbolLibData=t.result,this.libID=this.symbolLibData.libID,this.initNeedCacheList(),this.fire(SuperMap.Plot.Event.initializecompleted,{success:!0})):(this.libID=-1,this.fire(SuperMap.Plot.Event.initializecompleted,{success:!1}))},this)},getSymbolLibName:function(){return null===this.symbolLibData?null:this.symbolLibData.symbolLibName},getSymbolName:function(t){return null===this.symbolLibData?"":(null===this.symbolNames&&(this.symbolNames={},this.getSymbolNameFromList(this.symbolLibData.rootSymbolLibNode)),this.symbolNames[t])},getSymbolNameFromList:function(t){for(var e=0;e<t.childNodeCount;e++)"SYMBOL_GROUP"===t.childNodes[e].symbolNodeType?this.getSymbolNameFromList(t.childNodes[e]):"SYMBOL_NODE"===t.childNodes[e].symbolNodeType&&(this.symbolNames[t.childNodes[e].symbolCode]=t.childNodes[e].symbolName);return""},initNeedCacheList:function(){if(null===this.symbolLibData)return!1;this.initNeedCacheListForNode(this.symbolLibData.rootSymbolLibNode)},initNeedCacheListForNode:function(t){for(var e=0;e<t.childNodeCount;e++)"SYMBOL_GROUP"===t.childNodes[e].symbolNodeType?this.initNeedCacheListForNode(t.childNodes[e]):"SYMBOL_NODE"===t.childNodes[e].symbolNodeType&&"SYMBOL_DOT"===t.childNodes[e].symbolType&&this.needCacheList.push(t.childNodes[e].symbolCode)},cachedSymbols:function(){if(0!==this.needCacheList.length){for(var t=this.needCacheList.slice(),e=0,o=t.length;e<o;e++){var i=Math.floor(1e3*Math.random()),l=new SuperMap.GetSymbolInfoParameters;l.libID=this.libID,l.code=t[e],l.dynamicToken=i,L.supermap.symbolInfoService(this.url,this.options.serviceParams).getSymbolInfo(l,function(t){if(t.result.succeed){if(t.result.dynamicToken&&t.result.dynamicToken===SuperMap.MD5.md5(i.toString()))delete t.result.dynamicToken,this.cacheSymbolData(t.result);else{var e=SuperMap.Util.indexOf(this.needCacheList,t.result.code);-1!==e&&this.needCacheList.splice(e,1)}0===this.needCacheList.length&&this.fire(SuperMap.Plot.Event.cachecompleted,{success:!0})}},this)}this.cachedSymbolOK=!0}else this.fire(SuperMap.Plot.Event.cachecompleted,{success:!0})},getSymbolLibID:function(){return this.libID},getSymbolData:function(t){var e=null;return this.cachedSymbolList.hasOwnProperty(t)&&(e=SuperMap.Plot.PlottingUtil.cloneObject(this.cachedSymbolList[t])),e},cacheSymbolData:function(t){var e=SuperMap.Util.indexOf(this.needCacheList,t.code);-1!==e&&(this.cachedSymbolList[t.code]=SuperMap.Plot.PlottingUtil.cloneObject(t),this.needCacheList.splice(e,1))},getSymbolCount:function(){return null===this.symbolLibData?null:this.symbolLibData.symbolCount},querySymbolbyKey:function(t){return this.querySymbol(t,this.getRootSymbolInfo(),this.getRootSymbolIconUrl())},getClassFication:function(){return null===this.symbolLibData?null:this.symbolLibData.classFication},getCreateTime:function(){return null===this.symbolLibData?null:this.symbolLibData.createTime},getCreator:function(){return null===this.symbolLibData?null:this.symbolLibData.creator},getModifyTime:function(){return null===this.symbolLibData?null:this.symbolLibData.modifyTime},getRootSymbolIconUrl:function(){return null===this.symbolLibData?null:this.symbolLibData.rootSymbolIconUrl},getVersion:function(){return null===this.symbolLibData?null:this.symbolLibData.version},getRootSymbolInfo:function(){return null===this.symbolLibData?null:this.symbolLibData.rootSymbolLibNode},querySymbol:function(t,e,o){var i=[];if("SYMBOL_GROUP"===e.symbolNodeType)for(var l=0;l<e.childNodes.length;l++)for(var n=o+"/"+e.symbolName,a=this.querySymbol(t,e.childNodes[l],n),s=0;s<a.length;s++)i.push(a[s]);else t===e.symbolCode.toString()?(e.icon=o+"/"+e.symbolCode+".png",i.push(e)):-1!==e.symbolName.indexOf(t)&&(e.icon=o+"/"+e.symbolCode+".png",i.push(e));return i}}),l=e.symbolLib=function(t){return new i(t)};L.supermap.plotting.symbolLib=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.symbolLibManager=e.SymbolLibManager=void 0,o(0);var i=o(23),l=e.SymbolLibManager=L.Evented.extend({url:null,libIDs:null,symbolLibs:null,symbolLibJsons:null,isInializeOK:!1,options:{serviceParams:{proxy:null,withCredentials:!1,crossOrigin:null,headers:null,serverType:null}},initialize:function(t,e){l.prototype.url=t,null===this.libIDs&&(l.prototype.libIDs=[]),null===this.symbolLibs&&(l.prototype.symbolLibs=[]),null===this.symbolLibJsons&&(l.prototype.symbolLibJsons=[]),e&&SuperMap.Util.extend(this.options,e)},destroy:function(){l.prototype.url=null,l.prototype.libIDs=null,l.prototype.symbolLibs=null,l.prototype.symbolLibJsons=null,l.prototype.isInializeOK=!1,l.prototype.isInitialize=!1},initializeAsync:function(){this.isInitializeOK()?this.fire(SuperMap.Plot.Event.initializecompleted,{success:!0,libIDs:this.libIDs}):this.isInitialize||(l.prototype.isInitialize=!0,L.supermap.symbolLibService(this.url,this.options.serviceParams).getLibIDs(function(t){if(void 0!==t.result&&t.result.succeed){if(null!==this.libIDs&&0!==this.libIDs.length)for(var e=0;e<this.libIDs.length;e++){for(var o=!1,i=0;i<t.result.length;i++)if(l.prototype.libIDs[e]===t.result[i]){o=!0;break}!1===o&&l.prototype.libIDs.slice(e,1)}else l.prototype.libIDs=t.result;this.initializeSymbolLib()}else l.prototype.libIDs=[]},this))},initializeSymbolLib:function(){for(var t=this.libIDs.slice(),e=0,o=this.libIDs.length;e<o;e++){var n=new SuperMap.GetLibInfoParameter;n.libID=this.libIDs[e],L.supermap.symbolLibService(this.url,this.options.serviceParams).getLibInfo(n,function(e){if(e.result.succeed){var o=SuperMap.Util.indexOf(t,e.result.libID);-1!==o&&(t.splice(o,1),l.prototype.symbolLibJsons.push(e.result),l.prototype.symbolLibs.push(new i.SymbolLib({symbolLibData:e.result})),this.symbolLibs[this.symbolLibs.length-1].url=this.url),0===t.length&&(l.prototype.isInializeOK=!0,this.fire(SuperMap.Plot.Event.initializecompleted,{success:!0,libIDs:this.libIDs}))}},this)}},isInitializeOK:function(){return this.isInializeOK},getSymbolLibNumber:function(){return this.libIDs.length},getSymbolLibID:function(t){return t>=this.libIDs.length?-1:this.libIDs[t]},getSymbolLibJSONInfo:function(t){return t>=this.libIDs.length?null:this.symbolLibJsons[t]},getSymbolLibByIndex:function(t){return t>=this.libIDs.length?null:this.symbolLibs[t]},getSymbolLibByLibId:function(t){for(var e=0;e<this.symbolLibs.length;e++)if(t===this.symbolLibs[e].libID)return this.symbolLibs[e];return null},cacheSymbolData:function(t){var e=t.libID,o=this.getSymbolLibByLibId(e);if(null===o)for(var l in o=new i.SymbolLib({libID:e}),this.symbolLibs.push(o),t)l!==e&&(o.cachedSymbolList[l]=SuperMap.Plot.PlottingUtil.cloneObject(t[l]))},cacheSymbolLib:function(t){var e=this.getSymbolLibByLibId(t);null!==e&&(e.on(SuperMap.Plot.Event.cachecompleted,function t(){this.fire(SuperMap.Plot.Event.cachecompleted,{success:!0}),e.off(SuperMap.Plot.Event.cachecompleted,t)},this),e.cachedSymbols())},getSymbolName:function(t,e){var o=this.getSymbolLibByLibId(t);return null===o?"":o.getSymbolName(e)},findSymbolByName:function(t){for(var e=[],o=0;o<this.libIDs.length;o++)for(var i=this.getSymbolLibByLibId(this.libIDs[o]).querySymbolbyKey(t),l=0;l<i.length;l++)e.push(i[l]);return e},findSymbolByCode:function(t){for(var e=[],o=0;o<this.libIDs.length;o++)for(var i=this.getSymbolLibByLibId(this.libIDs[o]).querySymbolbyKey(t.toString()),l=0;l<i.length;l++)e.push(i[l]);return e}}),n=e.symbolLibManager=function(t,e){return new l(t,e)};L.supermap.plotting.symbolLibManager=n},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.sitDataManager=e.SitDataManager=void 0,o(0);var i=e.SitDataManager=L.Evented.extend({map:null,serverUrl:null,smlInfo:null,smlFileName:null,options:{serviceParams:{proxy:null,withCredentials:!1,crossOrigin:null,headers:null,serverType:null}},initialize:function(t,e,o){o&&SuperMap.Util.extend(this.options,o),t&&null!==t&&null===this.map&&(i.prototype.map=t),e&&null===this.serverUrl&&(i.prototype.serverUrl=e),null===this.smlInfo&&(i.prototype.smlInfo=new SuperMap.Plot.SMLInfoStruct),null===this.smlFileName&&(i.prototype.smlFileName="situationMap")},destroy:function(){i.prototype.map=null,i.prototype.smlInfo.destroy(),i.prototype.smlInfo=null,i.prototype.smlFileName=null,i.prototype.serverUrl=null},getSitDataLayers:function(){return this.map.getPlottingLayers()},getSmlData:function(){var t=this.map.getPlottingLayers(),e=new SuperMap.Plot.SitDataStruct;e.smlInfo=this.smlInfo;var o=new SuperMap.Plot.MapInfoStruct;o.zoom=this.map.getZoom(),o.centerX=this.map.getCenter().lng,o.centerY=this.map.getCenter().lat,e.mapInfo=o,e.layerDatas=[];for(var i=0;i<t.length;i++){var l=t[i].features,n=new SuperMap.Plot.LayerDataStruct;n.layerName=t[i].name,n.spatialAnalystUrl=t[i].spatialAnalystUrl,this.map instanceof L.Map?this.map.getRenderer(t[i])instanceof L.Canvas&&(n.useCanvas=!0):(n.useCanvas=t[i].useCanvas,n.useCanvas2=t[i].useCanvas2),n.isEditable=t[i].getEditable(),n.isLocked=t[i].getLocked(),n.visibility=t[i].getVisibility(),n.features=l,e.layerDatas.push(n)}return SuperMap.Plot.PlottingUtil.toJSON(e)},openSmlData:function(t){if(this.smlInfo.fromJSON(t.smlInfo),t.mapInfo){var e=new SuperMap.Plot.MapInfoStruct;e.fromJSON(t.mapInfo),null!==e.zoom&&null!==e.centerX&&null!==e.centerY&&this.map.setView(L.latLng(e.centerY,e.centerX),e.zoom,{reset:!0})}var o,i=t.layerDatas;this.map.clearPlottingLayers();for(var l=0,n=i.length;l<n;l++)(o=i[l].useCanvas||i[l].useCanvas2?L.supermap.plotting.plottingLayer(i[l].layerName,this.serverUrl,{renderer:L.canvas(),serviceParams:this.options.serviceParams}):L.supermap.plotting.plottingLayer(i[l].layerName,this.serverUrl,{renderer:L.svg(),serviceParams:this.options.serviceParams})).spatialAnalystUrl=i[l].spatialAnalystUrl,this.map.addLayer(o),this._load(i[l],o),void 0!==i[l].isEditable&&null!==i[l].isEditable&&o.setEditable(i[l].isEditable),void 0!==i[l].isLocked&&null!==i[l].isLocked&&o.setLocked(i[l].isLocked),void 0!==i[l].visibility&&null!==i[l].visibility&&o.setVisibility(i[l].visibility)},addSmlData:function(t,e){this.smlInfo.fromJSON(t.smlInfo);for(var o=t.layerDatas,i=null,l=0;l<o.length;l++)if(null!==o[l].layerName){var n=this.map.getLayersByName(o[l].layerName);0!==n.length?i=n[0]:e&&((i=L.supermap.plotting.plottingLayer(o[l].layerName,this.serverUrl,{serviceParams:this.options.serviceParams})).spatialAnalystUrl=o[l].spatialAnalystUrl,this.map.addLayer(i)),null!==i&&this._load(o[l],i)}},addSmlDataToLayer:function(t,e){this.smlInfo.fromJSON(t.smlInfo);var o=t.layerDatas,i=null,l=this.map.getLayersByName(e);0!==l.length?i=l[0]:(i=L.supermap.plotting.plottingLayer(e,this.serverUrl,{serviceParams:this.options.serviceParams}),this.map.addLayer(i));for(var n=0;n<o.length;n++)this._load(o[n],i)},openSmlFile:function(t,e){var o=this.serverUrl+"smlInfos/",i=document.getElementById(t).value.split("\\"),l=i[i.length-1];o+=l;var n=this;""!==l&&$.ajaxFileUpload({url:o,secureuri:!1,fileElementId:t,dataType:"json",timeout:36e5,success:function(){n.openSmlFileOnServer(l,e)},error:function(){e({success:!1,message:"打开本地态势图文件失败"})}})},addSmlFile:function(t,e,o){var i=this.serverUrl+"smlInfos/",l=document.getElementById(t).value.split("\\"),n=l[l.length-1];i+=n;var a=this;""!==n&&$.ajaxFileUpload({url:i,secureuri:!1,fileElementId:t,dataType:"json",timeout:36e5,success:function(){a.addSmlFileOnServer(n,e,o)},error:function(){o({success:!1,message:"叠加本地态势图文件失败"})}})},uploadSmlFile:function(t,e){var o=this.serverUrl+"smlInfos/",i=document.getElementById(t).value.split("\\"),l=i[i.length-1];o+=l,""!==l&&$.ajaxFileUpload({url:o,secureuri:!1,fileElementId:t,dataType:"json",timeout:36e5,success:function(){e({success:!0,message:"上传态势图文件成功"})},error:function(){e({success:!1,message:"上传态势图文件失败"})}})},addSmlFileToLayer:function(t,e,o){var i=this.serverUrl+"smlInfos/",l=document.getElementById(t).value.split("\\"),n=l[l.length-1];i+=n;var a=this;""!==n&&$.ajaxFileUpload({url:i,secureuri:!1,fileElementId:t,dataType:"json",timeout:36e5,success:function(){a.addSmlFileToLayerOnServer(n,e,o)},error:function(){o({success:!1,message:"打开本地文件失败"})}})},addSmlFileOnServer:function(t,e,o){var i=new SuperMap.EditSmlFileParameters;i.method="GET",i.smlFileName=t,L.supermap.smlFileService(this.serverUrl,this.options.serviceParams).editSMLFile(i,function(t){if(t.result.succeed){var i=t.result;this.smlInfo.fromJSON(i.smlInfo);for(var l=i.layerDatas,n=null,a=0;a<l.length;a++){var s=[];l[a].layerName&&(s=this.map.getLayersByName(l[a].layerName)),0!==s.length?n=s[0]:e&&((n=L.supermap.plotting.plottingLayer(l[a].layerName,this.serverUrl,{serviceParams:this.options.serviceParams})).spatialAnalystUrl=l[a].spatialAnalystUrl,this.map.addLayer(n)),null!==n&&this._load(l[a],n)}null!==n&&"function"==typeof o?o({success:!0,smlFileName:this.smlFileName,sitDataLayers:this.map.getPlottingLayers()}):"function"==typeof o&&o({success:!1,message:"态势图文件不存在与当前态势图同名的图层"})}else"function"==typeof o&&o({success:!1,message:"从服务器上获取态势图文件失败"})},this)},addSmlFileToLayerOnServer:function(t,e,o){var i=new SuperMap.EditSmlFileParameters;i.method="GET",i.smlFileName=t,L.supermap.smlFileService(this.serverUrl,this.options.serviceParams).editSMLFile(i,function(t){if(t.result.succeed){var i=t.result;this.smlInfo.fromJSON(i.smlInfo);var l=i.layerDatas,n=null,a=this.map.getLayersByName(e);0!==a.length?n=a[0]:(n=L.supermap.plotting.plottingLayer(e,this.serverUrl,{serviceParams:this.options.serviceParams}),this.map.addLayer(n));for(var s=0;s<l.length;s++)this._load(l[s],n);"function"==typeof o&&o({success:!0,smlFileName:this.smlFileName,sitDataLayers:this.map.getPlottingLayers()})}else"function"==typeof o&&o({success:!1,message:"从服务器上获取态势图失败"})},this)},downloadSmlFileURL:function(t){return"smlFileDownload/"+t+".sml"},newSmlFile:function(){this.smlFileName="",this.smlInfo.destroy(),this.map.clearPlottingLayers()},saveSmlFile:function(t){var e=this.map.getPlottingLayers();this._save(this.smlFileName,e,!0,t)},saveAsSmlFile:function(t,e){var o=this.map.getPlottingLayers();this._save(t,o,!1,e)},getSMLInfo:function(t,e){var o=new SuperMap.EditSmlFileParameters;o.method="GET",o.smlFileName=t,L.supermap.smlFileService(this.serverUrl,this.options.serviceParams).editSMLFile(o,function(t){t.result.succeed&&"function"==typeof e?e({success:!0,smlInfo:t.result.smlInfo}):"function"==typeof e&&e({success:!1})},this)},getSMLInfos:function(t,e,o){var i=t*e,l=e,n=new SuperMap.GetSMLInfosParameters;n.start=i,n.count=l,L.supermap.smlFileService(this.serverUrl,this.options.serviceParams).getSMLInfos(n,function(t){t.result.succeed&&"function"==typeof o?o({success:!0,smlInfoList:t.result}):"function"==typeof o&&o({success:!1})},this)},_getCompletedInit:function(t,e){if(this.smlFileName=e,this.smlInfo.fromJSON(t.smlInfo),t.mapInfo){var o=new SuperMap.Plot.MapInfoStruct;o.fromJSON(t.mapInfo),null!==o.zoom&&null!==o.centerX&&null!==o.centerY&&this.map.setView(L.latLng(o.centerY,o.centerX),o.zoom,{reset:!0})}var i,l=t.layerDatas;this.map.clearPlottingLayers();for(var n=0,a=l.length;n<a;n++)(i=l[n].useCanvas||l[n].useCanvas2?L.supermap.plotting.plottingLayer(l[n].layerName,this.serverUrl,{renderer:L.canvas(),serviceParams:this.options.serviceParams}):L.supermap.plotting.plottingLayer(l[n].layerName,this.serverUrl,{renderer:L.svg(),serviceParams:this.options.serviceParams})).spatialAnalystUrl=l[n].spatialAnalystUrl,this.map.addLayer(i),this._load(l[n],i),void 0!==l[n].isEditable&&null!==l[n].isEditable&&i.setEditable(l[n].isEditable),void 0!==l[n].isLocked&&null!==l[n].isLocked&&i.setLocked(l[n].isLocked),void 0!==l[n].visibility&&null!==l[n].visibility&&i.setVisibility(l[n].visibility)},openSmlFileOnServer:function(t,e){var o=new SuperMap.EditSmlFileParameters;o.method="GET",o.smlFileName=t,L.supermap.smlFileService(this.serverUrl,this.options.serviceParams).editSMLFile(o,function(o){o.result.succeed?(this._getCompletedInit(o.result,t),"function"==typeof e&&e({success:!0,smlFileName:this.smlFileName,sitDataLayers:this.map.getPlottingLayers()})):"function"==typeof e&&e({success:!1,message:"打开已发布的态势图文件失败"})},this)},deleteSmlFileOnServer:function(t,e){var o=new SuperMap.EditSmlFileParameters;o.method="DELETE",o.smlFileName=t,L.supermap.smlFileService(this.serverUrl,this.options.serviceParams).editSMLFile(o,function(t){t.result.succeed&&"function"==typeof e?e({success:!0}):"function"==typeof e&&e({success:!1})},this)},_save:function(t,e,o,i){var l=new SuperMap.Plot.SitDataStruct;l.smlInfo=this.smlInfo;var n=new SuperMap.Plot.MapInfoStruct;n.zoom=this.map.getZoom(),n.centerX=this.map.getCenter().lng,n.centerY=this.map.getCenter().lat,l.mapInfo=n,l.layerDatas=[];for(var a=0;a<e.length;a++){var s=e[a].features,r=new SuperMap.Plot.LayerDataStruct;r.layerName=e[a].name,r.spatialAnalystUrl=e[a].spatialAnalystUrl,this.map instanceof L.Map?this.map.getRenderer(e[a])instanceof L.Canvas&&(r.useCanvas=!0):(r.useCanvas=e[a].useCanvas,r.useCanvas2=e[a].useCanvas2),r.isEditable=e[a].getEditable(),r.isLocked=e[a].getLocked(),r.visibility=e[a].getVisibility(),r.features=s,l.layerDatas.push(r)}var u=new SuperMap.EditSmlFileParameters;u.method="POST",u.sitData=l,u.smlFileName=t,u.isCover=o,L.supermap.smlFileService(this.serverUrl,this.options.serviceParams).editSMLFile(u,function(t){t.result.succeed&&"function"==typeof i?i({success:!0}):"function"==typeof i&&i({success:!1})},this)},_load:function(t,e){e.spatialAnalystUrl=t.spatialAnalystUrl;for(var o=0,i=t.features.length;o<i;o++){var l=t.features[o];if(null!==l){var n;l.resolution?n=this.map.getZoom():l.fromZoom&&(n=l.fromZoom),!1===l.scaleByMap&&(n=this.map.getZoom()),l.hasOwnProperty("isEdit")||(l.isEdit=!0);var a=l.uuid;e.createSymbol(l.libID,l.code,void 0,a,{},{serverUrl:this.serverUrl,symbolData:l,fromZoom:n,map:this.map})}}}}),l=e.sitDataManager=function(t,e,o){return new i(t,e,o)};L.supermap.plotting.sitDataManager=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.goAnimationManager=e.GOAnimationManager=void 0,o(0);var i=o(34),l=o(33),n=o(32),a=o(31),s=o(30),r=o(29),u=o(28),p=o(7),h=e.GOAnimationManager=L.Evented.extend({serverUrl:null,goAnimations:null,map:null,goAnimationLayer:null,options:{serviceParams:{proxy:null,withCredentials:!1,crossOrigin:null,headers:null,serverType:null}},initialize:function(t,e,o){null===this.goAnimations&&(this.goAnimations=[]),t&&null!==t&&null===this.map&&this.setMap(t),e&&null===this.serverUrl&&(h.prototype.serverUrl=e),o&&SuperMap.Util.extend(this.options,o)},destroy:function(){h.prototype.goAnimations=null,h.prototype.map.removeLayer(this.goAnimationLayer),this.goAnimationLayer.destroy(),h.prototype.goAnimationLayer=null,h.prototype.map=null,h.prototype.serverUrl=null},setMap:function(t){if(null===t)return!1;h.prototype.map=t;null===this.goAnimationLayer&&(h.prototype.goAnimationLayer=L.supermap.plotting.animationLayer("animation",{displayInLayerSwitcher:!1})),this.map.addLayer(this.goAnimationLayer)},createGOAnimation:function(t,e,o){var i,l=this.createGOAnimationByType(t,e);if(null===l)return null;if(o._eventParents)for(var n in o._eventParents)i=o._eventParents[n];return o instanceof L.supermap.plotting.Route||i instanceof L.supermap.plotting.Route?null:l.setGOFeature(o)?(this.goAnimations.push(l),l):null},findGOAnimationByName:function(t){if(null===this.goAnimations||null===t||""===t)return null;for(var e=null,o=0;o<this.goAnimations.length;o++)if(this.goAnimations[o].name===t){e=this.goAnimations[o];break}return e},findGOAnimationsByFeature:function(t){var e=[];if(null===this.goAnimations||"undefined"===t||null===t)return e;for(var o=0;o<this.goAnimations.length;o++)this.goAnimations[o].getGOFeature()===t&&e.push(this.goAnimations[o]);return e},findGOAnimationsByUuid:function(t){if(null===this.goAnimations||"undefined"===t||null===t)return[];var e=this.map.getFeatureByUuid(t);return this.findGOAnimationsByFeature(e)},removeGOAnimationByName:function(t){if(null===this.goAnimations||null===t||""===t)return!1;var e=this.findGOAnimationByName(t);return this.removeGOAnimation(e)},removeGOAnimation:function(t){if(null===this.goAnimations||null===t)return!1;for(var e=0;e<this.goAnimations.length;e++)if(this.goAnimations[e]===t){t.reset(),this.goAnimations.splice(e,1),t.destroy();break}return!0},removeAllGOAnimation:function(){if(null!==this.goAnimations){for(var t=0;t<this.goAnimations.length;t++)this.removeGOAnimation(this.goAnimations[t]);this.goAnimations=[]}},execute:function(){if(0===this.goAnimations.length)return!1;for(var t=0;t<this.goAnimations.length;t++)this.goAnimations[t].execute();if(this.hasGrowAnimation())for(var e=0;e<this.goAnimations.length;e++)this.redrawFeature(this.goAnimations[e].animationGOFeature);return 0!==this.goAnimations.length||void 0},hasGrowAnimation:function(){if(null===this.goAnimations)return!1;for(var t=0;t<this.goAnimations.length;t++)if(!0===this.goAnimations[t].animationGOFeature.grow&&this.goAnimations[t].canExecute())return!0},redrawFeature:function(t){if(!(t.grow&&t instanceof p.AlgoSymbol))return!0;var e=new SuperMap.GetSymbolInfoParameters;e.libID=t.libID,e.code=t.code,e.surroundLineType=t.surroundLineType,e.inputPoints=L.Util.latLngsToSuperMapPoints(t.getLatLngs()),e.subSymbols=t.subSymbols,e.scaleValues=t.scaleValues,L.supermap.symbolInfoService(t.serverUrl,this.options.serviceParams).getSymbolInfo(e,function(e){t.symbolData.innerCells=e.result.innerCells,t.redraw()},this)},play:function(){if(0!==this.goAnimations.length)for(var t=0;t<this.goAnimations.length;t++)this.goAnimations[t].play()},stop:function(){if(0!==this.goAnimations.length)for(var t=0;t<this.goAnimations.length;t++)this.goAnimations[t].stop()},pause:function(){if(0!==this.goAnimations.length)for(var t=0;t<this.goAnimations.length;t++)this.goAnimations[t].pause()},reset:function(){if(0!==this.goAnimations.length)for(var t=0;t<this.goAnimations.length;t++)this.goAnimations[t].reset()},createGOAnimationByType:function(t,e){if(null===e||""===e||null===this.goAnimationLayer)return null;if(null!==this.findGOAnimationByName(e))return null;var o=null;switch(t){case SuperMap.Plot.GOAnimationType.ANIMATION_WAY:o=new u.GOAnimationWay;break;case SuperMap.Plot.GOAnimationType.ANIMATION_BLINK:o=new l.GOAnimationBlink;break;case SuperMap.Plot.GOAnimationType.ANIMATION_ATTRIBUTE:o=new i.GOAnimationAttribute;break;case SuperMap.Plot.GOAnimationType.ANIMATION_SHOW:o=new r.GOAnimationShow;break;case SuperMap.Plot.GOAnimationType.ANIMATION_ROTATE:o=new a.GOAnimationRotate;break;case SuperMap.Plot.GOAnimationType.ANIMATION_SCALE:o=new s.GOAnimationScale;break;case SuperMap.Plot.GOAnimationType.ANIMATION_GROW:o=new n.GOAnimationGrow;break;default:return null}return null!==o&&(o.name=e),o},getJSONData:function(){for(var t={animations:[]},e=0;e<this.goAnimations.length;e++)t.animations.push(this.goAnimations[e].getJSONData());return t},fromJSONData:function(t){for(var e=0;e<t.animations.length;e++){var o=t.animations[e],i=o.goFeatureUuid,l=this.map.getFeatureByUuid(i),n=o.name,a=o.type;if(l&&n&&-1!==a){var s=this.createGOAnimation(a,n,l);null!==s&&s.fromJSONData(o)}}},saveEvoFile:function(){},openEvoFileOnServer:function(){}}),c=e.goAnimationManager=function(t,e,o){return new h(t,e,o)};L.supermap.plotting.goAnimationManager=c},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DrawGraphicObject=void 0,o(0);var i=o(4),l=o(1),n=o(8);e.DrawGraphicObject=L.Handler.extend({symbolData:null,plotting:null,_isDrawing:!1,libID:0,code:24,serverUrl:"",isFreeCure:!1,_drawingLayer:null,_tempDrawingLayer:null,_control:null,options:{tolerancePixel:6,allowIntersection:!0,repeatMode:!0,icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,nautic:!1,showLength:!0,zIndexOffset:2e3},initialize:function(t,e,o){L.Browser.touch&&L.supermap.plotting.getControl().getTouchMode()&&(this.options.icon=this.options.touchIcon),this._map=t,this._drawingLayer=e,this._tempDrawingLayer=new n.PlottingLayerBase("drawControl-temportary"),this._container=t._container,this._overlayPane=t._panes.overlayPane,L.setOptions(this,o)},addHooks:function(){this._map&&(this._isDrawing=!1,this._markers=[],this._latlngs=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._map.addLayer(this._tempDrawingLayer),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mousedown",this._onMouseDown,this).on("mouseup",this._onMouseUp,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("zoomend",this._onZoomEnd,this),this._map.getPlotEditControl()&&this._map.getPlotEditControl()._avoidEditing&&this._map.getPlotEditControl().avoidEdit(!1),null!=this._map.doubleClickZoom&&this._map.doubleClickZoom.enabled()&&(this.doubleClickZoomEnabled=!0,this._map.doubleClickZoom.disable()))},removeHooks:function(){this._isDrawing=!1,this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,delete this._latlngs,delete this.isFreeCure,this.plotting&&(this._tempDrawingLayer.removeFeatures(this.plotting),delete this.plotting,this.plotting=null),this._map.removeLayer(this._tempDrawingLayer),this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseup",this._onMouseUp,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",this._onZoomEnd,this).off("click",this._onTouch,this),null!=this._map.doubleClickZoom&&!0===this.doubleClickZoomEnabled&&this._map.doubleClickZoom.enable()},deleteLastVertex:function(){if(!(this._markers.length<=1)){this._latlngs.pop();var t=this._markers.pop(),e=this.plotting.getLatLngs(),o=e.splice(-1,1)[0];this.plotting.setLatLngs(e),this._markerGroup.removeLayer(t),this.plotting.getLatLngs().length<2&&this._tempDrawingLayer.removeFeatures(this.plotting),this._vertexChanged(o,!1)}},addVertex:function(t){if(this._markers.push(this._createMarker(t)),this._latlngs.push(t),this.plotting&&0===this.libID&&1023===this.code&&!0===this.isFreeCure)this.plotting.addLatLng(t);else if(this.plotting&&SuperMap.Plot.AlgoSymbolFactory.isAccessServer(this.plotting.libID,this.plotting.code)&&this._latlngs.length>=this.plotting.minEditPts){var e=new SuperMap.GetSymbolInfoParameters({libID:this.libID,code:this.code});e.inputPoints=L.Util.latLngsToSuperMapPoints(this._latlngs),L.supermap.symbolInfoService(this._drawingLayer.serverUrl,this._drawingLayer.options.serviceParams).getSymbolInfo(e,function(t){this.plotting.symbolData=t.result,this.plotting.setLatLngs(this._latlngs)},this)}else if(this.plotting&&this.plotting instanceof i.Route){var o=this._map.layerPointToLatLng(L.point(0,0)),l=this._map.layerPointToLatLng(L.point(this.options.tolerancePixel,0)),n=SuperMap.Plot.PlottingUtil.distance({x:o.lng,y:o.lat},{x:l.lng,y:l.lat});this.plotting._addRouteNodeByPos(t,n)}else this.plotting&&this.plotting.setLatLngs(this._latlngs);this._vertexChanged(t,!0)},_finishShape:function(){this._markers.length>1&&this._markers[this._markers.length-1].off("click",this._finishShape,this),L.Browser.touch&&L.supermap.plotting.getControl().getTouchMode()&&this._latlngs.length+1<this.plotting.maxEditPts&&"function"==typeof this.plotting.getLatLngs&&this._latlngs.length!==this.plotting.getLatLngs().length&&this.plotting.setLatLngs(this._latlngs),0===this.libID&&this.code===SuperMap.Plot.SymbolType.FREECURVE&&!0===this.isFreeCure&&(this.plotting.latLngs=L.Util.superMapPointsToLatLngs(this.plotting.superMapAlgoSymbol.controlPoints),this.isFreeCure=!1),-1===this.plotting.libID&&(this.plotting.libID=this.libID,this.plotting.code=this.code);var t=this.plotting.clone();if(this._markerGroup.clearLayers(),this._markers=[],this._latlngs=[],this._tempDrawingLayer.removeFeatures(this.plotting),delete this.plotting,this._drawingLayer.addFeatures(t),this._drawingLayer._renderer instanceof L.SVG&&(t.isFirstAdd=!0),this._control.fire(SuperMap.Plot.Event.featureadded,{feature:t}),this._isDrawing=!1,this.options.repeatMode||this.disable(),null!=t.layer){var e=new SuperMap.Plot.Transaction;e.transType=SuperMap.Plot.TransactionType.CREATE;var o=new SuperMap.Plot.TransactionInfo;o.layerId=t.layer._leaflet_id,o.feature=t,e.transInfos.push(o),L.supermap.plotting.getControl(this._map,this.serverUrl,{serviceParams:this._drawingLayer.options.serviceParams}).getTransManager().add(e)}},_onZoomEnd:function(){this._markers},_onMouseMove:function(t){var e=this._map.mouseEventToLayerPoint(t.originalEvent),o=this._map.layerPointToLatLng(e);if(this._currentLatLng=o,!this.plotting||!0!==this._isDrawing||this.plotting instanceof i.Route)!1===this._isDrawing&&(this._isDrawing=!0,this._createFeature());else{var l=L.Util.cloneLatLngs(this._latlngs);if(0===l.length?l.push(o):l[l.length-1].lat===o.lat&&l[l.length-1].lng===o.lng||l.push(o),0===this.libID&&this.code===SuperMap.Plot.SymbolType.FREECURVE&&!0===this.isFreeCure)this.plotting.addLatLng(o);else if(this.plotting.symbolType!==SuperMap.Plot.SymbolType.DOTSYMBOL&&SuperMap.Plot.AlgoSymbolFactory.isAccessServer(this.plotting.libID,this.plotting.code)&&l.length>=this.plotting.minEditPts){var n=new SuperMap.GetSymbolInfoParameters({libID:this.libID,code:this.code});n.inputPoints=L.Util.latLngsToSuperMapPoints(l),L.supermap.symbolInfoService(this._drawingLayer.serverUrl,this._drawingLayer.options.serviceParams).getSymbolInfo(n,function(t){this.plotting.symbolData=t.result,this.plotting.setLatLngs(l)},this)}else this.plotting.setLatLngs(l)}this._mouseMarker.setLatLng(o),L.DomEvent.preventDefault(t.originalEvent)},_createFeature:function(t){if(SuperMap.Plot.AlgoSymbolFactory.isAccessServer(this.libID,this.code))if(this.symbolData=this._drawingLayer._getSymbolDataFromCache(this.libID,this.code),null===this.symbolData){var e=Math.floor(1e3*Math.random()),o=new SuperMap.GetSymbolInfoParameters({libID:this.libID,code:this.code});o.dynamicToken=e,L.supermap.symbolInfoService(this._drawingLayer.serverUrl,this._drawingLayer.options.serviceParams).getSymbolInfo(o,function(o){o.result.dynamicToken&&o.result.dynamicToken===SuperMap.MD5.md5(e.toString())?this.libID!==o.result.libID||this.code!==o.result.code?this.symbolData=null:(this._drawingLayer._cacheSymbolData(o.result),this.symbolData=o.result,this.plotting=L.supermap.plotting.PlottingObject.createSymbol(this.libID,this.code,[],{symbolData:this.symbolData,serverUrl:this._drawingLayer.serverUrl,serviceParams:this._drawingLayer.serviceParams,map:this._map}),this._control.fire(SuperMap.Plot.Event.beforefeatureadded,{feature:this.plotting}),this._tempDrawingLayer.addFeatures(this.plotting),this.plotting.isEdit=!1,"function"==typeof t&&t()):this.symbolData=null},this)}else this.plotting=L.supermap.plotting.PlottingObject.createSymbol(this.libID,this.code,[],{symbolData:this.symbolData,serverUrl:this._drawingLayer.serverUrl,serviceParams:this._drawingLayer.serviceParams,map:this._map}),this._control.fire(SuperMap.Plot.Event.beforefeatureadded,{feature:this.plotting}),this._tempDrawingLayer.addFeatures(this.plotting),this.plotting.isEdit=!1,"function"==typeof t&&t();else if(this.plotting=L.supermap.plotting.PlottingObject.createSymbol(this.libID,this.code,[],{serverUrl:this._drawingLayer.serverUrl,spatialAnalystUrl:this._drawingLayer.spatialAnalystUrl,serviceParams:this._drawingLayer.serviceParams,map:this._map}),this.plotting.subSymbols&&0!==this.plotting.subSymbols.length){for(var i=[],l=0,n=this.plotting.subSymbols.length;l<n;l++)null===this.plotting.subSymbols[l].symbolData&&(this.plotting.subSymbols[l].symbolData=this._drawingLayer._getSymbolDataFromCache(this.plotting.subSymbols[l].libID,this.plotting.subSymbols[l].code),null===this.plotting.subSymbols[l].symbolData&&-1===SuperMap.Util.indexOf(i,this.plotting.subSymbols[l])&&i.push(this.plotting.subSymbols[l]));for(var a=i.slice(),s=0;s<i.length;s++){var r=new SuperMap.GetSymbolInfoParameters({libID:i[s].libID,code:i[s].code});L.supermap.symbolInfoService(this.serverUrl,this._drawingLayer.options.serviceParams).getSymbolInfo(r,function(e){this._drawingLayer._cacheSymbolData(e.result);for(var o=0,i=this.plotting.subSymbols.length;o<i;o++)if(null===this.plotting.subSymbols[o].symbolData&&this.plotting.subSymbols[o].libID===e.result.libID&&this.plotting.subSymbols[o].code===e.result.code){var l=SuperMap.Util.indexOf(a,this.plotting.subSymbols[o]);-1!==l&&a.splice(l,1),this.plotting.subSymbols[o].symbolData=SuperMap.Plot.PlottingUtil.cloneObject(e.result)}0===a.length&&(this._control.fire(SuperMap.Plot.Event.beforefeatureadded,{feature:this.plotting}),this._tempDrawingLayer.addFeatures(this.plotting),this.plotting.isEdit=!1,"function"==typeof t&&t())},this)}0===i.length&&(this._control.fire(SuperMap.Plot.Event.beforefeatureadded,{feature:this.plotting}),this._tempDrawingLayer.addFeatures(this.plotting),this.plotting.isEdit=!1,"function"==typeof t&&t())}else this._control.fire(SuperMap.Plot.Event.beforefeatureadded,{feature:this.plotting}),this._tempDrawingLayer.addFeatures(this.plotting),this.plotting.isEdit=!1,"function"==typeof t&&t()},_vertexChanged:function(){var t=this._markers.length;t>1&&this._markers[t-1].on("click",this._finishShape,this),t>2&&this._markers[t-2].off("click",this._finishShape,this)},_onMouseDown:function(t){if((!t||2!==t.originalEvent.button)&&!this._clickHandled&&!this._touchHandled&&!this._disableMarkers&&this._drawingLayer&&this._drawingLayer.isEditable&&this._drawingLayer._map){this._onMouseMove(t),this._clickHandled=!0,this._disableNewMarkers();var e=t.originalEvent,o=e.clientX,i=e.clientY;this._startPoint.call(this,o,i)}},_startPoint:function(t,e){0===this.libID&&this.code===SuperMap.Plot.SymbolType.FREECURVE&&(this.isFreeCure=!0),this._mouseDownOrigin=L.point(t,e)},_onMouseUp:function(t){!L.Browser.ie||null!==this._mouseDownOrigin&&void 0!==this._mouseDownOrigin||this._onMouseDown.call(this,t);var e=t.originalEvent,o=e.clientX,i=e.clientY;this._endPoint.call(this,o,i,t),this._clickHandled=null,L.DomEvent.stopPropagation(t)},_endPoint:function(t,e,o){if(this._mouseDownOrigin){var i=L.point(t,e).distanceTo(this._mouseDownOrigin),n=this._calculateFinishDistance(o.latlng);if(L.Browser.touch&&L.supermap.plotting.getControl().getTouchMode()&&null==this.plotting){var a=this;this._createFeature(function(){a._latlngs.push(o.latlng),a.plotting.setLatLngs(a._latlngs),(a.plotting instanceof l.GraphicObject||a.plotting instanceof L.supermap.plotting.Route)&&(a._latlngs.length+1>=a.plotting.maxEditPts||n<20&&L.Browser.touch)?a._finishShape():Math.abs(i)<9*(window.devicePixelRatio||1)&&a.addVertex(o.latlng),a._enableNewMarkers()})}else(this.plotting instanceof l.GraphicObject||this.plotting instanceof L.supermap.plotting.Route)&&(this._latlngs.length+1>=this.plotting.maxEditPts||n<20&&L.Browser.touch)?this._finishShape():Math.abs(i)<9*(window.devicePixelRatio||1)&&this.addVertex(o.latlng),this._enableNewMarkers()}this._mouseDownOrigin=null},_onTouch:function(t){var e,o,i=t.originalEvent;!i.touches||!i.touches[0]||this._clickHandled||this._touchHandled||this._disableMarkers||(e=i.touches[0].clientX,o=i.touches[0].clientY,this._disableNewMarkers(),this._touchHandled=!0,this._startPoint.call(this,e,o),this._endPoint.call(this,e,o,t),this._touchHandled=null),this._clickHandled=null},_calculateFinishDistance:function(t){var e;if(this._markers.length>0){var o=this._markers[this._markers.length-1],i=this._map.latLngToContainerPoint(o.getLatLng()),l=new L.Marker(t,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset}),n=this._map.latLngToContainerPoint(l.getLatLng());e=i.distanceTo(n)}else e=1/0;return e},_createMarker:function(t){var e=new L.Marker(t,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(e),e},_disableNewMarkers:function(){this._disableMarkers=!0},_enableNewMarkers:function(){setTimeout(function(){this._disableMarkers=!1}.bind(this),50)}})},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GOAnimationWay=void 0,o(0);var i=o(3),l=e.GOAnimationWay=i.GOAnimation.extend({showPath:!1,tangentDirection:!1,pathWidth:.5,pathColor:"#00FFFF",currentPt:null,pathType:SuperMap.Plot.WayPathType.POLYLINE,wayPoints:null,shapePoints:null,pathFeature:null,pathLength:0,destroy:function(){null!==this.pathFeature&&(L.supermap.plotting.getControl().getGOAnimationManager().map.removeLayer(this.pathFeature),this.pathFeature=null);i.GOAnimation.prototype.destroy.call(this)},getGOAnimationType:function(){return SuperMap.Plot.GOAnimationType.ANIMATION_WAY},setShowPath:function(t){this.showPath=t},resetAnimationFeature:function(t){i.GOAnimation.prototype.resetAnimationFeature.call(this,t);var e=this.goFeature.dRotate,o=this.animationGOFeature.dRotate;this.animationGOFeature._rotate(e-o,this.animationGOFeature.getLatLngs()[0]),t&&(null!==this.pathFeature&&null!==this.shapePoints||(this._makePath(),this.pathColor&&(this.pathFeature.options.color=this.pathColor),this.pathWidth&&(this.pathFeature.options.weight=this.pathWidth)),this.pathFeature.options.opacity=0,1!==this.animationGOFeature.symbolType&&(this.pathFeature.options.opacity=0),this.pathFeature.setStyle())},execute:function(){if(this.goFeature.symbolType!==SuperMap.Plot.SymbolType.DOTSYMBOL)return null!==this.pathFeature&&(this.pathFeature.options.opacity=0),!1;if(!this.canExecute())return!1;this.showPath&&0===this.pathFeature.options.opacity&&(this.pathFeature.options.opacity=1,this.pathFeature.setStyle());var t=this.ratio,e=t*this.pathLength,o=new Object,i=this._findPos(e,this.shapePoints,o);this.currentPt=i.clone();var l=this.animationGOFeature.getLatLngs()[0],n=i.y-l.lat,a=i.x-l.lng;if(this.animationGOFeature.move(n,a),this.tangentDirection){var s=o.angle;1===t&&(s=0);var r=this.animationGOFeature.dRotate;this.animationGOFeature._rotate(s-r,this.animationGOFeature.getLatLngs()[0])}return!0},setWayPoints:function(t){((!t||!SuperMap.Util.isArray(t)||2>t.length)&&(t=[this.goFeature.getLatLngs()[0],this.goFeature.getLatLngs()[0]]),this.wayPoints=[],this.wayPoints=L.Util.cloneLatLngs(t),null!==this.pathFeature)&&(L.supermap.plotting.getControl().getGOAnimationManager().map.removeLayer(this.pathFeature),this.pathFeature.destroy(),this.pathFeature=null)},getWayPoints:function(){return this.wayPoints},getCurrentPt:function(){return this.currentPt},setPathColor:function(t){t&&(this.pathColor=t,this.pathFeature&&null!==this.pathFeature&&(this.pathFeature.options.color=this.pathColor,this.pathFeature.setStyle(this.pathFeature.options)))},getPathColor:function(){return this.pathColor},setPathWidth:function(t){t&&(this.pathWidth=t,this.pathFeature&&null!==this.pathWidth&&(this.pathFeature.options.weight=this.pathWidth,this.pathFeature.setStyle(this.pathFeature.options)))},getPathWidth:function(){return this.pathWidth},setPathType:function(t){void 0!==t&&null!==t&&(this.pathType!==t&&(this.pathType=t,null!==this.pathFeature&&(L.supermap.plotting.getControl().getGOAnimationManager().map.removeLayer(this.pathFeature),this.pathFeature.destroy(),this.pathFeature=null)))},getPathType:function(){return this.pathType},_makePath:function(){((null===this.wayPoints||2>this.wayPoints.length)&&(this.wayPoints=[this.goFeature.getLatLngs()[0],this.goFeature.getLatLngs()[0]]),null===this.pathFeature)&&(this.pathType===SuperMap.Plot.WayPathType.POLYLINE?this.shapePoints=L.Util.latLngsToSuperMapPoints(this.wayPoints):this.shapePoints=SuperMap.Plot.PlottingUtil.generateBeizerPointsNoCtrlPt(L.Util.latLngsToSuperMapPoints(this.wayPoints)),this.pathFeature=L.polyline(L.Util.superMapPointsToLatLngs(this.shapePoints),SuperMap.Plot.PlottingUtil.cloneObject(this.animationGOFeature.style)),L.supermap.plotting.getControl().getGOAnimationManager().map.addLayer(this.pathFeature));this.pathLength=0;for(var t=1;t<this.shapePoints.length;t++)this.pathLength+=SuperMap.Plot.PlottingUtil.distance(this.shapePoints[t-1],this.shapePoints[t]);return this.pathFeature},_findPos:function(t,e,o){var i,l=0,n=0;for(i=1;i<e.length&&!(l+(n=SuperMap.Plot.PlottingUtil.distance(e[i-1],e[i]))>=t);i++)l+=n;var a=SuperMap.Plot.PlottingUtil.findPoint(e[i-1],e[i],t-l,0);return this.tangentDirection&&(o.angle=SuperMap.Plot.PlottingUtil.radian(a,e[i])/Math.PI*180),a},getJSONData:function(){var t=i.GOAnimation.prototype.getJSONData.call(this);t.showPath=this.showPath,t.tangentDirection=this.tangentDirection,t.pathType=this.pathType,t.pathWidth=this.pathWidth,t.pathColor=this.pathColor,t.wayPoints=[];for(var e=0;e<this.wayPoints.length;e++)t.wayPoints.push({x:this.wayPoints[e].lng,y:this.wayPoints[e].lat});return t},fromJSONData:function(t){i.GOAnimation.prototype.fromJSONData.call(this,t),this.showPath=t.showPath,this.tangentDirection=t.tangentDirection,this.pathType=t.pathType,this.pathWidth=t.pathWidth,this.pathColor=t.pathColor;for(var e=[],o=0;o<t.wayPoints.length;o++)e.push(L.latLng(t.wayPoints[o].y,t.wayPoints[o].x));this.setWayPoints(e)}});L.supermap.plotting.GOAnimationWay=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GOAnimationShow=void 0,o(0);var i=o(3),l=e.GOAnimationShow=i.GOAnimation.extend({showEffect:!1,finalDisplay:!1,getGOAnimationType:function(){return SuperMap.Plot.GOAnimationType.ANIMATION_SHOW},execute:function(){if(!this.canExecute())return!1;var t=this.ratio;return this.showEffect?this._executeHaveEffect(t):this._executeNoEffect(t),!0},_executeNoEffect:function(t){this.finalDisplay?this.animationGOFeature.style.display=1-t<.01?"display":"none":this.animationGOFeature.style.display=1-t<.01?"none":"display",this.animationGOFeature.redraw()},_executeHaveEffect:function(t){this.finalDisplay||(t=1-t);var e=parseFloat(t)<0||parseFloat(t);e=parseFloat(t)>1?1:parseFloat(t),this.animationGOFeature.style.display="display",this.animationGOFeature.style.opacity=e,this.animationGOFeature.style.fontOpacity=e,this.animationGOFeature.style.surroundLineColorOpacity=this.goFeature.style.surroundLineColorOpacity*t,this.animationGOFeature.style.fill&&(this.animationGOFeature.style.fillOpacity=this.goFeature.style.fillOpacity*t,this.animationGOFeature.style.fillBackOpacity=this.goFeature.style.fillBackOpacity*t),this.animationGOFeature.redraw()},getJSONData:function(){var t=i.GOAnimation.prototype.getJSONData.call(this);return t.showEffect=this.showEffect,t.finalDisplay=this.finalDisplay,t},fromJSONData:function(t){i.GOAnimation.prototype.fromJSONData.call(this,t),this.showEffect=t.showEffect,this.finalDisplay=t.finalDisplay}});L.supermap.plotting.GOAnimationShow=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GOAnimationScale=void 0,o(0);var i=o(3),l=e.GOAnimationScale=i.GOAnimation.extend({startScale:0,endScale:1,lastScale:null,getGOAnimationType:function(){return SuperMap.Plot.GOAnimationType.ANIMATION_SCALE},resetAnimationFeature:function(t){this.lastScale=null,this.animationGOFeature._resize(this.goFeature.initialScale.x/this.animationGOFeature.initialScale.x,this.animationGOFeature.getLatLngs()[0]),i.GOAnimation.prototype.resetAnimationFeature.call(this,t)},execute:function(){if(this.goFeature.symbolType!==SuperMap.Plot.SymbolType.DOTSYMBOL)return!1;if(!this.canExecute())return!1;this.lastScale=this.animationGOFeature.initialScale.x;var t=this.startScale;0===t&&(t=.1);var e=this.endScale;0===e&&(e=.1);var o=this.goFeature.initialScale.x*(t+this.ratio*(e-t));return this.animationGOFeature._resize(o/this.lastScale,this.animationGOFeature.getLatLngs()[0]),!0},getJSONData:function(){var t=i.GOAnimation.prototype.getJSONData.call(this);return t.startScale=this.startScale,t.endScale=this.endScale,t},fromJSONData:function(t){i.GOAnimation.prototype.fromJSONData.call(this,t),this.startScale=t.startScale,this.endScale=t.endScale}});L.supermap.plotting.GOAnimationScale=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GOAnimationRotate=void 0,o(0);var i=o(3),l=e.GOAnimationRotate=i.GOAnimation.extend({rotateDirection:SuperMap.Plot.RotateDirection.ClockWise,startAngle:0,endAngle:360,getGOAnimationType:function(){return SuperMap.Plot.GOAnimationType.ANIMATION_ROTATE},resetAnimationFeature:function(t){this.animationGOFeature._rotate(this.goFeature.dRotate-this.animationGOFeature.dRotate,this.animationGOFeature.getLatLngs()[0]),i.GOAnimation.prototype.resetAnimationFeature.call(this,t)},execute:function(){if(this.goFeature.symbolType!==SuperMap.Plot.SymbolType.DOTSYMBOL)return!1;if(!this.canExecute())return!1;var t=this.ratio,e=this._getCurrentAngle(this.startAngle,this.endAngle,t),o=this.animationGOFeature.dRotate;return this.animationGOFeature._rotate(e-o,this.animationGOFeature.getLatLngs()[0]),!0},_getCurrentAngle:function(t,e,o){var i=0,l=e-t,n=parseInt(Math.abs(l/360));if(t!==e)if(this.rotateDirection===SuperMap.Plot.RotateDirection.AntiClockWise)l<0&&(l+=360*(2*n+1)),i=t+l*o;else{var a=0;i=t+(360-(l=0===(a=l<0?l+360*(n+1):l-360*n)?360*n:360-a+360*n)*o)}return i},getJSONData:function(){var t=i.GOAnimation.prototype.getJSONData.call(this);return t.rotateDirection=this.rotateDirection,t.startAngle=this.startAngle,t.endAngle=this.endAngle,t},fromJSONData:function(t){i.GOAnimation.prototype.fromJSONData.call(this,t),this.rotateDirection=t.rotateDirection,this.startAngle=t.startAngle,this.endAngle=t.endAngle}});L.supermap.plotting.GOAnimationRotate=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GOAnimationGrow=void 0,o(0);var i=o(3),l=o(7),n=e.GOAnimationGrow=i.GOAnimation.extend({startScale:0,endScale:1,timeSpace:50,lastDrawTime:0,lineLength:0,controlPoints:[],initialize:function(t){i.GOAnimation.prototype.initialize.call(this,t),this.controlPoints=[],this.lineLength=0},getGOAnimationType:function(){return SuperMap.Plot.GOAnimationType.ANIMATION_GROW},_execute_1004:function(t){if(0===this.lineLength){this.controlPoints=L.Util.latLngsToSuperMapPoints(this.goFeature.getLatLngs());var e=new SuperMap.Geometry.Point((this.controlPoints[0].x+this.controlPoints[1].x)/2,(this.controlPoints[0].y+this.controlPoints[1].y)/2);this.lineLength+=SuperMap.Plot.PlottingUtil.distance(e,this.controlPoints[2]);for(var o=3;o<this.controlPoints.length;o++)this.lineLength+=SuperMap.Plot.PlottingUtil.distance(this.controlPoints[o-1],this.controlPoints[o])}if(0===t)return this._executeAndRatioIsZero(),!0;var i=[],l=[];e=new SuperMap.Geometry.Point((this.controlPoints[0].x+this.controlPoints[1].x)/2,(this.controlPoints[0].y+this.controlPoints[1].y)/2),l.push(e);for(var n=2;n<this.controlPoints.length;n++)l.push(this.controlPoints[n].clone());i.push(this.controlPoints[0]),i.push(this.controlPoints[1]);for(var a=this._findPos(this.lineLength*t,l),s=1;s<=a.pos;s++)i.push(l[s]);return i.push(a.pts),this.animationGOFeature.setLatLngs(L.Util.superMapPointsToLatLngs(i)),!0},_execute_1006:function(t){if(0===this.controlPoints.length){var e=L.Util.latLngsToSuperMapPoints(this.goFeature.getLatLngs());this.controlPoints=SuperMap.Plot.PlottingUtil.operateControlPoints(e)}if(0===t)return this._executeAndRatioIsZero(),!0;var o=this.controlPoints;if(4!=o.length)return!1;var i=o[0],l=o[1],n=o[2],a=o[3],s=SuperMap.Plot.PlottingUtil.distance(i,a),r=SuperMap.Plot.PlottingUtil.distance(l,n),u=SuperMap.Plot.PlottingUtil.linePnt(i,a,s*t),p=SuperMap.Plot.PlottingUtil.linePnt(l,n,r*t),h=[];return h.push(i),h.push(l),h.push(p),h.push(u),null!==this.animationGOFeature.superMapAlgoSymbol&&this.animationGOFeature.superMapAlgoSymbol.hasOwnProperty("m_bIsAnimation")&&(this.animationGOFeature.superMapAlgoSymbol.m_bIsAnimation=!0),this.animationGOFeature.setLatLngs(L.Util.superMapPointsToLatLngs(h)),this.animationGOFeature.superMapAlgoSymbol.m_bIsAnimation=!1,!0},_execute_1002:function(t){if(0===this.lineLength&&(this.controlPoints=L.Util.latLngsToSuperMapPoints(this.goFeature.getLatLngs()),this.lineLength=SuperMap.Plot.PlottingUtil.polylineDistance(this.controlPoints)),0===t)return this._executeAndRatioIsZero(),!0;for(var e=[],o=SuperMap.Plot.PlottingUtil.clonePoints(this.controlPoints),i=this._findPos(this.lineLength*t,o),l=0;l<=i.pos;l++)e.push(o[l]);e.push(i.pts);var n=[];return e.length<3&&(n.push(e[0].clone()),n.push(new SuperMap.Geometry.Point((e[0].x+e[1].x)/2,(e[0].y+e[1].y)/2)),n.push(e[1].clone()),e=n),SuperMap.Plot.AlgoSymbolFactory.isAccessServer(this.animationGOFeature.libID,this.animationGOFeature.code)&&this.goFeature.symbolData.algoMinEditPts>e.length?(this._executeAndRatioIsZero(),!0):(this.animationGOFeature.setLatLngs(L.Util.superMapPointsToLatLngs(e)),!0)},_execute_Generalization:function(t){if(0===this.lineLength&&(this.controlPoints=L.Util.latLngsToSuperMapPoints(this.goFeature.getLatLngs()),this.lineLength=SuperMap.Plot.PlottingUtil.polylineDistance(this.controlPoints)),0===t)return this._executeAndRatioIsZero(),!0;for(var e=[],o=SuperMap.Plot.PlottingUtil.clonePoints(this.controlPoints),i=this._findPos(this.lineLength*t,o),l=0;l<=i.pos;l++)e.push(o[l]);return e.push(i.pts),SuperMap.Plot.AlgoSymbolFactory.isAccessServer(this.animationGOFeature.libID,this.animationGOFeature.code)&&this.goFeature.symbolData.algoMinEditPts>e.length?(this._executeAndRatioIsZero(),!0):(this.animationGOFeature.latLngs=L.Util.superMapPointsToLatLngs(e),this.animationGOFeature.redraw(),!0)},_execute_Rect:function(t){0===this.controlPoints.length&&(this.controlPoints=L.Util.latLngsToSuperMapPoints(this.goFeature.getLatLngs()));var e=new SuperMap.Geometry.Point((this.controlPoints[0].x+this.controlPoints[1].x)/2,(this.controlPoints[0].y+this.controlPoints[1].y)/2),o=Math.abs(this.controlPoints[0].x-this.controlPoints[1].x)/2*t,i=Math.abs(this.controlPoints[0].y-this.controlPoints[1].y)/2*t,l=new SuperMap.Geometry.Point(e.x-o,e.y+i),n=new SuperMap.Geometry.Point(e.x+o,e.y-i);return this.animationGOFeature.setLatLngs(L.Util.superMapPointsToLatLngs([l,n])),!0},_execute_Circle:function(t){0===this.controlPoints.length&&(this.controlPoints=L.Util.latLngsToSuperMapPoints(this.goFeature.getLatLngs()));var e=this.controlPoints[0].clone(),o=t*Math.sqrt((this.controlPoints[0].x-this.controlPoints[1].x)*(this.controlPoints[0].x-this.controlPoints[1].x)+(this.controlPoints[0].y-this.controlPoints[1].y)*(this.controlPoints[0].y-this.controlPoints[1].y));return this.animationGOFeature.setLatLngs(L.Util.superMapPointsToLatLngs([e,new SuperMap.Geometry.Point(e.x+o,e.y)])),!0},_execute_Kidney:function(t){if(0===this.controlPoints.length&&(this.controlPoints=L.Util.latLngsToSuperMapPoints(this.goFeature.getLatLngs())),0===t)return this._executeAndRatioIsZero(),!0;var e=[],o=this.controlPoints.length,i=SuperMap.Plot.PlottingUtil.getPolygonCenterPt(this.controlPoints);if(null===i)return this._executeAndRatioIsZero(),!0;for(var l=0;l<o;l++){var n=SuperMap.Plot.PlottingUtil.distance(i,this.controlPoints[l]),a=n*t;if(a>n)return!1;var s=SuperMap.Plot.PlottingUtil.linePnt(i,this.controlPoints[l],a);e.push(s)}return this.animationGOFeature.setLatLngs(L.Util.superMapPointsToLatLngs(e)),!0},_execute_RegularPloygon:function(t){if(0===this.controlPoints.length&&(this.controlPoints=L.Util.latLngsToSuperMapPoints(this.goFeature.getLatLngs())),0===t)return this._executeAndRatioIsZero(),!0;var e=this.controlPoints.length,o=SuperMap.Plot.PlottingUtil.distance(this.controlPoints[0],this.controlPoints[this.controlPoints.length-1])*t,i=new SuperMap.Geometry.Point(this.controlPoints[0].x+o,this.controlPoints[0].y),l=2*Math.PI/(e+1),n=Math.PI/2+this.animationGOFeature.dRotate,a=i;SuperMap.Plot.PlottingUtil.rotateAngle(this.controlPoints[0],n,a);var s=[];s.push(this.controlPoints[0].clone()),s.push(a);for(var r=a.clone(),u=1;u<e-1;u++)SuperMap.Plot.PlottingUtil.rotateAngle(this.controlPoints[0],l,r),s.push(r.clone());return this.animationGOFeature.setLatLngs(L.Util.superMapPointsToLatLngs(s)),!0},_execute_Ellipse:function(t){0===this.controlPoints.length&&(this.controlPoints=L.Util.latLngsToSuperMapPoints(this.goFeature.getLatLngs()));var e=SuperMap.Plot.PlottingUtil.findPointOnLineByRatio(t,this.controlPoints[0],this.controlPoints[1]),o=SuperMap.Plot.PlottingUtil.findPointOnLineByRatio(t,this.controlPoints[0],this.controlPoints[2]);return this.animationGOFeature.latLngs[1]=L.latLng(e.y,e.x),this.animationGOFeature.latLngs[2]=L.latLng(o.y,o.x),this.animationGOFeature.redraw(),!0},_execute_ArbitraryPolygon:function(t){0===this.controlPoints.length&&(this.controlPoints=L.Util.latLngsToSuperMapPoints(this.goFeature.getLatLngs()));var e=this.controlPoints.length,o=SuperMap.Plot.PlottingUtil.getPolygonCenterPt(this.controlPoints);if(null===o)return this._executeAndRatioIsZero(),!0;for(var i=[],l=0;l<e;l++){var n=SuperMap.Plot.PlottingUtil.distance(o,this.controlPoints[l])*t,a=SuperMap.Plot.PlottingUtil.linePnt(o,this.controlPoints[l],n);i.push(a)}return this.animationGOFeature.setLatLngs(L.Util.superMapPointsToLatLngs(i)),!0},_execute_ParallelLine:function(t){if(0===this.lineLength){this.controlPoints=L.Util.latLngsToSuperMapPoints(this.goFeature.getLatLngs());for(var e=2;e<this.controlPoints.length;e++)this.lineLength+=SuperMap.Plot.PlottingUtil.distance(this.controlPoints[e-1],this.controlPoints[e])}for(var o=[],i=[],l=1;l<this.controlPoints.length;l++)i.push(this.controlPoints[l].clone());var n=this._findPos(this.lineLength*t,i);o.push(this.controlPoints[0].clone());for(var a=0;a<=n.pos;a++)o.push(i[a]);return o.push(n.pts),this.animationGOFeature.setLatLngs(L.Util.superMapPointsToLatLngs(o)),!0},_execute_Polybezier:function(t){if(0===this.lineLength){this.controlPoints=L.Util.latLngsToSuperMapPoints(this.goFeature.getLatLngs());var e=SuperMap.Plot.PlottingUtil.generateBeizerPointsNoCtrlPt(this.controlPoints);this.lineLength+=SuperMap.Plot.PlottingUtil.polylineDistance(e)}var o=[];e=SuperMap.Plot.PlottingUtil.generateBeizerPointsNoCtrlPt(this.controlPoints,[]);for(var i=this._findPos(this.lineLength*t,e),l=0;l<=i.pos;l++)o.push(e[l].clone());return o.push(i.pts),this.animationGOFeature.setLatLngs(L.Util.superMapPointsToLatLngs(o)),!0},_execute_CurveEight:function(t){0===this.controlPoints.length&&(this.controlPoints=L.Util.latLngsToSuperMapPoints(this.goFeature.getLatLngs()));for(var e=SuperMap.Plot.PlottingUtil.getPolygonCenterPt(this.controlPoints),o=[],i=0;i<this.controlPoints.length;i++){var l=SuperMap.Plot.PlottingUtil.distance(e,this.controlPoints[i])*t,n=SuperMap.Plot.PlottingUtil.linePnt(e,this.controlPoints[i],l);o.push(n)}return this.animationGOFeature.setLatLngs(L.Util.superMapPointsToLatLngs(o)),!0},_execute_AnnotationFrame:function(t){if(0===this.lineLength&&(this.controlPoints=L.Util.latLngsToSuperMapPoints(this.goFeature.getLatLngs()),this.lineLength=SuperMap.Plot.PlottingUtil.polylineDistance(this.controlPoints)),0===t)return this._executeAndRatioIsZero(),!0;var e=[],o=SuperMap.Plot.PlottingUtil.clonePoints(this.controlPoints);if(this.goFeature.symbolType===SuperMap.Plot.SymbolType.SYMBOLTEXTBOX||this.goFeature.symbolType===SuperMap.Plot.SymbolType.LINEMARKING){var i=[];i.push(this.controlPoints[0]),i.push(new SuperMap.Geometry.Point(this.goFeature.scaleValues[1],this.goFeature.scaleValues[2]));var l=SuperMap.Plot.PlottingUtil.polylineDistance(i),n=this._findPos(l*t,i);this.animationGOFeature.scaleValues[1]=n.pts.x,this.animationGOFeature.scaleValues[2]=n.pts.y}else for(var a=this.goFeature.scaleValues.length/2,s=0;s<a;s++){var r=[];r.push(this.controlPoints[0]),r.push(new SuperMap.Geometry.Point(this.goFeature.scaleValues[2*s],this.goFeature.scaleValues[2*s+1]));var u=SuperMap.Plot.PlottingUtil.polylineDistance(r),p=this._findPos(u*t,r);this.animationGOFeature.scaleValues[2*s]=p.pts.x,this.animationGOFeature.scaleValues[2*s+1]=p.pts.y}for(var h=this._findPos(this.lineLength*t,o),c=0;c<=h.pos;c++)e.push(o[c]);return e.push(h.pts),this.animationGOFeature.latLngs=L.Util.superMapPointsToLatLngs(e),this.animationGOFeature.redraw(),!0},_executeAndRatioIsZero:function(){this.animationGOFeature.setLatLngs([]),this.animationGOFeature.grow=SuperMap.Plot.AlgoSymbolFactory.isAccessServer(this.animationGOFeature.libID,this.animationGOFeature.code)},resetAnimationFeature:function(t){i.GOAnimation.prototype.resetAnimationFeature.call(this,t),this.lineLength=0,this.controlPoints=[],this.startScale<0&&(this.startScale=0),this.startScale>1&&(this.startScale=1),this.endScale<0&&(this.endScale=0),this.endScale>1&&(this.endScale=1)},execute:function(){if(!(this.goFeature instanceof l.AlgoSymbol))return!1;if(!this.canExecute())return!1;this.endScale>1&&(this.endScale=1);var t=(new Date).getTime();if(this.lastDrawTime>0&&t-this.timeSpace<this.lastDrawTime)return!1;var e=this.startScale+this.ratio*(this.endScale-this.startScale);return this.lastDrawTime=t,this._executeAnimation(e)},_executeAnimation:function(t){var e=!1,o=this.animationGOFeature.code,i=this.animationGOFeature.libID;if(0===i)switch(o){case SuperMap.Plot.SymbolType.KIDNEY:case SuperMap.Plot.SymbolType.POLYBEZIERCLOSESYMBOL:case SuperMap.Plot.SymbolType.PARALLELOGRAM:case SuperMap.Plot.SymbolType.TRAPEZOIDSYMBOL:e=this._execute_Kidney(t);break;case SuperMap.Plot.SymbolType.CIRCLESYMBOL:e=this._execute_Circle(t);break;case SuperMap.Plot.SymbolType.RECTANGLESYMBOL:e=this._execute_Rect(t);break;case SuperMap.Plot.SymbolType.REGULARPOLYGON:e=this._execute_RegularPloygon(t);break;case SuperMap.Plot.SymbolType.ELLIPSESYMBOL:e=this._execute_Ellipse(t);break;case SuperMap.Plot.SymbolType.ARBITRARYPOLYGONSYMBOL:case SuperMap.Plot.SymbolType.POLYGONREGION:e=this._execute_ArbitraryPolygon(t);break;case SuperMap.Plot.SymbolType.PARALLELLINE:e=this._execute_ParallelLine(t);break;case SuperMap.Plot.SymbolType.POLYBEZIERSYMBOL:e=this._execute_Polybezier(t);break;case SuperMap.Plot.SymbolType.PIESYMBOL:case SuperMap.Plot.SymbolType.CHORDSYMBOL:case SuperMap.Plot.SymbolType.ARCSYMBOL:case SuperMap.Plot.SymbolType.ANNOFRAMESYMBOL:return!1;case SuperMap.Plot.SymbolType.CURVEEIGHT:e=this._execute_CurveEight(t);break;case SuperMap.Plot.SymbolType.ANNOFRAMESYMBOLM:case SuperMap.Plot.SymbolType.SYMBOLTEXTBOX:case SuperMap.Plot.SymbolType.LINEMARKING:e=this._execute_AnnotationFrame(t);break;default:e=this._execute_Generalization(t)}else if(22===i)switch(o){case 1004:case 2004:case 1010:e=this._execute_1004(t);break;case 1006:case 2006:e=this._execute_1006(t);break;case 1002:case 2002:e=this._execute_1002(t);break;case 32:case 3211:e=this._execute_ArbitraryPolygon(t);break;case 390:case 3911:e=this._execute_Kidney(t);break;default:e=this._execute_Generalization(t)}else if(100===i)switch(o){case 25200:e=this._execute_1004(t);break;default:e=this._execute_Generalization(t)}else if(421===i)switch(o){case 311:e=this._execute_1004(t);break;case 317:e=this._execute_1006(t);break;default:e=this._execute_Generalization(t)}else if(123===i)switch(o){case 60310:case 6031001:e=this._execute_1004(t);break;default:e=this._execute_Generalization(t)}else e=this._execute_Generalization(t);return this.animationGOFeature.grow=SuperMap.Plot.AlgoSymbolFactory.isAccessServer(this.animationGOFeature.libID,this.animationGOFeature.code),e},_findPos:function(t,e){var o,i=0,l=0;for(o=1;o<e.length&&!(i+(l=SuperMap.Plot.PlottingUtil.distance(e[o-1],e[o]))>=t);o++)i+=l;var n,a=new Object;return n=o<e.length?SuperMap.Plot.PlottingUtil.findPoint(e[o-1],e[o],t-i,0):e[o-1].clone(),a.pos=o-1,a.pts=n,a},getJSONData:function(){var t=i.GOAnimation.prototype.getJSONData.call(this);return t.startScale=this.startScale,t.endScale=this.endScale,t},fromJSONData:function(t){i.GOAnimation.prototype.fromJSONData.call(this,t),this.startScale=t.startScale,this.endScale=t.endScale}});L.supermap.plotting.GOAnimationGrow=n},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GOAnimationBlink=void 0,o(0);var i=o(3),l=e.GOAnimationBlink=i.GOAnimation.extend({blinkInterval:500,blinkStyle:SuperMap.Plot.BlinkAnimationBlinkStyle.Blink_Frequency,blinkNumber:0,replaceStyle:SuperMap.Plot.BlinkAnimationReplaceStyle.Replace_NoColor,startColor:"#0000ff",endColor:"#ff0000",getGOAnimationType:function(){return SuperMap.Plot.GOAnimationType.ANIMATION_BLINK},execute:function(){if(!this.canExecute())return"none"===this.goFeature.style.display&&"none"===this.animationGOFeature.style.display&&(this.animationGOFeature.style.display="display",!0);var t=(new Date).getTime()/1e3,e=this.blinkInterval/1e3;return this.blinkStyle===SuperMap.Plot.BlinkAnimationBlinkStyle.Blink_Number&&(e=this.blinkInterval=this.duration/this.blinkNumber),(t-this.innerStartTime)%e<=e/2?this.replaceStyle===SuperMap.Plot.BlinkAnimationReplaceStyle.Replace_Color?(this.animationGOFeature.style.color=this.startColor,this.animationGOFeature.style.display="display"):this.animationGOFeature.style.display="none":(this.animationGOFeature.style.display="display",this.replaceStyle===SuperMap.Plot.BlinkAnimationReplaceStyle.Replace_Color&&(this.animationGOFeature.style.color=this.endColor)),this.animationGOFeature.redraw(),!0},getJSONData:function(){var t=i.GOAnimation.prototype.getJSONData.call(this);return t.blinkStyle=this.blinkStyle,t.blinkInterval=this.blinkInterval,t.blinkNumber=this.blinkNumber,t.replaceStyle=this.replaceStyle,t.startColor=this.startColor,t.endColor=this.endColor,t},fromJSONData:function(t){i.GOAnimation.prototype.fromJSONData.call(this,t),this.blinkStyle=t.blinkStyle,this.blinkInterval=t.blinkInterval,this.blinkNumber=t.blinkNumber,this.replaceStyle=t.replaceStyle,this.startColor=t.startColor,this.endColor=t.endColor}});L.supermap.plotting.GOAnimationBlink=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GOAnimationAttribute=void 0,o(0);var i=o(3),l=e.GOAnimationAttribute=i.GOAnimation.extend({lineColorAnimation:!1,startLineColor:"#FF0000",endLineColor:"#0000FF",lineWidthAnimation:!1,startLineWidth:0,endLineWidth:5,surroundLineColorAnimation:!1,startSurroundLineColor:"#ffff00",endSurroundLineColor:"#00ffff",surroundLineWidthAnimation:!1,startSurroundLineWidth:0,endSurroundLineWidth:1,getGOAnimationType:function(){return SuperMap.Plot.GOAnimationType.ANIMATION_ATTRIBUTE},resetAnimationFeature:function(t){i.GOAnimation.prototype.resetAnimationFeature.call(this,t),t&&(this.animationGOFeature.style.color=this.startLineColor,this.animationGOFeature.style.weight=this.startLineWidth,this.animationGOFeature.style.surroundLineColor=this.startSurroundLineColor,this.animationGOFeature.style.surroundLineWidth=this.startSurroundLineWidth)},execute:function(){if(!this.canExecute())return!1;var t=this.ratio,e=this._executeLineColorAnimation(t),o=this._executeLineWidthAnimation(t),i=this._executeSurroundLineColorAnimation(t),l=this._executeSurroundLineWidthAnimation(t);return e||o||i||l},_executeLineColorAnimation:function(t){if(!this.lineColorAnimation)return!1;var e=SuperMap.Plot.PlottingUtil.colorStringToRGB(this.startLineColor),o=SuperMap.Plot.PlottingUtil.colorStringToRGB(this.endLineColor),i=parseInt(e.red+(o.red-e.red)*t),l=parseInt(e.green+(o.green-e.green)*t),n=parseInt(e.blue+(o.blue-e.blue)*t);return this.animationGOFeature.setStyle({color:SuperMap.Plot.PlottingUtil.colorRGBToString({red:i,green:l,blue:n})}),!0},_executeLineWidthAnimation:function(t){return!!this.lineWidthAnimation&&(this.animationGOFeature.setStyle({weight:this.startLineWidth+(this.endLineWidth-this.startLineWidth)*t}),!0)},_executeSurroundLineColorAnimation:function(t){if(!this.surroundLineColorAnimation)return!1;var e=SuperMap.Plot.PlottingUtil.colorStringToRGB(this.startSurroundLineColor),o=SuperMap.Plot.PlottingUtil.colorStringToRGB(this.endSurroundLineColor),i=parseInt(e.red+(o.red-e.red)*t),l=parseInt(e.green+(o.green-e.green)*t),n=parseInt(e.blue+(o.blue-e.blue)*t);return this.animationGOFeature.setStyle({surroundLineColor:SuperMap.Plot.PlottingUtil.colorRGBToString({red:i,green:l,blue:n})}),!0},_executeSurroundLineWidthAnimation:function(t){return!!this.surroundLineWidthAnimation&&(this.animationGOFeature.setStyle({surroundLineWidth:this.startSurroundLineWidth+(this.endSurroundLineWidth-this.startSurroundLineWidth)*t}),!0)},getJSONData:function(){var t=i.GOAnimation.prototype.getJSONData.call(this);return t.lineColorAnimation=this.lineColorAnimation,t.startLineColor=this.startLineColor,t.endLineColor=this.endLineColor,t.lineWidthAnimation=this.lineWidthAnimation,t.startLineWidth=this.startLineWidth,t.endLineWidth=this.endLineWidth,t.surroundLineColorAnimation=this.surroundLineColorAnimation,t.startSurroundLineColor=this.startSurroundLineColor,t.endSurroundLineColor=this.endSurroundLineColor,t.surroundLineWidthAnimation=this.surroundLineWidthAnimation,t.startSurroundLineWidth=this.startSurroundLineWidth,t.endSurroundLineWidth=this.endSurroundLineWidth,t},fromJSONData:function(t){i.GOAnimation.prototype.fromJSONData.call(this,t),this.lineColorAnimation=t.lineColorAnimation,this.startLineColor=t.startLineColor,this.endLineColor=t.endLineColor,this.lineWidthAnimation=t.lineWidthAnimation,this.startLineWidth=t.startLineWidth,this.endLineWidth=t.endLineWidth,this.surroundLineColorAnimation=t.surroundLineColorAnimation,this.startSurroundLineColor=t.startSurroundLineColor,this.endSurroundLineColor=t.endSurroundLineColor,this.surroundLineWidthAnimation=t.surroundLineWidthAnimation,this.startSurroundLineWidth=t.startSurroundLineWidth,this.endSurroundLineWidth=t.endSurroundLineWidth}});L.supermap.plotting.GOAnimationAttribute=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.plottingGraphicLayer=e.PlottingGraphicLayer=void 0,o(0);var i=o(20),l=o(36),n=e.PlottingGraphicLayer=L.Path.extend({serverUrl:null,features:null,isLocked:!1,isEditable:!0,isSelected:!0,visibility:!0,cacheImages:null,graphics:null,_editLayer:null,options:{renderer:L.canvas()},getSelected:function(){return this.isSelected},setSelected:function(t){this.isSelected!==t&&(this.isSelected=t,this._map&&this._map.getPlotEditControl()&&(this.isSelected?this._map.getPlotEditControl().enableEditFeatures(this.features):this._map.getPlotEditControl().disableEditFeatures(this.features)))},getEditable:function(){return this.isEditable},setEditable:function(t){if(this.isEditable!==t&&(this.isEditable=t,this._map&&this._map.getPlotEditControl())){var e=this._map.getPlotEditControl().getSelectedFeatures();this._map.getPlotEditControl().unselectFeatures(this.features),this._map.getPlotEditControl().selectFeatures(e)}},getLocked:function(){return this.isLocked},setLocked:function(t){if(this.isLocked!==t&&(this.isLocked=t,this._map&&this._map.getPlotEditControl())){var e=this._map.getPlotEditControl().getSelectedFeatures();this._map.getPlotEditControl().unselectFeatures(this.features),this._map.getPlotEditControl().selectFeatures(e)}},getVisibility:function(){return this.visibility},setVisibility:function(t){this.visibility!==t&&(this.visibility=t,this.visibility?this._renderer._container.style.display="block":this._renderer._container.style.display="none")},initialize:function(t,e){this._editLayer=new l.GraphicEditLayer("temportary"),e=e||{},L.Util.setOptions(this,e),this.cacheImages={},this.graphics=[],this.selectedFeatures=[],this.name=t,this.features=[]},getEvents:function(){var t={click:this._handleClick,mousemove:this._onMapMouseMove};return this._map._zoomAnimated&&(t.zoomanim=this._zoomAnim),t},_zoomAnim:function(t){var e=this._map.getZoomScale(t.zoom),o=this._map._getCenterOffset(t.center)._multiplyBy(-e).subtract(this._map._getMapPanePos());L.DomUtil.setTransform?L.DomUtil.setTransform(this._canvas,o,e):L.DomUtil.setPosition(this._canvas,o)},_onMapMouseMove:function(t){var e=this._getGraphicsInBounds();if(0!==e.length)for(var o=0,i=e.length;o<i;o++){if(e[o]._containsPoint(this._map.latLngToLayerPoint(t.latlng))){this._editLayer._renderer._container.style.cursor=e[o].feature.isSelected?"move":"pointer";break}this._editLayer._renderer._container.style.cursor=""}},isGraphic:function(t){return t===SuperMap.Plot.SymbolType.DOTSYMBOL},isSupportType:function(t){return t===SuperMap.Plot.SymbolType.DOTSYMBOL},getFeatureByUuid:function(t){for(var e=0;e<this.features.length;e++)if(this.features[e].uuid===t)return this.features[e];return null},getFeatures:function(){return this.features.slice()},addFeatures:function(t){L.Util.isArray(t)||(t=[t]);for(var e=0,o=t.length;e<o;e++){var l=t[e];if(this.isSupportType(l.symbolType)){if(null!=this._map.getFeatureByUuid(l.uuid)&&(l.uuid=SuperMap.Plot.PlottingUtil.generateUuid()),l.symbolType===SuperMap.Plot.SymbolType.DOTSYMBOL){var n=new i.PlottingGraphic(l);n.onAdd(this),this.graphics.push(n)}this.features.push(l)}}this._update()},removeFeatures:function(t){var e=[];SuperMap.Util.isArray(t)||(t=[t]);for(var o=0,i=t.length;o<i;o++){var l=t[o];-1!=SuperMap.Util.indexOf(this.features,l)&&e.push(l.graphic)}this.fire(SuperMap.Plot.Event.beforefeaturesremoved,{features:t}),this.removeGraphics(e),this.fire(SuperMap.Plot.Event.featuresremoved,{features:t})},removeAllFeatures:function(){this.fire(SuperMap.Plot.Event.beforefeaturesremoved,{features:this.features}),this.removeAllGraphics(),this.fire(SuperMap.Plot.Event.featuresremoved,{features:this.features})},updateGraphics:function(t){L.Util.isArray(t)||(t=[t]);t.map(function(t){return t.update(),t}),this._update()},removeGraphics:function(t){L.Util.isArray(t)||(t=[t]);var e=this;t.map(function(t){var o=SuperMap.Util.indexOf(e.selectedFeatures,t.feature);-1!==o&&(e._editLayer.removeFeatures(t.feature),e.selectedFeatures.splice(o,1)),e._map&&e._map.getPlotEditControl()&&e._map.getPlotEditControl().disableEditFeatures(t.feature);var i=t.getUuid();return e.cacheImages[i]&&0==--e.cacheImages[i].imgCount&&delete e.cacheImages[i],-1!==(o=SuperMap.Util.indexOf(e.graphics,t))&&e.graphics.splice(o,1),t.onRemove(),-1!==(o=SuperMap.Util.indexOf(e.features,t.feature))&&e.features.splice(o,1),t}),this._update()},removeAllGraphics:function(){this.removeGraphics(this.graphics.slice()),this.selectedFeatures=[],this.graphics=[],this.features=[],this.cacheImages={}},redraw:function(){this._update()},_generateFromFeature:function(t){var e="";return t.symbolType===SuperMap.Plot.SymbolType.DOTSYMBOL?e=t.libID.toString()+"_"+t.code.toString()+"_"+Math.round(t.symbolSize.w).toString()+"_"+Math.round(t.symbolSize.h).toString()+"_"+t.textContent+"_"+t.annotationPosition.toString()+"_"+t.dRotate.toString()+this._styleToString(t.style)+"_"+t.textDisplay.toString()+"_"+t.surroundLineType.toString():t.symbolType===SuperMap.Plot.SymbolType.SYMBOLTEXT?(e=t.libID.toString()+"_"+t.code.toString()+"_"+t.associatedUuid+"_"+t.addFrame.toString(),1===t.symbolTexts.length&&(null!=t.symbolTexts[0].textContent&&(e+="_"+t.symbolTexts[0].textContent),null!=t.symbolTexts[0].textPosition&&(e+="_"+t.symbolTexts[0].textPosition.toString()),null!=t.symbolTexts[0].offsetX&&(e+="_"+t.symbolTexts[0].offsetX.toString()),null!=t.symbolTexts[0].offsetY&&(e+="_"+t.symbolTexts[0].offsetY.toString()),null!=t.symbolTexts[0].style&&(e+=this._styleToString(t.symbolTexts[0].style)))):t.symbolType===SuperMap.Plot.SymbolType.SYMBOLTEXT1&&(e=t.libID.toString()+"_"+t.code.toString()+"_"+t.associatedUuid+"_"+t.textContent+"_"+t.space.toString()+"_"+t.offsetX.toString()+"_"+t.offsetY.toString()+this._styleToString(t.style)),e},_styleToString:function(t){var e="";return null!=t.fontFamily&&(e+="_"+t.fontFamily),null!=t.fontSize&&(e+="_"+t.fontSize),null!=t.fontColor&&(e+="_"+t.fontColor),null!=t.fontStroke&&(e+="_"+t.fontStroke),null!=t.fontStrokeColor&&(e+="_"+t.fontStrokeColor),null!=t.fontStrokeWidth&&(e+="_"+t.fontStrokeWidth),null!=t.fontBackground&&(e+="_"+t.fontBackground),null!=t.fontBackgroundColor&&(e+="_"+t.fontBackgroundColor),null!=t.fontShadow&&(e+="_"+t.fontShadow),null!=t.fontShadowColor&&(e+="_"+t.fontShadowColor),null!=t.fontShadowOffsetX&&(e+="_"+t.fontShadowOffsetX),null!=t.fontShadowOffsetY&&(e+="_"+t.fontShadowOffsetY),null!=t.color&&(e+="_"+t.color),null!=t.weight&&(e+="_"+t.weight),null!=t.opacity&&(e+="_"+t.opacity),null!=t.lineSymbolID&&(e+="_"+t.lineSymbolID),null!=t.dashArray&&(e+="_"+t.dashArray),null!=t.fill&&(e+="_"+t.fill),null!=t.fillSymbolID&&(e+="_"+t.fillSymbolID),null!=t.fillColor&&(e+="_"+t.fillColor),null!=t.fillOpacity&&(e+="_"+t.fillOpacity),null!=t.fillBackColor&&(e+="_"+t.fillBackColor),null!=t.fillBackOpacity&&(e+="_"+t.fillBackOpacity),null!=t.fillGradientMode&&(e+="_"+t.fillGradientMode),e},onAdd:function(){this._canvas=document.createElement("canvas");var t=this._map.getPixelBounds().getSize().x,e=this._map.getPixelBounds().getSize().y;this._canvas.width=t,this._canvas.height=e,this._ctx=this._canvas.getContext("2d"),L.Path.prototype.onAdd.call(this),this._map.addLayer(this._editLayer)},onRemove:function(){L.Path.prototype.onRemove.call(this),this._map.removeLayer(this._editLayer)},_update:function(){this._map&&this.getVisibility()&&this._updatePath()},_containsPoint:function(){return!1},_updatePath:function(){this._renderer._ctx.clearRect(this._renderer._bounds.min.x,this._renderer._bounds.min.y,this._renderer._ctx.canvas.width,this._renderer._ctx.canvas.height),this._renderer._drawPlottingGraphics(this._getGraphicsInBounds())},_project:function(){var t=this;t._pxBounds=L.bounds(L.point(0,0),L.point(0,0)),t._getGraphicsInBounds().map(function(e){return e._project(),t._pxBounds.extend(e._pxBounds.min),t._pxBounds.extend(e._pxBounds.max),e})},_getGraphicsInBounds:function(){var t=[],e=this._map.getBounds();return this.graphics.map(function(o){return"none"!==o.feature.style.display&&e.contains(o.getLatLng())&&(null!=o.getImage()&&o.getUuid()===o.getImage().generateUuidFromFeature()||o.update(),t.push(o)),o}),t},_handleClick:function(t){var e=this;if(null!=e._map.getPlotEditControl()){if(0!==this.selectedFeatures.length)for(var o=0,i=this.selectedFeatures.length;o<i;o++)e._editLayer.removeFeatures(this.selectedFeatures),this.addFeatures(this.selectedFeatures);this.selectedFeatures=[];for(var l=e._getGraphicsInBounds(),n=0,a=l.length;n<a;n++)if(l[n]._containsPoint(this._map.latLngToLayerPoint(t.latlng))){this.removeFeatures(l[n].feature),e._editLayer.addFeatures(l[n].feature),e._map.getPlotEditControl()&&(e._map.getPlotEditControl().unselectFeatures(),l[n].feature.enableEdit||e._map.getPlotEditControl().enableEditFeatures(l[n].feature),e._map.getPlotEditControl().selectFeatures(l[n].feature)),this.selectedFeatures.push(l[n].feature),e._map.getPlotEditControl()&&(e._map.getPlotEditControl()._onTriggerMapClick=!1);break}L.DomEvent.stopPropagation(t)}}}),a=e.plottingGraphicLayer=function(t){return new n(t)};L.supermap.plotting.graphicLayer=a},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GraphicEditLayer=void 0;var i=o(9),l=o(8);e.GraphicEditLayer=i.PlottingLayer.extend({layer:null,initialize:function(t,e,o){i.PlottingLayer.prototype.initialize.call(this,t,e,o),o&&o.layer&&(this.layer=o.layer),this.setVisibility(!0)},addFeatures:function(t){SuperMap.Util.isArray(t)||(t=[t]),0!==t.length&&(l.PlottingLayerBase.prototype.addFeatures.call(this,t),this._map.getPlotEditControl()&&this.isSelected&&this._map.getPlotEditControl().enableEditFeatures(t))},removeFeatures:function(t){SuperMap.Util.isArray(t)||(t=[t]);for(var e=0,o=t.length;e<o;e++){var i=t[e];if(-1!=SuperMap.Util.indexOf(this.features,i)){this._map&&this._map.getPlotEditControl()&&this._map.getPlotEditControl().disableEditFeatures(i),i._clearComponents();var l=SuperMap.Util.indexOf(this.features,i);-1!==l&&this.features.splice(l,1),i.layer=null}}this._update()}})},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.avoidRegion=e.AvoidRegion=void 0,o(0);var i=o(10),l=o(2),n=e.AvoidRegion=L.Evented.extend({options:{},uuid:null,associatedUuid:null,libID:null,code:null,maxEditPts:0,minEditPts:0,symbolType:null,latLngs:[],style:{fill:!1,color:"#0000ff",lineSymbolID:2,opacity:1,weight:1},components:[],initialize:function(t,e,o,i){this.components=[],this.minEditPts=3,this.maxEditPts=9999,this.libID=0,this.code=SuperMap.Plot.SymbolType.AVOIDREGION,this.symbolType=SuperMap.Plot.SymbolType.AVOIDREGION,this.symbolName="避让区域",i.style&&(this.style=SuperMap.Plot.PlottingUtil.cloneObject(i.style)),i&&i.symbolData&&this._parseSymbolData(i.symbolData),L.Util.isArray(o)||(o=[o]),o.length>0&&(this.latLngs=L.Util.isArray(o)?o:[o]),SuperMap.Util.extend(this,i),void 0!==this.uuid&&null!==this.uuid||(this.uuid=SuperMap.Plot.PlottingUtil.generateUuid())},destroy:function(){this.libID=null,this.code=null,this.symbolType=null,this.symbolName=null,this.uuid=null,this.associatedUuid=null,this.minEditPts=null,this.maxEditPts=null,this.latLngs=null,this.components=null},onAdd:function(t){this.layer=t,this._renderer=t._renderer,this._map=t._map,this.redraw(),i.PlottingObjectDrag&&(this.dragging||(this.dragging=new i.PlottingObjectDrag(this)))},_clearComponents:function(){for(var t=0;t<this.components.length;t++)this.components[t].removeEventParent(this),this.components[t].onRemove(),delete this.components[t];this.components.length=0},_addComponents:function(t){t._map=this._map,t._renderer=this._renderer,t.addEventParent(this),t.onAdd(),this.components.push(t)},_project:function(){var t=this;t._pxBounds=L.bounds(L.point(0,0),L.point(0,0)),t.components.map(function(e){return t._pxBounds.extend(e._pxBounds.min),t._pxBounds.extend(e._pxBounds.max),e})},getBounds:function(){var t=this;return t._bounds=new L.LatLngBounds,t.components.map(function(e){return t._bounds.extend(e.getBounds()),e}),t._bounds},setLatLngs:function(t){return this.latLngs=t,this.redraw()},getLatLngs:function(){return this.latLngs},addLatLng:function(t){if(this.latLngs[this.latLngs.length-1].lat!==t.lat||this.latLngs[this.latLngs.length-1].lng!==t.lng)return this.latLngs.push(t),this.redraw()},redraw:function(){if(this._clearComponents(),this.getLatLngs().length>=this.minEditPts){var t=new L.Polygon(this.getLatLngs(),{smoothFactor:.05});this._addComponents(t),t.setStyle(this.style)}else if(this.getLatLngs().length>=2&&this.getLatLngs().length<this.minEditPts){var e=new L.Polyline(this.getLatLngs(),{smoothFactor:.05});this._addComponents(e),e.setStyle(this.style)}},_modifyPoint:function(){this.redraw(),this._map.getFeatureByUuid(this.associatedUuid).redraw()},move:function(t,e){(L.Util.moveLatLngs(this.getLatLngs(),t,e),this.redraw(),null!==this._map&&void 0!==this._map)&&this._map.getFeatureByUuid(this.associatedUuid).redraw()},rotate:function(t,e){(L.Util.rotateLatLngs(this.getLatLngs(),e,t),null!==this._map&&void 0!==this._map)&&this._map.getFeatureByUuid(this.associatedUuid).redraw()},_reView:function(){},_parseSymbolData:function(t){if(null!==t&&(this.libID=t.libID,this.code=t.code,this.symbolType=t.symbolType,this.maxEditPts=t.algoMaxEditPts,this.minEditPts=t.algoMinEditPts,void 0!==t.uuid&&(this.uuid=t.uuid),void 0!==t.associatedUuid&&(this.associatedUuid=t.associatedUuid),this.latLngs=[],t.controlPoints))for(var e=0;e<t.controlPoints.length;e++)this.latLngs.push(L.latLng(t.controlPoints[e].y,t.controlPoints[e].x))},getSymbolData:function(){var t={};t.uuid=this.uuid,t.associatedUuid=this.associatedUuid,t.libID=this.libID,t.code=this.code,t.symbolType=this.symbolType,t.algoMaxEditPts=this.maxEditPts,t.algoMinEditPts=this.minEditPts,t.controlPoints=[];for(var e=0;e<this.latLngs.length;e++)t.controlPoints.push({x:this.getLatLngs()[e].lng,y:this.getLatLngs()[e].lat,z:0});return t},clone:function(){var t=SuperMap.Plot.PlottingUtil.cloneObject(this.getSymbolData());return t.uuid=SuperMap.Plot.PlottingUtil.generateUuid(),L.supermap.plotting.avoidRegion(0,SuperMap.Plot.SymbolType.AVOIDREGION,L.Util.cloneLatLngs(this.getLatLngs()),{symbolData:t,style:SuperMap.Plot.PlottingUtil.cloneObject(this.style)})},_containsPoint:function(t){var e=L.Util.latLngsToSuperMapPoints(this.getLatLngs());e.push(e[0].clone());var o=SuperMap.Number.limitSigDigs,i=o(t.x,14),l=o(t.y,14);function n(t,e,o,i,l){return(i-e)/(l-o)*(t-l)+i}for(var a,s,r,u,p,h,c,g=e.length-1,y=0,f=0;f<g;++f)if(r=o((a=e[f]).x,14),u=o(a.y,14),p=o((s=e[f+1]).x,14),u!==(h=o(s.y,14))){if((c=o(n(l,r,u,p,h),14))===i&&(u<h&&l>=u&&l<=h||u>h&&l<=u&&l>=h)){y=-1;break}c<=i||r!==p&&(c<Math.min(r,p)||c>Math.max(r,p))||(u<h&&l>=u&&l<h||u>h&&l<u&&l>=h)&&++y}else if(l===u&&(r<=p&&i>=r&&i<=p||r>=p&&i<=r&&i>=p)){y=-1;break}return-1===y?1:!!(1&y)},_relationToLayer:function(t){var e=2,o=[];if(t instanceof L.Polygon)(o=L.Util.latLngsToSuperMapPoints(t.getLatLngs()[0])).push(o[0].clone());else if(t instanceof L.Polyline)o=L.Util.latLngsToSuperMapPoints(t.getLatLngs());else if(t instanceof l.Text){var i=t.getBounds();o.push(new SuperMap.Geometry.Point(i.left,i.top)),o.push(new SuperMap.Geometry.Point(i.left,i.bottom)),o.push(new SuperMap.Geometry.Point(i.right,i.bottom)),o.push(new SuperMap.Geometry.Point(i.top,i.right))}if(0===o.length)e=2;else{var n=this._containsPoint(o[0]);n&&(e=1);for(var a=1;a<o.length;a++)if(n!==this._containsPoint(o[a])){e=0;break}if(2===e){var s=L.Util.latLngsToSuperMapPoints(this.getLatLngs());s.push(s[0].clone());for(var r=0;r<o.length-1;r++){for(var u=0;u<s.length-1;u++)if(SuperMap.Plot.PlottingUtil.isCross(o[r],o[r+1],s[u],s[u+1])){e=0;break}if(0===e)break}}}return e},_getWithoutPts:function(t,e){var o=L.Util.latLngsToSuperMapPoints(t);!0===e&&o[0].x!==o[o.length-1].x&&o[0].y!==o[o.length-1].y&&o.push(o[0]);for(var i=[],l=[],n=0;n<o.length;n++)if(this._containsPoint(o[n])||l.push(o[n].clone()),n<=o.length-2)for(var a=this._intersectSegs(o[n],o[n+1]),s=0;s<a.length;s++)l.push(a[s].clone()),l.length>1&&(i.push(l),l=[]);0!==l.length&&i.push(l);var r=i.length;if(!0===e&&r>1&&SuperMap.Plot.PlottingUtil.equalFuzzy(i[0][0].x,i[r-1][i[r-1].length-1].x)&&SuperMap.Plot.PlottingUtil.equalFuzzy(i[0][0].y,i[r-1][i[r-1].length-1].y)){for(var u=0;u<i[0].length;u++)i[r-1].push(i[0][u]);i.splice(0,1)}return i},_intersectSegs:function(t,e){var o=L.Util.latLngsToSuperMapPoints(this.getLatLngs());o.push(o[0].clone()),o[0].x!==o[o.length-1].x&&o[0].y!==o[o.length-1].y&&o.push(o[0]);for(var i=[],l=0;l<o.length-1;l++){var n=new SuperMap.Geometry.Point;SuperMap.Plot.PlottingUtil.intersectLineSegs(t,e,o[l],o[l+1],n)&&i.push(n)}for(var a=[];i.length>0;)if(1===i.length)a.push(i[0]),i.splice(0,1);else{for(var s=0,r=SuperMap.Plot.PlottingUtil.distance(t,i[0]),u=1;u<i.length;u++)SuperMap.Plot.PlottingUtil.distance(t,i[u])<r&&(r=SuperMap.Plot.PlottingUtil.distance(t,i[u]),s=u);a.push(i[s]),i.splice(s,1)}return a}}),a=e.avoidRegion=function(t,e,o,i){return new n(t,e,o,i)};L.supermap.plotting.avoidRegion=a,L.supermap.plotting.AvoidRegion=n},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.navyDeployment=e.NavyDeployment=void 0,o(0);var i=o(6),l=e.NavyDeployment=i.GroupObject.extend({colNum:null,space:null,initialize:function(t,e,o,l){i.GroupObject.prototype.initialize.call(this,t,e,o,l),this.libID=0,this.code=SuperMap.Plot.SymbolType.NAVYDEPLOYMENT,this.symbolType=SuperMap.Plot.SymbolType.NAVYDEPLOYMENT,this.symbolName="海军兵力部署",null===this.colNum&&(this.colNum=1),null===this.space&&(this.space=10),null===this.scaleByMap&&(this.scaleByMap=!0)},destroy:function(){this.space=null,this.colNum=null,i.GroupObject.prototype.destroy.call(this)},redraw:function(){"none"===this.style.display||null!=this.layer&&"function"==typeof this.layer.getVisibility&&!1===this.layer.getVisibility()?this._clearComponents():this._redrawComponents()},_calculateParts:function(){var t=this._map.getFeatureByUuid(this.associatedUuid);if(null!==t&&t.symbolType===SuperMap.Plot.SymbolType.DOTSYMBOL&&0!==t.latLngs.length){for(var e=!1,o=0;o<t.deployments.length;o++)if(this===t.deployments[o]){e=!0;break}if(e||t.deployments.push(this),0!==this.subObjects.length&&0===this.components.length)for(var i=0,l=this.subObjects.length;i<l;i++)this.subObjects[i].ownerGroup=this,this.subObjects[i].enableEdit=!0,this._addComponents(this.subObjects[i]);if(0===this.components.length){for(var n=L.Util.cloneLatLngs(t.latLngs[0]),a=this._map.latLngToLayerPoint(L.latLng(n[0].lat,n[0].lng)),s=this._transitionPoint(new SuperMap.Geometry.Point(this.space,0),a),r=Math.abs(s.lng-n[0].lng),u=new SuperMap.Geometry.Point(0,0),p=this._transitionPoint(u,a),h=new SuperMap.Geometry.Point(100,100),c=this._transitionPoint(h,a),g=new L.LatLngBounds(L.latLng(p.lat,p.lng),L.latLng(c.lat,c.lng)),y=Math.ceil(this._getSubSymbolCount(this.subSymbols.length-1)/this.colNum),f=Math.abs(g.getNorth()-g.getSouth())*y+r*(y+1),P=L.latLng(n[0].lat+f/2,n[0].lng-5*r),d=0;d<this.subSymbols.length;d++)for(var S=0;S<this.subSymbols[d].totalNum;S++){var m=this._getSubSymbolCount(d-1)+S+1,b=Math.ceil(m/y),v=m-y*(b-1);if(1!==b&&1===v){var M=this._calculateBounds();P.lng=M.getWest()}this.subSymbols[d].symbolData.textContent=this.subSymbols[d].textContent;for(var A=P.lng-(r+Math.abs(g.getWest()-g.getEast())/3),T=P.lat-v*(Math.abs(g.getNorth()-g.getSouth())+r),_=0,O=0,x=0,w=0,E=0;E<this.subSymbols[d].symbolData.innerCells.length;E++)for(var C=0;C<this.subSymbols[d].symbolData.innerCells[E].positionPoints.length;C++)_<=this.subSymbols[d].symbolData.innerCells[E].positionPoints[C].x&&(_=this.subSymbols[d].symbolData.innerCells[E].positionPoints[C].x),O>=this.subSymbols[d].symbolData.innerCells[E].positionPoints[C].x&&(O=this.subSymbols[d].symbolData.innerCells[E].positionPoints[C].x),x<=this.subSymbols[d].symbolData.innerCells[E].positionPoints[C].y&&(x=this.subSymbols[d].symbolData.innerCells[E].positionPoints[C].y),w>=this.subSymbols[d].symbolData.innerCells[E].positionPoints[C].y&&(w=this.subSymbols[d].symbolData.innerCells[E].positionPoints[C].y);var I=L.latLng(T,A),D=this._map.latLngToLayerPoint(L.latLng(T,A)),R=new SuperMap.Geometry.Point(_,(x+w)/2),N=new SuperMap.Geometry.Point(R.x,R.y),U=new SuperMap.Geometry.Point(this.subSymbols[d].symbolData.anchorPoint.x,this.subSymbols[d].symbolData.anchorPoint.y),B=this._transitionPoint(N,D),k=this._transitionPoint(U,D);I.lat+=k.lat-B.lat,I.lng+=k.lng-B.lng;var F=this.subSymbols[d].symbolData.libID,G=this.subSymbols[d].symbolData.code;this.subSymbols[d].symbolData.annotationPosition=6;var V=SuperMap.Util.cloneObject(this.subSymbols[d].symbolData),j=L.supermap.plotting.PlottingObject.createSymbol(F,G,I,{serverUrl:this.serverUrl,symbolData:V,scaleByMap:!0,minScale:0,maxScale:2048,space:0});j.enableEdit=!0,j.ownerGroup=this,this._addComponents(j),this.bounds=this._calculateBounds(),this.subObjects.push(j)}if(this.bounds=new L.LatLngBounds,this.bounds=this._calculateBounds(),null!==this.textContent&&0!==this.textContent.length){var Y=L.latLng(n[0].lat+f/2+r,n[0].lng-5*r),z=L.supermap.plotting.PlottingObject.createSymbol(0,34,[Y],{textContent:this.textContent,serverUrl:this.serverUrl});z.style.labelAlign="rb",z.style.scaleByMap=!0,z.enableEdit=!0,z.ownerGroup=this,this._addComponents(z),this.bounds.extend(z.getBounds()),this.subObjects.push(z)}var W=new L.LatLngBounds(L.latLng(this.bounds.getSouth()-r,this.bounds.getWest()-r),L.latLng(this.bounds.getNorth()+r,this.bounds.getEast()+r)),X=[];X.push(L.latLng(W.getNorth(),W.getWest())),X.push(L.latLng(W.getSouth(),W.getEast()));var H=L.latLng(n[0].lat,n[0].lng);H.isFixedPos=!0,X.push(H);var Z=L.supermap.plotting.PlottingObject.createSymbol(0,SuperMap.Plot.SymbolType.ANNOFRAMESYMBOL,X,{serverUrl:this.serverUrl});for(var J in Z.enableEdit=!0,Z.ownerGroup=this,this.subObjects.splice(0,0,Z),this._addComponents(Z),this._clearComponents(),this.subObjects)this.subObjects[J].ownerGroup=this,this.subObjects[J].enableEdit=!0,this._addComponents(this.subObjects[J])}}},_reView:function(){for(var t in this.subObjects)this.subObjects[t].layer&&this.subObjects[t]._reView();this.fire(SuperMap.Plot.Event.reseteditmarkersvalues)},move:function(t,e){for(var o in this.subObjects)this.subObjects[o].move(t,e);this.fire(SuperMap.Plot.Event.reseteditmarkersvalues)},_resize:function(t,e){for(var o in this.subObjects)this.subObjects[o]._resize(t,e)},_transitionPoint:function(t,e){var o=e.x+t.x*(96/254),i=e.y-t.y*(96/254);return this._map.layerPointToLatLng(L.point(o,i))},_getSubSymbolCount:function(t){var e=0;if(t<0)return e;t>this.subSymbols.length-1&&(t=this.subSymbols.length-1);for(var o=0;o<=t;o++)e+=this.subSymbols[t].totalNum;return e},_calculateBounds:function(){for(var t in this.bounds=new L.LatLngBounds,this.components)this.components[t].symbolType===SuperMap.Plot.SymbolType.DOTSYMBOL&&this.bounds.extend(this.components[t].getBoundsWithText());return this.bounds},setTextContent:function(t){if(this.textContent!==t){this.textContent=t;for(var e=0;e<this.subObjects.length;e++)this.subObjects[e].symbolType===SuperMap.Plot.SymbolType.TEXTSYMBOL&&(this.subObjects[e].textContent=this.textContent,this.subObjects[e].redraw())}}}),n=e.navyDeployment=function(t,e,o,i){return new l(t,e,o,i)};L.supermap.plotting.navyDeployment=n,L.supermap.plotting.NavyDeployment=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.lineRelation=e.LineRelation=void 0,o(0);var i=o(7),l=o(40),n=e.LineRelation=i.AlgoSymbol.extend({startAssociatedUuid:null,endAssociatedUuid:null,lineRelationType:SuperMap.Plot.LineRelationType.ARROW,setLineRelationType:function(t){this.lineRelationType!==t&&(this.lineRelationType=t,this.redraw(),this.fire(SuperMap.Plot.Event.reseteditmarkersvalues))},getLineRelationType:function(){return this.lineRelationType},initialize:function(t,e,o,l){this.libID=0,this.code=SuperMap.Plot.SymbolType.LINERELATION,this.symbolType=SuperMap.Plot.SymbolType.LINERELATION,this.symbolName="连接线",i.AlgoSymbol.prototype.initialize.call(this,t,e,o,l)},onAdd:function(t){i.AlgoSymbol.prototype.onAdd.call(this,t),this.setJoinLineToDotSymbol(this.startAssociatedUuid),this.setJoinLineToDotSymbol(this.endAssociatedUuid)},setStartFeature:function(t){null!==this.startAssociatedUuid&&(this.removeJoinLineFromDotSymbol(this.startAssociatedUuid),this.startAssociatedUuid=null);var e=this._map.getFeatureByUuid(t);null!=e&&e instanceof l.DotSymbol&&(null!==this.endAssociatedUuid&&t===this.endAssociatedUuid||(this.startAssociatedUuid=t,this.setJoinLineToDotSymbol(this.startAssociatedUuid),null!==this.endAssociatedUuid&&this.setFeatures(this.startAssociatedUuid,this.endAssociatedUuid)))},setEndFeature:function(t){null!==this.endAssociatedUuid&&(this.removeJoinLineFromDotSymbol(this.endAssociatedUuid),this.endAssociatedUuid="");var e=this._map.getFeatureByUuid(t);null!==e&&e instanceof l.DotSymbol&&(null!==this.startAssociatedUuid&&t===this.startAssociatedUuid||(this.endAssociatedUuid=t,this.setJoinLineToDotSymbol(this.endAssociatedUuid),null!==this.startAssociatedUuid&&this.setFeatures(this.startAssociatedUuid,this.endAssociatedUuid)))},setFeatures:function(t,e){var o=this._map.getFeatureByUuid(t),i=this._map.getFeatureByUuid(e);null!==o&&null!==i&&o instanceof l.DotSymbol&&i instanceof l.DotSymbol&&(this.startAssociatedUuid=t,this.endAssociatedUuid=e,this.setJoinLineToDotSymbol(this.startAssociatedUuid),this.setJoinLineToDotSymbol(this.endAssociatedUuid),this.redraw())},destroy:function(){this.startFeature=null,this.endFeature=null,i.AlgoSymbol.prototype.destroy.call(this)},_calculateParts:function(){var t=null,e=this._map.getFeatureByUuid(this.startAssociatedUuid);if(null!==e){var o=L.Util.latLngsToSuperMapPoints(e.latLngs);null!==o&&0<o.length&&(t=o[0])}var i=null,l=this._map.getFeatureByUuid(this.endAssociatedUuid);if(null!==l){var n=L.Util.latLngsToSuperMapPoints(l.latLngs);null!==n&&0<n.length&&(i=n[0])}if(this.superMapAlgoSymbol.controlPoints=L.Util.latLngsToSuperMapPoints(this.latLngs),this.superMapAlgoSymbol.lineRelationType=this.lineRelationType,null!==t&&(0===this.superMapAlgoSymbol.controlPoints.length?this.superMapAlgoSymbol.controlPoints.push(t):this.superMapAlgoSymbol.controlPoints[0]=t),null!==i){if(0===this.superMapAlgoSymbol.controlPoints.length)return;1===this.superMapAlgoSymbol.controlPoints.length?this.superMapAlgoSymbol.controlPoints.push(i):this.superMapAlgoSymbol.controlPoints[this.superMapAlgoSymbol.controlPoints.length-1]=i}this.superMapAlgoSymbol.calculateParts(),this.latLngs=L.Util.superMapPointsToLatLngs(this.superMapAlgoSymbol.controlPoints),this._transSymbolCellsToLayers(this.superMapAlgoSymbol.components)},move:function(t,e){if(null!==t&&null!==e){for(var o in this.getLatLngs())this.getLatLngs()[o].lat+=t,this.getLatLngs()[o].lng+=e;for(var i=0,l=this.avoidRegions.length;i<l;i++)this.avoidRegions[i].move(t,e);this.redraw()}},_modifyPoint:function(t,e){if(0===t){var o=this.getFeatureByPoint(e);null!==o?this.setStartFeature(o.uuid):this.setStartFeature(null)}else if(this.getLatLngs().length-1===t){var i=this.getFeatureByPoint(e);null!==i?this.setEndFeature(i.uuid):this.setEndFeature(null)}this.redraw()},getFeatureByPoint:function(t){var e=this._map.latLngToLayerPoint(t),o=this.layer.features;for(var i in o){if(o[i]instanceof l.DotSymbol)if(this._map.latLngToLayerPoint(o[i].getLatLngs()[0]).distanceTo(e)<5)return o[i]}return null},setJoinLineToDotSymbol:function(t){var e=this._map.getFeatureByUuid(t);if(null!=e&&e instanceof l.DotSymbol){for(var o=!1,i=0;i<e.joinLines.length;i++)if(this===e.joinLines[i]){o=!0;break}o||e.joinLines.push(this)}},removeJoinLineFromDotSymbol:function(t){if(t&&"[object String]"===Object.prototype.toString.call(t)){var e=this._map.getFeatureByUuid(t);if(null!==e&&e instanceof l.DotSymbol)for(var o=0,i=e.joinLines.length;o<i;o++)if(this===e.joinLines[o]){e.joinLines.splice(o,1);break}}},_parseSymbolData:function(){i.AlgoSymbol.prototype._parseSymbolData.call(this),this.symbolData&&(this.symbolData.hasOwnProperty("startAssociatedUuid")&&(this.startAssociatedUuid=this.symbolData.startAssociatedUuid),this.symbolData.hasOwnProperty("endAssociatedUuid")&&(this.endAssociatedUuid=this.symbolData.endAssociatedUuid),this.symbolData.hasOwnProperty("lineRelationType")&&(this.lineRelationType=this.symbolData.lineRelationType))},_setSymbolData:function(){i.AlgoSymbol.prototype._setSymbolData.call(this),this.symbolData&&(this.symbolData.endAssociatedUuid=this.endAssociatedUuid,this.symbolData.lineRelationType=this.lineRelationType,this.symbolData.startAssociatedUuid=this.startAssociatedUuid)}}),a=e.lineRelation=function(t,e,o,i){return new n(t,e,o,i)};L.supermap.plotting.lineRelation=a,L.supermap.plotting.LineRelation=n},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.dotSymbol=e.DotSymbol=void 0,o(0);var i=o(1),l=o(39),n=o(2),a=e.DotSymbol=i.GraphicObject.extend({symbolSizeInLib:null,dRotate:0,initialScale:null,symbolSize:null,positionOffset:!1,positionOffsetType:null,positionOffsetX:null,positionOffsetY:null,symbolRank:null,negativeImage:null,middleMarkBounds:null,flagTextSize:60,maxScale:5,minScale:1,space:7,deployments:null,joinLines:null,trajectory:null,limitWidthHeight:!0,symbolTexts:null,symbolTextComponents:null,bloodVolumes:null,bloodVolumeComponents:null,pictureFrames:null,pictureFrameComponents:null,antoRotation:null,initialize:function(t,e,o,l){if(this.autoRotation=!1,this.symbolType=SuperMap.Plot.SymbolType.DOTSYMBOL,this.minEditPts=1,this.maxEditPts=1,this.joinLines=[],this.deployments=[],this.symbolTexts=[],this.bloodVolumes=[],this.pictureFrames=[],this.symbolTextComponents=[],this.bloodVolumeComponents=[],this.pictureFrameComponents=[],this.symbolSizeInLib=new SuperMap.Size(0,0),this.symbolSizeInLib=new SuperMap.Size(0,0),this.symbolSize=new SuperMap.Size(0,0),null===this.initialScale&&(this.initialScale={}),i.GraphicObject.prototype.initialize.call(this,t,e,o,l),null===this.positionOffsetType&&(this.positionOffsetType=SuperMap.Plot.PositionOffsetType.LINE),null===this.positionOffsetX&&(this.positionOffsetX=0),null===this.positionOffsetY&&(this.positionOffsetY=0),void 0===this.actualScale&&(this.actualScale=this.dScale),this.dScale>this.maxScale?this.dScale=this.maxScale:this.dScale<this.minScale&&(this.dScale=this.minScale),(this.symbolSize==={}||0===this.symbolSize.w&&0===this.symbolSize.h)&&(this.symbolSize.w=this.symbolSizeInLib.w,this.symbolSize.h=this.symbolSizeInLib.h),!this.initialScale.x){var n=this.symbolSizeInLib.w,a=this.symbolSize.w;this.symbolSizeInLib.w<this.symbolSizeInLib.h&&(n=this.symbolSizeInLib.h,a=this.symbolSize.h),this.initialScale.x=a/n,isNaN(this.initialScale.x)||this.initialScale.x===1/0||(!0===this.limitWidthHeight?(this.symbolSize.w=this.initialScale.x*this.dScale*this.symbolSizeInLib.w,this.symbolSize.h=this.initialScale.x*this.dScale*this.symbolSizeInLib.h):(this.symbolSize.w=this.initialScale.x*this.dScale*this.symbolSizeInLib.w,this.symbolSize.h=this.initialScale.y*this.dScale*this.symbolSizeInLib.h),void 0===this.fontSize&&(void 0===this.style.fontSize&&(this.style.fontSize=12),this.fontSize=this.style.fontSize/this.initialScale.x))}},destroy:function(){if(this.symbolRank=null,this.negativeImage=null,this.annotationIndex=-1,this.textPosition=null,this.symbolSizeInLib=null,this.symbolSize=null,this.middleMarkBounds=null,this.positionOffsetX=null,this.positionOffsetY=null,this.trajectory=null,null!==this.joinLines&&void 0!==this.joinLines)for(var t=0;t<this.joinLines.length;t++)null!==this.joinLines[t]&&(this.joinLines[t].startAssociatedUuid===this.uuid&&(this.joinLines[t].removeJoinLineFromDotSymbol(),this.joinLines[t].startAssociatedUuid=null),this.joinLines[t].endAssociatedUuid===this.uuid&&(this.joinLines[t].removeJoinLineFromDotSymbol(),this.joinLines[t].endAssociatedUuid=null));this.joinLines=null,this.deployments=null,i.GraphicObject.prototype.destroy.call(this)},_reView:function(){if(void 0!==this.prevStrokeWidth&&this.prevStrokeWidth!==this.style.weight&&(this.strokeWidth=this.style.weight,this.prevStrokeWidth=this.style.weight),void 0!==this.prevFontSize&&this.prevFontSize!==this.style.fontSize&&(this.fontSize=this.style.fontSize/this.dScale/this.initialScale.x,this.prevFontSize=this.style.fontSize),void 0!==this.prevSpace&&this.prevSpace*this.dScale!==this.space&&(this.prevSpace=this.space/this.dScale),this.fromZoom!==this._map.getZoom()){if(this.scaleByMap&&!1!==this.scaleByMap)if(void 0===this.actualScale&&(this.actualScale=this.dScale),void 0===this.prevScale&&(this.prevScale=this.dScale),this.actualScale*=this._map.getZoomScale(this._map.getZoom(),this.fromZoom),this.actualScale>this.maxScale?this.dScale=this.maxScale:this.actualScale<this.minScale?this.dScale=this.minScale:this.dScale=this.actualScale,this.dScale!==this.prevScale){var t=this.initialScale.x*this.dScale;!0===this.limitWidthHeight?(this.symbolSize.w=t*this.symbolSizeInLib.w,this.symbolSize.h=t*this.symbolSizeInLib.h):this.prevScale?(this.symbolSize.w=this.initialScale.x*this.dScale*this.symbolSizeInLib.w/this.prevScale,this.symbolSize.h=this.initialScale.y*this.dScale*this.symbolSizeInLib.h/this.prevScale):(this.symbolSize.w=this.initialScale.x*this.dScale*this.symbolSizeInLib.w,this.symbolSize.h=this.initialScale.y*this.dScale*this.symbolSizeInLib.h),void 0===this.prevSpace&&(this.prevSpace=this.space),void 0===this.strokeWidth&&(this.strokeWidth=this.style.weight);var e=this.strokeWidth/.5*5;if(this.symbolSize.w<e&&this.symbolSize.h<e){this.scaleStrokeWidth=!0;var o=this.symbolSize.w>this.symbolSize.h?this.symbolSize.w:this.symbolSize.h;this.style.weight=Math.round(o/10),this.style.weight>=this.weight&&(this.style.weight=this.weight),this.style.weight<=.5&&(this.style.weight=.5)}else!0===this.scaleStrokeWidth&&(this.scaleStrokeWidth=!1),this.style.weight=this.strokeWidth;if(this.prevStrokeWidth=this.style.weight,this.style.fontSize=this.style.fontSize*this._map.getZoomScale(this._map.getZoom(),this.fromZoom),this.prevFontSize=this.style.fontSize,0!==this.textContent.length&&8===this.annotationPosition){var i;!0===this.limitWidthHeight?i=this.middleMarkBounds.scale(this.dScale*this.initialScale.x,this.anchorPoint):this._widthHeightLimitScale();var l=96*i.getWidth()/25.4/10,a=96*i.getHeight()/25.4/10;this.components[this._annotationId].options.graphicWidth=l,this.components[this._annotationId].options.graphicHeight=a}for(var s in this.components)s===this._annotationId&&this.components[s]instanceof n.Text?this.components[s].options.fontSize=this.style.fontSize:s!==this._annotationId&&this.components[s]instanceof n.Text?this.components[s].options.fontSize=t*(this.components[s].options.fontSize/this.prevScale/this.initialScale.x):s!==this._annotationId&&!0!==this.components[s].isLeadLine&&(this.components[s].options.weight=this.style.weight);for(var r=0;r<this.geoSymbolTexts.length;r++){var u=this.geoSymbolTexts[r];null!==u&&u._calculateParts()}var p=this.dScale/this.prevScale,h=this._map.getZoomScale(this._map.getZoom(),this.fromZoom);p!==h&&this._resizeCells(p*(1/h),this.getLatLngs()[0]),this._renderer instanceof L.Canvas&&p===h&&!0===this.positionOffset&&(this._clearComponents(),this._calculateParts()),this.prevScale=this.dScale,this._calculateLabel(),this._calculateBloodVolume(),this._calculatePictureFrame()}else{var c=this._map.getZoomScale(this.fromZoom,this._map.getZoom());this._resizeCells(c,this.getLatLngs()[0])}else{for(var g=0;g<this.geoSymbolTexts.length;g++)this.geoSymbolTexts[g].fromZoom=this._map.getZoom();var y=this._map.getZoomScale(this.fromZoom,this._map.getZoom()),f=this.getLatLngs()[0];this._resizeCells(y,f)}this.fromZoom=this._map.getZoom(),this.layer._map.getRenderer(this.layer)instanceof L.Canvas&&this._updateCanvasFills(),this._updateSymbolTexts();var P="";null!==this._map&&this._map instanceof L.Map&&(P=this._map.options.crs.code,L.Util.isMercatorProjection(P)&&this.redraw()),this.fire(SuperMap.Plot.Event.reseteditmarkersvalues),this.isSelected&&this._map.getPlotEditControl()&&this._map.getPlotEditControl().fire(SuperMap.Plot.Event.featuresmodified,{features:[this]})}},setLatLngs:function(t){this.latLngs=t,this.redraw();for(var e=0;e<this.deployments.length;e++){var o=this.deployments[e];null!==o&&null!=o.layer&&(o.symbolType!==SuperMap.Plot.SymbolType.NAVYDEPLOYMENT&&o.symbolType!==SuperMap.Plot.SymbolType.AIRDEPLOYMENT||(o.style.display=this.style.display,o.redraw()))}this._updateJoinLines(),this._updateSymbolTexts()},getSpace:function(){return this.space},setSpace:function(t){this.space!==t&&(this.space=t,0!==this.textContent.length&&(null!=this.graphic&&null!=this.graphic.layer&&!0===this.graphic.layer.getVisibility()?this.graphic.redraw():null==this.layer||null!=this.layer.getVisibility&&!0!==this.layer.getVisibility()||this._handleAnnotation()))},setRotate:function(t){if(!isNaN(t)){var e=t-this.dRotate;this.dRotate=t;for(var o=0,i=this.avoidRegions.length;o<i;o++)L.Util.rotateLatLngs(this.avoidRegions[o].getLatLngs(),this.getLatLngs()[0],e);this.redraw(),this._updateSymbolTexts()}},getScale:function(){return!0===this.limitWidthHeight?this.initialScale.x:this.initialScale={x:this.symbolSize.w/this.symbolSizeInLib.w,y:this.symbolSize.h/this.symbolSizeInLib.h}},setScale:function(t,e){isNaN(t)||(!0===this.limitWidthHeight?(this.initialScale.x=t,this.symbolSize.w=this.initialScale.x*this.dScale*this.symbolSizeInLib.w,this.symbolSize.h=this.initialScale.x*this.dScale*this.symbolSizeInLib.h):(this.symbolSize.w=t*this.symbolSizeInLib.w,this.symbolSize.h=e*this.symbolSizeInLib.h),this.style.fontSize=this.fontSize*this.dScale*this.initialScale.x,this.prevFontSize=this.style.fontSize,this.redraw(),this._updateSymbolTexts())},setPositionOffset:function(t){this.positionOffset!==t&&(this.positionOffset=t,!1===this.positionOffset&&(this.positionOffsetX=0,this.positionOffsetY=0),this.redraw())},getPositionOffset:function(){return this.positionOffset},setPositionOffsetType:function(t){this.positionOffsetType!==t&&(this.positionOffsetType=t,this.positionOffset&&this.redraw())},getPositionOffsetType:function(){return this.positionOffsetType},setTextContent:function(t){this.textContent=t,null!=this.graphic&&null!=this.graphic.layer&&!0===this.graphic.layer.getVisibility()?this.graphic.redraw():null==this.layer||null!=this.layer.getVisibility&&!0!==this.layer.getVisibility()||this._handleAnnotation()},middleMarkExist:function(){return this.symbolData.middleMarkExist},setTextPosition:function(t){8===t&&!1===this.symbolData.middleMarkExist||this.annotationPosition!==t&&(this.annotationPosition=t,null!=this.graphic&&null!=this.graphic.layer&&!0===this.graphic.layer.getVisibility()?this.graphic.redraw():null==this.layer||null!=this.layer.getVisibility&&!0!==this.layer.getVisibility()||this._handleAnnotation())},getSymbolSize:function(){return this.symbolSize},setSymbolSize:function(t,e){if(0===this.symbolSizeInLib.w||0===this.symbolSizeInLib.h)this.initialScale.x=1;else{null===this.symbolSize&&(this.symbolSize=new SuperMap.Size(0,0));var o=t/this.dScale/this.symbolSizeInLib.w,i=e/this.dScale/this.symbolSizeInLib.h;!0===this.limitWidthHeight?(this.initialScale.x!==o?this.initialScale.x=o:this.initialScale.x!==i&&(this.initialScale.x=i),this.symbolSize.w=this.initialScale.x*this.dScale*this.symbolSizeInLib.w,this.symbolSize.h=this.initialScale.x*this.dScale*this.symbolSizeInLib.h):(this.initialScale.x=o,this.initialScale.y=i,this.symbolSize.w=this.initialScale.x*this.dScale*this.symbolSizeInLib.w,this.symbolSize.h=this.initialScale.y*this.dScale*this.symbolSizeInLib.h)}var l;l=!1===this.limitWidthHeight?this.initialScale.x<this.initialScale.y?this.initialScale.x:this.initialScale.y:this.initialScale.x,void 0===this.fontSize?this.fontSize=this.style.fontSize/this.dScale/l:this.style.fontSize=this.fontSize*this.dScale*l,this.prevFontSize=this.style.fontSize,this._map&&this.redraw()},setSurroundLineType:function(t){if(this.surroundLineType!==t){var e=new SuperMap.GetSymbolInfoParameters;e.libID=this.libID,e.code=this.code,e.negativeImage=this.negativeImage,e.symbolRank=this.symbolRank,e.surroundLineType=t,L.supermap.symbolInfoService(this.serverUrl).getSymbolInfo(e,function(t){this.symbolData.innerCells=t.result.innerCells,this.surroundLineType=t.result.surroundLineType,this.redraw(),this._map&&this._map.getPlotEditControl()&&this._map.getPlotEditControl().fire(SuperMap.Plot.Event.featuresmodified,{features:[this]})},this)}},getSymbolRanks:function(){return this.symbolData.symbolRanks},getSymbolRank:function(){return this.symbolRank},setSymbolRank:function(t){if(this.symbolRank!==t){var e=new SuperMap.GetSymbolInfoParameters;e.libID=this.libID,e.code=this.code,e.symbolRank=t,e.negativeImage=this.negativeImage,e.surroundLineType=this.surroundLineType,L.supermap.symbolInfoService(this.serverUrl).getSymbolInfo(e,function(t){this.symbolData.innerCells=t.result.innerCells,this.symbolRank=t.result.symbolRank,this.redraw(),this._map&&this._map.getPlotEditControl()&&this._map.getPlotEditControl().fire(SuperMap.Plot.Event.featuresmodified,{features:[this]})},this)}},getNegativeImage:function(){return this.negativeImage},setNegativeImage:function(t){if(this.negativeImage!==t){var e=new SuperMap.GetSymbolInfoParameters;e.libID=this.libID,e.code=this.code,e.negativeImage=t,e.symbolRank=this.symbolRank,e.surroundLineType=this.surroundLineType,L.supermap.symbolInfoService(this.serverUrl).getSymbolInfo(e,function(t){this.symbolData.innerCells=t.result.innerCells,this.negativeImage=t.result.negativeImage,this.redraw(),this._map&&this._map.getPlotEditControl()&&this._map.getPlotEditControl().fire(SuperMap.Plot.Event.featuresmodified,{features:[this]})},this)}},setWidthHeightLimit:function(t){this.limitWidthHeight!==t&&(t.constructor===Boolean&&(this.limitWidthHeight=t),!1===this.limitWidthHeight?(this.initialScale.x=this.symbolSize.w/this.symbolSizeInLib.w,this.initialScale.y=this.symbolSize.h/this.symbolSizeInLib.h):!0===this.limitWidthHeight&&(this.initialScale.x=this.initialScale.x<this.initialScale.y?this.initialScale.y:this.initialScale.x,this.redraw()))},getWidthHeightLimit:function(){return this.limitWidthHeight},getBloodVolumes:function(){return this.bloodVolumes},getSymbolTexts:function(){return this.symbolTexts},getPictureFrames:function(){return this.pictureFrames},move:function(t,e){if(this.hasOwnProperty("_eventParents")&&null!==this._eventParents)for(var o in this._eventParents){var l=this._eventParents[o];if(l.symbolType===SuperMap.Plot.SymbolType.FLAGGROUP&&!1===l.isSelected)return void this.fire(SuperMap.Plot.Event.reseteditmarkersvalues)}if(this.positionOffset){var n=this._map.latLngToLayerPoint(L.latLng(this.getLatLngs()[0].lat+t,this.getLatLngs()[0].lng+e)),a=this._map.latLngToLayerPoint(this.getLatLngs()[0]);this.positionOffsetX+=(n.x-a.x)/this.dScale,this.positionOffsetY+=(n.y-a.y)/this.dScale,this.redraw()}else i.GraphicObject.prototype._move.call(this,t,e);if(this._updateJoinLines(),null!==this.deployments&&0<this.deployments.length)for(var s=0;s<this.deployments.length;s++){var r=this.deployments[s];if(null!==r&&(r.symbolType===SuperMap.Plot.SymbolType.NAVYDEPLOYMENT||r.symbolType===SuperMap.Plot.SymbolType.AIRDEPLOYMENT)){for(var u in r.components)r.components[u].symbolType===SuperMap.Plot.SymbolType.ANNOFRAMESYMBOL&&(r.components[u].latLngs[2]=this.latLngs[0],r.components[u].redraw());for(var p in r.subObjects)r.subObjects[p].redraw()}}for(var h=0,c=this.avoidRegions.length;h<c;h++)L.Util.moveLatLngs(this.avoidRegions[h].getLatLngs(),t,e);var g="";null!==this._map&&this._map instanceof L.Map&&(g=this._map.options.crs.code,L.Util.isMercatorProjection(g)&&this.redraw()),this._updateSymbolTexts(),this.fire(SuperMap.Plot.Event.reseteditmarkersvalues)},getBounds:function(){var t=new L.LatLngBounds;for(var e in this.components){var o=this.components[e];o.isLeadLine||o.isAnnotation||o.isSymbolText||o.isBloodVolume||o.isPictureFrame||t.extend(o.getBounds?o.getBounds():o.getLatLng())}return t},getBoundsWithText:function(){var t=new L.LatLngBounds;for(var e in this.components){var o=this.components[e];o.isLeadLine||t.extend(o.getBounds?o.getBounds():o.getLatLng())}return t},_calculateParts:function(){if(!(this.getLatLngs().length<this.minEditPts))if("none"===this.style.display||null!=this.layer&&"function"==typeof this.layer.getVisibility&&!1===this.layer.getVisibility())this._updateSymbolTexts();else{var t=SuperMap.Plot.AnalysisSymbol.analysisSymbolCells(this.symbolData,!0),e=this._map.latLngToLayerPoint(this.getLatLngs()[0]);if(!0===this.positionOffset&&(e.x+=this.positionOffsetX*this.dScale,e.y+=this.positionOffsetY*this.dScale),!0===this.limitWidthHeight)var o=this.initialScale.x*this.dScale;for(var i=0,l=t.length;i<l;i++){var n=t[i];if(0!==this.surroundLineType||!0!==n.surroundLineFlag){n.type===SuperMap.Plot.SymbolType.TEXTSYMBOL&&(n.style.fontSize=o*(n.style.fontSize/10),n.style.fontSize<6&&(n.style.fontSize=6),n.style.labelRotation+=-this.dRotate),null!=n.polybezierClose&&(n.type===SuperMap.Plot.SymbolType.POLYBEZIERSYMBOL||n.type===SuperMap.Plot.SymbolType.POLYBEZIERCLOSESYMBOL?(n.type,SuperMap.Plot.SymbolType.POLYBEZIERSYMBOL,n.positionPoints=SuperMap.Plot.PlottingUtil.generateBeizerPointsWithCtrlPt(n.positionPoints),n.isClosed&&n.positionPoints[0]!==n.positionPoints[n.positionPoints.length-1]&&n.positionPoints.push(n.positionPoints[0])):n.type===SuperMap.Plot.SymbolType.KIDNEY&&(n.positionPoints=SuperMap.Plot.Primitives.getSpatialData(n.type,n.positionPoints)));for(var a=0,s=n.positionPoints.length;a<s;a++){n.positionPoints[a].x-=this.symbolData.anchorPoint.x,n.positionPoints[a].y-=this.symbolData.anchorPoint.y,!0===this.limitWidthHeight?(n.positionPoints[a].x=n.positionPoints[a].x*o,n.positionPoints[a].y=n.positionPoints[a].y*o):(n.positionPoints[a].x=n.positionPoints[a].x*this.symbolSize.w/this.symbolSizeInLib.w,n.positionPoints[a].y=n.positionPoints[a].y*this.symbolSize.h/this.symbolSizeInLib.h);var r=this.dRotate*(Math.PI/180);SuperMap.Plot.PlottingUtil.rotateAngle({x:0,y:0},r,n.positionPoints[a]),n.positionPoints[a]=this._transitionPoint(n.positionPoints[a],e)}n.positionPoints=L.Util.latLngsToSuperMapPoints(n.positionPoints)}}this._transSymbolCellsToLayers(t),this._calculateBloodVolume(),this._calculatePictureFrame(),this._generateLeadLine(),this._annotationId=-1,this.isNotRedrawText||void 0!==this.isNotRedrawText||this._handleAnnotation(),this._calculateLabel(),this._updateSymbolTexts(),this._bounds=this.getBounds()}},_calculateBloodVolume:function(t,e){for(var o=0;o<this.components.length;)!0===this.components[o].isBloodVolume?(null!=this.components[o]._renderer&&(this.components[o].removeEventParent(this),this.components[o].onRemove()),delete this.components[o],this.components.splice(o,1)):o++;if(this.bloodVolumeComponents.length=0,!(this.getLatLngs().length<this.minEditPts)&&null!=this.bloodVolumes&&0!==this.bloodVolumes.length){null==t&&(t=this.getBounds()),null==e&&(e=this.getLatLngs()[0]);for(var i=this._map.latLngToLayerPoint(e),l=0;l<this.bloodVolumes.length;l++){var n=[],a=null;if(null!=this.bloodVolumes[l].width)a=Math.abs(this._map.layerPointToLatLng(L.point(i.x+this.bloodVolumes[l].width,i.y)).lng-e.lng);else{var s=Math.abs(this._map.layerPointToLatLng(L.point(i.x+40,i.y)).lng-e.lng);(a=Math.abs(t.getEast()-t.getWest()))<s&&(a=s)}var r,u,p=null;if(null!=this.bloodVolumes[l].height)p=Math.abs(this._map.layerPointToLatLng(L.point(i.x,i.y+this.bloodVolumes[l].height)).lat-e.lat);else{p=Math.abs(this._map.layerPointToLatLng(L.point(i.x,i.y+8)).lat-e.lat)}if(this.bloodVolumes[l].position===SuperMap.Plot.Position.TOP){var h=L.latLng(t.getNorth(),t.getCenter().lng),c=this._map.latLngToLayerPoint(h);c.x+=this.bloodVolumes[l].offsetX,c.y+=this.bloodVolumes[l].offsetY,h=this._map.layerPointToLatLng(c),r=L.latLng(h.lat+p,h.lng-.5*a),u=L.latLng(h.lat,h.lng+.5*a)}else if(this.bloodVolumes[l].position===SuperMap.Plot.Position.BOTTOM){var g=L.latLng(t.getSouth(),t.getCenter().lng),y=this._map.latLngToLayerPoint(g);y.x+=this.bloodVolumes[l].offsetX,y.y+=this.bloodVolumes[l].offsetY,g=this._map.layerPointToLatLng(y),r=L.latLng(g.lat,g.lng-.5*a),u=L.latLng(g.lat-p,g.lng+.5*a)}else if(this.bloodVolumes[l].position===SuperMap.Plot.Position.LEFT){var f=L.latLng(t.getCenter().lat,t.getWest()),P=this._map.latLngToLayerPoint(f);P.x+=this.bloodVolumes[l].offsetX,P.y+=this.bloodVolumes[l].offsetY,f=this._map.layerPointToLatLng(P),r=L.latLng(f.lat+.5*a,f.lng-p),u=L.latLng(f.lat-.5*a,f.lng)}else if(this.bloodVolumes[l].position===SuperMap.Plot.Position.RIGHT){var d=L.latLng(t.getCenter().lat,t.getEast()),S=this._map.latLngToLayerPoint(d);S.x+=this.bloodVolumes[l].offsetX,S.y+=this.bloodVolumes[l].offsetY,d=this._map.layerPointToLatLng(S),r=L.latLng(d.lat+.5*a,d.lng),u=L.latLng(d.lat-.5*a,d.lng+p)}var m=this.bloodVolumes[l].style.color;null==m&&(m="#808080");var b=this.bloodVolumes[l].style.weight;null==b&&(b=4);var v=this.bloodVolumes[l].style.opacity;null==v&&(v=1);var M=this._createAndDrawLayer(SuperMap.Plot.SymbolType.RECTANGLESYMBOL,[r,u],{fillLimit:!0,fillSymbolID:1,lineWidthLimit:!0,weight:b,lineColorLimit:!0,color:m,opacity:v});M.isBloodVolume=!0,M.fromZoom=this._map.getZoom(),n.push(M);var A=this.bloodVolumes[l].style.remainingVolumeColor;null==A&&(A="#00ff00");var T=this.bloodVolumes[l].style.remainingVolumeOpacity;null==T&&(T=.8);var _=this.bloodVolumes[l].style.consumeVolumeColor;null==_&&(_="#000000");var O=this.bloodVolumes[l].style.consumeVolumeOpacity;null==O&&(O=.8);var x=this.components[this.components.length-1].getBounds();if(this.bloodVolumes[l].position===SuperMap.Plot.Position.TOP||this.bloodVolumes[l].position===SuperMap.Plot.Position.BOTTOM){if(!SuperMap.Plot.PlottingUtil.equalFuzzy(0,this.bloodVolumes[l].volume)){var w=x.getNorthWest(),E=L.latLng(x.getSouthEast().lat,w.lng+this.bloodVolumes[l].volume*a),C=this._createAndDrawLayer(SuperMap.Plot.SymbolType.RECTANGLESYMBOL,[w,E],{fillLimit:!0,fillSymbolID:0,fillColorLimit:!0,fillColor:A,fillOpacity:T,lineColorLimit:!0,opacity:0});C.isBloodVolume=!0,C.fromZoom=this._map.getZoom(),n.push(C)}if(!SuperMap.Plot.PlottingUtil.equalFuzzy(1,this.bloodVolumes[l].volume)){var I=x.getSouthEast(),D=L.latLng(x.getNorthWest().lat,x.getNorthWest().lng+this.bloodVolumes[l].volume*a),R=this._createAndDrawLayer(SuperMap.Plot.SymbolType.RECTANGLESYMBOL,[I,D],{fillLimit:!0,fillSymbolID:0,fillColorLimit:!0,fillColor:_,fillOpacity:O,lineColorLimit:!0,opacity:0});R.isBloodVolume=!0,R.fromZoom=this._map.getZoom(),n.push(R)}}else if(this.bloodVolumes[l].position===SuperMap.Plot.Position.LEFT){if(!SuperMap.Plot.PlottingUtil.equalFuzzy(0,this.bloodVolumes[l].volume)){var N=x.getSouthWest(),U=L.latLng(N.lat+this.bloodVolumes[l].volume*a,x.getNorthEast().lng),B=this._createAndDrawLayer(SuperMap.Plot.SymbolType.RECTANGLESYMBOL,[N,U],{fillLimit:!0,fillSymbolID:0,fillColorLimit:!0,fillColor:A,fillOpacity:T,lineColorLimit:!0,opacity:0});B.isBloodVolume=!0,B.fromZoom=this._map.getZoom(),n.push(B)}if(!SuperMap.Plot.PlottingUtil.equalFuzzy(1,this.bloodVolumes[l].volume)){var k=x.getNorthEast(),F=L.latLng(x.getSouthWest().lat+this.bloodVolumes[l].volume*a,x.getSouthWest().lng),G=this._createAndDrawLayer(SuperMap.Plot.SymbolType.RECTANGLESYMBOL,[k,F],{fillLimit:!0,fillSymbolID:0,fillColorLimit:!0,fillColor:_,fillOpacity:O,lineColorLimit:!0,opacity:0});G.isBloodVolume=!0,G.fromZoom=this._map.getZoom(),n.push(G)}}else if(this.bloodVolumes[l].position===SuperMap.Plot.Position.RIGHT){if(!SuperMap.Plot.PlottingUtil.equalFuzzy(0,this.bloodVolumes[l].volume)){var V=x.getNorthEast(),j=L.latLng(V.lat-this.bloodVolumes[l].volume*a,x.getSouthWest().lng),Y=this._createAndDrawLayer(SuperMap.Plot.SymbolType.RECTANGLESYMBOL,[V,j],{fillLimit:!0,fillSymbolID:0,fillColorLimit:!0,fillColor:A,fillOpacity:T,lineColorLimit:!0,opacity:0});Y.isBloodVolume=!0,Y.fromZoom=this._map.getZoom(),n.push(Y)}if(!SuperMap.Plot.PlottingUtil.equalFuzzy(1,this.bloodVolumes[l].volume)){var z=x.getSouthWest(),W=L.latLng(x.getNorthEast().lat-this.bloodVolumes[l].volume*a,x.getNorthEast().lng),X=this._createAndDrawLayer(SuperMap.Plot.SymbolType.RECTANGLESYMBOL,[z,W],{fillLimit:!0,fillSymbolID:0,fillColorLimit:!0,fillColor:_,fillOpacity:O,lineColorLimit:!0,opacity:0});X.isBloodVolume=!0,X.fromZoom=this._map.getZoom(),n.push(X)}}this.bloodVolumeComponents.push(n)}}},_calculatePictureFrame:function(t){for(var e=0;e<this.components.length;)!0===this.components[e].isPictureFrame?(null!=this.components[e]._renderer&&(this.components[e].removeEventParent(this),this.components[e].onRemove()),delete this.components[e],this.components.splice(e,1)):e++;if(this.pictureFrameComponents.length=0,!(this.getLatLngs().length<this.minEditPts)&&null!=this.pictureFrames&&0!==this.pictureFrames.length){null==t&&(t=this.getBounds());for(var o=0;o<this.pictureFrames.length;o++){var i=[],l=void 0,n=0,a=0;if(this.pictureFrames[o].position===SuperMap.Plot.Position.TOP){var s=L.latLng(t.getNorth(),t.getCenter().lng),r=this._map.latLngToLayerPoint(s);r.x+=this.pictureFrames[o].offsetX,r.y+=this.pictureFrames[o].offsetY,l=this._map.layerPointToLatLng(r),n=-.5*this.pictureFrames[o].width,a=-this.pictureFrames[o].height}else if(this.pictureFrames[o].position===SuperMap.Plot.Position.BOTTOM){var u=L.latLng(t.getSouth(),t.getCenter().lng),p=this._map.latLngToLayerPoint(u);p.x+=this.pictureFrames[o].offsetX,p.y+=this.pictureFrames[o].offsetY,l=this._map.layerPointToLatLng(p),n=-.5*this.pictureFrames[o].width}else if(this.pictureFrames[o].position===SuperMap.Plot.Position.LEFT){var h=L.latLng(t.getCenter().lat,t.getWest()),c=this._map.latLngToLayerPoint(h);c.x+=this.pictureFrames[o].offsetX,c.y+=this.pictureFrames[o].offsetY,l=this._map.layerPointToLatLng(c),n=-this.pictureFrames[o].width,a=-.5*this.pictureFrames[o].height}else if(this.pictureFrames[o].position===SuperMap.Plot.Position.RIGHT){var g=L.latLng(t.getCenter().lat,t.getEast()),y=this._map.latLngToLayerPoint(g);y.x+=this.pictureFrames[o].offsetX,y.y+=this.pictureFrames[o].offsetY,l=this._map.layerPointToLatLng(y),a=-.5*this.pictureFrames[o].height}var f={externalGraphic:this.pictureFrames[o].path,graphicWidth:this.pictureFrames[o].width,graphicHeight:this.pictureFrames[o].height,graphicXOffset:n,graphicYOffset:a},P=L.supermap.plotting.pointImage([l],f);P.isPictureFrame=!0,P.fromZoom=this._map.getZoom(),this._addComponents(P),i.push(P),this.pictureFrameComponents.push(i)}}},_generateLeadLine:function(){if(this.positionOffset)if(this.positionOffsetType===SuperMap.Plot.PositionOffsetType.LINE){var t=this._map.latLngToLayerPoint(this.getLatLngs()[0]),e=L.point(t.x+this.positionOffsetX*this.dScale,t.y+this.positionOffsetY*this.dScale),o=this._map.layerPointToLatLng(e),i=[this.getLatLngs()[0].clone(),o];this._createAndDrawLayer(24,i,{surroundLineFlag:!1,lineTypeLimit:!0}).isLeadLine=!0}else{var l,n,a=this._map.latLngToLayerPoint(this.getLatLngs()[0]),s=L.point(a.x+this.positionOffsetX*this.dScale,a.y+this.positionOffsetY*this.dScale),r=this._map.layerPointToLatLng(s),u=new SuperMap.Geometry.Point(this.getLatLngs()[0].lng,this.getLatLngs()[0].lat),p=new SuperMap.Geometry.Point(r.lng,r.lat),h=180*SuperMap.Plot.PlottingUtil.radian(u,p)/Math.PI;if(h>45&&h<135||h>225&&h<315){var c=L.point(s.x-this.style.weight/2,s.y),g=L.point(s.x+this.style.weight/2,s.y);l=this._map.layerPointToLatLng(c),n=this._map.layerPointToLatLng(g)}else{var y=L.point(s.x,s.y-this.style.weight/2),f=L.point(s.x,s.y+this.style.weight/2);l=this._map.layerPointToLatLng(y),n=this._map.layerPointToLatLng(f)}var P=[this.getLatLngs()[0],l,n];this._createAndDrawLayer(32,P,{surroundLineFlag:!1,lineWidthLimit:!0,weight:0,fillLimit:!0,fill:!0}).isLeadLine=!0}},_handleAnnotation:function(t){if(null!=this._annotationId&&-1!==this._annotationId&&(null!=this.components[this._annotationId]._renderer&&(this.components[this._annotationId].removeEventParent(this),this.components[this._annotationId].onRemove()),delete this.components[this._annotationId],this.components.splice(this._annotationId,1),this._annotationId=-1),!1!==this.textDisplay&&(this.textContent=SuperMap.Plot.PlottingUtil.trim(this.textContent),null==t&&(t=this.getBounds()),t.isValid()&&this.textContent&&null!==this.textContent&&0!==this.textContent.length&&null!==t&&t.isValid())){var e={};SuperMap.Plot.PlottingUtil.cloneObject(this.style);var o=this.space*this.dScale,i=null;if(0===this.annotationPosition){e.labelAlign="rb";var l=L.latLng(t.getNorth(),t.getWest()),n=this._map.latLngToLayerPoint(l);n.x-=o,i=this._map.layerPointToLatLng(n)}else if(1===this.annotationPosition){e.labelAlign="rt";var a=L.latLng(t.getSouth(),t.getWest()),s=this._map.latLngToLayerPoint(a);s.x-=o,i=this._map.layerPointToLatLng(s)}else if(2===this.annotationPosition){e.labelAlign="lb";var r=L.latLng(t.getNorth(),t.getEast()),u=this._map.latLngToLayerPoint(r);u.x+=o,i=this._map.layerPointToLatLng(u)}else if(3===this.annotationPosition){e.labelAlign="lt";var p=L.latLng(t.getSouth(),t.getEast()),h=this._map.latLngToLayerPoint(p);h.x+=o,i=this._map.layerPointToLatLng(h)}else if(4===this.annotationPosition){e.labelAlign="cb";var c=L.latLng(t.getNorth(),(t.getWest()+t.getEast())/2),g=this._map.latLngToLayerPoint(c);g.y-=o,i=this._map.layerPointToLatLng(g)}else if(5===this.annotationPosition){e.labelAlign="ct";var y=L.latLng(t.getSouth(),(t.getWest()+t.getEast())/2),f=this._map.latLngToLayerPoint(y);f.y+=o,i=this._map.layerPointToLatLng(f)}else if(6===this.annotationPosition){e.labelAlign="rm";var P=L.latLng((t.getSouth()+t.getNorth())/2,t.getWest()),d=this._map.latLngToLayerPoint(P);d.x-=o,i=this._map.layerPointToLatLng(d)}else if(7===this.annotationPosition){e.labelAlign="lm";var S=L.latLng((t.getSouth()+t.getNorth())/2,t.getEast()),m=this._map.latLngToLayerPoint(S);m.x+=o,i=this._map.layerPointToLatLng(m)}else if(8===this.annotationPosition&&this.symbolData.middleMarkExist){var b;b=!0===this.limitWidthHeight?this.middleMarkBounds.scale(this.dScale*this.initialScale.x,this.anchorPoint):this._widthHeightLimitScale();var v=new SuperMap.Geometry.Point((b.left+b.right)/2,(b.top+b.bottom)/2);if(this.negativeImage){var M=SuperMap.Plot.PlottingUtil.projectPoint(v,new SuperMap.Geometry.Point(this.anchorPoint.x,100),new SuperMap.Geometry.Point(this.anchorPoint.x,this.anchorPoint.y));SuperMap.Plot.PlottingUtil.rotateAngle(M,Math.PI,v)}v.x-=this.anchorPoint.x,v.y-=this.anchorPoint.y;var A=this.dRotate*(Math.PI/180);SuperMap.Plot.PlottingUtil.rotateAngle(new SuperMap.Geometry.Point(0,0),A,v);var T=this._map.latLngToLayerPoint(this.getLatLngs()[0]);!0===this.positionOffset&&(T.x+=this.positionOffsetX*this.dScale,T.y+=this.positionOffsetY*this.dScale);var _=96*b.getWidth()/25.4/10,O=96*b.getHeight()/25.4/10;e.graphicWidth=_,e.graphicHeight=O,i=this._transitionPoint(v,T)}if(8===this.annotationPosition&&this.symbolData.middleMarkExist){e.rotation=-this.dRotate,e.labelAlign="cm",e.graphicOpacity=1,e.fontColor=this.style.fontColor,e.fontFamily=this.style.fontFamily,e.fontWeight=this.style.fontWeight,e.fontStyle=this.style.fontStyle,e.externalGraphic=this._getTextGraphic(this.textContent,e);var x={externalGraphic:e.externalGraphic,graphicWidth:e.graphicWidth,graphicHeight:e.graphicHeight,rotation:-this.dRotate},w=L.supermap.plotting.pointImage([i],x);this._annotationId=this.components.length,w.fromZoom=this._map.getZoom(),this._addComponents(w)}else if(8!==this.annotationPosition){if(!1===this.limitWidthHeight)var E=this.initialScale.x<this.initialScale.y?this.initialScale.x:this.initialScale.y;null==this.prevFontSize&&(!0===this.limitWidthHeight?this.fontSize=this.style.fontSize/this.dScale/this.initialScale.x:this.fontSize=this.style.fontSize/this.dScale/E,this.prevFontSize=this.style.fontSize),void 0!==this.prevFontSize&&this.prevFontSize!==this.style.fontSize&&(!0===this.limitWidthHeight?this.fontSize=this.style.fontSize/this.dScale/this.initialScale.x:this.fontSize=this.style.fontSize/this.dScale/E,this.prevFontSize=this.style.fontSize),void 0!==this.fontSize?(!0===this.limitWidthHeight?this.style.fontSize=this.fontSize*this.dScale*this.initialScale.x:this.style.fontSize=this.fontSize*this.dScale*E,this.prevFontSize=this.style.fontSize):(!0===this.limitWidthHeight?this.fontSize=this.style.fontSize/this.dScale/this.initialScale.x:this.fontSize=this.style.fontSize/this.dScale/E,this.prevFontSize=this.style.fontSize),e.fontSize=this.style.fontSize,e.fontSizeLimit=!1,e.labelRotation=0,this._annotationId=this.components.length;var C=this._createAndDrawLayer(34,[i],e,this.textContent);C.isAnnotation=!0,C.fromZoom=this._map.getZoom()}}},_calculateLabel:function(t,e){for(var o=0;o<this.components.length;)!0===this.components[o].isSymbolText?(null!=this.components[o]._renderer&&(this.components[o].removeEventParent(this),this.components[o].onRemove()),delete this.components[o],this.components.splice(o,1)):o++;if(this.symbolTextComponents.length=0,null!=this.symbolTexts&&0!==this.symbolTexts.length){var i={surroundLineFlag:!1,lineColorLimit:!0,fillColorLimit:!0,lineWidthLimit:!0,lineTypeLimit:!0,fontColorLimit:!0,fontSizeLimit:!0,fillLimit:!0};if(null==t&&(t=this.getBounds()),t&&t.isValid()){null==e&&(e=this.latLngs[0]);for(var l=0;l<this.symbolTexts.length;l++){var n=[];if(null!=this.symbolTexts[l].textContent&&0!==this.symbolTexts[l].textContent.length&&(null==this.symbolTexts[l].style||"none"!==this.symbolTexts[l].style.display)){var a=this.symbolTexts[l];this._mergeStyleToSymbolText(a),a.textPosition=null==a.textPosition?0:a.textPosition;var s=a.textContent.split("\n"),r=s.length,u=0,p=0;if(a.border){u=SuperMap.Plot.PlottingUtil.getTextWidth(a.style,s[0])+2*a.paddingX;for(var h=1;h<r;h++){var c=SuperMap.Plot.PlottingUtil.getTextWidth(a.style,s[h])+2*a.paddingX;c>u&&(u=c)}p=parseInt(a.style.fontSize*r)+2*a.paddingY}var g=void 0,y=void 0,f=L.point(0,0),P=L.point(0,0);switch(a.textPosition){case SuperMap.Plot.AnnoPosition.LEFTTOP:a.style.labelAlign="rb",g=L.latLng(t.getNorth(),t.getWest()),(y=this._map.latLngToLayerPoint(g)).x+=a.offsetX,y.y+=a.offsetY,!0===a.border&&(f.x=y.x,f.y=y.y,P.x=y.x-u,P.y=y.y-p);break;case SuperMap.Plot.AnnoPosition.LEFTBOTTOM:a.style.labelAlign="rt",g=L.latLng(t.getSouth(),t.getWest()),(y=this._map.latLngToLayerPoint(g)).x+=a.offsetX,y.y+=a.offsetY,!0===a.border&&(f.x=y.x,f.y=y.y,P.x=y.x-u,P.y=y.y+p);break;case SuperMap.Plot.AnnoPosition.RIGHTTOP:a.style.labelAlign="lb",g=L.latLng(t.getNorth(),t.getEast()),(y=this._map.latLngToLayerPoint(g)).x+=a.offsetX,y.y+=a.offsetY,!0===a.border&&(f.x=y.x,f.y=y.y,P.x=y.x+u,P.y=y.y-p);break;case SuperMap.Plot.AnnoPosition.RIGHTBOTTOM:a.style.labelAlign="lt",g=L.latLng(t.getSouth(),t.getEast()),(y=this._map.latLngToLayerPoint(g)).x+=a.offsetX,y.y+=a.offsetY,!0===a.border&&(f.x=y.x,f.y=y.y,P.x=y.x+u,P.y=y.y+p);break;case SuperMap.Plot.AnnoPosition.TOP:a.style.labelAlign="cb",g=L.latLng(t.getNorth(),(t.getWest()+t.getEast())/2),(y=this._map.latLngToLayerPoint(g)).x+=a.offsetX,y.y+=a.offsetY,!0===a.border&&(f.x=y.x-u/2,f.y=y.y,P.x=y.x+u/2,P.y=y.y-p);break;case SuperMap.Plot.AnnoPosition.BOTTOM:a.style.labelAlign="ct",g=L.latLng(t.getSouth(),(t.getWest()+t.getEast())/2),(y=this._map.latLngToLayerPoint(g)).x+=a.offsetX,y.y+=a.offsetY,!0===a.border&&(f.x=y.x-u/2,f.y=y.y,P.x=y.x+u/2,P.y=y.y+p);break;case SuperMap.Plot.AnnoPosition.LEFT:a.style.labelAlign="rm",g=L.latLng((t.getSouth()+t.getNorth())/2,t.getWest()),(y=this._map.latLngToLayerPoint(g)).x+=a.offsetX,y.y+=a.offsetY,!0===a.border&&(f.x=y.x,f.y=y.y+p/2,P.x=y.x-u,P.y=y.y-p/2);break;case SuperMap.Plot.AnnoPosition.RIGHT:a.style.labelAlign="lm",g=L.latLng((t.getSouth()+t.getNorth())/2,t.getEast()),(y=this._map.latLngToLayerPoint(g)).x+=a.offsetX,y.y+=a.offsetY,!0===a.border&&(f.x=y.x,f.y=y.y+p/2,P.x=y.x+u,P.y=y.y-p/2);break;case SuperMap.Plot.AnnoPosition.ANCHOR:a.style.labelAlign="lm",g=L.latLng(e.lat,e.lng),(y=this._map.latLngToLayerPoint(g)).x+=a.offsetX,y.y+=a.offsetY,a.offsetX>0?(a.style.labelAlign="lm",!0===a.border&&(f.x=y.x,f.y=y.y+p/2,P.x=y.x+u,P.y=y.y-p/2)):(a.style.labelAlign="rm",!0===a.border&&(f.x=y.x,f.y=y.y+p/2,P.x=y.x-u,P.y=y.y-p/2))}var d=this._map.layerPointToLatLng(y);if(!0===a.showRelationLine&&(0!==a.offsetX||0!==a.offsetY)){var S=a.lineStyle;null==a.lineStyle&&(S=SuperMap.Util.copyAttributes(S,this.style)),S.lineColorLimit=!0,S.lineTypeLimit=!0,S.lineWidthLimit=!0;var m=this._createAndDrawLayer(SuperMap.Plot.SymbolType.POLYLINESYMBOL,[d,g],S);m.isSymbolText=!0,m.fromZoom=this._map.getZoom(),n.push(m)}var b=SuperMap.Util.copyAttributes(i,a.style);if(a.border){var v=this._map.layerPointToLatLng(f),M=this._map.layerPointToLatLng(P),A=this._createAndDrawLayer(SuperMap.Plot.SymbolType.RECTANGLESYMBOL,[v,M],SuperMap.Util.cloneObject(b));A.isSymbolText=!0,A.fromZoom=this._map.getZoom(),n.push(A);var T=f.x<P.x?f.x:P.x,_=f.y<P.y?f.y:P.y,O=this._map.layerPointToLatLng(L.point(T+a.paddingX,_+p/2)),x=SuperMap.Util.cloneObject(b);x.labelAlign="lm";var w=this._createAndDrawLayer(SuperMap.Plot.SymbolType.TEXTSYMBOL,[O],x,a.textContent);w.isSymbolText=!0,w.fromZoom=this._map.getZoom(),n.push(w)}else{var E=this._createAndDrawLayer(SuperMap.Plot.SymbolType.TEXTSYMBOL,[d],SuperMap.Util.cloneObject(b),a.textContent);E.isSymbolText=!0,E.fromZoom=this._map.getZoom(),n.push(E)}this.symbolTextComponents.push(n)}}}}},_getTextGraphic:function(t,e){var o=SuperMap.Plot.PlottingUtil.cloneObject(e);o.fontPercent=100,o.fontSpace=0,void 0!==this.flagTextSize?o.fontSize=this.flagTextSize:o.fontSize=60,o.labelAlign="cm";var i=document.createElement("canvas"),l=SuperMap.Plot.PlottingUtil.getTextWidth(o,t);i.width=l+20,i.height=parseFloat(o.fontSize)+10,document.body.appendChild(i);var n=i.getContext("2d");n.fillStyle=o.fontColor,n.globalAlpha=o.fontOpacity||1;var a=[o.fontStyle?o.fontStyle:"normal","normal",o.fontWeight?o.fontWeight:"normal",o.fontSize?new String(o.fontSize)+"px":"1em",o.fontFamily?o.fontFamily:"sans-serif"].join(" ");if(n.fillText)n.font=a,n.textAlign="center",n.textBaseline="middle",n.fillText(t,i.width/2,i.height/2);else if(n.mozDrawText){n.mozTextStyle=a;var s=-.5;L.PlotCanvas.LABEL_FACTOR[e.labelAlign[0]],null==s&&(s=-.5);var r=-.5;L.PlotCanvas.LABEL_FACTOR[e.labelAlign[1]],null==r&&(r=-.5);var u=[0,0],p=n.mozMeasureText("xx");u[1]+=p*(1+r*numRows);var h=u[0]+s*n.mozMeasureText(t),c=u[1]+p;n.translate(h,c),n.mozDrawText(t),n.translate(-h,-c)}var g=i.toDataURL("image/png","image/octet-stream");return document.body.removeChild(i),g},_transitionPoint:function(t,e){var o=e.x+t.x*(96/254),i=e.y-t.y*(96/254);return this._map.layerPointToLatLng(L.point(o,i))},_widthHeightLimitScale:function(){var t=this.initialScale.x,e=this.initialScale.y,o=this.anchorPoint.x,i=this.anchorPoint.y,l=(this.middleMarkBounds.left-o)*t+o,n=(this.middleMarkBounds.bottom-i)*e+i,a=(this.middleMarkBounds.right-o)*t+o,s=(this.middleMarkBounds.top-i)*e+i;return new SuperMap.Bounds(l,n,a,s)},_updateJoinLines:function(){if(null!==this.joinLines&&0<this.joinLines.length)for(var t=0;t<this.joinLines.length;t++){var e=this.joinLines[t];null!==e&&null!=e.layer&&(e instanceof l.LineRelation&&e.redraw())}},_mergeStyleToSymbolText:function(t){if(null!==this.components)for(var e in null!==t.style&&void 0!==t.style||(t.style={}),this.style)t.style.hasOwnProperty(e)||(t.style[e]=this.style[e])},_resizeCells:function(t,e){for(var o in this.components)L.Util.resizeLatLngs(this.components[o].getLatLngs(),e,t),this.components[o].setLatLngs(this.components[o].getLatLngs());this._renderer instanceof L.Canvas&&this._updateCanvasFills()},_rotate:function(t,e){i.GraphicObject.prototype._rotate.call(this,t,e),this.dRotate+=t},_resize:function(t,e){i.GraphicObject.prototype._resize.call(this,t,e),!0===this.limitWidthHeight?(this.initialScale.x*=t,this.symbolSize.w=this.initialScale.x*this.dScale*this.symbolSizeInLib.w,this.symbolSize.h=this.initialScale.x*this.dScale*this.symbolSizeInLib.h):(this.symbolSize.w=this.initialScale.x*this.dScale*this.symbolSizeInLib.w,this.symbolSize.h=this.initialScale.y*this.dScale*this.symbolSizeInLib.h),this.style.fontSize=this.fontSize*this.dScale*this.initialScale.x,this.prevFontSize=this.style.fontSize},_setSymbolData:function(t){if(i.GraphicObject.prototype._setSymbolData.call(this,t),this.symbolData){this.symbolData.hasOwnProperty("type")||(this.symbolData.type="GRAPHICOBJECT"),this.symbolData.symbolRank=this.symbolRank,this.symbolData.negativeImage=this.negativeImage,this.symbolData.space=this.space,this.symbolData.flagTextSize=this.flagTextSize,this.symbolData.maxScale=this.maxScale,this.symbolData.minScale=this.minScale,this.symbolData.textDisplay=this.textDisplay,this.symbolData.initialScale=this.initialScale,this.symbolData.actualScale=this.actualScale,void 0!==this.fontSize&&(this.symbolData.fontSize=this.fontSize),void 0!==this.strokeWidth&&(this.symbolData.strokeWidth=this.strokeWidth);var e=25.4*this.symbolSize.w*10/96,o=25.4*this.symbolSize.h*10/96;this.symbolData.symbolSize={x:e,y:o};var l=25.4*this.symbolSizeInLib.w*10/96,n=25.4*this.symbolSizeInLib.h*10/96;this.symbolData.symbolSizeInLib={x:l,y:n},this.symbolData.positionOffset=this.positionOffset,this.symbolData.positionOffsetType=this.positionOffsetType,this.symbolData.positionOffsetX=this.positionOffsetX,this.symbolData.positionOffsetY=this.positionOffsetY}},_parseBasicData:function(){if(this.symbolName=this.symbolData.symbolName,void 0!==this.symbolData.symbolSizeInLib?(this.symbolSizeInLib.w=Math.round(96*this.symbolData.symbolSizeInLib.x/25.4/10),this.symbolSizeInLib.h=Math.round(96*this.symbolData.symbolSizeInLib.y/25.4/10)):void 0!==this.symbolData.symbolSize&&(this.symbolSizeInLib.w=Math.round(96*this.symbolData.symbolSize.x/25.4/10),this.symbolSizeInLib.h=Math.round(96*this.symbolData.symbolSize.y/25.4/10)),null===this.initialScale||isNaN(this.initialScale)||this.initialScale===1/0){var t=L.supermap.plotting.getControl(this.map,this.serverUrl).getDefaultStyle();if(t&&!0===t.defaultFlag&&this.symbolType===SuperMap.Plot.SymbolType.DOTSYMBOL&&-1!==t.dotSymbolSize){var e=this.symbolSizeInLib.w;if(this.symbolSizeInLib.h>this.symbolSizeInLib.w&&(e=this.symbolSizeInLib.h),0===e||0===t.dotSymbolSize)this.symbolSize.w=this.symbolSizeInLib.w,this.symbolSize.h=this.symbolSizeInLib.h;else if(0!==this.symbolSize.w||0===this.symbolData.symbolSize.x||0!==this.symbolSize.h||0===this.symbolData.symbolSize.y||this.minEditPts)if(0!==this.symbolSize.w||0!==this.symbolSize.h);else{var o=t.dotSymbolSize/e;this.symbolSize.w=o*this.symbolSizeInLib.w,this.symbolSize.h=o*this.symbolSizeInLib.h}else{this.symbolSize.w=96*this.symbolData.symbolSize.x/25.4/10,this.symbolSize.h=96*this.symbolData.symbolSize.y/25.4/10;var i=this.symbolSize.w/this.dScale/this.symbolSizeInLib.w,l=this.symbolSize.h/this.dScale/this.symbolSizeInLib.h;this.initialScale!==i?this.initialScale=i:this.initialScale!==l&&(this.initialScale=l),this.symbolSize.w=this.initialScale*this.dScale*this.symbolSizeInLib.w,this.symbolSize.h=this.initialScale*this.dScale*this.symbolSizeInLib.h}}var n=this.symbolSizeInLib.w,a=this.symbolSize.w;this.symbolSizeInLib.w<this.symbolSizeInLib.h&&(n=this.symbolSizeInLib.h,a=this.symbolSize.h),this.initialScale=a/n,this.symbolSize.w=this.initialScale*this.dScale*this.symbolSizeInLib.w,this.symbolSize.h=this.initialScale*this.dScale*this.symbolSizeInLib.h,(void 0===this.fontSize||isNaN(this.fontSize))&&(void 0===this.style.fontSize&&(this.style.fontSize=12),this.fontSize=this.style.fontSize/this.initialScale)}this.anchorPoint=new SuperMap.Geometry.Point(this.symbolData.anchorPoint.x,this.symbolData.anchorPoint.y),this.middleMarkBounds=new SuperMap.Bounds(this.symbolData.middleMarkBounds.leftBottom.x,this.symbolData.middleMarkBounds.leftBottom.y,this.symbolData.middleMarkBounds.rightTop.x,this.symbolData.middleMarkBounds.rightTop.y),this.symbolRank=this.symbolData.symbolRank,this.negativeImage=this.symbolData.negativeImage},_parseSymbolData:function(){if(i.GraphicObject.prototype._parseSymbolData.call(this),null!==this.symbolData){if(void 0!==this.symbolData.symbolSizeInLib?(this.symbolSizeInLib.w=Math.round(96*this.symbolData.symbolSizeInLib.x/25.4/10),this.symbolSizeInLib.h=Math.round(96*this.symbolData.symbolSizeInLib.y/25.4/10)):this.symbolData.innerCells&&(this.symbolSizeInLib.w=Math.round(96*this.symbolData.symbolSize.x/25.4/10),this.symbolSizeInLib.h=Math.round(96*this.symbolData.symbolSize.y/25.4/10)),this.symbolRank=this.symbolData.symbolRank,this.negativeImage=this.symbolData.negativeImage,void 0!==this.symbolData.anchorPoint&&(this.anchorPoint=new SuperMap.Geometry.Point(this.symbolData.anchorPoint.x,this.symbolData.anchorPoint.y)),void 0!==this.symbolData.middleMarkBounds&&null!==this.symbolData.middleMarkBounds&&(this.middleMarkBounds=new SuperMap.Bounds(this.symbolData.middleMarkBounds.leftBottom.x,this.symbolData.middleMarkBounds.leftBottom.y,this.symbolData.middleMarkBounds.rightTop.x,this.symbolData.middleMarkBounds.rightTop.y)),void 0!==this.symbolData.actualScale&&null!==this.symbolData.actualScale&&(this.actualScale=this.symbolData.actualScale),void 0!==this.symbolData.fontSize&&null!==this.symbolData.fontSize&&(this.fontSize=this.symbolData.fontSize),void 0!==this.symbolData.strokeWidth&&void 0!==this.symbolData.strokeWidth&&(this.strokeWidth=this.symbolData.strokeWidth),void 0!==this.symbolData.space&&null!==this.symbolData.space&&(this.space=this.symbolData.space),void 0!==this.symbolData.flagTextSize&&null!==this.symbolData.flagTextSize&&(this.flagTextSize=this.symbolData.flagTextSize),void 0!==this.symbolData.maxScale&&null!==this.symbolData.maxScale&&(this.maxScale=this.symbolData.maxScale),void 0!==this.symbolData.minScale&&null!==this.symbolData.minScale&&(this.minScale=this.symbolData.minScale),void 0!==this.symbolData.textDisplay&&null!==this.symbolData.textDisplay&&(this.textDisplay=this.symbolData.textDisplay),void 0!==this.symbolData.initialScale&&null!==this.symbolData.initialScale){this.initialScale=this.symbolData.initialScale;var t=this.initialScale*this.symbolSizeInLib.w*this.dScale,e=this.initialScale*this.symbolSizeInLib.h*this.dScale;this.symbolSize=new SuperMap.Size(t,e),this.symbolSize.w=t,this.symbolSize.h=e}else if(!1!==this.isEdit){var o=96*this.symbolData.symbolSize.x/25.4/10,l=96*this.symbolData.symbolSize.y/25.4/10;this.setSymbolSize(o,l)}void 0!==this.symbolData.positionOffset&&null!==this.symbolData.positionOffset&&(this.positionOffset=this.symbolData.positionOffset),void 0!==this.symbolData.positionOffsetType&&null!==this.symbolData.positionOffsetType&&(this.positionOffsetType=this.symbolData.positionOffsetType),void 0!==this.symbolData.positionOffsetX&&null!==this.symbolData.positionOffsetX&&(this.positionOffsetX=this.symbolData.positionOffsetX),void 0!==this.symbolData.positionOffsetY&&null!==this.symbolData.positionOffsetY&&(this.positionOffsetY=this.symbolData.positionOffsetY)}}}),s=e.dotSymbol=function(t,e,o,i){return new a(t,e,o,i)};L.supermap.plotting.dotSymbol=s,L.supermap.plotting.DotSymbol=a},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.resizeLatLngs=e.rotateLatLngs=e.moveLatLngs=e.cloneLatLngs=e.superMapPointsToLatLngs=e.latLngsToSuperMapPoints=void 0;var i=o(80);e.latLngsToSuperMapPoints=i.latLngsToSuperMapPoints,e.superMapPointsToLatLngs=i.superMapPointsToLatLngs,e.cloneLatLngs=i.cloneLatLngs,e.moveLatLngs=i.moveLatLngs,e.rotateLatLngs=i.rotateLatLngs,e.resizeLatLngs=i.resizeLatLngs},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.dotSymbolStyle=e.DotSymbolStyle=void 0;var i=o(2),l=o(11),n=o(21),a=o(22),s=(o(41),e.DotSymbolStyle=a.SymbolStyle.extend({redrawAnchor:null,redrawSize:null,lastStyleKey:null,lastMainKey:null,lastSymbolTextKey:null,lastBloodVolumeKey:null,lastAnnotationKey:null,lastPictureFrameKey:null,images:null,annotation:null,pictureFrames:null,symbolTexts:null,bloodVolumes:null,componentLatLngs:null,initialize:function(t,e){this.feature=t,e=e||{},L.Util.setOptions(this,e),this.canvasEle=document.createElement("canvas"),this.canvasEle.width=0,this.canvasEle.height=0,this._ctx=this.canvasEle.getContext("2d"),this.images=[],this.symbolTexts=[],this.bloodVolumes=[],this.pictureFrames=[],this.componentLatLngs=[]},render:function(){this._redrawFeature()},complete:function(){if(!(null!=this.pictureFrames&&0!==this.pictureFrames.length||null!=this.images&&0!==this.images.length))return!0;for(var t=0;t<this.pictureFrames.length;t++)if(null!=L.supermap.plotting.getControl().imageManager[this.pictureFrames[t].path]&&!0!==L.supermap.plotting.getControl().imageManager[this.pictureFrames[t].path].complete)return!1;for(var e=0;e<this.images.length;e++)if(null!=L.supermap.plotting.getControl().imageManager[this.images[e].path]&&!0!==L.supermap.plotting.getControl().imageManager[this.images[e].path].complete)return!1;return!0},getBounds:function(t,e){if(this.feature.symbolType===SuperMap.Plot.SymbolType.PICTURE)return this.feature.getBounds();for(var o=new L.LatLngBounds,i=t.lat-this.latLng.lat,l=t.lng-this.latLng.lng,n=this.feature._map.getZoomScale(this.fromZoom,this.feature._map.getZoom()),a=0;a<this.componentLatLngs.length;a++){var s=L.Util.cloneLatLngs(this.componentLatLngs[a]);L.Util.moveLatLngs(s,i,l),L.Util.resizeLatLngs(s,t,n),L.Util.rotateLatLngs(s,t,e),o.extend(L.Util.bounds(s))}return o},getComponentLatLngs:function(){this.componentLatLngs.length=0;for(var t=0;t<this.feature.components.length;t++){var e=this.feature.components[t];e.isLeadLine||e.isAnnotation||e.isSymbolText||e.isBloodVolume||e.isPictureFrame||this.componentLatLngs.push(e.getLatLngs())}},_redrawFeature:function(){if(0===this.feature.components.length){this.latLng=L.latLng(this.feature.getLatLngs()[0].lat,this.feature.getLatLngs()[0].lng),this.fromZoom=this.feature._map.getZoom();var t=this.feature.dRotate;this.feature.dRotate=0,this.feature._calculateParts(),this.feature.dRotate=t,this.lastStyleKey=this._generateFromFeatureStyle(this.feature.style),this.lastMainKey=this._generateFromFeature(),this.lastAnnotationKey=this._generateFromAnnotation(),this.lastSymbolTextKey=this._generateFromSymbolText(),this.lastPictureFrameKey=this._generateFromPictureFrame(),this.lastBloodVolumeKey=this._generateFromBloodVolume(),this.bounds=L.latLngBounds(L.latLng(this.feature.getBounds().getNorth(),this.feature.getBounds().getWest()),L.latLng(this.feature.getBounds().getSouth(),this.feature.getBounds().getEast())),this.getComponentLatLngs(),this._drawFeatures(),this._drawAnnotation(),this._drawSymbolText(),this._drawBloodVolume(),this._drawPictureFrame()}else{var e=this._generateFromFeature();if(this.lastMainKey!==e){for(var o in this.feature.components)delete this.feature.components[o];this.feature.components.length=0;var i=this.feature.dRotate;this.feature.dRotate=0,this.feature._calculateParts(),this.feature.dRotate=i,this.lastMainKey=e,this.lastAnnotationKey=this._generateFromAnnotation(),this.lastSymbolTextKey=this._generateFromSymbolText(),this.lastPictureFrameKey=this._generateFromPictureFrame(),this.lastBloodVolumeKey=this._generateFromBloodVolume(),this.lastStyleKey=this._generateFromFeatureStyle(this.feature.style),this.fromZoom=this.feature._map.getZoom(),this.latLng=L.latLng(this.feature.getLatLngs()[0].lat,this.feature.getLatLngs()[0].lng),this.bounds=L.latLngBounds(L.latLng(this.feature.getBounds().getNorth(),this.feature.getBounds().getWest()),L.latLng(this.feature.getBounds().getSouth(),this.feature.getBounds().getEast())),this.getComponentLatLngs(),this._drawFeatures(),this._drawAnnotation(),this._drawSymbolText(),this._drawBloodVolume(),this._drawPictureFrame()}else{var l=this._generateFromAnnotation();this.lastAnnotationKey!==l&&(this.feature._handleAnnotation(this._scaleBounds(this.bounds)),this._drawAnnotation(),this.lastAnnotationKey=l);var n=this._generateFromSymbolText();this.lastSymbolTextKey!==n&&(this.feature._calculateLabel(this._scaleBounds(this.bounds),this.latLng),this._drawSymbolText(),this.lastSymbolTextKey=n);var a=this._generateFromBloodVolume();this.lastBloodVolumeKey!==a&&(this.feature._calculateBloodVolume(this._scaleBounds(this.bounds),this.latLng),this._drawBloodVolume(),this.lastBloodVolumeKey=a);var s=this._generateFromPictureFrame();this.lastPictureFrameKey!==s&&(this.feature._calculatePictureFrame(this._scaleBounds(this.bounds)),this._drawPictureFrame(),this.lastPictureFrameKey=s)}var r=this._generateFromFeatureStyle(this.feature.style);if(this.lastStyleKey!==r&&"function"==typeof this.feature._copyStyleForCell){for(var u in this.feature.components){var p=this.feature.components[u];if(!(p.isSymbolText||p.isBloodVolume||p.isPictureFrame)){var h=p.options;this.feature._copyStyleForCell(h,this.feature.style,p),L.setOptions(p,h)}}8===this.feature.annotationPosition&&0!==this.feature.textContent.length&&this.feature._handleAnnotation(this._scaleBounds(this.bounds)),this._drawFeatures(),this._drawAnnotation()}this.lastStyleKey=r}this._computeRedrawSize()},getCacheInfo:function(){var t=document.createElement("canvas"),e=t.getContext("2d");t.width=this.canvas.width,t.height=this.canvas.height,e.clearRect(0,0,t.width,t.height),e.drawImage(this.canvas,0,0);for(var o={canvas:e.canvas,anchor:L.point(this.anchor.x,this.anchor.y),size:[this.size[0],this.size[1]],redrawSize:[this.redrawSize[0],this.redrawSize[1]],redrawAnchor:L.point(this.redrawAnchor.x,this.redrawAnchor.y),bounds:L.latLngBounds(this.bounds.getSouthEast(),this.bounds.getNorthWest()),fromZoom:this.fromZoom,latLng:L.latLng(this.latLng.lat,this.latLng.lng),componentLatLngs:[]},i=0;i<this.componentLatLngs.length;i++)o.componentLatLngs.push(L.Util.cloneLatLngs(this.componentLatLngs[i]));null!=this.annotation&&(o.annotation=this.annotation.getCacheInfo()),o.images=[];for(var l=0;l<this.images.length;l++){var n={};n=SuperMap.Util.copyAttributes(n,this.images[l]),o.images.push(n)}o.pictureFrames=[];for(var a=0;a<this.pictureFrames.length;a++){var s={};s=SuperMap.Util.copyAttributes(s,this.pictureFrames[a]),o.pictureFrames.push(s)}o.symbolTexts=[];for(var r=0;r<this.symbolTexts.length;r++)o.symbolTexts.push(this.symbolTexts[r].getCacheInfo());o.bloodVolumes=[];for(var u=0;u<this.bloodVolumes.length;u++)o.bloodVolumes.push(this.bloodVolumes[u].getCacheInfo());return o},generateUuidFromFeature:function(){var t="";return this.feature.symbolType===SuperMap.Plot.SymbolType.DOTSYMBOL?(t+=this._generateFromFeature(),t+="_"+this._generateFromAnnotation(),t+="_"+this._generateFromSymbolText(),t+="_"+this._generateFromBloodVolume(),t+="_"+this._generateFromPictureFrame(),t+="_"+this._generateFromFeatureStyle(this.feature.style)):this.feature.symbolType===SuperMap.Plot.SymbolType.PICTURE?(t=this.feature.libID.toString()+"_"+this.feature.code.toString()+"_"+this.feature.path+this.feature.style.graphicWidth+this.feature.style.graphicHeight+this.feature.style.graphicXOffset+this.feature.style.graphicYOffset,t+="_"+this._generateFromSymbolText(),t+="_"+this._generateFromBloodVolume()):this.feature.symbolType===SuperMap.Plot.SymbolType.SYMBOLTEXT?(t=this.feature.libID.toString()+"_"+this.feature.code.toString()+"_"+this.feature.associatedUuid+"_"+this.feature.addFrame.toString(),t+="_"+this._generateFromSymbolText()):this.feature.symbolType===SuperMap.Plot.SymbolType.SYMBOLTEXT1&&(t=this.feature.libID.toString()+"_"+this.feature.code.toString()+"_"+this.feature.associatedUuid+"_"+this.feature.textContent+"_"+this.feature.space.toString()+"_"+this.feature.offsetX.toString()+"_"+this.feature.offsetY.toString(),t+="_"+this._generateFromFeatureStyle(this.feature.style)),t},_computeImageSize:function(){var t=this._scaleBounds(this.bounds),e=new L.Bounds;e.extend(this.feature._map.latLngToLayerPoint(t.getNorthEast())),e.extend(this.feature._map.latLngToLayerPoint(t.getNorthWest())),e.extend(this.feature._map.latLngToLayerPoint(t.getSouthEast())),e.extend(this.feature._map.latLngToLayerPoint(t.getSouthWest()));var o=new L.Bounds(e.min,e.max);this.leftTopPixel=L.point(e.min.x,e.min.y);var i=o.getSize();i.x+=2*this.feature.style.weight,i.y+=2*this.feature.style.weight,this.anchor=this._latlngToLayerPoint([this.latLng])[0],this.size=[i.x,i.y]},_computeRedrawSize:function(){var t=this._scaleBounds(this.bounds),e=this.getBounds(this.latLng,this.feature.dRotate),o=e.getWest()-t.getWest(),i=e.getEast()-t.getEast(),l=e.getNorth()-t.getNorth(),n=e.getSouth()-t.getSouth();if(this.feature.symbolType===SuperMap.Plot.SymbolType.DOTSYMBOL||this.feature.symbolType===SuperMap.Plot.SymbolType.PICTURE)for(var a in this.feature.components){var s=this.feature.components[a];(s.isAnnotation||s.isSymbolText||s.isBloodVolume||s.isPictureFrame)&&t.extend(s.getBounds?s.getBounds():s.getLatLng())}var r=new L.Bounds;r.extend(this.feature._map.latLngToLayerPoint(L.latLng(t.getNorth()+l,t.getEast()+i))),r.extend(this.feature._map.latLngToLayerPoint(L.latLng(t.getNorth()+l,t.getWest()+o))),r.extend(this.feature._map.latLngToLayerPoint(L.latLng(t.getSouth()+n,t.getEast()+i))),r.extend(this.feature._map.latLngToLayerPoint(L.latLng(t.getSouth()+n,t.getWest()+o))),this.leftTopPixel=L.point(r.min.x,r.min.y);var u=r.getSize(),p=this.feature.style.weight;u.x+=2*p,u.y+=2*p,this.redrawAnchor=this._latlngToLayerPoint([this.latLng])[0],this.redrawSize=[u.x,u.y]},_latlngToLayerPoint:function(t,e){null==e&&(e=this.fromZoom);for(var o=this.feature._map.getZoomScale(e,this.feature._map.getZoom()),i=this.latLng,l=[],n=0;n<t.length;n++){var a=i.lat+o*(t[n].lat-i.lat),s=i.lng+o*(t[n].lng-i.lng),r=this.feature._map.latLngToLayerPoint(L.latLng(a,s));r.x=r.x-this.leftTopPixel.x+this.feature.style.weight,r.y=r.y-this.leftTopPixel.y+this.feature.style.weight,l.push(r)}return l},_scaleBounds:function(t){if(this.fromZoom!==this.feature._map.getZoom()){var e=this.feature._map.getZoomScale(this.fromZoom,this.feature._map.getZoom()),o=this.latLng,i=o.lat+e*(t.getNorth()-o.lat),l=o.lat+e*(t.getSouth()-o.lat),n=o.lng+e*(t.getWest()-o.lng),a=o.lng+e*(t.getEast()-o.lng);return L.latLngBounds(L.latLng(i,n),L.latLng(l,a))}return L.latLngBounds(L.latLng(t.getNorth(),t.getWest()),L.latLng(t.getSouth(),t.getEast()))},_scaleCompount:function(t){if(this.fromZoom!==this.feature._map.getZoom()){var e=this.feature._map.getZoomScale(this.fromZoom,this.feature._map.getZoom()),o=this.latLng,i=o.lat+e*(t.getNorth()-o.lat),l=o.lat+e*(t.getSouth()-o.lat),n=o.lng+e*(t.getWest()-o.lng),a=o.lng+e*(t.getEast()-o.lng);return L.latLngBounds(L.latLng(i,n),L.latLng(l,a))}return L.latLngBounds(L.latLng(t.getNorth(),t.getWest()),L.latLng(t.getSouth(),t.getEast()))},_drawFeatures:function(){for(var t in this.images.length=0,this._computeImageSize(),this.canvasEle.width=this.size[0],this.canvasEle.height=this.size[1],this._ctx.clearRect(0,0,this.canvasEle.width,this.canvasEle.height),this.canvas=this._ctx.canvas,this._ctx.translate(0,0),this.feature.components){var e=this.feature.components[t];!0!==e.isSymbolText&&!0!==e.isBloodVolume&&!0!==e.isPictureFrame&&!0!==e.isAnnotation&&(l.PointImage&&e instanceof l.PointImage?this.images.push(this._drawImage(e,this._ctx)):i.Text&&e instanceof i.Text?this._drawText(e,this._ctx):L.Rectangle&&e instanceof L.Rectangle?this._drawRectangle(e,this._ctx):L.Polygon&&e instanceof L.Polygon?this._drawPolygon(e,this._ctx):L.Polyline&&e instanceof L.Polyline&&this._drawPolyline(e,this._ctx))}},_drawAnnotation:function(){for(var t=!1,e=this._scaleBounds(this.bounds),o=(this.latLng,0);o<this.feature.components.length;o++)if(!0===this.feature.components[o].isAnnotation&&8!==this.feature.annotationPosition){t=!0;var i=null;switch(this.feature.annotationPosition){case SuperMap.Plot.AnnoPosition.LEFTTOP:i=L.latLng(e.getNorth(),e.getWest());break;case SuperMap.Plot.AnnoPosition.LEFTBOTTOM:i=L.latLng(e.getSouth(),e.getWest());break;case SuperMap.Plot.AnnoPosition.RIGHTTOP:i=L.latLng(e.getNorth(),e.getEast());break;case SuperMap.Plot.AnnoPosition.RIGHTBOTTOM:i=L.latLng(e.getSouth(),e.getEast());break;case SuperMap.Plot.AnnoPosition.TOP:i=L.latLng(e.getNorth(),(e.getWest()+e.getEast())/2);break;case SuperMap.Plot.AnnoPosition.BOTTOM:i=L.latLng(e.getSouth(),(e.getWest()+e.getEast())/2);break;case SuperMap.Plot.AnnoPosition.LEFT:i=L.latLng((e.getSouth()+e.getNorth())/2,e.getWest());break;case SuperMap.Plot.AnnoPosition.RIGHT:i=L.latLng((e.getSouth()+e.getNorth())/2,e.getEast())}null==this.annotation?(this.annotation=new n.ComponentStyle(this.feature,[this.feature.components[o]],i,this.feature.annotationPosition,0,0,this.options),this.annotation.render()):(this.annotation.clear(),this.annotation.setComponents([this.feature.components[o]],i,this.feature.annotationPosition,0,0));break}!1===t&&null!=this.annotation&&(delete this.annotation,this.annotation=null)},_drawSymbolText:function(){for(var t=this._scaleBounds(this.bounds),e=this.latLng,o=0;o<this.feature.symbolTextComponents.length;o++){var i=null;switch(this.feature.symbolTexts[o].textPosition){case SuperMap.Plot.AnnoPosition.LEFTTOP:i=L.latLng(t.getNorth(),t.getWest());break;case SuperMap.Plot.AnnoPosition.LEFTBOTTOM:i=L.latLng(t.getSouth(),t.getWest());break;case SuperMap.Plot.AnnoPosition.RIGHTTOP:i=L.latLng(t.getNorth(),t.getEast());break;case SuperMap.Plot.AnnoPosition.RIGHTBOTTOM:i=L.latLng(t.getSouth(),t.getEast());break;case SuperMap.Plot.AnnoPosition.TOP:i=L.latLng(t.getNorth(),(t.getWest()+t.getEast())/2);break;case SuperMap.Plot.AnnoPosition.BOTTOM:i=L.latLng(t.getSouth(),(t.getWest()+t.getEast())/2);break;case SuperMap.Plot.AnnoPosition.LEFT:i=L.latLng((t.getSouth()+t.getNorth())/2,t.getWest());break;case SuperMap.Plot.AnnoPosition.RIGHT:i=L.latLng((t.getSouth()+t.getNorth())/2,t.getEast());break;case SuperMap.Plot.AnnoPosition.ANCHOR:i=L.latLng(e.lat,e.lng)}if(this.symbolTexts.length<=o){var l=new n.ComponentStyle(this.feature,this.feature.symbolTextComponents[o],i,this.feature.symbolTexts[o].textPosition,0,0,this.options);l.render(),this.symbolTexts.push(l)}else this.symbolTexts[o].clear(),this.symbolTexts[o].setComponents(this.feature.symbolTextComponents[o],i,this.feature.symbolTexts[o].textPosition,0,0)}for(var a=this.feature.symbolTextComponents.length;a<this.symbolTexts.length;)delete this.symbolTexts[a],this.symbolTexts.splice(a,1)},_drawBloodVolume:function(){for(var t=0;t<this.feature.bloodVolumeComponents.length;t++){var e=this._scaleBounds(this.bounds),o=null;switch(this.feature.bloodVolumes[t].position){case SuperMap.Plot.AnnoPosition.TOP:o=L.latLng(e.getNorth(),(e.getWest()+e.getEast())/2);break;case SuperMap.Plot.AnnoPosition.BOTTOM:o=L.latLng(e.getSouth(),(e.getWest()+e.getEast())/2);break;case SuperMap.Plot.AnnoPosition.LEFT:o=L.latLng((e.getSouth()+e.getNorth())/2,e.getWest());break;case SuperMap.Plot.AnnoPosition.RIGHT:o=L.latLng((e.getSouth()+e.getNorth())/2,e.getEast())}if(this.bloodVolumes.length<=t){var i=new n.ComponentStyle(this.feature,this.feature.bloodVolumeComponents[t],o,this.feature.bloodVolumes[t].position,0,0,this.fromZoom,this.options);i.render(),this.bloodVolumes.push(i)}else this.bloodVolumes[t].clear(),this.bloodVolumes[t].setComponents(this.feature.bloodVolumeComponents[t],o,this.feature.bloodVolumes[t].position,0,0,this.fromZoom)}for(var l=this.feature.bloodVolumeComponents.length;l<this.bloodVolumes.length;)delete this.bloodVolumes[l],this.bloodVolumes.splice(l,1)},_drawPictureFrame:function(){if(this.pictureFrames.length=0,null!=this.feature.pictureFrameComponents)for(var t=0;t<this.feature.pictureFrameComponents.length;t++){var e=this.feature.pictureFrames[t].offsetX,o=this.feature.pictureFrames[t].offsetY,i=this.feature.pictureFrameComponents[t][0];if(l.PointImage&&i instanceof l.PointImage){var n=this._drawImage(i,this._ctx);this.pictureFrames.push({path:n.path,style:n.style,position:this.feature.pictureFrames[t].position,offsetX:e,offsetY:o})}}},_generateFromFeature:function(){var t="";return this.feature.symbolType===SuperMap.Plot.SymbolType.DOTSYMBOL?t=this.feature.libID.toString()+"_"+this.feature.code.toString()+"_"+Math.round(this.feature.symbolSize.w).toString()+"_"+Math.round(this.feature.symbolSize.h).toString()+"_"+ +this.feature.dRotate.toString()+"_"+this.feature.symbolRank.toString()+this.feature.surroundLineType.toString()+this.feature.textContent+this.feature.annotationPosition:this.feature.symbolType===SuperMap.Plot.SymbolType.PICTURE&&(t=this.feature.libID.toString()+"_"+this.feature.code.toString()+"_"+this.feature.path+this.feature.style.graphicWidth+this.feature.style.graphicHeight+this.feature.style.graphicXOffset+this.feature.style.graphicYOffset,t+="_"+this._generateFromSymbolText(),t+="_"+this._generateFromBloodVolume()),t},_generateFromAnnotation:function(){return this.feature.textContent+"_"+this.feature.annotationPosition.toString()},_generateFromSymbolText:function(){var t="";if(null==this.feature.symbolTexts)return t;for(var e=0;e<this.feature.symbolTexts.length;e++){var o=this.feature.symbolTexts[e];null!=o.textContent&&(t+="_"+o.textContent),null!=o.textPosition&&(t+="_"+o.textPosition.toString()),null!=o.offsetX&&(t+="_"+o.offsetX.toString()),null!=o.offsetY&&(t+="_"+o.offsetY.toString()),null!=o.border&&(t+="_"+o.border.toString()),null!=o.showRelationLine&&(t+="_"+o.showRelationLine.toString()),null!=o.paddingX&&(t+="_"+o.paddingX.toString()),null!=o.paddingY&&(t+="_"+o.paddingY.toString()),null!=o.style&&(t+=this._generateFromFeatureStyle(o.style)),null!=o.lineStyle&&(null!=o.lineStyle.color&&(t+="_"+o.lineStyle.color),null!=o.lineStyle.lineSymbolID&&(t+="_"+o.lineStyle.lineSymbolID),null!=o.lineStyle.opacity&&(t+="_"+o.lineStyle.opacity),null!=o.lineStyle.weight&&(t+="_"+o.lineStyle.weight))}return t},_generateFromBloodVolume:function(){var t="";if(null==this.feature.bloodVolumes)return t;for(var e=0;e<this.feature.bloodVolumes.length;e++){var o=this.feature.bloodVolumes[e];null!=o.volume&&(t+="_"+o.volume),null!=o.position&&(t+="_"+o.position.toString()),null!=o.offsetX&&(t+="_"+o.offsetX.toString()),null!=o.offsetY&&(t+="_"+o.offsetY.toString()),null!=o.width&&(t+="_"+o.width.toString()),null!=o.height&&(t+="_"+o.height.toString()),null!=o.style&&(null!=o.style.color&&(t+="_"+o.style.color),null!=o.style.opacity&&(t+="_"+o.style.opacity.toString()),null!=o.style.weight&&(t+="_"+o.style.weight.toString()),null!=o.style.remainingVolumeColor&&(t+="_"+o.style.remainingVolumeColor),null!=o.style.remainingVolumeOpacity&&(t+="_"+o.style.remainingVolumeOpacity.toString()),null!=o.style.consumeVolumeColor&&(t+="_"+o.style.consumeVolumeColor),null!=o.style.consumeVolumeOpacity&&(t+="_"+o.style.consumeVolumeOpacity.toString()))}return t},_generateFromPictureFrame:function(){var t="";if(null==this.feature.pictureFrames)return t;for(var e=0;e<this.feature.pictureFrames.length;e++){var o=this.feature.pictureFrames[0];null!=o.path&&(t+="_"+o.path),null!=o.position&&(t+="_"+o.position.toString()),null!=o.offsetX&&(t+="_"+o.offsetX.toString()),null!=o.offsetY&&(t+="_"+o.offsetY.toString()),null!=o.width&&(t+="_"+o.width.toString()),null!=o.height&&(t+="_"+o.height.toString())}return t},_generateFromFeatureStyle:function(t){var e="";return null!=t.fontFamily&&(e+=t.fontFamily),null!=t.fontSize&&(e+="_"+t.fontSize),null!=t.fontColor&&(e+="_"+t.fontColor),null!=t.fontStroke&&(e+="_"+t.fontStroke),null!=t.fontStrokeColor&&(e+="_"+t.fontStrokeColor),null!=t.fontStrokeWidth&&(e+="_"+t.fontStrokeWidth),null!=t.fontBackground&&(e+="_"+t.fontBackground),null!=t.fontBackgroundColor&&(e+="_"+t.fontBackgroundColor),null!=t.fontShadow&&(e+="_"+t.fontShadow),null!=t.fontShadowColor&&(e+="_"+t.fontShadowColor),null!=t.fontShadowOffsetX&&(e+="_"+t.fontShadowOffsetX),null!=t.fontShadowOffsetY&&(e+="_"+t.fontShadowOffsetY),null!=t.color&&(e+="_"+t.color),null!=t.weight&&(e+="_"+t.weight),null!=t.opacity&&(e+="_"+t.opacity),null!=t.lineSymbolID&&(e+="_"+t.lineSymbolID),null!=t.dashArray&&(e+="_"+t.dashArray),null!=t.fill&&(e+="_"+t.fill),null!=t.fillSymbolID&&(e+="_"+t.fillSymbolID),null!=t.fillColor&&(e+="_"+t.fillColor),null!=t.fillOpacity&&(e+="_"+t.fillOpacity),null!=t.fillBackColor&&(e+="_"+t.fillBackColor),null!=t.fillBackOpacity&&(e+="_"+t.fillBackOpacity),null!=t.fillGradientMode&&(e+="_"+t.fillGradientMode),null!=t.surroundLineColor&&(e+="_"+t.surroundLineColor),null!=t.surroundLineColorOpacity&&(e+="_"+t.surroundLineColorOpacity),null!=t.surroundLineWidth&&(e+="_"+t.surroundLineWidth),e}})),r=e.dotSymbolStyle=function(t){return new s(t)};L.supermap.plotting.dotSymbolStyle=r},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.plottingLayer=e.PlottingLayer=e.plottingGraphicLayer=e.PlottingGraphicLayer=e.movingTargetLayer=e.MovingTargetLayer=e.PlottingLayerBase=e.animationLayer=e.AnimationLayer=e.PlottingGraphic=e.componentStyle=e.ComponentStyle=e.dotSymbolStyle=e.DotSymbolStyle=e.symbolStyle=e.SymbolStyle=void 0;var i=o(81),l=o(63),n=o(14),a=o(35),s=o(9);e.SymbolStyle=i.SymbolStyle,e.symbolStyle=i.symbolStyle,e.DotSymbolStyle=i.DotSymbolStyle,e.dotSymbolStyle=i.dotSymbolStyle,e.ComponentStyle=i.ComponentStyle,e.componentStyle=i.componentStyle,e.PlottingGraphic=i.PlottingGraphic,e.AnimationLayer=l.AnimationLayer,e.animationLayer=l.animationLayer,e.PlottingLayerBase=l.PlottingLayerBase,e.MovingTargetLayer=n.MovingTargetLayer,e.movingTargetLayer=n.movingTargetLayer,e.PlottingGraphicLayer=a.PlottingGraphicLayer,e.plottingGraphicLayer=a.plottingGraphicLayer,e.PlottingLayer=s.PlottingLayer,e.plottingLayer=s.plottingLayer},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BasicAlgoSymbolFactory=void 0,o(141);e.BasicAlgoSymbolFactory=SuperMapAlgoPlot.BasicAlgoSymbolFactory=SuperMapAlgoPlot.BasicAlgoSymbolFactory||{};SuperMapAlgoPlot.BasicAlgoSymbolFactory.getAlgoSymbol=function(t,e,o){if(0===t)switch(e){case SuperMapAlgoPlot.SymbolType.ANNOFRAMESYMBOL:return new SuperMapAlgoPlot.GeoTooltipBox(o);case SuperMapAlgoPlot.SymbolType.ANNOFRAMESYMBOLM:return new SuperMapAlgoPlot.GeoTooltipBoxM(o);case SuperMapAlgoPlot.SymbolType.PATHTEXT:return new SuperMapAlgoPlot.PathText(o);case SuperMapAlgoPlot.SymbolType.ARROWLINE:return new SuperMapAlgoPlot.ArrowLine(o);case SuperMapAlgoPlot.SymbolType.CURVEEIGHT:return new SuperMapAlgoPlot.CurveEight(o);case SuperMapAlgoPlot.SymbolType.RUNWAY:return new SuperMapAlgoPlot.Runway(o);case SuperMapAlgoPlot.SymbolType.CONCENTRICCIRCLE:return new SuperMapAlgoPlot.ConcentricCircle(o);case SuperMapAlgoPlot.SymbolType.COMBINATIONALCIRCLE:return new SuperMapAlgoPlot.CombinationalCircle(o);case SuperMapAlgoPlot.SymbolType.FREECURVE:return new SuperMapAlgoPlot.FreeCurve(o);case SuperMapAlgoPlot.SymbolType.REGULARPOLYGON:return new SuperMapAlgoPlot.RegularPolygon(o);case SuperMapAlgoPlot.SymbolType.BRACESYMBOL:return new SuperMapAlgoPlot.Brace(o);case SuperMapAlgoPlot.SymbolType.TRAPEZOIDSYMBOL:return new SuperMapAlgoPlot.Trapezoid(o);case SuperMapAlgoPlot.SymbolType.SYMBOLTEXTBOX:return new SuperMapAlgoPlot.SymbolTextBox(o);case SuperMapAlgoPlot.SymbolType.NODECHAIN:return new SuperMapAlgoPlot.NodeChain(o);case SuperMapAlgoPlot.SymbolType.LINERELATION:return new SuperMapAlgoPlot.LineRelation(o);case SuperMapAlgoPlot.SymbolType.LINEMARKING:return new SuperMapAlgoPlot.LineMarking(o);case SuperMapAlgoPlot.SymbolType.POLYGONREGION:return new SuperMapAlgoPlot.PolygonRegion(o);case SuperMapAlgoPlot.SymbolType.WIRE:return new SuperMapAlgoPlot.Wire(o);case SuperMapAlgoPlot.SymbolType.LINEARARROW:return new SuperMapAlgoPlot.LinearArrow(o);case SuperMapAlgoPlot.SymbolType.POLYBEZIERSYMBOL:return new SuperMapAlgoPlot.Polybezier(o);case SuperMapAlgoPlot.SymbolType.NEWPIESYMBOL:return new SuperMapAlgoPlot.NewPie(o);case SuperMapAlgoPlot.SymbolType.NEWARCSYMBOL:return new SuperMapAlgoPlot.NewArc(o);case SuperMapAlgoPlot.SymbolType.NEWCHORDSYMBOL:return new SuperMapAlgoPlot.NewChord(o);default:return new SuperMapAlgoPlot.AlgoSymbol(o)}else if(22===t)switch(e){case 1001:return new SuperMapAlgoPlot.AlgoSymbol1001(o);case 1002:return new SuperMapAlgoPlot.AlgoSymbol1002(o);case 1003:return new SuperMapAlgoPlot.AlgoSymbol1003(o);case 1004:return new SuperMapAlgoPlot.AlgoSymbol1004(o);case 1005:return new SuperMapAlgoPlot.AlgoSymbol1005(o);case 1006:return new SuperMapAlgoPlot.AlgoSymbol1006(o);case 1007:return new SuperMapAlgoPlot.AlgoSymbol1007(o);case 1008:return new SuperMapAlgoPlot.AlgoSymbol1008(o);case 1009:return new SuperMapAlgoPlot.AlgoSymbol1009(o);case 1010:return new SuperMapAlgoPlot.AlgoSymbol1010(o);case 1011:return new SuperMapAlgoPlot.AlgoSymbol1011(o);case 1012:return new SuperMapAlgoPlot.AlgoSymbol1012(o);case 1013:return new SuperMapAlgoPlot.AlgoSymbol1013(o);case 1014:return new SuperMapAlgoPlot.AlgoSymbol1014(o);case 1015:return new SuperMapAlgoPlot.AlgoSymbol1015(o);case 1016:return new SuperMapAlgoPlot.AlgoSymbol1016(o);case 1017:return new SuperMapAlgoPlot.AlgoSymbol1017(o);case 1018:return new SuperMapAlgoPlot.AlgoSymbol1018(o);case 1019:return new SuperMapAlgoPlot.AlgoSymbol1019(o);case 1020:return new SuperMapAlgoPlot.AlgoSymbol1020(o);case 1021:return new SuperMapAlgoPlot.AlgoSymbol1021(o);case 1022:return new SuperMapAlgoPlot.AlgoSymbol1022(o);default:return null}else{if(421!==t)return null;switch(e){case 311:return new SuperMapAlgoPlot.AlgoSymbol1004(o);case 315:return new SuperMapAlgoPlot.AlgoSymbol315(o);case 317:return new SuperMapAlgoPlot.AlgoSymbol1006(o);case 318:return new SuperMapAlgoPlot.AlgoSymbol1002(o);case 319:return new SuperMapAlgoPlot.AlgoSymbol15200(o);case 320:return new SuperMapAlgoPlot.AlgoSymbol320(o);case 321:return new SuperMapAlgoPlot.AlgoSymbol321(o);case 322:return new SuperMapAlgoPlot.AlgoSymbol322(o);case 323:return new SuperMapAlgoPlot.AlgoSymbol25701(o);default:return null}}},SuperMapAlgoPlot.BasicAlgoSymbolFactory.getSymbolWayType=function(t,e){if(0===t)switch(e){case SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL:case SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL:return SuperMapAlgoPlot.AddPoint_WayType.POLYLINE;case SuperMapAlgoPlot.SymbolType.POLYBEZIERSYMBOL:case SuperMapAlgoPlot.SymbolType.POLYBEZIERCLOSESYMBOL:return SuperMapAlgoPlot.AddPoint_WayType.CURVE;default:return SuperMapAlgoPlot.AddPoint_WayType.UNKNOWN}else if(22===t)switch(e){case 1005:case 1008:case 1012:case 1014:return SuperMapAlgoPlot.AddPoint_WayType.CURVE;case 1007:case 1009:case 1013:case 1015:case 1017:return SuperMapAlgoPlot.AddPoint_WayType.POLYLINE;default:return SuperMapAlgoPlot.AddPoint_WayType.UNKNOWN}},SuperMapAlgoPlot.BasicAlgoSymbolFactory.isAccessServer=function(t,e){if(0===t||22===t)return!1;if(421!==t)return!0;switch(e){case 311:case 317:case 318:case 315:case 319:case 320:case 321:case 322:case 323:return!1;default:return!0}},SuperMapAlgoPlot.BasicAlgoSymbolFactory.getDefaultSubSymbols=function(){return[]},SuperMapAlgoPlot.BasicAlgoSymbolFactory.getMinEditPts=function(t,e){if(0===t)switch(e){case SuperMapAlgoPlot.SymbolType.TEXTSYMBOL:case SuperMapAlgoPlot.SymbolType.COMBINATIONALCIRCLE:return 1;case SuperMapAlgoPlot.SymbolType.CIRCLESYMBOL:case SuperMapAlgoPlot.SymbolType.RECTANGLESYMBOL:case SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL:case SuperMapAlgoPlot.SymbolType.POLYBEZIERSYMBOL:case SuperMapAlgoPlot.SymbolType.KIDNEY:case SuperMapAlgoPlot.SymbolType.ARROWLINE:case SuperMapAlgoPlot.SymbolType.BRACESYMBOL:case SuperMapAlgoPlot.SymbolType.CURVEEIGHT:case SuperMapAlgoPlot.SymbolType.FREECURVE:case SuperMapAlgoPlot.SymbolType.LINEMARKING:case SuperMapAlgoPlot.SymbolType.LINERELATION:case SuperMapAlgoPlot.SymbolType.NODECHAIN:case SuperMapAlgoPlot.SymbolType.PATHTEXT:case SuperMapAlgoPlot.SymbolType.REGULARPOLYGON:case SuperMapAlgoPlot.SymbolType.RUNWAY:case SuperMapAlgoPlot.SymbolType.SYMBOLTEXTBOX:case SuperMapAlgoPlot.SymbolType.ANNOFRAMESYMBOLM:case SuperMapAlgoPlot.SymbolType.CONCENTRICCIRCLE:case SuperMapAlgoPlot.SymbolType.WIRE:case SuperMapAlgoPlot.SymbolType.LINEARARROW:return 2;case SuperMapAlgoPlot.SymbolType.ARCSYMBOL:case SuperMapAlgoPlot.SymbolType.CHORDSYMBOL:case SuperMapAlgoPlot.SymbolType.PIESYMBOL:case SuperMapAlgoPlot.SymbolType.ELLIPSESYMBOL:case SuperMapAlgoPlot.SymbolType.PARALLELOGRAM:case SuperMapAlgoPlot.SymbolType.PARALLELLINE:case SuperMapAlgoPlot.SymbolType.POLYBEZIERCLOSESYMBOL:case SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL:case SuperMapAlgoPlot.SymbolType.POLYGONREGION:case SuperMapAlgoPlot.SymbolType.TRAPEZOIDSYMBOL:case SuperMapAlgoPlot.SymbolType.ANNOFRAMESYMBOL:case SuperMapAlgoPlot.SymbolType.NEWARCSYMBOL:case SuperMapAlgoPlot.SymbolType.NEWPIESYMBOL:case SuperMapAlgoPlot.SymbolType.NEWCHORDSYMBOL:return 3}else if(22===t)switch(e){case 1001:case 1003:case 1005:case 1007:case 1008:case 1009:case 1011:case 1012:case 1013:case 1014:case 1015:case 1016:case 1017:case 1019:case 1020:case 1022:return 2;case 1002:case 1004:case 1006:case 1010:case 1018:case 1021:return 3}else if(421===t)switch(e){case 319:case 320:case 321:return 2;case 311:case 315:case 317:case 318:case 322:case 323:return 3}},SuperMapAlgoPlot.BasicAlgoSymbolFactory.getMaxEditPts=function(t,e){if(0===t)switch(e){case SuperMapAlgoPlot.SymbolType.TEXTSYMBOL:return 1;case SuperMapAlgoPlot.SymbolType.CIRCLESYMBOL:case SuperMapAlgoPlot.SymbolType.RECTANGLESYMBOL:case SuperMapAlgoPlot.SymbolType.BRACESYMBOL:case SuperMapAlgoPlot.SymbolType.LINEMARKING:case SuperMapAlgoPlot.SymbolType.LINERELATION:case SuperMapAlgoPlot.SymbolType.RUNWAY:case SuperMapAlgoPlot.SymbolType.SYMBOLTEXTBOX:case SuperMapAlgoPlot.SymbolType.ANNOFRAMESYMBOLM:case SuperMapAlgoPlot.SymbolType.LINEARARROW:return 2;case SuperMapAlgoPlot.SymbolType.ARCSYMBOL:case SuperMapAlgoPlot.SymbolType.CHORDSYMBOL:case SuperMapAlgoPlot.SymbolType.PIESYMBOL:case SuperMapAlgoPlot.SymbolType.ELLIPSESYMBOL:case SuperMapAlgoPlot.SymbolType.PARALLELOGRAM:case SuperMapAlgoPlot.SymbolType.KIDNEY:case SuperMapAlgoPlot.SymbolType.CONCENTRICCIRCLE:case SuperMapAlgoPlot.SymbolType.CURVEEIGHT:case SuperMapAlgoPlot.SymbolType.ANNOFRAMESYMBOL:case SuperMapAlgoPlot.SymbolType.TRAPEZOIDSYMBOL:case SuperMapAlgoPlot.SymbolType.NEWARCSYMBOL:case SuperMapAlgoPlot.SymbolType.NEWPIESYMBOL:case SuperMapAlgoPlot.SymbolType.NEWCHORDSYMBOL:return 3;case SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL:case SuperMapAlgoPlot.SymbolType.POLYBEZIERSYMBOL:case SuperMapAlgoPlot.SymbolType.PARALLELLINE:case SuperMapAlgoPlot.SymbolType.POLYBEZIERCLOSESYMBOL:case SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL:case SuperMapAlgoPlot.SymbolType.ARROWLINE:case SuperMapAlgoPlot.SymbolType.COMBINATIONALCIRCLE:case SuperMapAlgoPlot.SymbolType.FREECURVE:case SuperMapAlgoPlot.SymbolType.NODECHAIN:case SuperMapAlgoPlot.SymbolType.PATHTEXT:case SuperMapAlgoPlot.SymbolType.POLYGONREGION:case SuperMapAlgoPlot.SymbolType.REGULARPOLYGON:case SuperMapAlgoPlot.SymbolType.WIRE:return 9999}else if(22===t)switch(e){case 1003:case 1019:case 1020:case 1022:return 2;case 1006:case 1021:return 4;case 1001:case 1002:case 1004:case 1005:case 1007:case 1008:case 1009:case 1010:case 1011:case 1012:case 1013:case 1014:case 1015:case 1016:case 1017:case 1018:return 99999}else if(421===t)switch(e){case 320:return 2;case 317:return 4;case 323:return 1e3;case 311:case 315:case 318:case 319:case 321:case 322:return 99999}},SuperMapAlgoPlot.BasicAlgoSymbolFactory.getDefaultStyle=function(t,e){var o={};if(421===t)switch(e){case 320:case 321:o.color=o.strokeColor="#000000";break;case 322:o.color=o.strokeColor="#bc744d"}return o},SuperMapAlgoPlot.BasicAlgoSymbolFactory.zoomInCalSymbol=function(){if(22!==libID)return!1;switch(code){case 1012:case 1013:case 1014:case 1015:return!0;default:return!1}},SuperMapAlgoPlot.BasicAlgoSymbolFactory.zoomCalSymbol=function(){return!1},SuperMapAlgoPlot.BasicAlgoSymbolFactory.getSymbolName=function(t,e){var o="";if(0===t)switch(e){case SuperMapAlgoPlot.SymbolType.TEXTSYMBOL:o="文本";break;case SuperMapAlgoPlot.SymbolType.CIRCLESYMBOL:o="圆";break;case SuperMapAlgoPlot.SymbolType.RECTANGLESYMBOL:o="矩形";break;case SuperMapAlgoPlot.SymbolType.ARCSYMBOL:o="弧线";break;case SuperMapAlgoPlot.SymbolType.CHORDSYMBOL:o="弓形";break;case SuperMapAlgoPlot.SymbolType.PIESYMBOL:o="扇形";break;case SuperMapAlgoPlot.SymbolType.ELLIPSESYMBOL:o="椭圆";break;case SuperMapAlgoPlot.SymbolType.PARALLELOGRAM:o="平行四边形";break;case SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL:o="多边形";break;case SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL:o="折线";break;case SuperMapAlgoPlot.SymbolType.POLYBEZIERSYMBOL:o="贝赛尔曲线";break;case SuperMapAlgoPlot.SymbolType.POLYBEZIERCLOSESYMBOL:o="闭合贝塞尔曲线";break;case SuperMapAlgoPlot.SymbolType.PARALLELLINE:o="平行线";break;case SuperMapAlgoPlot.SymbolType.KIDNEY:o="集结地";break;case SuperMapAlgoPlot.SymbolType.ANNOFRAMESYMBOL:o="注记指示框";break;case SuperMapAlgoPlot.SymbolType.ARROWLINE:o="箭头线";break;case SuperMapAlgoPlot.SymbolType.COMBINATIONALCIRCLE:o="组合圆";break;case SuperMapAlgoPlot.SymbolType.CONCENTRICCIRCLE:o="同心圆";break;case SuperMapAlgoPlot.SymbolType.CURVEEIGHT:o="八字形";break;case SuperMapAlgoPlot.SymbolType.FREECURVE:o="自由线";break;case SuperMapAlgoPlot.SymbolType.ANNOFRAMESYMBOLM:o="多角标注框";break;case SuperMapAlgoPlot.SymbolType.LINEMARKING:o="线型标注";break;case SuperMapAlgoPlot.SymbolType.LINERELATION:o="对象间连线";break;case SuperMapAlgoPlot.SymbolType.NODECHAIN:o="节点链";break;case SuperMapAlgoPlot.SymbolType.PATHTEXT:o="沿线注记";break;case SuperMapAlgoPlot.SymbolType.POLYGONREGION:o="多边形区域管理";break;case SuperMapAlgoPlot.SymbolType.RUNWAY:o="跑道线";break;case SuperMapAlgoPlot.SymbolType.SYMBOLTEXTBOX:o="标注框";break;case SuperMapAlgoPlot.SymbolType.REGULARPOLYGON:o="正多边形";break;case SuperMapAlgoPlot.SymbolType.BRACESYMBOL:o="大括号";break;case SuperMapAlgoPlot.SymbolType.TRAPEZOIDSYMBOL:o="梯形";break;case SuperMapAlgoPlot.SymbolType.WIRE:o="铁丝网";break;case SuperMapAlgoPlot.SymbolType.LINEARARROW:o="直线箭头";break;case SuperMapAlgoPlot.SymbolType.NEWPIESYMBOL:o="扇形";break;case SuperMapAlgoPlot.SymbolType.NEWARCSYMBOL:o="弧线";break;case SuperMapAlgoPlot.SymbolType.NEWCHORDSYMBOL:o="弓形"}return o}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.GetSymbolInfoService=function(t){function e(t,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),o=o||{};var i,l=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,o)),n=l;return i=n.url.substr(n.url.length-1,1),n.url+="/"==i?"graphicObject.json?":"/graphicObject.json?",l.CLASS_NAME="SuperMap.GetSymbolInfoService",l}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMap.PlotCommonServiceBase),i(e,[{key:"destroy",value:function(){(function t(e,o,i){null===e&&(e=Function.prototype);var l=Object.getOwnPropertyDescriptor(e,o);if(void 0===l){var n=Object.getPrototypeOf(e);return null===n?void 0:t(n,o,i)}if("value"in l)return l.value;var a=l.get;return void 0!==a?a.call(i):void 0})(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}},{key:"processAsync",value:function(t){if(t){var e,o=this;e=SuperMap.GetSymbolInfoParameters.toUrlParameters(t),o.url+=e,t.dynamicToken&&(o.url+="&dynamicToken="+t.dynamicToken),"MSIE"===SuperMap.Browser.name.toUpperCase()&&(o.url=encodeURI(o.url)),o.request({method:"GET",params:null,scope:o,success:o.myServiceProcessCompleted,failure:o.serviceProcessFailed})}}},{key:"myServiceProcessCompleted",value:function(t){null!=(t=SuperMap.Util.transformResult(t))&&null!=t.textStyle2D&&null!=t.textStyle2D.fontHeight&&(t.textStyle2D.fontHeight=3),this.events.triggerEvent("processCompleted",{result:t})}}]),e}();SuperMap.GetSymbolInfoService=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.GetSMLInfosService=function(t){function e(t,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,o));(o=o||{})&&SuperMap.Util.extend(i,o);var l,n=i;return n.events=new SuperMap.Events(n,null,n.EVENT_TYPES,!0),n.eventListeners instanceof Object&&n.events.on(n.eventListeners),l=n.url.substr(n.url.length-1,1),n.url+="/"==l?"smlInfos":"/smlInfos",n.url+=".json",i.CLASS_NAME="SuperMap.GetSMLInfosService",i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMap.PlotCommonServiceBase),i(e,[{key:"destroy",value:function(){(function t(e,o,i){null===e&&(e=Function.prototype);var l=Object.getOwnPropertyDescriptor(e,o);if(void 0===l){var n=Object.getPrototypeOf(e);return null===n?void 0:t(n,o,i)}if("value"in l)return l.value;var a=l.get;return void 0!==a?a.call(i):void 0})(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}},{key:"processAsync",value:function(t){if(t){var e=this;e.url+=SuperMap.GetSMLInfosParameters.toUrlParameters(t),e.request({method:"GET",data:null,scope:e,success:e.serviceProcessCompleted,failure:e.serviceProcessFailed})}}}]),e}();SuperMap.GetSMLInfosService=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.GetLibInfoService=function(t){function e(t,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,o));(o=o||{})&&SuperMap.Util.extend(i,o);var l,n=i;return l=n.url.substr(n.url.length-1,1),n.url+="/"==l?"symbolLibs/":"/symbolLibs/",i.CLASS_NAME="SuperMap.GetLibInfoService",i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMap.PlotCommonServiceBase),i(e,[{key:"destroy",value:function(){(function t(e,o,i){null===e&&(e=Function.prototype);var l=Object.getOwnPropertyDescriptor(e,o);if(void 0===l){var n=Object.getPrototypeOf(e);return null===n?void 0:t(n,o,i)}if("value"in l)return l.value;var a=l.get;return void 0!==a?a.call(i):void 0})(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}},{key:"processAsync",value:function(t){var e=this;t&&null!==t.libID&&(e.libID=t.libID),e.url+=e.libID,e.url+=".json",e.request({method:"GET",data:null,scope:e,success:e.serviceProcessCompleted,failure:e.serviceProcessFailed})}}]),e}();SuperMap.GetLibInfoService=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.GetLibIDsService=function(t){function e(t,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,o));(o=o||{})&&SuperMap.Util.extend(i,o);var l,n=i;return l=n.url.substr(n.url.length-1,1),n.url+="/"==l?"symbolLibs.json?":"/symbolLibs.json?",i.CLASS_NAME="SuperMap.GetLibIDsService",i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMap.PlotCommonServiceBase),i(e,[{key:"destroy",value:function(){(function t(e,o,i){null===e&&(e=Function.prototype);var l=Object.getOwnPropertyDescriptor(e,o);if(void 0===l){var n=Object.getPrototypeOf(e);return null===n?void 0:t(n,o,i)}if("value"in l)return l.value;var a=l.get;return void 0!==a?a.call(i):void 0})(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}},{key:"processAsync",value:function(){this.request({method:"GET",data:null,scope:this,success:this.serviceProcessCompleted,failure:this.serviceProcessFailed})}}]),e}();SuperMap.GetLibIDsService=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.EditSmlFileService=function(t){function e(t,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,o));(o=o||{})&&SuperMap.Util.extend(i,o);var l=i;return l.events=new SuperMap.Events(l,null,l.EVENT_TYPES,!0),l.eventListeners instanceof Object&&l.events.on(l.eventListeners),i.CLASS_NAME="SuperMap.EditSmlFileService",i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMap.PlotCommonServiceBase),i(e,[{key:"destroy",value:function(){(function t(e,o,i){null===e&&(e=Function.prototype);var l=Object.getOwnPropertyDescriptor(e,o);if(void 0===l){var n=Object.getPrototypeOf(e);return null===n?void 0:t(n,o,i)}if("value"in l)return l.value;var a=l.get;return void 0!==a?a.call(i):void 0})(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}},{key:"processAsync",value:function(t){if(t){var e=this,o=t.method,i=e.url.substr(e.url.length-1,1);e.url+="/"==i?"smlInfos/":"/smlInfos/",e.url+=t.smlFileName+".json",e.url+="?isCover="+t.isCover;var l=null;t.method&&"POST"===t.method&&(l=SuperMap.EditSmlFileParameters.toJsonParameters(t)),e.request({method:o,data:l,scope:e,success:e.serviceProcessCompleted,failure:e.serviceProcessFailed})}}}]),e}();SuperMap.EditSmlFileService=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.symbolLibService=e.SymbolLibService=void 0,o(0);var i=o(48),l=o(47),n=e.SymbolLibService=L.supermap.ServiceBase.extend({initialize:function(t,e){L.supermap.ServiceBase.prototype.initialize.call(this,t,e)},getLibIDs:function(t,e){var o=this;return e||(e=o),new i.GetLibIDsService(o.url,{proxy:o.options.proxy,withCredentials:o.options.withCredentials,crossOrigin:o.options.crossOrigin,headers:o.options.headers,serverType:o.options.serverType,eventListeners:{scope:e,processCompleted:t,processFailed:t}}).processAsync(),o},getLibInfo:function(t,e,o){var i=this;return o||(o=i),new l.GetLibInfoService(i.url,{proxy:i.options.proxy,withCredentials:i.options.withCredentials,crossOrigin:i.options.crossOrigin,headers:i.options.headers,serverType:i.options.serverType,eventListeners:{scope:o,processCompleted:e,processFailed:e}}).processAsync(t),i}}),a=e.symbolLibService=function(t,e){return new n(t,e)};L.supermap.symbolLibService=a},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.symbolInfoService=e.SymbolInfoService=void 0,o(0);var i=o(45),l=e.SymbolInfoService=L.supermap.ServiceBase.extend({initialize:function(t,e){L.supermap.ServiceBase.prototype.initialize.call(this,t,e)},getSymbolInfo:function(t,e,o){var l=this;return o||(o=l),new i.GetSymbolInfoService(l.url,{proxy:l.options.proxy,withCredentials:l.options.withCredentials,crossOrigin:l.options.crossOrigin,headers:l.options.headers,serverType:l.options.serverType,eventListeners:{scope:o,processCompleted:e,processFailed:e}}).processAsync(t),l}}),n=e.symbolInfoService=function(t,e){return new l(t,e)};L.supermap.symbolInfoService=n},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.smlFileService=e.SMLFileService=void 0,o(0);var i=o(46),l=o(49),n=e.SMLFileService=L.supermap.ServiceBase.extend({initialize:function(t,e){L.supermap.ServiceBase.prototype.initialize.call(this,t,e)},getSMLInfos:function(t,e,o){var l=this;return o||(o=l),new i.GetSMLInfosService(l.url,{proxy:l.options.proxy,withCredentials:l.options.withCredentials,crossOrigin:l.options.crossOrigin,headers:l.options.headers,serverType:l.options.serverType,eventListeners:{scope:o,processCompleted:e,processFailed:e}}).processAsync(t),l},editSMLFile:function(t,e,o){var i=this;return o||(o=i),new l.EditSmlFileService(i.url,{proxy:i.options.proxy,withCredentials:i.options.withCredentials,crossOrigin:i.options.crossOrigin,headers:i.options.headers,serverType:i.options.serverType,eventListeners:{scope:o,processCompleted:e,processFailed:e}}).processAsync(t),i}}),a=e.smlFileService=function(t,e){return new n(t,e)};L.supermap.smlFileService=a},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.symbolLibService=e.SymbolLibService=e.symbolInfoService=e.SymbolInfoService=e.smlFileService=e.SMLFileService=void 0;var i=o(52),l=o(51),n=o(50);e.SMLFileService=i.SMLFileService,e.smlFileService=i.smlFileService,e.SymbolInfoService=l.SymbolInfoService,e.symbolInfoService=l.symbolInfoService,e.SymbolLibService=n.SymbolLibService,e.symbolLibService=n.symbolLibService},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.query=e.Query=void 0,o(0);var i=o(5),l=e.Query=L.Class.extend({map:null,initialize:function(t){t&&null!==t&&(this.map=t)},destroy:function(){this.map=null,delete this.map},captureGObject:function(t){var e=[];if(t){for(var o=this.map.getPlottingLayers(),l=0;l<o.length;l++){var n=o[l];for(var a in n.features){var s=n.features[a];s instanceof i.PlottingObject&&s.symbolType===SuperMap.Plot.SymbolType.DOTSYMBOL&&(t.lng===s.getLatLngs()[0].lng&&t.lat===s.getLatLngs()[0].lat&&e.push(s))}}return e}return 0},getGObjectsInPolygon:function(t){var e=[];if(t&&0!==t.length){if(L.Util.isArray(t)||(t=[t]),t.length<=2)return e;for(var o=this.map.getPlottingLayers(),l=0;l<o.length;l++){var n=o[l];for(var a in n.features){var s=n.features[a];if(s instanceof i.PlottingObject){var r=s.getBounds().getCenter();if(null===r)return;this._ptIsInPolygon(t,r)&&e.push(s)}}}return e}},_ptIsInPolygon:function(t,e){if(!t||null===t||0===t.length)return!1;for(var o=0,i=t.length,l=0;l<i;l++){var n=t[l],a=t[(l+1)%i];if(n.lat!==a.lat){var s=n.lat<a.lat?n.lat:a.lat,r=n.lat>a.lat?n.lat:a.lat;if(!(e.lat<s||e.lat>r))(e.lat-n.lat)*(a.lng-n.lng)/(a.lat-n.lat)+n.lng>e.lng&&o++}}return o%2==1},getGObjectsInCircle:function(t,e){if(t&&e){for(var o=[],l=this.map.getPlottingLayers(),n=0;n<l.length;n++){var a=l[n];for(var s in a.features){var r=a.features[s];if(r instanceof i.PlottingObject){var u=r.getBounds().getCenter();if(null===u)continue;Math.abs(e)>Math.sqrt(Math.pow(t.lng-u.lng,2)+Math.pow(t.lat-u.lat,2))&&o.push(r)}}}return o}},getGObjectsInRect:function(t,e){if(t&&e){for(var o=[],l=this.map.getPlottingLayers(),n=0;n<l.length;n++){var a=l[n];for(var s in a.features){var r=a.features[s];if(r instanceof i.PlottingObject){var u=r.getBounds().getCenter();if(null===u)continue;t.lng<e.lng&&t.lat>e.lat?u.lng>t.lng&&u.lng<e.lng&&u.lat<t.lat&&u.lat>e.lat&&o.push(r):u.lng<t.lng&&u.lng>e.lng&&u.lat<t.lat&&u.lat>e.lat&&o.push(r)}}}return o}}}),n=e.query=function(t){return new l(t)};L.supermap.plotting.query=n},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=e.TransactionManager=L.Evented.extend({map:null,undoTransactions:null,redoTransactions:null,maxCount:32,initialize:function(t){this.map=t,this.undoTransactions=[],this.redoTransactions=[],null===this.maxCount&&(this.maxCount=32)},destroy:function(){this.map=null,this.undoTransactions=null,this.redoTransactions=null,this.maxCount=null},setMaxCount:function(t){this.maxCount=t},add:function(t){this.undoTransactions.length>this.maxCount-1&&this.undoTransactions.splice(0,this.undoTransactions.length-this.maxCount+1),this.undoTransactions.push(t)},undo:function(){var t=this.undoTransactions.length;if(t>0){var e=this.undoTransactions[t-1];this.doTransaction(e,!0),this.redoTransactions.push(e),this.undoTransactions.splice(t-1,1)}},redo:function(){var t=this.redoTransactions.length;if(t>0){var e=this.redoTransactions[t-1];this.doTransaction(e),this.undoTransactions.push(e),this.redoTransactions.splice(t-1,1)}},doTransaction:function(t,e){var o=t.transInfos;if(t.transType===SuperMap.Plot.TransactionType.CREATE)for(var i=0,l=o.length;i<l;i++){var n=this.map.getLayer(o[i].layerId);e?n.removeFeatures(o[i].feature):n.addFeatures(o[i].feature)}else if(t.transType===SuperMap.Plot.TransactionType.EDIT)for(var a=0;a<o.length;a++){var s=this.map.getLayer(o[a].layerId),r=null;if(r=s?s.getFeatureByUuid(o[a].uuid):L.supermap.plotting.getControl(this.map).getFeatureByUuid(o[a].uuid),null!==s||null!==r){var u=o[a].redoParams;if(e&&(u=o[a].undoParams),"setFontAlign"===o[a].functionName)u.length>0&&r.setFontAlign(u[0]);else if("setLatLngs"===o[a].functionName)u.length>0&&r.setLatLngs(u[0]);else if("modifyPoint"===o[a].functionName)u.length>0&&r._modifyPoint(u[0],u[1]);else if("setTextContent"===o[a].functionName)u.length>0&&r.setTextContent(u[0]);else if("setRadiusText"===o[a].functionName)2===u.length&&r.setRadiusText(u[0],u[1]);else if("setType"===o[a].functionName&&r instanceof L.supermap.plotting.RouteNode)u.length>0&&r.setType(u[0]);else if("setStrokeColor"===o[a].functionName&&r.geometry instanceof SuperMap.Geometry.GroupObject)u.length>0&&r.setStyle(u[0]);else if("addAvoidRegion"===o[a].functionName)u.length>0&&(u[0]&&u[0].layer&&u[0].layer.removeFeatures(u[0]),e?r.removeAvoidRegions(u[0]):r.addAvoidRegion(u[0]));else if("removeAvoidRegions"===o[a].functionName){if(u.length>0){for(var p=0;p<u[0].length;p++)u[0][p]&&u[0][p].layer&&u[0][p].layer.removeFeatures(u[0][p]);if(e)for(var h=0;h<u[0].length;h++)r.addAvoidRegion(u[0][h]);else r.removeAvoidRegions(u[0])}}else if("createGroupObject"===o[a].functionName||"createFlags"===o[a].functionName){var c=null;e?s&&o[a].undoParams.length>0&&(c=s.unGroupObject(o[a].undoParams[0])):"createGroupObject"===o[a].functionName?c=s.createGroupObject(o[a].redoParams[0]):"createFlags"===o[a].functionName&&(c=s.createFlags(o[a].redoParams[0])),null!==c&&s._map.getPlotEditControl().selectFeatures(c)}else"updateSymbolText"===o[a].functionName?u.length>0&&r.updateSymbolText(u[0],u[1]):o[a].functionName&&null!==u&&r[o[a].functionName](u[0],u[1]);if(o[a].propertyName){var g=o[a].undoValue;e||(g=o[a].redoValue),r.hasOwnProperty(o[a].propertyName)?r[o[a].propertyName]=g:null!==r&&(r.style[o[a].propertyName]=g)}r&&r.layer&&(r.symbolType!==SuperMap.Plot.SymbolType.DOTSYMBOL||8!==r.textPosition||"fontColor"!==o[a].propertyName&&"fontFamily"!==o[a].propertyName||r._calculateParts(),r.redraw(),r.fire(SuperMap.Plot.Event.reseteditmarkersvalues))}}else if(t.transType===SuperMap.Plot.TransactionType.REMOVE)for(var y=0;y<o.length;y++)e?this.map.getLayer(o[y].layerId).addFeatures(o[y].feature):this.map.getLayer(o[y].layerId).removeFeatures(o[y].feature)}}),l=e.transactionManager=function(t){return new i(t)};L.supermap.plotting.transactionManager=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Plotting=void 0,o(0);var i=o(25),l=o(24),n=o(26),a=o(55),s=null,r=e.Plotting=L.Evented.extend({serverUrl:null,map:null,defaultStyle:null,sitDataManager:null,symbolLibManager:null,clientID:null,dpi:96,animationManager:null,transManager:null,imageManager:null,touchMode:null,options:{serviceParams:{proxy:null,withCredentials:!1,crossOrigin:null,headers:null,serverType:null}},initialize:function(t,e,o){null!=t&&(r.prototype.map=t),null!=e&&(r.prototype.serverUrl=e),o&&o.serviceParams&&SuperMap.Util.extend(this.options,o),this.defaultStyle=new SuperMap.Plot.DefaultStyle,this.sitDataManager=new i.SitDataManager(this.map,this.serverUrl,this.options),this.symbolLibManager=new l.SymbolLibManager(this.serverUrl,this.options),this.animationManager=new n.GOAnimationManager(this.map,this.serverUrl,this.options),this.transManager=new a.TransactionManager(this.map),this.imageManager={},this.touchMode=!1},destroy:function(){r.prototype.serverUrl=null,r.prototype.map=null,this.defaultStyle&&(this.defaultStyle.destroy(),this.defaultStyle=null),this.sitDataManager&&(this.sitDataManager.destroy(),this.sitDataManager=null),this.symbolLibManager&&(this.symbolLibManager.destroy(),this.symbolLibManager=null),this.clientID=null,null!==this.animationManager&&(this.animationManager.destroy(),this.animationManager=null),s=null},getDefaultStyle:function(){return this.defaultStyle},getSitDataManager:function(){return this.sitDataManager},getSymbolLibManager:function(){return this.symbolLibManager},getGOAnimationManager:function(){return this.animationManager},getClientID:function(){return this.clientID},setClientID:function(t){this.clientID=t},getTouchMode:function(){return this.touchMode},setTouchMode:function(t){this.touchMode=t},getDPI:function(){return this.dpi},setDPI:function(t){this.dpi=t},getTransManager:function(){return this.transManager},setMap:function(t){r.prototype.map=t,null===this.sitDataManager.map&&(i.SitDataManager.prototype.map=t),null===this.animationManager.map&&this.animationManager.setMap(t),null===this.transManager.map&&(this.transManager.map=t)},setPlotUrl:function(t){r.prototype.serverUrl=t,null===this.sitDataManager.serverUrl&&(i.SitDataManager.prototype.serverUrl=t),null===this.symbolLibManager.url&&(l.SymbolLibManager.prototype.url=t),null===this.animationManager.serverUrl&&(n.GOAnimationManager.prototype.serverUrl=t)},setOptions:function(t){t=t||{},L.setOptions(this,t),L.setOptions(this.sitDataManager,t),L.setOptions(this.symbolLibManager,t),L.setOptions(this.animationManager,t)},getFeatureByUuid:function(t){if(null!==this.map){for(var e=this.map.getPlottingLayers(),o=0,i=e.length;o<i;o++){var l=e[o].getFeatureByUuid(t);if(null!==l)return l}return null}return null}});L.supermap.plotting.getControl=function(t,e,o){return null===s&&(s=new r(t,e,o)),t&&null!==t&&null===s.map&&s.setMap(t),e&&null!==e&&null===s.serverUrl&&s.setPlotUrl(e),null!=o&&s.setOptions(o),s}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.symbolLibManager=e.SymbolLibManager=e.symbolLib=e.SymbolLib=e.sitDataManager=e.SitDataManager=e.query=e.Query=e.Plotting=e.goAnimationManager=e.GOAnimationManager=void 0;var i=o(26),l=o(56),n=o(54),a=o(25),s=o(23),r=o(24);e.GOAnimationManager=i.GOAnimationManager,e.goAnimationManager=i.goAnimationManager,e.Plotting=l.Plotting,e.Query=n.Query,e.query=n.query,e.SitDataManager=a.SitDataManager,e.sitDataManager=a.sitDataManager,e.SymbolLib=s.SymbolLib,e.symbolLib=s.symbolLib,e.SymbolLibManager=r.SymbolLibManager,e.symbolLibManager=r.symbolLibManager},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.editControl=e.PlotEditControl=void 0,o(0);var i=o(5),l=o(6),n=o(4),a=o(15),s=o(17),r=o(9),u=o(13),p=o(12),h=e.PlotEditControl=p.PlotControl.extend({_dragStartScale:null,_dragStartRotate:null,_dragStartBounds:null,_dragStartLatLngs:null,_dragStartScaleValues:null,_dragStartPositionOffset:null,_dragStartScalePoints:null,_editMarkers:null,_disEditBox:null,_editFeatures:null,_mouseTolerance:10,touchTolerance:20,_editMode:SuperMap.Plot.EditMode.EDITCIRCUMRECTANGLE,_avoidEditing:!1,selectedFeatures:[],options:{highlightFlag:!0,highlightStyle:{color:"#ffffff",opacity:1,weight:1},draggable:!0,editIcon:L.divIcon({className:"leaflet-supermap-plot-control-icon-path",iconSize:[10,10]}),scaleIcon:L.divIcon({className:"leaflet-supermap-plot-scale-icon-path",iconSize:[10,10]}),rotateIcon:L.divIcon({className:"leaflet-supermap-plot-rotate-icon-path",iconSize:[15,15]}),lockedIcon:L.divIcon({className:"leaflet-supermap-plot-locked-icon-path",iconSize:[10,10]}),avoidIcon:L.divIcon({className:"leaflet-supermap-plot-avoid-icon-path",iconSize:[8,8]})},initialize:function(t,e){if(L.Browser.touch&&L.supermap.plotting.getControl().getTouchMode()&&(this.options.editIcon=L.divIcon({className:"leaflet-supermap-plot-control-icon-path",iconSize:[20,20]}),this.options.scaleIcon=L.divIcon({className:"leaflet-supermap-plot-scale-icon-path",iconSize:[20,20]}),this.options.rotateIcon=L.divIcon({className:"leaflet-supermap-plot-rotate-icon-path",iconSize:[25,25]}),this.options.lockedIcon=L.divIcon({className:"leaflet-supermap-plot-locked-icon-path",iconSize:[20,20]}),this.options.avoidIcon=L.divIcon({className:"leaflet-supermap-plot-avoid-icon-path",iconSize:[15,15]})),L.version<"0.7")throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");L.Control.prototype.initialize.call(this,e),L.setOptions(this,e),this._editMarkers={},this._disEditBox={},this._dragStartScale={},this._dragStartRotate={},this._dragStartBounds={},this._dragStartLatLngs={},this._dragStartPositionOffset={},this._dragStartScaleValues={},this._dragStartScalePoints={},this._editFeatures={}},onAdd:function(t){this.controlDiv=L.DomUtil.create("div","supermap-iclient"),this._map=t,this._map.on("click",this._onMapClick,this),this._map._plotEditControl=this;for(var e=0;e<this._map.getPlottingLayers().length;e++)if(this._map.getPlottingLayers()[e].isSelected){this.enableEditFeatures(this._map.getPlottingLayers()[e].features);for(var o=0;o<this._map.getPlottingLayers()[e].features.length;o++)(this._map.getPlottingLayers()[e].features[o]instanceof l.GroupObject||this._map.getPlottingLayers()[e].features[o]instanceof n.Route)&&this.enableEditFeatures(this._map.getPlottingLayers()[e].features[o].components)}return this.controlDiv},onRemove:function(){for(var t in this._map.off("click",this._onMapClick,this),this.unselectFeatures(),this._map._plotEditControl=null,this._map=null,this._editFeatures)this._disableFeatureEdit(this._editFeatures[t])},enableEditFeatures:function(t){SuperMap.Util.isArray(t)||(t=[t]);for(var e=0;e<t.length;e++)t[e]instanceof i.PlottingObject&&(t[e].enableEdit=!0,this._editFeatures[t[e].uuid]=t[e],this._enableFeatureEdit(t[e]))},disableEditFeatures:function(t){SuperMap.Util.isArray(t)||(t=[t]);for(var e=0;e<t.length;e++)t[e]instanceof i.PlottingObject&&(t[e].enableEdit=!1,delete this._editFeatures[t[e].uuid],this._disableFeatureEdit(t[e]))},avoidEdit:function(t){if(void 0===t&&(t=!this._avoidEditing),this._avoidEditing!==t)if(t&&1===this.selectedFeatures.length&&!this.selectedFeatures[0].getLocked()){for(var e in this._avoidRegionControl=new u.AvoidRegionControl(this.selectedFeatures[0]),this._map.addControl(this._avoidRegionControl),this._editFeatures)this._disableFeatureEdit(this._editFeatures[e]);this._collectEditMarkers(this._avoidRegionControl.feature),this._avoidEditing=t}else if(!t){if(this._avoidRegionControl){for(var o in this._editFeatures)this._enableFeatureEdit(this._editFeatures[o]);if(!SuperMap.Util.isArray(this._avoidRegionControl.feature))var i=[this._avoidRegionControl.feature];this.selectFeatures(i),this._map.removeControl(this._avoidRegionControl),this._avoidRegionControl=null}this._avoidEditing=t}return this._avoidEditing},setEditMode:function(t){if(this._editMode!==t){this._editMode=t;for(var e=0;e<this.selectedFeatures.length;e++)this._collectEditMarkers(this.selectedFeatures[e])}},canCopy:function(){return this.getSelectedFeatures().length>0},canCut:function(){return this.getSelectedFeatures().length>0},canPaste:function(){return!!(this.pasteGeoAry&&this.pasteGeoAry.length>0)},copy:function(){this.pasteGeoAry=[],this.pasteGeoSel=[];for(var t=0,e=this._map.getPlottingLayers().length;t<e;t++){var o=this._map.getPlottingLayers()[t];if(!0!==o.isLocked&&!1!==o.isEditable)for(var l=0,n=o.getFeatures().length;l<n;l++){var a=o.getFeatures()[l];if(a.isSelected&&!1===a.isLocked&&(a.layer=o,a instanceof i.PlottingObject))if(a.symbolType===SuperMap.Plot.SymbolType.ROUTENODE)this.pasteGeoAry.push(a.route);else if(this.pasteGeoAry.push(a),this.pasteGeoSel.push(a.isSelected),(a.symbolType===SuperMap.Plot.SymbolType.SATELLITETIMEWINDOWS||a.symbolType===SuperMap.Plot.SymbolType.SATELLITE)&&a.hasOwnProperty("timeWindows")&&0!==a.timeWindows.length)for(var s=0,r=a.timeWindows.length;s<r;s++)a.timeWindows[s].hasOwnProperty("symbolType")&&a.timeWindows[s].symbolType===SuperMap.Plot.SymbolType.SATELLITETIMEWINDOWS&&this.pasteGeoAry.push(a.timeWindows[s])}}},copyFeatures:function(t){this.pasteGeoAry=[],this.pasteGeoSel=[],SuperMap.Util.isArray(t)||(t=[t]);for(var e=0;e<t.length;e++){var o=t[e];o instanceof i.PlottingObject&&(this.pasteGeoAry.push(o),this.pasteGeoSel.push(o.isSelected),o.isSelected&&this.selectedFeatures.push(o))}},cut:function(){this.pasteGeoAry=[],this.pasteGeoSel=[];var t=[],e=new SuperMap.Plot.Transaction;e.transType=SuperMap.Plot.TransactionType.REMOVE;for(var o=this.getSelectedFeatures().slice(),l=0;l<o.length;l++){var n=o[l];if(!0!==n.layer.isLocked&&!1!==n.layer.isEditable&&!1===n.isLocked){if(n instanceof i.PlottingObject)if(n.symbolType===SuperMap.Plot.SymbolType.ROUTENODE)this.pasteGeoAry.push(n.route),this.pasteGeoSel.push(n.route.isSelected),n.layer.removeFeatures(n.route);else{if(this.pasteGeoAry.push(n),this.pasteGeoSel.push(n.isSelected),n.hasOwnProperty("geoSymbolTexts")&&0!==n.geoSymbolTexts.length)for(var a=0,s=n.geoSymbolTexts.length;a<s;a++)n.geoSymbolTexts[a].hasOwnProperty("isSelected")&&!0===n.geoSymbolTexts[a].isSelected&&t.push(n.geoSymbolTexts[a].clone());if((n.symbolType===SuperMap.Plot.SymbolType.SATELLITETIMEWINDOWS||n.symbolType===SuperMap.Plot.SymbolType.SATELLITE)&&n.hasOwnProperty("timeWindows")&&0!==n.timeWindows.length)for(var r=0,u=n.timeWindows.length;r<u;r++)n.timeWindows[r].hasOwnProperty("symbolType")&&n.timeWindows[r].symbolType===SuperMap.Plot.SymbolType.SATELLITETIMEWINDOWS&&(this.pasteGeoAry.push(n.timeWindows[r]),n.layer.removeFeatures(n.timeWindows[r]));var p=new SuperMap.Plot.TransactionInfo;p.layerId=n.layer._leaflet_id,p.feature=n,e.transInfos.push(p),n.layer.removeFeatures(n)}0!==e.transInfos.length&&L.supermap.plotting.getControl().getTransManager().add(e)}}if(0!==t.length)for(var h=0,c=t.length;h<c;h++){var g=t[h];if(g.symbolType===SuperMap.Plot.SymbolType.SYMBOLTEXT||g.symbolType===SuperMap.Plot.SymbolType.SYMBOLTEXT1)for(var y=0,f=this.pasteGeoAry.length;y<f;y++)g.associatedUuid===this.pasteGeoAry[y].uuid&&this.pasteGeoAry[y].geoSymbolTexts.push(t[h])}},cutFeatures:function(t){this.pasteGeoAry=[],this.pasteGeoSel=[],t=SuperMap.Util.isArray(t)?t.slice():[t];for(var e=0;e<t.length;e++){var o=t[e],l=o.layer;o instanceof i.PlottingObject&&(this.pasteGeoAry.push(o),this.pasteGeoSel.push(o.isSelected),o instanceof a.GeoRouteNode?(o.isSelected&&this.unselectFeatures(o),l.removeFeatures(o.route)):l.removeFeatures(o),o.layer=l)}},paste:function(){return this._pasteToPosition.apply(this,arguments)},align:function(t){if(0!==this.getSelectedFeatures().length){var e=new SuperMap.Plot.Transaction;L.supermap.plotting.getControl().getTransManager().add(e);var o=function(t,e,o,i,l,n){var a=new SuperMap.Plot.TransactionInfo;a.layerId=t,a.uuid=e,a.functionName=o,a.undoParams=i,a.redoParams=l,n.transInfos.push(a)},i=1,l=this.getSelectedFeatures().length,n=null,a=null,s=null,r=this.getSelectedFeatures()[0].getBounds();if(t===SuperMap.Plot.AlignType.LEFT)for(;i<l;i++)n=this.getSelectedFeatures()[i].getBounds(),a=r.getWest()-n.getWest(),this.getSelectedFeatures()[i].move(0,a),this._collectEditMarkers(this.getSelectedFeatures()[i]),o(this.getSelectedFeatures()[i].layer._leaflet_id,this.getSelectedFeatures()[i].uuid,"move",[0,-a],[0,a],e);if(t===SuperMap.Plot.AlignType.RIGHT)for(;i<l;i++)n=this.getSelectedFeatures()[i].getBounds(),a=r.getEast()-n.getEast(),this.getSelectedFeatures()[i].move(0,a),this._collectEditMarkers(this.getSelectedFeatures()[i]),o(this.getSelectedFeatures()[i].layer._leaflet_id,this.getSelectedFeatures()[i].uuid,"move",[0,-a],[0,a],e);if(t===SuperMap.Plot.AlignType.UP)for(;i<l;i++)n=this.getSelectedFeatures()[i].getBounds(),s=r.getNorth()-n.getNorth(),this.getSelectedFeatures()[i].move(s,0),this._collectEditMarkers(this.getSelectedFeatures()[i]),o(this.getSelectedFeatures()[i].layer._leaflet_id,this.getSelectedFeatures()[i].uuid,"move",[-s,0],[s,0],e);if(t===SuperMap.Plot.AlignType.DOWN)for(;i<l;i++)n=this.getSelectedFeatures()[i].getBounds(),s=r.getSouth()-n.getSouth(),this.getSelectedFeatures()[i].move(s,0),this._collectEditMarkers(this.getSelectedFeatures()[i]),o(this.getSelectedFeatures()[i].layer._leaflet_id,this.getSelectedFeatures()[i].uuid,"move",[-s,0],[s,0],e);if(t===SuperMap.Plot.AlignType.VERTICALCENTER)for(;i<l;i++)n=this.getSelectedFeatures()[i].getBounds(),s=r.getCenter().lat-n.getCenter().lat,this.getSelectedFeatures()[i].move(s,0),this._collectEditMarkers(this.getSelectedFeatures()[i]),o(this.getSelectedFeatures()[i].layer._leaflet_id,this.getSelectedFeatures()[i].uuid,"move",[-s,0],[s,0],e);if(t===SuperMap.Plot.AlignType.HORIZONTALCENTER)for(;i<l;i++)n=this.getSelectedFeatures()[i].getBounds(),a=r.getCenter().lng-n.getCenter().lng,this.getSelectedFeatures()[i].move(0,a),this._collectEditMarkers(this.getSelectedFeatures()[i]),o(this.getSelectedFeatures()[i].layer._leaflet_id,this.getSelectedFeatures()[i].uuid,"move",[0,-a],[0,a],e)}},deleteSelectedFeatures:function(){if(0===Object.keys(this.getSelectedFeatures()).length)return null;if(Object.keys(this.getSelectedFeatures()).length){var t=this.getSelectedFeatures(),e=t.slice(),o=new SuperMap.Plot.Transaction;o.transType=SuperMap.Plot.TransactionType.REMOVE,L.supermap.plotting.getControl().getTransManager().add(o);for(var i=0,l=e.length;i<l;i++){var n=new SuperMap.Plot.TransactionInfo;n.layerId=e[i].layer._leaflet_id,n.feature=e[i],o.transInfos.push(n)}for(var a=0,s=t.length;a<s;a++)t[a].layer.removeFeatures(t[a])}},getSelectedFeatures:function(){return this.selectedFeatures.slice()},multiSelect:function(){L.DomEvent.on(this._map._container,"mousedown",this._onMapMouseDown,this),this._map.dragging.enabled()&&(this._map.dragging.disable(),this._mapDraggingWasEnabled=!0)},selectFeatures:function(t){if(SuperMap.Util.isArray(t)||(t=[t]),!1!==this.fire(SuperMap.Plot.Event.beforefeaturesselected,{features:t})){var e=[];for(var o in t)null!==t[o]._map&&t[o].enableEdit&&!1===t[o].isSelected&&(t[o].isSelected=!0,this.selectedFeatures.push(t[o]),this._collectEditMarkers(t[o]),this.options.draggable&&!t[o].layer.isLocked&&t[o].layer.isEditable&&t[o].dragging.enable(),null!==t[o].ownerGroup&&(t[o].ownerGroup.isSelected=!0),t[o]instanceof a.GeoRouteNode&&(t[o].route.isSelected=!0,this.options.highlightFlag&&t[o].route.highlight(this.options.highlightStyle)),e.push(t[o]));this.fire(SuperMap.Plot.Event.featuresselected,{features:e})}},unselectFeatures:function(t){if(void 0===t&&(t=this.selectedFeatures.slice()),SuperMap.Util.isArray(t)||(t=[t]),!1!==this.fire(SuperMap.Plot.Event.beforefeaturesunselected,{features:t})){for(var e=t.slice(),o=0;o<e.length;){var i=L.Util.indexOf(this.selectedFeatures,e[o]);-1!==i?(this._removeMarkers(e[o]),e[o].isSelected=!1,e[o].dragging.disable(),null!==e[o].ownerGroup&&(e[o].ownerGroup.isSelected=!1),e[o]instanceof a.GeoRouteNode&&(e[o].route.isSelected=!1,e[o].route.unhighlight()),this.selectedFeatures.splice(i,1),o++):e.splice(o,1)}this.fire(SuperMap.Plot.Event.featuresunselected,{features:e}),this.transaction&&0!==this.transaction.transInfos.length&&(L.supermap.plotting.getControl().getTransManager().add(this.transaction),this.transaction=null,this.isAddTransInfo=!1)}},_onMapMouseDown:function(t){this.multiple=!1,L.DomUtil.disableTextSelection(),L.DomUtil.disableImageDrag(),this._startPoint=this._map.mouseEventToContainerPoint(t),L.DomEvent.on(document,{contextmenu:L.DomEvent.stop,mousemove:this._onMapMouseMove,mouseup:this._onMapMouseUp},this)},_onMapMouseMove:function(t){this.multiple||(this.multiple=!0,this._box=L.DomUtil.create("div","leaflet-zoom-box",this._map._container),L.DomUtil.addClass(this._map._container,"leaflet-crosshair")),this._endPoint=this._map.mouseEventToContainerPoint(t);var e=new L.Bounds(this._endPoint,this._startPoint),o=e.getSize();L.DomUtil.setPosition(this._box,e.min),this._box.style.width=o.x+"px",this._box.style.height=o.y+"px"},_onMapMouseUp:function(){if(L.DomEvent.off(this._map._container,"mousedown",this._onMapMouseDown,this),this.multiple&&(L.DomUtil.remove(this._box),L.DomUtil.removeClass(this._map._container,"leaflet-crosshair")),L.DomUtil.enableTextSelection(),L.DomUtil.enableImageDrag(),L.DomEvent.off(document,{contextmenu:L.DomEvent.stop,mousemove:this._onMapMouseMove,mouseup:this._onMapMouseUp},this),this.multiple){var t=new L.LatLngBounds(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._endPoint)),e=[];for(var o in this._editFeatures)e.push(this._editFeatures[o]);for(var i=[],l=0,n=e.length;l<n;l++)e[l].isSelected||(e[l]instanceof a.GeoRouteNode||e[l].symbolType===SuperMap.Plot.SymbolType.LITERATESIGN?t.contains(e[l].route.getBounds().getCenter())&&-1===SuperMap.Util.indexOf(i,e[l].route)&&i.push(e[l].route):null!==e[l].ownerGroup?t.contains(e[l].ownerGroup.getBounds().getCenter())&&-1===SuperMap.Util.indexOf(i,e[l].ownerGroup)&&i.push(e[l].ownerGroup):e[l].getBounds().isValid()&&t.contains(e[l].getBounds().getCenter())&&i.push(e[l]));0!==i.length&&this.selectFeatures(i),this._mapDraggingWasEnabled&&this._map.dragging.enable(),this.multiple=!1}},_enableFeatureEdit:function(t){t instanceof i.PlottingObject&&t.on("click",this._onClick,this).on("mousemove",this._onMouseMove,this).on("mouseout",this._onMouseOut,this).on("dragstart",this._onDragStart,this).on("drag",this._onDrag,this).on("dragend",this._onDragEnd,this).on("reseteditmarkersvalues",this._onResetEditMarkersValues,this).on("reseteditmarkers",this._onResetEditMarkers,this)},_disableFeatureEdit:function(t){t instanceof i.PlottingObject&&(t.isSelected&&this.unselectFeatures(t),t.off("click",this._onClick,this).off("mousemove",this._onMouseMove,this).off("mouseout",this._onMouseOut,this).off("dragstart",this._onDragStart,this).off("drag",this._onDrag,this).off("dragend",this._onDragEnd,this).off("reseteditmarkersvalues",this._onResetEditMarkersValues,this).off("reseteditmarkers",this._onResetEditMarkers,this))},_onSelectedLayers:function(t){this.selectFeatures(t.target)},_onUnSelectLayers:function(t){this.unselectFeatures(t.target)},_onMouseMove:function(t){var e=t.target,o="";if(e.isSelected)if(this._editMode===SuperMap.Plot.EditMode.ADDCONTROLPOINT&&(SuperMap.Plot.AddPoint_WayType.UNKNOWN!==e._getSymbolWayType()||e instanceof a.GeoRouteNode&&(e._isFirstNode()||e._isLastNode())||e.symbolType===SuperMap.Plot.SymbolType.ANNOFRAMESYMBOLM))o="crosshair";else if(this._editMode===SuperMap.Plot.EditMode.ADDCONTROLPOINT&&e instanceof n.Route){var i=this._getAddPointTolerance(),l=e._selectNodeLayer(t.latlng,i);null===l||l instanceof a.GeoRouteNode&&(l._isFirstNode()||l._isLastNode())?o="crosshair":null!==l&&(o="pointer")}else o="move";else o="pointer";e.layer._setCursorStyle(o)},_onMouseOut:function(t){t.target.layer._setCursorStyle()},_onDragStart:function(){for(var t=0;t<this.selectedFeatures.length;t++){if(!this.selectedFeatures[t].getLocked()){var e=this._editMarkers[this.selectedFeatures[t].uuid];for(var o in e)e[o].setOpacity(0)}this.selectedFeatures[t]instanceof l.GroupObject?this._dragStartLatLngs[this.selectedFeatures[t].uuid]=this._editMarkers[this.selectedFeatures[t].uuid]:this._dragStartLatLngs[this.selectedFeatures[t].uuid]=L.Util.cloneLatLngs(this.selectedFeatures[t].getLatLngs()),this.selectedFeatures[t].symbolType===SuperMap.Plot.SymbolType.DOTSYMBOL&&(this._dragStartPositionOffset[this.selectedFeatures[t].uuid]={x:this.selectedFeatures[t].positionOffsetX,y:this.selectedFeatures[t].positionOffsetY}),this.transaction||(this.transaction=new SuperMap.Plot.Transaction,this.transaction.transType=SuperMap.Plot.TransactionType.EDIT,this.isAddTransInfo=!0)}},_onDrag:function(t){for(var e=0,o=this.selectedFeatures.length;e<o;e++)if((this._editMode!==SuperMap.Plot.EditMode.ADDCONTROLPOINT||SuperMap.Plot.AddPoint_WayType.UNKNOWN===this.selectedFeatures[e]._getSymbolWayType())&&!this.selectedFeatures[e].getLocked()){var i=this.selectedFeatures[e].symbolType;if(i===SuperMap.Plot.SymbolType.SYMBOLTEXT1||i===SuperMap.Plot.SymbolType.AIRROUTE||i===SuperMap.Plot.SymbolType.NAVYROUTE||i===SuperMap.Plot.SymbolType.MISSILEROUTE)break;if(this.selectedFeatures[e].move(t.dLat,t.dLng),this.isAddTransInfo){var l=new SuperMap.Plot.TransactionInfo;l.layerId=this.selectedFeatures[e].layer._leaflet_id,l.uuid=this.selectedFeatures[e].uuid,l.functionName="move",this.transaction.transInfos.push(l)}}this.isAddTransInfo=!1},_onDragEnd:function(){for(var t=0;t<this.selectedFeatures.length;t++)this.selectedFeatures[t].getLocked()||(this._collectEditMarkers(this.selectedFeatures[t]),this.selectedFeatures[t].graphic&&this.selectedFeatures[t].graphic.updateImage());this._saveHistoryInfomation(),this.transaction&&0!==this.transaction.transInfos.length&&(L.supermap.plotting.getControl().getTransManager().add(this.transaction),this.transaction=new SuperMap.Plot.Transaction,this.isAddTransInfo=!0),this.fire(SuperMap.Plot.Event.featuresmodified,{features:this.selectedFeatures})},_saveHistoryInfomation:function(){if(this.transaction)for(var t=0;t<this.transaction.transInfos.length;t++){var e=this.transaction.transInfos[t].uuid,o=this._map.getLayer(this.transaction.transInfos[t].layerId).getFeatureByUuid(e);if(null===o)for(var i=0;i<this.features.length;i++)if(this.features[t].uuid===e){o=this.features[t];break}if(null!==o){if("setRotate"===this.transaction.transInfos[t].functionName)o._isDot()?(this.transaction.transInfos[t].undoParams=[this._dragStartRotate[e]],this.transaction.transInfos[t].redoParams=[o.getRotate()]):(this.transaction.transInfos[t].undoParams=[360-(o.getRotate()-this._dragStartRotate[e])],this.transaction.transInfos[t].redoParams=[o.getRotate()-this._dragStartRotate[e]]);else if("setScale"===this.transaction.transInfos[t].functionName){var n=this._dragStartScale[e];!1===o.limitWidthHeight?(this.transaction.transInfos[t].undoParams=[n.x,n.y],this.transaction.transInfos[t].redoParams=[o.getScale().x,o.getScale().y]):(this.transaction.transInfos[t].undoParams=[n],this.transaction.transInfos[t].redoParams=[o.getScale()])}else if("setLatLngs"===this.transaction.transInfos[t].functionName)o.symbolType===SuperMap.Plot.SymbolType.LINERELATION?this.transaction.transInfos[t].undoParams=[this._dragStartLatLngs[e]]:this.transaction.transInfos[t].undoParams=[L.Util.cloneLatLngs(this._dragStartLatLngs[e])],this.transaction.transInfos[t].redoParams=[L.Util.cloneLatLngs(o.getLatLngs())],o.symbolType===SuperMap.Plot.SymbolType.ARCREGION&&1===this.transaction.transInfos[t].redoParams[0].length&&this.transaction.transInfos[t].redoParams[0].push(o.scalePoints[0]);else if("setScaleValues"===this.transaction.transInfos[t].functionName){for(var a=[],s=[],r=0;r<this._dragStartScaleValues[e].length;r++)a.push(this._dragStartScaleValues[e][r]);for(var u=0;u<o.scaleValues.length;u++)s.push(o.scaleValues[u]);this.transaction.transInfos[t].undoParams=[a],this.transaction.transInfos[t].redoParams=[s]}else if("modifyPoint"===this.transaction.transInfos[t].functionName){var p=this.transaction.transInfos[t].undoParams[0];this.transaction.transInfos[t].undoParams.push(this._dragStartScalePoints[e][p]),this.transaction.transInfos[t].undoParams[1].isScalePoint=!0;var h=this.transaction.transInfos[t].redoParams[0];this.transaction.transInfos[t].redoParams.push(o.scalePoints[h]),this.transaction.transInfos[t].redoParams[1].isScalePoint=!0}else if("move"===this.transaction.transInfos[t].functionName){if(o.symbolType===SuperMap.Plot.SymbolType.DOTSYMBOL&&!0===o.positionOffset){var c=0,g=0,y=this._map.latLngToLayerPoint(o.getLatLngs()[0]),f={x:y.x+this._dragStartPositionOffset[e].x,y:y.y+this._dragStartPositionOffset[e].y},P=this._map.layerPointToLatLng(f);y.x+=o.positionOffsetX,y.y+=o.positionOffsetY;var d=this._map.layerPointToLatLng(y);c=P.lng-d.lng,g=P.lat-d.lat}else o instanceof l.GroupObject?(c=this._dragStartLatLngs[e][0].getLatLng().lng-this._editMarkers[o.uuid][0].getLatLng().lng,g=this._dragStartLatLngs[e][0].getLatLng().lat-this._editMarkers[o.uuid][0].getLatLng().lat):0!==o.getLatLngs().length&&(c=this._dragStartLatLngs[e][0].lng-o.getLatLngs()[0].lng,g=this._dragStartLatLngs[e][0].lat-o.getLatLngs()[0].lat);o instanceof l.GroupObject?(this.transaction.transInfos[t].undoParams=[g,c],this.transaction.transInfos[t].redoParams=[-g,-c]):0!==o.getLatLngs().length&&(this.transaction.transInfos[t].undoParams=[g,c],this.transaction.transInfos[t].redoParams=[-g,-c])}}else this.transaction.transInfos.splice(t,1),t--}},_onResetEditMarkers:function(t){-1!==L.Util.indexOf(this.selectedFeatures,t.target)&&this._collectEditMarkers(t.target)},_onResetEditMarkersValues:function(t){this._resetEditMarkersValue(t.target)},_onMapClick:function(t){if(!1!==this._onTriggerMapClick){if(this._startPoint&&this._endPoint)return this._startPoint=null,void(this._endPoint=null);this.unselectFeatures(),L.DomEvent.stopPropagation(t)}else this._onTriggerMapClick=!0},_onClick:function(t){this._onTriggerMapClick=!1;var e,o,s=t.target;if(s.isSelected&&s.symbolType===SuperMap.Plot.SymbolType.SATELLITE&&s.timeWindows.length>0){var r=s.layer._getFeatureFromEvent(t);r.symbolType===SuperMap.Plot.SymbolType.SATELLITETIMEWINDOWS&&(s=r)}if(this.transaction||(this.transaction=new SuperMap.Plot.Transaction,this.transaction.transType=SuperMap.Plot.TransactionType.EDIT,this.isAddTransInfo=!0),s instanceof i.PlottingObject)if(s instanceof l.GroupObject&&s.moveend)s.moveend=!1;else if(null!==s.ownerGroup&&s.ownerGroup.moveend)s.ownerGroup.moveend=!1;else if(this._editMode!==SuperMap.Plot.EditMode.ADDCONTROLPOINT)s instanceof l.GroupObject&&!s.isSelected?(!1===t.originalEvent.ctrlKey&&this.unselectFeatures(),this.selectFeatures(s)):s instanceof n.Route||s.isSelected||null!==s.ownerGroup&&!0!==s.ownerGroup.isSelected||(!1===t.originalEvent.ctrlKey&&this.unselectFeatures(),this.selectFeatures(s));else if(s instanceof n.Route||s.isSelected){if(!1===s.isLocked&&s.isSelected)if(s instanceof n.Route){var u=this._getAddPointTolerance();if(null===(P=s._selectNodeLayer(t.latlng,u))){var p=this._getAddPointTolerance(),h=s._addRouteNodeByPosWithoutLast(t.latlng,p);null!==h&&(this.unselectFeatures(),this.selectFeatures(h))}}else if(s instanceof a.GeoRouteNode&&s.route.isSelected){var c=s._isFirstNode(),g=s._isLastNode();if(!0===c||!0===g){var y=s.route._addRouteNodeByNode(s.routeNode,c,g);if(null!==y){this.unselectFeatures(),this.selectFeatures(y);var f=new SuperMap.Plot.TransactionInfo;f.layerId=y.layer._leaflet_id,f.uuid=y.uuid,f.functionName="setLatLngs",f.undoParams=[L.Util.cloneLatLngs(y.getLatLngs())],f.redoParams=[L.Util.cloneLatLngs(y.getLatLngs())],this.transaction.transInfos.push(f),this.transaction&&(L.supermap.plotting.getControl().getTransManager().add(this.transaction),this.transaction=new SuperMap.Plot.Transaction,this.isAddTransInfo=!0)}}else this.unselectFeatures(),this.selectFeatures(s)}else this._addPoint(s,t.latlng)}else if(!1===t.originalEvent.ctrlKey&&this.unselectFeatures(),this.selectFeatures(s),s instanceof a.GeoRouteNode&&((e=s._isFirstNode())||(o=s._isLastNode()))){var P=s.route._addRouteNodeByNode(s.routeNode,e,o);null!==P&&(this.unselectFeatures(),this.selectFeatures(P))}},_addPoint:function(t,e){if(null!==t&&void 0!==t){var o=t.scaleValues.slice(),i=L.Util.cloneLatLngs(t.getLatLngs()),l=L.Util.latLngsToSuperMapPoints(t.getLatLngs());if(t.symbolType===SuperMap.Plot.SymbolType.ANNOFRAMESYMBOLM){var n=L.supermap.plotting.editMarker(e,{icon:this.options.scaleIcon,nHandle:-2,tag:t.scalePoints.length});n.owner=t,this._addToMapAndBindMarker(n),this._editMarkers[t.uuid].push(n),t.scalePoints.push(e),t._modifyPoint(t.scalePoints.length-1,e);var a=new SuperMap.Plot.TransactionInfo;a.layerId=t.layer._leaflet_id,a.uuid=t.uuid,a.functionName="setScaleValues",a.undoParams=[o],a.redoParams=[t.scaleValues],this.transaction.transInfos.push(a),this.transaction&&(L.supermap.plotting.getControl().getTransManager().add(this.transaction),this.transaction=new SuperMap.Plot.Transaction,this.isAddTransInfo=!0)}else{if(t.getLatLngs().length>=t.maxEditPts)return;var s=t._getSymbolWayType();if(void 0!==SuperMap.Plot.AlgoSymbolFactory&&SuperMap.Plot.AlgoSymbolFactory.canPolylineConnect(t.libID,t.code)&&!0===t.polylineConnectLocationPoint&&(s=SuperMap.Plot.AddPoint_WayType.POLYLINE),SuperMap.Plot.AddPoint_WayType.UNKNOWN===s)return;var r=new SuperMap.Geometry.Point(e.lng,e.lat),u=-1;SuperMap.Plot.AddPoint_WayType.CURVE===s&&(u=this._addPointByCurve(t,r));var p=new SuperMap.Plot.Transaction;if(L.supermap.plotting.getControl().getTransManager().add(p),SuperMap.Plot.AddPoint_WayType.POLYLINE===s&&(u=this._addPointByPolyLine(t,r)),l=L.Util.latLngsToSuperMapPoints(t.getLatLngs()),u>0&&u<l.length){var h=L.supermap.plotting.editMarker(new L.LatLng(r.y,r.x),{icon:this.options.editIcon,nHandle:-1});if(h.owner=t,this._addToMapAndBindMarker(h),this._editMarkers[t.uuid].splice(u,0,h),l.splice(u,0,r),0===t.libID&&590===t.code||100===t.libID&&(17703===t.code||17704===t.code)){var c=SuperMap.Plot.PlottingUtil.computeBeizerPoints(!1,l,t.scaleValues);t.scalePoints=L.Util.superMapPointsToLatLngs(c.scalePoints),t.scaleValues=c.scaleValues,t.setLatLngs(L.Util.superMapPointsToLatLngs(l)),this._resetEditMarkersValue(t)}else t.latLngs=L.Util.superMapPointsToLatLngs(l);var g=new SuperMap.Plot.TransactionInfo;g.layerId=t.layer._leaflet_id,g.uuid=t.uuid,g.functionName="setLatLngs",g.undoParams=[i],g.redoParams=[t.getLatLngs()],p.transInfos.push(g)}}}},_addPointByCurve:function(t,e){var o=L.Util.latLngsToSuperMapPoints(t.getLatLngs()),i=SuperMap.Plot.PlottingUtil.generateBeizerPointsNoCtrlPt(o);if(2>i.length)return-1;for(var l=[],n=0,a=1,s=o.length;a<s;a++)for(var r=[],u=n,p=i.length;u<p;u++){if(SuperMap.Plot.PlottingUtil.equalFuzzy(o[a].x,i[u].x)&&SuperMap.Plot.PlottingUtil.equalFuzzy(o[a].y,i[u].y)){if(r.length<1)continue;r.push(i[u]),l.push(r),r=[],n=u;break}r.push(i[u])}for(var h=-1,c=-1,g=0;g<l.length;g++){var y=this._computePointToLineMinDis(e,l[g]).minDis;y<0||(c<0?(c=y,h=g+1):c>y&&(c=y,h=g+1))}var f=o.slice();f.push(f[0]);for(var P=SuperMap.Plot.PlottingUtil.generateBeizerPointsNoCtrlPt(f),d=[],S=1,m=f.length;S<m;S++)for(var b=[],v=n,M=P.length;v<M;v++){if(SuperMap.Plot.PlottingUtil.equalFuzzy(f[S].x,P[v].x)&&SuperMap.Plot.PlottingUtil.equalFuzzy(f[S].y,P[v].y)){if(r.length<1)continue;b.push(P[v]),d.push(b),b=[],index1=v;break}b.push(P[v])}for(var A=-1,T=-1,_=0;_<d.length;_++){var O=this._computePointToLineMinDis(e,d[_]).minDis;O<0||(T<0?(T=O,A=_+1):T>O&&(T=O,A=_+1))}return A>h&&(h=-1),h},_addPointByPolyLine:function(t,e){var o=-1,i=L.Util.latLngsToSuperMapPoints(t.getLatLngs());return(o=this._computePointToLineMinDis(e,i).index)>=0&&o++,o},_computePointToLineMinDis:function(t,e){var o=this._getAddPointTolerance(),i=SuperMap.Plot.PlottingUtil.computePointToLineMinDis(t,e);return i.minDis>o&&(i.index=-1),i},_getAddPointTolerance:function(){var t=this._mouseTolerance;L.Browser.touch&&L.supermap.plotting.getControl().getTouchMode()&&(t=this.touchTolerance);var e=this._map.layerPointToLatLng(L.point(0,0)),o=this._map.layerPointToLatLng(L.point(t,0));return SuperMap.Plot.PlottingUtil.distance(new SuperMap.Geometry.Point(e.lng,e.lat),new SuperMap.Geometry.Point(o.lng,o.lat))},_collectEditMarkers:function(t){void 0!==this._editMarkers[t.uuid]&&this._removeMarkers(t);var e,o=[];if(t.layer instanceof r.PlottingLayer&&(t.layer.getLocked()||!t.layer.getEditable())){var i=t.getBounds();if(null!==i&&i.isValid()){var n=L.latLng(i.getNorth(),i.getEast()),u=L.latLng(i.getNorth(),i.getWest()),p=L.latLng(i.getSouth(),i.getEast()),h=L.latLng(i.getSouth(),i.getWest()),c=new L.Polygon([n,u,h,p],{smoothFactor:.5});L.setOptions(c,{weight:1,opacity:.5,color:"#0000ff",fillOpacity:.3,fillColor:"#0000ff"}),this._map.addLayer(c),e=c}}else if(t.getLocked()){var g=t._getHandlePointsByBounds();for(var y in g){var f=new L.LatLng(g[y].lat,g[y].lng),P=L.supermap.plotting.editMarker(f,{icon:this.options.lockedIcon,nHandle:-3});this._addToMapAndBindMarker(P),P.owner=t,o.push(P)}}else if(t instanceof l.GroupObject||t instanceof a.GeoRouteNode)if(t instanceof s.FlagGroup&&this._editMode!==SuperMap.Plot.EditMode.EDITCIRCUMRECTANGLE)for(var d=0;d<t.scalePoints.length;d++){var S=new L.LatLng(t.scalePoints[d].lat,t.scalePoints[d].lng),m=t.scalePoints[d].tag?t.scalePoints[d].tag:d,b=L.supermap.plotting.editMarker(S,{icon:this.options.scaleIcon,nHandle:t.enableEdit?-2:-3,tag:m});this._addToMapAndBindMarker(b),o.push(b),b.owner=t}else{var v=t._getHandleAndRotatePoints();for(var M in v.handlePoints){var A=v.handlePoints[M].nHandle;(this._editMode!==SuperMap.Plot.EditMode.EDITCIRCUMRECTANGLE||t instanceof a.GeoRouteNode)&&(A=-3);var T=new L.LatLng(v.handlePoints[M].lat,v.handlePoints[M].lng),_=L.supermap.plotting.editMarker(T,{icon:this.options.editIcon,nHandle:A,tag:M});this._addToMapAndBindMarker(_),_.owner=t,o.push(_)}if(this._editMode===SuperMap.Plot.EditMode.EDITCIRCUMRECTANGLE)for(var O in v.rotatePoints){var x=new L.LatLng(v.rotatePoints[O].lat,v.rotatePoints[O].lng),w=L.supermap.plotting.editMarker(x,{icon:this.options.rotateIcon,nHandle:0});this._addToMapAndBindMarker(w),o.push(w),w.owner=t}}else if(this._editMode===SuperMap.Plot.EditMode.EDITCIRCUMRECTANGLE){for(var E=t._getHandleAndRotatePoints(),C=0,I=E.handlePoints.length;C<I;C++){var D=E.handlePoints[C].nHandle;t.enableEdit&&t.symbolType!==SuperMap.Plot.SymbolType.TEXTSYMBOL?t._getHandleCount()>9&&(D=-1):D=-3;var R=new L.LatLng(E.handlePoints[C].lat,E.handlePoints[C].lng),N=L.supermap.plotting.editMarker(R,{icon:this.options.editIcon,nHandle:D,tag:C});this._addToMapAndBindMarker(N),N.owner=t,o.push(N)}for(var U=0,B=E.rotatePoints.length;U<B;U++){var k=new L.LatLng(E.rotatePoints[U].lat,E.rotatePoints[U].lng),F=L.supermap.plotting.editMarker(k,{icon:this.options.rotateIcon,nHandle:t.enableEdit?0:-3});this._addToMapAndBindMarker(F),o.push(F),F.owner=t}}else if(t.symbolType===SuperMap.Plot.SymbolType.REGULARPOLYGON){var G=[t.latLngs[0],t.components[0].getLatLngs()[0][0]];for(var V in G){var j=L.supermap.plotting.editMarker(G[V],{icon:this.options.editIcon,nHandle:t.enableEdit?-1:-3,tag:V});this._addToMapAndBindMarker(j),o.push(j),j.owner=t}for(var Y in t.scalePoints){var z=new L.LatLng(t.scalePoints[Y].lat,t.scalePoints[Y].lng),W=t.scalePoints[Y].tag?t.scalePoints[Y].tag:Y,X=L.supermap.plotting.editMarker(z,{icon:this.options.scaleIcon,nHandle:t.enableEdit?-2:-3,tag:W});this._addToMapAndBindMarker(X),o.push(X),X.owner=t}}else if(t.symbolType===SuperMap.Plot.SymbolType.PARALLELLINE){var H=L.Util.superMapPointsToLatLngs(t.superMapAlgoSymbol.controlPoints[0]);for(var Z in t.getLatLngs()[0]=L.latLng(H[0].lat,H[0].lng),t.latLngs){var J=new L.LatLng(t.latLngs[Z].lat,t.latLngs[Z].lng),q=L.supermap.plotting.editMarker(J,{icon:this.options.editIcon,nHandle:t.enableEdit?-1:-3,tag:Z});this._addToMapAndBindMarker(q),o.push(q),q.owner=t}}else if(t.symbolType===SuperMap.Plot.SymbolType.NEWPIESYMBOL||t.symbolType===SuperMap.Plot.SymbolType.NEWCHORDSYMBOL||t.symbolType===SuperMap.Plot.SymbolType.NEWARCSYMBOL){for(var K=0;K<t.latLngs.length;K++){var Q={};if(2===K){var $=t.components[0]._latlngs;Q=$.length>1?new L.LatLng($[1].lat,$[1].lng):new L.LatLng($[0][1].lat,$[0][1].lng)}else Q=new L.LatLng(t.latLngs[K].lat,t.latLngs[K].lng);var tt=L.supermap.plotting.editMarker(Q,{icon:this.options.editIcon,nHandle:t.enableEdit?-1:-3,tag:K});this._addToMapAndBindMarker(tt),o.push(tt),tt.owner=t}for(var et in t.scalePoints){var ot=new L.LatLng(t.scalePoints[et].lat,t.scalePoints[et].lng),it=t.scalePoints[et].tag?t.scalePoints[et].tag:et,lt=L.supermap.plotting.editMarker(ot,{icon:this.options.scaleIcon,nHandle:t.enableEdit?-2:-3,tag:it});this._addToMapAndBindMarker(lt),o.push(lt),lt.owner=t}}else if(t.symbolType!==SuperMap.Plot.SymbolType.SATELLITE){for(var nt in t.latLngs){var at=new L.LatLng(t.latLngs[nt].lat,t.latLngs[nt].lng),st=L.supermap.plotting.editMarker(at,{icon:this.options.editIcon,nHandle:t.enableEdit?-1:-3,tag:nt});this._addToMapAndBindMarker(st),o.push(st),st.owner=t}for(var rt in t.scalePoints){var ut=new L.LatLng(t.scalePoints[rt].lat,t.scalePoints[rt].lng),pt=t.scalePoints[rt].tag?t.scalePoints[rt].tag:rt,ht=L.supermap.plotting.editMarker(ut,{icon:this.options.scaleIcon,nHandle:t.enableEdit?-2:-3,tag:pt});this._addToMapAndBindMarker(ht),o.push(ht),ht.owner=t}}else if(t.symbolType===SuperMap.Plot.SymbolType.SATELLITE||t.timeWindows.length>1)for(var ct in t.scalePoints){var gt=new L.LatLng(t.scalePoints[ct].lat,t.scalePoints[ct].lng),yt=t.scalePoints[ct].tag?t.scalePoints[ct].tag:ct,ft=L.supermap.plotting.editMarker(gt,{icon:this.options.scaleIcon,nHandle:t.enableEdit?-2:-3,tag:yt});this._addToMapAndBindMarker(ft),o.push(ft),ft.owner=t}this._editMarkers[t.uuid]=o,this._disEditBox[t.uuid]=e},_resetEditMarkersValue:function(t){if(this._editMarkers.hasOwnProperty(t.uuid)){var e=this._editMarkers[t.uuid],o=this._disEditBox[t.uuid];if(null==o||!t.layer.getLocked()&&t.layer.getEditable())if(t instanceof l.GroupObject||t instanceof a.GeoRouteNode)if(t instanceof s.FlagGroup&&this._editMode!==SuperMap.Plot.EditMode.EDITCIRCUMRECTANGLE)for(var i in t.scalePoints)e[i]._latlng=t.scalePoints[i],e[i].update();else{var n=t._getHandleAndRotatePoints();for(var r in n.handlePoints)e[r]._latlng=n.handlePoints[r],e[r].update();if(this._editMode===SuperMap.Plot.EditMode.EDITCIRCUMRECTANGLE){var u=n.handlePoints.length;for(var p in n.rotatePoints)e[u+parseInt(p)]._latlng=n.rotatePoints[p],e[u+parseInt(p)].update()}}else if(this._editMode===SuperMap.Plot.EditMode.EDITCIRCUMRECTANGLE){var h=t._getHandleAndRotatePoints();for(var c in h.handlePoints)e[c]._latlng=h.handlePoints[c],e[c].update();var g=h.handlePoints.length;for(var y in h.rotatePoints)e[g+parseInt(y)]._latlng=h.rotatePoints[y],e[g+parseInt(y)].update()}else if(void 0!==t.scalePoints&&null!==t.scalePoints||(t.scalePoints=[]),t.symbolType===SuperMap.Plot.SymbolType.REGULARPOLYGON){var f=[t.getLatLngs()[0],t.components[0].getLatLngs()[0][0]];for(var P in f)e[P]._latlng=f[P],e[P].update()}else if(t.symbolType===SuperMap.Plot.SymbolType.PARALLELLINE){var d=L.Util.superMapPointsToLatLngs(t.superMapAlgoSymbol.controlPoints[0]);for(var S in t.getLatLngs()[0]=L.latLng(d[0].lat,d[0].lng),t.getLatLngs())e[S]._latlng=t.getLatLngs()[S],e[S].update()}else if(t.symbolType===SuperMap.Plot.SymbolType.SATELLITE||t.timeWindows&&t.timeWindows.length>1)for(var m in t.scalePoints){var b=parseInt(m);e[b]._latlng=t.scalePoints[m],e[b].update()}else if(t.getLatLngs().length+t.scalePoints.length===e.length){for(var v in t.getLatLngs())e[v]._latlng=t.getLatLngs()[v],e[v].update();var M=t.getLatLngs().length;for(var A in t.scalePoints){var T=M+parseInt(A);e[T]._latlng=t.scalePoints[A],e[T].update()}}else this._collectEditMarkers(t);else{var _=t.getBounds();if(null!==_&&_.isValid()){var O=L.latLng(_.getNorth(),_.getEast()),x=L.latLng(_.getNorth(),_.getWest()),w=L.latLng(_.getSouth(),_.getEast()),E=L.latLng(_.getSouth(),_.getWest());o.setLatLngs([O,x,E,w])}}}},_removeMarkers:function(t){var e=this._editMarkers[t.uuid];for(var o in e)this._unbindMarkerEvents(e[o]),this._map.removeLayer(e[o]);delete this._editMarkers[t.uuid];var i=this._disEditBox[t.uuid];i&&this._map.removeLayer(i),delete this._disEditBox[t.uuid]},_unbindMarkerEvents:function(t){t.off("mousemove",this._moveMove,this),t.off("mouseout",this._moveOut,this),-3!==t.options.nHandle&&(t.off("click",this._removePoint,this),t.off("dragstart",this._dragStart,this),t.off("drag",this.redraw,this),t.off("dragend",this._dragEnd,this),t.dragging.disable())},_addToMapAndBindMarker:function(t){t.addTo(this._map),t.on("mousemove",this._moveMove,this),t.on("mouseout",this._moveOut,this),-3!==t.options.nHandle&&(t.on("click",this._removePoint,this),t.on("dragstart",this._dragStart,this),t.on("drag",this._dragPoint,this),t.on("dragend",this._dragEnd,this),t.dragging.enable()),-3===t.options.nHandle&&(t.on("dragstart",this._dragStart,this),t.on("dragend",this._dragEnd,this),t.dragging.enable())},_moveMove:function(t){switch(t.target.options.nHandle){case 1:case 8:t.target._icon.style.cursor="se-resize";break;case 3:case 6:t.target._icon.style.cursor="ne-resize";break;case 4:case 5:t.target._icon.style.cursor="e-resize";break;case 2:case 7:t.target._icon.style.cursor="n-resize";break;case-1:case-2:t.target._icon.style.cursor="pointer";break;case 0:t.target._icon.style.cursor="default"}},_moveOut:function(t){t.target._icon.style.cursor=""},_removePoint:function(t){if(this._editMode===SuperMap.Plot.EditMode.ADDCONTROLPOINT&&t.target.owner.isSelected){var e=L.Util.cloneLatLngs(t.target.owner.getLatLngs()),o=this._editMarkers[t.target.owner.uuid],i=o.indexOf(t.target);this._map.removeLayer(o[i]),o.splice(i,1),t.target.owner.latLngs.splice(i,1),t.target.owner.redraw();var l=new SuperMap.Plot.Transaction;L.supermap.plotting.getControl().getTransManager().add(l);var n=new SuperMap.Plot.TransactionInfo;n.layerId=t.target.owner.layer._leaflet_id,n.uuid=t.target.owner.layer.uuid,n.functionName="setLatLngs",n.undoParams=[e],n.redoParams=[t.target.owner.getLatLngs()],l.transInfos.push(n)}else if(this._editMode===SuperMap.Plot.EditMode.REMOVECONTROLPOINT&&t.target.owner.isSelected){var a=this._editMarkers[t.target.owner.uuid],s=a.indexOf(t.target),r=L.Util.cloneLatLngs(t.target.owner.getLatLngs());if(t.target.owner.getLatLngs().length<=t.target.owner.minEditPts)return this._editMode=SuperMap.Plot.EditMode.EDITCIRCUMRECTANGLE,void this._collectEditMarkers(t.target.owner);this._map.removeLayer(a[s]),a.splice(s,1),t.target.owner.latLngs.splice(s,1),t.target.owner.redraw();var u=new SuperMap.Plot.Transaction;L.supermap.plotting.getControl().getTransManager().add(u);var p=new SuperMap.Plot.TransactionInfo;p.layerId=t.target.owner.layer._leaflet_id,p.uuid=t.target.owner.uuid,p.functionName="setLatLngs",p.undoParams=[r],p.redoParams=[t.target.owner.getLatLngs()],u.transInfos.push(p)}},_dragStart:function(t){for(var e in this.transaction||(this.transaction=new SuperMap.Plot.Transaction,this.transaction.transType=SuperMap.Plot.TransactionType.EDIT,this.isAddTransInfo=!0),this.selectedFeatures){var o=this.selectedFeatures[e];if(o._isDot()&&(this._dragStartScale[o.uuid]=o.getScale()),o.scaleValues&&o.scaleValues.length&&0!==o.scaleValues.length){this._dragStartScaleValues[o.uuid]=[];for(var i=0;i<o.scaleValues.length;i++)this._dragStartScaleValues[o.uuid].push(o.scaleValues[i])}else this._dragStartScaleValues[o.uuid]=[];if(o.scalePoints&&o.scalePoints.length&&0!==o.scalePoints.length&&(this._dragStartScalePoints[o.uuid]=L.Util.cloneLatLngs(o.scalePoints)),this._dragStartRotate[o.uuid]=o.getRotate(),this.selectedFeatures[e]instanceof l.GroupObject?this._dragStartLatLngs[o.uuid]=this._editMarkers[this.selectedFeatures[e].uuid]:this._dragStartLatLngs[o.uuid]=L.Util.cloneLatLngs(o.getLatLngs()),o.symbolType===SuperMap.Plot.SymbolType.ARCREGION&&1===this._dragStartLatLngs[o.uuid].length&&this._dragStartLatLngs[o.uuid].push(o.scalePoints[0].clone()),o.symbolType===SuperMap.Plot.SymbolType.LINERELATION&&(null!==o.endAssociatedUuid?this._dragStartLatLngs[o.uuid].push(o.startAssociatedUuid):null!==o.endAssociatedUuid&&this._dragStartLatLngs[o.uuid].push(o.endAssociatedUuid)),this._dragStartBounds[o.uuid]=o.getBounds(),o.symbolType===SuperMap.Plot.SymbolType.FLAGGROUP)o.anchorPoint=L.latLng(o.getBounds().getSouth(),o.getBounds().getWest());else if(o.symbolType===SuperMap.Plot.SymbolType.TEXTSYMBOL)o.anchorPoint=L.latLng(o.getLatLngs()[0].lat,o.getLatLngs()[0].lng);else if(o.symbolType===SuperMap.Plot.SymbolType.CONCENTRICCIRCLE)o.anchorPoint=L.latLng(o.getLatLngs()[0].lat,o.getLatLngs()[0].lng);else if(o.symbolType!==SuperMap.Plot.SymbolType.DOTSYMBOL){var n=o.getBounds();n.isValid()&&(o.anchorPoint=n.getCenter())}var a=this._editMarkers[o.uuid];for(var s in a)-3===a[s].options.nHandle&&a[s].setOpacity(0),a[s].setOpacity(0)}this.transaction||(this.transaction=new SuperMap.Plot.Transaction,this.transaction.transType=SuperMap.Plot.TransactionType.EDIT,this.isAddTransInfo=!0),this.oldLatLng=t.target._latlng,this._lastPixel=this._map.latLngToLayerPoint(t.target._latlng)},_dragEnd:function(){for(var t=0;t<this.selectedFeatures.length;t++)this._collectEditMarkers(this.selectedFeatures[t]),this.selectedFeatures[t].graphic&&this.selectedFeatures[t].graphic.updateImage();this.fire(SuperMap.Plot.Event.featuresmodified,{features:this.selectedFeatures}),this._saveHistoryInfomation(),this.transaction&&0!==this.transaction.transInfos.length&&(L.supermap.plotting.getControl().getTransManager().add(this.transaction),this.transaction=new SuperMap.Plot.Transaction,this.isAddTransInfo=!0)},_dragPoint:function(t){if(!1!==this.fire(SuperMap.Plot.Event.beforefeaturesmodified,{features:this.selectedFeatures})){var e=t.target.owner;-3===t.target.options.nHandle||this._avoidRegionControl?this._avoidRegionControl&&this._collectEditMarkers(e):this._editMode===SuperMap.Plot.EditMode.EDITCIRCUMRECTANGLE&&0===t.target.options.nHandle?this._dragRotate(t):this._editMode===SuperMap.Plot.EditMode.EDITCIRCUMRECTANGLE&&t.target.options.nHandle>0?this._dragResize(t,t.target.options.nHandle):this._dragLatLngs(t),this.fire(SuperMap.Plot.Event.featuresmodified,{features:this.selectedFeatures})}},_dragRotate:function(t){var e=this;var o=t.target.owner,i=null;i=o.symbolType===SuperMap.Plot.SymbolType.DOTSYMBOL||o.symbolType===SuperMap.Plot.SymbolType.CONCENTRICCIRCLE?o.getLatLngs()[0]:o.anchorPoint;var l=this._map.latLngToLayerPoint(i);o.symbolType===SuperMap.Plot.SymbolType.DOTSYMBOL&&!0===o.positionOffset&&(l.x+=o.positionOffsetX*o.dScale,l.y+=o.positionOffsetY*o.dScale);var n=this._map.latLngToLayerPoint(t.latlng),a=this._map.latLngToLayerPoint(t.oldLatLng),s=n.x-l.x-(a.x-l.x),r=n.y-l.y-(a.y-l.y);if(0!==s&&0!==r){var u=180*(Math.atan2(a.y-l.y,a.x-l.x)-Math.atan2(n.y-l.y,n.x-l.x))/Math.PI,p=u;if(void 0!==this._lastPixel)p=180*(Math.atan2(this._lastPixel.y-l.y,this._lastPixel.x-l.x)-Math.atan2(n.y-l.y,n.x-l.x))/Math.PI;!function(t,o){for(var i=0;i<e.selectedFeatures.length;i++){var l=0;if(l=e.selectedFeatures[i].symbolType===SuperMap.Plot.SymbolType.DOTSYMBOL?t+e._dragStartRotate[e.selectedFeatures[i].uuid]:o,(l%=360)<0&&(l+=360),e.selectedFeatures[i].setRotate(l),e.isAddTransInfo){var n=new SuperMap.Plot.TransactionInfo;n.layerId=e.selectedFeatures[i].layer._leaflet_id,n.uuid=e.selectedFeatures[i].uuid,n.functionName="setRotate",e.transaction.transInfos.push(n)}}e.isAddTransInfo=!1}(u,p)}this._lastPixel=n},_dragResize:function(t,e){var o=this;function i(t,i,n){for(var a=[],s=0;s<o.selectedFeatures.length;s++)if(!0!==o.selectedFeatures[s].getLocked())if(o.selectedFeatures[s]._isDot()){var r=o._dragStartScale[o.selectedFeatures[s].uuid];if(o.selectedFeatures[s].symbolType===SuperMap.Plot.SymbolType.DOTSYMBOL&&!1===o.selectedFeatures[s].limitWidthHeight)r.x=0===r.x?.05:r.x,r.y=0===r.y?.05:r.y,o.selectedFeatures[s].setScale(t*r.x,i*r.y);else{var u=t*(r=!0===Boolean(r)?r:1);u>0&&o.selectedFeatures[s].setScale(u)}if(o.isAddTransInfo){var p=new SuperMap.Plot.TransactionInfo;p.layerId=o.selectedFeatures[s].layer._leaflet_id,p.uuid=o.selectedFeatures[s].uuid,p.functionName="setScale",o.transaction.transInfos.push(p)}}else{if(9===o.selectedFeatures[s]._getHandleCount()&&e&&e>0){var h=o._dragStartBounds[o.selectedFeatures[s].uuid],c=o._dragStartLatLngs[o.selectedFeatures[s].uuid],g=o.selectedFeatures[s]._getLatLng(e,h,n);o.selectedFeatures[s]._resizeLatLngs(g,e,h,c)}if(SuperMap.Plot.AlgoSymbolFactory.isAccessServer(o.selectedFeatures[s].libID,o.selectedFeatures[s].code)){var y=new SuperMap.GetSymbolInfoParameters;y.libID=o.selectedFeatures[s].libID,y.code=o.selectedFeatures[s].code,y.inputPoints=L.Util.latLngsToSuperMapPoints(o.selectedFeatures[s].getLatLngs()),y.scaleValues=o.selectedFeatures[s].scaleValues,y.subSymbols=o.selectedFeatures[s].subSymbols,a.push(o.selectedFeatures[s]),L.supermap.symbolInfoService(l.serverUrl,l.serviceParams).getSymbolInfo(y,function(t){for(var e=0;e<a.length;e++)a[e].libID===t.result.libID&&a[e].code===t.result.code&&(a[e].symbolData.innerCells=t.result.innerCells,a[e].symbolData.scalePoints=t.result.scalePoints,a[e].symbolData.scaleValues=t.result.scaleValues,a[e].redraw(),a[e]._updateSymbolTexts(),a.splice(0,1))},this)}else if(o.selectedFeatures[s].redraw(),o.selectedFeatures[s]._updateSymbolTexts(),o.selectedFeatures[s].symbolType===SuperMap.Plot.SymbolType.ANNOFRAMESYMBOL&&o.selectedFeatures[s].ownerGroup&&(o.selectedFeatures[s].ownerGroup.symbolType===SuperMap.Plot.SymbolType.NAVYDEPLOYMENT||o.selectedFeatures[s].ownerGroup.symbolType===SuperMap.Plot.SymbolType.AIRDEPLOYMENT))for(var f in o.selectedFeatures[s].ownerGroup.subObjects)o.selectedFeatures[s].ownerGroup.subObjects[f].redraw();if(o.isAddTransInfo){var P=new SuperMap.Plot.TransactionInfo;P.layerId=o.selectedFeatures[s].layer._leaflet_id,P.uuid=o.selectedFeatures[s].uuid,P.functionName="setLatLngs",o.transaction.transInfos.push(P)}}}var l=t.target.owner,n=this._dragStartBounds[l.uuid],a=n.getEast()-n.getWest(),s=n.getNorth()-n.getSouth(),r=l._resizeOffset(t.latlng,e,n);!0===t.originalEvent.altKey&&(0===r.lng&&0!==r.lat?r.lng=r.lat*a/s:0===r.lat&&0!==r.lng?r.lat=r.lng*s/a:Math.abs(r.lng)<Math.abs(r.lat)?r.lng<0&&r.lat>0||r.lng>0&&r.lat<0?r.lng=r.lat*a/s*-1:r.lng=r.lat*a/s:r.lat<0&&r.lng>0||r.lat>0&&r.lng<0?r.lat=r.lng*s/a*-1:r.lat=r.lng*s/a);var u=1,p=l._resizeBounds(t.latlng,e,n),h=!0===Boolean(a)?(p.getEast()-p.getWest())/a:.5,c=!0===Boolean(s)?(p.getNorth()-p.getSouth())/s:.5;u=2===e||7===e?c:4===e||5===e?h:h<c?h:c,l.symbolType===SuperMap.Plot.SymbolType.DOTSYMBOL&&!1===l.limitWidthHeight?i(h,c,r):i(u,null,r),this.oldLatLng=t.latlng},_dragLatLngs:function(t){var e=t.target.owner,o=this._editMarkers[e.uuid],i=SuperMap.Util.indexOf(o,t.target),l=!1;if(-2===t.target.options.nHandle&&(l=!0),this.transaction||(this.transaction=new SuperMap.Plot.Transaction,this.transaction.transType=SuperMap.Plot.TransactionType.EDIT,this.isAddTransInfo=!0),SuperMap.Plot.AlgoSymbolFactory.isAccessServer(e.libID,e.code)){var n=(new Date).getTime(),a=this._map.latLngToLayerPoint(t.latlng);if(l&&void 0!==this._lastDragPixel&&null!==this._lastDragPixel&&!((Math.abs(a.x-this._lastDragPixel.x)>3||Math.abs(a.y-this._lastDragPixel.y)>3)&&n-this.lastDownTime>100))return;var s=new SuperMap.GetSymbolInfoParameters;s.libID=e.libID,s.code=e.code,l?(s.inputPoints=L.Util.latLngsToSuperMapPoints(e.getLatLngs()),s.scalePoints=L.Util.latLngsToSuperMapPoints(e.scalePoints),s.scaleValues=e.scaleValues,s.newScalePoint=new SuperMap.Geometry.Point(t.latlng.lng,t.latlng.lat),s.newScalePointIndex=parseInt(t.target.options.tag)):(e.getLatLngs()[i]=t.target.getLatLng(),s.inputPoints=L.Util.latLngsToSuperMapPoints(e.getLatLngs()),s.scaleValues=e.scaleValues),s.subSymbols=e.subSymbols,L.supermap.symbolInfoService(e.serverUrl,e.serviceParams).getSymbolInfo(s,function(t){e.symbolData.innerCells=t.result.innerCells,e.symbolData.scalePoints=t.result.scalePoints,e.symbolData.scaleValues=t.result.scaleValues,e.redraw(),e._updateSymbolTexts(),this._resetEditMarkersValue(e)},this),this._lastDragPixel=a,this.lastDownTime=(new Date).getTime()}else if(-1===t.target.options.nHandle){if(e.symbolType===SuperMap.Plot.SymbolType.REGULARPOLYGON)1===i?e.getLatLngs()[e.getLatLngs().length-1]=t.latlng:e.getLatLngs()[0]=t.latlng;else if(e.symbolType===SuperMap.Plot.SymbolType.ELLIPSESYMBOL)e.getLatLngs()[i]=t.latlng;else if(e.symbolType===SuperMap.Plot.SymbolType.DOTSYMBOL){if(!0===e.positionOffset?e.setLatLngs(t.latlng):e.setLatLngs(e.latLngs[0]),this.isAddTransInfo){var r=new SuperMap.Plot.TransactionInfo;r.layerId=e.layer._leaflet_id,r.uuid=e.uuid,r.functionName="setLatLngs",this.transaction.transInfos.push(r)}}else e.getLatLngs()[i]=t.latlng;if(e.symbolType===SuperMap.Plot.SymbolType.LINERELATION||e.symbolType===SuperMap.Plot.SymbolType.SYMBOLTEXT||e.symbolType===SuperMap.Plot.SymbolType.SYMBOLTEXT1||e.symbolType===SuperMap.Plot.SymbolType.ELLIPSESYMBOL)e._modifyPoint(parseInt(t.target.options.tag),t.latlng);else if(e.redraw(),e.symbolType===SuperMap.Plot.SymbolType.ANNOFRAMESYMBOL&&e.ownerGroup&&(e.ownerGroup.symbolType===SuperMap.Plot.SymbolType.NAVYDEPLOYMENT||e.ownerGroup.symbolType===SuperMap.Plot.SymbolType.AIRDEPLOYMENT))for(var u in e.ownerGroup.subObjects)e.ownerGroup.subObjects[u].redraw();e._updateSymbolTexts(),this._resetEditMarkersValue(e)}else if(-2===t.target.options.nHandle){var p=t.target.getLatLng();if(p.isScalePoint=!0,e._modifyPoint(parseInt(t.target.options.tag),p),e.symbolType===SuperMap.Plot.SymbolType.FLAGGROUP)for(var h=0,c=e.components.length;h<c;h++)e.components[h]._updateSymbolTexts();else e._updateSymbolTexts();this._resetEditMarkersValue(e)}if(this.isAddTransInfo){var g=new SuperMap.Plot.TransactionInfo;g.layerId=e.layer._leaflet_id,g.uuid=e.uuid,g.functionName="setLatLngs",-2===t.target.options.nHandle&&(g.functionName="setScaleValues",e.symbolType!==SuperMap.Plot.SymbolType.ARCREGION&&e.symbolType!==SuperMap.Plot.SymbolType.FLAGGROUP||(g.functionName="modifyPoint",g.undoParams=[parseInt(t.target.options.tag)],g.redoParams=[parseInt(t.target.options.tag)])),this.transaction.transInfos.push(g)}this.isAddTransInfo=!1},_pasteToPosition:function(){if(this.pasteGeoAry&&0!==this.pasteGeoAry.length){var t=new SuperMap.Plot.Transaction;t.transType=SuperMap.Plot.TransactionType.CREATE,L.supermap.plotting.getControl().getTransManager().add(t);var e=function(t,e,o,i){var l=new SuperMap.Plot.TransactionInfo;l.layerId=t,l.uuid=e,l.feature=o,i.transInfos.push(l)},o=null,a=null,s=this.pasteGeoAry.slice();if(0!==arguments.length){for(var r=new L.LatLngBounds,u=0,p=s.length;u<p;u++){var h=s[u];if(h instanceof l.GroupObject)for(var c=0;c<h.subObjects.length;c++){var g=h.subObjects[c];r.extend(g._bounds)}else h instanceof i.PlottingObject&&r.extend(h._bounds)}o=r.getCenter()}0!==this.getSelectedFeatures().length&&this.unselectFeatures();var y=this._map.getPlottingLayers();for(var f in s)if(s[f]instanceof i.PlottingObject&&(a=s[f].clone()),0!==arguments.length&&null!==o){for(var P=0,d=y.length;P<d;P++)if(y[P].getEditable()&&!y[P].getLocked()){y[P].addFeatures(a);break}if(a instanceof n.Route||a.move(arguments[0].lat-o.lat,arguments[0].lng-o.lng),this.selectFeatures(a),s[f]&&s[f].geoSymbolTexts)for(var S=0;S<s[f].geoSymbolTexts.length;S++){var m=s[f].geoSymbolTexts[S].getSymbolData();for(var b in m.associatedUuid=a.uuid,s)if(s[b].symbolType===SuperMap.Plot.SymbolType.SYMBOLTEXT||s[b].symbolType===SuperMap.Plot.SymbolType.SYMBOLTEXT1){var v=s[f].layer.createSymbol(m.libID,m.code,null,{symbolData:m});this.selectFeatures(v),s.splice(b,1),e(v.layer._leaflet_id,v.uuid,v,t);break}}if(s[f]&&s[f].deployments)for(var M=0;M<s[f].deployments.length;M++){var A=s[f].deployments[M].getSymbolData();for(var T in A.associatedUuid=a.uuid,s)if(s[T].symbolType===SuperMap.Plot.SymbolType.NAVYDEPLOYMENT||s[T].symbolType===SuperMap.Plot.SymbolType.AIRDEPLOYMENT){var _=s[f].layer.createSymbol(A.libID,A.code,null,{symbolData:A});this.selectFeatures(_),s.splice(T,1),e(_.layer._leaflet_id,_.uuid,_,t);break}}if(s[f]&&s[f].timeWindows)for(var O=0;O<s[f].timeWindows.length;O++){var x=s[f].timeWindows[O].getSymbolData();for(var w in x.associatedUuid=a.uuid,s)if(s[w].symbolType===SuperMap.Plot.SymbolType.SATELLITETIMEWINDOWS){var E=s[f].layer.createSymbol(x.libID,x.code,null,{symbolData:x});this.selectFeatures(E),s.splice(w,1),e(E.layer._leaflet_id,E.uuid,E,t);break}}}else for(var C=0,I=y.length;C<I;C++)if(y[C].getEditable()&&!y[C].getLocked()){if(y[C].addFeatures(a),1012!==a.code&&this.selectFeatures(a),e(a.layer._leaflet_id,a.uuid,a,t),s[f]&&s[f].geoSymbolTexts)for(var D=0;D<s[f].geoSymbolTexts.length;D++){var R=s[f].geoSymbolTexts[D].getSymbolData();for(var N in R.associatedUuid=a.uuid,s)if(s[N].symbolType===SuperMap.Plot.SymbolType.SYMBOLTEXT||s[N].symbolType===SuperMap.Plot.SymbolType.SYMBOLTEXT1){var U=s[f].layer.createSymbol(R.libID,R.code,null,{symbolData:R});this.selectFeatures(U),s.splice(N,1),e(U.layer._leaflet_id,U.uuid,U,t);break}}if(s[f]&&s[f].deployments)for(var B=0;B<s[f].deployments.length;B++){var k=s[f].deployments[B].getSymbolData();for(var F in k.associatedUuid=a.uuid,s)if(s[F].symbolType===SuperMap.Plot.SymbolType.NAVYDEPLOYMENT||s[F].symbolType===SuperMap.Plot.SymbolType.AIRDEPLOYMENT){var G=s[f].layer.createSymbol(k.libID,k.code,null,{symbolData:k});this.selectFeatures(G),s.splice(F,1),e(G.layer._leaflet_id,G.uuid,G,t);break}}if(s[f]&&s[f].timeWindows)for(var V=0;V<s[f].timeWindows.length;V++){if(!s[f].timeWindows[V].hasOwnProperty("symbolType"))return;var j=s[f].timeWindows[V].getSymbolData();for(var Y in j.associatedUuid=a.uuid,s)if(s[Y].symbolType===SuperMap.Plot.SymbolType.SATELLITETIMEWINDOWS){var z=s[f].layer.createSymbol(j.libID,j.code,null,{symbolData:j});this.selectFeatures(z),s.splice(Y,1),e(z.layer._leaflet_id,z.uuid,z,t);break}}break}}},pasteToPositionAndLayer:function(t,e){var o=!0;e&&e instanceof r.PlottingLayer&&(o=!1);var i=!1;null!==t&&void 0!==t||(i=!0);var l=null,a=this.pasteGeoAry.slice();if(!i){for(var s=new L.LatLngBounds,u=0;u<a.length;u++){var p=a[u];p instanceof n.Route&&s.extend(p._bounds),s.extend(p._bounds)}l=s.getCenter()}for(var h=0;h<this.selectedFeatures.length;h++){var c=this.selectedFeatures[h];this.unselectFeatures(c)}this.selectedFeatures=[];for(var g=0;g<a.length;g++){var y=a[g];if(!0!==y.layer.isLocked&&!1!==y.layer.isEditable){var f=null;if(f=y instanceof n.Route?y.route.clone():y.clone(),o?y.layer.addFeatures(f):e.addFeatures(f),i||null===l||f instanceof n.Route||f.move(t.lat-l.lat,t.lng-l.lng),void 0!==this.pasteGeoSel&&this.pasteGeoSel.length>g&&!0===this.pasteGeoSel[g])if(y instanceof n.Route){var P=f._getNodeFeature(f._getNodeByUuid(y.routeNode.id));this.selectedFeatures(P)}else this.selectFeatures(f);if(a[g]&&a[g].geoSymbolTexts)for(var d=0;d<a[g].geoSymbolTexts.length;d++){var S=a[g].geoSymbolTexts[d].getSymbolData();for(var m in S.associatedUuid=f.uuid,a)if(a[m].symbolType===SuperMap.Plot.SymbolType.SYMBOLTEXT||a[m].symbolType===SuperMap.Plot.SymbolType.SYMBOLTEXT1){var b=a[g].layer.createSymbol(S.libID,S.code,null,{symbolData:S});this.selectFeatures(b),a.splice(m,1);break}}if(a[g]&&a[g].deployments)for(var v=0;v<a[g].deployments.length;v++){var M=a[g].deployments[v].getSymbolData();for(var A in M.associatedUuid=f.uuid,a)if(a[A].symbolType===SuperMap.Plot.SymbolType.NAVYDEPLOYMENT||a[A].symbolType===SuperMap.Plot.SymbolType.AIRDEPLOYMENT){var T=a[g].layer.createSymbol(M.libID,M.code,null,{symbolData:M});this.selectFeatures(T),a.splice(A,1);break}}if(a[g]&&a[g].timeWindows)for(var _=0;_<a[g].timeWindows.length;_++){var O=a[g].timeWindows[_].getSymbolData();for(var x in O.associatedUuid=f.uuid,a)if(a[x].symbolType===SuperMap.Plot.SymbolType.SATELLITETIMEWINDOWS){var w=a[g].layer.createSymbol(O.libID,O.code,null,{symbolData:O});this.selectFeatures(w),a.splice(x,1);break}}}}},equalLarge:function(t){for(var e=[],o=0;o<this.getSelectedFeatures().length;o++)this.getSelectedFeatures()[o].symbolType===SuperMap.Plot.SymbolType.DOTSYMBOL&&e.push(this.getSelectedFeatures()[o]);if(!(e.length<2)){var i=new SuperMap.Plot.Transaction;L.supermap.plotting.getControl().getTransManager().add(i);var l=function(t,e,o,i,l){var n=new SuperMap.Plot.TransactionInfo;n.layerId=t,n.uuid=e,n.functionName="setSymbolSize",n.undoParams=o,n.redoParams=i,l.transInfos.push(n)};if(t===SuperMap.Plot.EqualLargeType.WIDTH)for(var n=e[e.length-1].symbolSize.w,a=0;a<e.length-1;a++){var s=e[a].symbolSize.w;e[a].setSymbolSize(n,e[a].symbolSize.h),l(e[a].layer._leaflet_id,e[a].uuid,[s,e[a].symbolSize.h],[n,e[a].symbolSize.h],i)}else if(t===SuperMap.Plot.EqualLargeType.HEIGHT)for(var r=e[e.length-1].symbolSize.h,u=0;u<e.length-1;u++){var p=e[u].symbolSize.h;e[u].setSymbolSize(e[u].symbolSize.w,r),l(e[u].layer._leaflet_id,e[u].uuid,[e[u].symbolSize.w,p],[e[u].symbolSize.w,r],i)}else if(t===SuperMap.Plot.EqualLargeType.SAME)for(var h=e[e.length-1].symbolSize.w,c=e[e.length-1].symbolSize.h,g=0;g<e.length-1;g++){var y=e[g].symbolSize.w,f=e[g].symbolSize.h;e[g].setSymbolSize(h,c),l(e[g].layer._leaflet_id,e[g].uuid,[y,f],[h,c],i)}}},uniformDistribution:function(t){if(!(this.getSelectedFeatures().length<3)){var e=new SuperMap.Plot.Transaction;L.supermap.plotting.getControl().getTransManager().add(e);for(var o=function(t,e,o,i,l){var n=new SuperMap.Plot.TransactionInfo;n.layerId=t,n.uuid=e,n.functionName="move",n.undoParams=o,n.redoParams=i,l.transInfos.push(n)},i=[],l=0;l<this.getSelectedFeatures().length;l++){var n=this.getSelectedFeatures()[l].getBounds();i.push(new SuperMap.Geometry.Point(n.getCenter().lng,n.getCenter().lat))}var a=this.getSelectedFeatures().slice();if(t===SuperMap.Plot.UniformDistributionType.LEVEL){for(var s=0;s<i.length;s++)for(var r=0;r<i.length-1-s;r++)if(i[r].x>i[r+1].x){var u=i[r+1];i[r+1]=i[r],i[r]=u;var p=a[r+1];a[r+1]=a[r],a[r]=p}for(var h=Math.abs(i[i.length-1].x-i[0].x)/(i.length-1),c=1;c<i.length-1;c++){var g=i[i.length-1].x-h*c-i[c].x;a[c].move(0,g),this._resetEditMarkersValue(a[c]),o(a[c].layer._leaflet_id,a[c].uuid,[0,-g],[0,g],e)}}else if(t===SuperMap.Plot.UniformDistributionType.VERTICAL){for(var y=0;y<i.length;y++)for(var f=0;f<i.length-1-y;f++)if(i[f].y>i[f+1].y){var P=i[f+1];i[f+1]=i[f],i[f]=P;var d=a[f+1];a[f+1]=a[f],a[f]=d}for(var S=Math.abs(i[i.length-1].y-i[0].y)/(i.length-1),m=1;m<i.length-1;m++){var b=i[i.length-1].y-S*m-i[m].y;a[m].move(b,0),this._resetEditMarkersValue(a[m]),o(a[m].layer._leaflet_id,a[m].uuid,[-b,0],[b,0],e)}}}}});L.Map.include({getPlotEditControl:function(){return this._plotEditControl?this._plotEditControl:null}});var c=e.editControl=function(t){return new h(t)};L.supermap.plotting.editControl=c},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.drawControl=e.PlotDrawControl=void 0,o(0);var i=o(27),l=o(12),n=e.PlotDrawControl=l.PlotControl.extend({drawingLayer:null,initialize:function(t,e){if(L.version<"0.7")throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");this.drawingLayer=t,L.Control.prototype.initialize.call(this,e)},onAdd:function(t){var e=L.DomUtil.create("div","supermap-iclient");return this._map=t,this.handler=new i.DrawGraphicObject(this._map,this.drawingLayer),this.handler._control=this,e},onRemove:function(){this._map=null,this.handler=null},setDrawingLayer:function(t){this.drawingLayer=t,this.handler._drawingLayer=t,this.handler._tempDrawingLayer.serverUrl=t.serverUrl,this.handler._drawingLayer.serviceParams=t.serviceParams}}),a=e.drawControl=function(t,e){return new n(t,e)};L.supermap.plotting.drawControl=a},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.editControl=e.PlotEditControl=e.drawControl=e.PlotDrawControl=e.DrawGraphicObject=e.AvoidRegionControl=e.PlotControl=void 0;var i=o(12),l=o(13),n=o(27),a=o(59),s=o(58);e.PlotControl=i.PlotControl,e.AvoidRegionControl=l.AvoidRegionControl,e.DrawGraphicObject=n.DrawGraphicObject,e.PlotDrawControl=a.PlotDrawControl,e.drawControl=a.drawControl,e.PlotEditControl=s.PlotEditControl,e.editControl=s.editControl},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GOAnimationWay=e.GOAnimationShow=e.GOAnimationScale=e.GOAnimationRotate=e.GOAnimationGrow=e.GOAnimationBlink=e.GOAnimationAttribute=e.GOAnimation=void 0;var i=o(3),l=o(34),n=o(33),a=o(32),s=o(31),r=o(30),u=o(29),p=o(28);e.GOAnimation=i.GOAnimation,e.GOAnimationAttribute=l.GOAnimationAttribute,e.GOAnimationBlink=n.GOAnimationBlink,e.GOAnimationGrow=a.GOAnimationGrow,e.GOAnimationRotate=s.GOAnimationRotate,e.GOAnimationScale=r.GOAnimationScale,e.GOAnimationShow=u.GOAnimationShow,e.GOAnimationWay=p.GOAnimationWay},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.animationLayer=e.AnimationLayer=void 0,o(0);var i=o(8),l=e.AnimationLayer=i.PlottingLayerBase.extend({addFeatures:function(t){SuperMap.Util.isArray(t)||(t=[t]),i.PlottingLayerBase.prototype.addFeatures.call(this,t)}}),n=e.animationLayer=function(t,e){return new l(t,e)};L.supermap.plotting.animationLayer=n},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PlottingLayerBase=e.animationLayer=e.AnimationLayer=void 0;var i=o(62),l=o(8);e.AnimationLayer=i.AnimationLayer,e.animationLayer=i.animationLayer,e.PlottingLayerBase=l.PlottingLayerBase},function(t,e,o){"use strict";L.Canvas.include({_drawPlottingGraphics:function(t){var e=this,o=[];t.map(function(t){if("none"===t.feature.style.display)return t;if(t.feature.symbolType===SuperMap.Plot.SymbolType.SYMBOLTEXT||t.feature.symbolType===SuperMap.Plot.SymbolType.SYMBOLTEXT1){var i=e._map.getFeatureByUuid(t.feature.associatedUuid);if(null==i||"none"===i.style.display)return t}return t.getImage().complete()?e._drawPlottingGraphic(t):o.push(t),t}),o.length>0&&setTimeout(function(){for(var t=0;t<o.length;t++)e._drawPlottingGraphic(o[t])},100),this._redrawBounds=null},_drawPlottingLayers:function(t){t.map(function(e){return e instanceof L.Polyline&&e._update(),e instanceof L.Polygon&&e._update(),t})},_drawPlottingGraphic:function(t){var e=this;if("none"===t.feature.style.display)return t;if(t.feature.symbolType===SuperMap.Plot.SymbolType.SYMBOLTEXT||t.feature.symbolType===SuperMap.Plot.SymbolType.SYMBOLTEXT1){var o=e._map.getFeatureByUuid(t.feature.associatedUuid);if(null==o||"none"===o.style.display)return t}var i=e._map.latLngToLayerPoint(t.getLatLng()),l=t.getImage().img||t.getImage().canvas,n=i.x,a=i.y,s=-1*t.getImage().anchor.x,r=-1*t.getImage().anchor.y;e._ctx.save(),e._ctx.translate(n,a);var u=!0===t.feature.autoRotation&&0==t.getImage().feature.dRotate?-t._rotation:-t.getImage().feature.dRotate;e._ctx.rotate(u/180*Math.PI),e._ctx.translate(s,r);var p=L.Canvas.drawImageScaleFactor||(L.Canvas.drawImageScaleFactor=/android 2.1/.test(navigator.userAgent.toLowerCase())?320/window.screen.width:1);t.graphicHeight&&t.graphicWidth?e._ctx.drawImage(l,0,0,t.graphicHeight*p,t.graphicWidth*p):e._ctx.drawImage(l,0,0,t.getImage().size[0]*p,t.getImage().size[1]*p);for(var h=0;h<t.getImage().images.length;h++){var c=t.getImage().images[h].style,g=c.graphicWidth||c.graphicHeight,y=c.graphicHeight||c.graphicWidth;g=g||2*c.pointRadius,y=y||2*c.pointRadius;var f=void 0!==c.graphicXOffset?c.graphicXOffset:-.5*g,P=void 0!==c.graphicYOffset?c.graphicYOffset:-.5*y,d=t.getImage().images[h].point;e._ctx.translate(f,P);var S=L.supermap.plotting.getControl().imageManager[t.getImage().images[h].path];e._ctx.drawImage(S,d.x,d.y,g*p,y*p),e._ctx.translate(-f,-P)}e._ctx.translate(-s,-r),e._ctx.rotate(-u/180*Math.PI);var m=t.getImage().getBounds(t.getImage().feature.getLatLngs()[0],-u);if(null!=t.getImage().annotation){var b=null;switch(t.getImage().annotation.position){case SuperMap.Plot.AnnoPosition.LEFTTOP:b=L.latLng(m.getNorth(),m.getWest());break;case SuperMap.Plot.AnnoPosition.LEFTBOTTOM:b=L.latLng(m.getSouth(),m.getWest());break;case SuperMap.Plot.AnnoPosition.RIGHTTOP:b=L.latLng(m.getNorth(),m.getEast());break;case SuperMap.Plot.AnnoPosition.RIGHTBOTTOM:b=L.latLng(m.getSouth(),m.getEast());break;case SuperMap.Plot.AnnoPosition.TOP:b=L.latLng(m.getNorth(),(m.getWest()+m.getEast())/2);break;case SuperMap.Plot.AnnoPosition.BOTTOM:b=L.latLng(m.getSouth(),(m.getWest()+m.getEast())/2);break;case SuperMap.Plot.AnnoPosition.LEFT:b=L.latLng((m.getSouth()+m.getNorth())/2,m.getWest());break;case SuperMap.Plot.AnnoPosition.RIGHT:b=L.latLng((m.getSouth()+m.getNorth())/2,m.getEast())}var v=e._map.latLngToLayerPoint(b),M=v.x+t.getImage().annotation.offsetX-i.x,A=v.y+t.getImage().annotation.offsetY-i.y;e._ctx.translate(M,A),e._ctx.translate(-t.getImage().annotation.anchor.x,-t.getImage().annotation.anchor.y),e._ctx.drawImage(t.getImage().annotation.canvas,0,0,t.getImage().annotation.size[0]*p,t.getImage().annotation.size[1]*p),e._ctx.translate(t.getImage().annotation.anchor.x,t.getImage().annotation.anchor.y),e._ctx.translate(-M,-A)}for(var T=0;T<t.getImage().pictureFrames.length;T++){var _=null;switch(t.getImage().pictureFrames[T].position){case SuperMap.Plot.AnnoPosition.TOP:_=L.latLng(m.getNorth(),(m.getWest()+m.getEast())/2);break;case SuperMap.Plot.AnnoPosition.BOTTOM:_=L.latLng(m.getSouth(),(m.getWest()+m.getEast())/2);break;case SuperMap.Plot.AnnoPosition.LEFT:_=L.latLng((m.getSouth()+m.getNorth())/2,m.getWest());break;case SuperMap.Plot.AnnoPosition.RIGHT:_=L.latLng((m.getSouth()+m.getNorth())/2,m.getEast())}var O=e._map.latLngToLayerPoint(_),x=O.x+t.getImage().pictureFrames[T].offsetX-i.x,w=O.y+t.getImage().pictureFrames[T].offsetY-i.y;e._ctx.translate(x,w);var E=t.getImage().pictureFrames[T].style,C=E.graphicWidth||E.graphicHeight,I=E.graphicHeight||E.graphicWidth;C=C||2*E.pointRadius,I=I||2*E.pointRadius;var D=void 0!==E.graphicXOffset?E.graphicXOffset:-.5*C,R=void 0!==E.graphicYOffset?E.graphicYOffset:-.5*I;e._ctx.translate(D,R);var N=L.supermap.plotting.getControl().imageManager[t.getImage().pictureFrames[T].path];e._ctx.drawImage(N,0,0,C*p,I*p),e._ctx.translate(-D,-R),e._ctx.translate(-x,-w)}for(var U=0;U<t.getImage().symbolTexts.length;U++){var B=null;switch(t.getImage().symbolTexts[U].position){case SuperMap.Plot.AnnoPosition.LEFTTOP:B=L.latLng(m.getNorth(),m.getWest());break;case SuperMap.Plot.AnnoPosition.LEFTBOTTOM:B=L.latLng(m.getSouth(),m.getWest());break;case SuperMap.Plot.AnnoPosition.RIGHTTOP:B=L.latLng(m.getNorth(),m.getEast());break;case SuperMap.Plot.AnnoPosition.RIGHTBOTTOM:B=L.latLng(m.getSouth(),m.getEast());break;case SuperMap.Plot.AnnoPosition.TOP:B=L.latLng(m.getNorth(),(m.getWest()+m.getEast())/2);break;case SuperMap.Plot.AnnoPosition.BOTTOM:B=L.latLng(m.getSouth(),(m.getWest()+m.getEast())/2);break;case SuperMap.Plot.AnnoPosition.LEFT:B=L.latLng((m.getSouth()+m.getNorth())/2,m.getWest());break;case SuperMap.Plot.AnnoPosition.RIGHT:B=L.latLng((m.getSouth()+m.getNorth())/2,m.getEast());break;case SuperMap.Plot.AnnoPosition.ANCHOR:B=L.latLng(t.getLatLng().lat,t.getLatLng().lng)}var k=e._map.latLngToLayerPoint(B),F=k.x+t.getImage().symbolTexts[U].offsetX-i.x,G=k.y+t.getImage().symbolTexts[U].offsetY-i.y;e._ctx.translate(F,G),e._ctx.translate(-t.getImage().symbolTexts[U].anchor.x,-t.getImage().symbolTexts[U].anchor.y),e._ctx.drawImage(t.getImage().symbolTexts[U].canvas,0,0,t.getImage().symbolTexts[U].size[0]*p,t.getImage().symbolTexts[U].size[1]*p),e._ctx.translate(t.getImage().symbolTexts[U].anchor.x,t.getImage().symbolTexts[U].anchor.y),e._ctx.translate(-F,-G)}for(var V=0;V<t.getImage().bloodVolumes.length;V++){var j=null;switch(t.getImage().bloodVolumes[V].position){case SuperMap.Plot.AnnoPosition.TOP:j=L.latLng(m.getNorth(),(m.getWest()+m.getEast())/2);break;case SuperMap.Plot.AnnoPosition.BOTTOM:j=L.latLng(m.getSouth(),(m.getWest()+m.getEast())/2);break;case SuperMap.Plot.AnnoPosition.LEFT:j=L.latLng((m.getSouth()+m.getNorth())/2,m.getWest());break;case SuperMap.Plot.AnnoPosition.RIGHT:j=L.latLng((m.getSouth()+m.getNorth())/2,m.getEast())}var Y=e._map.latLngToLayerPoint(j),z=Y.x+t.getImage().bloodVolumes[V].offsetX-i.x,W=Y.y+t.getImage().bloodVolumes[V].offsetY-i.y;e._ctx.translate(z,W),e._ctx.translate(-t.getImage().bloodVolumes[V].anchor.x,-t.getImage().bloodVolumes[V].anchor.y),e._ctx.drawImage(t.getImage().bloodVolumes[V].canvas,0,0,t.getImage().bloodVolumes[V].size[0]*p,t.getImage().bloodVolumes[V].size[1]*p),e._ctx.translate(t.getImage().bloodVolumes[V].anchor.x,t.getImage().bloodVolumes[V].anchor.y),e._ctx.translate(-z,-W)}e._ctx.restore()},_updateTextPt:function(t,e){var o=e.options,i=1;100!==o.fontPercent&&(i=o.fontPercent/100),this._ctx.fillStyle=o.fontColor,!0===o.fontStroke&&(this._ctx.strokeStyle=o.fontStrokeColor,this._ctx.setLineDash([]),this._ctx.lineWidth=o.fontStrokeWidth),this._ctx.globalAlpha=o.fontOpacity||1;var l=[o.fontStyle?o.fontStyle:"normal","normal",o.fontWeight?o.fontWeight:"normal",o.fontSize?o.fontSize+"px":"1em",o.fontFamily?o.fontFamily:"sans-serif"].join(" "),n=o.text.split("\n"),a=n.length;if(this._ctx.fillText){this._ctx.font=l,this._ctx.textAlign=L.Canvas.LABEL_ALIGN[o.labelAlign[0]]||"center",this._ctx.textBaseline=L.Canvas.LABEL_ALIGN[o.labelAlign[1]]||"middle";var s=L.Canvas.LABEL_FACTOR[o.labelAlign[1]];null==s&&(s=-.5);var r=this._ctx.measureText("Mg").height||this._ctx.measureText("xx").width;t.y+=r*s*(a-1);for(var u=0;u<a;u++)if(0!=o.fontSpace){var p=0,h=this._ctx.measureText(n[u]).width+o.fontSpace*(n[u].length-1),c=o.labelAlign[0]||"c";"c"===c?p-=h/2-this._ctx.measureText(n[u][0]).width/2:"r"===c&&(p-=h-o.fontSize);var g=0,y=n[u].split(""),f="";this._ctx.save(),this._ctx.translate(t.x,t.y),0!=o.labelRotation&&this._ctx.rotate(o.labelRotation*Math.PI/180),this._ctx.scale(i,1);for(var P=0;P<y.length;P++)!0===o.fontStroke&&this._ctx.strokeText(y[P],p+g,r*u),this._ctx.fillText(y[P],p+g,r*u),f+=y[P],g=this._ctx.measureText(f).width+parseFloat(o.fontSpace)*(P+1);this._ctx.restore()}else this._ctx.save(),this._ctx.translate(t.x,t.y),0!=o.labelRotation&&this._ctx.rotate(o.labelRotation*Math.PI/180),this._ctx.scale(i,1),!0===o.fontStroke&&this._ctx.strokeText(n[u],0,r*u),this._ctx.fillText(n[u],0,r*u),this._ctx.restore()}},_updateText:function(t){if(void 0!=t.options.text&&!(t.options.fontSize<6)){void 0===t.options.fontPercent&&(t.options.fontPercent=100),t.options.fontPercent<0&&(t.options.fontPercent=0),t.options.fontPercent>400&&(t.options.fontPercent=400),void 0===t.options.fontSpace&&(t.options.fontSpace=0),t.options.fontSpace>30?t.options.fontSpace=30:t.options.fontSpace<0&&(t.options.fontSpace=0);var e=t._latlng,o=this._map.latLngToLayerPoint(e);if(void 0!=o){if(t.options.labelXOffset||t.options.labelYOffset){var i=isNaN(t.options.labelXOffset)?0:t.options.labelXOffset,l=isNaN(t.options.labelYOffset)?0:t.options.labelYOffset;o.x+=i,o.y-=l}if(!0===t.options.fontBackground){this._ctx.font=[t.options.fontStyle?t.options.fontStyle:"normal","normal",t.options.fontWeight?t.options.fontWeight:"normal",t.options.fontSize?t.options.fontSize+"px":"1em",t.options.fontFamily?t.options.fontFamily:"sans-serif"].join(" ");var n=t.options.labelRotation;t.options.labelRotation=0;var a=t.getPxBounds();t.options.labelRotation=n;var s=a.min.x,r=a.min.y,u=a.max.x-a.min.x,p=a.max.y-a.min.y;this._ctx.fillStyle=t.options.fontBackgroundColor,this._ctx.globalAlpha=1,this._ctx.save(),this._ctx.translate(s,r),0!=t.options.labelRotation&&this._ctx.rotate(t.options.labelRotation*Math.PI/180),this._ctx.fillRect(0,0,u,p),this._ctx.restore()}if(!0===t.options.fontShadow){var h=L.point(o.x,o.y);if(t.options.fontShadowOffsetX&&(h.x+=t.options.fontShadowOffsetX),t.options.fontShadowOffsetY&&(h.y+=t.options.fontShadowOffsetY),0!==t.options.labelRotation){var c=o.x,g=o.y,y=t.options.labelRotation*Math.PI/180,f=Math.sqrt(Math.pow(h.x-c,2)+Math.pow(h.y-g,2)),P=y+Math.atan2(h.y-g,h.x-c);h.x=c+f*Math.cos(P),h.y=g+f*Math.sin(P)}var d=t.options.fontStroke;t.options.fontStroke=!1;var S=t.options.fontColor;t.options.fontColor=t.options.fontShadowColor,this._updateTextPt(h,t),t.options.fontColor=S,t.options.fontStroke=d}if(t.hasOwnProperty("_eventParents"))for(var m in t._eventParents)t._eventParents[m].hasOwnProperty("ownerGroup")&&null!==t._eventParents[m].ownerGroup&&(t._eventParents[m].ownerGroup.symbolType!==SuperMap.Plot.SymbolType.NAVYDEPLOYMENT&&t._eventParents[m].ownerGroup.symbolType!==SuperMap.Plot.SymbolType.AIRDEPLOYMENT||t._updateBounds());this._updateTextPt(o,t)}}},_updateImage:function(t){var e=this,o=function(){var t=this.style,o=t.graphicWidth||t.graphicHeight,i=t.graphicHeight||t.graphicWidth;o=o||2*t.pointRadius,i=i||2*t.pointRadius;var l=void 0!==t.graphicXOffset?t.graphicXOffset:-.5*o,n=void 0!==t.graphicYOffset?t.graphicYOffset:-.5*i,a=t.graphicOpacity||t.fillOpacity,s=this.point,r=s.x,u=s.y;if(!isNaN(r)&&!isNaN(u)){var p;e._ctx.save(),t.rotation&&(p=t.rotation/180*Math.PI),e._ctx.translate(r,u),p&&e._ctx.rotate(p),e._ctx.translate(l,n),e._ctx.globalAlpha=a;var h=L.Canvas.drawImageScaleFactor||(L.Canvas.drawImageScaleFactor=/android 2.1/.test(navigator.userAgent.toLowerCase())?320/window.screen.width:1);e._ctx.drawImage(this.img,0,0,o*h,i*h),e._ctx.restore()}},i=new Image;"firefox"==SuperMap.Browser.name?(i.onload=function(){o.call({point:t._point,style:t.options,img:i}),i.onload=null},t.options.graphicTitle&&(i.title=t.options.graphicTitle),i.src=t.options.externalGraphic):(t.options.graphicTitle&&(i.title=t.options.graphicTitle),i.src=t.options.externalGraphic,i.onload=function(){o.call({point:t._point,style:t.options,img:i}),i.onload=null}),window.ActiveXObject||"ActiveXObject"in window?i.onload():i.complete&&i.onload()},_updateArc:function(t){if(this._drawing&&!t._empty()){var e=t._point,o=this._ctx,i=t._radius,l=(t._radiusY||i)/i,n=(360-t.options.endAngle)*(Math.PI/180),a=(360-t.options.startAngle)*(Math.PI/180);this._drawnLayers[t._leaflet_id]=t,1!==l&&(o.save(),o.scale(1,l)),o.beginPath(),o.arc(e.x,e.y/l,i,n,a,!1),1!==l&&o.restore(),this._fillStroke(o,t)}},_handleMouseHover:function(t,e){var o,i=null;for(var l in this._map._layers)if((o=this._map._layers[l])._drawFirst)for(var n=o._drawFirst;n;n=n.next)n.layer.options.interactive&&n.layer._containsPoint(e)&&!this._map._draggableMoved(n.layer)&&(i=n.layer);i!==this._hoveredLayer&&(this._handleMouseOut(t),i&&(L.DomUtil.addClass(this._container,"leaflet-interactive"),this._fireEvent([i],t,"mouseover"),this._hoveredLayer=i)),this._hoveredLayer&&this._fireEvent([this._hoveredLayer],t)},_onClick:function(t){var e,o=this._map.mouseEventToLayerPoint(t),i=[],l=[],n=0;for(var a in this._map._layers)if(this._map._layers[a]._drawFirst)for(var s=this._map._layers[a]._drawFirst;s;s=s.next)if(s.layer.options.interactive&&s.layer._containsPoint(o)&&!this._map._draggableMoved(s.layer)&&(e=s.layer).hasOwnProperty("_eventParents")&&null!==e._eventParents)for(var r in e._eventParents)l.push(e),i.push(e._eventParents[r]);if(e&&l.length>1){if(i.length>0){for(var u=!1,p=[],h=[],c=0,g=i.length;c<g;c++)i[c].isSelected&&i[c].moveend&&(u=!0),i[c].enableEdit&&(p.push(i[c]),h.push(l[c]));if(t.altKey){for(var y=0;y<i.length;y++){if(1===i[y].symbolType){n=y;break}i[y].getBounds().contains(i[n].getBounds())||(n=y)}return L.DomEvent.fakeStop(t),void this._fireEvent([h[n]],t)}for(var f=0,P=p.length;f<P;f++){if(L.DomEvent.fakeStop(t),p[f].isSelected&&p[f].moveend){this._fireEvent([h[f]],t);break}if(p[f].isSelected&&p.length>1){this._fireEvent([h[f]],t);break}if(!u){this._fireEvent([h[h.length-1]],t);break}}}}else e&&(L.DomEvent.fakeStop(t),this._fireEvent([e],t))}}),L.Polyline.prototype._containsPoint=function(t,e){var o,i,l,n,a,s,r=this._clickTolerance()+10;if(this._pxBounds&&!this._pxBounds.contains(t))return!1;for(o=0,n=this._parts.length;o<n;o++)for(i=0,l=(a=(s=this._parts[o]).length)-1;i<a;l=i++)if((e||0!==i)&&L.LineUtil.pointToSegmentDistance(t,s[l],s[i])<=r)return!0;return!1},L.supermap.plotting.Text.prototype._containsPoint=function(t){return this._pxBounds.contains(t)},L.supermap.plotting.PointImage.prototype._containsPoint=function(t){return this._pxBounds.contains(t)},L.Canvas.LABEL_ALIGN={l:"left",r:"right",t:"hanging",b:"alphabetic"},L.Canvas.LABEL_FACTOR={l:0,r:-1,t:0,b:-1},L.Canvas.drawImageScaleFactor=null},function(t,e,o){"use strict";L.SVG.include({_drawPlottingLayers:function(t){t.map(function(e){return e instanceof L.Polyline&&e._update(),e instanceof L.Polygon&&e._update(),t})},getEvents:function(){var t=this;this._map.on("layeradd",function(e){e.layer===t&&(L.DomEvent.on(t._container,"mousemove",L.Util.throttle(t._onMouseMove,32,t),t),L.DomEvent.on(t._container,"mouseout",t._handleMouseOut,t))});var e=L.Renderer.prototype.getEvents.call(this);return e.zoomstart=this._onZoomStart,e},_onClick:function(t){var e,o=this._map.mouseEventToLayerPoint(t),i=[],l=[];for(var n in this._layers){var a=this._layers[n];if(a.options.interactive&&"function"==typeof a._containsPoint&&a._containsPoint(o)&&!this._map._draggableMoved(a)&&(e=a).hasOwnProperty("_eventParents")&&null!=e._eventParents)for(var s in e._eventParents)l.push(e),i.push(e._eventParents[s])}if(e&&l.length>1){if(i.length>0){for(var r=!1,u=[],p=[],h=0,c=i.length;h<c;h++)i[h].isSelected&&i[h].moveend&&(r=!0),i[h].enableEdit&&(u.push(i[h]),p.push(l[h]));for(var g=0,y=u.length;g<y;g++){if(L.DomEvent.fakeStop(t),u[g].isSelected&&u[g].moveend){u[g].moveend=!1,this._fireEvent([p[g]],t),u[g].moveend=!0;break}if(u[g].isSelected&&u.length>1){this._fireEvent([p[g]],t);break}if(!r){this._fireEvent([p[p.length-1]],t);break}}}}else e&&(L.DomEvent.fakeStop(t),e._eventParents[0]&&e._eventParents[0].fire(t.type,t))},_onMouseMove:function(t){if(this._map&&!this._map.dragging.moving()&&!this._map._animatingZoom){var e=this._map.mouseEventToLayerPoint(t);this._handleMouseHover(t,e)}},_handleMouseOut:function(t){var e=this._hoveredLayer;e&&(L.DomUtil.removeClass(this._container,"leaflet-interactive"),this._fireEvent([e],t,"mouseout"),this._hoveredLayer=null)},_handleMouseHover:function(t,e){var o,i;for(var l in this._layers)(o=this._layers[l]).options.interactive&&"function"==typeof o._containsPoint&&o._containsPoint(e)&&(i=o);i!==this._hoveredLayer&&(this._handleMouseOut(t),i&&(L.DomUtil.addClass(this._container,"leaflet-interactive"),this._fireEvent([i],t,"mouseover"),this._hoveredLayer=i)),this._hoveredLayer&&this._fireEvent([this._hoveredLayer],t)},_fireEvent:function(t,e,o){this._map._fireDOMEvent(e,o||e.type,t)},_updateTextPt:function(t,e,o,i){var l;if(t.setAttributeNS(null,"x",e.x),t.setAttributeNS(null,"y",e.y),o.options.display&&t.setAttributeNS(null,"display",o.options.display),!0===o.options.fontStroke&&(o.options.fontStrokeColor&&t.setAttributeNS(null,"stroke",o.options.fontStrokeColor),o.options.fontStrokeWidth&&t.setAttributeNS(null,"stroke-width",o.options.fontStrokeWidth)),o.options.labelRotation&&t.setAttributeNS(null,"transform","rotate("+o.options.labelRotation+" "+e.x+","+e.y+")"),o.options.fontColor&&t.setAttributeNS(null,"fill",o.options.fontColor),o.options.fontOpacity&&t.setAttributeNS(null,"opacity",o.options.fontOpacity),o.options.fontFamily&&t.setAttributeNS(null,"font-family",o.options.fontFamily),o.options.fontSize&&t.setAttributeNS(null,"font-size",o.options.fontSize),o.options.fontWeight&&t.setAttributeNS(null,"font-weight",o.options.fontWeight),o.options.fontStyle&&t.setAttributeNS(null,"font-layer.options",o.options.fontStyle),L.Browser.gecko){if(100!==o.options.fontPercent&&0!==o.options.fontSpace&&(l=o.options.fontSpace+o.options.fontPercent/100*parseFloat(o.options.fontSize)*o.options.text.length),100!==o.options.fontPercent&&0===o.options.fontSpace){var n=document.createElement("span");document.body.appendChild(n),n.style.width="auto",n.style.height="auto",o.options.fontSize&&(n.style.fontSize=new String(o.options.fontSize)+"px"),o.options.fontFamily&&(n.style.fontFamily=o.options.fontFamily),o.options.fontWeight&&(n.style.fontWeight=o.options.fontWeight),n.style.position="absolute",n.style.visibility="hidden",n.innerHTML=o.options.text;var a=n.clientWidth;l=o.options.fontPercent/100*a+o.options.text.length}t.setAttributeNS(null,"textLength",l),t.setAttributeNS(null,"lengthAdjust","spacingAndGlyphs")}t.setAttributeNS(null,"pointer-events","visible");var s=o.options.labelAlign||"cm";t.setAttributeNS(null,"text-anchor",L.SVG.LABEL_ALIGN[s[0]]||"middle"),!0===L.Browser.gecko&&t.setAttributeNS(null,"dominant-baseline",L.SVG.LABEL_ALIGN[s[1]]||"central");for(var r=function(){var t=L.SVG.LABEL_VFACTOR[s[1]];null==t&&(t=-.5);var e=t*(p-1);return L.Browser.ie&&(null===(t=L.SVG.LABEL_IE_VOFFSET[s[1]])&&(t=.35),e+=t),e},u=o.options.text.split("\n"),p=u.length;t.childNodes.length>p;)t.removeChild(t.lastChild);for(var h=0;h<p;h++){var c=e.x;if(0!==o.options.fontSpace||100!==o.options.fontPercent&&L.Browser.ie){var g=SuperMap.Plot.PlottingUtil.getTextWidth(o.options,u[h]);"c"===s[0]?c-=g/2:"r"===s[0]&&(c-=g);for(var y=0,f=u[h].split(""),P="",d=0;d<f.length;d++){var S=i+"tspan"+h+d;o._tspanNodeObj&&o._tspanNodeObj[S]||(o._tspanNodeObj[S]=L.SVG.create("tspan"));var m=o._tspanNodeObj[S];!1===L.Browser.gecko&&m.setAttributeNS(null,"baseline-shift",L.SVG.LABEL_VSHIFT[s[1]]||"-35%");var b=SuperMap.Plot.PlottingUtil.getTextWidth(o.options,f[d]);m.setAttributeNS(null,"textLength",b),m.setAttributeNS(null,"lengthAdjust","spacingAndGlyphs"),m.setAttribute("x",c+y+(0===h?0:b>>>1)),0!==d?m.setAttribute("dy","0em"):0===h?m.setAttribute("dy",r()+"em"):m.setAttribute("dy","1em");var v=""===f[d]?" ":f[d];o.options.isUnicode?L.Browser.ie||L.Browser.ielt9?(this.element.innerHTML=v,m.textContent=this.element.innerHTML):m.innerHTML=v:m.textContent=v,m.parentNode||t.appendChild(m),P+=f[d],y=SuperMap.Plot.PlottingUtil.getTextWidth(o.options,P)+parseFloat(o.options.fontSpace)*(o.options.fontPercent/100)}}else{var M=i+"tspan"+h;o._tspanNodeObj&&o._tspanNodeObj[M]||(o._tspanNodeObj[M]=L.SVG.create("tspan"));var A=o._tspanNodeObj[M];if(!1===L.Browser.gecko&&A.setAttributeNS(null,"baseline-shift",L.SVG.LABEL_VSHIFT[s[1]]||"-35%"),100!==o.options.fontPercent){var T=SuperMap.Plot.PlottingUtil.getTextWidth(o.options,u[h]);A.setAttributeNS(null,"textLength",T),A.setAttributeNS(null,"lengthAdjust","spacingAndGlyphs")}A.setAttribute("x",e.x),0==h?A.setAttribute("dy",r()+"em"):A.setAttribute("dy","1em");var _=""===u[h]?" ":u[h];o.options.isUnicode?L.Browser.ie||L.Browser.ielt9?(this.element.innerHTML=_,A.textContent=this.element.innerHTML):A.innerHTML=_:A.textContent=_,A.parentNode||t.appendChild(A)}}t.parentNode||this._rootGroup.appendChild(t)},_updateText:function(t){if(t.options.text&&0!==t.options.text.length)if(t.options.fontSize<6||t.options.fontPercent<=0)t._removeNode();else{for(var e in t._eventParents)if(t._eventParents[e].symbolType===SuperMap.Plot.SymbolType.DOTSYMBOL&&!1===t._eventParents[e].textDisplay)return void t._removeNode();void 0===t.options.fontPercent&&(t.options.fontPercent=100),t.options.fontPercent<0&&(t.options.fontPercent=0),t.options.fontPercent>400&&(t.options.fontPercent=400),void 0===t.options.fontSpace&&(t.options.fontSpace=0),t.options.fontSpace>30?t.options.fontSpace=30:t.options.fontSpace<0&&(t.options.fontSpace=0);var o=t._latlng,i=this._map.latLngToLayerPoint(o);if(void 0!=i){if(t.options.labelXOffset||t.options.labelYOffset){var l=isNaN(t.options.labelXOffset)?0:t.options.labelXOffset,n=isNaN(t.options.labelYOffset)?0:t.options.labelYOffset;i.x+=l,i.y-=n}if(!0===t.options.fontShadow){t._shadowTextNode&&t._shadowTextNode.parentNode||(t._shadowTextNode=L.SVG.create("text"),this._rootGroup.appendChild(t._shadowTextNode));var a=L.point(i.x,i.y);if(t.options.fontShadowOffsetX&&(a.x+=t.options.fontShadowOffsetX),t.options.fontShadowOffsetY&&(a.y+=t.options.fontShadowOffsetY),0!==t.options.labelRotation){var s=i.x,r=i.y,u=t.options.labelRotation*Math.PI/180,p=Math.sqrt(Math.pow(a.x-s,2)+Math.pow(a.y-r,2)),h=u+Math.atan2(a.y-r,a.x-s);a.x=s+p*Math.cos(h),a.y=r+p*Math.sin(h)}var c=t.options.fontStroke;t.options.fontStroke=!1;var g=t.options.fontColor;t.options.fontColor=t.options.fontShadowColor,this._updateTextPt(t._shadowTextNode,a,t,"shadow"),t.options.fontColor=g,t.options.fontStroke=c}else t._shadowTextNode&&t._shadowTextNode.parentNode&&(this._rootGroup.removeChild(t._shadowTextNode),delete t._shadowTextNode);if(t._textNode&&t._textNode.parentNode||(t._textNode=L.SVG.create("text"),this._rootGroup.appendChild(t._textNode),t.options.interactive&&L.DomUtil.addClass(t._textNode,"leaflet-interactive"),t.addInteractiveTarget(t._textNode)),this._updateTextPt(t._textNode,i,t,"label"),!0===t.options.fontBackground){var y=t._shadowTextNode;if(y&&y.parentNode||(y=t._textNode),!y||!y.parentNode)return;t._backgroundTextNode&&t._backgroundTextNode.parentNode||(t._backgroundTextNode=L.SVG.create("rect"),!0===t.options.fontShadow?this._rootGroup.insertBefore(t._backgroundTextNode,t._shadowTextNode):this._rootGroup.insertBefore(t._backgroundTextNode,t._textNode));var f=t._textNode.getBBox();t._backgroundTextNode.x.baseVal.value=f.x,t._backgroundTextNode.y.baseVal.value=f.y,t._backgroundTextNode.width.baseVal.value=f.width,t._backgroundTextNode.height.baseVal.value=f.height,t._backgroundTextNode.style.fill=t.options.fontBackgroundColor,t.options.labelRotation&&t._backgroundTextNode.setAttributeNS(null,"transform","rotate("+t.options.labelRotation+" "+i.x+","+i.y+")")}else t._backgroundTextNode&&t._backgroundTextNode.parentNode&&(this._rootGroup.removeChild(t._backgroundTextNode),delete t._backgroundTextNode)}else t._removeNode()}else t._removeNode()},_updateImage:function(t){if(t._imageNode&&t._imageNode.parentNode||(t._imageNode=L.SVG.create("image"),this._rootGroup.appendChild(t._imageNode)),t._imageNode.setAttributeNS(null,"cx",t._point.x),t._imageNode.setAttributeNS(null,"cy",t._point.y),t._imageNode.setAttributeNS(null,"r",1),t._imageNode.style.visibility="",t.options.graphicTitle){t._imageNode.setAttributeNS(null,"title",t.options.graphicTitle);var e=L.SVG.create("title");e.textContent=style.graphicTitle,t._imageNode.appendChild(e)}t.options.graphicWidth&&t.options.graphicHeight&&t._imageNode.setAttributeNS(null,"preserveAspectRatio","none");var o=t.options.graphicWidth||t.options.graphicHeight,i=t.options.graphicHeight||t.options.graphicWidth;o=o||2*t.options.pointRadius,i=i||2*t.options.pointRadius;var l=void 0!=t.options.graphicXOffset?t.options.graphicXOffset:-.5*o,n=void 0!=t.options.graphicYOffset?t.options.graphicYOffset:-.5*i,a=t.options.graphicOpacity||t.options.fillOpacity;t._imageNode.setAttributeNS(null,"x",(t._point.x+l).toFixed()),t._imageNode.setAttributeNS(null,"y",(t._point.y+n).toFixed()),t._imageNode.setAttributeNS(null,"width",o),t._imageNode.setAttributeNS(null,"height",i),t._imageNode.setAttributeNS("http://www.w3.org/1999/xlink","href",t.options.externalGraphic),t._imageNode.setAttributeNS(null,"style","opacity: "+a),t._imageNode.onclick=L.SVG.preventDefault;var s=t.options.rotation;void 0===s&&void 0===t._imageNode._rotation||!t._point||(t._imageNode._rotation=s,s|=0,t._imageNode.setAttributeNS(null,"transform","rotate("+s+" "+t._point.x+" "+t._point.y+")")),t._imageNode.setAttributeNS(null,"fill","none"),t._imageNode.setAttributeNS(null,"stroke","none"),t.options.pointerEvents?(t._imageNode.setAttributeNS(null,"pointer-events",t.options.pointerEvents),t._imageNode.style.pointerEvents=t.options.pointerEvents):(t._imageNode.setAttributeNS(null,"pointer-events","visiblepainted"),t._imageNode.style.pointerEvents="visiblepainted"),null!=t.options.cursor&&t._imageNode.setAttributeNS(null,"cursor",style.cursor)},_updateArc:function(t){if(this._drawing&&!t._empty()){var e=t._point,o=t._radius,i="a"+o+","+(t._radiusY||o)+" 0 1,0 ";sRadian=(360-t.options.endAngle)*(Math.PI/180),eRadian=(360-t.options.startAngle)*(Math.PI/180);var l=t._empty()?"M0 0":"M"+(e.x-o)+","+e.y+i+2*o+",0 "+i+2*-o+",0 ";this._setPath(t,l)}}}),L.SVG.LABEL_ALIGN={l:"start",r:"end",b:"bottom",t:"hanging"},L.SVG.LABEL_VSHIFT={t:"-83%",b:"0"},L.SVG.LABEL_VFACTOR={t:0,b:-1},L.SVG.LABEL_IE_VOFFSET={t:.86,b:0},L.SVG.preventDefault=function(t){t.preventDefault&&t.preventDefault()}},function(t,e,o){"use strict";var i=o(9),l=o(35),n=o(14);L.Map.include({getFeatureByUuid:function(t){var e=[];for(var o in this._layers){var a;if(this._layers[o]instanceof i.PlottingLayer)null!==(a=this._layers[o].getFeatureByUuid(t))&&e.push(a);if(this._layers[o]instanceof l.PlottingGraphicLayer)null!==(a=this._layers[o].getFeatureByUuid(t))&&e.push(a);if(this._layers[o]instanceof n.MovingTargetLayer)null!==(a=this._layers[o].getFeatureByUuid(t))&&e.push(a)}return 0===e.length?null:e[0]},getPlottingLayers:function(){var t=[],e=this._layers;for(var o in e)e[o]instanceof i.PlottingLayer&&t.push(e[o]);return t},clearPlottingLayers:function(){var t=this._layers;for(var e in t)t[e]instanceof i.PlottingLayer&&(t[e].removeAllFeatures(),this.removeLayer(t[e]))},getLayer:function(t){var e=this._layers;for(var o in e)if(e[o]._leaflet_id===t)return e[o]},getLayersByName:function(t){return this.getLayersBy("name",t)},getLayersBy:function(t,e){return this.getBy("_layers",t,e)},getBy:function(t,e,o){var i="function"==typeof o.test,l=[];for(var n in this[t])l.push(this[t][n]);return SuperMap.Array.filter(l,function(t){return t[e]===o||i&&o.test(t[e])})},latLngToLayerPoint:function(t){return this.project(L.latLng(t))._subtract(this.getPixelOrigin())}})},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.geoSymbolText1=e.GeoSymbolText1=void 0,o(0);var i=o(1),l=(o(18),e.GeoSymbolText1=i.GraphicObject.extend({space:null,offsetX:null,offsetY:null,initialize:function(t,e,o,l){this.minEditPts=1,this.maxEditPts=1,this.libID=0,this.code=SuperMap.Plot.SymbolType.SYMBOLTEXT1,this.symbolType=SuperMap.Plot.SymbolType.SYMBOLTEXT1,this.symbolName="对象标注(带指示线)",null===this.space&&(this.space=10),null===this.offsetX&&(this.offsetX=60),null===this.offsetY&&(this.offsetY=30),i.GraphicObject.prototype.initialize.call(this,t,e,o,l),this.style.sizeFixed=!1},destroy:function(){this.space=null,this.offsetX=null,this.offsetY=null,i.GraphicObject.prototype.destroy.call(this)},removeSymbolTextsFromDotSymbol:function(t){if(t&&"string"==typeof t){var e=this._map.getFeatureByUuid(t);if(e)for(var o=0,i=e.geoSymbolTexts.length;o<i;o++)if(this===e.geoSymbolTexts[o]){e.geoSymbolTexts.splice(o,1);break}}},_calculateParts:function(){if("none"!==this.style.display&&(null==this.layer||"function"!=typeof this.layer.getVisibility||!1!==this.layer.getVisibility())){var t=this._map.getFeatureByUuid(this.associatedUuid);if(null!=t&&"none"!==t.style.display){this.latLngs=[];for(var e=[],o=!1,i=0;i<t.geoSymbolTexts.length;i++)if(this===t.geoSymbolTexts[i]){o=!0;break}o||t.geoSymbolTexts.push(this),this._calculateSize(t);var l=t.latLngs[0],n=this._map.latLngToLayerPoint(l),a=new SuperMap.Pixel(n.x+this.offsetX,n.y+this.offsetY),s=this._map.layerPointToLatLng(a);0===this.latLngs.length?this.latLngs.push(s):(this.latLngs[0].lng=s.lng,this.latLngs[0].lat=s.lat);var r=L.Util.cloneLatLngs(this.latLngs[0]);r.push(l);var u={style:{surroundLineFlag:!1}};u.style=SuperMap.Util.copyAttributes(u.style,this.style),u.positionPoints=r,u.type=24,e.push(u),SuperMap.Util.isArray(this.textContent)||(this.textContent=[this.textContent]);var p=this.textContent.length,h=this.style.fontSize*p+p+1,c=this._map.latLngToLayerPoint(L.latLng(this.latLngs[0].lat,this.latLngs[0].lng)),g=L.point(c.x,c.y-h/2),y=L.point(c.x,c.y+h/2),f=[this._map.layerPointToLatLng(g),this._map.layerPointToLatLng(y)],P={};P.positionPoints=f,P.style={surroundLineFlag:!1},P.style=SuperMap.Util.copyAttributes(P.style,this.style),P.type=24,e.push(P);var d,S=new SuperMap.Geometry.Point(this.latLngs[0].lng,this.latLngs[0].lat);if(0!==this.textContent.length){for(var m=t.getBounds(),b=new SuperMap.Geometry.Point((m.getWest()+m.getEast())/2,m.getNorth()),v=new SuperMap.Geometry.Point((m.getWest()+m.getEast())/2,m.getSouth()),M=SuperMap.Plot.PlottingUtil.pointIsRightToLine(b,v,S),A="",T=0;T<this.textContent.length;T++)A+=this.textContent[T],T!==this.textContent.length-1&&(A+="\r\n");var _=null;_=!0===M?L.point(c.x-this.space,c.y):L.point(c.x+this.space,c.y);var O={},x=this._map.layerPointToLatLng(_);O.positionPoints=x,O.type=34,O.textContent=A,O.style={},O.style=SuperMap.Util.copyAttributes(O.style,this.style),O.style.hasOwnProperty("sizeFixed")&&delete O.style.sizeFixed,O.style.labelAlign=!0===M?"rm":"lm",e.push(O)}for(var w=0;w<e.length;w++)d=L.Util.isArray(e[w].positionPoints)?e[w].positionPoints:[e[w].positionPoints],this._createAndDrawLayer(e[w].type,d,e[w].style,e[w].textContent)}}},_calculateSize:function(t){this.scaleByMap=t.scaleByMap,!1===this.scaleByMap||!0===this.style.sizeFixed?this.fromZoom=this._map.getZoom():this.fromZoom<=this._map.getZoom()&&(this.dScale=t.dScale),void 0!==this.prevOffsetX&&this.prevOffsetX!==this.offsetX&&(this.scaleBeforeOffsetX=this.offsetX/this.dScale,this.prevOffsetX=this.offsetX),!0===this.scaleByMap&&(void 0===this.scaleBeforeOffsetX&&(this.scaleBeforeOffsetX=this.offsetX),this.offsetX=this.scaleBeforeOffsetX*this.dScale,this.prevOffsetX=this.offsetX),void 0!==this.prevOffsetY&&this.prevOffsetY!==this.offsetY&&(this.scaleBeforeOffsetY=this.offsetY/this.dScale,this.prevOffsetY=this.offsetY),!0===this.scaleByMap&&(void 0===this.scaleBeforeOffsetY&&(this.scaleBeforeOffsetY=this.offsetY),this.offsetY=this.scaleBeforeOffsetY*this.dScale,this.prevOffsetY=this.offsetY),void 0!==this.prevStrokeWidth&&this.prevStrokeWidth!==this.style.weight&&(this.strokeWidth=this.style.weight,this.prevStrokeWidth=this.style.weight),!0===this.scaleByMap&&(void 0===this.weight&&(this.weight=this.style.weight),this.fromZoom<=this._map.getZoom()?this.style.weight=t.style.weight:this.style.weight=this.weight,this.prevStrokeWidth=this.style.weight),void 0!==this.prevFontSize&&this.prevFontSize!==this.style.fontSize&&(this.fontSize=this.style.fontSize/this.dScale,this.prevFontSize=this.style.fontSize),!0===this.scaleByMap&&(void 0===this.fontSize&&(this.fontSize=this.style.fontSize),this.style.fontSize=this.fontSize*this.dScale,this.prevFontSize=this.style.fontSize)},_reView:function(){this.fire(SuperMap.Plot.Event.reseteditmarkersvalues)},_modifyPoint:function(){var t=this._map.getFeatureByUuid(this.associatedUuid);if(null!==t){var e=this._map.latLngToLayerPoint(L.latLng(t.latLngs[0].lat,t.latLngs[0].lng)),o=this._map.latLngToLayerPoint(L.latLng(this.latLngs[0].lat,this.latLngs[0].lng));this.offsetX=o.x-e.x,this.offsetY=o.y-e.y,this.redraw()}},_parseSymbolData:function(){i.GraphicObject.prototype._parseSymbolData.call(this),this.symbolData&&(void 0!==this.symbolData.space&&(this.space=this.symbolData.space),void 0!==this.symbolData.offsetX&&(this.offsetX=this.symbolData.offsetX),void 0!==this.symbolData.offsetY&&(this.offsetY=this.symbolData.offsetY),void 0!==this.symbolData.scaleBeforeOffsetX&&(this.scaleBeforeOffsetX=this.symbolData.scaleBeforeOffsetX),void 0!==this.symbolData.scaleBeforeOffsetY&&(this.scaleBeforeOffsetY=this.symbolData.scaleBeforeOffsetY))},_setSymbolData:function(){i.GraphicObject.prototype._setSymbolData.call(this),this.symbolData&&(this.symbolData.space=this.space,this.symbolData.offsetX=this.offsetX,this.symbolData.offsetY=this.offsetY,void 0!==this.scaleBeforeOffsetX&&(this.symbolData.scaleBeforeOffsetX=this.scaleBeforeOffsetX),void 0!==this.scaleBeforeOffsetY&&(this.symbolData.scaleBeforeOffsetY=this.scaleBeforeOffsetY))}})),n=e.geoSymbolText1=function(t,e,o,i){return new l(t,e,o,i)};L.supermap.plotting.symbolText1=n,L.supermap.plotting.SymbolText1=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.geoSymbolText=e.GeoSymbolText=void 0,o(0);var i=o(1),l=(o(18),e.GeoSymbolText=i.GraphicObject.extend({symbolTexts:[],addFrame:!1,getFrame:function(){return this.addFrame},setFrame:function(t){this.addFrame!==t&&(this.addFrame=t,this.redraw())},updateSymbolText:function(t,e){this.symbolTexts.length>e&&(this.symbolTexts[e]=t,this.redraw())},removeSymbolTextsFromDotSymbol:function(t){if(t&&"string"==typeof t){var e=this._map.getFeatureByUuid(t);if(e)for(var o=0,i=e.geoSymbolTexts.length;o<i;o++)if(this===e.geoSymbolTexts[o]){e.geoSymbolTexts.splice(o,1);break}}},initialize:function(t,e,o,l){this.libID=0,this.code=SuperMap.Plot.SymbolType.SYMBOLTEXT,this.symbolType=SuperMap.Plot.SymbolType.SYMBOLTEXT,this.symbolName="对象标注",i.GraphicObject.prototype.initialize.call(this,t,e,o,l),this.style.sizeFixed=!1},_calculateParts:function(){if(!("none"===this.style.display||null!=this.layer&&"function"==typeof this.layer.getVisibility&&!1===this.layer.getVisibility()||this.symbolTexts.length<=0)){var t=this._map.getFeatureByUuid(this.associatedUuid);if(null!=t&&"none"!==t.style.display){this.latLngs=[];for(var e=[],o=this.symbolTexts,i=!1,l=t.geoSymbolTexts,n=0,a=l.length;n<a;n++)if(this===l[n]){i=!0;break}i||l.push(this);var s={surroundLineFlag:!1,lineColorLimit:!0,fillColorLimit:!0,lineWidthLimit:!0,lineTypeLimit:!0,fontColorLimit:!0,fontSizeLimit:!0,fillLimit:!0},r=t.getBounds();if((null==r||!r.isValid())&&null!=t.graphic&&null!=t.graphic.layer&&null!=t.graphic.getImage()){t.graphic._project();var u=t.graphic._pxBounds;null!=u&&u.isValid()&&(r.extend(this._map.layerPointToLatLng(u.min)),r.extend(this._map.layerPointToLatLng(u.max)))}if(r&&r.isValid()){for(var p=0,h=o.length;p<h;p++){this._mergeStyleToSymbolText(o[p]);var c=o[p].textContent;if(null!==c&&0!==c.length){this._calculateSize(t,o[p]);var g=this.addFrame||o[p].border;o[p].textPosition=void 0===o[p].textPosition?0:o[p].textPosition;var y,f,P,d=0,S=0;g&&(d=SuperMap.Plot.PlottingUtil.getTextWidth(o[p].style,o[p].textContent)+2*o[p].paddingX,S=parseInt(o[p].style.fontSize)+2*o[p].paddingY);var m=L.point(0,0),b=L.point(0,0);switch(o[p].textPosition){case SuperMap.Plot.AnnoPosition.LEFTTOP:o[p].style.labelAlign="rb",y=L.latLng(r.getNorth(),r.getWest()),(f=this._map.latLngToLayerPoint(y)).x+=o[p].offsetX,f.y+=o[p].offsetY,!0===g&&(m.x=f.x,m.y=f.y,b.x=f.x-d,b.y=f.y-S);break;case SuperMap.Plot.AnnoPosition.LEFTBOTTOM:o[p].style.labelAlign="rt",y=L.latLng(r.getSouth(),r.getWest()),(f=this._map.latLngToLayerPoint(y)).x+=o[p].offsetX,f.y+=o[p].offsetY,!0===g&&(m.x=f.x,m.y=f.y,b.x=f.x-d,b.y=f.y+S);break;case SuperMap.Plot.AnnoPosition.RIGHTTOP:o[p].style.labelAlign="lb",y=L.latLng(r.getNorth(),r.getEast()),(f=this._map.latLngToLayerPoint(y)).x+=o[p].offsetX,f.y+=o[p].offsetY,!0===g&&(m.x=f.x,m.y=f.y,b.x=f.x+d,b.y=f.y-S);break;case SuperMap.Plot.AnnoPosition.RIGHTBOTTOM:o[p].style.labelAlign="lt",y=L.latLng(r.getSouth(),r.getEast()),(f=this._map.latLngToLayerPoint(y)).x+=o[p].offsetX,f.y+=o[p].offsetY,!0===g&&(m.x=f.x,m.y=f.y,b.x=f.x+d,b.y=f.y+S);break;case SuperMap.Plot.AnnoPosition.TOP:o[p].style.labelAlign="cb",y=L.latLng(r.getNorth(),(r.getWest()+r.getEast())/2),(f=this._map.latLngToLayerPoint(y)).x+=o[p].offsetX,f.y+=o[p].offsetY,!0===g&&(m.x=f.x-d/2,m.y=f.y,b.x=f.x+d/2,b.y=f.y-S);break;case SuperMap.Plot.AnnoPosition.BOTTOM:o[p].style.labelAlign="ct",y=L.latLng(r.getSouth(),(r.getWest()+r.getEast())/2),(f=this._map.latLngToLayerPoint(y)).x+=o[p].offsetX,f.y+=o[p].offsetY,!0===g&&(m.x=f.x-d/2,m.y=f.y,b.x=f.x+d/2,b.y=f.y+S);break;case SuperMap.Plot.AnnoPosition.LEFT:o[p].style.labelAlign="rm",y=L.latLng((r.getSouth()+r.getNorth())/2,r.getWest()),(f=this._map.latLngToLayerPoint(y)).x+=o[p].offsetX,f.y+=o[p].offsetY,!0===g&&(m.x=f.x,m.y=f.y+S/2,b.x=f.x-d,b.y=f.y-S/2);break;case SuperMap.Plot.AnnoPosition.RIGHT:o[p].style.labelAlign="lm",y=L.latLng((r.getSouth()+r.getNorth())/2,r.getEast()),(f=this._map.latLngToLayerPoint(y)).x+=o[p].offsetX,f.y+=o[p].offsetY,!0===g&&(m.x=f.x,m.y=f.y+S/2,b.x=f.x+d,b.y=f.y-S/2);break;case SuperMap.Plot.AnnoPosition.ANCHOR:o[p].style.labelAlign="lm",y=t.symbolType===SuperMap.Plot.SymbolType.DOTSYMBOL?t.latLngs[0]:r.getCenter(),(f=this._map.latLngToLayerPoint(y)).x+=o[p].offsetX,f.y+=o[p].offsetY,o[p].offsetX>0?(o[p].style.labelAlign="lm",!0===g&&(m.x=f.x,m.y=f.y+S/2,b.x=f.x+d,b.y=f.y-S/2)):(o[p].style.labelAlign="rm",!0===g&&(m.x=f.x,m.y=f.y+S/2,b.x=f.x-d,b.y=f.y-S/2))}var v=this._map.layerPointToLatLng(f);if(0!==o[p].offsetX||0!==o[p].offsetY){var M={};M.positionPoints=[v,y],M.style={},M.type=SuperMap.Plot.SymbolType.POLYLINESYMBOL,e.push(M)}var A=SuperMap.Util.copyAttributes(s,this.symbolTexts[p].style);if(g){var T=this._map.layerPointToLatLng(m),_=this._map.layerPointToLatLng(b),O={};O.positionPoints=[T,_],O.style=SuperMap.Util.cloneObject(A),O.type=SuperMap.Plot.SymbolType.RECTANGLESYMBOL,e.push(O),P=L.latLng((_.lat-T.lat)/2+T.lat,(T.lng-_.lng)/2+_.lng)}else P=v;var x={};x.positionPoints=P,x.type=SuperMap.Plot.SymbolType.TEXTSYMBOL,x.style=SuperMap.Util.cloneObject(A),x.textContent=o[p].textContent,g&&(x.style.labelAlign="cm"),e.push(x),this.latLngs.push(v)}}for(var w,E=0;E<e.length;E++)w=L.Util.isArray(e[E].positionPoints)?e[E].positionPoints:[e[E].positionPoints],this._createAndDrawLayer(e[E].type,w,e[E].style,e[E].textContent)}}}},_calculatePositionPoints:function(){this.latLngs=[];var t=this.symbolTexts;if(t.length>0){var e=this._map.getFeatureByUuid(this.associatedUuid);if(null===e||void 0===e)return;var o=e.getBounds();if((null==o||!o.isValid())&&null!=e.graphic&&null!=e.graphic.layer&&null!=e.graphic.getImage()){e.graphic._project();var i=e.graphic._pxBounds;null!=i&&i.isValid()&&(o.extend(this._map.layerPointToLatLng(i.min)),o.extend(this._map.layerPointToLatLng(i.max)))}if(!o||!o.isValid())return;for(var l=0,n=t.length;l<n;l++){var a=t[l].textContent;if(null!==a&&0!==a.length){var s;switch(t[l].textPosition=void 0===t[l].textPosition?0:t[l].textPosition,t[l].textPosition){case SuperMap.Plot.AnnoPosition.LEFTTOP:s=L.latLng(o.getNorth(),o.getWest());break;case SuperMap.Plot.AnnoPosition.LEFTBOTTOM:s=L.latLng(o.getSouth(),o.getWest());break;case SuperMap.Plot.AnnoPosition.RIGHTTOP:s=L.latLng(o.getNorth(),o.getEast());break;case SuperMap.Plot.AnnoPosition.RIGHTBOTTOM:s=L.latLng(o.getSouth(),o.getEast());break;case SuperMap.Plot.AnnoPosition.TOP:s=L.latLng(o.getNorth(),(o.getWest()+o.getEast())/2);break;case SuperMap.Plot.AnnoPosition.BOTTOM:s=L.latLng(o.getSouth(),(o.getWest()+o.getEast())/2);break;case SuperMap.Plot.AnnoPosition.LEFT:s=L.latLng((o.getSouth()+o.getNorth())/2,o.getWest());break;case SuperMap.Plot.AnnoPosition.RIGHT:s=L.latLng((o.getSouth()+o.getNorth())/2,o.getEast());break;case SuperMap.Plot.AnnoPosition.ANCHOR:t[l].style.labelAlign="lm",s=e.symbolType===SuperMap.Plot.SymbolType.DOTSYMBOL?e.latLngs[0]:o.getCenter()}var r=this._map.latLngToLayerPoint(s);r.x+=t[l].offsetX,r.y+=t[l].offsetY,this.latLngs.push(this._map.layerPointToLatLng(r))}}}},destroy:function(){this.frame=!1,this.symbolTexts=null,i.GraphicObject.prototype.destroy.call(this)},_mergeStyleToSymbolText:function(t){if(null!==this.components)for(var e in null!==t.style&&void 0!==t.style||(t.style={}),this.style)t.style.hasOwnProperty(e)||(t.style[e]=this.style[e])},_calculateSize:function(t,e){this.scaleByMap=t.scaleByMap,!1===this.scaleByMap||!0===this.style.sizeFixed?this.fromZoom=this._map.getZoom():this.dScale=t.dScale,void 0!==e.prevStrokeWidth&&e.prevStrokeWidth!==e.style.weight&&(e.strokeWidth=e.style.weight,e.prevStrokeWidth=e.style.weight),!0===this.scaleByMap&&!1===this.style.sizeFixed&&(void 0===e.weight&&(e.weight=e.style.weight),this.fromZoom<=this._map.getZoom()&&(e.style.weight=t.style.weight),e.prevStrokeWidth=e.style.weight),void 0!==e.prevFontSize&&e.prevFontSize!==e.style.fontSize&&(e.fontSize=e.style.fontSize/this.dScale,e.prevFontSize=e.style.fontSize),!0===this.scaleByMap&&!1===this.style.sizeFixed&&(void 0===e.fontSize&&(e.fontSize=e.style.fontSize),e.style.fontSize=e.fontSize*this.dScale,e.prevFontSize=e.style.fontSize)},_modifyPoint:function(t,e){this._calculateOffset(t,e),this.redraw()},_calculateOffset:function(t,e){if(t<this.symbolTexts.length){var o=this.symbolTexts[t].textPosition,i=this._map.latLngToLayerPoint(e),l=this._map.getFeatureByUuid(this.associatedUuid);if(null===l||void 0===l)return;var n,a,s=l.getBounds();if((null==s||!s.isValid())&&null!=l.graphic&&null!=l.graphic.layer&&null!=l.graphic.getImage()){l.graphic._project();var r=l.graphic._pxBounds;null!=r&&r.isValid()&&(s.extend(this._map.layerPointToLatLng(r.min)),s.extend(this._map.layerPointToLatLng(r.max)))}if(!s||!s.isValid())return;0===o?(n=L.latLng(s.getNorth(),s.getWest()),a=this._map.latLngToLayerPoint(n),this.symbolTexts[t].offsetX=i.x-a.x,this.symbolTexts[t].offsetY=i.y-a.y):1===o?(n=L.latLng(s.getSouth(),s.getWest()),a=this._map.latLngToLayerPoint(n),this.symbolTexts[t].offsetX=i.x-a.x,this.symbolTexts[t].offsetY=i.y-a.y):2===o?(n=L.latLng(s.getNorth(),s.getEast()),a=this._map.latLngToLayerPoint(n),this.symbolTexts[t].offsetX=i.x-a.x,this.symbolTexts[t].offsetY=i.y-a.y):3===o?(n=L.latLng(s.getSouth(),s.getEast()),a=this._map.latLngToLayerPoint(n),this.symbolTexts[t].offsetX=i.x-a.x,this.symbolTexts[t].offsetY=i.y-a.y):4===o?(n=L.latLng(s.getNorth(),(s.getWest()+s.getEast())/2),a=this._map.latLngToLayerPoint(n),this.symbolTexts[t].offsetX=i.x-a.x,this.symbolTexts[t].offsetY=i.y-a.y):5===o?(n=L.latLng(s.getSouth(),(s.getWest()+s.getEast())/2),a=this._map.latLngToLayerPoint(n),this.symbolTexts[t].offsetX=i.x-a.x,this.symbolTexts[t].offsetY=i.y-a.y):6===o?(n=L.latLng((s.getNorth()+s.getSouth())/2,s.getWest()),a=this._map.latLngToLayerPoint(n),this.symbolTexts[t].offsetX=i.x-a.x,this.symbolTexts[t].offsetY=i.y-a.y):7===o?(n=L.latLng((s.getNorth()+s.getSouth())/2,s.getEast()),a=this._map.latLngToLayerPoint(n),this.symbolTexts[t].offsetX=i.x-a.x,this.symbolTexts[t].offsetY=i.y-a.y):o===SuperMap.Plot.AnnoPosition.ANCHOR&&(n=l.symbolType===SuperMap.Plot.SymbolType.DOTSYMBOL?l.latLngs[0]:s.getCenter(),a=this._map.latLngToLayerPoint(n),this.symbolTexts[t].offsetX=i.x-a.x,this.symbolTexts[t].offsetY=i.y-a.y)}},_reView:function(){this.fire(SuperMap.Plot.Event.reseteditmarkersvalues)},move:function(){},_parseSymbolData:function(){if(i.GraphicObject.prototype._parseSymbolData.call(this),this.symbolData){this.addFrame=this.symbolData.addFrame,this.symbolTexts=[];for(var t=0,e=this.symbolData.symbolTexts.length;t<e;t++){var o=new SuperMap.Plot.GeoSymbolText;o.textContent=this.symbolData.symbolTexts[t].textContent,o.textPosition=this.symbolData.symbolTexts[t].textPosition,o.style=this.symbolData.symbolTexts[t].style,o.offsetX=this.symbolData.symbolTexts[t].offsetX,o.offsetY=this.symbolData.symbolTexts[t].offsetY,this.symbolTexts.push(o)}}},_setSymbolData:function(){i.GraphicObject.prototype._setSymbolData.call(this),this.symbolData&&(this.symbolData.symbolTexts=this.symbolTexts,this.symbolData.addFrame=this.addFrame)},setStyle:function(t){if(t.fontSize&&this.style.fontSize!==t.fontSize||this.style.display!==t.display&&t.display){SuperMap.Util.extend(this.style,t);for(var e=0,o=this.symbolTexts.length;e<o;e++)SuperMap.Util.copyAttributes(this.symbolTexts[e].style,t);this.redraw()}else{SuperMap.Util.extend(this.style,t);for(var i=0;i<this.symbolTexts.length;i++)SuperMap.Util.copyAttributes(this.symbolTexts[i].style,t);for(var l in this.components)delete t.labelAlign,SuperMap.Util.copyAttributes(this.components[l].options,t),this._copyStyleForCell(this.components[l].options,this.style,this.components[l]),this.components[l].setStyle(this.components[l].options)}}})),n=e.geoSymbolText=function(t,e,o,i){return new l(t,e,o,i)};L.supermap.plotting.symbolText=n,L.supermap.plotting.SymbolText=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.satelliteTimeWindows=e.SatelliteTimeWindows=void 0,o(0);var i=o(1),l=e.SatelliteTimeWindows=i.GraphicObject.extend({timeWindows:[],initialize:function(t,e,o,l){this.libID=0,this.code=SuperMap.Plot.SymbolType.SATELLITETIMEWINDOWS,this.symbolType=SuperMap.Plot.SymbolType.SATELLITETIMEWINDOWS,this.symbolName="卫星时间窗",i.GraphicObject.prototype.initialize.call(this,t,e,o,l),this.scaleValues||(this.scaleValues=[])},_calculateParts:function(){if(this.associatedUuid){var t=this._map.getFeatureByUuid(this.associatedUuid);if(null===t||null===t.orbitPoints)return}for(var e=!1,o=0;o<t.timeWindows.length;o++)if(this===t.timeWindows[o]){e=!0;break}if(e||t.timeWindows.push(this),this.type)for(var i=0;i<this.timeWindows.length;i++)this.timeWindows[i].type=this.type;if(this.scalePoints=[],null!==this.timeWindows)for(var l=t.orbitPoints,n=0;n<this.timeWindows.length;n++){var a,s;if("Number"===this.timeWindows[n].type){for(var r=0,u=l.length;r<u;r++)if(this.timeWindows[n].startOrbitPoint===l[r].number&&(a=r),this.timeWindows[n].endOrbitPoint===l[r].number){s=r;break}}else if("Time"===this.timeWindows[n].type)for(var p=0;p<l.length;p++)if(this.timeWindows[n].startOrbitPoint===l[p].time&&(a=p),this.timeWindows[n].endOrbitPoint===l[p].time){s=p;break}for(var h=[],c=a;c<=s;c++)h.push(new L.latLng(l[c].y,l[c].x));h.length>1&&(this._createAndDrawLayer(24,h,{surroundLineFlag:!1,lineWidthLimit:!0,weight:4*t.style.weight+this.style.weight}),h[0].isScalePoint=!0,h[0].tag=2*n,this.scalePoints.push(h[0]),h[h.length-1].isScalePoint=!0,h[h.length-1].tag=2*n+1,this.scalePoints.push(h[h.length-1]))}},calculateBounds:function(){this.bounds=null;var t=new L.Bounds,e=this.components;if(e)for(var o=0;o<e.length;o++)t.extend(e[o].getBounds());null!==t.left&&null!==t.bottom&&null!==t.right&&null!==t.top&&this.setBounds(t)},move:function(){},_modifyPoint:function(t,e){if(e.isScalePoint){var o=this._map.getFeatureByUuid(this.associatedUuid);if(!o)return;var i=o.getLatLngs(),l=o.orbitPoints,n=L.Util.latLngsToSuperMapPoints(e),a=L.Util.latLngsToSuperMapPoints(i);if(t%2==0){var s;t/=2,s=this.timeWindows[t].endOrbitPoint-this.timeWindows[t].startOrbitPoint;for(var r=SuperMap.Plot.PlottingUtil.distance(n[0],a[0]),u=0,p=0;p<i.length-s;p++)r>=SuperMap.Plot.PlottingUtil.distance(n[0],a[p])&&(r=SuperMap.Plot.PlottingUtil.distance(n[0],a[p]),u=p);for(var h=0;h<this.timeWindows.length;h++)"Number"===this.timeWindows[h].type?(this.timeWindows[t].startOrbitPoint=u+l[0].number,this.timeWindows[t].endOrbitPoint=u+s+l[0].number):"Time"===this.timeWindows[h].type&&(this.timeWindows[t].startOrbitPoint=u+l[0].time,this.timeWindows[t].endOrbitPoint=u+s+l[0].time)}else{t=(t-1)/2;for(var c=SuperMap.Plot.PlottingUtil.distance(n[0],a[a.length-1]),g=0;g<i.length;g++)c>=SuperMap.Plot.PlottingUtil.distance(n[0],a[g])&&(c=SuperMap.Plot.PlottingUtil.distance(n[0],a[g]),u=g);for(var y=0;y<this.timeWindows.length;y++)"Number"===this.timeWindows[y].type?(this.timeWindows[t].endOrbitPoint=u+l[0].number,this.timeWindows[t].endOrbitPoint<=this.timeWindows[t].startOrbitPoint&&(this.timeWindows[t].endOrbitPoint=this.timeWindows[t].startOrbitPoint+1)):"Time"===this.timeWindows[y].type&&(this.timeWindows[t].endOrbitPoint=u+l[0].time,this.timeWindows[t].endOrbitPoint<=this.timeWindows[t].startOrbitPoint&&(this.timeWindows[t].endOrbitPoint=this.timeWindows[t].startOrbitPoint+1))}}this.redraw()}}),n=e.satelliteTimeWindows=function(t,e,o,i){return new l(t,e,o,i)};L.supermap.plotting.satelliteTimeWindows=n,L.supermap.plotting.SatelliteTimeWindows=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.satellite=e.Satellite=void 0,o(0);var i=o(1),l=e.Satellite=i.GraphicObject.extend({orbitPoints:[],visible:null,timeWindows:null,setVisible:function(t){this.visible!==t&&(this.visible=t,this.redraw(),null!==this._map.getPlotEditControl()&&this.isSelected&&this.fire(SuperMap.Plot.Event.reseteditmarkersvalues))},getBounds:function(){var t=this;return t._bounds=new L.LatLngBounds,t.components.map(function(e){return e.symbolType===SuperMap.Plot.SymbolType.DOTSYMBOL?t._bounds.extend(e.getBoundsWithText()):t._bounds.extend(e.getBounds()),e}),t._bounds},getVisible:function(){return this.visible},initialize:function(t,e,o,l){this.libID=0,this.code=SuperMap.Plot.SymbolType.SATELLITE,this.symbolType=SuperMap.Plot.SymbolType.SATELLITE,this.symbolName="卫星",null===this.visible&&(this.visible=!0),null===this.timeWindows&&(this.timeWindows=[]),0===this.orbitPoints.length&&(this.orbitPoints=[]),this.scaleValues||(this.scaleValues=[]),i.GraphicObject.prototype.initialize.call(this,t,e,o,l)},_calculateParts:function(){if(null!==this.orbitPoints&&this.visible){if(null===this.latLngs||0===this.latLngs.length)this.latLngs=L.Util.superMapPointsToLatLngs(this.orbitPoints);else for(var t=0,e=this.latLngs.length;t<e;t++)this.orbitPoints[t].x=this.latLngs[t].lng,this.orbitPoints[t].y=this.latLngs[t].lat;this._createAndDrawLayer(24,L.Util.cloneLatLngs(this.latLngs),this.style,"")}0===this.scaleValues.length&&this.scaleValues.push(.5);var o=L.Util.latLngsToSuperMapPoints(this.latLngs),i=SuperMap.Plot.PlottingUtil.polylineDistance(o),l=SuperMap.Plot.PlottingUtil.findPointInPolyLine(o,i*this.scaleValues[0]).pt.clone(),n=Math.floor(this.orbitPoints.length/2),a=new SuperMap.Geometry.Point(this.orbitPoints[n].x,this.orbitPoints[n].y),s=SuperMap.Plot.PlottingUtil.radian(a,new SuperMap.Geometry.Point(this.orbitPoints[n-1].x,this.orbitPoints[n-1].y));this.subSymbols[0].symbolData.dRotate=180*s/Math.PI,this.subSymbols[0].symbolData.textContent=this.textContent,this.subSymbols[0].symbolData.annotationPosition=7;var r={symbolData:SuperMap.Util.cloneObject(this.subSymbols[0].symbolData),serverUrl:this.serverUrl,enableEdit:!1,style:this.style,scaleByMap:!0},u=SuperMap.Plot.PlottingUtil.cloneObject(this.style),p=L.supermap.plotting.PlottingObject.createSymbol(this.subSymbols[0].libID,this.subSymbols[0].code,[new L.latLng(l.y,l.x)],r,u);this._addComponents(p),p.isEdit=!0,this.scalePoints=[];var h=new L.latLng(l.y,l.x);h.isScalePoint=!0,h.tag=0,this.scalePoints.push(h)},move:function(t,e){L.Util.moveLatLngs(this.getLatLngs(),t,e);for(var o=0,i=this.orbitPoints.length;o<i;o++)this.orbitPoints[o].x+=e,this.orbitPoints[o].y+=t;for(var l=0,n=this.timeWindows.length;l<n;l++){var a=this.timeWindows[l];null!==a&&a.redraw()}if(0!==this.avoidRegions.length)for(var s=0,r=this.avoidRegions.length;s<r;s++)L.Util.moveLatLngs(this.avoidRegions[s].getLatLngs(),t,e);if(!1===this.visible)for(var u=0;u<this.components.length;u++)this.components[u].symbolType===SuperMap.Plot.SymbolType.DOTSYMBOL&&this.components[u].move(t,e);else this.redraw()},_resizeLatLngs:function(t,e,o,l){i.GraphicObject.prototype._resizeLatLngs.call(this,t,e,o,l);for(var n=0,a=this.orbitPoints.length;n<a;n++)this.orbitPoints[n].x=this.latLngs[n].lng,this.orbitPoints[n].y=this.latLngs[n].lat;for(var s=0,r=this.timeWindows.length;s<r;s++){var u=this.timeWindows[s];null!==u&&u.redraw()}},setRotate:function(t){this.dRotate=t,null===this.anchorPoint&&(this.anchorPoint=this.getBounds().getCenter());for(var e=0,o=this.avoidRegions.length;e<o;e++)this.avoidRegions[e].rotate(t,this.anchorPoint);i.GraphicObject.prototype._rotate.call(this,t,this.anchorPoint);for(var l=0,n=this.orbitPoints.length;l<n;l++)this.orbitPoints[l].x=this.latLngs[l].lng,this.orbitPoints[l].y=this.latLngs[l].lat;for(var a=0;a<this.timeWindows.length;a++){var s=this.timeWindows[a];null!==s&&s.redraw()}this.fire(SuperMap.Plot.Event.reseteditmarkersvalues)},_reView:function(){for(var t=0,e=this.components.length;t<e;t++)this.components[t].symbolType===SuperMap.Plot.SymbolType.DOTSYMBOL&&(this.components[t]._reView(),this.components[t]._handleAnnotation(),this.subSymbols[0].symbolData=SuperMap.Util.cloneObject(this.components[t].getSymbolData()))},_modifyPoint:function(t,e){if(e.isScalePoint){if(0!==t)return;var o=L.Util.latLngsToSuperMapPoints(this.getLatLngs()),i=L.Util.latLngsToSuperMapPoints(e),l=SuperMap.Plot.PlottingUtil.clonePoints(o);if((l=SuperMap.Plot.PlottingUtil.clearSamePts(l)).length<this.minEditPts)return;var n=SuperMap.Plot.PlottingUtil.generateBeizerPointsNoCtrlPt(l);n=SuperMap.Plot.PlottingUtil.clearSamePts(n);for(var a,s=SuperMap.Plot.PlottingUtil.polylineDistance(n),r=SuperMap.Plot.PlottingUtil.distance(n[0],i[0]),u=0;u<n.length;u++)r>SuperMap.Plot.PlottingUtil.distance(n[u],i[0])&&(r=SuperMap.Plot.PlottingUtil.distance(n[u],i[0]),a=u);var p=0;0===a&&(a=1);for(var h=0;h<a;h++)p+=SuperMap.Plot.PlottingUtil.distance(n[h],n[h+1]);this.scaleValues[0]=p/s}this.redraw()}}),n=e.satellite=function(t,e,o,i){return new l(t,e,o,i)};L.supermap.plotting.satellite=n,L.supermap.plotting.Satellite=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.interferenceBeam=e.InterferenceBeam=void 0,o(0);var i=o(1),l=e.InterferenceBeam=i.GraphicObject.extend({initialize:function(t,e,o,l){i.GraphicObject.prototype.initialize.call(this,t,e,o,l),this.libID=0,this.code=SuperMap.Plot.SymbolType.INTERFERENCEBEAM,this.symbolType=SuperMap.Plot.SymbolType.INTERFERENCEBEAM,this.symbolName="干扰波束",this.minEditPts=3,this.maxEditPts=9999},destroy:function(){i.GraphicObject.prototype.destroy.apply(this,arguments)},_calculateParts:function(){null!==this.getLatLngs()&&this.getLatLngs().length>=this.minEditPts&&this._createAndDrawLayer(32,this.latLngs,this.style,"")},move:function(t,e){L.Util.moveLatLngs(this.getLatLngs(),t,e);for(var o=0,i=this.avoidRegions.length;o<i;o++)this.avoidRegions[o].move(t,e);this.redraw()},setRotate:function(t){for(var e in this.dRotate=t,null===this.anchorPoint&&(this.anchorPoint=this.getBounds().getCenter()),this.components)L.Util.rotateLatLngs(this.components[e].getLatLngs(),this.anchorPoint,t),this.components[e].setLatLngs(this.components[e].getLatLngs());for(var o=0,i=this.avoidRegions.length;o<i;o++)this.avoidRegions[o].rotate(this.dRotate,this.anchorPoint)},_reView:function(){}}),n=e.interferenceBeam=function(t,e,o,i){return new l(t,e,o,i)};L.supermap.plotting.interferenceBeam=n,L.supermap.plotting.InterferenceBeam=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.navyRoute=e.NavyRoute=void 0,o(0);var i=o(4),l=e.NavyRoute=i.Route.extend({initialize:function(t,e,o,l){this.libID=0,this.code=SuperMap.Plot.SymbolType.NAVYROUTE,this.symbolType=SuperMap.Plot.SymbolType.NAVYROUTE,this.symbolName="海军航线",i.Route.prototype.initialize.call(this,t,e,o,l)}}),n=e.navyRoute=function(t,e,o,i){return new l(t,e,o,i)};L.supermap.plotting.navyRoute=n,L.supermap.plotting.NavyRoute=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.missileRoute=e.MissileRoute=void 0,o(0);var i=o(4),l=e.MissileRoute=i.Route.extend({initialize:function(t,e,o,l){this.libID=0,this.code=SuperMap.Plot.SymbolType.MISSILEROUTE,this.symbolType=SuperMap.Plot.SymbolType.MISSILEROUTE,this.symbolName="导弹航线",i.Route.prototype.initialize.call(this,t,e,o,l)}}),n=e.missileRoute=function(t,e,o,i){return new l(t,e,o,i)};L.supermap.plotting.missileRoute=n,L.supermap.plotting.MissileRoute=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.airRoute=e.AirRoute=void 0,o(0);var i=o(4),l=e.AirRoute=i.Route.extend({space:null,inner:null,initialize:function(t,e,o,l){i.Route.prototype.initialize.call(this,t,e,o,l),this.libID=0,this.code=SuperMap.Plot.SymbolType.AIRROUTE,this.symbolType=SuperMap.Plot.SymbolType.AIRROUTE,this.symbolName="空军航线",null===this.space&&(this.space=20),null===this.inner&&(this.inner=!1)},destroy:function(){this.space=null,this.inner=null,i.Route.prototype.destroy.call(this)},redraw:function(){if(this._initRoute(),void 0!==this.arrRoutePts&&null!==this.arrRoutePts)for(var t=0;t<this.arrRoutePts.length;t++){var e=this.arrRoutePts[t];if(SuperMap.Util.isArray(e)&&!(e.length<2)){var o=L.supermap.plotting.PlottingObject.createSymbol(0,SuperMap.Plot.SymbolType.POLYLINESYMBOL,e,{serverUrl:this.serverUrl,enableEdit:!1});this._addComponents(o)}}for(var i=0;i<this.routeNodes.length;i++){var l=this.routeNodes[i];if(null!==l&&(l.towardNodes&&null!==l.towardNodes)){for(var n=0;n<l.towardNodes.length;n++)if(l.towardNodes[n]instanceof SuperMap.Plot.TowardNode){var a=this._getNodeByUuid(l.towardNodes[n].routeNodeId);if(null!==a){if(0===this.arrRoutePts.length){var s=[];s.push(L.latLng(l.y,l.x)),s.push(L.latLng(a.y,a.x));var r=L.supermap.plotting.PlottingObject.createSymbol(0,SuperMap.Plot.SymbolType.POLYLINESYMBOL,s,{enableEdit:!1});this._addComponents(r),r._startRouteNode=l.id,r._endRouteNode=a.id}this._createLiterateSign(l,l.towardNodes[n])}}this._createRouteNode(l)}}this._finishRoute()},_createLiterateSign:function(t,e){for(var o=0;o<this.prevLiterateSign.length;){if(this.prevLiterateSign[o]._startRouteNode===t.id&&this.prevLiterateSign[o]._endRouteNode===e.routeNodeId)return this.prevLiterateSign[o].startRouteNode=t,this.prevLiterateSign[o].towardNode=e,this.prevLiterateSign[o].redraw(),this.components.push(this.prevLiterateSign[o]),void this.prevLiterateSign.splice(o,1);o++}if(null!==e.textContent&&0!==e.textContent.length){var i=SuperMap.Util.copyAttributes(SuperMap.Plot.PlottingUtil.cloneObject(this.style),e.style),l=L.supermap.plotting.PlottingObject.createSymbol(0,SuperMap.Plot.SymbolType.LITERATESIGN,null,{startRouteNode:t,towardNode:e,route:this,inner:this.inner,space:this.space},i);this._addComponents(l),l._startRouteNode=t.id,l._endRouteNode=e.routeNodeId}}}),n=e.airRoute=function(t,e,o,i){return new l(t,e,o,i)};L.supermap.plotting.airRoute=n,L.supermap.plotting.AirRoute=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.pathText=e.PathText=void 0,o(0);var i=o(7),l=e.PathText=i.AlgoSymbol.extend({relLineText:0,showPathLine:!0,showPathLineArrow:!1,isCurve:!1,isAvoid:!1,textToLineDistance:0,getRelLineText:function(){return this.relLineText},setRelLineText:function(t){this.relLineText!==t&&(this.relLineText=t,this.redraw(),this.fire(SuperMap.Plot.Event.reseteditmarkersvalues))},getShowPathLine:function(){return this.showPathLine},setShowPathLine:function(t){this.showPathLine!==t&&(this.showPathLine=t,this.redraw(),this.fire(SuperMap.Plot.Event.reseteditmarkersvalues))},getShowPathLineArrow:function(){return this.showPathLineArrow},setShowPathLineArrow:function(t){this.showPathLineArrow!==t&&(this.showPathLineArrow=t,this.showPathLine&&(this.redraw(),this.fire(SuperMap.Plot.Event.reseteditmarkersvalues)))},getIsCurveLine:function(){return this.isCurve},setCurveLine:function(t){this.isCurve!==t&&(this.isCurve=t,this.showPathLine&&(this.redraw(),this.fire(SuperMap.Plot.Event.reseteditmarkersvalues)))},getIsAvoidLine:function(){return this.isAvoid},setAvoidLine:function(t){this.isAvoid!==t&&(this.isAvoid=t,this.relLineText===SuperMap.Plot.RelLineText.ONLINE&&this.showPathLine&&(this.redraw(),this.fire(SuperMap.Plot.Event.reseteditmarkersvalues)))},getSpace:function(){return this.textToLineDistance},setSpace:function(t){this.textToLineDistance!==t&&(this.textToLineDistance=t,this.relLineText!==SuperMap.Plot.RelLineText.ONLINE&&(this.redraw(),this.fire(SuperMap.Plot.Event.reseteditmarkersvalues)))},initialize:function(t,e,o,l){this.code=SuperMap.Plot.SymbolType.PATHTEXT,this.libID=0,this.symbolType=SuperMap.Plot.SymbolType.PATHTEXT,this.symbolName="沿线注记",this.minEditPts=2,this.maxEditPts=9999,i.AlgoSymbol.prototype.initialize.call(this,t,e,o,l)},_reView:function(){this.fromZoom!==this._map.getZoom()&&(this.redraw(),this.fromZoom=this._map.getZoom())},toSuperMapAlgorithms:function(){i.AlgoSymbol.prototype.toSuperMapAlgorithms.call(this),this.superMapAlgoSymbol.relLineText=this.relLineText,this.superMapAlgoSymbol.showPathLine=this.showPathLine,this.superMapAlgoSymbol.showPathLineArrow=this.showPathLineArrow,this.superMapAlgoSymbol.isCurve=this.isCurve,this.superMapAlgoSymbol.isAvoid=this.isAvoid,this.superMapAlgoSymbol.textToLineDistance=this.textToLineDistance}}),n=e.pathText=function(t,e,o,i){return new l(t,e,o,i)};L.supermap.plotting.pathText=n,L.supermap.plotting.PathText=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.airDeployment=e.AirDeployment=void 0,o(0);var i=o(38),l=e.AirDeployment=i.NavyDeployment.extend({isShowTooltip:!0,getShowTooltip:function(){return this.isShowTooltip},setShowTooltip:function(t){if(this.isShowTooltip!==t)if(this.isShowTooltip=t,this.isShowTooltip&&0!==this.components.length){var e=this._map.getFeatureByUuid(this.associatedUuid),o=L.Util.cloneLatLngs(e.latLngs[0]),i=this._map.latLngToLayerPoint(L.latLng(o[0].lat,o[0].lng)),l=this._transitionPoint(new SuperMap.Geometry.Point(this.space,0),i),n=Math.abs(l.lng-o[0].lng),a=new L.LatLngBounds(L.latLng(this.bounds.getSouth()-n,this.bounds.getWest()-n),L.latLng(this.bounds.getNorth()+n,this.bounds.getEast()+n)),s=[];s.push(L.latLng(a.getNorth(),a.getWest())),s.push(L.latLng(a.getSouth(),a.getEast()));var r=L.latLng(o[0].lat,o[0].lng);r.isFixedPos=!0,s.push(r);var u=L.supermap.plotting.PlottingObject.createSymbol(0,SuperMap.Plot.SymbolType.ANNOFRAMESYMBOL,s,{serverUrl:this.serverUrl});this._addComponents(u)}else for(var p in this.components)if(320===this.components[p].symbolType){this.subObjects.splice(SuperMap.Util.indexOf(this.subObjects,this.components[p]),1);var h=SuperMap.Util.indexOf(this.components,this.components[p]);if(-1!==h){this.components[h]._clearComponents(),this.components.splice(h,1);break}}},initialize:function(t,e,o,l){i.NavyDeployment.prototype.initialize.call(this,t,e,o,l),this.libID=0,this.code=SuperMap.Plot.SymbolType.AIRDEPLOYMENT,this.symbolType=SuperMap.Plot.SymbolType.AIRDEPLOYMENT,this.symbolName="空军兵力部署",null===this.isShowTooltip&&(this.isShowTooltip=!0)},destroy:function(){this.isShowTooltip=null,i.NavyDeployment.prototype.destroy.call(this)},_calculateParts:function(){var t=this._map.getFeatureByUuid(this.associatedUuid);if(null!==t&&t.symbolType===SuperMap.Plot.SymbolType.DOTSYMBOL&&0!==t.latLngs.length){for(var e=!1,o=0;o<t.deployments.length;o++)if(this===t.deployments[o]){e=!0;break}if(e||t.deployments.push(this),0!==this.subObjects.length&&0===this.components.length)for(var i=0,l=this.subObjects.length;i<l;i++)this.subObjects[i].enableEdit=!0,this.subObjects[i].ownerGroup=this,this._addComponents(this.subObjects[i]);if(0===this.components.length){var n=L.Util.cloneLatLngs(t.latLngs[0]),a=this._map.latLngToLayerPoint(L.latLng(n[0].lat,n[0].lng)),s=this._transitionPoint(new SuperMap.Geometry.Point(this.space,0),a),r=Math.abs(s.lng-n[0].lng),u=new SuperMap.Geometry.Point(0,0),p=this._transitionPoint(u,a),h=new SuperMap.Geometry.Point(100,100),c=this._transitionPoint(h,a),g=new L.LatLngBounds(L.latLng(p.lat,p.lng),L.latLng(c.lat,c.lng)),y=Math.ceil(this._getSubSymbolCount(this.subSymbols.length-1)/this.colNum),f=Math.abs(g.getWest()-g.getEast())*this.colNum+r*(this.colNum-1),P=L.latLng(n[0].lat-r,n[0].lng-.5*f+.5*Math.abs(g.getEast()-g.getWest()));!0===this.isShowTooltip&&(P.lat-=4*r),this._setSubSymbolText();for(var d=[],S=0;S<this.subSymbols.length;S++)for(var m=0;m<this.subSymbols[S].totalNum;m++)d.push(this.subSymbols[S]);for(var b=0,v=0;v<y;v++){for(m=0;m<this.colNum&&!(b>=d.length);m++){var M=d[b];if(void 0!==M.symbolData&&null!==M.symbolData){for(var A=M.symbolData.libID,T=M.symbolData.code,_=P.lng+m*(r+Math.abs(g.getEast()-g.getWest())),O=P.lat-(2*r+Math.abs(g.getNorth()-g.getSouth())/2),x=0,w=0,E=0,C=0,I=0;I<M.symbolData.innerCells.length;I++)for(var D=0;D<M.symbolData.innerCells[I].positionPoints.length;D++)x<=M.symbolData.innerCells[I].positionPoints[D].x&&(x=M.symbolData.innerCells[I].positionPoints[D].x),w>=M.symbolData.innerCells[I].positionPoints[D].x&&(w=M.symbolData.innerCells[I].positionPoints[D].x),E<=M.symbolData.innerCells[I].positionPoints[D].y&&(E=M.symbolData.innerCells[I].positionPoints[D].y),C>=M.symbolData.innerCells[I].positionPoints[D].y&&(C=M.symbolData.innerCells[I].positionPoints[D].y);var R=L.latLng(O,_),N=this._map.latLngToLayerPoint(L.latLng(O,_)),U=new SuperMap.Geometry.Point((x+w)/2,E),B=new SuperMap.Geometry.Point(U.x,U.y),k=new SuperMap.Geometry.Point(d[b].symbolData.anchorPoint.x,d[b].symbolData.anchorPoint.y),F=this._transitionPoint(B,N),G=this._transitionPoint(k,N);R.lat+=G.lat-F.lat,R.lng+=G.lng-F.lng,M.symbolData.annotationPosition=5;var V=SuperMap.Util.cloneObject(M.symbolData),j=L.supermap.plotting.PlottingObject.createSymbol(A,T,R,{symbolData:V,scaleByMap:!0,minScale:0,maxScale:2048,space:0});j.enableEdit=!0,j.ownerGroup=this,this._addComponents(j),this.subObjects.push(j),b++}}this.bounds=this._calculateBounds(),P.lat=this.bounds.getSouth()}if(this.isShowTooltip){var Y=new L.LatLngBounds(L.latLng(this.bounds.getSouth()-r,this.bounds.getWest()-r),L.latLng(this.bounds.getNorth()+r+1.2,this.bounds.getEast()+r)),z=[];z.push(L.latLng(Y.getNorth(),Y.getWest())),z.push(L.latLng(Y.getSouth(),Y.getEast()));var W=L.latLng(n[0].lat,n[0].lng);W.isFixedPos=!0,z.push(W);var X=L.supermap.plotting.PlottingObject.createSymbol(0,SuperMap.Plot.SymbolType.ANNOFRAMESYMBOL,z,{serverUrl:this.serverUrl});for(var H in X.enableEdit=!0,X.ownerGroup=this,this.subObjects.splice(0,0,X),this._addComponents(X),this._clearComponents(),this.subObjects)this.subObjects[H].enableEdit=!0,this.subObjects[H].ownerGroup=this,this._addComponents(this.subObjects[H])}}}},_setSubSymbolText:function(){for(var t=0;t<this.subSymbols.length;t++)null!==this.subSymbols[t].symbolData&&(this.subSymbols[t].symbolData.textContent=this.subSymbols[t].textContent)},_parseSymbolData:function(){i.NavyDeployment.prototype._parseSymbolData.call(this),this.symbolData&&(this.isShowTooltip=this.symbolData.isShowTooltip)},_setSymbolData:function(){i.NavyDeployment.prototype._setSymbolData.call(this),this.symbolData&&(this.symbolData.isShowTooltip=this.isShowTooltip)}}),n=e.airDeployment=function(t,e,o,i){return new l(t,e,o,i)};L.supermap.plotting.airDeployment=n,L.supermap.plotting.AirDeployment=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.arcRegion=e.ArcRegion=void 0,o(0);var i=o(7),l=o(1),n=e.ArcRegion=i.AlgoSymbol.extend({centerPoint:null,radius:null,startAngle:null,endAngle:null,textPosition:null,radiusText:null,radiusPosAngle:null,radiusLineType:null,subSymbolDefaultPixelSize:15,getCirclePts:function(){return this.getArcPts(this.startAngle,this.endAngle)},setLatLngs:function(t){return this.latLngs=t,2===this.latLngs.length&&(this.centerPoint=this.latLngs[0],this.radius=SuperMap.Plot.PlottingUtil.distVincenty(this.latLngs[0],this.latLngs[1])),3===this.latLngs.length&&(this.startAngle=180*SuperMap.Plot.PlottingUtil.radian(new SuperMap.Geometry.Point(this.latLngs[0].lng,this.latLngs[0].lat),new SuperMap.Geometry.Point(this.latLngs[1].lng,this.latLngs[1].lat))/Math.PI,this.endAngle=180*SuperMap.Plot.PlottingUtil.radian(new SuperMap.Geometry.Point(this.latLngs[0].lng,this.latLngs[0].lat),new SuperMap.Geometry.Point(this.latLngs[2].lng,this.latLngs[2].lat))/Math.PI),this.redraw()},setRadius:function(t){this.radius!==t&&(this.radius=t,this.redraw(),this.fire(SuperMap.Plot.Event.reseteditmarkersvalues))},getRadius:function(){return this.radius},setStartAngle:function(t){this.startAngle!==t&&(this.startAngle=t,this.redraw(),this.fire(SuperMap.Plot.Event.reseteditmarkersvalues))},getStartAngle:function(){return this.startAngle},setEndAngle:function(t){this.endAngle!==t&&(this.endAngle=t,this.redraw(),this.fire(SuperMap.Plot.Event.reseteditmarkersvalues))},getEndAngle:function(){return this.endAngle},setTextPosition:function(t){this.textPosition!==t&&(this.textPosition=t,0!==this.textContent.length&&(this.redraw(),this.fire(SuperMap.Plot.Event.reseteditmarkersvalues)))},setRadiusText:function(t,e){e>1&&(e=1),e<0&&(e=0),this.radiusText[e]!==t&&(this.radiusText[e]=t,this.redraw(),this.fire(SuperMap.Plot.Event.reseteditmarkersvalues))},getRadiusText:function(t){return t>1&&(t=1),t<0&&(t=0),this.radiusText[t]},setRadiusTextPos:function(t){this.radiusPosAngle!==t&&(this.radiusPosAngle=t,0!==this.radiusText.length&&(this.redraw(),this.fire(SuperMap.Plot.Event.reseteditmarkersvalues)))},getRadiusTextPos:function(){return this.radiusPosAngle},setRadiusLineType:function(t){this.radiusLineType!==t&&(this.radiusLineType=t,0!==this.radiusText.length&&(this.redraw(),this.fire(SuperMap.Plot.Event.reseteditmarkersvalues)))},getRadiusLineType:function(){return this.radiusLineType},initialize:function(t,e,o,i){this.scalePoints=[],this.scaleValues=[],l.GraphicObject.prototype.initialize.call(this,t,e,o,i),this.libID=0,this.code=SuperMap.Plot.SymbolType.ARCREGION,this.symbolType=SuperMap.Plot.SymbolType.ARCREGION,this.symbolName="扇形区域",this.minEditPts=2,this.maxEditPts=3,null===this.circlePts&&(this.circlePts=[]),null===this.textPosition&&(this.textPosition=(this.startAngle+this.endAngle)/2),null===this.radiusText&&(this.radiusText=[]),null===this.radiusPosAngle&&(this.radiusPosAngle=(this.startAngle+this.endAngle)/2),null===this.radiusLineType&&(this.radiusLineType=SuperMap.Plot.RadiusLineType.NONE),void 0!==i.constantSize&&null!==i.constantSize||!1!==this.isEdit||(this.constantSize=!0),this.subSymbolDefaultPixelSize=15,0===this.scaleValues.length&&this.scaleValues.push(.1)},destroy:function(){this.centerPoint=null,this.radius=null,this.startAngle=null,this.endAngle=null,this.textPosition=null,this.radiusText=null,this.radiusPosAngle=null,this.radiusLineType=null,i.AlgoSymbol.prototype.destroy.call(this)},_calculateParts:function(){if(this.scalePoints=[],this.isEdit?1===this.latLngs.length&&this.centerPoint!==this.latLngs[0]&&(this.centerPoint=this.latLngs[0]):(2===this.latLngs.length&&(this.centerPoint=this.latLngs[0],this.radius=SuperMap.Plot.PlottingUtil.distVincenty(this.latLngs[0],this.latLngs[1])),3===this.latLngs.length&&(this.startAngle=180*SuperMap.Plot.PlottingUtil.radian(new SuperMap.Geometry.Point(this.latLngs[0].lng,this.latLngs[0].lat),new SuperMap.Geometry.Point(this.latLngs[1].lng,this.latLngs[1].lat))/Math.PI,this.endAngle=180*SuperMap.Plot.PlottingUtil.radian(new SuperMap.Geometry.Point(this.latLngs[0].lng,this.latLngs[0].lat),new SuperMap.Geometry.Point(this.latLngs[2].lng,this.latLngs[2].lat))/Math.PI)),this.centerPoint&&null!==this.centerPoint&&this.radius&&null!==this.radius){this.startAngle%=360,this.endAngle%=360,this.startAngle>this.endAngle&&(this.endAngle+=360);var t=SuperMap.Plot.PlottingUtil.equalFuzzy(this.startAngle,this.endAngle);t&&(this.startAngle=0,this.endAngle=360);var e=this.getArcPts(this.startAngle,this.endAngle);if(!t){var o=e[0][0].clone();o.isScalePoint=!0,o.tag=0;var i=e[e.length-1][e[e.length-1].length-1].clone();i.isScalePoint=!0,i.tag=1,this.scalePoints.push(o),this.scalePoints.push(i),e[0].splice(0,0,this.centerPoint.clone()),e[e.length-1].push(this.centerPoint.clone()),this.latLngs.length>2&&this.latLngs.splice(1,this.latLngs.length-1)}for(var l=0;l<e.length;l++)this._createAndDrawLayer(SuperMap.Plot.SymbolType.POLYLINESYMBOL,e[l],{surroundLineFlag:!1});0===this.latLngs.length&&this.latLngs.push(this.centerPoint.clone()),1===this.latLngs.length&&t&&this.latLngs.push(e[Math.ceil(e.length/2)].clone()),this._textGeometry(),this._radiusGeometry()}},_textGeometry:function(){if(0!==this.textContent.length){var t=90,e=!1;this.textPosition%=360,this.endAngle>this.startAngle&&(this.textPosition<this.endAngle&&this.textPosition>this.startAngle?(this.endAngle-this.textPosition<t&&(t=this.endAngle-this.textPosition),this.textPosition-this.startAngle<t&&(t=this.textPosition-this.startAngle)):this.textPosition+360<this.endAngle&&this.textPosition+360>this.startAngle?(this.textPosition+=360,this.endAngle-this.textPosition<t&&(t=this.endAngle-this.textPosition),this.textPosition-this.startAngle<t&&(t=this.textPosition-this.startAngle)):e=!0),this.startAngle>this.endAngle&&(this.textPosition>this.startAngle||this.textPosition<this.endAngle?e=!0:(this.startAngle-this.textPosition<t&&(t=this.startAngle-this.textPosition),this.textPosition-this.endAngle<t&&(t=this.textPosition-this.endAngle))),2*t<4&&(e=!0);var o=null;if(!0===e){var i=this.getBounds().getCenter();this._createAndDrawLayer(34,[i],{surroundLineFlag:!1,labelAlign:"cm"},this.textContent),o=i.clone()}else{var l=this.textPosition+t,n=this.textPosition-t,a=this.getArcPts(n,l),s=SuperMap.Plot.RelLineText.ONLEFTLINE;SuperMap.Plot.PlottingUtil.isPloyClockwise(a[0])&&(s=SuperMap.Plot.RelLineText.ONRIGHTLINE);for(var r=SuperMap.Plot.PlottingUtil.clonePoints(a[0]),u=[],p=r.length-1;p>=0;p--)u.push(r[p]);this._addComponents(L.supermap.plotting.PlottingObject.createSymbol(0,SuperMap.Plot.SymbolType.PATHTEXT,u,{textContent:this.textContent,showPathLine:!1,isCurve:!1,relLineText:s},this.style)),o=a[0][Math.ceil(a[0].length/2)].clone()}o.isScalePoint=!0,o.tag=2,this.scalePoints.push(o)}},_radiusGeometry:function(){if(0!==this.radiusText.length){this.radiusPosAngle%=360;var t=SuperMap.Plot.PlottingUtil.destinationVincenty(this.centerPoint,360-this.radiusPosAngle+90,1e3*this.radius),e=new SuperMap.Geometry.Point(t.lng,t.lat),o=new SuperMap.Geometry.Point(this.centerPoint.lng,this.centerPoint.lat),i=SuperMap.Plot.PlottingUtil.distance(o,e),l=[];if(l.push(this.centerPoint),l.push(L.latLng(e.y,e.x)),SuperMap.Plot.RadiusLineType.NONE!==this.radiusLineType&&this._createAndDrawLayer(SuperMap.Plot.SymbolType.POLYLINESYMBOL,l,{surroundLineFlag:!1}),this.radiusLineType===SuperMap.Plot.RadiusLineType.ARROW){var n;if(null===this.map)n=0;else{var a=this._map.layerPointToLatLng(L.point(0,0)),s=this._map.layerPointToLatLng(L.point(this.subSymbolDefaultPixelSize,0));n=SuperMap.Plot.PlottingUtil.distance(new SuperMap.Geometry.Point(a.lng,a.lat),new SuperMap.Geometry.Point(s.lng,s.lat))}var r=SuperMap.Plot.PlottingUtil.findPoint(e,o,n,12.5),u=SuperMap.Plot.PlottingUtil.findPoint(e,o,n,-12.5),p=[];p.push(L.latLng(e.y,e.x)),p.push(L.latLng(r.y,r.x)),p.push(L.latLng(u.y,u.x)),this._createAndDrawLayer(SuperMap.Plot.SymbolType.ARBITRARYPOLYGONSYMBOL,p,{surroundLineFlag:!1,fill:!0,fillLimit:!0,lineTypeLimit:!0})}if(SuperMap.Util.isArray(this.radiusText)||(this.radiusText=[this.radiusText]),this.radiusText.length>=1){var h=SuperMap.Plot.PlottingUtil.findPoint(o,e,.2*i,0),c=SuperMap.Plot.PlottingUtil.findPoint(o,e,.8*i,0),g=SuperMap.Plot.PlottingUtil.findPoint(h,e,.02*i,90),y=SuperMap.Plot.PlottingUtil.findPoint(c,e,.02*i,90),f=L.latLng(g.y,g.x),P=L.latLng(y.y,y.x),d=SuperMap.Plot.RelLineText.ONLEFTLINE,S=[];g.x<y.x?(S.push(f),S.push(P)):(S.push(P),S.push(f),d=SuperMap.Plot.RelLineText.ONRIGHTLINE),this._addComponents(L.supermap.plotting.PlottingObject.createSymbol(0,SuperMap.Plot.SymbolType.PATHTEXT,S,{textContent:this.radiusText[0],showPathLine:!1,relLineText:d},this.style))}if(2===this.radiusText.length){var m=SuperMap.Plot.RelLineText.ONRIGHTLINE,b=SuperMap.Plot.PlottingUtil.findPoint(h,e,.02*i,270),v=SuperMap.Plot.PlottingUtil.findPoint(c,e,.02*i,270),M=L.latLng(b.y,b.x),A=L.latLng(v.y,v.x),T=[];b.x<v.x?(T.push(M),T.push(A)):(T.push(A),T.push(M),m=SuperMap.Plot.RelLineText.ONLEFTLINE),this._addComponents(L.supermap.plotting.PlottingObject.createSymbol(0,SuperMap.Plot.SymbolType.PATHTEXT,T,{textContent:this.radiusText[1],showPathLine:!1,relLineText:m},this.style))}var _=L.latLng(e.y,e.x);_.isScalePoint=!0,_.tag=this.scalePoints.length,this.scalePoints.push(_)}},_parseSymbolData:function(){i.AlgoSymbol.prototype._parseSymbolData.call(this),this.symbolData&&(this.centerPoint=L.latLng(this.symbolData.centerPoint.y,this.symbolData.centerPoint.x),this.endAngle=this.symbolData.endAngle,this.radius=this.symbolData.radius,this.radiusPosAngle=this.symbolData.radiusPosAngle,this.startAngle=this.symbolData.startAngle,this.textPosition=this.symbolData.textPosition,this.radiusLineType=this.symbolData.radiusLineType,this.radiusText=this.symbolData.radiusText)},_setSymbolData:function(){this.latLngs=[],i.AlgoSymbol.prototype._setSymbolData.call(this),this.symbolData&&(this.symbolData.centerPoint||(this.symbolData.centerPoint={}),this.symbolData.centerPoint.x=this.centerPoint.lng,this.symbolData.centerPoint.y=this.centerPoint.lat,this.symbolData.endAngle=this.endAngle,this.symbolData.radius=this.radius,this.symbolData.radiusPosAngle=this.radiusPosAngle,this.symbolData.startAngle=this.startAngle,this.symbolData.textPosition=this.textPosition,this.symbolData.radiusLineType=this.radiusLineType,this.symbolData.radiusText=this.radiusText)},_reView:function(){void 0!==this.prevStrokeWidth&&this.prevStrokeWidth!==this.feature.style.strokeWidth&&(this.strokeWidth=this.style.strokeWidth),this.fromZoom!==this._map.getZoom()&&(!0===this.isEdit&&this.redraw(),this.fromZoom=this._map.getZoom())},_modifyPoint:function(t,e){if(!0===e.isScalePoint){if(0===t)this.radius=SuperMap.Plot.PlottingUtil.distVincenty(this.centerPoint,e),this.startAngle=180*SuperMap.Plot.PlottingUtil.radian(new SuperMap.Geometry.Point(this.latLngs[0].lng,this.latLngs[0].lat),new SuperMap.Geometry.Point(e.lng,e.lat))/Math.PI;else if(1===t)this.radius=SuperMap.Plot.PlottingUtil.distVincenty(this.centerPoint,e),this.endAngle=180*SuperMap.Plot.PlottingUtil.radian(new SuperMap.Geometry.Point(this.latLngs[0].lng,this.latLngs[0].lat),new SuperMap.Geometry.Point(e.lng,e.lat))/Math.PI;else if(2===t&&0!==this.textContent.length){var o=180*SuperMap.Plot.PlottingUtil.radian(new SuperMap.Geometry.Point(this.latLngs[0].lng,this.latLngs[0].lat),new SuperMap.Geometry.Point(e.lng,e.lat))/Math.PI;(o>this.startAngle&&o<this.endAngle||o+360>this.startAngle&&o+360<this.endAngle)&&(this.textPosition=o)}else if(3===t||2===t&&0===this.textContent.length){var i=180*SuperMap.Plot.PlottingUtil.radian(new SuperMap.Geometry.Point(this.latLngs[0].lng,this.latLngs[0].lat),new SuperMap.Geometry.Point(e.lng,e.lat))/Math.PI;this.startAngle%360==this.endAngle%360?this.radiusPosAngle=i:(i>this.startAngle&&i<this.endAngle||i+360>this.startAngle&&i+360<this.endAngle)&&(this.radiusPosAngle=i)}}else this.latLngs.length>0&&(this.centerPoint=this.latLngs[0].clone()),2===this.latLngs.length&&(this.radius=SuperMap.Plot.PlottingUtil.distVincenty(this.latLngs[0],this.latLngs[1]));this.redraw()},_resizeLatLngs:function(t,e,o,l){var n=!1;1===this.latLngs.length&&(n=!0,this.latLngs.push(this.scalePoints[0])),i.AlgoSymbol.prototype._resizeLatLngs.call(this,t,e,o,l),this.centerPoint.lng=this.latLngs[0].lng,this.centerPoint.lat=this.latLngs[0].lat,this.radius=SuperMap.Plot.PlottingUtil.distVincenty(this.latLngs[0],this.latLngs[1]),n&&this.latLngs.splice(1,1)},setRotate:function(t){if(this.dRotate=t,this._rotate(t,this.centerPoint),this.radiusPosAngle+=t,this.startAngle+=t,this.endAngle+=t,this.textPosition+=t,this.latLngs=[],0!==this.avoidRegions.length)for(var e=0,o=this.avoidRegions.length;e<o;e++)L.Util.rotateLatLngs(this.avoidRegions[e].getLatLngs(),this.centerPoint,t);this.redraw()},move:function(t,e){for(var o=0,i=this.avoidRegions.length;o<i;o++)L.Util.moveLatLngs(this.avoidRegions[o].getLatLngs(),t,e);L.Util.moveLatLngs([this.centerPoint],t,e),this.latLngs=[],this.redraw()},getArcPts:function(t,e){for(var o=[],i=[],l=t;l<=e;l+=5){var n=SuperMap.Plot.PlottingUtil.destinationVincenty(this.centerPoint,360-l+90,1e3*this.radius);i.length>2&&Math.abs(n.lng-i[i.length-1].lng)>180&&(o.push(i.slice()),i.length=0),i.push(n)}if(l-e>0&&l-e<5){var a=SuperMap.Plot.PlottingUtil.destinationVincenty(this.centerPoint,360-e+90,1e3*this.radius);i.push(a)}return o.push(i.slice()),o}}),a=e.arcRegion=function(t,e,o,i){return new n(t,e,o,i)};L.supermap.plotting.arcRegion=a},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.picture=e.Picture=void 0,o(0);var i=o(1),l=e.Picture=i.GraphicObject.extend({path:null,symbolTexts:null,symbolTextComponents:null,bloodVolumes:null,bloodVolumeComponents:null,trajectory:null,antoRotation:null,getPath:function(){return this.path},setPath:function(t,e,o){this.path!==t&&(this.path=t,this.style.graphicWidth=e,this.style.graphicHeight=o,this.redraw(),this.fire(SuperMap.Plot.Event.reseteditmarkersvalues))},getBloodVolumes:function(){return this.bloodVolumes},getSymbolTexts:function(){return this.symbolTexts},setScale:function(t){isNaN(t)||(this.style.graphicHeight*=t/this.dScale,this.style.graphicWidth*=t/this.dScale,this.dScale=t,this.redraw(),this.fire(SuperMap.Plot.Event.reseteditmarkersvalues))},setRotate:function(t){isNaN(t)||(this.dRotate+=t,this.redraw(),this.fire(SuperMap.Plot.Event.reseteditmarkersvalues))},initialize:function(t,e,o,l){this.code=SuperMap.Plot.SymbolType.PICTURE,this.libID=0,this.symbolType=SuperMap.Plot.SymbolType.PICTURE,this.symbolName="图片",this.minEditPts=1,this.maxEditPts=1,this.symbolTexts=[],this.bloodVolumes=[],this.symbolTextComponents=[],this.bloodVolumeComponents=[],this.autoRotation=!1,i.GraphicObject.prototype.initialize.call(this,t,e,o,l),null===this.path&&(this.path="../img/marker.png")},_calculateParts:function(){if(!(this.getLatLngs().length<this.minEditPts||"none"===this.style.display||null!=this.layer&&"function"==typeof this.layer.getVisibility&&!1===this.layer.getVisibility())){var t={surroundLineFlag:!1};this.style.externalGraphic=t.externalGraphic=this.style.externalGraphic?this.style.externalGraphic:this.path,this.style.graphicOpacity=t.graphicOpacity=this.style.graphicOpacity?this.style.graphicOpacity:1,this.style.graphicWidth=t.graphicWidth=this.style.graphicWidth?this.style.graphicWidth:32,this.style.graphicHeight=t.graphicHeight=this.style.graphicHeight?this.style.graphicHeight:32,t.rotation=-this.dRotate,t.graphicXOffset=this.style.graphicXOffset?this.style.graphicXOffset:void 0,t.graphicYOffset=this.style.graphicYOffset?this.style.graphicYOffset:void 0;var e={externalGraphic:t.externalGraphic,graphicWidth:t.graphicWidth,graphicHeight:t.graphicHeight,rotation:-this.dRotate},o=L.supermap.plotting.pointImage(L.Util.cloneLatLngs(this.getLatLngs()),e);this._addComponents(o),this._bounds=this.getBounds(),this._calculateLabel(),this._calculateBloodVolume()}},getBounds:function(){var t=this._map.latLngToLayerPoint(this.getLatLngs()[0]),e=this.style.graphicXOffset?this.style.graphicXOffset:.5*this.style.graphicWidth,o=this.style.graphicYOffset?this.style.graphicYOffset:.5*this.style.graphicHeight,i=L.point(t.x-e,t.y-o),l=L.point(i.x+this.style.graphicWidth,i.y+this.style.graphicHeight),n=this._map.layerPointToLatLng(i),a=this._map.layerPointToLatLng(l);return L.latLngBounds(n,a)},_calculateLabel:function(t,e){for(var o=0;o<this.components.length;)!0===this.components[o].isSymbolText?(null!=this.components[o]._renderer&&(this.components[o].removeEventParent(this),this.components[o].onRemove()),delete this.components[o],this.components.splice(o,1)):o++;if(this.symbolTextComponents.length=0,null!=this.symbolTexts&&0!==this.symbolTexts.length){var i={surroundLineFlag:!1,lineColorLimit:!0,fillColorLimit:!0,lineWidthLimit:!0,lineTypeLimit:!0,fontColorLimit:!0,fontSizeLimit:!0,fillLimit:!0};if(null==t&&(t=this.getBounds()),t&&t.isValid()){null==e&&(e=this.latLngs[0]);for(var l=0;l<this.symbolTexts.length;l++){var n=[];if(null!=this.symbolTexts[l].textContent&&0!==this.symbolTexts[l].textContent.length&&(null==this.symbolTexts[l].style||"none"!==this.symbolTexts[l].style.display)){var a=this.symbolTexts[l];this._mergeStyleToSymbolText(a),a.textPosition=null==a.textPosition?0:a.textPosition;var s=a.textContent.split("\n"),r=s.length,u=0,p=0;if(a.border){u=SuperMap.Plot.PlottingUtil.getTextWidth(a.style,s[0])+2*a.paddingX;for(var h=1;h<r;h++){var c=SuperMap.Plot.PlottingUtil.getTextWidth(a.style,s[h])+2*a.paddingX;c>u&&(u=c)}p=parseInt(a.style.fontSize*r)+2*a.paddingY}var g=void 0,y=void 0,f=L.point(0,0),P=L.point(0,0);switch(a.textPosition){case SuperMap.Plot.AnnoPosition.LEFTTOP:a.style.labelAlign="rb",g=L.latLng(t.getNorth(),t.getWest()),(y=this._map.latLngToLayerPoint(g)).x+=a.offsetX,y.y+=a.offsetY,!0===a.border&&(f.x=y.x,f.y=y.y,P.x=y.x-u,P.y=y.y-p);break;case SuperMap.Plot.AnnoPosition.LEFTBOTTOM:a.style.labelAlign="rt",g=L.latLng(t.getSouth(),t.getWest()),(y=this._map.latLngToLayerPoint(g)).x+=a.offsetX,y.y+=a.offsetY,!0===a.border&&(f.x=y.x,f.y=y.y,P.x=y.x-u,P.y=y.y+p);break;case SuperMap.Plot.AnnoPosition.RIGHTTOP:a.style.labelAlign="lb",g=L.latLng(t.getNorth(),t.getEast()),(y=this._map.latLngToLayerPoint(g)).x+=a.offsetX,y.y+=a.offsetY,!0===a.border&&(f.x=y.x,f.y=y.y,P.x=y.x+u,P.y=y.y-p);break;case SuperMap.Plot.AnnoPosition.RIGHTBOTTOM:a.style.labelAlign="lt",g=L.latLng(t.getSouth(),t.getEast()),(y=this._map.latLngToLayerPoint(g)).x+=a.offsetX,y.y+=a.offsetY,!0===a.border&&(f.x=y.x,f.y=y.y,P.x=y.x+u,P.y=y.y+p);break;case SuperMap.Plot.AnnoPosition.TOP:a.style.labelAlign="cb",g=L.latLng(t.getNorth(),(t.getWest()+t.getEast())/2),(y=this._map.latLngToLayerPoint(g)).x+=a.offsetX,y.y+=a.offsetY,!0===a.border&&(f.x=y.x-u/2,f.y=y.y,P.x=y.x+u/2,P.y=y.y-p);break;case SuperMap.Plot.AnnoPosition.BOTTOM:a.style.labelAlign="ct",g=L.latLng(t.getSouth(),(t.getWest()+t.getEast())/2),(y=this._map.latLngToLayerPoint(g)).x+=a.offsetX,y.y+=a.offsetY,!0===a.border&&(f.x=y.x-u/2,f.y=y.y,P.x=y.x+u/2,P.y=y.y+p);break;case SuperMap.Plot.AnnoPosition.LEFT:a.style.labelAlign="rm",g=L.latLng((t.getSouth()+t.getNorth())/2,t.getWest()),(y=this._map.latLngToLayerPoint(g)).x+=a.offsetX,y.y+=a.offsetY,!0===a.border&&(f.x=y.x,f.y=y.y+p/2,P.x=y.x-u,P.y=y.y-p/2);break;case SuperMap.Plot.AnnoPosition.RIGHT:a.style.labelAlign="lm",g=L.latLng((t.getSouth()+t.getNorth())/2,t.getEast()),(y=this._map.latLngToLayerPoint(g)).x+=a.offsetX,y.y+=a.offsetY,!0===a.border&&(f.x=y.x,f.y=y.y+p/2,P.x=y.x+u,P.y=y.y-p/2);break;case SuperMap.Plot.AnnoPosition.ANCHOR:a.style.labelAlign="lm",g=L.latLng(e.lat,e.lng),(y=this._map.latLngToLayerPoint(g)).x+=a.offsetX,y.y+=a.offsetY,a.offsetX>0?(a.style.labelAlign="lm",!0===a.border&&(f.x=y.x,f.y=y.y+p/2,P.x=y.x+u,P.y=y.y-p/2)):(a.style.labelAlign="rm",!0===a.border&&(f.x=y.x,f.y=y.y+p/2,P.x=y.x-u,P.y=y.y-p/2))}var d=this._map.layerPointToLatLng(y);if(!0===a.showRelationLine&&(0!==a.offsetX||0!==a.offsetY)){var S=a.lineStyle;null==a.lineStyle&&(S=SuperMap.Util.copyAttributes(S,this.style)),S.lineColorLimit=!0,S.lineTypeLimit=!0,S.lineWidthLimit=!0;var m=this._createAndDrawLayer(SuperMap.Plot.SymbolType.POLYLINESYMBOL,[d,g],S);m.isSymbolText=!0,m.fromZoom=this._map.getZoom(),n.push(m)}var b=SuperMap.Util.copyAttributes(i,a.style);if(a.border){var v=this._map.layerPointToLatLng(f),M=this._map.layerPointToLatLng(P),A=this._createAndDrawLayer(SuperMap.Plot.SymbolType.RECTANGLESYMBOL,[v,M],SuperMap.Util.cloneObject(b));A.isSymbolText=!0,A.fromZoom=this._map.getZoom(),n.push(A);var T=f.x<P.x?f.x:P.x,_=f.y<P.y?f.y:P.y,O=this._map.layerPointToLatLng(L.point(T+a.paddingX,_+p/2)),x=SuperMap.Util.cloneObject(b);x.labelAlign="lm";var w=this._createAndDrawLayer(SuperMap.Plot.SymbolType.TEXTSYMBOL,[O],x,a.textContent);w.isSymbolText=!0,w.fromZoom=this._map.getZoom(),n.push(w)}else{var E=this._createAndDrawLayer(SuperMap.Plot.SymbolType.TEXTSYMBOL,[d],SuperMap.Util.cloneObject(b),a.textContent);E.isSymbolText=!0,E.fromZoom=this._map.getZoom(),n.push(E)}this.symbolTextComponents.push(n)}}}}},_calculateBloodVolume:function(t,e){for(var o=0;o<this.components.length;)!0===this.components[o].isBloodVolume?(null!=this.components[o]._renderer&&(this.components[o].removeEventParent(this),this.components[o].onRemove()),delete this.components[o],this.components.splice(o,1)):o++;if(this.bloodVolumeComponents.length=0,!(this.getLatLngs().length<this.minEditPts)&&null!=this.bloodVolumes&&0!==this.bloodVolumes.length){null==t&&(t=this.getBounds()),null==e&&(e=this.getLatLngs()[0]);for(var i=this._map.latLngToLayerPoint(e),l=0;l<this.bloodVolumes.length;l++){var n=[],a=null;if(null!=this.bloodVolumes[l].width)a=Math.abs(this._map.layerPointToLatLng(L.point(i.x+this.bloodVolumes[l].width,i.y)).lng-e.lng);else{var s=Math.abs(this._map.layerPointToLatLng(L.point(i.x+40,i.y)).lng-e.lng);(a=Math.abs(t.getEast()-t.getWest()))<s&&(a=s)}var r,u,p=null;if(null!=this.bloodVolumes[l].height)p=Math.abs(this._map.layerPointToLatLng(L.point(i.x,i.y+this.bloodVolumes[l].height)).lat-e.lat);else{p=Math.abs(this._map.layerPointToLatLng(L.point(i.x,i.y+8)).lat-e.lat)}if(this.bloodVolumes[l].position===SuperMap.Plot.Position.TOP){var h=L.latLng(t.getNorth(),t.getCenter().lng),c=this._map.latLngToLayerPoint(h);c.x+=this.bloodVolumes[l].offsetX,c.y+=this.bloodVolumes[l].offsetY,h=this._map.layerPointToLatLng(c),r=L.latLng(h.lat+p,h.lng-.5*a),u=L.latLng(h.lat,h.lng+.5*a)}else if(this.bloodVolumes[l].position===SuperMap.Plot.Position.BOTTOM){var g=L.latLng(t.getSouth(),t.getCenter().lng),y=this._map.latLngToLayerPoint(g);y.x+=this.bloodVolumes[l].offsetX,y.y+=this.bloodVolumes[l].offsetY,g=this._map.layerPointToLatLng(y),r=L.latLng(g.lat,g.lng-.5*a),u=L.latLng(g.lat-p,g.lng+.5*a)}else if(this.bloodVolumes[l].position===SuperMap.Plot.Position.LEFT){var f=L.latLng(t.getCenter().lat,t.getWest()),P=this._map.latLngToLayerPoint(f);P.x+=this.bloodVolumes[l].offsetX,P.y+=this.bloodVolumes[l].offsetY,f=this._map.layerPointToLatLng(P),r=L.latLng(f.lat+.5*a,f.lng-p),u=L.latLng(f.lat-.5*a,f.lng)}else if(this.bloodVolumes[l].position===SuperMap.Plot.Position.RIGHT){var d=L.latLng(t.getCenter().lat,t.getEast()),S=this._map.latLngToLayerPoint(d);S.x+=this.bloodVolumes[l].offsetX,S.y+=this.bloodVolumes[l].offsetY,d=this._map.layerPointToLatLng(S),r=L.latLng(d.lat+.5*a,d.lng),u=L.latLng(d.lat-.5*a,d.lng+p)}var m=this.bloodVolumes[l].style.color;null==m&&(m="#808080");var b=this.bloodVolumes[l].style.weight;null==b&&(b=4);var v=this.bloodVolumes[l].style.opacity;null==v&&(v=1);var M=this._createAndDrawLayer(SuperMap.Plot.SymbolType.RECTANGLESYMBOL,[r,u],{fillLimit:!0,fillSymbolID:1,lineWidthLimit:!0,weight:b,lineColorLimit:!0,color:m,opacity:v});M.isBloodVolume=!0,M.fromZoom=this._map.getZoom(),n.push(M);var A=this.bloodVolumes[l].style.remainingVolumeColor;null==A&&(A="#00ff00");var T=this.bloodVolumes[l].style.remainingVolumeOpacity;null==T&&(T=.8);var _=this.bloodVolumes[l].style.consumeVolumeColor;null==_&&(_="#000000");var O=this.bloodVolumes[l].style.consumeVolumeOpacity;null==O&&(O=.8);var x=this.components[this.components.length-1].getBounds();if(this.bloodVolumes[l].position===SuperMap.Plot.Position.TOP||this.bloodVolumes[l].position===SuperMap.Plot.Position.BOTTOM){if(!SuperMap.Plot.PlottingUtil.equalFuzzy(0,this.bloodVolumes[l].volume)){var w=x.getNorthWest(),E=L.latLng(x.getSouthEast().lat,w.lng+this.bloodVolumes[l].volume*a),C=this._createAndDrawLayer(SuperMap.Plot.SymbolType.RECTANGLESYMBOL,[w,E],{fillLimit:!0,fillSymbolID:0,fillColorLimit:!0,fillColor:A,fillOpacity:T,lineColorLimit:!0,opacity:0});C.isBloodVolume=!0,C.fromZoom=this._map.getZoom(),n.push(C)}if(!SuperMap.Plot.PlottingUtil.equalFuzzy(1,this.bloodVolumes[l].volume)){var I=x.getSouthEast(),D=L.latLng(x.getNorthWest().lat,x.getNorthWest().lng+this.bloodVolumes[l].volume*a),R=this._createAndDrawLayer(SuperMap.Plot.SymbolType.RECTANGLESYMBOL,[I,D],{fillLimit:!0,fillSymbolID:0,fillColorLimit:!0,fillColor:_,fillOpacity:O,lineColorLimit:!0,opacity:0});R.isBloodVolume=!0,R.fromZoom=this._map.getZoom(),n.push(R)}}else if(this.bloodVolumes[l].position===SuperMap.Plot.Position.LEFT){if(!SuperMap.Plot.PlottingUtil.equalFuzzy(0,this.bloodVolumes[l].volume)){var N=x.getSouthWest(),U=L.latLng(N.lat+this.bloodVolumes[l].volume*a,x.getNorthEast().lng),B=this._createAndDrawLayer(SuperMap.Plot.SymbolType.RECTANGLESYMBOL,[N,U],{fillLimit:!0,fillSymbolID:0,fillColorLimit:!0,fillColor:A,fillOpacity:T,lineColorLimit:!0,opacity:0});B.isBloodVolume=!0,B.fromZoom=this._map.getZoom(),n.push(B)}if(!SuperMap.Plot.PlottingUtil.equalFuzzy(1,this.bloodVolumes[l].volume)){var k=x.getNorthEast(),F=L.latLng(x.getSouthWest().lat+this.bloodVolumes[l].volume*a,x.getSouthWest().lng),G=this._createAndDrawLayer(SuperMap.Plot.SymbolType.RECTANGLESYMBOL,[k,F],{fillLimit:!0,fillSymbolID:0,fillColorLimit:!0,fillColor:_,fillOpacity:O,lineColorLimit:!0,opacity:0});G.isBloodVolume=!0,G.fromZoom=this._map.getZoom(),n.push(G)}}else if(this.bloodVolumes[l].position===SuperMap.Plot.Position.RIGHT){if(!SuperMap.Plot.PlottingUtil.equalFuzzy(0,this.bloodVolumes[l].volume)){var V=x.getNorthEast(),j=L.latLng(V.lat-this.bloodVolumes[l].volume*a,x.getSouthWest().lng),Y=this._createAndDrawLayer(SuperMap.Plot.SymbolType.RECTANGLESYMBOL,[V,j],{fillLimit:!0,fillSymbolID:0,fillColorLimit:!0,fillColor:A,fillOpacity:T,lineColorLimit:!0,opacity:0});Y.isBloodVolume=!0,Y.fromZoom=this._map.getZoom(),n.push(Y)}if(!SuperMap.Plot.PlottingUtil.equalFuzzy(1,this.bloodVolumes[l].volume)){var z=x.getSouthWest(),W=L.latLng(x.getNorthEast().lat-this.bloodVolumes[l].volume*a,x.getNorthEast().lng),X=this._createAndDrawLayer(SuperMap.Plot.SymbolType.RECTANGLESYMBOL,[z,W],{fillLimit:!0,fillSymbolID:0,fillColorLimit:!0,fillColor:_,fillOpacity:O,lineColorLimit:!0,opacity:0});X.isBloodVolume=!0,X.fromZoom=this._map.getZoom(),n.push(X)}}this.bloodVolumeComponents.push(n)}}},move:function(t,e){i.GraphicObject.prototype._move.call(this,t,e)},_mergeStyleToSymbolText:function(t){if(null!==this.components)for(var e in null!==t.style&&void 0!==t.style||(t.style={}),this.style)t.style.hasOwnProperty(e)||(t.style[e]=this.style[e])},_reView:function(){this.fromZoom!==this._map.getZoom()&&(this._calculateLabel(),this._calculateBloodVolume(),this.fire(SuperMap.Plot.Event.reseteditmarkersvalues)),this.fromZoom=this._map.getZoom()}}),n=e.picture=function(t,e,o,i){return new l(t,e,o,i)};L.supermap.plotting.picture=n,L.supermap.plotting.Picture=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EditMarker=void 0,o(0);var i=e.EditMarker=L.Marker.extend({options:{nHandle:0,tag:0}});L.supermap.plotting.editMarker=function(t,e){return new i(t,e)}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=e.bounds=function(t){L.Util.isArray(t)||(t=[t]);for(var e=L.latLngBounds(),o=0;o<t.length;o++)L.Util.isArray(t[o])?e.extend(L.Util.bounds(t[o])):e.extend(t[o]);return e},l=e.latLngsToSuperMapPoints=function(t){var e=[];L.Util.isArray(t)||(t=[t]);for(var o=0;o<t.length;o++)e.push(new SuperMap.Geometry.Point(t[o].lng,t[o].lat));return e},n=e.superMapPointsToLatLngs=function(t){var e=[];L.Util.isArray(t)||(t=[t]);for(var o=0;o<t.length;o++)void 0!==t[o]&&e.push(L.latLng(t[o].y,t[o].x));return e},a=e.cloneLatLngs=function(t){var e=[];L.Util.isArray(t)||(t=[t]);for(var o=0;o<t.length;o++)L.Util.isArray(t[o])?e.push(L.Util.cloneLatLngs(t[o])):e.push(t[o].clone());return e},s=e.moveLatLngs=function(t,e,o){L.Util.isArray(t)||(t=[t]);for(var i=0;i<t.length;i++)L.Util.isArray(t[i])?L.Util.moveLatLngs(t[i],e,o):(t[i].lat+=e,t[i].lng+=o)},r=e.rotateLatLngs=function(t,e,o){L.Util.isArray(t)||(t=[t]);for(var i=o*(Math.PI/180),l=Math.cos(i),n=Math.sin(i),a=0;a<t.length;a++)if(L.Util.isArray(t[a]))L.Util.rotateLatLngs(t[a],e,o);else{var s=t[a].lat-e.lat,r=t[a].lng-e.lng;t[a].lat=r*n+s*l+e.lat,t[a].lng=r*l-s*n+e.lng}},u=e.rotateBounds=function(t,e,o){if(t instanceof L.LatLngBounds){var i=L.latLngBounds(),l=o*(Math.PI/180),n=Math.cos(l),a=Math.sin(l),s=[];s.push(L.latLng(t.getNorth(),t.getWest())),s.push(L.latLng(t.getNorth(),t.getEast())),s.push(L.latLng(t.getSouth(),t.getWest())),s.push(L.latLng(t.getSouth(),t.getEast()));for(var r=0;r<s.length;r++){var u=s[r].lat-e.lat,p=s[r].lng-e.lng;s[r].lat=p*a+u*n+e.lat,s[r].lng=p*n-u*a+e.lng,i.extend(s[r])}return i}},p=e.resizeLatLngs=function(t,e,o){L.Util.isArray(t)||(t=[t]);for(var i=0;i<t.length;i++)L.Util.isArray(t[i])?L.Util.resizeLatLngs(t[i],e,o):(t[i].lat=e.lat+o*(t[i].lat-e.lat),t[i].lng=e.lng+o*(t[i].lng-e.lng))},h=e.conventProjectPts=function(t){var e=[];L.Util.isArray(t)||(t=[t]);for(var o=0,i=t.length;o<i;o++)e.push(L.CRS.EPSG3857.project(t[o]));return e},c=e.unConventProjectPts=function(t){var e=[];L.Util.isArray(t)||(t=[e]);for(var o=0,i=t.length;o<i;o++)e.push(L.CRS.EPSG3857.unproject(t[o]));return e},g=e.isMercatorProjection=function(t){if(void 0!==t&&"string"==typeof t)switch(t.toUpperCase()){case"EPSG:3857":return!0;case"EPSG:4326":default:return!1}};L.Util.bounds=i,L.Util.latLngsToSuperMapPoints=l,L.Util.superMapPointsToLatLngs=n,L.Util.cloneLatLngs=a,L.Util.moveLatLngs=s,L.Util.rotateLatLngs=r,L.Util.rotateBounds=u,L.Util.resizeLatLngs=p,L.Util.conventProjectPts=h,L.Util.unConventProjectPts=c,L.Util.isMercatorProjection=g},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PlottingGraphic=e.componentStyle=e.ComponentStyle=e.dotSymbolStyle=e.DotSymbolStyle=e.symbolStyle=e.SymbolStyle=void 0;var i=o(22),l=o(42),n=o(21),a=o(20);e.SymbolStyle=i.SymbolStyle,e.symbolStyle=i.symbolStyle,e.DotSymbolStyle=l.DotSymbolStyle,e.dotSymbolStyle=l.dotSymbolStyle,e.ComponentStyle=n.ComponentStyle,e.componentStyle=n.componentStyle,e.PlottingGraphic=a.PlottingGraphic},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.MD5=SuperMap.MD5=SuperMap.MD5||{};var i=e.md5=function(t){function e(t,e){return t<<e|t>>>32-e}function o(t,e){var o,i,l,n,a;return l=2147483648&t,n=2147483648&e,a=(1073741823&t)+(1073741823&e),(o=1073741824&t)&(i=1073741824&e)?2147483648^a^l^n:o|i?1073741824&a?3221225472^a^l^n:1073741824^a^l^n:a^l^n}function i(t,i,l,n,a,s,r){return o(e(t=o(t,o(o(function(t,e,o){return t&e|~t&o}(i,l,n),a),r)),s),i)}function l(t,i,l,n,a,s,r){return o(e(t=o(t,o(o(function(t,e,o){return t&o|e&~o}(i,l,n),a),r)),s),i)}function n(t,i,l,n,a,s,r){return o(e(t=o(t,o(o(function(t,e,o){return t^e^o}(i,l,n),a),r)),s),i)}function a(t,i,l,n,a,s,r){return o(e(t=o(t,o(o(function(t,e,o){return e^(t|~o)}(i,l,n),a),r)),s),i)}function s(t){var e,o="",i="";for(e=0;e<=3;e++)o+=(i="0"+(t>>>8*e&255).toString(16)).substr(i.length-2,2);return o}var r,u,p,h,c,g,y,f,P,d=Array();for(d=function(t){for(var e,o=t.length,i=o+8,l=16*((i-i%64)/64+1),n=Array(l-1),a=0,s=0;s<o;)a=s%4*8,n[e=(s-s%4)/4]=n[e]|t.charCodeAt(s)<<a,s++;return a=s%4*8,n[e=(s-s%4)/4]=n[e]|128<<a,n[l-2]=o<<3,n[l-1]=o>>>29,n}(t=function(t){t=t.replace("/\r\n/g","\n");for(var e="",o=0;o<t.length;o++){var i=t.charCodeAt(o);i<128?e+=String.fromCharCode(i):i>127&&i<2048?(e+=String.fromCharCode(i>>6|192),e+=String.fromCharCode(63&i|128)):(e+=String.fromCharCode(i>>12|224),e+=String.fromCharCode(i>>6&63|128),e+=String.fromCharCode(63&i|128))}return e}(t)),g=1732584193,y=4023233417,f=2562383102,P=271733878,r=0;r<d.length;r+=16)u=g,p=y,h=f,c=P,y=a(y=a(y=a(y=a(y=n(y=n(y=n(y=n(y=l(y=l(y=l(y=l(y=i(y=i(y=i(y=i(y,f=i(f,P=i(P,g=i(g,y,f,P,d[r+0],7,3614090360),y,f,d[r+1],12,3905402710),g,y,d[r+2],17,606105819),P,g,d[r+3],22,3250441966),f=i(f,P=i(P,g=i(g,y,f,P,d[r+4],7,4118548399),y,f,d[r+5],12,1200080426),g,y,d[r+6],17,2821735955),P,g,d[r+7],22,4249261313),f=i(f,P=i(P,g=i(g,y,f,P,d[r+8],7,1770035416),y,f,d[r+9],12,2336552879),g,y,d[r+10],17,4294925233),P,g,d[r+11],22,2304563134),f=i(f,P=i(P,g=i(g,y,f,P,d[r+12],7,1804603682),y,f,d[r+13],12,4254626195),g,y,d[r+14],17,2792965006),P,g,d[r+15],22,1236535329),f=l(f,P=l(P,g=l(g,y,f,P,d[r+1],5,4129170786),y,f,d[r+6],9,3225465664),g,y,d[r+11],14,643717713),P,g,d[r+0],20,3921069994),f=l(f,P=l(P,g=l(g,y,f,P,d[r+5],5,3593408605),y,f,d[r+10],9,38016083),g,y,d[r+15],14,3634488961),P,g,d[r+4],20,3889429448),f=l(f,P=l(P,g=l(g,y,f,P,d[r+9],5,568446438),y,f,d[r+14],9,3275163606),g,y,d[r+3],14,4107603335),P,g,d[r+8],20,1163531501),f=l(f,P=l(P,g=l(g,y,f,P,d[r+13],5,2850285829),y,f,d[r+2],9,4243563512),g,y,d[r+7],14,1735328473),P,g,d[r+12],20,2368359562),f=n(f,P=n(P,g=n(g,y,f,P,d[r+5],4,4294588738),y,f,d[r+8],11,2272392833),g,y,d[r+11],16,1839030562),P,g,d[r+14],23,4259657740),f=n(f,P=n(P,g=n(g,y,f,P,d[r+1],4,2763975236),y,f,d[r+4],11,1272893353),g,y,d[r+7],16,4139469664),P,g,d[r+10],23,3200236656),f=n(f,P=n(P,g=n(g,y,f,P,d[r+13],4,681279174),y,f,d[r+0],11,3936430074),g,y,d[r+3],16,3572445317),P,g,d[r+6],23,76029189),f=n(f,P=n(P,g=n(g,y,f,P,d[r+9],4,3654602809),y,f,d[r+12],11,3873151461),g,y,d[r+15],16,530742520),P,g,d[r+2],23,3299628645),f=a(f,P=a(P,g=a(g,y,f,P,d[r+0],6,4096336452),y,f,d[r+7],10,1126891415),g,y,d[r+14],15,2878612391),P,g,d[r+5],21,4237533241),f=a(f,P=a(P,g=a(g,y,f,P,d[r+12],6,1700485571),y,f,d[r+3],10,2399980690),g,y,d[r+10],15,4293915773),P,g,d[r+1],21,2240044497),f=a(f,P=a(P,g=a(g,y,f,P,d[r+8],6,1873313359),y,f,d[r+15],10,4264355552),g,y,d[r+6],15,2734768916),P,g,d[r+13],21,1309151649),f=a(f,P=a(P,g=a(g,y,f,P,d[r+4],6,4149444226),y,f,d[r+11],10,3174756917),g,y,d[r+2],15,718787259),P,g,d[r+9],21,3951481745),g=o(g,u),y=o(y,p),f=o(f,h),P=o(P,c);return(s(g)+s(y)+s(f)+s(P)).toLowerCase()};SuperMap.MD5.md5=i},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.md5=void 0;var i=o(82);e.md5=i.md5},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AlgoSymbolFactory=void 0,o(44);e.AlgoSymbolFactory=SuperMapAlgoPlot.AlgoSymbolFactory=SuperMapAlgoPlot.AlgoSymbolFactory||{};SuperMapAlgoPlot.AlgoSymbolFactory.getAlgoSymbol=function(t){var e=t.libID,o=t.code;return 0!==e&&22!==e&&421!==e||void 0===SuperMapAlgoPlot.BasicAlgoSymbolFactory?100===e&&void 0!==SuperMapAlgoPlot.JBAlgoSymbolFactory?SuperMapAlgoPlot.JBAlgoSymbolFactory.getAlgoSymbol(e,o,t):123===e&&void 0!==SuperMapAlgoPlot.WJAlgoSymbolFactory?SuperMapAlgoPlot.WJAlgoSymbolFactory.getAlgoSymbol(e,o,t):999===e&&void 0!==SuperMapAlgoPlot.YJAlgoSymbolFactory?SuperMapAlgoPlot.YJAlgoSymbolFactory.getAlgoSymbol(e,o,t):null:SuperMapAlgoPlot.BasicAlgoSymbolFactory.getAlgoSymbol(e,o,t)},SuperMapAlgoPlot.AlgoSymbolFactory.getSymbolWayType=function(t,e){if(0===t)switch(e){case SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL:case SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL:return SuperMapAlgoPlot.AddPoint_WayType.POLYLINE;case SuperMapAlgoPlot.SymbolType.POLYBEZIERSYMBOL:case SuperMapAlgoPlot.SymbolType.POLYBEZIERCLOSESYMBOL:return SuperMapAlgoPlot.AddPoint_WayType.CURVE;default:return SuperMapAlgoPlot.AddPoint_WayType.UNKNOWN}if(22===t)switch(e){case 1005:case 1008:case 1012:case 1014:return SuperMapAlgoPlot.AddPoint_WayType.CURVE;case 1007:case 1009:case 1013:case 1015:return SuperMapAlgoPlot.AddPoint_WayType.POLYLINE;default:return SuperMapAlgoPlot.AddPoint_WayType.UNKNOWN}if(100===t)switch(e){case 15200:case 15201:case 16203:case 17703:case 17704:case 21400:case 21401:case 21500:case 21501:case 21502:case 21503:case 21504:case 21600:case 21900:case 22e3:case 22103:case 23800:case 24700:case 25201:case 25400:case 25601:case 25801:case 25901:case 26500:case 26501:case 26502:case 26503:case 26600:case 28900:case 29e3:case 29003:case 29903:case 3e4:case 30001:case 30002:case 30100:case 30102:case 30200:case 30201:case 30800:case 31803:case 33400:case 34900:case 34901:case 34902:case 35e3:case 36400:case 44200:case 3010102:case 3010103:case 3010104:case 3010105:case 3010106:case 3010107:case 3010108:case 3010301:case 3010302:case 3010303:case 3010304:case 16500:case 17400:case 17401:case 17500:case 17501:case 23400:case 23500:case 23600:case 23700:case 27300:case 28200:case 28300:case 28400:case 37600:case 37601:case 37700:case 39e3:case 40100:case 40101:case 42400:case 2350001:case 3032e3:case 4010800:case 4010801:case 4011100:case 4011101:case 4022100:case 4022101:case 4022102:case 39101:case 44300:case 22200:case 27701:return SuperMapAlgoPlot.AddPoint_WayType.CURVE;case 12500:case 12502:case 16100:case 20300:case 25501:case 25502:case 25503:case 32900:case 34700:case 35200:case 36401:case 41200:case 41201:case 41202:case 42700:case 44400:return SuperMapAlgoPlot.AddPoint_WayType.POLYLINE;default:return SuperMapAlgoPlot.AddPoint_WayType.UNKNOWN}if(123===t)switch(e){case 21003:case 21207:case 2120701:case 2121503:case 21218:case 30008:case 3000801:case 3000802:case 3000803:case 3000804:case 3000805:case 3000806:case 3000807:case 3000808:case 3000809:case 30009:case 5021803:case 5022001:case 5022002:case 40301:case 4030101:case 4030102:case 4030103:case 4030104:case 40303:case 4030301:case 4030302:case 4030303:case 50101:case 5010101:case 50102:case 5010201:case 5010202:case 5010203:case 5010204:case 50103:case 5010301:case 5010302:case 5010303:case 5010304:case 50107:case 5010701:case 50210:case 50220:case 50221:case 50225:case 5030102:case 50303:case 5030301:case 50309:case 50320:case 5032001:case 5032002:case 5032003:case 50321:case 5032101:case 5032102:case 50322:case 5032201:case 50330:case 5033001:case 5034203:case 5035201:case 5035204:case 60205:case 90105:return SuperMapAlgoPlot.AddPoint_WayType.CURVE;case 20915:case 2091502:case 2092101:case 2120702:case 21216:case 2121601:case 2121602:case 21605:case 30010:case 30011:case 3001101:case 3001102:case 3001103:case 3001104:case 3001105:case 30012:case 30020:case 3002001:case 3002002:case 3002005:case 30025:case 3002501:case 30026:case 40104:case 40302:case 4030201:case 4030202:case 4030203:case 4030204:case 50227:case 5035205:case 60301:case 6030101:case 6030102:case 6030103:case 6030104:case 6030105:case 6030106:case 6030107:case 70202:case 7020201:case 7020202:case 90107:return SuperMapAlgoPlot.AddPoint_WayType.POLYLINE;default:return SuperMapAlgoPlot.AddPoint_WayType.UNKNOWN}},SuperMapAlgoPlot.AlgoSymbolFactory.isAccessServer=function(t,e){return 0!==t&&22!==t&&421!==t||void 0===SuperMapAlgoPlot.BasicAlgoSymbolFactory?100===t&&void 0!==SuperMapAlgoPlot.JBAlgoSymbolFactory?SuperMapAlgoPlot.JBAlgoSymbolFactory.isAccessServer(t,e):123===t&&void 0!==SuperMapAlgoPlot.WJAlgoSymbolFactory?SuperMapAlgoPlot.WJAlgoSymbolFactory.isAccessServer(t,e):999!==t||void 0===SuperMapAlgoPlot.YJAlgoSymbolFactory||SuperMapAlgoPlot.YJAlgoSymbolFactory.isAccessServer(t,e):SuperMapAlgoPlot.BasicAlgoSymbolFactory.isAccessServer(t,e)},SuperMapAlgoPlot.AlgoSymbolFactory.getDefaultSubSymbols=function(t,e){return 100===t&&void 0!==SuperMapAlgoPlot.JBAlgoSymbolFactory?SuperMapAlgoPlot.JBAlgoSymbolFactory.getDefaultSubSymbols(t,e):123===t&&void 0!==SuperMapAlgoPlot.WJAlgoSymbolFactory?SuperMapAlgoPlot.WJAlgoSymbolFactory.getDefaultSubSymbols(t,e):999===t&&void 0!==SuperMapAlgoPlot.YJAlgoSymbolFactory?SuperMapAlgoPlot.YJAlgoSymbolFactory.getDefaultSubSymbols(t,e):[]},SuperMapAlgoPlot.AlgoSymbolFactory.getMinEditPts=function(t,e){return 0!==t&&22!==t&&421!==t||void 0===SuperMapAlgoPlot.BasicAlgoSymbolFactory?100===t&&void 0!==SuperMapAlgoPlot.JBAlgoSymbolFactory?SuperMapAlgoPlot.JBAlgoSymbolFactory.getMinEditPts(t,e):123===t&&void 0!==SuperMapAlgoPlot.WJAlgoSymbolFactory?SuperMapAlgoPlot.WJAlgoSymbolFactory.getMinEditPts(t,e):999===t&&void 0!==SuperMapAlgoPlot.YJAlgoSymbolFactory?SuperMapAlgoPlot.YJAlgoSymbolFactory.getMinEditPts(t,e):0:SuperMapAlgoPlot.BasicAlgoSymbolFactory.getMinEditPts(t,e)},SuperMapAlgoPlot.AlgoSymbolFactory.getMaxEditPts=function(t,e){return 0!==t&&22!==t&&421!==t||void 0===SuperMapAlgoPlot.BasicAlgoSymbolFactory?100===t&&void 0!==SuperMapAlgoPlot.JBAlgoSymbolFactory?SuperMapAlgoPlot.JBAlgoSymbolFactory.getMaxEditPts(t,e):123===t&&void 0!==SuperMapAlgoPlot.WJAlgoSymbolFactory?SuperMapAlgoPlot.WJAlgoSymbolFactory.getMaxEditPts(t,e):999===t&&void 0!==SuperMapAlgoPlot.YJAlgoSymbolFactory?SuperMapAlgoPlot.YJAlgoSymbolFactory.getMaxEditPts(t,e):0:SuperMapAlgoPlot.BasicAlgoSymbolFactory.getMaxEditPts(t,e)},SuperMapAlgoPlot.AlgoSymbolFactory.getDefaultStyle=function(t,e){return 0!==t&&22!==t&&421!==t||void 0===SuperMapAlgoPlot.BasicAlgoSymbolFactory?100===t&&void 0!==SuperMapAlgoPlot.JBAlgoSymbolFactory?SuperMapAlgoPlot.JBAlgoSymbolFactory.getDefaultStyle(t,e):123===t&&void 0!==SuperMapAlgoPlot.WJAlgoSymbolFactory?SuperMapAlgoPlot.WJAlgoSymbolFactory.getDefaultStyle(t,e):999===t&&void 0!==SuperMapAlgoPlot.YJAlgoSymbolFactory?SuperMapAlgoPlot.YJAlgoSymbolFactory.getDefaultStyle(t,e):{}:SuperMapAlgoPlot.BasicAlgoSymbolFactory.getDefaultStyle(t,e)},SuperMapAlgoPlot.AlgoSymbolFactory.getSymbolName=function(t,e){return 0!==t&&22!==t&&421!==t||void 0===SuperMapAlgoPlot.BasicAlgoSymbolFactory?"":SuperMapAlgoPlot.BasicAlgoSymbolFactory.getSymbolName(t,e)},SuperMapAlgoPlot.AlgoSymbolFactory.canPolylineConnect=function(t,e){if(100!==t)return!1;switch(e){case 16500:case 17400:case 17401:case 17500:case 17501:case 23400:case 23500:case 23600:case 23700:case 27300:case 28200:case 28300:case 28400:case 37600:case 37601:case 37700:case 39e3:case 40100:case 40101:case 42200:case 42400:case 2350001:case 2730101:case 3032e3:case 4010800:case 4010801:case 4011100:case 4011101:case 4022100:case 4022101:case 4022102:return!0;default:return!1}},SuperMapAlgoPlot.AlgoSymbolFactory.zoomInCalSymbol=function(t,e){return 0!==t&&22!==t&&421!==t||void 0===SuperMapAlgoPlot.BasicAlgoSymbolFactory?100===t&&void 0!==SuperMapAlgoPlot.JBAlgoSymbolFactory?SuperMapAlgoPlot.JBAlgoSymbolFactory.zoomInCalSymbol(t,e):123===t&&void 0!==SuperMapAlgoPlot.WJAlgoSymbolFactory?SuperMapAlgoPlot.WJAlgoSymbolFactory.zoomInCalSymbol(t,e):999===t&&void 0!==SuperMapAlgoPlot.YJAlgoSymbolFactory?SuperMapAlgoPlot.YJAlgoSymbolFactory.zoomInCalSymbol(t,e):0:SuperMapAlgoPlot.BasicAlgoSymbolFactory.zoomInCalSymbol(t,e)},SuperMapAlgoPlot.AlgoSymbolFactory.zoomCalSymbol=function(t,e){if((0===t||22===t||421===t)&&void 0!==SuperMapAlgoPlot.BasicAlgoSymbolFactory)return SuperMapAlgoPlot.BasicAlgoSymbolFactory.zoomCalSymbol(t,e);if(100===t)switch(e){case 28e3:case 28100:case 28200:case 28201:case 32300:return!0;default:return!1}else{if(123!==t||void 0===SuperMapAlgoPlot.WJAlgoSymbolFactory)return!1;switch(e){case 50312:case 50313:case 50314:case 50348:return!0;default:return!1}}},SuperMapAlgoPlot.AlgoSymbolFactory.calSurroundLineDir=function(t,e){if(22!==t)return!0;switch(e){case 1018:case 1020:case 1021:return!1;default:return!0}}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.AlgoSymbol322=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return 0===o.scaleValues.length&&(o.scaleValues.push(.025),o.scaleValues.push(.085)),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol),i(e,[{key:"calculateParts",value:function(){this.init();var t=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);if(!((t=SuperMapAlgoPlot.PlottingUtil.clearSamePts(t)).length<this.minEditPts)){this.isEdit||(this.scaleValues[0]=.5*this.getSubSymbolScaleValue()),this.addCell(SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,t),SuperMapAlgoPlot.PlottingUtil.equalFuzzy(t[0].x,t[t.length-1].x)&&SuperMapAlgoPlot.PlottingUtil.equalFuzzy(t[0].y,t[t.length-1].y)||t.push(t[0]);for(var e=SuperMapAlgoPlot.PlottingUtil.polylineDistance(t),o=this.scaleValues[0]*e,i=-1*SuperMapAlgoPlot.PlottingUtil.innerOutlineDir(t),l=this.scaleValues[1]*e,n=.3*l,a=l;a<e;a+=l){var s=SuperMapAlgoPlot.PlottingUtil.findPointInPolyLine(t,a);if(-1===s.index)return void this.finish();var r=a+n,u=SuperMapAlgoPlot.PlottingUtil.findPointInPolyLine(t,r);if(-1===u.index)return void this.finish();var p=[],h=[];p.push(s.pt);var c=SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine(o,t[s.index],s.pt);1===i?p.push(new SuperMapAlgoPlot.Point(c.pntLeft.x,c.pntLeft.y)):p.push(new SuperMapAlgoPlot.Point(c.pntRight.x,c.pntRight.y)),h.push(u.pt);var g=SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine(o,t[u.index],u.pt);if(1===i?h.push(new SuperMapAlgoPlot.Point(g.pntLeft.x,g.pntLeft.y)):h.push(new SuperMapAlgoPlot.Point(g.pntRight.x,g.pntRight.y)),l===a){this.scalePoints=[];var y=new SuperMapAlgoPlot.Point(p[1].x,p[1].y);y.isScalePoint=!0,y.tag=0,this.scalePoints.push(y),(y=new SuperMapAlgoPlot.Point(p[0].x,p[0].y)).isScalePoint=!0,y.tag=1,this.scalePoints.push(y)}this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,p),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,h)}this.finish()}}},{key:"computeScaleValues",value:function(t,e){if(!0===e.isScalePoint){var o=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);if((o=SuperMapAlgoPlot.PlottingUtil.clearSamePts(o)).length<this.minEditPts)return;SuperMapAlgoPlot.PlottingUtil.equalFuzzy(o[0].x,o[o.length-1].x)&&SuperMapAlgoPlot.PlottingUtil.equalFuzzy(o[0].y,o[o.length-1].y)||o.push(o[0]);var i=SuperMapAlgoPlot.PlottingUtil.polylineDistance(o),l=new SuperMapAlgoPlot.Point(e.x,e.y);if(0===t){var n=SuperMapAlgoPlot.PlottingUtil.findPointInPolyLine(o,i*this.scaleValues[1]);if(-1===n.index)return;var a=SuperMapAlgoPlot.PlottingUtil.distance(n.pt,l)/i;this.scaleValues[0]=a}else if(1===t){for(var s=0,r=-1,u=null,p=0,h=o.length-1;p<h;p++){var c=SuperMapAlgoPlot.PlottingUtil.pointProjectToSegment(e,o[p],o[p+1]);if(c.isOnline)if(null==u)r=p,u=c.projectPoint,s=SuperMapAlgoPlot.PlottingUtil.distance(e,u);else{var g=SuperMapAlgoPlot.PlottingUtil.distance(e,u);g<s&&(r=p,u=c.projectPoint,s=g)}}if(-1==r)return;for(var y=0,f=0,P=r-1;f<P;f++)y+=SuperMapAlgoPlot.PlottingUtil.distance(o[f],o[f+1]);var d=(y+=SuperMapAlgoPlot.PlottingUtil.distance(o[r],u))/i;d>.3&&(d=.3),this.scaleValues[1]=d}}}}]),e}();SuperMapAlgoPlot.AlgoSymbol322=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.AlgoSymbol321=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return 0===o.scaleValues.length&&(o.scaleValues.push(.02),o.scaleValues.push(.1),o.scaleValues.push(0)),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol),i(e,[{key:"calculateParts",value:function(){this.init();var t=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);if(!((t=SuperMapAlgoPlot.PlottingUtil.clearSamePts(t)).length<this.minEditPts)){var e=SuperMapAlgoPlot.PlottingUtil.polylineDistance(t),o=SuperMapAlgoPlot.PlottingUtil.generateBeizerPointsNoCtrlPt(t);o=SuperMapAlgoPlot.PlottingUtil.clearSamePts(o);var i=this.getSubSymbolScaleValue();this.isEdit||(this.scaleValues[0]=.5*i);var l=this.scaleValues[0]*e,n=SuperMapAlgoPlot.PlottingUtil.paraLine(o,.5*l,!0),a=SuperMapAlgoPlot.PlottingUtil.paraLine(o,.5*l,!1);n=SuperMapAlgoPlot.PlottingUtil.clearSamePts(n),a=SuperMapAlgoPlot.PlottingUtil.clearSamePts(a),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,n),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,a);for(var s=e*this.scaleValues[1],r=.5*l,u=SuperMapAlgoPlot.PlottingUtil.polylineDistance(o),p=r,h=0;p<u;p+=s,h++){var c=SuperMapAlgoPlot.PlottingUtil.findPointInPolyLine(n,p);if(-1!==c.index){var g=SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine(l,n[c.index+1],c.pt),y=[];y.push(g.pntRight),y.push(c.pt),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,y);var f=SuperMapAlgoPlot.PlottingUtil.findPointInPolyLine(a,p);if(-1!==f.index){var P=SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine(l,a[f.index+1],f.pt);(y=[]).push(f.pt),y.push(P.pntLeft),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,y),0===h?this.addScalePoint(g.pntRight,0):1===h&&this.addScalePoint(c.pt,1)}}}this.finish()}}},{key:"computeScaleValues",value:function(t,e){if(!0===e.isScalePoint){var o=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);o=SuperMapAlgoPlot.PlottingUtil.clearSamePts(o);for(var i=0,l=0;l<o.length-1;l++)i+=SuperMapAlgoPlot.PlottingUtil.distance(o[l],o[l+1]);var n,a=SuperMapAlgoPlot.PlottingUtil.generateBeizerPointsNoCtrlPt(o);if(a=SuperMapAlgoPlot.PlottingUtil.clearSamePts(a),0==t){n=.5*(i*this.scaleValues[0]);var s=SuperMapAlgoPlot.PlottingUtil.findPointInPolyLine(a,n);if(-1===s.index)return;var r=SuperMapAlgoPlot.PlottingUtil.distance(e,s.pt);this.scaleValues[0]=r/i}else if(1===t){n=.5*(i*this.scaleValues[0]);var u=SuperMapAlgoPlot.PlottingUtil.findPointInPolyLine(a,n);if(-1===u.index)return;var p=SuperMapAlgoPlot.PlottingUtil.projectPtOnPolyLine(e,a);if(-1==p.index)return;for(var h=SuperMapAlgoPlot.PlottingUtil.distance(u.pt,a[u.index+1]),c=u.index+1;c<p.index;c++)h+=SuperMapAlgoPlot.PlottingUtil.distance(a[c],a[c+1]);h+=SuperMapAlgoPlot.PlottingUtil.distance(a[p.index],p.pt),this.scaleValues[1]=h/i}}}}]),e}();SuperMapAlgoPlot.AlgoSymbol321=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.AlgoSymbol320=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return 0===o.scaleValues.length&&(o.scaleValues.push(.1),o.scaleValues.push(.1)),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol),i(e,[{key:"calculateParts",value:function(){this.init();var t=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);if(!((t=SuperMapAlgoPlot.PlottingUtil.clearSamePts(t)).length<this.minEditPts)){for(var e=0,o=0;o<t.length-1;o++)e+=SuperMapAlgoPlot.PlottingUtil.distance(t[o],t[o+1]);var i,l,n=this.scaleValues[0]*e,a=t[0],s=t[1],r=180*SuperMapAlgoPlot.PlottingUtil.radian(a,s)/Math.PI;i=SuperMapAlgoPlot.PlottingUtil.paraLine(t,n,!0),l=SuperMapAlgoPlot.PlottingUtil.paraLine(t,n,!1);var u=.15*e,p=SuperMapAlgoPlot.PlottingUtil.circlePoint(i[0],u,u,r+165),h=SuperMapAlgoPlot.PlottingUtil.circlePoint(l[0],u,u,r-165),c=SuperMapAlgoPlot.PlottingUtil.circlePoint(i[i.length-1],u,u,r+15),g=SuperMapAlgoPlot.PlottingUtil.circlePoint(l[l.length-1],u,u,r-15),y=[];y.push(p),y.push(i[0]),y.push(i[i.length-1]),y.push(c),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,y);var f=[];f.push(h),f.push(l[0]),f.push(l[l.length-1]),f.push(g),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,f);var P=new SuperMapAlgoPlot.Point(i[0].x,i[0].y);P.isScalePoint=!0,P.tag=0,this.scalePoints.push(P),this.finish()}}},{key:"computeScaleValues",value:function(t,e){if(!0===e.isScalePoint){var o=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);o=SuperMapAlgoPlot.PlottingUtil.clearSamePts(o);for(var i=0,l=0;l<o.length-1;l++)i+=SuperMapAlgoPlot.PlottingUtil.distance(o[l],o[l+1]);if(0==t){var n=o[0],a=o[1],s=SuperMapAlgoPlot.PlottingUtil.projectPoint(e,n,a),r=SuperMapAlgoPlot.PlottingUtil.distance(e,s);this.scaleValues[0]=r/i}}}}]),e}();SuperMapAlgoPlot.AlgoSymbol320=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.AlgoSymbol25701=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol),i(e,[{key:"calculateParts",value:function(){this.init();var t=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);if(!((t=SuperMapAlgoPlot.PlottingUtil.clearSamePts(t)).length<this.minEditPts)){for(var e=t[0].x,o=t[0].x,i=0;i<t.length;i++)e>t[i].x&&(e=t[i].x),o<t[i].x&&(o=t[i].x);var l=(o-e)/50;this.addCell(SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,t);var n={surroundLineFlag:!1,lineWidthLimit:!0,strokeWidth:1,weight:1},a=SuperMapAlgoPlot.PlottingUtil.getPolygonCenterPt(t),s=10*l;t.push(t[0]);for(var r=!0,u=a.x,p=a.x;r;){r=!1;for(var h,c,g,y,f,P=[],d=new SuperMapAlgoPlot.Point(u,a.y),S=SuperMapAlgoPlot.PlottingUtil.circlePoint(d,10,10,45),m=0;m<t.length-1;m++){var b=SuperMapAlgoPlot.PlottingUtil.intersectLines(d,S,t[m],t[m+1]);b.isIntersectLines&&(c=b.intersectPoint,(g=[]).push(t[m]),g.push(t[m+1]),(h=SuperMapAlgoPlot.PlottingUtil.pointIsOnPolyLines(c,g)).isOnPolyLine&&P.push(c))}if(1<P.length){this.sortPts2D(P);for(var L=0;L<P.length-1;L++)f=new SuperMapAlgoPlot.Point((P[L].x+P[L+1].x)/2,(P[L].y+P[L+1].y)/2),SuperMapAlgoPlot.PlottingUtil.ptIsInPolygon(t,f)&&((y=[]).push(P[L]),y.push(P[L+1]),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,y,n,!0))}P.length>0&&(r=!0),P=[];for(var v=new SuperMapAlgoPlot.Point(p,a.y),M=SuperMapAlgoPlot.PlottingUtil.circlePoint(v,5,5,45),A=0;A<t.length-1;A++)(h=SuperMapAlgoPlot.PlottingUtil.intersectLines(v,M,t[A],t[A+1])).isIntersectLines&&(c=h.intersectPoint,(g=[]).push(t[A]),g.push(t[A+1]),(h=SuperMapAlgoPlot.PlottingUtil.pointIsOnPolyLines(c,g)).isOnPolyLine&&P.push(c));if(1<P.length){this.sortPts2D(P);for(var T=0;T<P.length-1;T++)f=new SuperMapAlgoPlot.Point((P[T].x+P[T+1].x)/2,(P[T].y+P[T+1].y)/2),SuperMapAlgoPlot.PlottingUtil.ptIsInPolygon(t,f)&&((y=[]).push(P[T]),y.push(P[T+1]),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,y,n,!0))}P.length>0&&(r=!0),u-=s,p+=s}this.finish()}}},{key:"sortPts2D",value:function(t){for(var e=new SuperMapAlgoPlot.Point(0,0),o=0;o<t.length;o++)for(var i=0;i<t.length-1-o;i++)SuperMapAlgoPlot.PlottingUtil.equalFuzzy(t[i].x,t[i+1].x)?t[i].y>t[i+1].y&&(e=t[i],t[i]=t[i+1],t[i+1]=e):t[i].x>t[i+1].x&&(e=t[i],t[i]=t[i+1],t[i+1]=e);return t}}]),e}();SuperMapAlgoPlot.AlgoSymbol25701=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.AlgoSymbol15200=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return 0===o.scaleValues.length&&(o.scaleValues.push(.05),o.scaleValues.push(0),o.scaleValues.push(.185)),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol),i(e,[{key:"calculateParts",value:function(){this.init();var t=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);if(!((t=SuperMapAlgoPlot.PlottingUtil.clearSamePts(t)).length<this.minEditPts)){var e=SuperMapAlgoPlot.PlottingUtil.generateBeizerPointsNoCtrlPt(t);e=SuperMapAlgoPlot.PlottingUtil.clearSamePts(e),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,e);for(var o=0,i=0,l=e.length-1;i<l;i++)o+=SuperMapAlgoPlot.PlottingUtil.distance(e[i],e[i+1]);for(var n=0,a=0,s=t.length-1;a<s;a++)n+=SuperMapAlgoPlot.PlottingUtil.distance(t[a],t[a+1]);this.isEdit||(this.scaleValues[0]=.5*this.getSubSymbolScaleValue());for(var r=this.scaleValues[0]*n,u=this.scaleValues[1],p=this.scaleValues[2]*n,h=.3*p,c=p;c<o;c+=p){var g=SuperMapAlgoPlot.PlottingUtil.getPtsIndexByDistance(c,e);if(-1===g.index)return void this.finish();var y=c+h,f=SuperMapAlgoPlot.PlottingUtil.getPtsIndexByDistance(y,e);if(-1===f.index)return void this.finish();var P=[],d=[];P.push(g.pts);var S=SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine(r,e[g.index],g.pts);0===u?P.push(new SuperMapAlgoPlot.Point(S.pntLeft.x,S.pntLeft.y)):P.push(new SuperMapAlgoPlot.Point(S.pntRight.x,S.pntRight.y)),d.push(f.pts);var m=SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine(r,e[f.index],f.pts);if(0===u?d.push(new SuperMapAlgoPlot.Point(m.pntLeft.x,m.pntLeft.y)):d.push(new SuperMapAlgoPlot.Point(m.pntRight.x,m.pntRight.y)),p===c){this.scalePoints=[];var b=new SuperMapAlgoPlot.Point(P[1].x,P[1].y);b.isScalePoint=!0,b.tag=0,this.scalePoints.push(b),(b=new SuperMapAlgoPlot.Point(P[0].x,P[0].y)).isScalePoint=!0,b.tag=1,this.scalePoints.push(b)}this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,P),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,d)}this.finish()}}},{key:"computeScaleValues",value:function(t,e){if(!0===e.isScalePoint){var o=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);if((o=SuperMapAlgoPlot.PlottingUtil.clearSamePts(o)).length<this.minEditPts)return;for(var i=0,l=0,n=o.length-1;l<n;l++)i+=SuperMapAlgoPlot.PlottingUtil.distance(o[l],o[l+1]);var a=SuperMapAlgoPlot.PlottingUtil.generateBeizerPointsNoCtrlPt(o),s=new SuperMapAlgoPlot.Point(e.x,e.y);if(0===t){var r=SuperMapAlgoPlot.PlottingUtil.findPointInPolyLine(a,i*this.scaleValues[2]);if(-1===r.index)return;var u=SuperMapAlgoPlot.PlottingUtil.distance(r.pt,s)/i,p=SuperMapAlgoPlot.PlottingUtil.pointIsRightToLine(a[0],a[1],e);this.scaleValues[1]=p?1:0,this.scaleValues[0]=u}else if(1===t){for(var h=0,c=-1,g=[],y=0,f=a.length-1;y<f;y++){var P=SuperMapAlgoPlot.PlottingUtil.pointProjectToSegment(e,a[y],a[y+1]);if(P.isOnline){var d=SuperMapAlgoPlot.PlottingUtil.distance(P.projectPoint,this.controlPoints[1]);0==h?(h=d,c=y,g=e):d<h&&(h=d,c=y,g=e)}}if(-1==c)return;for(var S=0,m=0,b=c-1;m<b;m++)S+=SuperMapAlgoPlot.PlottingUtil.distance(a[m],a[m+1]);var L=(S+=SuperMapAlgoPlot.PlottingUtil.distance(g,a[c]))/i;L>.7&&(L=.7),this.scaleValues[2]=L}}}}]),e}();SuperMapAlgoPlot.AlgoSymbol15200=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.AlgoSymbol315=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return 0!==o.scaleValues.length&&(o.scaleValues=[],o.scaleValues.push(.2),o.scaleValues.push(.2),o.scaleValues.push(.4),o.scaleValues.push(.4),o.scaleValues.push(.1),o.scaleValues.push(.2),o.scaleValues.push(.1),o.scaleValues.push(.2),o.scaleValues.push(1),o.scaleValues.push(1)),o.CLASS_NAME="SuperMapAlgoPlot.AlgoSymbol315",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol1004),i(e,[{key:"calculateParts",value:function(){this.init();var t=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);if((t=SuperMapAlgoPlot.PlottingUtil.clearSamePts(t)).length>=2&&t.length<this.minEditPts&&this.calAssistantLine(),!(t.length<this.minEditPts)){for(var e=0,o=0;o<t.length-1;o++)e+=SuperMapAlgoPlot.PlottingUtil.distance(t[o],t[o+1]);SuperMapAlgoPlot.AlgoSymbol1004.prototype.applyUse.apply(this,arguments),this.scaleValues.length<9&&(this.scaleValues=[],this.scaleValues.push(.2),this.scaleValues.push(.2),this.scaleValues.push(.4),this.scaleValues.push(.4),this.scaleValues.push(.1),this.scaleValues.push(.2),this.scaleValues.push(.1),this.scaleValues.push(.2),this.scaleValues.push(1),this.scaleValues.push(1));var i,l=e*this.scaleValues[4],n=e*this.scaleValues[5],a=SuperMapAlgoPlot.PlottingUtil.distance(t[1],t[0]),s=SuperMapAlgoPlot.PlottingUtil.linePnt(t[1],t[0],a+n);i=(this.scaleValues[8],SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine(l,t[1],s));var r,u=e*this.scaleValues[6],p=e*this.scaleValues[7],h=SuperMapAlgoPlot.PlottingUtil.linePnt(t[0],t[1],a+p);r=(this.scaleValues[9],SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine(u,t[0],h));var c=[];c.push(new SuperMapAlgoPlot.Point(i.pntLeft.x,i.pntLeft.y)),c.push(new SuperMapAlgoPlot.Point(t[0].x,t[0].y)),c.push(new SuperMapAlgoPlot.Point(t[1].x,t[1].y)),c.push(new SuperMapAlgoPlot.Point(r.pntRight.x,r.pntRight.y));var g=SuperMapAlgoPlot.PlottingUtil.generateBeizerPointsNoCtrlPt(c);g=SuperMapAlgoPlot.PlottingUtil.clearSamePts(g),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,g),this.addScalePoint(i.pntLeft,3),this.addScalePoint(r.pntRight,4)}}},{key:"modifyPoint",value:function(t,o){if(!0===o.isScalePoint){var i=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);i=SuperMapAlgoPlot.PlottingUtil.clearSamePts(i);var l=SuperMapAlgoPlot.PlottingUtil.polylineDistance(i),n=SuperMapAlgoPlot.PlottingUtil.projectPoint(o,i[0],i[1]);if(t<=2&&(SuperMapAlgoPlot.AlgoSymbol1004.prototype.modifyPoint.apply(this,arguments),function t(e,o,i){null===e&&(e=Function.prototype);var l=Object.getOwnPropertyDescriptor(e,o);if(void 0===l){var n=Object.getPrototypeOf(e);return null===n?void 0:t(n,o,i)}if("value"in l)return l.value;var a=l.get;return void 0!==a?a.call(i):void 0}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"modifyPoint",this).call(this,t,o)),3===t){var a=SuperMapAlgoPlot.PlottingUtil.distance(o,n)/l,s=SuperMapAlgoPlot.PlottingUtil.distance(n,i[0])/l;this.scaleValues[4]=a,this.scaleValues[5]=s,SuperMapAlgoPlot.PlottingUtil.pointIsRightToLine(i[0],i[1],o)?this.scaleValues[8]=1:this.scaleValues[8]=0}if(4===t){var r=SuperMapAlgoPlot.PlottingUtil.distance(o,n)/l,u=SuperMapAlgoPlot.PlottingUtil.distance(n,i[1])/l;this.scaleValues[6]=r,this.scaleValues[7]=u,SuperMapAlgoPlot.PlottingUtil.pointIsRightToLine(i[0],i[1],o)?this.scaleValues[9]=1:this.scaleValues[9]=0}}this.calculateParts()}}]),e}();SuperMapAlgoPlot.AlgoSymbol315=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.AlgoSymbol1022=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return 0===o.scaleValues.length&&o.scaleValues.push(.05),o.CLASS_NAME="SuperMap.Geometry.AlgoSymbol1022",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol),i(e,[{key:"calculateParts",value:function(){this.init();var t=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);if(!((t=SuperMapAlgoPlot.PlottingUtil.clearSamePts(t)).length<this.minEditPts)){var e=SuperMapAlgoPlot.PlottingUtil.polylineDistance(t),o=e*this.scaleValues[0],i=SuperMapAlgoPlot.PlottingUtil.paraLine(t,o,!0),l=SuperMapAlgoPlot.PlottingUtil.paraLine(t,o,!1),n=SuperMapAlgoPlot.PlottingUtil.findPointInLine(i[0],i[1],.6*e),a=SuperMapAlgoPlot.PlottingUtil.findPointInLine(i[0],i[1],.5*e),s=SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine(.1*e,i[0],a).pntLeft;this.addCell(SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,[s,n,i[1]],{surroundLineFlag:!1,fillLimit:!0,fillColorLimit:!1,fill:!0,lineTypeLimit:!0});var r=SuperMapAlgoPlot.PlottingUtil.findPointInLine(l[0],l[1],.4*e),u=SuperMapAlgoPlot.PlottingUtil.findPointInLine(l[0],l[1],.5*e),p=SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine(.1*e,l[0],u).pntRight;this.addCell(SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,[p,r,l[0]],{surroundLineFlag:!1,fillLimit:!0,fillColorLimit:!1,fill:!0,lineTypeLimit:!0}),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,i),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,[l[1],l[0]]),this.addScalePoint(i[0],0),this.finish()}}},{key:"modifyPoint",value:function(t,e){if(!0===e.isScalePoint){var o=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);o=SuperMapAlgoPlot.PlottingUtil.clearSamePts(o);var i=SuperMapAlgoPlot.PlottingUtil.polylineDistance(o);if(0===t){var l=SuperMapAlgoPlot.PlottingUtil.distance(o[0],e)/i;this.scaleValues[0]=l}}this.calculateParts()}}]),e}();SuperMapAlgoPlot.AlgoSymbol1022=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.AlgoSymbol1021=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return 0===o.scaleValues.length&&o.scaleValues.push(.25),o.CLASS_NAME="SuperMap.Geometry.AlgoSymbol1021",o.QIANJI_RATE1=9,o.QIANJI_RATE2=20,o.QIANJI_RATE4=5,o.QIANJI_RATE3=1/3,o.QIANJI_TAIL_RATE1=8,o.QIANJI_TAIL_RATE2=3,o.QIANJI_TAIL_RATE3=.6,o.SV1_Default=.25,o.SV1_MinValue=0,o.SV1_MaxValue=.5,o.DEFAULT_ARROW_TAIL_POS=.4,o.SCALE_VALUE_COUNT=1,o.MIN_LEN_LeftToRightCenter=1e-7,o.SCALE_AT=1/3,o.SCALE_ATAJ=1/7,o.SCALE_ATAE=1/3,o.SCALE_AW=2/3,o.SCALE_ATAJctrlDefSide=.8,o.SCALE_ATAJctrlSameSide=2/3,o.SCALE_MM_LEFT=.25,o.SCALE_MM_RIGHT=.75,o.BEZIER_K1=1/3,o.QIANJI_OPERATE_RATE1=1,o.m_dMaxDis=0,o.m_bIsAnimation=!1,o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol),i(e,[{key:"calculateParts",value:function(){this.init();var t=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);if(t=SuperMapAlgoPlot.PlottingUtil.clearSamePts(t),this.components.length=0,this.m_scalePoints=[],t.length>=2&&t.length<this.minEditPts&&this.calAssistantLine(),!(t.length<3)){var e=SuperMapAlgoPlot.PlottingUtil.clonePoints(t),o=this.arrowMeshs(e);o.LeftArowHead.unshift(o.LeftArowLeftBody[0][o.LeftArowLeftBody[0].length-1]),o.RightArowHead.unshift(o.RightArowLeftBody[o.RightArowLeftBody.length-1]),o.LeftArowLeftBody[0].push(o.LeftArowHead[0]),o.RightArowLeftBody.push(o.RightArowHead[0]),o.shapePts.push(o.shapePts[0]);var i=SuperMapAlgoPlot.PlottingUtil.polylineDistance(o.LeftArowLeftBody[0]),l=SuperMapAlgoPlot.PlottingUtil.getPtsIndexByDistance(.4*i,o.LeftArowLeftBody[0]),n=[],a=[];if(l.bfind)for(var s=0;s<=l.index;s++)n.push(o.LeftArowLeftBody[0][s]);var r=SuperMapAlgoPlot.PlottingUtil.getPtsIndexByDistance(.5*i,o.LeftArowLeftBody[0]);if(r.bfind)for(var u=r.index;u<o.LeftArowLeftBody[0].length-1;u++)a.push(o.LeftArowLeftBody[0][u]);var p=SuperMapAlgoPlot.PlottingUtil.polylineDistance(o.RightArowLeftBody),h=SuperMapAlgoPlot.PlottingUtil.getPtsIndexByDistance(.4*p,o.RightArowLeftBody),c=[],g=[];if(h.bfind)for(var y=0;y<=h.index;y++)c.push(o.RightArowLeftBody[y]);var f=SuperMapAlgoPlot.PlottingUtil.getPtsIndexByDistance(.5*p,o.RightArowLeftBody);if(f.bfind)for(var P=f.index;P<o.RightArowLeftBody.length-1;P++)g.push(o.RightArowLeftBody[P]);var d=SuperMapAlgoPlot.PlottingUtil.polylineDistance(o.RightArowRightBody),S=SuperMapAlgoPlot.PlottingUtil.getPtsIndexByDistance(.4*d,o.RightArowRightBody),m=[],b=[];if(S.bfind)for(var L=0;L<=S.index;L++)m.push(o.RightArowRightBody[L]);var v=SuperMapAlgoPlot.PlottingUtil.getPtsIndexByDistance(.5*d,o.RightArowRightBody);if(v.bfind)for(var M=v.index;M<o.RightArowRightBody.length-1;M++)b.push(o.RightArowRightBody[M]);o.shapePts.length>0&&(this.addCell(SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,o.shapePts,{strokeWidth:0,weight:0,lineWidthLimit:!0}),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,n),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,a),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,o.LeftArowHead,{lineTypeLimit:!0}),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,o.LeftArowRightBody),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,c),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,g),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,o.RightArowHead,{lineTypeLimit:!0}),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,m),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,b)),this.scalePoints=[];for(var A=0;A<this.m_scalePoints.length;A++)this.m_scalePoints[A].isScalePoint=!0,this.m_scalePoints[A].tag=A,this.scalePoints.push(this.m_scalePoints[A]);this.finish()}}},{key:"modifyPoint",value:function(t,e){if(!0===e.isScalePoint){var o=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);o=SuperMapAlgoPlot.PlottingUtil.clearSamePts(o);var i,l=SuperMapAlgoPlot.PlottingUtil.operateControlPoints(o),n=new SuperMapAlgoPlot.Point((l[0].x+l[1].x)/2,(l[0].y+l[1].y)/2),a=new SuperMapAlgoPlot.Point((l[2].x+l[3].x)/2,(l[2].y+l[3].y)/2),s=SuperMapAlgoPlot.PlottingUtil.pointProjectToSegment(e,n,a);if(s.isOnline){var r=SuperMapAlgoPlot.PlottingUtil.distance(s.projectPoint,n),u=SuperMapAlgoPlot.PlottingUtil.distance(n,a);(i=SuperMapAlgoPlot.PlottingUtil.equalFuzzy(r,0)?this.SV1_MinValue:r/u)>this.SV1_MaxValue&&(i=this.SV1_MaxValue)}else i=SuperMapAlgoPlot.PlottingUtil.distance(s.projectPoint,n)<SuperMapAlgoPlot.PlottingUtil.distance(s.projectPoint,a)?this.SV1_MinValue:this.SV1_MaxValue;this.scaleValues=[],this.scaleValues.push(i)}this.calculateParts()}},{key:"arrowMeshs",value:function(t){var e=new SuperMapAlgoPlot.Path2D,o=[];o=this.m_bIsAnimation&&4===t.length?SuperMapAlgoPlot.PlottingUtil.clonePoints(t):SuperMapAlgoPlot.PlottingUtil.operateControlPoints(t);var i=this.scaleValues[0],l=SuperMapAlgoPlot.PlottingUtil.distance(o[0],o[3]),n=SuperMapAlgoPlot.PlottingUtil.distance(o[1],o[2]),a=o[1].clone(),s=.5*(o[0].x+o[3].x),r=.5*(o[0].y+o[3].y),u=new SuperMapAlgoPlot.Point(s,r),p=.5*(o[1].x+o[2].x),h=.5*(o[1].y+o[2].y),c=new SuperMapAlgoPlot.Point(p,h),g=SuperMapAlgoPlot.PlottingUtil.distance(u,c);g<this.MIN_LEN_LeftToRightCenter&&(g=this.MIN_LEN_LeftToRightCenter),u.x=s+l*(s-p)/(g*this.QIANJI_RATE1),u.y=r+l*(r-h)/(g*this.QIANJI_RATE1),c.x=p+n*(p-s)/(g*this.QIANJI_RATE1),c.y=h+n*(h-r)/(g*this.QIANJI_RATE1);var y=new SuperMapAlgoPlot.Point(0,0),f=new SuperMapAlgoPlot.Point(0,0);y.x=s+l*(s-p)/(g*this.QIANJI_RATE2),y.y=r+l*(r-h)/(g*this.QIANJI_RATE2),f.x=p+n*(p-s)/(g*this.QIANJI_RATE2),f.y=h+n*(h-r)/(g*this.QIANJI_RATE2);var P=new SuperMapAlgoPlot.Point((o[0].x+o[1].x)/2,(o[0].y+o[1].y)/2),d=new SuperMapAlgoPlot.Point((o[2].x+o[3].x)/2,(o[2].y+o[3].y)/2),S=o[3].x-(o[3].x-u.x)*this.SCALE_AT,m=o[3].y-(o[3].y-u.y)*this.SCALE_AT,b=o[2].x-(o[2].x-c.x)*this.SCALE_AT,L=o[2].y-(o[2].y-c.y)*this.SCALE_AT,v=new SuperMapAlgoPlot.Point(0,0),M=new SuperMapAlgoPlot.Point(0,0),A=new SuperMapAlgoPlot.Point(0,0),T=new SuperMapAlgoPlot.Point(0,0);M.x=S-(m-o[3].y)*this.SCALE_ATAJ,M.y=m+(S-o[3].x)*this.SCALE_ATAJ,v.x=S+(m-o[3].y)*this.SCALE_ATAJ,v.y=m-(S-o[3].x)*this.SCALE_ATAJ,T.x=b-(L-o[2].y)*this.SCALE_ATAJ,T.y=L+(b-o[2].x)*this.SCALE_ATAJ,A.x=b+(L-o[2].y)*this.SCALE_ATAJ,A.y=L-(b-o[2].x)*this.SCALE_ATAJ;var _=new SuperMapAlgoPlot.Point(0,0),O=new SuperMapAlgoPlot.Point(0,0),x=new SuperMapAlgoPlot.Point(0,0),w=new SuperMapAlgoPlot.Point(0,0);_.x=3*v.x-2*S-(o[3].x-S)*this.SCALE_ATAE,_.y=3*v.y-2*m-(o[3].y-m)*this.SCALE_ATAE,O.x=3*M.x-2*S-(o[3].x-S)*this.SCALE_ATAE,O.y=3*M.y-2*m-(o[3].y-m)*this.SCALE_ATAE,x.x=3*A.x-2*b-(o[2].x-b)*this.SCALE_ATAE,x.y=3*A.y-2*L-(o[2].y-L)*this.SCALE_ATAE,w.x=3*T.x-2*b-(o[2].x-b)*this.SCALE_ATAE,w.y=3*T.y-2*L-(o[2].y-L)*this.SCALE_ATAE,u.x=s+l*(s-p)/(g*this.QIANJI_RATE4),u.y=r+l*(r-h)/(g*this.QIANJI_RATE4),c.x=p+n*(p-s)/(g*this.QIANJI_RATE4),c.y=h+n*(h-r)/(g*this.QIANJI_RATE4);var E=new SuperMapAlgoPlot.Point(0,0);E.x=o[0].x+(u.x-o[0].x)*this.SCALE_AW,E.y=o[0].y+(u.y-o[0].y)*this.SCALE_AW;var C=new SuperMapAlgoPlot.Point(0,0);C.x=o[1].x+(c.x-o[1].x)*this.SCALE_AW,C.y=o[1].y+(c.y-o[1].y)*this.SCALE_AW;var I=new SuperMapAlgoPlot.Point(0,0);I.x=v.x+(u.x-v.x)*this.SCALE_ATAJctrlSameSide,I.y=v.y+(u.y-v.y)*this.SCALE_ATAJctrlSameSide;var D=new SuperMapAlgoPlot.Point(0,0);D.x=T.x+(c.x-T.x)*this.SCALE_ATAJctrlSameSide,D.y=T.y+(c.y-T.y)*this.SCALE_ATAJctrlSameSide;var R=new SuperMapAlgoPlot.Point(0,0);R.x=M.x+(y.x-M.x)*this.SCALE_ATAJctrlDefSide,R.y=M.y+(y.y-M.y)*this.SCALE_ATAJctrlDefSide;var N=new SuperMapAlgoPlot.Point(0,0);N.x=A.x+(f.x-A.x)*this.SCALE_ATAJctrlDefSide,N.y=A.y+(f.y-A.y)*this.SCALE_ATAJctrlDefSide;var U=new SuperMapAlgoPlot.Point(0,0);U.x=P.x+(d.x-P.x)*i,U.y=P.y+(d.y-P.y)*i,this.m_scalePoints.push(new SuperMapAlgoPlot.Point(U.x,U.y));var B=new SuperMapAlgoPlot.Point(0,0),k=new SuperMapAlgoPlot.Point(0,0);B.x=o[0].x+(o[3].x-o[0].x)*i,B.y=o[0].y+(o[3].y-o[0].y)*i,k.x=o[1].x+(o[2].x-o[1].x)*i,k.y=o[1].y+(o[2].y-o[1].y)*i,B.x=B.x+(U.x-B.x)*this.QIANJI_RATE3,B.y=B.y+(U.y-B.y)*this.QIANJI_RATE3,k.x=k.x+(U.x-k.x)*this.QIANJI_RATE3,k.y=k.y+(U.y-k.y)*this.QIANJI_RATE3;var F=[];F.push(o[0].clone()),F.push(E.clone()),F.push(I.clone()),F.push(v.clone()),e.MoveTo(F[0]),e.CurveTo(F[1],F[2],F[3]);var G,V=[],j=[],Y=[],z=[],W=[],X=[],H=[];for(e.ToSubPathPolygons(H),V.push(H[0]),G=H[0].length,e.LineTo(_),e.LineTo(o[3]),e.LineTo(O),(F=[]).push(M),F.push(R),F.push(B),F.push(U),e.LineTo(F[0]),H=[],e.ToSubPathPolygons(H);G<H[0].length;G++)j.push(H[0][G]);for(G=H[0].length,e.CurveTo(F[1],F[2],F[3]),H=[],e.ToSubPathPolygons(H);G<H[0].length;G++)Y.push(H[0][G]);for(G=H[0].length,(F=[]).push(k),F.push(N),F.push(A),e.CurveTo(F[0],F[1],F[2]),H=[],e.ToSubPathPolygons(H);G<H[0].length;G++)z.push(H[0][G]);for(G=H[0].length,e.LineTo(x),e.LineTo(o[2]),e.LineTo(w),(F=[]).push(T),F.push(D),F.push(C),F.push(a),e.LineTo(F[0]),H=[],e.ToSubPathPolygons(H);G<H[0].length;G++)W.push(H[0][G]);for(G=H[0].length,e.CurveTo(F[1],F[2],F[3]),H=[],e.ToSubPathPolygons(H);G<H[0].length;G++)X.push(H[0][G]);return H=[],e.ToSubPathPolygons(H),{shapePts:H[0],LeftArowLeftBody:V,LeftArowHead:j,LeftArowRightBody:Y,ArowMidBody:[],RightArowLeftBody:z,RightArowHead:W,RightArowRightBody:X}}}]),e}();SuperMapAlgoPlot.AlgoSymbol1021=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.AlgoSymbol1020=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return 0===o.scaleValues.length&&(o.scaleValues.push(.5),o.scaleValues.push(.222222),o.scaleValues.push(.5),o.scaleValues.push(.5),o.scaleValues.push(.5)),o.CLASS_NAME="SuperMap.Geometry.AlgoSymbol1020",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol),i(e,[{key:"calculateParts",value:function(){this.init();var t=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);if(!((t=SuperMapAlgoPlot.PlottingUtil.clearSamePts(t)).length<this.minEditPts)){0==this.scaleValues.length&&(this.scaleValues=[],this.scaleValues.push(.5),this.scaleValues.push(.222222),this.scaleValues.push(.5),this.scaleValues.push(.5),this.scaleValues.push(.5));var e=t[0].clone(),o=t[1].clone(),i=SuperMapAlgoPlot.PlottingUtil.distance(e,o),l=this.scaleValues[0],n=new SuperMapAlgoPlot.Point(0,-i*l),a=new SuperMapAlgoPlot.Point(0,i*l),s=this.scaleValues[1],r=this.scaleValues[3],u=new SuperMapAlgoPlot.Point(i*(1-r),-i*s),p=new SuperMapAlgoPlot.Point(i*(1-r),i*s),h=this.scaleValues[2],c=this.scaleValues[4],g=new SuperMapAlgoPlot.Point(i*(1-c),-i*h),y=new SuperMapAlgoPlot.Point(i*(1-c),i*h),f=new SuperMapAlgoPlot.Point(i,0),P=SuperMapAlgoPlot.PlottingUtil.radian(e,o),d=SuperMapAlgoPlot.PlottingUtil.distance(n,u),S=SuperMapAlgoPlot.PlottingUtil.findPointInLine(n,u,.3*d),m=SuperMapAlgoPlot.PlottingUtil.findPointInLine(n,u,.4*d),b=SuperMapAlgoPlot.PlottingUtil.distance(p,a),L=SuperMapAlgoPlot.PlottingUtil.findPointInLine(p,a,.6*b),v=SuperMapAlgoPlot.PlottingUtil.findPointInLine(p,a,.7*b),M=[];M.push(n),M.push(S),M.push(m),M.push(u),M.push(g),M.push(f),M.push(y),M.push(p),M.push(L),M.push(v),M.push(a);for(var A=[],T=0;T<M.length;T++){var _=SuperMapAlgoPlot.PlottingUtil.coordinateTrans(e,M[T],P*SuperMapAlgoPlot.PlottingUtil.RTOD);A.push(_)}for(var O=[],x=A.length-1;x>=0;--x)O.push(A[x]);var w=SuperMapAlgoPlot.PlottingUtil.clonePoints(O);w.push(w[0]),this.addCell(SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,w,{lineWidthLimit:!0,strokeWidth:0,weight:0,surroundLineFlag:!1}),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,[O[0],O[1]]),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,[O[2],O[3]]),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,[O[3],O[4],O[5],O[6],O[7]],{lineTypeLimit:!0}),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,[O[7],O[8]]),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,[O[9],O[10]]),this.scalePoints=[];var E=A[0].clone();E.isScalePoint=!0,E.tag=0,this.scalePoints.push(E);var C=A[3].clone();C.isScalePoint=!0,C.tag=1,this.scalePoints.push(C);var I=A[4].clone();I.isScalePoint=!0,I.tag=2,this.scalePoints.push(I),this.finish()}}},{key:"modifyPoint",value:function(t,e){if(e.isScalePoint&&(t>=0||t<3)){var o=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);o=SuperMapAlgoPlot.PlottingUtil.clearSamePts(o);var i=SuperMapAlgoPlot.PlottingUtil.distance(o[0],o[1]),l=o[0].clone(),n=o[1].clone(),a=e.clone();if(0==t){var s=SuperMapAlgoPlot.PlottingUtil.distance(a,l)/i;this.scaleValues[0]=s}else if(1==t){var r=SuperMapAlgoPlot.PlottingUtil.projectPoint(a,l,n),u=SuperMapAlgoPlot.PlottingUtil.distance(r,a)/i;this.scaleValues[1]=u;var p=SuperMapAlgoPlot.PlottingUtil.distance(r,n)/i;this.scaleValues[3]=p}else if(2==t){var h=SuperMapAlgoPlot.PlottingUtil.projectPoint(a,l,n),c=SuperMapAlgoPlot.PlottingUtil.distance(h,a)/i;this.scaleValues[2]=c;var g=SuperMapAlgoPlot.PlottingUtil.distance(h,n)/i;this.scaleValues[4]=g}}this.calculateParts()}}]),e}();SuperMapAlgoPlot.AlgoSymbol1020=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.AlgoSymbol1019=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return 0===o.scaleValues.length&&(o.scaleValues.push(.5),o.scaleValues.push(.222222),o.scaleValues.push(.5),o.scaleValues.push(.5),o.scaleValues.push(.5)),o.CLASS_NAME="SuperMap.Geometry.AlgoSymbol1019",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol),i(e,[{key:"calculateParts",value:function(){this.init();var t=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);if(!((t=SuperMapAlgoPlot.PlottingUtil.clearSamePts(t)).length<this.minEditPts)){0==this.scaleValues.length&&(this.scaleValues=[],this.scaleValues.push(.5),this.scaleValues.push(.222222),this.scaleValues.push(.5),this.scaleValues.push(.5),this.scaleValues.push(.5));var e=t[0].clone(),o=t[1].clone(),i=SuperMapAlgoPlot.PlottingUtil.distance(e,o),l=this.scaleValues[0],n=new SuperMapAlgoPlot.Point(0,-i*l),a=new SuperMapAlgoPlot.Point(0,i*l),s=this.scaleValues[1],r=this.scaleValues[3],u=new SuperMapAlgoPlot.Point(i*(1-r),-i*s),p=new SuperMapAlgoPlot.Point(i*(1-r),i*s),h=this.scaleValues[2],c=this.scaleValues[4],g=new SuperMapAlgoPlot.Point(i*(1-c),-i*h),y=new SuperMapAlgoPlot.Point(i*(1-c),i*h),f=new SuperMapAlgoPlot.Point(i,0),P=SuperMapAlgoPlot.PlottingUtil.radian(e,o),d=[];d.push(n),d.push(u),d.push(g),d.push(f),d.push(y),d.push(p),d.push(a),d.push(n);for(var S=[],m=0;m<d.length;m++){var b=SuperMapAlgoPlot.PlottingUtil.coordinateTrans(e,d[m],P*SuperMapAlgoPlot.PlottingUtil.RTOD);S.push(b)}for(var L=[],v=S.length-1;v>=0;--v)L.push(S[v]);this.addCell(SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,L,{lineWidthLimit:!0,strokeWidth:0,weight:0,surroundLineFlag:!1}),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,[L[2],L[1],L[7],L[6]],{surroundLineFlag:!1}),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,[L[6],L[5],L[4],L[3],L[2]],{lineTypeLimit:!0,surroundLineFlag:!1}),this.scalePoints=[];var M=S[0].clone();M.isScalePoint=!0,M.tag=0,this.scalePoints.push(M);var A=S[1].clone();A.isScalePoint=!0,A.tag=1,this.scalePoints.push(A);var T=S[2].clone();T.isScalePoint=!0,T.tag=2,this.scalePoints.push(T),this.finish()}}},{key:"modifyPoint",value:function(t,e){if(e.isScalePoint&&(t>=0||t<3)){var o=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);o=SuperMapAlgoPlot.PlottingUtil.clearSamePts(o);var i=SuperMapAlgoPlot.PlottingUtil.distance(o[0],o[1]),l=o[0].clone(),n=o[1].clone(),a=e.clone();if(0==t){var s=SuperMapAlgoPlot.PlottingUtil.distance(a,l)/i;this.scaleValues[0]=s}else if(1==t){var r=SuperMapAlgoPlot.PlottingUtil.projectPoint(a,l,n),u=SuperMapAlgoPlot.PlottingUtil.distance(r,a)/i;this.scaleValues[1]=u;var p=SuperMapAlgoPlot.PlottingUtil.distance(r,n)/i;this.scaleValues[3]=p}else if(2==t){var h=SuperMapAlgoPlot.PlottingUtil.projectPoint(a,l,n),c=SuperMapAlgoPlot.PlottingUtil.distance(h,a)/i;this.scaleValues[2]=c;var g=SuperMapAlgoPlot.PlottingUtil.distance(h,n)/i;this.scaleValues[4]=g}}this.calculateParts()}}]),e}();SuperMapAlgoPlot.AlgoSymbol1019=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.AlgoSymbol1018=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return o.MAX_ARRAY_SIZE=128,o.sv1_DefaultAtLenDivAbLen=0,o.sv2_DefaultAjWidthDivAtLen=.148,o.sv3_DefaultAeWidthDivAtLen=.4,o.sv4_DefaultAeLenDivAtLen=.312,o.sv_AtScaleParameter=1.5,o.sv_AtLenDivAtWidth=1.35,o.sv_AtWidthDivAwWidth=.5,o.sv_defaultAwLenDivAbLen=.15,0===o.scaleValues.length&&(o.scaleValues.push(o.sv1_DefaultAtLenDivAbLen),o.scaleValues.push(o.sv2_DefaultAjWidthDivAtLen),o.scaleValues.push(o.sv3_DefaultAeWidthDivAtLen),o.scaleValues.push(o.sv4_DefaultAeLenDivAtLen)),o.CLASS_NAME="SuperMap.Geometry.AlgoSymbol1018",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol),i(e,[{key:"calculateParts",value:function(){this.init(),this.applyUse()}},{key:"applyUse",value:function(){var t=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);if((t=SuperMapAlgoPlot.PlottingUtil.clearSamePts(t)).length>=2&&t.length<this.minEditPts&&this.calAssistantLine(),!(t.length<3)){var e=SuperMapAlgoPlot.PlottingUtil.clonePoints(t),o=this.arrowMeshs(e),i=SuperMapAlgoPlot.PlottingUtil.clonePoints(o.shapePts);(i=SuperMapAlgoPlot.PlottingUtil.clearSamePts(i)).push(i[0]);var l=SuperMapAlgoPlot.PlottingUtil.clearSamePts(o.leftBodyPts),n=SuperMapAlgoPlot.PlottingUtil.clearSamePts(o.rightBodyPts),a=SuperMapAlgoPlot.PlottingUtil.clearSamePts(o.arrowHeadPts);if(0!=o.shapePts.length){var s=SuperMapAlgoPlot.PlottingUtil.polylineDistance(l),r=SuperMapAlgoPlot.PlottingUtil.getPtsIndexByDistance(.4*s,l),u=[],p=[],h=[];if(r.bfind)for(var c=0;c<=r.index;c++)u.push(l[c]);var g=SuperMapAlgoPlot.PlottingUtil.getPtsIndexByDistance(.45*s,l),y=SuperMapAlgoPlot.PlottingUtil.getPtsIndexByDistance(.8*s,l);if(g.bfind&&y.bfind)for(var f=g.index;f<=y.index;f++)p.push(l[f]);var P=SuperMapAlgoPlot.PlottingUtil.getPtsIndexByDistance(.85*s,l);if(P.bfind)for(var d=P.index;d<l.length;d++)h.push(l[d]);var S=SuperMapAlgoPlot.PlottingUtil.polylineDistance(n),m=SuperMapAlgoPlot.PlottingUtil.getPtsIndexByDistance(.15*S,n),b=[],L=[],v=[];if(m.bfind)for(var M=0;M<=m.index;M++)b.push(n[M]);var A=SuperMapAlgoPlot.PlottingUtil.getPtsIndexByDistance(.2*S,n),T=SuperMapAlgoPlot.PlottingUtil.getPtsIndexByDistance(.55*S,n);if(A.bfind&&T.bfind)for(var _=A.index;_<=T.index;_++)L.push(n[_]);var O=SuperMapAlgoPlot.PlottingUtil.getPtsIndexByDistance(.6*S,n);if(O.bfind)for(var x=O.index;x<n.length;x++)v.push(n[x]);var w=SuperMapAlgoPlot.PlottingUtil.clonePoints(a);w.splice(0,0,l[l.length-1]),w.push(n[0]),this.addCell(SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,i,{lineWidthLimit:!0,strokeWidth:0,weight:0,surroundLineFlag:!1}),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,u,{surroundLineFlag:!1}),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,p,{surroundLineFlag:!1}),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,h,{surroundLineFlag:!1}),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,b,{surroundLineFlag:!1}),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,L,{surroundLineFlag:!1}),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,v,{surroundLineFlag:!1}),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,w,{surroundLineFlag:!1,lineTypeLimit:!0});var E=this.updateScalePoints(e);if(this.scalePoints=[],3!=E.length)E=[];else for(var C=0;C<E.length;C++)E[C].isScalePoint=!0,E[C].tag=C,this.scalePoints.push(E[C]);this.finish()}else this.finish()}}},{key:"modifyPoint",value:function(t,e){if(!0===e.isScalePoint){var o=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);o=SuperMapAlgoPlot.PlottingUtil.clearSamePts(o),this.scaleValues.length<4&&(this.scaleValues.push(this.sv1_DefaultAtLenDivAbLen),this.scaleValues.push(this.sv2_DefaultAjWidthDivAtLen),this.scaleValues.push(this.sv3_DefaultAeWidthDivAtLen),this.scaleValues.push(this.sv4_DefaultAeLenDivAtLen));var i=o.length;if(i<=2)return;var l,n,a,s,r=this.operateCtrlPts(o);i=r.length,i--;var u=this.calcScaleValueCount(o.length);if(this.scaleValues.length<u){var p=this.calcDefaultScaleValues(i);l=p[0],n=p[1],a=p[2],s=p[3]}else l=this.scaleValues[0],n=this.scaleValues[1],a=this.scaleValues[2],s=this.scaleValues[3];for(var h=SuperMapAlgoPlot.PlottingUtil.polylineDistance(o),c=[],g=0;g<this.scalePoints.length;g++)c.push(this.scalePoints[g].clone());if(0==c.length)return;c[t]=e.clone();var y,f,P=i-1;y=i<=3?new SuperMapAlgoPlot.Point((r[0].x+r[1].x)/2,(r[0].y+r[1].y)/2):r[P-1].clone();var d,S,m,b,L,v,M=new SuperMapAlgoPlot.Point(0,0),A=new SuperMapAlgoPlot.Point(0,0),T=new SuperMapAlgoPlot.Point(0,0);SuperMapAlgoPlot.PlottingUtil.getTrianglePoints(0,3,y,r[P],r[P+1],A,T),SuperMapAlgoPlot.PlottingUtil.getTrapezoidPoints(.5,r[i],r[i-1],T,M),f=M.clone();var _=SuperMapAlgoPlot.PlottingUtil.triangleHeightAndPartBottomLen(r[i],f,c[2]);d=_.dLen1,_.dLen2,0==d&&(d=.1),S=d,l=(d/=s+1)/h,1==t?(b=(_=SuperMapAlgoPlot.PlottingUtil.triangleHeightAndPartBottomLen(r[i],f,c[1])).dLen1,a=(L=_.dLen2)/d,s=(b-d)/d):0==t?(d=(_=SuperMapAlgoPlot.PlottingUtil.triangleHeightAndPartBottomLen(r[i],f,c[0])).dLen1,n=(m=_.dLen2)/d,(v=SuperMapAlgoPlot.PlottingUtil.distance(r[i],r[i-1]))<2*d&&(d=.5*v),b=(_=SuperMapAlgoPlot.PlottingUtil.triangleHeightAndPartBottomLen(r[i],f,c[1])).dLen1,a=(L=_.dLen2)/d,(s=(S-d)/d)<.1&&(a=L/(d=S/(1+(s=.1))),n=m/d),l=d/h):2==t&&(l=d/h),m=d*n,(v=SuperMapAlgoPlot.PlottingUtil.distance(r[i],r[i-1]))<2*d&&(m=(d=.5*v)*n,l=d/h),this.scaleValues[0]=l,this.scaleValues[1]=n,this.scaleValues[2]=a,this.scaleValues[3]=s}this.calculateParts()}},{key:"arrowMeshs",value:function(t){var e=[],o=[],i=[],l=[],n=SuperMapAlgoPlot.PlottingUtil.clonePoints(t),a=SuperMapAlgoPlot.ArrowToolkit.generateArrowBodyShapePts(n,this.scaleValues,SuperMapAlgoPlot.ArrowToolkit.ArrowBodyType.ARROWBODY_MULTIPOLYBEZIER),s=a.arrowTouLen,r=a.leftBodyPts,u=a.rightBodyPts;if(!SuperMapAlgoPlot.PlottingUtil.equalFuzzy(s,0)){var p=[];p.push(r[r.length-1]),p.push(u[u.length-1]);var h=[];h.push(this.scaleValues[2]),h.push(this.scaleValues[3]),h.push(0),h.push(0);for(var c=SuperMapAlgoPlot.ArrowToolkit.generateArrowHeadShapePts(n,p,h,s,SuperMapAlgoPlot.ArrowToolkit.ArrowHeadType.ARROWHEAD_WITH_EAR),g=0;g<r.length;g++)e.push(r[g]),o.push(r[g]);for(var y=0;y<c.length;y++)e.push(c[y]),l.push(c[y]);for(var f=u.length-1;f>=0;f--)e.push(u[f]),i.push(u[f])}return{shapePts:e,leftBodyPts:o,rightBodyPts:i,arrowHeadPts:l}}},{key:"updateScalePoints",value:function(t){var e=t.length,o=[];if(!(e<3)){var i=SuperMapAlgoPlot.PlottingUtil.polylineDistance(t);if(!SuperMapAlgoPlot.PlottingUtil.equalFuzzy(i,0)){var l=this.operateCtrlPts(t);e=l.length,e--;for(var n=[],a=0;a<this.scaleValues.length;a++)n.push(this.scaleValues[a]);var s=this.genArrowBodyPts(i,l,n),r=s.ArrowBodyCenterPts,u=this.genAtPts(e,r,n,s.ArrowTouLen),p=this.calc3rdScalePt(e,r,n,s.ArrowTouLen);return o.push(new SuperMapAlgoPlot.Point(s.LeftBodyPtsTemp[e].x,s.LeftBodyPtsTemp[e].y)),o.push(new SuperMapAlgoPlot.Point(u[2].x,u[2].y)),o.push(new SuperMapAlgoPlot.Point(p.x,p.y)),o}}}},{key:"operateCtrlPts",value:function(t){var e=SuperMapAlgoPlot.PlottingUtil.clonePoints(t);if(3===e.length){var o=((e[0].x+e[1].x)/2+e[2].x)/2,i=((e[0].y+e[1].y)/2+e[2].y)/2,l=new SuperMapAlgoPlot.Point(o,i),n=e[2];e[2]=l,e.push(n)}return e}},{key:"genArrowBodyPts",value:function(t,e,o){var i,l,n,a=[],s=[],r=[],u=[],p=[],h=[],c=e.length;if(c--,o.length<this.calcScaleValueCount(c)){var g=this.calcDefaultScaleValues(c);l=g[0],n=g[1]}else l=o[0],n=o[1];var y=SuperMapAlgoPlot.PlottingUtil.clonePoints(e),f=(y[0].x+y[1].x)/2,P=(y[0].y+y[1].y)/2,d=Math.abs(f-y[2].x),S=Math.abs(P-y[2].y),m=0;if(d>0&&S>0){var b=1/(f-y[2].x),L=-1/(P-y[2].y),v=1*y[2].y/(P-y[2].y)-1*y[2].x/(f-y[2].x);m=Math.abs(b*y[0].x+L*y[0].y+v)/Math.sqrt(b*b+L*L)}else S<=1e-4?m=Math.abs(P-y[1].y):d<=1e-4&&(m=Math.abs(f-y[1].x));var M=SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine(m,y[2],new SuperMapAlgoPlot.Point(f,P)),A=SuperMapAlgoPlot.PlottingUtil.pointIsRightToLine(y[1],y[2],y[0]);A?(a[1]=y[1],s[1]=y[0]):(a[1]=y[0],s[1]=y[1]),y[1]=new SuperMapAlgoPlot.Point((y[0].x+y[1].x)/2,(y[0].y+y[1].y)/2);var T=Math.sqrt((M.pntLeft.x-M.pntRight.x)*(M.pntLeft.x-M.pntRight.x)+(M.pntLeft.y-M.pntRight.y)*(M.pntLeft.y-M.pntRight.y))*this.sv_AtWidthDivAwWidth,_=(i=T*this.sv_AtLenDivAtWidth)*n;SuperMapAlgoPlot.PlottingUtil.equalFuzzy(l,0)||(_=(i=t*l)*n);var O,x,w=SuperMapAlgoPlot.PlottingUtil.distance(y[c],y[c-1]),E=2*i;w<E&&(_=(i=w/2)*n),y.push(y[c].clone()),O=0,x=0;var C=0,I=[];for(C=2;C<=c;C++)O+=SuperMapAlgoPlot.PlottingUtil.distance(y[C],y[C-1]);for(O-=i,C=2;C<=c-1;C++)x+=SuperMapAlgoPlot.PlottingUtil.distance(y[C],y[C-1]),I[C]=_+(T-_)*Math.pow((O-x)/O,this.sv_AtScaleParameter);I[c]=_;var D,R,N=new SuperMapAlgoPlot.Point(0,0),U=new SuperMapAlgoPlot.Point(0,0),B=new SuperMapAlgoPlot.Point(0,0);for(C=2;C<=c-1;C++)SuperMapAlgoPlot.PlottingUtil.getTrianglePoints(0,3,y[C-1],y[C],y[C+1],U,B),C==c-1&&SuperMapAlgoPlot.PlottingUtil.getTrapezoidPoints(.5,y[c],y[c-1],B,N),D=SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine(I[C],U,y[C]),(A=SuperMapAlgoPlot.PlottingUtil.pointIsRightToLine(B,U,D.pntRight))?(a[C]=new SuperMapAlgoPlot.Point(D.pntRight.x,D.pntRight.y),s[C]=new SuperMapAlgoPlot.Point(D.pntLeft.x,D.pntLeft.y)):(a[C]=new SuperMapAlgoPlot.Point(D.pntLeft.x,D.pntLeft.y),s[C]=new SuperMapAlgoPlot.Point(D.pntRight.x,D.pntRight.y));for(Math.sqrt(1*(y[c].x-N.x)*(y[c].x-N.x)+1*(y[c].y-N.y)*(y[c].y-N.y))>0&&(y[c]=SuperMapAlgoPlot.PlottingUtil.getIncentrePointOnSegmentByScale(i,y[c],N)),D=SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine(_,y[c+1],y[c]),(A=SuperMapAlgoPlot.PlottingUtil.pointIsRightToLine(y[c],y[c+1],D.pntLeft))?(s[c]=new SuperMapAlgoPlot.Point(D.pntLeft.x,D.pntLeft.y),a[c]=new SuperMapAlgoPlot.Point(D.pntRight.x,D.pntRight.y)):(s[c]=new SuperMapAlgoPlot.Point(D.pntRight.x,D.pntRight.y),a[c]=new SuperMapAlgoPlot.Point(D.pntLeft.x,D.pntLeft.y)),C=2;C<c;C++)SuperMapAlgoPlot.PlottingUtil.getTrianglePoints(3,3,a[C-1],a[C],a[C+1],U,B),r[C]=new SuperMapAlgoPlot.Point(U.x,U.y),u[C]=new SuperMapAlgoPlot.Point(B.x,B.y),SuperMapAlgoPlot.PlottingUtil.getTrianglePoints(3,3,s[C-1],s[C],s[C+1],U,B),p[C]=new SuperMapAlgoPlot.Point(U.x,U.y),h[C]=new SuperMapAlgoPlot.Point(B.x,B.y),2==C&&(SuperMapAlgoPlot.PlottingUtil.getTrapezoidPoints(.5,a[1],a[2],r[2],N),u[C]=new SuperMapAlgoPlot.Point(N.x,N.y),SuperMapAlgoPlot.PlottingUtil.getTrapezoidPoints(.5,s[1],s[2],p[2],N),h[C]=new SuperMapAlgoPlot.Point(N.x,N.y)),C==c-1&&(E=(w=SuperMapAlgoPlot.PlottingUtil.distance(a[c],a[c-1]))/3,(R=SuperMapAlgoPlot.PlottingUtil.getExcentrePointOnSegmentByScale(E,y[c],y[c+1])).x+=a[c].x-y[c].x,R.y+=a[c].y-y[c].y,E=(w=T-_)*Math.pow(E/O,this.sv_AtScaleParameter),D=SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine(E,a[c],R),r[c]=new SuperMapAlgoPlot.Point(D.pntLeft.x,D.pntLeft.y),E=(w=SuperMapAlgoPlot.PlottingUtil.distance(s[c],s[c-1]))/3,(R=SuperMapAlgoPlot.PlottingUtil.getExcentrePointOnSegmentByScale(E,y[c],y[c+1])).x+=s[c].x-y[c].x,R.y+=s[c].y-y[c].y,E=(w=T-_)*Math.pow(E/O,this.sv_AtScaleParameter),D=SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine(E,s[c],R),p[c]=new SuperMapAlgoPlot.Point(D.pntRight.x,D.pntRight.y));return{ArrowBodyCenterPts:SuperMapAlgoPlot.PlottingUtil.clonePoints(y),LeftBodyPtsTemp:a,RightBodyPtsTemp:s,LeftBodyPtsLeftCtrlPts:r,LeftBodyPtsRightCtrlPts:u,RightBodyPtsLeftCtrlPts:p,RightBodyPtsRightCtrlPts:h,ArrowTouLen:i}}},{key:"calcScaleValueCount",value:function(){return 4}},{key:"calcDefaultScaleValues",value:function(){var t=[];return t.push(this.sv1_DefaultAtLenDivAbLen),t.push(this.sv2_DefaultAjWidthDivAtLen),t.push(this.sv3_DefaultAeWidthDivAtLen),t.push(this.sv4_DefaultAeLenDivAtLen),t}},{key:"genAtPts",value:function(t,e,o,i){var l=o[2],n=[],a=i*o[3],s=SuperMapAlgoPlot.PlottingUtil.getExcentrePointOnSegmentByScale(a,e[t],e[t+1]);a=i*l;var r=SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine(a,e[t+1],s);return n.push(new SuperMapAlgoPlot.Point(r.pntLeft.x,r.pntLeft.y)),n.push(e[t+1]),n.push(new SuperMapAlgoPlot.Point(r.pntRight.x,r.pntRight.y)),n}},{key:"calc3rdScalePt",value:function(t,e,o,i){var l=i*o[3];return SuperMapAlgoPlot.PlottingUtil.getExcentrePointOnSegmentByScale(l,e[t],e[t+1])}}]),e}();SuperMapAlgoPlot.AlgoSymbol1018=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.AlgoSymbol1017=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return 0===o.scaleValues.length&&(o.scaleValues.push(.1),o.scaleValues.push(.2),o.scaleValues.push(0),o.scaleValues.push(.3),o.scaleValues.push(.3)),o.CLASS_NAME="SuperMap.Geometry.AlgoSymbol1017",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol),i(e,[{key:"calculateParts",value:function(){this.init();var t=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);if((t=SuperMapAlgoPlot.PlottingUtil.clearSamePts(t)).length>=this.minEditPts){this.scalePoints=[];var e=SuperMapAlgoPlot.PlottingUtil.clonePoints(t);this.isEdit||(this.scaleValues[0]=1.5*this.getSubSymbolScaleValue());var o=SuperMapAlgoPlot.ArrowToolkit.generateArrowBodyShapePts(e,this.scaleValues,SuperMapAlgoPlot.ArrowToolkit.ArrowBodyType.ARROWBODY_PARALLEL),i=o.arrowTouLen,l=o.leftBodyPts,n=o.rightBodyPts,a=[];a.push(l[l.length-1]),a.push(n[n.length-1]);var s=[];s.push(this.scaleValues[3]),s.push(this.scaleValues[4]),s.push(this.scaleValues[0]),s.push(this.scaleValues[1]);var r=SuperMapAlgoPlot.ArrowToolkit.generateArrowHeadShapePts(e,a,s,i,SuperMapAlgoPlot.ArrowToolkit.ArrowHeadType.ARROWHEAD_WITHOUT_EAR),u=[];u=(u=u.concat(l)).concat(r);for(var p=n.length-1;p>=0;p--)u.push(n[p]);u.push(u[0]),this.addCell(SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,u,{lineWidthLimit:!0,strokeWidth:0,weight:0,surroundLineFlag:!1});for(var h=SuperMapAlgoPlot.PlottingUtil.clonePoints(l),c=[],g=n.length-1;g>=0;g--)c.push(n[g]);c=c.concat(h),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,c);var y=SuperMapAlgoPlot.PlottingUtil.clonePoints(r);y.push(n[n.length-1]),y.splice(0,0,l[l.length-1]),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,y,{lineTypeLimit:!0});var f=new SuperMapAlgoPlot.Point((a[0].x+a[1].x)/2,(a[0].y+a[1].y)/2),P=new SuperMapAlgoPlot.Point(f.x,f.y);P.isScalePoint=!0,P.tag=0,this.scalePoints.push(P);var d=new SuperMapAlgoPlot.Point(l[l.length-1].x,l[l.length-1].y);d.isScalePoint=!0,d.tag=1,this.scalePoints.push(d);var S=new SuperMapAlgoPlot.Point(r[0].x,r[0].y);S.isScalePoint=!0,S.tag=2,this.scalePoints.push(S),this.finish()}}},{key:"modifyPoint",value:function(t,e){if(!0===e.isScalePoint){var o=new SuperMapAlgoPlot.Point(this.scalePoints[0].x,this.scalePoints[0].y),i=new SuperMapAlgoPlot.Point(this.scalePoints[1].x,this.scalePoints[1].y),l=new SuperMapAlgoPlot.Point(this.scalePoints[2].x,this.scalePoints[2].y),n=this.scaleValues[0],a=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);a=SuperMapAlgoPlot.PlottingUtil.clearSamePts(a);var s=SuperMapAlgoPlot.PlottingUtil.polylineDistance(a),r=s*n;if(0==t){var u=SuperMapAlgoPlot.PlottingUtil.pointProjectToSegment(e,a[a.length-2],a[a.length-1]),p=u.projectPoint;if(u.isOnline){var h=SuperMapAlgoPlot.PlottingUtil.distance(p,a[a.length-1]);this.scaleValues[0]=h/s}}else if(1==t){var c=SuperMapAlgoPlot.PlottingUtil.pointProjectToSegment(e,i,l).projectPoint,g=SuperMapAlgoPlot.PlottingUtil.distance(c,o);this.scaleValues[1]=g/r}else if(2==t){var y=SuperMapAlgoPlot.PlottingUtil.pointProjectToSegment(e,a[1],l).projectPoint,f=SuperMapAlgoPlot.PlottingUtil.pointProjectToSegment(y,o,a[1]),P=f.projectPoint,d=SuperMapAlgoPlot.PlottingUtil.distance(P,o);!1===f.isOnline&&(this.scaleValues[4]=d/r)}}this.calculateParts()}}]),e}();SuperMapAlgoPlot.AlgoSymbol1017=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.AlgoSymbol1016=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return 0===o.scaleValues.length&&o.scaleValues.push(.1),o.arrowHeadType=t.arrowHeadType?t.arrowHeadType:0,o.arrowBodyType=t.arrowBodyType?t.arrowBodyType:0,o.arrowTailType=t.arrowTailType?t.arrowTailType:0,o.CLASS_NAME="SuperMapAlgoPlot.AlgoSymbol1016",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol),i(e,[{key:"calculateParts",value:function(){this.init();var t=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);if(!((t=SuperMapAlgoPlot.PlottingUtil.clearSamePts(t)).length<this.minEditPts)){var e={surroundLineFlag:!1,fillLimit:!0,fillColorLimit:!1,fillStyle:0,lineTypeLimit:!0};this.scaleValues[0]=this.getSubSymbolScaleValue();var o,i=SuperMapAlgoPlot.PlottingUtil.polylineDistance(t)*this.scaleValues[0],l=2*Math.sqrt(i*i/3)/1.4,n=Math.sqrt(i*i/3),a=!1;this.arrowBodyType===SuperMapAlgoPlot.ArrowToolkit.ArrowBodyType.ARROWBODY_COATTAIL?o=SuperMapAlgoPlot.ArrowToolkit.generateArrowBodyShapePtsBySingleLine(t,i,this.arrowBodyType,a):this.arrowHeadType===SuperMapAlgoPlot.ArrowToolkit.ArrowHeadType.ARROWHEAD_TRIANGLE||this.arrowHeadType===SuperMapAlgoPlot.ArrowToolkit.ArrowHeadType.ARROWHEAD_TRIANGLE_SOLID?(a=!0,o=SuperMapAlgoPlot.ArrowToolkit.generateArrowBodyShapePtsBySingleLine(t,i,this.arrowBodyType,a)):this.arrowHeadType===SuperMapAlgoPlot.ArrowToolkit.ArrowHeadType.ARROWHEAD_POLYLINE?o=SuperMapAlgoPlot.ArrowToolkit.generateArrowBodyShapePtsBySingleLine(t,i,this.arrowBodyType,a):this.arrowHeadType===SuperMapAlgoPlot.ArrowToolkit.ArrowHeadType.ARROWHEAD_COATTAIL_HOLLOW?(a=!0,o=SuperMapAlgoPlot.ArrowToolkit.generateArrowBodyShapePtsBySingleLine(t,l,this.arrowBodyType,a)):this.arrowHeadType===SuperMapAlgoPlot.ArrowToolkit.ArrowHeadType.ARROWHEAD_COATTAIL?(a=!0,o=SuperMapAlgoPlot.ArrowToolkit.generateArrowBodyShapePtsBySingleLine(t,n,this.arrowBodyType,a)):o=SuperMapAlgoPlot.ArrowToolkit.generateArrowBodyShapePtsBySingleLine(t,0,this.arrowBodyType,a);var s=[];this.arrowBodyType===SuperMapAlgoPlot.ArrowToolkit.ArrowBodyType.ARROWBODY_COATTAIL?(s.push(t[t.length-1]),s.push(t[t.length-2])):a?(s.push(t[t.length-1]),s.push(o[o.length-1])):(s.push(o[o.length-1]),s.push(o[o.length-2]));var r,u=SuperMapAlgoPlot.ArrowToolkit.generateArrowHeadShapePtsBySingleLine(s,i,this.arrowHeadType);if(o.length>1)if(this.arrowBodyType!==SuperMapAlgoPlot.ArrowToolkit.ArrowBodyType.ARROWBODY_COATTAIL)this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,o);else for(var p=0,h=o.length-1;p<h;p+=2){var c=SuperMapAlgoPlot.PlottingUtil.distance(o[p+1],o[p]),g=180*SuperMapAlgoPlot.PlottingUtil.radian(o[p+1],o[p])/Math.PI,y=SuperMapAlgoPlot.PlottingUtil.circlePoint(o[p+1],.3*c,.3*c,g+30),f=SuperMapAlgoPlot.PlottingUtil.circlePoint(o[p+1],.3*c,.3*c,g+330),P=SuperMapAlgoPlot.PlottingUtil.circlePoint(o[p],.3*c,.3*c,g+30),d=SuperMapAlgoPlot.PlottingUtil.circlePoint(o[p],.3*c,.3*c,g+330),S=[];S.push(y,o[p+1],f,d,o[p],P),this.addCell(SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,S,e)}r=this.arrowBodyType===SuperMapAlgoPlot.ArrowToolkit.ArrowBodyType.ARROWBODY_POLYBEZIER?SuperMapAlgoPlot.ArrowToolkit.generateArrowTailShapePtsBySingleLine([o[0],o[1]],i,this.arrowTailType):SuperMapAlgoPlot.ArrowToolkit.generateArrowTailShapePtsBySingleLine([t[0],t[1]],i,this.arrowTailType);var m=SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL;this.arrowHeadType!==SuperMapAlgoPlot.ArrowToolkit.ArrowHeadType.ARROWHEAD_COATTAIL&&this.arrowHeadType!==SuperMapAlgoPlot.ArrowToolkit.ArrowHeadType.ARROWHEAD_TRIANGLE_SOLID&&this.arrowHeadType!==SuperMapAlgoPlot.ArrowToolkit.ArrowHeadType.ARROWHEAD_TRIANGLE&&this.arrowHeadType!==SuperMapAlgoPlot.ArrowToolkit.ArrowHeadType.ARROWHEAD_COATTAIL_HOLLOW||(m=SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL),u.length>1&&this.addCell(m,u,e),r.length>1&&this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,r)}}}]),e}();SuperMapAlgoPlot.AlgoSymbol1016=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=e.AlgoSymbol1015=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return o.subSymbolDefaultPixelSize=15,o.CLASS_NAME="SuperMapAlgoPlot.AlgoSymbol1015",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol1009),e}();SuperMapAlgoPlot.AlgoSymbol1015=i},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=e.AlgoSymbol1014=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return o.subSymbolDefaultPixelSize=15,o.CLASS_NAME="SuperMapAlgoPlot.AlgoSymbol1014",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol1008),e}();SuperMapAlgoPlot.AlgoSymbol1014=i},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=e.AlgoSymbol1013=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return o.subSymbolDefaultPixelSize=15,o.CLASS_NAME="SuperMapAlgoPlot.AlgoSymbol1013",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol1007),e}();SuperMapAlgoPlot.AlgoSymbol1013=i},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=e.AlgoSymbol1012=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return o.subSymbolDefaultPixelSize=15,o.CLASS_NAME="SuperMapAlgoPlot.AlgoSymbol1012",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol1005),e}();SuperMapAlgoPlot.AlgoSymbol1012=i},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.AlgoSymbol1011=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return o.sv1_DefaultAtLenDivAbLen=0,o.sv2_DefaultAjWidthDivAtLen=.148,o.sv3_DefaultAeWidthDivAtLen=.4,o.sv4_DefaultAeLenDivAtLen=.312,o.sv_arrowTailWidth=.05,5!==o.scaleValues.length&&(o.scaleValues=[],o.scaleValues.push(o.sv1_DefaultAtLenDivAbLen),o.scaleValues.push(o.sv2_DefaultAjWidthDivAtLen),o.scaleValues.push(o.sv3_DefaultAeWidthDivAtLen),o.scaleValues.push(o.sv4_DefaultAeLenDivAtLen),o.scaleValues.push(o.sv_arrowTailWidth)),o.CLASS_NAME="SuperMapAlgoPlot.AlgoSymbol1011",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol1004),i(e,[{key:"calculateParts",value:function(){this.init();var t=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);if(!((t=SuperMapAlgoPlot.PlottingUtil.clearSamePts(t)).length<2)){var e=SuperMapAlgoPlot.PlottingUtil.polylineDistance(t);if(0!==e){var o=e*this.scaleValues[4],i=SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine(o,t[1],t[0]);void 0!==t[0].z&&(i.pntLeft.z=t[0].z,i.pntRight.z=t[0].z),this.controlPoints=[],this.controlPoints.push(i.pntLeft),this.controlPoints.push(i.pntRight);for(var l=1;l<t.length;l++)this.controlPoints.push(t[l].clone());for(var n=[],a=0;a<this.scaleValues.length;a++)n.push(this.scaleValues[a]);this.scaleValues=[];for(var s=0;s<n.length-1;s++)this.scaleValues.push(n[s]);SuperMapAlgoPlot.AlgoSymbol1004.prototype.calculateParts.apply(this,arguments);var r=i.pntRight.clone();r.isScalePoint=!0,r.tag=3,this.addScalePoint(r),this.controlPoints=SuperMapAlgoPlot.PlottingUtil.clonePoints(t),this.scaleValues=[];for(var u=0;u<n.length;u++)this.scaleValues.push(n[u])}}}},{key:"modifyPoint",value:function(t,e){if(!0===e.isScalePoint){var o=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);if(o.length<2)return;this.scaleValues.length<5&&(this.scaleValues=[],this.scaleValues.push(this.sv1_DefaultAtLenDivAbLen),this.scaleValues.push(this.sv2_DefaultAjWidthDivAtLen),this.scaleValues.push(this.sv3_DefaultAeWidthDivAtLen),this.scaleValues.push(this.sv4_DefaultAeLenDivAtLen),this.scaleValues.push(this.sv_arrowTailWidth));var i,l=o[0].clone(),n=SuperMapAlgoPlot.PlottingUtil.polylineDistance(o),a=n*this.scaleValues[4],s=SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine(a,o[1],o[0]);(o=[]).push(s.pntLeft),o.push(s.pntRight);for(var r=1;r<this.controlPoints.length;r++)o.push(this.controlPoints[r].clone());var u,p,h,c,g,y=o.length,f=this.operateCtrlPts(o);y=f.length,y--;var P=this.calcScaleValueCount(o.length);if(P++,this.scaleValues.length<P){var d=this.calcDefaultScaleValues(y);u=d[0],p=d[1],h=d[2],c=d[3],g=this.sv_arrowTailWidth}else u=this.scaleValues[0],p=this.scaleValues[1],h=this.scaleValues[2],c=this.scaleValues[3],g=this.scaleValues[4];i=SuperMapAlgoPlot.PlottingUtil.polylineDistance(o);for(var S=[],m=0;m<this.scalePoints.length;m++)S.push(this.scalePoints[m].clone());if(0===S.length)return;S[t]=e.clone();var b,L,v=y-1;b=y<=3?new SuperMapAlgoPlot.Point((f[0].x+f[1].x)/2,(f[0].y+f[1].y)/2):f[v-1].clone();var M,A,T,_,O,x,w=new SuperMapAlgoPlot.Point(0,0),E=new SuperMapAlgoPlot.Point(0,0),C=new SuperMapAlgoPlot.Point(0,0);SuperMapAlgoPlot.PlottingUtil.getTrianglePoints(0,3,b,f[v],f[v+1],E,C),SuperMapAlgoPlot.PlottingUtil.getTrapezoidPoints(.5,f[y],f[y-1],C,w),L=w.clone();var I=SuperMapAlgoPlot.PlottingUtil.triangleHeightAndPartBottomLen(f[y],L,S[2]);if(M=I.dLen1,I.dLen2,0===M&&(M=.1),A=M,u=(M/=c+1)/i,1===t)_=(I=SuperMapAlgoPlot.PlottingUtil.triangleHeightAndPartBottomLen(f[y],L,S[1])).dLen1,h=(O=I.dLen2)/M,c=(_-M)/M;else if(0===t)M=(I=SuperMapAlgoPlot.PlottingUtil.triangleHeightAndPartBottomLen(f[y],L,S[0])).dLen1,p=(T=I.dLen2)/M,(x=SuperMapAlgoPlot.PlottingUtil.distance(f[y],f[y-1]))<2*M&&(M=.5*x),_=(I=SuperMapAlgoPlot.PlottingUtil.triangleHeightAndPartBottomLen(f[y],L,S[1])).dLen1,h=(O=I.dLen2)/M,(c=(A-M)/M)<.1&&(h=O/(M=A/(1+(c=.1))),p=T/M),u=M/i;else if(2===t)u=M/i;else{g=SuperMapAlgoPlot.PlottingUtil.distance(e,l)/n}T=M*p,(x=SuperMapAlgoPlot.PlottingUtil.distance(f[y],f[y-1]))<2*M&&(T=(M=.5*x)*p,u=M/i),this.scaleValues[0]=u,this.scaleValues[1]=p,this.scaleValues[2]=h,this.scaleValues[3]=c,this.scaleValues[4]=g}this.calculateParts()}},{key:"arrowMeshs",value:function(t){var e=[],o=[],i=[],l=[],n=SuperMapAlgoPlot.PlottingUtil.clonePoints(t),a=SuperMapAlgoPlot.ArrowToolkit.generateArrowBodyShapePts(n,this.scaleValues,SuperMapAlgoPlot.ArrowToolkit.ArrowBodyType.ARROWBODY_MULTIPOLYBEZIER),s=a.arrowTouLen,r=a.leftBodyPts,u=a.rightBodyPts;if(!SuperMapAlgoPlot.PlottingUtil.equalFuzzy(s,0)){var p=[];p.push(r[r.length-1]),p.push(u[u.length-1]);var h=[];h.push(this.scaleValues[2]),h.push(this.scaleValues[3]),h.push(0),h.push(0);for(var c=SuperMapAlgoPlot.ArrowToolkit.generateArrowHeadShapePts(n,p,h,s,SuperMapAlgoPlot.ArrowToolkit.ArrowHeadType.ARROWHEAD_WITH_EAR),g=0;g<r.length;g++)e.push(r[g]),o.push(r[g]);for(var y=0;y<c.length;y++)e.push(c[y]),l.push(c[y]);for(var f=u.length-1;f>=0;f--)e.push(u[f]),i.push(u[f])}return{shapePts:e,leftBodyPts:o,rightBodyPts:i,arrowHeadPts:l}}},{key:"updateScalePoints",value:function(t){var e=t.length,o=[];if(!(e<3)){var i=SuperMapAlgoPlot.PlottingUtil.polylineDistance(t);if(!SuperMapAlgoPlot.PlottingUtil.equalFuzzy(i,0)){var l=this.operateCtrlPts(t);e=l.length,e--;for(var n=[],a=0;a<this.scaleValues.length;a++)n.push(this.scaleValues[a]);var s=this.genArrowBodyPts(i,l,n),r=s.ArrowBodyCenterPts,u=this.genAtPts(e,r,n,s.ArrowTouLen),p=this.calc3rdScalePt(e,r,n,s.ArrowTouLen);return o.push(new SuperMapAlgoPlot.Point(s.LeftBodyPtsTemp[e].x,s.LeftBodyPtsTemp[e].y)),o.push(new SuperMapAlgoPlot.Point(u[2].x,u[2].y)),o.push(new SuperMapAlgoPlot.Point(p.x,p.y)),o}}}},{key:"operateCtrlPts",value:function(t){var e=SuperMapAlgoPlot.PlottingUtil.clonePoints(t);if(3===e.length){var o=((e[0].x+e[1].x)/2+e[2].x)/2,i=((e[0].y+e[1].y)/2+e[2].y)/2,l=new SuperMapAlgoPlot.Point(o,i),n=e[2];e[2]=l,e.push(n)}return e}},{key:"genArrowBodyPts",value:function(t,e,o){var i,l,n,a=[],s=[],r=[],u=[],p=[],h=[],c=e.length;if(c--,o.length<this.calcScaleValueCount(c)){var g=this.calcDefaultScaleValues(c);l=g[0],n=g[1]}else l=o[0],n=o[1];var y=SuperMapAlgoPlot.PlottingUtil.clonePoints(e),f=(y[0].x+y[1].x)/2,P=(y[0].y+y[1].y)/2,d=Math.abs(f-y[2].x),S=Math.abs(P-y[2].y),m=0;if(d>0&&S>0){var b=1/(f-y[2].x),L=-1/(P-y[2].y),v=1*y[2].y/(P-y[2].y)-1*y[2].x/(f-y[2].x);m=Math.abs(b*y[0].x+L*y[0].y+v)/Math.sqrt(b*b+L*L)}else S<=1e-4?m=Math.abs(P-y[1].y):d<=1e-4&&(m=Math.abs(f-y[1].x));var M=SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine(m,y[2],new SuperMapAlgoPlot.Point(f,P)),A=SuperMapAlgoPlot.PlottingUtil.pointIsRightToLine(y[1],y[2],y[0]);A?(a[1]=y[1],s[1]=y[0]):(a[1]=y[0],s[1]=y[1]),y[1]=new SuperMapAlgoPlot.Point((y[0].x+y[1].x)/2,(y[0].y+y[1].y)/2);var T=Math.sqrt((M.pntLeft.x-M.pntRight.x)*(M.pntLeft.x-M.pntRight.x)+(M.pntLeft.y-M.pntRight.y)*(M.pntLeft.y-M.pntRight.y))*this.sv_AtWidthDivAwWidth,_=(i=T*this.sv_AtLenDivAtWidth)*n;SuperMapAlgoPlot.PlottingUtil.equalFuzzy(l,0)||(_=(i=t*l)*n);var O,x,w=SuperMapAlgoPlot.PlottingUtil.distance(y[c],y[c-1]),E=2*i;w<E&&(_=(i=w/2)*n),y.push(y[c].clone()),O=0,x=0;var C=0,I=[];for(C=2;C<=c;C++)O+=SuperMapAlgoPlot.PlottingUtil.distance(y[C],y[C-1]);for(O-=i,C=2;C<=c-1;C++)x+=SuperMapAlgoPlot.PlottingUtil.distance(y[C],y[C-1]),I[C]=_+(T-_)*Math.pow((O-x)/O,this.sv_AtScaleParameter);I[c]=_;var D,R,N=new SuperMapAlgoPlot.Point(0,0),U=new SuperMapAlgoPlot.Point(0,0),B=new SuperMapAlgoPlot.Point(0,0);for(C=2;C<=c-1;C++)SuperMapAlgoPlot.PlottingUtil.getTrianglePoints(0,3,y[C-1],y[C],y[C+1],U,B),C===c-1&&SuperMapAlgoPlot.PlottingUtil.getTrapezoidPoints(.5,y[c],y[c-1],B,N),D=SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine(I[C],U,y[C]),(A=SuperMapAlgoPlot.PlottingUtil.pointIsRightToLine(B,U,D.pntRight))?(a[C]=new SuperMapAlgoPlot.Point(D.pntRight.x,D.pntRight.y),s[C]=new SuperMapAlgoPlot.Point(D.pntLeft.x,D.pntLeft.y)):(a[C]=new SuperMapAlgoPlot.Point(D.pntLeft.x,D.pntLeft.y),s[C]=new SuperMapAlgoPlot.Point(D.pntRight.x,D.pntRight.y));for(Math.sqrt(1*(y[c].x-N.x)*(y[c].x-N.x)+1*(y[c].y-N.y)*(y[c].y-N.y))>0&&(y[c]=SuperMapAlgoPlot.PlottingUtil.getIncentrePointOnSegmentByScale(i,y[c],N)),D=SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine(_,y[c+1],y[c]),(A=SuperMapAlgoPlot.PlottingUtil.pointIsRightToLine(y[c],y[c+1],D.pntLeft))?(s[c]=new SuperMapAlgoPlot.Point(D.pntLeft.x,D.pntLeft.y),a[c]=new SuperMapAlgoPlot.Point(D.pntRight.x,D.pntRight.y)):(s[c]=new SuperMapAlgoPlot.Point(D.pntRight.x,D.pntRight.y),a[c]=new SuperMapAlgoPlot.Point(D.pntLeft.x,D.pntLeft.y)),C=2;C<c;C++)SuperMapAlgoPlot.PlottingUtil.getTrianglePoints(3,3,a[C-1],a[C],a[C+1],U,B),r[C]=new SuperMapAlgoPlot.Point(U.x,U.y),u[C]=new SuperMapAlgoPlot.Point(B.x,B.y),SuperMapAlgoPlot.PlottingUtil.getTrianglePoints(3,3,s[C-1],s[C],s[C+1],U,B),p[C]=new SuperMapAlgoPlot.Point(U.x,U.y),h[C]=new SuperMapAlgoPlot.Point(B.x,B.y),2===C&&(SuperMapAlgoPlot.PlottingUtil.getTrapezoidPoints(.5,a[1],a[2],r[2],N),u[C]=new SuperMapAlgoPlot.Point(N.x,N.y),SuperMapAlgoPlot.PlottingUtil.getTrapezoidPoints(.5,s[1],s[2],p[2],N),h[C]=new SuperMapAlgoPlot.Point(N.x,N.y)),C===c-1&&(E=(w=SuperMapAlgoPlot.PlottingUtil.distance(a[c],a[c-1]))/3,(R=SuperMapAlgoPlot.PlottingUtil.getExcentrePointOnSegmentByScale(E,y[c],y[c+1])).x+=a[c].x-y[c].x,R.y+=a[c].y-y[c].y,E=(w=T-_)*Math.pow(E/O,this.sv_AtScaleParameter),D=SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine(E,a[c],R),r[c]=new SuperMapAlgoPlot.Point(D.pntLeft.x,D.pntLeft.y),E=(w=SuperMapAlgoPlot.PlottingUtil.distance(s[c],s[c-1]))/3,(R=SuperMapAlgoPlot.PlottingUtil.getExcentrePointOnSegmentByScale(E,y[c],y[c+1])).x+=s[c].x-y[c].x,R.y+=s[c].y-y[c].y,E=(w=T-_)*Math.pow(E/O,this.sv_AtScaleParameter),D=SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine(E,s[c],R),p[c]=new SuperMapAlgoPlot.Point(D.pntRight.x,D.pntRight.y));return{ArrowBodyCenterPts:SuperMapAlgoPlot.PlottingUtil.clonePoints(y),LeftBodyPtsTemp:a,RightBodyPtsTemp:s,LeftBodyPtsLeftCtrlPts:r,LeftBodyPtsRightCtrlPts:u,RightBodyPtsLeftCtrlPts:p,RightBodyPtsRightCtrlPts:h,ArrowTouLen:i}}},{key:"calcScaleValueCount",value:function(){return 4}},{key:"calcDefaultScaleValues",value:function(){var t=[];return t.push(this.sv1_DefaultAtLenDivAbLen),t.push(this.sv2_DefaultAjWidthDivAtLen),t.push(this.sv3_DefaultAeWidthDivAtLen),t.push(this.sv4_DefaultAeLenDivAtLen),t}},{key:"genAtPts",value:function(t,e,o,i){var l=o[2],n=[],a=i*o[3],s=SuperMapAlgoPlot.PlottingUtil.getExcentrePointOnSegmentByScale(a,e[t],e[t+1]);a=i*l;var r=SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine(a,e[t+1],s);return n.push(new SuperMapAlgoPlot.Point(r.pntLeft.x,r.pntLeft.y)),n.push(e[t+1]),n.push(new SuperMapAlgoPlot.Point(r.pntRight.x,r.pntRight.y)),n}},{key:"calc3rdScalePt",value:function(t,e,o,i){var l=i*o[3];return SuperMapAlgoPlot.PlottingUtil.getExcentrePointOnSegmentByScale(l,e[t],e[t+1])}}]),e}();SuperMapAlgoPlot.AlgoSymbol1011=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.AlgoSymbol1010=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return 0===o.scaleValues.length&&(o.scaleValues.push(0),o.scaleValues.push(.148),o.scaleValues.push(.4),o.scaleValues.push(.312),o.scaleValues.push(.2)),o.CLASS_NAME="SuperMapAlgoPlot.AlgoSymbol1010",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol),i(e,[{key:"calculateParts",value:function(){this.init();var t=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);if((t=SuperMapAlgoPlot.PlottingUtil.clearSamePts(t)).length>=2&&t.length<this.minEditPts&&this.calAssistantLine(),!(t.length<this.minEditPts)){var e=this.arrowMeshs(t);if(SuperMapAlgoPlot.PlottingUtil.clearSamePts(e.shapePts),0!==e.shapePts.length){this.addCell(SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,e.shapePts,{surroundLineFlag:!1}),this.scalePoints=[];for(var o=0;o<e.m_scalePoints.length;o++)this.addScalePoint(e.m_scalePoints[o])}}}},{key:"modifyPoint",value:function(t,e){if(!0===e.isScalePoint){var o=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);this.scaleValues.length<4&&(this.scaleValues.push(0),this.scaleValues.push(.148),this.scaleValues.push(.4),this.scaleValues.push(.312),this.scaleValues.push(.2));var i,l,n,a,s=o.length;if(s<=2)return;this.scaleValues.length<4?(i=0,l=.148,n=.4,a=.312):(i=this.scaleValues[0],l=this.scaleValues[1],n=this.scaleValues[2],a=this.scaleValues[3]);var r=SuperMapAlgoPlot.PlottingUtil.polylineDistance(o),u=this.operateCtrlPts(o);s=u.length,s--;for(var p=[],h=0;h<this.scalePoints.length;h++)p.push(this.scalePoints[h].clone());if(0===p.length)return;if(p[t]=e.clone(),3===t){var c=SuperMapAlgoPlot.ArrowToolkit.generateArrowBodyShapePts(o,this.scaleValues,SuperMapAlgoPlot.ArrowToolkit.ArrowBodyType.ARROWBODY_MULTIPOLYBEZIER),g=new SuperMapAlgoPlot.Point(.5*(c.leftBodyPts[0].x+c.rightBodyPts[0].x),.5*(c.leftBodyPts[0].y+c.rightBodyPts[0].y)),y=SuperMapAlgoPlot.PlottingUtil.distance(c.leftBodyPts[0],c.rightBodyPts[0]);this.scaleValues[4]=SuperMapAlgoPlot.PlottingUtil.distance(g,e)/y}else{var f,P,d=s-1;f=s<=3?new SuperMapAlgoPlot.Point((u[0].x+u[1].x)/2,(u[0].y+u[1].y)/2):u[d-1].clone();var S,m,b,L,v,M,A=new SuperMapAlgoPlot.Point(0,0),T=new SuperMapAlgoPlot.Point(0,0),_=new SuperMapAlgoPlot.Point(0,0);SuperMapAlgoPlot.PlottingUtil.getTrianglePoints(0,3,f,u[d],u[d+1],T,_),SuperMapAlgoPlot.PlottingUtil.getTrapezoidPoints(.5,u[s],u[s-1],_,A),P=A.clone();var O=SuperMapAlgoPlot.PlottingUtil.triangleHeightAndPartBottomLen(u[s],P,p[2]);S=O.dLen1,O.dLen2,0===S&&(S=.1),m=S,i=(S/=a+1)/r,1===t?(L=(O=SuperMapAlgoPlot.PlottingUtil.triangleHeightAndPartBottomLen(u[s],P,p[1])).dLen1,n=(v=O.dLen2)/S,a=(L-S)/S):0===t?(S=(O=SuperMapAlgoPlot.PlottingUtil.triangleHeightAndPartBottomLen(u[s],P,p[0])).dLen1,l=(b=O.dLen2)/S,(M=SuperMapAlgoPlot.PlottingUtil.distance(u[s],u[s-1]))<2*S&&(S=.5*M),L=(O=SuperMapAlgoPlot.PlottingUtil.triangleHeightAndPartBottomLen(u[s],P,p[1])).dLen1,n=(v=O.dLen2)/S,(a=(m-S)/S)<.1&&(n=v/(S=m/(1+(a=.1))),l=b/S),i=S/r):2===t&&(i=S/r),b=S*l,(M=SuperMapAlgoPlot.PlottingUtil.distance(u[s],u[s-1]))<2*S&&(b=(S=.5*M)*l,i=S/r),this.scaleValues[0]=i,this.scaleValues[1]=l,this.scaleValues[2]=n,this.scaleValues[3]=a}}this.calculateParts()}},{key:"arrowMeshs",value:function(t){var e=[],o=[],i=[],l=[],n=[],a=[],s=SuperMapAlgoPlot.PlottingUtil.clonePoints(t),r=SuperMapAlgoPlot.ArrowToolkit.generateArrowBodyShapePts(s,this.scaleValues,SuperMapAlgoPlot.ArrowToolkit.ArrowBodyType.ARROWBODY_MULTIPOLYBEZIER),u=r.arrowTouLen,p=r.leftBodyPts,h=r.rightBodyPts;if(s=r.OpectrlPoints,!SuperMapAlgoPlot.PlottingUtil.equalFuzzy(u,0)){var c=[];c.push(p[p.length-1]),c.push(h[h.length-1]);var g=[];g.push(this.scaleValues[2]),g.push(this.scaleValues[3]),g.push(0),g.push(0);var y=SuperMapAlgoPlot.ArrowToolkit.generateArrowHeadShapePts(s,c,g,u,SuperMapAlgoPlot.ArrowToolkit.ArrowHeadType.ARROWHEAD_WITH_EAR),f=[];f.push(p[0]),f.push(h[0]);for(var P,d=SuperMapAlgoPlot.ArrowToolkit.generateArrowTailShapePts(t,f,this.scaleValues[4],SuperMapAlgoPlot.ArrowToolkit.ArrowTailType.ARROWTAIL_COATTAIL_POLYBODY),S=0;S<p.length;S++)e.push(p[S]),o.push(p[S]);for(var m=0;m<y.length;m++)e.push(y[m]),l.push(y[m]);for(var b=h.length-1;b>=0;b--)e.push(h[b]),i.push(h[b]);for(var L=1;L<d.length;L++)e.push(d[L]),n.push(d[L]);var v=s.length;v-=2;var M=u*this.scaleValues[3];P=SuperMapAlgoPlot.PlottingUtil.getExcentrePointOnSegmentByScale(M,s[v],s[v+1]);var A=new SuperMapAlgoPlot.Point(o[o.length-1].x,o[o.length-1].y);A.isScalePoint=!0,A.tag=0,a.push(A),(A=new SuperMapAlgoPlot.Point(l[0].x,l[0].y)).isScalePoint=!0,A.tag=1,a.push(A),(A=new SuperMapAlgoPlot.Point(P.x,P.y)).isScalePoint=!0,A.tag=2,a.push(A),(A=new SuperMapAlgoPlot.Point(d[1].x,d[1].y)).isScalePoint=!0,A.tag=3,a.push(A)}return{shapePts:e,leftBodyPts:o,rightBodyPts:i,arrowHeadPts:l,arrowTailPts:n,m_scalePoints:a}}},{key:"operateCtrlPts",value:function(t){var e=SuperMapAlgoPlot.PlottingUtil.clonePoints(t);if(3===e.length){var o=((e[0].x+e[1].x)/2+e[2].x)/2,i=((e[0].y+e[1].y)/2+e[2].y)/2,l=new SuperMapAlgoPlot.Point(o,i),n=e[2];e[2]=l,e.push(n)}return e}}]),e}();SuperMapAlgoPlot.AlgoSymbol1010=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.AlgoSymbol1009=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return 0===o.scaleValues.length&&o.scaleValues.push(.1),o.CLASS_NAME="SuperMapAlgoPlot.AlgoSymbol1009",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol),i(e,[{key:"calculateParts",value:function(){this.init();var t=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);if(!((t=SuperMapAlgoPlot.PlottingUtil.clearSamePts(t)).length<this.minEditPts)){var e=!1;void 0!==t[0].z&&(e=!0),this.scaleValues[0]=this.getSubSymbolScaleValue();var o=SuperMapAlgoPlot.PlottingUtil.polylineDistance(t)*this.scaleValues[0],i=SuperMapAlgoPlot.ArrowToolkit.generateArrowBodyShapePtsBySingleLine(t,0,SuperMapAlgoPlot.ArrowToolkit.ArrowBodyType.ARROWBODY_POLYLINE,!1),l=[];l.push(i[i.length-1]),l.push(i[i.length-2]);var n=SuperMapAlgoPlot.ArrowToolkit.generateArrowHeadShapePtsBySingleLine(l,o,SuperMapAlgoPlot.ArrowToolkit.ArrowHeadType.ARROWHEAD_POLYLINE),a=[];a.push(i[0]),a.push(i[1]);var s=SuperMapAlgoPlot.ArrowToolkit.generateArrowTailShapePtsBySingleLine(a,o,SuperMapAlgoPlot.ArrowToolkit.ArrowTailType.ARROWTAIL_COATTAIL);if(e){for(var r=t.length,u=[],p=[],h=[],c=0;c<r;++c)u.push({x:t[c].x,y:t[c].y,z:t[c].z});var g,y={x:t[r-1].x,y:t[r-1].y,z:t[r-1].z},f={x:t[r-2].x,y:t[r-2].y,z:t[r-2].z};g=this.ComputeZValue(i[r-1],y,f),u.push({x:i[r-1].x,y:i[r-1].y,z:g});for(var P=0;P<n.length;++P)g=this.ComputeZValue(n[P],y,f),p.push({x:n[P].x,y:n[P].y,z:g});for(var d={x:t[1].x,y:t[1].y,z:t[1].z},S={x:t[0].x,y:t[0].y,z:t[0].z},m=0;m<s.length;++m)g=this.ComputeZValue(s[m],d,S),h.push({x:s[m].x,y:s[m].y,z:g});this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,u,{surroundLineFlag:!1}),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,p),0!==h.length&&this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,h)}else{this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,i,{surroundLineFlag:!1}),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,n),0!==s.length&&this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,s)}}}}]),e}();SuperMapAlgoPlot.AlgoSymbol1009=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.AlgoSymbol1008=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return 0===o.scaleValues.length&&o.scaleValues.push(.1),o.CLASS_NAME="SuperMapAlgoPlot.AlgoSymbol1008",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol),i(e,[{key:"calculateParts",value:function(){this.init();var t=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);if(!((t=SuperMapAlgoPlot.PlottingUtil.clearSamePts(t)).length<this.minEditPts)){this.scaleValues[0]=this.getSubSymbolScaleValue();var e=SuperMapAlgoPlot.PlottingUtil.polylineDistance(t)*this.scaleValues[0],o=Math.sqrt(e*e/3),i=SuperMapAlgoPlot.ArrowToolkit.generateArrowBodyShapePtsBySingleLine(t,o,SuperMapAlgoPlot.ArrowToolkit.ArrowBodyType.ARROWBODY_POLYBEZIER,!0),l=[];l.push(t[t.length-1]),l.push(i[i.length-1]);var n=SuperMapAlgoPlot.ArrowToolkit.generateArrowHeadShapePtsBySingleLine(l,e,SuperMapAlgoPlot.ArrowToolkit.ArrowHeadType.ARROWHEAD_COATTAIL);i.push(t[t.length-1]),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,i);n.length>0&&this.addCell(SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,n,{surroundLineFlag:!1,fillLimit:!0,fill:!0,lineTypeLimit:!0})}}}]),e}();SuperMapAlgoPlot.AlgoSymbol1008=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.AlgoSymbol1007=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return 0===o.scaleValues.length&&o.scaleValues.push(.1),o.CLASS_NAME="SuperMapAlgoPlot.AlgoSymbol1007",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol),i(e,[{key:"calculateParts",value:function(){this.init();var t=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);if(!((t=SuperMapAlgoPlot.PlottingUtil.clearSamePts(t)).length<this.minEditPts)){var e=!1;void 0!==t[0].z&&(e=!0),this.scaleValues[0]=this.getSubSymbolScaleValue();var o=SuperMapAlgoPlot.PlottingUtil.polylineDistance(t)*this.scaleValues[0],i=SuperMapAlgoPlot.ArrowToolkit.generateArrowBodyShapePtsBySingleLine(t,o,SuperMapAlgoPlot.ArrowToolkit.ArrowBodyType.ARROWBODY_POLYLINE,!0),l=[];l.push(t[t.length-1]),l.push(i[i.length-1]);var n=SuperMapAlgoPlot.ArrowToolkit.generateArrowHeadShapePtsBySingleLine(l,o,SuperMapAlgoPlot.ArrowToolkit.ArrowHeadType.ARROWHEAD_TRIANGLE_SOLID);if(e){for(var a=t.length,s=[],r=[],u=0;u<a;++u)s.push({x:i[u].x,y:i[u].y,z:t[u].z});var p={x:t[a-1].x,y:t[a-1].y,z:t[a-1].z},h={x:t[a-2].x,y:t[a-2].y,z:t[a-2].z},c=this.ComputeZValue(i[a-1],p,h);s[a-1].z=c;for(var g=0;g<n.length;++g){var y=this.ComputeZValue(n[g],p,h);r.push({x:n[g].x,y:n[g].y,z:y})}this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,s);r.length>0&&this.addCell(SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,r,{surroundLineFlag:!1,fillLimit:!0,fillColorLimit:!1,fill:!0})}else{this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,i);n.length>0&&this.addCell(SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,n,{surroundLineFlag:!1,fillLimit:!0,fillColorLimit:!1,fill:!0,lineTypeLimit:!0})}}}}]),e}();SuperMapAlgoPlot.AlgoSymbol1007=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.AlgoSymbol1006=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return o.QIANJI_RATE1=9,o.QIANJI_RATE2=20,o.QIANJI_RATE4=5,o.QIANJI_RATE3=1/3,o.QIANJI_TAIL_RATE1=8,o.QIANJI_TAIL_RATE2=3,o.QIANJI_TAIL_RATE3=.6,o.SV1_Default=.25,o.SV1_MinValue=0,o.SV1_MaxValue=.5,o.DEFAULT_ARROW_TAIL_POS=.4,o.SCALE_VALUE_COUNT=1,o.MIN_LEN_LeftToRightCenter=1e-7,o.SCALE_AT=1/3,o.SCALE_ATAJ=1/7,o.SCALE_ATAE=1/3,o.SCALE_AW=2/3,o.SCALE_ATAJctrlDefSide=.8,o.SCALE_ATAJctrlSameSide=2/3,o.SCALE_MM_LEFT=.25,o.SCALE_MM_RIGHT=.75,o.BEZIER_K1=1/3,o.QIANJI_OPERATE_RATE1=1,0===o.scaleValues.length&&o.scaleValues.push(o.SV1_Default),o.m_dMaxDis=0,o.m_bIsAnimation=!1,o.CLASS_NAME="SuperMapAlgoPlot.AlgoSymbol1006",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol),i(e,[{key:"calculateParts",value:function(){this.init(),this.m_scalePoints=[];var t=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);if((t=SuperMapAlgoPlot.PlottingUtil.clearSamePts(t)).length>=2&&t.length<this.minEditPts&&this.calAssistantLine(),!(t.length<this.minEditPts)){var e=SuperMapAlgoPlot.PlottingUtil.clonePoints(t),o=e.length,i=!1;void 0!==e[0].z&&(i=!0);var l=this.arrowMeshs(t);if(i){for(var n=[],a=0;a<o;a++)n.push(e[a]);var s=l.LeftArowLeftBody,r=l.LeftArowHead,u=l.LeftArowRightBody,p=l.RightArowLeftBody,h=l.RightArowHead,c=l.RightArowRightBody;if(0==s.length)return!1;var g=[],y=[],f=[];if(3==n.length)s[0].x==n[0].x&&s[0].y==n[0].y?(y.push(n[0]),y.push(n[2]),f.push(n[1]),f.push(n[2])):(y.push(n[1]),y.push(n[2]),f.push(n[0]),f.push(n[2]));else{if(4!=n.length)return!1;s[0].x==n[0].x&&s[0].y==n[0].y?(y.push(n[0]),f.push(n[1])):(y.push(n[1]),f.push(n[0])),r[1].x==n[2].x&&r[1].y==n[2].y?(y.push(n[2]),f.push(n[3])):(y.push(n[3]),f.push(n[2]))}var P=new SuperMapAlgoPlot.Point;P=SuperMapAlgoPlot.PlottingUtil.pointProjectToSegment(s[s.length-1],{x:y[0].x,y:y[0].y},{x:y[1].x,y:y[1].y}).projectPoint;var d=this.ComputeZValue(P,y[1],y[0]),S=[];this.ComputeHeight(s,S,y[0].z,d),g=g.concat(S);for(var m=0;m<r.length;m++){P=SuperMapAlgoPlot.PlottingUtil.pointProjectToSegment(r[m],{x:y[0].x,y:y[0].y},{x:y[1].x,y:y[1].y}).projectPoint;var b=this.ComputeZValue(P,y[1],y[0]);g.push({x:r[m].x,y:r[m].y,z:b})}P=SuperMapAlgoPlot.PlottingUtil.pointProjectToSegment(u[0],{x:y[0].x,y:y[0].y},{x:y[1].x,y:y[1].y}).projectPoint,this.ComputeZValue(P,y[1],y[0]),P=SuperMapAlgoPlot.PlottingUtil.pointProjectToSegment(u[u.length-1],{x:y[0].x,y:y[0].y},{x:y[1].x,y:y[1].y}).projectPoint;var L=this.ComputeZValue(P,y[1],y[0]);P=SuperMapAlgoPlot.PlottingUtil.pointProjectToSegment(p[0],{x:f[0].x,y:f[0].y},{x:f[1].x,y:f[1].y}).projectPoint;var v=(this.ComputeZValue(P,f[1],f[0])+L)/2,M=[];this.ComputeHeight(u,M,d,v),g=g.concat(M),P=SuperMapAlgoPlot.PlottingUtil.pointProjectToSegment(p[p.length-1],{x:f[0].x,y:f[0].y},{x:f[1].x,y:f[1].y}).projectPoint;var A=this.ComputeZValue(P,f[1],f[0]),T=[];this.ComputeHeight(p,T,v,A),g=g.concat(T);for(var _=0;_<h.length;_++){P=SuperMapAlgoPlot.PlottingUtil.pointProjectToSegment(h[_],{x:f[0].x,y:f[0].y},{x:f[1].x,y:f[1].y}).projectPoint;var O=this.ComputeZValue(P,f[1],f[0]);g.push({x:h[_].x,y:h[_].y,z:O})}P=SuperMapAlgoPlot.PlottingUtil.pointProjectToSegment(c[0],{x:f[0].x,y:f[0].y},{x:f[1].x,y:f[1].y}).projectPoint;var x=this.ComputeZValue(P,f[1],f[0]),w=[];this.ComputeHeight(c,w,x,f[0].z),(g=g.concat(w)).length>0&&this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,g,{surroundLineFlag:!1}),this.m_scalePoints.length>0&&(this.m_scalePoints[0]={x:this.m_scalePoints[0].x,y:this.m_scalePoints[0].y,z:v});for(var E=0;E<this.m_scalePoints.length;E++)this.m_scalePoints[E].isScalePoint=!0,this.m_scalePoints[E].tag=E,this.addScalePoint(this.m_scalePoints[E]);return!0}var C=l.shapePts;C.length>0&&(this.addCell(SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,C,{surroundLineFlag:!1,lineWidthLimit:!0,strokeWidth:0,weight:0}),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,C,{surroundLineFlag:!1})),this.scalePoints=[];for(var I=0;I<this.m_scalePoints.length;I++)this.m_scalePoints[I].isScalePoint=!0,this.m_scalePoints[I].tag=I,this.addScalePoint(this.m_scalePoints[I])}}},{key:"modifyPoint",value:function(t,e){if(!0===e.isScalePoint){var o,i=SuperMapAlgoPlot.PlottingUtil.operateControlPoints(this.controlPoints),l=new SuperMapAlgoPlot.Point((i[0].x+i[1].x)/2,(i[0].y+i[1].y)/2),n=new SuperMapAlgoPlot.Point((i[2].x+i[3].x)/2,(i[2].y+i[3].y)/2),a=SuperMapAlgoPlot.PlottingUtil.pointProjectToSegment(e,l,n);if(a.isOnline){var s=SuperMapAlgoPlot.PlottingUtil.distance(a.projectPoint,l),r=SuperMapAlgoPlot.PlottingUtil.distance(l,n);(o=SuperMapAlgoPlot.PlottingUtil.equalFuzzy(s,0)?this.SV1_MinValue:s/r)>this.SV1_MaxValue&&(o=this.SV1_MaxValue)}else o=SuperMapAlgoPlot.PlottingUtil.distance(a.projectPoint,l)<SuperMapAlgoPlot.PlottingUtil.distance(a.projectPoint,n)?this.SV1_MinValue:this.SV1_MaxValue;this.scaleValues=[],this.scaleValues.push(o)}this.calculateParts()}},{key:"arrowMeshs",value:function(t){var e=new SuperMapAlgoPlot.Path2D,o=[];this.m_bIsAnimation&&4==t.length?o=SuperMapAlgoPlot.PlottingUtil.clonePoints(t):(o=SuperMapAlgoPlot.PlottingUtil.operateControlPoints(t),void 0!==t[0].z&&(o[o.length-1].z=o[o.length-2].z));var i=this.scaleValues[0],l=SuperMapAlgoPlot.PlottingUtil.distance(o[0],o[3]),n=SuperMapAlgoPlot.PlottingUtil.distance(o[1],o[2]),a=o[1].clone(),s=.5*(o[0].x+o[3].x),r=.5*(o[0].y+o[3].y),u=new SuperMapAlgoPlot.Point(s,r),p=.5*(o[1].x+o[2].x),h=.5*(o[1].y+o[2].y),c=new SuperMapAlgoPlot.Point(p,h),g=SuperMapAlgoPlot.PlottingUtil.distance(u,c);g<this.MIN_LEN_LeftToRightCenter&&(g=this.MIN_LEN_LeftToRightCenter),u.x=s+l*(s-p)/(g*this.QIANJI_RATE1),u.y=r+l*(r-h)/(g*this.QIANJI_RATE1),c.x=p+n*(p-s)/(g*this.QIANJI_RATE1),c.y=h+n*(h-r)/(g*this.QIANJI_RATE1);var y=new SuperMapAlgoPlot.Point(0,0),f=new SuperMapAlgoPlot.Point(0,0);y.x=s+l*(s-p)/(g*this.QIANJI_RATE2),y.y=r+l*(r-h)/(g*this.QIANJI_RATE2),f.x=p+n*(p-s)/(g*this.QIANJI_RATE2),f.y=h+n*(h-r)/(g*this.QIANJI_RATE2);var P=new SuperMapAlgoPlot.Point((o[0].x+o[1].x)/2,(o[0].y+o[1].y)/2),d=new SuperMapAlgoPlot.Point((o[2].x+o[3].x)/2,(o[2].y+o[3].y)/2),S=o[3].x-(o[3].x-u.x)*this.SCALE_AT,m=o[3].y-(o[3].y-u.y)*this.SCALE_AT,b=o[2].x-(o[2].x-c.x)*this.SCALE_AT,L=o[2].y-(o[2].y-c.y)*this.SCALE_AT,v=new SuperMapAlgoPlot.Point(0,0),M=new SuperMapAlgoPlot.Point(0,0),A=new SuperMapAlgoPlot.Point(0,0),T=new SuperMapAlgoPlot.Point(0,0);M.x=S-(m-o[3].y)*this.SCALE_ATAJ,M.y=m+(S-o[3].x)*this.SCALE_ATAJ,v.x=S+(m-o[3].y)*this.SCALE_ATAJ,v.y=m-(S-o[3].x)*this.SCALE_ATAJ,T.x=b-(L-o[2].y)*this.SCALE_ATAJ,T.y=L+(b-o[2].x)*this.SCALE_ATAJ,A.x=b+(L-o[2].y)*this.SCALE_ATAJ,A.y=L-(b-o[2].x)*this.SCALE_ATAJ;var _=new SuperMapAlgoPlot.Point(0,0),O=new SuperMapAlgoPlot.Point(0,0),x=new SuperMapAlgoPlot.Point(0,0),w=new SuperMapAlgoPlot.Point(0,0);_.x=3*v.x-2*S-(o[3].x-S)*this.SCALE_ATAE,_.y=3*v.y-2*m-(o[3].y-m)*this.SCALE_ATAE,O.x=3*M.x-2*S-(o[3].x-S)*this.SCALE_ATAE,O.y=3*M.y-2*m-(o[3].y-m)*this.SCALE_ATAE,x.x=3*A.x-2*b-(o[2].x-b)*this.SCALE_ATAE,x.y=3*A.y-2*L-(o[2].y-L)*this.SCALE_ATAE,w.x=3*T.x-2*b-(o[2].x-b)*this.SCALE_ATAE,w.y=3*T.y-2*L-(o[2].y-L)*this.SCALE_ATAE,u.x=s+l*(s-p)/(g*this.QIANJI_RATE4),u.y=r+l*(r-h)/(g*this.QIANJI_RATE4),c.x=p+n*(p-s)/(g*this.QIANJI_RATE4),c.y=h+n*(h-r)/(g*this.QIANJI_RATE4);var E=new SuperMapAlgoPlot.Point(0,0);E.x=o[0].x+(u.x-o[0].x)*this.SCALE_AW,E.y=o[0].y+(u.y-o[0].y)*this.SCALE_AW;var C=new SuperMapAlgoPlot.Point(0,0);C.x=o[1].x+(c.x-o[1].x)*this.SCALE_AW,C.y=o[1].y+(c.y-o[1].y)*this.SCALE_AW;var I=new SuperMapAlgoPlot.Point(0,0);I.x=v.x+(u.x-v.x)*this.SCALE_ATAJctrlSameSide,I.y=v.y+(u.y-v.y)*this.SCALE_ATAJctrlSameSide;var D=new SuperMapAlgoPlot.Point(0,0);D.x=T.x+(c.x-T.x)*this.SCALE_ATAJctrlSameSide,D.y=T.y+(c.y-T.y)*this.SCALE_ATAJctrlSameSide;var R=new SuperMapAlgoPlot.Point(0,0);R.x=M.x+(y.x-M.x)*this.SCALE_ATAJctrlDefSide,R.y=M.y+(y.y-M.y)*this.SCALE_ATAJctrlDefSide;var N=new SuperMapAlgoPlot.Point(0,0);N.x=A.x+(f.x-A.x)*this.SCALE_ATAJctrlDefSide,N.y=A.y+(f.y-A.y)*this.SCALE_ATAJctrlDefSide;var U=new SuperMapAlgoPlot.Point(0,0);U.x=P.x+(d.x-P.x)*i,U.y=P.y+(d.y-P.y)*i,this.m_scalePoints.push(new SuperMapAlgoPlot.Point(U.x,U.y));var B=new SuperMapAlgoPlot.Point(0,0),k=new SuperMapAlgoPlot.Point(0,0);B.x=o[0].x+(o[3].x-o[0].x)*i,B.y=o[0].y+(o[3].y-o[0].y)*i,k.x=o[1].x+(o[2].x-o[1].x)*i,k.y=o[1].y+(o[2].y-o[1].y)*i,B.x=B.x+(U.x-B.x)*this.QIANJI_RATE3,B.y=B.y+(U.y-B.y)*this.QIANJI_RATE3,k.x=k.x+(U.x-k.x)*this.QIANJI_RATE3,k.y=k.y+(U.y-k.y)*this.QIANJI_RATE3;var F=[];F.push(o[0].clone()),F.push(E.clone()),F.push(I.clone()),F.push(v.clone()),e.MoveTo(F[0]),e.CurveTo(F[1],F[2],F[3]);var G,V,j=[],Y=[],z=[],W=[],X=[],H=[];for(e.ToSubPathPolygons(H),G=H[0],V=H[0].length,e.LineTo(_),e.LineTo(o[3]),e.LineTo(O),(F=[]).push(M),F.push(R),F.push(B),F.push(U),e.LineTo(F[0]),H=[],e.ToSubPathPolygons(H);V<H[0].length;V++)j.push(H[0][V]);for(V=H[0].length,e.CurveTo(F[1],F[2],F[3]),H=[],e.ToSubPathPolygons(H);V<H[0].length;V++)Y.push(H[0][V]);for(V=H[0].length,(F=[]).push(k),F.push(N),F.push(A),e.CurveTo(F[0],F[1],F[2]),H=[],e.ToSubPathPolygons(H);V<H[0].length;V++)z.push(H[0][V]);for(V=H[0].length,e.LineTo(x),e.LineTo(o[2]),e.LineTo(w),(F=[]).push(T),F.push(D),F.push(C),F.push(a),e.LineTo(F[0]),H=[],e.ToSubPathPolygons(H);V<H[0].length;V++)W.push(H[0][V]);for(V=H[0].length,e.CurveTo(F[1],F[2],F[3]),H=[],e.ToSubPathPolygons(H);V<H[0].length;V++)X.push(H[0][V]);return H=[],e.ToSubPathPolygons(H),{shapePts:H[0],LeftArowLeftBody:G,LeftArowHead:j,LeftArowRightBody:Y,RightArowLeftBody:z,RightArowHead:W,RightArowRightBody:X}}}]),e}();SuperMapAlgoPlot.AlgoSymbol1006=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.AlgoSymbol1005=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return 0===o.scaleValues.length&&o.scaleValues.push(.1),o.CLASS_NAME="SuperMapAlgoPlot.AlgoSymbol1005",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol),i(e,[{key:"calculateParts",value:function(){this.init();var t=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);if(!((t=SuperMapAlgoPlot.PlottingUtil.clearSamePts(t)).length<this.minEditPts)){this.scaleValues[0]=this.getSubSymbolScaleValue();var e=SuperMapAlgoPlot.PlottingUtil.polylineDistance(t)*this.scaleValues[0],o=SuperMapAlgoPlot.ArrowToolkit.generateArrowBodyShapePtsBySingleLine(t,e,SuperMapAlgoPlot.ArrowToolkit.ArrowBodyType.ARROWBODY_POLYBEZIER,!1),i=[];i.push(o[o.length-1]),i.push(o[o.length-2]);var l=SuperMapAlgoPlot.ArrowToolkit.generateArrowHeadShapePtsBySingleLine(i,e,SuperMapAlgoPlot.ArrowToolkit.ArrowHeadType.ARROWHEAD_POLYLINE);this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,o),l.length>0&&this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,l)}}}]),e}();SuperMapAlgoPlot.AlgoSymbol1005=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.AlgoSymbol1004=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return o.MAX_ARRAY_SIZE=128,o.sv1_DefaultAtLenDivAbLen=0,o.sv2_DefaultAjWidthDivAtLen=.148,o.sv3_DefaultAeWidthDivAtLen=.4,o.sv4_DefaultAeLenDivAtLen=.312,o.sv_AtScaleParameter=1.5,o.sv_AtLenDivAtWidth=1.35,o.sv_AtWidthDivAwWidth=.5,o.sv_defaultAwLenDivAbLen=.15,0===o.scaleValues.length&&(o.scaleValues.push(o.sv1_DefaultAtLenDivAbLen),o.scaleValues.push(o.sv2_DefaultAjWidthDivAtLen),o.scaleValues.push(o.sv3_DefaultAeWidthDivAtLen),o.scaleValues.push(o.sv4_DefaultAeLenDivAtLen)),o.CLASS_NAME="SuperMapAlgoPlot.AlgoSymbol1004",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol),i(e,[{key:"calculateParts",value:function(){this.init(),this.applyUse()}},{key:"applyUse",value:function(){var t=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);if((t=SuperMapAlgoPlot.PlottingUtil.clearSamePts(t)).length>=2&&t.length<this.minEditPts&&this.calAssistantLine(),!(t.length<this.minEditPts)){var e=this.arrowMeshs(t);SuperMapAlgoPlot.PlottingUtil.clearSamePts(e.shapePts);var o=SuperMapAlgoPlot.PlottingUtil.clonePoints(t),i=o.length,l=!1;if(void 0!==o[0].z&&(l=!0),l){for(var n=e.leftBodyPts,a=e.rightBodyPts,s=e.arrowHeadPts,r=e.shapePts,u=[],p=0;p<r.length;p++)u.push({x:r[p].x,y:r[p].y,z:0});if(0==r.length)return!1;var h=this.updateScalePoints(t);if(this.scalePoints=[],3!=h.length)h=[];else for(var c=0;c<h.length;c++)h[c].isScalePoint=!0,h[c].tag=c,this.addScalePoint(h[c]);var g=[],y={x:(o[0].x+o[1].x)/2,y:(o[0].y+o[1].y)/2},f={x:(n[n.length-1].x+a[0].x)/2,y:(n[n.length-1].y+a[0].y)/2},P=this.ComputeZValue(f,o[i-1],o[i-2]),d=0,S=0;n[0].x==o[0].x&&n[0].y==o[0].y?(d=o[0].z,S=o[1].z):(d=o[1].z,S=o[0].z),g.push({x:y.x,y:y.y,z:d});for(var m=2;m<i-1;m++)g.push(o[m]);g.push({x:f.x,y:f.y,z:P});var b=[];this.ComputeBeizerZValueByDis(g,n,b),(g=[]).push({x:f.x,y:f.y,z:P});for(var L=i-2;L>=2;L--)g.push(o[L]);g.push({x:y.x,y:y.y,z:S});var v=[];this.ComputeBeizerZValueByDis(g,a,v);for(var M=[],A=0;A<s.length;A++){var T=this.ComputeZValue(s[A],o[i-1],o[i-2]);M.push({x:s[A].x,y:s[A].y,z:T})}if(b.length>0&&v.length>0&&M.length>0){u=(u=(u=(u=[]).concat(b)).concat(M)).concat(v),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,u,{surroundLineFlag:!1});for(var _=[],O=0;O<h.length;O++){var x=this.ComputeZValue(h[O],o[i-1],o[i-2]),w=new SuperMapAlgoPlot.Point(h[O].x,h[O].y);w.z=x,_.push(w)}3!=h.length?this.scalePoints=[]:this.scalePoints=this.scalePoints.concat(_)}}else{if(0==e.shapePts.length)return;if(this.addCell(SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,e.shapePts,{surroundLineFlag:!1,lineWidthLimit:!0,strokeWidth:0,weight:0}),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,e.shapePts,{surroundLineFlag:!1}),h=this.updateScalePoints(t),this.scalePoints=[],3!=h.length)h=[];else for(var E=0;E<h.length;E++)h[E].isScalePoint=!0,h[E].tag=E,this.addScalePoint(h[E])}}}},{key:"computeScaleValues",value:function(t,e){if(!0===e.isScalePoint){var o=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);o=SuperMapAlgoPlot.PlottingUtil.clearSamePts(o),this.scaleValues.length<4&&(this.scaleValues.push(this.sv1_DefaultAtLenDivAbLen),this.scaleValues.push(this.sv2_DefaultAjWidthDivAtLen),this.scaleValues.push(this.sv3_DefaultAeWidthDivAtLen),this.scaleValues.push(this.sv4_DefaultAeLenDivAtLen));var i=o.length;if(i<=2)return;var l,n,a,s,r=this.operateCtrlPts(o);i=r.length,i--;var u=this.calcScaleValueCount(o.length);if(this.scaleValues.length<u){var p=this.calcDefaultScaleValues(i);l=p[0],n=p[1],a=p[2],s=p[3]}else l=this.scaleValues[0],n=this.scaleValues[1],a=this.scaleValues[2],s=this.scaleValues[3];for(var h=SuperMapAlgoPlot.PlottingUtil.polylineDistance(o),c=[],g=0;g<this.scalePoints.length;g++)c.push(this.scalePoints[g].clone());if(0==c.length)return;c[t]=e.clone();var y,f,P=i-1;y=i<=3?new SuperMapAlgoPlot.Point((r[0].x+r[1].x)/2,(r[0].y+r[1].y)/2):r[P-1].clone();var d,S,m,b,L,v,M=new SuperMapAlgoPlot.Point(0,0),A=new SuperMapAlgoPlot.Point(0,0),T=new SuperMapAlgoPlot.Point(0,0);SuperMapAlgoPlot.PlottingUtil.getTrianglePoints(0,3,y,r[P],r[P+1],A,T),SuperMapAlgoPlot.PlottingUtil.getTrapezoidPoints(.5,r[i],r[i-1],T,M),f=M.clone();var _=SuperMapAlgoPlot.PlottingUtil.triangleHeightAndPartBottomLen(r[i],f,c[2]);d=_.dLen1,_.dLen2,0==d&&(d=.1),S=d,l=(d/=s+1)/h,1==t?(b=(_=SuperMapAlgoPlot.PlottingUtil.triangleHeightAndPartBottomLen(r[i],f,c[1])).dLen1,a=(L=_.dLen2)/d,s=(b-d)/d):0==t?(d=(_=SuperMapAlgoPlot.PlottingUtil.triangleHeightAndPartBottomLen(r[i],f,c[0])).dLen1,n=(m=_.dLen2)/d,(v=SuperMapAlgoPlot.PlottingUtil.distance(r[i],r[i-1]))<2*d&&(d=.5*v),b=(_=SuperMapAlgoPlot.PlottingUtil.triangleHeightAndPartBottomLen(r[i],f,c[1])).dLen1,a=(L=_.dLen2)/d,(s=(S-d)/d)<.1&&(a=L/(d=S/(1+(s=.1))),n=m/d),l=d/h):2==t&&(l=d/h),m=d*n,(v=SuperMapAlgoPlot.PlottingUtil.distance(r[i],r[i-1]))<2*d&&(m=(d=.5*v)*n,l=d/h),this.scaleValues[0]=l,this.scaleValues[1]=n,this.scaleValues[2]=a,this.scaleValues[3]=s}}},{key:"arrowMeshs",value:function(t){var e=[],o=[],i=[],l=[],n=SuperMapAlgoPlot.PlottingUtil.clonePoints(t),a=SuperMapAlgoPlot.ArrowToolkit.generateArrowBodyShapePts(n,this.scaleValues,SuperMapAlgoPlot.ArrowToolkit.ArrowBodyType.ARROWBODY_MULTIPOLYBEZIER),s=a.arrowTouLen,r=a.leftBodyPts,u=a.rightBodyPts;if(!SuperMapAlgoPlot.PlottingUtil.equalFuzzy(s,0)){var p=[];p.push(r[r.length-1]),p.push(u[u.length-1]);var h=[];h.push(this.scaleValues[2]),h.push(this.scaleValues[3]),h.push(0),h.push(0);for(var c=SuperMapAlgoPlot.ArrowToolkit.generateArrowHeadShapePts(n,p,h,s,SuperMapAlgoPlot.ArrowToolkit.ArrowHeadType.ARROWHEAD_WITH_EAR),g=0;g<r.length;g++)e.push(r[g]),o.push(r[g]);for(var y=0;y<c.length;y++)e.push(c[y]),l.push(c[y]);for(var f=u.length-1;f>=0;f--)e.push(u[f]),i.push(u[f])}return{shapePts:e,leftBodyPts:o,rightBodyPts:i,arrowHeadPts:l}}},{key:"updateScalePoints",value:function(t){var e=t.length,o=[];if(!(e<3)){var i=SuperMapAlgoPlot.PlottingUtil.polylineDistance(t);if(!SuperMapAlgoPlot.PlottingUtil.equalFuzzy(i,0)){var l=this.operateCtrlPts(t);e=l.length,e--;for(var n=[],a=0;a<this.scaleValues.length;a++)n.push(this.scaleValues[a]);var s=this.genArrowBodyPts(i,l,n),r=s.ArrowBodyCenterPts,u=this.genAtPts(e,r,n,s.ArrowTouLen),p=this.calc3rdScalePt(e,r,n,s.ArrowTouLen);return o.push(new SuperMapAlgoPlot.Point(s.LeftBodyPtsTemp[e].x,s.LeftBodyPtsTemp[e].y)),o.push(new SuperMapAlgoPlot.Point(u[2].x,u[2].y)),o.push(new SuperMapAlgoPlot.Point(p.x,p.y)),o}}}},{key:"operateCtrlPts",value:function(t){var e=SuperMapAlgoPlot.PlottingUtil.clonePoints(t);if(3===e.length){var o=((e[0].x+e[1].x)/2+e[2].x)/2,i=((e[0].y+e[1].y)/2+e[2].y)/2,l=new SuperMapAlgoPlot.Point(o,i),n=e[2];e[2]=l,e.push(n)}return e}},{key:"genArrowBodyPts",value:function(t,e,o){var i,l,n,a=[],s=[],r=[],u=[],p=[],h=[],c=e.length;if(c--,o.length<this.calcScaleValueCount(c)){var g=this.calcDefaultScaleValues(c);l=g[0],n=g[1]}else l=o[0],n=o[1];var y=SuperMapAlgoPlot.PlottingUtil.clonePoints(e),f=(y[0].x+y[1].x)/2,P=(y[0].y+y[1].y)/2,d=Math.abs(f-y[2].x),S=Math.abs(P-y[2].y),m=0;if(d>0&&S>0){var b=1/(f-y[2].x),L=-1/(P-y[2].y),v=1*y[2].y/(P-y[2].y)-1*y[2].x/(f-y[2].x);m=Math.abs(b*y[0].x+L*y[0].y+v)/Math.sqrt(b*b+L*L)}else S<=1e-4?m=Math.abs(P-y[1].y):d<=1e-4&&(m=Math.abs(f-y[1].x));var M=SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine(m,y[2],new SuperMapAlgoPlot.Point(f,P)),A=SuperMapAlgoPlot.PlottingUtil.pointIsRightToLine(y[1],y[2],y[0]);A?(a[1]=y[1],s[1]=y[0]):(a[1]=y[0],s[1]=y[1]),y[1]=new SuperMapAlgoPlot.Point((y[0].x+y[1].x)/2,(y[0].y+y[1].y)/2);var T=Math.sqrt((M.pntLeft.x-M.pntRight.x)*(M.pntLeft.x-M.pntRight.x)+(M.pntLeft.y-M.pntRight.y)*(M.pntLeft.y-M.pntRight.y))*this.sv_AtWidthDivAwWidth,_=(i=T*this.sv_AtLenDivAtWidth)*n;SuperMapAlgoPlot.PlottingUtil.equalFuzzy(l,0)||(_=(i=t*l)*n);var O,x,w=SuperMapAlgoPlot.PlottingUtil.distance(y[c],y[c-1]),E=2*i;w<E&&(_=(i=w/2)*n),y.push(y[c].clone()),O=0,x=0;var C=0,I=[];for(C=2;C<=c;C++)O+=SuperMapAlgoPlot.PlottingUtil.distance(y[C],y[C-1]);for(O-=i,C=2;C<=c-1;C++)x+=SuperMapAlgoPlot.PlottingUtil.distance(y[C],y[C-1]),I[C]=_+(T-_)*Math.pow((O-x)/O,this.sv_AtScaleParameter);I[c]=_;var D,R,N=new SuperMapAlgoPlot.Point(0,0),U=new SuperMapAlgoPlot.Point(0,0),B=new SuperMapAlgoPlot.Point(0,0);for(C=2;C<=c-1;C++)SuperMapAlgoPlot.PlottingUtil.getTrianglePoints(0,3,y[C-1],y[C],y[C+1],U,B),C==c-1&&SuperMapAlgoPlot.PlottingUtil.getTrapezoidPoints(.5,y[c],y[c-1],B,N),D=SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine(I[C],U,y[C]),(A=SuperMapAlgoPlot.PlottingUtil.pointIsRightToLine(B,U,D.pntRight))?(a[C]=new SuperMapAlgoPlot.Point(D.pntRight.x,D.pntRight.y),s[C]=new SuperMapAlgoPlot.Point(D.pntLeft.x,D.pntLeft.y)):(a[C]=new SuperMapAlgoPlot.Point(D.pntLeft.x,D.pntLeft.y),s[C]=new SuperMapAlgoPlot.Point(D.pntRight.x,D.pntRight.y));for(Math.sqrt(1*(y[c].x-N.x)*(y[c].x-N.x)+1*(y[c].y-N.y)*(y[c].y-N.y))>0&&(y[c]=SuperMapAlgoPlot.PlottingUtil.getIncentrePointOnSegmentByScale(i,y[c],N)),D=SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine(_,y[c+1],y[c]),(A=SuperMapAlgoPlot.PlottingUtil.pointIsRightToLine(y[c],y[c+1],D.pntLeft))?(s[c]=new SuperMapAlgoPlot.Point(D.pntLeft.x,D.pntLeft.y),a[c]=new SuperMapAlgoPlot.Point(D.pntRight.x,D.pntRight.y)):(s[c]=new SuperMapAlgoPlot.Point(D.pntRight.x,D.pntRight.y),a[c]=new SuperMapAlgoPlot.Point(D.pntLeft.x,D.pntLeft.y)),C=2;C<c;C++)SuperMapAlgoPlot.PlottingUtil.getTrianglePoints(3,3,a[C-1],a[C],a[C+1],U,B),r[C]=new SuperMapAlgoPlot.Point(U.x,U.y),u[C]=new SuperMapAlgoPlot.Point(B.x,B.y),SuperMapAlgoPlot.PlottingUtil.getTrianglePoints(3,3,s[C-1],s[C],s[C+1],U,B),p[C]=new SuperMapAlgoPlot.Point(U.x,U.y),h[C]=new SuperMapAlgoPlot.Point(B.x,B.y),2==C&&(SuperMapAlgoPlot.PlottingUtil.getTrapezoidPoints(.5,a[1],a[2],r[2],N),u[C]=new SuperMapAlgoPlot.Point(N.x,N.y),SuperMapAlgoPlot.PlottingUtil.getTrapezoidPoints(.5,s[1],s[2],p[2],N),h[C]=new SuperMapAlgoPlot.Point(N.x,N.y)),C==c-1&&(E=(w=SuperMapAlgoPlot.PlottingUtil.distance(a[c],a[c-1]))/3,(R=SuperMapAlgoPlot.PlottingUtil.getExcentrePointOnSegmentByScale(E,y[c],y[c+1])).x+=a[c].x-y[c].x,R.y+=a[c].y-y[c].y,E=(w=T-_)*Math.pow(E/O,this.sv_AtScaleParameter),D=SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine(E,a[c],R),r[c]=new SuperMapAlgoPlot.Point(D.pntLeft.x,D.pntLeft.y),E=(w=SuperMapAlgoPlot.PlottingUtil.distance(s[c],s[c-1]))/3,(R=SuperMapAlgoPlot.PlottingUtil.getExcentrePointOnSegmentByScale(E,y[c],y[c+1])).x+=s[c].x-y[c].x,R.y+=s[c].y-y[c].y,E=(w=T-_)*Math.pow(E/O,this.sv_AtScaleParameter),D=SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine(E,s[c],R),p[c]=new SuperMapAlgoPlot.Point(D.pntRight.x,D.pntRight.y));return{ArrowBodyCenterPts:SuperMapAlgoPlot.PlottingUtil.clonePoints(y),LeftBodyPtsTemp:a,RightBodyPtsTemp:s,LeftBodyPtsLeftCtrlPts:r,LeftBodyPtsRightCtrlPts:u,RightBodyPtsLeftCtrlPts:p,RightBodyPtsRightCtrlPts:h,ArrowTouLen:i}}},{key:"calcScaleValueCount",value:function(){return 4}},{key:"calcDefaultScaleValues",value:function(){var t=[];return t.push(this.sv1_DefaultAtLenDivAbLen),t.push(this.sv2_DefaultAjWidthDivAtLen),t.push(this.sv3_DefaultAeWidthDivAtLen),t.push(this.sv4_DefaultAeLenDivAtLen),t}},{key:"genAtPts",value:function(t,e,o,i){var l=o[2],n=[],a=i*o[3],s=SuperMapAlgoPlot.PlottingUtil.getExcentrePointOnSegmentByScale(a,e[t],e[t+1]);a=i*l;var r=SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine(a,e[t+1],s);return n.push(new SuperMapAlgoPlot.Point(r.pntLeft.x,r.pntLeft.y)),n.push(e[t+1]),n.push(new SuperMapAlgoPlot.Point(r.pntRight.x,r.pntRight.y)),n}},{key:"calc3rdScalePt",value:function(t,e,o,i){var l=i*o[3];return SuperMapAlgoPlot.PlottingUtil.getExcentrePointOnSegmentByScale(l,e[t],e[t+1])}}]),e}();SuperMapAlgoPlot.AlgoSymbol1004=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.AlgoSymbol1003=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return 0===o.scaleValues.length&&(o.scaleValues.push(.3),o.scaleValues.push(.28),o.scaleValues.push(.433333),o.scaleValues.push(.53),o.scaleValues.push(0)),o.CLASS_NAME="SuperMapAlgoPlot.AlgoSymbol1003",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol),i(e,[{key:"calculateParts",value:function(){this.init();var t=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints),e=(t=SuperMapAlgoPlot.PlottingUtil.clearSamePts(t)).length;if(e>=this.minEditPts){if(SuperMapAlgoPlot.PlottingUtil.equalFuzzy(this.controlPoints[0].x,this.controlPoints[1].x)&&SuperMapAlgoPlot.PlottingUtil.equalFuzzy(this.controlPoints[0].y,this.controlPoints[1].y))return;var o=SuperMapAlgoPlot.PlottingUtil.clonePoints(t),i=!1;void 0!==o[0].z&&(i=!0);var l=SuperMapAlgoPlot.ArrowToolkit.generateArrowBodyShapePts(t,this.scaleValues,SuperMapAlgoPlot.ArrowToolkit.ArrowBodyType.ARROWBODY_TRAPEZOID),n=l.arrowTouLen,a=l.leftBodyPts,s=l.rightBodyPts,r=[];r.push(a[a.length-1]),r.push(s[s.length-1]);var u=[];u.push(this.scaleValues[3]),u.push(this.scaleValues[4]),u.push(0),u.push(0);var p=SuperMapAlgoPlot.ArrowToolkit.generateArrowHeadShapePts(t,r,u,n,SuperMapAlgoPlot.ArrowToolkit.ArrowHeadType.ARROWHEAD_WITHOUT_EAR),h=[];h=(h=h.concat(a)).concat(p);for(var c=s.length-1;c>=0;c--)h.push(s[c]);if(h.push(a[0]),i){for(var g=[],y={x:o[1].x,y:o[1].y,z:o[1].z},f={x:o[0].x,y:o[0].y,z:o[0].z},P=0;P<h.length;P++){var d=this.ComputeZValue(h[P],y,f);g.push({x:h[P].x,y:h[P].y,z:d})}var S=new SuperMapAlgoPlot.Point((r[0].x+r[1].x)/2,(r[0].y+r[1].y)/2),m=new SuperMapAlgoPlot.Point(S.x,S.y);m.isScalePoint=!0,m.tag=0,this.addScalePoint(m);var b=new SuperMapAlgoPlot.Point(a[a.length-1].x,a[a.length-1].y);b.isScalePoint=!0,b.tag=1,this.addScalePoint(b);var L=new SuperMapAlgoPlot.Point(p[0].x,p[0].y);L.isScalePoint=!0,L.tag=2,this.addScalePoint(L);for(var v={x:o[e-1].x,y:o[e-1].y,z:o[e-1].z},M={x:o[e-2].x,y:o[e-2].y,z:o[e-2].z},A=[],T=0;T<this.scalePoints.length;T++){var _={x:this.scalePoints[T].x,y:this.scalePoints[T].y},O=this.ComputeZValue(_,v,M);A.push({x:_.x,y:_.y,z:O})}this.scalePoints=A,this.addCell(SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,g)}else{var x=new SuperMapAlgoPlot.Point((r[0].x+r[1].x)/2,(r[0].y+r[1].y)/2),w=new SuperMapAlgoPlot.Point(x.x,x.y);w.isScalePoint=!0,w.tag=0,this.addScalePoint(w);var E=new SuperMapAlgoPlot.Point(a[a.length-1].x,a[a.length-1].y);E.isScalePoint=!0,E.tag=1,this.addScalePoint(E);var C=new SuperMapAlgoPlot.Point(p[0].x,p[0].y);C.isScalePoint=!0,C.tag=2,this.addScalePoint(C),this.addCell(SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,h)}}}},{key:"modifyPoint",value:function(t,e){if(!0===e.isScalePoint){var o=new SuperMapAlgoPlot.Point(this.scalePoints[0].x,this.scalePoints[0].y),i=new SuperMapAlgoPlot.Point(this.scalePoints[1].x,this.scalePoints[1].y),l=new SuperMapAlgoPlot.Point(this.scalePoints[2].x,this.scalePoints[2].y),n=this.scaleValues[0],a=SuperMapAlgoPlot.PlottingUtil.polylineDistance(this.controlPoints),s=a*n;if(0==t){var r=SuperMapAlgoPlot.PlottingUtil.pointProjectToSegment(e,this.controlPoints[0],this.controlPoints[1]),u=r.projectPoint;if(r.isOnline){var p=SuperMapAlgoPlot.PlottingUtil.distance(u,this.controlPoints[1]);this.scaleValues[0]=p/a}}else if(1==t){var h=SuperMapAlgoPlot.PlottingUtil.pointProjectToSegment(e,i,l).projectPoint,c=SuperMapAlgoPlot.PlottingUtil.distance(h,o),g=s*this.scaleValues[1];this.scaleValues[1]=c/s,this.scaleValues[2]=(s*this.scaleValues[2]+c-g)/s}else if(2==t){var y=SuperMapAlgoPlot.PlottingUtil.pointProjectToSegment(e,this.controlPoints[1],l).projectPoint,f=SuperMapAlgoPlot.PlottingUtil.pointProjectToSegment(y,o,this.controlPoints[1]),P=f.projectPoint,d=SuperMapAlgoPlot.PlottingUtil.distance(P,o);!0===f.inOnline?this.scaleValues[4]=-d/s:this.scaleValues[4]=d/s}}this.calculateParts()}}]),e}();SuperMapAlgoPlot.AlgoSymbol1003=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.AlgoSymbol1002=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return o.MIN_GEOPT_COUNT=2,o.MAX_GEOPT_COUNT=1024,o.SV1_defaultATLenDivABLen=0,o.SV2_defaultAYPosScale=.65,o.SV_AJCtrl=.6,o.SV_ArrowWoCtrl=.6,o.SV2_DefaultAJWidDiviedByATLen=.148,o.SV3_DefaultAEWidDividedByATLen=.4,o.SV4_DefaultAELenDividedByATLen=.3,o.SV_ATScaleParameter=1.25,o.SV_ATLenDividedByATWid=1.35,o.SV_ATWidDividedByArrowWeiWid=.5,o.AB_VERTEX_COUNT=4,o.MIN_PTCOUNT_PERARROW=3,o.ATL_DIV_AWW=.7,o.ATL_DIV_ABL=.12,o.ATL_DIV_ABL_1=.18,o.DEFAULT_ARROW_TAIL_POS=.12,o.DUOJIANTOU_TAIL_RATE_1=8,o.DUOJIANTOU_TAIL_RATE_2=3,o.DUOJIANTOU_TAIL_RATE_3=.6,o.AB_CTRLPT_RATE1=0,o.AB_CTRLPT_RATE2=3,o.AB_CTRLPT_RATE3=.5,o.MIN_SCALEVALUE=.1,o.MAX_SCALEVALUE=1,o.m_scalePoints=null,o.CLASS_NAME="SuperMapAlgoPlot.AlgoSymbol1002",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol),i(e,[{key:"calculateParts",value:function(){this.init(),this.m_scalePoints=[];var t=SuperMapAlgoPlot.PlottingUtil.clearSamePts(this.controlPoints);if((t=SuperMapAlgoPlot.PlottingUtil.clearSamePts(t)).length>=2&&t.length<this.minEditPts&&this.calAssistantLine(),!(t.length<this.minEditPts)){var e=this.operateCtrlPts(t),o=e.length,i=Math.floor(o/this.MIN_PTCOUNT_PERARROW),l=this.scaleValues.length;if(l<2*i-1){0==l&&(this.scaleValues.push(this.SV1_defaultATLenDivABLen),l++);for(var n=2*i-1-l,a=0;a<n;a+=2)this.scaleValues.splice(l/2+1,0,this.SV1_defaultATLenDivABLen),this.scaleValues.splice(this.scaleValues.length,0,this.SV2_defaultAYPosScale)}else if(l>2*i-1){for(var s=0;s<i;s++)this.scaleValues.push(this.SV1_defaultATLenDivABLen);for(var r=0;r<i-1;r++)this.scaleValues.push(this.SV2_defaultAYPosScale)}var u=this.arrowMeshs(e);SuperMapAlgoPlot.PlottingUtil.clearSamePts(u.shapePts);var p=!1;if(void 0!==t[0].z&&(p=!0),p){var h=this.operateCtrlPts3D(t),c=u.arrLeftPts2D,g=u.arrRightPts2D,y=u.arrHeadPts2D;if(i!=c.length&&i!=g.length&&i!=y.length)return!1;for(var f=[],P=0;P<i;P++){for(var d=[],S=3*P;S<3*(P+1)&&S<h.length;S++)d.push(h[S]);f.push(d)}for(var m=[],b=[],L=[],v=0;v<i;v++)if(!(2>f[v].length)){for(var M=c[v][c[v].length-1],A=g[v][0],T=new SuperMapAlgoPlot.Point(.5*(M.x+A.x),.5*(M.y+A.y)),_=f[v][f[v].length-1],O=f[v][f[v].length-2],x=this.ComputeZValue(T,_,O),w={x:T.x,y:T.y,z:x},E=[],C=[],I=0;I<f[v].length-1;I++)if(0==v)C.push(f[v][I]);else{var D={x:f[v][I].x,y:f[v][I].y,z:.5*(f[v][I].z+f[v-1][I].z)};C.push(D)}C.push(w),this.ComputeBeizerZValueByDis(C,c[v],E),m.push(E),E=[];var R=[];R.push(w);for(var N=f[v].length-2;N>=0;N--)if(v==i-1)R.push(f[v][N]);else{var U={x:f[v][N].x,y:f[v][N].y,z:.5*(f[v][N].z+f[v+1][N].z)};R.push(U)}this.ComputeBeizerZValueByDis(R,g[v],E),b.push(E),E=[];for(var B=y[v],k=0;k<B.length;k++){var F=this.ComputeZValue(B[k],_,O);E.push({x:B[k].x,y:B[k].y,z:F})}L.push(E)}for(var G=[],V=0;V<i;V++)G=(G=(G=G.concat(m[V])).concat(L[V])).concat(b[V]);return SuperMapAlgoPlot.PlottingUtil.clearSamePts(G),u.shapePts.length>0&&this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,G,{surroundLineFlag:!1}),this.scalePoints=this.scalePoints.concat(this.m_scalePoints),!0}u.shapePts.length>0&&(this.addCell(SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,u.shapePts,{surroundLineFlag:!1,lineWidthLimit:!0,strokeWidth:0,weight:0}),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,u.shapePts,{surroundLineFlag:!1})),this.scalePoints=[];for(var j=0;j<this.m_scalePoints.length;j++)this.m_scalePoints[j].isScalePoint=!0,this.m_scalePoints[j].tag=j,this.addScalePoint(this.m_scalePoints[j])}}},{key:"modifyPoint",value:function(t,e){if(!0===e.isScalePoint){var o=this.operateCtrlPts(this.controlPoints),i=o.length,l=Math.floor(i/this.MIN_PTCOUNT_PERARROW),n=0;if(t<l){var a=[],s=t*this.MIN_PTCOUNT_PERARROW;a[0]=o[s],a[1]=o[s+1],a[2]=o[s+2];var r=SuperMapAlgoPlot.PlottingUtil.polylineDistance(a),u=new SuperMapAlgoPlot.Point(0,0),p=new SuperMapAlgoPlot.Point(0,0),h=new SuperMapAlgoPlot.Point(0,0);SuperMapAlgoPlot.PlottingUtil.getTrianglePoints(this.AB_CTRLPT_RATE1,this.AB_CTRLPT_RATE2,a[0],a[1],a[2],u,p),SuperMapAlgoPlot.PlottingUtil.getTrapezoidPoints(this.AB_CTRLPT_RATE3,a[2],a[1],p,h),n=SuperMapAlgoPlot.PlottingUtil.triangleHeightAndPartBottomLen(a[2],h,e).dLen1/(this.SV4_DefaultAELenDividedByATLen+1)/r}else{var c=[],g=[],y=(t-l)*this.MIN_PTCOUNT_PERARROW;c[0]=o[y],c[1]=o[y+1],c[2]=o[y+2];var f=(t-l+1)*this.MIN_PTCOUNT_PERARROW;g[0]=o[f],g[1]=o[f+1],g[2]=o[f+2];var P=new SuperMapAlgoPlot.Point(0,0),d=new SuperMapAlgoPlot.Point(0,0),S=new SuperMapAlgoPlot.Point(0,0);P.x=.5*(c[2].x+g[2].x),d.x=.5*(c[1].x+g[1].x),S.x=.5*(c[0].x+g[0].x),P.y=.5*(c[2].y+g[2].y),d.y=.5*(c[1].y+g[1].y),S.y=.5*(c[0].y+g[0].y);var m=SuperMapAlgoPlot.PlottingUtil.distance(P,d),b=SuperMapAlgoPlot.PlottingUtil.distance(S,d),L=SuperMapAlgoPlot.PlottingUtil.triangleHeightAndPartBottomLen(P,d,e),v=L.dLen1;n=v<m?v/(m+b):((v=(L=SuperMapAlgoPlot.PlottingUtil.triangleHeightAndPartBottomLen(d,S,e)).dLen1)+m)/(m+b)}n>this.MAX_SCALEVALUE?n=this.MAX_SCALEVALUE:n<this.MIN_SCALEVALUE&&(n=this.MIN_SCALEVALUE),this.scaleValues[t]=n}this.calculateParts()}},{key:"arrowMeshs",value:function(t){var e=[],o=[],i=[],l=new SuperMapAlgoPlot.Path2D,n=t.length,a=Math.floor(n/this.MIN_PTCOUNT_PERARROW),s=this.generateAWWidth(a,t),r=[],u=[],p=0,h=0,c=0,g=[];for(h=0,c=0;h<a;h++,c+=this.MIN_PTCOUNT_PERARROW){g[0]=t[c],g[1]=t[c+1],g[2]=t[c+2],p=this.scaleValues[h];var y=this.generateArrowBodyPts(g,s[h],p);p=y.dATLenDivABLen,r[h]=y.arrowBodyPts,u.push(p)}var f=[],P=0,d=0,S=0,m=[],b=[];for(h=0;h<a-1;h++,d+=this.MIN_PTCOUNT_PERARROW){S=d+this.MIN_PTCOUNT_PERARROW,m[0]=t[d],m[1]=t[d+1],m[2]=t[d+2],b[0]=t[S],b[1]=t[S+1],b[2]=t[S+2],P=this.scaleValues[a+h];var L=this.generateAYPts(m,r[h],b,r[h+1],P);f.push(L.arrowLeftYaoPts),f.push(L.arrowRightYaoPts)}var v=[],M=r[0],A=[],T=0,_=[];l.MoveTo(M[0]),l.CurveTo(M[1],M[2],M[3]),l.CurveTo(M[4],M[5],M[6]),l.ToSubPathPolygons(A),e.push(A[0]),T=A[0].length;for(var O=7;O<10;O++)l.LineTo(M[O]);for(A=[],l.ToSubPathPolygons(A);T<A[0].length;T++)_.push(A[0][T]);for(i.push(_),v.push(M[0]),v.push(t[0]),h=1,c=this.MIN_PTCOUNT_PERARROW;h<a;h++,c+=this.MIN_PTCOUNT_PERARROW){var x=r[h],w=h+h-2,E=f[w];for(l.LineTo(E[0]),l.CurveTo(E[1],E[2],E[3]),A=[],_=[],l.ToSubPathPolygons(A);T<A[0].length;T++)_.push(A[0][T]);o.push(_);var C=f[w+1];for(l.CurveTo(C[1],C[2],C[3]),A=[],_=[],l.ToSubPathPolygons(A);T<A[0].length;T++)_.push(A[0][T]);e.push(_);for(var I=7;I<10;I++)l.LineTo(x[I]);for(A=[],_=[],l.ToSubPathPolygons(A);T<A[0].length;T++)_.push(A[0][T]);i.push(_),v.push(t[c].clone())}var D=r[a-1];for(l.LineTo(D[10]),l.CurveTo(D[11],D[12],D[13]),l.CurveTo(D[14],D[15],D[16]),A=[],_=[],l.ToSubPathPolygons(A);T<A[0].length;T++)_.push(A[0][T]);o.push(_),v.push(D[16]);var R=[];return l.ToSubPathPolygons(R),{shapePts:R[0],arrLeftPts2D:e,arrRightPts2D:o,arrHeadPts2D:i}}},{key:"operateCtrlPts",value:function(t){var e=SuperMapAlgoPlot.PlottingUtil.clonePoints(t),o=e.length,i=Math.floor(o/this.MIN_PTCOUNT_PERARROW),l=o%this.MIN_PTCOUNT_PERARROW,n=new SuperMapAlgoPlot.Point;if(2==l&&(n.x=.5*(e[o-2].x+e[o-1].x),n.y=.5*(e[o-2].y+e[o-1].y),n.x==e[o-1].x&&n.y==e[o-1].y||(e.push(e[o-1].clone()),e[o-1]=n,o++,i++)),o>3)for(var a=i-1,s=0,r=a;s<a;r--,s++)for(var u=r*this.MIN_PTCOUNT_PERARROW,p=0;p<u;p+=this.MIN_PTCOUNT_PERARROW){if(!SuperMapAlgoPlot.PlottingUtil.isRight(e[p+3],e[p+1],e[p+2])){var h=e[p];e[p]=e[p+3],e[p+3]=h,h=e[p+1],e[p+1]=e[p+4],e[p+4]=h,h=e[p+2],e[p+2]=e[p+5],e[p+5]=h}}return e}},{key:"operateCtrlPts3D",value:function(t){var e=t,o=e.length,i=Math.floor(o/this.MIN_PTCOUNT_PERARROW),l={x:0,y:0,z:0};if(2==o%3&&(l.x=.5*(e[o-2].x+e[o-1].x),l.y=.5*(e[o-2].y+e[o-1].y),l.z=.5*(e[o-2].z+e[o-1].z),l.x==e[o-1].x&&l.y==e[o-1].y&&l.z==e[o-1].z||(e.push(e[o-1]),e[o-1]=l,o++,i++)),o>3)for(var n=i-1,a=0,s=n;a<n;s--,a++)for(var r=3*s,u=0;u<r;u+=3){if(!SuperMapAlgoPlot.PlottingUtil.isRight(e[u+3],e[u+1],e[u+2])){var p=e[u];e[u]=e[u+3],e[u+3]=p,p=e[u+1],e[u+1]=e[u+4],e[u+4]=p,p=e[u+2],e[u+2]=e[u+5],e[u+5]=p}}return e}},{key:"generateAWWidth",value:function(t,e){var o=[];if(t>0)if(1==t)o.push(0);else{var i=SuperMapAlgoPlot.PlottingUtil.distance(e[0],e[this.MIN_PTCOUNT_PERARROW]);o.push(i);for(var l=1,n=this.MIN_PTCOUNT_PERARROW;l<t-1;l++,n+=this.MIN_PTCOUNT_PERARROW){i=.5*(SuperMapAlgoPlot.PlottingUtil.distance(e[n-this.MIN_PTCOUNT_PERARROW],e[n])+SuperMapAlgoPlot.PlottingUtil.distance(e[n],e[n+this.MIN_PTCOUNT_PERARROW])),o.push(i)}i=SuperMapAlgoPlot.PlottingUtil.distance(e[n-this.MIN_PTCOUNT_PERARROW],e[n]),o.push(i)}return o}},{key:"generateArrowBodyPts",value:function(t,e,o){var i=[],l=[],n=[],a=[],s=[],r=[],u=[],p=t.length-1;if(p<2)return{dATLenDivABLen:o=0,arrowBodyPts:i};var h=o,c=this.SV2_DefaultAJWidDiviedByATLen,g=this.SV3_DefaultAEWidDividedByATLen,y=this.SV4_DefaultAELenDividedByATLen,f=SuperMapAlgoPlot.PlottingUtil.clonePoints(t),P=SuperMapAlgoPlot.PlottingUtil.polylineDistance(f),d=0==e?P*this.ATL_DIV_ABL_1:(P+e)*this.ATL_DIV_ABL,S=SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine(d,f[1],f[0]);l[1]=S.pntLeft.clone(),n[1]=S.pntRight.clone();var m=0;m=SuperMapAlgoPlot.PlottingUtil.equalFuzzy(h,0,1e-14)?d*this.ATL_DIV_AWW:P*h;var b=SuperMapAlgoPlot.PlottingUtil.distance(f[1],f[2]);m+m>b&&(m=.5*b);var L=m*c;f.push(f[p].clone());var v,M=0;v=P-m;var A=[],T=0;for(T=2;T<=p;T++)M+=SuperMapAlgoPlot.PlottingUtil.distance(f[T-1],f[T-2]),SuperMapAlgoPlot.PlottingUtil.equalFuzzy(v,0,1e-14)?A[T]=0:SuperMapAlgoPlot.PlottingUtil.equalFuzzy(v-M,0,1e-14)?A[T]=L:A[T]=L+(d-L)*Math.pow((v-M)/v,this.SV_ATScaleParameter);A[p+1]=L;var _=new SuperMapAlgoPlot.Point(0,0),O=new SuperMapAlgoPlot.Point(0,0),x=new SuperMapAlgoPlot.Point(0,0);for(T=2;T<=p;T++){SuperMapAlgoPlot.PlottingUtil.getTrianglePoints(this.AB_CTRLPT_RATE1,this.AB_CTRLPT_RATE2,f[T-2],f[T-1],f[T],O,x),p==T&&SuperMapAlgoPlot.PlottingUtil.getTrapezoidPoints(this.AB_CTRLPT_RATE3,f[p],f[p-1],x,_);var w=SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine(A[T],O,f[T-1]);n[T]=w.pntLeft,l[T]=w.pntRight}var E,C,I=_.clone();if(SuperMapAlgoPlot.PlottingUtil.distance(f[p],I)>0){var D=SuperMapAlgoPlot.PlottingUtil.getIncentrePointOnSegmentByScale(m,f[p],_);f[p]=D.clone()}for(S=SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine(L,f[p+1],f[p]),l[p+1]=S.pntLeft,n[p+1]=S.pntRight,T=2;T<=p;T++)SuperMapAlgoPlot.PlottingUtil.getTrianglePoints(this.AB_CTRLPT_RATE2,this.AB_CTRLPT_RATE2,l[T-1],l[T],l[T+1],O,x),a[T]=O.clone(),s[T]=x.clone(),SuperMapAlgoPlot.PlottingUtil.getTrianglePoints(this.AB_CTRLPT_RATE2,this.AB_CTRLPT_RATE2,n[T-1],n[T],n[T+1],O,x),r[T]=O.clone(),u[T]=x.clone();SuperMapAlgoPlot.PlottingUtil.getTrapezoidPoints(this.AB_CTRLPT_RATE3,l[1],l[2],a[2],_),s[1]=_.clone(),SuperMapAlgoPlot.PlottingUtil.getTrapezoidPoints(this.AB_CTRLPT_RATE3,n[1],n[2],r[2],_),u[1]=_.clone();C=SuperMapAlgoPlot.PlottingUtil.distance(l[p+1],l[p])*(1/3),(E=SuperMapAlgoPlot.PlottingUtil.getExcentrePointOnSegmentByScale(C,f[p],f[p+1])).x+=l[p+1].x-f[p].x,E.y+=l[p+1].y-f[p].y,C=(d-L)*Math.pow(C/v,this.SV_ATScaleParameter+.3),S=SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine(C,l[p+1],E),a[p+1]=S.pntLeft.clone(),C=SuperMapAlgoPlot.PlottingUtil.distance(n[p+1],n[p])*(1/3),(E=SuperMapAlgoPlot.PlottingUtil.getExcentrePointOnSegmentByScale(C,f[p],f[p+1])).x+=n[p+1].x-f[p].x,E.y+=n[p+1].y-f[p].y,C=(d-L)*Math.pow(C/v,this.SV_ATScaleParameter+.3),S=SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine(C,n[p+1],E),r[p+1]=S.pntRight.clone();var R=[],N=m*y,U=SuperMapAlgoPlot.PlottingUtil.getExcentrePointOnSegmentByScale(N,f[p],f[p+1]);this.m_scalePoints.push(U.clone()),N=m*g,S=SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine(N,f[p+1],U),R.push(S.pntRight),R.push(f[p+1]),R.push(S.pntLeft);var B=[];for(B.push(l[p+1]),T=p;T>=1;T--)B.push(a[T+1]),B.push(s[T]),B.push(l[T]);var k=[];for(T=1;T<=p;T++)k.push(n[T]),k.push(u[T]),k.push(r[T+1]);k.push(n[p+1]),i.push.apply(i,k),i.push.apply(i,R),i.push.apply(i,B),o=m/P;var F=[];for(T=B.length-1;T>=0;T--)F.push(B[T]);return{dATLenDivABLen:o,arrowBodyPts:i}}},{key:"generateAYPts",value:function(t,e,o,i,l){var n=new SuperMapAlgoPlot.Point(.5*(t[2].x+o[2].x),.5*(t[2].y+o[2].y)),a=new SuperMapAlgoPlot.Point(.5*(t[1].x+o[1].x),.5*(t[1].y+o[1].y)),s=new SuperMapAlgoPlot.Point(.5*(t[0].x+o[0].x),.5*(t[0].y+o[0].y)),r=SuperMapAlgoPlot.PlottingUtil.distance(n,a),u=SuperMapAlgoPlot.PlottingUtil.distance(s,a),p=l*(r+u),h=new SuperMapAlgoPlot.Point(0,0),c=new SuperMapAlgoPlot.Point(0,0),g=new SuperMapAlgoPlot.Point(0,0);if(p>r){p=r+u-p,h=SuperMapAlgoPlot.PlottingUtil.getIncentrePointOnSegmentByScale(p,s,a);var y=SuperMapAlgoPlot.PlottingUtil.distance(t[1],t[0]),f=SuperMapAlgoPlot.PlottingUtil.distance(o[1],o[0]);y=y*p/u,c=SuperMapAlgoPlot.PlottingUtil.getIncentrePointOnSegmentByScale(y,t[0],t[1]),f=f*p/u,g=SuperMapAlgoPlot.PlottingUtil.getIncentrePointOnSegmentByScale(f,o[0],o[1])}else{h=SuperMapAlgoPlot.PlottingUtil.getIncentrePointOnSegmentByScale(p,n,a);var P=SuperMapAlgoPlot.PlottingUtil.distance(t[1],t[2]),d=SuperMapAlgoPlot.PlottingUtil.distance(o[1],o[2]);P=P*p/r,c=SuperMapAlgoPlot.PlottingUtil.getIncentrePointOnSegmentByScale(P,t[2],t[1]),d=d*p/r,g=SuperMapAlgoPlot.PlottingUtil.getIncentrePointOnSegmentByScale(d,o[2],o[1])}this.m_scalePoints.push(h.clone());var S=this.SV_ArrowWoCtrl*SuperMapAlgoPlot.PlottingUtil.distance(h,c),m=this.SV_ArrowWoCtrl*SuperMapAlgoPlot.PlottingUtil.distance(h,g),b=SuperMapAlgoPlot.PlottingUtil.getIncentrePointOnSegmentByScale(S,h,c),L=SuperMapAlgoPlot.PlottingUtil.getIncentrePointOnSegmentByScale(m,h,g),v=e[11].clone(),M=e[10].clone(),A=i[5].clone(),T=i[6].clone(),_=SuperMapAlgoPlot.PlottingUtil.intersectLines(M,v,h,c),O=SuperMapAlgoPlot.PlottingUtil.distance(_.intersectPoint,M),x=SuperMapAlgoPlot.PlottingUtil.distance(M,h);O=O>x?this.SV_AJCtrl*x:this.SV_AJCtrl*O;var w=SuperMapAlgoPlot.PlottingUtil.getIncentrePointOnSegmentByScale(O,M,v);v=w.clone(),e[11]=w.clone(),_=SuperMapAlgoPlot.PlottingUtil.intersectLines(T,A,h,g),O=(O=SuperMapAlgoPlot.PlottingUtil.distance(_.intersectPoint,T))>(x=SuperMapAlgoPlot.PlottingUtil.distance(T,h))?this.SV_AJCtrl*x:this.SV_AJCtrl*O,A=(w=SuperMapAlgoPlot.PlottingUtil.getIncentrePointOnSegmentByScale(O,T,A)).clone(),i[5]=w.clone();var E=[];E.push(M),E.push(v),E.push(b),E.push(h);var C=[];return C.push(h),C.push(L),C.push(A),C.push(T),{arrowLeftYaoPts:E,arrowRightYaoPts:C}}}]),e}();SuperMapAlgoPlot.AlgoSymbol1002=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.AlgoSymbol1001=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return 0===o.scaleValues.length&&(o.scaleValues.push(.1),o.scaleValues.push(.2),o.scaleValues.push(0),o.scaleValues.push(.3),o.scaleValues.push(.08)),o.CLASS_NAME="SuperMapAlgoPlot.AlgoSymbol1001",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol),i(e,[{key:"calculateParts",value:function(){this.init();var t=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints),e=(t=SuperMapAlgoPlot.PlottingUtil.clearSamePts(t)).length;if(e>=this.minEditPts){this.scalePoints=[];var o=SuperMapAlgoPlot.PlottingUtil.clonePoints(t),i=!1;void 0!==o[0].z&&(i=!0);var l=SuperMapAlgoPlot.ArrowToolkit.generateArrowBodyShapePts(t,this.scaleValues,SuperMapAlgoPlot.ArrowToolkit.ArrowBodyType.ARROWBODY_PARALLEL),n=l.arrowTouLen,a=l.leftBodyPts,s=l.rightBodyPts,r=[];r.push(a[a.length-1]),r.push(s[s.length-1]);var u=[];u.push(this.scaleValues[3]),u.push(this.scaleValues[4]),u.push(this.scaleValues[0]),u.push(this.scaleValues[1]);var p=SuperMapAlgoPlot.ArrowToolkit.generateArrowHeadShapePts(t,r,u,n,SuperMapAlgoPlot.ArrowToolkit.ArrowHeadType.ARROWHEAD_WITHOUT_EAR),h=[];if(i){for(var c=[],g=[],y=[],f=0;f<e-1;f++)g.push({x:a[f].x,y:a[f].y,z:o[f].z}),y.push({x:s[f].x,y:s[f].y,z:o[f].z});var P={x:o[e-2].x,y:o[e-2].y,z:o[e-2].z},d={x:o[e-1].x,y:o[e-1].y,z:o[e-1].z},S=this.ComputeZValue(a[e-1],d,P);g.push({x:a[e-1].x,y:a[e-1].y,z:S});var m=this.ComputeZValue(s[e-1],d,P);y.push({x:s[e-1].x,y:s[e-1].y,z:m});for(var b=0;b<p.length;b++){var L=this.ComputeZValue(p[b],d,P);c.push({x:p[b].x,y:p[b].y,z:L})}h=(h=h.concat(g)).concat(c);for(var v=y.length-1;v>=0;v--)h.push(y[v]);var M=new SuperMapAlgoPlot.Point((r[0].x+r[1].x)/2,(r[0].y+r[1].y)/2),A=new SuperMapAlgoPlot.Point(M.x,M.y);A.isScalePoint=!0,A.tag=0,this.addScalePoint(A);var T=new SuperMapAlgoPlot.Point(a[a.length-1].x,a[a.length-1].y);T.isScalePoint=!0,T.tag=1,this.addScalePoint(T);var _=new SuperMapAlgoPlot.Point(p[0].x,p[0].y);_.isScalePoint=!0,_.tag=2,this.addScalePoint(_);for(var O=0;O<this.scalePoints.length;O++){var x=new SuperMapAlgoPlot.Point(this.scalePoints[O].x,this.scalePoints[O].y);this.scalePoints[O].z=this.ComputeZValue(x,d,P)}}else{h=(h=h.concat(a)).concat(p);for(var w=s.length-1;w>=0;w--)h.push(s[w]);var E=new SuperMapAlgoPlot.Point((r[0].x+r[1].x)/2,(r[0].y+r[1].y)/2),C=new SuperMapAlgoPlot.Point(E.x,E.y);C.isScalePoint=!0,C.tag=0,this.addScalePoint(C);var I=new SuperMapAlgoPlot.Point(a[a.length-1].x,a[a.length-1].y);I.isScalePoint=!0,I.tag=1,this.addScalePoint(I);var D=new SuperMapAlgoPlot.Point(p[0].x,p[0].y);D.isScalePoint=!0,D.tag=2,this.addScalePoint(D)}this.addCell(SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,h,{surroundLineFlag:!1,lineWidthLimit:!0,strokeWidth:0,weight:0}),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,h)}}},{key:"modifyPoint",value:function(t,e){if(!0===e.isScalePoint){var o=new SuperMapAlgoPlot.Point(this.scalePoints[0].x,this.scalePoints[0].y),i=new SuperMapAlgoPlot.Point(this.scalePoints[1].x,this.scalePoints[1].y),l=new SuperMapAlgoPlot.Point(this.scalePoints[2].x,this.scalePoints[2].y),n=this.scaleValues[0],a=SuperMapAlgoPlot.PlottingUtil.polylineDistance(this.controlPoints),s=a*n;if(0==t){var r=SuperMapAlgoPlot.PlottingUtil.pointProjectToSegment(e,this.controlPoints[this.controlPoints.length-2],this.controlPoints[this.controlPoints.length-1]),u=r.projectPoint;if(r.isOnline){var p=SuperMapAlgoPlot.PlottingUtil.distance(u,this.controlPoints[this.controlPoints.length-1]);this.scaleValues[0]=p/a}}else if(1==t){var h=SuperMapAlgoPlot.PlottingUtil.pointProjectToSegment(e,i,l).projectPoint,c=SuperMapAlgoPlot.PlottingUtil.distance(h,o);this.scaleValues[1]=c/s}else if(2==t){var g=SuperMapAlgoPlot.PlottingUtil.pointProjectToSegment(e,this.controlPoints[1],l).projectPoint,y=SuperMapAlgoPlot.PlottingUtil.pointProjectToSegment(g,o,this.controlPoints[1]),f=y.projectPoint,P=SuperMapAlgoPlot.PlottingUtil.distance(f,o);!0===y.inOnline?this.scaleValues[4]=-P/s:this.scaleValues[4]=P/s}}this.calculateParts()}}]),e}();SuperMapAlgoPlot.AlgoSymbol1001=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.NewChord=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return o.CLASS_NAME="SuperMapAlgoPlot.NewChord",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol),i(e,[{key:"destroy",value:function(){(function t(e,o,i){null===e&&(e=Function.prototype);var l=Object.getOwnPropertyDescriptor(e,o);if(void 0===l){var n=Object.getPrototypeOf(e);return null===n?void 0:t(n,o,i)}if("value"in l)return l.value;var a=l.get;return void 0!==a?a.call(i):void 0})(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}},{key:"calculateParts",value:function(){this.init();var t=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);if((t=SuperMapAlgoPlot.PlottingUtil.clearSamePts(t)).length>=this.minEditPts){var e=SuperMapAlgoPlot.PlottingUtil.distance(t[0],t[1]),o=SuperMapAlgoPlot.PlottingUtil.radian(t[0],t[1]),i=SuperMapAlgoPlot.PlottingUtil.radian(t[0],t[2]),l=SuperMapAlgoPlot.Primitives.getArcCircleSpatialData(t[0],e,i,o);0!==l.length&&this.addCell(SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,l)}}}]),e}();SuperMapAlgoPlot.NewChord=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.NewArc=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return o.CLASS_NAME="SuperMapAlgoPlot.NewArc",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol),i(e,[{key:"destroy",value:function(){(function t(e,o,i){null===e&&(e=Function.prototype);var l=Object.getOwnPropertyDescriptor(e,o);if(void 0===l){var n=Object.getPrototypeOf(e);return null===n?void 0:t(n,o,i)}if("value"in l)return l.value;var a=l.get;return void 0!==a?a.call(i):void 0})(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}},{key:"calculateParts",value:function(){this.init();var t=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);if((t=SuperMapAlgoPlot.PlottingUtil.clearSamePts(t)).length>=this.minEditPts){var e=SuperMapAlgoPlot.PlottingUtil.distance(t[0],t[1]),o=SuperMapAlgoPlot.PlottingUtil.radian(t[0],t[2]),i=SuperMapAlgoPlot.PlottingUtil.radian(t[0],t[1]),l=SuperMapAlgoPlot.Primitives.getArcCircleSpatialData(t[0],e,o,i);0!==l.length&&this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,l)}}}]),e}();SuperMapAlgoPlot.NewArc=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.NewPie=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return o.CLASS_NAME="SuperMapAlgoPlot.NewPie",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol),i(e,[{key:"destroy",value:function(){(function t(e,o,i){null===e&&(e=Function.prototype);var l=Object.getOwnPropertyDescriptor(e,o);if(void 0===l){var n=Object.getPrototypeOf(e);return null===n?void 0:t(n,o,i)}if("value"in l)return l.value;var a=l.get;return void 0!==a?a.call(i):void 0})(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}},{key:"calculateParts",value:function(){this.init();var t=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);if((t=SuperMapAlgoPlot.PlottingUtil.clearSamePts(t)).length>=this.minEditPts){var e=SuperMapAlgoPlot.PlottingUtil.distance(t[0],t[1]),o=SuperMapAlgoPlot.PlottingUtil.radian(t[0],t[2]),i=SuperMapAlgoPlot.PlottingUtil.radian(t[0],t[1]),l=[];l.push(t[0]),(l=l.concat(SuperMapAlgoPlot.Primitives.getArcCircleSpatialData(t[0],e,o,i))).push(t[0]),0!==l.length&&this.addCell(SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,l)}}}]),e}();SuperMapAlgoPlot.NewPie=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.Polybezier=function(t){function e(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol),i(e,[{key:"calculateParts",value:function(){this.init();var t=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);if(!((t=SuperMapAlgoPlot.PlottingUtil.clearSamePts(t)).length<this.minEditPts)){this.isEdit||(this.scaleValues=[]),this.scalePoints=[];var e=[];if(t.length<3)e.push(t[0]),e.push(t[1]);else{var o=SuperMapAlgoPlot.PlottingUtil.computeBeizerPoints(this.isEdit,t,this.scaleValues);this.scaleValues=o.scaleValues;for(var i=0;i<o.scalePoints.length;i++)this.addScalePoint(o.scalePoints[i]);e=o.beizerPoints}SuperMapAlgoPlot.PlottingUtil.clearSamePts(e),e.length<=0||(this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,e),this.finish())}}},{key:"computeScaleValues",value:function(t,e){if(!0===e.isScalePoint){if(t<0||t>2*this.controlPoints.length-1)return;var o=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);if(o=SuperMapAlgoPlot.PlottingUtil.clearSamePts(o),this.minEditPts>o.length)return;var i=SuperMapAlgoPlot.PlottingUtil.generateBeizerPointsNoCtrlPt(o);i=SuperMapAlgoPlot.PlottingUtil.clearSamePts(i);var l=SuperMapAlgoPlot.PlottingUtil.polylineDistance(o),n=SuperMapAlgoPlot.PlottingUtil.polylineDistance(i);if(SuperMapAlgoPlot.PlottingUtil.equalFuzzy(l,0)||SuperMapAlgoPlot.PlottingUtil.equalFuzzy(n,0))return;var a=-1;a=t%2==0?Math.floor(t/2):Math.floor((t+1)/2);var s=(e.x-o[a].x)/l,r=(e.y-o[a].y)/l;this.scaleValues[2*t]=s,this.scaleValues[2*t+1]=r}}}]),e}();SuperMapAlgoPlot.Polybezier=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.LinearArrow=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return 0===o.scaleValues.length&&(o.scaleValues.push(15),o.scaleValues.push(7.5),o.scaleValues.push(0),o.scaleValues.push(15),o.scaleValues.push(7.5),o.scaleValues.push(0)),o.CLASS_NAME="SuperMapAlgoPlot.LinearArrow",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol),i(e,[{key:"calculateParts",value:function(){if(this.init(),!(null==this.controlPoints||this.controlPoints.length<this.minEditPts)){var t=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);if(!((t=SuperMapAlgoPlot.PlottingUtil.clearSamePts(t)).length<this.minEditPts)){if(this.scalePoints=[],this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,t),!SuperMapAlgoPlot.PlottingUtil.equalFuzzy(this.scaleValues[0],0)&&!SuperMapAlgoPlot.PlottingUtil.equalFuzzy(this.scaleValues[1],0)){var e=this.scaleValues[0]*(this.style.weight||this.style.strokeWidth),o=this.scaleValues[1]*(this.style.weight||this.style.strokeWidth),i=this.getLonLatDistanceFromPixel(e),l=this.getLonLatDistanceFromPixel(o),n=SuperMapAlgoPlot.PlottingUtil.findPointInLine(t[0],t[1],i),a=SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine(l,t[1],n),s=[];if(s.push(a.pntLeft),s.push(t[0]),s.push(a.pntRight),this.addScalePoint(a.pntLeft,0),SuperMapAlgoPlot.PlottingUtil.equalFuzzy(this.scaleValues[2],0))this.addCell(SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,s,{fillLimit:!0,fill:!0}),this.addScalePoint(n,1);else if(SuperMapAlgoPlot.PlottingUtil.equalFuzzy(this.scaleValues[2],1))this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,s),this.addScalePoint(t[0],1);else{var r=i*this.scaleValues[2],u=SuperMapAlgoPlot.PlottingUtil.findPointInLine(n,t[0],r);s.push(u),this.addCell(SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,s,{fillLimit:!0,fill:!0}),this.addScalePoint(u,1)}}if(!SuperMapAlgoPlot.PlottingUtil.equalFuzzy(this.scaleValues[3],0)&&!SuperMapAlgoPlot.PlottingUtil.equalFuzzy(this.scaleValues[4],0)){var p=this.scaleValues[3]*(this.style.weight||this.style.strokeWidth),h=this.scaleValues[4]*(this.style.weight||this.style.strokeWidth),c=this.getLonLatDistanceFromPixel(p),g=this.getLonLatDistanceFromPixel(h),y=SuperMapAlgoPlot.PlottingUtil.findPointInLine(t[1],t[0],c),f=SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine(g,t[0],y),P=[];if(P.push(f.pntLeft),P.push(t[1]),P.push(f.pntRight),this.addScalePoint(f.pntLeft,2),SuperMapAlgoPlot.PlottingUtil.equalFuzzy(this.scaleValues[5],0))this.addCell(SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,P,{fillLimit:!0,fill:!0}),this.addScalePoint(y,3);else if(SuperMapAlgoPlot.PlottingUtil.equalFuzzy(this.scaleValues[5],1))this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,P),this.addScalePoint(t[1],3);else{var d=c*this.scaleValues[5],S=SuperMapAlgoPlot.PlottingUtil.findPointInLine(y,t[1],d);P.push(S),this.addCell(SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,P,{fillLimit:!0,fill:!0}),this.addScalePoint(S,3)}}this.finish()}}}},{key:"modifyPoint",value:function(t,e){if(!0===e.isScalePoint){var o=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);if(o=SuperMapAlgoPlot.PlottingUtil.clearSamePts(o),0===t){var i=SuperMapAlgoPlot.PlottingUtil.pointProjectToSegment(e,o[0],o[1]);if(i.isOnline){var l=this.scaleValues[0]*(this.style.weight||this.style.strokeWidth),n=this.getLonLatDistanceFromPixel(l),a=n*this.scaleValues[2],s=SuperMapAlgoPlot.PlottingUtil.findPointInLine(o[0],o[1],n),r=SuperMapAlgoPlot.PlottingUtil.findPointInLine(s,o[0],a);n=SuperMapAlgoPlot.PlottingUtil.distance(o[0],i.projectPoint),l=this.getPixelDistanceFromLonLat(n),this.scaleValues[0]=l/(this.style.weight||this.style.strokeWidth);var u=SuperMapAlgoPlot.PlottingUtil.distance(e,i.projectPoint),p=this.getPixelDistanceFromLonLat(u);this.scaleValues[1]=p/(this.style.weight||this.style.strokeWidth),a=SuperMapAlgoPlot.PlottingUtil.distance(r,i.projectPoint),this.scaleValues[2]=a/n}}else if(1===t){var h=this.scaleValues[0]*(this.style.weight||this.style.strokeWidth),c=this.getLonLatDistanceFromPixel(h),g=SuperMapAlgoPlot.PlottingUtil.findPointInLine(o[0],o[1],c),y=SuperMapAlgoPlot.PlottingUtil.pointProjectToSegment(e,g,o[0]);if(y.isOnline){var f=SuperMapAlgoPlot.PlottingUtil.distance(g,y.projectPoint);this.scaleValues[2]=f/c,this.scaleValues[2]<0?this.scaleValues[2]=0:this.scaleValues[2]>1&&(this.scaleValues[2]=1)}}else if(2===t){var P=SuperMapAlgoPlot.PlottingUtil.pointProjectToSegment(e,o[0],o[1]);if(P.isOnline){var d=this.scaleValues[3]*(this.style.weight||this.style.strokeWidth),S=this.getLonLatDistanceFromPixel(d),m=S*this.scaleValues[5],b=SuperMapAlgoPlot.PlottingUtil.findPointInLine(o[1],o[0],S),L=SuperMapAlgoPlot.PlottingUtil.findPointInLine(b,o[1],m);S=SuperMapAlgoPlot.PlottingUtil.distance(o[1],P.projectPoint),d=this.getPixelDistanceFromLonLat(S),this.scaleValues[3]=d/(this.style.weight||this.style.strokeWidth);var v=SuperMapAlgoPlot.PlottingUtil.distance(e,P.projectPoint),M=this.getPixelDistanceFromLonLat(v);this.scaleValues[4]=M/(this.style.weight||this.style.strokeWidth),m=SuperMapAlgoPlot.PlottingUtil.distance(L,P.projectPoint),this.scaleValues[5]=m/S}}else if(3===t){var A=this.scaleValues[3]*(this.style.weight||this.style.strokeWidth),T=this.getLonLatDistanceFromPixel(A),_=SuperMapAlgoPlot.PlottingUtil.findPointInLine(o[1],o[0],T),O=SuperMapAlgoPlot.PlottingUtil.pointProjectToSegment(e,_,o[1]);if(O.isOnline){var x=SuperMapAlgoPlot.PlottingUtil.distance(_,O.projectPoint);this.scaleValues[5]=x/T,this.scaleValues[5]<0?this.scaleValues[5]=0:this.scaleValues[5]>1&&(this.scaleValues[5]=1)}}}this.calculateParts()}}]),e}();SuperMapAlgoPlot.LinearArrow=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.Wire=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return 0===o.scaleValues.length&&o.scaleValues.push(.05),o.CLASS_NAME="SuperMapAlgoPlot.Wire",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol),i(e,[{key:"calculateParts",value:function(){this.init();var t=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);if(!((t=SuperMapAlgoPlot.PlottingUtil.clearSamePts(t)).length<this.minEditPts)){this.isEdit||(this.scaleValues[0]=2*this.getSubSymbolScaleValue());var e=SuperMapAlgoPlot.PlottingUtil.generateBeizerPointsNoCtrlPt(t);e=SuperMapAlgoPlot.PlottingUtil.clearSamePts(e);var o=SuperMapAlgoPlot.PlottingUtil.polylineDistance(e);this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,e);for(var i=o*this.scaleValues[0],l=o*this.scaleValues[0]/2,n=SuperMapAlgoPlot.PlottingUtil.clonePoints(e),a=parseInt((o-l)/i),s=0;s<=a&&!(l+i*s>o);s++){var r=SuperMapAlgoPlot.PlottingUtil.findPointInPolyLine(n,l+i*s);if(-1!==r.index){var u=new SuperMapAlgoPlot.Point(r.pt.x,r.pt.y),p=SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine(i/2,e[r.index],u);this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,[p.pntLeft,p.pntRight])}}this.finish()}}}]),e}();SuperMapAlgoPlot.Wire=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}(),l=function t(e,o,i){null===e&&(e=Function.prototype);var l=Object.getOwnPropertyDescriptor(e,o);if(void 0===l){var n=Object.getPrototypeOf(e);return null===n?void 0:t(n,o,i)}if("value"in l)return l.value;var a=l.get;return void 0!==a?a.call(i):void 0};var n=e.PolygonRegion=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return void 0===o.scaleValues[0]&&(o.scaleValues[0]=0),void 0===o.scaleValues[1]&&(o.scaleValues[1]=0),o.CLASS_NAME="SuperMapAlgoPlot.PolygonRegion",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol),i(e,[{key:"destroy",value:function(){l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}},{key:"calculateParts",value:function(){this.init();var t=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);if(null!=(t=SuperMapAlgoPlot.PlottingUtil.clearSamePts(t))&&t.length>=this.minEditPts){if(this.addCell(32,t,{surroundLineFlag:!1}),this.textContent&&null!=this.textContent&&this.textContent.length>0){var e=[];this.scaleValues[1]>t.length&&(this.scaleValues[1]=0);var o={labelRotation:0,surroundLineFlag:!1,labelAlign:"lt"};if(0===this.scaleValues[1])e=[SuperMapAlgoPlot.PlottingUtil.getPolygonCenterPt(t)];else{var i=null,l=null;this.scaleValues[1]===t.length?(i=t[t.length-1],l=t[0]):(i=t[this.scaleValues[1]-1],l=t[this.scaleValues[1]]),o.labelRotation=-SuperMapAlgoPlot.PlottingUtil.radian(i,l)/Math.PI*180;var n=this.scaleValues[0]*SuperMapAlgoPlot.PlottingUtil.distance(i,l);e=[SuperMapAlgoPlot.PlottingUtil.findPoint(i,l,n,0)]}this.addCell(34,e,o,this.textContent);var a=new SuperMapAlgoPlot.Point(e[0].x,e[0].y);a.isScalePoint=!0,a.tag=0,this.scalePoints=[],this.addScalePoint(a)}}else this.controlPoints.length>=2&&this.controlPoints.length<this.minEditPts&&this.calAssistantLine()}},{key:"modifyPoint",value:function(t,e){if(!0===e.isScalePoint){for(var o=0,i=SuperMapAlgoPlot.PlottingUtil.distance(e,this.controlPoints[0]),l=1;l<this.controlPoints.length;l++){var n=SuperMapAlgoPlot.PlottingUtil.distance(e,this.controlPoints[l]);n<i&&(i=n,o=l)}var a=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);(a=SuperMapAlgoPlot.PlottingUtil.clearSamePts(a)).push(a[0].clone());var s=SuperMapAlgoPlot.PlottingUtil.computePointToLineMinDis(e,a);if(-1===s.minDis)this.scaleValues[1]=o+1,this.offsetX=0,this.offsetY=0;else{var r=SuperMapAlgoPlot.PlottingUtil.projectPoint(e,a[s.index],a[s.index+1]),u=SuperMapAlgoPlot.PlottingUtil.distance(e,r),p=SuperMapAlgoPlot.PlottingUtil.getPolygonCenterPt(this.controlPoints),h=SuperMapAlgoPlot.PlottingUtil.distance(e,p);if(h<u&&h<i)this.scaleValues[1]=0,this.scaleValues[0]=0;else if(i<u&&i<h)this.scaleValues[1]=o+1,this.scaleValues[0]=0;else if(u<i&&u<h){this.scaleValues[1]=s.index+1;var c=null,g=null;this.scaleValues[1]===this.controlPoints.length?(c=this.controlPoints[this.controlPoints.length-1],g=this.controlPoints[0]):(c=this.controlPoints[this.scaleValues[1]-1],g=this.controlPoints[this.scaleValues[1]]);var y=SuperMapAlgoPlot.PlottingUtil.distance(r,c),f=SuperMapAlgoPlot.PlottingUtil.distance(c,g);this.scaleValues[0]=y/f}}}this.calculateParts()}},{key:"parseSymbolData",value:function(){l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"parseSymbolData",this).call(this),this.symbolData&&(this.scaleValues[1]=this.symbolData.annotationPosition)}},{key:"setSymbolData",value:function(){l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"setSymbolData",this).call(this),this.symbolData&&(this.symbolData.annotationPosition=this.scaleValues[1])}}]),e}();SuperMapAlgoPlot.PolygonRegion=n},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.LineRelation=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return o.subSectionCount=t.subSectionCount?t.subSectionCount:10,o.CLASS_NAME="SuperMapAlgoPlot.LineRelation",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol),i(e,[{key:"destroy",value:function(){this.subSectionCount=null,function t(e,o,i){null===e&&(e=Function.prototype);var l=Object.getOwnPropertyDescriptor(e,o);if(void 0===l){var n=Object.getPrototypeOf(e);return null===n?void 0:t(n,o,i)}if("value"in l)return l.value;var a=l.get;return void 0!==a?a.call(i):void 0}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}},{key:"calculateParts",value:function(){this.init();for(var t=0;t<this.controlPoints.length;t++)this.controlPoints[t].tag=t;var e=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);null!==e&&e.length>=this.minEditPts&&this.computeLine(e)}},{key:"computeLine",value:function(t){this.components.length=0;var e=t[0],o=t[t.length-1];this.subSectionCount<=1&&(this.subSectionCount=10);var i=SuperMapAlgoPlot.PlottingUtil.distance(e,o)/(2*this.subSectionCount-1);if(this.lineRelationType===SuperMapAlgoPlot.LineRelationType.SOLID)this.addCell(24,t,{surroundLineFlag:!1});else if(this.lineRelationType===SuperMapAlgoPlot.LineRelationType.DASH)for(var l=0;l<this.subSectionCount;l++){var n=SuperMapAlgoPlot.PlottingUtil.findPoint(e,o,2*l*i,0),a=SuperMapAlgoPlot.PlottingUtil.findPoint(e,o,(2*l+1)*i,0);this.addCell(24,[n,a],{surroundLineFlag:!1})}else if(this.lineRelationType===SuperMapAlgoPlot.LineRelationType.ARROW)for(var s=0;s<this.subSectionCount;s++){var r=SuperMapAlgoPlot.PlottingUtil.findPoint(e,o,2*s*i,0),u=SuperMapAlgoPlot.PlottingUtil.findPoint(e,o,(2*s+1)*i,0),p=SuperMapAlgoPlot.PlottingUtil.findPoint(u,r,i,60),h=SuperMapAlgoPlot.PlottingUtil.findPoint(u,r,i,-60);this.addCell(24,[p,u,h],{surroundLineFlag:!1})}}}]),e}();SuperMapAlgoPlot.LineRelation=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.LineMarking=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return o.islocationCircle=!!t.islocationCircle&&t.islocationCircle,o.textBoxType=t.textBoxType?t.textBoxType:SuperMapAlgoPlot.TextBoxType.RECTBOX,0===o.scaleValues.length&&(o.scaleValues.push(.126),o.scaleValues.push(0),o.scaleValues.push(0),o.scaleValues.push(4)),o.CLASS_NAME="SuperMapAlgoPlot.LineMarking",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol),i(e,[{key:"destroy",value:function(){this.islocationCircle=null,this.textBoxType=null,function t(e,o,i){null===e&&(e=Function.prototype);var l=Object.getOwnPropertyDescriptor(e,o);if(void 0===l){var n=Object.getPrototypeOf(e);return null===n?void 0:t(n,o,i)}if("value"in l)return l.value;var a=l.get;return void 0!==a?a.call(i):void 0}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}},{key:"calculateParts",value:function(){this.init(),this.controlPoints=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints),this.controlPoints=SuperMapAlgoPlot.PlottingUtil.clearSamePts(this.controlPoints);var t=this.scaleValues[0];if(!(t<0||t>1)){if(t=(1-t)/2,this.controlPoints.length>=this.minEditPts){var e,o,i,l;this.scalePoints=[];var n=[];this.controlPoints[0].x<this.controlPoints[1].x?(e=this.controlPoints[0].x,i=this.controlPoints[1].x):(e=this.controlPoints[1].x,i=this.controlPoints[0].x),this.controlPoints[0].y<this.controlPoints[1].y?(l=this.controlPoints[0].y,o=this.controlPoints[1].y):(l=this.controlPoints[1].y,o=this.controlPoints[0].y),n.push(new SuperMapAlgoPlot.Point(e,l)),n.push(new SuperMapAlgoPlot.Point(e,o)),n.push(new SuperMapAlgoPlot.Point(i,o)),n.push(new SuperMapAlgoPlot.Point(i,l)),!1===this.isEdit&&(this.scaleValues[1]=e+.1*(i-e),this.scaleValues[2]=l+-.3*(o-l));var a=this.getAction(this.scaleValues[1],this.scaleValues[2],e,o,i,l),s=new SuperMapAlgoPlot.Point(this.scaleValues[1],this.scaleValues[2]);if(this.textBoxType===SuperMapAlgoPlot.TextBoxType.RECTBOX||this.textBoxType===SuperMapAlgoPlot.TextBoxType.LINEBOX){var r=[];switch(a){case 0:this.addScalePoint(s);break;case 1:this.addScalePoint(s),r.push(new SuperMapAlgoPlot.Point(e,o-(o-l)*t)),r.push(s);break;case 2:this.addScalePoint(s),r.push(new SuperMapAlgoPlot.Point(i-(i-e)*t,o)),r.push(s);break;case 3:this.addScalePoint(s),r.push(new SuperMapAlgoPlot.Point(i,o-(o-l)*t)),r.push(s);break;case 4:this.addScalePoint(s),r.push(new SuperMapAlgoPlot.Point(i-(i-e)*t,l)),r.push(s)}this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,r)}if(0!==n.length&&this.textBoxType===SuperMapAlgoPlot.TextBoxType.RECTBOX)this.addCell(SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,n);else if(0!==n.length&&this.textBoxType===SuperMapAlgoPlot.TextBoxType.LINEBOX){var u=[];switch(a){case 0:break;case 1:u=(u=u.concat(n[0])).concat(n[1]);break;case 2:u=(u=u.concat(n[1])).concat(n[2]);break;case 3:u=(u=u.concat(n[2])).concat(n[3]);break;case 4:u=(u=u.concat(n[3])).concat(n[0])}0!==u.length?this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,u):this.addCell(SuperMapAlgoPlot.SymbolType.RECTANGLESYMBOL,this.controlPoints)}this.islocationCircle&&this.addCell(SuperMapAlgoPlot.SymbolType.CIRCLESYMBOL,[s,new SuperMapAlgoPlot.Point(s.x-.05,s.y-.05)]),this.annotationContent(e,o,i,l)}else this.controlPoints.length>=2&&this.controlPoints.length<this.minEditPts&&this.addCell(SuperMapAlgoPlot.SymbolType.RECTANGLESYMBOL,this.controlPoints);this.finish()}}},{key:"modifyPoint",value:function(t,e){!0===e.isScalePoint&&(this.scaleValues[1]=e.x,this.scaleValues[2]=e.y),this.calculateParts()}},{key:"getAction",value:function(t,e,o,i,l,n){var a=(i-n)/(l-o);return t<o?e>i?Math.abs((e-i)/(t-o))>a?2:1:e<n&&Math.abs((e-n)/(t-o))>a?4:1:t>l?e>i?Math.abs((e-i)/(t-l))>a?2:3:e<n&&Math.abs((e-n)/(t-l))>a?4:3:e>i?2:e<n?4:0}}]),e}();SuperMapAlgoPlot.LineMarking=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.PathText=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return o.relLineText=t.relLineText?t.relLineText:0,o.showPathLine=!t.showPathLine||t.showPathLine,o.showPathLineArrow=!!t.showPathLineArrow&&t.showPathLineArrow,o.isCurve=!!t.isCurve&&t.isCurve,o.isAvoid=!!t.isAvoid&&t.isAvoid,o.textToLineDistance=t.textToLineDistance?t.textToLineDistance:0,o.CLASS_NAME="SuperMapAlgoPlot.PathText",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol),i(e,[{key:"calculateParts",value:function(){if(this.init(),null!==this.controlPoints&&0!==this.controlPoints.length&&!(this.controlPoints.length<this.minEditPts)){SuperMap.Util.isArray(this.textContent)||(this.textContent=[this.textContent]);var t=[];if(t=this.isCurve?SuperMapAlgoPlot.PlottingUtil.generateBeizerPointsNoCtrlPt(this.controlPoints):SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints),this.relLineText===SuperMapAlgoPlot.RelLineText.ONBOTHLINE){this.relLineText=SuperMapAlgoPlot.RelLineText.ONRIGHTLINE;var e=this.getTextPathPts(t,!1);this.computeText(e,this.textContent[0],t),this.relLineText=SuperMapAlgoPlot.RelLineText.ONLEFTLINE;var o=this.showPathLine;this.showPathLine=!1;var i=this.getTextPathPts(t,!0);this.textContent.length>1?this.computeText(i,this.textContent[1],t):this.computeText(i,this.textContent[0],t),this.relLineText=SuperMapAlgoPlot.RelLineText.ONBOTHLINE,this.showPathLine=o}else{var l=[];l=this.relLineText===SuperMapAlgoPlot.RelLineText.ONRIGHTLINE?this.getTextPathPts(t,!1):this.relLineText===SuperMapAlgoPlot.RelLineText.ONLEFTLINE?this.getTextPathPts(t,!0):t,this.computeText(l,this.textContent[0],t)}this.finish()}}},{key:"getTextPathPts",value:function(t,e){t=SuperMapAlgoPlot.PlottingUtil.clearSamePts(t);var o=this.getLonLatDistanceFromPixel(this.textToLineDistance);if(0>=o)return SuperMapAlgoPlot.PlottingUtil.clonePoints(t);var i=SuperMapAlgoPlot.PlottingUtil.paraLine(t,o,e);return SuperMapAlgoPlot.PlottingUtil.clearSamePts(i)}},{key:"computeText",value:function(t,e,o){if(!(t.length<2)){for(var i=e.length,l=t,n=l.length,a=0,s=0;s<l.length-1;s++)a+=SuperMapAlgoPlot.PlottingUtil.distance(l[s],l[s+1]);var r={index:-1,pt:l[0]},u=0,p=0,h=0,c=180/Math.PI,g=this.getTextBounds(this.style,e),y="lm";y=this.relLineText===SuperMapAlgoPlot.RelLineText.ONLINE?"lm":this.relLineText===SuperMapAlgoPlot.RelLineText.ONLEFTLINE?"lb":"lt",(u=(a-g.getWidth())/2)<=0&&(u=0);for(var f=[],P=0;P<i;P++){var d=this.getTextBounds(this.style,e.charAt(P));f.push(new SuperMap.Bounds(0,-g.getHeight(),d.getWidth(),0))}for(var S,m=!1,b=!1,L=0,v=0,M=[];p<=u&&h<n-1;)h++,p+=SuperMapAlgoPlot.PlottingUtil.distance(l[h-1],l[h]);var A=SuperMapAlgoPlot.PlottingUtil.findPointInPolyLine(l,u),T=SuperMapAlgoPlot.PlottingUtil.radian(l[h-1],l[h])*c;T>180&&(T-=360),T<-180&&(T+=360),T>90&&T<=180?(L=-180,m=!0,b=!0):T>-180&&T<-90&&(L=180,m=!0,b=!0),!0,0!=L?this.relLineText===SuperMapAlgoPlot.RelLineText.ONLINE||(y=this.relLineText===SuperMapAlgoPlot.RelLineText.ONLEFTLINE?"lt":"lb"):this.relLineText===SuperMapAlgoPlot.RelLineText.ONLINE||(y=this.relLineText===SuperMapAlgoPlot.RelLineText.ONLEFTLINE?"lb":"lt");for(var _=0;_<i&&!(u>a);_++){var O=_;for(b&&(O=i-_-1),v=(S=f[O]).getWidth(),m&&(u+=v);p<=u&&h<n-1;)h++,p+=SuperMapAlgoPlot.PlottingUtil.distance(l[h-1],l[h]);var x=(T=SuperMapAlgoPlot.PlottingUtil.radian(l[h-1],l[h])*c)+L;if((r=SuperMapAlgoPlot.PlottingUtil.findPointInPolyLine(l,u)).index<0)break;S.add(r.pt.x,r.pt.y);var w=e.charAt(O),E={};E.type=SuperMapAlgoPlot.SymbolType.TEXTSYMBOL,E.textContent=w,E.positionPoints=[r.pt],E.style={surroundLineFlag:!1,labelAlign:y,labelRotation:-x},M.push(E),m||(u+=v)}var C=SuperMapAlgoPlot.PlottingUtil.findPointInPolyLine(l,u);if(this.showPathLine){if(this.relLineText===SuperMapAlgoPlot.RelLineText.ONLINE&&this.isAvoid){if(A.index>=0){for(var I=[],D=0;D<=A.index;D++)I.push(o[D]);I.push(A.pt),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,I)}if(C.index>=0){var R=[];R.push(C.pt);for(var N=C.index+1;N<o.length;N++)R.push(o[N]);this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,R)}}else this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,o);this.showPathLineArrow&&this.addArrow(o)}for(var U=0;U<M.length;U++)this.components.push(M[U])}}},{key:"addArrow",value:function(t){if(t.length<2)return t;var e=SuperMapAlgoPlot.PlottingUtil.polylineDistance(this.controlPoints)*(this.isEdit,null==this.getSubSymbolScaleValue()?.05:.5*this.getSubSymbolScaleValue()),o=t[t.length-1];if(t.length>2){for(var i=-1,l=t.length-2;l>=0;l--)if(e<SuperMapAlgoPlot.PlottingUtil.distance(o,t[l])){i=l;break}t.splice(i+1,t.length-i),t.push(o)}var n=t[t.length-2],a=t[t.length-1],s=e;if(void 0===n)return t;if(!(SuperMapAlgoPlot.PlottingUtil.distance(n,a)<e)){var r=SuperMapAlgoPlot.PlottingUtil.radian(n,a)*SuperMapAlgoPlot.PlottingUtil.RTOD,u=SuperMapAlgoPlot.PlottingUtil.circlePoint(a,s,s,r+157.5),p=SuperMapAlgoPlot.PlottingUtil.circlePoint(a,s,s,r+202.5);this.addCell(SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,[u,t[t.length-1],p],{surroundLineFlag:!1,fillLimit:!0,lineTypeLimit:!0,fill:!0})}}}]),e}();SuperMapAlgoPlot.PathText=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.CurveEight=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return o.CLASS_NAME="SuperMapAlgoPlot.CurveEight",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol),i(e,[{key:"destroy",value:function(){(function t(e,o,i){null===e&&(e=Function.prototype);var l=Object.getOwnPropertyDescriptor(e,o);if(void 0===l){var n=Object.getPrototypeOf(e);return null===n?void 0:t(n,o,i)}if("value"in l)return l.value;var a=l.get;return void 0!==a?a.call(i):void 0})(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}},{key:"calculateParts",value:function(){if(this.init(),this.controlPoints&&null!==this.controlPoints&&!(this.minEditPts>this.controlPoints.length))if(2===this.controlPoints.length){var t=this.controlPoints[0].clone(),e=this.controlPoints[1].clone(),o=SuperMapAlgoPlot.PlottingUtil.distance(t,e)/2,i=180*SuperMapAlgoPlot.PlottingUtil.radian(t,e)/Math.PI,l=new SuperMapAlgoPlot.Point((t.x+e.x)/2,(t.y+e.y)/2),n=SuperMapAlgoPlot.PlottingUtil.circlePoint(l,o,o,i+90),a=SuperMapAlgoPlot.PlottingUtil.circlePoint(l,3*o,3*o,i+90);this.addCell(SuperMapAlgoPlot.SymbolType.CIRCLESYMBOL,[n,new SuperMapAlgoPlot.Point(n.x+o,n.y)]),this.addCell(SuperMapAlgoPlot.SymbolType.CIRCLESYMBOL,[a,new SuperMapAlgoPlot.Point(a.x+o,a.y)])}else{var s=this.controlPoints[0].clone(),r=this.controlPoints[1].clone(),u=this.controlPoints[2].clone(),p=0;p=SuperMapAlgoPlot.PlottingUtil.isRight(u,s,r)?180*SuperMapAlgoPlot.PlottingUtil.radian(r,s)/Math.PI+90:180*SuperMapAlgoPlot.PlottingUtil.radian(s,r)/Math.PI+90;var h=SuperMapAlgoPlot.PlottingUtil.distance(s,r)/2,c=new SuperMapAlgoPlot.Point((s.x+r.x)/2,(s.y+r.y)/2),g=SuperMapAlgoPlot.PlottingUtil.circlePoint(c,h,h,p),y=SuperMapAlgoPlot.PlottingUtil.plumbLineLen(u,s,r);if(y<=4*h){var f=SuperMapAlgoPlot.PlottingUtil.circlePoint(c,3*h,3*h,p);this.addCell(SuperMapAlgoPlot.SymbolType.CIRCLESYMBOL,[g,new SuperMapAlgoPlot.Point(g.x+h,g.y)]),this.addCell(SuperMapAlgoPlot.SymbolType.CIRCLESYMBOL,[f,new SuperMapAlgoPlot.Point(f.x+h,f.y)])}else{for(var P=SuperMapAlgoPlot.PlottingUtil.circlePoint(c,y-h,y-h,p),d=180*Math.acos(h/(y-2*h))/Math.PI,S=p-d,m=p-180+d,b=p-180-d+360,L=[],v=p+d-360;v<=S;v+=4){var M=SuperMapAlgoPlot.PlottingUtil.circlePoint(g,h,h,v);L.push(M)}var A=SuperMapAlgoPlot.PlottingUtil.circlePoint(g,h,h,S);L.push(A);for(var T=[],_=m;_<b;_+=4){var O=SuperMapAlgoPlot.PlottingUtil.circlePoint(P,h,h,_);T.push(O)}var x=SuperMapAlgoPlot.PlottingUtil.circlePoint(P,h,h,b);T.push(x);var w=[];w=w.concat(L);for(var E=T.length-1;E>=0;E--)w.push(T[E]);this.addCell(SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,w)}}}}]),e}();SuperMapAlgoPlot.CurveEight=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.Runway=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return 0===o.scaleValues.length&&o.scaleValues.push(.2),o.CLASS_NAME="SuperMapAlgoPlot.Runway",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol),i(e,[{key:"destroy",value:function(){(function t(e,o,i){null===e&&(e=Function.prototype);var l=Object.getOwnPropertyDescriptor(e,o);if(void 0===l){var n=Object.getPrototypeOf(e);return null===n?void 0:t(n,o,i)}if("value"in l)return l.value;var a=l.get;return void 0!==a?a.call(i):void 0})(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}},{key:"calculateParts",value:function(){if(this.init(),this.controlPoints.length>=this.minEditPts){for(var t=this.controlPoints[0],e=this.controlPoints[1],o=SuperMapAlgoPlot.PlottingUtil.distance(t,e),i=this.scaleValues[0]*o,l=SuperMapAlgoPlot.PlottingUtil.parallel(this.controlPoints,i/2),n=SuperMapAlgoPlot.PlottingUtil.parallel(this.controlPoints,-i/2),a=180*SuperMapAlgoPlot.PlottingUtil.radian(t,e)/Math.PI,s=[],r=a+90;r<=a+270;r+=10){var u=SuperMapAlgoPlot.PlottingUtil.circlePoint(t,i/2,i/2,r);s.push(u)}for(var p=[],h=a-90;h<=a+90;h+=10){var c=SuperMapAlgoPlot.PlottingUtil.circlePoint(e,i/2,i/2,h);p.push(c)}var g=[];(g=(g=(g=(g=g.concat(s)).concat(n)).concat(p)).concat(l)).push(g[0]),this.addCell(SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,g);var y=new SuperMapAlgoPlot.Point(s[0].x,s[0].y);this.addScalePoint(y)}}},{key:"modifyPoint",value:function(t,e){if(!0===e.isScalePoint&&0==t){var o=SuperMapAlgoPlot.PlottingUtil.distance(e,this.controlPoints[0]),i=SuperMapAlgoPlot.PlottingUtil.distance(this.controlPoints[0],this.controlPoints[1]);this.scaleValues[0]=2*o/i}this.calculateParts()}}]),e}();SuperMapAlgoPlot.Runway=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.NodeChain=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return 0===o.scaleValues.length&&(o.scaleValues.push(0),o.scaleValues[1]=.1),o.CLASS_NAME="SuperMapAlgoPlot.NodeChain",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol),i(e,[{key:"destroy",value:function(){(function t(e,o,i){null===e&&(e=Function.prototype);var l=Object.getOwnPropertyDescriptor(e,o);if(void 0===l){var n=Object.getPrototypeOf(e);return null===n?void 0:t(n,o,i)}if("value"in l)return l.value;var a=l.get;return void 0!==a?a.call(i):void 0})(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}},{key:"calculateParts",value:function(){if(this.init(),this.controlPoints&&null!==this.controlPoints){var t=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);if(!((t=SuperMapAlgoPlot.PlottingUtil.clearSamePts(t)).length<this.minEditPts)){this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,t),this.isEdit||(this.scaleValues[1]=.25*this.getSubSymbolScaleValue());var e=SuperMapAlgoPlot.PlottingUtil.polylineDistance(t),o=e*this.scaleValues[0],i=e*this.scaleValues[1];if(0<this.subSymbols.length&&null!==this.subSymbols[0]&&void 0!==this.subSymbols[0])if(this.subSymbols[0].code>0)for(var l=0;l<t.length;l++){var n=new SuperMapAlgoPlot.Point(t[l].x,t[l].y+o);this.computeSubSymbol(this.subSymbols[0],n,2*i,0)}else this.addCircles(t,o,i);else this.addCircles(t,o,i);var a=new SuperMapAlgoPlot.Point(t[0].x,t[0].y+o);this.addScalePoint(a);var s=SuperMapAlgoPlot.PlottingUtil.circlePoint(a,i,i,90);this.addScalePoint(s)}}}},{key:"addCircles",value:function(t,e,o){for(var i={surroundLineFlag:!1,fillLimit:!0,fillColorLimit:!1,fill:!0},l=0;l<t.length;l++){var n=new SuperMapAlgoPlot.Point(t[l].x,t[l].y+e),a=this.getCirclePts(n,o);this.addCell(SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,a,i)}}},{key:"getCirclePts",value:function(t,e){for(var o=[],i=0;i<=360;i+=12){var l=SuperMapAlgoPlot.PlottingUtil.circlePoint(t,e,e,i);o.push(l)}return o}},{key:"modifyPoint",value:function(t,e){if(!0===e.isScalePoint){var o=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);if((o=SuperMapAlgoPlot.PlottingUtil.clearSamePts(o)).length<this.minEditPts)return;var i=SuperMapAlgoPlot.PlottingUtil.polylineDistance(o);if(0===t)this.scaleValues[0]=(e.y-o[0].y)/i;else if(1===t){var l=i*this.scaleValues[0],n=new SuperMapAlgoPlot.Point(o[0].x,o[0].y+l),a=SuperMapAlgoPlot.PlottingUtil.distance(e,n);this.scaleValues[1]=a/i}}this.calculateParts()}}]),e}();SuperMapAlgoPlot.NodeChain=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.FreeCurve=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return o.CLASS_NAME="SuperMapAlgoPlot.FreeCurve",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol),i(e,[{key:"calculateParts",value:function(){if(this.init(),!(null==this.controlPoints||this.controlPoints.length<this.minEditPts)){this.scalePoints=[];var t=[];if(this.controlPoints.length<3)t.push(this.controlPoints[0]),t.push(this.controlPoints[1]);else{if(!this.isEdit){var e=this.getLonLatFromPixel(0,0),o=this.getLonLatFromPixel(100,100),i=Math.abs(e.lon-o.lon),l=this.reSample(this.controlPoints,i/50);l.length<3&&(l=this.controlPoints),this.controlPoints=[],this.controlPoints=this.controlPoints.concat(l)}var n=SuperMapAlgoPlot.PlottingUtil.computeBeizerPoints(this.isEdit,this.controlPoints,this.scaleValues);n.scalePoints=SuperMapAlgoPlot.PlottingUtil.clearSamePts(n.scalePoints),n.scaleValues=SuperMapAlgoPlot.PlottingUtil.clearSamePts(n.scaleValues),this.scaleValues=n.scaleValues;for(var a=0,s=n.scalePoints.length;a<s;a++){var r=n.scalePoints[a];r.isScalePoint=!0,r.tag=a,this.addScalePoint(r)}t=SuperMapAlgoPlot.PlottingUtil.clonePoints(n.beizerPoints)}this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,t)}}},{key:"modifyPoint",value:function(t,e){if(!0===e.isScalePoint){if(t<0||t>2*this.controlPoints.length-1)return;var o=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);if(2>o.length)return;var i=SuperMapAlgoPlot.PlottingUtil.polylineDistance(o),l=-1;l=t%2==0?Math.floor(t/2):Math.floor((t+1)/2);var n=(e.x-o[l].x)/i,a=(e.y-o[l].y)/i;this.scaleValues[2*t]=n,this.scaleValues[2*t+1]=a}this.calculateParts()}},{key:"reSample",value:function(t,e){var o=[];if(null==t||e<0)return o;var i=t.length;if(i>2){var l=new SuperMapAlgoPlot.Point(0,0),n=0,a=0,s=0,r=2*Math.PI;l=t[0],o.push(l);for(var u=!1,p=!1,h=!1,c=1;c<i;c++)if(a=Math.sqrt((t[c].y-l.y)*(t[c].y-l.y)+(t[c].x-l.x)*(t[c].x-l.x)),SuperMapAlgoPlot.PlottingUtil.equalFuzzy(0,a))u&&(l=t[c-1],c--,o.push(l),s=0,r=2*Math.PI,u=!1,p=!1,h=!1);else{var g=(t[c].x-l.x)/a,y=(t[c].y-l.y)/a;if(n=y>0||SuperMapAlgoPlot.PlottingUtil.equalFuzzy(0,y)?Math.acos(g):2*Math.PI-Math.acos(g),r>2*Math.PI&&n+2*Math.PI<r?(n+=2*Math.PI,s<0&&(s+=2*Math.PI)):s<0&&n-2*Math.PI>s&&(n-=2*Math.PI,r>2*Math.PI&&(r-=2*Math.PI)),n>s&&n<r||SuperMapAlgoPlot.PlottingUtil.equalFuzzy(0,n-s)||SuperMapAlgoPlot.PlottingUtil.equalFuzzy(0,n-r)){var f=Math.atan(e/a);p?s<n-f&&(s=n-f):(p=!0,s=n-f),h?r>n+f&&(r=n+f):(h=!0,r=n+f),u=!0}else l=t[c-1],c--,o.push(l),s=0,r=2*Math.PI,u=!1,p=!1,h=!1}return o.push(t[i-1]),o}return o}},{key:"reSampleByAngle",value:function(t,e){var o=[],i=t.length;if(null==t||i<=0||e<=0)return o;for(var l=t,n=i,a=!1;SuperMapAlgoPlot.PlottingUtil.equalFuzzy(l[0].x,l[n-1].x)&&SuperMapAlgoPlot.PlottingUtil.equalFuzzy(l[0].y,l[n-1].y);){if((n-=1)<=0)return o;a=!0}var s,r,u=[];for(s=0;s<n;s++)u.push(0);for(u[0]=1,u[n-1]=1,r=0,s=1;s<n-1;s++)if(SuperMapAlgoPlot.PlottingUtil.distance(l[r],l[s])>1e-10&&SuperMapAlgoPlot.PlottingUtil.distance(l[r],l[s+1])>1e-10){var p=180*SuperMapAlgoPlot.PlottingUtil.InnerAngle(l[s],l[r],l[s+1])/Math.PI;p>e&&p<180-e&&(u[s]=1,r++)}var h=0;for(s=0;s<n;s++)1==u[s]&&h++;if(h>0){for(a&&h++,o=[],r=0,s=0;s<n;s++)1==u[s]&&(o[r++]=l[s]);return a&&(o[r]=o[0]),o}return o}}]),e}();SuperMapAlgoPlot.FreeCurve=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.CombinationalCircle=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return o.angleRange=[],o.defaultRadius=t.defaultRadius?t.defaultRadius:60,o.CLASS_NAME="SuperMapAlgoPlot.CombinationalCircle",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol),i(e,[{key:"calculateParts",value:function(){if(this.init(),this.controlPoints=SuperMapAlgoPlot.PlottingUtil.clearSamePts(this.controlPoints),!(null==this.controlPoints||this.controlPoints.length<1)){var t=this.getCircleLonLat(this.controlPoints[0],this.defaultRadius);this.angleRange=[];for(var e=0;e<this.controlPoints.length;e++)null==this.scaleValues[e]&&(this.scaleValues[e]=t),this.angleRange.push([{Start:0,End:360}]);for(var o=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints),i=0;i<o.length;i++)if(0!==this.angleRange[i].length&&(0!==this.angleRange[i][0].Start||0!==this.angleRange[i][0].End))for(var l=i+1;l<o.length;l++)if(0!==this.angleRange[l].length&&(0!==this.angleRange[l][0].Start||0!==this.angleRange[l][0].End)){var n=SuperMapAlgoPlot.PlottingUtil.distance(o[i],o[l]);if(n<this.scaleValues[i]+this.scaleValues[l])if(n>Math.abs(this.scaleValues[i]-this.scaleValues[l]))for(var a=0;a<2;a++){var s,r,u;0==a?(u=i,s=SuperMapAlgoPlot.PlottingUtil.radian(o[i],o[l])*SuperMapAlgoPlot.PlottingUtil.RTOD,r=Math.acos((n*n+this.scaleValues[i]*this.scaleValues[i]-this.scaleValues[l]*this.scaleValues[l])/(2*n*this.scaleValues[i]))*SuperMapAlgoPlot.PlottingUtil.RTOD):(u=l,s=SuperMapAlgoPlot.PlottingUtil.radian(o[l],o[i])*SuperMapAlgoPlot.PlottingUtil.RTOD,r=Math.acos((n*n+this.scaleValues[l]*this.scaleValues[l]-this.scaleValues[i]*this.scaleValues[i])/(2*n*this.scaleValues[l]))*SuperMapAlgoPlot.PlottingUtil.RTOD);var p=s-r,h=s+r,c=p<0&&h>0||p>360||h>360;p=this.adjustAngle(p),h=this.adjustAngle(h);for(var g=this.angleRange[u].length-1;g>=0;g--)if(c){if(h>this.angleRange[u][g].End||SuperMapAlgoPlot.PlottingUtil.equalFuzzy(h,this.angleRange[u][g].End)){this.angleRange[u].splice(g,1);continue}if(h>this.angleRange[u][g].Start&&(this.angleRange[u][g].Start=h),p<this.angleRange[u][g].Start||SuperMapAlgoPlot.PlottingUtil.equalFuzzy(p,this.angleRange[u][g].Start)){this.angleRange[u].splice(g,1);continue}p<this.angleRange[u][g].End&&(this.angleRange[u][g].End=p)}else if(p<this.angleRange[u][g].Start&&h>this.angleRange[u][g].End)this.angleRange[u].splice(g,1);else if(p>this.angleRange[u][g].Start&&h<this.angleRange[u][g].End)this.angleRange[u].push({Start:this.angleRange[u][g].Start,End:p}),this.angleRange[u].push({Start:h,End:this.angleRange[u][g].End}),this.angleRange[u].splice(g,1);else{if(p>this.angleRange[u][g].End)continue;if(p>this.angleRange[u][g].Start&&(this.angleRange[u][g].End=p),h<this.angleRange[u][g].Start)continue;h<this.angleRange[u][g].End&&(this.angleRange[u][g].Start=h)}}else{if(this.scaleValues[i]<this.scaleValues[l]){this.angleRange[i][0].Start=0,this.angleRange[i][0].End=0;break}this.angleRange[l][0].Start=0,this.angleRange[l][0].End=0}}for(var y=[],f=0;f<o.length;f++)if(0!==this.angleRange[f].length&&(0!==this.angleRange[f][0].Start||0!==this.angleRange[f][0].End))for(var P=this.angleRange[f].length-1;P>=0;P--){for(var d=this.adjustAngle(this.angleRange[f][P].Start),S=this.adjustAngle(this.angleRange[f][P].End);S<d;)S+=360;if(S-d==360)this.addCell(SuperMapAlgoPlot.SymbolType.CIRCLESYMBOL,[o[f],new SuperMapAlgoPlot.Point(o[f].x,o[f].y+this.scaleValues[f])]);else{for(var m=[],b=(S-d)/72,L=d;L<S+b/2;L+=b){var v=o[f].x+this.scaleValues[f]*Math.cos(L*SuperMapAlgoPlot.PlottingUtil.DTOR),M=o[f].y+this.scaleValues[f]*Math.sin(L*SuperMapAlgoPlot.PlottingUtil.DTOR);m.push(new SuperMapAlgoPlot.Point(v,M))}this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,m),y.push(m)}}for(var A=[];0!==y.length;){var T=y[0];y.splice(0,1),void 0!==(T=this.generatePolygon(y,T))&&A.push(T)}for(var _=[],O=0;O<A.length;O++)_.push(A[O]);for(var x=_.length-1;x>=0;x--)for(var w=0;w<_[x].length;w++){for(var E in _)if(parseInt(E)!==x){var C=_[E];if(SuperMapAlgoPlot.PlottingUtil.ptIsInPolygon(C,_[x][w])){var I=x,D=parseInt(E);_[D].push(_[D][0]),_[I].push(_[I][0]),_[D]=_[D].concat(_[I]),_.splice(I,1);break}}if(!isNaN(I)&&!isNaN(D))break}for(var R=0;R<_.length;R++){var N={type:SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,positionPoints:_[R],style:{surroundLineFlag:!1,lineWidthLimit:!0,weight:0,strokeWidth:0}};this.components.splice(0,0,N)}for(var U=0;U<o.length;U++){var B=new SuperMapAlgoPlot.Point(o[U].x+this.scaleValues[U],o[U].y);B.isScalePoint=!0,B.tag=U,this.addScalePoint(B)}}}},{key:"generatePolygon",value:function(t,e){if(0===t.length||SuperMapAlgoPlot.PlottingUtil.equalFuzzy(e[0].x,e[e.length-1].x,1e-7)&&SuperMapAlgoPlot.PlottingUtil.equalFuzzy(e[0].y,e[e.length-1].y,1e-7))return e;for(var o,i=e[e.length-1],l=0;l<t.length;l++)if(SuperMapAlgoPlot.PlottingUtil.equalFuzzy(t[l][0].x,i.x,1e-7)&&SuperMapAlgoPlot.PlottingUtil.equalFuzzy(t[l][0].y,i.y,1e-7)){if(e=e.concat(t[l]),t.splice(l,1),void 0!==(o=this.generatePolygon(t,e))&&0!==o.length)return o}else if(SuperMapAlgoPlot.PlottingUtil.equalFuzzy(t[l][t[l].length-1].x,i.x,1e-7)&&SuperMapAlgoPlot.PlottingUtil.equalFuzzy(t[l][t[l].length-1].y,i.y,1e-7)){for(var n=t[l].length-1;n>=0;n--)e.push(t[l][n]);if(t.splice(l,1),void 0!==(o=this.generatePolygon(t,e))&&0!==o.length)return o}}},{key:"modifyPoint",value:function(t,e){if(!0===e.isScalePoint){if(t<0||t>=this.controlPoints.length)return;var o=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints),i=SuperMapAlgoPlot.PlottingUtil.distance(o[t],e);this.scaleValues[t]=i}this.calculateParts()}},{key:"adjustAngle",value:function(t){for(;t>360;)t-=360;for(;t<0;)t+=360;return t}},{key:"getCircleLonLat",value:function(t,e){return null===this.map?2*this.getDefaultSubSymbolSize():this.map&&"undefined"!=typeof L&&void 0!==L.Map&&this.map instanceof L.Map?((o=this.map.latLngToLayerPoint(L.latLng(t.y,t.x))).x+=e,this.map.layerPointToLatLng(L.point(o.x,o.y)).lng-t.x):this.map&&"undefined"!=typeof SuperMap&&void 0!==SuperMap.Map&&this.map instanceof SuperMap.Map?((o=this.map.getPixelFromLonLat(new SuperMap.LonLat(t.x,t.y))).x+=e,this.map.getLonLatFromPixel(new SuperMap.Pixel(o.x,o.y)).lon-t.x):void 0;var o}}]),e}();SuperMapAlgoPlot.CombinationalCircle=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.ConcentricCircle=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return void 0===o.scaleValues[0]&&(o.scaleValues[0]=0),void 0===o.scaleValues[1]&&(o.scaleValues[1]=360),o.CLASS_NAME="SuperMapAlgoPlot.ConcentricCircle",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol),i(e,[{key:"calculateParts",value:function(){this.init();var t=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);if(!(null==(t=SuperMapAlgoPlot.PlottingUtil.clearSamePts(t))||t.length<2)){for(2==t.length&&t.push(t[1].clone());this.scaleValues[0]>360;)this.scaleValues[0]-=360;for(;this.scaleValues[0]<0;)this.scaleValues[0]+=360;for(;this.scaleValues[1]>360;)this.scaleValues[1]-=360;for(;this.scaleValues[1]<0;)this.scaleValues[1]+=360;for(;this.scaleValues[1]<=this.scaleValues[0];)this.scaleValues[1]+=360;SuperMapAlgoPlot.PlottingUtil.equalFuzzy(this.scaleValues[1],this.scaleValues[0])&&(this.scaleValues[1]+=360);for(var e=SuperMapAlgoPlot.PlottingUtil.distance(t[0],t[1]),o=SuperMapAlgoPlot.PlottingUtil.distance(t[0],t[2]),i=[],l=[],n=Math.PI/180,a=(this.scaleValues[1]-this.scaleValues[0])/72,s=this.scaleValues[0];s<this.scaleValues[1]+a/2;s+=a){var r=t[0].x+e*Math.cos(s*n),u=t[0].y+e*Math.sin(s*n),p=t[0].x+o*Math.cos(s*n),h=t[0].y+o*Math.sin(s*n);i.push(new SuperMapAlgoPlot.Point(r,u)),l.push(new SuperMapAlgoPlot.Point(p,h))}for(var c=[],g=0;g<i.length;g++)c.push(i[g]);for(var y=l.length-1;y>=0;y--)c.push(l[y]);this.addCell(SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,c,{surroundLineFlag:!1,lineWidthLimit:!0,weight:0,strokeWidth:0}),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,i),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,l);var f=t[0].x+e/2*Math.cos(this.scaleValues[0]*n),P=t[0].y+e/2*Math.sin(this.scaleValues[0]*n),d=t[0].x+o/2*Math.cos(this.scaleValues[1]*n),S=t[0].y+o/2*Math.sin(this.scaleValues[1]*n),m=new SuperMapAlgoPlot.Point(f,P);m.isScalePoint=!0,m.tag=0,this.addScalePoint(m);var b=new SuperMapAlgoPlot.Point(d,S);b.isScalePoint=!0,b.tag=1,this.addScalePoint(b)}}},{key:"modifyPoint",value:function(t,e){if(!0===e.isScalePoint){for(var o=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints),i=180*SuperMapAlgoPlot.PlottingUtil.radian(o[0],e)/Math.PI;i>360;)i-=360;for(;i<0;)i+=360;0==t?this.scaleValues[0]=i:1==t&&(this.scaleValues[1]=i)}this.calculateParts()}}]),e}();SuperMapAlgoPlot.ConcentricCircle=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.SymbolTextBox=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return o.roundBox=!!t.roundBox&&t.roundBox,o.textBoxType=t.textBoxType?t.textBoxType:SuperMapAlgoPlot.TextBoxType.WITHTIPBOX,0===o.scaleValues.length&&(o.scaleValues.push(.126),o.scaleValues.push(0),o.scaleValues.push(0)),o.CLASS_NAME="SuperMapAlgoPlot.SymbolTextBox",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol),i(e,[{key:"destroy",value:function(){this.roundBox=null,this.textBoxType=null,function t(e,o,i){null===e&&(e=Function.prototype);var l=Object.getOwnPropertyDescriptor(e,o);if(void 0===l){var n=Object.getPrototypeOf(e);return null===n?void 0:t(n,o,i)}if("value"in l)return l.value;var a=l.get;return void 0!==a?a.call(i):void 0}(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}},{key:"calculateParts",value:function(){this.init();var t=this.scaleValues[0];if(!(t<0||t>1)){if(t=(1-t)/2,this.controlPoints.length>=this.minEditPts){var e,o,i,l;this.scalePoints=[];var n=[];this.controlPoints[0].x<this.controlPoints[1].x?(e=this.controlPoints[0].x,i=this.controlPoints[1].x):(e=this.controlPoints[1].x,i=this.controlPoints[0].x),this.controlPoints[0].y<this.controlPoints[1].y?(l=this.controlPoints[0].y,o=this.controlPoints[1].y):(l=this.controlPoints[1].y,o=this.controlPoints[0].y);var a=1,s=2,r=3,u=4;if(this.roundBox){var p=Math.max(e,i),h=Math.min(e,i),c=Math.max(o,l),g=Math.min(o,l),y=.1*Math.min(Math.abs(e-i),Math.abs(o-l)),f=new SuperMapAlgoPlot.Point(h+y,g+y),P=new SuperMapAlgoPlot.Point(h+y,c-y),d=new SuperMapAlgoPlot.Point(p-y,c-y),S=new SuperMapAlgoPlot.Point(p-y,g+y),m=this.calculateArc(f,y,3*Math.PI/2,Math.PI,-1,180),b=this.calculateArc(P,y,Math.PI,Math.PI/2,-1,180),L=this.calculateArc(d,y,Math.PI/2,0,-1,180),v=this.calculateArc(S,y,2*Math.PI,3*Math.PI/2,-1,180);a=m.length,s=m.length+b.length,r=m.length+b.length+L.length,u=m.length+b.length+L.length+v.length,n=m.concat(b,L,v)}else n.push(new SuperMapAlgoPlot.Point(e,l)),n.push(new SuperMapAlgoPlot.Point(e,o)),n.push(new SuperMapAlgoPlot.Point(i,o)),n.push(new SuperMapAlgoPlot.Point(i,l));this.isEdit||(this.scaleValues[1]=e+.1*(i-e),this.scaleValues[2]=l+-.3*(o-l));var M=new SuperMapAlgoPlot.Point(this.scaleValues[1],this.scaleValues[2]),A=this.getAction(this.scaleValues[1],this.scaleValues[2],e,o,i,l);if(this.textBoxType===SuperMapAlgoPlot.TextBoxType.WITHTIPBOX)switch(this.addScalePoint(M,0),A){case 0:break;case 1:this.addScalePoint(new SuperMapAlgoPlot.Point(e,o-(o-l)*t)),n.splice(a,0,new SuperMapAlgoPlot.Point(e,o-(o-l)*t)),n.splice(a,0,M),n.splice(a,0,new SuperMapAlgoPlot.Point(e,l+(o-l)*t));break;case 2:this.addScalePoint(new SuperMapAlgoPlot.Point(i-(i-e)*t,o)),n.splice(s,0,new SuperMapAlgoPlot.Point(i-(i-e)*t,o)),n.splice(s,0,M),n.splice(s,0,new SuperMapAlgoPlot.Point(e+(i-e)*t,o));break;case 3:this.addScalePoint(new SuperMapAlgoPlot.Point(i,o-(o-l)*t)),n.splice(r,0,new SuperMapAlgoPlot.Point(i,l+(o-l)*t)),n.splice(r,0,M),n.splice(r,0,new SuperMapAlgoPlot.Point(i,o-(o-l)*t));break;case 4:this.addScalePoint(new SuperMapAlgoPlot.Point(i-(i-e)*t,l)),n.splice(u,0,new SuperMapAlgoPlot.Point(e+(i-e)*t,l)),n.splice(u,0,M),n.splice(u,0,new SuperMapAlgoPlot.Point(i-(i-e)*t,l))}if(0!==n.length)if(this.textBoxType===SuperMapAlgoPlot.TextBoxType.NONEBOX){this.addCell(SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,n,{surroundLineFlag:!1,weight:0,lineWidthLimit:!0})}else this.addCell(SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,n)}else this.controlPoints.length>=2&&this.controlPoints.length<this.minEditPts&&this.addCell(SuperMapAlgoPlot.SymbolType.RECTANGLESYMBOL,this.controlPoints);this.annotationContent(e,o,i,l),this.finish()}}},{key:"modifyPoint",value:function(t,e){if(!0===e.isScalePoint)if(0===t)this.scaleValues[1]=e.x,this.scaleValues[2]=e.y;else if(1===t){var o,i,l,n,a,s,r=this.scalePoints[0];this.controlPoints[0].x<this.controlPoints[1].x?(o=this.controlPoints[0].x,l=this.controlPoints[1].x):(o=this.controlPoints[1].x,l=this.controlPoints[0].x),this.controlPoints[0].y<this.controlPoints[1].y?(n=this.controlPoints[0].y,i=this.controlPoints[1].y):(n=this.controlPoints[1].y,i=this.controlPoints[0].y),a=this.scaleValues[1],s=this.scaleValues[2];var u=(i-n)/(l-o),p=.25;switch(a<o?s>i?Math.abs((s-i)/(a-o))>u?2:1:s<n&&Math.abs((s-n)/(a-o))>u?4:1:a>l?s>i?Math.abs((s-i)/(a-l))>u?2:3:s<n&&Math.abs((s-n)/(a-l))>u?4:3:s>i?2:s<n?4:0){case 1:case 3:var h=r.y+(e.y-r.y);h>i&&(h=i),h<(i+n)/2&&(h=(i+n)/2),p=1-2*(i-h)/(i-n);break;case 2:case 4:var c=r.x+(e.x-r.x);c>l&&(c=l),c<(o+l)/2&&(c=(o+l)/2),p=1-2*(l-c)/(l-o)}p<0&&(p=0),p>1&&(p=1),this.scaleValues[0]=p}this.calculateParts()}},{key:"calculateArc",value:function(t,e,o,i,l,n){(!l||1!=l&&-1!=l)&&(l=-1),n||(n=360);for(var a=Math.PI/n/2,s=a*l,r=Math.abs(i-o),u=[],p=o,h=0;h<r;h+=a){var c=new SuperMapAlgoPlot.Point(Math.cos(p)*e+t.x,Math.sin(p)*e+t.y);u.push(c),p=(p=(p+=s)<0?p+2*Math.PI:p)>2*Math.PI?p-2*Math.PI:p}return u}},{key:"getAction",value:function(t,e,o,i,l,n){var a=(i-n)/(l-o);return t<o?e>i?Math.abs((e-i)/(t-o))>a?2:1:e<n&&Math.abs((e-n)/(t-o))>a?4:1:t>l?e>i?Math.abs((e-i)/(t-l))>a?2:3:e<n&&Math.abs((e-n)/(t-l))>a?4:3:e>i?2:e<n?4:0}}]),e}();SuperMapAlgoPlot.SymbolTextBox=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.GeoTooltipBoxM=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return 0===o.scaleValues.length&&(o.scaleValues.push(0),o.scaleValues.push(0),o.scaleValues.push(0),o.scaleValues.push(0)),o.CLASS_NAME="SuperMapAlgoPlot.GeoTooltipBoxM",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol),i(e,[{key:"destroy",value:function(){(function t(e,o,i){null===e&&(e=Function.prototype);var l=Object.getOwnPropertyDescriptor(e,o);if(void 0===l){var n=Object.getPrototypeOf(e);return null===n?void 0:t(n,o,i)}if("value"in l)return l.value;var a=l.get;return void 0!==a?a.call(i):void 0})(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destory",this).call(this)}},{key:"calculateParts",value:function(){this.init();var t=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);if((t=SuperMapAlgoPlot.PlottingUtil.clearSamePts(t)).length>=this.minEditPts){var e,o,i,l;t[0].x<t[1].x?(e=t[0].x,i=t[1].x):(e=t[1].x,i=t[0].x),t[0].y<t[1].y?(l=t[0].y,o=t[1].y):(l=t[1].y,o=t[0].y),this.scalePoints=[];var n=[];n.push(new SuperMapAlgoPlot.Point(e,l)),n.push(new SuperMapAlgoPlot.Point(e,o)),n.push(new SuperMapAlgoPlot.Point(i,o)),n.push(new SuperMapAlgoPlot.Point(i,l)),this.isEdit||(this.scaleValues[0]=e,this.scaleValues[1]=l-.3*(o-l),this.scaleValues[2]=e+.5*(i-e),this.scaleValues[3]=l-.3*(o-l));for(var a=[],s=[],r=0;r<this.scaleValues.length/2;r++)a.push(this.getAction(this.scaleValues[2*r],this.scaleValues[2*r+1],e,o,i,l)),s.push(new SuperMapAlgoPlot.Point(this.scaleValues[2*r],this.scaleValues[2*r+1]));for(var u,p,h,c,g=s.length,y=[],f=[],P=[],d=[],S=[],m=0;m<a.length;m++)0===a[m]&&y.push(s[m]),1===a[m]&&f.push(s[m]),2===a[m]&&P.push(s[m]),3===a[m]&&d.push(s[m]),4===a[m]&&S.push(s[m]);var b=a.slice();b.sort();var L=new SuperMapAlgoPlot.Point(0,0);if(b[0]===b[b.length-1]&&0!==b[0]){var v=[];switch(b[0]){case 0:break;case 1:u=1/(2*f.length+1);for(var M=new SuperMapAlgoPlot.Point,A=0;A<2*f.length;A++)M=new SuperMapAlgoPlot.Point(e,l+(o-l)*u*(A+1)),v.unshift(M);break;case 2:p=1/(2*P.length+1);for(var T=new SuperMapAlgoPlot.Point,_=0;_<2*P.length;_++)T=new SuperMapAlgoPlot.Point(e+(i-e)*p*(_+1),o),v.unshift(T);break;case 3:h=1/(2*d.length+1);for(var O=new SuperMapAlgoPlot.Point,x=0;x<2*d.length;x++)O=new SuperMapAlgoPlot.Point(i,l+(o-l)*h*(x+1)),v.push(O);break;case 4:c=1/(2*S.length+1);for(var w=new SuperMapAlgoPlot.Point,E=0;E<2*S.length;E++)w=new SuperMapAlgoPlot.Point(e+(i-e)*c*(E+1),l),v.push(w)}for(var C=0;C<g;C++)for(var I=0;I<g;I++){var D=SuperMapAlgoPlot.PlottingUtil.intersectLineSegs(v[2*C+1],s[C],v[2*I],s[I],L);if(D&&SuperMapAlgoPlot.PlottingUtil.equalFuzzy(L.x,v[2*C+1].x)&&SuperMapAlgoPlot.PlottingUtil.equalFuzzy(L.y,v[2*C+1].y)&&(D=!1),D){var R=s[I].clone();s[I]=s[C],s[C]=R}}for(var N=0;N<g;N++)n.splice(b[0],0,v[2*N]),n.splice(b[0],0,s[N]),n.splice(b[0],0,v[2*N+1])}else{for(var U,B,k=[],F=[],G=[],V=[],j=0;j<a.length;j++)switch(a[j]){case 0:break;case 1:u=1/(2*f.length+1);for(var Y=0;Y<2*f.length;Y++){var z=new SuperMapAlgoPlot.Point(e,l+(o-l)*u*(Y+1));k.unshift(z)}for(var W=0;W<f.length;W++)for(var X=1;X<f.length;X++)(U=SuperMapAlgoPlot.PlottingUtil.intersectLineSegs(k[2*W+1],f[W],k[2*X],f[X],L))&&SuperMapAlgoPlot.PlottingUtil.equalFuzzy(L.x,k[2*W+1].x)&&SuperMapAlgoPlot.PlottingUtil.equalFuzzy(L.y,k[2*W+1].y)&&(U=!1),U&&(B=f[X].clone(),f[X]=f[W],f[W]=B);break;case 2:p=1/(2*P.length+1);for(var H=0;H<2*P.length;H++){var Z=new SuperMapAlgoPlot.Point(e+(i-e)*p*(H+1),o);F.unshift(Z)}for(var J=0;J<P.length;J++)for(var q=1;q<P.length;q++)(U=SuperMapAlgoPlot.PlottingUtil.intersectLineSegs(F[2*J+1],P[J],F[2*q],P[q],L))&&SuperMapAlgoPlot.PlottingUtil.equalFuzzy(L.x,F[2*J+1].x)&&SuperMapAlgoPlot.PlottingUtil.equalFuzzy(L.y,F[2*J+1].y)&&(U=!1),U&&(B=P[q].clone(),P[q]=P[J],P[J]=B);break;case 3:h=1/(2*d.length+1);for(var K=0;K<2*d.length;K++){var Q=new SuperMapAlgoPlot.Point(i,l+(o-l)*h*(K+1));G.push(Q)}for(var $=0;$<d.length;$++)for(var tt=1;tt<d.length;tt++)(U=SuperMapAlgoPlot.PlottingUtil.intersectLineSegs(G[2*$+1],d[$],G[2*tt],d[tt],L))&&SuperMapAlgoPlot.PlottingUtil.equalFuzzy(L.x,G[2*$+1].x)&&SuperMapAlgoPlot.PlottingUtil.equalFuzzy(L.y,G[2*$+1].y)&&(U=!1),U&&(B=d[tt].clone(),d[tt]=d[$],d[$]=B);break;case 4:c=1/(2*S.length+1);for(var et=0;et<2*S.length;et++){var ot=new SuperMapAlgoPlot.Point(e+(i-e)*c*(et+1),l);V.push(ot)}for(var it=0;it<S.length;it++)for(var lt=1;lt<S.length;lt++)(U=SuperMapAlgoPlot.PlottingUtil.intersectLineSegs(V[2*it+1],S[it],V[2*lt],S[lt],L))&&SuperMapAlgoPlot.PlottingUtil.equalFuzzy(L.x,V[2*it+1].x)&&SuperMapAlgoPlot.PlottingUtil.equalFuzzy(L.y,V[2*it+1].y)&&(U=!1),U&&(B=S[lt].clone(),S[lt]=S[it],S[it]=B)}for(var nt=0;nt<S.length;nt++)n.splice(4,0,V[2*nt]),n.splice(4,0,S[nt]),n.splice(4,0,V[2*nt+1]);for(var at=0;at<d.length;at++)n.splice(3,0,G[2*at]),n.splice(3,0,d[at]),n.splice(3,0,G[2*at+1]);for(var st=0;st<P.length;st++)n.splice(2,0,F[2*st]),n.splice(2,0,P[st]),n.splice(2,0,F[2*st+1]);for(var rt=0;rt<f.length;rt++)n.splice(1,0,k[2*rt]),n.splice(1,0,f[rt]),n.splice(1,0,k[2*rt+1])}for(var ut=0;ut<s.length;ut++)this.addScalePoint(s[ut],ut)}this.addCell(SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,n),this.annotationContent(e,o,i,l),this.finish()}},{key:"modifyPoint",value:function(t,e){!0===e.isScalePoint&&(null==t&&void 0===t||(this.scaleValues[2*t]=e.x,this.scaleValues[2*t+1]=e.y)),this.calculateParts()}},{key:"getAction",value:function(t,e,o,i,l,n){var a=(i-n)/(l-o);return t<o?e>i?Math.abs((e-i)/(t-o))>a?2:1:e<n&&Math.abs((e-n)/(t-o))>a?4:1:t>l?e>i?Math.abs((e-i)/(t-l))>a?2:3:e<n&&Math.abs((e-n)/(t-l))>a?4:3:e>i?2:e<n?4:0}}]),e}();SuperMapAlgoPlot.GeoTooltipBoxM=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.GeoTooltipBox=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return 0===o.scaleValues.length&&o.scaleValues.push(.126),o.CLASS_NAME="SuperMapAlgoPlot.GeoTooltipBox",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol),i(e,[{key:"destroy",value:function(){(function t(e,o,i){null===e&&(e=Function.prototype);var l=Object.getOwnPropertyDescriptor(e,o);if(void 0===l){var n=Object.getPrototypeOf(e);return null===n?void 0:t(n,o,i)}if("value"in l)return l.value;var a=l.get;return void 0!==a?a.call(i):void 0})(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}},{key:"calculateParts",value:function(){this.init();var t=this.scaleValues[0];if(!(t<0||t>1)){if(t=(1-t)/2,this.controlPoints.length>=this.minEditPts){var e,o,i,l,n,a;this.controlPoints[2]&&(this.controlPoints[2].isFixedPos=!0),this.controlPoints[0].x<this.controlPoints[1].x?(e=this.controlPoints[0].x,i=this.controlPoints[1].x):(e=this.controlPoints[1].x,i=this.controlPoints[0].x),this.controlPoints[0].y<this.controlPoints[1].y?(l=this.controlPoints[0].y,o=this.controlPoints[1].y):(l=this.controlPoints[1].y,o=this.controlPoints[0].y),n=this.controlPoints[2].x,a=this.controlPoints[2].y;var s=0,r=(o-l)/(i-e);s=n<e?a>o?Math.abs((a-o)/(n-e))>r?2:1:a<l&&Math.abs((a-l)/(n-e))>r?4:1:n>i?a>o?Math.abs((a-o)/(n-i))>r?2:3:a<l&&Math.abs((a-l)/(n-i))>r?4:3:a>o?2:a<l?4:0,this.scalePoints=[];var u=[];switch(u.push(new SuperMapAlgoPlot.Point(e,l)),u.push(new SuperMapAlgoPlot.Point(e,o)),u.push(new SuperMapAlgoPlot.Point(i,o)),u.push(new SuperMapAlgoPlot.Point(i,l)),s){case 0:break;case 1:this.addScalePoint(new SuperMapAlgoPlot.Point(e,o-(o-l)*t)),u.splice(s,0,new SuperMapAlgoPlot.Point(e,o-(o-l)*t)),u.splice(s,0,this.controlPoints[2].clone()),u.splice(s,0,new SuperMapAlgoPlot.Point(e,l+(o-l)*t));break;case 2:this.addScalePoint(new SuperMapAlgoPlot.Point(i-(i-e)*t,o)),u.splice(s,0,new SuperMapAlgoPlot.Point(i-(i-e)*t,o)),u.splice(s,0,this.controlPoints[2].clone()),u.splice(s,0,new SuperMapAlgoPlot.Point(e+(i-e)*t,o));break;case 3:this.addScalePoint(new SuperMapAlgoPlot.Point(i,o-(o-l)*t)),u.splice(s,0,new SuperMapAlgoPlot.Point(i,l+(o-l)*t)),u.splice(s,0,this.controlPoints[2].clone()),u.splice(s,0,new SuperMapAlgoPlot.Point(i,o-(o-l)*t));break;case 4:this.addScalePoint(new SuperMapAlgoPlot.Point(i-(i-e)*t,l)),u.splice(s,0,new SuperMapAlgoPlot.Point(e+(i-e)*t,l)),u.splice(s,0,this.controlPoints[2].clone()),u.splice(s,0,new SuperMapAlgoPlot.Point(i-(i-e)*t,l))}this.addCell(SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,u),this.annotationContent(e,o,i,l)}this.finish()}}},{key:"modifyPoint",value:function(t,e){if(!0===e.isScalePoint&&0==t){var o,i,l,n,a,s,r=this.scalePoints[0];this.controlPoints[0].x<this.controlPoints[1].x?(o=this.controlPoints[0].x,l=this.controlPoints[1].x):(o=this.controlPoints[1].x,l=this.controlPoints[0].x),this.controlPoints[0].y<this.controlPoints[1].y?(n=this.controlPoints[0].y,i=this.controlPoints[1].y):(n=this.controlPoints[1].y,i=this.controlPoints[0].y),a=this.controlPoints[2].x,s=this.controlPoints[2].y;var u=(i-n)/(l-o),p=.25;switch(a<o?s>i?Math.abs((s-i)/(a-o))>u?2:1:s<n&&Math.abs((s-n)/(a-o))>u?4:1:a>l?s>i?Math.abs((s-i)/(a-l))>u?2:3:s<n&&Math.abs((s-n)/(a-l))>u?4:3:s>i?2:s<n?4:0){case 1:case 3:var h=r.y+(e.y-r.y);h>i&&(h=i),h<(i+n)/2&&(h=(i+n)/2),p=1-2*(i-h)/(i-n);break;case 2:case 4:var c=r.x+(e.x-r.x);c>l&&(c=l),c<(o+l)/2&&(c=(o+l)/2),p=1-2*(l-c)/(l-o)}p<0&&(p=0),p>1&&(p=1),this.scaleValues[0]=p}this.calculateParts()}}]),e}();SuperMapAlgoPlot.GeoTooltipBox=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.Trapezoid=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return o.CLASS_NAME="SuperMapAlgoPlot.Trapezoid",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol),i(e,[{key:"calculateParts",value:function(){this.init();var t=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);if((t=SuperMapAlgoPlot.PlottingUtil.clearSamePts(t)).length>=2&&t.length<this.minEditPts&&this.calAssistantLine(),!(t.length<this.minEditPts)){var e=[],o=t[0],i=t[1],l=t[2],n=new SuperMapAlgoPlot.Point(0,0);this.GetPointsByTrapezoid(1,l,i,o,n),e.push(o),e.push(i),e.push(l),e.push(n);var a=SuperMapAlgoPlot.PlottingUtil.intersectLines(o,i,l,n),s=a.intersectPoint;a.isIntersectLines&&(s.x>o.x&&s.x<i.x||s.y>o.y&&s.y<i.y||s.x<o.x&&s.x>i.x||s.y<o.y&&s.y>i.y)&&(e[0]=n,e[3]=o),4==e.length&&this.addCell(SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,e)}}},{key:"GetPointsByTrapezoid",value:function(t,e,o,i,l){var n=e.x,a=e.y,s=o.x,r=o.y,u=i.x,p=i.y,h=0,c=0,g=0,y=0;if(SuperMapAlgoPlot.PlottingUtil.equalFuzzy(Math.abs(a-r),0))h=n+s-u,c=p;else if(SuperMapAlgoPlot.PlottingUtil.equalFuzzy(Math.abs(n-s),0))h=u,c=a+r-p;else{var f=1*(a-r)/(n-s),P=p-f*u;c=f*(h=((r+a)/2+(n+s)/(2*f)-P)/(f+1/f))+P,h=2*h-u,c=2*c-p}var d=Math.sqrt(1*(n-s)*(n-s)+1*(a-r)*(a-r)),S=Math.sqrt(1*(n-h)*(n-h)+1*(a-c)*(a-c));d>0?(g=n+(s-n)*S/d,y=a+(r-a)*S/d):(g=n,y=a);var m=g+(h-g)*t,b=y+(c-y)*t;l.x=m,l.y=b}}]),e}();SuperMapAlgoPlot.Trapezoid=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.Brace=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return 0===o.scaleValues.length&&(o.scaleValues.push(.1),o.scaleValues.push(.1)),o.CLASS_NAME="SuperMapAlgoPlot.Brace",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol),i(e,[{key:"calculateParts",value:function(){this.init();var t=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);if(!((t=SuperMapAlgoPlot.PlottingUtil.clearSamePts(t)).length<this.minEditPts)){var e=t[0],o=t[1],i=SuperMapAlgoPlot.PlottingUtil.distance(e,o);this.scaleValues.length<2&&(this.scaleValues=[],this.scaleValues.push(.1),this.scaleValues.push(.1));for(var l=this.scaleValues[0],n=this.scaleValues[1],a=new SuperMapAlgoPlot.Point(i*l,i*l),s=new SuperMapAlgoPlot.Point(i*(.5-n/2),0),r=new SuperMapAlgoPlot.Point(.5*i,-i*n),u=new SuperMapAlgoPlot.Point(i*(.5+n/2),0),p=new SuperMapAlgoPlot.Point(i*(1-l),i*l),h=[],c=180*Math.PI/180,g=270*Math.PI/180,y=3*Math.PI/180,f=c;f<=g;f+=y){var P=new SuperMapAlgoPlot.Point(a.x+i*l,a.y);P=SuperMapAlgoPlot.PlottingUtil.rotateAngle(a,f,P),h.push(P)}h.push(s),h.push(r),h.push(u),c=270*Math.PI/180,g=360*Math.PI/180;for(var d=c;d<=g;d+=y){var S=new SuperMapAlgoPlot.Point(p.x+i*l,p.y);S=SuperMapAlgoPlot.PlottingUtil.rotateAngle(p,d,S),h.push(S)}for(var m=SuperMapAlgoPlot.PlottingUtil.radian(e,o),b=[],L=0;L<h.length;L++){var v=new SuperMapAlgoPlot.Point(h[L].x+e.x,h[L].y+e.y);v=SuperMapAlgoPlot.PlottingUtil.rotateAngle(e,m,v),b.push(v)}this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,b),this.scalePoints=[];var M=new SuperMapAlgoPlot.Point(i*l,0),A=new SuperMapAlgoPlot.Point(M.x+e.x,M.y+e.y);(A=SuperMapAlgoPlot.PlottingUtil.rotateAngle(e,m,A)).isScalePoint=!0,A.tag=0,this.addScalePoint(A);var T=new SuperMapAlgoPlot.Point(r.x+e.x,r.y+e.y);SuperMapAlgoPlot.PlottingUtil.rotateAngle(e,m,T),T.isScalePoint=!0,T.tag=1,this.addScalePoint(T)}}},{key:"modifyPoint",value:function(t,e){if(!0===e.isScalePoint){var o=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints),i=SuperMapAlgoPlot.PlottingUtil.distance(o[0],o[1]);if(0==t){var l=SuperMapAlgoPlot.PlottingUtil.distance(o[0],e)/i;l>0&&l<.4&&(this.scaleValues[0]=l)}else if(1==t){var n=new SuperMapAlgoPlot.Point((o[0].x+o[1].x)/2,(o[0].y+o[1].y)/2),a=SuperMapAlgoPlot.PlottingUtil.distance(e,n)/i;0<a&&.2>a&&(this.scaleValues[1]=a)}}this.calculateParts()}}]),e}();SuperMapAlgoPlot.Brace=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.RegularPolygon=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return 0===o.scaleValues.length&&o.scaleValues.push(1),o.CLASS_NAME="SuperMapAlgoPlot.RegularPolygon",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol),i(e,[{key:"calculateParts",value:function(){if(this.init(),!(this.controlPoints.length<this.minEditPts)){var t=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints),e=this.controlPoints.length+1,o=2*Math.PI/e;if(!this.isEdit){var i=this.controlPoints[this.controlPoints.length-1],l=new SuperMapAlgoPlot.Point(this.controlPoints[this.controlPoints.length-1].x,this.controlPoints[this.controlPoints.length-1].y);SuperMapAlgoPlot.PlottingUtil.rotateAngle(this.controlPoints[0],o,l),this.scaleValues[0]=SuperMapAlgoPlot.PlottingUtil.distance(t[0],this.calculateMidPt(i,l))/SuperMapAlgoPlot.PlottingUtil.distance(t[0],t[t.length-1])}var n=[],a=this.controlPoints[this.controlPoints.length-1].clone();n.push(a.clone()),a=SuperMapAlgoPlot.PlottingUtil.rotateAngle(this.controlPoints[0],o/2,a);var s=SuperMapAlgoPlot.PlottingUtil.findPointOnLineByRatio(this.scaleValues[0],this.controlPoints[0],a);n.push(s);for(var r=1;r<e;r++)a=SuperMapAlgoPlot.PlottingUtil.rotateAngle(this.controlPoints[0],o/2,a),n.push(a.clone()),a=SuperMapAlgoPlot.PlottingUtil.rotateAngle(this.controlPoints[0],o/2,a),s=SuperMapAlgoPlot.PlottingUtil.findPointOnLineByRatio(this.scaleValues[0],this.controlPoints[0],a),n.push(s);var u=n[1];this.addCell(SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,n,{surroundLineFlag:!1,fill:!1}),this.addScalePoint(u),this.finish()}}},{key:"calculateMidPt",value:function(t,e){return new SuperMapAlgoPlot.Point((t.x+e.x)/2,(t.y+e.y)/2)}},{key:"modifyPoint",value:function(t,e){if(0===t&&!0===e.isScalePoint){var o=SuperMapAlgoPlot.PlottingUtil.distance(this.controlPoints[0],this.controlPoints[this.controlPoints.length-1]),i=this.scalePoints[0],l=SuperMapAlgoPlot.PlottingUtil.projectPoint(e,this.controlPoints[0],i),n=SuperMapAlgoPlot.PlottingUtil.distance(this.controlPoints[0],l);this.scaleValues[0]=n/o}this.calculateParts()}}]),e}();SuperMapAlgoPlot.RegularPolygon=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.ArrowLine=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return o.arrowAngle=t.arrowAngle?t.arrowAngle:45,0===o.scaleValues.length&&(o.scaleValues.push(.3),o.scaleValues.push(0),o.scaleValues.push(0)),o.CLASS_NAME="SuperMapAlgoPlot.ArrowLine",o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMapAlgoPlot.AlgoSymbol),i(e,[{key:"calculateParts",value:function(){if(this.init(),!(null==this.controlPoints||this.controlPoints.length<this.minEditPts)){var t=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);t=SuperMapAlgoPlot.PlottingUtil.clearSamePts(t);var e=SuperMapAlgoPlot.PlottingUtil.generateBeizerPointsNoCtrlPt(t);e=SuperMapAlgoPlot.PlottingUtil.clearSamePts(e);var o=SuperMapAlgoPlot.PlottingUtil.polylineDistance(e);this.isEdit||(this.scaleValues[0]=.5*this.getSubSymbolScaleValue(o));var i,l=this.scaleValues[0]*o,n=this.arrowAngle*Math.PI/180/2,a=(i=e.length>2?SuperMapAlgoPlot.PlottingUtil.radian(e[e.length-1],e[e.length-2]):SuperMapAlgoPlot.PlottingUtil.radian(e[1],e[0]))-n,s=e[e.length-1].x+l*Math.cos(a),r=e[e.length-1].y+l*Math.sin(a),u=new SuperMapAlgoPlot.Point(s,r),p=i+n,h=e[e.length-1].x+l*Math.cos(p),c=e[e.length-1].y+l*Math.sin(p),g=new SuperMapAlgoPlot.Point(h,c),y=[];y.push(u),y.push(e[e.length-1].clone()),y.push(g);var f={surroundLineFlag:!1,fillLimit:!0,lineTypeLimit:!0},P=SuperMapAlgoPlot.PlottingUtil.radian(e[0],e[1]);a=P-n,s=e[0].x+l*Math.cos(a),r=e[0].y+l*Math.sin(a),u=new SuperMapAlgoPlot.Point(s,r),p=P+n,h=e[0].x+l*Math.cos(p),c=e[0].y+l*Math.sin(p),g=new SuperMapAlgoPlot.Point(h,c);var d=[];d.push(u),d.push(e[0].clone()),d.push(g);var S=this.scaleValues[1]===SuperMapAlgoPlot.ArrowLineType.DOUBLELINE?SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL:SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,m=this.scaleValues[2]===SuperMapAlgoPlot.ArrowLineType.DOUBLELINE?SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL:SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL;this.scaleValues[1]===SuperMapAlgoPlot.ArrowLineType.DOUBLELINE?this.addCell(S,d,f):this.scaleValues[1]===SuperMapAlgoPlot.ArrowLineType.TRIANGLESOLID&&this.addCell(S,d,f),this.scaleValues[2]===SuperMapAlgoPlot.ArrowLineType.DOUBLELINE?this.addCell(m,y,f):this.scaleValues[2]===SuperMapAlgoPlot.ArrowLineType.TRIANGLESOLID&&this.addCell(m,y,f),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,e),this.finish()}}}]),e}();SuperMapAlgoPlot.ArrowLine=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.AlgoSymbol=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=e||{},this.style=null,this.libID=e.libID?e.libID:0,this.code=e.code?e.code:0,this.maxEditPts=e.maxEditPts?e.maxEditPts:SuperMapAlgoPlot.AlgoSymbolFactory.getMaxEditPts(e.libID,e.code),this.minEditPts=e.minEditPts?e.minEditPts:SuperMapAlgoPlot.AlgoSymbolFactory.getMinEditPts(e.libID,e.code),this.isEdit=!!e.isEdit&&e.isEdit,this.controlPoints=e.controlPoints?e.controlPoints:[],this.scalePoints=e.scalePoints?e.scalePoints:[],this.scaleValues=e.scaleValues?e.scaleValues:[],this.subSymbols=e.subSymbols?e.subSymbols:SuperMapAlgoPlot.AlgoSymbolFactory.getDefaultSubSymbols(e.libID,e.code),this.polylineConnectLocationPoint=!!e.polylineConnectLocationPoint&&e.polylineConnectLocationPoint,this.style=e.style?e.style:SuperMapAlgoPlot.PlottingUtil.copyAttributes(this.style,SuperMapAlgoPlot.AlgoSymbolFactory.getDefaultStyle(e.libID,e.code)),this.textContent=e.textContent?e.textContent:"",this.map=e.map?e.map:null,this.scene=e.scene?e.scene:null,this.subSymbolDefaultPixelSize=e.subSymbolDefaultPixelSize?e.subSymbolDefaultPixelSize:30,this.components=[],this.symbolType=0===this.libID?this.code:2}return i(t,[{key:"addScalePoint",value:function(t,e){if(null!=t){void 0!==e&&null!==e||(e=this.scalePoints.length);var o=new SuperMapAlgoPlot.Point(t.x,t.y);o.isScalePoint=!0,o.tag=e,this.scalePoints.push(o)}}},{key:"setOptions",value:function(t){if(t)for(var e in this)t[e]&&(this[e]=t[e])}},{key:"getAlgorithmResult",value:function(t){t.components=this.components,t.scalePoints=this.scalePoints,t.scaleValues=this.scaleValues}}]),i(t,[{key:"destroy",value:function(){this.minEditPts=null,this.maxEditPts=null,this.controlPoints.length=0,this.controlPoints=null,this.scalePoints.length=0,this.scalePoints=null,this.scaleValues.length=0,this.scaleValues=null,this.subSymbols.length=0,this.subSymbols=null,this.subSymbolSize=0,this.components=null,this.style=null}},{key:"init",value:function(){if(this.components.length=0,this.scalePoints.length=0,this.controlPoints.length>=2&&this.controlPoints.length<this.minEditPts&&this.calAssistantLine(),this.maxEditPts<this.controlPoints.length&&this.symbolType!==SuperMapAlgoPlot.SymbolType.ELLIPSESYMBOL){var t=this.controlPoints.shift(),e=this.controlPoints.pop();this.controlPoints=[],this.controlPoints.push(t,e)}}},{key:"finish",value:function(){}},{key:"calculateParts",value:function(){this.init();var t=SuperMapAlgoPlot.PlottingUtil.clearSamePts(this.controlPoints);if(t=SuperMapAlgoPlot.PlottingUtil.clonePoints(t),this.controlPoints.length>=this.minEditPts){var e={textContent:this.textContent,type:this.symbolType,surroundLineFlag:!1,positionPoints:t,style:{}};if(e.type===SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL&&e.positionPoints.push(e.positionPoints[0]),this.symbolType===SuperMapAlgoPlot.SymbolType.PARALLELLINE){if(this.controlPoints&&this.controlPoints.length>=3){var o=!1;void 0!==this.controlPoints[0].z&&(o=!0);var i=SuperMapAlgoPlot.PlottingUtil.distance(this.controlPoints[0],this.controlPoints[1]);SuperMapAlgoPlot.PlottingUtil.isRight(this.controlPoints[0],this.controlPoints[1],this.controlPoints[2])&&(i=-i);for(var l=[],n=1;n<this.controlPoints.length;n++)l.push(this.controlPoints[n].clone());var a=SuperMapAlgoPlot.PlottingUtil.parallel(l,i);if(this.controlPoints[0].x=a[0].x,this.controlPoints[0].y=a[0].y,o)for(var s=0;s<l.length;s++)a[s].z=l[s].z;this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,l),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,a)}}else this.components.push(e)}}},{key:"modifyPoint",value:function(t,e){this.computeScaleValues(t,e),this.calculateParts()}},{key:"computeScaleValues",value:function(){}},{key:"getLonLatDistanceFromPixel",value:function(t){if(null===this.map)return 0;var e,o;if(this.map&&"undefined"!=typeof L&&void 0!==L.Map&&this.map instanceof L.Map){var i=this.map.layerPointToLatLng(L.point(0,0)),l=this.map.layerPointToLatLng(L.point(t,0));e=new SuperMapAlgoPlot.Point(i.lng,i.lat),o=new SuperMapAlgoPlot.Point(l.lng,l.lat)}else if(this.map&&"undefined"!=typeof SuperMap&&void 0!==SuperMap.Map&&this.map instanceof SuperMap.Map){i=this.map.getLonLatFromPixel(new SuperMap.Pixel(0,0)),l=this.map.getLonLatFromPixel(new SuperMap.Pixel(t,0));e=new SuperMapAlgoPlot.Point(i.lon,i.lat),o=new SuperMapAlgoPlot.Point(l.lon,l.lat)}return SuperMapAlgoPlot.PlottingUtil.distance(e,o)}},{key:"getPixelDistanceFromLonLat",value:function(t){if(null===this.map)return 0;var e,o;if(this.map&&"undefined"!=typeof L&&void 0!==L.Map&&this.map instanceof L.Map){var i=this.map.latLngToLayerPoint(L.latLng(0,0)),l=this.map.latLngToLayerPoint(L.latLng(t,0));e=new SuperMapAlgoPlot.Point(i.x,i.y),o=new SuperMapAlgoPlot.Point(l.x,l.y)}else if(this.map&&"undefined"!=typeof SuperMap&&void 0!==SuperMap.Map&&this.map instanceof SuperMap.Map){i=this.map.getPixelFromLonLat(new SuperMap.LonLat(0,0)),l=this.map.getPixelFromLonLat(new SuperMap.LonLat(t,0));e=new SuperMapAlgoPlot.Point(i.x,i.y),o=new SuperMapAlgoPlot.Point(l.x,l.y)}return SuperMapAlgoPlot.PlottingUtil.distance(e,o)}},{key:"getPixelFromLonLat",value:function(t,e){if(this.map&&"undefined"!=typeof L&&void 0!==L.Map&&this.map instanceof L.Map){var o=this.map.latLngToLayerPoint(L.latLng(e,t));return{x:o.x,y:o.y}}if(this.map&&"undefined"!=typeof SuperMap&&void 0!==SuperMap.Map&&this.map instanceof SuperMap.Map){var i=this.map.getPixelFromLonLat(new SuperMap.LonLat(t,e));return{x:i.x,y:i.y}}}},{key:"getLonLatFromPixel",value:function(t,e){if(this.map&&"undefined"!=typeof L&&void 0!==L.Map&&this.map instanceof L.Map){var o=this.map.layerPointToLatLng(L.point(t,e));return{lon:o.lng,lat:o.lat}}if(this.map&&"undefined"!=typeof SuperMap&&void 0!==SuperMap.Map&&this.map instanceof SuperMap.Map){var i=this.map.getLonLatFromPixel(new SuperMap.Pixel(t,e));return{lon:i.lon,lat:i.lat}}}},{key:"pixelBoundsToLonLat",value:function(t){var e=this.getLonLatFromPixel(t.left,t.top),o=this.getLonLatFromPixel(t.right,t.bottom);return new SuperMap.Bounds(e.lon,o.lat,o.lon,e.lat)}},{key:"annotationContent",value:function(t,e,o,i){var l=this.textContent;if(0!==l.length){var n=l.split("\n");l="";var a=0,s={};SuperMap.Util.copyAttributes(s,this.style),s.fontSize<12&&(s.fontSize=12);for(var r=0;r<n.length;r++){a++;var u=n[r],p=SuperMapAlgoPlot.PlottingUtil.getTextWidth(s,u),h=this.getPixelFromLonLat(t,e),c=this.getPixelFromLonLat(o,i),g=parseFloat(Math.abs(c.x-h.x)),y=parseFloat(Math.abs(h.y-c.y)),f=0;if(s.weight?f=parseFloat(s.fontSize)+2*s.weight+.2*parseFloat(s.fontSize)+a:this.style.strokeWidth&&(f=parseFloat(s.fontSize)+2*s.strokeWidth+.2*parseFloat(s.fontSize)+a),f>y)break;if(p>=g){var P=u.split("");u="";for(var d="",S=P.length,m=0;m<S;m++){if(d+=P[m],SuperMapAlgoPlot.PlottingUtil.getTextWidth(s,d)>=g){var b=P[m];if(P[m]="\n",a++,s.weight?f=parseFloat(s.fontSize)*a+a+2*s.weight+.2*parseFloat(s.fontSize):this.style.strokeWidth&&(f=parseFloat(s.fontSize)*a+a+2*s.strokeWidth+.2*parseFloat(s.fontSize)),!(f<y)){0===l.length?l=u:(l+="\n",l+=u);break}P[m]+=b,d=b}u+=P[m],m===S-1&&(0===l.length?l=u:(l+="\n",l+=u))}}else 0===l.length?l=u:(l+="\n",l+=u)}if(0!==l.length){var L=s.labelAlign,v=0,M=0;"l"===L[0]?v=t:"r"===L[0]?v=o:"c"===L[0]&&(v=(t+o)/2),"t"===L[1]?M=e:"b"===L[1]?M=i:"m"===L[1]&&(M=(e+i)/2);var A=new SuperMapAlgoPlot.Point(v,M),T={};T.positionPoints=[A],T.type=SuperMapAlgoPlot.SymbolType.TEXTSYMBOL,T.textContent=l,T.style={surroundLineFlag:!1,labelAlign:L},this.components.push(T)}}}},{key:"addCell",value:function(t,e,o,i){if(t&&e){var l={};l.type=t,l.textContent=i,l.positionPoints=e,l.style=null==o?{surroundLineFlag:!1}:o,this.components.push(l)}}},{key:"addText",value:function(t,e,o,i,l){if(t&&e){var n={};n.type=SuperMapAlgoPlot.SymbolType.TEXTSYMBOL,n.textContent=t,n.positionPoints=[e];var a=o/t.length/2;n.style={},n.style.surroundLineFlag=!1,n.style.labelRotation=-i,n.style.fontSize=a,void 0===l?n.style.fontColor="#000000":(n.style.fontColor=l,n.style.fontColorLimit=!0),n.style.fontSizeLimit=!0,n.style.sizeFixed=!1,n.style.labelAlign="cm",n.style.label=t,this.components.push(n)}}},{key:"getLinePts",value:function(t,e,o){var i=new Object;if(e>.5)return i.startIndex=0,i.startPt=t[0],i.endIndex=t.length-1,i.endPt=t[t.length-1],i;null==o&&(o=.5);var l=SuperMapAlgoPlot.PlottingUtil.polylineDistance(t),n=SuperMapAlgoPlot.PlottingUtil.getPtsIndexByDistance(l*(o-e),t),a=SuperMapAlgoPlot.PlottingUtil.getPtsIndexByDistance(l*(o+e),t);return i.startIndex=n.index,i.startPt=n.pts,i.endIndex=a.index,i.endPt=a.pts,i}},{key:"computeDashLine",value:function(t,e,o){var i=[],l=SuperMapAlgoPlot.PlottingUtil.polylineDistance(o);if(l<=0)return[];for(var n,a=o[0],s=1,r=0,u=!0,p=!0;r<l;){var h,c=[];c.push(a),r+=t;var g=SuperMapAlgoPlot.PlottingUtil.getPtsIndexByDistance(r,o);if(h=g.index,n=g.pts,!(u=g.bfind))break;if(s<h)for(var y=s;y<h;y++)c.push(o[y]);c.push(n),i.push(c),r+=e;var f=SuperMapAlgoPlot.PlottingUtil.getPtsIndexByDistance(r,o);if(h=f.index,a=f.pts,s=h+1,!(p=f.bfind))break}if(!u){var P=[];P.push(a);for(var d=s;d<o.length;d++)P.push(o[d]);2===P.length&&SuperMapAlgoPlot.PlottingUtil.equalFuzzy(SuperMapAlgoPlot.PlottingUtil.distance(P[0],P[1]),0)||i.push(P)}if(!p){var S=o[o.length-1],m=SuperMapAlgoPlot.PlottingUtil.distance(n,S);if(m*=.01,!SuperMapAlgoPlot.PlottingUtil.equalFuzzy(m,0)){var b=SuperMapAlgoPlot.PlottingUtil.linePnt(S,n,m),L=[];L.push(b),L.push(S),i.push(L)}}return i}},{key:"addArrow",value:function(t,e){if(t.length<2)return t;var o,i=SuperMapAlgoPlot.PlottingUtil.polylineDistance(this.controlPoints);void 0===e&&(e=(this.isEdit,.5*this.getSubSymbolScaleValue()));var l=t.slice();o=i*e;var n,a=t[t.length-1],s=o*Math.cos(.125*Math.PI);if(t.length>2){for(var r=-1,u=t.length-2;u>=0;u--)if(o<SuperMapAlgoPlot.PlottingUtil.distance(a,t[u])){r=u;break}t.splice(r+1,t.length-r),t.push(a)}if(t.length>1){SuperMapAlgoPlot.PlottingUtil.distance(t[t.length-1],t[t.length-2])>s&&(n=SuperMapAlgoPlot.PlottingUtil.getPtsIndexByDistance(s,[t[t.length-1],t[t.length-2]])).bfind&&(t.splice(t.length-1,1),t.push(n.pts)),this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,t);var p=t[t.length-1],h=a,c=o;if(void 0===p)return t;var g=SuperMapAlgoPlot.PlottingUtil.radian(p,h)*SuperMapAlgoPlot.PlottingUtil.RTOD,y=SuperMapAlgoPlot.PlottingUtil.circlePoint(h,c,c,g+157.5),f=SuperMapAlgoPlot.PlottingUtil.circlePoint(h,c,c,g+202.5),P={surroundLineFlag:!1,fillLimit:!0,fillColorLimit:!1,fill:!0,lineTypeLimit:!0,surroundLineLimit:!0,surroundLineType:SuperMapAlgoPlot.AlgoSurroundLineType.NONE};this.addCell(SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,[y,a,f],P)}else this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,l)}},{key:"addDovetailArrow",value:function(t,e){if(t.length<2)return t;var o,i=SuperMapAlgoPlot.PlottingUtil.polylineDistance(this.controlPoints);void 0===e&&(e=(this.isEdit,.5*this.getSubSymbolScaleValue())),o=i*e;var l=t[t.length-1];if(t.length>2){for(var n=-1,a=t.length-2;a>=0;a--)if(o<SuperMapAlgoPlot.PlottingUtil.distance(l,t[a])){n=a;break}t.splice(n+1,t.length-n),t.push(l)}this.addCell(SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,t);var s=t[t.length-2],r=t[t.length-1],u=o;if(void 0===s)return t;if(!(SuperMapAlgoPlot.PlottingUtil.distance(s,r)<o)){var p=SuperMapAlgoPlot.PlottingUtil.radian(s,r)*SuperMapAlgoPlot.PlottingUtil.RTOD,h=SuperMapAlgoPlot.PlottingUtil.circlePoint(r,u,u,p+157.5),c=SuperMapAlgoPlot.PlottingUtil.circlePoint(r,u,u,p+202.5),g=SuperMapAlgoPlot.PlottingUtil.circlePoint(r,.5*u,.5*u,p+180),y=[];y.push(h),y.push(t[t.length-1]),y.push(c),y.push(g);var f={surroundLineFlag:!1,fillLimit:!0,fillColorLimit:!1,fill:!0,lineTypeLimit:!0,surroundLineLimit:!0,surroundLineType:SuperMapAlgoPlot.AlgoSurroundLineType.NONE};this.addCell(SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,y,f)}}},{key:"getDefaultSubSymbolSize",value:function(){var t=0;if(this.map){var e=this.getLonLatFromPixel(0,0),o=this.getLonLatFromPixel(this.subSymbolDefaultPixelSize,0),i=new SuperMapAlgoPlot.Point(e.lon,e.lat),l=new SuperMapAlgoPlot.Point(o.lon,o.lat);t=SuperMapAlgoPlot.PlottingUtil.distance(i,l)}if(0===t){if(0!==this.subSymbolSize)return this.subSymbolSize;for(var n=0,a=0;a<this.controlPoints.length-1;a++)n+=SuperMapAlgoPlot.PlottingUtil.distance(this.controlPoints[a],this.controlPoints[a+1]);t=.3*n}return t}},{key:"getTextBounds",value:function(t,e){" "===e&&(e="_");var o=document.createElement("span");document.body.appendChild(o),o.style.width="auto",o.style.height="auto",t.fontSize&&(o.style.fontSize=new String(t.fontSize)+"px"),t.fontFamily&&(o.style.fontFamily=t.fontFamily),t.fontWeight&&(o.style.fontWeight=t.fontWeight),o.style.position="absolute",o.style.visibility="hidden",o.innerHTML=e;var i=new SuperMap.Bounds(o.clientLeft,o.clientTop+o.clientHeight-6,o.clientLeft+o.clientWidth,o.clientTop+4),l=this.pixelBoundsToLonLat(i);return document.body.removeChild(o),l}},{key:"calAssistantLine",value:function(){var t=SuperMapAlgoPlot.PlottingUtil.clonePoints(this.controlPoints);this.symbolType===SuperMapAlgoPlot.SymbolType.ANNOFRAMESYMBOL&&(t.splice(1,0,new SuperMapAlgoPlot.Point(this.controlPoints[1].x,this.controlPoints[0].y)),t.push(new SuperMapAlgoPlot.Point(this.controlPoints[0].x,this.controlPoints[1].y)),t.push(new SuperMapAlgoPlot.Point(this.controlPoints[0].x,this.controlPoints[0].y)));var e={type:24,surroundLineFlag:!1,positionPoints:t,style:{color:"#0000ff",opacity:1,weight:1,dashArray:"5, 5",strokeColor:"#0000ff",strokeOpacity:1,strokeWidth:1,strokeDashstyle:"dash",lineColorLimit:!0,lineTypeLimit:!0,lineWidthLimit:!0,surroundLineFlag:!1}};this.components.push(e)}},{key:"getSubSymbolScaleValue",value:function(t,e){var o=0;o=t&&!SuperMapAlgoPlot.PlottingUtil.equalFuzzy(t,0)?t:SuperMapAlgoPlot.PlottingUtil.polylineDistance(this.controlPoints);var i=this.getDefaultSubSymbolSize()/o;return void 0===e&&(e=.3),(i>e||i<=0)&&(i=e),i}},{key:"computeSubSymbol",value:function(t,e,o,i,l,n){if(null==t.symbolData||null==t.symbolData.innerCells)return null;void 0===l&&(l=0),void 0===n&&(n=0);for(var a=SuperMapAlgoPlot.AnalysisSymbol.analysisSymbolCells(t.symbolData,!0),s=0,r=0,u=0,p=0,h=0;h<a.length;h++){null!=a[h].polybezierClose&&(a[h].type===SuperMapAlgoPlot.SymbolType.POLYBEZIERSYMBOL||a[h].type===SuperMapAlgoPlot.SymbolType.POLYBEZIERCLOSESYMBOL?(a[h].type,SuperMapAlgoPlot.SymbolType.POLYBEZIERSYMBOL,a[h].positionPoints=SuperMapAlgoPlot.PlottingUtil.generateBeizerPointsWithCtrlPt(a[h].positionPoints),a[h].isClosed&&a[h].positionPoints[0]!==a[h].positionPoints[symbolCell.positionPoints.length-1]&&a[h].positionPoints.push(a[h].positionPoints[0])):a[h].type===SuperMapAlgoPlot.SymbolType.KIDNEY&&(a[h].positionPoints=SuperMapAlgoPlot.Primitives.getSpatialData(a[h].type,a[h].positionPoints)));for(var c=SuperMapAlgoPlot.Primitives.getSpatialData(a[h].type,a[h].positionPoints,a[h].textContent,0,a[h].isCalculate),g=0,y=c.length;g<y;g++)s<c[g].x&&(s=c[g].x),r<c[g].y&&(r=c[g].y),u>c[g].x&&(u=c[g].x),p>c[g].y&&(p=c[g].y)}var f=new SuperMapAlgoPlot.Point(s,r),P=new SuperMapAlgoPlot.Point(u,p),d=(f.y-P.y)/o,S=(f.x-P.x)/o,m=S>d?S:d,b=new SuperMapAlgoPlot.Point(.5*(f.x+P.x),.5*(f.y+P.y));b.x+=l*(f.x-P.x),b.y+=n*(f.y-P.y);for(var L=0,v=a.length;L<v;L++){for(var M=0,A=a[L].positionPoints.length;M<A;M++)a[L].positionPoints[M].x-=b.x,a[L].positionPoints[M].y-=b.y,a[L].positionPoints[M].x/=m,a[L].positionPoints[M].y/=m,SuperMapAlgoPlot.PlottingUtil.rotateAngle(new SuperMapAlgoPlot.Point(0,0),i*Math.PI/180,a[L].positionPoints[M]),a[L].positionPoints[M].x+=e.x,a[L].positionPoints[M].y+=e.y;a[L].type===SuperMapAlgoPlot.SymbolType.TEXTSYMBOL&&(a[L].style.fontSize/=10*m,a[L].style.labelRotation=-i,a[L].style.sizeFixed=!1),a[L].isCalculate=!1,a[L].style.surroundLineType=0,a[L].style.surroundLineLimit=!0,this.components.push(a[L])}return a}},{key:"ComputeZValue",value:function(t,e,o){var i=SuperMapAlgoPlot.PlottingUtil.pointProjectToSegment(t,e,o),l=new SuperMapAlgoPlot.Point(i.projectPoint.x,i.projectPoint.y),n=SuperMapAlgoPlot.PlottingUtil.distance(e,o),a=SuperMapAlgoPlot.PlottingUtil.distance(e,t),s=SuperMapAlgoPlot.PlottingUtil.distance(o,t);if(!i.isOnline){if(a>=n)return o.z;if(s>=n)return e.z}return l.x!=e.x&&e.x!=o.x?e.z+(l.x-e.x)/(e.x-o.x)*(e.z-o.z):l.y!=e.y&&e.y!=o.y?e.z+(l.y-e.y)/(e.y-o.y)*(e.z-o.z):0==(a=SuperMapAlgoPlot.PlottingUtil.distance(e,l))?e.z:e.z-(e.z-o.z)*(a/n)}},{key:"ComputeBeizerZValueByDis",value:function(t,e,o){if(t.length<2)return!1;for(var i=[],l=0;l<t.length;l++)i.push({x:t[l].x,y:t[l].y});var n=SuperMapAlgoPlot.PlottingUtil.polylineDistance(i);if(0==n)return!1;var a=SuperMapAlgoPlot.PlottingUtil.polylineDistance(e),s=[];s.push(i[0]);for(var r=-1,u=0,p=e[0],h=1;h<i.length;h++){s.push(i[h]);var c=SuperMapAlgoPlot.PlottingUtil.polylineDistance(s)/n,g=a*c,y=SuperMapAlgoPlot.PlottingUtil.getPtsIndexByDistance(g,e),f=y.index,P=y.pts;if(y.bfind){for(var d=t[h-1].z,S=t[h].z,m=a*(c-u),b=0,L=++r;L<=f;L++){var v=d+(S-d)*((b+=L==r?SuperMapAlgoPlot.PlottingUtil.distance(p,e[L]):SuperMapAlgoPlot.PlottingUtil.distance(e[L-1],e[L]))/m);o.push({x:e[L].x,y:e[L].y,z:v})}r=f}u=c,p=P}for(var M=r+1;M<e.length;M++)o.push({x:e[M].x,y:e[M].y,z:t[t.length-1].z});return!0}},{key:"ComputeHeight",value:function(t,e,o,i){if(o!=i){if(0!=t.length)if(1==t.length)e.push({x:t[0].x,y:t[0].y,z:o});else if(2==t.length)e.push({x:t[0].x,y:t[0].y,z:o}),e.push({x:t[1].x,y:t[1].y,z:i});else{var l=SuperMapAlgoPlot.PlottingUtil.polylineDistance(t);if(0!=l){var n=[];n.push(t[0]),e.push({x:t[0].x,y:t[0].y,z:o});for(var a=1;a<t.length-1;a++){n.push(t[a]);var s=o+(i-o)*SuperMapAlgoPlot.PlottingUtil.polylineDistance(n)/l;e.push({x:t[a].x,y:t[a].y,z:s})}e.push({x:t[t.length-1].x,y:t[t.length-1].y,z:i})}else for(var r=0;r<t.length;r++)e.push({x:t[r].x,y:t[r].y,z:o})}}else for(var u=0;u<t.length;u++)e.push({x:t[u].x,y:t[u].y,z:o})}}]),t}();SuperMapAlgoPlot.AlgoSymbol=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.ArrowToolkit=SuperMapAlgoPlot.ArrowToolkit=SuperMapAlgoPlot.ArrowToolkit||{};SuperMapAlgoPlot.ArrowToolkit.ConstValue={MAX_ARRAY_SIZE:128,sv_AtScaleParameter:1.5,sv_AtLenDivAtWidth:1.35,sv_AtWidthDivAwWidth:.5,DUOJIANTOU_TAIL_RATE_1:8,DUOJIANTOU_TAIL_RATE_2:3,DUOJIANTOU_TAIL_RATE_3:.6},SuperMapAlgoPlot.ArrowToolkit.ArrowTailType={ARROWTAIL_NONE:0,ARROWTAIL_LINE:1,ARROWTAIL_CURVE:2,ARROWTAIL_COATTAIL:3,ARROWTAIL_COATTAIL_POLYBODY:4},SuperMapAlgoPlot.ArrowToolkit.ArrowHeadType={ARROWHEAD_POLYLINE:0,ARROWHEAD_TRIANGLE:1,ARROWHEAD_COATTAIL:2,ARROWHEAD_TRIANGLE_SOLID:3,ARROWHEAD_COATTAIL_HOLLOW:6,ARROWHEAD_WITH_EAR:4,ARROWHEAD_WITHOUT_EAR:5},SuperMapAlgoPlot.ArrowToolkit.ArrowBodyType={ARROWBODY_POLYLINE:0,ARROWBODY_POLYBEZIER:1,ARROWBODY_COATTAIL:5,ARROWBODY_PARALLEL:2,ARROWBODY_TRAPEZOID:3,ARROWBODY_MULTIPOLYBEZIER:4},SuperMapAlgoPlot.ArrowToolkit.parallel=function(t,e){var o={leftParallelPts:[],rightParallelPts:[]};return 1===t.length||2===t.length&&t[0].x===t[1].x&&t[0].y===t[1].y?o:(o.leftParallelPts=SuperMapAlgoPlot.PlottingUtil.parallel(t,e),o.rightParallelPts=SuperMapAlgoPlot.PlottingUtil.parallel(t,-e),o)},SuperMapAlgoPlot.ArrowToolkit.trapezoid=function(t,e,o){var i={leftParallelPts:[],rightParallelPts:[]};if(1===t.length||2===t.length&&t[0].x===t[1].x&&t[0].y===t[1].y)return i;for(var l=0;l<t.length-1;l++){t[l].x===t[l+1].x&&t[l].y===t[l+1].y&&(i.leftParallelPts.push(i.leftParallelPts[i.leftParallelPts.length-1]),i.rightParallelPts.push(i.rightParallelPts[i.rightParallelPts.length-1]));var n=t[l+1];n=SuperMapAlgoPlot.PlottingUtil.rotate(t[l],0,1,n),i.leftParallelPts.push(SuperMapAlgoPlot.PlottingUtil.findPointInLine(t[l],n,e)),n=t[l],n=SuperMapAlgoPlot.PlottingUtil.rotate(t[l+1],0,-1,n),i.leftParallelPts.push(SuperMapAlgoPlot.PlottingUtil.findPointInLine(t[l+1],n,o)),n=t[l+1],n=SuperMapAlgoPlot.PlottingUtil.rotate(t[l],0,-1,n),i.rightParallelPts.push(SuperMapAlgoPlot.PlottingUtil.findPointInLine(t[l],n,e)),n=t[l],n=SuperMapAlgoPlot.PlottingUtil.rotate(t[l+1],0,1,n),i.rightParallelPts.push(SuperMapAlgoPlot.PlottingUtil.findPointInLine(t[l+1],n,o))}return i},SuperMapAlgoPlot.ArrowToolkit.generateArrowBodyShapePts=function(t,e,o){var i={};switch(o){case SuperMapAlgoPlot.ArrowToolkit.ArrowBodyType.ARROWBODY_PARALLEL:case SuperMapAlgoPlot.ArrowToolkit.ArrowBodyType.ARROWBODY_TRAPEZOID:var l=e[0],n=e[1],a=e[2],s=SuperMapAlgoPlot.PlottingUtil.equalFuzzy(a,0);if(!s&&t.length>2){var r=t.length;t.splice(2,r-2)}var u=SuperMapAlgoPlot.PlottingUtil.polylineDistance(t);i.arrowTouLen=u*l;for(var p=SuperMapAlgoPlot.PlottingUtil.findPointInPolyLine(t,u-i.arrowTouLen).pt,h=[],c=i.arrowTouLen*a,g=i.arrowTouLen*n,y=t.length-1,f=0;f<y;f++)h.push(t[f]);h.push(p);var P={leftParallelPts:[],rightParallelPts:[]};P=!0===s?SuperMapAlgoPlot.ArrowToolkit.parallel(h,g):SuperMapAlgoPlot.ArrowToolkit.trapezoid(h,c,g);var d=t[t.length-1];t[t.length-1]=p,t.push(d);i.leftBodyPts=P.leftParallelPts,i.rightBodyPts=P.rightParallelPts,i.OpectrlPoints=null;break;case SuperMapAlgoPlot.ArrowToolkit.ArrowBodyType.ARROWBODY_MULTIPOLYBEZIER:var S=SuperMapAlgoPlot.PlottingUtil.polylineDistance(t);if(0==S)return;var m=SuperMapAlgoPlot.ArrowToolkit.OperateCtrlPts(t),b=m.length;b--;var L=SuperMapAlgoPlot.ArrowToolkit.generateMultiBezier(m,b,e,S);t=[];for(var v=0;v<m.length;v++)t.push(m[v]);i.arrowTouLen=L.arrowTouLen,i.leftBodyPts=L.leftBodyPts,i.rightBodyPts=L.rightBodyPts,i.OpectrlPoints=m}return i},SuperMapAlgoPlot.ArrowToolkit.generateArrowHeadShapePts=function(t,e,o,i,l){var n=[];switch(l){case SuperMapAlgoPlot.ArrowToolkit.ArrowHeadType.ARROWHEAD_WITH_EAR:case SuperMapAlgoPlot.ArrowToolkit.ArrowHeadType.ARROWHEAD_WITHOUT_EAR:var a=o[0],s=o[1],r=0,u=0;3==o.length&&(r=o[2]),4==o.length&&(r=o[2],u=o[3]);var p=0;if(!SuperMapAlgoPlot.PlottingUtil.equalFuzzy(r,0)&&!SuperMapAlgoPlot.PlottingUtil.equalFuzzy(u,0)){var h=SuperMapAlgoPlot.PlottingUtil.clonePoints(t);h.splice(h.length-1,1),p=SuperMapAlgoPlot.PlottingUtil.polylineDistance(h)*r*u}var c=new SuperMapAlgoPlot.Point((e[0].x+e[1].x)/2,(e[0].y+e[1].y)/2);if(SuperMapAlgoPlot.PlottingUtil.equalFuzzy(s,0)){var g=i*a,y=t[t.length-1];return y=SuperMapAlgoPlot.PlottingUtil.rotate(c,0,1,y),n.push(SuperMapAlgoPlot.PlottingUtil.findPointInLine(c,y,g)),n.push(t[t.length-1]),y=t[t.length-1],y=SuperMapAlgoPlot.PlottingUtil.rotate(c,0,-1,y),n.push(SuperMapAlgoPlot.PlottingUtil.findPointInLine(c,y,g)),n}var f=i*s,P=SuperMapAlgoPlot.PlottingUtil.getExcentrePointOnSegmentByScale(f,c,t[t.length-1]);f=i*a,f+=p;var d=SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine(f,t[t.length-1],P),S=d.pntLeft,m=d.pntRight,b=t[t.length-1];return n.push(m),n.push(b),n.push(S),n}},SuperMapAlgoPlot.ArrowToolkit.generateArrowBodyShapePtsBySingleLine=function(t,e,o,i){var l=[];if(2>t.length)return l;var n,a=SuperMapAlgoPlot.PlottingUtil.polylineDistance(t),s=SuperMapAlgoPlot.PlottingUtil.equalFuzzy(e,0);switch(o){case SuperMapAlgoPlot.ArrowToolkit.ArrowBodyType.ARROWBODY_POLYLINE:l=l.concat(t),i&&!s&&SuperMapAlgoPlot.PlottingUtil.distance(t[t.length-1],t[t.length-2])>e&&(n=SuperMapAlgoPlot.PlottingUtil.findPointInPolyLine(t,a-e),l.splice(l.length-1,1),l.push(n.pt));break;case SuperMapAlgoPlot.ArrowToolkit.ArrowBodyType.ARROWBODY_POLYBEZIER:if(2==t.length)l=l.concat(t),i&&!s&&SuperMapAlgoPlot.PlottingUtil.distance(t[t.length-1],t[t.length-2])>e&&(n=SuperMapAlgoPlot.PlottingUtil.findPointInPolyLine(t,a-e),l.splice(l.length-1,1),l.push(n.pt));else{var r=SuperMapAlgoPlot.PlottingUtil.generateBeizerPointsNoCtrlPt(t);if(s)l=l.concat(r);else{var u=r[r.length-1];if(!s&&(e<SuperMapAlgoPlot.PlottingUtil.distance(t[t.length-1],t[t.length-2])||SuperMapAlgoPlot.PlottingUtil.equalFuzzy(SuperMapAlgoPlot.PlottingUtil.distance(t[t.length-1],t[t.length-2]),e,1e-7))){for(var p=r.length-1;p>1;p--){if(!(e>SuperMapAlgoPlot.PlottingUtil.distance(u,r[p]))){var h=SuperMapAlgoPlot.PlottingUtil.findPoint(u,r[p],e,0);r.push(h),l=r;break}r.splice(p,1)}i||l.push(u)}else l=l.concat(r)}}break;case SuperMapAlgoPlot.ArrowToolkit.ArrowBodyType.ARROWBODY_COATTAIL:var c=e;if(c>a)return l;for(var g,y,f=Math.ceil(a/(1.4*c)),P=0,d=[],S=0;S<f;S++)g=SuperMapAlgoPlot.PlottingUtil.getPtsIndexByDistance(c*P,t),y=SuperMapAlgoPlot.PlottingUtil.getPtsIndexByDistance(c*(P+1),t),g.bfind&&y.bfind&&(d.push(g.pts),d.push(y.pts)),P=1.4*(S+1);l=d}return l},SuperMapAlgoPlot.ArrowToolkit.generateArrowHeadShapePtsBySingleLine=function(t,e,o){var i=[];if(2>t.length)return i;switch(o){case SuperMapAlgoPlot.ArrowToolkit.ArrowHeadType.ARROWHEAD_POLYLINE:var l=t[0],n=t[1],a=SuperMapAlgoPlot.PlottingUtil.distance(l,n);if(SuperMapAlgoPlot.PlottingUtil.equalFuzzy(a,e,1e-7)||a>e){var s=SuperMapAlgoPlot.PlottingUtil.findPoint(l,n,e,0),r=e*Math.tan(.125*Math.PI),u=SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine(r,t[0],s);i.push(u.pntLeft),i.push(t[0]),i.push(u.pntRight)}break;case SuperMapAlgoPlot.ArrowToolkit.ArrowHeadType.ARROWHEAD_TRIANGLE:break;case SuperMapAlgoPlot.ArrowToolkit.ArrowHeadType.ARROWHEAD_TRIANGLE_SOLID:var p=t[0],h=t[1],c=SuperMapAlgoPlot.PlottingUtil.distance(p,h);if(SuperMapAlgoPlot.PlottingUtil.equalFuzzy(c,e,1e-7)||c>e){var g=e*Math.tan(.125*Math.PI),y=SuperMapAlgoPlot.PlottingUtil.findPoint(p,h,e,0),f=SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine(g,t[0],y);i.push(f.pntLeft),i.push(p),i.push(f.pntRight),i.push(f.pntLeft)}break;case SuperMapAlgoPlot.ArrowToolkit.ArrowHeadType.ARROWHEAD_COATTAIL:var P=t[0],d=2*Math.sqrt(e*e/3),S=SuperMapAlgoPlot.PlottingUtil.distance(t[0],t[1]);if(SuperMapAlgoPlot.PlottingUtil.equalFuzzy(d/2,S,1e-7)||S>d/2){var m=SuperMapAlgoPlot.PlottingUtil.findPoint(t[0],t[1],d,20),b=SuperMapAlgoPlot.PlottingUtil.findPoint(t[0],t[1],d,-20),L=SuperMapAlgoPlot.PlottingUtil.findPoint(t[0],t[1],d/2,0);i.push(P),i.push(m),i.push(L),i.push(b),i.push(P)}break;case SuperMapAlgoPlot.ArrowToolkit.ArrowHeadType.ARROWHEAD_COATTAIL_HOLLOW:var v=[],M=t[0],A=2*Math.sqrt(e*e/3),T=SuperMapAlgoPlot.PlottingUtil.distance(t[0],t[1]);if(SuperMapAlgoPlot.PlottingUtil.equalFuzzy(A/1.4,T,1e-7)||T>A/1.4){var _=SuperMapAlgoPlot.PlottingUtil.findPoint(t[0],t[1],A,20),O=SuperMapAlgoPlot.PlottingUtil.findPoint(t[0],t[1],A,-20),x=SuperMapAlgoPlot.PlottingUtil.findPoint(t[0],t[1],A/1.4,0);v.push(M),v.push(_),v.push(x),v.push(O),v.push(M);var w=new SuperMapAlgoPlot.Point((v[0].x+v[1].x)/2,(v[0].y+v[1].y)/2),E=new SuperMapAlgoPlot.Point((v[3].x+v[4].x)/2,(v[3].y+v[4].y)/2),C=new SuperMapAlgoPlot.Point((w.x+E.x)/2,(w.y+E.y)/2),I=.75*SuperMapAlgoPlot.PlottingUtil.distance(w,E)/2,D=SuperMapAlgoPlot.PlottingUtil.findPointInLine(C,w,I),R=SuperMapAlgoPlot.PlottingUtil.findPointInLine(C,E,I);i.push(v[0]),i.push(D),i.push(v[1]),i.push(v[2]),i.push(v[3]),i.push(R),i.push(v[4])}}return i},SuperMapAlgoPlot.ArrowToolkit.generateArrowTailShapePts=function(t,e,o,i){for(var l=e.length,n=[],a=0,s=0;s<t.length-1;s++)a+=SuperMapAlgoPlot.PlottingUtil.distance(t[s],t[s+1]);var r=a*o;switch(i){case SuperMapAlgoPlot.ArrowToolkit.ArrowTailType.ARROWTAIL_NONE:break;case SuperMapAlgoPlot.ArrowToolkit.ArrowTailType.ARROWTAIL_LINE:var u=SuperMapAlgoPlot.PlottingUtil.findPoint(t[0],t[1],r,90),p=SuperMapAlgoPlot.PlottingUtil.findPoint(t[0],t[1],r,-90);n.push(u),n.push(p);break;case SuperMapAlgoPlot.ArrowToolkit.ArrowTailType.ARROWTAIL_CURVE:var h=new SuperMapAlgoPlot.Point(.5*(e[0].x+e[l-1].x),.5*(e[0].y+e[l-1].y)),c=SuperMapAlgoPlot.PlottingUtil.distance(e[0],e[l-1]),g=SuperMapAlgoPlot.PlottingUtil.getIncentrePointOnSegmentByScale(c*o,h,t[t.length-1]),y=new SuperMapAlgoPlot.Point(0,0),f=new SuperMapAlgoPlot.Point(0,0);SuperMapAlgoPlot.PlottingUtil.getTrianglePoints(SuperMapAlgoPlot.ArrowToolkit.ConstValue.DUOJIANTOU_TAIL_RATE_1,SuperMapAlgoPlot.ArrowToolkit.ConstValue.DUOJIANTOU_TAIL_RATE_2,e[0],g,e[l-1],y,f);var P=new SuperMapAlgoPlot.Point(0,0);SuperMapAlgoPlot.PlottingUtil.getTrapezoidPoints(SuperMapAlgoPlot.ArrowToolkit.ConstValue.DUOJIANTOU_TAIL_RATE_3,e[0],g,y,P);var d=new SuperMapAlgoPlot.Point(0,0);SuperMapAlgoPlot.PlottingUtil.getTrapezoidPoints(SuperMapAlgoPlot.ArrowToolkit.ConstValue.DUOJIANTOU_TAIL_RATE_3,e[l-1],g,f,d);break;case SuperMapAlgoPlot.ArrowToolkit.ArrowTailType.ARROWTAIL_COATTAIL:var S=SuperMapAlgoPlot.PlottingUtil.findPoint(t[0],t[1],r,157.5),m=SuperMapAlgoPlot.PlottingUtil.findPoint(t[0],t[1],r,-157.5);n.push(S),n.push(t[0]),n.push(m);break;case SuperMapAlgoPlot.ArrowToolkit.ArrowTailType.ARROWTAIL_COATTAIL_POLYBODY:var b=new SuperMapAlgoPlot.Point(.5*(e[0].x+e[l-1].x),.5*(e[0].y+e[l-1].y)),L=SuperMapAlgoPlot.PlottingUtil.distance(e[0],e[l-1]),v=SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine(L*o,e[0],b);n.push(e[l-1]),n.push(v.pntLeft),n.push(e[0])}return n},SuperMapAlgoPlot.ArrowToolkit.generateArrowTailShapePtsBySingleLine=function(t,e,o){var i=[];switch(o){case SuperMapAlgoPlot.ArrowToolkit.ArrowTailType.ARROWTAIL_NONE:break;case SuperMapAlgoPlot.ArrowToolkit.ArrowTailType.ARROWTAIL_LINE:var l=SuperMapAlgoPlot.PlottingUtil.findPoint(t[0],t[1],e,90),n=SuperMapAlgoPlot.PlottingUtil.findPoint(t[0],t[1],e,-90);i.push(l),i.push(n);break;case SuperMapAlgoPlot.ArrowToolkit.ArrowTailType.ARROWTAIL_COATTAIL:var a=SuperMapAlgoPlot.PlottingUtil.findPoint(t[0],t[1],e,157.5),s=SuperMapAlgoPlot.PlottingUtil.findPoint(t[0],t[1],e,-157.5);i.push(a),i.push(t[0]),i.push(s)}return i},SuperMapAlgoPlot.ArrowToolkit.OperateCtrlPts=function(t){var e=SuperMapAlgoPlot.PlottingUtil.clonePoints(t);if(3==e.length){var o=((e[0].x+e[1].x)/2+e[2].x)/2,i=((e[0].y+e[1].y)/2+e[2].y)/2,l=new SuperMapAlgoPlot.Point(o,i),n=e[2].clone();e[2]=l,e.push(n)}return e},SuperMapAlgoPlot.ArrowToolkit.generateMultiBezier=function(t,e,o,i){var l=0,n=[],a=[],s=[],r=[],u=[],p=[],h=o[0],c=o[1],g=(t[0].x+t[1].x)/2,y=(t[0].y+t[1].y)/2,f=Math.abs(g-t[2].x),P=Math.abs(y-t[2].y),d=0;if(f>0&&P>0){var S=1/(g-t[2].x),m=-1/(y-t[2].y),b=1*t[2].y/(y-t[2].y)-1*t[2].x/(g-t[2].x);d=Math.abs(S*t[0].x+m*t[0].y+b)/Math.sqrt(S*S+m*m)}else P<=1e-4?d=Math.abs(y-t[1].y):f<=1e-4&&(d=Math.abs(g-t[1].x));var L=SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine(d,t[2],new SuperMapAlgoPlot.Point(g,y)),v=SuperMapAlgoPlot.PlottingUtil.pointIsRightToLine(t[1],t[2],t[0]);v?(n[1]=t[1],a[1]=t[0]):(n[1]=t[0],a[1]=t[1]),t[1]=new SuperMapAlgoPlot.Point((t[0].x+t[1].x)/2,(t[0].y+t[1].y)/2);var M=Math.sqrt((L.pntLeft.x-L.pntRight.x)*(L.pntLeft.x-L.pntRight.x)+(L.pntLeft.y-L.pntRight.y)*(L.pntLeft.y-L.pntRight.y))*SuperMapAlgoPlot.ArrowToolkit.ConstValue.sv_AtWidthDivAwWidth,A=(l=M*SuperMapAlgoPlot.ArrowToolkit.ConstValue.sv_AtLenDivAtWidth)*c;SuperMapAlgoPlot.PlottingUtil.equalFuzzy(h,0)||(A=(l=i*h)*c);var T,_,O=SuperMapAlgoPlot.PlottingUtil.distance(t[e],t[e-1]),x=2*l;O<x&&(A=(l=O/2)*c),t.push(t[e]),T=0,_=0;var w=0,E=[];for(w=2;w<=e;w++)T+=SuperMapAlgoPlot.PlottingUtil.distance(t[w],t[w-1]);for(T-=l,w=2;w<=e-1;w++)_+=SuperMapAlgoPlot.PlottingUtil.distance(t[w],t[w-1]),E[w]=A+(M-A)*Math.pow((T-_)/T,SuperMapAlgoPlot.ArrowToolkit.ConstValue.sv_AtScaleParameter);E[e]=A;var C,I,D=new SuperMapAlgoPlot.Point(0,0),R=new SuperMapAlgoPlot.Point(0,0),N=new SuperMapAlgoPlot.Point(0,0);for(w=2;w<=e-1;w++)SuperMapAlgoPlot.PlottingUtil.getTrianglePoints(0,3,t[w-1],t[w],t[w+1],R,N),w==e-1&&SuperMapAlgoPlot.PlottingUtil.getTrapezoidPoints(.5,t[e],t[e-1],N,D),C=SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine(E[w],R,t[w]),(v=SuperMapAlgoPlot.PlottingUtil.pointIsRightToLine(N,R,C.pntRight))?(n[w]=new SuperMapAlgoPlot.Point(C.pntRight.x,C.pntRight.y),a[w]=new SuperMapAlgoPlot.Point(C.pntLeft.x,C.pntLeft.y)):(n[w]=new SuperMapAlgoPlot.Point(C.pntLeft.x,C.pntLeft.y),a[w]=new SuperMapAlgoPlot.Point(C.pntRight.x,C.pntRight.y));for(Math.sqrt(1*(t[e].x-D.x)*(t[e].x-D.x)+1*(t[e].y-D.y)*(t[e].y-D.y))>0&&(t[e]=SuperMapAlgoPlot.PlottingUtil.getIncentrePointOnSegmentByScale(l,t[e],D)),C=SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine(A,t[e+1],t[e]),(v=SuperMapAlgoPlot.PlottingUtil.pointIsRightToLine(t[e],t[e+1],C.pntLeft))?(a[e]=new SuperMapAlgoPlot.Point(C.pntLeft.x,C.pntLeft.y),n[e]=new SuperMapAlgoPlot.Point(C.pntRight.x,C.pntRight.y)):(a[e]=new SuperMapAlgoPlot.Point(C.pntRight.x,C.pntRight.y),n[e]=new SuperMapAlgoPlot.Point(C.pntLeft.x,C.pntLeft.y)),w=2;w<e;w++)SuperMapAlgoPlot.PlottingUtil.getTrianglePoints(3,3,n[w-1],n[w],n[w+1],R,N),s[w]=new SuperMapAlgoPlot.Point(R.x,R.y),r[w]=new SuperMapAlgoPlot.Point(N.x,N.y),SuperMapAlgoPlot.PlottingUtil.getTrianglePoints(3,3,a[w-1],a[w],a[w+1],R,N),u[w]=new SuperMapAlgoPlot.Point(R.x,R.y),p[w]=new SuperMapAlgoPlot.Point(N.x,N.y),2==w&&(SuperMapAlgoPlot.PlottingUtil.getTrapezoidPoints(.5,n[1],n[2],s[2],D),r[1]=new SuperMapAlgoPlot.Point(D.x,D.y),SuperMapAlgoPlot.PlottingUtil.getTrapezoidPoints(.5,a[1],a[2],u[2],D),p[1]=new SuperMapAlgoPlot.Point(D.x,D.y)),w==e-1&&(x=(O=SuperMapAlgoPlot.PlottingUtil.distance(n[e],n[e-1]))/3,(I=SuperMapAlgoPlot.PlottingUtil.getExcentrePointOnSegmentByScale(x,t[e],t[e+1])).x+=n[e].x-t[e].x,I.y+=n[e].y-t[e].y,x=(O=M-A)*Math.pow(x/T,SuperMapAlgoPlot.ArrowToolkit.ConstValue.sv_AtScaleParameter),C=SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine(x,n[e],I),s[e]=new SuperMapAlgoPlot.Point(C.pntLeft.x,C.pntLeft.y),x=(O=SuperMapAlgoPlot.PlottingUtil.distance(a[e],a[e-1]))/3,(I=SuperMapAlgoPlot.PlottingUtil.getExcentrePointOnSegmentByScale(x,t[e],t[e+1])).x+=a[e].x-t[e].x,I.y+=a[e].y-t[e].y,x=(O=M-A)*Math.pow(x/T,SuperMapAlgoPlot.ArrowToolkit.ConstValue.sv_AtScaleParameter),C=SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine(x,a[e],I),u[e]=new SuperMapAlgoPlot.Point(C.pntRight.x,C.pntRight.y));return{arrowTouLen:l,leftBodyPts:SuperMapAlgoPlot.ArrowToolkit.genArrowBody(e,n,s,r),rightBodyPts:SuperMapAlgoPlot.ArrowToolkit.genArrowBody(e,a,u,p)}},SuperMapAlgoPlot.ArrowToolkit.genArrowBody=function(t,e,o,i){var l=new SuperMapAlgoPlot.Path2D;if(!(t<2)){l.MoveTo(e[1]);for(var n=1;n<=t-1;n++)l.CubicTo(i[n],o[n+1],e[n+1]);var a=[];return l.ToSubPathPolygons(a),a[0]}}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.Path2DData=function(){function t(e){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e){this.cStart=e.cStart,this.fillRule=e.fillRule,this.require_StartNewFigure=e.require_StartNewFigure,this.isBoundsDirty=e.isBoundsDirty,this.bounds=new SuperMap.Bounds(e.bounds.left,e.bounds.bottom,e.bounds.right,e.bounds.top),this.ref=1,this.elements=[];for(var o=0;o<e.elements.length;o++)this.elements.push(e.elements[o].clone())}else this.ref=1,this.bounds=new SuperMap.Bounds(0,0,0,0),this.elements=[];this.CLASS_NAME="SuperMapAlgoPlot.Path2DData"}return i(t,[{key:"IsClosed",value:function(){var t=this.elements[this.cStart],e=this.elements[this.elements.length-1];return t.GetX()==e.GetX()&&t.GetY()==e.GetY()}},{key:"Close",value:function(){this.require_StartNewFigure=!0;var t=this.elements[this.cStart],e=this.elements[this.elements.length-1];t!=e&&(t.Equal(e)?e.SetPosition(t.GetX(),t.GetY()):this.elements.push(new SuperMapAlgoPlot.Element(t.GetX(),t.GetY(),SuperMapAlgoPlot.ElementType.LineToElement)))}},{key:"MaybeStartNewFigure",value:function(){if(this.require_StartNewFigure){var t=this.elements[this.elements.length-1].clone();t.SetType(0),this.elements.push(t),this.require_StartNewFigure=!1}}}]),t}();SuperMapAlgoPlot.Path2DData=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.Element=function(){function t(e,o,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.m_x=e,this.m_y=o,this.m_type=i,this.CLASS_NAME="SuperMapAlgoPlot.Element"}return i(t,[{key:"GetX",value:function(){return this.m_x}},{key:"GetY",value:function(){return this.m_y}},{key:"GetType",value:function(){return this.m_type}},{key:"GetPosition",value:function(){return SuperMapAlgoPlot.Point(this.m_x,this.m_y)}},{key:"SetPosition",value:function(t,e){this.m_x=t,this.m_y=e}},{key:"SetType",value:function(t){this.m_type=t}},{key:"IsCurveTo",value:function(){return 2==this.m_type}},{key:"IsLineTo",value:function(){return 1==this.m_type}},{key:"IsMoveTo",value:function(){return 0==this.m_type}},{key:"Equal",value:function(t){return SuperMapAlgoPlot.PlottingUtil.equalFuzzy(this.m_x,t.m_x,1e-10)&&SuperMapAlgoPlot.PlottingUtil.equalFuzzy(this.m_y,t.m_y,1e-10)&&this.m_type==t.m_type}},{key:"clone",value:function(){return new SuperMapAlgoPlot.Path2D.Element(this.m_x,this.m_y,this.m_type)}}]),t}();SuperMapAlgoPlot.Element=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.Path2D=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.m_pData=null,this.CLASS_NAME="SuperMapAlgoPlot.Path2D"}return i(t,[{key:"MoveTo",value:function(t){this.ensureData(),this.detach();var e=this.getDataPtr();if(e.require_StartNewFigure=!1,0==e.elements[e.elements.length-1].GetType())e.elements[e.elements.length-1].SetPosition(t.x,t.y);else{var o=new SuperMapAlgoPlot.Element(t.x,t.y,0);e.elements.push(o)}e.cStart=e.elements.length-1}},{key:"LineTo",value:function(t){this.ensureData(),this.detach();var e=this.getDataPtr();if(e.MaybeStartNewFigure(),e.elements[e.elements.length-1].GetX()!=t.x||e.elements[e.elements.length-1].GetY()!=t.y){var o=new SuperMapAlgoPlot.Element(t.x,t.y,1);e.elements.push(o)}}},{key:"CurveTo",value:function(t,e,o){this.ensureData(),this.detach();var i=this.getDataPtr();if(i.elements[i.elements.length-1].GetX()!=t.x||i.elements[i.elements.length-1].GetY()!=t.y||t.x!=e.x||t.y!=e.y||e.x!=o.x||e.y!=o.y){i.MaybeStartNewFigure();var l=new SuperMapAlgoPlot.Element(t.x,t.y,2),n=new SuperMapAlgoPlot.Element(e.x,e.y,3),a=new SuperMapAlgoPlot.Element(o.x,o.y,3);i.elements.push(l),i.elements.push(n),i.elements.push(a)}}},{key:"CubicTo",value:function(t,e,o){this.ensureData(),this.detach();var i=this.getDataPtr();if(i.elements[i.elements.length-1].GetX()!=t.x||i.elements[i.elements.length-1].GetY()!=t.y||t.x!=e.x||t.y!=e.y||e.x!=o.x||e.y!=o.y){i.MaybeStartNewFigure();var l=new SuperMapAlgoPlot.Element(t.x,t.y,2),n=new SuperMapAlgoPlot.Element(e.x,e.y,3),a=new SuperMapAlgoPlot.Element(o.x,o.y,3);i.elements.push(l),i.elements.push(n),i.elements.push(a)}}},{key:"ToSubPathPolygons",value:function(t){var e,o,i=this.getDataPtr();if(this.IsEmpty())return!1;for(var l=[],n=this.GetElementCount(),a=0;a<n;a++){var s=i.elements[a];switch(s.GetType()){case 0:l.length>1&&t.push(l),l=[],e=s.GetX(),o=s.GetY(),l.push(new SuperMapAlgoPlot.Point(e,o));break;case 1:e=s.GetX(),o=s.GetY(),l.push(new SuperMapAlgoPlot.Point(e,o));break;case 2:if(3!=i.elements[a+1].GetType()||3!=i.elements[a+1].GetType())break;for(var r=i.elements[a-1].GetX(),u=i.elements[a-1].GetY(),p=s.GetX(),h=s.GetY(),c=i.elements[a+1].GetX(),g=i.elements[a+1].GetY(),y=i.elements[a+2].GetX(),f=i.elements[a+2].GetY(),P=0;P<=1;P+=.03125){var d=P*P,S=d*P,m=1-3*P+3*d-S,b=3*(P-2*d+S),L=3*(d-S),v=S;l.push(new SuperMapAlgoPlot.Point(m*r+b*p+L*c+v*y,m*u+b*h+L*g+v*f))}a+=2}}return l.length>1&&t.push(l),!0}},{key:"ensureData",value:function(){null==this.m_pData&&this.ensureData_helper()}},{key:"ensureData_helper",value:function(){var t=new SuperMapAlgoPlot.Path2DData,e=new SuperMapAlgoPlot.Element(0,0,0);t.elements.push(e),null==this.m_pData||this.mtDeRef(this.m_pData.ref)||(this.m_pData=null),this.m_pData=t}},{key:"detach",value:function(){1!=this.m_pData.ref&&this.detach_helper(),this.setBoundsDirty(!0)}},{key:"detach_helper",value:function(){var t=new SuperMapAlgoPlot.Path2DData;null==this.m_pData||this.mtDeRef(this.m_pData.ref)||(this.m_pData=null),this.m_pData=t}},{key:"setBoundsDirty",value:function(t){this.getDataPtr().isBoundsDirty=t}},{key:"getDataPtr",value:function(){return this.m_pData}},{key:"IsEmpty",value:function(){if(null==this.m_pData)return!0;var t=this.m_pData.elements.length;return 0==t||1==t&&0==this.m_pData.elements[0].GetType()}},{key:"GetElementCount",value:function(){return null!=this.m_pData?this.m_pData.elements.length:0}}],[{key:"mtRef",value:function(t){return 0!=++t}},{key:"mtDeRef",value:function(t){return 0!=--t}}]),t}();SuperMapAlgoPlot.Path2D=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AlgoSymbol322=e.AlgoSymbol321=e.AlgoSymbol320=e.AlgoSymbol25701=e.AlgoSymbol15200=e.AlgoSymbol315=e.AlgoSymbol1022=e.AlgoSymbol1021=e.AlgoSymbol1020=e.AlgoSymbol1019=e.AlgoSymbol1018=e.AlgoSymbol1017=e.AlgoSymbol1016=e.AlgoSymbol1015=e.AlgoSymbol1014=e.AlgoSymbol1013=e.AlgoSymbol1012=e.AlgoSymbol1011=e.AlgoSymbol1010=e.AlgoSymbol1009=e.AlgoSymbol1008=e.AlgoSymbol1007=e.AlgoSymbol1006=e.AlgoSymbol1005=e.AlgoSymbol1004=e.AlgoSymbol1003=e.AlgoSymbol1002=e.AlgoSymbol1001=e.NewChord=e.NewArc=e.NewPie=e.Polybezier=e.LinearArrow=e.Wire=e.PolygonRegion=e.LineRelation=e.LineMarking=e.PathText=e.CurveEight=e.Runway=e.NodeChain=e.FreeCurve=e.CombinationalCircle=e.ConcentricCircle=e.SymbolTextBox=e.GeoTooltipBoxM=e.GeoTooltipBox=e.Trapezoid=e.Brace=e.RegularPolygon=e.ArrowLine=e.AlgoSymbol=e.ArrowToolkit=e.Path2DData=e.Element=e.Path2D=void 0;var i=o(140),l=o(139),n=o(138),a=o(137),s=o(136),r=o(135),u=o(134),p=o(133),h=o(132),c=o(131),g=o(130),y=o(129),f=o(128),P=o(127),d=o(126),S=o(125),m=o(124),b=o(123),L=o(122),v=o(121),M=o(120),A=o(119),T=o(118),_=o(117),O=o(116),x=o(115),w=o(114),E=o(113),C=o(112),I=o(111),D=o(110),R=o(109),N=o(108),U=o(107),B=o(106),k=o(105),F=o(104),G=o(103),V=o(102),j=o(101),Y=o(100),z=o(99),W=o(98),X=o(97),H=o(96),Z=o(95),J=o(94),q=o(93),K=o(92),Q=o(91),$=o(90),tt=o(89),et=o(88),ot=o(87),it=o(86),lt=o(85);e.Path2D=i.Path2D,e.Element=l.Element,e.Path2DData=n.Path2DData,e.ArrowToolkit=a.ArrowToolkit,e.AlgoSymbol=s.AlgoSymbol,e.ArrowLine=r.ArrowLine,e.RegularPolygon=u.RegularPolygon,e.Brace=p.Brace,e.Trapezoid=h.Trapezoid,e.GeoTooltipBox=c.GeoTooltipBox,e.GeoTooltipBoxM=g.GeoTooltipBoxM,e.SymbolTextBox=y.SymbolTextBox,e.ConcentricCircle=f.ConcentricCircle,e.CombinationalCircle=P.CombinationalCircle,e.FreeCurve=d.FreeCurve,e.NodeChain=S.NodeChain,e.Runway=m.Runway,e.CurveEight=b.CurveEight,e.PathText=L.PathText,e.LineMarking=v.LineMarking,e.LineRelation=M.LineRelation,e.PolygonRegion=A.PolygonRegion,e.Wire=T.Wire,e.LinearArrow=_.LinearArrow,e.Polybezier=O.Polybezier,e.NewPie=x.NewPie,e.NewArc=w.NewArc,e.NewChord=E.NewChord,e.AlgoSymbol1001=C.AlgoSymbol1001,e.AlgoSymbol1002=I.AlgoSymbol1002,e.AlgoSymbol1003=D.AlgoSymbol1003,e.AlgoSymbol1004=R.AlgoSymbol1004,e.AlgoSymbol1005=N.AlgoSymbol1005,e.AlgoSymbol1006=U.AlgoSymbol1006,e.AlgoSymbol1007=B.AlgoSymbol1007,e.AlgoSymbol1008=k.AlgoSymbol1008,e.AlgoSymbol1009=F.AlgoSymbol1009,e.AlgoSymbol1010=G.AlgoSymbol1010,e.AlgoSymbol1011=V.AlgoSymbol1011,e.AlgoSymbol1012=j.AlgoSymbol1012,e.AlgoSymbol1013=Y.AlgoSymbol1013,e.AlgoSymbol1014=z.AlgoSymbol1014,e.AlgoSymbol1015=W.AlgoSymbol1015,e.AlgoSymbol1016=X.AlgoSymbol1016,e.AlgoSymbol1017=H.AlgoSymbol1017,e.AlgoSymbol1018=Z.AlgoSymbol1018,e.AlgoSymbol1019=J.AlgoSymbol1019,e.AlgoSymbol1020=q.AlgoSymbol1020,e.AlgoSymbol1021=K.AlgoSymbol1021,e.AlgoSymbol1022=Q.AlgoSymbol1022,e.AlgoSymbol315=$.AlgoSymbol315,e.AlgoSymbol15200=tt.AlgoSymbol15200,e.AlgoSymbol25701=et.AlgoSymbol25701,e.AlgoSymbol320=ot.AlgoSymbol320,e.AlgoSymbol321=it.AlgoSymbol321,e.AlgoSymbol322=lt.AlgoSymbol322},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AlgoSymbolFactory=e.BasicAlgoSymbolFactory=void 0;var i=o(44),l=o(84);e.BasicAlgoSymbolFactory=i.BasicAlgoSymbolFactory,e.AlgoSymbolFactory=l.AlgoSymbolFactory},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.AddPoint_WayType=SuperMapAlgoPlot.AddPoint_WayType={UNKNOWN:0,POLYLINE:1,CURVE:2}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.RouteNodePrimitives=SuperMapAlgoPlot.RouteNodePrimitives=SuperMapAlgoPlot.RouteNodePrimitives||{};SuperMapAlgoPlot.RouteNodePrimitives={initialize:function(){},rendezvousPoint:function(){var t=[],e=new Object;e.type=SuperMapAlgoPlot.SymbolType.CIRCLESYMBOL,e.positionPoints=[],e.positionPoints.push(new SuperMapAlgoPlot.Point(0,0)),e.positionPoints.push(new SuperMapAlgoPlot.Point(0,30)),e.style={surroundLineFlag:!1,fillLimit:!0,fill:!1};var o=new Object;return o.type=SuperMapAlgoPlot.SymbolType.TEXTSYMBOL,o.positionPoints=[],o.positionPoints.push(new SuperMapAlgoPlot.Point(0,0)),o.textContent="会",o.style={surroundLineFlag:!1,fontSize:14,fontSizeLimit:!0},o.style.labelAlign="cm",t.push(o),t.push(e),t},expandingPoint:function(){var t=[],e=new Object;e.type=SuperMapAlgoPlot.SymbolType.CIRCLESYMBOL,e.positionPoints=[],e.positionPoints.push(new SuperMapAlgoPlot.Point(0,0)),e.positionPoints.push(new SuperMapAlgoPlot.Point(0,30)),e.style={surroundLineFlag:!1,fillLimit:!0,fill:!1};var o=new Object;return o.type=SuperMapAlgoPlot.SymbolType.TEXTSYMBOL,o.positionPoints=[],o.positionPoints.push(new SuperMapAlgoPlot.Point(0,0)),o.textContent="展",o.style={surroundLineFlag:!1,fontSize:14,fontSizeLimit:!0},o.style.labelAlign="cm",t.push(o),t.push(e),t},volleyPoint:function(){var t=[],e=new Object;e.type=SuperMapAlgoPlot.SymbolType.CIRCLESYMBOL,e.positionPoints=[],e.positionPoints.push(new SuperMapAlgoPlot.Point(0,0)),e.positionPoints.push(new SuperMapAlgoPlot.Point(0,30)),e.style={surroundLineFlag:!1,fillLimit:!0,fill:!1};var o=new Object;return o.type=SuperMapAlgoPlot.SymbolType.TEXTSYMBOL,o.positionPoints=[],o.positionPoints.push(new SuperMapAlgoPlot.Point(0,0)),o.textContent="齐",o.style={surroundLineFlag:!1,fontSize:14,fontSizeLimit:!0},o.style.labelAlign="cm",t.push(o),t.push(e),t},standbyPoint_Outer:function(t,e){var o=[],i=new SuperMapAlgoPlot.Point(0,0),l=new SuperMapAlgoPlot.Point(0,30);t||(t=90);var n=new Object;n.type=SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,n.positionPoints=[];for(var a=t+10;a<170+t;a+=10){var s=SuperMapAlgoPlot.PlottingUtil.findPoint(i,l,30,a);n.positionPoints.push(s)}n.style={surroundLineFlag:!1,fillLimit:!0,fill:!1},o.push(n);var r=n.positionPoints[n.positionPoints.length-1],u=n.positionPoints[n.positionPoints.length-2],p=SuperMapAlgoPlot.PlottingUtil.findPoint(r,u,9,22.5),h=SuperMapAlgoPlot.PlottingUtil.findPoint(r,u,9,-22.5),c=new Object;c.type=SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,c.positionPoints=[],c.positionPoints.push(p),c.positionPoints.push(r.clone()),c.positionPoints.push(h),c.style={surroundLineFlag:!1,fillLimit:!0,fill:!1},o.push(c);var g=new Object;g.type=SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,g.positionPoints=[];for(var y=190+t;y<350+t;y+=10){var f=SuperMapAlgoPlot.PlottingUtil.findPoint(i,l,30,y);g.positionPoints.push(f)}g.style={surroundLineFlag:!1,fillLimit:!0,fill:!1},o.push(g);var P=g.positionPoints[g.positionPoints.length-1],d=g.positionPoints[g.positionPoints.length-2],S=SuperMapAlgoPlot.PlottingUtil.findPoint(P,d,9,22.5),m=SuperMapAlgoPlot.PlottingUtil.findPoint(P,d,9,-22.5),b=new Object;b.type=SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,b.positionPoints=[],b.positionPoints.push(S),b.positionPoints.push(P.clone()),b.positionPoints.push(m),b.style={surroundLineFlag:!1,fillLimit:!0,fill:!1},o.push(b);for(var L=0;L<o.length;L++)for(var v=0;v<o[L].positionPoints.length;v++){var M=e*(Math.PI/180);SuperMapAlgoPlot.PlottingUtil.rotateAngle(i,M,o[L].positionPoints[v])}return o},standbyPoint_Inner:function(){var t=[],e=new Object;e.type=SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,e.positionPoints=[],e.positionPoints.push(new SuperMapAlgoPlot.Point(-20,0)),e.positionPoints.push(new SuperMapAlgoPlot.Point(20,10)),e.positionPoints.push(new SuperMapAlgoPlot.Point(20,-10)),e.style={surroundLineFlag:!1,fillLimit:!0,fill:!1},t.push(e);var o=new Object;o.type=SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,o.positionPoints=[],o.positionPoints.push(new SuperMapAlgoPlot.Point(-5,0)),o.positionPoints.push(new SuperMapAlgoPlot.Point(17,0)),o.style={surroundLineFlag:!1,fillLimit:!0,fill:!1},t.push(o);var i=new Object;return i.type=SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,i.positionPoints=[],i.positionPoints.push(new SuperMapAlgoPlot.Point(-2,1.5)),i.positionPoints.push(new SuperMapAlgoPlot.Point(-5,0)),i.positionPoints.push(new SuperMapAlgoPlot.Point(-2,-1.5)),i.style={surroundLineFlag:!1,fillLimit:!0,fill:!1},t.push(i),t},supplyPoint:function(){var t=[],e=new Object;e.type=SuperMapAlgoPlot.SymbolType.CIRCLESYMBOL,e.positionPoints=[],e.positionPoints.push(new SuperMapAlgoPlot.Point(0,0)),e.positionPoints.push(new SuperMapAlgoPlot.Point(0,30)),e.style={surroundLineFlag:!1,fillLimit:!0,fill:!1};var o=new Object;return o.type=SuperMapAlgoPlot.SymbolType.TEXTSYMBOL,o.positionPoints=[],o.positionPoints.push(new SuperMapAlgoPlot.Point(0,0)),o.textContent="补",o.style={surroundLineFlag:!1,fontSize:14,fontSizeLimit:!0},o.style.labelAlign="cm",t.push(o),t.push(e),t},takeoffPoint:function(){var t=[],e=new Object;return e.type=SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,e.positionPoints=[],e.positionPoints.push(new SuperMapAlgoPlot.Point(-15,25)),e.positionPoints.push(new SuperMapAlgoPlot.Point(15,25)),e.positionPoints.push(new SuperMapAlgoPlot.Point(15,-25)),e.positionPoints.push(new SuperMapAlgoPlot.Point(0,-35)),e.positionPoints.push(new SuperMapAlgoPlot.Point(-15,-25)),e.positionPoints.push(new SuperMapAlgoPlot.Point(-15,25)),e.style={surroundLineFlag:!1,fillLimit:!0,fill:!1},t.push(e),t},initialPoint:function(){var t=[],e=new Object;return e.type=SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,e.positionPoints=[],e.positionPoints.push(new SuperMapAlgoPlot.Point(-30,30)),e.positionPoints.push(new SuperMapAlgoPlot.Point(30,30)),e.positionPoints.push(new SuperMapAlgoPlot.Point(30,-30)),e.positionPoints.push(new SuperMapAlgoPlot.Point(-30,-30)),e.style={surroundLineFlag:!1,fillLimit:!0,fill:!1},t.push(e),t},visualInitalPoint:function(){var t=[],e=new Object;return e.type=SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,e.positionPoints=[],e.positionPoints.push(new SuperMapAlgoPlot.Point(0,30)),e.positionPoints.push(new SuperMapAlgoPlot.Point(30,0)),e.positionPoints.push(new SuperMapAlgoPlot.Point(0,-30)),e.positionPoints.push(new SuperMapAlgoPlot.Point(-30,0)),e.style={surroundLineFlag:!1,fillLimit:!0,fill:!1},t.push(e),t},lanchPoint:function(){var t=[],e=new Object;return e.type=SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,e.positionPoints=[],e.positionPoints.push(new SuperMapAlgoPlot.Point(0,30)),e.positionPoints.push(new SuperMapAlgoPlot.Point(20,-30)),e.positionPoints.push(new SuperMapAlgoPlot.Point(-20,-30)),e.style={surroundLineFlag:!1,fillLimit:!0,fill:!1},t.push(e),t},turningPoint:function(){var t=[],e=new Object;return e.type=SuperMapAlgoPlot.SymbolType.CIRCLESYMBOL,e.positionPoints=[],e.positionPoints.push(new SuperMapAlgoPlot.Point(0,0)),e.positionPoints.push(new SuperMapAlgoPlot.Point(0,30)),e.style={surroundLineFlag:!1,fillLimit:!0,fill:!1},t.push(e),t},aimingPoint:function(){var t=[],e=new Object;return e.type=SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,e.positionPoints=[],e.positionPoints.push(new SuperMapAlgoPlot.Point(0,-30)),e.positionPoints.push(new SuperMapAlgoPlot.Point(20,30)),e.positionPoints.push(new SuperMapAlgoPlot.Point(-20,30)),e.style={surroundLineFlag:!1,fillLimit:!0,fill:!1},t.push(e),t},targetPoint:function(){var t=[],e=new Object;return e.type=SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,e.positionPoints=[],e.positionPoints.push(new SuperMapAlgoPlot.Point(0,30)),e.positionPoints.push(new SuperMapAlgoPlot.Point(30,-30)),e.positionPoints.push(new SuperMapAlgoPlot.Point(-30,-30)),e.style={surroundLineFlag:!1,fillLimit:!0,fill:!1},t.push(e),t},eightSpiralPoint:function(){var t=[],e=new Object;e.type=SuperMapAlgoPlot.SymbolType.CIRCLESYMBOL,e.positionPoints=[],e.positionPoints.push(new SuperMapAlgoPlot.Point(30,0)),e.positionPoints.push(new SuperMapAlgoPlot.Point(0,0)),e.style={surroundLineFlag:!1,fillLimit:!0,fill:!1};var o=new Object;return o.type=SuperMapAlgoPlot.SymbolType.CIRCLESYMBOL,o.positionPoints=[],o.positionPoints.push(new SuperMapAlgoPlot.Point(-30,0)),o.positionPoints.push(new SuperMapAlgoPlot.Point(0,0)),o.style={surroundLineFlag:!1,fillLimit:!0,fill:!1},t.push(e),t.push(o),t},happyValleyPoint:function(){var t=[],e=new Object;e.type=SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,e.positionPoints=[],e.positionPoints.push(new SuperMapAlgoPlot.Point(-30,20)),e.positionPoints.push(new SuperMapAlgoPlot.Point(30,20)),e.style={surroundLineFlag:!1,fillLimit:!0,fill:!1};var o=new Object;o.type=SuperMapAlgoPlot.SymbolType.POLYLINESYMBOL,o.positionPoints=[],o.positionPoints.push(new SuperMapAlgoPlot.Point(30,-20)),o.positionPoints.push(new SuperMapAlgoPlot.Point(-30,-20)),o.style={surroundLineFlag:!1,fillLimit:!0,fill:!1};var i=new Object;i.type=SuperMapAlgoPlot.SymbolType.ARCSYMBOL,i.positionPoints=[],i.positionPoints.push(new SuperMapAlgoPlot.Point(-30,20)),i.positionPoints.push(new SuperMapAlgoPlot.Point(-50,0)),i.positionPoints.push(new SuperMapAlgoPlot.Point(-30,-20)),i.style={surroundLineFlag:!1,fillLimit:!0,fill:!1};var l=new Object;return l.type=SuperMapAlgoPlot.SymbolType.ARCSYMBOL,l.positionPoints=[],l.positionPoints.push(new SuperMapAlgoPlot.Point(30,20)),l.positionPoints.push(new SuperMapAlgoPlot.Point(50,0)),l.positionPoints.push(new SuperMapAlgoPlot.Point(30,-20)),l.style={surroundLineFlag:!1,fillLimit:!0,fill:!1},t.push(e),t.push(o),t.push(i),t.push(l),t},attackPoint:function(){var t=[],e=new Object;e.type=SuperMapAlgoPlot.SymbolType.CIRCLESYMBOL,e.positionPoints=[],e.positionPoints.push(new SuperMapAlgoPlot.Point(0,0)),e.positionPoints.push(new SuperMapAlgoPlot.Point(0,30)),e.style={surroundLineFlag:!1,fillLimit:!0,fill:!1};var o=new Object;return o.type=SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,o.positionPoints=[],o.positionPoints.push(new SuperMapAlgoPlot.Point(0,20)),o.positionPoints.push(new SuperMapAlgoPlot.Point(20,-20)),o.positionPoints.push(new SuperMapAlgoPlot.Point(-20,-20)),o.style={surroundLineFlag:!1,fillLimit:!0,fill:!1},t.push(o),t.push(e),t},suppressPoint:function(){var t=[],e=new Object;e.type=SuperMapAlgoPlot.SymbolType.CIRCLESYMBOL,e.positionPoints=[],e.positionPoints.push(new SuperMapAlgoPlot.Point(0,0)),e.positionPoints.push(new SuperMapAlgoPlot.Point(0,30)),e.style={surroundLineFlag:!1,fontSize:14};var o=new Object;return o.type=SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL,o.positionPoints=[],o.positionPoints.push(new SuperMapAlgoPlot.Point(-15,15)),o.positionPoints.push(new SuperMapAlgoPlot.Point(15,15)),o.positionPoints.push(new SuperMapAlgoPlot.Point(15,-15)),o.positionPoints.push(new SuperMapAlgoPlot.Point(-15,-15)),o.style={surroundLineFlag:!1,fillLimit:!0,fill:!1},t.push(o),t.push(e),t},getRouteNodeCells:function(t,e,o){switch(t){case SuperMapAlgoPlot.RouteNodeType.RENDEZVOUS:return this.rendezvousPoint();case SuperMapAlgoPlot.RouteNodeType.EXPANDING:return this.expandingPoint();case SuperMapAlgoPlot.RouteNodeType.VOLLEY:return this.volleyPoint();case SuperMapAlgoPlot.RouteNodeType.STANDBY:return e?this.standbyPoint_Inner():this.standbyPoint_Outer(null,o);case SuperMapAlgoPlot.RouteNodeType.SUPPLY:return this.supplyPoint();case SuperMapAlgoPlot.RouteNodeType.TAKEOFF:return this.takeoffPoint();case SuperMapAlgoPlot.RouteNodeType.INITIAL:return this.initialPoint();case SuperMapAlgoPlot.RouteNodeType.VISUALINITAL:return this.visualInitalPoint();case SuperMapAlgoPlot.RouteNodeType.LANCH:case SuperMapAlgoPlot.RouteNodeType.WEAPONLAUNCH:return this.lanchPoint();case SuperMapAlgoPlot.RouteNodeType.TURNING:case SuperMapAlgoPlot.RouteNodeType.COMMONROUTE:return this.turningPoint();case SuperMapAlgoPlot.RouteNodeType.AIMING:return this.aimingPoint();case SuperMapAlgoPlot.RouteNodeType.TARGET:return this.targetPoint();case SuperMapAlgoPlot.RouteNodeType.ATTACK:return this.attackPoint();case SuperMapAlgoPlot.RouteNodeType.SUPPRESS:return this.suppressPoint();case SuperMapAlgoPlot.RouteNodeType.EIGHTSPIRAL:return this.eightSpiralPoint();case SuperMapAlgoPlot.RouteNodeType.HAPPYVALLEY:return this.happyValleyPoint();default:return[]}},getRouteNodeNameByType:function(t){switch(t){case SuperMapAlgoPlot.RouteNodeType.RENDEZVOUS:return"会合点";case SuperMapAlgoPlot.RouteNodeType.EXPANDING:return"展开点";case SuperMapAlgoPlot.RouteNodeType.VOLLEY:return"齐射点";case SuperMapAlgoPlot.RouteNodeType.STANDBY:return"待机点";case SuperMapAlgoPlot.RouteNodeType.SUPPLY:return"补给点";case SuperMapAlgoPlot.RouteNodeType.TAKEOFF:return"起飞点";case SuperMapAlgoPlot.RouteNodeType.INITIAL:return"初始点";case SuperMapAlgoPlot.RouteNodeType.VISUALINITAL:return"可视化初始点";case SuperMapAlgoPlot.RouteNodeType.LANCH:return"发射点";case SuperMapAlgoPlot.RouteNodeType.WEAPONLAUNCH:return"武器发射点";case SuperMapAlgoPlot.RouteNodeType.TURNING:return"转弯点";case SuperMapAlgoPlot.RouteNodeType.COMMONROUTE:return"普通航路点";case SuperMapAlgoPlot.RouteNodeType.AIMING:return"目标瞄准点";case SuperMapAlgoPlot.RouteNodeType.TARGET:return"目标点";case SuperMapAlgoPlot.RouteNodeType.ATTACK:return"攻击点";case SuperMapAlgoPlot.RouteNodeType.SUPPRESS:return"压制点";case SuperMapAlgoPlot.RouteNodeType.EIGHTSPIRAL:return"八字盘旋点";case SuperMapAlgoPlot.RouteNodeType.HAPPYVALLEY:return"跑马圈点";default:return""}}}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.Primitives=SuperMapAlgoPlot.Primitives=SuperMapAlgoPlot.Primitives||{};SuperMapAlgoPlot.Primitives={nSegmentCount:72,initialize:function(t){t&&t.nSegmentCount&&(this.nSegmentCount=t.nSegmentCount)},polyline:function(t){return t},parallelline:function(t){if(t&&t.length>=3){var e=SuperMapAlgoPlot.PlottingUtil.distance(t[0],t[1]);SuperMapAlgoPlot.PlottingUtil.isRight(t[0],t[1],t[2])&&(e=-e);for(var o=[],i=1;i<t.length;i++)o.push(t[i].clone());var l=SuperMapAlgoPlot.PlottingUtil.parallel(o,e);return t[0].x=l[0].x,t[0].y=l[0].y,[o,l]}return[]},kidney:function(t,e){if(t){var o=[];return o=e?this.getKendyShapePts(t):t,SuperMapAlgoPlot.PlottingUtil.clearSamePts(o),o}},bezier:function(t,e){if(t){var o=[];return o=e?SuperMapAlgoPlot.PlottingUtil.generateBeizerPointsNoCtrlPt(t):t,SuperMapAlgoPlot.PlottingUtil.clearSamePts(o),o}},loopbezier:function(t,e){if(t){t[0].x===t[t.length-1].x&&t[0].y===t[t.length-1].y||t.push(t[0]);var o=[];return o=e?SuperMapAlgoPlot.PlottingUtil.generateBeizerPointsNoCtrlPt(t):t,SuperMapAlgoPlot.PlottingUtil.clearSamePts(o),o}},parallelogram:function(t){if(t&&t.length>=3){var e=t[0].x+(t[2].x-t[1].x),o=t[0].y+(t[2].y-t[1].y),i=new SuperMapAlgoPlot.Point(e,o),l=[];return l.push.apply(l,t),l.push(i),l.push(l[0]),l}},polygon:function(t){if(t&&t.length>2)return t},circle:function(t){if(t&&2===t.length){for(var e=t[0],o=t[1],i=[],l=Math.sqrt((o.x-e.x)*(o.x-e.x)+(o.y-e.y)*(o.y-e.y)),n=360/this.nSegmentCount,a=0;a<this.nSegmentCount;a++){var s=(a*n+1)*Math.PI/180,r=new SuperMapAlgoPlot.Point(Math.cos(s)*l+e.x,Math.sin(s)*l+e.y);i[a]=r}return i}},rectangle:function(t){if(t&&2===t.length){var e=t[0],o=t[1],i=e.clone();return[i,new SuperMapAlgoPlot.Point(o.x,e.y),o.clone(),new SuperMapAlgoPlot.Point(e.x,o.y),i]}},sector:function(t){if(t&&t.length>=3){var e=this.getArcInfo(t[0],t[1],t[2]);e.dStartAngle*=Math.PI/180,e.dEndAngle*=Math.PI/180;var o=(e.dEndAngle-e.dStartAngle)/this.nSegmentCount,i=this.getArcSpatialData(e.pntCenter,e.dRadius,e.dRadius,0,e.dStartAngle,e.dEndAngle,o);if(i.push(e.pntCenter),0!==i.length)return i}},lune:function(t){if(t&&t.length>=3){var e=this.getArcInfo(t[0],t[1],t[2]);e.dStartAngle*=Math.PI/180,e.dEndAngle*=Math.PI/180;var o=(e.dEndAngle-e.dStartAngle)/this.nSegmentCount,i=this.getArcSpatialData(e.pntCenter,e.dRadius,e.dRadius,0,e.dStartAngle,e.dEndAngle,o);if(0!==i.length)return i}},arc:function(t){if(t&&t.length>=3){var e=this.getArcInfo(t[0],t[1],t[2]);e.dStartAngle*=Math.PI/180,e.dEndAngle*=Math.PI/180;var o=(e.dEndAngle-e.dStartAngle)/this.nSegmentCount,i=this.getArcSpatialData(e.pntCenter,e.dRadius,e.dRadius,0,e.dStartAngle,e.dEndAngle,o);if(0!==i.length)return i}},ellipse:function(t,e,o,i,l){if(!0===o){if((!i||null==i)&&t&&t.length>=3&&(i=SuperMapAlgoPlot.PlottingUtil.distance(t[0],t[1])),(!l||null==l)&&t&&t.length>=3){var n=SuperMapAlgoPlot.PlottingUtil.projectPoint(t[2],t[0],t[1]);l=SuperMapAlgoPlot.PlottingUtil.distance(n,t[2])}}else l=SuperMapAlgoPlot.PlottingUtil.distance(t[0],t[2]),i=SuperMapAlgoPlot.PlottingUtil.distance(t[0],t[1]);if(e&&null!=e?e*=Math.PI/180:e=SuperMapAlgoPlot.PlottingUtil.radian(t[0],t[1]),t&&t.length>0){var a=2*Math.PI,s=a/this.nSegmentCount,r=this.getArcSpatialData(t[0],i,l,e,0,a,s);if(!0===o){var u=Math.sin(e),p=Math.cos(e);t[2].x>t[1].x?(t[2].x=t[0].x-l*u,t[2].y=t[0].y+l*p):(t[2].x=t[0].x+l*u,t[2].y=t[0].y-l*p)}return r}},getArcSpatialData:function(t,e,o,i,l,n,a){var s=[];if(Math.abs(a)<1e-9)return s;for(;n<l;)n+=2*Math.PI;for(;n>l+2*Math.PI;)l+=2*Math.PI;var r=Math.cos(i)*e,u=Math.sin(i)*e,p=Math.cos(i)*o,h=Math.sin(i)*o,c=this.calcEllipseRadian(l,e,o),g=this.calcEllipseRadian(n,e,o);g-c<1e-5&&(g+=2*Math.PI);var y=Math.round(Math.abs((g-c)/a)+1);if(y<2)return s;for(var f=0;f<y-1;c+=a,f++){f===y-2&&(c=n);var P=t.x+r*Math.cos(c)-h*Math.sin(c),d=t.y+u*Math.cos(c)+p*Math.sin(c);s.push(new SuperMapAlgoPlot.Point(P,d))}return 0>s.length&&(s[s.length-1].x=t.x+r*Math.cos(g)-h*Math.sin(g),s[s.length-1].y=t.y+u*Math.cos(g)+p*Math.sin(g)),s},getArcCircleSpatialData:function(t,e,o,i){for(var l=[];i<o;)i+=2*Math.PI;for(;i>o+2*Math.PI;)o+=2*Math.PI;i-o<1e-10&&(i+=2*Math.PI);for(var n=(i-o)/50,a=o;a<i;a+=n){var s=t.x+e*Math.cos(a),r=t.y+e*Math.sin(a);l.push(new SuperMapAlgoPlot.Point(s,r))}var u=t.x+e*Math.cos(i),p=t.y+e*Math.sin(i);return l.push(new SuperMapAlgoPlot.Point(u,p)),l},getArcInfo:function(t,e,o){var i={};i.pntCenter=new SuperMapAlgoPlot.Point(0,0),i.dRadius=0,i.dStartAngle=0,i.dEndAngle=0;var l=e.x-t.x,n=e.y-t.y;if(Math.abs(l)<1e-9){var a={},s={};a.x=(e.x+t.x)/2,a.y=(e.y+t.y)/2,s.x=(e.x+o.x)/2,s.y=(e.y+o.y)/2;var r=0;Math.abs(o.x-e.x)>=1e-9&&(r=(o.y-e.y)/(o.x-e.x)),i.pntCenter.y=a.y,Math.abs(r)<1e-9?i.pntCenter.x=s.x:i.pntCenter.x=s.x-r*(a.y-s.y)}else{var u={},p={};u.x=(e.x+t.x)/2,u.y=(e.y+t.y)/2,p.x=(e.x+o.x)/2,p.y=(e.y+o.y)/2;var h=n/l,c=1;Math.abs(h)<1e-9?(i.pntCenter.x=u.x,Math.abs(o.x-e.x<1e-9)?i.pntCenter.y=p.y:i.pntCenter.y=-(o.x-e.x)/(o.y-e.y)*(i.pntCenter.x-p.x)+p.y):Math.abs(o.x-e.x)<1e-9?(i.pntCenter.y=p.y,i.pntCenter.x=-h*(i.pntCenter.y-u.y)+u.x):(c=(o.y-e.y)/(o.x-e.x),i.pntCenter.x=(h*c*(u.y-p.y)+c*u.x-h*p.x)/(c-h),i.pntCenter.y=(p.x-u.x+c*p.y-h*u.y)/(c-h))}var g=Math.atan2(t.y-i.pntCenter.y,t.x-i.pntCenter.x),y=Math.atan2(o.y-i.pntCenter.y,o.x-i.pntCenter.x);if(SuperMapAlgoPlot.PlottingUtil.isCounterClockwise(t,e,o)){for(;g>=2*Math.PI;)g-=2*Math.PI;for(;g<0;)g+=2*Math.PI;for(;y>2*Math.PI;)y-=2*Math.PI;for(;y<g;)y+=2*Math.PI}else{for(;y>=2*Math.PI;)y-=2*Math.PI;for(;y<0;)y+=2*Math.PI;for(;g>2*Math.PI;)g-=2*Math.PI;for(;y>g;)g+=2*Math.PI;var f=g;g=y,y=f}return i.dRadius=Math.sqrt((i.pntCenter.x-t.x)*(i.pntCenter.x-t.x)+(i.pntCenter.y-t.y)*(i.pntCenter.y-t.y)),i.dEndAngle=180*y/Math.PI,i.dStartAngle=180*g/Math.PI,i},calcEllipseRadian:function(t,e,o){var i=t,l=e*Math.sin(t),n=o*Math.cos(t),a=Math.atan2(l,n);if(t>Math.PI)for(;i>Math.PI;)i-=2*Math.PI,a+=2*Math.PI;else if(t<-Math.PI)for(;i<-Math.PI;)i+=2*Math.PI,a-=2*Math.PI;return a},getKendyShapePts:function(t){var e=[];if(2>(t=SuperMapAlgoPlot.PlottingUtil.clearSamePts(t)).length)return e;var o=this.calcShapePoints(t);if(12!=o.length)return e;o.push(o[0]),o.push(o[1]),o.splice(0,1);for(var i=0;i<o.length-3;i+=3){var l;l=this.getBezierPtsWithScalePts(o[i],o[i+1],o[i+2],o[i+3]),e=e.concat(l)}return e},calcShapePoints:function(t){var e=[],o=[],i=t.length;if(0!==i){if(1!==i){if(2==i){var l=this.calcProtudeC3(t[0],t[1]);o.push(t[0]),o.push(t[1]),o.push(l)}else if(o.push(t[0]),o.push(t[1]),o.push(t[2]),(SuperMapAlgoPlot.PlottingUtil.isSamePt(t[0],t[2])||SuperMapAlgoPlot.PlottingUtil.isSamePt(t[1],t[2]))&&(e.push(t[0]),e.push(t[1])),SuperMapAlgoPlot.PlottingUtil.isSamePt(t[0],t[1]))return e.push(t[0]),void e.push(t[2]);o=this.reNormalizeKidneyCtrlPoints(o);var n=new SuperMapAlgoPlot.Point(0,0),a=new SuperMapAlgoPlot.Point(0,0);n.x=.5*(o[0].x+o[1].x),n.y=.5*(o[0].y+o[1].y),a.x=n.x-.1*(o[2].x-n.x),a.y=n.y-.1*(o[2].y-n.y);var s=this.GetPtsByTriangle(3,0,o[1],o[0],a);e.push(s.pr),e.push(a),e.push(s.pl);var r=this.GetPtsByTriangle(4,2,o[2],o[0],o[1]);e.push(r.pr),e.push(o[1]),e.push(r.pl);var u=this.GetPtsByTriangle(2,0,o[0],o[1],o[2]);e.push(u.pr),e.push(o[2]),e.push(u.pl);var p=this.GetPtsByTriangle(4,1,o[1],o[2],o[0]);return e.push(p.pr),e.push(o[0]),e.push(p.pl),e}e.push(t[0])}},calcProtudeC3:function(t,e){var o,i=new SuperMapAlgoPlot.Point(0,0);return i.x=.5*(t.x+e.x),i.y=.5*(t.y+e.y),o=SuperMapAlgoPlot.PlottingUtil.distance(e,t)/2.7,this.GetPointsOfNormal(o,t,i).pt3},GetPointsOfNormal:function(t,e,o){var i,l=new SuperMapAlgoPlot.Point(0,0),n=new SuperMapAlgoPlot.Point(0,0),a=new SuperMapAlgoPlot.Point(0,0);return 0==(i=SuperMapAlgoPlot.PlottingUtil.distance(e,o))?(a.y=0,a.x=t):(a.x=t*(e.x-o.x)/i,a.y=t*(e.y-o.y)/i),l.x=-a.y+o.x,l.y=a.x+o.y,n.x=a.y+o.x,n.y=-a.x+o.y,{pt3:l,pt4:n}},reNormalizeKidneyCtrlPoints:function(t){var e=[];e.push(new SuperMapAlgoPlot.Point(0,0)),e.push(new SuperMapAlgoPlot.Point(0,0)),e.push(new SuperMapAlgoPlot.Point(0,0));var o=t.length;if(o<2)return e;if(2==o)e[0]=t[0],e[1]=t[1],e[2]=this.calcProtudeC3(t[0],t[1]);else{var i,l,n,a=t[0],s=t[1],r=t[2];if(i=SuperMapAlgoPlot.PlottingUtil.distance(s,a),l=SuperMapAlgoPlot.PlottingUtil.distance(r,s),n=SuperMapAlgoPlot.PlottingUtil.distance(a,r),l>=i&&l>=n){var u=a.clone();a=r.clone(),r=u.clone()}else if(n>=i&&n>=l){var p=r.clone();r=s.clone(),s=p.clone()}if(!SuperMapAlgoPlot.PlottingUtil.isRight(r,a,s)){var h=a.clone();a=s.clone(),s=h.clone()}e[0]=a,e[1]=s,e[2]=r}return e},GetPtsByTriangle:function(t,e,o,i,l){var n=new SuperMapAlgoPlot.Point(0,0),a=0,s=0;return a=SuperMapAlgoPlot.PlottingUtil.distance(l,o),s=SuperMapAlgoPlot.PlottingUtil.distance(i,l),1==e&&(a*=2),2==e&&(s*=2),n.x=(a*i.x+s*o.x)/(a+s),n.y=(a*i.y+s*o.y)/(a+s),{pl:this.GetWhichPtOfNormal(t,o,n,l),pr:this.GetWhichPtOfNormal(t,i,n,l)}},GetWhichPtOfNormal:function(t,e,o,i){var l=0;l=SuperMapAlgoPlot.PlottingUtil.distance(i,e)/t;var n=this.GetPointsOfNormal(l,o,i);return SuperMapAlgoPlot.PlottingUtil.distance(e,n.pt4)>=(l=SuperMapAlgoPlot.PlottingUtil.distance(e,n.pt3))?n.pt3:n.pt4},getBezierPtsWithScalePts:function(t,e,o,i){var l=[],n=t.x,a=t.y,s=e.x,r=e.y,u=o.x,p=o.y,h=i.x,c=i.y;if(SuperMapAlgoPlot.PlottingUtil.equalFuzzy(n,s,1e-10)&&SuperMapAlgoPlot.PlottingUtil.equalFuzzy(a,r,1e-10)&&SuperMapAlgoPlot.PlottingUtil.equalFuzzy(u,h,1e-10)&&SuperMapAlgoPlot.PlottingUtil.equalFuzzy(p,c,1e-10))l.push(new SuperMapAlgoPlot.Point(n,a)),l.push(new SuperMapAlgoPlot.Point(u,p));else for(var g=0;g<=1;g+=.03125){var y,f,P,d,S=g*g,m=S*g;y=1-3*g+3*S-m,f=3*(g-2*S+m),P=3*(S-m),d=m;var b=new SuperMapAlgoPlot.Point(y*n+f*s+P*u+d*h,y*a+f*r+P*p+d*c);l.push(b)}return l},getSpatialData:function(t,e,o,i){switch(null==i&&(i=!0),t){case 24:return this.polyline(e);case 390:return this.kidney(e,i);case 590:return this.bezier(e,i);case 360:return this.loopbezier(e,i);case 28:return this.parallelogram(e);case 32:return this.polygon(e);case 29:return this.circle(e);case 26:return this.rectangle(e);case 380:return this.sector(e);case 370:return this.lune(e);case 44:return this.arc(e);case 31:return this.ellipse(e,o,i);case 48:return this.parallelline(e);default:return e}}}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.PlottingUtil=SuperMapAlgoPlot.PlottingUtil=SuperMapAlgoPlot.PlottingUtil||{};SuperMapAlgoPlot.PlottingUtil.DEFAULT_PRECISION=14,SuperMapAlgoPlot.PlottingUtil.DPI=96,SuperMapAlgoPlot.PlottingUtil.RTOD=57.29577951308232,SuperMapAlgoPlot.PlottingUtil.DTOR=.017453292519943295,SuperMapAlgoPlot.PlottingUtil.dirAngle=function(t,e){var o,i,l,n;o=e.x,i=e.y,l=o-t.x,n=i-t.y;var a=Math.atan2(n,l);return a<0&&(a+=2*Math.PI),a},SuperMapAlgoPlot.PlottingUtil.generateUuid=function(){for(var t=[],e=0;e<36;e++)t[e]="0123456789abcdef".substr(Math.floor(16*Math.random()),1);return t[14]="4",t[19]="0123456789abcdef".substr(3&t[19]|8,1),t[8]=t[13]=t[18]=t[23]="-",t.join("")},SuperMapAlgoPlot.PlottingUtil.cloneObject=function(t){return JSON.parse(JSON.stringify(t))},SuperMapAlgoPlot.PlottingUtil.colorRGBA=function(t,e){var o=t.substring(1,3),i=parseInt(o,16),l=t.substring(3,5),n=parseInt(l,16),a=t.substring(5);return"rgba("+i+","+n+","+parseInt(a,16)+","+e+")"},SuperMapAlgoPlot.PlottingUtil.colorRGBToString=function(t){var e=t.red.toString(16);e.length<2&&(e="0"+e);var o=t.green.toString(16);o.length<2&&(o="0"+o);var i=t.blue.toString(16);return i.length<2&&(i="0"+i),"#"+e+o+i},SuperMapAlgoPlot.PlottingUtil.colorStringToRGB=function(t){var e={},o=t.substring(1,3);e.red=parseInt(o,16);var i=t.substring(3,5);e.green=parseInt(i,16);var l=t.substring(5);return e.blue=parseInt(l,16),e},SuperMapAlgoPlot.PlottingUtil.decimalToHex=function(t){for(var e=t.toString(16);e.length<8;)e="0"+e;var o=e.substring(0,2),i=e.substring(2,4),l=e.substring(4,6);return{color:"#"+e.substring(6)+l+i,alpha:parseInt(o,16)/255}},SuperMapAlgoPlot.PlottingUtil.hexToDecimal=function(t,e){var o=t.substring(1,3),i=t.substring(3,5),l=t.substring(5),n=parseInt(l+i+o,16),a=Math.round(255*e).toString(16);return parseInt(a+"000000",16)+n},SuperMapAlgoPlot.PlottingUtil.getAlign=function(t){return"TOPLEFT"===t?"lt":"TOPCENTER"===t?"ct":"TOPRIGHT"===t?"rt":"BOTTOMLEFT"===t?"lb":"BOTTOMCENTER"===t?"cb":"BOTTOMRIGHT"===t?"rb":"MIDDLELEFT"===t?"lm":"MIDDLECENTER"===t?"cm":"MIDDLERIGHT"===t?"rm":"lt"},SuperMapAlgoPlot.PlottingUtil.trim=function(t){return null==t?"":t.replace(/(^\s*)|(\s*$)/g,"")},SuperMapAlgoPlot.PlottingUtil.getTextWidth=function(t,e){" "===e&&(e="_");var o=document.createElement("span");document.body.appendChild(o),o.style.width="auto",o.style.height="auto",t.fontSize&&(o.style.fontSize=new String(t.fontSize)+"px"),t.fontFamily&&(o.style.fontFamily=t.fontFamily),t.fontWeight&&(o.style.fontWeight=t.fontWeight),o.style.position="absolute",o.style.visibility="hidden",o.style.display="inline-block",o.innerHTML=e;var i=o.clientWidth,l=e.length;return void 0===t.fontSpace&&void 0===t.fontPercent||(0!==t.fontSpace&&100!==t.fontPercent&&void 0!==t.fontSpace||void 0!==t.fontPercent?i=t.fontPercent/100*i+t.fontSpace*(t.fontPercent/100)*(l-1):0===t.fontSpace&&100!==t.fontPercent&&void 0!==t.fontPercent?i=t.fontPercent/100*i:0!==t.fontSpace&&100===t.fontPercent&&void 0!==t.fontSpace&&(i+=t.fontSpace*(l-1))),document.body.removeChild(o),i},SuperMapAlgoPlot.PlottingUtil.getTextCount=function(t){for(var e=0,o=0,i=0;i<t.length;i++)t.charCodeAt(i)>255?e++:o++;return e+o/2},SuperMapAlgoPlot.PlottingUtil.toJSON=function(t){var e=t;if(null==e)return null;switch(e.constructor){case String:return e=(e=(e=(e=(e=(e=(e='"'+e.replace(/(["\\])/g,"\\$1")+'"').replace(/\n/g,"\\n")).replace(/\r/g,"\\r")).replace("<","&lt;")).replace(">","&gt;")).replace(/%/g,"%2525")).replace(/&/g,"%26");case Array:for(var o=[],l=0,n=e.length;l<n;l++)o.push(SuperMapAlgoPlot.PlottingUtil.toJSON(e[l]));return"["+o.join(",")+"]";case Number:return isFinite(e)?String(e):null;case Boolean:return String(e);case Date:return"{'__type':\"System.DateTime\",'Year':"+e.getFullYear()+",'Month':"+(e.getMonth()+1)+",'Day':"+e.getDate()+",'Hour':"+e.getHours()+",'Minute':"+e.getMinutes()+",'Second':"+e.getSeconds()+",'Millisecond':"+e.getMilliseconds()+",'TimezoneOffset':"+e.getTimezoneOffset()+"}";default:if(null!=e.toJSON&&"function"==typeof e.toJSON)return e.toJSON();if("object"===(void 0===e?"undefined":i(e))){if(e.length){for(var a=[],s=0,r=e.length;s<r;s++)a.push(SuperMapAlgoPlot.PlottingUtil.toJSON(e[s]));return"["+a.join(",")+"]"}var u=[];for(var p in e)"function"!=typeof e[p]&&"CLASS_NAME"!==p&&"parent"!==p&&u.push('"'+p+'":'+SuperMapAlgoPlot.PlottingUtil.toJSON(e[p]));return u.length>0?"{"+u.join(",")+"}":"{}"}return e.toString()}},SuperMapAlgoPlot.PlottingUtil.copyFeature=function(t){var e=null;if(null!=t&&t.geometry){var o=t.geometry.clone();e=new SuperMap.Feature.Vector(o),t.style&&(e.style=SuperMapAlgoPlot.PlottingUtil.copyAttributes(e.style,t.style)),o.feature=e,o.calculateParts()}return e},SuperMapAlgoPlot.PlottingUtil.getSurroundLinePts=function(t,e){for(var o=[],i=[],l=0;l<t.length-1;l++){var n,a,s=[];if(!SuperMapAlgoPlot.PlottingUtil.equalFuzzy(t[l].x,t[l+1].x)||!SuperMapAlgoPlot.PlottingUtil.equalFuzzy(t[l].y,t[l+1].y)){s.push(t[l]),s.push(t[l+1]);var r=SuperMapAlgoPlot.PlottingUtil.parallel(s,e);if(n=r[0],a=r[1],0!=o.length){var u=SuperMapAlgoPlot.PlottingUtil.intersectLines(n,a,o[0],o[1]);if(u.isIntersectLines){var p=u.intersectPoint,h=SuperMapAlgoPlot.PlottingUtil.distance(n,a);SuperMapAlgoPlot.PlottingUtil.distance(p,a)>2*h?i.push(a):(i[i.length-1]=p,i.push(a))}else i.push(a)}else i.push(n),i.push(a);(o=[]).push(i[i.length-2]),o.push(i[i.length-1])}}if(t[0].x===t[t.length-1].x&&t[0].y===t[t.length-1].y&&1<i.length){var c=SuperMapAlgoPlot.PlottingUtil.intersectLines(i[0],i[1],i[i.length-2],i[i.length-1]);if(c.isIntersectLines){var g=c.intersectPoint;i[i.length-1]=g,i[0]=g}}return i},SuperMapAlgoPlot.PlottingUtil.copyFontStyle=function(t,e){void 0===t.labelAlign&&void 0!==e.labelAlign&&(t.labelAlign=e.labelAlign),!0!==t.fontSizeLimit&&(void 0!==e.fontSize&&(t.fontSize=e.fontSize),void 0!==e.fontWeight&&(t.fontWeight=e.fontWeight),void 0!==e.fontStyle&&(t.fontStyle=e.fontStyle),void 0!==e.fontSpace&&(t.fontSpace=e.fontSpace),void 0!==e.fontPercent&&(t.fontPercent=e.fontPercent)),t.strokeWidth=e.strokeWidth},SuperMapAlgoPlot.PlottingUtil.getDataFromServer=function(t,e,o,l,n,a,s,r){var u=void 0;if(void 0!==a&&(u=a),"undefined"!=typeof SuperMap&&void 0!==SuperMap.GetSymbolInfoService){var p=new SuperMap.GetSymbolInfoService(t);p.events.on({processCompleted:s,processFailed:r,scope:u});var h=new SuperMap.GetSymbolInfoParameters;h.libID=e,h.code=o,n&&SuperMapAlgoPlot.PlottingUtil.extend(h,n),l&&null!=l&&(SuperMapAlgoPlot.PlottingUtil.isArray(l)||(l=[l]),h.inputPoints=l),p.processAsync(h)}else if(void 0!==("undefined"==typeof SuperMap?"undefined":i(SuperMap))&&void 0!==i(SuperMap.REST)&&void 0!==i(SuperMap.REST.GetSymbolInfoService)){var c=new SuperMap.REST.GetSymbolInfoService(t);c.events.on({processCompleted:s,processFailed:r,scope:u});var g=new SuperMap.REST.GetSymbolInfoParameters;if(g.libID=e,g.code=o,n&&SuperMapAlgoPlot.PlottingUtil.extend(g,n),l&&null!=l&&(SuperMapAlgoPlot.PlottingUtil.isArray(l)||(l=[l]),g.inputPoints=l),n&&n.credential){var y=n.credential;c.processAsync(g,y)}else c.processAsync(g)}},SuperMapAlgoPlot.PlottingUtil.innerOutlineDir=function(t){function e(t,e){function o(t){var e=Math.atan2(t.y,t.x);return e<0&&(e+=2*Math.PI),e}var i=o(e)-o(t);return i<-Math.PI&&(i+=2*Math.PI),i>Math.PI&&(i-=2*Math.PI),i}if(t.length<3)return 1;for(var o=0,i={x:0,y:0},l={x:0,y:0},n=2;n<t.length;n++)l.x=t[n].x-t[n-1].x,l.y=t[n].y-t[n-1].y,i.x=t[n-1].x-t[n-2].x,i.y=t[n-1].y-t[n-2].y,o+=e(i,l);return l.x=t[1].x-t[0].x,l.y=t[1].y-t[0].y,i.x=t[0].x-t[t.length-1].x,i.y=t[0].y-t[t.length-1].y,(o+=e(i,l))>=0?-1:1},SuperMapAlgoPlot.PlottingUtil.isNear=function(t,e){return e||(e=SuperMapAlgoPlot.PlottingUtil.TORLERANCE_STATIC),t<e&&t>-e},SuperMapAlgoPlot.PlottingUtil.equalFuzzy=function(t,e,o){return o||(o=1e-18),Math.abs(t-e)<=o},SuperMapAlgoPlot.PlottingUtil.intersectLines=function(t,e,o,i){var l={isIntersectLines:!1};if(t.x===e.x&&t.y===e.y||o.x===i.x&&o.y===i.y)return l;var n=e.x-t.x,a=e.y-t.y,s=i.x-o.x,r=i.y-o.y,u=n*r-s*a;if(SuperMapAlgoPlot.PlottingUtil.isNear(u))return l;var p=(n*(t.y-o.y)-a*(t.x-o.x))/u,h=new SuperMapAlgoPlot.Point(0,0);return h.x=p*s+o.x,h.y=p*r+o.y,l.isIntersectLines=!0,l.intersectPoint=h,l},SuperMapAlgoPlot.PlottingUtil.getEnvelopePoints=function(t){function e(t,e){if(t.length!==e.length)return!1;for(var o=0;o<t.length;o++)if(t[o].x!==e[o].x||t[o].y!==e[o].y)return!1;return!0}function o(t,e,o){for(var i=0;i<t.length;i++)if(t[i].containsPoint(e))return o.index=i,!0;return!1}function i(t,e,o){for(var i=t.components[0].components,l=new SuperMapAlgoPlot.Point(0,0),n=0;n<i.length-1;n++)if(SuperMapAlgoPlot.PlottingUtil.intersectLineSegs(e,o,i[n],i[n+1],l))return l;return null}function l(t,e){if(0===t.length||SuperMapAlgoPlot.PlottingUtil.equalFuzzy(e[0].x,e[e.length-1].x,.5)&&SuperMapAlgoPlot.PlottingUtil.equalFuzzy(e[0].y,e[e.length-1].y,.5))return e;for(var o=e[e.length-1],i=0;i<t.length;i++)if(SuperMapAlgoPlot.PlottingUtil.equalFuzzy(t[i][0].x,o.x,.5)&&SuperMapAlgoPlot.PlottingUtil.equalFuzzy(t[i][0].y,o.y,.5)){e=e.concat(t[i]),t.splice(i,1);var n=l(t,e);if(void 0!==n&&0!==n.length)return n}else if(SuperMapAlgoPlot.PlottingUtil.equalFuzzy(t[i][t[i].length-1].x,o.x,.5)&&SuperMapAlgoPlot.PlottingUtil.equalFuzzy(t[i][t[i].length-1].y,o.y,.5)){for(var a=t[i].length-1;a>=0;a--)e.push(t[i][a]);t.splice(i,1);var s=l(t,e);if(void 0!==s&&0!==s.length)return s}return e}if(SuperMapAlgoPlot.PlottingUtil.isArray(t)||(t=[t]),0===t.length)return[];if(1===t.length)return t[0];for(var n=0;n<t.length;n++)for(var a=n+1;a<t.length;)e(t[n],t[a])?t.splice(a,1):a++;for(var s=[],r=0;r<t.length;r++)s.push(new SuperMap.Geometry.Polygon([new SuperMap.Geometry.LinearRing(t[r])]));for(var u=[],p=0;p<t.length;p++){var h=[],c=[],g=-1,y=-1,f=s.slice();f.splice(p,1);for(var P={},d=0;d<t[p].length;d++)if(o(f,t[p][d],P)){if(0!==c.length){var S=i(s[P.index],t[p][d-1],t[p][d]);S&&S!==t[p][d-1]&&S!==t[p][d]&&c.push(S),h.push(c),c=[]}}else{if(0===d&&(g=h.length),d===t[p].length-1&&(y=h.length),0===c.length&&void 0!==P.index){var m=i(s[P.index],t[p][d-1],t[p][d]);m&&m!==t[p][d-1]&&m!==t[p][d]&&c.push(m)}c.push(t[p][d].clone())}if(0!==c.length&&h.push(c),g<h.length&&y<h.length&&g!==y){for(var b=0;b<h[g].length;b++)h[y].push(h[g][b]);h.splice(g,1)}u=u.concat(h)}for(var L=[];0!==u.length;){var v=u[0];u.splice(0,1);var M=l(u,v);void 0!==M&&(v=M),v.length>2&&L.push(v)}return L},SuperMapAlgoPlot.PlottingUtil.isRight=function(t,e,o){var i=e,l=o,n=e,a=t;return(l.x-i.x)*(a.y-n.y)-(a.x-n.x)*(l.y-i.y)<0},SuperMapAlgoPlot.PlottingUtil.radian=function(t,e){var o,i,l=0;return o=e.x-t.x,i=e.y-t.y,(l=Math.atan2(i,o))<0&&(l+=2*Math.PI),l},SuperMapAlgoPlot.PlottingUtil.findBisectorPoint=function(t,e,o,i){var l=SuperMapAlgoPlot.PlottingUtil.radian(e,t),n=(l+SuperMapAlgoPlot.PlottingUtil.radian(e,o))/2,a=Math.cos(n-l+Math.PI/2),s=i;SuperMapAlgoPlot.PlottingUtil.isNear(a,.15)||(s=i/a);var r=e.x+s*Math.cos(n),u=e.y+s*Math.sin(n);return new SuperMapAlgoPlot.Point(r,u)},SuperMapAlgoPlot.PlottingUtil.findPoint=function(t,e,o,i){if(t===e||Math.abs(o)<1e-18)return t;var l=SuperMapAlgoPlot.PlottingUtil.radian(t,e)+i*Math.PI/180,n=t.x+o*Math.cos(l),a=t.y+o*Math.sin(l);return new SuperMapAlgoPlot.Point(n,a)},SuperMapAlgoPlot.PlottingUtil.isSameQuadrant=function(t,e,o,i){var l=(e.x-t.x)*(i.x-o.x),n=(e.y-t.y)*(i.y-o.y);return!(Math.abs(l)<1e-18&&Math.abs(n)<1e-18)&&((l>0||Math.abs(l)<1e-18)&&(n>0||Math.abs(n)<1e-18))},SuperMapAlgoPlot.PlottingUtil.isCross=function(t,e,o,i){var l=new SuperMapAlgoPlot.Point(0,0);return!(!SuperMapAlgoPlot.PlottingUtil.intersectLineSegs(t,e,o,i,l)||l==t||l===e||l===o||l==i)},SuperMapAlgoPlot.PlottingUtil.intersectLineSegs=function(t,e,o,i,l){if(SuperMapAlgoPlot.PlottingUtil.equalFuzzy(t.x,e.x)&&SuperMapAlgoPlot.PlottingUtil.equalFuzzy(t.y,e.y))return l.x=t.x,l.y=t.y,!1;if(SuperMapAlgoPlot.PlottingUtil.equalFuzzy(o.x,i.x)&&SuperMapAlgoPlot.PlottingUtil.equalFuzzy(o.y,i.y))return l.x=o.x,l.y=o.y,!1;var n=0,a=0;if(n=t.x>e.x?t.x:e.x,a=t.x<e.x?t.x:e.x,o.x-n>1e-16&&i.x-n>1e-16||o.x-a<-1e-16&&i.x-a<-1e-16)return!1;if(n=t.y>e.y?t.y:e.y,a=t.y<e.y?t.y:e.y,o.y-n>1e-16&&i.y-n>1e-16||o.y-a<-1e-16&&i.y-a<-1e-16)return!1;var s=e.x-t.x,r=e.y-t.y,u=i.x-o.x,p=i.y-o.y,h=t.x-o.x,c=t.y-o.y,g=s*p-u*r,y=g;if(Math.abs(s)>1e-18&&Math.abs(u)>1e-18&&(y/=s*u),Math.abs(y)<1e-18)return t===o?(l.x=t.x,l.y=t.y,!SuperMapAlgoPlot.PlottingUtil.isSameQuadrant(t,e,o,i)):e===i?(l.x=e.x,l.y=e.y,!SuperMapAlgoPlot.PlottingUtil.isSameQuadrant(t,e,o,i)):t===i?(l.x=t.x,l.y=t.y,SuperMapAlgoPlot.PlottingUtil.isSameQuadrant(t,e,o,i)):e===o&&(l.x=e.x,l.y=e.y,SuperMapAlgoPlot.PlottingUtil.isSameQuadrant(t,e,o,i));var f=(s*c-r*h)/g,P=(u*c-p*h)/g;return!(f<0&&(Math.abs(f*u)>1e-16||Math.abs(f*p)>1e-16))&&(!(f>1&&(Math.abs((f-1)*u)>1e-16||Math.abs((f-1)*p)>1e-16))&&(!(P<0&&(Math.abs(P*s)>1e-16||Math.abs(P*r)>1e-16))&&(!(P>1&&(Math.abs((P-1)*s)>1e-16||Math.abs((P-1)*r)>1e-16))&&(Math.abs(f)<1e-18?(l.x=o.x,l.y=o.y,!0):Math.abs(f-1)<1e-18?(l.x=i.x,l.y=i.y,!0):Math.abs(P)<1e-18?(l.x=t.x,l.y=t.y,!0):Math.abs(P-1)<1e-18?(l.x=e.x,l.y=e.y,!0):!(f<0&&(Math.abs(f*u)>1e-16||Math.abs(f*p)>1e-16))&&(!(f>1&&(Math.abs((f-1)*u)>1e-16||Math.abs((f-1)*p)>1e-16))&&(!(P<0&&(Math.abs(P*s)>1e-16||Math.abs(P*r)>1e-16))&&(!(P>1&&(Math.abs((P-1)*s)>1e-16||Math.abs((P-1)*r)>1e-16))&&(l.x=f*u+o.x,l.y=f*p+o.y,!0))))))))},SuperMapAlgoPlot.PlottingUtil.parallel=function(t,e){var o=[],i=t.length;if(!t||null==t||t.length<2)return o;var l=!1;t.length>3&&t[0].x===t[t.length-1].x&&t[0].y===t[t.length-1].y&&(l=!0),l?(o[0]=SuperMapAlgoPlot.PlottingUtil.findBisectorPoint(t[t.length-2],t[0],t[1],e),o[t.length-1]=o[0]):(o[0]=SuperMapAlgoPlot.PlottingUtil.findPoint(t[0],t[1],e,90),o[t.length-1]=SuperMapAlgoPlot.PlottingUtil.findPoint(t[t.length-1],t[t.length-2],-e,90));for(var n=t[0],a=t[1],s=t[1],r=1;r<t.length-1;r++)if(a=t[r],t[r]!==t[r-1]&&(n=t[r-1]),t[r]!==t[r+1]){s=t[r+1];var u=SuperMapAlgoPlot.PlottingUtil.findBisectorPoint(n,a,s,e);SuperMapAlgoPlot.PlottingUtil.isCross(n,o[r-1],a,u)&&(u=o[r-1]),o[r]=u}else{for(var p=r;p<i-1;){if(t[p]!==t[p+1]){s=t[p+1];break}p++}if(p<i-1){var h=SuperMapAlgoPlot.PlottingUtil.FindBisectorPoint(n,a,s,e);for(SuperMapAlgoPlot.PlottingUtil.isCross(n,o[r-1],a,h)&&(h=o[r-1]);r<p;)o[r]=h,r++;r=p-1}}return o},SuperMapAlgoPlot.PlottingUtil.distance=function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},SuperMapAlgoPlot.PlottingUtil.projectPoint=function(t,e,o){if(e===o)return e;var i=new SuperMapAlgoPlot.Point(0,0),l=o.x-e.x,n=e.y-o.y,a=l*l,s=n*n,r=l*n,u=l*l+n*n;return i.x=(r*(e.y-t.y)+e.x*s+t.x*a)/u,i.y=(r*(e.x-t.x)+e.y*a+t.y*s)/u,i},SuperMapAlgoPlot.PlottingUtil.pointToLineDis=function(t,e,o){var i=SuperMapAlgoPlot.PlottingUtil.projectPoint(t,e,o);return SuperMapAlgoPlot.PlottingUtil.distance(t,i)},SuperMapAlgoPlot.PlottingUtil.pointToPloyLineDis=function(t,e,o){if(e===o)return SuperMapAlgoPlot.PlottingUtil.distance(t,e);var i=(e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y),l=(o.x-t.x)*(o.x-t.x)+(o.y-t.y)*(o.y-t.y),n=(e.x-o.x)*(e.x-o.x)+(e.y-o.y)*(e.y-o.y),a=(i+n-l)/(2*n);a<0?a=0:a>1&&(a=1);var s=(o.x-e.x)*a+e.x,r=(o.y-e.y)*a+e.y,u=(s-t.x)*(s-t.x)+(r-t.y)*(r-t.y);return Math.sqrt(u)},SuperMapAlgoPlot.PlottingUtil.isCounterClockwise=function(t,e,o){return(o.x-e.x)*(t.y-e.y)-(t.x-e.x)*(o.y-e.y)>0},SuperMapAlgoPlot.PlottingUtil.clearSamePts=function(t){for(var e=t.length,o=0;o<e-1;)SuperMapAlgoPlot.PlottingUtil.equalFuzzy(t[o].x,t[o+1].x)&&SuperMapAlgoPlot.PlottingUtil.equalFuzzy(t[o].y,t[o+1].y)?(t.splice(o,1),e--):o++;return t},SuperMapAlgoPlot.PlottingUtil.getBeizerCtrlPt=function(t){var e=[],o=t.length;if(o<3)for(var i=0;i<o;++i)e[i]=t[i].clone();else{for(var l=0,n=0;n<3*o-2;n+=3)e[n]=t[l].clone(),e[n+1]=new SuperMapAlgoPlot.Point(0,0),e[n+2]=new SuperMapAlgoPlot.Point(0,0),l++;for(var a=1;a<o-1;a++)SuperMapAlgoPlot.PlottingUtil.getTrianglePoints(8,3,t[a-1],t[a],t[a+1],e[3*a+1],e[3*a+2]);SuperMapAlgoPlot.PlottingUtil.getTrapezoidPoints(.6,e[0],e[3],e[4],e[2]),SuperMapAlgoPlot.PlottingUtil.getTrapezoidPoints(.6,e[3*o-3],e[3*o-6],e[3*o-4],e[3*o-2]),e[1]=t[0].clone(),e[3*o-1]=t[o-1].clone()}return e},SuperMapAlgoPlot.PlottingUtil.generateBeizerPointsNoCtrlPt=function(t,e){var o=t.slice();!0===e&&o.push(o[0]);var i=SuperMapAlgoPlot.PlottingUtil.getBeizerCtrlPt(o);return SuperMapAlgoPlot.PlottingUtil.generateBeizerPointsWithCtrlPt(i)},SuperMapAlgoPlot.PlottingUtil.generateBeizerPointsWithCtrlPt=function(t){var e=t.length,o=[];if(t.length<3)for(var i=0;i<e;i++)o[i]=t[i].clone();else for(var l=0;l<e;l+=3)if(!(l+4>=e)){var n=t[l].x,a=t[l].y,s=t[l+2].x,r=t[l+2].y,u=t[l+4].x,p=t[l+4].y,h=t[l+3].x,c=t[l+3].y;if(SuperMapAlgoPlot.PlottingUtil.equalFuzzy(n,s,1e-10)&&SuperMapAlgoPlot.PlottingUtil.equalFuzzy(a,r,1e-10)&&SuperMapAlgoPlot.PlottingUtil.equalFuzzy(u,h,1e-10)&&SuperMapAlgoPlot.PlottingUtil.equalFuzzy(p,c,1e-10))o.push(new SuperMapAlgoPlot.Point(n,a)),o.push(new SuperMapAlgoPlot.Point(u,p));else for(var g=0;g<=1;g+=.03125){var y,f,P,d,S=g*g,m=S*g;y=1-3*g+3*S-m,f=3*(g-2*S+m),P=3*(S-m),d=m;var b=new SuperMapAlgoPlot.Point(y*n+f*s+P*u+d*h,y*a+f*r+P*p+d*c);o.push(b)}}return o},SuperMapAlgoPlot.PlottingUtil.computeBeizerPoints0=function(t,e,o){var i=SuperMapAlgoPlot.PlottingUtil.polylineDistance(e),l=[],n=[],a=[];if(t){n.push(e[0]);var s=o[0],r=o[1],u=e[0].x+i*s,p=e[0].y+i*r;n.push(new SuperMapAlgoPlot.Point(u,p)),l.push(new SuperMapAlgoPlot.Point(u,p));for(var h=1;h<e.length-1;h++){var c=o[4*h-2],g=o[4*h-1],y=e[h].x+i*c,f=e[h].y+i*g;n.push(new SuperMapAlgoPlot.Point(y,f)),l.push(new SuperMapAlgoPlot.Point(y,f)),n.push(new SuperMapAlgoPlot.Point(e[h].x,e[h].y)),c=o[4*h],g=o[4*h+1],y=e[h].x+i*c,f=e[h].y+i*g,n.push(new SuperMapAlgoPlot.Point(y,f)),l.push(new SuperMapAlgoPlot.Point(y,f))}var P=e.length-1;s=o[4*P-2],r=o[4*P-1],u=e[P].x+i*s,p=e[P].y+i*r,n.push(new SuperMapAlgoPlot.Point(u,p)),l.push(new SuperMapAlgoPlot.Point(u,p)),n.push(new SuperMapAlgoPlot.Point(e[P].x,e[P].y)),n.push(new SuperMapAlgoPlot.Point(e[P].x,e[P].y)),n.push(new SuperMapAlgoPlot.Point(e[P].x,e[P].y)),a=SuperMapAlgoPlot.PlottingUtil.generateBeizerPointsWithCtrlPt(n)}else{o=[];var d=(n=SuperMapAlgoPlot.PlottingUtil.getBeizerCtrlPt(e))[1].x-n[0].x,S=n[1].y-n[0].y,m=d/i,b=S/i;o.push(m),o.push(b),l.push(n[1]);for(var L=1;L<e.length-1;L++){var v=(n[3*L-1].x-n[3*L].x)/i,M=(n[3*L-1].y-n[3*L].y)/i;o.push(v),o.push(M),l.push(n[3*L-1]);var A=(n[3*L+1].x-n[3*L].x)/i,T=(n[3*L+1].y-n[3*L].y)/i;o.push(A),o.push(T),l.push(n[3*L+1])}m=(d=n[3*(e.length-1)-1].x-n[3*(e.length-1)].x)/i,b=(S=n[3*(e.length-1)-1].y-n[3*(e.length-1)].y)/i,o.push(m),o.push(b),l.push(n[3*(e.length-1)-1]),a=SuperMapAlgoPlot.PlottingUtil.generateBeizerPointsWithCtrlPt(n)}return{scalePoints:l,scaleValues:o,beizerPoints:a}},SuperMapAlgoPlot.PlottingUtil.computeBeizerPoints=function(t,e,o){var i=SuperMapAlgoPlot.PlottingUtil.polylineDistance(e),l=[],n=[],a=[];if(t){n.push(new SuperMapAlgoPlot.Point(e[0].x,e[0].y)),n.push(new SuperMapAlgoPlot.Point(e[0].x,e[0].y));var s=o[0],r=o[1],u=e[0].x+i*s,p=e[0].y+i*r;n.push(new SuperMapAlgoPlot.Point(u,p)),l.push(new SuperMapAlgoPlot.Point(u,p));for(var h=1;h<e.length-1;h++){n.push(new SuperMapAlgoPlot.Point(e[h].x,e[h].y));var c=o[4*h-2],g=o[4*h-1],y=e[h].x+i*c,f=e[h].y+i*g;n.push(new SuperMapAlgoPlot.Point(y,f)),l.push(new SuperMapAlgoPlot.Point(y,f)),c=o[4*h],g=o[4*h+1],y=e[h].x+i*c,f=e[h].y+i*g,n.push(new SuperMapAlgoPlot.Point(y,f)),l.push(new SuperMapAlgoPlot.Point(y,f))}var P=e.length-1;n.push(new SuperMapAlgoPlot.Point(e[P].x,e[P].y)),s=o[4*P-2],r=o[4*P-1],u=e[P].x+i*s,p=e[P].y+i*r,n.push(new SuperMapAlgoPlot.Point(u,p)),l.push(new SuperMapAlgoPlot.Point(u,p)),n.push(new SuperMapAlgoPlot.Point(e[P].x,e[P].y)),a=SuperMapAlgoPlot.PlottingUtil.generateBeizerPointsWithCtrlPt(n)}else{o=[];var d=(n=SuperMapAlgoPlot.PlottingUtil.getBeizerCtrlPt(e))[2].x-n[0].x,S=n[2].y-n[0].y,m=d/i,b=S/i;o.push(m),o.push(b),l.push(n[2]);for(var L=1;L<e.length-1;L++){var v=(n[3*L+1].x-n[3*L].x)/i,M=(n[3*L+1].y-n[3*L].y)/i;o.push(v),o.push(M),l.push(n[3*L+1]);var A=(n[3*L+2].x-n[3*L].x)/i,T=(n[3*L+2].y-n[3*L].y)/i;o.push(A),o.push(T),l.push(n[3*L+2])}m=(d=n[3*(e.length-1)+1].x-n[3*(e.length-1)].x)/i,b=(S=n[3*(e.length-1)+1].y-n[3*(e.length-1)].y)/i,o.push(m),o.push(b),l.push(n[3*(e.length-1)+1]),a=SuperMapAlgoPlot.PlottingUtil.generateBeizerPointsWithCtrlPt(n)}return{scalePoints:l,scaleValues:o,beizerPoints:a}},SuperMapAlgoPlot.PlottingUtil.getTrianglePoints=function(t,e,o,i,l,n,a){var s=o.x,r=o.y,u=i.x,p=i.y,h=l.x,c=l.y;SuperMapAlgoPlot.PlottingUtil.getPointsByTriangle(t,e,s,r,u,p,h,c,n,a)},SuperMapAlgoPlot.PlottingUtil.getPointsByTriangle=function(t,e,o,i,l,n,a,s,r,u){var p=l+(a-o),h=n+(s-i),c=0,g=0;if(o==a)c=o,g=h;else if(i==s)c=p,g=i;else{var y=1*(s-i)/(a-o),f=i-o*y;g=y*(c=(h+p/y-f)/(y+1/y))+f}var P=Math.sqrt(1*(l-p)*(l-p)+1*(n-h)*(n-h)),d=Math.sqrt(1*(o-l)*(o-l)+1*(i-n)*(i-n)),S=Math.sqrt(1*(l-a)*(l-a)+1*(n-s)*(n-s)),m=0;p=c+(p-c)*(m=d+S?1+(S-d)*t/(S+d):1),h=g+(h-g)*m,0==P&&(P=1),r.x=l+(l-p)*d/(e*P),r.y=n+(n-h)*d/(e*P),u.x=l+(p-l)*S/(e*P),u.y=n+(h-n)*S/(e*P)},SuperMapAlgoPlot.PlottingUtil.getTrapezoidPoints=function(t,e,o,i,l){var n=e.x,a=e.y,s=o.x,r=o.y,u=i.x,p=i.y;return SuperMapAlgoPlot.PlottingUtil.getPointsByTrapezoid(t,n,a,s,r,u,p,l)},SuperMapAlgoPlot.PlottingUtil.getPointsByTrapezoid=function(t,e,o,i,l,n,a,s){var r=0,u=0,p=0,h=0;if(0==Math.abs(o-l))r=e+i-n,u=a;else if(0==Math.abs(e-i))r=n,u=o+l-a;else{var c=1*(o-l)/(e-i),g=a-c*n;u=c*(r=((l+o)/2+(e+i)/(2*c)-g)/(c+1/c))+g,r=2*r-n,u=2*u-a}var y=Math.sqrt(1*(e-i)*(e-i)+1*(o-l)*(o-l)),f=Math.sqrt(1*(e-r)*(e-r)+1*(o-u)*(o-u));return y>0?(p=e+(i-e)*f/y,h=o+(l-o)*f/y):(p=e,h=o),s.x=p+(r-p)*t,s.y=h+(u-h)*t,s},SuperMapAlgoPlot.PlottingUtil.pointIsOnPolyLine=function(t,e,o){if(SuperMapAlgoPlot.PlottingUtil.equalFuzzy(t.x,e.x)&&SuperMapAlgoPlot.PlottingUtil.equalFuzzy(t.y,e.y)||SuperMapAlgoPlot.PlottingUtil.equalFuzzy(t.x,o.x)&&SuperMapAlgoPlot.PlottingUtil.equalFuzzy(t.y,o.y))return!0;var i=t.x-e.x,l=t.y-e.y,n=t.x-o.x,a=t.y-o.y,s=(i*n+l*a)/(Math.sqrt(i*i+l*l)*Math.sqrt(n*n+a*a));return!!SuperMapAlgoPlot.PlottingUtil.equalFuzzy(s,-1,.1)},SuperMapAlgoPlot.PlottingUtil.pointIsOnPolyLines=function(t,e){if(!e||0===e.length)return{isOnPolyLine:!1,index:-1};for(var o=!1,i=-1,l=0;l<e.length-1;l++)if(o=SuperMapAlgoPlot.PlottingUtil.pointIsOnPolyLine(t,e[l],e[l+1])){i=l;break}return{isOnPolyLine:o,index:i}},SuperMapAlgoPlot.PlottingUtil.computePointToLineMinDis=function(t,e){for(var o=-1,i=-1,l=0;l<e.length-1;l++){var n=e[l],a=e[l+1],s=SuperMapAlgoPlot.PlottingUtil.projectPoint(t,n,a);if(SuperMapAlgoPlot.PlottingUtil.pointIsOnPolyLine(s,n,a)){var r=SuperMapAlgoPlot.PlottingUtil.distance(t,s);o<0?(o=r,i&&(i=l)):o>r&&(o=r,i=l)}}return i&&o<0&&(i=-1),{minDis:o,index:i}},SuperMapAlgoPlot.PlottingUtil.findPointInLine=function(t,e,o){if(t===e||Math.abs(o)<1e-18)return t;var i=e.x-t.x,l=e.y-t.y,n=o/Math.sqrt(i*i+l*l),a=t.x+i*n,s=t.y+l*n;return new SuperMapAlgoPlot.Point(a,s)},SuperMapAlgoPlot.PlottingUtil.operateControlPoints=function(t){var e=t,o=e.length;if(3==o){var i=new SuperMapAlgoPlot.Point(0,0);SuperMapAlgoPlot.PlottingUtil.getTrapezoidPoints(1,t[0],t[1],t[2],i),e.push(i)}if(o>4&&(e.splice(4,o-4),o=e.length),SuperMapAlgoPlot.PlottingUtil.pointIsRightToLine(t[0],t[1],e[2])){var l=e[0];e[0]=e[1],e[1]=l}if(!SuperMapAlgoPlot.PlottingUtil.pointIsRightToVerticle(e[0],e[1],e[2])){var n=e[2];e[2]=e[3],e[3]=n}return e},SuperMapAlgoPlot.PlottingUtil.pointIsRightToLine=function(t,e,o){return(e.x-t.x)*(o.y-t.y)-(o.x-t.x)*(e.y-t.y)<0},SuperMapAlgoPlot.PlottingUtil.pointIsRightToVerticle=function(t,e,o){var i=new SuperMapAlgoPlot.Point(.5*(e.x+t.x),.5*(e.y+t.y)),l=new SuperMapAlgoPlot.Point(e.x-t.x,e.y-t.y),n=new SuperMapAlgoPlot.Point(o.x-i.x,o.y-i.y);return l.x*n.x+l.y*n.y>0},SuperMapAlgoPlot.PlottingUtil.linePnt=function(t,e,o){var i=SuperMapAlgoPlot.PlottingUtil.distance(t,e);if(0==i)return t;var l=o/i;return SuperMapAlgoPlot.PlottingUtil.findPointOnLineByRatio(l,t,e)},SuperMapAlgoPlot.PlottingUtil.findPointOnLineByRatio=function(t,e,o){var i=new SuperMapAlgoPlot.Point(0,0);return i.x=e.x+(o.x-e.x)*t,i.y=e.y+(o.y-e.y)*t,i},SuperMapAlgoPlot.PlottingUtil.rotateAngle=function(t,e,o){var i=e,l=Math.cos(i),n=Math.sin(i),a=o.x-t.x,s=o.y-t.y;return o.x=a*l-s*n+t.x,o.y=a*n+s*l+t.y,o},SuperMapAlgoPlot.PlottingUtil.resize=function(t,e,o){return o.x=t.x+e*(o.x-t.x),o.y=t.y+e*(o.y-t.y),o},SuperMapAlgoPlot.PlottingUtil.findPointInPolyLine=function(t,e){if(e<0||t.length<2)return{index:-1,pt:null};if(Math.abs(e)<1e-18)return{index:0,pt:t[0]};for(var o=0,i=0;i<t.length-1;i++)if((o+=SuperMapAlgoPlot.PlottingUtil.distance(t[i],t[i+1]))>e||SuperMapAlgoPlot.PlottingUtil.equalFuzzy(o,e)){var l=o-e,n=t[i+1],a=t[i],s=l/SuperMapAlgoPlot.PlottingUtil.distance(n,a),r=new SuperMapAlgoPlot.Point(0,0);return r.x=n.x+(a.x-n.x)*s,r.y=n.y+(a.y-n.y)*s,{index:i,pt:r}}return{index:-1,pt:null}},SuperMapAlgoPlot.PlottingUtil.polylineDistance=function(t){if(0===t.length)return 0;for(var e=0,o=0;o<t.length-1;o++)e+=SuperMapAlgoPlot.PlottingUtil.distance(t[o],t[o+1]);return e},SuperMapAlgoPlot.PlottingUtil.rotate=function(t,e,o,i){var l=i.x-t.x,n=i.y-t.y,a=l*e-n*o+t.x,s=l*o+n*e+t.y;return new SuperMapAlgoPlot.Point(a,s)},SuperMapAlgoPlot.PlottingUtil.getIncentrePointOnSegmentByScale=function(t,e,o){var i=e.x,l=e.y,n=o.x,a=o.y,s=Math.sqrt(1*(i-n)*(i-n)+1*(l-a)*(l-a)),r=0,u=0;return 0==s?(r=i,u=l):(r=i+(n-i)*t/s,u=l+(a-l)*t/s),new SuperMapAlgoPlot.Point(r,u)},SuperMapAlgoPlot.PlottingUtil.getExcentrePointOnSegmentByScale=function(t,e,o){var i=e.x,l=e.y,n=o.x,a=o.y,s=0,r=0,u=Math.sqrt(1*(i-n)*(i-n)+1*(l-a)*(l-a));return 0===u?(s=i,r=l):(s=i+(i-n)*t/u,r=l+(l-a)*t/u),new SuperMapAlgoPlot.Point(s,r)},SuperMapAlgoPlot.PlottingUtil.getSidePointsOfLine=function(t,e,o){var i=e.x,l=e.y,n=o.x,a=o.y,s=Math.sqrt(1*(i-n)*(i-n)+1*(l-a)*(l-a)),r=0,u=0;0==s?(u=0,r=t):(r=t*(i-n)/s,u=t*(l-a)/s);var p=-u+n,h=+r+a,c=+u+n,g=-r+a;return{pntLeft:new SuperMapAlgoPlot.Point(c,g),pntRight:new SuperMapAlgoPlot.Point(p,h)}},SuperMapAlgoPlot.PlottingUtil.pointProjectToSegment=function(t,e,o){var i=0,l=0,n=0,a=1,s=void 0,r=void 0;if(l=e.x!==t.x?(e.y-t.y)/(e.x-t.x):1.7976931348623157e308,n=o.x!==t.x?(o.y-t.y)/(o.x-t.x):1.7976931348623157e308,i=o.y!==e.y?(o.x-e.x)/(e.y-o.y):1.7976931348623157e308,(s=e.x>=t.x&&e.y>=t.y?1:e.x<t.x&&e.y>t.y?2:e.x<=t.x&&e.y<=t.y?3:4)==(r=o.x>t.x&&o.y>t.y?1:o.x<t.x&&o.y>t.y?2:o.x<t.x&&o.y<t.y?3:4))(l<i&&n<i||l>i&&n>i)&&(a=0);else switch(s){case 1:(4==r&&l<i||2==r&&l>i)&&(a=0);break;case 2:(1==r&&l<i||3==r&&l>i)&&(a=0);break;case 3:(2==r&&l<i||4==r&&l>i)&&(a=0);break;case 4:(3==r&&l<i||1==r&&l>i)&&(a=0)}var u=new SuperMapAlgoPlot.Point(0,0);return SuperMapAlgoPlot.PlottingUtil.equalFuzzy(i-1.7976931348623157e308,0)?(u.x=t.x,u.y=e.y):SuperMapAlgoPlot.PlottingUtil.equalFuzzy(i,0)?(u.x=e.x,u.y=t.y):(u.x=(i*(e.y-t.y)+i*i*t.x+e.x)/(i*i+1),u.y=t.y+i*(u.x-t.x)),{isOnline:1===a,projectPoint:u}},SuperMapAlgoPlot.PlottingUtil.coordinateTrans=function(t,e,o){var i=SuperMapAlgoPlot.PlottingUtil.distance(new SuperMapAlgoPlot.Point(0,0),e),l=SuperMapAlgoPlot.PlottingUtil.radian(new SuperMapAlgoPlot.Point(0,0),e)+o*Math.PI/180,n=i*Math.cos(l)+t.x,a=i*Math.sin(l)+t.y;return new SuperMapAlgoPlot.Point(n,a)},SuperMapAlgoPlot.PlottingUtil.triangleHeightAndPartBottomLen=function(t,e,o){var i=void 0,l=void 0,n=(o.x-e.x)*(o.x-e.x)+(o.y-e.y)*(o.y-e.y),a=Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y)),s=Math.sqrt((t.x-o.x)*(t.x-o.x)+(t.y-o.y)*(t.y-o.y));if(0==s||0==a)i=0,l=0;else if(0==n)i=a,l=0;else{var r=(a*a+s*s-n)/2/a/s,u=0;r>=1?(r=1,u=0):u=Math.sqrt(1-r*r),i=s*r,l=s*u}return{dLen1:i,dLen2:l}},SuperMapAlgoPlot.PlottingUtil.paraLine=function(t,e,o){var i=[];if(2>t.length)return i;if(o){var l=t[1].clone();l=SuperMapAlgoPlot.PlottingUtil.rotateAngle(t[0],Math.PI/2,l),i.push(SuperMapAlgoPlot.PlottingUtil.linePnt(t[0],l,e));for(var n=1;n<t.length-1;n++)if(!SuperMapAlgoPlot.PlottingUtil.equalFuzzy(t[n].x,t[n+1].x)||!SuperMapAlgoPlot.PlottingUtil.equalFuzzy(t[n].y,t[n+1].y)){for(var a=SuperMapAlgoPlot.PlottingUtil.radian(t[n],t[n+1]),s=SuperMapAlgoPlot.PlottingUtil.radian(t[n],t[n-1])-a;s<0;)s+=2*Math.PI;var r=s/2,u=void 0;u=r>Math.PI/2?r-Math.PI/2:Math.PI/2-r;var p=e/Math.cos(u);l=t[n+1].clone(),l=SuperMapAlgoPlot.PlottingUtil.rotateAngle(t[n],r,l),i.push(SuperMapAlgoPlot.PlottingUtil.linePnt(t[n],l,p))}l=t[t.length-2].clone(),l=SuperMapAlgoPlot.PlottingUtil.rotateAngle(t[t.length-1],-1*Math.PI/2,l),i.push(SuperMapAlgoPlot.PlottingUtil.linePnt(t[t.length-1],l,e))}else{var h=t[1].clone();h=SuperMapAlgoPlot.PlottingUtil.rotateAngle(t[0],-Math.PI/2,h),i.push(SuperMapAlgoPlot.PlottingUtil.linePnt(t[0],h,e));for(var c=1;c<t.length-1;c++)if(!SuperMapAlgoPlot.PlottingUtil.equalFuzzy(t[c].x,t[c+1].x)||!SuperMapAlgoPlot.PlottingUtil.equalFuzzy(t[c].y,t[c+1].y)){for(var g=SuperMapAlgoPlot.PlottingUtil.radian(t[c],t[c+1]),y=SuperMapAlgoPlot.PlottingUtil.radian(t[c],t[c-1])-g;y<0;)y+=2*Math.PI;var f=Math.PI-y/2,P=void 0;P=f>Math.PI/2?f-Math.PI/2:Math.PI/2-f;var d=e/Math.cos(P);h=t[c-1].clone(),h=SuperMapAlgoPlot.PlottingUtil.rotateAngle(t[c],f,h),i.push(SuperMapAlgoPlot.PlottingUtil.linePnt(t[c],h,d))}h=t[t.length-2].clone(),h=SuperMapAlgoPlot.PlottingUtil.rotateAngle(t[t.length-1],Math.PI/2,h),i.push(SuperMapAlgoPlot.PlottingUtil.linePnt(t[t.length-1],h,e))}return i},SuperMapAlgoPlot.PlottingUtil.circlePoint=function(t,e,o,i){i*=Math.PI/180;var l=t.x+e*Math.cos(i),n=t.y+o*Math.sin(i);return new SuperMapAlgoPlot.Point(l,n)},SuperMapAlgoPlot.PlottingUtil.getPolygonCenterPt=function(t){if(!t||0===t.length)return null;for(var e=0,o=0,i=0;i<t.length;i++)e+=t[i].x,o+=t[i].y;return new SuperMapAlgoPlot.Point(e/t.length,o/t.length)},SuperMapAlgoPlot.PlottingUtil.ptIsInPolygon=function(t,e){if(!t||0===t.length)return!1;for(var o=0,i=t.length,l=0;l<i;l++){var n=t[l],a=t[(l+1)%i];if(n.y!==a.y){var s=n.y<a.y?n.y:a.y,r=n.y>a.y?n.y:a.y;if(!(e.y<s||e.y>r))(e.y-n.y)*(a.x-n.x)/(a.y-n.y)+n.x>e.x&&o++}}return o%2==1},SuperMapAlgoPlot.PlottingUtil.projectPtOnPolyLine=function(t,e){if(2>e.length)return{index:-1,pt:null};for(var o=0;o<e.length-1;o++){var i=SuperMapAlgoPlot.PlottingUtil.pointProjectToSegment(t,e[o],e[o+1]);if(i.isOnline)return{index:o,pt:i.projectPoint}}return{index:-1,pt:null}},SuperMapAlgoPlot.PlottingUtil.isPloyClockwise=function(t){var e=SuperMapAlgoPlot.PlottingUtil.clonePoints(t),o=e.length;if(!(o<3)){var i=e[0].y*(e[o-1].x-e[1].x);e.push(e[0].clone());for(var l=1;l<o;++l)i+=e[l].y*(e[l-1].x-e[l+1].x);return i>0?0:1}},SuperMapAlgoPlot.PlottingUtil.isSamePt=function(t,e){return!(!SuperMapAlgoPlot.PlottingUtil.equalFuzzy(t.x,e.x)||!SuperMapAlgoPlot.PlottingUtil.equalFuzzy(t.y,e.y))},SuperMapAlgoPlot.PlottingUtil.getPtsIndexByDistance=function(t,e){var o=SuperMapAlgoPlot.PlottingUtil.findPointInPolyLine(e,t);return{index:o.index,pts:o.pt,bfind:-1!==o.index}},SuperMapAlgoPlot.PlottingUtil.ptInBounds=function(t,e){return t.x>e.left&&t.x<e.right&&t.y<e.top&&t.y>e.bottom},SuperMapAlgoPlot.PlottingUtil.InnerAngle=function(t,e,o){if(t==e||t==o)return 0;var i=SuperMapAlgoPlot.PlottingUtil.distance(t,e),l=SuperMapAlgoPlot.PlottingUtil.distance(t,o),n=SuperMapAlgoPlot.PlottingUtil.distance(e,o),a=(i*i+l*l-n*n)/(2*i*l);return a>1&&SuperMapAlgoPlot.PlottingUtil.equalFuzzy(a,1)?a=1:a<1&&SuperMapAlgoPlot.PlottingUtil.equalFuzzy(a,-1)&&(a=-1),Math.acos(a)},SuperMapAlgoPlot.PlottingUtil.plumbLineLen=function(t,e,o){return SuperMapAlgoPlot.PlottingUtil.distance(t,e)*Math.sin(SuperMapAlgoPlot.PlottingUtil.InnerAngle(e,t,o))},SuperMapAlgoPlot.PlottingUtil.paraPolygon=function(t,e,o){var i=[],l=SuperMapAlgoPlot.PlottingUtil.clonePoints(t),n=l.length;if(n<2)return i;var a=new SuperMapAlgoPlot.Point(0,0);if(o){if(n<3)a=l[1].clone(),SuperMapAlgoPlot.PlottingUtil.rotateAngle(l[0],Math.PI,a),i.push(SuperMapAlgoPlot.PlottingUtil.linePnt(l[0],a,e));else{for(var s=SuperMapAlgoPlot.PlottingUtil.radian(l[0],l[1]),r=SuperMapAlgoPlot.PlottingUtil.radian(l[0],l[l.length-1])-s;r<0;)r+=2*Math.PI;var u=r/2,p=void 0;p=u>Math.PI/2?u-Math.PI/2:Math.PI/2-u;var h=e/Math.cos(p);a=l[1].clone(),a=SuperMapAlgoPlot.PlottingUtil.rotateAngle(l[0],u,a),i.push(SuperMapAlgoPlot.PlottingUtil.linePnt(l[0],a,h))}for(var c=1;c<n-1;c++){for(var g=SuperMapAlgoPlot.PlottingUtil.radian(l[c],l[c+1]),y=SuperMapAlgoPlot.PlottingUtil.radian(l[c],l[c-1])-g;y<0;)y+=2*Math.PI;var f=y/2,P=void 0;P=f>Math.PI/2?f-Math.PI/2:Math.PI/2-f;var d=e/Math.cos(P);a=l[c+1].clone(),a=SuperMapAlgoPlot.PlottingUtil.rotateAngle(l[c],f,a),i.push(SuperMapAlgoPlot.PlottingUtil.linePnt(l[c],a,d))}if(n<3)a=l[n-2].clone(),SuperMapAlgoPlot.PlottingUtil.rotateAngle(l[n-1],0,a),i.push(SuperMapAlgoPlot.PlottingUtil.linePnt(l[n-1],a,e));else{for(var S=SuperMapAlgoPlot.PlottingUtil.radian(l[n-1],l[0]),m=SuperMapAlgoPlot.PlottingUtil.radian(l[n-1],l[n-2])-S;m<0;)m+=2*Math.PI;var b=m/2,L=void 0;L=b>Math.PI/2?b-Math.PI/2:Math.PI/2-b;var v=e/Math.cos(L);a=l[0].clone(),a=SuperMapAlgoPlot.PlottingUtil.rotateAngle(l[n-1],b,a),i.push(SuperMapAlgoPlot.PlottingUtil.linePnt(l[n-1],a,v))}}else{if(n<3){var M=l[1].clone();SuperMapAlgoPlot.PlottingUtil.rotateAngle(l[0],0,M),i.push(SuperMapAlgoPlot.PlottingUtil.linePnt(l[0],M,e))}else{for(var A=SuperMapAlgoPlot.PlottingUtil.radian(l[0],l[1]),T=SuperMapAlgoPlot.PlottingUtil.radian(l[0],l[n-1])-A;T<0;)T+=2*Math.PI;var _=Math.PI-T/2,O=void 0;O=_>Math.PI/2?_-Math.PI/2:Math.PI/2-_;var x=e/Math.cos(O);a=l[n-1].clone(),a=SuperMapAlgoPlot.PlottingUtil.rotateAngle(l[0],_,a),i.push(SuperMapAlgoPlot.PlottingUtil.linePnt(l[0],a,x))}for(var w=1;w<n-1;w++){for(var E=SuperMapAlgoPlot.PlottingUtil.radian(l[w],l[w+1]),C=SuperMapAlgoPlot.PlottingUtil.radian(l[w],l[w-1])-E;C<0;)C+=2*Math.PI;var I=Math.PI-C/2,D=void 0;D=I>Math.PI/2?I-Math.PI/2:Math.PI/2-I;var R=e/Math.cos(D);a=l[w-1].clone(),a=SuperMapAlgoPlot.PlottingUtil.rotateAngle(l[w],I,a),i.push(SuperMapAlgoPlot.PlottingUtil.linePnt(l[w],a,R))}if(n<3)a=l[n-2].clone(),SuperMapAlgoPlot.PlottingUtil.rotateAngle(l[n-1],Math.PI,a),i.push(SuperMapAlgoPlot.PlottingUtil.linePnt(l[n-1],a,e));else{for(var N=SuperMapAlgoPlot.PlottingUtil.radian(l[n-1],l[0]),U=SuperMapAlgoPlot.PlottingUtil.radian(l[n-1],l[n-2])-N;U<0;)U+=2*Math.PI;var B=Math.PI-U/2,k=void 0;k=B>Math.PI/2?B-Math.PI/2:Math.PI/2-B;var F=e/Math.cos(k);a=l[n-2].clone(),a=SuperMapAlgoPlot.PlottingUtil.rotateAngle(l[n-1],B,a),i.push(SuperMapAlgoPlot.PlottingUtil.linePnt(l[n-1],a,F))}}return i},SuperMapAlgoPlot.PlottingUtil.getOutRectangleDis=function(t){if(2>t.length)return 0;for(var e=t[0].x,o=t[0].x,i=t[0].y,l=t[0].y,n=1;n<t.length;n++)e<t[n].x&&(e=t[n].x),o>t[n].x&&(o=t[n].x),i<t[n].y&&(i=t[n].y),l>t[n].y&&(l=t[n].y);return SuperMapAlgoPlot.PlottingUtil.distance(new SuperMapAlgoPlot.Point(e,i),new SuperMapAlgoPlot.Point(o,l))},SuperMapAlgoPlot.PlottingUtil.clonePoints=function(t){var e=[];if(void 0===t||null===t)return e;if(SuperMapAlgoPlot.PlottingUtil.isArray(t)||(t=[t]),t&&null!=t)for(var o=0;o<t.length;o++)void 0!==t[o]&&null!==t[o]&&e.push(t[o].clone());return e},SuperMapAlgoPlot.PlottingUtil.extend=function(t,e){if("function"==typeof SuperMap.Util.extend)return SuperMap.Util.extend(t,e);if(t=t||{},e){for(var o in e){var i=e[o];void 0!==i&&(t[o]=i)}!("function"==typeof window.Event&&e instanceof window.Event)&&e.hasOwnProperty&&e.hasOwnProperty("toString")&&(t.toString=e.toString)}return t},SuperMapAlgoPlot.PlottingUtil.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},SuperMapAlgoPlot.PlottingUtil.indexOf=function(t,e){if(null==t)return-1;if("function"==typeof t.indexOf)return t.indexOf(e);for(var o=0,i=t.length;o<i;o++)if(t[o]===e)return o;return-1},SuperMapAlgoPlot.PlottingUtil.copyAttributes=function(t,e){if(t=t||{},e)for(var o in e){var i=e[o];void 0!==i&&"CLASS_NAME"!==o&&"function"!=typeof i&&(t[o]=i)}return t},SuperMapAlgoPlot.PlottingUtil.cloneObject=function(t){if(null===t||"object"!==(void 0===t?"undefined":i(t)))return t;if(t instanceof Date){var e=new Date;return e.setTime(t.getTime()),e}if(t instanceof Array)return t.slice(0);if(t instanceof Object){var o={};for(var l in t)t.hasOwnProperty(l)&&(o[l]=SuperMapAlgoPlot.PlottingUtil.cloneObject(t[l]));return o}throw new Error("Unable to copy obj! Its type isn't supported.")},SuperMapAlgoPlot.PlottingUtil.rad=function(t){return t*Math.PI/180},SuperMapAlgoPlot.PlottingUtil.deg=function(t){return 180*t/Math.PI},SuperMapAlgoPlot.PlottingUtil.VincentyConstants={a:6378137,b:6356752.3142,f:1/298.257223563},SuperMapAlgoPlot.PlottingUtil.distVincenty=function(t,e){var o,i,l,n=SuperMapAlgoPlot.PlottingUtil.VincentyConstants,a=n.a,s=n.b,r=n.f;"undefined"!=typeof L&&void 0!==L.LatLng&&t instanceof L.LatLng&&e instanceof L.LatLng?(o=SuperMapAlgoPlot.PlottingUtil.rad(e.lng-t.lng),i=Math.atan((1-r)*Math.tan(SuperMapAlgoPlot.PlottingUtil.rad(t.lat))),l=Math.atan((1-r)*Math.tan(SuperMapAlgoPlot.PlottingUtil.rad(e.lat)))):(o=SuperMapAlgoPlot.PlottingUtil.rad(e.lon-t.lon),i=Math.atan((1-r)*Math.tan(SuperMapAlgoPlot.PlottingUtil.rad(t.lat))),l=Math.atan((1-r)*Math.tan(SuperMapAlgoPlot.PlottingUtil.rad(e.lat))));for(var u=Math.sin(i),p=Math.cos(i),h=Math.sin(l),c=Math.cos(l),g=o,y=2*Math.PI,f=20;Math.abs(g-y)>1e-12&&--f>0;){var P=Math.sin(g),d=Math.cos(g),S=Math.sqrt(c*P*(c*P)+(p*h-u*c*d)*(p*h-u*c*d));if(0==S)return 0;var m=u*h+p*c*d,b=Math.atan2(S,m),v=Math.asin(p*c*P/S),M=Math.cos(v)*Math.cos(v),A=m-2*u*h/M,T=r/16*M*(4+r*(4-3*M));y=g,g=o+(1-T)*r*Math.sin(v)*(b+T*S*(A+T*m*(2*A*A-1)))}if(0==f)return NaN;var _=M*(a*a-s*s)/(s*s),O=_/1024*(256+_*(_*(74-47*_)-128));return(s*(1+_/16384*(4096+_*(_*(320-175*_)-768)))*(b-O*S*(A+O/4*(m*(2*A*A-1)-O/6*A*(4*S*S-3)*(4*A*A-3))))).toFixed(3)/1e3},SuperMapAlgoPlot.PlottingUtil.destinationVincenty=function(t,e,o){var i,l,n=SuperMapAlgoPlot.PlottingUtil,a=n.VincentyConstants,s=a.a,r=a.b,u=a.f;"undefined"!=typeof L&&void 0!==L.LatLng&&t instanceof L.LatLng?(i=t.lng,l=t.lat):(i=t.lon,l=t.lat);for(var p=o,h=n.rad(e),c=Math.sin(h),g=Math.cos(h),y=(1-u)*Math.tan(n.rad(l)),f=1/Math.sqrt(1+y*y),P=y*f,d=Math.atan2(y,g),S=f*c,m=1-S*S,b=m*(s*s-r*r)/(r*r),v=1+b/16384*(4096+b*(b*(320-175*b)-768)),M=b/1024*(256+b*(b*(74-47*b)-128)),A=p/(r*v),T=2*Math.PI;Math.abs(A-T)>1e-12;){var _=Math.cos(2*d+A),O=Math.sin(A),x=Math.cos(A);T=A,A=p/(r*v)+M*O*(_+M/4*(x*(2*_*_-1)-M/6*_*(4*O*O-3)*(4*_*_-3)))}var w=P*O-f*x*g,E=Math.atan2(P*x+f*O*g,(1-u)*Math.sqrt(S*S+w*w)),C=u/16*m*(4+u*(4-3*m)),I=Math.atan2(O*c,f*x-P*O*g)-(1-C)*u*S*(A+C*O*(_+C*x*(2*_*_-1)));return"undefined"!=typeof L&&void 0!==L.LatLng&&t instanceof L.LatLng?L.latLng(n.deg(E),i+n.deg(I)):new SuperMap.LonLat(i+n.deg(I),n.deg(E))}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.AnalysisSymbol=SuperMapAlgoPlot.AnalysisSymbol=SuperMapAlgoPlot.AnalysisSymbol||{};SuperMapAlgoPlot.AnalysisSymbol.analysisBasicInfo=function(t){var e=new Object;return e.libID=t.libID,e.code=t.code,e.symbolType=t.symbolType,e.symbolName=t.symbolName,e.textContent=t.textContent,e.minEditPts=t.algoMinEditPts,e.maxEditPts=t.algoMaxEditPts,e.surroundLineType=t.surroundLineType,e},SuperMapAlgoPlot.AnalysisSymbol.analysisDotBasicInfo=function(t){var e=SuperMapAlgoPlot.PlottingUtil.DPI,o=new Object;o.anchorPoint=new SuperMapAlgoPlot.Point(t.anchorPoint.x,t.anchorPoint.y);var i=0,l=0;return void 0!==t.symbolSizeInLib?(i=Math.round(t.symbolSizeInLib.x*e/25.4/10),l=Math.round(t.symbolSizeInLib.y*e/25.4/10)):(i=Math.round(t.symbolSize.x*e/25.4/10),l=Math.round(t.symbolSize.y*e/25.4/10)),o.symbolSizeInLib=new SuperMap.Size(i,l),o.symbolSizeInLib.w=i,o.symbolSizeInLib.h=l,o.middleMarkBounds=new SuperMap.Bounds(t.middleMarkBounds.leftBottom.x,t.middleMarkBounds.leftBottom.y,t.middleMarkBounds.rightTop.x,t.middleMarkBounds.rightTop.y),o},SuperMapAlgoPlot.AnalysisSymbol.analysisAlgoBasicInfo=function(t,e){var o=new Object;if(o.subSymbols=[],o.scalePoints=[],o.scaleValues=[],e&&t.subSymbols)for(var i=0;i<t.subSymbols.length;i++)o.subSymbols.push(new SuperMapAlgoPlot.SubSymbol(t.libID,t.subSymbols[i]));if(t.scalePoints){o.scalePoints=[];for(var l=0;l<t.scalePoints.length;l++){var n=new SuperMapAlgoPlot.Point(t.scalePoints[l].x,t.scalePoints[l].y);n.tag=l,n.isScalePoint=!0,o.scalePoints.push(n)}}if(t.scaleValues)for(var a=0;a<t.scaleValues.length;a++)o.scaleValues.push(t.scaleValues[a]);return o},SuperMapAlgoPlot.AnalysisSymbol.analysisSymbolCells=function(t,e){var o=[];if(t&&(function(t,o){if(t.innerCells&&t.innerCells.length)for(var i=0;i<t.innerCells.length;i++){var l=t.innerCells[i];if(t.symbolIsCanFill&&l.type!==SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL){var n=new Object,a=SuperMapAlgoPlot.AnalysisSymbol.getStyle(t,e);n.type=32,n.style={fillSymbolID:a.fillSymbolID,fillColor:a.fillColor,fillOpacity:a.fillOpacity,strokeOpacity:0,strokeWidth:0,fillLimit:!1,lineColorLimit:!0,lineWidthLimit:!0},n.positionPoints=[];for(var s=0;s<l.positionPoints.length;s++){var r=new SuperMapAlgoPlot.Point(l.positionPoints[s].x,l.positionPoints[s].y);n.positionPoints.push(r)}o.push(n)}}}(t,o),t.innerCells)){var i=t.innerCells;if(0!==i.length)for(var l=0;l<i.length;l++)o.push(SuperMapAlgoPlot.AnalysisSymbol.analysisInnerCell(i[l],e))}return o},SuperMapAlgoPlot.AnalysisSymbol.analysisInnerCell=function(t,e){var o=new Object;if(o.positionPoints=[],t){if(void 0!==t.polybezierClose&&(o.polybezierClose=t.polybezierClose),o.type=t.type,o.surroundLineFlag=t.surroundLineFlag,o.textContent=t.textContent,o.style=SuperMapAlgoPlot.AnalysisSymbol.getStyle(t,e),null!=t.positionPoints)for(var i=t.positionPoints,l=0;l<i.length;l++){var n=new SuperMapAlgoPlot.Point(i[l].x,i[l].y);o.positionPoints.push(n)}if(o.style.lineColorLimit=t.lineColorLimit,o.style.lineTypeLimit=t.lineTypeLimit,o.style.lineWidthLimit=t.lineWidthLimit,o.style.fillLimit=t.fillLimit,o.style.fillColorLimit=t.fillColorLimit,o.style.fontColorLimit=t.fontColorLimit,o.style.surroundLineLimit=t.surroundLineLimit,o.style.surroundLineFlag=t.surroundLineFlag,o.style.surroundLineType=t.surroundLineType,34==t.type?o.style.fontColorLimit=!0:o.style.fontColorLimit=t.fontColorLimit,o.type===SuperMapAlgoPlot.SymbolType.RECTANGLESYMBOL){var a=o.positionPoints[0],s=o.positionPoints[1],r=a.clone(),u=new SuperMapAlgoPlot.Point(s.x,a.y),p=s.clone(),h=new SuperMapAlgoPlot.Point(a.x,s.y);o.positionPoints=[],o.positionPoints.push(r),o.positionPoints.push(u),o.positionPoints.push(p),o.positionPoints.push(h),o.type=SuperMapAlgoPlot.SymbolType.ARBITRARYPOLYGONSYMBOL}o.type===SuperMapAlgoPlot.SymbolType.TEXTSYMBOL&&(o.style.fontSizeLimit=!0)}return o},SuperMapAlgoPlot.AnalysisSymbol.getStyle=function(t,e){function o(t){var e=t.red.toString(16);e.length<2&&(e="0"+e);var o=t.green.toString(16);o.length<2&&(o="0"+o);var i=t.blue.toString(16);return i.length<2&&(i="0"+i),"#"+e+o+i}function i(t){return"TOPLEFT"===t?"lt":"TOPCENTER"===t?"ct":"TOPRIGHT"===t?"rt":"BOTTOMLEFT"===t?"lb":"BOTTOMCENTER"===t?"cb":"BOTTOMRIGHT"===t?"rb":"MIDDLELEFT"===t?"lm":"MIDDLECENTER"===t?"cm":"MIDDLERIGHT"===t?"rm":0===t?"lt":1===t?"ct":2===t?"rt":6===t?"lb":7===t?"cb":8===t?"rb":9===t?"lm":10===t?"cm":11===t?"rm":"lt"}var l=SuperMapAlgoPlot.PlottingUtil.DPI,n={};return t.style?(e?(n.fillSymbolID=t.style.fillSymbolID,n.fillSymbolID||(n.fill=t.style.fill)):(!1===t.style.fill?t.style.fillSymbolID=1:!0===t.style.fill&&(t.style.fillSymbolID=0),n.fillSymbolID=t.style.fillSymbolID),void 0!==t.style.strokeGradientMode&&null!=t.style.strokeGradientMode?1===t.style.strokeGradientMode?n.strokeGradientMode="LINEAR":2===t.style.strokeGradientMode?n.strokeGradientMode="RADIAL":"LINEAR"!==t.style.strokeGradientMode&&"RADIAL"!==t.style.strokeGradientMode&&(n.strokeGradientMode="NONE"):n.strokeGradientMode="NONE",t.style.strokeBackColor?void 0!==t.style.strokeBackColor.red?(n.strokeBackColor=o(t.style.strokeBackColor),n.strokeBackOpacity=(t.style.strokeBackColor.alpha/255).toFixed(2)):(n.strokeBackColor=t.style.strokeBackColor,n.strokeBackOpacity=t.style.strokeBackOpacity):t.style.fillBackColor&&(void 0!==t.style.fillBackColor.red?(n.strokeBackColor=o(t.style.fillBackColor),n.strokeBackOpacity=(t.style.fillBackColor.alpha/255).toFixed(2)):(n.strokeBackColor=t.style.strokeBackColor,n.strokeBackOpacity=t.style.strokeBackOpacity)),void 0!==t.style.fillGradientMode&&null!=t.style.fillGradientMode&&(1===t.style.fillGradientMode?n.fillGradientMode="LINEAR":2===t.style.fillGradientMode?n.fillGradientMode="RADIAL":"LINEAR"!==t.style.fillGradientMode&&"RADIAL"!==t.style.fillGradientMode&&(n.fillGradientMode="NONE")),null!=t.style.fillGradientAngle&&void 0!==t.style.fillGradientAngle?n.fillAngle=t.style.fillGradientAngle:void 0!==t.style.fillAngle&&null!=t.style.fillAngle&&(n.fillAngle=t.style.fillAngle),void 0!==t.style.fillGradientOffsetRatioX&&null!=t.style.fillGradientOffsetRatioX?n.fillCenterOffsetX=t.style.fillGradientOffsetRatioX/100:void 0!==t.style.fillCenterOffsetX&&null!=t.style.fillCenterOffsetX&&(n.fillCenterOffsetX=t.style.fillCenterOffsetX/100),void 0!==t.style.fillGradientOffsetRatioY&&null!=t.style.fillGradientOffsetRatioY?n.fillCenterOffsetY=t.style.fillGradientOffsetRatioY/100:void 0!==t.style.fillCenterOffsetY&&null!=t.style.fillCenterOffsetY&&(n.fillCenterOffsetY=t.style.fillCenterOffsetY/100),void 0!==t.style.fillForeColor&&(n.fillColor=o(t.style.fillForeColor)),void 0!==t.style.fillOpaqueRate&&(n.fillOpacity=(t.style.fillOpaqueRate/100).toFixed(2),100!==t.style.fillOpaqueRate||1===t.style.fillGradientMode&&2===t.style.fillGradientMode||(n.fillOpacity=(t.style.fillForeColor.alpha/255).toFixed(2))),void 0!==t.style.fillBackColor&&(void 0!==t.style.fillBackColor.red?n.fillBackColor=o(t.style.fillBackColor):n.fillBackColor=t.style.fillBackColor),0===t.style.fillBackOpaque?n.fillBackOpacity=0:t.style.fillBackColor&&t.style.fillBackColor.alpha?n.fillBackOpacity=(t.style.fillBackColor.alpha/255).toFixed(2):n.fillBackOpacity=t.style.fillBackOpacity,void 0!==t.style.lineColor&&(!0===e?(n.color=o(t.style.lineColor),n.opacity=(t.style.lineColor.alpha/255).toFixed(2)):(n.strokeColor=o(t.style.lineColor),n.strokeOpacity=(t.style.lineColor.alpha/255).toFixed(2))),!0===e?void 0!==t.style.lineWidth?n.weight=Math.ceil(t.style.lineWidth*l/25.4):n.weight=t.style.strokeWidth:void 0!==t.style.lineWidth?n.strokeWidth=Math.ceil(t.style.lineWidth*l/25.4):n.strokeWidth=t.style.strokeWidth,e?(n.lineSymbolID=t.style.lineSymbolID,n.lineSymbolID||(n.dashArray=t.style.dashArray),!n.dashArray&&t.style.strokeDashstyle&&("dash"===t.style.strokeDashstyle?n.lineSymbolID=1:"dot"===t.style.strokeDashstyle?n.lineSymbolID=2:"dashdot"===t.style.strokeDashstyle?n.lineSymbolID=3:n.lineSymbolID=0)):1===t.style.lineSymbolID?n.strokeDashstyle="dash":2===t.style.lineSymbolID?n.strokeDashstyle="dot":3===t.style.lineSymbolID?n.strokeDashstyle="dashdot":t.style.strokeDashstyle?n.strokeDashstyle=t.style.strokeDashstyle:n.strokeDashstyle="solid",t.textStyle2D&&null!=t.textStyle2D?(void 0!==t.textStyle2D.sizeFixed&&(n.sizeFixed=t.textStyle2D.sizeFixed),void 0!==t.textStyle2D.fontName&&(n.fontFamily=t.textStyle2D.fontName),void 0!==t.textStyle2D.fontHeight&&(n.fontSize=Math.ceil(t.textStyle2D.fontHeight*l/25.4)),void 0!==t.textStyle2D.foreColor&&(n.fontColor=o(t.textStyle2D.foreColor)),void 0!==t.textStyle2D.align&&(n.labelAlign=i(t.textStyle2D.align)),void 0!==t.textStyle2D.rotation&&(n.labelRotation=-t.textStyle2D.rotation),void 0!==t.textStyle2D.bold&&(n.fontWeight=-t.textStyle2D.bold),n.labelXOffset=0,n.labelYOffset=0):t.textStyle&&null!=t.textStyle&&(void 0!==t.textStyle.sizeFixed&&(n.sizeFixed=t.textStyle.sizeFixed),void 0!==t.textStyle.fontName&&(n.fontFamily=t.textStyle.fontName),void 0!==t.textStyle.fontHeight&&(n.sizeFixed?n.fontSize=Math.ceil(t.textStyle.fontHeight*l/25.4):n.fontSize=t.textStyle.fontHeight),void 0!==t.textStyle.foreColor&&(n.fontColor=o(t.textStyle.foreColor)),void 0!==t.textStyle.align&&(n.labelAlign=i(t.textStyle.align)),void 0!==t.textStyle.rotation&&(n.labelRotation=-t.textStyle.rotation),void 0!==t.textStyle.bold&&(n.fontWeight=-t.textStyle.bold),n.labelXOffset=0,n.labelYOffset=0),void 0!==t.style.fontOpacity&&(n.fontOpacity=t.style.fontOpacity),void 0!==t.style.fontStroke?n.fontStroke=t.style.fontStroke:t.textStyle2D&&void 0!==t.textStyle2D.outline&&(n.fontStroke=t.textStyle2D.outline),void 0!==t.style.fontStrokeColor?n.fontStrokeColor=t.style.fontStrokeColor:t.textStyle2D&&void 0!==t.textStyle2D.backColor&&(n.fontStrokeColor=o(t.textStyle2D.backColor)),void 0!==n.fontStrokeWidth&&(n.fontStrokeWidth=t.style.fontStrokeWidth),void 0!==t.style.fontBackground&&(n.fontBackground=t.style.fontBackground),void 0!==t.style.fontBackgroundColor&&(n.fontBackgroundColor=t.style.fontBackgroundColor),void 0!==t.style.fontShadow&&(n.fontShadow=t.style.fontShadow),void 0!==t.style.fontShadowColor&&(n.fontShadowColor=t.style.fontShadowColor),void 0!==t.style.fontShadowOffsetX&&(n.fontShadowOffsetX=t.style.fontShadowOffsetX),void 0!==t.style.fontShadowOffsetY&&(n.fontShadowOffsetY=t.style.fontShadowOffsetY),void 0!==t.style.fontSpace&&(n.fontSpace=t.style.fontSpace),void 0!==t.style.fontPercent&&(n.fontPercent=t.style.fontPercent),void 0!==t.style.fontWeight&&(n.fontWeight=t.style.fontWeight),void 0!==t.style.fontStyle&&(n.fontStyle=t.style.fontStyle),void 0!==t.surroundLineColor&&null!=t.surroundLineColor&&(n.surroundLineColor=o(t.surroundLineColor),n.surroundLineColorOpacity=(t.surroundLineColor.alpha/255).toFixed(2)),void 0!==t.surroundLineWidth2D&&null!=t.surroundLineWidth2D?n.surroundLineWidth=Math.round(t.surroundLineWidth2D*l/25.4):void 0!==t.surroundLineWidth&&null!=t.surroundLineWidth&&(n.surroundLineWidth=Math.round(t.surroundLineWidth*l/25.4)),null!=t.style.graphicWidth&&(n.graphicWidth=t.style.graphicWidth),null!=t.style.graphicHeight&&(n.graphicHeight=t.style.graphicHeight),null!=t.style.graphicOpacity&&(n.graphicOpacity=t.style.graphicOpacity),null!=t.style.graphicXOffset&&(n.graphicXOffset=t.style.graphicXOffset),null!=t.style.graphicYOffset&&(n.graphicYOffset=t.style.graphicYOffset),!1===t.visibility?n.display="none":n.display="display",n):n},SuperMapAlgoPlot.AnalysisSymbol.setStyle=function(t,e,o){var i=SuperMapAlgoPlot.PlottingUtil.DPI;if(null!=e)return e.style||(e.style={}),e.textStyle2D||(e.textStyle2D={}),o?(e.style.fillSymbolID=t.fillSymbolID,e.style.fillSymbolID||(e.style.fill=t.fill)):(!1===t.fill?t.fillSymbolID=1:!0===t.fill&&(t.fillSymbolID=0),e.style.fillSymbolID=t.fillSymbolID),t.fillGradientMode&&(e.style.fillGradientMode=t.fillGradientMode),t.fillGradientMode&&("LINEAR"===t.fillGradientMode?e.style.fillGradientMode=1:"RADIAL"===t.fillGradientMode?e.style.fillGradientMode=2:e.style.fillGradientMode=0),t.strokeGradientMode&&("LINEAR"===t.strokeGradientMode?e.style.strokeGradientMode=1:"RADIAL"===t.strokeGradientMode?e.style.strokeGradientMode=2:e.style.strokeGradientMode=0),t.strokeBackColor&&(e.style.strokeBackColor=SuperMapAlgoPlot.PlottingUtil.colorStringToRGB(t.strokeBackColor)),t.strokeBackOpacity&&(e.style.strokeBackColor.alpha=255*t.strokeBackOpacity),null!=t.fillAngle&&void 0!==t.fillAngle&&(e.style.fillAngle=t.fillAngle,e.style.fillGradientAngle=t.fillAngle),null!=t.fillCenterOffsetX&&void 0!==t.fillCenterOffsetX&&(e.style.fillCenterOffsetX=100*t.fillCenterOffsetX,e.style.fillGradientOffsetRatioX=100*t.fillCenterOffsetX),null!=t.fillCenterOffsetY&&void 0!==t.fillCenterOffsetY&&(e.style.fillCenterOffsetY=100*t.fillCenterOffsetY,e.style.fillGradientOffsetRatioY=100*t.fillCenterOffsetY),t.fillColor&&(e.style.fillForeColor=SuperMapAlgoPlot.PlottingUtil.colorStringToRGB(t.fillColor)),void 0!==t.fillOpacity&&null!=t.fillOpacity&&(e.style.fillOpaqueRate=100*t.fillOpacity,e.style.fillForeColor.alpha=255),t.fillBackColor&&(e.style.fillBackColor=SuperMapAlgoPlot.PlottingUtil.colorStringToRGB(t.fillBackColor)),void 0!==t.fillBackOpacity&&null!=t.fillBackOpacity&&(0===t.fillBackOpacity?(e.style.fillBackOpaque=0,e.style.fillBackColor.alpha=255):e.style.fillBackColor&&(e.style.fillBackOpaque=1,e.style.fillBackColor.alpha=255*t.fillBackOpacity)),!0===o&&t.color?e.style.lineColor=SuperMapAlgoPlot.PlottingUtil.colorStringToRGB(t.color):t.strokeColor&&(e.style.lineColor=SuperMapAlgoPlot.PlottingUtil.colorStringToRGB(t.strokeColor)),!0===o&&null!=t.opacity&&void 0!==t.opacity?(e.style.lineColor.alpha=255*t.opacity,e.style.lineColor.alpha<1&&(e.style.lineColor.alpha=1)):null!=t.strokeOpacity&&void 0!==t.strokeOpacity&&(e.style.lineColor.alpha=255*t.strokeOpacity,e.style.lineColor.alpha<1&&(e.style.lineColor.alpha=1)),!0===o&&t.weight?e.style.lineWidth=25.4*t.weight/i:t.strokeWidth&&(e.style.lineWidth=25.4*t.strokeWidth/i),o?(e.style.lineSymbolID=t.lineSymbolID,e.style.lineSymbolID||(e.style.dashArray=t.dashArray)):"dot"===t.strokeDashstyle?e.style.lineSymbolID=2:"dash"===t.strokeDashstyle||"longdash"===t.strokeDashstyle?e.style.lineSymbolID=1:"dashdot"===t.strokeDashstyle||"longdashdot"===t.strokeDashstyle?e.style.lineSymbolID=3:e.style.lineSymbolID=0,t.fontFamily&&(e.textStyle2D&&null!=e.textStyle2D?e.textStyle2D.fontName=t.fontFamily:e.textStyle&&null!=e.textStyle&&(e.textStyle.fontName=t.fontFamily)),null!=t.sizeFixed&&(e.textStyle2D&&null!=e.textStyle2D?e.textStyle2D.sizeFixed=t.sizeFixed:e.textStyle&&null!=e.textStyle&&(e.textStyle.sizeFixed=t.sizeFixed)),t.fontSize&&(e.textStyle2D&&null!=e.textStyle2D?e.textStyle2D.fontHeight=25.4*t.fontSize/i:e.textStyle&&null!=e.textStyle&&(t.sizeFixed?e.textStyle.fontHeight=25.4*t.fontSize/i:e.textStyle.fontHeight=t.fontSize)),t.fontWeight&&(e.textStyle2D&&null!=e.textStyle2D?e.textStyle2D.bold=t.fontWeight:e.textStyle&&null!=e.textStyle&&(e.textStyle.bold=t.fontWeight)),t.fontColor&&(e.textStyle2D&&null!=e.textStyle2D?e.textStyle2D.foreColor=SuperMapAlgoPlot.PlottingUtil.colorStringToRGB(t.fontColor):e.textStyle&&null!=e.textStyle&&(e.textStyle.foreColor=SuperMapAlgoPlot.PlottingUtil.colorStringToRGB(t.fontColor))),t.labelRotation&&(e.textStyle2D&&null!=e.textStyle2D?e.textStyle2D.rotation=-t.labelRotation:e.textStyle&&null!=e.textStyle&&(e.textStyle.rotation=-t.labelRotation)),void 0!==t.fontOpacity&&(e.style.fontOpacity=t.fontOpacity),void 0!==t.fontStroke&&(e.textStyle2D.outline=t.fontStroke),void 0!==t.fontStrokeColor&&(e.textStyle2D.backColor=SuperMapAlgoPlot.PlottingUtil.colorStringToRGB(t.fontStrokeColor)),void 0!==t.fontStrokeWidth&&(e.style.fontStrokeWidth=t.fontStrokeWidth),void 0!==t.fontBackground&&(e.style.fontBackground=t.fontBackground),void 0!==t.fontBackgroundColor&&(e.style.fontBackgroundColor=t.fontBackgroundColor),void 0!==t.fontShadow&&(e.style.fontShadow=t.fontShadow),void 0!==t.fontShadowColor&&(e.style.fontShadowColor=t.fontShadowColor),void 0!==t.fontShadowOffsetX&&(e.style.fontShadowOffsetX=t.fontShadowOffsetX),void 0!==t.fontShadowOffsetY&&(e.style.fontShadowOffsetY=t.fontShadowOffsetY),void 0!==t.fontSpace&&(e.style.fontSpace=t.fontSpace),void 0!==t.fontPercent&&(e.style.fontPercent=t.fontPercent),void 0!==t.fontWeight&&(e.style.fontWeight=t.fontWeight),void 0!==t.fontStyle&&(e.style.fontStyle=t.fontStyle),t.surroundLineColor&&(e.surroundLineColor=SuperMapAlgoPlot.PlottingUtil.colorStringToRGB(t.surroundLineColor)),null!=t.surroundLineColorOpacity&&void 0!==t.surroundLineColorOpacity&&(e.surroundLineColor.alpha=255*t.surroundLineColorOpacity),t.surroundLineWidth&&(e.surroundLineWidth2D=25.4*t.surroundLineWidth/i),void 0!==t.labelAlign&&("lt"===t.labelAlign?e.textStyle2D&&null!=e.textStyle2D?e.textStyle2D.align=0:e.textStyle&&null!=e.textStyle&&(e.textStyle.align=0):"ct"===t.labelAlign?e.textStyle2D&&null!=e.textStyle2D?e.textStyle2D.align=1:e.textStyle&&null!=e.textStyle&&(e.textStyle.align=1):"rt"===t.labelAlign?e.textStyle2D&&null!=e.textStyle2D?e.textStyle2D.align=2:e.textStyle&&null!=e.textStyle&&(e.textStyle.align=2):"lb"===t.labelAlign?e.textStyle2D&&null!=e.textStyle2D?e.textStyle2D.align=6:e.textStyle&&null!=e.textStyle&&(e.textStyle.align=6):"cb"===t.labelAlign?e.textStyle2D&&null!=e.textStyle2D?e.textStyle2D.align=7:e.textStyle&&null!=e.textStyle&&(e.textStyle.align=7):"rb"===t.labelAlign?e.textStyle2D&&null!=e.textStyle2D?e.textStyle2D.align=8:e.textStyle&&null!=e.textStyle&&(e.textStyle.align=8):"lm"===t.labelAlign?e.textStyle2D&&null!=e.textStyle2D?e.textStyle2D.align=9:e.textStyle&&null!=e.textStyle&&(e.textStyle.align=9):"cm"===t.labelAlign?e.textStyle2D&&null!=e.textStyle2D?e.textStyle2D.align=10:e.textStyle&&null!=e.textStyle&&(e.textStyle.align=10):"rm"===t.labelAlign&&(e.textStyle2D&&null!=e.textStyle2D?e.textStyle2D.align=11:e.textStyle&&null!=e.textStyle&&(e.textStyle.align=11))),null!=t.graphicWidth&&(e.style.graphicWidth=t.graphicWidth),null!=t.graphicHeight&&(e.style.graphicHeight=t.graphicHeight),null!=t.graphicOpacity&&(e.style.graphicOpacity=t.graphicOpacity),null!=t.graphicXOffset&&(e.style.graphicXOffset=t.graphicXOffset),null!=t.graphicYOffset&&(e.style.graphicYOffset=t.graphicYOffset),t.display&&"none"===t.display?e.visibility=!1:e.visibility=!0,t},SuperMapAlgoPlot.AnalysisSymbol.mergeDefaultStyleToFeature=function(t,e,o){var i=void 0,l=void 0;i=t.style,l=!0!==o?t.geometry:t,e&&!0===e.defaultFlag&&!1===l.isEdit&&(l.surroundLineType=e.surroundLineType,i.surroundLineColor=e.surroundLineColor,i.surroundLineWidth=e.surroundLineWidth,i.surroundLineColorOpacity=e.surroundLineColorOpacity,i.fillBackColor=e.fillBackColor,i.fillBackOpacity=e.fillBackOpacity,i.fillGradientMode=e.fillGradientMode,i.fillCenterOffsetX=e.fillCenterOffsetX,i.fillCenterOffsetY=e.fillCenterOffsetY,i.fillAngle=e.fillAngle,!0===o?(i.color=e.lineColor,i.weight=e.lineWidth,i.opacity=e.lineOpacity,i.lineSymbolID=e.lineType,i.lineCap=e.lineCap,i.lineJoin=e.lineJoin):(i.strokeColor=e.lineColor,i.strokeWidth=e.lineWidth,i.strokeOpacity=e.lineOpacity,i.strokeDashstyle=e.lineType,i.strokeLinecap=e.lineCap,i.strokeLinejoin=e.lineJoin),i.fillSymbolID=e.fillSymbolID,i.fillColor=e.fillColor,i.fillOpacity=e.fillOpacity,i.fontColor=e.fontColor,i.fontOpacity=e.fontOpacity,i.fontSize=e.fontSize,i.fontFamily=e.fontFamily,i.fontWeight=e.fontWeight,i.fontStyle=e.fontStyle,i.fontStroke=e.fontStroke,i.fontStrokeColor=e.fontStrokeColor,i.fontStrokeWidth=e.fontStrokeWidth,i.fontBackground=e.fontBackground,i.fontBackgroundColor=e.fontBackgroundColor,i.fontShadow=e.fontShadow,i.fontShadowColor=e.fontShadowColor,i.fontShadowOffsetX=e.fontShadowOffsetX,i.fontShadowOffsetY=e.fontShadowOffsetY,i.fontSpace=e.fontSpace,i.fontPercent=e.fontPercent,i.strokeGradientMode=e.strokeGradientMode,i.strokeBackColor=e.strokeBackColor,i.strokeBackOpacity=e.strokeBackOpacity)},SuperMapAlgoPlot.AnalysisSymbol.mergeSymbolDataAndServerData=function(t,e){t.hasOwnProperty("algoMinEditPts")||(t.algoMinEditPts=e.algoMinEditPts),t.hasOwnProperty("algoMaxEditPts")||(t.algoMaxEditPts=e.algoMaxEditPts),t.hasOwnProperty("innerCells")||(t.innerCells=SuperMap.Util.cloneObject(e.innerCells)),t.hasOwnProperty("symbolRanks")||(t.symbolRanks=SuperMap.Util.cloneObject(e.symbolRanks)),t.hasOwnProperty("symbolSizeInLib")||(t.symbolSizeInLib=SuperMap.Util.cloneObject(e.symbolSize)),t.hasOwnProperty("middleMarkExist")||(t.middleMarkExist=SuperMap.Util.cloneObject(e.middleMarkExist)),t.hasOwnProperty("middleMarkBounds")||(t.middleMarkBounds=SuperMap.Util.cloneObject(e.middleMarkBounds)),t.hasOwnProperty("anchorPoint")||(t.anchorPoint=SuperMap.Util.cloneObject(e.anchorPoint))},SuperMapAlgoPlot.AnalysisSymbol.setSymbolData=function(t,e,o){null==e&&(e={}),e.hasOwnProperty("type")||(0!=t.libID||t.code!=SuperMap.Plot.SymbolType.GROUPOBJECT&&t.code!=SuperMap.Plot.SymbolType.FLAGGROUP?e.type="GRAPHICOBJECT":e.type="GraphicCollection"),e.hasOwnProperty("version")||(e.version=2),e.isEdit=!0,e.uuid=t.uuid,e.associatedUuid=t.associatedUuid,e.hasOwnProperty("rotate2D")?e.rotate2D.x=t.dRotate:e.rotate2D={x:t.dRotate,y:0,z:0},e.hasOwnProperty("scale2D")?e.scale2D.x=t.dScale:e.scale2D={x:t.dScale,y:0,z:0},e.libID=t.libID,e.code=t.code,e.algoMaxEditPts=t.maxEditPts,e.algoMinEditPts=t.minEditPts,e.symbolType=t.symbolType,e.symbolName=t.symbolName,e.annotationPosition=t.annotationPosition?t.annotationPosition:t.textPosition,e.textContent=t.textContent,e.textDisplay=t.textDisplay,e.scaleByMap=t.scaleByMap,e.resolution=t.resolution,e.isLocked=t.isLocked,e.note=t.note,e.custom=t.custom,e.subSymbols=[];for(var i=0;i<t.subSymbols.length;i++){var l=t.subSymbols[i];e.subSymbols.push({libID:l.libID,code:l.code,symbolData:l.symbolData,textContent:l.textContent,totalNum:l.totalNum})}e.extendProperty=[];for(var n=t.getExtendProperty().getPropertyCount(),a=0;a<n;a++){var s=t.getExtendProperty().getPropertyByIndex(a);e.extendProperty.push({key:s.key,value:s.value})}e.avoidRegions=[];for(var r=0;r<t.avoidRegions.length;r++){var u={};o?SuperMapAlgoPlot.AnalysisSymbol.setStyle(t.avoidRegions[r].style,u,o):SuperMapAlgoPlot.AnalysisSymbol.setStyle(t.avoidRegions[r].feature.style,u,o),e.avoidRegions.push([t.avoidRegions[r].getSymbolData(),u])}if(!0===o?SuperMapAlgoPlot.AnalysisSymbol.setStyle(t.style,e,o):null!=t.feature&&SuperMapAlgoPlot.AnalysisSymbol.setStyle(t.feature.style,e),t.symbolType===SuperMapAlgoPlot.SymbolType.AIRROUTE||t.symbolType===SuperMapAlgoPlot.SymbolType.NAVYROUTE||t.symbolType===SuperMapAlgoPlot.SymbolType.MISSILEROUTE){for(var p in e.routeNodes=[],t.routeNodes)e.routeNodes.push(t.routeNodes[p].setSymbolData());e.arrRoutePts=t.arrRoutePts,o||SuperMapAlgoPlot.AnalysisSymbol.setStyle(t.lineStyle,e)}else if(t.symbolType===SuperMapAlgoPlot.SymbolType.GROUPOBJECT||t.symbolType===SuperMapAlgoPlot.SymbolType.FLAGGROUP||t.symbolType===SuperMapAlgoPlot.SymbolType.NAVYDEPLOYMENT||t.symbolType===SuperMapAlgoPlot.SymbolType.AIRDEPLOYMENT){if(e.subAssociatedUuids=t.subAssociatedUuids,e.geometries=[],o)for(var h=0;h<t.subObjects.length;h++)e.geometries.push(t.subObjects[h].getSymbolData());else for(var c=0;c<t.components.length;c++)e.geometries.push(t.components[c].geometry.getSymbolData());0===t.libID&&t.symbolType===SuperMapAlgoPlot.SymbolType.FLAGGROUP?e.ratios=t.ratio:0===t.libID&&t.symbolType===SuperMapAlgoPlot.SymbolType.AIRDEPLOYMENT?(e.colNum=t.colNum,e.speceDis=t.speceDis,e.isShowTooltip=t.isShowTooltip):0===t.libID&&t.symbolType===SuperMapAlgoPlot.SymbolType.NAVYDEPLOYMENT&&(e.colNum=t.colNum,e.speceDis=t.speceDis)}else if(0===t.libID&&t.symbolType===SuperMapAlgoPlot.SymbolType.SYMBOLTEXT){var g=[];for(var y in t.symbolTexts)g.push(t.symbolTexts[y].setSymbolData());e.symbolTexts=g,e.addFrame=t.addFrame}else if(0===t.libID&&t.symbolType===SuperMapAlgoPlot.SymbolType.SYMBOLTEXT1)e.space=t.space,e.offsetX=t.offsetX,e.offsetY=t.offsetY;else if(0===t.libID&&t.symbolType===SuperMapAlgoPlot.SymbolType.TRAJECTORY)e.trajectoryType=t.trajectoryType,e.trajectoryLength=t.trajectoryLength,e.showTrackingLine=t.showTrackingLine,e.showTrackingPoint=t.showTrackingPoint,e.trackingPointRadius=t.trackingPointRadius,e.saveTrackingPoint=t.saveTrackingPoint;else if(0===t.libID&&t.symbolType===SuperMapAlgoPlot.SymbolType.SATELLITE){if(e.hasOwnProperty("scaleValues"))for(var f=0;f<t.scaleValues.length;f++)e.scaleValues.length>f?e.scaleValues[f]=t.scaleValues[f]:e.scaleValues.push(t.scaleValues[f]);else e.scaleValues=[],e.scaleValues=t.scaleValues;e.visible=t.visible,e.orbitPoints=t.orbitPoints}else if(0===t.libID&&t.symbolType===SuperMapAlgoPlot.SymbolType.SATELLITETIMEWINDOWS)e.timeWindows=t.timeWindows;else{var P=void 0;P=!0===o?L.Util.latLngsToSuperMapPoints(t.getLatLngs()):t.controlPoints,e.localePoints=[];var d=P.length;t.symbolType===SuperMapAlgoPlot.SymbolType.ELLIPSESYMBOL&&(d=3);for(var S=0;S<d;S++)e.localePoints.push({x:P[S].x,y:P[S].y,z:0});if(0===t.libID&&t.symbolType===SuperMapAlgoPlot.SymbolType.LINERELATION)e.endAssociatedUuid=t.endAssociatedUuid,e.lineRelationType=t.lineRelationType,e.startAssociatedUuid=t.startAssociatedUuid,e.subSectionCount=t.subSectionCount;else if(0===t.libID&&t.symbolType===SuperMapAlgoPlot.SymbolType.PICTURE){if(e.path=t.path,e.symbolTexts=[],null!=t.symbolTexts&&0!=t.symbolTexts.length)for(var m=0;m<t.symbolTexts.length;m++)e.symbolTexts.push(t.symbolTexts[m].setSymbolData());if(e.bloodVolumes=[],null!=t.bloodVolumes&&0!=t.bloodVolumes.length)for(var b=0;b<t.bloodVolumes.length;b++)e.bloodVolumes.push(t.bloodVolumes[b].setSymbolData());null!=t.trajectory&&(e.trajectory=t.trajectory.setSymbolData()),null!=e.antoRotation&&(t.antoRotation=e.antoRotation)}else if(t.symbolType===SuperMapAlgoPlot.SymbolType.DOTSYMBOL){e.surroundLineType=t.surroundLineType,e.symbolRank=t.symbolRank,e.negativeImage=t.negativeImage,e.space=25.4*t.space*10/SuperMapAlgoPlot.PlottingUtil.DPI,e.flagTextSize=t.flagTextSize,e.maxScale=t.maxScale,e.minScale=t.minScale,e.actualScale=t.actualScale,void 0!==t.fontSize&&(e.fontSize=t.fontSize),void 0!==t.strokeWidth&&(e.strokeWidth=t.strokeWidth);var v=25.4*t.symbolSize.w*10/SuperMapAlgoPlot.PlottingUtil.DPI,M=25.4*t.symbolSize.h*10/SuperMapAlgoPlot.PlottingUtil.DPI;e.symbolSize={x:v,y:M};var A=25.4*t.symbolSizeInLib.w*10/SuperMapAlgoPlot.PlottingUtil.DPI,T=25.4*t.symbolSizeInLib.h*10/SuperMapAlgoPlot.PlottingUtil.DPI;if(e.symbolSizeInLib={x:A,y:T},e.positionOffset=t.positionOffset,e.positionOffsetType=t.positionOffsetType,e.positionOffsetX=t.positionOffsetX,e.positionOffsetY=t.positionOffsetY,!1===t.widthHeightLimit||!0===t.widthHeightLimit?e.limitWidthHeight=t.widthHeightLimit:e.limitWidthHeight=t.limitWidthHeight,e.symbolTexts=[],null!=t.symbolTexts&&0!=t.symbolTexts.length)for(var _=0;_<t.symbolTexts.length;_++)e.symbolTexts.push(t.symbolTexts[_].setSymbolData());if(e.bloodVolumes=[],null!=t.bloodVolumes&&0!=t.bloodVolumes.length)for(var O=0;O<t.bloodVolumes.length;O++)e.bloodVolumes.push(t.bloodVolumes[O].setSymbolData());if(e.pictureFrames=[],null!=t.pictureFrames&&0!=t.pictureFrames.length)for(var x=0;x<t.pictureFrames.length;x++)e.pictureFrames.push(t.pictureFrames[x].setSymbolData());null!=t.trajectory&&(e.trajectory=t.trajectory.setSymbolData()),null!=e.antoRotation&&(t.antoRotation=e.antoRotation)}else{if(e.surroundLineType=t.surroundLineType,e.hasOwnProperty("scaleValues"))for(var w=0;w<t.scaleValues.length;w++)e.scaleValues.length>w?e.scaleValues[w]=t.scaleValues[w]:e.scaleValues.push(t.scaleValues[w]);else e.scaleValues=[],e.scaleValues=t.scaleValues;e.subSymbolScaleValue=t.subSymbolScaleValue,e.baseScale=t.baseScale,e.strokeWidth=t.strokeWidth,e.polylineConnectLocationPoint=t.polylineConnectLocationPoint,22===t.libID&&t.symbolType===SuperMapAlgoPlot.SymbolType.ALGOSYMBOL?(e.arrowHeadType=t.arrowHeadType,e.arrowBodyType=t.arrowBodyType,e.arrowTailType=t.arrowTailType):0===t.libID&&t.symbolType===SuperMapAlgoPlot.SymbolType.ARROWLINE?e.arrowAngle=t.arrowAngle:0===t.libID&&t.symbolType===SuperMapAlgoPlot.SymbolType.COMBINATIONALCIRCLE?e.defaultRadius=t.defaultRadius:0===t.libID&&t.symbolType===SuperMapAlgoPlot.SymbolType.CONCENTRICCIRCLE||(0===t.libID&&t.symbolType===SuperMapAlgoPlot.SymbolType.LINEMARKING?(e.islocationCircle=t.islocationCircle,e.textBoxType=t.textBoxType):0===t.libID&&t.symbolType===SuperMapAlgoPlot.SymbolType.SYMBOLTEXTBOX?(e.roundBox=t.roundBox,e.textBoxType=t.textBoxType):0===t.libID&&t.symbolType===SuperMapAlgoPlot.SymbolType.PATHTEXT?(e.isAvoid=t.isAvoid,e.isCurve=t.isCurve,e.relLineText=t.relLineText,e.showPathLine=t.showPathLine,e.textToLineDistance=t.textToLineDistance,e.showPathLineArrow=t.showPathLineArrow):0===t.libID&&t.symbolType===SuperMapAlgoPlot.SymbolType.ARCREGION&&(o?(e.centerPoint={x:t.centerPoint.lng,y:t.centerPoint.lat},e.circlePts=t.circlePts,e.spatialAnalystUrl=t.spatialAnalystUrl):e.centerPoint=t.centerPoint,e.endAngle=t.endAngle,e.radius=t.radius,e.radiusPosAngle=t.radiusPosAngle,e.startAngle=t.startAngle,e.textPosition=t.textPosition,e.radiusLineType=t.radiusLineType,e.radiusText=t.radiusText))}}t.symbolData=e},SuperMapAlgoPlot.AnalysisSymbol.parseSymbolData=function(t,e,o){if(null!=e){if(null!=e.isEdit&&(t.isEdit=e.isEdit),e.hasOwnProperty("version")&&(t.version=e.version),e.hasOwnProperty("libID")&&(t.libID=parseInt(e.libID)),e.hasOwnProperty("code")&&(t.code=parseInt(e.code)),e.hasOwnProperty("algoMaxEditPts")&&(t.maxEditPts=parseInt(e.algoMaxEditPts)),e.hasOwnProperty("algoMinEditPts")&&(t.minEditPts=parseInt(e.algoMinEditPts)),e.hasOwnProperty("symbolType")&&(t.symbolType=parseInt(e.symbolType)),e.hasOwnProperty("symbolName")&&(t.symbolName=e.symbolName),e.hasOwnProperty("textContent")&&(t.textContent=e.textContent),null!=e.dScale?t.dScale=e.dScale:void 0!==e.scale2D&&(t.dScale=e.scale2D.x),null!=e.dRotate?t.dRotate=e.dRotate:void 0!==e.rotate2D&&(t.dRotate=e.rotate2D.x),null!=e.resolution&&(t.resolution=e.resolution),null!=e.uuid&&(t.uuid=e.uuid),null!=e.associatedUuid&&(t.associatedUuid=e.associatedUuid),null!=e.textDisplay&&(t.textDisplay=e.textDisplay),null!=e.annotationPosition&&(o?t.annotationPosition=e.annotationPosition:t.textPosition=e.annotationPosition),null!=e.scaleByMap&&(t.scaleByMap=e.scaleByMap),void 0!==e.isLocked&&(t.isLocked=e.isLocked),void 0!==e.note&&(t.note=e.note),void 0!==e.custom&&(t.custom=e.custom),e.extendProperty)for(var i=0;i<e.extendProperty.length;i++){var l=e.extendProperty[i];t.extendProperty.addProperty(l.key,l.value)}if(e.hasOwnProperty("subSymbols")&&null!=e.subSymbols){t.subSymbols=[];for(var n=0;n<e.subSymbols.length;n++){var a=e.subSymbols[n].libID;void 0===a&&(a=t.libID);var s=e.subSymbols[n].code;if(void 0!==s){var r={};void 0!==e.subSymbols[n].textContent&&(r.textContent=e.subSymbols[n].textContent),void 0!==e.subSymbols[n].totalNum&&(r.totalNum=e.subSymbols[n].totalNum),void 0!==e.subSymbols[n].symbolData&&(r.symbolData=e.subSymbols[n].symbolData),t.subSymbols.push(new SuperMapAlgoPlot.SubSymbol(a,s,r))}}}if(e.avoidRegions&&0!==e.avoidRegions.length)for(var u=0;u<e.avoidRegions.length;u++){var p={libID:0,code:SuperMapAlgoPlot.SymbolType.AVOIDREGION,map:t.map,symbolData:e.avoidRegions[u][0]},h=null;if(o)(h=L.supermap.plotting.avoidRegion(0,SuperMapAlgoPlot.SymbolType.AVOIDREGION,[],p)).style=SuperMapAlgoPlot.AnalysisSymbol.getStyle(t.symbolData.avoidRegions[u][1],!0);else{h=new SuperMap.Geometry.AvoidRegion(p);var c=new SuperMap.Feature.Vector(h);c.style=SuperMapAlgoPlot.AnalysisSymbol.getStyle(e.avoidRegions[u][1],o),h.feature=c,h.calculateParts()}t.avoidRegions.push(h)}if(!0===o&&(t.style=SuperMapAlgoPlot.AnalysisSymbol.getStyle(e,!0)),t.symbolType===SuperMapAlgoPlot.SymbolType.AIRROUTE||t.symbolType===SuperMapAlgoPlot.SymbolType.NAVYROUTE||t.symbolType===SuperMapAlgoPlot.SymbolType.MISSILEROUTE){for(var g in t.routeNodes=[],e.routeNodes){var y=new SuperMapAlgoPlot.RouteNode;t.routeNodes.push(y.parseSymbolData(e.routeNodes[g]))}t.arrRoutePts=[];for(var f=0;f<e.arrRoutePts.length;f++){for(var P=[],d=0;d<e.arrRoutePts[f].length;d++)e.arrRoutePts[f][d].hasOwnProperty("lat")&&e.arrRoutePts[f][d].hasOwnProperty("lng")?P.push(new SuperMapAlgoPlot.Point(e.arrRoutePts[f][d].lng,e.arrRoutePts[f][d].lat)):void 0===e.arrRoutePts[f][d].x&&void 0===e.arrRoutePts[f][d].y||P.push(new SuperMapAlgoPlot.Point(e.arrRoutePts[f][d].x,e.arrRoutePts[f][d].y));o&&(P=L.Util.superMapPointsToLatLngs(P)),t.arrRoutePts.push(P)}o||(t.lineStyle=SuperMapAlgoPlot.AnalysisSymbol.getStyle(e,!1))}else if(t.symbolType===SuperMapAlgoPlot.SymbolType.GROUPOBJECT||t.symbolType===SuperMapAlgoPlot.SymbolType.FLAGGROUP||t.symbolType===SuperMapAlgoPlot.SymbolType.NAVYDEPLOYMENT||t.symbolType===SuperMapAlgoPlot.SymbolType.AIRDEPLOYMENT){if(null!=e.subAssociatedUuids&&(t.subAssociatedUuids=e.subAssociatedUuids),null!=e.geometries)if(o){for(var S=[],m=0;m<e.geometries.length;m++){var b=e.geometries[m];b.uuid=SuperMapAlgoPlot.PlottingUtil.generateUuid();var v=L.supermap.plotting.PlottingObject.createSymbol(b.libID,b.code,null,{symbolData:b});S.push(v)}t.subObjects=S}else for(var M=0;M<e.geometries.length;M++){var A=e.geometries[M],T=SuperMap.Geometry.PlottingGeometry.createFeature(A.libID,A.code,null,{symbolData:A,map:t.map});T.geometry.ownGroupObj=t,t.components.push(T)}else if(o){S=[];for(var _=0;_<e.subFeatures.length;_++){var O=e.subFeatures[_];O.uuid=SuperMapAlgoPlot.PlottingUtil.generateUuid();var x=L.supermap.plotting.PlottingObject.createSymbol(O.libID,O.code,null,{symbolData:O});S.push(x)}t.subObjects=S}else for(var w=0;w<e.subFeatures.length;w++){var E=e.subFeatures[w],C=SuperMap.Geometry.PlottingGeometry.createFeature(E.libID,E.code,null,{symbolData:E,map:t.map});C.geometry.ownGroupObj=t,t.components.push(C)}0===t.libID&&t.symbolType===SuperMapAlgoPlot.SymbolType.FLAGGROUP&&(null!=e.ratios?t.ratios=e.ratios:null!=e.ratio&&(t.ratios=e.ratio)),0===t.libID&&t.symbolType===SuperMapAlgoPlot.SymbolType.AIRDEPLOYMENT&&(t.colNum=e.colNum,t.speceDis=e.speceDis,t.isShowTooltip=e.isShowTooltip),0===t.libID&&t.symbolType===SuperMapAlgoPlot.SymbolType.NAVYDEPLOYMENT&&(t.colNum=e.colNum,t.speceDis=e.speceDis)}else if(0===t.libID&&t.symbolType===SuperMapAlgoPlot.SymbolType.SYMBOLTEXT){t.addFrame=e.addFrame,t.symbolTexts=[];for(var I=0,D=e.symbolTexts.length;I<D;I++){var R=new SuperMapAlgoPlot.SymbolText;R.parseSymbolData(e.symbolTexts[I]),t.symbolTexts.push(R)}}else if(0===t.libID&&t.symbolType===SuperMapAlgoPlot.SymbolType.SYMBOLTEXT1)void 0!==e.space&&(t.space=e.space),void 0!==e.offsetX&&(t.offsetX=e.offsetX),void 0!==e.offsetY&&(t.offsetY=e.offsetY);else if(0===t.libID&&t.symbolType===SuperMapAlgoPlot.SymbolType.TRAJECTORY)void 0!==e.trajectoryType&&(t.trajectoryType=e.trajectoryType),void 0!==e.trajectoryLength&&(t.trajectoryLength=e.trajectoryLength),void 0!==e.showTrackingLine&&(t.showTrackingLine=e.showTrackingLine),void 0!==e.showTrackingPoint&&(t.showTrackingPoint=e.showTrackingPoint),void 0!==e.trackingPointRadius&&(t.trackingPointRadius=e.trackingPointRadius),void 0!==e.saveTrackingPoint&&(t.saveTrackingPoint=e.saveTrackingPoint);else if(0===t.libID&&t.symbolType===SuperMapAlgoPlot.SymbolType.SATELLITE){if(e.scaleValues&&0!==e.scaleValues.length){t.scaleValues=[];for(var N=0;N<e.scaleValues.length;N++)t.scaleValues.push(e.scaleValues[N])}if(e.subSymbol&&(t.subSymbols=[e.subSymbol]),t.visible=e.visible,e.orbitPoints){t.orbitPoints=[];for(var U=0;U<e.orbitPoints.length;U++)t.orbitPoints.push(new SuperMapAlgoPlot.OrbitPoint(e.orbitPoints[U].x,e.orbitPoints[U].y,e.orbitPoints[U].z,e.orbitPoints[U].number,e.orbitPoints[U].time))}}else if(0===t.libID&&t.symbolType===SuperMapAlgoPlot.SymbolType.SATELLITETIMEWINDOWS){t.timeWindows=e.timeWindows;for(var B=0;B<t.timeWindows.length;B++)"Time"!==e.type&&"Number"!==e.type||(t.timeWindows[B].type=e.type)}else{if(e.localePoints){t.controlPoints=[];for(var k=0;k<e.localePoints.length;k++)t.controlPoints.push(new SuperMapAlgoPlot.Point(e.localePoints[k].x,e.localePoints[k].y));!0===o&&(t.latLngs=L.Util.superMapPointsToLatLngs(t.controlPoints),delete t.controlPoints)}if(0===t.libID&&t.symbolType===SuperMapAlgoPlot.SymbolType.LINERELATION)t.endAssociatedUuid=e.endAssociatedUuid,t.lineRelationType=e.lineRelationType,t.startAssociatedUuid=e.startAssociatedUuid,t.subSectionCount=e.subSectionCount;else if(0===t.libID&&t.symbolType===SuperMapAlgoPlot.SymbolType.PICTURE){if(t.path=e.path,null!=e.symbolTexts&&0!==e.symbolTexts.length){t.symbolTexts=[];for(var F=0;F<e.symbolTexts.length;F++){var G=new SuperMapAlgoPlot.SymbolText;G.parseSymbolData(e.symbolTexts[F]),t.symbolTexts.push(G)}}if(null!=e.bloodVolumes&&0!==e.bloodVolumes.length){t.bloodVolumes=[];for(var V=0;V<e.bloodVolumes.length;V++){var j=new SuperMapAlgoPlot.BloodVolume;j.parseSymbolData(e.bloodVolumes[V]),t.bloodVolumes.push(j)}}if(null!=e.trajectory){var Y=new SuperMapAlgoPlot.Trajectory;Y.parseSymbolData(e.trajectory),t.trajectory=Y}null!=e.antoRotation&&(t.antoRotation=e.antoRotation)}else if(t.symbolType===SuperMapAlgoPlot.SymbolType.DOTSYMBOL){t.surroundLineType=e.surroundLineType,t.symbolRank=e.symbolRank,t.negativeImage=e.negativeImage;var z=SuperMapAlgoPlot.AnalysisSymbol.analysisDotBasicInfo(e);if(t.anchorPoint=z.anchorPoint,t.symbolSizeInLib=z.symbolSizeInLib,t.middleMarkBounds=z.middleMarkBounds,void 0!==e.actualScale&&(t.actualScale=e.actualScale),void 0!==e.limitWidthHeight&&(t.limitWidthHeight=e.limitWidthHeight),void 0!==e.fontSize&&(t.fontSize=e.fontSize),void 0!==e.strokeWidth&&(t.strokeWidth=e.strokeWidth),void 0!==e.space&&(t.space=e.space*SuperMapAlgoPlot.PlottingUtil.DPI/25.4/10),void 0!==e.flagTextSize&&(t.flagTextSize=e.flagTextSize),void 0!==e.maxScale&&(t.maxScale=e.maxScale),void 0!==e.minScale&&(t.minScale=e.minScale),!1!==t.isEdit){var W={x:0,y:0};-1===e.symbolSize.x&&-1===e.symbolSize.x?(W.x=e.symbolSizeInLib.x*SuperMapAlgoPlot.PlottingUtil.DPI/25.4/10,W.y=e.symbolSizeInLib.y*SuperMapAlgoPlot.PlottingUtil.DPI/25.4/10):(W.x=e.symbolSize.x*SuperMapAlgoPlot.PlottingUtil.DPI/25.4/10,W.y=e.symbolSize.y*SuperMapAlgoPlot.PlottingUtil.DPI/25.4/10),t.setSymbolSize(W.x,W.y)}if(void 0!==e.positionOffset&&null!==e.positionOffset&&(t.positionOffset=e.positionOffset),void 0!==e.positionOffsetType&&null!==e.positionOffsetType&&(t.positionOffsetType=e.positionOffsetType),void 0!==e.positionOffsetX&&null!==e.positionOffsetX&&(t.positionOffsetX=e.positionOffsetX),void 0!==e.positionOffsetY&&null!==e.positionOffsetY&&(t.positionOffsetY=e.positionOffsetY),null!=e.symbolTexts&&0!==e.symbolTexts.length){t.symbolTexts=[];for(var X=0;X<e.symbolTexts.length;X++){var H=new SuperMapAlgoPlot.SymbolText;H.parseSymbolData(e.symbolTexts[X]),t.symbolTexts.push(H)}}if(null!=e.bloodVolumes&&0!==e.bloodVolumes.length){t.bloodVolumes=[];for(var Z=0;Z<e.bloodVolumes.length;Z++){var J=new SuperMapAlgoPlot.BloodVolume;J.parseSymbolData(e.bloodVolumes[Z]),t.bloodVolumes.push(J)}}if(null!=e.pictureFrames&&0!==e.pictureFrames.length){t.pictureFrames=[];for(var q=0;q<e.pictureFrames.length;q++){var K=new SuperMapAlgoPlot.PictureFrame;K.parseSymbolData(e.pictureFrames[q]),t.pictureFrames.push(K)}}if(null!=e.trajectory){var Q=new SuperMapAlgoPlot.Trajectory;Q.parseSymbolData(e.trajectory),t.trajectory=Q}null!=e.antoRotation&&(t.antoRotation=e.antoRotation)}else{if(t.surroundLineType=e.surroundLineType,e.scaleValues&&0!==e.scaleValues.length){t.scaleValues=[];for(var $=0;$<e.scaleValues.length;$++)t.scaleValues.push(e.scaleValues[$])}if(void 0!==e.strokeWidth&&null!==e.strokeWidth&&(t.strokeWidth=e.strokeWidth),void 0!==e.baseScale&&null!==e.baseScale&&(t.baseScale=e.baseScale),void 0!==e.polylineConnectLocationPoint&&null!==e.polylineConnectLocationPoint&&(t.polylineConnectLocationPoint=e.polylineConnectLocationPoint),22===t.libID&&t.symbolType===SuperMapAlgoPlot.SymbolType.ALGOSYMBOL)void 0!==e.arrowHeadType&&null!==e.arrowHeadType&&(t.arrowHeadType=e.arrowHeadType),void 0!==e.arrowBodyType&&null!==e.arrowBodyType&&(t.arrowBodyType=e.arrowBodyType),void 0!==e.arrowTailType&&null!==e.arrowTailType&&(t.arrowTailType=e.arrowTailType);else if(0===t.libID&&t.symbolType===SuperMapAlgoPlot.SymbolType.ARROWLINE)t.arrowAngle=e.arrowAngle,void 0!==e.arrowTypeStart&&(t.scaleValues[1]=e.arrowTypeStart),void 0!==e.arrowTypeEnd&&(t.scaleValues[2]=e.arrowTypeEnd);else if(0===t.libID&&t.symbolType===SuperMapAlgoPlot.SymbolType.COMBINATIONALCIRCLE){if(e.radius&&0!==e.radius.length&&0===t.scaleValues.length)for(var tt=0;tt<e.radius.length;tt++)t.scaleValues.push(e.radius[tt])}else if(0===t.libID&&t.symbolType===SuperMapAlgoPlot.SymbolType.CONCENTRICCIRCLE)t.symbolData.hasOwnProperty("startAngle")&&(t.scaleValues[0]=t.symbolData.startAngle),t.symbolData.hasOwnProperty("endAngle")&&(t.scaleValues[1]=t.symbolData.endAngle);else if(0===t.libID&&t.symbolType===SuperMapAlgoPlot.SymbolType.LINEMARKING)void 0!==e.islocationCircle&&null!==e.islocationCircle&&(t.islocationCircle=e.islocationCircle),void 0!==e.textBoxType&&null!==e.textBoxType&&(t.textBoxType=e.textBoxType),e.tipPoint&&(this.scaleValues[1]=e.tipPoint.x,this.scaleValues[2]=e.tipPoint.y);else if(0===t.libID&&t.symbolType===SuperMapAlgoPlot.SymbolType.SYMBOLTEXTBOX)void 0!==e.roundBox&&null!==e.roundBox&&(t.roundBox=e.roundBox),void 0!==e.textBoxType&&null!==e.textBoxType&&(t.textBoxType=e.textBoxType),e.tipPoint&&(this.scaleValues[1]=e.tipPoint.x,this.scaleValues[2]=e.tipPoint.y);else if(0===t.libID&&t.symbolType===SuperMapAlgoPlot.SymbolType.ANNOFRAMESYMBOLM)e.tipPoint1&&(this.scaleValues[0]=e.tipPoint1.x,this.scaleValues[1]=e.tipPoint1.y),e.tipPoint2&&(this.scaleValues[2]=e.tipPoint2.x,this.scaleValues[3]=e.tipPoint2.y);else if(0===t.libID&&t.symbolType===SuperMapAlgoPlot.SymbolType.PATHTEXT)t.isAvoid=e.isAvoid,t.isCurve=e.isCurve,t.relLineText=e.relLineText,t.showPathLine=e.showPathLine,t.textToLineDistance=e.textToLineDistance,t.showPathLineArrow=e.showPathLineArrow;else if(0===t.libID&&t.symbolType===SuperMapAlgoPlot.SymbolType.ARCREGION){if(o){if(t.centerPoint=L.latLng(e.centerPoint.y,e.centerPoint.x),t.symbolData.circlePts){for(var et=[],ot=0;ot<e.circlePts.length;ot++)et.push(new SuperMapAlgoPlot.Point(e.circlePts[ot].x,e.circlePts[ot].y));0!==et.length&&(t.circlePts=et)}t.spatialAnalystUrl=e.spatialAnalystUrl}else t.centerPoint=new SuperMapAlgoPlot.Point(e.centerPoint.x,e.centerPoint.y);t.endAngle=e.endAngle,t.radius=e.radius,t.radiusPosAngle=e.radiusPosAngle,t.startAngle=e.startAngle,t.textPosition=e.textPosition,t.radiusLineType=e.radiusLineType,t.radiusText=e.radiusText}else 0===t.libID&&t.symbolType===SuperMapAlgoPlot.SymbolType.POLYGONREGION&&(t.symbolData.hasOwnProperty("textPosition")?t.scaleValues[1]=t.symbolData.textPosition:void 0===t.scaleValues[1]&&(t.scaleValues[1]=t.symbolData.annotationPosition))}}}}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();
/* Copyright© 2000 - 2018 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
var l=e.Point=function(){function t(e,o,i,l){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=parseFloat(e),this.y=parseFloat(o),this.tag=l||0==l?parseFloat(l):null,this.type=i||"Point",this.CLASS_NAME="SuperMapAlgoPlot"}return i(t,[{key:"clone",value:function(e){return null==e&&(e=new t(this.x,this.y)),SuperMap.Util.applyDefaults(e,this),e}},{key:"calculateBounds",value:function(){this.bounds=new Bounds(this.x,this.y,this.x,this.y)}},{key:"equals",value:function(t){var e=!1;return null!=t&&(e=this.x===t.x&&this.y===t.y||isNaN(this.x)&&isNaN(this.y)&&isNaN(t.x)&&isNaN(t.y)),e}},{key:"move",value:function(t,e){this.x=this.x+t,this.y=this.y+e,this.clearBounds()}},{key:"toShortString",value:function(){return this.x+", "+this.y}},{key:"destroy",value:function(){this.x=null,this.y=null,this.tag=null,function t(e,o,i){null===e&&(e=Function.prototype);var l=Object.getOwnPropertyDescriptor(e,o);if(void 0===l){var n=Object.getPrototypeOf(e);return null===n?void 0:t(n,o,i)}if("value"in l)return l.value;var a=l.get;return void 0!==a?a.call(i):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"destroy",this).call(this)}},{key:"getVertices",value:function(t){return[this]}}]),t}();SuperMapAlgoPlot.Point=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AddPoint_WayType=e.RouteNodePrimitives=e.Primitives=e.PlottingUtil=e.AnalysisSymbol=e.Point=void 0;var i=o(148),l=o(147),n=o(146),a=o(145),s=o(144),r=o(143);e.Point=i.Point,e.AnalysisSymbol=l.AnalysisSymbol,e.PlottingUtil=n.PlottingUtil,e.Primitives=a.Primitives,e.RouteNodePrimitives=s.RouteNodePrimitives,e.AddPoint_WayType=r.AddPoint_WayType},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.CalculateSVGGradient=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.feature=e}return i(t,[{key:"destroy",value:function(){this.feature=null}},{key:"createGradient",value:function(){var t=!1;this.feature.layer._renderer._container.defs||(this.feature.layer._renderer._container.defs=L.SVG.create("defs"),t=!0);var e=null;"LINEAR"===this.feature.style.fillGradientMode&&(e=document.getElementById("linearGradient_"+this.feature.uuid)),"RADIAL"===this.feature.style.fillGradientMode&&(e=document.getElementById("radialGradient_"+this.feature.uuid));var o=this.createGradientDirection();for("LINEAR"===this.feature.style.fillGradientMode?((e=null===e?L.SVG.create("linearGradient"):e).setAttributeNS(null,"x1",o.x1),e.setAttributeNS(null,"y1",o.y1),e.setAttributeNS(null,"x2",o.x2),e.setAttributeNS(null,"y2",o.y2)):"RADIAL"===this.feature.style.fillGradientMode&&((e=null===e?L.SVG.create("radialGradient"):e).setAttributeNS(null,"cx",o.cx),e.setAttributeNS(null,"cy",o.cy),e.setAttributeNS(null,"fx",o.fx),e.setAttributeNS(null,"fy",o.fy),e.setAttributeNS(null,"r",o.r));e.hasChildNodes();)e.removeChild(e.firstChild);for(var i=0,l=o.colors.length;i<l;i++){var n=L.SVG.create("stop");n.setAttributeNS(null,"offset",o.colors[i].offset),n.setAttributeNS(null,"style","stop-color:"+SuperMap.Plot.PlottingUtil.colorRGBA(o.colors[i].color,o.colors[i].opacity)),e.appendChild(n)}return 0===e.id.length&&e.setAttributeNS(null,"id",e.tagName+"_"+this.feature.uuid),this.feature.layer._renderer._container.defs.appendChild(e),t&&this.feature.layer._renderer._container.appendChild(this.feature.layer._renderer._container.defs),e.id}},{key:"createTextureFill",value:function(t){var e=!1;this.feature.layer._renderer._container.defs||(this.feature.layer._renderer._container.defs=L.SVG.create("defs"),e=!0);var o=document.getElementById("patternFill_"+this.feature.uuid);function i(t){var e="";return 2===t.fillID?e="rotate(-45)":3===t.fillID||6===t.fillID?e="rotate(0)":4===t.fillID||5===t.fillID?e="rotate(45)":7===t.fillID&&(e="rotate(90)"),e}function l(t,e,o){var i=L.SVG.create("path");i.setAttributeNS(null,"d",t),i.setAttributeNS(null,"stroke",o.color),i.setAttributeNS(null,"stroke-width","2"),i.setAttributeNS(null,"stroke-linecap","square"),i.setAttributeNS(null,"stroke-opacity",o.opacity),e.appendChild(i)}function n(t,e,o){var i=L.SVG.create("polygon");i.setAttributeNS(null,"points",t),i.setAttributeNS(null,"fill",o.color),i.setAttributeNS(null,"fill-opacity",o.opacity),e.appendChild(i)}return o?(o.setAttributeNS(null,"patternTransform",i(t[0]).toString()),3===t[0].fillID||6===t[0].fillID||7===t[0].fillID?(o.setAttributeNS(null,"width",7.3),o.setAttributeNS(null,"height",7.3),o.childNodes[0].setAttributeNS(null,"points","0 0 0 7.3 7.3 7.3 7.3 0"),o.childNodes[1].setAttributeNS(null,"d","M 7.3 0 L 0 0")):(o.setAttributeNS(null,"width",5.4),o.setAttributeNS(null,"height",5.4),o.childNodes[0].setAttributeNS(null,"points","0 0 0 5.4 5.4 5.4 5.4 0"),o.childNodes[1].setAttributeNS(null,"d","M 5.4 0 L 0 0")),o.childNodes[0].setAttributeNS(null,"fill",t[1].color),o.childNodes[0].setAttributeNS(null,"fill-opacity",t[1].opacity),o.childNodes[1].setAttributeNS(null,"stroke",t[0].color),o.childNodes[1].setAttributeNS(null,"stroke-opacity",t[0].opacity),3===t[0].fillID||4===t[0].fillID?(o.childNodes[2]&&(o.childNodes[2].setAttributeNS(null,"stroke",t[0].color),o.childNodes[2].setAttributeNS(null,"stroke-opacity",t[0].opacity)),3===t[0].fillID?null===o&&l("M 0 7.3 L 0 0",o,t[0]):4===t[0].fillID&&null===o&&l("M 0 5.4 L 0 0",o,t[0])):o.childNodes[2]&&o.removeChild(o.childNodes[2]),0===o.id.length&&o.setAttributeNS(null,"id","patternFill_"+this.feature.uuid),o.id):((o=null===o?L.SVG.create("pattern"):o).setAttributeNS(null,"x",0),o.setAttributeNS(null,"y",0),3===t[0].fillID||6===t[0].fillID||7===t[0].fillID?(o.setAttributeNS(null,"width",7.3),o.setAttributeNS(null,"height",7.3)):(o.setAttributeNS(null,"width",5.4),o.setAttributeNS(null,"height",5.4)),o.setAttributeNS(null,"patternUnits","userSpaceOnUse"),o.setAttributeNS(null,"patternTransform",i(t[0]).toString()),3===t[0].fillID||6===t[0].fillID||7===t[0].fillID?(n("0 0 0 7.3 7.3 7.3 7.3 0",o,t[1]),l("M 7.3 0 L 0 0",o,t[0])):(n("0 0 0 5.4 5.4 5.4 5.4 0",o,t[1]),l("M 5.4 0 L 0 0",o,t[0])),4===t[0].fillID?l("M 0 5.4 L 0 0",o,t[0]):3===t[0].fillID&&l("M 0 7.3 L 0 0",o,t[0]),this.feature.layer._renderer._container.defs.appendChild(o),e&&this.feature.layer._renderer._container.appendChild(this.feature.layer._renderer._container.defs),0===o.id.length&&o.setAttributeNS(null,"id","patternFill_"+this.feature.uuid),o.id)}},{key:"createFillMode",value:function(t){if(void 0!==this.feature.style.fillSymbolID)if(t.fill=this.feature.style.fill,t.fillSymbolID=this.feature.style.fillSymbolID,0===this.feature.style.fillSymbolID||1===this.feature.style.fillSymbolID||!0===this.feature.style.fill||!1===this.feature.style.fill)0===this.feature.style.fillSymbolID?t.fill=!0:1===this.feature.style.fillSymbolID&&(t.fill=!1),t.fillColor=this.feature.style.fillColor,t.fillOpacity=this.feature.style.fillOpacity;else if(this.feature.style.fillColor!==this.feature.style.fillBackColor||this.feature.style.fillBackOpacity>0&&this.feature.style.fillBackOpacity<1){var e=[];e.push({fillID:this.feature.style.fillSymbolID,color:this.feature.style.fillColor,opacity:this.feature.style.fillOpacity},{fillID:this.feature.style.fillSymbolID,color:this.feature.style.fillBackColor,opacity:this.feature.style.fillBackOpacity}),this.feature._map.getRenderer(this.feature.layer)instanceof L.SVG?(t.fillOpacity=1,t.fillColor="url(#"+this.createTextureFill(e)+")",t.fill=t.fillColor):new SuperMap.Plot.CalculateCanvasGradient(this.feature,this.feature.getBounds()).createTextureFill(e)}else t.fill=!0,t.fillColor=this.feature.style.fillColor,t.fillOpacity=this.feature.style.fillOpacity;else t.fill=this.feature.style.fill,t.fillColor=this.feature.style.fillColor,t.fillOpacity=this.feature.style.fillOpacity}},{key:"createGradientDirection",value:function(){var t=[];if("LINEAR"===this.feature.style.fillGradientMode){if(null!==this.feature.style.fillCenterOffsetX&&void 0!==this.feature.style.fillCenterOffsetX&&(0===this.feature.style.fillAngle||180===this.feature.style.fillAngle?(t.push({offset:0,color:this.feature.style.fillBackColor,opacity:this.feature.style.fillOpacity}),t.push({offset:this.feature.style.fillCenterOffsetX,color:this.feature.style.fillColor,opacity:this.feature.style.fillOpacity}),t.push({offset:1,color:this.feature.style.fillBackColor,opacity:this.feature.style.fillOpacity})):90===this.feature.style.fillAngle||270===this.feature.style.fillAngle?(t.push({offset:0,color:this.feature.style.fillBackColor,opacity:this.feature.style.fillOpacity}),t.push({offset:this.feature.style.fillCenterOffsetY,color:this.feature.style.fillColor,opacity:this.feature.style.fillOpacity}),t.push({offset:1,color:this.feature.style.fillBackColor,opacity:this.feature.style.fillOpacity})):(t.push({offset:0,color:this.feature.style.fillBackColor,opacity:this.feature.style.fillOpacity}),t.push({offset:this.feature.style.fillCenterOffsetX/2*(Math.sqrt(2)/2)*Math.abs(Math.sin(this.feature.style.fillAngle*Math.PI/180)),color:this.feature.style.fillColor,opacity:this.feature.style.fillOpacity}),t.push({offset:1,color:this.feature.style.fillBackColor,opacity:this.feature.style.fillOpacity}))),this.feature.style.fillAngle>=360&&(this.feature.style.fillAngle=0),0===this.feature.style.fillAngle)return{x1:0,y1:0,x2:1,y2:0,colors:t};if(90===this.feature.style.fillAngle)return{x1:0,y1:1,x2:0,y2:0,colors:t};if(180===this.feature.style.fillAngle)return{x1:1,y1:0,x2:0,y2:0,colors:t};if(270===this.feature.style.fillAngle)return{x1:0,y1:0,x2:0,y2:1,colors:t};if(0<this.feature.style.fillAngle&&this.feature.style.fillAngle<=45)return{x1:0,y1:1,x2:1,y2:(1-Math.tan(this.feature.style.fillAngle*Math.PI/180))/2,colors:t};if(45<this.feature.style.fillAngle&&this.feature.style.fillAngle<90)return{x1:0,y1:1,x2:(1-Math.tan((this.feature.style.fillAngle-45)*Math.PI/180))/2,y2:0,colors:t};if(90<this.feature.style.fillAngle&&this.feature.style.fillAngle<=135)return{x1:1,y1:1,x2:Math.tan((this.feature.style.fillAngle-90)*Math.PI/180)/2,y2:0,colors:t};if(135<this.feature.style.fillAngle&&this.feature.style.fillAngle<180)return{x1:1,y1:1,x2:0,y2:Math.tan((this.feature.style.fillAngle-135)*Math.PI/180)/2,colors:t};if(180<this.feature.style.fillAngle&&this.feature.style.fillAngle<=225)return{x1:1,y1:0,x2:0,y2:Math.tan((this.feature.style.fillAngle-180)*Math.PI/180)/2,colors:t};if(225<this.feature.style.fillAngle&&this.feature.style.fillAngle<270)return{x1:1,y1:0,x2:Math.tan((this.feature.style.fillAngle-225)*Math.PI/180)/2,y2:0,colors:t};if(270<this.feature.style.fillAngle&&this.feature.style.fillAngle<=315)return{x1:0,y1:0,x2:1-Math.tan((this.feature.style.fillAngle-270)*Math.PI/180)/2,y2:1,colors:t};if(315<this.feature.style.fillAngle&&this.feature.style.fillAngle<360)return{x1:0,y1:0,x2:1,y2:Math.tan((this.feature.style.fillAngle-315)*Math.PI/180)/2,colors:t}}else if("RADIAL"===this.feature.style.fillGradientMode)if(null!==this.feature.style.fillCenterOffsetX&&void 0!==this.feature.style.fillCenterOffsetX&&null!==this.feature.style.fillCenterOffsetY&&void 0!==this.feature.style.fillCenterOffsetY&&(t.push({offset:0,color:this.feature.style.fillColor,opacity:this.feature.style.fillOpacity}),this.feature.style.fillColor,this.feature.style.fillBackColor,t.push({offset:1,color:this.feature.style.fillBackColor,opacity:this.feature.style.fillOpacity})),this.feature.style.fillCenterOffsetX<=.5&&this.feature.style.fillCenterOffsetX>=0||this.feature.style.fillCenterOffsetX<=0&&this.feature.style.fillCenterOffsetX>=-1){if(this.feature.style.fillCenterOffsetY>=0&&this.feature.style.fillCenterOffsetY<=.5||this.feature.style.fillCenterOffsetY>=-.5&&this.feature.style.fillCenterOffsetY<=0)return{cx:.5,cy:.5,fx:.5+this.feature.style.fillCenterOffsetX,fy:.5-this.feature.style.fillCenterOffsetY,r:.5*Math.sqrt(2),colors:t};if(this.feature.style.fillCenterOffsetY>=.5&&this.feature.style.fillCenterOffsetY<=.8||this.feature.style.fillCenterOffsetY>=-.8&&this.feature.style.fillCenterOffsetY<=-.5)return{cx:.5,cy:.5,fx:.5+this.feature.style.fillCenterOffsetX,fy:.5-this.feature.style.fillCenterOffsetY,r:.8*Math.sqrt(2),colors:t};if(this.feature.style.fillCenterOffsetY>=.8&&this.feature.style.fillCenterOffsetY<=1||this.feature.style.fillCenterOffsetY>=-1&&this.feature.style.fillCenterOffsetY<=-.8)return{cx:.5,cy:.5,fx:.5+this.feature.style.fillCenterOffsetX,fy:.5-this.feature.style.fillCenterOffsetY,r:Math.sqrt(2),colors:t}}else if(this.feature.style.fillCenterOffsetX<=.8&&this.feature.style.fillCenterOffsetX>.5||this.feature.style.fillCenterOffsetX<=-.5&&this.feature.style.fillCenterOffsetX>=-.8){if(this.feature.style.fillCenterOffsetY>=0&&this.feature.style.fillCenterOffsetY<=.5||this.feature.style.fillCenterOffsetY>=-.5&&this.feature.style.fillCenterOffsetY<=0)return{cx:.5,cy:.5,fx:.5+this.feature.style.fillCenterOffsetX,fy:.5-this.feature.style.fillCenterOffsetY,r:.8*Math.sqrt(2),colors:t};if(this.feature.style.fillCenterOffsetY>=.5&&this.feature.style.fillCenterOffsetY<=.8||this.feature.style.fillCenterOffsetY>=-.8&&this.feature.style.fillCenterOffsetY<=-.5)return{cx:.5,cy:.5,fx:.5+this.feature.style.fillCenterOffsetX,fy:.5-this.feature.style.fillCenterOffsetY,r:.8*Math.sqrt(2),colors:t};if(this.feature.style.fillCenterOffsetY>=.8&&this.feature.style.fillCenterOffsetY<=1||this.feature.style.fillCenterOffsetY>=-1&&this.feature.style.fillCenterOffsetY<=-.8)return{cx:.5,cy:.5,fx:.5+this.feature.style.fillCenterOffsetX,fy:.5-this.feature.style.fillCenterOffsetY,r:Math.sqrt(2),colors:t}}else if(this.feature.style.fillCenterOffsetX<=1&&this.feature.style.fillCenterOffsetX>.8||this.feature.style.fillCenterOffsetX<=-.8&&this.feature.style.fillCenterOffsetX>=-1){if(this.feature.style.fillCenterOffsetY>=0&&this.feature.style.fillCenterOffsetY<=.5||this.feature.style.fillCenterOffsetY>=-.5&&this.feature.style.fillCenterOffsetY<=0)return{cx:.5,cy:.5,fx:.5+this.feature.style.fillCenterOffsetX,fy:.5-this.feature.style.fillCenterOffsetY,r:Math.sqrt(2),colors:t};if(this.feature.style.fillCenterOffsetY>=.5&&this.feature.style.fillCenterOffsetY<=.8||this.feature.style.fillCenterOffsetY>=-.8&&this.feature.style.fillCenterOffsetY<=-.5)return{cx:.5,cy:.5,fx:.5+this.feature.style.fillCenterOffsetX,fy:.5-this.feature.style.fillCenterOffsetY,r:Math.sqrt(2),colors:t};if(this.feature.style.fillCenterOffsetY>=.8&&this.feature.style.fillCenterOffsetY<=1||this.feature.style.fillCenterOffsetY>=-1&&this.feature.style.fillCenterOffsetY<=-.8)return{cx:.5,cy:.5,fx:.5+this.feature.style.fillCenterOffsetX,fy:.5-this.feature.style.fillCenterOffsetY,r:Math.sqrt(2),colors:t}}}}]),t}();SuperMap.Plot.CalculateSVGGradient=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.CalculateCanvasGradient=function(){function t(e,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.feature=e,this._bounds=o}return i(t,[{key:"destroy",value:function(){this.feature=null}},{key:"getContext",value:function(){return this.feature._map.getRenderer(this.feature.layer)._ctx}},{key:"calculateObjectByBounds",value:function(){var t=this.feature._map.latLngToLayerPoint(L.latLng(this._bounds.getNorth(),this._bounds.getWest())),e=this.feature._map.latLngToLayerPoint(L.latLng(this._bounds.getSouth(),this._bounds.getEast())),o=this.feature._map.latLngToLayerPoint(L.latLng(this._bounds.getCenter()));if(t.x!==e.x||t.y!==e.y){var i=Math.max(t.x,e.x),l=Math.max(t.y,e.y),n=Math.min(t.x,e.x),a=Math.min(t.y,e.y);return{ptMinX:n,ptMinY:a,width:Math.abs(i-n),height:Math.abs(l-a),center:o,r:Math.abs(t.x-e.x)>Math.abs(e.y-e.y)?Math.abs(t.x-e.x):Math.abs(t.y-e.y)}}}},{key:"createGradient",value:function(){var t=null;if(this.getContext()instanceof CanvasRenderingContext2D){var e=this.calculateObjectByBounds();if("LINEAR"===this.feature.style.fillGradientMode){var o=this.getGradientDirection(this.feature.style.fillAngle);if(t=this.getContext().createLinearGradient(e.ptMinX+e.width*o.x1,e.ptMinY+e.height*o.y1,e.ptMinX+e.width*o.x2,e.ptMinY+e.height*o.y2),0===this.feature.style.fillCenterOffsetX&&0===this.feature.style.fillCenterOffsetY)t.addColorStop(0,SuperMap.Plot.PlottingUtil.colorRGBA(this.feature.style.fillColor,this.feature.style.fillOpacity)),t.addColorStop(1,SuperMap.Plot.PlottingUtil.colorRGBA(this.feature.style.fillBackColor,this.feature.style.fillOpacity));else{var i=this.feature.style.fillAngle;0===i||180===i||90===i||270===i?(t.addColorStop(0,SuperMap.Plot.PlottingUtil.colorRGBA(this.feature.style.fillBackColor,this.feature.style.fillOpacity)),0!==i&&180!==i||t.addColorStop(this.feature.style.fillCenterOffsetX,SuperMap.Plot.PlottingUtil.colorRGBA(this.feature.style.fillColor,this.feature.style.fillOpacity)),90!==i&&270!==i||t.addColorStop(this.feature.style.fillCenterOffsetY,SuperMap.Plot.PlottingUtil.colorRGBA(this.feature.style.fillColor,this.feature.style.fillOpacity)),t.addColorStop(1,SuperMap.Plot.PlottingUtil.colorRGBA(this.feature.style.fillBackColor,this.feature.style.fillOpacity))):(t.addColorStop(0,SuperMap.Plot.PlottingUtil.colorRGBA(this.feature.style.fillBackColor,this.feature.style.fillOpacity)),t.addColorStop(this.feature.style.fillCenterOffsetX>=this.feature.style.fillCenterOffsetY?this.feature.style.fillCenterOffsetX:this.feature.style.fillCenterOffsetY*Math.cos(this.feature.style.fillAngle*Math.PI/180),SuperMap.Plot.PlottingUtil.colorRGBA(this.feature.style.fillColor,this.feature.style.fillOpacity)),t.addColorStop(1,SuperMap.Plot.PlottingUtil.colorRGBA(this.feature.style.fillBackColor,this.feature.style.fillOpacity)))}}if("RADIAL"===this.feature.style.fillGradientMode){var l=this.feature.style.fillCenterOffsetX*e.r,n=this.feature.style.fillCenterOffsetY*e.r,a=e.r/Math.sqrt(2)+Math.abs(l)>e.r/Math.sqrt(2)+Math.abs(n)?e.r/Math.sqrt(2)+Math.abs(l):e.r/Math.sqrt(2)+Math.abs(n);(t=this.getContext().createRadialGradient(e.center.x+l,e.center.y-n,0,e.center.x+l,e.center.y-n,a)).addColorStop(0,SuperMap.Plot.PlottingUtil.colorRGBA(this.feature.style.fillColor,this.feature.style.fillOpacity)),this.feature.style.fillColor,this.feature.style.fillBackColor,t.addColorStop(1,SuperMap.Plot.PlottingUtil.colorRGBA(this.feature.style.fillBackColor,this.feature.style.fillOpacity))}return t}}},{key:"createTextureFill",value:function(t){if(0!==t.length){var e=document.createElement("canvas");document.body.appendChild(e);var o=e.getContext("2d");e.width=8,e.height=8;var i=e.width,l=e.height,n=SuperMap.Plot.PlottingUtil.colorStringToRGB(t[0].color);o.strokeStyle="rgba("+n.red+","+n.green+","+n.blue+","+t[0].opacity+")",o.lineWidth=1;var a=SuperMap.Plot.PlottingUtil.colorStringToRGB(t[1].color);switch(o.fillStyle="rgba("+a.red+","+a.green+","+a.blue+","+t[1].opacity+")",o.fillRect(0,0,e.width,e.height),o.beginPath(),t[0].fillID){case 0:case 1:break;case 2:o.moveTo(0,l),o.lineTo(i,0);break;case 3:o.moveTo(0,0),o.lineTo(i,0),o.moveTo(0,0),o.lineTo(0,l);break;case 4:o.moveTo(0,l),o.lineTo(i,0),o.moveTo(0,0),o.lineTo(i,l);break;case 5:o.moveTo(0,0),o.lineTo(i,l);break;case 6:o.moveTo(0,0),o.lineTo(i,0);break;case 7:o.moveTo(0,0),o.lineTo(0,l)}o.closePath(),o.stroke(),o.fill();var s=o.createPattern(e,"repeat");return document.body.removeChild(e),s}}},{key:"createFillMode",value:function(t){if(void 0!==this.feature.style.fillSymbolID)if(t.fill=this.feature.style.fill,t.fillSymbolID=this.feature.style.fillSymbolID,0===this.feature.style.fillSymbolID||1===this.feature.style.fillSymbolID||!0===this.feature.style.fill||!1===this.feature.style.fill)0===this.feature.style.fillSymbolID?t.fill=!0:1===this.feature.style.fillSymbolID&&(t.fill=!1),t.fillColor=this.feature.style.fillColor,t.fillOpacity=this.feature.style.fillOpacity;else if(this.feature.style.fillColor!==this.feature.style.fillBackColor||this.feature.style.fillBackOpacity>0&&this.feature.style.fillBackOpacity<1){var e=[];e.push({fillID:this.feature.style.fillSymbolID,color:this.feature.style.fillColor,opacity:this.feature.style.fillOpacity},{fillID:this.feature.style.fillSymbolID,color:this.feature.style.fillBackColor,opacity:this.feature.style.fillBackOpacity}),t.fill=!0,t.fillColor=this.createTextureFill(e),t.fillOpacity=this.feature.style.fillColor}else t.fill=!0,t.fillColor=this.feature.style.fillColor,t.fillOpacity=this.feature.style.fillOpacity;else t.fill=this.feature.style.fill,t.fillColor=this.feature.style.fillColor,t.fillOpacity=this.feature.style.fillOpacity}},{key:"getGradientDirection",value:function(t){var e=function(t){return{x:Math.cos(t),y:Math.sin(t)}},o=function(t){return t*Math.PI/180},i=e(o(180-t%360)),l=e(o(360-t%360)),n=Math.pow(2,-52);return(i.x<=0||Math.abs(i.x)<=n)&&(i.x=0),(i.y<=0||Math.abs(i.y)<=n)&&(i.y=0),(l.x<=0||Math.abs(l.x)<=n)&&(l.x=0),(l.y<=0||Math.abs(l.y)<=n)&&(l.y=0),{x1:i.x,y1:i.y,x2:l.x,y2:l.y}}}]),t}();SuperMap.Plot.CalculateCanvasGradient=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CalculateSVGGradient=e.CalculateCanvasGradient=void 0;var i=o(151),l=o(150);e.CalculateCanvasGradient=i.CalculateCanvasGradient,e.CalculateSVGGradient=l.CalculateSVGGradient},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=e.TransactionInfo=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=e||{},this.layer=e.layer?e.layer:null,this.feature=e.feature?e.feature:null,this.uuid=e.uuid?e.uuid:null,this.functionName=e.functionName?e.functionName:null,this.undoParams=e.undoParams?e.undoParams:null,this.redoParams=e.redoParams?e.redoParams:null,this.propertyName=e.propertyName?e.propertyName:null,this.undoValue=e.undoValue?e.undoValue:null,this.redoValue=e.redoValue?e.redoValue:null,this.CLASS_NAME="SuperMap.Plot.TransactionInfo"};SuperMap.Plot.TransactionInfo=i},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.Transaction=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=e||{},this.transType=e.transType?e.transType:SuperMap.Plot.TransactionType.EDIT,this.transInfos=[],this.CLASS_NAME="SuperMap.Plot.Transaction"}return i(t,[{key:"destroy",value:function(){this.transInfos=null,this.transType=null}}]),t}();SuperMap.Plot.Transaction=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.TowardNode=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=e||{},this.routeNodeId=e.routeNodeId?e.routeNodeId:null,this.relLineText=e.relLineText?e.relLineText:SuperMap.Plot.RelLineText.ONLEFTLINE,this.index=e.index?e.index:0,this.textContent=e.textContent?e.textContent:null,this.offsetX=e.offsetX?e.offsetX:null,this.offsetY=e.offsetY?e.offsetY:null,this.style=e.style?e.style:{fontSize:12,fontFamily:"Microsoft YaHei"},this.CLASS_NAME="SuperMap.Plot.TowardNode"}return i(t,[{key:"destroy",value:function(){this.routeNodeId=null,this.relLineText=null,this.textContent=null,this.style=null}},{key:"clone",value:function(){return new t({routeNodeId:this.routeNodeId,relLineText:this.relLineText,textContent:this.textContent,style:SuperMap.Util.cloneObject(this.style)})}},{key:"parseSymbolData",value:function(t){return this.routeNodeId=t.routeNodeId,this.relLineText=t.relLineText,this.index=t.index,this.textContent=t.textContent,this.offsetX=t.offsetX,this.offsetY=t.offsetY,this.style=SuperMap.Plot.AnalysisSymbol.getStyle(t,!0),this}},{key:"setSymbolData",value:function(){var t={};return t.routeNodeId=this.routeNodeId,t.relLineText=this.relLineText,t.index=this.index,t.textContent=this.textContent,t.offsetX=this.offsetX,t.offsetY=this.offsetY,SuperMap.Util.applyDefaults(this.style,L.supermap.plotting.PlottingObject.prototype._defaultStyle),SuperMap.Plot.AnalysisSymbol.setStyle(this.style,t,!0),t}}]),t}();SuperMap.Plot.TowardNode=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.TimeWindowParameter=function(){function t(e,o,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.startOrbitPoint=e,this.endOrbitPoint=o,this.type=i,this.CLASS_NAME="SuperMap.Plot.TimeWindowParameter"}return i(t,[{key:"destroy",value:function(){this.startOrbitPoint=null,this.endOrbitPoint=null,this.type=null}}]),t}();SuperMap.Plot.TimeWindowParameter=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.Trajectory=function(){function t(e,o,i,l,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),n=n||{},this.latlngs=[],this.trajectoryLength=e,null==this.trajectoryLength&&(this.trajectoryLength=15),this.showTrackingLine=o,null==this.showTrackingLine&&(this.showTrackingLine=!0),this.showTrackingPoint=i,null==this.showTrackingPoint&&(this.showTrackingPoint=!1),this.saveTrackingPoint=null!=n.saveTrackingPoint&&n.saveTrackingPoint,this.trackingPointStyle=null!=n.trackingPointStyle?n.trackingPointStyle:0,this.trackingPointRadius=null!=n.trackingPointRadius?n.trackingPointRadius:2,this.style={color:"#ff0000",opacity:1,weight:1},null!=l&&(this.style=SuperMap.Util.copyAttributes(this.style,l)),this.CLASS_NAME="SuperMap.Plot.Trajectory"}return i(t,[{key:"addLatLng",value:function(t){this.latlngs.length>0&&SuperMap.Plot.PlottingUtil.equalFuzzy(t.lat,this.latlngs[this.latlngs.length-1].lat)&&SuperMap.Plot.PlottingUtil.equalFuzzy(t.lng,this.latlngs[this.latlngs.length-1].lng)||(!1===this.saveTrackingPoint&&-1!==this.trajectoryLength&&this.trajectoryLength>0?this.latlngs.length<this.trajectoryLength?this.latlngs.push(L.latLng(t.lat,t.lng)):(this.latlngs.splice(0,this.latlngs.length-this.trajectoryLength+1),this.latlngs.push(L.latLng(t.lat,t.lng))):-1!==this.trajectoryLength&&!0!==this.saveTrackingPoint||this.latlngs.push(L.latLng(t.lat,t.lng)))}},{key:"getDisplayLatLngs",value:function(t){var e=[];if("none"===this.style.display)return e;var o=[],i=0;this.trajectoryLength>0&&this.latlngs.length>this.trajectoryLength&&(i+=this.latlngs.length-this.trajectoryLength);for(var l=i;l<this.latlngs.length&&!t.contains(this.latlngs[l]);l++)if(!0===this.showTrackingLine&&l!==this.latlngs.length-1){0===o.length&&(o.push(t.getNorthWest()),o.push(t.getNorthEast()),o.push(t.getSouthEast()),o.push(t.getSouthWest()),o.push(t.getNorthWest()));for(var n=!1,a=0;a<o.length-1;a++)if(SuperMap.Plot.PlottingUtil.isCross(this.latlngs[l],this.latlngs[l+1],o[a],o[a+1])){n=!0;break}if(n)break}var s=i;for(l>i&&(s=l),l=s;l<this.latlngs.length;l++)e.push(this.latlngs[l]);return e}},{key:"generateUuidKey",value:function(){return this.trackingPointStyle.toString()+"_"+this.trackingPointRadius.toString()+"_"+this.style.color+"_"+this.style.weight.toString()}},{key:"destroy",value:function(){this.latlngs.length=0,this.trajectoryLength=null,this.showTrackingLine=null,this.showTrackingPoint=null,this.saveTrackingPoint=null,this.style=null}},{key:"clone",value:function(){var t={saveTrackingPoint:this.saveTrackingPoint},e={};return e=SuperMap.Util.copyAttributes(e,this.style),new SuperMap.Plot.Trajectory(this.trajectoryLength,this.showTrackingLine,this.showTrackingPoint,e,t)}},{key:"setSymbolData",value:function(){var t={};return t.trajectoryLength=this.trajectoryLength,t.showTrackingLine=this.showTrackingLine,t.showTrackingPoint=this.showTrackingPoint,t.saveTrackingPoint=this.saveTrackingPoint,SuperMap.Plot.AnalysisSymbol.setStyle(this.style,t,!0),t}},{key:"parseSymbolData",value:function(t){return this.trajectoryLength=t.trajectoryLength,this.showTrackingLine=t.showTrackingLine,this.showTrackingPoint=t.showTrackingPoint,this.saveTrackingPoint=t.saveTrackingPoint,SuperMap.Plot.AnalysisSymbol.getStyle(symbolTextData,!0),this}}]),t}();SuperMap.Plot.Trajectory=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.PictureFrame=function(){function t(e,o,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),i=i||{},this.path=e,this.position=o,void 0!==this.position&&null!==this.position||(this.position=SuperMap.Plot.Position.TOP),this.offsetX=i.offsetX?i.offsetX:0,this.offsetY=i.offsetY?i.offsetY:0,this.width=i.width?i.width:32,this.height=i.height?i.height:32,this.CLASS_NAME="SuperMap.Plot.PictureFrame"}return i(t,[{key:"destroy",value:function(){this.path=null,this.position=null,this.offsetX=null,this.offsetY=null,this.width=null,this.height=null}},{key:"clone",value:function(){var t={offsetX:this.offsetX,offsetY:this.offsetY,width:this.width,height:this.height};return new SuperMap.Plot.PictureFrame(this.path,this.position,t)}},{key:"setSymbolData",value:function(){var t={};return t.path=this.path,t.position=this.position,t.offsetX=this.offsetX,t.offsetY=this.offsetY,t.width=this.width,t.height=this.height,t}},{key:"parseSymbolData",value:function(t){return this.path=t.path,this.position=t.position,null!=t.offsetX&&(this.offsetX=t.offsetX),null!=t.offsetY&&(this.offsetY=t.offsetY),null!=t.width&&(this.width=t.width),null!=t.height&&(this.height=t.height),this}}]),t}();SuperMap.Plot.PictureFrame=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.BloodVolume=function(){function t(e,o,i,l){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),l=l||{},this.volume=e,this.position=o,void 0!==this.position&&null!==this.position||(this.position=SuperMap.Plot.Position.TOP),this.offsetX=l.offsetX?l.offsetX:0,this.offsetY=l.offsetY?l.offsetY:0,this.width=l.width?l.width:null,this.height=l.height?l.height:null,this.style={display:"display",color:"#808080",opacity:1,weight:4,remainingVolumeColor:"#00ff00",remainingVolumeOpacity:.8,consumeVolumeColor:"#000000",consumeVolumeOpacity:.8},null!=i&&(this.style=SuperMap.Util.copyAttributes(this.style,i)),this.CLASS_NAME="SuperMap.Plot.BloodVolume"}return i(t,[{key:"destroy",value:function(){this.volume=null,this.position=null,this.offsetX=null,this.offsetY=null,this.width=null,this.height=null,this.style=null}},{key:"clone",value:function(){var t={offsetX:this.offsetX,offsetY:this.offsetY,width:this.width,height:this.height},e={};return e=SuperMap.Util.copyAttributes(e,this.style),new SuperMap.Plot.BloodVolume(this.volume,this.position,e,t)}},{key:"setSymbolData",value:function(){var t={};return t.volume=this.volume,t.position=this.position,t.offsetX=this.offsetX,t.offsetY=this.offsetY,t.width=this.width,t.height=this.height,null!=this.style&&(t.style={},null!=this.style.display&&(t.style.display=this.style.display),null!=this.style.color&&(t.style.color=this.style.color),null!=this.style.opacity&&(t.style.opacity=this.style.opacity),null!=this.style.weight&&(t.style.weight=this.style.weight),null!=this.style.remainingVolumeColor&&(t.style.remainingVolumeColor=this.style.remainingVolumeColor),null!=this.style.remainingVolumeOpacity&&(t.style.remainingVolumeOpacity=this.style.remainingVolumeOpacity),null!=this.style.consumeVolumeColor&&(t.style.consumeVolumeColor=this.style.consumeVolumeColor),this.style.consumeVolumeOpacity&&(t.style.consumeVolumeOpacity=this.style.consumeVolumeOpacity)),t}},{key:"parseSymbolData",value:function(t){return this.volume=t.volume,this.position=t.position,this.offsetX=t.offsetX,this.offsetY=t.offsetY,null!=t.width&&(this.width=t.width),null!=t.height&&(this.height=t.height),null!=t.style&&(null==this.style&&(this.style={}),null!=t.style.display&&(this.style.display=t.style.display),null!=t.style.color&&(this.style.color=t.style.color),null!=t.style.opacity&&(this.style.opacity=t.style.opacity),null!=t.style.weight&&(this.style.weight=t.style.weight),null!=t.style.remainingVolumeColor&&(this.style.remainingVolumeColor=t.style.remainingVolumeColor),null!=t.style.remainingVolumeOpacity&&(this.style.remainingVolumeOpacity=t.style.remainingVolumeOpacity),null!=t.style.consumeVolumeColor&&(this.style.consumeVolumeColor=t.style.consumeVolumeColor),t.style.consumeVolumeOpacity&&(this.style.consumeVolumeOpacity=t.style.consumeVolumeOpacity)),this}}]),t}();SuperMap.Plot.BloodVolume=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.SymbolText=function(){function t(e,o,i,l){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),l=l||{},this.textContent=e,this.textPosition=o,void 0!==this.textPosition&&null!==this.textPosition||(this.textPosition=0),this.offsetX=l.offsetX?l.offsetX:0,this.offsetY=l.offsetY?l.offsetY:0,this.border=null!=l.border&&l.border,this.showRelationLine=null==l.showRelationLine||l.showRelationLine,this.paddingX=l.paddingX?l.paddingX:0,this.paddingY=l.paddingY?l.paddingY:0,this.style={display:"display",color:"#ff0000",lineSymbolID:0,opacity:"1.00",weight:2,lineCap:"square",lineJoin:"square",surroundLineColor:"#ffff00",surroundLineColorOpacity:"1.00",surroundLineWidth:4,fillSymbolID:1,fillColor:"#ff0000",fillOpacity:"0.31",fillBackColor:"#ff0000",fillBackOpacity:"1.00",fillGradientMode:"NONE",fontColor:"#000000",fontFamily:"Microsoft YaHei",fontSize:"12",fontStroke:!1,fontStrokeColor:"#ff0000",fontStrokeWidth:"2px",fontBackground:!1,fontBackgroundColor:"#ff0000",fontShadow:!1,fontShadowColor:"#ff0000",fontShadowOffsetX:0,fontShadowOffsetY:0,fontSpace:0,fontPercent:100,sizeFixed:!0,labelAlign:"lt",labelRotation:-0,labelXOffset:0,labelYOffset:0,fillAngle:0,fillCenterOffsetX:0,fillCenterOffsetY:0},null!=i&&(this.style=SuperMap.Util.copyAttributes(this.style,i)),this.lineStyle={color:"#ff0000",lineSymbolID:0,opacity:1,weight:2},null!=l.lineStyle&&(this.lineStyle=SuperMap.Util.copyAttributes(this.lineStyle,l.lineStyle)),this.CLASS_NAME="SuperMap.Plot.SymbolText"}return i(t,[{key:"destroy",value:function(){this.textContent=null,this.textPosition=null,this.offsetX=null,this.offsetY=null,this.border=null,this.paddingX=null,this.paddingY=null,this.showRelationLine=null,this.style=null,this.lineStyle=null}},{key:"clone",value:function(){var t={offsetX:this.offsetX,offsetY:this.offsetY,border:this.border,paddingX:this.paddingX,paddingY:this.paddingY,showRelationLine:this.showRelationLine},e={};e=SuperMap.Util.copyAttributes(e,this.style);var o=new SuperMap.Plot.SymbolText(this.textContent,this.textPosition,e,t),i={};return i=SuperMap.Util.copyAttributes(i,this.lineStyle),o.lineStyle=i,o}},{key:"setSymbolData",value:function(){var t={};return t.textContent=this.textContent,t.textPosition=this.textPosition,t.offsetX=this.offsetX,t.offsetY=this.offsetY,t.border=this.border,t.paddingX=this.paddingX,t.paddingY=this.paddingY,t.showRelationLine=this.showRelationLine,null!=this.lineStyle&&(t.lineStyle={},null!=this.lineStyle.color&&(t.lineStyle.color=this.lineStyle.color),null!=this.lineStyle.lineSymbolID&&(t.lineStyle.lineSymbolID=this.lineStyle.lineSymbolID),null!=this.lineStyle.dashArray&&(t.lineStyle.dashArray=this.lineStyle.dashArray),null!=this.lineStyle.opacity&&(t.lineStyle.opacity=this.lineStyle.opacity),null!=this.lineStyle.weight&&(t.lineStyle.weight=this.lineStyle.weight)),SuperMap.Plot.AnalysisSymbol.setStyle(this.style,t,!0),t}},{key:"parseSymbolData",value:function(t){return this.textContent=t.textContent,this.textPosition=t.textPosition,this.offsetX=t.offsetX,this.offsetY=t.offsetY,null!=t.border&&(this.border=t.border),null!=t.paddingX&&(this.paddingX=t.paddingX),null!=t.paddingY&&(this.paddingY=t.paddingY),null!=t.showRelationLine&&(this.showRelationLine=t.showRelationLine),null!=t.lineStyle&&(null==this.lineStyle&&(this.lineStyle=null),null!=t.lineStyle.color&&(this.lineStyle.color=t.lineStyle.color),null!=t.lineStyle.lineSymbolID&&(this.lineStyle.lineSymbolID=t.lineStyle.lineSymbolID),null!=t.lineStyle.dashArray&&(this.lineStyle.dashArray=t.lineStyle.dashArray),null!=t.lineStyle.opacity&&(this.lineStyle.opacity=t.lineStyle.opacity),null!=t.lineStyle.weight&&(this.lineStyle.weight=t.lineStyle.weight)),SuperMap.Plot.AnalysisSymbol.getStyle(t,!0),this}}]),t}();SuperMap.Plot.SymbolText=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.SubSymbol=function(){function t(e,o,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),i=i||{},this.libID=e,this.code=o,this.symbolData=i.symbolData?i.symbolData:null,this.textContent=i.textContent?i.textContent:null,this.totalNum=i.totalNum?i.totalNum:null,this.CLASS_NAME="SuperMap.Plot.SubSymbol"}return i(t,[{key:"destroy",value:function(){this.libID=null,this.code=null,this.symbolData=null,this.totalNum=null}},{key:"clone",value:function(){var t=new SuperMap.Plot.SubSymbol(this.libID,this.code);return t.symbolData={},t.symbolData=SuperMap.Util.copyAttributes(t.symbolData,this.symbolData),t.textContent=this.textContent,t.totalNum=this.totalNum,t}}]),t}();SuperMap.Plot.SubSymbol=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.SMLInfoStruct=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e&&(this.SMLName=e.SMLName,this.SMLDesc=e.SMLDesc,this.SMLSeclevel=e.SMLSeclevel,this.SMLDepat=e.SMLDepat,this.SMLAuthor=e.SMLAuthor,this.SMLTime=e.SMLTime),this.CLASS_NAME="SuperMap.Plot.SMLInfoStruct"}return i(t,[{key:"destroy",value:function(){this.SMLName="",this.SMLDesc="",this.SMLAuthor="",this.SMLSeclevel="",this.SMLDepat="",this.SMLTime=""}},{key:"fromJSON",value:function(t){this.SMLName=t.SMLName,this.SMLDesc=t.SMLDesc,this.SMLSeclevel=t.SMLSeclevel,this.SMLDepat=t.SMLDepat,this.SMLAuthor=t.SMLAuthor,this.SMLTime=t.SMLTime}},{key:"toJSON",value:function(){return'{"SMLName":'+SuperMap.Plot.PlottingUtil.toJSON(this.SMLName)+',"SMLDesc":'+SuperMap.Plot.PlottingUtil.toJSON(this.SMLDesc)+',"SMLSeclevel":'+SuperMap.Plot.PlottingUtil.toJSON(this.SMLSeclevel)+',"SMLDepat":'+SuperMap.Plot.PlottingUtil.toJSON(this.SMLDepat)+',"SMLAuthor":'+SuperMap.Plot.PlottingUtil.toJSON(this.SMLAuthor)+',"SMLTime":'+SuperMap.Plot.PlottingUtil.toJSON(this.SMLTime)+"}"}}]),t}();SuperMap.Plot.SMLInfoStruct=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.SitDataStruct=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=e||{},this.smlInfo=e.smlInfo?e.smlInfo:null,this.mapInfo=e.mapInfo?e.mapInfo:null,this.layerDatas=e.layerDatas?e.layerDatas:null,this.CLASS_NAME="SuperMap.Plot.SitDataStruct"}return i(t,[{key:"destroy",value:function(){this.smlInfo=null,this.mapInfo=null,this.layerDatas=null}}]),t}();SuperMap.Plot.SitDataStruct=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.RouteNode=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=e||{},this.id=e.id?e.id:SuperMap.Plot.PlottingUtil.generateUuid(),this.x=e.x?e.x:null,this.y=e.y?e.y:null,this.z=e.z?e.z:null,this.type=e.type?e.type:null,this.name=e.name?e.name:null,this.rotate=e.rotate?e.rotate:0,this.towardNodes=e.towardNodes?e.towardNodes:[],this.style=e.style?e.style:{},0===Object.keys(this.style).length&&(this.style=SuperMap.Util.cloneObject(L.supermap.plotting.PlottingObject.prototype._defaultStyle)),this.CLASS_NAME="SuperMap.Plot.RouteNode"}return i(t,[{key:"destroy",value:function(){this.type=null,this.position=null,this.name=null,this.id=null,this.rotate=null,this.towardNodes&&null!==this.towardNodes||(this.towardNodes=null);for(var t=0;t<this.towardNodes.length;t++)this.towardNodes[t].destroy();this.towardNodes=null}},{key:"clone",value:function(){var e=new t({id:this.id,type:this.type,name:this.name,rotate:this.rotate,towardNodes:this.towardNodes});return e.positionPoint=this.positionPoint.clone(),e.style={},e.style=SuperMap.Util.copyAttributes(e.style,this.style),e}},{key:"parseSymbolData",value:function(t){for(var e in this.id=t.id,this.type=t.type,this.name=t.name,this.rotate=t.rotate,t.positionPoint?(this.x=t.positionPoint.x,this.y=t.positionPoint.y,this.z=t.positionPoint.z):(this.x=t.x,this.y=t.y,this.z=t.z),this.style=SuperMap.Plot.AnalysisSymbol.getStyle(t,!0),t.towardNodes){var o=new SuperMap.Plot.TowardNode;this.towardNodes.push(o.parseSymbolData(t.towardNodes[e]))}return this}},{key:"setSymbolData",value:function(){var t={};for(var e in t.id=this.id,t.type=this.type,t.name=this.name,t.rotate=this.rotate,t.x=this.x,t.y=this.y,t.z=this.z,SuperMap.Plot.AnalysisSymbol.setStyle(this.style,t,!0),t.towardNodes=[],this.towardNodes)t.towardNodes.push(this.towardNodes[e].setSymbolData());return t}}]),t}();SuperMap.Plot.RouteNode=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.Property=function(){function t(e,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e&&(this.key=e),o&&(this.value=o),this.CLASS_NAME="SuperMap.Plot.Property"}return i(t,[{key:"setKey",value:function(t){this.key=t}},{key:"getKey",value:function(){return this.key}},{key:"setValue",value:function(t){this.value=t}},{key:"getValue",value:function(){return this.value}},{key:"destroy",value:function(){this.key=null,this.value=null}},{key:"clone",value:function(){return new SuperMap.Plot.Property(this.key,this.value)}}]),t}();SuperMap.Plot.Property=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.OrbitPoint=function(){function t(e,o,i,l,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.x=parseFloat(e),this.y=parseFloat(o),(i||0==i)&&(this.z=parseFloat(i)),l&&(this.number=l),n&&(this.time=n),this.CLASS_NAME="SuperMap.Plot.OrbitPoint"}return i(t,[{key:"destroy",value:function(){this.x=null,this.y=null,this.z=null,this.index=null,this.time=null}},{key:"clone",value:function(t){return null==t&&(t=new SuperMap.Plot.OrbitPoint(this.x,this.y,this.z)),SuperMap.Util.applyDefaults(t,this),t}}]),t}();SuperMap.Plot.OrbitPoint=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.MapInfoStruct=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=e||{},this.zoom=e.zoom?e.zoom:null,this.centerX=e.centerX?e.centerX:null,this.centerY=e.centerY?e.centerY:null,this.CLASS_NAME="SuperMap.Plot.MapInfoStruct"}return i(t,[{key:"destroy",value:function(){this.zoom=null,this.centerX=null,this.centerY=null}},{key:"fromJSON",value:function(t){void 0!==t.zoom&&(this.zoom=t.zoom),void 0!==t.centerX&&(this.centerX=t.centerX),void 0!==t.centerY&&(this.centerY=t.centerY)}},{key:"toJSON",value:function(){return'{"zoom":'+SuperMap.Plot.PlottingUtil.toJSON(this.zoom)+',"centerX":'+SuperMap.Plot.PlottingUtil.toJSON(this.centerX)+',"centerY":'+SuperMap.Plot.PlottingUtil.toJSON(this.centerY)+"}"}}]),t}();SuperMap.Plot.MapInfoStruct=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.LayerDataStruct=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=e||{},this.layerName=e.layerName?e.layerName:null,this.spatialAnalystUrl=e.spatialAnalystUrl?e.spatialAnalystUrl:null,this.useCanvas2=!!e.useCanvas2&&e.useCanvas2,this.useCanvas=!!e.useCanvas&&e.useCanvas,this.features=e.features?e.features:null,this.CLASS_NAME="SuperMap.Plot.LayerDataStruct"}return i(t,[{key:"destroy",value:function(){this.layerName=null,this.spatialAnalystUrl=null,this.useCanvas2=null,this.useCanvas=null,this.features=null}},{key:"toJSON",value:function(){for(var t=[],e=0;e<this.features.length;e++)t.push(this.features[e].getSymbolData());return'{"layerName":'+SuperMap.Plot.PlottingUtil.toJSON(this.layerName)+', "spatialAnalystUrl":'+SuperMap.Plot.PlottingUtil.toJSON(this.spatialAnalystUrl)+', "useCanvas2":'+SuperMap.Plot.PlottingUtil.toJSON(this.useCanvas2)+', "useCanvas":'+SuperMap.Plot.PlottingUtil.toJSON(this.useCanvas)+', "isEditable":'+SuperMap.Plot.PlottingUtil.toJSON(this.isEditable)+', "isLocked":'+SuperMap.Plot.PlottingUtil.toJSON(this.isLocked)+', "visibility":'+SuperMap.Plot.PlottingUtil.toJSON(this.visibility)+',"features":'+SuperMap.Plot.PlottingUtil.toJSON(t)+"}"}}]),t}();SuperMap.Plot.LayerDataStruct=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.ExtendProperty=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=e||{},this.properties=e.properties?e.properties:[],this.CLASS_NAME="SuperMap.Plot.ExtendProperty"}return i(t,[{key:"addProperty",value:function(t,e){var o=this.findProperty(t);return null==o?this.properties.push(new SuperMap.Plot.Property(t,e)):o.setValue(e),!0}},{key:"deleteProperty",value:function(t){for(var e=0;e<this.properties.length;e++)if(this.properties[e].key===t)return this.properties.slice(e,1),!0;return!1}},{key:"findProperty",value:function(t){for(var e=0;e<this.properties.length;e++)if(this.properties[e].key===t)return this.properties[e];return null}},{key:"getPropertyValue",value:function(t){for(var e=0;e<this.properties.length;e++)if(this.properties[e].key===t)return this.properties[e].value;return null}},{key:"getPropertyByIndex",value:function(t){return t<this.properties.length?this.properties[t]:null}},{key:"getPropertyCount",value:function(){return this.properties.length}},{key:"destroy",value:function(){this.properties=null}}]),t}();SuperMap.Plot.ExtendProperty=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.DefaultStyle=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=e||{},this.lineColor=e.lineColor?e.lineColor:"#ff0000",this.lineWidth=e.lineWidth?e.lineWidth:2,this.lineType=e.lineType?e.lineType:0,this.lineOpacity=e.lineOpacity?e.lineOpacity:1,this.lineCap=e.lineCap?e.lineCap:"round",this.flagTextSize=e.flagTextSize?e.flagTextSize:60,this.maxScale=e.maxScale?e.maxScale:5,this.minScale=e.minScale?e.minScale:1,this.dotSymbolSize=e.dotSymbolSize?e.dotSymbolSize:40,this.dotTextSpace=e.dotTextSpace?e.dotTextSpace:7,this.scaleByMap=!!e.scaleByMap&&e.scaleByMap,this.fillColor=e.fillColor?e.fillColor:"#ff0000",this.fillOpacity=e.fillOpacity?e.fillOpacity:.31,this.fontColor=e.fontColor?e.fontColor:"#000000",this.fontOpacity=e.fontOpacity?e.fontOpacity:1,this.fontStroke=!!e.fontStroke&&e.fontStroke,this.fontStrokeColor=e.fontStrokeColor?e.fontStrokeColor:"#ff0000",this.fontStrokeWidth=e.fontStrokeWidth?e.fontStrokeWidth:"2px",this.fontBackground=!!e.fontBackground&&e.fontBackground,this.fontBackgroundColor=e.fontBackgroundColor?e.fontBackgroundColor:"#ff0000",this.fontShadow=!!e.fontShadow&&e.fontShadow,this.fontShadowColor=e.fontShadowColor?e.fontShadowColor:"#ff0000",this.fontShadowOffsetX=e.fontShadowOffsetX?e.fontShadowOffsetX:0,this.fontShadowOffsetY=e.fontShadowOffsetY?e.fontShadowOffsetY:0,this.fontSize=e.fontSize?e.fontSize:14,this.fontSpace=e.fontSpace?e.fontSpace:0,this.fontPercent=e.fontPercent?e.fontPercent:100,this.fontFamily=e.fontFamily?e.fontFamily:"微软雅黑",this.fontWeight=e.fontWeight?e.fontWeight:"bold",this.fontStyle=e.fontStyle?e.fontStyle:"",this.surroundLineType=e.surroundLineType?e.surroundLineType:0,this.surroundLineColor=e.surroundLineColor?e.surroundLineColor:"#ffff00",this.surroundLineWidth=e.surroundLineWidth?e.surroundLineWidth:4,this.surroundLineColorOpacity=e.surroundLineColorOpacity?e.surroundLineColorOpacity:1,this.fontStyle=e.fontStyle?e.fontStyle:"",this.fillBackColor=e.fillBackColor?e.fillBackColor:"#ff0000",this.fillBackOpacity=e.fillBackOpacity?e.fillBackOpacity:1,this.fillGradientMode=e.fillGradientMode?e.fillGradientMode:"NONE",this.fillCenterOffsetX=e.fillCenterOffsetX?e.fillCenterOffsetX:0,this.fillCenterOffsetY=e.fillCenterOffsetY?e.fillCenterOffsetY:0,this.fillAngle=e.fillAngle?e.fillAngle:0,this.fillSymbolID=e.fillSymbolID?e.fillSymbolID:1,this.defaultFlag=!!e.defaultFlag&&e.defaultFlag,this.CLASS_NAME="SuperMap.Plot.DefaultStyle",this.parserConfiguration()}return i(t,[{key:"parserConfiguration",value:function(){"undefined"!=typeof DefaultStyleConfiguration&&("undefined"==typeof DefaultStyleConfiguration&&void 0!==DefaultStyleConfiguration.flagTextSize&&(this.flagTextSize=parseFloat(DefaultStyleConfiguration.flagTextSize)),"undefined"==typeof DefaultStyleConfiguration&&void 0!==DefaultStyleConfiguration.maxScale&&(this.maxScale=parseFloat(DefaultStyleConfiguration.maxScale)),"undefined"==typeof DefaultStyleConfiguration&&void 0!==DefaultStyleConfiguration.minScale&&(this.minScale=parseFloat(DefaultStyleConfiguration.minScale)),"undefined"==typeof DefaultStyleConfiguration&&void 0!==DefaultStyleConfiguration.dotSymbolSize&&(this.dotSymbolSize=parseFloat(DefaultStyleConfiguration.dotSymbolSize)),"undefined"==typeof DefaultStyleConfiguration&&void 0!==DefaultStyleConfiguration.dotTextSpace&&(this.dotTextSpace=parseFloat(DefaultStyleConfiguration.dotTextSpace)),"undefined"==typeof DefaultStyleConfiguration&&void 0!==DefaultStyleConfiguration.scaleByMap&&(this.scaleByMap=DefaultStyleConfiguration.scaleByMap),"undefined"==typeof DefaultStyleConfiguration&&void 0!==DefaultStyleConfiguration.strokeWidth&&(this.lineWidth=parseFloat(DefaultStyleConfiguration.strokeWidth)),"undefined"==typeof DefaultStyleConfiguration&&void 0!==DefaultStyleConfiguration.strokeColor&&(this.lineColor=DefaultStyleConfiguration.strokeColor),"undefined"==typeof DefaultStyleConfiguration&&void 0!==DefaultStyleConfiguration.strokeOpacity&&(this.lineOpacity=parseFloat(DefaultStyleConfiguration.strokeOpacity)),"undefined"==typeof DefaultStyleConfiguration&&void 0!==DefaultStyleConfiguration.strokeDashstyle&&(this.lineType=DefaultStyleConfiguration.strokeDashstyle),"undefined"==typeof DefaultStyleConfiguration&&void 0!==DefaultStyleConfiguration.strokeLinecap&&(this.lineCap=DefaultStyleConfiguration.strokeLinecap),"undefined"==typeof DefaultStyleConfiguration&&void 0!==DefaultStyleConfiguration.fillColor&&(this.fillColor=DefaultStyleConfiguration.fillColor),"undefined"==typeof DefaultStyleConfiguration&&void 0!==DefaultStyleConfiguration.fillOpacity&&(this.fillOpacity=parseFloat(DefaultStyleConfiguration.fillOpacity)),"undefined"==typeof DefaultStyleConfiguration&&void 0!==DefaultStyleConfiguration.fontColor&&(this.fontColor=DefaultStyleConfiguration.fontColor),"undefined"==typeof DefaultStyleConfiguration&&void 0!==DefaultStyleConfiguration.fontOpacity&&(this.fontOpacity=parseFloat(DefaultStyleConfiguration.fontOpacity)),"undefined"==typeof DefaultStyleConfiguration&&void 0!==DefaultStyleConfiguration.fontStroke&&(this.fontStroke=DefaultStyleConfiguration.fontStroke),"undefined"==typeof DefaultStyleConfiguration&&void 0!==DefaultStyleConfiguration.fontStrokeColor&&(this.fontStrokeColor=DefaultStyleConfiguration.fontStrokeColor),"undefined"==typeof DefaultStyleConfiguration&&void 0!==DefaultStyleConfiguration.fontStrokeWidth&&(this.fontStrokeWidth=parseFloat(DefaultStyleConfiguration.fontStrokeWidth)),"undefined"==typeof DefaultStyleConfiguration&&void 0!==DefaultStyleConfiguration.fontBackground&&(this.fontBackground=DefaultStyleConfiguration.fontBackground),"undefined"==typeof DefaultStyleConfiguration&&void 0!==DefaultStyleConfiguration.fontBackgroundColor&&(this.fontBackgroundColor=DefaultStyleConfiguration.fontBackgroundColor),"undefined"==typeof DefaultStyleConfiguration&&void 0!==DefaultStyleConfiguration.fontShadow&&(this.fontShadow=DefaultStyleConfiguration.fontShadow),"undefined"==typeof DefaultStyleConfiguration&&void 0!==DefaultStyleConfiguration.fontShadowColor&&(this.fontShadowColor=DefaultStyleConfiguration.fontShadowColor),"undefined"==typeof DefaultStyleConfiguration&&void 0!==DefaultStyleConfiguration.fontShadowOffsetX&&(this.fontShadowOffsetX=DefaultStyleConfiguration.fontShadowOffsetX),"undefined"==typeof DefaultStyleConfiguration&&void 0!==DefaultStyleConfiguration.fontShadowOffsetY&&(this.fontShadowOffsetY=DefaultStyleConfiguration.fontShadowOffsetY),"undefined"==typeof DefaultStyleConfiguration&&void 0!==DefaultStyleConfiguration.fontSpace&&(this.fontSpace=parseInt(DefaultStyleConfiguration.fontSpace)),"undefined"==typeof DefaultStyleConfiguration&&void 0!==DefaultStyleConfiguration.fontPercent&&(this.fontPercent=parseFloat(DefaultStyleConfiguration.fontPercent)),"undefined"==typeof DefaultStyleConfiguration&&void 0!==DefaultStyleConfiguration.fontSize&&(this.fontSize=parseFloat(DefaultStyleConfiguration.fontSize)),"undefined"==typeof DefaultStyleConfiguration&&void 0!==DefaultStyleConfiguration.fontFamily&&(this.fontFamily=DefaultStyleConfiguration.fontFamily),"undefined"==typeof DefaultStyleConfiguration&&void 0!==DefaultStyleConfiguration.fontWeight&&(this.fontWeight=DefaultStyleConfiguration.fontWeight),"undefined"==typeof DefaultStyleConfiguration&&void 0!==DefaultStyleConfiguration.fontStyle&&(this.fontStyle=DefaultStyleConfiguration.fontStyle),DefaultStyleConfiguration&&void 0!==DefaultStyleConfiguration.surroundLineType&&(this.surroundLineType=parseFloat(DefaultStyleConfiguration.surroundLineType)),DefaultStyleConfiguration&&void 0!==DefaultStyleConfiguration.surroundLineColor&&(this.surroundLineColor=DefaultStyleConfiguration.surroundLineColor),DefaultStyleConfiguration&&void 0!==DefaultStyleConfiguration.surroundLineWidth&&(this.surroundLineWidth=parseFloat(DefaultStyleConfiguration.surroundLineWidth)),DefaultStyleConfiguration&&void 0!==DefaultStyleConfiguration.surroundLineColorOpacity&&(this.surroundLineColorOpacity=parseFloat(DefaultStyleConfiguration.surroundLineColorOpacity)),DefaultStyleConfiguration&&void 0!==DefaultStyleConfiguration.fillBackColor&&(this.fillBackColor=DefaultStyleConfiguration.fillBackColor),DefaultStyleConfiguration&&void 0!==DefaultStyleConfiguration.fillBackOpacity&&(this.fillBackOpacity=parseFloat(DefaultStyleConfiguration.fillBackOpacity)),DefaultStyleConfiguration&&void 0!==DefaultStyleConfiguration.fillGradientMode&&(this.fillGradientMode=DefaultStyleConfiguration.fillGradientMode),DefaultStyleConfiguration&&void 0!==DefaultStyleConfiguration.fillAngle&&(this.fillAngle=parseFloat(DefaultStyleConfiguration.fillAngle)),DefaultStyleConfiguration&&void 0!==DefaultStyleConfiguration.fillCenterOffsetX&&(this.fillCenterOffsetX=parseFloat(DefaultStyleConfiguration.fillCenterOffsetX)),DefaultStyleConfiguration&&void 0!==DefaultStyleConfiguration.fillCenterOffsetY&&(this.fillCenterOffsetY=parseFloat(DefaultStyleConfiguration.fillCenterOffsetY)),DefaultStyleConfiguration&&void 0!==DefaultStyleConfiguration.fillSymbolID&&(this.fillSymbolID=parseFloat(DefaultStyleConfiguration.fillSymbolID)))}},{key:"destroy",value:function(){this.lineColor=null,this.lineWidth=null,this.dotSymbolSize=null,this.lineType=null,this.defaultFlag=null,this.flagTextSize=null,this.maxScale=null,this.minScale=null,this.dotTextSpace=null,this.scaleByMap=null,this.lineOpacity=null,this.lineCap=null,this.fillColor=null,this.fillOpacity=null,this.fontColor=null,this.fontOpacity=null,this.fontSize=null,this.fontFamily=null,this.fontWeight=null,this.fontStyle=null,this.fontPercent=null,this.fontSpace=null,this.surroundLineType=null,this.surroundLineColor=null,this.surroundLineWidth=null,this.surroundLineColorOpacity=null,this.fillBackColor=null,this.fillBackOpacity=null,this.fillGradientMode=null,this.fillAngle=null,this.fillCenterOffsetX=null,this.fillCenterOffsetY=null,this.fillSymbolID=null}}]),t}();SuperMap.Plot.DefaultStyle=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TransactionInfo=e.Transaction=e.TowardNode=e.TimeWindowParameter=e.Trajectory=e.PictureFrame=e.BloodVolume=e.SymbolText=e.SubSymbol=e.SMLInfoStruct=e.SitDataStruct=e.RouteNode=e.Property=e.OrbitPoint=e.MapInfoStruct=e.LayerDataStruct=e.ExtendProperty=e.DefaultStyle=void 0;var i=o(170),l=o(169),n=o(168),a=o(167),s=o(166),r=o(165),u=o(164),p=o(163),h=o(162),c=o(161),g=o(160),y=o(159),f=o(158),P=o(157),d=o(156),S=o(155),m=o(154),b=o(153);e.DefaultStyle=i.DefaultStyle,e.ExtendProperty=l.ExtendProperty,e.LayerDataStruct=n.LayerDataStruct,e.MapInfoStruct=a.MapInfoStruct,e.OrbitPoint=s.OrbitPoint,e.Property=r.Property,e.RouteNode=u.RouteNode,e.SitDataStruct=p.SitDataStruct,e.SMLInfoStruct=h.SMLInfoStruct,e.SubSymbol=c.SubSymbol,e.SymbolText=g.SymbolText,e.BloodVolume=y.BloodVolume,e.PictureFrame=f.PictureFrame,e.Trajectory=P.Trajectory,e.TimeWindowParameter=d.TimeWindowParameter,e.TowardNode=S.TowardNode,e.Transaction=m.Transaction,e.TransactionInfo=b.TransactionInfo},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.GetSymbolInfoParameters=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=e||{},this.libID=e.libID,this.code=e.code,this.inputPoints=e.inputPoints?e.inputPoints:null,this.symbolRank=e.symbolRank?e.symbolRank:0,this.negativeImage=!!e.negativeImage&&e.negativeImage,this.surroundLineType=e.surroundLineType?e.surroundLineType:0,this.subSymbols=e.subSymbols?e.subSymbols:null,this.scaleValues=e.scaleValues?e.scaleValues:null,this.scalePoints=e.scalePoints?e.scalePoints:null,this.newScalePoint=e.newScalePoint?e.newScalePoint:null,this.newScalePointIndex=e.newScalePointIndex?e.newScalePointIndex:0,this.CLASS_NAME="SuperMap.GetSymbolInfoParameters"}return i(t,[{key:"destroy",value:function(){var t=this;t.libID=null,t.code=null,t.inputPoints=null,t.symbolRank=null,t.negativeImage=null,t.surroundLineType=null,t.subSymbols=null,t.scaleValues=null,t.scalePoints=null,t.newScalePoint=null,t.newScalePointIndex=null}}],[{key:"toUrlParameters",value:function(t){if(t&&null!==t.libID&&null!==t.code){var e="libID="+encodeURIComponent(t.libID)+"&code="+encodeURIComponent(t.code);if(t.inputPoints&&null!==t.inputPoints&&0!==t.inputPoints.length){for(var o="[",i=0;i<t.inputPoints.length;i++)i===t.inputPoints.length-1?o+='{"x":'+t.inputPoints[i].x+', "y":'+t.inputPoints[i].y+"}]":o+='{"x":'+t.inputPoints[i].x+', "y":'+t.inputPoints[i].y+"},";e+="&inputPoints="+encodeURIComponent(o)}if(t.scalePoints&&null!==t.scalePoints&&0!==t.scalePoints.length){for(var l="[",n=0;n<t.scalePoints.length;n++)n===t.scalePoints.length-1?l+='{"x":'+t.scalePoints[n].x+', "y":'+t.scalePoints[n].y+"}]":l+='{"x":'+t.scalePoints[n].x+', "y":'+t.scalePoints[n].y+"},";e+="&scalePoints="+encodeURIComponent(l)}if(t.scaleValues&&null!==t.scaleValues&&0!==t.scaleValues.length){for(var a="[",s=0;s<t.scaleValues.length;s++)s===t.scaleValues.length-1?a+=t.scaleValues[s]+"]":a+=t.scaleValues[s]+",";e+="&scaleValues="+encodeURIComponent(a)}if(t.subSymbols&&null!==t.subSymbols&&0!==t.subSymbols.length){for(var r="[",u=0;u<t.subSymbols.length;u++)u===t.subSymbols.length-1?r+=t.subSymbols[u].code+"]":r+=t.subSymbols[u].code+",";e+="&subSymbols="+encodeURIComponent(r)}return t.newScalePoint&&null!==t.newScalePoint&&(e+="&newScalePoint="+encodeURIComponent('{"x":'+t.newScalePoint.x+', "y":'+t.newScalePoint.y+"}")),t.newScalePointIndex&&null!==t.newScalePointIndex&&(e+="&newScalePointIndex="+encodeURIComponent(t.newScalePointIndex)),t.symbolRank&&null!==t.symbolRank&&(e+="&symbolRank="+encodeURIComponent(t.symbolRank)),t.negativeImage&&null!==t.negativeImage&&(e+="&negativeImage="+encodeURIComponent(t.negativeImage)),t.surroundLineType&&null!==t.surroundLineType&&(e+="&surroundLineType="+encodeURIComponent(t.surroundLineType)),e}}}]),t}();SuperMap.GetSymbolInfoParameters=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.GetSMLInfosParameters=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=e||{},this.start=e.start,this.count=e.count?e.count:null,this.CLASS_NAME="SuperMap.GetSMLInfosParameters"}return i(t,[{key:"destroy",value:function(){this.start=null,this.count=null}}],[{key:"toUrlParameters",value:function(t){if(t){var e="";return null!==t.start&&(e="?start="+encodeURIComponent(t.start)),!t.count||null===t.count&&0===t.count||(e+="&count="+encodeURIComponent(t.count)),e}}}]),t}();SuperMap.GetSMLInfosParameters=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.GetLibInfoParameter=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=e||{},this.libID=e.libID,this.CLASS_NAME="SuperMap.GetLibInfoParameter"}return i(t,[{key:"destroy",value:function(){this.libID=null}}]),t}();SuperMap.GetLibInfoParameter=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.EditSmlFileParameters=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=e||{},this.method=e.method?e.method:"POST",this.sitData=e.sitData?e.sitData:null,this.smlFileName=e.smlFileName?e.smlFileName:"",this.isCover=!!e.isCover&&e.isCover,this.CLASS_NAME="SuperMap.EditSmlFileParameters"}return i(t,[{key:"destroy",value:function(){this.method="POST",this.sitData=null,this.isCover=!1,this.smlFileName=""}}],[{key:"toJsonParameters",value:function(t){if(t)return SuperMap.Plot.PlottingUtil.toJSON(t.sitData)}}]),t}();SuperMap.EditSmlFileParameters=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function t(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,o,i){return o&&t(e.prototype,o),i&&t(e,i),e}}();var l=e.PlotCommonServiceBase=function(t){function e(t,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,o));return i.CLASS_NAME="SuperMap.PlotCommonServiceBase",i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,SuperMap.CommonServiceBase),i(e,[{key:"destroy",value:function(){(function t(e,o,i){null===e&&(e=Function.prototype);var l=Object.getOwnPropertyDescriptor(e,o);if(void 0===l){var n=Object.getPrototypeOf(e);return null===n?void 0:t(n,o,i)}if("value"in l)return l.value;var a=l.get;return void 0!==a?a.call(i):void 0})(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this)}},{key:"_commit",value:function(t){"POST"!==t.method&&"PUT"!==t.method||(t.params&&(t.url=SuperMap.Util.urlAppend(t.url,SuperMap.Util.getParameterString(t.params||{}))),t.params=t.data),SuperMap.FetchRequest.commit(t.method,t.url,t.params,{headers:t.headers,withCredentials:t.withCredentials,crossOrigin:t.crossOrigin,timeout:t.async?0:null,proxy:t.proxy}).then(function(t){return t.text()}).then(function(e){var o=(new SuperMap.Format.JSON).read(e);(o||(o={error:e}),o.error)?(t.scope?SuperMap.Function.bind(t.failure,t.scope):t.failure)(o.error):(o.succeed=void 0==o.succeed||o.succeed,(t.scope?SuperMap.Function.bind(t.success,t.scope):t.success)(o))})}}]),e}();SuperMap.PlotCommonServiceBase=l},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GetSymbolInfoService=e.GetSymbolInfoParameters=e.GetSMLInfosService=e.GetSMLInfosParameters=e.GetLibInfoService=e.GetLibInfoParameter=e.GetLibIDsService=e.EditSmlFileService=e.EditSmlFileParameters=e.PlotCommonServiceBase=void 0;var i=o(176),l=o(175),n=o(49),a=o(48),s=o(174),r=o(47),u=o(173),p=o(46),h=o(172),c=o(45);e.PlotCommonServiceBase=i.PlotCommonServiceBase,e.EditSmlFileParameters=l.EditSmlFileParameters,e.EditSmlFileService=n.EditSmlFileService,e.GetLibIDsService=a.GetLibIDsService,e.GetLibInfoParameter=s.GetLibInfoParameter,e.GetLibInfoService=r.GetLibInfoService,e.GetSMLInfosParameters=u.GetSMLInfosParameters,e.GetSMLInfosService=p.GetSMLInfosService,e.GetSymbolInfoParameters=h.GetSymbolInfoParameters,e.GetSymbolInfoService=c.GetSymbolInfoService},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=SuperMap.Plot.GOAnimationType={ANIMATION_UNKNOWN:-1,ANIMATION_WAY:0,ANIMATION_BLINK:1,ANIMATION_ATTRIBUTE:2,ANIMATION_SHOW:3,ANIMATION_ROTATE:4,ANIMATION_SCALE:5,ANIMATION_GROW:6};e.GOAnimationType=i;var l=SuperMap.Plot.BlinkAnimationBlinkStyle={Blink_Frequency:0,Blink_Number:1};e.BlinkAnimationBlinkStyle=l;var n=SuperMap.Plot.BlinkAnimationReplaceStyle={Replace_NoColor:0,Replace_Color:1};e.BlinkAnimationReplaceStyle=n;var a=SuperMap.Plot.RotateDirection={ClockWise:0,AntiClockWise:1};e.RotateDirection=a;var s=SuperMap.Plot.WayPathType={POLYLINE:0,CURVE:1};e.WayPathType=s;var r=SuperMap.Plot.GOAnimationState={UNKNOWN:0,PLAYING:1,PAUSE:2,STOP:3,RESET:4};e.GOAnimationState=r},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GOAnimationState=e.WayPathType=e.RotateDirection=e.BlinkAnimationReplaceStyle=e.BlinkAnimationBlinkStyle=e.GOAnimationType=void 0;var i=o(178);e.GOAnimationType=i.GOAnimationType,e.BlinkAnimationBlinkStyle=i.BlinkAnimationBlinkStyle,e.BlinkAnimationReplaceStyle=i.BlinkAnimationReplaceStyle,e.RotateDirection=i.RotateDirection,e.WayPathType=i.WayPathType,e.GOAnimationState=i.GOAnimationState},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.Event=SuperMap.Plot.Event=SuperMap.Plot.Event||{};SuperMap.Plot.Event.beforefeatureadded="beforefeatureadded",SuperMap.Plot.Event.featureadded="featureadded",SuperMap.Plot.Event.beforefeaturesselected="beforefeaturesselected",SuperMap.Plot.Event.featuresselected="featuresselected",SuperMap.Plot.Event.beforefeaturesunselected="beforefeaturesunselected",SuperMap.Plot.Event.featuresunselected="featuresunselected",SuperMap.Plot.Event.beforefeaturesmodified="beforefeaturesmodified",SuperMap.Plot.Event.featuresmodified="featuresmodified",SuperMap.Plot.Event.beforefeaturesremoved="beforefeaturesremoved",SuperMap.Plot.Event.featuresremoved="featuresremoved",SuperMap.Plot.Event.beforefeaturesadded="beforefeaturesadded",SuperMap.Plot.Event.featuresadded="featuresadded",SuperMap.Plot.Event.movingtargetsselected="featuresselected",SuperMap.Plot.Event.movingtargetsunselected="featuresunselected",SuperMap.Plot.Event.movingtargetcontextmenu="featurecontextmenu",SuperMap.Plot.Event.initializecompleted="initializecompleted",SuperMap.Plot.Event.cachecompleted="cachecompleted",SuperMap.Plot.Event.reseteditmarkersvalues="reseteditmarkersvalues",SuperMap.Plot.Event.reseteditmarkers="reseteditmarkers"},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Event=void 0;var i=o(180);e.Event=i.Event},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=SuperMap.Plot.ArrowTailType={ARROWTAIL_NONE:0,ARROWTAIL_LINE:1,ARROWTAIL_CURVE:2,ARROWTAIL_COATTAIL:3,ARROWTAIL_COATTAIL_POLYBODY:4};e.ArrowTailType=i;var l=SuperMap.Plot.ArrowHeadType={ARROWHEAD_POLYLINE:0,ARROWHEAD_TRIANGLE:1,ARROWHEAD_COATTAIL:2,ARROWHEAD_TRIANGLE_SOLID:3,ARROWHEAD_WITH_EAR:4,ARROWHEAD_WITHOUT_EAR:5,ARROWHEAD_COATTAIL_HOLLOW:6};e.ArrowHeadType=l;var n=SuperMap.Plot.ArrowBodyType={ARROWBODY_POLYLINE:0,ARROWBODY_POLYBEZIER:1,ARROWBODY_PARALLEL:2,ARROWBODY_TRAPEZOID:3,ARROWBODY_MULTIPOLYBEZIER:4,ARROWBODY_COATTAIL:5};e.ArrowBodyType=n;var a=SuperMap.Plot.SymbolType={DOTSYMBOL:1,ALGOSYMBOL:2,TEXTSYMBOL:34,ELLIPSESYMBOL:31,CIRCLESYMBOL:29,RECTANGLESYMBOL:26,ARBITRARYPOLYGONSYMBOL:32,POLYLINESYMBOL:24,PARALLELOGRAM:28,ARCSYMBOL:44,NEWARCSYMBOL:4401,REGULARPOLYGON:410,CHORDSYMBOL:370,NEWCHORDSYMBOL:3701,PIESYMBOL:380,NEWPIESYMBOL:3801,KIDNEY:390,POLYBEZIERSYMBOL:590,PARALLELLINE:48,BRACESYMBOL:400,ANNOFRAMESYMBOL:320,ANNOFRAMESYMBOLM:321,TRAPEZOIDSYMBOL:350,POLYBEZIERCLOSESYMBOL:360,GROUPOBJECT:1e3,LINERELATION:1001,INTERFERENCEBEAM:1002,POLYGONREGION:1003,ARCREGION:1004,AIRROUTE:1005,NAVYROUTE:1006,MISSILEROUTE:1007,NAVYDEPLOYMENT:1008,AIRDEPLOYMENT:1009,SATELLITE:1010,SATELLITETIMEWINDOWS:1011,SYMBOLTEXT:1012,RUNWAY:1013,CURVEEIGHT:1014,ROUTENODE:1015,ARROWLINE:1016,PATHTEXT:1017,LITERATESIGN:1018,CONCENTRICCIRCLE:1019,FLAGGROUP:1020,SYMBOLTEXT1:1021,COMBINATIONALCIRCLE:1022,FREECURVE:1023,SYMBOLTEXTBOX:1024,NODECHAIN:1025,LINEMARKING:1026,AVOIDREGION:1027,WIRE:1028,LINEARARROW:1029,PICTURE:3e3};e.SymbolType=a;var s=SuperMap.Plot.LineRelationType={SOLID:0,DASH:1,ARROW:2};e.LineRelationType=s;var r=SuperMap.Plot.AlgoSurroundLineType={NONE:0,INNER:1,OUT:2,ALL:3};e.AlgoSurroundLineType=r;var u=SuperMap.Plot.RouteNodeType={RENDEZVOUS:"RENDEZVOUS",EXPANDING:"EXPANDING",VOLLEY:"VOLLEY",STANDBY:"STANDBY",SUPPLY:"SUPPLY",TAKEOFF:"TAKEOFF",INITIAL:"INITIAL",VISUALINITAL:"VISUALINITAL",LANCH:"LANCH",TURNING:"TURNING",AIMING:"AIMING",COMMONROUTE:"COMMONROUTE",WEAPONLAUNCH:"WEAPONLAUNCH",TARGET:"TARGET",ATTACK:"ATTACK",SUPPRESS:"SUPPRESS",EIGHTSPIRAL:"EIGHTSPIRAL",HAPPYVALLEY:"HAPPYVALLEY"};e.RouteNodeType=u;var p=SuperMap.Plot.RelLineText={ONLINE:0,ONLEFTLINE:1,ONRIGHTLINE:2,ONBOTHLINE:3};e.RelLineText=p;var h=SuperMap.Plot.RadiusLineType={NONE:0,SOLID:1,ARROW:2};e.RadiusLineType=h;var c=SuperMap.Plot.Position={TOP:4,BOTTOM:5,LEFT:6,RIGHT:7};e.Position=c;var g=SuperMap.Plot.AnnoPosition={LEFTTOP:0,LEFTBOTTOM:1,RIGHTTOP:2,RIGHTBOTTOM:3,TOP:4,BOTTOM:5,LEFT:6,RIGHT:7,MIDDLE:8,ANCHOR:9};e.AnnoPosition=g;var y=SuperMap.Plot.ArrowLineType={DOUBLELINE:0,TRIANGLESOLID:1,NONE:2};e.ArrowLineType=y;var f=SuperMap.Plot.TextBoxType={WITHTIPBOX:0,RECTBOX:1,LINEBOX:2,NONEBOX:3};e.TextBoxType=f;var P=SuperMap.Plot.PositionOffsetType={LINE:0,GRADIENTLINE:1};e.PositionOffsetType=P;var d=SuperMap.Plot.AlignType={LEFT:0,RIGHT:1,UP:2,DOWN:3,VERTICALCENTER:4,HORIZONTALCENTER:5};e.AlignType=d;var S=SuperMap.Plot.EditMode={ADDCONTROLPOINT:0,EDITCONTROLPOINT:1,EDITCIRCUMRECTANGLE:2,REMOVECONTROLPOINT:3};e.EditMode=S,SuperMap.Plot.EqualLargeType={WIDTH:0,HEIGHT:1,SAME:2},SuperMap.Plot.UniformDistributionType={LEVEL:0,VERTICAL:1};var m=SuperMap.Plot.TransactionType={CREATE:0,EDIT:1,REMOVE:2};e.TransactionType=m},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=e.SuperMap=window.SuperMap=window.SuperMap||{};e.Plot=i.Plot=i.Plot||{},e.SuperMapAlgoPlot=window.SuperMapAlgoPlot=i.Plot||{}},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CalculateSVGGradient=e.CalculateCanvasGradient=e.TransactionInfo=e.Transaction=e.TowardNode=e.TimeWindowParameter=e.PictureFrame=e.BloodVolume=e.SymbolText=e.SubSymbol=e.SMLInfoStruct=e.SitDataStruct=e.RouteNode=e.Property=e.OrbitPoint=e.MapInfoStruct=e.LayerDataStruct=e.ExtendProperty=e.DefaultStyle=e.GetSymbolInfoService=e.GetSymbolInfoParameters=e.GetSMLInfosService=e.GetSMLInfosParameters=e.GetLibInfoService=e.GetLibInfoParameter=e.GetLibIDsService=e.EditSmlFileService=e.EditSmlFileParameters=e.PlotCommonServiceBase=e.GOAnimationType=e.Event=e.EditMode=e.AlignType=e.PositionOffsetType=e.TextBoxType=e.ArrowLineType=e.AnnoPosition=e.RadiusLineType=e.RelLineText=e.RouteNodeType=e.AlgoSurroundLineType=e.LineRelationType=e.SymbolType=e.Plot=void 0;var i=o(183),l=o(182),n=o(181),a=o(179),s=o(177),r=o(171),u=o(152);e.Plot=i.Plot,e.SymbolType=l.SymbolType,e.LineRelationType=l.LineRelationType,e.AlgoSurroundLineType=l.AlgoSurroundLineType,e.RouteNodeType=l.RouteNodeType,e.RelLineText=l.RelLineText,e.RadiusLineType=l.RadiusLineType,e.AnnoPosition=l.AnnoPosition,e.ArrowLineType=l.ArrowLineType,e.TextBoxType=l.TextBoxType,e.PositionOffsetType=l.PositionOffsetType,e.AlignType=l.AlignType,e.EditMode=l.EditMode,e.Event=n.Event,e.GOAnimationType=a.GOAnimationType,e.PlotCommonServiceBase=s.PlotCommonServiceBase,e.EditSmlFileParameters=s.EditSmlFileParameters,e.EditSmlFileService=s.EditSmlFileService,e.GetLibIDsService=s.GetLibIDsService,e.GetLibInfoParameter=s.GetLibInfoParameter,e.GetLibInfoService=s.GetLibInfoService,e.GetSMLInfosParameters=s.GetSMLInfosParameters,e.GetSMLInfosService=s.GetSMLInfosService,e.GetSymbolInfoParameters=s.GetSymbolInfoParameters,e.GetSymbolInfoService=s.GetSymbolInfoService,e.DefaultStyle=r.DefaultStyle,e.ExtendProperty=r.ExtendProperty,e.LayerDataStruct=r.LayerDataStruct,e.MapInfoStruct=r.MapInfoStruct,e.OrbitPoint=r.OrbitPoint,e.Property=r.Property,e.RouteNode=r.RouteNode,e.SitDataStruct=r.SitDataStruct,e.SMLInfoStruct=r.SMLInfoStruct,e.SubSymbol=r.SubSymbol,e.SymbolText=r.SymbolText,e.BloodVolume=r.BloodVolume,e.PictureFrame=r.PictureFrame,e.TimeWindowParameter=r.TimeWindowParameter,e.TowardNode=r.TowardNode,e.Transaction=r.Transaction,e.TransactionInfo=r.TransactionInfo,e.CalculateCanvasGradient=u.CalculateCanvasGradient,e.CalculateSVGGradient=u.CalculateSVGGradient},function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.resizeLatLngs=e.rotateLatLngs=e.moveLatLngs=e.cloneLatLngs=e.superMapPointsToLatLngs=e.latLngsToSuperMapPoints=e.symbolLibService=e.SymbolLibService=e.symbolInfoService=e.SymbolInfoService=e.smlFileService=e.SMLFileService=e.symbolLibManager=e.SymbolLibManager=e.symbolLib=e.SymbolLib=e.sitDataManager=e.SitDataManager=e.query=e.Query=void 0,e.goAnimationManager=e.GOAnimationManager=e.Plotting=e.geoSymbolText1=e.GeoSymbolText1=e.geoSymbolText=e.GeoSymbolText=e.satelliteTimeWindows=e.SatelliteTimeWindows=e.satellite=e.Satellite=e.lineRelation=e.LineRelation=e.interferenceBeam=e.InterferenceBeam=e.navyRoute=e.NavyRoute=e.missileRoute=e.MissileRoute=e.airRoute=e.AirRoute=e.avoidRegion=e.AvoidRegion=e.airDeployment=e.AirDeployment=e.navyDeployment=e.NavyDeployment=e.flagGroup=e.FlagGroup=e.groupObject=e.GroupObject=e.arcRegion=e.ArcRegion=e.dotSymbol=e.DotSymbol=e.algoSymbol=e.AlgoSymbol=e.GraphicObject=e.PlottingObject=e.editControl=e.PlotEditControl=e.drawControl=e.PlotDrawControl=e.DrawGraphicObject=e.AvoidRegionControl=e.PlotControl=e.GOAnimationWay=e.GOAnimationShow=e.GOAnimationScale=e.GOAnimationRotate=e.GOAnimationGrow=e.GOAnimationBlink=e.GOAnimationAttribute=e.GOAnimation=e.plottingGraphicLayer=e.PlottingGraphicLayer=e.plottingLayer=e.PlottingLayer=e.md5=e.AlgoSymbolFactory=e.BasicAlgoSymbolFactory=e.AddPoint_WayType=e.Primitives=e.PlottingUtil=e.RouteNodePrimitives=e.AnalysisSymbol=e.CalculateSVGGradient=e.CalculateCanvasGradient=e.Event=e.TowardNode=e.TimeWindowParameter=e.SymbolText=e.SubSymbol=e.SMLInfoStruct=e.SitDataStruct=e.RouteNode=e.Property=e.OrbitPoint=e.MapInfoStruct=e.LayerDataStruct=e.ExtendProperty=e.DefaultStyle=e.GetSymbolInfoParameters=e.GetSMLInfosParameters=e.GetLibInfoParameter=e.EditSmlFileParameters=e.GOAnimationType=e.EditMode=e.AlignType=e.PositionOffsetType=e.TextBoxType=e.ArrowLineType=e.AnnoPosition=e.RadiusLineType=e.RelLineText=e.RouteNodeType=e.AlgoSurroundLineType=e.LineRelationType=e.SymbolType=e.Plot=void 0;var i=o(184),l=o(149),n=o(142),a=o(83),s=o(43),r=o(61),u=o(60),p=o(19),h=o(57),c=o(53),g=o(41);e.Plot=i.Plot,e.SymbolType=i.SymbolType,e.LineRelationType=i.LineRelationType,e.AlgoSurroundLineType=i.AlgoSurroundLineType,e.RouteNodeType=i.RouteNodeType,e.RelLineText=i.RelLineText,e.RadiusLineType=i.RadiusLineType,e.AnnoPosition=i.AnnoPosition,e.ArrowLineType=i.ArrowLineType,e.TextBoxType=i.TextBoxType,e.PositionOffsetType=i.PositionOffsetType,e.AlignType=i.AlignType,e.EditMode=i.EditMode,e.GOAnimationType=i.GOAnimationType,e.EditSmlFileParameters=i.EditSmlFileParameters,e.GetLibInfoParameter=i.GetLibInfoParameter,e.GetSMLInfosParameters=i.GetSMLInfosParameters,e.GetSymbolInfoParameters=i.GetSymbolInfoParameters,e.DefaultStyle=i.DefaultStyle,e.ExtendProperty=i.ExtendProperty,e.LayerDataStruct=i.LayerDataStruct,e.MapInfoStruct=i.MapInfoStruct,e.OrbitPoint=i.OrbitPoint,e.Property=i.Property,e.RouteNode=i.RouteNode,e.SitDataStruct=i.SitDataStruct,e.SMLInfoStruct=i.SMLInfoStruct,e.SubSymbol=i.SubSymbol,e.SymbolText=i.SymbolText,e.TimeWindowParameter=i.TimeWindowParameter,e.TowardNode=i.TowardNode,e.Event=i.Event,e.CalculateCanvasGradient=i.CalculateCanvasGradient,e.CalculateSVGGradient=i.CalculateSVGGradient,e.AnalysisSymbol=l.AnalysisSymbol,e.RouteNodePrimitives=l.RouteNodePrimitives,e.PlottingUtil=l.PlottingUtil,e.Primitives=l.Primitives,e.AddPoint_WayType=l.AddPoint_WayType,e.BasicAlgoSymbolFactory=n.BasicAlgoSymbolFactory,e.AlgoSymbolFactory=n.AlgoSymbolFactory,e.md5=a.md5,e.PlottingLayer=s.PlottingLayer,e.plottingLayer=s.plottingLayer,e.PlottingGraphicLayer=s.PlottingGraphicLayer,e.plottingGraphicLayer=s.plottingGraphicLayer,e.GOAnimation=r.GOAnimation,e.GOAnimationAttribute=r.GOAnimationAttribute,e.GOAnimationBlink=r.GOAnimationBlink,e.GOAnimationGrow=r.GOAnimationGrow,e.GOAnimationRotate=r.GOAnimationRotate,e.GOAnimationScale=r.GOAnimationScale,e.GOAnimationShow=r.GOAnimationShow,e.GOAnimationWay=r.GOAnimationWay,e.PlotControl=u.PlotControl,e.AvoidRegionControl=u.AvoidRegionControl,e.DrawGraphicObject=u.DrawGraphicObject,e.PlotDrawControl=u.PlotDrawControl,e.drawControl=u.drawControl,e.PlotEditControl=u.PlotEditControl,e.editControl=u.editControl,e.PlottingObject=p.PlottingObject,e.GraphicObject=p.GraphicObject,e.AlgoSymbol=p.AlgoSymbol,e.algoSymbol=p.algoSymbol,e.DotSymbol=p.DotSymbol,e.dotSymbol=p.dotSymbol,e.ArcRegion=p.ArcRegion,e.arcRegion=p.arcRegion,e.GroupObject=p.GroupObject,e.groupObject=p.groupObject,e.FlagGroup=p.FlagGroup,e.flagGroup=p.flagGroup,e.NavyDeployment=p.NavyDeployment,e.navyDeployment=p.navyDeployment,e.AirDeployment=p.AirDeployment,e.airDeployment=p.airDeployment,e.AvoidRegion=p.AvoidRegion,e.avoidRegion=p.avoidRegion,e.AirRoute=p.AirRoute,e.airRoute=p.airRoute,e.MissileRoute=p.MissileRoute,e.missileRoute=p.missileRoute,e.NavyRoute=p.NavyRoute,e.navyRoute=p.navyRoute,e.InterferenceBeam=p.InterferenceBeam,e.interferenceBeam=p.interferenceBeam,e.LineRelation=p.LineRelation,e.lineRelation=p.lineRelation,e.Satellite=p.Satellite,e.satellite=p.satellite,e.SatelliteTimeWindows=p.SatelliteTimeWindows,e.satelliteTimeWindows=p.satelliteTimeWindows,e.GeoSymbolText=p.GeoSymbolText,e.geoSymbolText=p.geoSymbolText,e.GeoSymbolText1=p.GeoSymbolText1,e.geoSymbolText1=p.geoSymbolText1,e.Plotting=h.Plotting,e.GOAnimationManager=h.GOAnimationManager,e.goAnimationManager=h.goAnimationManager,e.Query=h.Query,e.query=h.query,e.SitDataManager=h.SitDataManager,e.sitDataManager=h.sitDataManager,e.SymbolLib=h.SymbolLib,e.symbolLib=h.symbolLib,e.SymbolLibManager=h.SymbolLibManager,e.symbolLibManager=h.symbolLibManager,e.SMLFileService=c.SMLFileService,e.smlFileService=c.smlFileService,e.SymbolInfoService=c.SymbolInfoService,e.symbolInfoService=c.symbolInfoService,e.SymbolLibService=c.SymbolLibService,e.symbolLibService=c.symbolLibService,e.latLngsToSuperMapPoints=g.latLngsToSuperMapPoints,e.superMapPointsToLatLngs=g.superMapPointsToLatLngs,e.cloneLatLngs=g.cloneLatLngs,e.moveLatLngs=g.moveLatLngs,e.rotateLatLngs=g.rotateLatLngs,e.resizeLatLngs=g.resizeLatLngs}]);