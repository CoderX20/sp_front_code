/*!
 * 
 *          iclient-ol.(https://iclient.supermap.io)
 *          CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd
 *          license: Apache-2.0
 *          version: v11.0.1
 *
 */
/******/ (() => { // webpackBootstrap
/******/ 	var __webpack_modules__ = ({

/***/ 693:
/***/ (function(module) {

(function(self) {
  'use strict';

  // if __disableNativeFetch is set to true, the it will always polyfill fetch
  // with Ajax.
  if (!self.__disableNativeFetch && self.fetch) {
    return
  }

  function normalizeName(name) {
    if (typeof name !== 'string') {
      name = String(name)
    }
    if (/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(name)) {
      throw new TypeError('Invalid character in header field name')
    }
    return name.toLowerCase()
  }

  function normalizeValue(value) {
    if (typeof value !== 'string') {
      value = String(value)
    }
    return value
  }

  function Headers(headers) {
    this.map = {}

    if (headers instanceof Headers) {
      headers.forEach(function(value, name) {
        this.append(name, value)
      }, this)

    } else if (headers) {
      Object.getOwnPropertyNames(headers).forEach(function(name) {
        this.append(name, headers[name])
      }, this)
    }
  }

  Headers.prototype.append = function(name, value) {
    name = normalizeName(name)
    value = normalizeValue(value)
    var list = this.map[name]
    if (!list) {
      list = []
      this.map[name] = list
    }
    list.push(value)
  }

  Headers.prototype['delete'] = function(name) {
    delete this.map[normalizeName(name)]
  }

  Headers.prototype.get = function(name) {
    var values = this.map[normalizeName(name)]
    return values ? values[0] : null
  }

  Headers.prototype.getAll = function(name) {
    return this.map[normalizeName(name)] || []
  }

  Headers.prototype.has = function(name) {
    return this.map.hasOwnProperty(normalizeName(name))
  }

  Headers.prototype.set = function(name, value) {
    this.map[normalizeName(name)] = [normalizeValue(value)]
  }

  Headers.prototype.forEach = function(callback, thisArg) {
    Object.getOwnPropertyNames(this.map).forEach(function(name) {
      this.map[name].forEach(function(value) {
        callback.call(thisArg, value, name, this)
      }, this)
    }, this)
  }

  function consumed(body) {
    if (body.bodyUsed) {
      return Promise.reject(new TypeError('Already read'))
    }
    body.bodyUsed = true
  }

  function fileReaderReady(reader) {
    return new Promise(function(resolve, reject) {
      reader.onload = function() {
        resolve(reader.result)
      }
      reader.onerror = function() {
        reject(reader.error)
      }
    })
  }

  function readBlobAsArrayBuffer(blob) {
    var reader = new FileReader()
    reader.readAsArrayBuffer(blob)
    return fileReaderReady(reader)
  }

  function readBlobAsText(blob, options) {
    var reader = new FileReader()
    var contentType = options.headers.map['content-type'] ? options.headers.map['content-type'].toString() : ''
    var regex = /charset\=[0-9a-zA-Z\-\_]*;?/
    var _charset = blob.type.match(regex) || contentType.match(regex)
    var args = [blob]

    if(_charset) {
      args.push(_charset[0].replace(/^charset\=/, '').replace(/;$/, ''))
    }

    reader.readAsText.apply(reader, args)
    return fileReaderReady(reader)
  }

  var support = {
    blob: 'FileReader' in self && 'Blob' in self && (function() {
      try {
        new Blob();
        return true
      } catch(e) {
        return false
      }
    })(),
    formData: 'FormData' in self,
    arrayBuffer: 'ArrayBuffer' in self
  }

  function Body() {
    this.bodyUsed = false


    this._initBody = function(body, options) {
      this._bodyInit = body
      if (typeof body === 'string') {
        this._bodyText = body
      } else if (support.blob && Blob.prototype.isPrototypeOf(body)) {
        this._bodyBlob = body
        this._options = options
      } else if (support.formData && FormData.prototype.isPrototypeOf(body)) {
        this._bodyFormData = body
      } else if (!body) {
        this._bodyText = ''
      } else if (support.arrayBuffer && ArrayBuffer.prototype.isPrototypeOf(body)) {
        // Only support ArrayBuffers for POST method.
        // Receiving ArrayBuffers happens via Blobs, instead.
      } else {
        throw new Error('unsupported BodyInit type')
      }
    }

    if (support.blob) {
      this.blob = function() {
        var rejected = consumed(this)
        if (rejected) {
          return rejected
        }

        if (this._bodyBlob) {
          return Promise.resolve(this._bodyBlob)
        } else if (this._bodyFormData) {
          throw new Error('could not read FormData body as blob')
        } else {
          return Promise.resolve(new Blob([this._bodyText]))
        }
      }

      this.arrayBuffer = function() {
        return this.blob().then(readBlobAsArrayBuffer)
      }

      this.text = function() {
        var rejected = consumed(this)
        if (rejected) {
          return rejected
        }

        if (this._bodyBlob) {
          return readBlobAsText(this._bodyBlob, this._options)
        } else if (this._bodyFormData) {
          throw new Error('could not read FormData body as text')
        } else {
          return Promise.resolve(this._bodyText)
        }
      }
    } else {
      this.text = function() {
        var rejected = consumed(this)
        return rejected ? rejected : Promise.resolve(this._bodyText)
      }
    }

    if (support.formData) {
      this.formData = function() {
        return this.text().then(decode)
      }
    }

    this.json = function() {
      return this.text().then(JSON.parse)
    }

    return this
  }

  // HTTP methods whose capitalization should be normalized
  var methods = ['DELETE', 'GET', 'HEAD', 'OPTIONS', 'POST', 'PUT']

  function normalizeMethod(method) {
    var upcased = method.toUpperCase()
    return (methods.indexOf(upcased) > -1) ? upcased : method
  }

  function Request(input, options) {
    options = options || {}
    var body = options.body
    if (Request.prototype.isPrototypeOf(input)) {
      if (input.bodyUsed) {
        throw new TypeError('Already read')
      }
      this.url = input.url
      this.credentials = input.credentials
      if (!options.headers) {
        this.headers = new Headers(input.headers)
      }
      this.method = input.method
      this.mode = input.mode
      if (!body) {
        body = input._bodyInit
        input.bodyUsed = true
      }
    } else {
      this.url = input
    }

    this.credentials = options.credentials || this.credentials || 'omit'
    if (options.headers || !this.headers) {
      this.headers = new Headers(options.headers)
    }
    this.method = normalizeMethod(options.method || this.method || 'GET')
    this.mode = options.mode || this.mode || null
    this.referrer = null

    if ((this.method === 'GET' || this.method === 'HEAD') && body) {
      throw new TypeError('Body not allowed for GET or HEAD requests')
    }
    this._initBody(body, options)
  }

  Request.prototype.clone = function() {
    return new Request(this)
  }

  function decode(body) {
    var form = new FormData()
    body.trim().split('&').forEach(function(bytes) {
      if (bytes) {
        var split = bytes.split('=')
        var name = split.shift().replace(/\+/g, ' ')
        var value = split.join('=').replace(/\+/g, ' ')
        form.append(decodeURIComponent(name), decodeURIComponent(value))
      }
    })
    return form
  }

  function headers(xhr) {
    var head = new Headers()
    var pairs = xhr.getAllResponseHeaders().trim().split('\n')
    pairs.forEach(function(header) {
      var split = header.trim().split(':')
      var key = split.shift().trim()
      var value = split.join(':').trim()
      head.append(key, value)
    })
    return head
  }

  Body.call(Request.prototype)

  function Response(bodyInit, options) {
    if (!options) {
      options = {}
    }

    this._initBody(bodyInit, options)
    this.type = 'default'
    this.status = options.status
    this.ok = this.status >= 200 && this.status < 300
    this.statusText = options.statusText
    this.headers = options.headers instanceof Headers ? options.headers : new Headers(options.headers)
    this.url = options.url || ''
  }

  Body.call(Response.prototype)

  Response.prototype.clone = function() {
    return new Response(this._bodyInit, {
      status: this.status,
      statusText: this.statusText,
      headers: new Headers(this.headers),
      url: this.url
    })
  }

  Response.error = function() {
    var response = new Response(null, {status: 0, statusText: ''})
    response.type = 'error'
    return response
  }

  var redirectStatuses = [301, 302, 303, 307, 308]

  Response.redirect = function(url, status) {
    if (redirectStatuses.indexOf(status) === -1) {
      throw new RangeError('Invalid status code')
    }

    return new Response(null, {status: status, headers: {location: url}})
  }

  self.Headers = Headers;
  self.Request = Request;
  self.Response = Response;

  self.fetch = function(input, init) {
    return new Promise(function(resolve, reject) {
      var request
      if (Request.prototype.isPrototypeOf(input) && !init) {
        request = input
      } else {
        request = new Request(input, init)
      }

      var xhr = new XMLHttpRequest()

      function responseURL() {
        if ('responseURL' in xhr) {
          return xhr.responseURL
        }

        // Avoid security warnings on getResponseHeader when not allowed by CORS
        if (/^X-Request-URL:/m.test(xhr.getAllResponseHeaders())) {
          return xhr.getResponseHeader('X-Request-URL')
        }

        return;
      }

      var __onLoadHandled = false;

      function onload() {
        if (xhr.readyState !== 4) {
          return
        }
        var status = (xhr.status === 1223) ? 204 : xhr.status
        if (status < 100 || status > 599) {
          if (__onLoadHandled) { return; } else { __onLoadHandled = true; }
          reject(new TypeError('Network request failed'))
          return
        }
        var options = {
          status: status,
          statusText: xhr.statusText,
          headers: headers(xhr),
          url: responseURL()
        }
        var body = 'response' in xhr ? xhr.response : xhr.responseText;

        if (__onLoadHandled) { return; } else { __onLoadHandled = true; }
        resolve(new Response(body, options))
      }
      xhr.onreadystatechange = onload;
      xhr.onload = onload;
      xhr.onerror = function() {
        if (__onLoadHandled) { return; } else { __onLoadHandled = true; }
        reject(new TypeError('Network request failed'))
      }

      xhr.open(request.method, request.url, true)

      // `withCredentials` should be setted after calling `.open` in IE10
      // http://stackoverflow.com/a/19667959/1219343
      try {
        if (request.credentials === 'include') {
          if ('withCredentials' in xhr) {
            xhr.withCredentials = true;
          } else {
            console && console.warn && console.warn('withCredentials is not supported, you can ignore this warning');
          }
        }
      } catch (e) {
        console && console.warn && console.warn('set withCredentials error:' + e);
      }

      if ('responseType' in xhr && support.blob) {
        xhr.responseType = 'blob'
      }

      request.headers.forEach(function(value, name) {
        xhr.setRequestHeader(name, value)
      })

      xhr.send(typeof request._bodyInit === 'undefined' ? null : request._bodyInit)
    })
  }
  self.fetch.polyfill = true

  // Support CommonJS
  if ( true && module.exports) {
    module.exports = self.fetch;
  }
})(typeof self !== 'undefined' ? self : this);


/***/ }),

/***/ 144:
/***/ (function(module, exports) {

var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;(function (global, factory) {
  if (true) {
    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [exports, module], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),
		__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?
		(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),
		__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
  } else { var mod; }
})(this, function (exports, module) {
  'use strict';

  var defaultOptions = {
    timeout: 5000,
    jsonpCallback: 'callback',
    jsonpCallbackFunction: null
  };

  function generateCallbackFunction() {
    return 'jsonp_' + Date.now() + '_' + Math.ceil(Math.random() * 100000);
  }

  function clearFunction(functionName) {
    // IE8 throws an exception when you try to delete a property on window
    // http://stackoverflow.com/a/1824228/751089
    try {
      delete window[functionName];
    } catch (e) {
      window[functionName] = undefined;
    }
  }

  function removeScript(scriptId) {
    var script = document.getElementById(scriptId);
    if (script) {
      document.getElementsByTagName('head')[0].removeChild(script);
    }
  }

  function fetchJsonp(_url) {
    var options = arguments.length <= 1 || arguments[1] === undefined ? {} : arguments[1];

    // to avoid param reassign
    var url = _url;
    var timeout = options.timeout || defaultOptions.timeout;
    var jsonpCallback = options.jsonpCallback || defaultOptions.jsonpCallback;

    var timeoutId = undefined;

    return new Promise(function (resolve, reject) {
      var callbackFunction = options.jsonpCallbackFunction || generateCallbackFunction();
      var scriptId = jsonpCallback + '_' + callbackFunction;

      window[callbackFunction] = function (response) {
        resolve({
          ok: true,
          // keep consistent with fetch API
          json: function json() {
            return Promise.resolve(response);
          }
        });

        if (timeoutId) clearTimeout(timeoutId);

        removeScript(scriptId);

        clearFunction(callbackFunction);
      };

      // Check if the user set their own params, and if not add a ? to start a list of params
      url += url.indexOf('?') === -1 ? '?' : '&';

      var jsonpScript = document.createElement('script');
      jsonpScript.setAttribute('src', '' + url + jsonpCallback + '=' + callbackFunction);
      if (options.charset) {
        jsonpScript.setAttribute('charset', options.charset);
      }
      jsonpScript.id = scriptId;
      document.getElementsByTagName('head')[0].appendChild(jsonpScript);

      timeoutId = setTimeout(function () {
        reject(new Error('JSONP request to ' + _url + ' timed out'));

        clearFunction(callbackFunction);
        removeScript(scriptId);
        window[callbackFunction] = function () {
          clearFunction(callbackFunction);
        };
      }, timeout);

      // Caught if got 404/500
      jsonpScript.onerror = function () {
        reject(new Error('JSONP request to ' + _url + ' failed'));

        clearFunction(callbackFunction);
        removeScript(scriptId);
        if (timeoutId) clearTimeout(timeoutId);
      };
    });
  }

  // export as global function
  /*
  let local;
  if (typeof global !== 'undefined') {
    local = global;
  } else if (typeof self !== 'undefined') {
    local = self;
  } else {
    try {
      local = Function('return this')();
    } catch (e) {
      throw new Error('polyfill failed because global object is unavailable in this environment');
    }
  }
  local.fetchJsonp = fetchJsonp;
  */

  module.exports = fetchJsonp;
});

/***/ }),

/***/ 794:
/***/ ((module, exports, __webpack_require__) => {

/* module decorator */ module = __webpack_require__.nmd(module);
/**
 * lodash (Custom Build) <https://lodash.com/>
 * Build: `lodash modularize exports="npm" -o ./`
 * Copyright jQuery Foundation and other contributors <https://jquery.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */

/** Used as the size to enable large array optimizations. */
var LARGE_ARRAY_SIZE = 200;

/** Used as the `TypeError` message for "Functions" methods. */
var FUNC_ERROR_TEXT = 'Expected a function';

/** Used to stand-in for `undefined` hash values. */
var HASH_UNDEFINED = '__lodash_hash_undefined__';

/** Used to compose bitmasks for comparison styles. */
var UNORDERED_COMPARE_FLAG = 1,
    PARTIAL_COMPARE_FLAG = 2;

/** Used as references for various `Number` constants. */
var INFINITY = 1 / 0,
    MAX_SAFE_INTEGER = 9007199254740991;

/** `Object#toString` result references. */
var argsTag = '[object Arguments]',
    arrayTag = '[object Array]',
    boolTag = '[object Boolean]',
    dateTag = '[object Date]',
    errorTag = '[object Error]',
    funcTag = '[object Function]',
    genTag = '[object GeneratorFunction]',
    mapTag = '[object Map]',
    numberTag = '[object Number]',
    objectTag = '[object Object]',
    promiseTag = '[object Promise]',
    regexpTag = '[object RegExp]',
    setTag = '[object Set]',
    stringTag = '[object String]',
    symbolTag = '[object Symbol]',
    weakMapTag = '[object WeakMap]';

var arrayBufferTag = '[object ArrayBuffer]',
    dataViewTag = '[object DataView]',
    float32Tag = '[object Float32Array]',
    float64Tag = '[object Float64Array]',
    int8Tag = '[object Int8Array]',
    int16Tag = '[object Int16Array]',
    int32Tag = '[object Int32Array]',
    uint8Tag = '[object Uint8Array]',
    uint8ClampedTag = '[object Uint8ClampedArray]',
    uint16Tag = '[object Uint16Array]',
    uint32Tag = '[object Uint32Array]';

/** Used to match property names within property paths. */
var reIsDeepProp = /\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,
    reIsPlainProp = /^\w*$/,
    reLeadingDot = /^\./,
    rePropName = /[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g;

/**
 * Used to match `RegExp`
 * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).
 */
var reRegExpChar = /[\\^$.*+?()[\]{}|]/g;

/** Used to match backslashes in property paths. */
var reEscapeChar = /\\(\\)?/g;

/** Used to detect host constructors (Safari). */
var reIsHostCtor = /^\[object .+?Constructor\]$/;

/** Used to detect unsigned integer values. */
var reIsUint = /^(?:0|[1-9]\d*)$/;

/** Used to identify `toStringTag` values of typed arrays. */
var typedArrayTags = {};
typedArrayTags[float32Tag] = typedArrayTags[float64Tag] =
typedArrayTags[int8Tag] = typedArrayTags[int16Tag] =
typedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =
typedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =
typedArrayTags[uint32Tag] = true;
typedArrayTags[argsTag] = typedArrayTags[arrayTag] =
typedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =
typedArrayTags[dataViewTag] = typedArrayTags[dateTag] =
typedArrayTags[errorTag] = typedArrayTags[funcTag] =
typedArrayTags[mapTag] = typedArrayTags[numberTag] =
typedArrayTags[objectTag] = typedArrayTags[regexpTag] =
typedArrayTags[setTag] = typedArrayTags[stringTag] =
typedArrayTags[weakMapTag] = false;

/** Detect free variable `global` from Node.js. */
var freeGlobal = typeof __webpack_require__.g == 'object' && __webpack_require__.g && __webpack_require__.g.Object === Object && __webpack_require__.g;

/** Detect free variable `self`. */
var freeSelf = typeof self == 'object' && self && self.Object === Object && self;

/** Used as a reference to the global object. */
var root = freeGlobal || freeSelf || Function('return this')();

/** Detect free variable `exports`. */
var freeExports =  true && exports && !exports.nodeType && exports;

/** Detect free variable `module`. */
var freeModule = freeExports && "object" == 'object' && module && !module.nodeType && module;

/** Detect the popular CommonJS extension `module.exports`. */
var moduleExports = freeModule && freeModule.exports === freeExports;

/** Detect free variable `process` from Node.js. */
var freeProcess = moduleExports && freeGlobal.process;

/** Used to access faster Node.js helpers. */
var nodeUtil = (function() {
  try {
    return freeProcess && freeProcess.binding('util');
  } catch (e) {}
}());

/* Node.js helper references. */
var nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;

/**
 * A specialized version of `_.some` for arrays without support for iteratee
 * shorthands.
 *
 * @private
 * @param {Array} [array] The array to iterate over.
 * @param {Function} predicate The function invoked per iteration.
 * @returns {boolean} Returns `true` if any element passes the predicate check,
 *  else `false`.
 */
function arraySome(array, predicate) {
  var index = -1,
      length = array ? array.length : 0;

  while (++index < length) {
    if (predicate(array[index], index, array)) {
      return true;
    }
  }
  return false;
}

/**
 * The base implementation of `_.property` without support for deep paths.
 *
 * @private
 * @param {string} key The key of the property to get.
 * @returns {Function} Returns the new accessor function.
 */
function baseProperty(key) {
  return function(object) {
    return object == null ? undefined : object[key];
  };
}

/**
 * The base implementation of `_.times` without support for iteratee shorthands
 * or max array length checks.
 *
 * @private
 * @param {number} n The number of times to invoke `iteratee`.
 * @param {Function} iteratee The function invoked per iteration.
 * @returns {Array} Returns the array of results.
 */
function baseTimes(n, iteratee) {
  var index = -1,
      result = Array(n);

  while (++index < n) {
    result[index] = iteratee(index);
  }
  return result;
}

/**
 * The base implementation of `_.unary` without support for storing metadata.
 *
 * @private
 * @param {Function} func The function to cap arguments for.
 * @returns {Function} Returns the new capped function.
 */
function baseUnary(func) {
  return function(value) {
    return func(value);
  };
}

/**
 * Gets the value at `key` of `object`.
 *
 * @private
 * @param {Object} [object] The object to query.
 * @param {string} key The key of the property to get.
 * @returns {*} Returns the property value.
 */
function getValue(object, key) {
  return object == null ? undefined : object[key];
}

/**
 * Checks if `value` is a host object in IE < 9.
 *
 * @private
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a host object, else `false`.
 */
function isHostObject(value) {
  // Many host objects are `Object` objects that can coerce to strings
  // despite having improperly defined `toString` methods.
  var result = false;
  if (value != null && typeof value.toString != 'function') {
    try {
      result = !!(value + '');
    } catch (e) {}
  }
  return result;
}

/**
 * Converts `map` to its key-value pairs.
 *
 * @private
 * @param {Object} map The map to convert.
 * @returns {Array} Returns the key-value pairs.
 */
function mapToArray(map) {
  var index = -1,
      result = Array(map.size);

  map.forEach(function(value, key) {
    result[++index] = [key, value];
  });
  return result;
}

/**
 * Creates a unary function that invokes `func` with its argument transformed.
 *
 * @private
 * @param {Function} func The function to wrap.
 * @param {Function} transform The argument transform.
 * @returns {Function} Returns the new function.
 */
function overArg(func, transform) {
  return function(arg) {
    return func(transform(arg));
  };
}

/**
 * Converts `set` to an array of its values.
 *
 * @private
 * @param {Object} set The set to convert.
 * @returns {Array} Returns the values.
 */
function setToArray(set) {
  var index = -1,
      result = Array(set.size);

  set.forEach(function(value) {
    result[++index] = value;
  });
  return result;
}

/** Used for built-in method references. */
var arrayProto = Array.prototype,
    funcProto = Function.prototype,
    objectProto = Object.prototype;

/** Used to detect overreaching core-js shims. */
var coreJsData = root['__core-js_shared__'];

/** Used to detect methods masquerading as native. */
var maskSrcKey = (function() {
  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');
  return uid ? ('Symbol(src)_1.' + uid) : '';
}());

/** Used to resolve the decompiled source of functions. */
var funcToString = funcProto.toString;

/** Used to check objects for own properties. */
var hasOwnProperty = objectProto.hasOwnProperty;

/**
 * Used to resolve the
 * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)
 * of values.
 */
var objectToString = objectProto.toString;

/** Used to detect if a method is native. */
var reIsNative = RegExp('^' +
  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\$&')
  .replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g, '$1.*?') + '$'
);

/** Built-in value references. */
var Symbol = root.Symbol,
    Uint8Array = root.Uint8Array,
    propertyIsEnumerable = objectProto.propertyIsEnumerable,
    splice = arrayProto.splice;

/* Built-in method references for those with the same name as other `lodash` methods. */
var nativeKeys = overArg(Object.keys, Object);

/* Built-in method references that are verified to be native. */
var DataView = getNative(root, 'DataView'),
    Map = getNative(root, 'Map'),
    Promise = getNative(root, 'Promise'),
    Set = getNative(root, 'Set'),
    WeakMap = getNative(root, 'WeakMap'),
    nativeCreate = getNative(Object, 'create');

/** Used to detect maps, sets, and weakmaps. */
var dataViewCtorString = toSource(DataView),
    mapCtorString = toSource(Map),
    promiseCtorString = toSource(Promise),
    setCtorString = toSource(Set),
    weakMapCtorString = toSource(WeakMap);

/** Used to convert symbols to primitives and strings. */
var symbolProto = Symbol ? Symbol.prototype : undefined,
    symbolValueOf = symbolProto ? symbolProto.valueOf : undefined,
    symbolToString = symbolProto ? symbolProto.toString : undefined;

/**
 * Creates a hash object.
 *
 * @private
 * @constructor
 * @param {Array} [entries] The key-value pairs to cache.
 */
function Hash(entries) {
  var index = -1,
      length = entries ? entries.length : 0;

  this.clear();
  while (++index < length) {
    var entry = entries[index];
    this.set(entry[0], entry[1]);
  }
}

/**
 * Removes all key-value entries from the hash.
 *
 * @private
 * @name clear
 * @memberOf Hash
 */
function hashClear() {
  this.__data__ = nativeCreate ? nativeCreate(null) : {};
}

/**
 * Removes `key` and its value from the hash.
 *
 * @private
 * @name delete
 * @memberOf Hash
 * @param {Object} hash The hash to modify.
 * @param {string} key The key of the value to remove.
 * @returns {boolean} Returns `true` if the entry was removed, else `false`.
 */
function hashDelete(key) {
  return this.has(key) && delete this.__data__[key];
}

/**
 * Gets the hash value for `key`.
 *
 * @private
 * @name get
 * @memberOf Hash
 * @param {string} key The key of the value to get.
 * @returns {*} Returns the entry value.
 */
function hashGet(key) {
  var data = this.__data__;
  if (nativeCreate) {
    var result = data[key];
    return result === HASH_UNDEFINED ? undefined : result;
  }
  return hasOwnProperty.call(data, key) ? data[key] : undefined;
}

/**
 * Checks if a hash value for `key` exists.
 *
 * @private
 * @name has
 * @memberOf Hash
 * @param {string} key The key of the entry to check.
 * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.
 */
function hashHas(key) {
  var data = this.__data__;
  return nativeCreate ? data[key] !== undefined : hasOwnProperty.call(data, key);
}

/**
 * Sets the hash `key` to `value`.
 *
 * @private
 * @name set
 * @memberOf Hash
 * @param {string} key The key of the value to set.
 * @param {*} value The value to set.
 * @returns {Object} Returns the hash instance.
 */
function hashSet(key, value) {
  var data = this.__data__;
  data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;
  return this;
}

// Add methods to `Hash`.
Hash.prototype.clear = hashClear;
Hash.prototype['delete'] = hashDelete;
Hash.prototype.get = hashGet;
Hash.prototype.has = hashHas;
Hash.prototype.set = hashSet;

/**
 * Creates an list cache object.
 *
 * @private
 * @constructor
 * @param {Array} [entries] The key-value pairs to cache.
 */
function ListCache(entries) {
  var index = -1,
      length = entries ? entries.length : 0;

  this.clear();
  while (++index < length) {
    var entry = entries[index];
    this.set(entry[0], entry[1]);
  }
}

/**
 * Removes all key-value entries from the list cache.
 *
 * @private
 * @name clear
 * @memberOf ListCache
 */
function listCacheClear() {
  this.__data__ = [];
}

/**
 * Removes `key` and its value from the list cache.
 *
 * @private
 * @name delete
 * @memberOf ListCache
 * @param {string} key The key of the value to remove.
 * @returns {boolean} Returns `true` if the entry was removed, else `false`.
 */
function listCacheDelete(key) {
  var data = this.__data__,
      index = assocIndexOf(data, key);

  if (index < 0) {
    return false;
  }
  var lastIndex = data.length - 1;
  if (index == lastIndex) {
    data.pop();
  } else {
    splice.call(data, index, 1);
  }
  return true;
}

/**
 * Gets the list cache value for `key`.
 *
 * @private
 * @name get
 * @memberOf ListCache
 * @param {string} key The key of the value to get.
 * @returns {*} Returns the entry value.
 */
function listCacheGet(key) {
  var data = this.__data__,
      index = assocIndexOf(data, key);

  return index < 0 ? undefined : data[index][1];
}

/**
 * Checks if a list cache value for `key` exists.
 *
 * @private
 * @name has
 * @memberOf ListCache
 * @param {string} key The key of the entry to check.
 * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.
 */
function listCacheHas(key) {
  return assocIndexOf(this.__data__, key) > -1;
}

/**
 * Sets the list cache `key` to `value`.
 *
 * @private
 * @name set
 * @memberOf ListCache
 * @param {string} key The key of the value to set.
 * @param {*} value The value to set.
 * @returns {Object} Returns the list cache instance.
 */
function listCacheSet(key, value) {
  var data = this.__data__,
      index = assocIndexOf(data, key);

  if (index < 0) {
    data.push([key, value]);
  } else {
    data[index][1] = value;
  }
  return this;
}

// Add methods to `ListCache`.
ListCache.prototype.clear = listCacheClear;
ListCache.prototype['delete'] = listCacheDelete;
ListCache.prototype.get = listCacheGet;
ListCache.prototype.has = listCacheHas;
ListCache.prototype.set = listCacheSet;

/**
 * Creates a map cache object to store key-value pairs.
 *
 * @private
 * @constructor
 * @param {Array} [entries] The key-value pairs to cache.
 */
function MapCache(entries) {
  var index = -1,
      length = entries ? entries.length : 0;

  this.clear();
  while (++index < length) {
    var entry = entries[index];
    this.set(entry[0], entry[1]);
  }
}

/**
 * Removes all key-value entries from the map.
 *
 * @private
 * @name clear
 * @memberOf MapCache
 */
function mapCacheClear() {
  this.__data__ = {
    'hash': new Hash,
    'map': new (Map || ListCache),
    'string': new Hash
  };
}

/**
 * Removes `key` and its value from the map.
 *
 * @private
 * @name delete
 * @memberOf MapCache
 * @param {string} key The key of the value to remove.
 * @returns {boolean} Returns `true` if the entry was removed, else `false`.
 */
function mapCacheDelete(key) {
  return getMapData(this, key)['delete'](key);
}

/**
 * Gets the map value for `key`.
 *
 * @private
 * @name get
 * @memberOf MapCache
 * @param {string} key The key of the value to get.
 * @returns {*} Returns the entry value.
 */
function mapCacheGet(key) {
  return getMapData(this, key).get(key);
}

/**
 * Checks if a map value for `key` exists.
 *
 * @private
 * @name has
 * @memberOf MapCache
 * @param {string} key The key of the entry to check.
 * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.
 */
function mapCacheHas(key) {
  return getMapData(this, key).has(key);
}

/**
 * Sets the map `key` to `value`.
 *
 * @private
 * @name set
 * @memberOf MapCache
 * @param {string} key The key of the value to set.
 * @param {*} value The value to set.
 * @returns {Object} Returns the map cache instance.
 */
function mapCacheSet(key, value) {
  getMapData(this, key).set(key, value);
  return this;
}

// Add methods to `MapCache`.
MapCache.prototype.clear = mapCacheClear;
MapCache.prototype['delete'] = mapCacheDelete;
MapCache.prototype.get = mapCacheGet;
MapCache.prototype.has = mapCacheHas;
MapCache.prototype.set = mapCacheSet;

/**
 *
 * Creates an array cache object to store unique values.
 *
 * @private
 * @constructor
 * @param {Array} [values] The values to cache.
 */
function SetCache(values) {
  var index = -1,
      length = values ? values.length : 0;

  this.__data__ = new MapCache;
  while (++index < length) {
    this.add(values[index]);
  }
}

/**
 * Adds `value` to the array cache.
 *
 * @private
 * @name add
 * @memberOf SetCache
 * @alias push
 * @param {*} value The value to cache.
 * @returns {Object} Returns the cache instance.
 */
function setCacheAdd(value) {
  this.__data__.set(value, HASH_UNDEFINED);
  return this;
}

/**
 * Checks if `value` is in the array cache.
 *
 * @private
 * @name has
 * @memberOf SetCache
 * @param {*} value The value to search for.
 * @returns {number} Returns `true` if `value` is found, else `false`.
 */
function setCacheHas(value) {
  return this.__data__.has(value);
}

// Add methods to `SetCache`.
SetCache.prototype.add = SetCache.prototype.push = setCacheAdd;
SetCache.prototype.has = setCacheHas;

/**
 * Creates a stack cache object to store key-value pairs.
 *
 * @private
 * @constructor
 * @param {Array} [entries] The key-value pairs to cache.
 */
function Stack(entries) {
  this.__data__ = new ListCache(entries);
}

/**
 * Removes all key-value entries from the stack.
 *
 * @private
 * @name clear
 * @memberOf Stack
 */
function stackClear() {
  this.__data__ = new ListCache;
}

/**
 * Removes `key` and its value from the stack.
 *
 * @private
 * @name delete
 * @memberOf Stack
 * @param {string} key The key of the value to remove.
 * @returns {boolean} Returns `true` if the entry was removed, else `false`.
 */
function stackDelete(key) {
  return this.__data__['delete'](key);
}

/**
 * Gets the stack value for `key`.
 *
 * @private
 * @name get
 * @memberOf Stack
 * @param {string} key The key of the value to get.
 * @returns {*} Returns the entry value.
 */
function stackGet(key) {
  return this.__data__.get(key);
}

/**
 * Checks if a stack value for `key` exists.
 *
 * @private
 * @name has
 * @memberOf Stack
 * @param {string} key The key of the entry to check.
 * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.
 */
function stackHas(key) {
  return this.__data__.has(key);
}

/**
 * Sets the stack `key` to `value`.
 *
 * @private
 * @name set
 * @memberOf Stack
 * @param {string} key The key of the value to set.
 * @param {*} value The value to set.
 * @returns {Object} Returns the stack cache instance.
 */
function stackSet(key, value) {
  var cache = this.__data__;
  if (cache instanceof ListCache) {
    var pairs = cache.__data__;
    if (!Map || (pairs.length < LARGE_ARRAY_SIZE - 1)) {
      pairs.push([key, value]);
      return this;
    }
    cache = this.__data__ = new MapCache(pairs);
  }
  cache.set(key, value);
  return this;
}

// Add methods to `Stack`.
Stack.prototype.clear = stackClear;
Stack.prototype['delete'] = stackDelete;
Stack.prototype.get = stackGet;
Stack.prototype.has = stackHas;
Stack.prototype.set = stackSet;

/**
 * Creates an array of the enumerable property names of the array-like `value`.
 *
 * @private
 * @param {*} value The value to query.
 * @param {boolean} inherited Specify returning inherited property names.
 * @returns {Array} Returns the array of property names.
 */
function arrayLikeKeys(value, inherited) {
  // Safari 8.1 makes `arguments.callee` enumerable in strict mode.
  // Safari 9 makes `arguments.length` enumerable in strict mode.
  var result = (isArray(value) || isArguments(value))
    ? baseTimes(value.length, String)
    : [];

  var length = result.length,
      skipIndexes = !!length;

  for (var key in value) {
    if ((inherited || hasOwnProperty.call(value, key)) &&
        !(skipIndexes && (key == 'length' || isIndex(key, length)))) {
      result.push(key);
    }
  }
  return result;
}

/**
 * Gets the index at which the `key` is found in `array` of key-value pairs.
 *
 * @private
 * @param {Array} array The array to inspect.
 * @param {*} key The key to search for.
 * @returns {number} Returns the index of the matched value, else `-1`.
 */
function assocIndexOf(array, key) {
  var length = array.length;
  while (length--) {
    if (eq(array[length][0], key)) {
      return length;
    }
  }
  return -1;
}

/**
 * The base implementation of `_.get` without support for default values.
 *
 * @private
 * @param {Object} object The object to query.
 * @param {Array|string} path The path of the property to get.
 * @returns {*} Returns the resolved value.
 */
function baseGet(object, path) {
  path = isKey(path, object) ? [path] : castPath(path);

  var index = 0,
      length = path.length;

  while (object != null && index < length) {
    object = object[toKey(path[index++])];
  }
  return (index && index == length) ? object : undefined;
}

/**
 * The base implementation of `getTag`.
 *
 * @private
 * @param {*} value The value to query.
 * @returns {string} Returns the `toStringTag`.
 */
function baseGetTag(value) {
  return objectToString.call(value);
}

/**
 * The base implementation of `_.hasIn` without support for deep paths.
 *
 * @private
 * @param {Object} [object] The object to query.
 * @param {Array|string} key The key to check.
 * @returns {boolean} Returns `true` if `key` exists, else `false`.
 */
function baseHasIn(object, key) {
  return object != null && key in Object(object);
}

/**
 * The base implementation of `_.isEqual` which supports partial comparisons
 * and tracks traversed objects.
 *
 * @private
 * @param {*} value The value to compare.
 * @param {*} other The other value to compare.
 * @param {Function} [customizer] The function to customize comparisons.
 * @param {boolean} [bitmask] The bitmask of comparison flags.
 *  The bitmask may be composed of the following flags:
 *     1 - Unordered comparison
 *     2 - Partial comparison
 * @param {Object} [stack] Tracks traversed `value` and `other` objects.
 * @returns {boolean} Returns `true` if the values are equivalent, else `false`.
 */
function baseIsEqual(value, other, customizer, bitmask, stack) {
  if (value === other) {
    return true;
  }
  if (value == null || other == null || (!isObject(value) && !isObjectLike(other))) {
    return value !== value && other !== other;
  }
  return baseIsEqualDeep(value, other, baseIsEqual, customizer, bitmask, stack);
}

/**
 * A specialized version of `baseIsEqual` for arrays and objects which performs
 * deep comparisons and tracks traversed objects enabling objects with circular
 * references to be compared.
 *
 * @private
 * @param {Object} object The object to compare.
 * @param {Object} other The other object to compare.
 * @param {Function} equalFunc The function to determine equivalents of values.
 * @param {Function} [customizer] The function to customize comparisons.
 * @param {number} [bitmask] The bitmask of comparison flags. See `baseIsEqual`
 *  for more details.
 * @param {Object} [stack] Tracks traversed `object` and `other` objects.
 * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.
 */
function baseIsEqualDeep(object, other, equalFunc, customizer, bitmask, stack) {
  var objIsArr = isArray(object),
      othIsArr = isArray(other),
      objTag = arrayTag,
      othTag = arrayTag;

  if (!objIsArr) {
    objTag = getTag(object);
    objTag = objTag == argsTag ? objectTag : objTag;
  }
  if (!othIsArr) {
    othTag = getTag(other);
    othTag = othTag == argsTag ? objectTag : othTag;
  }
  var objIsObj = objTag == objectTag && !isHostObject(object),
      othIsObj = othTag == objectTag && !isHostObject(other),
      isSameTag = objTag == othTag;

  if (isSameTag && !objIsObj) {
    stack || (stack = new Stack);
    return (objIsArr || isTypedArray(object))
      ? equalArrays(object, other, equalFunc, customizer, bitmask, stack)
      : equalByTag(object, other, objTag, equalFunc, customizer, bitmask, stack);
  }
  if (!(bitmask & PARTIAL_COMPARE_FLAG)) {
    var objIsWrapped = objIsObj && hasOwnProperty.call(object, '__wrapped__'),
        othIsWrapped = othIsObj && hasOwnProperty.call(other, '__wrapped__');

    if (objIsWrapped || othIsWrapped) {
      var objUnwrapped = objIsWrapped ? object.value() : object,
          othUnwrapped = othIsWrapped ? other.value() : other;

      stack || (stack = new Stack);
      return equalFunc(objUnwrapped, othUnwrapped, customizer, bitmask, stack);
    }
  }
  if (!isSameTag) {
    return false;
  }
  stack || (stack = new Stack);
  return equalObjects(object, other, equalFunc, customizer, bitmask, stack);
}

/**
 * The base implementation of `_.isMatch` without support for iteratee shorthands.
 *
 * @private
 * @param {Object} object The object to inspect.
 * @param {Object} source The object of property values to match.
 * @param {Array} matchData The property names, values, and compare flags to match.
 * @param {Function} [customizer] The function to customize comparisons.
 * @returns {boolean} Returns `true` if `object` is a match, else `false`.
 */
function baseIsMatch(object, source, matchData, customizer) {
  var index = matchData.length,
      length = index,
      noCustomizer = !customizer;

  if (object == null) {
    return !length;
  }
  object = Object(object);
  while (index--) {
    var data = matchData[index];
    if ((noCustomizer && data[2])
          ? data[1] !== object[data[0]]
          : !(data[0] in object)
        ) {
      return false;
    }
  }
  while (++index < length) {
    data = matchData[index];
    var key = data[0],
        objValue = object[key],
        srcValue = data[1];

    if (noCustomizer && data[2]) {
      if (objValue === undefined && !(key in object)) {
        return false;
      }
    } else {
      var stack = new Stack;
      if (customizer) {
        var result = customizer(objValue, srcValue, key, object, source, stack);
      }
      if (!(result === undefined
            ? baseIsEqual(srcValue, objValue, customizer, UNORDERED_COMPARE_FLAG | PARTIAL_COMPARE_FLAG, stack)
            : result
          )) {
        return false;
      }
    }
  }
  return true;
}

/**
 * The base implementation of `_.isNative` without bad shim checks.
 *
 * @private
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a native function,
 *  else `false`.
 */
function baseIsNative(value) {
  if (!isObject(value) || isMasked(value)) {
    return false;
  }
  var pattern = (isFunction(value) || isHostObject(value)) ? reIsNative : reIsHostCtor;
  return pattern.test(toSource(value));
}

/**
 * The base implementation of `_.isTypedArray` without Node.js optimizations.
 *
 * @private
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.
 */
function baseIsTypedArray(value) {
  return isObjectLike(value) &&
    isLength(value.length) && !!typedArrayTags[objectToString.call(value)];
}

/**
 * The base implementation of `_.iteratee`.
 *
 * @private
 * @param {*} [value=_.identity] The value to convert to an iteratee.
 * @returns {Function} Returns the iteratee.
 */
function baseIteratee(value) {
  // Don't store the `typeof` result in a variable to avoid a JIT bug in Safari 9.
  // See https://bugs.webkit.org/show_bug.cgi?id=156034 for more details.
  if (typeof value == 'function') {
    return value;
  }
  if (value == null) {
    return identity;
  }
  if (typeof value == 'object') {
    return isArray(value)
      ? baseMatchesProperty(value[0], value[1])
      : baseMatches(value);
  }
  return property(value);
}

/**
 * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.
 *
 * @private
 * @param {Object} object The object to query.
 * @returns {Array} Returns the array of property names.
 */
function baseKeys(object) {
  if (!isPrototype(object)) {
    return nativeKeys(object);
  }
  var result = [];
  for (var key in Object(object)) {
    if (hasOwnProperty.call(object, key) && key != 'constructor') {
      result.push(key);
    }
  }
  return result;
}

/**
 * The base implementation of `_.matches` which doesn't clone `source`.
 *
 * @private
 * @param {Object} source The object of property values to match.
 * @returns {Function} Returns the new spec function.
 */
function baseMatches(source) {
  var matchData = getMatchData(source);
  if (matchData.length == 1 && matchData[0][2]) {
    return matchesStrictComparable(matchData[0][0], matchData[0][1]);
  }
  return function(object) {
    return object === source || baseIsMatch(object, source, matchData);
  };
}

/**
 * The base implementation of `_.matchesProperty` which doesn't clone `srcValue`.
 *
 * @private
 * @param {string} path The path of the property to get.
 * @param {*} srcValue The value to match.
 * @returns {Function} Returns the new spec function.
 */
function baseMatchesProperty(path, srcValue) {
  if (isKey(path) && isStrictComparable(srcValue)) {
    return matchesStrictComparable(toKey(path), srcValue);
  }
  return function(object) {
    var objValue = get(object, path);
    return (objValue === undefined && objValue === srcValue)
      ? hasIn(object, path)
      : baseIsEqual(srcValue, objValue, undefined, UNORDERED_COMPARE_FLAG | PARTIAL_COMPARE_FLAG);
  };
}

/**
 * A specialized version of `baseProperty` which supports deep paths.
 *
 * @private
 * @param {Array|string} path The path of the property to get.
 * @returns {Function} Returns the new accessor function.
 */
function basePropertyDeep(path) {
  return function(object) {
    return baseGet(object, path);
  };
}

/**
 * The base implementation of `_.pullAt` without support for individual
 * indexes or capturing the removed elements.
 *
 * @private
 * @param {Array} array The array to modify.
 * @param {number[]} indexes The indexes of elements to remove.
 * @returns {Array} Returns `array`.
 */
function basePullAt(array, indexes) {
  var length = array ? indexes.length : 0,
      lastIndex = length - 1;

  while (length--) {
    var index = indexes[length];
    if (length == lastIndex || index !== previous) {
      var previous = index;
      if (isIndex(index)) {
        splice.call(array, index, 1);
      }
      else if (!isKey(index, array)) {
        var path = castPath(index),
            object = parent(array, path);

        if (object != null) {
          delete object[toKey(last(path))];
        }
      }
      else {
        delete array[toKey(index)];
      }
    }
  }
  return array;
}

/**
 * The base implementation of `_.slice` without an iteratee call guard.
 *
 * @private
 * @param {Array} array The array to slice.
 * @param {number} [start=0] The start position.
 * @param {number} [end=array.length] The end position.
 * @returns {Array} Returns the slice of `array`.
 */
function baseSlice(array, start, end) {
  var index = -1,
      length = array.length;

  if (start < 0) {
    start = -start > length ? 0 : (length + start);
  }
  end = end > length ? length : end;
  if (end < 0) {
    end += length;
  }
  length = start > end ? 0 : ((end - start) >>> 0);
  start >>>= 0;

  var result = Array(length);
  while (++index < length) {
    result[index] = array[index + start];
  }
  return result;
}

/**
 * The base implementation of `_.toString` which doesn't convert nullish
 * values to empty strings.
 *
 * @private
 * @param {*} value The value to process.
 * @returns {string} Returns the string.
 */
function baseToString(value) {
  // Exit early for strings to avoid a performance hit in some environments.
  if (typeof value == 'string') {
    return value;
  }
  if (isSymbol(value)) {
    return symbolToString ? symbolToString.call(value) : '';
  }
  var result = (value + '');
  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;
}

/**
 * Casts `value` to a path array if it's not one.
 *
 * @private
 * @param {*} value The value to inspect.
 * @returns {Array} Returns the cast property path array.
 */
function castPath(value) {
  return isArray(value) ? value : stringToPath(value);
}

/**
 * A specialized version of `baseIsEqualDeep` for arrays with support for
 * partial deep comparisons.
 *
 * @private
 * @param {Array} array The array to compare.
 * @param {Array} other The other array to compare.
 * @param {Function} equalFunc The function to determine equivalents of values.
 * @param {Function} customizer The function to customize comparisons.
 * @param {number} bitmask The bitmask of comparison flags. See `baseIsEqual`
 *  for more details.
 * @param {Object} stack Tracks traversed `array` and `other` objects.
 * @returns {boolean} Returns `true` if the arrays are equivalent, else `false`.
 */
function equalArrays(array, other, equalFunc, customizer, bitmask, stack) {
  var isPartial = bitmask & PARTIAL_COMPARE_FLAG,
      arrLength = array.length,
      othLength = other.length;

  if (arrLength != othLength && !(isPartial && othLength > arrLength)) {
    return false;
  }
  // Assume cyclic values are equal.
  var stacked = stack.get(array);
  if (stacked && stack.get(other)) {
    return stacked == other;
  }
  var index = -1,
      result = true,
      seen = (bitmask & UNORDERED_COMPARE_FLAG) ? new SetCache : undefined;

  stack.set(array, other);
  stack.set(other, array);

  // Ignore non-index properties.
  while (++index < arrLength) {
    var arrValue = array[index],
        othValue = other[index];

    if (customizer) {
      var compared = isPartial
        ? customizer(othValue, arrValue, index, other, array, stack)
        : customizer(arrValue, othValue, index, array, other, stack);
    }
    if (compared !== undefined) {
      if (compared) {
        continue;
      }
      result = false;
      break;
    }
    // Recursively compare arrays (susceptible to call stack limits).
    if (seen) {
      if (!arraySome(other, function(othValue, othIndex) {
            if (!seen.has(othIndex) &&
                (arrValue === othValue || equalFunc(arrValue, othValue, customizer, bitmask, stack))) {
              return seen.add(othIndex);
            }
          })) {
        result = false;
        break;
      }
    } else if (!(
          arrValue === othValue ||
            equalFunc(arrValue, othValue, customizer, bitmask, stack)
        )) {
      result = false;
      break;
    }
  }
  stack['delete'](array);
  stack['delete'](other);
  return result;
}

/**
 * A specialized version of `baseIsEqualDeep` for comparing objects of
 * the same `toStringTag`.
 *
 * **Note:** This function only supports comparing values with tags of
 * `Boolean`, `Date`, `Error`, `Number`, `RegExp`, or `String`.
 *
 * @private
 * @param {Object} object The object to compare.
 * @param {Object} other The other object to compare.
 * @param {string} tag The `toStringTag` of the objects to compare.
 * @param {Function} equalFunc The function to determine equivalents of values.
 * @param {Function} customizer The function to customize comparisons.
 * @param {number} bitmask The bitmask of comparison flags. See `baseIsEqual`
 *  for more details.
 * @param {Object} stack Tracks traversed `object` and `other` objects.
 * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.
 */
function equalByTag(object, other, tag, equalFunc, customizer, bitmask, stack) {
  switch (tag) {
    case dataViewTag:
      if ((object.byteLength != other.byteLength) ||
          (object.byteOffset != other.byteOffset)) {
        return false;
      }
      object = object.buffer;
      other = other.buffer;

    case arrayBufferTag:
      if ((object.byteLength != other.byteLength) ||
          !equalFunc(new Uint8Array(object), new Uint8Array(other))) {
        return false;
      }
      return true;

    case boolTag:
    case dateTag:
    case numberTag:
      // Coerce booleans to `1` or `0` and dates to milliseconds.
      // Invalid dates are coerced to `NaN`.
      return eq(+object, +other);

    case errorTag:
      return object.name == other.name && object.message == other.message;

    case regexpTag:
    case stringTag:
      // Coerce regexes to strings and treat strings, primitives and objects,
      // as equal. See http://www.ecma-international.org/ecma-262/7.0/#sec-regexp.prototype.tostring
      // for more details.
      return object == (other + '');

    case mapTag:
      var convert = mapToArray;

    case setTag:
      var isPartial = bitmask & PARTIAL_COMPARE_FLAG;
      convert || (convert = setToArray);

      if (object.size != other.size && !isPartial) {
        return false;
      }
      // Assume cyclic values are equal.
      var stacked = stack.get(object);
      if (stacked) {
        return stacked == other;
      }
      bitmask |= UNORDERED_COMPARE_FLAG;

      // Recursively compare objects (susceptible to call stack limits).
      stack.set(object, other);
      var result = equalArrays(convert(object), convert(other), equalFunc, customizer, bitmask, stack);
      stack['delete'](object);
      return result;

    case symbolTag:
      if (symbolValueOf) {
        return symbolValueOf.call(object) == symbolValueOf.call(other);
      }
  }
  return false;
}

/**
 * A specialized version of `baseIsEqualDeep` for objects with support for
 * partial deep comparisons.
 *
 * @private
 * @param {Object} object The object to compare.
 * @param {Object} other The other object to compare.
 * @param {Function} equalFunc The function to determine equivalents of values.
 * @param {Function} customizer The function to customize comparisons.
 * @param {number} bitmask The bitmask of comparison flags. See `baseIsEqual`
 *  for more details.
 * @param {Object} stack Tracks traversed `object` and `other` objects.
 * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.
 */
function equalObjects(object, other, equalFunc, customizer, bitmask, stack) {
  var isPartial = bitmask & PARTIAL_COMPARE_FLAG,
      objProps = keys(object),
      objLength = objProps.length,
      othProps = keys(other),
      othLength = othProps.length;

  if (objLength != othLength && !isPartial) {
    return false;
  }
  var index = objLength;
  while (index--) {
    var key = objProps[index];
    if (!(isPartial ? key in other : hasOwnProperty.call(other, key))) {
      return false;
    }
  }
  // Assume cyclic values are equal.
  var stacked = stack.get(object);
  if (stacked && stack.get(other)) {
    return stacked == other;
  }
  var result = true;
  stack.set(object, other);
  stack.set(other, object);

  var skipCtor = isPartial;
  while (++index < objLength) {
    key = objProps[index];
    var objValue = object[key],
        othValue = other[key];

    if (customizer) {
      var compared = isPartial
        ? customizer(othValue, objValue, key, other, object, stack)
        : customizer(objValue, othValue, key, object, other, stack);
    }
    // Recursively compare objects (susceptible to call stack limits).
    if (!(compared === undefined
          ? (objValue === othValue || equalFunc(objValue, othValue, customizer, bitmask, stack))
          : compared
        )) {
      result = false;
      break;
    }
    skipCtor || (skipCtor = key == 'constructor');
  }
  if (result && !skipCtor) {
    var objCtor = object.constructor,
        othCtor = other.constructor;

    // Non `Object` object instances with different constructors are not equal.
    if (objCtor != othCtor &&
        ('constructor' in object && 'constructor' in other) &&
        !(typeof objCtor == 'function' && objCtor instanceof objCtor &&
          typeof othCtor == 'function' && othCtor instanceof othCtor)) {
      result = false;
    }
  }
  stack['delete'](object);
  stack['delete'](other);
  return result;
}

/**
 * Gets the data for `map`.
 *
 * @private
 * @param {Object} map The map to query.
 * @param {string} key The reference key.
 * @returns {*} Returns the map data.
 */
function getMapData(map, key) {
  var data = map.__data__;
  return isKeyable(key)
    ? data[typeof key == 'string' ? 'string' : 'hash']
    : data.map;
}

/**
 * Gets the property names, values, and compare flags of `object`.
 *
 * @private
 * @param {Object} object The object to query.
 * @returns {Array} Returns the match data of `object`.
 */
function getMatchData(object) {
  var result = keys(object),
      length = result.length;

  while (length--) {
    var key = result[length],
        value = object[key];

    result[length] = [key, value, isStrictComparable(value)];
  }
  return result;
}

/**
 * Gets the native function at `key` of `object`.
 *
 * @private
 * @param {Object} object The object to query.
 * @param {string} key The key of the method to get.
 * @returns {*} Returns the function if it's native, else `undefined`.
 */
function getNative(object, key) {
  var value = getValue(object, key);
  return baseIsNative(value) ? value : undefined;
}

/**
 * Gets the `toStringTag` of `value`.
 *
 * @private
 * @param {*} value The value to query.
 * @returns {string} Returns the `toStringTag`.
 */
var getTag = baseGetTag;

// Fallback for data views, maps, sets, and weak maps in IE 11,
// for data views in Edge < 14, and promises in Node.js.
if ((DataView && getTag(new DataView(new ArrayBuffer(1))) != dataViewTag) ||
    (Map && getTag(new Map) != mapTag) ||
    (Promise && getTag(Promise.resolve()) != promiseTag) ||
    (Set && getTag(new Set) != setTag) ||
    (WeakMap && getTag(new WeakMap) != weakMapTag)) {
  getTag = function(value) {
    var result = objectToString.call(value),
        Ctor = result == objectTag ? value.constructor : undefined,
        ctorString = Ctor ? toSource(Ctor) : undefined;

    if (ctorString) {
      switch (ctorString) {
        case dataViewCtorString: return dataViewTag;
        case mapCtorString: return mapTag;
        case promiseCtorString: return promiseTag;
        case setCtorString: return setTag;
        case weakMapCtorString: return weakMapTag;
      }
    }
    return result;
  };
}

/**
 * Checks if `path` exists on `object`.
 *
 * @private
 * @param {Object} object The object to query.
 * @param {Array|string} path The path to check.
 * @param {Function} hasFunc The function to check properties.
 * @returns {boolean} Returns `true` if `path` exists, else `false`.
 */
function hasPath(object, path, hasFunc) {
  path = isKey(path, object) ? [path] : castPath(path);

  var result,
      index = -1,
      length = path.length;

  while (++index < length) {
    var key = toKey(path[index]);
    if (!(result = object != null && hasFunc(object, key))) {
      break;
    }
    object = object[key];
  }
  if (result) {
    return result;
  }
  var length = object ? object.length : 0;
  return !!length && isLength(length) && isIndex(key, length) &&
    (isArray(object) || isArguments(object));
}

/**
 * Checks if `value` is a valid array-like index.
 *
 * @private
 * @param {*} value The value to check.
 * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.
 * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.
 */
function isIndex(value, length) {
  length = length == null ? MAX_SAFE_INTEGER : length;
  return !!length &&
    (typeof value == 'number' || reIsUint.test(value)) &&
    (value > -1 && value % 1 == 0 && value < length);
}

/**
 * Checks if `value` is a property name and not a property path.
 *
 * @private
 * @param {*} value The value to check.
 * @param {Object} [object] The object to query keys on.
 * @returns {boolean} Returns `true` if `value` is a property name, else `false`.
 */
function isKey(value, object) {
  if (isArray(value)) {
    return false;
  }
  var type = typeof value;
  if (type == 'number' || type == 'symbol' || type == 'boolean' ||
      value == null || isSymbol(value)) {
    return true;
  }
  return reIsPlainProp.test(value) || !reIsDeepProp.test(value) ||
    (object != null && value in Object(object));
}

/**
 * Checks if `value` is suitable for use as unique object key.
 *
 * @private
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is suitable, else `false`.
 */
function isKeyable(value) {
  var type = typeof value;
  return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')
    ? (value !== '__proto__')
    : (value === null);
}

/**
 * Checks if `func` has its source masked.
 *
 * @private
 * @param {Function} func The function to check.
 * @returns {boolean} Returns `true` if `func` is masked, else `false`.
 */
function isMasked(func) {
  return !!maskSrcKey && (maskSrcKey in func);
}

/**
 * Checks if `value` is likely a prototype object.
 *
 * @private
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.
 */
function isPrototype(value) {
  var Ctor = value && value.constructor,
      proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;

  return value === proto;
}

/**
 * Checks if `value` is suitable for strict equality comparisons, i.e. `===`.
 *
 * @private
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` if suitable for strict
 *  equality comparisons, else `false`.
 */
function isStrictComparable(value) {
  return value === value && !isObject(value);
}

/**
 * A specialized version of `matchesProperty` for source values suitable
 * for strict equality comparisons, i.e. `===`.
 *
 * @private
 * @param {string} key The key of the property to get.
 * @param {*} srcValue The value to match.
 * @returns {Function} Returns the new spec function.
 */
function matchesStrictComparable(key, srcValue) {
  return function(object) {
    if (object == null) {
      return false;
    }
    return object[key] === srcValue &&
      (srcValue !== undefined || (key in Object(object)));
  };
}

/**
 * Gets the parent value at `path` of `object`.
 *
 * @private
 * @param {Object} object The object to query.
 * @param {Array} path The path to get the parent value of.
 * @returns {*} Returns the parent value.
 */
function parent(object, path) {
  return path.length == 1 ? object : baseGet(object, baseSlice(path, 0, -1));
}

/**
 * Converts `string` to a property path array.
 *
 * @private
 * @param {string} string The string to convert.
 * @returns {Array} Returns the property path array.
 */
var stringToPath = memoize(function(string) {
  string = toString(string);

  var result = [];
  if (reLeadingDot.test(string)) {
    result.push('');
  }
  string.replace(rePropName, function(match, number, quote, string) {
    result.push(quote ? string.replace(reEscapeChar, '$1') : (number || match));
  });
  return result;
});

/**
 * Converts `value` to a string key if it's not a string or symbol.
 *
 * @private
 * @param {*} value The value to inspect.
 * @returns {string|symbol} Returns the key.
 */
function toKey(value) {
  if (typeof value == 'string' || isSymbol(value)) {
    return value;
  }
  var result = (value + '');
  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;
}

/**
 * Converts `func` to its source code.
 *
 * @private
 * @param {Function} func The function to process.
 * @returns {string} Returns the source code.
 */
function toSource(func) {
  if (func != null) {
    try {
      return funcToString.call(func);
    } catch (e) {}
    try {
      return (func + '');
    } catch (e) {}
  }
  return '';
}

/**
 * Gets the last element of `array`.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Array
 * @param {Array} array The array to query.
 * @returns {*} Returns the last element of `array`.
 * @example
 *
 * _.last([1, 2, 3]);
 * // => 3
 */
function last(array) {
  var length = array ? array.length : 0;
  return length ? array[length - 1] : undefined;
}

/**
 * Removes all elements from `array` that `predicate` returns truthy for
 * and returns an array of the removed elements. The predicate is invoked
 * with three arguments: (value, index, array).
 *
 * **Note:** Unlike `_.filter`, this method mutates `array`. Use `_.pull`
 * to pull elements from an array by value.
 *
 * @static
 * @memberOf _
 * @since 2.0.0
 * @category Array
 * @param {Array} array The array to modify.
 * @param {Function} [predicate=_.identity]
 *  The function invoked per iteration.
 * @returns {Array} Returns the new array of removed elements.
 * @example
 *
 * var array = [1, 2, 3, 4];
 * var evens = _.remove(array, function(n) {
 *   return n % 2 == 0;
 * });
 *
 * console.log(array);
 * // => [1, 3]
 *
 * console.log(evens);
 * // => [2, 4]
 */
function remove(array, predicate) {
  var result = [];
  if (!(array && array.length)) {
    return result;
  }
  var index = -1,
      indexes = [],
      length = array.length;

  predicate = baseIteratee(predicate, 3);
  while (++index < length) {
    var value = array[index];
    if (predicate(value, index, array)) {
      result.push(value);
      indexes.push(index);
    }
  }
  basePullAt(array, indexes);
  return result;
}

/**
 * Creates a function that memoizes the result of `func`. If `resolver` is
 * provided, it determines the cache key for storing the result based on the
 * arguments provided to the memoized function. By default, the first argument
 * provided to the memoized function is used as the map cache key. The `func`
 * is invoked with the `this` binding of the memoized function.
 *
 * **Note:** The cache is exposed as the `cache` property on the memoized
 * function. Its creation may be customized by replacing the `_.memoize.Cache`
 * constructor with one whose instances implement the
 * [`Map`](http://ecma-international.org/ecma-262/7.0/#sec-properties-of-the-map-prototype-object)
 * method interface of `delete`, `get`, `has`, and `set`.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Function
 * @param {Function} func The function to have its output memoized.
 * @param {Function} [resolver] The function to resolve the cache key.
 * @returns {Function} Returns the new memoized function.
 * @example
 *
 * var object = { 'a': 1, 'b': 2 };
 * var other = { 'c': 3, 'd': 4 };
 *
 * var values = _.memoize(_.values);
 * values(object);
 * // => [1, 2]
 *
 * values(other);
 * // => [3, 4]
 *
 * object.a = 2;
 * values(object);
 * // => [1, 2]
 *
 * // Modify the result cache.
 * values.cache.set(object, ['a', 'b']);
 * values(object);
 * // => ['a', 'b']
 *
 * // Replace `_.memoize.Cache`.
 * _.memoize.Cache = WeakMap;
 */
function memoize(func, resolver) {
  if (typeof func != 'function' || (resolver && typeof resolver != 'function')) {
    throw new TypeError(FUNC_ERROR_TEXT);
  }
  var memoized = function() {
    var args = arguments,
        key = resolver ? resolver.apply(this, args) : args[0],
        cache = memoized.cache;

    if (cache.has(key)) {
      return cache.get(key);
    }
    var result = func.apply(this, args);
    memoized.cache = cache.set(key, result);
    return result;
  };
  memoized.cache = new (memoize.Cache || MapCache);
  return memoized;
}

// Assign cache to `_.memoize`.
memoize.Cache = MapCache;

/**
 * Performs a
 * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)
 * comparison between two values to determine if they are equivalent.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to compare.
 * @param {*} other The other value to compare.
 * @returns {boolean} Returns `true` if the values are equivalent, else `false`.
 * @example
 *
 * var object = { 'a': 1 };
 * var other = { 'a': 1 };
 *
 * _.eq(object, object);
 * // => true
 *
 * _.eq(object, other);
 * // => false
 *
 * _.eq('a', 'a');
 * // => true
 *
 * _.eq('a', Object('a'));
 * // => false
 *
 * _.eq(NaN, NaN);
 * // => true
 */
function eq(value, other) {
  return value === other || (value !== value && other !== other);
}

/**
 * Checks if `value` is likely an `arguments` object.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is an `arguments` object,
 *  else `false`.
 * @example
 *
 * _.isArguments(function() { return arguments; }());
 * // => true
 *
 * _.isArguments([1, 2, 3]);
 * // => false
 */
function isArguments(value) {
  // Safari 8.1 makes `arguments.callee` enumerable in strict mode.
  return isArrayLikeObject(value) && hasOwnProperty.call(value, 'callee') &&
    (!propertyIsEnumerable.call(value, 'callee') || objectToString.call(value) == argsTag);
}

/**
 * Checks if `value` is classified as an `Array` object.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is an array, else `false`.
 * @example
 *
 * _.isArray([1, 2, 3]);
 * // => true
 *
 * _.isArray(document.body.children);
 * // => false
 *
 * _.isArray('abc');
 * // => false
 *
 * _.isArray(_.noop);
 * // => false
 */
var isArray = Array.isArray;

/**
 * Checks if `value` is array-like. A value is considered array-like if it's
 * not a function and has a `value.length` that's an integer greater than or
 * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is array-like, else `false`.
 * @example
 *
 * _.isArrayLike([1, 2, 3]);
 * // => true
 *
 * _.isArrayLike(document.body.children);
 * // => true
 *
 * _.isArrayLike('abc');
 * // => true
 *
 * _.isArrayLike(_.noop);
 * // => false
 */
function isArrayLike(value) {
  return value != null && isLength(value.length) && !isFunction(value);
}

/**
 * This method is like `_.isArrayLike` except that it also checks if `value`
 * is an object.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is an array-like object,
 *  else `false`.
 * @example
 *
 * _.isArrayLikeObject([1, 2, 3]);
 * // => true
 *
 * _.isArrayLikeObject(document.body.children);
 * // => true
 *
 * _.isArrayLikeObject('abc');
 * // => false
 *
 * _.isArrayLikeObject(_.noop);
 * // => false
 */
function isArrayLikeObject(value) {
  return isObjectLike(value) && isArrayLike(value);
}

/**
 * Checks if `value` is classified as a `Function` object.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a function, else `false`.
 * @example
 *
 * _.isFunction(_);
 * // => true
 *
 * _.isFunction(/abc/);
 * // => false
 */
function isFunction(value) {
  // The use of `Object#toString` avoids issues with the `typeof` operator
  // in Safari 8-9 which returns 'object' for typed array and other constructors.
  var tag = isObject(value) ? objectToString.call(value) : '';
  return tag == funcTag || tag == genTag;
}

/**
 * Checks if `value` is a valid array-like length.
 *
 * **Note:** This method is loosely based on
 * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.
 * @example
 *
 * _.isLength(3);
 * // => true
 *
 * _.isLength(Number.MIN_VALUE);
 * // => false
 *
 * _.isLength(Infinity);
 * // => false
 *
 * _.isLength('3');
 * // => false
 */
function isLength(value) {
  return typeof value == 'number' &&
    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;
}

/**
 * Checks if `value` is the
 * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)
 * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is an object, else `false`.
 * @example
 *
 * _.isObject({});
 * // => true
 *
 * _.isObject([1, 2, 3]);
 * // => true
 *
 * _.isObject(_.noop);
 * // => true
 *
 * _.isObject(null);
 * // => false
 */
function isObject(value) {
  var type = typeof value;
  return !!value && (type == 'object' || type == 'function');
}

/**
 * Checks if `value` is object-like. A value is object-like if it's not `null`
 * and has a `typeof` result of "object".
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is object-like, else `false`.
 * @example
 *
 * _.isObjectLike({});
 * // => true
 *
 * _.isObjectLike([1, 2, 3]);
 * // => true
 *
 * _.isObjectLike(_.noop);
 * // => false
 *
 * _.isObjectLike(null);
 * // => false
 */
function isObjectLike(value) {
  return !!value && typeof value == 'object';
}

/**
 * Checks if `value` is classified as a `Symbol` primitive or object.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.
 * @example
 *
 * _.isSymbol(Symbol.iterator);
 * // => true
 *
 * _.isSymbol('abc');
 * // => false
 */
function isSymbol(value) {
  return typeof value == 'symbol' ||
    (isObjectLike(value) && objectToString.call(value) == symbolTag);
}

/**
 * Checks if `value` is classified as a typed array.
 *
 * @static
 * @memberOf _
 * @since 3.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.
 * @example
 *
 * _.isTypedArray(new Uint8Array);
 * // => true
 *
 * _.isTypedArray([]);
 * // => false
 */
var isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;

/**
 * Converts `value` to a string. An empty string is returned for `null`
 * and `undefined` values. The sign of `-0` is preserved.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to process.
 * @returns {string} Returns the string.
 * @example
 *
 * _.toString(null);
 * // => ''
 *
 * _.toString(-0);
 * // => '-0'
 *
 * _.toString([1, 2, 3]);
 * // => '1,2,3'
 */
function toString(value) {
  return value == null ? '' : baseToString(value);
}

/**
 * Gets the value at `path` of `object`. If the resolved value is
 * `undefined`, the `defaultValue` is returned in its place.
 *
 * @static
 * @memberOf _
 * @since 3.7.0
 * @category Object
 * @param {Object} object The object to query.
 * @param {Array|string} path The path of the property to get.
 * @param {*} [defaultValue] The value returned for `undefined` resolved values.
 * @returns {*} Returns the resolved value.
 * @example
 *
 * var object = { 'a': [{ 'b': { 'c': 3 } }] };
 *
 * _.get(object, 'a[0].b.c');
 * // => 3
 *
 * _.get(object, ['a', '0', 'b', 'c']);
 * // => 3
 *
 * _.get(object, 'a.b.c', 'default');
 * // => 'default'
 */
function get(object, path, defaultValue) {
  var result = object == null ? undefined : baseGet(object, path);
  return result === undefined ? defaultValue : result;
}

/**
 * Checks if `path` is a direct or inherited property of `object`.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Object
 * @param {Object} object The object to query.
 * @param {Array|string} path The path to check.
 * @returns {boolean} Returns `true` if `path` exists, else `false`.
 * @example
 *
 * var object = _.create({ 'a': _.create({ 'b': 2 }) });
 *
 * _.hasIn(object, 'a');
 * // => true
 *
 * _.hasIn(object, 'a.b');
 * // => true
 *
 * _.hasIn(object, ['a', 'b']);
 * // => true
 *
 * _.hasIn(object, 'b');
 * // => false
 */
function hasIn(object, path) {
  return object != null && hasPath(object, path, baseHasIn);
}

/**
 * Creates an array of the own enumerable property names of `object`.
 *
 * **Note:** Non-object values are coerced to objects. See the
 * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)
 * for more details.
 *
 * @static
 * @since 0.1.0
 * @memberOf _
 * @category Object
 * @param {Object} object The object to query.
 * @returns {Array} Returns the array of property names.
 * @example
 *
 * function Foo() {
 *   this.a = 1;
 *   this.b = 2;
 * }
 *
 * Foo.prototype.c = 3;
 *
 * _.keys(new Foo);
 * // => ['a', 'b'] (iteration order is not guaranteed)
 *
 * _.keys('hi');
 * // => ['0', '1']
 */
function keys(object) {
  return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);
}

/**
 * This method returns the first argument it receives.
 *
 * @static
 * @since 0.1.0
 * @memberOf _
 * @category Util
 * @param {*} value Any value.
 * @returns {*} Returns `value`.
 * @example
 *
 * var object = { 'a': 1 };
 *
 * console.log(_.identity(object) === object);
 * // => true
 */
function identity(value) {
  return value;
}

/**
 * Creates a function that returns the value at `path` of a given object.
 *
 * @static
 * @memberOf _
 * @since 2.4.0
 * @category Util
 * @param {Array|string} path The path of the property to get.
 * @returns {Function} Returns the new accessor function.
 * @example
 *
 * var objects = [
 *   { 'a': { 'b': 2 } },
 *   { 'a': { 'b': 1 } }
 * ];
 *
 * _.map(objects, _.property('a.b'));
 * // => [2, 1]
 *
 * _.map(_.sortBy(objects, _.property(['a', 'b'])), 'a.b');
 * // => [1, 2]
 */
function property(path) {
  return isKey(path) ? baseProperty(toKey(path)) : basePropertyDeep(path);
}

module.exports = remove;


/***/ }),

/***/ 52:
/***/ ((module, __unused_webpack_exports, __webpack_require__) => {

/**
 * lodash (Custom Build) <https://lodash.com/>
 * Build: `lodash modularize exports="npm" -o ./`
 * Copyright jQuery Foundation and other contributors <https://jquery.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */

/** Used as references for various `Number` constants. */
var MAX_SAFE_INTEGER = 9007199254740991;

/** `Object#toString` result references. */
var argsTag = '[object Arguments]',
    funcTag = '[object Function]',
    genTag = '[object GeneratorFunction]',
    mapTag = '[object Map]',
    objectTag = '[object Object]',
    promiseTag = '[object Promise]',
    setTag = '[object Set]',
    weakMapTag = '[object WeakMap]';

var dataViewTag = '[object DataView]';

/**
 * Used to match `RegExp`
 * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).
 */
var reRegExpChar = /[\\^$.*+?()[\]{}|]/g;

/** Used to detect host constructors (Safari). */
var reIsHostCtor = /^\[object .+?Constructor\]$/;

/** Used to detect unsigned integer values. */
var reIsUint = /^(?:0|[1-9]\d*)$/;

/** Detect free variable `global` from Node.js. */
var freeGlobal = typeof __webpack_require__.g == 'object' && __webpack_require__.g && __webpack_require__.g.Object === Object && __webpack_require__.g;

/** Detect free variable `self`. */
var freeSelf = typeof self == 'object' && self && self.Object === Object && self;

/** Used as a reference to the global object. */
var root = freeGlobal || freeSelf || Function('return this')();

/**
 * A specialized version of `_.map` for arrays without support for iteratee
 * shorthands.
 *
 * @private
 * @param {Array} [array] The array to iterate over.
 * @param {Function} iteratee The function invoked per iteration.
 * @returns {Array} Returns the new mapped array.
 */
function arrayMap(array, iteratee) {
  var index = -1,
      length = array ? array.length : 0,
      result = Array(length);

  while (++index < length) {
    result[index] = iteratee(array[index], index, array);
  }
  return result;
}

/**
 * The base implementation of `_.times` without support for iteratee shorthands
 * or max array length checks.
 *
 * @private
 * @param {number} n The number of times to invoke `iteratee`.
 * @param {Function} iteratee The function invoked per iteration.
 * @returns {Array} Returns the array of results.
 */
function baseTimes(n, iteratee) {
  var index = -1,
      result = Array(n);

  while (++index < n) {
    result[index] = iteratee(index);
  }
  return result;
}

/**
 * The base implementation of `_.toPairs` and `_.toPairsIn` which creates an array
 * of key-value pairs for `object` corresponding to the property names of `props`.
 *
 * @private
 * @param {Object} object The object to query.
 * @param {Array} props The property names to get values for.
 * @returns {Object} Returns the key-value pairs.
 */
function baseToPairs(object, props) {
  return arrayMap(props, function(key) {
    return [key, object[key]];
  });
}

/**
 * Gets the value at `key` of `object`.
 *
 * @private
 * @param {Object} [object] The object to query.
 * @param {string} key The key of the property to get.
 * @returns {*} Returns the property value.
 */
function getValue(object, key) {
  return object == null ? undefined : object[key];
}

/**
 * Checks if `value` is a host object in IE < 9.
 *
 * @private
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a host object, else `false`.
 */
function isHostObject(value) {
  // Many host objects are `Object` objects that can coerce to strings
  // despite having improperly defined `toString` methods.
  var result = false;
  if (value != null && typeof value.toString != 'function') {
    try {
      result = !!(value + '');
    } catch (e) {}
  }
  return result;
}

/**
 * Converts `map` to its key-value pairs.
 *
 * @private
 * @param {Object} map The map to convert.
 * @returns {Array} Returns the key-value pairs.
 */
function mapToArray(map) {
  var index = -1,
      result = Array(map.size);

  map.forEach(function(value, key) {
    result[++index] = [key, value];
  });
  return result;
}

/**
 * Creates a unary function that invokes `func` with its argument transformed.
 *
 * @private
 * @param {Function} func The function to wrap.
 * @param {Function} transform The argument transform.
 * @returns {Function} Returns the new function.
 */
function overArg(func, transform) {
  return function(arg) {
    return func(transform(arg));
  };
}

/**
 * Converts `set` to its value-value pairs.
 *
 * @private
 * @param {Object} set The set to convert.
 * @returns {Array} Returns the value-value pairs.
 */
function setToPairs(set) {
  var index = -1,
      result = Array(set.size);

  set.forEach(function(value) {
    result[++index] = [value, value];
  });
  return result;
}

/** Used for built-in method references. */
var funcProto = Function.prototype,
    objectProto = Object.prototype;

/** Used to detect overreaching core-js shims. */
var coreJsData = root['__core-js_shared__'];

/** Used to detect methods masquerading as native. */
var maskSrcKey = (function() {
  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');
  return uid ? ('Symbol(src)_1.' + uid) : '';
}());

/** Used to resolve the decompiled source of functions. */
var funcToString = funcProto.toString;

/** Used to check objects for own properties. */
var hasOwnProperty = objectProto.hasOwnProperty;

/**
 * Used to resolve the
 * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)
 * of values.
 */
var objectToString = objectProto.toString;

/** Used to detect if a method is native. */
var reIsNative = RegExp('^' +
  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\$&')
  .replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g, '$1.*?') + '$'
);

/** Built-in value references. */
var propertyIsEnumerable = objectProto.propertyIsEnumerable;

/* Built-in method references for those with the same name as other `lodash` methods. */
var nativeKeys = overArg(Object.keys, Object);

/* Built-in method references that are verified to be native. */
var DataView = getNative(root, 'DataView'),
    Map = getNative(root, 'Map'),
    Promise = getNative(root, 'Promise'),
    Set = getNative(root, 'Set'),
    WeakMap = getNative(root, 'WeakMap');

/** Used to detect maps, sets, and weakmaps. */
var dataViewCtorString = toSource(DataView),
    mapCtorString = toSource(Map),
    promiseCtorString = toSource(Promise),
    setCtorString = toSource(Set),
    weakMapCtorString = toSource(WeakMap);

/**
 * Creates an array of the enumerable property names of the array-like `value`.
 *
 * @private
 * @param {*} value The value to query.
 * @param {boolean} inherited Specify returning inherited property names.
 * @returns {Array} Returns the array of property names.
 */
function arrayLikeKeys(value, inherited) {
  // Safari 8.1 makes `arguments.callee` enumerable in strict mode.
  // Safari 9 makes `arguments.length` enumerable in strict mode.
  var result = (isArray(value) || isArguments(value))
    ? baseTimes(value.length, String)
    : [];

  var length = result.length,
      skipIndexes = !!length;

  for (var key in value) {
    if ((inherited || hasOwnProperty.call(value, key)) &&
        !(skipIndexes && (key == 'length' || isIndex(key, length)))) {
      result.push(key);
    }
  }
  return result;
}

/**
 * The base implementation of `getTag`.
 *
 * @private
 * @param {*} value The value to query.
 * @returns {string} Returns the `toStringTag`.
 */
function baseGetTag(value) {
  return objectToString.call(value);
}

/**
 * The base implementation of `_.isNative` without bad shim checks.
 *
 * @private
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a native function,
 *  else `false`.
 */
function baseIsNative(value) {
  if (!isObject(value) || isMasked(value)) {
    return false;
  }
  var pattern = (isFunction(value) || isHostObject(value)) ? reIsNative : reIsHostCtor;
  return pattern.test(toSource(value));
}

/**
 * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.
 *
 * @private
 * @param {Object} object The object to query.
 * @returns {Array} Returns the array of property names.
 */
function baseKeys(object) {
  if (!isPrototype(object)) {
    return nativeKeys(object);
  }
  var result = [];
  for (var key in Object(object)) {
    if (hasOwnProperty.call(object, key) && key != 'constructor') {
      result.push(key);
    }
  }
  return result;
}

/**
 * Creates a `_.toPairs` or `_.toPairsIn` function.
 *
 * @private
 * @param {Function} keysFunc The function to get the keys of a given object.
 * @returns {Function} Returns the new pairs function.
 */
function createToPairs(keysFunc) {
  return function(object) {
    var tag = getTag(object);
    if (tag == mapTag) {
      return mapToArray(object);
    }
    if (tag == setTag) {
      return setToPairs(object);
    }
    return baseToPairs(object, keysFunc(object));
  };
}

/**
 * Gets the native function at `key` of `object`.
 *
 * @private
 * @param {Object} object The object to query.
 * @param {string} key The key of the method to get.
 * @returns {*} Returns the function if it's native, else `undefined`.
 */
function getNative(object, key) {
  var value = getValue(object, key);
  return baseIsNative(value) ? value : undefined;
}

/**
 * Gets the `toStringTag` of `value`.
 *
 * @private
 * @param {*} value The value to query.
 * @returns {string} Returns the `toStringTag`.
 */
var getTag = baseGetTag;

// Fallback for data views, maps, sets, and weak maps in IE 11,
// for data views in Edge < 14, and promises in Node.js.
if ((DataView && getTag(new DataView(new ArrayBuffer(1))) != dataViewTag) ||
    (Map && getTag(new Map) != mapTag) ||
    (Promise && getTag(Promise.resolve()) != promiseTag) ||
    (Set && getTag(new Set) != setTag) ||
    (WeakMap && getTag(new WeakMap) != weakMapTag)) {
  getTag = function(value) {
    var result = objectToString.call(value),
        Ctor = result == objectTag ? value.constructor : undefined,
        ctorString = Ctor ? toSource(Ctor) : undefined;

    if (ctorString) {
      switch (ctorString) {
        case dataViewCtorString: return dataViewTag;
        case mapCtorString: return mapTag;
        case promiseCtorString: return promiseTag;
        case setCtorString: return setTag;
        case weakMapCtorString: return weakMapTag;
      }
    }
    return result;
  };
}

/**
 * Checks if `value` is a valid array-like index.
 *
 * @private
 * @param {*} value The value to check.
 * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.
 * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.
 */
function isIndex(value, length) {
  length = length == null ? MAX_SAFE_INTEGER : length;
  return !!length &&
    (typeof value == 'number' || reIsUint.test(value)) &&
    (value > -1 && value % 1 == 0 && value < length);
}

/**
 * Checks if `func` has its source masked.
 *
 * @private
 * @param {Function} func The function to check.
 * @returns {boolean} Returns `true` if `func` is masked, else `false`.
 */
function isMasked(func) {
  return !!maskSrcKey && (maskSrcKey in func);
}

/**
 * Checks if `value` is likely a prototype object.
 *
 * @private
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.
 */
function isPrototype(value) {
  var Ctor = value && value.constructor,
      proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;

  return value === proto;
}

/**
 * Converts `func` to its source code.
 *
 * @private
 * @param {Function} func The function to process.
 * @returns {string} Returns the source code.
 */
function toSource(func) {
  if (func != null) {
    try {
      return funcToString.call(func);
    } catch (e) {}
    try {
      return (func + '');
    } catch (e) {}
  }
  return '';
}

/**
 * Checks if `value` is likely an `arguments` object.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is an `arguments` object,
 *  else `false`.
 * @example
 *
 * _.isArguments(function() { return arguments; }());
 * // => true
 *
 * _.isArguments([1, 2, 3]);
 * // => false
 */
function isArguments(value) {
  // Safari 8.1 makes `arguments.callee` enumerable in strict mode.
  return isArrayLikeObject(value) && hasOwnProperty.call(value, 'callee') &&
    (!propertyIsEnumerable.call(value, 'callee') || objectToString.call(value) == argsTag);
}

/**
 * Checks if `value` is classified as an `Array` object.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is an array, else `false`.
 * @example
 *
 * _.isArray([1, 2, 3]);
 * // => true
 *
 * _.isArray(document.body.children);
 * // => false
 *
 * _.isArray('abc');
 * // => false
 *
 * _.isArray(_.noop);
 * // => false
 */
var isArray = Array.isArray;

/**
 * Checks if `value` is array-like. A value is considered array-like if it's
 * not a function and has a `value.length` that's an integer greater than or
 * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is array-like, else `false`.
 * @example
 *
 * _.isArrayLike([1, 2, 3]);
 * // => true
 *
 * _.isArrayLike(document.body.children);
 * // => true
 *
 * _.isArrayLike('abc');
 * // => true
 *
 * _.isArrayLike(_.noop);
 * // => false
 */
function isArrayLike(value) {
  return value != null && isLength(value.length) && !isFunction(value);
}

/**
 * This method is like `_.isArrayLike` except that it also checks if `value`
 * is an object.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is an array-like object,
 *  else `false`.
 * @example
 *
 * _.isArrayLikeObject([1, 2, 3]);
 * // => true
 *
 * _.isArrayLikeObject(document.body.children);
 * // => true
 *
 * _.isArrayLikeObject('abc');
 * // => false
 *
 * _.isArrayLikeObject(_.noop);
 * // => false
 */
function isArrayLikeObject(value) {
  return isObjectLike(value) && isArrayLike(value);
}

/**
 * Checks if `value` is classified as a `Function` object.
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a function, else `false`.
 * @example
 *
 * _.isFunction(_);
 * // => true
 *
 * _.isFunction(/abc/);
 * // => false
 */
function isFunction(value) {
  // The use of `Object#toString` avoids issues with the `typeof` operator
  // in Safari 8-9 which returns 'object' for typed array and other constructors.
  var tag = isObject(value) ? objectToString.call(value) : '';
  return tag == funcTag || tag == genTag;
}

/**
 * Checks if `value` is a valid array-like length.
 *
 * **Note:** This method is loosely based on
 * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.
 * @example
 *
 * _.isLength(3);
 * // => true
 *
 * _.isLength(Number.MIN_VALUE);
 * // => false
 *
 * _.isLength(Infinity);
 * // => false
 *
 * _.isLength('3');
 * // => false
 */
function isLength(value) {
  return typeof value == 'number' &&
    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;
}

/**
 * Checks if `value` is the
 * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)
 * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)
 *
 * @static
 * @memberOf _
 * @since 0.1.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is an object, else `false`.
 * @example
 *
 * _.isObject({});
 * // => true
 *
 * _.isObject([1, 2, 3]);
 * // => true
 *
 * _.isObject(_.noop);
 * // => true
 *
 * _.isObject(null);
 * // => false
 */
function isObject(value) {
  var type = typeof value;
  return !!value && (type == 'object' || type == 'function');
}

/**
 * Checks if `value` is object-like. A value is object-like if it's not `null`
 * and has a `typeof` result of "object".
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @category Lang
 * @param {*} value The value to check.
 * @returns {boolean} Returns `true` if `value` is object-like, else `false`.
 * @example
 *
 * _.isObjectLike({});
 * // => true
 *
 * _.isObjectLike([1, 2, 3]);
 * // => true
 *
 * _.isObjectLike(_.noop);
 * // => false
 *
 * _.isObjectLike(null);
 * // => false
 */
function isObjectLike(value) {
  return !!value && typeof value == 'object';
}

/**
 * Creates an array of the own enumerable property names of `object`.
 *
 * **Note:** Non-object values are coerced to objects. See the
 * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)
 * for more details.
 *
 * @static
 * @since 0.1.0
 * @memberOf _
 * @category Object
 * @param {Object} object The object to query.
 * @returns {Array} Returns the array of property names.
 * @example
 *
 * function Foo() {
 *   this.a = 1;
 *   this.b = 2;
 * }
 *
 * Foo.prototype.c = 3;
 *
 * _.keys(new Foo);
 * // => ['a', 'b'] (iteration order is not guaranteed)
 *
 * _.keys('hi');
 * // => ['0', '1']
 */
function keys(object) {
  return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);
}

/**
 * Creates an array of own enumerable string keyed-value pairs for `object`
 * which can be consumed by `_.fromPairs`. If `object` is a map or set, its
 * entries are returned.
 *
 * @static
 * @memberOf _
 * @since 4.0.0
 * @alias entries
 * @category Object
 * @param {Object} object The object to query.
 * @returns {Array} Returns the key-value pairs.
 * @example
 *
 * function Foo() {
 *   this.a = 1;
 *   this.b = 2;
 * }
 *
 * Foo.prototype.c = 3;
 *
 * _.toPairs(new Foo);
 * // => [['a', 1], ['b', 2]] (iteration order is not guaranteed)
 */
var toPairs = createToPairs(keys);

module.exports = toPairs;


/***/ }),

/***/ 107:
/***/ (function(__unused_webpack_module, __unused_webpack_exports, __webpack_require__) {

(function (global, factory) {
	 true ? factory() :
	0;
}(this, (function () { 'use strict';

/**
 * @this {Promise}
 */
function finallyConstructor(callback) {
  var constructor = this.constructor;
  return this.then(
    function(value) {
      // @ts-ignore
      return constructor.resolve(callback()).then(function() {
        return value;
      });
    },
    function(reason) {
      // @ts-ignore
      return constructor.resolve(callback()).then(function() {
        // @ts-ignore
        return constructor.reject(reason);
      });
    }
  );
}

function allSettled(arr) {
  var P = this;
  return new P(function(resolve, reject) {
    if (!(arr && typeof arr.length !== 'undefined')) {
      return reject(
        new TypeError(
          typeof arr +
            ' ' +
            arr +
            ' is not iterable(cannot read property Symbol(Symbol.iterator))'
        )
      );
    }
    var args = Array.prototype.slice.call(arr);
    if (args.length === 0) return resolve([]);
    var remaining = args.length;

    function res(i, val) {
      if (val && (typeof val === 'object' || typeof val === 'function')) {
        var then = val.then;
        if (typeof then === 'function') {
          then.call(
            val,
            function(val) {
              res(i, val);
            },
            function(e) {
              args[i] = { status: 'rejected', reason: e };
              if (--remaining === 0) {
                resolve(args);
              }
            }
          );
          return;
        }
      }
      args[i] = { status: 'fulfilled', value: val };
      if (--remaining === 0) {
        resolve(args);
      }
    }

    for (var i = 0; i < args.length; i++) {
      res(i, args[i]);
    }
  });
}

// Store setTimeout reference so promise-polyfill will be unaffected by
// other code modifying setTimeout (like sinon.useFakeTimers())
var setTimeoutFunc = setTimeout;

function isArray(x) {
  return Boolean(x && typeof x.length !== 'undefined');
}

function noop() {}

// Polyfill for Function.prototype.bind
function bind(fn, thisArg) {
  return function() {
    fn.apply(thisArg, arguments);
  };
}

/**
 * @constructor
 * @param {Function} fn
 */
function Promise(fn) {
  if (!(this instanceof Promise))
    throw new TypeError('Promises must be constructed via new');
  if (typeof fn !== 'function') throw new TypeError('not a function');
  /** @type {!number} */
  this._state = 0;
  /** @type {!boolean} */
  this._handled = false;
  /** @type {Promise|undefined} */
  this._value = undefined;
  /** @type {!Array<!Function>} */
  this._deferreds = [];

  doResolve(fn, this);
}

function handle(self, deferred) {
  while (self._state === 3) {
    self = self._value;
  }
  if (self._state === 0) {
    self._deferreds.push(deferred);
    return;
  }
  self._handled = true;
  Promise._immediateFn(function() {
    var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;
    if (cb === null) {
      (self._state === 1 ? resolve : reject)(deferred.promise, self._value);
      return;
    }
    var ret;
    try {
      ret = cb(self._value);
    } catch (e) {
      reject(deferred.promise, e);
      return;
    }
    resolve(deferred.promise, ret);
  });
}

function resolve(self, newValue) {
  try {
    // Promise Resolution Procedure: https://github.com/promises-aplus/promises-spec#the-promise-resolution-procedure
    if (newValue === self)
      throw new TypeError('A promise cannot be resolved with itself.');
    if (
      newValue &&
      (typeof newValue === 'object' || typeof newValue === 'function')
    ) {
      var then = newValue.then;
      if (newValue instanceof Promise) {
        self._state = 3;
        self._value = newValue;
        finale(self);
        return;
      } else if (typeof then === 'function') {
        doResolve(bind(then, newValue), self);
        return;
      }
    }
    self._state = 1;
    self._value = newValue;
    finale(self);
  } catch (e) {
    reject(self, e);
  }
}

function reject(self, newValue) {
  self._state = 2;
  self._value = newValue;
  finale(self);
}

function finale(self) {
  if (self._state === 2 && self._deferreds.length === 0) {
    Promise._immediateFn(function() {
      if (!self._handled) {
        Promise._unhandledRejectionFn(self._value);
      }
    });
  }

  for (var i = 0, len = self._deferreds.length; i < len; i++) {
    handle(self, self._deferreds[i]);
  }
  self._deferreds = null;
}

/**
 * @constructor
 */
function Handler(onFulfilled, onRejected, promise) {
  this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;
  this.onRejected = typeof onRejected === 'function' ? onRejected : null;
  this.promise = promise;
}

/**
 * Take a potentially misbehaving resolver function and make sure
 * onFulfilled and onRejected are only called once.
 *
 * Makes no guarantees about asynchrony.
 */
function doResolve(fn, self) {
  var done = false;
  try {
    fn(
      function(value) {
        if (done) return;
        done = true;
        resolve(self, value);
      },
      function(reason) {
        if (done) return;
        done = true;
        reject(self, reason);
      }
    );
  } catch (ex) {
    if (done) return;
    done = true;
    reject(self, ex);
  }
}

Promise.prototype['catch'] = function(onRejected) {
  return this.then(null, onRejected);
};

Promise.prototype.then = function(onFulfilled, onRejected) {
  // @ts-ignore
  var prom = new this.constructor(noop);

  handle(this, new Handler(onFulfilled, onRejected, prom));
  return prom;
};

Promise.prototype['finally'] = finallyConstructor;

Promise.all = function(arr) {
  return new Promise(function(resolve, reject) {
    if (!isArray(arr)) {
      return reject(new TypeError('Promise.all accepts an array'));
    }

    var args = Array.prototype.slice.call(arr);
    if (args.length === 0) return resolve([]);
    var remaining = args.length;

    function res(i, val) {
      try {
        if (val && (typeof val === 'object' || typeof val === 'function')) {
          var then = val.then;
          if (typeof then === 'function') {
            then.call(
              val,
              function(val) {
                res(i, val);
              },
              reject
            );
            return;
          }
        }
        args[i] = val;
        if (--remaining === 0) {
          resolve(args);
        }
      } catch (ex) {
        reject(ex);
      }
    }

    for (var i = 0; i < args.length; i++) {
      res(i, args[i]);
    }
  });
};

Promise.allSettled = allSettled;

Promise.resolve = function(value) {
  if (value && typeof value === 'object' && value.constructor === Promise) {
    return value;
  }

  return new Promise(function(resolve) {
    resolve(value);
  });
};

Promise.reject = function(value) {
  return new Promise(function(resolve, reject) {
    reject(value);
  });
};

Promise.race = function(arr) {
  return new Promise(function(resolve, reject) {
    if (!isArray(arr)) {
      return reject(new TypeError('Promise.race accepts an array'));
    }

    for (var i = 0, len = arr.length; i < len; i++) {
      Promise.resolve(arr[i]).then(resolve, reject);
    }
  });
};

// Use polyfill for setImmediate for performance gains
Promise._immediateFn =
  // @ts-ignore
  (typeof setImmediate === 'function' &&
    function(fn) {
      // @ts-ignore
      setImmediate(fn);
    }) ||
  function(fn) {
    setTimeoutFunc(fn, 0);
  };

Promise._unhandledRejectionFn = function _unhandledRejectionFn(err) {
  if (typeof console !== 'undefined' && console) {
    console.warn('Possible Unhandled Promise Rejection:', err); // eslint-disable-line no-console
  }
};

/** @suppress {undefinedVars} */
var globalNS = (function() {
  // the only reliable means to get the global object is
  // `Function('return this')()`
  // However, this causes CSP violations in Chrome apps.
  if (typeof self !== 'undefined') {
    return self;
  }
  if (typeof window !== 'undefined') {
    return window;
  }
  if (typeof __webpack_require__.g !== 'undefined') {
    return __webpack_require__.g;
  }
  throw new Error('unable to locate global object');
})();

// Expose the polyfill if Promise is undefined or set to a
// non-function value. The latter can be due to a named HTMLElement
// being exposed by browsers for legacy reasons.
// https://github.com/taylorhakes/promise-polyfill/issues/114
if (typeof globalNS['Promise'] !== 'function') {
  globalNS['Promise'] = Promise;
} else {
  if (!globalNS.Promise.prototype['finally']) {
    globalNS.Promise.prototype['finally'] = finallyConstructor;
  } 
  if (!globalNS.Promise.allSettled) {
    globalNS.Promise.allSettled = allSettled;
  }
}

})));


/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			id: moduleId,
/******/ 			loaded: false,
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Flag the module as loaded
/******/ 		module.loaded = true;
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/compat get default export */
/******/ 	(() => {
/******/ 		// getDefaultExport function for compatibility with non-harmony modules
/******/ 		__webpack_require__.n = (module) => {
/******/ 			var getter = module && module.__esModule ?
/******/ 				() => (module['default']) :
/******/ 				() => (module);
/******/ 			__webpack_require__.d(getter, { a: getter });
/******/ 			return getter;
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/global */
/******/ 	(() => {
/******/ 		__webpack_require__.g = (function() {
/******/ 			if (typeof globalThis === 'object') return globalThis;
/******/ 			try {
/******/ 				return this || new Function('return this')();
/******/ 			} catch (e) {
/******/ 				if (typeof window === 'object') return window;
/******/ 			}
/******/ 		})();
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/node module decorator */
/******/ 	(() => {
/******/ 		__webpack_require__.nmd = (module) => {
/******/ 			module.paths = [];
/******/ 			if (!module.children) module.children = [];
/******/ 			return module;
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
var __webpack_exports__ = {};
// This entry need to be wrapped in an IIFE because it need to be in strict mode.
(() => {
"use strict";

// UNUSED EXPORTS: AddressMatchService, AggregationParameter, AggregationTypes, AlongLineDirection, AnalystAreaUnit, AnalystSizeUnit, AreaSolarRadiationParameters, ArrayStatistic, AttributesPopContainer, BaiduMap, Bounds, Browser, BucketAggParameter, BucketAggType, BufferAnalystParameters, BufferDistance, BufferEndType, BufferRadiusUnit, BufferSetting, BuffersAnalystJobsParameter, BurstPipelineAnalystParameters, CartoCSS, ChangeTileVersion, ChartQueryFilterParameter, ChartQueryParameters, ChartService, ChartType, ChartView, ChartViewModel, CityTabsPage, ClientType, ClipAnalystMode, ClipParameter, CloverShape, ColorDictionary, ColorGradientType, ColorSpaceType, ColorsPickerUtil, CommonContainer, CommonServiceBase, CommonTheme, CommonUtil, ComponentsUtil, ComputeWeightMatrixParameters, CreateDatasetParameters, Credential, DataFlow, DataFlowService, DataFormat, DataItemOrderBy, DataItemType, DataReturnMode, DataReturnOption, DatasetBufferAnalystParameters, DatasetInfo, DatasetOverlayAnalystParameters, DatasetService, DatasetSurfaceAnalystParameters, DatasetThiessenAnalystParameters, DatasourceConnectionInfo, DatasourceService, DeafultCanvasStyle, DensityKernelAnalystParameters, DirectionType, DropDownBox, EditFeaturesParameters, EditType, ElasticSearch, EngineType, EntityType, Event, Events, Exponent, FacilityAnalyst3DParameters, FacilityAnalystSinks3DParameters, FacilityAnalystSources3DParameters, FacilityAnalystStreamParameters, FacilityAnalystTracedown3DParameters, FacilityAnalystTraceup3DParameters, FacilityAnalystUpstream3DParameters, Feature, FeatureService, FeatureShapeFactory, FeatureTheme, FeatureThemeGraph, FeatureThemeRankSymbol, FeatureThemeVector, FeatureVector, FetchRequest, FieldParameters, FieldService, FieldStatisticsParameters, FieldsFilter, FileReaderUtil, FillGradientMode, FilterField, FilterParameter, FindClosestFacilitiesParameters, FindLocationParameters, FindMTSPPathsParameters, FindPathParameters, FindServiceAreasParameters, FindTSPPathsParameters, Format, GenerateSpatialDataParameters, GeoCodingParameter, GeoDecodingParameter, GeoFeature, GeoHashGridAggParameter, GeoJSONFormat, GeoRelationAnalystParameters, Geometry, GeometryBufferAnalystParameters, GeometryCollection, GeometryCurve, GeometryGeoText, GeometryLineString, GeometryLinearRing, GeometryMultiLineString, GeometryMultiPoint, GeometryMultiPolygon, GeometryOverlayAnalystParameters, GeometryPoint, GeometryPolygon, GeometryRectangle, GeometrySurfaceAnalystParameters, GeometryThiessenAnalystParameters, GeometryType, GeoprocessingService, GetFeatureMode, GetFeaturesByBoundsParameters, GetFeaturesByBufferParameters, GetFeaturesByGeometryParameters, GetFeaturesByIDsParameters, GetFeaturesBySQLParameters, GetFeaturesParametersBase, GetFeaturesServiceBase, GetGridCellInfosParameters, GraduatedMode, Graph, GraphAxesTextDisplayMode, Graphic, GraphicCanvasRenderer, GraphicWebGLRenderer, Grid, GridCellInfosService, GridType, HeatMap, HillshadeParameter, HitCloverShape, IManager, IManagerCreateNodeParam, IManagerServiceBase, IPortal, IPortalAddDataParam, IPortalAddResourceParam, IPortalDataConnectionInfoParam, IPortalDataMetaInfoParam, IPortalDataStoreInfoParam, IPortalQueryParam, IPortalQueryResult, IPortalRegisterServiceParam, IPortalResource, IPortalServiceBase, IPortalShareEntity, IPortalShareParam, IPortalUser, ImageCollectionService, ImageGFAspect, ImageGFHillShade, ImageGFOrtho, ImageGFSlope, ImageRenderingRule, ImageSearchParameter, ImageService, ImageStretchOption, ImageSuperMapRest, ImageTileSuperMapRest, IndexTabsPageContainer, InterpolationAlgorithmType, InterpolationAnalystParameters, InterpolationDensityAnalystParameters, InterpolationIDWAnalystParameters, InterpolationKrigingAnalystParameters, InterpolationRBFAnalystParameters, JSONFormat, JoinItem, JoinType, KernelDensityJobParameter, KeyServiceParameter, Label, LabelBackShape, LabelImageCell, LabelMatrixCell, LabelMixedTextStyle, LabelOverLengthMode, LabelSymbolCell, LabelThemeCell, Lang, LayerInfoService, LayerStatus, LayerType, LinkItem, Logo, LonLat, MapExtend, MapService, MapboxStyles, MappingParameters, Mapv, MapvCanvasLayer, MapvLayer, MathExpressionAnalysisParameters, MeasureMode, MeasureParameters, MeasureService, MessageBox, MetricsAggParameter, MetricsAggType, NDVIParameter, NavTabsPage, NetworkAnalyst3DService, NetworkAnalystService, NetworkAnalystServiceBase, Online, OnlineData, OnlineQueryDatasParameter, OnlineServiceBase, OrderBy, OrderType, OutputSetting, OutputType, OverlapDisplayedOptions, OverlayAnalystParameters, OverlayGeoJobParameter, OverlayGraphic, OverlayOperationType, PaginationContainer, PermissionType, Pixel, PixelFormat, PointWithMeasure, PopContainer, ProcessingService, ProcessingServiceBase, QueryByBoundsParameters, QueryByDistanceParameters, QueryByGeometryParameters, QueryBySQLParameters, QueryOption, QueryParameters, QueryService, Range, RangeMode, RankSymbol, RasterFunctionParameter, RasterFunctionType, ResourceType, Route, RouteCalculateMeasureParameters, RouteLocatorParameters, ScaleLine, SearchMode, SearchType, SecurityManager, Select, ServerColor, ServerFeature, ServerGeometry, ServerInfo, ServerStyle, ServerTextStyle, ServerTheme, ServerType, ServiceBase, ServiceStatus, SetDatasourceParameters, SetLayerInfoParameters, SetLayerStatusParameters, SetLayersInfoParameters, ShapeParameters, ShapeParametersCircle, ShapeParametersImage, ShapeParametersLabel, ShapeParametersLine, ShapeParametersPoint, ShapeParametersPolygon, ShapeParametersRectangle, ShapeParametersSector, SideType, SingleObjectQueryJobsParameter, Size, SmoothMethod, Sortby, SpatialAnalystBase, SpatialAnalystService, SpatialQueryMode, SpatialRelationType, StatisticAnalystMode, StatisticMode, StopQueryParameters, StyleMap, StyleUtils, SummaryAttributesJobsParameter, SummaryMeshJobParameter, SummaryRegionJobParameter, SummaryType, SuperMap, SuperMapCloud, SupplyCenter, SupplyCenterType, SurfaceAnalystMethod, SurfaceAnalystParameters, SurfaceAnalystParametersSetting, TemplateBase, TerrainCurvatureCalculationParameters, TextAlignment, Theme, ThemeDotDensity, ThemeFeature, ThemeGraduatedSymbol, ThemeGraduatedSymbolStyle, ThemeGraph, ThemeGraphAxes, ThemeGraphItem, ThemeGraphSize, ThemeGraphText, ThemeGraphTextFormat, ThemeGraphType, ThemeGridRange, ThemeGridRangeItem, ThemeGridUnique, ThemeGridUniqueItem, ThemeLabel, ThemeLabelAlongLine, ThemeLabelBackground, ThemeLabelItem, ThemeLabelText, ThemeLabelUniqueItem, ThemeMemoryData, ThemeOffset, ThemeParameters, ThemeRange, ThemeRangeItem, ThemeService, ThemeStyle, ThemeType, ThemeUnique, ThemeUniqueItem, ThiessenAnalystParameters, Tianditu, TileSuperMapRest, TimeControlBase, TimeFlowControl, TokenServiceParameter, TopologyValidatorJobsParameter, TopologyValidatorRule, TrafficTransferAnalystService, TransferLine, TransferPathParameters, TransferPreference, TransferSolutionParameters, TransferTactic, TransportationAnalystParameter, TransportationAnalystResultSetting, Turf, TurnType, UGCLayer, UGCLayerType, UGCMapLayer, UGCSubLayer, Unique, Unit, UpdateDatasetParameters, UpdateEdgeWeightParameters, UpdateTurnNodeWeightParameters, Util, VariogramMode, Vector, VectorClipJobsParameter, VectorTileStyles, VectorTileSuperMapRest, WKTFormat, WebExportFormatType, WebMap, WebPrintingJobContent, WebPrintingJobCustomItems, WebPrintingJobExportOptions, WebPrintingJobImage, WebPrintingJobLayers, WebPrintingJobLayoutOptions, WebPrintingJobLegendOptions, WebPrintingJobLittleMapOptions, WebPrintingJobNorthArrowOptions, WebPrintingJobParameters, WebPrintingJobScaleBarOptions, WebPrintingJobService, WebScaleOrientationType, WebScaleType, WebScaleUnit, conversionDegree, getMeterPerMapUnit, getWrapNum, initMap, isCORS, lineMap, lineStyle, pointMap, pointStyle, polygonMap, polygonStyle, setCORS, viewOptionsFromMapJSON

;// CONCATENATED MODULE: ./src/common/SuperMap.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
var SuperMap = window.SuperMap = window.SuperMap || {};
SuperMap.Components = window.SuperMap.Components || {};

;// CONCATENATED MODULE: ./src/common/REST.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/

 /**
 * @enum DataFormat
 * @description æå¡è¯·æ±è¿åç»ææ°æ®ç±»å
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.DataFormat.GEOJSON;
 *
 * </script>
 * // ES6 Import
 * import { DataFormat } from '{npm}';
 *
 * const result = DataFormat.GEOJSON;
 * ```
 */
var DataFormat = {
    /** GEOJSON */
    GEOJSON: "GEOJSON",
    /** ISERVER */
    ISERVER: "ISERVER"
};

/**
 * @enum ServerType
 * @description æå¡å¨ç±»å
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.ServerType.ISERVER;
 *
 * </script>
 * // ES6 Import
 * import { ServerType } from '{npm}';
 *
 * const result = ServerType.ISERVER;
 * ```
 */
var ServerType = {
    /** ISERVER */
    ISERVER: "ISERVER",
    /** IPORTAL */
    IPORTAL: "IPORTAL",
    /** ONLINE */
    ONLINE: "ONLINE"
};

/**
 * @enum GeometryType
 * @description å ä½å¯¹è±¡æä¸¾,å®ä¹äºä¸ç³»åå ä½å¯¹è±¡ç±»åã
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.GeometryType.LINE;
 *
 * </script>
 * // ES6 Import
 * import { GeometryType } from '{npm}';
 *
 * const result = GeometryType.LINE;
 * ```
 */
var GeometryType = {
    /** LINE */
    LINE: "LINE",
    /** LINEM */
    LINEM: "LINEM",
    /** POINT */
    POINT: "POINT",
    /** REGION */
    REGION: "REGION",
    /** POINTEPS */
    POINTEPS: "POINTEPS",
    /** LINEEPS */
    LINEEPS: "LINEEPS",
    /** REGIONEPS */
    REGIONEPS: "REGIONEPS",
    /** ELLIPSE */
    ELLIPSE: "ELLIPSE",
    /** CIRCLE */
    CIRCLE: "CIRCLE",
    /** TEXT */
    TEXT: "TEXT",
    /** RECTANGLE */
    RECTANGLE: "RECTANGLE",
    /** UNKNOWN */
    UNKNOWN: "UNKNOWN",
    /** GEOCOMPOUND */
    GEOCOMPOUND:"GEOCOMPOUND"
};

/**
 * @enum QueryOption
 * @description æ¥è¯¢ç»æç±»åæä¸¾,æè¿°æ¥è¯¢ç»æè¿åç±»åï¼åæ¬åªè¿åå±æ§ãåªè¿åå ä½å®ä½ä»¥åè¿åå±æ§åå ä½å®ä½ã
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.QueryOption.ATTRIBUTE;
 *
 * </script>
 * // ES6 Import
 * import { QueryOption } from '{npm}';
 *
 * const result = QueryOption.ATTRIBUTE;
 * ```
 */
var QueryOption = {
    /** å±æ§ */
    ATTRIBUTE: "ATTRIBUTE",
    /** å±æ§åå ä½å¯¹è±¡ */
    ATTRIBUTEANDGEOMETRY: "ATTRIBUTEANDGEOMETRY",
    /** å ä½å¯¹è±¡ */
    GEOMETRY: "GEOMETRY"
};

/**
 * @enum JoinType
 * @description å³èæ¥è¯¢æ¶çå³èç±»åå¸¸éã
 * è¯¥ç±»å®ä¹äºä¸¤ä¸ªè¡¨ä¹é´çè¿æ¥ç±»åå¸¸éï¼å³å®äºå¯¹ä¸¤ä¸ªè¡¨ä¹é´è¿è¡è¿æ¥æ¥è¯¢æ¶ï¼æ¥è¯¢ç»æä¸­å¾å°çè®°å½çæåµã
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.JoinType.INNERJOIN;
 *
 * </script>
 * // ES6 Import
 * import { JoinType } from '{npm}';
 *
 * const result = JoinType.INNERJOIN;
 * ```
 */
var JoinType = {
    /** åè¿æ¥ */
    INNERJOIN: "INNERJOIN",
    /** å·¦è¿æ¥ */
    LEFTJOIN: "LEFTJOIN"
};

/**
 * @enum SpatialQueryMode
 * @description  ç©ºé´æ¥è¯¢æ¨¡å¼æä¸¾ãè¯¥ç±»å®ä¹äºç©ºé´æ¥è¯¢æä½æ¨¡å¼å¸¸éã
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.SpatialQueryMode.CONTAIN;
 *
 * </script>
 * // ES6 Import
 * import { SpatialQueryMode } from '{npm}';
 *
 * const result = SpatialQueryMode.CONTAIN;
 * ```
 */
var SpatialQueryMode = {
    /** åå«ç©ºé´æ¥è¯¢æ¨¡å¼ */
    CONTAIN: "CONTAIN",
    /** äº¤åç©ºé´æ¥è¯¢æ¨¡å¼ */
    CROSS: "CROSS",
    /** åç¦»ç©ºé´æ¥è¯¢æ¨¡å¼ */
    DISJOINT: "DISJOINT",
    /** éåç©ºé´æ¥è¯¢æ¨¡å¼ */
    IDENTITY: "IDENTITY",
    /** ç¸äº¤ç©ºé´æ¥è¯¢æ¨¡å¼ */
    INTERSECT: "INTERSECT",
    /** æ ç©ºé´æ¥è¯¢ */
    NONE: "NONE",
    /** å å ç©ºé´æ¥è¯¢æ¨¡å¼ */
    OVERLAP: "OVERLAP",
    /** é»æ¥ç©ºé´æ¥è¯¢æ¨¡å¼ */
    TOUCH: "TOUCH",
    /** è¢«åå«ç©ºé´æ¥è¯¢æ¨¡å¼ */
    WITHIN: "WITHIN"
};

/**
 * @enum SpatialRelationType
 * @description  æ°æ®éå¯¹è±¡é´çç©ºé´å³ç³»æä¸¾ã
 * è¯¥ç±»å®ä¹äºæ°æ®éå¯¹è±¡é´çç©ºé´å³ç³»ç±»åå¸¸éã
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.SpatialRelationType.CONTAIN;
 *
 * </script>
 * // ES6 Import
 * import { SpatialRelationType } from '{npm}';
 *
 * const result = {namespace}.SpatialRelationType.CONTAIN;
 * ```
 */
var SpatialRelationType = {
    /** åå«å³ç³» */
    CONTAIN: "CONTAIN",
    /** ç¸äº¤å³ç³» */
    INTERSECT: "INTERSECT",
    /** è¢«åå«å³ç³» */
    WITHIN: "WITHIN"
};

/**
 * @enum MeasureMode
 * @type {string}
 * @description  éç®æ¨¡å¼æä¸¾ã
 * @category BaseTypes Constant
 * è¯¥ç±»å®ä¹äºä¸¤ç§æµéæ¨¡å¼ï¼è·ç¦»æµéåé¢ç§¯æµéã
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.MeasureMode.DISTANCE;
 *
 * </script>
 * // ES6 Import
 * import { MeasureMode } from '{npm}';
 *
 * const result = MeasureMode.DISTANCE;
 * ```
 */
var MeasureMode = {
    /** è·ç¦»æµé */
    DISTANCE: "DISTANCE",
    /** é¢ç§¯æµé */
    AREA: "AREA"
};

/**
 * @enum Unit
 * @description  è·ç¦»åä½æä¸¾ã
 * è¯¥ç±»å®ä¹äºä¸ç³»åè·ç¦»åä½ç±»åã
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.Unit.METER;
 *
 * </script>
 * // ES6 Import
 * import { Unit } from '{npm}';
 *
 * const result = Unit.METER;
 * ```
 */
var Unit = {
    /**  ç±³ */
    METER: "METER",
    /**  åç±³ */
    KILOMETER: "KILOMETER",
    /**  è±é */
    MILE: "MILE",
    /**  ç  */
    YARD: "YARD",
    /**  åº¦ */
    DEGREE: "DEGREE",
    /**  æ¯«ç±³ */
    MILLIMETER: "MILLIMETER",
    /**  åç±³ */
    CENTIMETER: "CENTIMETER",
    /**  è±å¯¸ */
    INCH: "INCH",
    /**  åç±³ */
    DECIMETER: "DECIMETER",
    /**  è±å°º */
    FOOT: "FOOT",
    /**  ç§ */
    SECOND: "SECOND",
    /**  å */
    MINUTE: "MINUTE",
    /**  å¼§åº¦ */
    RADIAN: "RADIAN"
};

/**
 * @enum BufferRadiusUnit
 * @description  ç¼å²åºè·ç¦»åä½æä¸¾ãè¯¥ç±»å®ä¹äºä¸ç³»åç¼å²è·ç¦»åä½ç±»åã
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.BufferRadiusUnit.CENTIMETER;
 *
 * </script>
 * // ES6 Import
 * import { BufferRadiusUnit } from '{npm}';
 *
 * const result = BufferRadiusUnit.CENTIMETER;
 * ```
 */
var BufferRadiusUnit = {
    /**  åç±³ */
    CENTIMETER: "CENTIMETER",
    /**  åç±³ */
    DECIMETER: "DECIMETER",
    /**  è±å°º */
    FOOT: "FOOT",
    /**  è±å¯¸ */
    INCH: "INCH",
    /**  åç±³ */
    KILOMETER: "KILOMETER",
    /**  ç±³ */
    METER: "METER",
    /**  è±é */
    MILE: "MILE",
    /**  æ¯«ç±³ */
    MILLIMETER: "MILLIMETER",
    /**  ç  */
    YARD: "YARD"
}

/**
 * @enum EngineType
 * @description  æ°æ®æºå¼æç±»åæä¸¾ã
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.EngineType.IMAGEPLUGINS;
 *
 * </script>
 * // ES6 Import
 * import { EngineType } from '{npm}';
 *
 * const result = EngineType.IMAGEPLUGINS;
 * ```
 */
var EngineType = {
    /** å½±ååªè¯»å¼æç±»åï¼æä»¶å¼æï¼éå¯¹éç¨å½±åæ ¼å¼å¦ BMPï¼JPGï¼TIFF ä»¥åè¶å¾èªå®ä¹å½±åæ ¼å¼ SIT ç­ã */
    IMAGEPLUGINS: "IMAGEPLUGINS",
    /**  OGC å¼æç±»åï¼éå¯¹äº Web æ°æ®æºï¼Web å¼æï¼ç®åæ¯æçç±»åæ WMSï¼WFSï¼WCSã */
    OGC: "OGC",
    /**  Oracle å¼æç±»åï¼éå¯¹ Oracle æ°æ®æºï¼æ°æ®åºå¼æã */
    ORACLEPLUS: "ORACLEPLUS",
    /**  SDB å¼æç±»åï¼æä»¶å¼æï¼å³ SDB æ°æ®æºã */
    SDBPLUS: "SDBPLUS",
    /**  SQL Server å¼æç±»åï¼éå¯¹ SQL Server æ°æ®æºï¼æ°æ®åºå¼æ */
    SQLPLUS: "SQLPLUS",
    /**  UDB å¼æç±»åï¼æä»¶å¼æã */
    UDB: "UDB"
};

/**
 * @enum ThemeGraphTextFormat
 * @description  ç»è®¡ä¸é¢å¾ææ¬æ¾ç¤ºæ ¼å¼æä¸¾ã
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.ThemeGraphTextFormat.CAPTION;
 *
 * </script>
 * // ES6 Import
 * import { ThemeGraphTextFormat } from '{npm}';
 *
 * const result = ThemeGraphTextFormat.CAPTION;
 * ```
 */
var ThemeGraphTextFormat = {
    /**  æ é¢ãä»¥åå­é¡¹çæ é¢æ¥è¿è¡æ æ³¨ã */
    CAPTION: "CAPTION",
    /**  æ é¢ + ç¾åæ°ãä»¥åå­é¡¹çæ é¢åæå çç¾åæ¯æ¥è¿è¡æ æ³¨ã */
    CAPTION_PERCENT: "CAPTION_PERCENT",
    /**  æ é¢ + å®éæ°å¼ãä»¥åå­é¡¹çæ é¢åçå®æ°å¼æ¥è¿è¡æ æ³¨ã */
    CAPTION_VALUE: "CAPTION_VALUE",
    /**  ç¾åæ°ãä»¥åå­é¡¹æå çç¾åæ¯æ¥è¿è¡æ æ³¨ã */
    PERCENT: "PERCENT",
    /**  å®éæ°å¼ãä»¥åå­é¡¹ççå®æ°å¼æ¥è¿è¡æ æ³¨ã */
    VALUE: "VALUE"

};

/**
 * @enum ThemeGraphType
 * @description  ç»è®¡ä¸é¢å¾ç±»åæä¸¾ã
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.ThemeGraphType.AREA;
 *
 * </script>
 * // ES6 Import
 * import { ThemeGraphType } from '{npm}';
 *
 * const result = ThemeGraphType.AREA;
 * ```
 */
var ThemeGraphType = {
    /**  é¢ç§¯å¾ã */
    AREA: "AREA",
    /**  æ±ç¶å¾ã */
    BAR: "BAR",
    /**  ä¸ç»´æ±ç¶å¾ã */
    BAR3D: "BAR3D",
    /**  æçº¿å¾ã */
    LINE: "LINE",
    /**  é¥¼å¾ã */
    PIE: "PIE",
    /**  ä¸ç»´é¥¼å¾ã */
    PIE3D: "PIE3D",
    /**  ç¹ç¶å¾ã */
    POINT: "POINT",
    /**  ç¯ç¶å¾ã */
    RING: "RING",
    /**  ç«ç°å¾ã */
    ROSE: "ROSE",
    /**  ä¸ç»´ç«ç°å¾ã */
    ROSE3D: "ROSE3D",
    /**  å å æ±ç¶å¾ã */
    STACK_BAR: "STACK_BAR",
    /**  ä¸ç»´å å æ±ç¶å¾ã */
    STACK_BAR3D: "STACK_BAR3D",
    /**  é¶æ¢¯å¾ã */
    STEP: "STEP"
};

/**
 * @enum GraphAxesTextDisplayMode
 * @description  ç»è®¡ä¸é¢å¾åæ è½´ææ¬æ¾ç¤ºæ¨¡å¼ã
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.GraphAxesTextDisplayMode.ALL;
 *
 * </script>
 * // ES6 Import
 * import { GraphAxesTextDisplayMode } from '{npm}';
 *
 * const result = GraphAxesTextDisplayMode.ALL;
 * ```
 */
var GraphAxesTextDisplayMode = {
    /**  æ¾ç¤ºå¨é¨ææ¬ã */
    ALL: "ALL",
    /**  ä¸æ¾ç¤ºã */
    NONE: "NONE",
    /**  æ¾ç¤ºYè½´çææ¬ã */
    YAXES: "YAXES"
};

/**
 * @enum GraduatedMode
 * @description  ä¸é¢å¾åçº§æ¨¡å¼æä¸¾ã
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.GraduatedMode.CONSTANT;
 *
 * </script>
 * // ES6 Import
 * import { GraduatedMode } from '{npm}';
 *
 * const result = GraduatedMode.CONSTANT;
 * ```
 */
var GraduatedMode = {
    /**  å¸¸éåçº§æ¨¡å¼ã */
    CONSTANT: "CONSTANT",
    /** å¯¹æ°åçº§æ¨¡å¼ã */
    LOGARITHM: "LOGARITHM",
    /**  å¹³æ¹æ ¹åçº§æ¨¡å¼ã */
    SQUAREROOT: "SQUAREROOT"
};

/**
 * @enum RangeMode
 * @description  èå´åæ®µä¸é¢å¾åæ®µæ¹å¼æä¸¾ã
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.RangeMode.CUSTOMINTERVAL;
 *
 * </script>
 * // ES6 Import
 * import { RangeMode } from '{npm}';
 *
 * const result = RangeMode.CUSTOMINTERVAL;
 * ```
 */
var RangeMode = {
    /**  èªå®ä¹åæ®µæ³ã */
    CUSTOMINTERVAL: "CUSTOMINTERVAL",
    /**  ç­è·ç¦»åæ®µæ³ã */
    EQUALINTERVAL: "EQUALINTERVAL",
    /**  å¯¹æ°åæ®µæ³ã */
    LOGARITHM: "LOGARITHM",
    /**  ç­è®¡æ°åæ®µæ³ã */
    QUANTILE: "QUANTILE",
    /**  å¹³æ¹æ ¹åæ®µæ³ã */
    SQUAREROOT: "SQUAREROOT",
    /**  æ åå·®åæ®µæ³ã */
    STDDEVIATION: "STDDEVIATION"
};

/**
 * @enum ThemeType
 * @description  ä¸é¢å¾ç±»åæä¸¾ã
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.ThemeType.DOTDENSITY;
 *
 * </script>
 * // ES6 Import
 * import { ThemeType } from '{npm}';
 *
 * const result = ThemeType.DOTDENSITY;
 * ```
 */
var ThemeType = {
    /** ç¹å¯åº¦ä¸é¢å¾ã */
    DOTDENSITY: "DOTDENSITY",
    /** ç­çº§ç¬¦å·ä¸é¢å¾ã */
    GRADUATEDSYMBOL: "GRADUATEDSYMBOL",
    /** ç»è®¡ä¸é¢å¾ã */
    GRAPH: "GRAPH",
    /** æ ç­¾ä¸é¢å¾ã */
    LABEL: "LABEL",
    /** åæ®µä¸é¢å¾ã */
    RANGE: "RANGE",
    /** åå¼ä¸é¢å¾ã */
    UNIQUE: "UNIQUE"
};

/**
 * @enum ColorGradientType
 * @description  æ¸åé¢è²æä¸¾ã
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.ColorGradientType.BLACK_WHITE;
 *
 * </script>
 * // ES6 Import
 * import { ColorGradientType } from '{npm}';
 *
 * const result = ColorGradientType.BLACK_WHITE;
 * ```
 */
var ColorGradientType = {
    /** é»ç½æ¸åè²ã */
    BLACK_WHITE: "BLACKWHITE",
    /** èé»æ¸åè²ã */
    BLUE_BLACK: "BLUEBLACK",
    /** èçº¢æ¸åè²ã */
    BLUE_RED: "BLUERED",
    /** èç½æ¸åè²ã */
    BLUE_WHITE: "BLUEWHITE",
    /** éé»æ¸åè²ã */
    CYAN_BLACK: "CYANBLACK",
    /** éèæ¸åè²ã */
    CYAN_BLUE: "CYANBLUE",
    /** éç»¿æ¸åè²ã */
    CYAN_GREEN: "CYANGREEN",
    /** éç½æ¸åè²ã */
    CYAN_WHITE: "CYANWHITE",
    /** ç»¿é»æ¸åè²ã */
    GREEN_BLACK: "GREENBLACK",
    /** ç»¿èæ¸åè²ã */
    GREEN_BLUE: "GREENBLUE",
    /** ç»¿æ©ç´«æ¸åè²ã */
    GREEN_ORANGE_VIOLET: "GREENORANGEVIOLET",
    /** ç»¿çº¢æ¸åè²ã */
    GREEN_RED: "GREENRED",
    /** èçº¢æ¸åè²ã */
    GREEN_WHITE: "GREENWHITE",
    /** ç²é»æ¸åè²ã */
    PINK_BLACK: "PINKBLACK",
    /** ç²èæ¸åè²ã */
    PINK_BLUE: "PINKBLUE",
    /** ç²çº¢æ¸åè²ã */
    PINK_RED: "PINKRED",
    /** ç²ç½æ¸åè²ã */
    PINK_WHITE: "PINKWHITE",
    /** å½©è¹è²ã */
    RAIN_BOW: "RAINBOW",
    /** çº¢é»æ¸åè²ã */
    RED_BLACK: "REDBLACK",
    /** çº¢ç½æ¸åè²ã */
    RED_WHITE: "REDWHITE",
    /** åè°±æ¸åã */
    SPECTRUM: "SPECTRUM",
    /** å°å½¢æ¸å,ç¨äºä¸ç»´æ¾ç¤ºææè¾å¥½ã */
    TERRAIN: "TERRAIN",
    /** é»é»æ¸åè²ã */
    YELLOW_BLACK: "YELLOWBLACK",
    /** é»èæ¸åè²ã */
    YELLOW_BLUE: "YELLOWBLUE",
    /** é»ç»¿æ¸åè²ã */
    YELLOW_GREEN: "YELLOWGREEN",
    /** é»çº¢æ¸åè²ã */
    YELLOW_RED: "YELLOWRED",
    /** é»ç½æ¸åè²ã */
    YELLOW_WHITE: "YELLOWWHITE"
};

/**
 * @enum TextAlignment
 * @description  ææ¬å¯¹é½æä¸¾ã
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.TextAlignment.TOPLEFT;
 *
 * </script>
 * // ES6 Import
 * import { TextAlignment } from '{npm}';
 *
 * const result = TextAlignment.TOPLEFT;
 * ```
 */
var TextAlignment = {
    /** å·¦ä¸è§å¯¹é½ã */
    TOPLEFT: "TOPLEFT",
    /** é¡¶é¨å±ä¸­å¯¹é½ã */
    TOPCENTER: "TOPCENTER",
    /** å³ä¸è§å¯¹é½ã */
    TOPRIGHT: "TOPRIGHT",
    /** åºåçº¿å·¦å¯¹é½ã */
    BASELINELEFT: "BASELINELEFT",
    /** åºåçº¿å±ä¸­å¯¹é½ã */
    BASELINECENTER: "BASELINECENTER",
    /** åºåçº¿å³å¯¹é½ã */
    BASELINERIGHT: "BASELINERIGHT",
    /** å·¦ä¸è§å¯¹é½ã */
    BOTTOMLEFT: "BOTTOMLEFT",
    /** åºé¨å±ä¸­å¯¹é½ã */
    BOTTOMCENTER: "BOTTOMCENTER",
    /** å³ä¸è§å¯¹é½ã */
    BOTTOMRIGHT: "BOTTOMRIGHT",
    /** å·¦ä¸­å¯¹é½ã */
    MIDDLELEFT: "MIDDLELEFT",
    /** ä¸­å¿å¯¹é½ã */
    MIDDLECENTER: "MIDDLECENTER",
    /** å³ä¸­å¯¹é½ã */
    MIDDLERIGHT: "MIDDLERIGHT"
};

/**
 * @enum FillGradientMode
 * @description  æ¸åå¡«åé£æ ¼çæ¸åç±»åæä¸¾ã
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.FillGradientMode.NONE;
 *
 * </script>
 * // ES6 Import
 * import { FillGradientMode } from '{npm}';
 *
 * const result = FillGradientMode.NONE;
 * ```
 */
var FillGradientMode = {
    /** æ æ¸åã */
    NONE: "NONE",
    /** çº¿æ§æ¸åå¡«åã */
    LINEAR: "LINEAR",
    /** è¾å°æ¸åå¡«åã */
    RADIAL: "RADIAL",
    /** åé¥æ¸åå¡«åã */
    CONICAL: "CONICAL",
    /** åè§æ¸åå¡«åã */
    SQUARE: "SQUARE"
};

/**
 * @enum AlongLineDirection
 * @description  æ ç­¾æ²¿çº¿æ æ³¨æ¹åæä¸¾ã
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.AlongLineDirection.NORMAL;
 *
 * </script>
 * // ES6 Import
 * import { AlongLineDirection } from '{npm}';
 *
 * const result = AlongLineDirection.NORMAL;
 * ```
 */
var AlongLineDirection = {
    /** æ²¿çº¿çæ³çº¿æ¹åæ¾ç½®æ ç­¾ã */
    NORMAL: "ALONG_LINE_NORMAL",
    /** ä»ä¸å°ä¸ï¼ä»å·¦å°å³æ¾ç½®ã */
    LB_TO_RT: "LEFT_BOTTOM_TO_RIGHT_TOP",
    /** ä»ä¸å°ä¸ï¼ä»å·¦å°å³æ¾ç½®ã */
    LT_TO_RB: "LEFT_TOP_TO_RIGHT_BOTTOM",
    /** ä»ä¸å°ä¸ï¼ä»å³å°å·¦æ¾ç½®ã */
    RB_TO_LT: "RIGHT_BOTTOM_TO_LEFT_TOP",
    /** ä»ä¸å°ä¸ï¼ä»å³å°å·¦æ¾ç½®ã */
    RT_TO_LB: "RIGHT_TOP_TO_LEFT_BOTTOM"
};

/**
 * @enum LabelBackShape
 * @description  æ ç­¾ä¸é¢å¾ä¸­æ ç­¾èæ¯çå½¢ç¶æä¸¾ã
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.LabelBackShape.DIAMOND;
 *
 * </script>
 * // ES6 Import
 * import { LabelBackShape } from '{npm}';
 *
 * const result = LabelBackShape.DIAMOND;
 * ```
 */
var LabelBackShape = {
    /** è±å½¢èæ¯ï¼å³æ ç­¾èæ¯çå½¢ç¶ä¸ºè±å½¢ã */
    DIAMOND: "DIAMOND",
    /** æ¤­åå½¢èæ¯ï¼å³æ ç­¾èæ¯çè¡ç¶ä¸ºæ¤­åå½¢ã */
    ELLIPSE: "ELLIPSE",
    /** ç¬¦å·èæ¯ï¼å³æ ç­¾èæ¯çå½¢ç¶ä¸ºè®¾å®çç¬¦å·ã */
    MARKER: "MARKER",
    /** ç©ºèæ¯ï¼å³ä¸ä½¿ç¨ä»»ä½å½¢ç¶ä½ä¸ºæ ç­¾çèæ¯ã */
    NONE: "NONE",
    /** ç©å½¢èæ¯ï¼å³æ ç­¾èæ¯çå½¢ç¶ä¸ºç©å½¢ã */
    RECT: "RECT",
    /** åè§ç©å½¢èæ¯ï¼å³æ ç­¾èæ¯çå½¢ç¶ä¸ºåè§ç©å½¢ã */
    ROUNDRECT: "ROUNDRECT",
    /** ä¸è§å½¢èæ¯ï¼å³æ ç­¾èæ¯çå½¢ç¶ä¸ºä¸è§å½¢ã */
    TRIANGLE: "TRIANGLE"
};

/**
 * @enum LabelOverLengthMode
 * @description  æ ç­¾ä¸é¢å¾ä¸­è¶é¿æ ç­¾çå¤çæ¨¡å¼æä¸¾ã
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.LabelOverLengthMode.NEWLINE;
 *
 * </script>
 * // ES6 Import
 * import { LabelOverLengthMode } from '{npm}';
 *
 * const result = LabelOverLengthMode.NEWLINE;
 * ```
 */
var LabelOverLengthMode = {
    /** æ¢è¡æ¾ç¤ºã */
    NEWLINE: "NEWLINE",
    /** å¯¹è¶é¿æ ç­¾ä¸è¿è¡å¤çã */
    NONE: "NONE",
    /** çç¥è¶åºé¨åã */
    OMIT: "OMIT"
};

/**
 * @enum DirectionType
 * @description  ç½ç»åæä¸­æ¹åæä¸¾ã
 * å¨è¡é©¶å¼å¯¼å­é¡¹ä¸­ä½¿ç¨ã
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.DirectionType.EAST;
 *
 * </script>
 * // ES6 Import
 * import { DirectionType } from '{npm}';
 *
 * const result = DirectionType.EAST;
 * ```
 */
var DirectionType = {
    /** ä¸ã */
    EAST: "EAST",
    /** æ æ¹åã */
    NONE: "NONE",
    /** åã */
    NORTH: "NORTH",
    /** åã */
    SOURTH: "SOURTH",
    /** è¥¿ã */
    WEST: "WEST"
};

/**
 * @enum SideType
 * @description  è¡é©¶ä½ç½®æä¸¾ã
 * è¡¨ç¤ºå¨è¡é©¶å¨è·¯çå·¦è¾¹ãå³è¾¹æèè·¯ä¸çæä¸¾,è¯¥ç±»ç¨å¨è¡é©¶å¯¼å¼å­é¡¹ç±»ä¸­ã
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.SideType.LEFT;
 *
 * </script>
 * // ES6 Import
 * import { SideType } from '{npm}';
 *
 * const result = SideType.LEFT;
 * ```
 */
var SideType = {
    /** è·¯çå·¦ä¾§ã */
    LEFT: "LEFT",
    /** å¨è·¯ä¸ï¼å³è·¯çä¸­é´ï¼ã */
    MIDDLE: "MIDDLE",
    /** æ æå¼ã */
    NONE: "NONE",
    /** è·¯çå³ä¾§ã */
    RIGHT: "RIGHT"
};

/**
 * @enum SupplyCenterType
 * @description  èµæºä¾ç»ä¸­å¿ç±»åæä¸¾ã
 * è¯¥æä¸¾å®ä¹äºç½ç»åæä¸­èµæºä¸­å¿ç¹çç±»åï¼ä¸»è¦ç¨äºèµæºåéåéåååºã
 * èµæºä¾ç»ä¸­å¿ç¹çç±»ååæ¬éä¸­å¿ï¼åºå®ä¸­å¿åå¯éä¸­å¿ãåºå®ä¸­å¿ç¨äºèµæºåéåæï¼ åºå®ä¸­å¿åå¯éä¸­å¿ç¨äºéååæï¼éä¸­å¿å¨ä¸¤ç§ç½ç»åææ¶é½ä¸äºèèã
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.SupplyCenterType.FIXEDCENTER;
 *
 * </script>
 * // ES6 Import
 * import { SupplyCenterType } from '{npm}';
 *
 * const result = SupplyCenterType.FIXEDCENTER;
 * ```
 */
var SupplyCenterType = {
    /** åºå®ä¸­å¿ç¹ã */
    FIXEDCENTER: "FIXEDCENTER",
    /** éä¸­å¿ç¹ã */
    NULL: "NULL",
    /** å¯éä¸­å¿ç¹ã */
    OPTIONALCENTER: "OPTIONALCENTER"
};

/**
 * @enum TurnType
 * @description  è½¬å¼¯æ¹åæä¸¾ã
 * ç¨å¨è¡é©¶å¼å¯¼å­é¡¹ç±»ä¸­ï¼è¡¨ç¤ºè½¬å¼¯çæ¹åã
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.TurnType.AHEAD;
 *
 * </script>
 * // ES6 Import
 * import { TurnType } from '{npm}';
 *
 * const result = TurnType.AHEAD;
 * ```
 */
var TurnType = {
    /** ååç´è¡ã */
    AHEAD: "AHEAD",
    /** æå¤´ã */
    BACK: "BACK",
    /** ç»ç¹ï¼ä¸æå¼¯ã */
    END: "END",
    /** å·¦è½¬å¼¯ã */
    LEFT: "LEFT",
    /** æ æå¼ã */
    NONE: "NONE",
    /** å³è½¬å¼¯ã */
    RIGHT: "RIGHT"
};

/**
 * @enum BufferEndType
 * @description  ç¼å²åºåæBufferEndç±»åã
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.BufferEndType.FLAT;
 *
 * </script>
 * // ES6 Import
 * import { BufferEndType } from '{npm}';
 *
 * const result = BufferEndType.FLAT;
 * ```
 */
var BufferEndType = {
    /** FLAT */
    FLAT: "FLAT",
    /** ROUND */
    ROUND: "ROUND"
};
/**
 * @enum OverlayOperationType
 * @description  å å åæç±»åæä¸¾ã
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.OverlayOperationType.CLIP;
 *
 * </script>
 * // ES6 Import
 * import { OverlayOperationType } from '{npm}';
 *
 * const result = OverlayOperationType.CLIP;
 * ```
 */
 var OverlayOperationType = {
    /** æä½æ°æ®éï¼å ä½å¯¹è±¡ï¼è£åªè¢«æä½æ°æ®éï¼å ä½å¯¹è±¡ï¼ã */
    CLIP: "CLIP",
    /** å¨è¢«æä½æ°æ®éï¼å ä½å¯¹è±¡ï¼ä¸æ¦é¤æä¸æä½æ°æ®éï¼å ä½å¯¹è±¡ï¼ç¸éåçé¨åã */
    ERASE: "ERASE",
    /**å¯¹è¢«æä½æ°æ®éï¼å ä½å¯¹è±¡ï¼è¿è¡åä¸æä½ï¼å³æä½æ§è¡åï¼è¢«æä½æ°æ®éï¼å ä½å¯¹è±¡ï¼åå«æ¥èªæä½æ°æ®éï¼å ä½å¯¹è±¡ï¼çå ä½å½¢ç¶ã */
    IDENTITY: "IDENTITY",
    /** å¯¹ä¸¤ä¸ªæ°æ®éï¼å ä½å¯¹è±¡ï¼æ±äº¤ï¼è¿åä¸¤ä¸ªæ°æ®éï¼å ä½å¯¹è±¡ï¼çäº¤éã */
    INTERSECT: "INTERSECT",
    /** å¯¹ä¸¤ä¸ªé¢æ°æ®éï¼å ä½å¯¹è±¡ï¼è¿è¡åå¹¶æä½ã */
    UNION: "UNION",
    /** å¯¹ä¸¤ä¸ªé¢æ°æ®éï¼å ä½å¯¹è±¡ï¼è¿è¡æ´æ°æä½ã */
    UPDATE: "UPDATE",
    /** å¯¹ä¸¤ä¸ªé¢æ°æ®éï¼å ä½å¯¹è±¡ï¼è¿è¡å¯¹ç§°å·®æä½ã */
    XOR: "XOR"
};

/**
 * @enum OutputType
 * @description  åå¸å¼åæè¾åºç±»åæä¸¾ã
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.OutputType.INDEXEDHDFS;
 *
 * </script>
 * // ES6 Import
 * import { OutputType } from '{npm}';
 *
 * const result = OutputType.INDEXEDHDFS;
 * ```
 */
var OutputType =  {
    /** INDEXEDHDFS */
    INDEXEDHDFS: "INDEXEDHDFS",
    /** UDB */
    UDB: "UDB",
    /** MONGODB */
    MONGODB: "MONGODB",
    /** PG */
    PG: "PG"
};

/**
 * @enum SmoothMethod
 * @description  åæ»æ¹æ³æä¸¾ã
 * ç¨äºä»Grid æDEMæ°æ®çæç­å¼çº¿æç­å¼é¢æ¶å¯¹ç­å¼çº¿æèç­å¼é¢çè¾¹ççº¿è¿è¡å¹³æ»å¤ççæ¹æ³ã
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.SmoothMethod.BSPLINE;
 *
 * </script>
 * // ES6 Import
 * import { SmoothMethod } from '{npm}';
 *
 * const result = SmoothMethod.BSPLINE;
 * ```
 */
 var SmoothMethod = {
    /** B æ ·æ¡æ³ã */
    BSPLINE: "BSPLINE",
    /** ç£¨è§æ³ã */
    POLISH: "POLISH"
};

/**
 * @enum SurfaceAnalystMethod
 * @description  è¡¨é¢åææ¹æ³æä¸¾ã
 * éè¿å¯¹æ°æ®è¿è¡è¡¨é¢åæï¼è½å¤ææåå§æ°æ®æåå«çä¿¡æ¯ï¼ä½¿æäºç»èææ¾åï¼æäºåæã
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.SurfaceAnalystMethod.ISOLINE;
 *
 * </script>
 * // ES6 Import
 * import { SurfaceAnalystMethod } from '{npm}';
 *
 * const result = SurfaceAnalystMethod.ISOLINE;
 * ```
 */
var SurfaceAnalystMethod = {
    /** ç­å¼çº¿æåã */
    ISOLINE: "ISOLINE",
    /** ç­å¼é¢æåã */
    ISOREGION: "ISOREGION"
};

/**
 * @enum DataReturnMode
 * @description  æ°æ®è¿åæ¨¡å¼æä¸¾ã
 * è¯¥æä¸¾ç¨äºæå®ç©ºé´åæè¿åç»ææ¨¡å¼,åå«è¿åæ°æ®éæ è¯åè®°å½éãåªè¿åæ°æ®éæ è¯(æ°æ®éåç§°@æ°æ®æºåç§°)ååªè¿åè®°å½éä¸ç§æ¨¡å¼ã
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.DataReturnMode.DATASET_AND_RECORDSET;
 *
 * </script>
 * // ES6 Import
 * import { DataReturnMode } from '{npm}';
 *
 * const result = DataReturnMode.DATASET_AND_RECORDSET;
 * ```
 */
var DataReturnMode = {
    /** è¿åç»ææ°æ®éæ è¯(æ°æ®éåç§°@æ°æ®æºåç§°)åè®°å½éï¼RecordSetï¼ã */
    DATASET_AND_RECORDSET: "DATASET_AND_RECORDSET",
    /** åªè¿åæ°æ®éæ è¯ï¼æ°æ®éåç§°@æ°æ®æºåç§°ï¼ã */
    DATASET_ONLY: "DATASET_ONLY",
    /** åªè¿åè®°å½éï¼RecordSetï¼ã */
    RECORDSET_ONLY: "RECORDSET_ONLY"
};

/**
 * @enum EditType
 * @description  è¦ç´ éæ´æ°æ¨¡å¼æä¸¾ã
 * è¯¥æä¸¾ç¨äºæå®æ°æ®æå¡ä¸­è¦ç´ éæ´æ°æ¨¡å¼,åå«æ·»å è¦ç´ éãæ´æ°è¦ç´ éåå é¤è¦ç´ éã
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.EditType.ADD;
 *
 * </script>
 * // ES6 Import
 * import { EditType } from '{npm}';
 *
 * const result = {namespace}.EditType.ADD;
 * ```
 */
var EditType = {
    /** å¢å æä½ã */
    ADD: "add",
    /** ä¿®æ¹æä½ã */
    UPDATE: "update",
    /** å é¤æä½ã */
    DELETE: "delete"
};

/**
 * @enum TransferTactic
 * @description  å¬äº¤æ¢ä¹ç­ç¥æä¸¾ã
 * è¯¥æä¸¾ç¨äºæå®å¬äº¤æå¡ä¸­è¦ç´ éæ´æ°æ¨¡å¼,åå«æ·»å è¦ç´ éãæ´æ°è¦ç´ éåå é¤è¦ç´ éã
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.TransferTactic.LESS_TIME;
 *
 * </script>
 * // ES6 Import
 * import { TransferTactic } from '{npm}';
 *
 * const result = TransferTactic.LESS_TIME;
 * ```
 */
var TransferTactic = {
    /** æ¶é´ç­ã */
    LESS_TIME: "LESS_TIME",
    /** å°æ¢ä¹ã */
    LESS_TRANSFER: "LESS_TRANSFER",
    /** å°æ­¥è¡ã */
    LESS_WALK: "LESS_WALK",
    /** è·ç¦»æç­ã */
    MIN_DISTANCE: "MIN_DISTANCE"
};

/**
 * @enum TransferPreference
 * @description  å¬äº¤æ¢ä¹ç­ç¥æä¸¾ã
 * è¯¥æä¸¾ç¨äºæå®äº¤éæ¢ä¹æå¡ä¸­è®¾ç½®å°éä¼åãå¬äº¤ä¼åãä¸ä¹å°éãæ åå¥½ç­åå¥½è®¾ç½®ã
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.TransferPreference.BUS;
 *
 * </script>
 * // ES6 Import
 * import { TransferPreference } from '{npm}';
 *
 * const result = TransferPreference.BUS;
 * ```
 */
var TransferPreference = {
    /** å¬äº¤æ±½è½¦ä¼åã */
    BUS: "BUS",
    /** å°éä¼åã */
    SUBWAY: "SUBWAY",
    /** ä¸ä¹åå°éã */
    NO_SUBWAY: "NO_SUBWAY",
    /** æ ä¹è½¦åå¥½ã */
    NONE: "NONE"
};

/**
 * @enum GridType
 * @description  å°å¾èæ¯æ ¼ç½ç±»åæä¸¾ã
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.GridType.CROSS;
 *
 * </script>
 * // ES6 Import
 * import { GridType } from '{npm}';
 *
 * const result = GridType.CROSS;
 * ```
 */
var GridType =  {
    /** åå­åä¸ã */
    CROSS: "CROSS",
    /** ç½æ ¼çº¿ã */
    GRID: "GRID",
    /** ç¹ã */
    POINT: "POINT"
};

/**
 * @enum ColorSpaceType
 * @description  è²å½©ç©ºé´æä¸¾ã
 * ç±äºæè²åççä¸åï¼å³å®äºæ¾ç¤ºå¨ãæå½±ä»ªè¿ç±»é è²åç´æ¥åæé¢è²çé¢è²è®¾å¤åæå°æºã
 * å°å·æºè¿ç±»é ä½¿ç¨é¢æçå°å·è®¾å¤å¨çæé¢è²æ¹å¼ä¸çåºå«ã
 * éå¯¹ä¸è¿°ä¸åæè²æ¹å¼ï¼SuperMap æä¾ä¸¤ç§è²å½©ç©ºé´ï¼
 * åå«ä¸º RGB å CMYKãRGB ä¸»è¦ç¨äºæ¾ç¤ºç³»ç»ä¸­ï¼CMYK ä¸»è¦ç¨äºå°å·ç³»ç»ä¸­ã
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.ColorSpaceType.CMYK;
 *
 * </script>
 * // ES6 Import
 * import { ColorSpaceType } from '{npm}';
 *
 * const result = ColorSpaceType.CMYK;
 * ```
 */
var ColorSpaceType = {
    /** è¯¥ç±»åä¸»è¦å¨å°å·ç³»ç»ä½¿ç¨ã */
    CMYK: "CMYK",
    /** è¯¥ç±»åä¸»è¦å¨æ¾ç¤ºç³»ç»ä¸­ä½¿ç¨ã */
    RGB: "RGB"
};

/**
 * @enum LayerType
 * @description  å¾å±ç±»åã
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.LayerType.UGC;
 *
 * </script>
 * // ES6 Import
 * import { LayerType } from '{npm}';
 *
 * const result = LayerType.UGC;
 * ```
 */
var LayerType = {
    /** SuperMap UGC ç±»åå¾å±ãå¦ç¢éå¾å±ãæ æ ¼(Grid)å¾å±ãå½±åå¾å±ã */
    UGC: "UGC",
    /** WMS å¾å±ã */
    WMS: "WMS",
    /** WFS å¾å±ã */
    WFS: "WFS",
    /** èªå®ä¹å¾å±ã */
    CUSTOM: "CUSTOM"
};

/**
 * @enum UGCLayerType
 * @description  SuperMap å¾å±ç±»åã
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.UGCLayerType.THEME;
 *
 * </script>
 * // ES6 Import
 * import { UGCLayerType } from '{npm}';
 *
 * const result = UGCLayerType.THEME;
 * ```
 */
var UGCLayerType = {
    /** ä¸é¢å¾å±ã */
    THEME: "THEME",
    /** ç¢éå¾å±ã */
    VECTOR: "VECTOR",
    /** æ æ ¼å¾å±ãã */
    GRID: "GRID",
    /** å½±åå¾å±ã */
    IMAGE: "IMAGE"
};

/**
 * @enum StatisticMode
 * @description  å­æ®µç»è®¡æ¹æ³ç±»åã
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.StatisticMode.AVERAGE;
 *
 * </script>
 * // ES6 Import
 * import { StatisticMode } from '{npm}';
 *
 * const result = StatisticMode.AVERAGE;
 * ```
 */
var StatisticMode = {
    /** ç»è®¡æéå­æ®µçå¹³åå¼ã */
    AVERAGE: "AVERAGE",
    /** ç»è®¡æéå­æ®µçæå¤§å¼ã */
    MAX: "MAX",
    /** ç»è®¡æéå­æ®µçæå°å¼ã */
    MIN: "MIN",
    /** ç»è®¡æéå­æ®µçæ åå·® */
    STDDEVIATION: "STDDEVIATION",
    /** ç»è®¡æéå­æ®µçæ»åã */
    SUM: "SUM",
    /** ç»è®¡æéå­æ®µçæ¹å·®ã */
    VARIANCE: "VARIANCE"
};

/**
 * @enum PixelFormat
 * @description  æ æ ¼ä¸å½±åæ°æ®å­å¨çåç´ æ ¼å¼æä¸¾ã
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.PixelFormat.BIT16;
 *
 * </script>
 * // ES6 Import
 * import { PixelFormat } from '{npm}';
 *
 * const result = PixelFormat.BIT16;
 * ```
 */
var PixelFormat = {
    /** æ¯ä¸ªååç¨16ä¸ªæ¯ç¹(å³2ä¸ªå­è)è¡¨ç¤ºã */
    BIT16: "BIT16",
    /** æ¯ä¸ªååç¨32ä¸ªæ¯ç¹(å³4ä¸ªå­è)è¡¨ç¤ºã */
    BIT32: "BIT32",
    /** æ¯ä¸ªååç¨64ä¸ªæ¯ç¹(å³8ä¸ªå­è)è¡¨ç¤ºï¼åªæä¾ç»æ æ ¼æ°æ®éä½¿ç¨ã */
    BIT64: "BIT64",
    /** æ¯ä¸ªååç¨4ä¸ªå­èæ¥è¡¨ç¤ºï¼åªæä¾ç»æ æ ¼æ°æ®éä½¿ç¨ã */
    SINGLE: "SINGLE",
    /** æ¯ä¸ªååç¨8ä¸ªå­èæ¥è¡¨ç¤ºï¼åªæä¾ç»æ æ ¼æ°æ®éä½¿ç¨ã */
    DOUBLE: "DOUBLE",
    /** æ¯ä¸ªååç¨1ä¸ªæ¯ç¹è¡¨ç¤ºã */
    UBIT1: "UBIT1",
    /** æ¯ä¸ªååç¨4ä¸ªæ¯ç¹æ¥è¡¨ç¤ºã */
    UBIT4: "UBIT4",
    /** æ¯ä¸ªååç¨8ä¸ªæ¯ç¹(å³1ä¸ªå­è)æ¥è¡¨ç¤ºã */
    UBIT8: "UBIT8",
    /** æ¯ä¸ªååç¨24ä¸ªæ¯ç¹(å³3ä¸ªå­è)æ¥è¡¨ç¤ºã */
    UBIT24: "UBIT24",
    /** æ¯ä¸ªååç¨32ä¸ªæ¯ç¹(å³4ä¸ªå­è)æ¥è¡¨ç¤ºã */
    UBIT32: "UBIT32"
};

/**
 * @enum SearchMode
 * @description  åææ¶ä½¿ç¨çæ ·æ¬ç¹çæ¥æ¾æ¹å¼æä¸¾
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.SearchMode.KDTREE_FIXED_COUNT;
 *
 * </script>
 * // ES6 Import
 * import { SearchMode } from '{npm}';
 *
 * const result = SearchMode.KDTREE_FIXED_COUNT;
 * ```
 */
var SearchMode = {
    /** ä½¿ç¨ KDTREE çåºå®ç¹æ°æ¹å¼æ¥æ¾åä¸åæåæçç¹ã */
    KDTREE_FIXED_COUNT: "KDTREE_FIXED_COUNT",
    /** ä½¿ç¨ KDTREE çå®é¿æ¹å¼æ¥æ¾åä¸åæåæçç¹ã */
    KDTREE_FIXED_RADIUS: "KDTREE_FIXED_RADIUS",
    /** ä¸è¿è¡æ¥æ¾ï¼ä½¿ç¨ææçè¾å¥ç¹è¿è¡åæåæã */
    NONE: "NONE",
    /** ä½¿ç¨ QUADTREE æ¹å¼æ¥æ¾åä¸åæåæçç¹ï¼ä»å¯¹æ ·æ¡ï¼RBFï¼æå¼åæ®éååéï¼Krigingï¼æç¨ã */
    QUADTREE: "QUADTREE"
};

/**
 * @enum InterpolationAlgorithmType
 * @description  æå¼åæçç®æ³çç±»å
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.InterpolationAlgorithmType.KRIGING;
 *
 * </script>
 * // ES6 Import
 * import { InterpolationAlgorithmType } from '{npm}';
 *
 * const result = InterpolationAlgorithmType.KRIGING;
 * ```
 */
var InterpolationAlgorithmType = {
    /** æ®éååéæå¼æ³ã */
    KRIGING: "KRIGING",
    /** ç®åååéæå¼æ³ã */
    SimpleKriging: "SimpleKriging",
    /** æ³ååéæå¼æ³ã */
    UniversalKriging: "UniversalKriging"
};

/**
 * @enum VariogramMode
 * @description  ååéï¼Krigingï¼æå¼æ¶çååå½æ°ç±»åæä¸¾
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.VariogramMode.EXPONENTIAL;
 *
 * </script>
 * // ES6 Import
 * import { VariogramMode } from '{npm}';
 *
 * const result = VariogramMode.EXPONENTIAL;
 * ```
 */
var VariogramMode = {
    /** ææ°å½æ°ã */
    EXPONENTIAL: "EXPONENTIAL",
    /** é«æ¯å½æ°ã */
    GAUSSIAN: "GAUSSIAN",
    /** çåå½æ°ã */
    SPHERICAL: "SPHERICAL"
};

/**
 * @enum Exponent
 * @description  å®ä¹äºæ³ååéï¼UniversalKrigingï¼æå¼æ¶æ ·ç¹æ°æ®ä¸­è¶å¿é¢æ¹ç¨çé¶æ°
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.Exponent.EXP1;
 *
 * </script>
 * // ES6 Import
 * import { Exponent } from '{npm}';
 *
 * const result = Exponent.EXP1;
 * ```
 */
var Exponent = {
    /** é¶æ°ä¸º1ã */
    EXP1: "EXP1",
    /** é¶æ°ä¸º2ã */
    EXP2: "EXP2"
};

/**
 * @enum ClientType
 * @description tokenç³è¯·çå®¢æ·ç«¯æ è¯ç±»å
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.ClientType.IP;
 *
 * </script>
 * // ES6 Import
 * import { ClientType } from '{npm}';
 *
 * const result = ClientType.IP;
 * ```
 */
var ClientType = {
    /** æå®ç IP å°åã */
    IP: "IP",
    /** æå®ç URLã */
    REFERER: "Referer",
    /** åéç³è¯·ä»¤çè¯·æ±çå®¢æ·ç«¯ IPã */
    REQUESTIP: "RequestIP",
    /** ä¸åä»»ä½éªè¯ã */
    NONE: "NONE",
    /** SERVERã */
    SERVER: "SERVER",
    /** WEBã */
    WEB: "WEB"
};

/**
 * @enum ChartType
 * @description å®¢æ·ç«¯ä¸é¢å¾å¾è¡¨ç±»å
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.ChartType.BAR;
 *
 * </script>
 * // ES6 Import
 * import { ChartType } from '{npm}';
 *
 * const result = ChartType.BAR;
 * ```
 */
var ChartType = {
    /** æ±ç¶å¾ã */
    BAR: "Bar",
    /** ä¸ç»´æ±ç¶å¾ã */
    BAR3D: "Bar3D",
    /** åå½¢å¾ã */
    CIRCLE: "Circle",
    /** é¥¼å¾ã */
    PIE: "Pie",
    /** æ£ç¹å¾ã */
    POINT: "Point",
    /** æçº¿å¾ã */
    LINE: "Line",
    /** ç¯ç¶å¾ã */
    RING: "Ring"
};

/**
 * @enum ClipAnalystMode
 * @description  è£åªåææ¨¡å¼
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.ClipAnalystMode.CLIP;
 *
 * </script>
 * // ES6 Import
 * import { ClipAnalystMode } from '{npm}';
 *
 * const result = ClipAnalystMode.CLIP;
 * ```
 */
var ClipAnalystMode = {
    /** CLIPã */
    CLIP: "clip",
    /** INTERSECTã */
    INTERSECT: "intersect"
};

/**
 * @enum AnalystAreaUnit
 * @description åå¸å¼åæé¢ç§¯åä½
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.AnalystAreaUnit.SQUAREMETER;
 *
 * </script>
 * // ES6 Import
 * import { AnalystAreaUnit } from '{npm}';
 *
 * const result = AnalystAreaUnit.SQUAREMETER;
 * ```
 */
var AnalystAreaUnit = {
    /** å¹³æ¹ç±³ã */
    "SQUAREMETER": "SquareMeter",
    /** å¹³æ¹åç±³ã */
    "SQUAREKILOMETER": "SquareKiloMeter",
    /** å¬é¡·ã */
    "HECTARE": "Hectare",
    /** å¬äº©ã */
    "ARE": "Are",
    /** è±äº©ã */
    "ACRE": "Acre",
    /** å¹³æ¹è±å°ºã */
    "SQUAREFOOT": "SquareFoot",
    /** å¹³æ¹ç ã */
    "SQUAREYARD": "SquareYard",
    /** å¹³æ¹è±éã */
    "SQUAREMILE": "SquareMile"
};

/**
 * @enum AnalystSizeUnit
 * @description åå¸å¼åæåä½
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.AnalystSizeUnit.METER;
 *
 * </script>
 * // ES6 Import
 * import { AnalystSizeUnit } from '{npm}';
 *
 * const result = AnalystSizeUnit.METER;
 * ```
 */
var AnalystSizeUnit = {
    /** ç±³ã */
    "METER": "Meter",
    /** åç±³ã */
    "KILOMETER": "Kilometer",
    /** ç ã */
    "YARD": "Yard",
    /** è±å°ºã */
    "FOOT": "Foot",
    /** è±éã */
    "MILE": "Mile"
};

/**
 * @enum StatisticAnalystMode
 * @description åå¸å¼åæç»è®¡æ¨¡å¼
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.StatisticAnalystMode.MAX;
 *
 * </script>
 * // ES6 Import
 * import { StatisticAnalystMode } from '{npm}';
 *
 * const result = StatisticAnalystMode.MAX;
 * ```
 */
var StatisticAnalystMode = {
    /** ç»è®¡æéå­æ®µçæå¤§å¼ã */
    "MAX": "max",
    /** ç»è®¡æéå­æ®µçæå°å¼ã */
    "MIN": "min",
    /** ç»è®¡æéå­æ®µçå¹³åå¼ã */
    "AVERAGE": "average",
    /** ç»è®¡æéå­æ®µçæ»åã */
    "SUM": "sum",
    /** ç»è®¡æéå­æ®µçæ¹å·®ã */
    "VARIANCE": "variance",
    /** ç»è®¡æéå­æ®µçæ åå·® */
    "STDDEVIATION": "stdDeviation"
};

/**
 * @enum SummaryType
 * @description åå¸å¼åæèåç±»å
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.SummaryType.SUMMARYMESH;
 *
 * </script>
 * // ES6 Import
 * import { SummaryType } from '{npm}';
 *
 * const result = SummaryType.SUMMARYMESH;
 * ```
 */
var SummaryType = {
    /** æ ¼ç½èåã */
    "SUMMARYMESH": "SUMMARYMESH",
    /** å¤è¾¹å½¢èåã */
    "SUMMARYREGION": "SUMMARYREGION"
};

/**
 * @enum TopologyValidatorRule
 * @description  æææ£æ¥æ¨¡å¼æä¸¾ãè¯¥ç±»å®ä¹äºæææ£æ¥æä½æ¨¡å¼å¸¸éã
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.TopologyValidatorRule.REGIONNOOVERLAP;
 *
 * </script>
 * // ES6 Import
 * import { TopologyValidatorRule } from '{npm}';
 *
 * const result = TopologyValidatorRule.REGIONNOOVERLAP;
 * ```
 */
var TopologyValidatorRule = {
    /** é¢åæ éå ï¼ç¨äºå¯¹é¢æ°æ®è¿è¡æææ£æ¥ã */
    REGIONNOOVERLAP: "REGIONNOOVERLAP",
    /** é¢ä¸é¢æ éå ï¼ç¨äºå¯¹é¢æ°æ®è¿è¡æææ£æ¥ã */
    REGIONNOOVERLAPWITH: "REGIONNOOVERLAPWITH",
    /** é¢è¢«é¢åå«ï¼ç¨äºå¯¹é¢æ°æ®è¿è¡æææ£æ¥ã */
    REGIONCONTAINEDBYREGION: "REGIONCONTAINEDBYREGION",
    /** é¢è¢«é¢è¦çï¼ç¨äºå¯¹é¢æ°æ®è¿è¡æææ£æ¥ã */
    REGIONCOVEREDBYREGION: "REGIONCOVEREDBYREGION",
    /** çº¿ä¸çº¿æ éå ï¼ç¨äºå¯¹çº¿æ°æ®è¿è¡æææ£æ¥ã */
    LINENOOVERLAP: "LINENOOVERLAP",
    /** çº¿åæ éå ï¼ç¨äºå¯¹çº¿æ°æ®è¿è¡æææ£æ¥ã */
    LINENOOVERLAPWITH: "LINENOOVERLAPWITH",
    /** ç¹ä¸ç¸åï¼ç¨äºå¯¹ç¹æ°æ®è¿è¡æææ£æ¥ã */
    POINTNOIDENTICAL: "POINTNOIDENTICAL"
};

/**
 * @enum BucketAggType
 * @description  æ ¼ç½èåæ¥è¯¢æä¸¾ç±»ï¼è¯¥ç±»å®ä¹äºElasticsearchæ°æ®æå¡ä¸­èåæ¥è¯¢æ¨¡å¼å¸¸é
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.BucketAggType.GEOHASH_GRID;
 *
 * </script>
 * // ES6 Import
 * import { BucketAggType } from '{npm}';
 *
 * const result = BucketAggType.GEOHASH_GRID;
 * ```
 */
var BucketAggType = {
    /** æ ¼ç½èåç±»å */
    GEOHASH_GRID: "geohash_grid"
};

/**
 * @enum MetricsAggType
 * @description  ææ èåç±»åæä¸¾ç±»ï¼è¯¥ç±»å®ä¹äºElasticsearchæ°æ®æå¡ä¸­èåæ¥è¯¢æ¨¡å¼å¸¸é
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.MetricsAggType.AVG;
 *
 * </script>
 * // ES6 Import
 * import { MetricsAggType } from '{npm}';
 *
 * const result = MetricsAggType.AVG;
 * ```
 */
var MetricsAggType = {
  /** å¹³åå¼èåç±»å */
  AVG:'avg',
  /** æå¤§å¼èåç±»å */
  MAX:'max',
  /** æå°å¼èåç±»å */
  MIN:'min',
  /** æ±åèåç±»å */
  SUM:'sum'
};

/**
 * @enum GetFeatureMode
 * @description feature æ¥è¯¢æ¹å¼ã
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.GetFeatureMode.BOUNDS;
 *
 * </script>
 * // ES6 Import
 * import { GetFeatureMode } from '{npm}';
 *
 * const result = GetFeatureMode.BOUNDS;
 * ```
 */
var GetFeatureMode = {
    /** éè¿èå´æ¥è¯¢æ¥è·åè¦ç´ ã */
    BOUNDS: "BOUNDS",
    /** éè¿å ä½å¯¹è±¡çç¼å²åºæ¥è·åè¦ç´ ã */
    BUFFER: "BUFFER",
    /** éè¿ ID æ¥è·åè¦ç´ ã */
    ID: "ID",
    /** éè¿ç©ºé´æ¥è¯¢æ¨¡å¼æ¥è·åè¦ç´ ã */
    SPATIAL: "SPATIAL",
    /** éè¿ SQL æ¥è¯¢æ¥è·åè¦ç´ ã */
    SQL: 'SQL'
}

/**
 * @enum RasterFunctionType
 * @description æ æ ¼åææ¹æ³ã
 * @category BaseTypes Constant
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.GetFeatureMode.NDVI;
 *
 * </script>
 * // ES6 Import
 * import { GetFeatureMode } from '{npm}';
 *
 * const result = GetFeatureMode.NDVI;
 * ```
 */
var RasterFunctionType = {
    /** å½ä¸åæ¤è¢«ææ°ã */
    NDVI: "NDVI",
    /** é´å½±é¢åæã */
    HILLSHADE: "HILLSHADE"
}

/**
 * @enum ResourceType
 * @description iportalèµæºç±»åã
 * @category BaseTypes Constant
 * @version 10.0.1
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.GetFeatureMode.MAP;
 *
 * </script>
 * // ES6 Import
 * import { GetFeatureMode } from '{npm}';
 *
 * const result = GetFeatureMode.MAP;
 * ```
 */
var ResourceType = {
    /** å°å¾ã */
    MAP: "MAP",
    /** æå¡ã */
    SERVICE: "SERVICE",
    /** åºæ¯ã */
    SCENE: "SCENE",
    /** æ°æ®ã */
    DATA: "DATA",
    /** æ´å¯ã */
    INSIGHTS_WORKSPACE: "INSIGHTS_WORKSPACE",
    /** å¤§å±ã */
    MAP_DASHBOARD: "MAP_DASHBOARD"
}

/**
 * @enum OrderBy
 * @description iportalèµæºæåºå­æ®µã
 * @category BaseTypes Constant
 * @version 10.0.1
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.OrderBy.UPDATETIME;
 *
 * </script>
 * // ES6 Import
 * import { OrderBy } from '{npm}';
 *
 * const result = OrderBy.UPDATETIME;
 * ```
 */
var OrderBy = {
    /** ææ´æ°æ¶é´æåº */
    UPDATETIME: "UPDATETIME",
    /** æç­åº¦(å¯è½æ¯è®¿é®éãä¸è½½é)æåº */
    HEATLEVEL: "HEATLEVEL",
    /** æç¸å³æ§æåº */
    RELEVANCE: "RELEVANCE"
}

/**
 * @enum OrderType
 * @description iportalèµæºååºè¿æ¯éåºè¿æ»¤
 * @category BaseTypes Constant
 * @version 10.0.1
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.OrderType.ASC;
 *
 * </script>
 * // ES6 Import
 * import { OrderType } from '{npm}';
 *
 * const result = OrderType.ASC;
 * ```
 */
var OrderType = {
    /** ååº */
    ASC: "ASC",
    /** éåº */
    DESC: "DESC"
}

/**
 * @enum SearchType
 * @description iportalèµæºæ¥è¯¢çèå´è¿è¡è¿æ»¤
 * @category BaseTypes Constant
 * @version 10.0.1
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.SearchType.PUBLIC;
 *
 * </script>
 * // ES6 Import
 * import { SearchType } from '{npm}';
 *
 * const result = SearchType.PUBLIC;
 * ```
 */
var SearchType = {
    /** å¬å¼èµæºã */
    PUBLIC: "PUBLIC",
    /** æçèµæºã */
    MY_RES: "MY_RES",
    /** æçç¾¤ç»èµæºã */
    MYGROUP_RES: "MYGROUP_RES",
    /** æçé¨é¨èµæºã */
    MYDEPARTMENT_RES: "MYDEPARTMENT_RES",
    /** åäº«ç»æçèµæºã */
    SHARETOME_RES: "SHARETOME_RES"
}

/**
 * @enum AggregationTypes
 * @description iportalèµæºèåæ¥è¯¢çç±»å
 * @category BaseTypes Constant
 * @version 10.0.1
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.AggregationTypes.TAG;
 *
 * </script>
 * // ES6 Import
 * import { AggregationTypes } from '{npm}';
 *
 * const result = AggregationTypes.TAG;
 * ```
 */
var AggregationTypes = {
    /** æ ç­¾ */
    TAG: "TAG",
    /** èµæºç±»å */
    TYPE: "TYPE"
}

/**
 * @enum PermissionType
 * @description iportalèµæºæéç±»åã
 * @category BaseTypes Constant
 * @version 10.0.1
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.PermissionType.SEARCH;
 *
 * </script>
 * // ES6 Import
 * import { PermissionType } from '{npm}';
 *
 * const result = PermissionType.SEARCH;
 * ```
 */
var PermissionType = {
    /** å¯æ£ç´¢ */
    SEARCH:"SEARCH",
    /** å¯æ¥ç */
    READ: "READ",
    /** å¯ç¼è¾ */
    READWRITE: "READWRITE",
    /** å¯å é¤ */
    DELETE: "DELETE",
    /** å¯ä¸è½½ï¼åæ¬å¯è¯»ãå¯æ£ç´¢ */
    DOWNLOAD:"DOWNLOAD"
}

/**
 * @enum EntityType
 * @description iportalèµæºå®ä½ç±»åã
 * @category BaseTypes Constant
 * @version 10.0.1
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.EntityType.DEPARTMENT;
 *
 * </script>
 * // ES6 Import
 * import { EntityType } from '{npm}';
 *
 * const result = EntityType.DEPARTMENT;
 * ```
 */
var EntityType = {
    /** é¨é¨ */
    DEPARTMENT: "DEPARTMENT",
    /** ç¨æ·ç» */
    GROUP: "GROUP",
    /** ç¾¤ç» */
    IPORTALGROUP: "IPORTALGROUP",
    /** è§è² */
    ROLE: "ROLE",
    /** ç¨æ· */
    USER: "USER"
}

/**
 * @enum DataItemType
 * @description iportalæ°æ®ç±»åã
 * @category BaseTypes Constant
 * @version 10.0.1
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.DataItemType.GEOJSON;
 *
 * </script>
 * // ES6 Import
 * import { DataItemType } from '{npm}';
 *
 * const result = DataItemType.GEOJSON;
 * ```
 */
var DataItemType = {
    /** geojsonæ°æ®ã */
    GEOJSON: "GEOJSON",
    /** UGCV5_MVT  */
    UGCV5_MVT: "UGCV5_MVT",
    /** jsonæ°æ®  */
    JSON: "JSON",
    /** AUDIO */
    AUDIO: "AUDIO",
    /** COLOR */
    COLOR: "COLOR",
    /** COLORSCHEME */
    COLORSCHEME: "COLORSCHEME",
    /** CSV */
    CSV: "CSV",
    /** EXCEL */
    EXCEL: "EXCEL",
    /** FILLSYMBOL */
    FILLSYMBOL: "FILLSYMBOL",
    /** IMAGE */
    IMAGE: "IMAGE",
    /** LAYERTEMPLATE */
    LAYERTEMPLATE: "LAYERTEMPLATE",
    /** LAYOUTTEMPLATE */
    LAYOUTTEMPLATE: "LAYOUTTEMPLATE",
    /** LINESYMBOL */
    LINESYMBOL: "LINESYMBOL",
    /** MAPTEMPLATE */
    MAPTEMPLATE: "MAPTEMPLATE",
    /** MARKERSYMBOL */
    MARKERSYMBOL: "MARKERSYMBOL",
    /** MBTILES */
    MBTILES: "MBTILES",
    /** PHOTOS */
    PHOTOS: "PHOTOS",
    /** SHP */
    SHP: "SHP",
    /** SMTILES */
    SMTILES: "SMTILES",
    /** SVTILES */
    SVTILES: "SVTILES",
    /** THEMETEMPLATE */
    THEMETEMPLATE: "THEMETEMPLATE",
    /** TPK */
    TPK: "TPK",
    /** UDB */
    UDB: "UDB",
    /** UGCV5 */
    UGCV5: "UGCV5",
    /** UNKNOWN */
    UNKNOWN: "UNKNOWN",
    /** VIDEO */
    VIDEO: "VIDEO",
    /** WORKENVIRONMENT */
    WORKENVIRONMENT: "WORKENVIRONMENT",
    /** WORKSPACE */
    WORKSPACE: "WORKSPACE"
}

/**
 * @enum WebExportFormatType
 * @description Web æå°è¾åºçæ ¼å¼ã
 * @category BaseTypes Constant
 * @version 10.0.1
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.WebExportFormatType.PNG;
 *
 * </script>
 * // ES6 Import
 * import { WebExportFormatType } from '{npm}';
 *
 * const result = WebExportFormatType.PNG;
 * ```
 */
var WebExportFormatType = {
    /** png */
    PNG: "PNG",
    /** pdf */
    PDF: "PDF"
}

/**
 * @enum WebScaleOrientationType
 * @description Web æ¯ä¾å°ºçæ¹ä½æ ·å¼ã
 * @category BaseTypes Constant
 * @version 10.0.1
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.WebScaleOrientationType.HORIZONTALLABELSBELOW;
 *
 * </script>
 * // ES6 Import
 * import { WebScaleOrientationType } from '{npm}';
 *
 * const result = WebScaleOrientationType.HORIZONTALLABELSBELOW;
 * ```
 */
var WebScaleOrientationType = {
    /** horizontal labels below */
    HORIZONTALLABELSBELOW: "HORIZONTALLABELSBELOW",
    /** horizontal labels above */
    HORIZONTALLABELSABOVE: "HORIZONTALLABELSABOVE",
    /** vertical labels left */
    VERTICALLABELSLEFT: "VERTICALLABELSLEFT",
    /** vertical labels right */
    VERTICALLABELSRIGHT: "VERTICALLABELSRIGHT"
}

/**
 * @enum WebScaleType
 * @description Web æ¯ä¾å°ºçæ ·å¼ã
 * @category BaseTypes Constant
 * @version 10.0.1
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.WebScaleType.LINE;
 *
 * </script>
 * // ES6 Import
 * import { WebScaleType } from '{npm}';
 *
 * const result = WebScaleType.LINE;
 * ```
 */
var WebScaleType = {
    /** line */
    LINE: "LINE",
    /** bar */
    BAR: "BAR",
    /** bar sub */
    BAR_SUB: "BAR_SUB"
}

/**
 * @enum WebScaleUnit
 * @description Web æ¯ä¾å°ºçåä½å¶ã
 * @category BaseTypes Constant
 * @version 10.0.1
 * @type {string}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.WebScaleUnit.METER;
 *
 * </script>
 * // ES6 Import
 * import { WebScaleUnit } from '{npm}';
 *
 * const result = WebScaleUnit.METER;
 * ```
 */
var WebScaleUnit = {
    /** ç±³ */
    METER: "METER",
    /** è±å°º */
    FOOT: "FOOT",
    /** åº¦ */
    DEGREES: "DEGREES"
}


;// CONCATENATED MODULE: ./src/common/commontypes/Size.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/

/**
 * @class  Size
 * @deprecatedclass SuperMap.Size
 * @category BaseTypes Style
 * @classdesc æ­¤ç±»æç»ä¸å¯¹é«å®½å¼çå®ä¾ã
 * @param {number} [w=0.0] - å®½åº¦ã
 * @param {number} [h=0.0] - é«åº¦ã
 *
 * @example
 * var size = new Size(31,46);
 * @usage
 */
class Size {

    constructor(w, h) {
        /**
         * @member {number} [Size.prototype.w=0.0]
         * @description å®½åº¦ã
         */
        this.w = w ? parseFloat(w) : 0.0;

        /**
         * @member {number} [Size.prototype.h=0.0]
         * @description é«åº¦ã
         */
        this.h = w ? parseFloat(h) : 0.0;
        this.CLASS_NAME = "SuperMap.Size";
    }


    /**
     * @function Size.prototype.toString
     * @description è¿åå­ç¬¦ä¸²å½¢å¼ã
     * @example
     * var size = new Size(10,5);
     * var str = size.toString();
     * @returns {string} ä¾å¦ï¼"w=10,h=5"ã
     */
    toString() {
        return ("w=" + this.w + ",h=" + this.h);
    }


    /**
     * @function Size.prototype.clone
     * @description åéå½åsizeå¯¹è±¡ã
     * @example
     * var size = new Size(31,46);
     * var size2 = size.clone();
     * @returns {Size}  æ°çä¸å½å size å¯¹è±¡æç¸åå®½ãé«ç Size å¯¹è±¡ã
     */
    clone() {
        return new Size(this.w, this.h);
    }


    /**
     *
     * @function Size.prototype.equals
     * @description æ¯è¾ä¸¤ä¸ª size å¯¹è±¡æ¯å¦ç¸ç­ã
     * @example
     * var size = new Size(31,46);
     * var size2 = new Size(31,46);
     * var isEquals = size.equals(size2);
     *
     * @param {Size} sz - ç¨äºæ¯è¾ç¸ç­ç Size å¯¹è±¡ã
     * @returns {boolean} ä¼ å¥ç size åå½å size é«å®½ç¸ç­ï¼æ³¨æï¼å¦æä¼ å¥ç size ä¸ºç©ºåè¿å falseã
     *
     */
    equals(sz) {
        var equals = false;
        if (sz != null) {
            equals = ((this.w === sz.w && this.h === sz.h) ||
                (isNaN(this.w) && isNaN(this.h) && isNaN(sz.w) && isNaN(sz.h)));
        }
        return equals;
    }

    /**
     *
     * @function Size.prototype.destroy
     * @description éæ¯æ­¤å¯¹è±¡ãéæ¯åæ­¤å¯¹è±¡çææå±æ§ä¸º nullï¼èä¸æ¯åå§å¼ã
     * @example
     * var size = new Size(31,46);
     * size.destroy();
     */
    destroy() {
        this.w = null;
        this.h = null;
    }
}

;// CONCATENATED MODULE: ./src/common/commontypes/Pixel.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/

/**
 * @class Pixel
 * @deprecatedclass SuperMap.Pixel
 * @category BaseTypes Geometry
 * @classdesc ç¨ x,y åæ æç»å±å¹åæ ï¼åç´ ç¹ï¼ã
 * @param {number} [x=0.0] - x åæ ã
 * @param {number} [y=0.0] - y åæ ã
 * @param {Pixel.Mode} [mode=Pixel.Mode.LeftTop] - åæ æ¨¡å¼ã
 *
 * @example
 * //åç¬åå»ºä¸ä¸ªå¯¹è±¡
 * var pixcel = new Pixel(100,50);
 *
 * //ä¾æ® size åå»º
 *  var size = new Size(21,25);
 *  var offset = new Pixel(-(size.w/2), -size.h);
 * @usage
 */
class Pixel {
  constructor(x, y, mode) {
    /**
     * @member {number} [Pixel.prototype.x=0.0]
     * @description x åæ ã
     */
    this.x = x ? parseFloat(x) : 0.0;

    /**
     * @member {number} [Pixel.prototype.y=0.0]
     * @description y åæ ã
     */
    this.y = y ? parseFloat(y) : 0.0;

    /**
     * @member {Pixel.Mode} [Pixel.prototype.mode=Pixel.Mode.LeftTop]
     * @description åæ æ¨¡å¼ï¼æå·¦ä¸ãå³ä¸ãå³ä¸ãå·¦ä¸è¿å ç§æ¨¡å¼ï¼åå«è¡¨ç¤ºç¸å¯¹äºå·¦ä¸è§ãå³ä¸è§ãå³ä¸è§ãå·¦ä¸è§çåæ ã
     */
    this.mode = mode;
    this.CLASS_NAME = 'SuperMap.Pixel';
  }

  /**
   * @function Pixel.prototype.toString
   * @description è¿åæ­¤å¯¹è±¡çå­ç¬¦ä¸²å½¢å¼ã
   * @example
   *
   * var pixcel = new Pixel(100,50);
   * var str = pixcel.toString();
   *
   * @returns {string} ä¾å¦: "x=200.4,y=242.2"
   */
  toString() {
    return 'x=' + this.x + ',y=' + this.y;
  }

  /**
   * @function Pixel.prototype.clone
   * @description åéå½åç pixel å¯¹è±¡ã
   * @example
   * var pixcel = new Pixel(100,50);
   * var pixcel2 = pixcel.clone();
   * @returns {Pixel} æ°çä¸å½å pixel å¯¹è±¡æç¸å xãy åæ ç pixel å¯¹è±¡ã
   */
  clone() {
    return new Pixel(this.x, this.y, this.mode);
  }

  /**
   * @function Pixel.prototype.equals
   * @description æ¯è¾ä¸¤ pixel æ¯å¦ç¸ç­ã
   * @example
   * var pixcel = new Pixel(100,50);
   * var pixcel2 = new Pixel(100,50);
   * var isEquals = pixcel.equals(pixcel2);
   *
   * @param {Pixel} px - ç¨äºæ¯è¾ç¸ç­ç pixel å¯¹è±¡ã
   * @returns {boolean} å¦æä¼ å¥çåç´ ç¹åå½ååç´ ç¹ç¸åè¿å trueï¼å¦æä¸åæä¼ å¥åæ°ä¸º NULL åè¿å falseã
   */
  equals(px) {
    var equals = false;
    if (px != null) {
      equals = (this.x == px.x && this.y == px.y) || (isNaN(this.x) && isNaN(this.y) && isNaN(px.x) && isNaN(px.y));
    }
    return equals;
  }

  /**
   * @function Pixel.prototype.distanceTo
   * @description è¿åä¸¤ä¸ª pixel çè·ç¦»ã
   * @example
   * var pixcel = new Pixel(100,50);
   * var pixcel2 = new Pixel(110,30);
   * var distance = pixcel.distanceTo(pixcel2);
   *
   * @param {Pixel} px - éè¦è®¡ç®ç pixelã
   * @returns {number} ä½ä¸ºåæ°ä¼ å¥çåç´ ä¸å½ååç´ ç¹çè·ç¦»ã
   */
  distanceTo(px) {
    return Math.sqrt(Math.pow(this.x - px.x, 2) + Math.pow(this.y - px.y, 2));
  }

  /**
   * @function Pixel.prototype.add
   * @description å¨åæ¥åç´ åæ åºç¡ä¸ï¼x å¼å ä¸ä¼ å¥ç x åæ°ï¼y å¼å ä¸ä¼ å¥ç y åæ°ã
   * @example
   * var pixcel = new Pixel(100,50);
   * //pixcel2æ¯æ°çå¯¹è±¡
   * var pixcel2 = pixcel.add(20,30);
   *
   * @param {number} x - ä¼ å¥ç x å¼ã
   * @param {number} y - ä¼ å¥ç y å¼ã
   * @returns {Pixel} æ°ç pixel å¯¹è±¡ï¼è¯¥ pixel æ¯ç±å½åç pixel ä¸ä¼ å¥ç xï¼y ç¸å å¾å°ã
   */
  add(x, y) {
    if (x == null || y == null) {
      throw new TypeError('Pixel.add cannot receive null values');
    }
    return new Pixel(this.x + x, this.y + y);
  }

  /**
   * @function Pixel.prototype.offset
   * @description éè¿ä¼ å¥ç {@link Pixel} åæ°å¯¹åå±å¹åæ è¿è¡åç§»ã
   * @example
   * var pixcel = new Pixel(100,50);
   * var pixcel2 = new Pixel(130,20);
   * //pixcel3 æ¯æ°çå¯¹è±¡
   * var pixcel3 = pixcel.offset(pixcel2);
   *
   * @param {Pixel} px - ä¼ å¥ç {@link Pixel} å¯¹è±¡ã
   * @returns {Pixel} æ°ç pixelï¼è¯¥ pixel æ¯ç±å½åç pixel å¯¹è±¡ç xï¼y å¼ä¸ä¼ å¥ç Pixel å¯¹è±¡ç xï¼y å¼ç¸å å¾å°ã
   */
  offset(px) {
    var newPx = this.clone();
    if (px) {
      newPx = this.add(px.x, px.y);
    }
    return newPx;
  }

  /**
   *
   * @function Pixel.prototype.destroy
   * @description éæ¯æ­¤å¯¹è±¡ãéæ¯åæ­¤å¯¹è±¡çææå±æ§ä¸º nullï¼èä¸æ¯åå§å¼ã
   * @example
   * var pixcel = new Pixel(100,50);
   * pixcel.destroy();
   */
  destroy() {
    this.x = null;
    this.y = null;
    this.mode = null;
  }
}
/**
 * @enum Mode
 * @memberOf Pixel
 * @readonly
 * @description æ¨¡å¼ã
 * @type {string}
 */
Pixel.Mode = {
  /** å·¦ä¸æ¨¡å¼ã*/
  LeftTop: 'lefttop',
  /** å³ä¸æ¨¡å¼ã */
  RightTop: 'righttop',
  /** å³ä¸æ¨¡å¼ã */
  RightBottom: 'rightbottom',
  /** å·¦ä¸æ¨¡å¼ã */
  LeftBottom: 'leftbottom'
};

;// CONCATENATED MODULE: ./src/common/commontypes/BaseTypes.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
 

/**
 * @function inherit
 * @description é¤äº C å P ä¸¤ä¸ªå¿è¦åæ°å¤ï¼å¯ä»¥ä¼ éä»»ææ°éçå¯¹è±¡ï¼è¿äºå¯¹è±¡é½å°ç»§æ¿Cã
 * @param {Object} C - ç»§æ¿çç±»ã
 * @param {Object} P - è¢«ç»§æ¿çç¶ç±»ã
 * @private
 */
var inheritExt = function (C, P) {
    var F = function () {
    };
    F.prototype = P.prototype;
    C.prototype = new F;
    var i, l, o;
    for (i = 2, l = arguments.length; i < l; i++) {
        o = arguments[i];
        if (typeof o === "function") {
            o = o.prototype;
        }
        Util.extend(C.prototype, o);
    }
};


/**
 * @function mixinExt
 * @description å®ç°å¤éç»§æ¿ã
 * @param {Class|Object} ...mixins - ç»§æ¿çç±»ã
 * @private
 */
var mixinExt = function (...mixins) {

    class Mix {
        constructor(options) {
            for (var index = 0; index < mixins.length; index++) {
                copyProperties(this, new mixins[index](options));
            }
        }
    }

    for (var index = 0; index < mixins.length; index++) {
        var mixin = mixins[index];
        copyProperties(Mix, mixin);
        copyProperties(Mix.prototype, mixin.prototype);
        copyProperties(Mix.prototype, new mixin());
    }
    return Mix;

    function copyProperties(target, source) {
        var ownKeys = Object.getOwnPropertyNames(source);
        if (Object.getOwnPropertySymbols) {
            ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source));
        }
        for (var index = 0; index < ownKeys.length; index++) {
            var key = ownKeys[index];
            if (key !== "constructor"
                && key !== "prototype"
                && key !== "name" && key !== "length") {
                let desc = Object.getOwnPropertyDescriptor(source, key);
                if (window["ActiveXObject"]) {
                    Object.defineProperty(target, key, desc || {});
                } else {
                    Object.defineProperty(target, key, desc);
                }
            }
        }
    }
};

/**
 * @name String
 * @namespace
 * @category BaseTypes Util
 * @description å­ç¬¦ä¸²æä½çä¸ç³»åå¸¸ç¨æ©å±å½æ°ã
 * @private
 */
var StringExt = {

    /**
     * @function StringExt.startsWith
     * @description å¤æ­ç®æ å­ç¬¦ä¸²æ¯å¦ä»¥æå®çå­å­ç¬¦ä¸²å¼å¤´ã
     * @param {string} str - ç®æ å­ç¬¦ä¸²ã
     * @param {string} sub - æ¥æ¾çå­å­ç¬¦ä¸²ã
     * @returns {boolean} ç®æ å­ç¬¦ä¸²ä»¥æå®çå­å­ç¬¦ä¸²å¼å¤´ï¼åè¿å trueï¼å¦åè¿å falseã
     */
    startsWith: function (str, sub) {
        return (str.indexOf(sub) == 0);
    },

    /**
     * @function StringExt.contains
     * @description å¤æ­ç®æ å­ç¬¦ä¸²æ¯å¦åå«æå®çå­å­ç¬¦ä¸²ã
     * @param {string} str - ç®æ å­ç¬¦ä¸²ã
     * @param {string} sub - æ¥æ¾çå­å­ç¬¦ä¸²ã
     * @returns {boolean} ç®æ å­ç¬¦ä¸²ä¸­åå«æå®çå­å­ç¬¦ä¸²ï¼åè¿å trueï¼å¦åè¿å falseã
     */
    contains: function (str, sub) {
        return (str.indexOf(sub) != -1);
    },

    /**
     * @function StringExt.trim
     * @description å é¤ä¸ä¸ªå­ç¬¦ä¸²çå¼å¤´åç»å°¾å¤çææç©ºç½å­ç¬¦ã
     * @param {string} str - ï¼å¯è½ï¼å­å¨ç©ºç½å­ç¬¦å¡«å¡çå­ç¬¦ä¸²ã
     * @returns {string} å é¤å¼å¤´åç»å°¾å¤ç©ºç½å­ç¬¦åçå­ç¬¦ä¸²ã
     */
    trim: function (str) {
        return str.replace(/^\s\s*/, '').replace(/\s\s*$/, '');
    },

    /**
     * @function StringExt.camelize
     * @description éªé©¼å¼("-")è¿å­ç¬¦çå­ç¬¦ä¸²å¤çã
     * ä¾å¦ï¼"chicken-head" becomes "chickenHead",
     *       "-chicken-head" becomes "ChickenHead"ã
     * @param {string} str - è¦å¤ççå­ç¬¦ä¸²ï¼åå§åå®¹ä¸åºè¢«ä¿®æ¹ã
     * @returns {string}
     */
    camelize: function (str) {
        var oStringList = str.split('-');
        var camelizedString = oStringList[0];
        for (var i = 1, len = oStringList.length; i < len; i++) {
            var s = oStringList[i];
            camelizedString += s.charAt(0).toUpperCase() + s.substring(1);
        }
        return camelizedString;
    },

    /**
     * @function StringExt.format
     * @description æä¾å¸¦ ${token} æ è®°çå­ç¬¦ä¸², è¿å context å¯¹è±¡å±æ§ä¸­æå®æ è®°çå±æ§å¼ã
     * @example
     * ç¤ºä¾ï¼
     * (code)
     * 1ãtemplate = "${value,getValue}";
     *         context = {value: {getValue:function(){return Math.max.apply(null,argument);}}};
     *         args = [2,23,12,36,21];
     *       è¿åå¼:36
     * (end)
     * ç¤ºä¾:
     * (code)
     * 2ãtemplate = "$${{value,getValue}}";
     *         context = {value: {getValue:function(){return Math.max.apply(null,argument);}}};
     *         args = [2,23,12,36,21];
     *       è¿åå¼:"${36}"
     * (end)
     * ç¤ºä¾:
     * (code)
     * 3ãtemplate = "${a,b}";
     *         context = {a: {b:"format"}};
     *         args = null;
     *       è¿åå¼:"format"
     * (end)
     * ç¤ºä¾:
     * (code)
     * 3ãtemplate = "${a,b}";
     *         context = null;
     *         args = null;
     *       è¿åå¼:"${a.b}"
     * (end)
     * @param {string} template - å¸¦æ è®°çå­ç¬¦ä¸²å°è¦è¢«æ¿æ¢ãåæ° template æ ¼å¼ä¸º"${token}"ï¼æ­¤å¤ç token æ è®°ä¼æ¿æ¢ä¸º context["token"] å±æ§çå¼ã
     * @param {Object} [context=window] - å¸¦æå±æ§çå¯éå¯¹è±¡çå±æ§ç¨äºå¹éæ ¼å¼åå­ç¬¦ä¸²ä¸­çæ è®°ãå¦æè¯¥åæ°ä¸ºç©ºï¼å°ä½¿ç¨ window å¯¹è±¡ã
     * @param {Array.<number>} [args] - å¯éåæ°ä¼ éç»å¨ context å¯¹è±¡ä¸æ¾å°çå½æ°ã
     * @returns {string} ä» context å¯¹è±¡å±æ§ä¸­æ¿æ¢å­ç¬¦ä¸²æ è®°ä½çå­ç¬¦ä¸²ã
     */
    format: function (template, context, args) {
        if (!context) {
            context = window;
        }

        // Example matching:
        // str   = ${foo.bar}
        // match = foo.bar
        var replacer = function (str, match) {
            var replacement;

            // Loop through all subs. Example: ${a.b.c}
            // 0 -> replacement = context[a];
            // 1 -> replacement = context[a][b];
            // 2 -> replacement = context[a][b][c];
            var subs = match.split(/\.+/);
            for (var i = 0; i < subs.length; i++) {
                if (i == 0) {
                    replacement = context;
                }

                replacement = replacement[subs[i]];
            }

            if (typeof replacement === "function") {
                replacement = args ?
                    replacement.apply(null, args) :
                    replacement();
            }

            // If replacement is undefined, return the string 'undefined'.
            // This is a workaround for a bugs in browsers not properly
            // dealing with non-participating groups in regular expressions:
            // http://blog.stevenlevithan.com/archives/npcg-javascript
            if (typeof replacement == 'undefined') {
                return 'undefined';
            } else {
                return replacement;
            }
        };

        return template.replace(StringExt.tokenRegEx, replacer);
    },

    /**
     * @member {RegExp} [StringExt.tokenRegEx]
     * @description å¯»æ¾å¸¦ token çå­ç¬¦ä¸²ï¼é»è®¤ä¸º tokenRegEx=/\$\{([\w.]+?)\}/gã
     * @example
     * Examples: ${a}, ${a.b.c}, ${a-b}, ${5}
     */
    tokenRegEx: /\$\{([\w.]+?)\}/g,

    /**
     * @member {RegExp} [StringExt.numberRegEx]
     * @description å¤æ­ä¸ä¸ªå­ç¬¦ä¸²æ¯å¦åªåå«ä¸ä¸ªæ°å¼ï¼é»è®¤ä¸º numberRegEx=/^([+-]?)(?=\d|\.\d)\d*(\.\d*)?([Ee]([+-]?\d+))?$/ã
     */
    numberRegEx: /^([+-]?)(?=\d|\.\d)\d*(\.\d*)?([Ee]([+-]?\d+))?$/,

    /**
     * @function StringExt.isNumeric
     * @description å¤æ­ä¸ä¸ªå­ç¬¦ä¸²æ¯å¦åªåå«ä¸ä¸ªæ°å¼ã
     * @example
     * (code)
     * StringExt.isNumeric("6.02e23") // true
     * StringExt.isNumeric("12 dozen") // false
     * StringExt.isNumeric("4") // true
     * StringExt.isNumeric(" 4 ") // false
     * (end)
     * @returns {boolean} å­ç¬¦ä¸²åå«å¯ä¸çæ°å¼ï¼è¿å trueï¼å¦åè¿å falseã
     */
    isNumeric: function (value) {
        return StringExt.numberRegEx.test(value);
    },

    /**
     * @function StringExt.numericIf
     * @description æä¸ä¸ªçä¼¼æ°å¼åçå­ç¬¦ä¸²è½¬åä¸ºä¸ä¸ªæ°å¼ã
     * @returns {(number|string)} å¦æè½è½¬æ¢ä¸ºæ°å¼åè¿åæ°å¼ï¼å¦åè¿åå­ç¬¦ä¸²æ¬èº«ã
     */
    numericIf: function (value) {
        return StringExt.isNumeric(value) ? parseFloat(value) : value;
    }

};

/**
 * @name Number
 * @namespace
 * @category BaseTypes Util
 * @description æ°å¼æä½çä¸ç³»åå¸¸ç¨æ©å±å½æ°ã
 * @private
 */
var NumberExt = {

    /**
     * @member {string} [NumberExt.decimalSeparator='.']
     * @description æ ¼å¼åæ°å­æ¶é»è®¤çå°æ°ç¹åéç¬¦ã
     * @constant
     */
    decimalSeparator: ".",

    /**
     * @member {string} [NumberExt.thousandsSeparator=',']
     * @description æ ¼å¼åæ°å­æ¶é»è®¤çåä½åéç¬¦ã
     * @constant
     */
    thousandsSeparator: ",",

    /**
     * @function NumberExt.limitSigDigs
     * @description éå¶æµ®ç¹æ°çæææ°å­ä½æ°ã
     * @param {number} num - æµ®ç¹æ°ã
     * @param {number} sig - ææä½æ°ã
     * @returns {number} å°æ°å­åèäºå¥å°æå®æ°éçææä½æ°ã
     */
    limitSigDigs: function (num, sig) {
        var fig = 0;
        if (sig > 0) {
            fig = parseFloat(num.toPrecision(sig));
        }
        return fig;
    },

    /**
     * @function NumberExt.format
     * @description æ°å­æ ¼å¼åè¾åºã
     * @param {number} num - æ°å­ã
     * @param {number} [dec=0]  - æ°å­çå°æ°é¨ååèäºå¥å°æå®çä½æ°ãè®¾ç½®ä¸º null å¼æ¶å°æ°é¨åä¸åã
     * @param {string} [tsep=','] - åä½åéç¬¦ã
     * @param {string} [dsep='.'] - å°æ°ç¹åéç¬¦ã
     * @returns {string} æ°å­æ ¼å¼ååçå­ç¬¦ä¸²ã
     */
    format: function (num, dec, tsep, dsep) {
        dec = (typeof dec != "undefined") ? dec : 0;
        tsep = (typeof tsep != "undefined") ? tsep :
        NumberExt.thousandsSeparator;
        dsep = (typeof dsep != "undefined") ? dsep :
        NumberExt.decimalSeparator;

        if (dec != null) {
            num = parseFloat(num.toFixed(dec));
        }

        var parts = num.toString().split(".");
        if (parts.length === 1 && dec == null) {
            // integer where we do not want to touch the decimals
            dec = 0;
        }

        var integer = parts[0];
        if (tsep) {
            var thousands = /(-?[0-9]+)([0-9]{3})/;
            while (thousands.test(integer)) {
                integer = integer.replace(thousands, "$1" + tsep + "$2");
            }
        }

        var str;
        if (dec == 0) {
            str = integer;
        } else {
            var rem = parts.length > 1 ? parts[1] : "0";
            if (dec != null) {
                rem = rem + new Array(dec - rem.length + 1).join("0");
            }
            str = integer + dsep + rem;
        }
        return str;
    }
};

if (!Number.prototype.limitSigDigs) {
    /**
     * APIMethod: Number.limitSigDigs
     * éå¶æµ®ç¹æ°çæææ°å­ä½æ°.
     * @param {number} sig -ææä½æ°ã
     * @returns {number} å°æ°å­åèäºå¥å°æå®æ°éçææä½æ°ã
     *           å¦æä¼ å¥å¼ ä¸º nullã0ãæèæ¯è´æ°, è¿åå¼ 0ã
     */
    Number.prototype.limitSigDigs = function (sig) {
        return NumberExt.limitSigDigs(this, sig);
    };
}

/**
 * @name Function
 * @namespace
 * @category BaseTypes Util
 * @description å½æ°æä½çä¸ç³»åå¸¸ç¨æ©å±å½æ°ã
 * @private
 */
var FunctionExt = {
    /**
     * @function FunctionExt.bind
     * @description ç»å®å½æ°å°å¯¹è±¡ãæ¹ä¾¿åå»º this çä½ç¨åã
     * @param {function} func - è¾å¥å½æ°ã
     * @param {Object} object - å¯¹è±¡ç»å®å°è¾å¥å½æ°ï¼ä½ä¸ºè¾å¥å½æ°ç this å¯¹è±¡ï¼ã
     * @returns {function} object åæ°ä½ä¸º func å½æ°ç this å¯¹è±¡ã
     */
    bind: function (func, object) {
        // create a reference to all arguments past the second one
        var args = Array.prototype.slice.apply(arguments, [2]);
        return function () {
            // Push on any additional arguments from the actual function call.
            // These will come after those sent to the bind call.
            var newArgs = args.concat(
                Array.prototype.slice.apply(arguments, [0])
            );
            return func.apply(object, newArgs);
        };
    },

    /**
     * @function FunctionExt.bindAsEventListener
     * @description ç»å®å½æ°å°å¯¹è±¡ï¼å¨è°ç¨è¯¥å½æ°æ¶éç½®å¹¶ä½¿ç¨äºä»¶å¯¹è±¡ä½ä¸ºç¬¬ä¸ä¸ªåæ°ã
     * @param {function} func - ç¨äºçå¬äºä»¶çå½æ°ã
     * @param {Object} object - this å¯¹è±¡çå¼ç¨ã
     * @returns {function}
     */
    bindAsEventListener: function (func, object) {
        return function (event) {
            return func.call(object, event || window.event);
        };
    },

    /**
     * @function FunctionExt.False
     * @description è¯¥å½æ°ä»ä»è¿å falseãè¯¥å½æ°ä¸»è¦æ¯é¿åå¨ IE8 ä»¥ä¸æµè§ä¸­ DOM äºä»¶å¥æçå¿åå½æ°é®é¢ã
     * @example
     * document.onclick = FunctionExt.False;
     * @returns {boolean}
     */
    False: function () {
        return false;
    },

    /**
     * @function FunctionExt.True
     * @description è¯¥å½æ°ä»ä»è¿å trueãè¯¥å½æ°ä¸»è¦æ¯é¿åå¨ IE8 ä»¥ä¸æµè§ä¸­ DOM äºä»¶å¥æçå¿åå½æ°é®é¢ã
     * @example
     * document.onclick = FunctionExt.True;
     * @returns {boolean}
     */
    True: function () {
        return true;
    },

    /**
     * @function FunctionExt.Void
     * @description å¯éç¨å½æ°ï¼ä»ä»è¿å "undefined"ã
     * @returns {undefined}
     */
    Void: function () {
    }

};

/**
 * @name Array
 * @namespace
 * @category BaseTypes Util
 * @description æ°ç»æä½çä¸ç³»åå¸¸ç¨æ©å±å½æ°ã
 * @private
 */
var ArrayExt = {

    /**
     * @function ArrayExt.filter
     * @description è¿æ»¤æ°ç»ï¼æä¾äº ECMA-262 æ åä¸­ Array.prototype.filter å½æ°çæ©å±ãè¯¦è§ï¼{@link http://developer.mozilla.org/en/Core_JavaScript_1.5_Reference/Global_Objects/Array/filter}
     * @param {Array} array - è¦è¿æ»¤çæ°ç»ã
     * @param {function} callback - æ°ç»ä¸­çæ¯ä¸ä¸ªåç´ è°ç¨è¯¥å½æ°ã</br>
     *     å¦æå½æ°çè¿åå¼ä¸º trueï¼è¯¥åç´ å°åå«å¨è¿åçæ°ç»ä¸­ãè¯¥å½æ°æä¸ä¸ªåæ°: æ°ç»ä¸­çåç´ ï¼åç´ çç´¢å¼ï¼æ°ç»èªèº«ã</br>
     *     å¦æè®¾ç½®äºå¯éåæ° callerï¼å¨è°ç¨ callback æ¶ï¼ä½¿ç¨å¯éåæ° caller è®¾ç½®ä¸º callback çåæ°ã</br>
     * @param {Object} [caller] - å¨è°ç¨ callback æ¶ï¼ä½¿ç¨åæ° caller è®¾ç½®ä¸º callback çåæ°ã
     * @returns {Array} callback å½æ°è¿å true æ¶çåç´ å°ä½ä¸ºè¿åæ°ç»ä¸­çåç´ ã
     */
    filter: function (array, callback, caller) {
        var selected = [];
        if (Array.prototype.filter) {
            selected = array.filter(callback, caller);
        } else {
            var len = array.length;
            if (typeof callback != "function") {
                throw new TypeError();
            }
            for (var i = 0; i < len; i++) {
                if (i in array) {
                    var val = array[i];
                    if (callback.call(caller, val, i, array)) {
                        selected.push(val);
                    }
                }
            }
        }
        return selected;
    }

};

;// CONCATENATED MODULE: ./src/common/commontypes/Geometry.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
// import {WKT} from '../format/WKT';
// import {Vector} from './Vector';


/**
 * @class Geometry
 * @deprecatedclass SuperMap.Geometry
 * @category BaseTypes Geometry
 * @classdesc å ä½å¯¹è±¡ç±»ï¼æè¿°å°çå¯¹è±¡çå ä½å¾å½¢ã
 * @usage
 */
class Geometry {


    constructor() {
        this.CLASS_NAME = "SuperMap.Geometry";
        /**
         * @member {string} Geometry.prototype.id
         * @description  å ä½å¯¹è±¡çå¯ä¸æ ç¤ºç¬¦ã
         *
         */
        this.id = Util.createUniqueID(this.CLASS_NAME + "_");

        /**
         * @member {Geometry} Geometry.prototype.parent
         * @description ç¶ç±»å ä½å¯¹è±¡ã
         */
        this.parent = null;

        /**
         * @member {Bounds} Geometry.prototype.bounds
         * @description å ä½å¯¹è±¡çèå´ã
         *
         */
        this.bounds = null;

        /**
         * @member {number} Geometry.prototype.SRID
         * @description æå½±åæ åæ°ãéè¿è¯¥åæ°ï¼æå¡å¨å¤æ­ Geometry å¯¹è±¡çåæ åèç³»æ¯å¦ä¸æ°æ®éç¸åï¼å¦æä¸åï¼åå¨æ°æ®å¥åºåè¿è¡æå½±åæ¢ã
         * @example
         * var geometry= new Geometry();
         * geometry. SRID=4326;
         *
         */
        this.SRID = null;
    }


    /**
     * @function Geometry.prototype.destroy
     * @description è§£æ Geometry ç±»ï¼éæ¾èµæºã
     */
    destroy() {
        this.id = null;
        this.bounds = null;
        this.SRID = null;
    }


    /**
     * @function Geometry.prototype.clone
     * @description åéå ä½å¾å½¢ãåéçå ä½å¾å½¢ä¸è®¾ç½®éæ åçå±æ§ã
     * @returns {Geometry} åéçå ä½å¾å½¢ã
     */
    clone() {
        return new Geometry();
    }


    /**
     * @function Geometry.prototype.setBounds
     * @description è®¾ç½®å ä½å¯¹è±¡ç boundsã
     * @param {Bounds} bounds - èå´ã
     */
    setBounds(bounds) {
        if (bounds) {
            this.bounds = bounds.clone();
        }
    }


    /**
     * @function Geometry.prototype.clearBounds
     * @description æ¸é¤å ä½å¯¹è±¡ç boundsã
     * å¦æè¯¥å¯¹è±¡æç¶ç±»ï¼ä¹ä¼æ¸é¤ç¶ç±»å ä½å¯¹è±¡ç boundsã
     */
    clearBounds() {
        this.bounds = null;
        if (this.parent) {
            this.parent.clearBounds();
        }
    }


    /**
     * @function Geometry.prototype.extendBounds
     * @description æ©å±ç°æè¾¹çä»¥åå«æ°è¾¹çãå¦æå°æªè®¾ç½®å ä½è¾¹çï¼åè®¾ç½®æ°è¾¹çã
     * @param {Bounds} newBounds - å ä½å¯¹è±¡ç boundsã
     */
    extendBounds(newBounds) {
        var bounds = this.getBounds();
        if (!bounds) {
            this.setBounds(newBounds);
        } else {
            this.bounds.extend(newBounds);
        }
    }


    /**
     * @function Geometry.prototype.getBounds
     * @description è·å¾å ä½å¾å½¢çè¾¹çãå¦ææ²¡æè®¾ç½®è¾¹çï¼å¯éè¿è®¡ç®è·å¾ã
     * @returns {Bounds} å ä½å¯¹è±¡çè¾¹çã
     */
    getBounds() {
        if (this.bounds == null) {
            this.calculateBounds();
        }
        return this.bounds;
    }


    /**
     * @function Geometry.prototype.calculateBounds
     * @description éæ°è®¡ç®å ä½å¾å½¢çè¾¹çï¼éè¦å¨å­ç±»ä¸­å®ç°æ­¤æ¹æ³ï¼ã
     */
    calculateBounds() {
        //
        // This should be overridden by subclasses.
        //
    }

    /**
     * @function Geometry.prototype.getVertices
     * @description è¿åå ä½å¾å½¢çææé¡¶ç¹çåè¡¨ï¼éè¦å¨å­ç±»ä¸­å®ç°æ­¤æ¹æ³ï¼ã
     * @param {boolean} [nodes] - å¦ææ¯ trueï¼çº¿ååªè¿åçº¿çæ«ç«¯ç¹ï¼å¦æ falseï¼ä»ä»è¿åé¡¶ç¹ï¼å¦ææ²¡æè®¾ç½®ï¼åè¿åé¡¶ç¹ã
     * @returns {Array} å ä½å¾å½¢çé¡¶ç¹åè¡¨ã
     */
    getVertices(nodes) { // eslint-disable-line no-unused-vars
    }

    /**
     * @function Geometry.prototype.getArea
     * @description è®¡ç®å ä½å¯¹è±¡çé¢ç§¯ ï¼æ­¤æ¹æ³éè¦å¨å­ç±»ä¸­å®ä¹ã
     * @returns {number} è®¡ç®åçå¯¹è±¡é¢ç§¯ã
     */
    getArea() {
        //to be overridden by geometries that actually have an area
        //
        return 0.0;
    }


    // /**
    //  * @function Geometry.prototype.toString
    //  * @description è¿ågeometryå¯¹è±¡çå­ç¬¦ä¸²è¡¨è¿°ï¼éè¦å¼å¥{@link WKTFormat}ãæ­¤æ¹æ³åªè½å¨å­ç±»å®ç°ï¼å¨ç¶ç±»ä½¿ç¨ä¼æ¥éã
    //  * @returns {string} geometryå¯¹è±¡çå­ç¬¦ä¸²è¡¨è¿°(Well-Known Text)
    //  */
    // toString() {
    // var string;
    // if (WKT) {
    //     var wkt = new WKT();
    //     string = wkt.write(new Vector(this));
    // } else {
    //     string = Object.prototype.toString.call(this);
    // }
    // return string;
    // }
}

;// CONCATENATED MODULE: ./src/common/commontypes/Util.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @description æµè§å¨åç§°ï¼ä¾èµäº userAgent å±æ§ï¼BROWSER_NAME å¯ä»¥æ¯ç©ºï¼æèä»¥ä¸æµè§å¨ï¼
 *     * "opera" -- Opera
 *     * "msie"  -- Internet Explorer
 *     * "safari" -- Safari
 *     * "firefox" -- Firefox
 *     * "mozilla" -- Mozilla
 * @category BaseTypes Constant
 * @constant {Object}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.Browser.name;
 *
 * </script>
 * // ES6 Import
 * import { Browser } from '{npm}';
 *
 * const result = Browser.name;
 * ```
 */
const Browser = (function () {
  var name = '',
    version = '',
    device = 'pc',
    uaMatch;
  //ä»¥ä¸è¿è¡æµè¯
  var ua = navigator.userAgent.toLowerCase();
  if (ua.indexOf('msie') > -1 || (ua.indexOf('trident') > -1 && ua.indexOf('rv') > -1)) {
    name = 'msie';
    uaMatch = ua.match(/msie ([\d.]+)/) || ua.match(/rv:([\d.]+)/);
  } else if (ua.indexOf('chrome') > -1) {
    name = 'chrome';
    uaMatch = ua.match(/chrome\/([\d.]+)/);
  } else if (ua.indexOf('firefox') > -1) {
    name = 'firefox';
    uaMatch = ua.match(/firefox\/([\d.]+)/);
  } else if (ua.indexOf('opera') > -1) {
    name = 'opera';
    uaMatch = ua.match(/version\/([\d.]+)/);
  } else if (ua.indexOf('safari') > -1) {
    name = 'safari';
    uaMatch = ua.match(/version\/([\d.]+)/);
  }
  version = uaMatch ? uaMatch[1] : '';

  if (ua.indexOf('ipad') > -1 || ua.indexOf('ipod') > -1 || ua.indexOf('iphone') > -1) {
    device = 'apple';
  } else if (ua.indexOf('android') > -1) {
    uaMatch = ua.match(/version\/([\d.]+)/);
    version = uaMatch ? uaMatch[1] : '';
    device = 'android';
  }
  return { name: name, version: version, device: device };
})();

const isSupportCanvas = (function () {
  var checkRes = true,
    broz = Browser;
  if (document.createElement('canvas').getContext) {
    if (broz.name === 'firefox' && parseFloat(broz.version) < 5) {
      checkRes = false;
    }
    if (broz.name === 'safari' && parseFloat(broz.version) < 4) {
      checkRes = false;
    }
    if (broz.name === 'opera' && parseFloat(broz.version) < 10) {
      checkRes = false;
    }
    if (broz.name === 'msie' && parseFloat(broz.version) < 9) {
      checkRes = false;
    }
  } else {
    checkRes = false;
  }
  return checkRes;
})();

/**
 * @description å¦æ userAgent æè·å°æµè§å¨ä½¿ç¨çæ¯ Gecko å¼æåè¿å trueã
 * @constant {number}
 * @private
 */
const IS_GECKO = (function () {
  var ua = navigator.userAgent.toLowerCase();
  return ua.indexOf('webkit') === -1 && ua.indexOf('gecko') !== -1;
})();

/**
 * @constant {number}
 * @default
 * @description åè¾¨çä¸æ¯ä¾å°ºä¹é´è½¬æ¢çå¸¸éã
 * @private
 */
const DOTS_PER_INCH = 96;

/**
 * @name CommonUtil
 * @namespace
 * @category BaseTypes Util
 * @description common å·¥å·ç±»ã
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.CommonUtil.getElement();
 *
 *   // å¼ç¨çåæ³
 *   const result = SuperMap.Util.getElement();
 *
 * </script>
 *
 * // ES6 Import
 * import { CommonUtil } from '{npm}';
 *
 * const result = CommonUtil.getElement();
 * ```
 */

const Util = {
  /**
   * @memberOf CommonUtil
   * @description å¤å¶æºå¯¹è±¡çææå±æ§å°ç®æ å¯¹è±¡ä¸ï¼æºå¯¹è±¡ä¸çæ²¡æå®ä¹çå±æ§å¨ç®æ å¯¹è±¡ä¸ä¹ä¸ä¼è¢«è®¾ç½®ã
   * @example
   * è¦å¤å¶ Size å¯¹è±¡çææå±æ§å°èªå®ä¹å¯¹è±¡ä¸ï¼ä½¿ç¨æ¹æ³å¦ä¸:
   *     var size = new Size(100, 100);
   *     var obj = {}ï¼
   *     CommonUtil.extend(obj, size);
   * @param {Object} [destination] - ç®æ å¯¹è±¡ã
   * @param {Object} source - æºå¯¹è±¡ï¼å¶å±æ§å°è¢«è®¾ç½®å°ç®æ å¯¹è±¡ä¸ã
   * @returns {Object} ç®æ å¯¹è±¡ã
   */

  extend: function (destination, source) {
    destination = destination || {};
    if (source) {
      for (var property in source) {
        var value = source[property];
        if (value !== undefined) {
          destination[property] = value;
        }
      }

      /**
       * IE doesn't include the toString property when iterating over an object's
       * properties with the for(property in object) syntax.  Explicitly check if
       * the source has its own toString property.
       */

      /*
       * FF/Windows < 2.0.0.13 reports "Illegal operation on WrappedNative
       * prototype object" when calling hawOwnProperty if the source object
       * is an instance of window.Event.
       */

      var sourceIsEvt = typeof window.Event === 'function' && source instanceof window.Event;

      if (!sourceIsEvt && source.hasOwnProperty && source.hasOwnProperty('toString')) {
        destination.toString = source.toString;
      }
    }
    return destination;
  },
  /**
   * @memberOf CommonUtil
   * @description å¯¹è±¡æ·è´ã
   * @param {Object} [des] - ç®æ å¯¹è±¡ã
   * @param {Object} soc - æºå¯¹è±¡ã
   */
  copy: function (des, soc) {
    des = des || {};
    var v;
    if (soc) {
      for (var p in des) {
        v = soc[p];
        if (typeof v !== 'undefined') {
          des[p] = v;
        }
      }
    }
  },
  /**
   * @memberOf CommonUtil
   * @description éæ¯å¯¹è±¡ï¼å°å¶å±æ§ç½®ç©ºã
   * @param {Object} [obj] - ç®æ å¯¹è±¡ã
   */
  reset: function (obj) {
    obj = obj || {};
    for (var p in obj) {
      if (obj.hasOwnProperty(p)) {
        if (typeof obj[p] === 'object' && obj[p] instanceof Array) {
          for (var i in obj[p]) {
            if (obj[p][i].destroy) {
              obj[p][i].destroy();
            }
          }
          obj[p].length = 0;
        } else if (typeof obj[p] === 'object' && obj[p] instanceof Object) {
          if (obj[p].destroy) {
            obj[p].destroy();
          }
        }
        obj[p] = null;
      }
    }
  },

  /**
   * @memberOf CommonUtil
   * @description è·å HTML åç´ æ°ç»ã
   * @returns {Array.<HTMLElement>} HTML åç´ æ°ç»ã
   */
  getElement: function () {
    var elements = [];

    for (var i = 0, len = arguments.length; i < len; i++) {
      var element = arguments[i];
      if (typeof element === 'string') {
        element = document.getElementById(element);
      }
      if (arguments.length === 1) {
        return element;
      }
      elements.push(element);
    }
    return elements;
  },

  /**
   * @memberOf CommonUtil
   * @description instance of çè·¨æµè§å¨å®ç°ã
   * @param {Object} o - å¯¹è±¡ã
   * @returns {boolean} æ¯å¦æ¯é¡µé¢åç´ ã
   */
  isElement: function (o) {
    return !!(o && o.nodeType === 1);
  },

  /**
   * @memberOf CommonUtil
   * @description å¤æ­ä¸ä¸ªå¯¹è±¡æ¯å¦æ¯æ°ç»ã
   * @param {Object} a - å¯¹è±¡ã
   * @returns {boolean} æ¯å¦æ¯æ°ç»ã
   */
  isArray: function (a) {
    return Object.prototype.toString.call(a) === '[object Array]';
  },

  /**
   * @memberOf CommonUtil
   * @description ä»æ°ç»ä¸­å é¤æä¸é¡¹ã
   * @param {Array} array - æ°ç»ã
   * @param {Object} item - æ°ç»ä¸­è¦å é¤çä¸é¡¹ã
   * @returns {Array} æ§è¡å é¤æä½åçæ°ç»ã
   */
  removeItem: function (array, item) {
    for (var i = array.length - 1; i >= 0; i--) {
      if (array[i] === item) {
        array.splice(i, 1);
        //break;more than once??
      }
    }
    return array;
  },

  /**
   * @memberOf CommonUtil
   * @description è·åæå¯¹è±¡å¨æ°ç»ä¸­çç´¢å¼å¼ã
   * @param {Array.<Object>} array - æ°ç»ã
   * @param {Object} obj - å¯¹è±¡ã
   * @returns {number} æå¯¹è±¡å¨æ°ç»ä¸­çç´¢å¼å¼ã
   */
  indexOf: function (array, obj) {
    if (array == null) {
      return -1;
    } else {
      // use the build-in function if available.
      if (typeof array.indexOf === 'function') {
        return array.indexOf(obj);
      } else {
        for (var i = 0, len = array.length; i < len; i++) {
          if (array[i] === obj) {
            return i;
          }
        }
        return -1;
      }
    }
  },

  /**
   * @memberOf CommonUtil
   * @description ä¿®æ¹æ DOM åç´ çè®¸å¤å±æ§ã
   * @param {HTMLElement} element - å¾ä¿®æ¹ç DOM åç´ ã
   * @param {string} [id] - DOM åç´ ç IDã
   * @param {Pixel} [px] - DOM åç´ ç style å±æ§ç left å top å±æ§ã
   * @param {Size} [sz] - DOM åç´ ç width å height å±æ§ã
   * @param {string} [position] - DOM åç´ ç position å±æ§ã
   * @param {string} [border] - DOM åç´ ç style å±æ§ç border å±æ§ã
   * @param {string} [overflow] - DOM åç´ ç style å±æ§ç overflow å±æ§ã
   * @param {number} [opacity] - ä¸éæåº¦å¼ãåå¼èå´ä¸º(0.0 - 1.0)ã
   */
  modifyDOMElement: function (element, id, px, sz, position, border, overflow, opacity) {
    if (id) {
      element.id = id;
    }
    if (px) {
      element.style.left = px.x + 'px';
      element.style.top = px.y + 'px';
    }
    if (sz) {
      element.style.width = sz.w + 'px';
      element.style.height = sz.h + 'px';
    }
    if (position) {
      element.style.position = position;
    }
    if (border) {
      element.style.border = border;
    }
    if (overflow) {
      element.style.overflow = overflow;
    }
    if (parseFloat(opacity) >= 0.0 && parseFloat(opacity) < 1.0) {
      element.style.filter = 'alpha(opacity=' + opacity * 100 + ')';
      element.style.opacity = opacity;
    } else if (parseFloat(opacity) === 1.0) {
      element.style.filter = '';
      element.style.opacity = '';
    }
  },

  /**
   * @memberOf CommonUtil
   * @description æ¯è¾ä¸¤ä¸ªå¯¹è±¡å¹¶åå¹¶ã
   * @param {Object} [to] - ç®æ å¯¹è±¡ã
   * @param {Object} from - æºå¯¹è±¡ã
   * @returns {Object} è¿ååå¹¶åçå¯¹è±¡ã
   */
  applyDefaults: function (to, from) {
    to = to || {};
    /*
     * FF/Windows < 2.0.0.13 reports "Illegal operation on WrappedNative
     * prototype object" when calling hawOwnProperty if the source object is an
     * instance of window.Event.
     */
    var fromIsEvt = typeof window.Event === 'function' && from instanceof window.Event;

    for (var key in from) {
      if (
        to[key] === undefined ||
        (!fromIsEvt && from.hasOwnProperty && from.hasOwnProperty(key) && !to.hasOwnProperty(key))
      ) {
        to[key] = from[key];
      }
    }
    /**
     * IE doesn't include the toString property when iterating over an object's
     * properties with the for(property in object) syntax.  Explicitly check if
     * the source has its own toString property.
     */
    if (
      !fromIsEvt &&
      from &&
      from.hasOwnProperty &&
      from.hasOwnProperty('toString') &&
      !to.hasOwnProperty('toString')
    ) {
      to.toString = from.toString;
    }

    return to;
  },

  /**
   * @memberOf CommonUtil
   * @description å°åæ°å¯¹è±¡è½¬æ¢ä¸º HTTP ç GET è¯·æ±ä¸­çåæ°å­ç¬¦ä¸²ãä¾å¦ï¼"key1=value1&key2=value2&key3=value3"ã
   * @param {Object} params - åæ°å¯¹è±¡ã
   * @returns {string} HTTP ç GET è¯·æ±ä¸­çåæ°å­ç¬¦ä¸²ã
   */
  getParameterString: function (params) {
    var paramsArray = [];

    for (var key in params) {
      var value = params[key];
      if (value != null && typeof value !== 'function') {
        var encodedValue;
        if (Array.isArray(value) || value.toString() === '[object Object]') {
          encodedValue = encodeURIComponent(JSON.stringify(value));
        } else {
          /* value is a string; simply encode */
          encodedValue = encodeURIComponent(value);
        }
        paramsArray.push(encodeURIComponent(key) + '=' + encodedValue);
      }
    }

    return paramsArray.join('&');
  },

  /**
   * @memberOf CommonUtil
   * @description ç» URL è¿½å æ¥è¯¢åæ°ã
   * @param {string} url - å¾è¿½å åæ°ç URL å­ç¬¦ä¸²ã
   * @param {string} paramStr - å¾è¿½å çæ¥è¯¢åæ°ã
   * @returns {string} æ°ç URLã
   */
  urlAppend: function (url, paramStr) {
    var newUrl = url;
    if (paramStr) {
      if (paramStr.indexOf('?') === 0) {
        paramStr = paramStr.substring(1);
      }
      var parts = (url + ' ').split(/[?&]/);
      newUrl += parts.pop() === ' ' ? paramStr : parts.length ? '&' + paramStr : '?' + paramStr;
    }
    return newUrl;
  },

  /**
   * @memberOf CommonUtil
   * @description ç» URL è¿½å  path åæ°ã
   * @param {string} url - å¾è¿½å åæ°ç URL å­ç¬¦ä¸²ã
   * @param {string} paramStr - å¾è¿½å çpathåæ°ã
   * @returns {string} æ°ç URLã
   */
  urlPathAppend: function (url, pathStr) {
    let newUrl = url;
    if (!pathStr) {
      return newUrl;
    }
    if (pathStr.indexOf('/') === 0) {
      pathStr = pathStr.substring(1);
    }
    const parts = url.split('?');
    if (parts[0].indexOf('/', parts[0].length - 1) < 0) {
      parts[0] += '/';
    }
    newUrl = `${parts[0]}${pathStr}${parts.length > 1 ? `?${parts[1]}` : ''}`;
    return newUrl;
  },

  /**
   * @memberOf CommonUtil
   * @description ä¸ºäºé¿åæµ®ç¹ç²¾åº¦éè¯¯èä¿ççææä½æ°ã
   * @type {number}
   * @default 14
   */
  DEFAULT_PRECISION: 14,

  /**
   * @memberOf CommonUtil
   * @description å°å­ç¬¦ä¸²ä»¥æ¥è¿çç²¾åº¦è½¬æ¢ä¸ºæ°å­ã
   * @param {string} number - å­ç¬¦ä¸²ã
   * @param {number} [precision=14] - ç²¾åº¦ã
   * @returns {number} è½¬ååçæ°å­ã
   */
  toFloat: function (number, precision) {
    if (precision == null) {
      precision = Util.DEFAULT_PRECISION;
    }
    if (typeof number !== 'number') {
      number = parseFloat(number);
    }
    return precision === 0 ? number : parseFloat(number.toPrecision(precision));
  },

  /**
   * @memberOf CommonUtil
   * @description è§åº¦è½¬å¼§åº¦ã
   * @param {number} x - è§åº¦ã
   * @returns {number} è½¬ååçå¼§åº¦ã
   */
  rad: function (x) {
    return (x * Math.PI) / 180;
  },

  /**
   * @memberOf CommonUtil
   * @description ä» URL å­ç¬¦ä¸²ä¸­è§£æåºåæ°å¯¹è±¡ã
   * @param {string} url - URLã
   * @returns {Object} è§£æåºçåæ°å¯¹è±¡ã
   */
  getParameters: function (url) {
    // if no url specified, take it from the location bar
    url = url === null || url === undefined ? window.location.href : url;

    //parse out parameters portion of url string
    var paramsString = '';
    if (StringExt.contains(url, '?')) {
      var start = url.indexOf('?') + 1;
      var end = StringExt.contains(url, '#') ? url.indexOf('#') : url.length;
      paramsString = url.substring(start, end);
    }

    var parameters = {};
    var pairs = paramsString.split(/[&;]/);
    for (var i = 0, len = pairs.length; i < len; ++i) {
      var keyValue = pairs[i].split('=');
      if (keyValue[0]) {
        var key = keyValue[0];
        try {
          key = decodeURIComponent(key);
        } catch (err) {
          key = unescape(key);
        }

        // being liberal by replacing "+" with " "
        var value = (keyValue[1] || '').replace(/\+/g, ' ');

        try {
          value = decodeURIComponent(value);
        } catch (err) {
          value = unescape(value);
        }

        // follow OGC convention of comma delimited values
        value = value.split(',');

        //if there's only one value, do not return as array
        if (value.length == 1) {
          value = value[0];
        }

        parameters[key] = value;
      }
    }
    return parameters;
  },

  /**
   * @memberOf CommonUtil
   * @description ä¸æ­éå¢è®¡æ°åéï¼ç¨äºçæå¯ä¸ IDã
   * @type {number}
   * @default 0
   */
  lastSeqID: 0,

  /**
   * @memberOf CommonUtil
   * @description åå»ºå¯ä¸ ID å¼ã
   * @param {string} [prefix] - åç¼ã
   * @returns {string} å¯ä¸ç ID å¼ã
   */
  createUniqueID: function (prefix) {
    if (prefix == null) {
      prefix = 'id_';
    }
    Util.lastSeqID += 1;
    return prefix + Util.lastSeqID;
  },

  /**
   * @memberOf CommonUtil
   * @description å¤æ­å¹¶è½¬åæ¯ä¾å°ºã
   * @param {number} scale - æ¯ä¾å°ºã
   * @returns {number} æ­£å¸¸ç scale å¼ã
   */
  normalizeScale: function (scale) {
    var normScale = scale > 1.0 ? 1.0 / scale : scale;
    return normScale;
  },

  /**
   * @memberOf CommonUtil
   * @description æ¯ä¾å°ºè½¬åè¾¨çã
   * @param {number} scale - æ¯ä¾å°ºã
   * @param {string} [units='degrees'] - æ¯ä¾å°ºåä½ã
   * @returns {number} è½¬ååçåè¾¨çã
   */
  getResolutionFromScale: function (scale, units) {
    var resolution;
    if (scale) {
      if (units == null) {
        units = 'degrees';
      }
      var normScale = Util.normalizeScale(scale);
      resolution = 1 / (normScale * INCHES_PER_UNIT[units] * DOTS_PER_INCH);
    }
    return resolution;
  },

  /**
   * @memberOf CommonUtil
   * @description åè¾¨çè½¬æ¯ä¾å°ºã
   * @param {number} resolution - åè¾¨çã
   * @param {string} [units='degrees'] - åè¾¨çåä½ã
   * @returns {number} è½¬ååçæ¯ä¾å°ºã
   */
  getScaleFromResolution: function (resolution, units) {
    if (units == null) {
      units = 'degrees';
    }

    var scale = resolution * INCHES_PER_UNIT[units] * DOTS_PER_INCH;
    return scale;
  },

  /**
   * @memberOf CommonUtil
   * @description è·åæµè§å¨ç¸å³ä¿¡æ¯ãæ¯æçæµè§å¨åæ¬ï¼Operaï¼Internet Explorerï¼Safariï¼Firefoxã
   * @returns {Object} æµè§å¨åç§°ãçæ¬ãè®¾å¤åç§°ãå¯¹åºçå±æ§åå«ä¸º name, version, deviceã
   */
  getBrowser: function () {
    return Browser;
  },

  /**
   * @memberOf CommonUtil
   * @description æµè§å¨æ¯å¦æ¯æ Canvasã
   * @returns {boolean} å½åæµè§å¨æ¯å¦æ¯æ HTML5 Canvasã
   */
  isSupportCanvas,

  /**
   * @memberOf CommonUtil
   * @description å¤æ­ï¼æµè§å¨æ¯å¦æ¯æ Canvasã
   * @returns {boolean} å½åæµè§å¨æ¯å¦æ¯æ HTML5 Canvas ã
   */
  supportCanvas: function () {
    return Util.isSupportCanvas;
  },

  /**
   * @memberOf CommonUtil
   * @description å¤æ­ä¸ä¸ª URL è¯·æ±æ¯å¦å¨å½ååä¸­ã
   * @param {string} url - URL è¯·æ±å­ç¬¦ä¸²ã
   * @returns {boolean} URL è¯·æ±æ¯å¦å¨å½ååä¸­ã
   */
  isInTheSameDomain: function (url) {
    if (!url) {
      return true;
    }
    var index = url.indexOf('//');
    var documentUrl = document.location.toString();
    var documentIndex = documentUrl.indexOf('//');
    if (index === -1) {
      return true;
    } else {
      var protocol;
      var substring = (protocol = url.substring(0, index));
      var documentSubString = documentUrl.substring(documentIndex + 2);
      documentIndex = documentSubString.indexOf('/');
      var documentPortIndex = documentSubString.indexOf(':');
      var documentDomainWithPort = documentSubString.substring(0, documentIndex);
      //var documentPort;

      var documentprotocol = document.location.protocol;
      if (documentPortIndex !== -1) {
        // documentPort = +documentSubString.substring(documentPortIndex, documentIndex);
      } else {
        documentDomainWithPort += ':' + (documentprotocol.toLowerCase() === 'http:' ? 80 : 443);
      }
      if (documentprotocol.toLowerCase() !== substring.toLowerCase()) {
        return false;
      }
      substring = url.substring(index + 2);
      var portIndex = substring.indexOf(':');
      index = substring.indexOf('/');
      var domainWithPort = substring.substring(0, index);
      var domain;
      if (portIndex !== -1) {
        domain = substring.substring(0, portIndex);
      } else {
        domain = substring.substring(0, index);
        domainWithPort += ':' + (protocol.toLowerCase() === 'http:' ? 80 : 443);
      }
      var documentDomain = document.domain;
      if (domain === documentDomain && domainWithPort === documentDomainWithPort) {
        return true;
      }
    }
    return false;
  },

  /**
   * @memberOf CommonUtil
   * @description è®¡ç® iServer æå¡ç REST å¾å±çæ¾ç¤ºåè¾¨çï¼éè¦ä» iServer ç REST å¾å±è¡¨è¿°ä¸­è·å viewBoundsãviewerãscaleãcoordUnitãdatumAxis äºä¸ªåæ°ï¼æ¥è¿è¡è®¡ç®ã
   * @param {Bounds} viewBounds - å°å¾çåç§å¯è§èå´ï¼å³å°å¾åå§åæ¶é»è®¤çå°å¾æ¾ç¤ºèå´ã
   * @param {Size} viewer - å°å¾åå§åæ¶é»è®¤çå°å¾å¾ççå°ºå¯¸ã
   * @param {number} scale - å°å¾åå§åæ¶é»è®¤çæ¾ç¤ºæ¯ä¾å°ºã
   * @param {string} [coordUnit='degrees'] - æå½±åæ ç³»ç»çå°å¾åä½ã
   * @param {number} [datumAxis=6378137] - å°çåæ ç³»ç»æ¤­çä½é¿åè½´ãç¨æ·èªå®ä¹å°å¾ç Options æ¶ï¼è¥æªæå®è¯¥åæ°çå¼ï¼åç³»ç»é»è®¤ä¸º WGS84 åèç³»çæ¤­çä½é¿åè½´ 6378137ã
   * @returns {number} å¾å±æ¾ç¤ºåè¾¨çã
   */
  calculateDpi: function (viewBounds, viewer, scale, coordUnit, datumAxis) {
    //10000 æ¯ 0.1æ¯«ç±³ä¸ç±³çè½¬æ¢ãDPIçè®¡ç®å¬å¼ï¼Viewer / DPI *  0.0254 * 10000 = ViewBounds * scale ï¼å¬å¼ä¸­ç10000æ¯ä¸ºäºæé«è®¡ç®ç»æçç²¾åº¦ï¼ä»¥ä¸åºç°çratioçä¸ºå¦æ­¤ã
    if (!viewBounds || !viewer || !scale) {
      return;
    }
    var ratio = 10000,
      rvbWidth = viewBounds.getWidth(),
      rvbHeight = viewBounds.getHeight(),
      rvWidth = viewer.w,
      rvHeight = viewer.h;
    //ç¨æ·èªå®ä¹å°å¾çOptionsæ¶ï¼è¥æªæå®è¯¥åæ°çå¼ï¼åç³»ç»é»è®¤ä¸º6378137ç±³ï¼å³WGS84åèç³»çæ¤­çä½é¿åè½´ã
    datumAxis = datumAxis || 6378137;
    coordUnit = coordUnit || 'degrees';
    var dpi;
    if (
      coordUnit.toLowerCase() === 'degree' ||
      coordUnit.toLowerCase() === 'degrees' ||
      coordUnit.toLowerCase() === 'dd'
    ) {
      let num1 = rvbWidth / rvWidth,
        num2 = rvbHeight / rvHeight,
        resolution = num1 > num2 ? num1 : num2;
      dpi = (0.0254 * ratio) / resolution / scale / ((Math.PI * 2 * datumAxis) / 360) / ratio;
    } else {
      let resolution = rvbWidth / rvWidth;
      dpi = (0.0254 * ratio) / resolution / scale / ratio;
    }
    return dpi;
  },

  /**
   * @memberOf CommonUtil
   * @description å°å¯¹è±¡è½¬æ¢æ JSON å­ç¬¦ä¸²ã
   * @param {Object} obj - è¦è½¬æ¢æ JSON ç Object å¯¹è±¡ã
   * @returns {string} è½¬æ¢åç JSON å¯¹è±¡ã
   */
  toJSON: function (obj) {
    var objInn = obj;
    if (objInn == null) {
      return null;
    }
    switch (objInn.constructor) {
      case String:
        //s = "'" + str.replace(/(["\\])/g, "\\$1") + "'";   stringå«æåå¼å·åºé
        objInn = '"' + objInn.replace(/(["\\])/g, '\\$1') + '"';
        objInn = objInn.replace(/\n/g, '\\n');
        objInn = objInn.replace(/\r/g, '\\r');
        objInn = objInn.replace('<', '&lt;');
        objInn = objInn.replace('>', '&gt;');
        objInn = objInn.replace(/%/g, '%25');
        objInn = objInn.replace(/&/g, '%26');
        return objInn;
      case Array:
        var arr = '';
        for (var i = 0, len = objInn.length; i < len; i++) {
          arr += Util.toJSON(objInn[i]);
          if (i !== objInn.length - 1) {
            arr += ',';
          }
        }
        return "[" + arr + "]";
      case Number:
        return isFinite(objInn) ? String(objInn) : null;
      case Boolean:
        return String(objInn);
      case Date:
        var dateStr =
          '{' +
          '\'__type\':"System.DateTime",' +
          "'Year':" +
          objInn.getFullYear() +
          ',' +
          "'Month':" +
          (objInn.getMonth() + 1) +
          ',' +
          "'Day':" +
          objInn.getDate() +
          ',' +
          "'Hour':" +
          objInn.getHours() +
          ',' +
          "'Minute':" +
          objInn.getMinutes() +
          ',' +
          "'Second':" +
          objInn.getSeconds() +
          ',' +
          "'Millisecond':" +
          objInn.getMilliseconds() +
          ',' +
          "'TimezoneOffset':" +
          objInn.getTimezoneOffset() +
          '}';
        return dateStr;
      default:
        if (objInn['toJSON'] != null && typeof objInn['toJSON'] === 'function') {
          return objInn.toJSON();
        }
        if (typeof objInn === 'object') {
          if (objInn.length) {
            let arr = [];
            for (let i = 0, len = objInn.length; i < len; i++) {
              arr.push(Util.toJSON(objInn[i]));
            }
            return '[' + arr.join(',') + ']';
          }
          let arr = [];
          for (let attr in objInn) {
            //ä¸ºè§£å³Geometryç±»åå¤´jsonæ¶å æ æº¢åºçé®é¢ï¼attr == "parent"æ¶ä¸è¿è¡jsonè½¬æ¢
            if (typeof objInn[attr] !== 'function' && attr !== 'CLASS_NAME' && attr !== 'parent') {
              arr.push("'" + attr + "':" + Util.toJSON(objInn[attr]));
            }
          }

          if (arr.length > 0) {
            return '{' + arr.join(',') + '}';
          } else {
            return '{}';
          }
        }
        return objInn.toString();
    }
  },

  /**
   * @memberOf CommonUtil
   * @description æ ¹æ®æ¯ä¾å°ºå dpi è®¡ç®å±å¹åè¾¨çã
   * @category BaseTypes Util
   * @param {number} scale - æ¯ä¾å°ºã
   * @param {number} dpi - å¾ååè¾¨çï¼è¡¨ç¤ºæ¯è±å¯¸åçåç´ ä¸ªæ°ã
   * @param {string} [coordUnit] - æå½±åæ ç³»ç»çå°å¾åä½ã
   * @param {number} [datumAxis=6378137] - å°çåæ ç³»ç»æ¤­çä½é¿åè½´ãç¨æ·èªå®ä¹å°å¾ç Options æ¶ï¼è¥æªæå®è¯¥åæ°çå¼ï¼å DPI é»è®¤æç§ WGS84 åèç³»çæ¤­çä½é¿åè½´ 6378137 æ¥è®¡ç®ã
   * @returns {number} å½åæ¯ä¾å°ºä¸çå±å¹åè¾¨çã
   */
  getResolutionFromScaleDpi: function (scale, dpi, coordUnit, datumAxis) {
    var resolution = null,
      ratio = 10000;
    //ç¨æ·èªå®ä¹å°å¾çOptionsæ¶ï¼è¥æªæå®è¯¥åæ°çå¼ï¼åç³»ç»é»è®¤ä¸º6378137ç±³ï¼å³WGS84åèç³»çæ¤­çä½é¿åè½´ã
    datumAxis = datumAxis || 6378137;
    coordUnit = coordUnit || '';
    if (scale > 0 && dpi > 0) {
      scale = Util.normalizeScale(scale);
      if (
        coordUnit.toLowerCase() === 'degree' ||
        coordUnit.toLowerCase() === 'degrees' ||
        coordUnit.toLowerCase() === 'dd'
      ) {
        //scale = Util.normalizeScale(scale);
        resolution = (0.0254 * ratio) / dpi / scale / ((Math.PI * 2 * datumAxis) / 360) / ratio;
        return resolution;
      } else {
        resolution = (0.0254 * ratio) / dpi / scale / ratio;
        return resolution;
      }
    }
    return -1;
  },

  /**
   * @memberOf CommonUtil
   * @description æ ¹æ® resolutionãdpiãcoordUnit å datumAxis è®¡ç®æ¯ä¾å°ºã
   * @param {number} resolution - ç¨äºè®¡ç®æ¯ä¾å°ºçå°å¾åè¾¨çã
   * @param {number} dpi - å¾ååè¾¨çï¼è¡¨ç¤ºæ¯è±å¯¸åçåç´ ä¸ªæ°ã
   * @param {string} [coordUnit] - æå½±åæ ç³»ç»çå°å¾åä½ã
   * @param {number} [datumAxis=6378137] - å°çåæ ç³»ç»æ¤­çä½é¿åè½´ãç¨æ·èªå®ä¹å°å¾ç Options æ¶ï¼è¥æªæå®è¯¥åæ°çå¼ï¼å DPI é»è®¤æç§ WGS84 åèç³»çæ¤­çä½é¿åè½´ 6378137 æ¥è®¡ç®ã
   * @returns {number} å½åå±å¹åè¾¨çä¸çæ¯ä¾å°ºã
   */
  getScaleFromResolutionDpi: function (resolution, dpi, coordUnit, datumAxis) {
    var scale = null,
      ratio = 10000;
    //ç¨æ·èªå®ä¹å°å¾çOptionsæ¶ï¼è¥æªæå®è¯¥åæ°çå¼ï¼åç³»ç»é»è®¤ä¸º6378137ç±³ï¼å³WGS84åèç³»çæ¤­çä½é¿åè½´ã
    datumAxis = datumAxis || 6378137;
    coordUnit = coordUnit || '';
    if (resolution > 0 && dpi > 0) {
      if (
        coordUnit.toLowerCase() === 'degree' ||
        coordUnit.toLowerCase() === 'degrees' ||
        coordUnit.toLowerCase() === 'dd'
      ) {
        scale = (0.0254 * ratio) / dpi / resolution / ((Math.PI * 2 * datumAxis) / 360) / ratio;
        return scale;
      } else {
        scale = (0.0254 * ratio) / dpi / resolution / ratio;
        return scale;
      }
    }
    return -1;
  },

  /**
   * @memberOf CommonUtil
   * @description è½¬æ¢æ¥è¯¢ç»æã
   * @param {Object} result - æ¥è¯¢ç»æã
   * @returns {Object} è½¬æ¢åçæ¥è¯¢ç»æã
   */
  transformResult: function (result) {
    if (result.responseText && typeof result.responseText === 'string') {
      result = JSON.parse(result.responseText);
    }
    return result;
  },

  /**
   * @memberOf CommonUtil
   * @description å±æ§æ·è´ï¼ä¸æ·è´æ¹æ³ç±»å(CLASS_NAME)ç­ã
   * @param {Object} [destination] - æ·è´ç®æ ã
   * @param {Object} source - æºå¯¹è±¡ã
   *
   */
  copyAttributes: function (destination, source) {
    destination = destination || {};
    if (source) {
      for (var property in source) {
        var value = source[property];
        if (value !== undefined && property !== 'CLASS_NAME' && typeof value !== 'function') {
          destination[property] = value;
        }
      }
    }
    return destination;
  },

  /**
   * @memberOf CommonUtil
   * @description å°æºå¯¹è±¡ä¸çå±æ§æ·è´å°ç®æ å¯¹è±¡ä¸ãï¼ä¸æ·è´ CLASS_NAME åæ¹æ³ï¼
   * @param {Object} [destination] - ç®æ å¯¹è±¡ã
   * @param {Object} source - æºå¯¹è±¡ã
   * @param {Array.<string>} clip - æºå¯¹è±¡ä¸­ç¦æ­¢æ·è´å°ç®æ å¯¹è±¡çå±æ§ï¼ç®çæ¯é²æ­¢ç®æ å¯¹è±¡ä¸ä¸å¯ä¿®æ¹çå±æ§è¢«ç¯¡æ¹ã
   *
   */
  copyAttributesWithClip: function (destination, source, clip) {
    destination = destination || {};
    if (source) {
      for (var property in source) {
        //å»æç¦æ­¢æ·è´çå±æ§
        var isInClip = false;
        if (clip && clip.length) {
          for (var i = 0, len = clip.length; i < len; i++) {
            if (property === clip[i]) {
              isInClip = true;
              break;
            }
          }
        }
        if (isInClip === true) {
          continue;
        }

        var value = source[property];
        if (value !== undefined && property !== 'CLASS_NAME' && typeof value !== 'function') {
          destination[property] = value;
        }
      }
    }
    return destination;
  },

  /**
   * @memberOf CommonUtil
   * @description åéä¸ä¸ª Object å¯¹è±¡
   * @param {Object} obj - éè¦åéçå¯¹è±¡ã
   * @returns {Object} å¯¹è±¡çæ·è´å¯¹è±¡ï¼æ³¨ææ¯æ°çå¯¹è±¡ï¼ä¸æ¯æåã
   */
  cloneObject: function (obj) {
    // Handle the 3 simple types, and null or undefined
    if (null === obj || 'object' !== typeof obj) {
      return obj;
    }

    // Handle Date
    if (obj instanceof Date) {
      let copy = new Date();
      copy.setTime(obj.getTime());
      return copy;
    }

    // Handle Array
    if (obj instanceof Array) {
      let copy = obj.slice(0);
      return copy;
    }

    // Handle Object
    if (obj instanceof Object) {
      let copy = {};
      for (var attr in obj) {
        if (obj.hasOwnProperty(attr)) {
          copy[attr] = Util.cloneObject(obj[attr]);
        }
      }
      return copy;
    }

    throw new Error("Unable to copy obj! Its type isn't supported.");
  },

  /**
   * @memberOf CommonUtil
   * @description å¤æ­ä¸¤æ¡çº¿æ®µæ¯ä¸æ¯æäº¤ç¹ã
   * @param {GeometryPoint} a1 - ç¬¬ä¸æ¡çº¿æ®µçèµ·å§èç¹ã
   * @param {GeometryPoint} a2 - ç¬¬ä¸æ¡çº¿æ®µçç»æèç¹ã
   * @param {GeometryPoint} b1 - ç¬¬äºæ¡çº¿æ®µçèµ·å§èç¹ã
   * @param {GeometryPoint} b2 - ç¬¬äºæ¡çº¿æ®µçç»æèç¹ã
   * @returns {Object} å¦æç¸äº¤è¿åäº¤ç¹ï¼å¦æä¸ç¸äº¤è¿åä¸¤æ¡çº¿æ®µçä½ç½®å³ç³»ã
   */
  lineIntersection: function (a1, a2, b1, b2) {
    var intersectValue = null;
    var k1;
    var k2;
    var b = (b2.x - b1.x) * (a1.y - b1.y) - (b2.y - b1.y) * (a1.x - b1.x);
    var a = (a2.x - a1.x) * (a1.y - b1.y) - (a2.y - a1.y) * (a1.x - b1.x);
    var ab = (b2.y - b1.y) * (a2.x - a1.x) - (b2.x - b1.x) * (a2.y - a1.y);
    //ab==0ä»£è¡¨ä¸¤æ¡çº¿æ­çæçä¸æ ·
    if (ab != 0) {
      k1 = b / ab;
      k2 = a / ab;

      if (k1 >= 0 && k2 <= 1 && k1 <= 1 && k2 >= 0) {
        intersectValue = new Geometry.Point(a1.x + k1 * (a2.x - a1.x), a1.y + k1 * (a2.y - a1.y));
      } else {
        intersectValue = 'No Intersection';
      }
    } else {
      if (b == 0 && a == 0) {
        var maxy = Math.max(a1.y, a2.y);
        var miny = Math.min(a1.y, a2.y);
        var maxx = Math.max(a1.x, a2.x);
        var minx = Math.min(a1.x, a2.x);
        if (
          (((b1.y >= miny && b1.y <= maxy) || (b2.y >= miny && b2.y <= maxy)) && b1.x >= minx && b1.x <= maxx) ||
          (b2.x >= minx && b2.x <= maxx)
        ) {
          intersectValue = 'Coincident'; //éå
        } else {
          intersectValue = 'Parallel'; //å¹³è¡
        }
      } else {
        intersectValue = 'Parallel'; //å¹³è¡
      }
    }
    return intersectValue;
  },

  /**
   * @memberOf CommonUtil
   * @description è·åææ¬å¤æ¥ç©å½¢å®½åº¦ä¸é«åº¦ã
   * @param {ThemeStyle} style - ææ¬æ ·å¼ã
   * @param {string} text - ææ¬åå®¹ã
   * @param {Object} element - DOM åç´ ã
   * @returns {Object} è£åªåçå®½åº¦ï¼é«åº¦ä¿¡æ¯ã
   */
  getTextBounds: function (style, text, element) {
    document.body.appendChild(element);
    element.style.width = 'auto';
    element.style.height = 'auto';
    if (style.fontSize) {
      element.style.fontSize = style.fontSize;
    }
    if (style.fontFamily) {
      element.style.fontFamily = style.fontFamily;
    }
    if (style.fontWeight) {
      element.style.fontWeight = style.fontWeight;
    }
    element.style.position = 'relative';
    element.style.visibility = 'hidden';
    //fix å¨æäºæåµä¸ï¼elementåçææ¬åæç«èµ·æåï¼å¯¼è´å®½åº¦è®¡ç®ä¸æ­£ç¡®çbug
    element.style.display = 'inline-block';
    element.innerHTML = text;
    var textWidth = element.clientWidth;
    var textHeight = element.clientHeight;
    document.body.removeChild(element);
    return {
      textWidth: textWidth,
      textHeight: textHeight
    };
  },
  /**
   * @memberOf CommonUtil
   * @description è·åè½¬æ¢åçpathè·¯å¾ã
   * @param {string} path - å¾è½¬æ¢çpath, åå«`{param}`ã
   * @param {Object} pathParams - pathä¸­å¾æ¿æ¢çåæ°ã
   * @returns {string} è½¬æ¢åçpathè·¯å¾
   */
  convertPath: function (path, pathParams) {
    if (!pathParams) {
      return path;
    }
    return path.replace(/\{([\w-\.]+)\}/g, (fullMatch, key) => {
      var value;
      if (pathParams.hasOwnProperty(key)) {
        value = paramToString(pathParams[key]);
      } else {
        value = fullMatch;
      }
      return encodeURIComponent(value);
    });
  }
};

/**
 * @enum INCHES_PER_UNIT
 * @description æ¯åä½çè±å°ºæ°ã
 * @type {number}
 * @private
 */
const INCHES_PER_UNIT = {
  inches: 1.0,
  ft: 12.0,
  mi: 63360.0,
  m: 39.3701,
  km: 39370.1,
  dd: 4374754,
  yd: 36
};
INCHES_PER_UNIT['in'] = INCHES_PER_UNIT.inches;
INCHES_PER_UNIT['degrees'] = INCHES_PER_UNIT.dd;
INCHES_PER_UNIT['nmi'] = 1852 * INCHES_PER_UNIT.m;

// Units from CS-Map
const METERS_PER_INCH = 0.0254000508001016002;
Util.extend(INCHES_PER_UNIT, {
  Inch: INCHES_PER_UNIT.inches,
  Meter: 1.0 / METERS_PER_INCH, //EPSG:9001
  Foot: 0.30480060960121920243 / METERS_PER_INCH, //EPSG:9003
  IFoot: 0.3048 / METERS_PER_INCH, //EPSG:9002
  ClarkeFoot: 0.3047972651151 / METERS_PER_INCH, //EPSG:9005
  SearsFoot: 0.30479947153867624624 / METERS_PER_INCH, //EPSG:9041
  GoldCoastFoot: 0.30479971018150881758 / METERS_PER_INCH, //EPSG:9094
  IInch: 0.0254 / METERS_PER_INCH,
  MicroInch: 0.0000254 / METERS_PER_INCH,
  Mil: 0.0000000254 / METERS_PER_INCH,
  Centimeter: 0.01 / METERS_PER_INCH,
  Kilometer: 1000.0 / METERS_PER_INCH, //EPSG:9036
  Yard: 0.91440182880365760731 / METERS_PER_INCH,
  SearsYard: 0.914398414616029 / METERS_PER_INCH, //EPSG:9040
  IndianYard: 0.91439853074444079983 / METERS_PER_INCH, //EPSG:9084
  IndianYd37: 0.91439523 / METERS_PER_INCH, //EPSG:9085
  IndianYd62: 0.9143988 / METERS_PER_INCH, //EPSG:9086
  IndianYd75: 0.9143985 / METERS_PER_INCH, //EPSG:9087
  IndianFoot: 0.30479951 / METERS_PER_INCH, //EPSG:9080
  IndianFt37: 0.30479841 / METERS_PER_INCH, //EPSG:9081
  IndianFt62: 0.3047996 / METERS_PER_INCH, //EPSG:9082
  IndianFt75: 0.3047995 / METERS_PER_INCH, //EPSG:9083
  Mile: 1609.34721869443738887477 / METERS_PER_INCH,
  IYard: 0.9144 / METERS_PER_INCH, //EPSG:9096
  IMile: 1609.344 / METERS_PER_INCH, //EPSG:9093
  NautM: 1852.0 / METERS_PER_INCH, //EPSG:9030
  'Lat-66': 110943.316488932731 / METERS_PER_INCH,
  'Lat-83': 110946.25736872234125 / METERS_PER_INCH,
  Decimeter: 0.1 / METERS_PER_INCH,
  Millimeter: 0.001 / METERS_PER_INCH,
  Dekameter: 10.0 / METERS_PER_INCH,
  Decameter: 10.0 / METERS_PER_INCH,
  Hectometer: 100.0 / METERS_PER_INCH,
  GermanMeter: 1.0000135965 / METERS_PER_INCH, //EPSG:9031
  CaGrid: 0.999738 / METERS_PER_INCH,
  ClarkeChain: 20.1166194976 / METERS_PER_INCH, //EPSG:9038
  GunterChain: 20.11684023368047 / METERS_PER_INCH, //EPSG:9033
  BenoitChain: 20.116782494375872 / METERS_PER_INCH, //EPSG:9062
  SearsChain: 20.11676512155 / METERS_PER_INCH, //EPSG:9042
  ClarkeLink: 0.201166194976 / METERS_PER_INCH, //EPSG:9039
  GunterLink: 0.2011684023368047 / METERS_PER_INCH, //EPSG:9034
  BenoitLink: 0.20116782494375872 / METERS_PER_INCH, //EPSG:9063
  SearsLink: 0.2011676512155 / METERS_PER_INCH, //EPSG:9043
  Rod: 5.02921005842012 / METERS_PER_INCH,
  IntnlChain: 20.1168 / METERS_PER_INCH, //EPSG:9097
  IntnlLink: 0.201168 / METERS_PER_INCH, //EPSG:9098
  Perch: 5.02921005842012 / METERS_PER_INCH,
  Pole: 5.02921005842012 / METERS_PER_INCH,
  Furlong: 201.1684023368046 / METERS_PER_INCH,
  Rood: 3.778266898 / METERS_PER_INCH,
  CapeFoot: 0.3047972615 / METERS_PER_INCH,
  Brealey: 375.0 / METERS_PER_INCH,
  ModAmFt: 0.304812252984505969011938 / METERS_PER_INCH,
  Fathom: 1.8288 / METERS_PER_INCH,
  'NautM-UK': 1853.184 / METERS_PER_INCH,
  '50kilometers': 50000.0 / METERS_PER_INCH,
  '150kilometers': 150000.0 / METERS_PER_INCH
});

//unit abbreviations supported by PROJ.4
Util.extend(INCHES_PER_UNIT, {
  mm: INCHES_PER_UNIT['Meter'] / 1000.0,
  cm: INCHES_PER_UNIT['Meter'] / 100.0,
  dm: INCHES_PER_UNIT['Meter'] * 100.0,
  km: INCHES_PER_UNIT['Meter'] * 1000.0,
  kmi: INCHES_PER_UNIT['nmi'], //International Nautical Mile
  fath: INCHES_PER_UNIT['Fathom'], //International Fathom
  ch: INCHES_PER_UNIT['IntnlChain'], //International Chain
  link: INCHES_PER_UNIT['IntnlLink'], //International Link
  'us-in': INCHES_PER_UNIT['inches'], //U.S. Surveyor's Inch
  'us-ft': INCHES_PER_UNIT['Foot'], //U.S. Surveyor's Foot
  'us-yd': INCHES_PER_UNIT['Yard'], //U.S. Surveyor's Yard
  'us-ch': INCHES_PER_UNIT['GunterChain'], //U.S. Surveyor's Chain
  'us-mi': INCHES_PER_UNIT['Mile'], //U.S. Surveyor's Statute Mile
  'ind-yd': INCHES_PER_UNIT['IndianYd37'], //Indian Yard
  'ind-ft': INCHES_PER_UNIT['IndianFt37'], //Indian Foot
  'ind-ch': 20.11669506 / METERS_PER_INCH //Indian Chain
});

//å°æå¡ç«¯çå°å¾åä½è½¬æSuperMapçå°å¾åä½
INCHES_PER_UNIT['degree'] = INCHES_PER_UNIT.dd;
INCHES_PER_UNIT['meter'] = INCHES_PER_UNIT.m;
INCHES_PER_UNIT['foot'] = INCHES_PER_UNIT.ft;
INCHES_PER_UNIT['inch'] = INCHES_PER_UNIT.inches;
INCHES_PER_UNIT['mile'] = INCHES_PER_UNIT.mi;
INCHES_PER_UNIT['kilometer'] = INCHES_PER_UNIT.km;
INCHES_PER_UNIT['yard'] = INCHES_PER_UNIT.yd;

function paramToString(param) {
  if (param == undefined || param == null) {
    return '';
  }
  if (param instanceof Date) {
    return param.toJSON();
  }
  if (canBeJsonified(param)) {
    return JSON.stringify(param);
  }

  return param.toString();
}

function canBeJsonified(str) {
  if (typeof str !== 'string' && typeof str !== 'object') {
    return false;
  }
  try {
    const type = str.toString();
    return type === '[object Object]' || type === '[object Array]';
  } catch (err) {
    return false;
  }
}



;// CONCATENATED MODULE: ./src/common/commontypes/LonLat.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class LonLat
 * @category BaseTypes Geometry
 * @classdesc  è¿ä¸ªç±»ç¨æ¥è¡¨ç¤ºç»åº¦åçº¬åº¦å¯¹ã
 * @param {number|Array.<number>} [lon=0.0] - å°å¾åä½ä¸ç X è½´åæ æèæ¨ªçºµåæ ç»æçæ°ç»ï¼å¦æå°å¾æ¯å°çæå½±ï¼åæ­¤å¼æ¯ç»åº¦ï¼å¦åï¼æ­¤å¼æ¯å°å¾å°çä½ç½®ç x åæ ã
 * @param {number} [lat=0.0] - å°å¾åä½ä¸ç Y è½´åæ ï¼å¦æå°å¾æ¯å°çæå½±ï¼åæ­¤å¼æ¯çº¬åº¦ï¼å¦åï¼æ­¤å¼æ¯å°å¾å°çä½ç½®ç y åæ ã
 * @example
 * var lonLat = new LonLat(30,45);
 * @usage
 */
class LonLat {


    constructor(lon, lat) {
        if (Util.isArray(lon)) {
            lat = lon[1];
            lon = lon[0];
        }
        /**
         * @member {number} [LonLat.prototype.lon=0.0]
         * @description å°å¾çåä½ç X è½´ï¼æ¨ªè½´ï¼åæ ã
         */
        this.lon = lon ? Util.toFloat(lon) : 0.0;

        /**
         * @member {number} [LonLat.prototype.lat=0.0]
         * @description å°å¾çåä½ç Y è½´ï¼çºµè½´ï¼åæ ã
         */
        this.lat = lat ? Util.toFloat(lat) : 0.0;
        this.CLASS_NAME = "SuperMap.LonLat";
    }

    /**
     * @function LonLat.prototype.toString
     * @description è¿åæ­¤å¯¹è±¡çå­ç¬¦ä¸²å½¢å¼
     * @example
     * var lonLat = new LonLat(100,50);
     * var str = lonLat.toString();
     * @returns {string} ä¾å¦: "lon=100,lat=50"
     */
    toString() {
        return ("lon=" + this.lon + ",lat=" + this.lat);
    }

    /**
     * @function LonLat.prototype.toShortString
     * @description å°ç»åº¦çº¬åº¦è½¬æ¢æç®åå­ç¬¦ä¸²ã
     * @example
     * var lonLat = new LonLat(100,50);
     * var str = lonLat.toShortString();
     * @returns {string} å¤çåçç»çº¬åº¦å­ç¬¦ä¸²ãä¾å¦ï¼"100,50"
     */
    toShortString() {
        return (this.lon + "," + this.lat);
    }

    /**
     * @function LonLat.prototype.clone
     * @description å¤å¶åæ å¯¹è±¡ï¼å¹¶è¿åå¤å¶åçæ°å¯¹è±¡ã
     * @example
     * var lonLat1 = new LonLat(100,50);
     * var lonLat2 = lonLat1.clone();
     * @returns {LonLat}  ç¸ååæ å¼çæ°çåæ å¯¹è±¡ã
     */
    clone() {
        return new LonLat(this.lon, this.lat);
    }

    /**
     * @function LonLat.prototype.add
     * @description å¨å·²æåæ å¯¹è±¡çç»çº¬åº¦åºç¡ä¸å ä¸æ°çåæ ç»çº¬åº¦ï¼å¹¶è¿åæ°çåæ å¯¹è±¡ã
     * @example
     * var lonLat1 = new LonLat(100,50);
     * //lonLat2 æ¯æ°çå¯¹è±¡
     * var lonLat2 = lonLat1.add(100,50);
     * @param {number} lon - ç»åº¦åæ°ã
     * @param {number} lat - çº¬åº¦åæ°ã
     * @returns {LonLat} æ°ç LonLat å¯¹è±¡ï¼æ­¤å¯¹è±¡çç»çº¬åº¦æ¯ç±ä¼ å¥çç»çº¬åº¦ä¸å½åçç»çº¬åº¦ç¸å æå¾ã
     */
    add(lon, lat) {
        if ((lon == null) || (lat == null)) {
            throw new TypeError('LonLat.add cannot receive null values');
        }
        return new LonLat(this.lon + Util.toFloat(lon),
            this.lat + Util.toFloat(lat));
    }

    /**
     * @function LonLat.prototype.equals
     * @description å¤æ­ä¸¤ä¸ªåæ å¯¹è±¡æ¯å¦ç¸ç­ã
     * @example
     * var lonLat1 = new LonLat(100,50);
     * var lonLat2 = new LonLat(100,50);
     * var isEquals = lonLat1.equals(lonLat2);
     * @param {LonLat} ll - éè¦è¿è¡æ¯è¾çåæ å¯¹è±¡ã
     * @returns {boolean} å¦æLonLatå¯¹è±¡çç»çº¬åº¦åä¼ å¥çç»çº¬åº¦ä¸è´åè¿åtrue,ä¸ä¸
     *      è´æä¼ å¥çllåæ°ä¸ºNULLåè¿åfalseã
     */
    equals(ll) {
        var equals = false;
        if (ll != null) {
            equals = ((this.lon === ll.lon && this.lat === ll.lat) ||
                (isNaN(this.lon) && isNaN(this.lat) && isNaN(ll.lon) && isNaN(ll.lat)));
        }
        return equals;
    }

    /**
     * @function LonLat.prototype.wrapDateLine
     * @description éè¿ä¼ å¥çèå´å¯¹è±¡å¯¹åæ å¯¹è±¡è½¬æ¢å°è¯¥èå´åã
     * å¦æç»åº¦å°äºç»å®èå´æå°ç²¾åº¦ï¼åå¨åç»åº¦åºç¡ä¸å ä¸èå´å®½åº¦ï¼ç´å°ç²¾åº¦å¨èå´åä¸ºæ­¢ï¼å¦æç»åº¦å¤§äºç»å®èå´åå¨åç»åº¦åºç¡ä¸åå»èå´å®½åº¦ã
     * å³æå°ä¸å¨ç»åº¦èå´åçåæ è½¬æ¢å°èå´ä»¥åï¼åªä¼è½¬æ¢ lonï¼ä¸ä¼è½¬æ¢ latï¼ä¸»è¦ç¨äºè½¬ç§»å°æ¥ççº¿ä»¥åï¼ã
     * @example
     * var lonLat1 = new LonLat(420,50);
     * var lonLat2 = lonLat1.wrapDateLine(
     *      new Bounds(-180,-90,180,90)
     *  );
     * @param {Bounds} maxExtent - æå¤§è¾¹ççèå´ã
     * @returns {LonLat} å°åæ è½¬æ¢å°èå´å¯¹è±¡ä»¥åï¼å¹¶è¿åæ°çåæ ã
     */
    wrapDateLine(maxExtent) {

        var newLonLat = this.clone();

        if (maxExtent) {
            //shift right?
            while (newLonLat.lon < maxExtent.left) {
                newLonLat.lon += maxExtent.getWidth();
            }

            //shift left?
            while (newLonLat.lon > maxExtent.right) {
                newLonLat.lon -= maxExtent.getWidth();
            }
        }

        return newLonLat;
    }

    /**
     *
     * @function LonLat.prototype.destroy
     * @description éæ¯æ­¤å¯¹è±¡ã
     * éæ¯åæ­¤å¯¹è±¡çææå±æ§ä¸º nullï¼èä¸æ¯åå§å¼ã
     * @example
     * var lonLat = new LonLat(100,50);
     * lonLat.destroy();
     */
    destroy() {
        this.lon = null;
        this.lat = null;
    }

    /**
     * @function LonLat.fromString
     * @description éè¿å­ç¬¦ä¸²çæä¸ä¸ª {@link LonLat} å¯¹è±¡ã
     * @example
     * var str = "100,50";
     * var lonLat = LonLat.fromString(str);
     * @param {string} str - å­ç¬¦ä¸²çæ ¼å¼ï¼Lon+","+Latãå¦ï¼"100,50"ã
     * @returns {LonLat} {@link LonLat} å¯¹è±¡ã
     */
    static fromString(str) {
        var pair = str.split(",");
        return new LonLat(pair[0], pair[1]);
    }

    /**
     * @function LonLat.fromArray
     * @description éè¿æ°ç»çæä¸ä¸ª {@link LonLat} å¯¹è±¡ã
     * @param {Array.<number>} arr - æ°ç»çæ ¼å¼ï¼é¿åº¦åªè½ä¸º2,ï¼[Lon,Lat]ãå¦ï¼[5,-42]ã
     * @returns {LonLat} {@link LonLat} å¯¹è±¡ã
     */
    static fromArray(arr) {
        var gotArr = Util.isArray(arr),
            lon = gotArr && arr[0],
            lat = gotArr && arr[1];
        return new LonLat(lon, lat);
    }


}


;// CONCATENATED MODULE: ./src/common/commontypes/Bounds.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class Bounds
 * @deprecatedclass SuperMap.Bounds
 * @category BaseTypes Geometry
 * @classdesc è¡¨ç¤ºè¾¹çç±»å®ä¾ãä½¿ç¨ bounds ä¹åéè¦è®¾ç½® leftï¼bottomï¼rightï¼top åä¸ªå±æ§ï¼è¿äºå±æ§çåå§å¼ä¸º nullã
 * @param {number|Array.<number>} [left] - å¦ææ¯numberï¼åè¡¨ç¤ºå·¦è¾¹çï¼æ³¨æèèå®½åº¦ï¼çè®ºä¸å°äº right å¼ãå¦ææ¯æ°ç»ï¼åè¡¨ç¤º [left, bottom, right, top] å·¦ä¸å³ä¸ç»æçæ°ç»ã
 * @param {number} [bottom] - ä¸è¾¹çãèèé«åº¦ï¼çè®ºä¸å°äº top å¼ã
 * @param {number} [right] - å³è¾¹çã
 * @param {number} [top] - ä¸è¾¹çã
 * @example
 * var bounds = new Bounds();
 * bounds.extend(new LonLat(4,5));
 * bounds.extend(new LonLat(5,6));
 * bounds.toBBOX(); // returns 4,5,5,6
 * @usage
 */
class Bounds {


    constructor(left, bottom, right, top) {
        if (Util.isArray(left)) {
            top = left[3];
            right = left[2];
            bottom = left[1];
            left = left[0];
        }
        /**
         * @member {number} Bounds.prototype.left
         * @description æå°çæ°´å¹³åæ ç³»ã
         */
        this.left = left != null ? Util.toFloat(left) : this.left;

        /**
         * @member {number} Bounds.prototype.bottom
         * @description æå°çåç´åæ ç³»ã
         */
        this.bottom = bottom != null ? Util.toFloat(bottom) : this.bottom;

        /**
         * @member {number} Bounds.prototype.right
         * @description æå¤§çæ°´å¹³åæ ç³»ã
         */
        this.right = right != null ? Util.toFloat(right) : this.right;

        /**
         * @member {number} Bounds.prototype.top
         * @description æå¤§çåç´åæ ç³»ã
         */
        this.top = top != null ? Util.toFloat(top) : this.top;

        /**
         * @member {LonLat} Bounds.prototype.centerLonLat
         * @description bounds çå°å¾ç©ºé´çä¸­å¿ç¹ãç¨ getCenterLonLat() è·å¾ã
         */
        this.centerLonLat = null;
        this.CLASS_NAME = "SuperMap.Bounds";
    }

    /**
     * @function Bounds.prototype.clone
     * @description å¤å¶å½å bounds å¯¹è±¡ã
     * @example
     * var bounds1 = new Bounds(-180,-90,180,90);
     * var bounds2 = bounds1.clone();
     * @returns {Bounds} åéåç boundsã
     */
    clone() {
        return new Bounds(this.left, this.bottom,
            this.right, this.top);
    }

    /**
     * @function Bounds.prototype.equals
     * @description å¤æ­ä¸¤ä¸ª bounds å¯¹è±¡æ¯å¦ç¸ç­ã
     * @example
     * var bounds1 = new Bounds(-180,-90,180,90);
     * var bounds2 = new Bounds(-180,-90,180,90);
     * var isEquals = bounds1.equals(bounds2);
     * @param {Bounds} bounds - éè¦è¿è¡è®¡è¾ç boundsã
     * @returns {boolean} å¦æ bounds å¯¹è±¡çè¾¹åä¼ å¥ç bounds ä¸è´åè¿å trueï¼ä¸ä¸è´æä¼ å¥ç bounds åæ°ä¸º NULL åè¿å falseã
     */
    equals(bounds) {
        var equals = false;
        if (bounds != null) {
            equals = ((this.left === bounds.left) &&
                (this.right === bounds.right) &&
                (this.top === bounds.top) &&
                (this.bottom === bounds.bottom));
        }
        return equals;
    }

    /**
     * @function Bounds.prototype.toString
     * @description è¿åæ­¤å¯¹è±¡çå­ç¬¦ä¸²å½¢å¼ã
     * @example
     * var bounds = new Bounds(-180,-90,180,90);
     * var str = bounds.toString();
     * @returns {string} è¾¹çå¯¹è±¡çå­ç¬¦ä¸²è¡¨ç¤ºå½¢å¼ï¼left,bottom,right,topï¼ï¼ä¾å¦: "-180,-90,180,90"ã
     */
    toString() {
        return [this.left, this.bottom, this.right, this.top].join(",");
    }

    /**
     * @function Bounds.prototype.toArray
     * @description è¾¹çå¯¹è±¡çæ°ç»è¡¨ç¤ºå½¢å¼ã
     * @example
     * var bounds = new Bounds(-180,-90,100,80);
     * //array1 = [-180,-90,100,80];
     * var array1 = bounds.toArray();
     * //array1 = [-90,-180,80,100];
     * var array2 = bounds.toArray(true);
     * @param {boolean} [reverseAxisOrder=false] - æ¯å¦åè½¬è½´é¡ºåºã
     * å¦æè®¾ä¸º trueï¼ååè½¬é¡ºåºï¼bottom,left,top,rightï¼ï¼å¦åææ­£å¸¸è½´é¡ºåºï¼left,bottom,right,topï¼ã
     * @returns {Array.<number>} left, bottom, right, top æ°ç»ã
     */
    toArray(reverseAxisOrder) {
        if (reverseAxisOrder === true) {
            return [this.bottom, this.left, this.top, this.right];
        } else {
            return [this.left, this.bottom, this.right, this.top];
        }
    }

    /**
     * @function Bounds.prototype.toBBOX
     * @description åå°æ°ç¹å decimal ä½æ°å­è¿è¡åèäºå¥åè½¬æ¢ä¸º BBOX å­ç¬¦ä¸²ã
     * @example
     * var bounds = new Bounds(-1.1234567,-1.7654321,1.4444444,1.5555555);
     * //str1 = "-1.123457,-1.765432,1.444444,1.555556";
     * var str1 = bounds.toBBOX();
     * //str2 = "-1.1,-1.8,1.4,1.6";
     * var str2 = bounds.toBBOX(1);
     * //str2 = "-1.8,-1.1,1.6,1.4";
     * var str2 = bounds.toBBOX(1,true);
     * @param {number} [decimal=6] - è¾¹çæ¹ä½åæ çæææ°å­ä¸ªæ°ã
     * @param {boolean} [reverseAxisOrder=false] - æ¯å¦æ¯åè½¬è½´é¡ºåºã
     * å¦æè®¾ä¸ºtrueï¼ååè½¬é¡ºåºï¼bottom,left,top,rightï¼,å¦åææ­£å¸¸è½´é¡ºåºï¼left,bottom,right,topï¼ã
     * @returns {string} è¾¹çå¯¹è±¡çå­ç¬¦ä¸²è¡¨ç¤ºå½¢å¼ï¼å¦ï¼"5,42,10,45"ã
     */
    toBBOX(decimal, reverseAxisOrder) {
        if (decimal == null) {
            decimal = 6;
        }
        var mult = Math.pow(10, decimal);
        var xmin = Math.round(this.left * mult) / mult;
        var ymin = Math.round(this.bottom * mult) / mult;
        var xmax = Math.round(this.right * mult) / mult;
        var ymax = Math.round(this.top * mult) / mult;
        if (reverseAxisOrder === true) {
            return ymin + "," + xmin + "," + ymax + "," + xmax;
        } else {
            return xmin + "," + ymin + "," + xmax + "," + ymax;
        }
    }

    ///**
    // * @function Bounds.prototype.toGeometry
    // * @description åºäºå½åè¾¹çèå´åå»ºä¸ä¸ªæ°çå¤è¾¹å½¢å¯¹è±¡ã
    // * @example
    // * var bounds = new Bounds(-180,-90,100,80);
    // * // Polygonå¯¹è±¡
    // * var geo = bounds.toGeometry();
    // * @returns {GeometryPolygon} åºäºå½å bounds åæ åå»ºçæ°çå¤è¾¹å½¢ã
    // */
    // toGeometry() {
    //     return new Polygon([
    //         new LinearRing([
    //             new Point(this.left, this.bottom),
    //             new Point(this.right, this.bottom),
    //             new Point(this.right, this.top),
    //             new Point(this.left, this.top)
    //         ])
    //     ]);
    // }

    /**
     * @function Bounds.prototype.getWidth
     * @description è·å bounds çå®½åº¦ã
     * @example
     * var bounds = new Bounds(-180,-90,100,80);
     * //width = 280;
     * var width = bounds.getWidth();
     * @returns {number} è·åå½å bounds çå®½åº¦ï¼right åå» leftï¼ã
     */
    getWidth() {
        return (this.right - this.left);
    }

    /**
     * @function Bounds.prototype.getHeight
     * @description è·å bounds çé«åº¦ã
     * @example
     * var bounds = new Bounds(-180,-90,100,80);
     * //height = 170;
     * var height = bounds.getHeight();
     * @returns {number} è¾¹çé«åº¦ï¼top åå» bottomï¼ã
     */
    getHeight() {
        return (this.top - this.bottom);
    }

    /**
     * @function Bounds.prototype.getSize
     * @description è·åè¾¹æ¡å¤§å°ã
     * @example
     * var bounds = new Bounds(-180,-90,100,80);
     * var size = bounds.getSize();
     * @returns {Size} è¾¹æ¡å¤§å°ã
     */
    getSize() {
        return new Size(this.getWidth(), this.getHeight());
    }

    /**
     * @function Bounds.prototype.getCenterPixel
     * @description è·ååç´ æ ¼å¼çèå´ä¸­å¿ç¹ã
     * @example
     * var bounds = new Bounds(-180,-90,100,80);
     * var pixel = bounds.getCenterPixel();
     * @returns {Pixel} åç´ æ ¼å¼çå½åèå´çä¸­å¿ç¹ã
     */
    getCenterPixel() {
        return new Pixel((this.left + this.right) / 2,
            (this.bottom + this.top) / 2);
    }

    /**
     * @function Bounds.prototype.getCenterLonLat
     * @description è·åå°çæ ¼å¼çèå´ä¸­å¿ç¹ã
     * @example
     * var bounds = new Bounds(-180,-90,100,80);
     * var lonlat = bounds.getCenterLonLat();
     * @returns {LonLat} å½åå°çèå´çä¸­å¿ç¹ã
     */
    getCenterLonLat() {
        if (!this.centerLonLat) {
            this.centerLonLat = new LonLat(
                (this.left + this.right) / 2, (this.bottom + this.top) / 2
            );
        }
        return this.centerLonLat;
    }

    /**
     * @function Bounds.prototype.scale
     * @description æç§æ¯ä¾æ©å¤§/ç¼©å°åºä¸ä¸ªæ°ç boundsã
     * @example
     * var bounds = new Bounds(-50,-50,40,40);
     * var bounds2 = bounds.scale(2);
     * @param {number} [ratio=1] - éè¦æ©å¤§çæ¯ä¾ã
     * @param {(Pixel|LonLat)} [origin] - æ©å¤§æ¶çåºåç¹ï¼é»è®¤ä¸ºå½å bounds çä¸­å¿ç¹ã
     * @returns {Bounds} éè¿ ratioãorigin è®¡ç®å¾å°çæ°çè¾¹çèå´ã
     */
    scale(ratio, origin) {
        ratio = ratio ? ratio : 1;
        if (origin == null) {
            origin = this.getCenterLonLat();
        }

        var origx, origy;

        // get origin coordinates
        if (origin.CLASS_NAME === "SuperMap.LonLat") {
            origx = origin.lon;
            origy = origin.lat;
        } else {
            origx = origin.x;
            origy = origin.y;
        }

        var left = (this.left - origx) * ratio + origx;
        var bottom = (this.bottom - origy) * ratio + origy;
        var right = (this.right - origx) * ratio + origx;
        var top = (this.top - origy) * ratio + origy;

        return new Bounds(left, bottom, right, top);
    }

    /**
     * @function Bounds.prototype.add
     * @description å¨å½åç Bounds ä¸æç§ä¼ å¥çåæ ç¹è¿è¡å¹³ç§»ï¼è¿åæ°çèå´ã
     * @example
     * var bounds1 = new Bounds(-50,-50,40,40);
     * //bounds2 æ¯æ°ç bounds
     * var bounds2 = bounds.add(20,10);
     * @param {number} x - åæ ç¹ç x åæ ã
     * @param {number} y - åæ ç¹ç y åæ ã
     * @returns {Bounds} æ°ç boundsï¼æ­¤ bounds çåæ æ¯ç±ä¼ å¥ç xï¼y åæ°ä¸å½å bounds åæ è®¡ç®æå¾ã
     */
    add(x, y) {
        if ((x == null) || (y == null)) {
            throw new TypeError('Bounds.add cannot receive null values');
        }
        return new Bounds(this.left + x, this.bottom + y,
            this.right + x, this.top + y);
    }

    /**
     * @function Bounds.prototype.extend
     * @description å¨å½å bounds ä¸æ©å± boundsï¼æ¯æ pointï¼lanlat å boundsãæ©å±åç bounds çèå´æ¯ä¸¤èçç»åã
     * @example
     * var bounds1 = new Bounds(-50,-50,40,40);
     * //bounds æ¹å
     * bounds.extend(new LonLat(50,60));
     * @param {GeometryPoint|LonLat|Bounds} object - å¯ä»¥æ¯ pointãlonlat å boundsã
     */
    extend(object) {
        var bounds = null;
        if (object) {
            // clear cached center location
            switch (object.CLASS_NAME) {
                case "SuperMap.LonLat":
                    bounds = new Bounds(object.lon, object.lat,
                        object.lon, object.lat);
                    break;
                case "SuperMap.Geometry.Point":
                    bounds = new Bounds(object.x, object.y,
                        object.x, object.y);
                    break;

                case "SuperMap.Bounds":
                    bounds = object;
                    break;
            }

            if (bounds) {
                this.centerLonLat = null;
                if ((this.left == null) || (bounds.left < this.left)) {
                    this.left = bounds.left;
                }
                if ((this.bottom == null) || (bounds.bottom < this.bottom)) {
                    this.bottom = bounds.bottom;
                }
                if ((this.right == null) || (bounds.right > this.right)) {
                    this.right = bounds.right;
                }
                if ((this.top == null) || (bounds.top > this.top)) {
                    this.top = bounds.top;
                }
            }
        }
    }

    /**
     * @function Bounds.prototype.containsLonLat
     * @description å¤æ­ä¼ å¥çåæ æ¯å¦å¨èå´åã
     * @example
     * var bounds1 = new Bounds(-50,-50,40,40);
     * //isContains1 = true
     * //è¿éçç¬¬äºä¸ªåæ°å¯ä»¥ç´æ¥ä¸º boolean ç±»åï¼ä¹å°±æ¯inclusive
     * var isContains1 = bounds.containsLonLat(new LonLat(40,40),true);
     *
     * //(40,40)å¨èå´åï¼åæ ·(40+360,40)ä¹å¨èå´å
     * var bounds2 = new Bounds(-50,-50,40,40);
     * //isContains2 = true;
     * var isContains2 = bounds2.containsLonLat(
     *      new LonLat(400,40),
     *      {
     *           inclusive:true,
     *           //å¨ççèå´
     *           worldBounds: new Bounds(-180,-90,180,90)
     *      }
     * );
     * @param {(LonLat|Object)} ll - <LonLat> å¯¹è±¡æèæ¯ä¸ä¸ªåå« 'lon' ä¸ 'lat' å±æ§çå¯¹è±¡ã
     * @param {Object} options - å¯éåæ°ã
     * @param {boolean} [options.inclusive=true] - æ¯å¦åå«è¾¹çã
     * @param {Bounds} [options.worldBounds] - å¦ææä¾ worldBounds åæ°, å¦æ ll åæ°æä¾çåæ è¶åºäºä¸çè¾¹çï¼worldBoundsï¼ï¼
     *        ä½æ¯éè¿æ¥ççº¿çè½¬åå¯ä»¥è¢«åå«, å®å°è¢«è®¤ä¸ºæ¯åå«å¨è¯¥èå´åçã
     * @returns {boolean} ä¼ å¥åæ æ¯å¦åå«å¨èå´åã
     */
    containsLonLat(ll, options) {
        if (typeof options === "boolean") {
            options = {inclusive: options};
        }
        options = options || {};
        var contains = this.contains(ll.lon, ll.lat, options.inclusive),
            worldBounds = options.worldBounds;
        //æ¥ççº¿ä»¥å¤çä¹æå¯è½ç®åå«ï¼
        if (worldBounds && !contains) {
            var worldWidth = worldBounds.getWidth();
            var worldCenterX = (worldBounds.left + worldBounds.right) / 2;
            //è¿ä¸æ­¥å¾å³é®
            var worldsAway = Math.round((ll.lon - worldCenterX) / worldWidth);
            contains = this.containsLonLat({
                lon: ll.lon - worldsAway * worldWidth,
                lat: ll.lat
            }, {inclusive: options.inclusive});
        }
        return contains;
    }

    /**
     * @function Bounds.prototype.containsPixel
     * @description å¤æ­ä¼ å¥çåç´ æ¯å¦å¨èå´åãç´æ¥å¹éå¤§å°ï¼ä¸æ¶ååç´ åå°çè½¬æ¢ã
     * @example
     * var bounds = new Bounds(-50,-50,40,40);
     * //isContains = true
     * var isContains = bounds.containsPixel(new Pixel(40,40),true);
     * @param {Pixel} px - æä¾çåç´ åæ°ã
     * @param {boolean} [inclusive=true] - æ¯å¦åå«è¾¹çã
     * @returns {boolean} ä¼ å¥ç pixel å¨å½åè¾¹çèå´ä¹åã
     */
    containsPixel(px, inclusive) {
        return this.contains(px.x, px.y, inclusive);
    }

    /**
     * @function Bounds.prototype.contains
     * @description å¤æ­ä¼ å¥ç xï¼y åæ å¼æ¯å¦å¨èå´åã
     * @example
     * var bounds = new Bounds(-50,-50,40,40);
     * //isContains = true
     * var isContains = bounds.contains(40,40,true);
     * @param {number} x - x åæ å¼ã
     * @param {number} y - y åæ å¼ã
     * @param {boolean} [inclusive=true] - æ¯å¦åå«è¾¹çã
     * @returns {boolean} ä¼ å¥ç xï¼y åæ æ¯å¦å¨å½åèå´åã
     */
    contains(x, y, inclusive) {
        //set default
        if (inclusive == null) {
            inclusive = true;
        }

        if (x == null || y == null) {
            return false;
        }

        //x = Util.toFloat(x);
        //y = Util.toFloat(y);

        var contains = false;
        if (inclusive) {
            contains = ((x >= this.left) && (x <= this.right) &&
                (y >= this.bottom) && (y <= this.top));
        } else {
            contains = ((x > this.left) && (x < this.right) &&
                (y > this.bottom) && (y < this.top));
        }
        return contains;
    }

    /**
     * @function Bounds.prototype.intersectsBounds
     * @description å¤æ­ç®æ è¾¹çèå´æ¯å¦ä¸å½åè¾¹çèå´ç¸äº¤ãå¦æä¸¤ä¸ªè¾¹çèå´ä¸­çä»»æ
     *              è¾¹ç¼ç¸äº¤æèä¸ä¸ªè¾¹çåå«äºå¦å¤ä¸ä¸ªå°±è®¤ä¸ºè¿ä¸¤ä¸ªè¾¹çç¸äº¤ã
     * @example
     * var bounds = new Bounds(-180,-90,100,80);
     * var isIntersects = bounds.intersectsBounds(
     *      new Bounds(-170,-90,120,80)
     *  );
     * @param {Bounds} bounds - ç®æ è¾¹çã
     * @param {Object} options - åæ°ã
     * @param {boolean} [options.inclusive=true] - è¾¹ç¼éåä¹çæç¸äº¤ãå¦ææ¯falseï¼
     *                               ä¸¤ä¸ªè¾¹çèå´æ²¡æéå é¨åä»ä»æ¯å¨è¾¹ç¼ç¸æ¥ï¼éåï¼ï¼
     *                               è¿ç§æåµè¢«è®¤ä¸ºæ²¡æç¸äº¤ã
     * @param {Bounds} [options.worldBounds] - æä¾äº worldBounds åæ°, å¦æä»ä»¬ç¸äº¤æ¶
     *                               æ¯å¨å¨çèå´å, ä¸¤ä¸ªè¾¹çå°è¢«è§ä¸ºç¸äº¤ãè¿ä»éç¨äºäº¤åæå®å¨ä¸å¨ä¸çèå´çè¾¹çã
     * @returns {boolean} ä¼ å¥ç bounds å¯¹è±¡ä¸å½å bounds ç¸äº¤ã
     */
    intersectsBounds(bounds, options) {
        if (typeof options === "boolean") {
            options = {inclusive: options};
        }
        options = options || {};
        if (options.worldBounds) {
            var self = this.wrapDateLine(options.worldBounds);
            bounds = bounds.wrapDateLine(options.worldBounds);
        } else {
            self = this;
        }
        if (options.inclusive == null) {
            options.inclusive = true;
        }
        var intersects = false;
        var mightTouch = (
            self.left === bounds.right ||
            self.right === bounds.left ||
            self.top === bounds.bottom ||
            self.bottom === bounds.top
        );

        // if the two bounds only touch at an edge, and inclusive is false,
        // then the bounds don't *really* intersect.
        if (options.inclusive || !mightTouch) {
            // otherwise, if one of the boundaries even partially contains another,
            // inclusive of the edges, then they do intersect.
            var inBottom = (
                ((bounds.bottom >= self.bottom) && (bounds.bottom <= self.top)) ||
                ((self.bottom >= bounds.bottom) && (self.bottom <= bounds.top))
            );
            var inTop = (
                ((bounds.top >= self.bottom) && (bounds.top <= self.top)) ||
                ((self.top > bounds.bottom) && (self.top < bounds.top))
            );
            var inLeft = (
                ((bounds.left >= self.left) && (bounds.left <= self.right)) ||
                ((self.left >= bounds.left) && (self.left <= bounds.right))
            );
            var inRight = (
                ((bounds.right >= self.left) && (bounds.right <= self.right)) ||
                ((self.right >= bounds.left) && (self.right <= bounds.right))
            );
            intersects = ((inBottom || inTop) && (inLeft || inRight));
        }
        // document me
        if (options.worldBounds && !intersects) {
            var world = options.worldBounds;
            var width = world.getWidth();
            var selfCrosses = !world.containsBounds(self);
            var boundsCrosses = !world.containsBounds(bounds);
            if (selfCrosses && !boundsCrosses) {
                bounds = bounds.add(-width, 0);
                intersects = self.intersectsBounds(bounds, {inclusive: options.inclusive});
            } else if (boundsCrosses && !selfCrosses) {
                self = self.add(-width, 0);
                intersects = bounds.intersectsBounds(self, {inclusive: options.inclusive});
            }
        }
        return intersects;
    }

    /**
     * @function Bounds.prototype.containsBounds
     * @description å¤æ­ç®æ è¾¹çæ¯å¦è¢«å½åè¾¹çåå«å¨åã
     * @example
     * var bounds = new Bounds(-180,-90,100,80);
     * var isContains = bounds.containsBounds(
     *      new Bounds(-170,-90,100,80),true,true
     *  );
     * @param {Bounds} bounds - ç®æ è¾¹çã
     * @param {boolean} [partial=false] - ç®æ è¾¹ççä»»æé¨åé½åå«å¨å½åè¾¹çä¸­åè¢«è®¤ä¸ºæ¯åå«å³ç³»ã
     * å¦æè®¾ä¸º falseï¼æ´ä¸ªç®æ è¾¹çå¨é¨è¢«åå«å¨å½åè¾¹çèå´åã
     * @param {boolean} [inclusive=true] - è¾¹ç¼å±äº«æ¯å¦è¢«è§ä¸ºåå«ã
     * @returns {boolean} ä¼ å¥çè¾¹çæ¯å¦è¢«å½åè¾¹çåå«ã
     */
    containsBounds(bounds, partial, inclusive) {
        if (partial == null) {
            partial = false;
        }
        if (inclusive == null) {
            inclusive = true;
        }
        var bottomLeft = this.contains(bounds.left, bounds.bottom, inclusive);
        var bottomRight = this.contains(bounds.right, bounds.bottom, inclusive);
        var topLeft = this.contains(bounds.left, bounds.top, inclusive);
        var topRight = this.contains(bounds.right, bounds.top, inclusive);

        return (partial) ? (bottomLeft || bottomRight || topLeft || topRight)
            : (bottomLeft && bottomRight && topLeft && topRight);
    }

    /**
     * @function Bounds.prototype.determineQuadrant
     * @description å¤æ­ä¼ å¥åæ æ¯å¦å¨ bounds èå´åçè±¡éãä»¥ bounds ä¸­å¿ç¹ä¸ºåæ åç¹ã
     * @example
     * var bounds = new Bounds(-180,-90,100,80);
     * //str = "tr";
     * var str = bounds.determineQuadrant(
     *      new LonLat(20,20)
     *  );
     * @param {LonLat} lonlat - ä¼ å¥çåæ å¯¹è±¡ã
     * @returns {string} ä¼ å¥åæ æå¨çè±¡éï¼"br" "tr" "tl" "bl" åå«å¯¹åº"å³ä¸"ï¼"å³ä¸"ï¼"å·¦ä¸" "å·¦ä¸"ï¼ã
     */
    determineQuadrant(lonlat) {

        var quadrant = "";
        var center = this.getCenterLonLat();

        quadrant += (lonlat.lat < center.lat) ? "b" : "t";
        quadrant += (lonlat.lon < center.lon) ? "l" : "r";

        return quadrant;
    }

    /**
     * @function Bounds.prototype.wrapDateLine
     * @description å°å½å bounds ç§»å¨å°æå¤§è¾¹çèå´åé¨ï¼æè°çåé¨æ¯ç¸äº¤æèåé¨ï¼ã
     * @example
     * var bounds = new Bounds(380,-40,400,-20);
     * var maxExtent = new Bounds(-180,-90,100,80);
     * //æ°çbounds
     * var newBounds = bounds.wrapDateLine(maxExtent);
     * @param {Bounds} maxExtent - æå¤§çè¾¹çèå´ï¼ä¸è¬æ¯å¨çèå´ï¼ã
     * @param {Object} options - å¯ééé¡¹åæ°ã
     * @param {number} [options.leftTolerance=0] - left åè®¸çè¯¯å·®ã
     * @param {number} [options.rightTolerance=0] - right åè®¸çè¯¯å·®ã
     * @returns {Bounds} åéå½åè¾¹çãå¦æå½åè¾¹çå®å¨å¨æå¤§èå´ä¹å¤æ­¤å½æ°åè¿åä¸ä¸ªä¸åå¼çè¾¹çï¼
     *                            è¥è½å¨æå¤§è¾¹ççå·¦è¾¹ï¼åç»å½åçboundså¼å ä¸æå¤§èå´çå®½åº¦ï¼å³åå³ç§»å¨ï¼
     *                            è¥è½å¨å³è¾¹ï¼ååå·¦ç§»å¨ï¼å³ç»å½åçboundså¼å ä¸è´çæå¤§èå´çå®½åº¦ã
     */
    wrapDateLine(maxExtent, options) {
        options = options || {};

        var leftTolerance = options.leftTolerance || 0;
        var rightTolerance = options.rightTolerance || 0;

        var newBounds = this.clone();

        if (maxExtent) {
            var width = maxExtent.getWidth();
            //å¦æ newBounds å¨ maxExtent çå·¦è¾¹ï¼é£ä¹ä¸ç´åå³ç§»å¨ï¼ç´å°ç¸äº¤æèåå«ä¸ºæ­¢ï¼æ¯æ¬¡ç§»å¨width
            //shift right?
            while (newBounds.left < maxExtent.left &&
            newBounds.right - rightTolerance <= maxExtent.left) {
                newBounds = newBounds.add(width, 0);
            }
            //å¦æ newBounds å¨ maxExtent çå³è¾¹ï¼é£ä¹ä¸ç´åå·¦ç§»å¨ï¼ç´å°ç¸äº¤æèåå«ä¸ºæ­¢ï¼æ¯æ¬¡ç§»å¨width
            //shift left?
            while (newBounds.left + leftTolerance >= maxExtent.right &&
            newBounds.right > maxExtent.right) {
                newBounds = newBounds.add(-width, 0);
            }
            //å¦æåå³è¾¹ç¸äº¤ï¼å·¦è¾¹åå¨åé¨ï¼é£ä¹åæ¬¡åå·¦è¾¹ç§»å¨ä¸æ¬¡
            // crosses right only? force left
            var newLeft = newBounds.left + leftTolerance;
            if (newLeft < maxExtent.right && newLeft > maxExtent.left &&
                newBounds.right - rightTolerance > maxExtent.right) {
                newBounds = newBounds.add(-width, 0);
            }
        }

        return newBounds;
    }

    /**
     * @function Bounds.prototype.toServerJSONObject
     * @description è½¬æ¢æå¯¹åºç JSON æ ¼å¼å¯¹è±¡ã
     * @example
     * var bounds = new Bounds(-180,-90,100,80);
     * var obj = bounds.toServerJSONObject();
     * @returns {Object} JSON æ ¼å¼ç Object å¯¹è±¡ã
     */
    toServerJSONObject() {
        var jsonObject = {
            rightTop: {x: this.right, y: this.top},
            leftBottom: {x: this.left, y: this.bottom},
            left: this.left,
            right: this.right,
            top: this.top,
            bottom: this.bottom
        }
        return jsonObject;
    }

    /**
     *
     * @function Bounds.prototype.destroy
     * @description éæ¯æ­¤å¯¹è±¡ã
     * éæ¯åæ­¤å¯¹è±¡çææå±æ§ä¸º nullï¼èä¸æ¯åå§å¼ã
     * @example
     * var bounds = new Bounds(-180,-90,100,80);
     * bounds.destroy();
     */
    destroy() {
        this.left = null;
        this.right = null;
        this.top = null;
        this.bottom = null;
        this.centerLonLat = null;
    }

    /**
     * @function Bounds.fromString
     * @description éè¿å­ç¬¦ä¸²åæ°åå»ºæ°ç bounds çæé å½æ°ã
     * @example
     * var bounds = Bounds.fromString("-180,-90,100,80");
     * @param {string} str - è¾¹çå­ç¬¦ä¸²ï¼ç¨éå·éå¼ï¼e.g. <i>"5,42,10,45"</i>ï¼ã
     * @param {boolean} [reverseAxisOrder=false] - æ¯å¦åè½¬è½´é¡ºåºã
     * å¦æè®¾ä¸ºtrueï¼ååè½¬é¡ºåºï¼bottom,left,top,rightï¼ï¼å¦åææ­£å¸¸è½´é¡ºåºï¼left,bottom,right,topï¼ã
     * @returns {Bounds} ç»å®çå­ç¬¦ä¸²åå»ºçæ°çè¾¹çå¯¹è±¡ã
     */
    static fromString(str, reverseAxisOrder) {
        var bounds = str.split(",");
        return Bounds.fromArray(bounds, reverseAxisOrder);
    }

    /**
     * @function Bounds.fromArray
     * @description éè¿è¾¹çæ¡æ°ç»åå»º Boundsã
     * @example
     * var bounds = Bounds.fromArray([-180,-90,100,80]);
     * @param {Array.<number>} bbox - è¾¹çå¼æ°ç»ãï¼e.g. <i>[5,42,10,45]</i>ï¼ã
     * @param {boolean} [reverseAxisOrder=false] - æ¯å¦æ¯åè½¬è½´é¡ºåºãå¦æè®¾ä¸ºtrueï¼ååè½¬é¡ºåºï¼bottom,left,top,rightï¼ï¼å¦åææ­£å¸¸è½´é¡ºåºï¼left,bottom,right,topï¼ã
     * @returns {Bounds} æ ¹æ®ä¼ å¥çæ°ç»åå»ºçæ°çè¾¹çå¯¹è±¡ã
     */
    static fromArray(bbox, reverseAxisOrder) {
        return reverseAxisOrder === true ?
            new Bounds(bbox[1], bbox[0], bbox[3], bbox[2]) :
            new Bounds(bbox[0], bbox[1], bbox[2], bbox[3]);
    }

    /**
     * @function Bounds.fromSize
     * @description éè¿ä¼ å¥çè¾¹çå¤§å°æ¥åå»ºæ°çè¾¹çã
     * @example
     * var bounds = Bounds.fromSize(new Size(20,10));
     * @param {Size} size - è¾¹çå¤§å°ã
     * @returns {Bounds} æ ¹æ®ä¼ å¥çè¾¹çå¤§å°çåå»ºæ°çè¾¹çã
     */
    static fromSize(size) {
        return new Bounds(0,
            size.h,
            size.w,
            0);
    }

    /**
     * @function Bounds.oppositeQuadrant
     * @description åè½¬è±¡éã"t"å"b" äº¤æ¢ï¼"r"å"l"äº¤æ¢, å¦ï¼"tl"åä¸º"br"ã
     * @param {string} quadrant - ä»£è¡¨è±¡éçå­ç¬¦ä¸²ï¼å¦ï¼"tl"ã
     * @returns {string} åè½¬åçè±¡éã
     */
    static oppositeQuadrant(quadrant) {
        var opp = "";

        opp += (quadrant.charAt(0) === 't') ? 'b' : 't';
        opp += (quadrant.charAt(1) === 'l') ? 'r' : 'l';

        return opp;
    }

}

;// CONCATENATED MODULE: ./src/common/commontypes/geometry/Collection.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class GeometryCollection
 * @aliasclass Geometry.Collection
 * @deprecatedclass SuperMap.Geometry.Collection
 * @classdesc å ä½å¯¹è±¡éåç±»ï¼å­å¨å¨æ¬å°ç components å±æ§ä¸­ï¼å¯ä½ä¸ºåæ°ä¼ éç»æé å½æ°ï¼ã<br>
 *            éçæ°çå ä½å¾å½¢æ·»å å°éåä¸­ï¼å°ä¸è½è¢«åéï¼å½ç§»å¨å ä½å¾å½¢æ¶ï¼éè¦æå®åç§ç©ã<br>
 *            getArea å getLength å½æ°åªè½éè¿éåå­å¨å ä½å¯¹è±¡ç components æ°ç»ï¼æ»è®¡ææå ä½å¾å½¢çé¢ç§¯åé¿åº¦ã
 * @category BaseTypes Geometry
 * @extends {Geometry}
 * @param {Array.<Geometry>} components - å ä½å¯¹è±¡æ°ç»ã
 * @example
 * var point1 = new GeometryPoint(10,20);
 * var point2 = new GeometryPoint(30,40);
 * var col = new GeometryCollection([point1,point2]);
 * @usage
 */
class Collection extends Geometry {


    constructor(components) {
        super();

        /**
         * @description å­å¨å ä½å¯¹è±¡çæ°ç»ã
         * @member {Array.<Geometry>} GeometryCollection.prototype.components
         */
        this.components = [];

        /**
         * @member {Array.<string>} GeometryCollection.prototype.componentTypes
         * @description components å­å¨ççå ä½å¯¹è±¡ææ¯æçå ä½ç±»åæ°ç»ï¼ä¸ºç©ºè¡¨ç¤ºç±»åä¸åéå¶ã
         */
        this.componentTypes = null;
        if (components != null) {
            this.addComponents(components);
        }
        this.CLASS_NAME = "SuperMap.Geometry.Collection";
        this.geometryType = "Collection";
    }

    /**
     * @function GeometryCollection.prototype.destroy
     * @description éæ¯å ä½å¾å½¢ã
     */
    destroy() {
        this.components.length = 0;
        this.components = null;
        super.destroy();
    }

    /**
     * @function GeometryCollection.prototype.clone
     * @description åéå½åå ä½å¯¹è±¡ã
     * @returns {GeometryCollection} åéçå ä½å¯¹è±¡éåã
     */
    clone() {
        var geometry = new Collection();
        for (var i = 0, len = this.components.length; i < len; i++) {
            geometry.addComponent(this.components[i].clone());
        }

        // catch any randomly tagged-on properties
        Util.applyDefaults(geometry, this);

        return geometry;
    }

    /**
     * @function GeometryCollection.prototype.getComponentsString
     * @description è·å components å­ç¬¦ä¸²ã
     * @returns {string} components å­ç¬¦ä¸²ã
     */
    getComponentsString() {
        var strings = [];
        for (var i = 0, len = this.components.length; i < len; i++) {
            strings.push(this.components[i].toShortString());
        }
        return strings.join(",");
    }

    /**
     * @function GeometryCollection.prototype.calculateBounds
     * @description éè¿éåæ°ç»éæ°è®¡ç®è¾¹çï¼å¨éåæ¯ä¸å­é¡¹ä¸­æ¶è°ç¨ extend æ¹æ³ã
     */
    calculateBounds() {
        this.bounds = null;
        var bounds = new Bounds();
        var components = this.components;
        if (components) {
            for (var i = 0, len = components.length; i < len; i++) {
                bounds.extend(components[i].getBounds());
            }
        }
        // to preserve old behavior, we only set bounds if non-null
        // in the future, we could add bounds.isEmpty()
        if (bounds.left != null && bounds.bottom != null &&
            bounds.right != null && bounds.top != null) {
            this.setBounds(bounds);
        }
    }

    /**
     * @function GeometryCollection.prototype.addComponents
     * @description ç»å ä½å¾å½¢å¯¹è±¡æ·»å åç´ ã
     * @param {Array.<Geometry>} components - å ä½å¯¹è±¡ç»ä»¶ã
     * @example
     * var geometryCollection = new GeometryCollection();
     * geometryCollection.addComponents(new SuerpMap.Geometry.Point(10,10));
     */
    addComponents(components) {
        if (!(Util.isArray(components))) {
            components = [components];
        }
        for (var i = 0, len = components.length; i < len; i++) {
            this.addComponent(components[i]);
        }
    }

    /**
     * @function GeometryCollection.prototype.addComponent
     * @description æ·»å å ä½å¯¹è±¡å°éåä¸­ãå¦æè®¾ç½®äº componentTypes ç±»åï¼åæ·»å çå ä½å¯¹è±¡å¿é¡»æ¯ componentTypes ä¸­çç±»åã
     * @param {Geometry} component - å¾æ·»å çå ä½å¯¹è±¡ã
     * @param {number} [index] - å ä½å¯¹è±¡æå¥çä½ç½®ã
     * @returns {boolean} æ¯å¦æ·»å æåã
     */
    addComponent(component, index) {
        var added = false;
        if (component) {
            if (this.componentTypes == null ||
                (Util.indexOf(this.componentTypes,
                    component.CLASS_NAME) > -1)) {

                if (index != null && (index < this.components.length)) {
                    var components1 = this.components.slice(0, index);
                    var components2 = this.components.slice(index,
                        this.components.length);
                    components1.push(component);
                    this.components = components1.concat(components2);
                } else {
                    this.components.push(component);
                }
                component.parent = this;
                this.clearBounds();
                added = true;
            }
        }
        return added;
    }

    /**
     * @function GeometryCollection.prototype.removeComponents
     * @description æ¸é¤å ä½å¯¹è±¡ã
     * @param {Array.<Geometry>} components - éè¦æ¸é¤çå ä½å¯¹è±¡ã
     * @returns {boolean} åç´ æ¯å¦è¢«å é¤ã
     */
    removeComponents(components) {
        var removed = false;

        if (!(Util.isArray(components))) {
            components = [components];
        }
        for (var i = components.length - 1; i >= 0; --i) {
            removed = this.removeComponent(components[i]) || removed;
        }
        return removed;
    }

    /**
     * @function GeometryCollection.prototype.removeComponent
     * @description ä»éåä¸­ç§»é¤å ä½å¯¹è±¡ã
     * @param {Geometry} component - è¦ç§»é¤çå ä½å¯¹è±¡ã
     * @returns {boolean} å ä½å¯¹è±¡æ¯å¦ç§»é¤æåã
     */
    removeComponent(component) {
        Util.removeItem(this.components, component);

        // clearBounds() so that it gets recalculated on the next call
        // to this.getBounds();
        this.clearBounds();
        return true;
    }

    /**
     * @function GeometryCollection.prototype.getArea
     * @description è®¡ç®å ä½å¯¹è±¡çé¢ç§¯ãæ³¨æï¼è¿ä¸ªæ¹æ³å¨ {@link GeometryPolygon} ç±»ä¸­éè¦éåã
     * @returns {number} å ä½å¾å½¢çé¢ç§¯ï¼æ¯å ä½å¯¹è±¡ä¸­ææç»æé¨åçé¢ç§¯ä¹åã
     */
    getArea() {
        var area = 0.0;
        for (var i = 0, len = this.components.length; i < len; i++) {
            area += this.components[i].getArea();
        }
        return area;
    }

    /**
     * @function GeometryCollection.prototype.equals
     * @description å¤æ­ä¸¤ä¸ªå ä½å¾å½¢æ¯å¦ç¸ç­ãå¦æææç components å·æç¸åçåæ ï¼åè®¤ä¸ºæ¯ç¸ç­çã
     * @param {Geometry} geometry - éè¦å¤æ­çå ä½å¾å½¢ã
     * @returns {boolean} è¾å¥çå ä½å¾å½¢ä¸å½åå ä½å¾å½¢æ¯å¦ç¸ç­ã
     */
    equals(geometry) {
        var equivalent = true;
        if (!geometry || !geometry.CLASS_NAME ||
            (this.CLASS_NAME !== geometry.CLASS_NAME)) {
            equivalent = false;
        } else if (!(Util.isArray(geometry.components)) ||
            (geometry.components.length !== this.components.length)) {
            equivalent = false;
        } else {
            for (var i = 0, len = this.components.length; i < len; ++i) {
                if (!this.components[i].equals(geometry.components[i])) {
                    equivalent = false;
                    break;
                }
            }
        }
        return equivalent;
    }


    /**
     * @function GeometryCollection.prototype.getVertices
     * @description è¿åå ä½å¯¹è±¡çææç»ç¹çåè¡¨ã
     * @param {boolean} [nodes] - å¯¹äºçº¿æ¥è¯´ï¼ä»ä»è¿åä½ä¸ºç«¯ç¹çé¡¶ç¹ï¼å¦æè®¾ä¸º falseï¼åè¿åéç«¯ç¹çé¡¶ç¹å¦ææ²¡æè®¾ç½®æ­¤åæ°ï¼åè¿åææé¡¶ç¹ã
     * @returns {Array} å ä½å¯¹è±¡çé¡¶ç¹åè¡¨ã
     */
    getVertices(nodes) {
        var vertices = [];
        for (var i = 0, len = this.components.length; i < len; ++i) {
            Array.prototype.push.apply(
                vertices, this.components[i].getVertices(nodes)
            );
        }
        return vertices;
    }

}

;// CONCATENATED MODULE: ./src/common/commontypes/geometry/MultiPoint.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class GeometryMultiPoint
 * @aliasclass Geometry.MultiPoint
 * @deprecatedclass SuperMap.Geometry.MultiPoint
 * @classdesc å ä½å¯¹è±¡å¤ç¹ç±»ã
 * @category BaseTypes Geometry
 * @extends GeometryCollection
 * @param {Array.<GeometryPoint>} components - ç¹å¯¹è±¡æ°ç»ã
 * @example
 * var point1 = new GeometryPoint(5,6);
 * var poine2 = new GeometryMultiPoint(7,8);
 * var multiPoint = new MultiPoint([point1,point2]);
 * @usage
 */
class MultiPoint extends Collection {


    constructor(components) {
        super(components);
        /**
         * @member {Array.<string>} [GeometryMultiPoint.prototype.componentTypes=["SuperMap.Geometry.Point"]]
         * @description components å­å¨ççå ä½å¯¹è±¡ææ¯æçå ä½ç±»åæ°ç»ã
         * @readonly
         */
        this.componentTypes = ["SuperMap.Geometry.Point"];
        this.CLASS_NAME = "SuperMap.Geometry.MultiPoint";
        this.geometryType = "MultiPoint";
    }

    /**
     * @function GeometryMultiPoint.prototype.addPoint
     * @description æ·»å ç¹ï¼å°è£äº {@link GeometryCollection|GeometryCollection.addComponent} æ¹æ³ã
     * @param {GeometryPoint} point - æ·»å çç¹ã
     * @param {number} [index] - ä¸æ ã
     */
    addPoint(point, index) {
        this.addComponent(point, index);
    }


    /**
     * @function GeometryMultiPoint.prototype.removePoint
     * @description ç§»é¤ç¹ï¼å°è£äº {@link GeometryCollection|GeometryCollection.removeComponent} æ¹æ³ã
     * @param {GeometryPoint} point - ç§»é¤çç¹å¯¹è±¡ã
     */
    removePoint(point) {
        this.removeComponent(point);
    }


}

;// CONCATENATED MODULE: ./src/common/commontypes/geometry/Curve.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class GeometryCurve
 * @aliasclass Geometry.Curve
 * @deprecatedclass SuperMap.Geometry.Curve
 * @classdesc å ä½å¯¹è±¡æ²çº¿ç±»ã
 * @category BaseTypes Geometry
 * @extends GeometryMultiPoint
 * @param {Array.<GeometryPoint>} components - å ä½å¯¹è±¡æ°ç»ã
 * @example
 * var point1 = new GeometryPoint(10,20);
 * var point2 = new GeometryPoint(30,40);
 * var curve = new Curve([point1,point2]);
 * @usage
 */
class Curve extends MultiPoint {

    constructor(components) {
        super(components);
        /**
         * @member {Array.<string>} [GeometryCurve.prototype.componentTypes=["SuperMap.Geometry.Point", "SuperMap.PointWithMeasure"]]
         * @description components å­å¨ççå ä½å¯¹è±¡ææ¯æçå ä½ç±»åæ°ç»ã
         * @readonly
         */
        this.componentTypes = ["SuperMap.Geometry.Point", "SuperMap.PointWithMeasure"];
        this.CLASS_NAME = "SuperMap.Geometry.Curve";
        this.geometryType = "Curve";

    }


}

;// CONCATENATED MODULE: ./src/common/commontypes/geometry/Point.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class GeometryPoint
 * @aliasclass Geometry.Point
 * @deprecatedclass SuperMap.Geometry.Point
 * @classdesc ç¹å ä½å¯¹è±¡ç±»ã
 * @category BaseTypes Geometry
 * @extends {Geometry}
 * @param {number} x - x åæ ã
 * @param {number} y - y åæ ã
 * @param {string} [type = 'Point'] - ç¹çç±»åã
 * @param {number} [tag] - é¢å¤çå±æ§ï¼æ¯å¦å·®å¼åæä¸­ç Z å¼ã
 * @example
 * var point = new GeometryPoint(-111.04, 45.68);
 * @usage
 */
class Point extends Geometry {


    constructor(x, y, type, tag) {
        super(x, y, type, tag);
        /**
         * @member {number} GeometryPoint.prototype.x
         * @description æ¨ªåæ ã
         */
        this.x = parseFloat(x);

        /**
         * @member {number} GeometryPoint.prototype.y
         * @description çºµåæ ã
         */
        this.y = parseFloat(y);

        /**
         * @member {string} GeometryPoint.prototype.tag
         * @description  ç¨æ¥å­å¨é¢å¤çå±æ§ï¼æ¯å¦å·®å¼åæä¸­ç Z å¼ã
         */
        this.tag = (tag || tag == 0) ? parseFloat(tag) : null;

        /**
         * @member {string} GeometryPoint.prototype.type
         * @description  ç¨æ¥å­å¨ç¹çç±»å
         */
        this.type = type || "Point";
        this.CLASS_NAME = "SuperMap.Geometry.Point";
        this.geometryType = "Point";
    }

    /**
     * @function GeometryPoint.prototype.clone
     * @description åéç¹å¯¹è±¡ã
     * @returns {GeometryPoint} åéåçç¹å¯¹è±¡ã
     */
    clone(obj) {
        if (obj == null) {
            obj = new Point(this.x, this.y);
        }

        // catch any randomly tagged-on properties
        Util.applyDefaults(obj, this);

        return obj;
    }

    /**
     * @function GeometryPoint.prototype.calculateBounds
     * @description è®¡ç®ç¹å¯¹è±¡çèå´ã
     */
    calculateBounds() {
        this.bounds = new Bounds(this.x, this.y,
            this.x, this.y);
    }

    /**
     * @function GeometryPoint.prototype.equals
     * @description å¤æ­ä¸¤ä¸ªç¹å¯¹è±¡æ¯å¦ç¸ç­ãå¦æä¸¤ä¸ªç¹å¯¹è±¡å·æç¸åçåæ ï¼åè®¤ä¸ºæ¯ç¸ç­çã
     * @example
     * var point= new GeometryPoint(0,0);
     * var point1={x:0,y:0};
     * var result= point.equals(point1);
     * @param {GeometryPoint} geom - éè¦å¤æ­çç¹å¯¹è±¡ã
     * @returns {boolean} ä¸¤ä¸ªç¹å¯¹è±¡æ¯å¦ç¸ç­ï¼true ä¸ºç¸ç­ï¼false ä¸ºä¸ç­ï¼ã
     */
    equals(geom) {
        var equals = false;
        if (geom != null) {
            equals = ((this.x === geom.x && this.y === geom.y) ||
                (isNaN(this.x) && isNaN(this.y) && isNaN(geom.x) && isNaN(geom.y)));
        }
        return equals;
    }


    /**
     * @function GeometryPoint.prototype.move
     * @description æ²¿ç xãy è½´çæ­£æ¹åä¸æç§ç»å®çä½ç§»ç§»å¨ç¹å¯¹è±¡ï¼move ä¸ä»æ¹åäºå ä½å¯¹è±¡çä½ç½®å¹¶ä¸æ¸çäºè¾¹çç¼å­ã
     * @param {number} x - x è½´æ­£æ¹åä¸çåç§»éã
     * @param {number} y - y è½´æ­£æ¹åä¸åç§»éã
     */
    move(x, y) {
        this.x = this.x + x;
        this.y = this.y + y;
        this.clearBounds();
    }

    /**
     * @function GeometryPoint.prototype.toShortString
     * @description å° x/y åæ è½¬æ¢æç®åå­ç¬¦ä¸²ã
     * @returns {string} å­ç¬¦ä¸²ä»£è¡¨ç¹å¯¹è±¡ã(ex. <i>"5, 42"</i>)
     */
    toShortString() {
        return (this.x + ", " + this.y);
    }

    /**
     * @function GeometryPoint.prototype.destroy
     * @description éæ¾ç¹å¯¹è±¡çèµæºã
     */
    destroy() {
        this.x = null;
        this.y = null;
        this.tag = null;
        super.destroy();
    }

    /**
     * @function GeometryPoint.prototype.getVertices
     * @description è·åå ä½å¾å½¢ææé¡¶ç¹çåè¡¨ã
     * @returns {Array} å ä½å¾å½¢çé¡¶ç¹åè¡¨ã
     */
    getVertices() {
        return [this];
    }


}

;// CONCATENATED MODULE: ./src/common/commontypes/geometry/LineString.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class GeometryLineString
 * @aliasclass Geometry.LineString
 * @deprecatedclass SuperMap.Geometry.LineString
 * @classdesc å ä½å¯¹è±¡çº¿ä¸²ç±»ã
 * @category BaseTypes Geometry
 * @param {Array.<GeometryPoint>} points - ç¨æ¥çæçº¿ä¸²çç¹æ°ç»ã
 * @extends GeometryCurve
 * @example
 * var points = [new GeometryPoint(4933.319287022352, -3337.3849141502124),
 *     new GeometryPoint(4960.9674060199022, -3349.3316322355736),
 *     new GeometryPoint(5006.0235999418364, -3358.8890067038628),
 *     new GeometryPoint(5075.3145648369318, -3378.0037556404409),
 *     new GeometryPoint(5305.19551436013, -3376.9669111768926)],
 * var roadLine = new GeometryLineString(points)ï¼
 * @usage
 */
class LineString extends Curve {

    constructor(points) {
        super(points);
        this.CLASS_NAME = "SuperMap.Geometry.LineString";
        this.geometryType = "LineString";
    }

    /**
     * @function GeometryLineString.prototype.removeComponent
     * @description åªæå¨çº¿ä¸²ä¸æä¸ä¸ªææ´å¤çç¹çæ¶åï¼æä¼åè®¸ç§»é¤ç¹ï¼å¦åç»æå°ä¼æ¯åä¸çç¹ï¼ã
     * @param {GeometryPoint} point - å°è¢«å é¤çç¹ã
     * @returns {boolean} å é¤çç¹ã
     */
    removeComponent(point) { // eslint-disable-line no-unused-vars
        var removed = this.components && (this.components.length > 2);
        if (removed) {
            super.removeComponent.apply(this, arguments);
        }
        return removed;
    }

    /**
     * @function GeometryLineString.prototype.getSortedSegments
     * @description è·åååºæåçç¹åæ å¯¹è±¡æ°ç»ã
     * @returns {Array} ååºæåçç¹åæ å¯¹è±¡æ°ç»ã
     */
    getSortedSegments() {
        var numSeg = this.components.length - 1;
        var segments = new Array(numSeg), point1, point2;
        for (var i = 0; i < numSeg; ++i) {
            point1 = this.components[i];
            point2 = this.components[i + 1];
            if (point1.x < point2.x) {
                segments[i] = {
                    x1: point1.x,
                    y1: point1.y,
                    x2: point2.x,
                    y2: point2.y
                };
            } else {
                segments[i] = {
                    x1: point2.x,
                    y1: point2.y,
                    x2: point1.x,
                    y2: point1.y
                };
            }
        }

        // more efficient to define this somewhere static
        function byX1(seg1, seg2) {
            return seg1.x1 - seg2.x1;
        }

        return segments.sort(byX1);
    }

    /**
     * @function GeometryLineString.prototype.getVertices
     * @description è¿åå ä½å¾å½¢çææé¡¶ç¹çåè¡¨ã
     * @param {boolean} [nodes] - å¯¹äºçº¿æ¥è¯´ï¼ä»ä»è¿åä½ä¸ºç«¯ç¹çé¡¶ç¹ï¼å¦æè®¾ä¸º falseï¼åè¿åéç«¯ç¹çé¡¶ç¹ãå¦ææ²¡æè®¾ç½®æ­¤åæ°ï¼åè¿åææé¡¶ç¹ã
     * @returns {Array} å ä½å¾å½¢çé¡¶ç¹åè¡¨ã
     */
    getVertices(nodes) {
        var vertices;
        if (nodes === true) {
            vertices = [
                this.components[0],
                this.components[this.components.length - 1]
            ];
        } else if (nodes === false) {
            vertices = this.components.slice(1, this.components.length - 1);
        } else {
            vertices = this.components.slice();
        }
        return vertices;
    }

    /**
     * @function GeometryLineString.calculateCircle
     * @description ä¸ç¹ç»åå¼§ã
     * @param {Array.<GeometryPoint>} points - ä¼ å¥çå¾è®¡ç®çåå§ç¹ä¸²ã
     * @returns {Array.<GeometryPoint>} è®¡ç®åºç¸åºçåå¼§æ§å¶ç¹ã
     * @example
     * var points = [];
     * points.push(new GeometryPoint(-50,30));
     * points.push(new GeometryPoint(-30,50));
     * points.push(new GeometryPoint(2,60));
     * var circle = GeometryLineString.calculateCircle(points);
     */
    static calculateCircle(points) {
        if (points.length < 3) {
            return points
        }
        var centerPoint = {},
            p1 = points[0],
            p2 = points[1],
            p3 = points[2];
        var R = 0,
            dStep = 0,
            direc = true,
            dRotation = 0,
            dRotationBegin = 0,
            dRotationAngle = 0,
            nSegmentCount = 72,
            circlePoints = [];

        var KTan13 = (p3.y - p1.y) / (p3.x - p1.x);
        var B13 = p3.y - KTan13 * p3.x;
        if ((((p3.x != p1.x) && (p3.y != p1.y)) && (p2.y == KTan13 * p2.x + B13)) ||
            ((p3.x == p1.x) && (p2.x == p1.x)) || ((p3.y == p1.y) && (p2.y == p1.y)) ||
            ((p3.x == p1.x) && (p3.y == p1.y)) || ((p3.x == p2.x) && (p3.y == p2.y)) || ((p1.x == p2.x) && (p1.y == p2.y))) {
            circlePoints.push(p1);
            circlePoints.push(p2);
            circlePoints.push(p3);
        } else {
            var D = ((p2.x * p2.x + p2.y * p2.y) - (p1.x * p1.x + p1.y * p1.y)) * (2 * (p3.y - p1.y)) - ((p3.x * p3.x + p3.y * p3.y) -
                (p1.x * p1.x + p1.y * p1.y)) * (2 * (p2.y - p1.y));
            var E = (2 * (p2.x - p1.x)) * ((p3.x * p3.x + p3.y * p3.y) - (p1.x * p1.x + p1.y * p1.y)) -
                (2 * (p3.x - p1.x)) * ((p2.x * p2.x + p2.y * p2.y) - (p1.x * p1.x + p1.y * p1.y));
            var F = 4 * ((p2.x - p1.x) * (p3.y - p1.y) - (p3.x - p1.x) * (p2.y - p1.y));
            centerPoint.x = D / F;
            centerPoint.y = E / F;
            R = Math.sqrt((p1.x - centerPoint.x) * (p1.x - centerPoint.x) + (p1.y - centerPoint.y) * (p1.y - centerPoint.y));

            var dis = (p1.x - p3.x) * (p1.x - p3.x) + (p1.y - p3.y) * (p1.y - p3.y);
            var cons = (2 * R * R - dis) / (2 * R * R);
            cons = cons >= 1 ? 1 : cons;
            cons = cons <= -1 ? -1 : cons;
            dRotationAngle = Math.acos(cons) * 180 / Math.PI;

            if (p3.x == p1.x) {
                dRotationAngle = ((centerPoint.x > p1.x && p2.x > p1.x) || (centerPoint.x < p1.x && p2.x < p1.x)) ? (360 - dRotationAngle) : dRotationAngle;
            } else {
                dRotationAngle = ((centerPoint.y > (KTan13 * centerPoint.x + B13) && p2.y > (KTan13 * p2.x + B13)) ||
                    (centerPoint.y < (KTan13 * centerPoint.x + B13) && p2.y < (KTan13 * p2.x + B13))) ? (360 - dRotationAngle) : dRotationAngle;
            }
            dStep = dRotationAngle / 72;

            if (p3.y != p1.y) {
                if (p3.x == p1.x) {
                    if (p3.y > p1.y) {
                        if (p2.x < p1.x) {
                            direc = false;
                        }
                    } else {
                        if (p2.x > p1.x) {
                            direc = false;
                        }
                    }
                } else if (p3.x < p1.x) {
                    if (p2.y < KTan13 * p2.x + B13) {
                        direc = false;
                    }
                } else {
                    if (p2.y > KTan13 * p2.x + B13) {
                        direc = false;
                    }
                }
            } else {
                if (p3.x > p1.x) {
                    if (p2.y > p1.y) {
                        direc = false;
                    }
                } else {
                    if (p2.y < p1.y) {
                        direc = false;
                    }
                }
            }

            var K10 = (p1.y - centerPoint.y) / (p1.x - centerPoint.x);
            var atan10 = K10 >= 0 ? Math.atan(K10) * 180 / Math.PI : Math.abs(Math.atan(K10) * 180 / Math.PI) + 90;

            var CY = Math.abs(centerPoint.y);
            if ((p1.y == CY) && (CY == p3.y)) {
                if (p1.x < p3.x) {
                    atan10 = atan10 + 180;
                }
            }

            var newPY = p1.y - centerPoint.y;
            circlePoints.push(p1);
            for (var i = 1; i < nSegmentCount; i++) {
                dRotation = dStep * i;
                dRotationBegin = atan10;

                if (direc) {
                    if (newPY >= 0) {
                        if (K10 >= 0) {
                            dRotationBegin = dRotationBegin + dRotation;
                        } else {
                            dRotationBegin = (180 - (dRotationBegin - 90)) + dRotation;
                        }
                    } else {
                        if (K10 > 0) {
                            dRotationBegin = (dRotationBegin - 180) + dRotation;
                        } else {
                            dRotationBegin = (90 - dRotationBegin) + dRotation;
                        }
                    }
                } else {
                    if (newPY >= 0) {
                        if (K10 >= 0) {
                            dRotationBegin = dRotationBegin - dRotation;
                        } else {
                            dRotationBegin = (180 - (dRotationBegin - 90)) - dRotation;
                        }
                    } else {
                        if (K10 >= 0) {
                            dRotationBegin = (dRotationBegin - 180) - dRotation;
                        } else {
                            dRotationBegin = (90 - dRotationBegin) - dRotation;
                        }
                    }
                }

                dRotationBegin = dRotationBegin * Math.PI / 180;
                var x = centerPoint.x + R * Math.cos(dRotationBegin);
                var y = centerPoint.y + R * Math.sin(dRotationBegin);
                circlePoints.push(new Point(x, y));
            }
            circlePoints.push(p3);
        }
        return circlePoints;
    }

    /**
     * @function GeometryLineString.createLineEPS
     * @description æ ¹æ®ç¹çç±»åç»åºä¸åç±»åçæ²çº¿ã
     * ç¹çç±»åæä¸ç§ï¼LTypeArcï¼LTypeCurveï¼NONEã
     * @param {Array.<GeometryPoint>} points - ä¼ å¥çå¾è®¡ç®çåå§ç¹ä¸²ã
     * @returns {Array.<GeometryPoint>} è®¡ç®åºç¸åºç lineEPS æ§å¶ç¹ã
     * @example
     * var points = [];
     * points.push(new GeometryPoint(-50,30));
     * points.push(new GeometryPoint(-30,50,"LTypeArc"));
     * points.push(new GeometryPoint(2,60));
     * points.push(new GeometryPoint(8,20));
     * var lineEPS = GeometryLineString.createLineEPS(points);
     */
    static createLineEPS(points) {
        var list = [],
            len = points.length;
        if (len < 2) {
            return points;
        }
        for (var i = 0; i < len;) {
            var type = points[i].type;
            if (type == 'LTypeArc') {
                var listObj = LineString.createLineArc(list, i, len, points);
                list = listObj[0];
                i = listObj[1];
            } else {
                list.push(points[i]);
                i++;
            }
        }
        return list;
    }

    static createLineArc(list, i, len, points) {
        if (i == 0) {
            let bezierPtsObj = LineString.addPointEPS(points, i, len, 'LTypeArc');
            Array.prototype.push.apply(list, bezierPtsObj[0]);
            i = bezierPtsObj[1] + 1;
        } else if (i == len - 1) {
            var bezierP = [points[i - 1], points[i]],
                bezierPts = LineString.calculateCircle(bezierP);
            Array.prototype.push.apply(list, bezierPts);
            i++;
        } else {
            let bezierPtsObj = LineString.addPointEPS(points, i, len, 'LTypeArc');
            list.pop();
            Array.prototype.push.apply(list, bezierPtsObj[0]);
            i = bezierPtsObj[1] + 1;
        }
        return [list, i];
    }

    static addPointEPS(points, i, len, type) {
        var bezierP = [], j = i + 1;
        if (i == 0) {
            Array.prototype.push.apply(bezierP, [points[i], points[i + 1]]);
        } else if (i == len - 1) {
            Array.prototype.push.apply(bezierP, [points[i - 1], points[i]]);
        } else {
            Array.prototype.push.apply(bezierP, [points[i - 1], points[i], points[i + 1]]);
        }
        var bezierPts;
        if (type == 'LTypeCurve') {
            bezierPts = LineString.calculatePointsFBZN(bezierP);
        } else if (type == 'LTypeArc') {
            bezierPts = LineString.calculateCircle(bezierP);
        }
        return [bezierPts, j];
    }
}



;// CONCATENATED MODULE: ./src/common/commontypes/geometry/GeoText.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/








/**
 * @class GeometryGeoText
 * @aliasclass Geometry.GeoText
 * @deprecatedclass SuperMap.Geometry.GeoText
 * @classdesc ææ¬æ ç­¾ç±»ã
 * @category BaseTypes Geometry
 * @extends {Geometry}
 * @param {number} x - x åæ ã
 * @param {number} y - y åæ ã
 * @param {string} text - æ ç­¾ä¸­çææ¬åå®¹ã
 * @usage
 */
class GeoText extends Geometry {

    constructor(x, y, text) {
        super(x, y, text);
        /**
         * @member {number} GeometryGeoText.prototype.x
         * @description æ¨ªåæ ã
         */
        this.x = parseFloat(x);

        /**
         * @member {number} GeometryGeoText.prototype.y
         * @description çºµåæ ã
         */
        this.y = parseFloat(y);

        /**
         * @member {string} GeometryGeoText.prototype.text
         * @description æ ç­¾ä¸­çææ¬åå®¹ã
         */
        this.text = text.toString();

        /**
         * @member {Object} GeometryGeoText.prototype.bsInfo
         * @description æ ç­¾èå´çåºç¡ä¿¡æ¯ã
         * @property {number} w - bounds çå®½ã
         * @property {number} h - bounds çé«åº¦ã
         */
        this.bsInfo = {
            "h": null,
            "w": null
        };
        this.element = document.createElement('span');
        this.CLASS_NAME = "SuperMap.Geometry.GeoText";
        this.geometryType = "GeoText";
    }

    /**
     * @function GeometryGeoText.prototype.destroy
     * @description éæ¯ææ¬æ ç­¾ç±»ã
     */
    destroy() {
        super.destroy();
        this.x = null;
        this.y = null;
        this.text = null;
    }

    /**
     * @function GeometryGeoText.prototype.getCentroid
     * @description è·åæ ç­¾å¯¹è±¡çè´¨å¿ã
     * @returns {GeometryPoint} æ ç­¾å¯¹è±¡çè´¨å¿ã
     */
    getCentroid() {
        return new Point(this.x, this.y);
    }

    /**
     * @function GeometryGeoText.prototype.clone
     * @description åéæ ç­¾å¯¹è±¡ã
     * @returns {GeometryGeoText} åéåçæ ç­¾å¯¹è±¡ã
     */
    clone(obj) {
        if (obj == null) {
            obj = new GeoText(this.x, this.y, this.text);
        }
        Util.applyDefaults(obj, this);
        return obj;
    }

    /**
     * @function GeometryGeoText.prototype.calculateBounds
     * @description è®¡ç®æ ç­¾å¯¹è±¡çèå´ã
     */
    calculateBounds() {
        this.bounds = new Bounds(this.x, this.y,
            this.x, this.y);
    }

    /**
     * @function GeometryGeoText.prototype.getLabelPxBoundsByLabel
     * @description æ ¹æ®ç»å¶å¥½çæ ç­¾è·åæå­æ ç­¾çåç´ èå´ï¼åæ°çåä½æ¯åç´ ï¼æ­¤æ¹æ³ç¸å¯¹äº getLabelPxBoundsByText æçè¾ä½ï¼ä½æ¯ææææ ¼å¼çææ¬ã
     * @param {Object} locationPixel - æ ç­¾çä½ç½®ç¹ï¼è¯¥å¯¹è±¡å«æå±æ§ xï¼æ¨ªåæ ï¼ï¼å±æ§ yï¼çºµåæ ï¼ã
     * @param {string} labelWidth - æ ç­¾çå®½åº¦ï¼å¦ï¼â90pxâã
     * @param {string} labelHeight - æ ç­¾çé«åº¦ã
     * @param {Object} style - æ ç­¾ç styleã
     * @returns {Bounds} æ ç­¾çåç´ èå´ã
     */
    getLabelPxBoundsByLabel(locationPixel, labelWidth, labelHeight, style) {
        var labelPxBounds, left, bottom, top, right;
        var locationPx = Util.cloneObject(locationPixel);

        //è®¡ç®ææ¬è¡æ°
        var theText = style.label || this.text;
        var textRows = theText.split('\n');
        var laberRows = textRows.length;

        //å¤çæå­å¯¹é½
        labelWidth = parseFloat(labelWidth);
        labelHeight = parseFloat(labelHeight);
        if (laberRows > 1) {
            labelHeight = parseFloat(labelHeight) * laberRows;
        }
        if (style.labelAlign && style.labelAlign !== "cm") {
            switch (style.labelAlign) {
                case "lt":
                    locationPx.x += labelWidth / 2;
                    locationPx.y += labelHeight / 2;
                    break;
                case "lm":
                    locationPx.x += labelWidth / 2;
                    break;
                case "lb":
                    locationPx.x += labelWidth / 2;
                    locationPx.y -= labelHeight / 2;
                    break;
                case "ct":
                    locationPx.y += labelHeight / 2;
                    break;
                case "cb":
                    locationPx.y -= labelHeight / 2;
                    break;
                case "rt":
                    locationPx.x -= labelWidth / 2;
                    locationPx.y += labelHeight / 2;
                    break;
                case "rm":
                    locationPx.x -= labelWidth / 2;
                    break;
                case "rb":
                    locationPx.x -= labelWidth / 2;
                    locationPx.y -= labelHeight / 2;
                    break;
                default:
                    break;
            }
        }

        this.bsInfo.h = labelHeight;
        this.bsInfo.w = labelWidth;

        //boundsçåè¾¹
        left = locationPx.x - parseFloat(labelWidth) / 2;
        bottom = locationPx.y + parseFloat(labelHeight) / 2;
        right = locationPx.x + parseFloat(labelWidth) / 2;
        top = locationPx.y - parseFloat(labelHeight) / 2;

        labelPxBounds = new Bounds(left, bottom, right, top);

        return labelPxBounds;
    }

    /**
     * @function GeometryGeoText.prototype.getLabelPxBoundsByText
     * @description æ ¹æ®ææ¬åå®¹è·åæå­æ ç­¾çåç´ èå´ã
     * @param {Object} locationPixel - æ ç­¾çä½ç½®ç¹ï¼è¯¥å¯¹è±¡å«æå±æ§ xï¼æ¨ªåæ ï¼ï¼å±æ§ yï¼çºµåæ ï¼ã
     * @param {Object} style - æ ç­¾çæ ·å¼ã
     * @returns {Bounds} æ ç­¾çåç´ èå´ã
     */
    getLabelPxBoundsByText(locationPixel, style) {
        var labelPxBounds, left, bottom, top, right;
        var labelSize = this.getLabelPxSize(style);
        var locationPx = Util.cloneObject(locationPixel);

        //å¤çæå­å¯¹é½
        if (style.labelAlign && style.labelAlign !== "cm") {
            switch (style.labelAlign) {
                case "lt":
                    locationPx.x += labelSize.w / 2;
                    locationPx.y += labelSize.h / 2;
                    break;
                case "lm":
                    locationPx.x += labelSize.w / 2;
                    break;
                case "lb":
                    locationPx.x += labelSize.w / 2;
                    locationPx.y -= labelSize.h / 2;
                    break;
                case "ct":
                    locationPx.y += labelSize.h / 2;
                    break;
                case "cb":
                    locationPx.y -= labelSize.h / 2;
                    break;
                case "rt":
                    locationPx.x -= labelSize.w / 2;
                    locationPx.y += labelSize.h / 2;
                    break;
                case "rm":
                    locationPx.x -= labelSize.w / 2;
                    break;
                case "rb":
                    locationPx.x -= labelSize.w / 2;
                    locationPx.y -= labelSize.h / 2;
                    break;
                default:
                    break;
            }
        }

        this.bsInfo.h = labelSize.h;
        this.bsInfo.w = labelSize.w;


        left = locationPx.x - labelSize.w / 2;
        bottom = locationPx.y + labelSize.h / 2;
        //å¤çæä½å­
        if (style.fontStyle && style.fontStyle === "italic") {
            right = locationPx.x + labelSize.w / 2 + parseInt(parseFloat(style.fontSize) / 2);
        } else {
            right = locationPx.x + labelSize.w / 2;
        }
        top = locationPx.y - labelSize.h / 2;

        labelPxBounds = new Bounds(left, bottom, right, top);

        return labelPxBounds;
    }

    /**
     * @function GeometryGeoText.prototype.getLabelPxSize
     * @description è·å label çåç´ å¤§å°ã
     * @param {Object} style - æ ç­¾æ ·å¼ã
     * @returns {Object} æ ç­¾å¤§å°å¯¹è±¡ï¼å±æ§ w è¡¨ç¤ºæ ç­¾çå®½åº¦ï¼å±æ§ h è¡¨ç¤ºæ ç­¾çé«åº¦ã
     */
    getLabelPxSize(style) {
        var text,//ææ¬åå®¹
            fontSize,//å­ä½å¤§å°
            spacing = 1,//ä¸¤ä¸ªå­ç¬¦é´çé´è·ï¼åä½ï¼pxï¼
            lineSpacing = 0.2,
            bgstrokeWidth = parseFloat(style.strokeWidth);//æ ç­¾èæ¯æ¡è¾¹æ¡çå®½åº¦

        text = style.label || this.text;
        if (style.fontSize) {
            fontSize = parseFloat(style.fontSize);
        } else {
            fontSize = parseFloat("12px");
        }

        //æ ç­¾å®½é«
        var labelW, labelH;

        var textRows = text.split('\n');
        var numRows = textRows.length;

        if (numRows > 1) {
            labelH = fontSize * numRows + numRows + bgstrokeWidth + lineSpacing * fontSize;
        } else {
            labelH = fontSize + bgstrokeWidth + lineSpacing * fontSize + 1;
        }

        //åæå¤§å®½åº¦
        labelW = 0;
        if (this.labelWTmp && labelW < this.labelWTmp) {
            labelW = this.labelWTmp;
        }
        for (var i = 0; i < numRows; i++) {
            var textCharC = this.getTextCount(textRows[i]);
            var labelWTmp = this.labelWTmp = Util.getTextBounds(style, textRows[i], this.element).textWidth + textCharC.textC * spacing + bgstrokeWidth;
            if (labelW < labelWTmp) {
                labelW = labelWTmp;
            }
        }

        var labelSize = new Object(); //æ ç­¾å¤§å°
        labelSize.h = labelH;
        labelSize.w = labelW;

        return labelSize;
    }

    /**
     * @function GeometryGeoText.prototype.getTextCount
     * @description è·å text ä¸­çå­ç¬¦ä¸ªæ°ã
     * @param {string} text - å­ç¬¦ä¸²ã
     * @returns {Object} å­ç¬¦ä¸ªæ°ç»è®¡ç»æï¼å±æ§ cnC è¡¨ç¤ºä¸­æå­ç¬¦ä¸ªæ°ï¼å±æ§ enC è¡¨ç¤ºè±æå­ç¬¦ä¸ªæ°ï¼å±æ§ textC è¡¨ç¤ºå­ç¬¦æ»ä¸ªæ°ã
     */
    getTextCount(text) {
        var textCharCount = {};

        var cnCount = 0;
        var enCount = 0;

        for (var i = 0; i < text.length; i++) {
            if (text.charCodeAt(i) > 255) { //éåå¤æ­å­ç¬¦ä¸²ä¸­æ¯ä¸ªå­ç¬¦çUnicodeç ,å¤§äº255åä¸ºä¸­æ
                cnCount++;
            } else {
                enCount++;
            }
        }
        //ä¸­åå­ç¬¦ä¸ªæ°
        textCharCount.cnC = cnCount;
        //è±æå­ç¬¦ä¸ªæ°
        textCharCount.enC = enCount;
        //å­ç¬¦æ»ä¸ªæ°
        textCharCount.textC = text.length;

        return textCharCount;
    }


}

;// CONCATENATED MODULE: ./src/common/commontypes/geometry/LinearRing.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class  GeometryLinearRing
 * @aliasclass Geometry.LinearRing
 * @deprecatedclass SuperMap.Geometry.LinearRing
 * @classdesc å ä½å¯¹è±¡çº¿ç¯ç±»ï¼æ¯ä¸ä¸ªç¹æ®çå°é­ççº¿ä¸²ï¼å¨æ¯æ¬¡ addPoint/removePoint ä¹åä¼éè¿æ·»å ä¸ä¸ªç¹ï¼æ­¤ç¹æ¯å¤å¶çç¬¬ä¸ä¸ªç¹å¾å°çï¼
 * ä½ä¸ºæåçä¸ä¸ªç¹æ¥èªå¨å³é­çº¿ç¯ã
 * @category BaseTypes Geometry
 * @extends GeometryLineString
 * @param {Array.<GeometryPoint>} points - ç»æçº¿æ§ç¯çç¹ã
 * @example
 * var points = [new GeometryPoint(4933.319287022352, -3337.3849141502124),
 *      new GeometryPoint(4960.9674060199022, -3349.3316322355736),
 *      new GeometryPoint(5006.0235999418364, -3358.8890067038628),
 *      new GeometryPoint(5075.3145648369318, -3378.0037556404409),
 *      new GeometryPoint(5305.19551436013, -3376.9669111768926)],
 * var linearRing = new GeometryLinearRing(points);
 * @usage
 */
class LinearRing extends LineString {


    constructor(points) {
        super(points);
        /**
         * @member {Array.<string>} [GeometryLinearRing.prototype.componentTypes=["SuperMap.Geometry.Point"]]
         * @description components å­å¨ççå ä½å¯¹è±¡ææ¯æçå ä½ç±»åæ°ç»ï¼ä¸ºç©ºè¡¨ç¤ºç±»åä¸åéå¶ã
         * @readonly
         */
        this.componentTypes = ["SuperMap.Geometry.Point"];
        this.CLASS_NAME = "SuperMap.Geometry.LinearRing";
        this.geometryType = "LinearRing";
    }

    /**
     * @function GeometryLinearRing.prototype.addComponent
     * @description æ·»å ä¸ä¸ªç¹å°å ä½å¾å½¢æ°ç»ä¸­ï¼å¦æè¿ä¸ªç¹å°è¦è¢«æ·»å å°ç»ä»¶æ°ç»çæ«ç«¯ï¼å¹¶ä¸ä¸æ°ç»ä¸­å·²ç»å­å¨çæåä¸ä¸ªç¹ç¸åï¼
     * éå¤çç¹æ¯ä¸è½è¢«æ·»å çãè¿å°å½±åæªå³é­ç¯çå³é­ã
     * è¿ä¸ªæ¹æ³å¯ä»¥éè¿å°éç©ºç´¢å¼ï¼ç»ä»¶æ°ç»çä¸æ ï¼ä½ä¸ºç¬¬äºä¸ªåæ°éåã
     * @param {GeometryPoint} point - ç¹å¯¹è±¡ã
     * @param {number} [index] - æå¥ç»ä»¶æ°ç»çä¸æ ã
     * @returns {boolean} ç¹å¯¹è±¡æ¯å¦æ·»å æåã
     */
    addComponent(point, index) {
        var added = false;

        //remove last point
        var lastPoint = this.components.pop();

        // given an index, add the point
        // without an index only add non-duplicate points
        if (index != null || !point.equals(lastPoint)) {
            added = super.addComponent.apply(this, arguments);
        }

        //append copy of first point
        var firstPoint = this.components[0];
        super.addComponent.apply(this, [firstPoint]);

        return added;
    }

    /**
     * @function GeometryLinearRing.prototype.removeComponent
     * @description ä»å ä½ç»ä»¶ä¸­å é¤ä¸ä¸ªç¹ã
     * @param {GeometryPoint} point - ç¹å¯¹è±¡ã
     * @returns {boolean} ç¹å¯¹è±¡æ¯å¦å é¤ã
     */
    removeComponent(point) { // eslint-disable-line no-unused-vars
        var removed = this.components && (this.components.length > 3);
        if (removed) {
            //remove last point
            this.components.pop();

            //remove our point
            super.removeComponent.apply(this, arguments);
            //append copy of first point
            var firstPoint = this.components[0];
            super.addComponent.apply(this, [firstPoint]);
        }
        return removed;
    }

    /**
     * @function GeometryLinearRing.prototype.getArea
     * @description è·å¾å½åå ä½å¯¹è±¡åºåå¤§å°ï¼å¦ææ¯æ²¿é¡ºæ¶éæ¹åçç¯åæ¯æ­£å¼ï¼å¦åä¸ºè´å¼ã
     * @returns {number} ç¯çé¢ç§¯ã
     */
    getArea() {
        var area = 0.0;
        if (this.components && (this.components.length > 2)) {
            var sum = 0.0;
            for (var i = 0, len = this.components.length; i < len - 1; i++) {
                var b = this.components[i];
                var c = this.components[i + 1];
                sum += (b.x + c.x) * (c.y - b.y);
            }
            area = -sum / 2.0;
        }
        return area;
    }

    /**
     * @function GeometryLinearRing.prototype.getVertices
     * @description è¿åå ä½å¾å½¢çææç¹çåè¡¨ã
     * @param {boolean} [nodes] - å¯¹äºçº¿æ¥è¯´ï¼ä»ä»è¿åä½ä¸ºç«¯ç¹çé¡¶ç¹ï¼å¦æè®¾ä¸º false ï¼åè¿åéç«¯ç¹çé¡¶ç¹ï¼å¦ææ²¡æè®¾ç½®æ­¤åæ°ï¼åè¿åææé¡¶ç¹ã
     * @returns {Array} å ä½å¯¹è±¡ææç¹çåè¡¨ã
     */
    getVertices(nodes) {
        return (nodes === true) ? [] : this.components.slice(0, this.components.length - 1);
    }


}

;// CONCATENATED MODULE: ./src/common/commontypes/geometry/MultiLineString.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class GeometryMultiLineString
 * @aliasclass Geometry.MultiLineString
 * @deprecatedclass SuperMap.Geometry.MultiLineString
 * @classdesc å ä½å¯¹è±¡å¤çº¿ç±»ã
 * @category BaseTypes Geometry
 * @extends GeometryCollection
 * @param {Array.<GeometryLineString>} components - GeometryLineString æ°ç»ã
 * @example
 * var multi = new GeometryMultiLineString([
 *      new GeometryLineString([
 *          new GeometryPoint(1, 0),
 *          new GeometryPoint(0, 1)
 *      ])
 *  ]);
 * @usage
 */
class MultiLineString extends Collection {


    constructor(components) {
        super(components);
        /**
         * @member {Array.<string>} [GeometryMultiLineString.prototype.componentTypes=["SuperMap.Geometry.LineString"]]
         * @description components å­å¨ççå ä½å¯¹è±¡ææ¯æçå ä½ç±»åæ°ç»ã
         * @readonly
         */
        this.componentTypes = ["SuperMap.Geometry.LineString"];
        this.CLASS_NAME = "SuperMap.Geometry.MultiLineString";
        this.geometryType = "MultiLineString";
    }


}

;// CONCATENATED MODULE: ./src/common/commontypes/geometry/MultiPolygon.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class GeometryMultiPolygon
 * @aliasclass Geometry.MultiPolygon
 * @deprecatedclass SuperMap.Geometry.MultiPolygon
 * @classdesc å ä½å¯¹è±¡å¤å¤è¾¹å½¢ç±»ã
 * @category BaseTypes Geometry
 * @extends GeometryCollection
 * @param  {Array.<GeometryPolygon>} components - å½¢æ GeometryMultiPolygon çå¤è¾¹å½¢æ°ç»ã
 * @example
 * var points1 = [new GeometryPoint(10,10),new GeometryPoint(0,0)];
 * var points2 = [new GeometryPoint(10,10),new GeometryPoint(0,0),new GeometryPoint(3,3),new GeometryPoint(10,10)];
 *
 * var linearRing1 = new GeometryLinearRing(points1);
 * var linearRing2 = new GeometryLinearRing(points2);
 *
 * var polygon1 = new GeometryPolygon([linearRing1]);
 * var polygon2 = new GeometryPolygon([linearRing2]);
 *
 * var multiPolygon1 = new GeometryMultiPolygon([polygon1,polygon2]);
 * @usage
 */
class MultiPolygon extends Collection {


    constructor(components) {
        super(components);
        /**
         * @member {Array.<string>} [GeometryMultiPolygon.prototype.componentTypes=["SuperMap.Geometry.Polygon"]]
         * @description components å­å¨ççå ä½å¯¹è±¡ææ¯æçå ä½ç±»åæ°ç»ã
         * @readonly
         */
        this.componentTypes = ["SuperMap.Geometry.Polygon"];
        this.CLASS_NAME = "SuperMap.Geometry.MultiPolygon";
        this.geometryType = "MultiPolygon";
    }


}

;// CONCATENATED MODULE: ./src/common/commontypes/geometry/Polygon.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class GeometryPolygon
 * @aliasclass Geometry.Polygon
 * @deprecatedclass SuperMap.Geometry.Polygon
 * @classdesc  å¤è¾¹å½¢å ä½å¯¹è±¡ç±»ã
 * @category BaseTypes Geometry
 * @extends GeometryCollection
 * @param {Array.<GeometryLinearRing>} components - å¤è¾¹å½¢ççº¿ç¯æ°ç»ã
 * @example
 * var points =[new GeometryPoint(0,4010338),
 *      new GeometryPoint(1063524,4010338),
 *      new GeometryPoint(1063524,3150322),
 *      new GeometryPoint(0,3150322)
 *  ],
 *  var linearRings = new GeometryLinearRing(points),
 *  var  region = new GeometryPolygon([linearRings]);
 * @usage
 */
class Polygon extends Collection {


    constructor(components) {
        super(components);
        /**
         * @member {Array.<string>} [GeometryPolygon.prototype.componentTypes=["SuperMap.Geometry.LinearRing"]]
         * @description components å­å¨ççå ä½å¯¹è±¡ææ¯æçå ä½ç±»åæ°ç»ã
         * @readonly
         */
        this.componentTypes = ["SuperMap.Geometry.LinearRing"];
        this.CLASS_NAME = "SuperMap.Geometry.Polygon";
        this.geometryType = "Polygon";
    }

    /**
     * @function GeometryMultiPoint.prototype.getArea
     * @description è·å¾åºåé¢ç§¯ï¼ä»åºåçå¤é¨å£å¾åå»è®¡æ­¤åºååé¨å£å¾ç®æå¾çé¢ç§¯ã
     * @returns {number} å ä½å¯¹è±¡çé¢ç§¯ã
     */
    getArea() {
        var area = 0.0;
        if (this.components && (this.components.length > 0)) {
            area += Math.abs(this.components[0].getArea());
            for (var i = 1, len = this.components.length; i < len; i++) {
                area -= Math.abs(this.components[i].getArea());
            }
        }
        return area;
    }


}

;// CONCATENATED MODULE: ./src/common/commontypes/geometry/Rectangle.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class  GeometryRectangle
 * @aliasclass Geometry.Rectangle
 * @deprecatedclass SuperMap.Geometry.Rectangle
 * @classdesc ç©å½¢å ä½å¯¹è±¡ç±»ã
 * @category BaseTypes Geometry
 * @param {number} x - ç©å½¢å·¦ä¸è§ç¹çæ¨ªåæ ã
 * @param {number} y - ç©å½¢å·¦ä¸è§ç¹ççºµåæ ã
 * @param {number} width - ç©å½¢çå®½åº¦ã
 * @param {number} height -  ç©å½¢çé«åº¦ã
 * @extends {Geometry}
 * @example
 *  //x ä¸ºç©å½¢å·¦ä¸è§ç¹çæ¨ªåæ ï¼y ä¸ºç©å½¢å·¦ä¸è§ç¹ççºµåæ ï¼w ä¸ºç©å½¢çå®½åº¦ï¼h ä¸ºç©å½¢çé«åº¦
 *  var x = 1;
 *  var y = 2;
 *  var w = 10;
 *  var h = 20;
 *  var recttangle = new GeometryRectangle(x, y, w, h);
 * @usage
 */

class Rectangle extends Geometry {


    constructor(x, y, width, height) {
        super(x, y, width, height);
        /**
         * @member {number} GeometryRectangle.prototype.x
         * @description ç©å½¢å·¦ä¸è§ç¹çæ¨ªåæ ã
         */
        this.x = x;

        /**
         * @member {number} GeometryRectangle.prototype.y
         * @description ç©å½¢å·¦ä¸è§ç¹ççºµåæ ã
         */
        this.y = y;

        /**
         * @member {number} GeometryRectangle.prototype.width
         * @description ç©å½¢çå®½åº¦ã
         */
        this.width = width;

        /**
         * @member {number} GeometryRectangle.prototype.height
         * @description ç©å½¢çé«åº¦ã
         */
        this.height = height;

        this.CLASS_NAME = "SuperMap.Geometry.Rectangle";
        this.geometryType = "Rectangle";
    }

    /**
     * @function GeometryRectangle.prototype.calculateBounds
     * @description è®¡ç®åºæ­¤ç©å½¢å¯¹è±¡ç boundsã
     */
    calculateBounds() {
        this.bounds = new Bounds(this.x, this.y,
            this.x + this.width,
            this.y + this.height);
    }


    /**
     * @function GeometryRectangle.prototype.getArea
     * @description è·åç©å½¢å¯¹è±¡çé¢ç§¯ã
     * @returns {number} ç©å½¢å¯¹è±¡é¢ç§¯ã
     */
    getArea() {
        var area = this.width * this.height;
        return area;
    }


}

;// CONCATENATED MODULE: ./src/common/commontypes/geometry/index.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/























;// CONCATENATED MODULE: ./src/common/commontypes/Credential.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/

/**
 * @class Credential
 * @deprecatedclass SuperMap.Credential
 * @category Security
 * @classdesc SuperMap çå®å¨è¯ä¹¦ç±»ï¼å¶ä¸­åæ¬ token ç­å®å¨éªè¯ä¿¡æ¯ã</br>
 * éè¦ä½¿ç¨ç¨æ·ååå¯ç å¨ï¼"http://localhost:8090/iserver/services/security/tokens" ä¸ç³è¯· valueã</br>
 * è·å¾å½¢å¦ï¼"2OMwGmcNlrP2ixqv1Mk4BuQMybOGfLOrljruX6VcYMDQKc58Sl9nMHsqQaqeBx44jRvKSjkmpZKK1L596y7skQ.." ç valueã</br>
 * ç®åæ¯æçåè½åæ¬ï¼å°å¾æå¡ãä¸é¢å¾ãéç®ãæ¥è¯¢ãå¬äº¤æ¢ä¹ãç©ºé´åæãç½ç»åæï¼ä¸æ¯æè½®è¯¢åè½ã</br>
 * @param {string} value - è®¿é®åå®å¨éå¶çæå¡æ¶ç¨äºéè¿å®å¨è®¤è¯çéªè¯ä¿¡æ¯ã
 * @param {string} [name='token'] - éªè¯ä¿¡æ¯åç¼ï¼name=value é¨åç name é¨åã
 * @example
 * var pixcel = new Credential("valueString","token");
 * pixcel.destroy();
 * @usage
 */
class Credential {

    constructor(value, name) {

        /**
         * @member {string} Credential.prototype.value
         * @description è®¿é®åå®å¨éå¶çæå¡æ¶ç¨äºéè¿å®å¨è®¤è¯çéªè¯ä¿¡æ¯ã
         */
        this.value = value ? value : "";

        /**
         * @member {string} [Credential.prototype.name='token']
         * @description éªè¯ä¿¡æ¯åç¼ï¼name=value é¨åç name é¨åã
         */
        this.name = name ? name : "token";
        this.CLASS_NAME = "SuperMap.Credential";
    }

    /**
     * @function Credential.prototype.getUrlParameters
     * @description è·å name=value çè¡¨è¾¾å¼ã
     * @example
     * var credential = new Credential("valueString","token");
     * //è¿é str = "token=valueString";
     * var str = credential.getUrlParameters();
     * @returns {string} å®å¨ä¿¡æ¯ç»æç url çæ®µã
     */
    getUrlParameters() {
        //å½éè¦å¶ä»å®å¨ä¿¡æ¯çæ¶åï¼åéè¦return this.name + "=" + this.value + "&" + "...";çå½¢å¼æ·»å ã
        return this.name + "=" + this.value;
    }


    /**
     * @function Credential.prototype.getValue
     * @description è·å valueã
     * @example
     * var credential = new Credential("2OMwGmcNlrP2ixqv1Mk4BuQMybOGfLOrljruX6VcYMDQKc58Sl9nMHsqQaqeBx44jRvKSjkmpZKK1L596y7skQ..","token");
     * //è¿é str = "2OMwGmcNlrP2ixqv1Mk4BuQMybOGfLOrljruX6VcYMDQKc58Sl9nMHsqQaqeBx44jRvKSjkmpZKK1L596y7skQ..";
     * var str = credential.getValue();
     * @returns {string} value å­ç¬¦ä¸²ï¼å¨ iServer æå¡ä¸è¯¥ value å¼å³ä¸º token å¼ã
     */
    getValue() {
        return this.value;
    }

    /**
     *
     * @function Credential.prototype.destroy
     * @description éæ¯æ­¤å¯¹è±¡ãéæ¯åæ­¤å¯¹è±¡çææå±æ§ä¸º nullï¼èä¸æ¯åå§å¼ã
     * @example
     * var credential = new Credential("valueString","token");
     * credential.destroy();
     */
    destroy() {
        this.value = null;
        this.name = null;
    }

}

/**
 * @member {Credential} Credential.CREDENTIAL
 * @description è¿ä¸ªå¯¹è±¡ä¿å­ä¸ä¸ªå®å¨ç±»çå®ä¾ï¼å¨æå¡ç«¯éè¦å®å¨éªè¯çæ¶åå¿é¡»è¿è¡è®¾ç½®ã
 * @example
 * ä»£ç å®ä¾:
 *  // å½iServerå¯ç¨æå¡å®å¨çæ¶åï¼ä¸è¾¹çä»£ç æ¯å¿é¡»çãå®å¨è¯ä¹¦ç±»è½å¤æ¥æ¶ä¸ä¸ªvalueåä¸ä¸ªnameåæ°ã
 *  var value = "(ä»¥iServerä¸ºä¾ï¼è¿éæ¯ç³è¯·çtokenå¼)";
 *  var name = "token";
 *  // é»è®¤nameåæ°ä¸ºtokenï¼æä»¥å½ä½¿ç¨iServeræå¡çæ¶åå¯ä»¥ä¸è¿è¡è®¾ç½®ã
 *  Credential.CREDENTIAL = new Credential(value, name);
 *
 */

 Credential.CREDENTIAL = null;

;// CONCATENATED MODULE: ./src/common/commontypes/Date.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
/**
 * @name Date
 * @namespace
 * @category BaseTypes Util
 * @description åå« parseãtoISOString æ¹æ³çå®ç°ï¼ä¸¤ä¸ªæ¹æ³ç¨æ¥è§£æ RFC 3339 æ¥æï¼éµå¾ª ECMAScript 5 è§èã
 * @private
 */
var DateExt = {

    /**
     * @description çæä»£è¡¨ä¸ä¸ªå·ä½çæ¥æå­ç¬¦ä¸²ï¼è¯¥æ¥æéµå¾ª ISO 8601 æ åï¼è¯¦ææ¥ç{@link http://tools.ietf.org/html/rfc3339}ï¼ã
     * @example
     *  var dateString = DateExt.toISOString(new Date());
     * @param {Date} date - æ¥æå¯¹è±¡ã
     * @returns {string} ä¸ä¸ªä»£è¡¨æ¥æçå­ç¬¦ä¸²ãï¼ä¾å¦ "2010-08-07T16:58:23.123Z"ï¼ã
     */
    toISOString: (function () {
        //æ åçDateä¼å­å¨toISOStringæ¹æ³ï¼å¯ä»¥ç´æ¥è°ç¨
        if ("toISOString" in Date.prototype) {
            return function (date) {
                return date.toISOString();
            };
        } else {// é¨åæµè§å¨æ²¡æï¼å°±å¾èªå·±ç»åï¼ç»ååçå­ç¬¦ä¸²è§åä¸å
            function pad(num, len) {
                var str = num + "";
                while (str.length < len) {
                    str = "0" + str;
                }
                return str;
            }

            return function (date) {
                var str;
                if (isNaN(date.getTime())) {
                    // ECMA-262 says throw RangeError, Firefox returns
                    // "Invalid Date"
                    str = "Invalid Date";
                } else {
                    str =
                        date.getUTCFullYear() + "-" +
                        pad(date.getUTCMonth() + 1, 2) + "-" +
                        pad(date.getUTCDate(), 2) + "T" +
                        pad(date.getUTCHours(), 2) + ":" +
                        pad(date.getUTCMinutes(), 2) + ":" +
                        pad(date.getUTCSeconds(), 2) + "." +
                        pad(date.getUTCMilliseconds(), 3) + "Z";
                }
                return str;
            };
        }

    })(),

    /**
     * @description ä»ä¸ä¸ªå­ç¬¦ä¸²çæä¸ä¸ªæ¥æå¯¹è±¡ã
     * @example
     *  var date = DateExt.parse("2010-08-07");
     * @param {string} str - æ¥æçå­ç¬¦ä¸²ãï¼ä¾å¦ï¼ "2010", "2010-08", "2010-08-07", "2010-08-07T16:58:23.123Z","2010-08-07T11:58:23.123-06"ï¼ã
     * @returns {Date} æ¥æå¯¹è±¡ï¼å¦æå­ç¬¦ä¸²æ æ³è¢«è§£æï¼åè¿åä¸ä¸ªæ æçæ¥æã(ä¾å¦ isNaN(date.getTime()))ã
     */
    parse: function (str) {
        var date;
        var match = str.match(/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:(?:T(\d{1,2}):(\d{2}):(\d{2}(?:\.\d+)?)(Z|(?:[+-]\d{1,2}(?::(\d{2}))?)))|Z)?$/);
        if (match && (match[1] || match[7])) { // must have at least year or time
            var year = parseInt(match[1], 10) || 0;
            var month = (parseInt(match[2], 10) - 1) || 0;
            var day = parseInt(match[3], 10) || 1;
            date = new Date(Date.UTC(year, month, day));
            // optional time
            var type = match[7];
            if (type) {
                var hours = parseInt(match[4], 10);
                var minutes = parseInt(match[5], 10);
                var secFrac = parseFloat(match[6]);
                var seconds = secFrac | 0;
                var milliseconds = Math.round(1000 * (secFrac - seconds));
                date.setUTCHours(hours, minutes, seconds, milliseconds);
                // check offset
                if (type !== "Z") {
                    var hoursOffset = parseInt(type, 10);
                    var minutesOffset = parseInt(match[8], 10) || 0;
                    var offset = -1000 * (60 * (hoursOffset * 60) + minutesOffset * 60);
                    date = new Date(date.getTime() + offset);
                }
            }
        } else {
            date = new Date("invalid");
        }
        return date;
    }
};

;// CONCATENATED MODULE: ./src/common/commontypes/Event.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
 

 /**
  * @name Event
  * @namespace
  * @category BaseTypes Events
  * @description äºä»¶å¤çå½æ°.
  * @usage
  * ```
  * // æµè§å¨
  * <script type="text/javascript" src="{cdn}"></script>
  * <script>
  *   const element = {namespace}.Event.element();
  *
  *   // å¼ç¨çåæ³
  *   const result = SuperMap.Event.element();
  *
  * </script>
  *
  * // ES6 Import
  * import { Event } from '{npm}';
  * 
  * const result = Event.element();
  * ```
  */
 var Event = {

     /**
      * @description  äºä»¶è§å¯èåè¡¨ã
      * @type {Object}
      * @default false
      */
     observers: false,

     /**
      * @description KEY_SPACE
      * @type {number}
      * @default 32
      */
     KEY_SPACE: 32,

     /**
      * @description KEY_BACKSPACE
      * @type {number}
      * @default 8
      */
     KEY_BACKSPACE: 8,

     /**
      * @description KEY_TAB
      * @type {number}
      * @default 9
      */
     KEY_TAB: 9,

     /**
      * @description KEY_RETURN
      * @type {number}
      * @default 13
      */
     KEY_RETURN: 13,

     /**
      * @description KEY_ESC
      * @type {number}
      * @default 27
      */
     KEY_ESC: 27,

     /**
      * @description KEY_LEFT
      * @type {number}
      * @default 37
      */
     KEY_LEFT: 37,

     /**
      * @description KEY_UP
      * @type {number}
      * @default 38
      */
     KEY_UP: 38,

     /**
      * @description KEY_RIGHT
      * @type {number}
      * @default 39
      */
     KEY_RIGHT: 39,

     /**
      * @description KEY_DOWN
      * @type {number}
      * @default 40
      */
     KEY_DOWN: 40,

     /**
      * @description KEY_DELETE
      * @type {number}
      * @default 46
      */
     KEY_DELETE: 46,


     /**
      * @description çå¬æµè§å¨ DOM äºä»¶ã
      * @param {Event} event - Event å¯¹è±¡ã
      * @returns {HTMLElement} è§¦åäºä»¶ç DOM åç´ ã
      */
     element: function (event) {
         return event.target || event.srcElement;
     },

     /**
      * @description å¤æ­äºä»¶æ¯å¦ç±åæ¬¡è§¦æ¸å¼èµ·ã
      * @param {Event} event - Event å¯¹è±¡ã
      * @returns {boolean} æ¯å¦æä¸åªæä¸ä¸ªå½åå¨ä¸è§¦æ¸è¡¨é¢æ¥è§¦ç Touch å¯¹è±¡ã
      */
     isSingleTouch: function (event) {
         return event.touches && event.touches.length === 1;
     },

     /**
      * @description å¤æ­äºä»¶æ¯å¦ç±å¤ç¹è§¦æ§å¼èµ·ã
      * @param {Event} event - Event å¯¹è±¡ã
      * @returns {boolean} æ¯å¦å­å¨å¤ä¸ªå½åå¨ä¸è§¦æ¸è¡¨é¢æ¥è§¦ç Touch å¯¹è±¡ã
      */
     isMultiTouch: function (event) {
         return event.touches && event.touches.length > 1;
     },

     /**
      * @description ç¡®å®äºä»¶æ¯å¦ç±å·¦é®åå»å¼èµ·ã
      * @param {Event} event - Event å¯¹è±¡ã
      * @returns {boolean} æ¯å¦ç¹å»é¼ æ å·¦é®ã
      */
     isLeftClick: function (event) {
         return (((event.which) && (event.which === 1)) ||
             ((event.button) && (event.button === 1)));
     },

     /**
      * @description ç¡®å®äºä»¶æ¯å¦ç±é¼ æ å³é®åå»å¼èµ·ã
      * @param {Event} event - Event å¯¹è±¡ã
      * @returns {boolean} æ¯å¦ç¹å»é¼ æ å³é®ã
      */
     isRightClick: function (event) {
         return (((event.which) && (event.which === 3)) ||
             ((event.button) && (event.button === 2)));
     },

     /**
      * @description é»æ­¢äºä»¶åæ³¡ã
      * @param {Event} event - Event å¯¹è±¡ã
      * @param {boolean} allowDefault - é»è®¤ä¸º falseï¼è¡¨ç¤ºé»æ­¢äºä»¶çé»è®¤è¡ä¸ºã
      */
     stop: function (event, allowDefault) {

         if (!allowDefault) {
             if (event.preventDefault) {
                 event.preventDefault();
             } else {
                 event.returnValue = false;
             }
         }

         if (event.stopPropagation) {
             event.stopPropagation();
         } else {
             event.cancelBubble = true;
         }
     },

     /**
      * @description æ¥è¯¢è§¦åæå®äºä»¶ç DOM åç´ ã
      * @param {Event} event - Event å¯¹è±¡ã
      * @param {string} tagName - html æ ç­¾åã
      * @returns {HTMLElement} DOM åç´ ã
      */
     findElement: function (event, tagName) {
         var element = Event.element(event);
         while (element.parentNode && (!element.tagName ||
             (element.tagName.toUpperCase() != tagName.toUpperCase()))) {
             element = element.parentNode;
         }
         return element;
     },

     /**
      * @description çå¬äºä»¶ï¼æ³¨åäºä»¶å¤çæ¹æ³ã
      * @param {(HTMLElement|string)} elementParam - å¾çå¬ç DOM å¯¹è±¡æèå¶ ID æ è¯ã
      * @param {string} name - çå¬äºä»¶çç±»å«åç§°ã
      * @param {function} observer - æ³¨åçäºä»¶å¤çæ¹æ³ã
      * @param {boolean} [useCapture=false] - æ¯å¦æè·ã
      */
     observe: function (elementParam, name, observer, useCapture) {
         var element = Util.getElement(elementParam);
         useCapture = useCapture || false;

         if (name === 'keypress' &&
             (navigator.appVersion.match(/Konqueror|Safari|KHTML/)
                 || element.attachEvent)) {
             name = 'keydown';
         }

         //if observers cache has not yet been created, create it
         if (!this.observers) {
             this.observers = {};
         }

         //if not already assigned, make a new unique cache ID
         if (!element._eventCacheID) {
             var idPrefix = "eventCacheID_";
             if (element.id) {
                 idPrefix = element.id + "_" + idPrefix;
             }
             element._eventCacheID = Util.createUniqueID(idPrefix);
         }

         var cacheID = element._eventCacheID;

         //if there is not yet a hash entry for this element, add one
         if (!this.observers[cacheID]) {
             this.observers[cacheID] = [];
         }

         //add a new observer to this element's list
         this.observers[cacheID].push({
             'element': element,
             'name': name,
             'observer': observer,
             'useCapture': useCapture
         });

         //add the actual browser event listener
         if (element.addEventListener) {
             if(name === 'mousewheel'){
                 // https://www.chromestatus.com/features/6662647093133312
                 element.addEventListener(name, observer, {useCapture: useCapture, passive: false} );
             } else {
                 element.addEventListener(name, observer, useCapture);
             }
         } else if (element.attachEvent) {
             element.attachEvent('on' + name, observer);
         }
     },

     /**
      * @description ç§»é¤ç»å® DOM åç´ ççå¬äºä»¶ã
      * @param {(HTMLElement|string)} elementParam - å¾çå¬ç DOM å¯¹è±¡æèå¶ ID æ è¯ã
      */
     stopObservingElement: function (elementParam) {
         var element = Util.getElement(elementParam);
         var cacheID = element._eventCacheID;
         this._removeElementObservers(Event.observers[cacheID]);
     },
     _removeElementObservers: function (elementObservers) {
         if (elementObservers) {
             for (var i = elementObservers.length - 1; i >= 0; i--) {
                 var entry = elementObservers[i];
                 var args = new Array(entry.element, entry.name, entry.observer, entry.useCapture);
                 Event.stopObserving.apply(this, args);
             }
         }
     },

     /**
      * @description ç§»é¤äºä»¶çå¬åæ³¨åçäºä»¶å¤çæ¹æ³ãæ³¨æï¼äºä»¶çç§»é¤åçå¬ç¸å¯¹åºï¼ç§»é¤æ¶çåå±æ§ä¿¡æ¯å¿é¡»çå¬æ¶
      * ä¿æä¸è´æè½ç¡®ä¿äºä»¶ç§»é¤æåã
      * @param {(HTMLElement|string)} elementParam - è¢«çå¬ç DOM åç´ æèå¶ IDã
      * @param {string} name - éè¦ç§»é¤çè¢«çå¬äºä»¶åç§°ã
      * @param {function} observer - éè¦ç§»é¤çäºä»¶å¤çæ¹æ³ã
      * @param {boolean} [useCapture=false] - æ¯å¦æè·ã
      * @returns {boolean} çå¬äºä»¶æ¯å¦è¢«ç§»é¤ã
      */
     stopObserving: function (elementParam, name, observer, useCapture) {
         useCapture = useCapture || false;

         var element = Util.getElement(elementParam);
         var cacheID = element._eventCacheID;

         if (name === 'keypress') {
             if (navigator.appVersion.match(/Konqueror|Safari|KHTML/) ||
                 element.detachEvent) {
                 name = 'keydown';
             }
         }

         // find element's entry in this.observers cache and remove it
         var foundEntry = false;
         var elementObservers = Event.observers[cacheID];
         if (elementObservers) {

             // find the specific event type in the element's list
             var i = 0;
             while (!foundEntry && i < elementObservers.length) {
                 var cacheEntry = elementObservers[i];

                 if ((cacheEntry.name === name) &&
                     (cacheEntry.observer === observer) &&
                     (cacheEntry.useCapture === useCapture)) {

                     elementObservers.splice(i, 1);
                     if (elementObservers.length == 0) {
                         delete Event.observers[cacheID];
                     }
                     foundEntry = true;
                     break;
                 }
                 i++;
             }
         }

         //actually remove the event listener from browser
         if (foundEntry) {
             if (element.removeEventListener) {
                 element.removeEventListener(name, observer, useCapture);
             } else if (element && element.detachEvent) {
                 element.detachEvent('on' + name, observer);
             }
         }
         return foundEntry;
     },

     /**
      * @description ç§»é¤ç¼å­ä¸­ççå¬äºä»¶ã
      */
     unloadCache: function () {
         // check for Event before checking for observers, because
         // Event may be undefined in IE if no map instance was
         // created
         if (Event && Event.observers) {
             for (var cacheID in Event.observers) {
                 var elementObservers = Event.observers[cacheID];
                 Event._removeElementObservers.apply(this,
                     [elementObservers]);
             }
             Event.observers = false;
         }
     },

     CLASS_NAME: "SuperMap.Event"
 };
 /* prevent memory leaks in IE */
 Event.observe(window, 'resize', Event.unloadCache, false);

;// CONCATENATED MODULE: ./src/common/commontypes/Events.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class Events
 * @deprecatedclass SuperMap.Events
 * @classdesc äºä»¶ç±»ã
 * @category BaseTypes Events
 * @param {Object} object - å½åäºä»¶å¯¹è±¡è¢«æ·»å å°ç JS å¯¹è±¡ã
 * @param {HTMLElement} element - ååºæµè§å¨äºä»¶ç DOM åç´ ã
 * @param {Array.<string>} eventTypes - èªå®ä¹åºç¨äºä»¶çæ°ç»ã
 * @param {boolean} [fallThrough=false] - æ¯å¦åè®¸äºä»¶å¤çä¹ååä¸ä¼ éï¼åæ³¡ï¼ï¼ä¸º false çæ¶åé»æ­¢äºä»¶åæ³¡ã
 * @param {Object} options - äºä»¶å¯¹è±¡éé¡¹ã
 * @usage
 */
class Events {

    constructor(object, element, eventTypes, fallThrough, options) {
        /**
         * @member {Array.<string>} Events.prototype.BROWSER_EVENTS
         * @description æ¯æçäºä»¶ã
         * @constant
         * @default [
         "mouseover", "mouseout","mousedown", "mouseup", "mousemove",
         "click", "dblclick", "rightclick", "dblrightclick","resize",
         "focus", "blur","touchstart", "touchmove", "touchend","keydown",
         "MSPointerDown", "MSPointerUp", "pointerdown", "pointerup",
         "MSGestureStart", "MSGestureChange", "MSGestureEnd","contextmenu"
         ]
         */
        this.BROWSER_EVENTS = [
            "mouseover", "mouseout",
            "mousedown", "mouseup", "mousemove",
            "click", "dblclick", "rightclick", "dblrightclick",
            "resize", "focus", "blur",
            "touchstart", "touchmove", "touchend",
            "keydown", "MSPointerDown", "MSPointerUp", "pointerdown", "pointerup",
            "MSGestureStart", "MSGestureChange", "MSGestureEnd",
            "contextmenu"
        ];

        /**
         * @member {Object} Events.prototype.listeners
         * @description äºä»¶çå¬å¨å½æ°
         */
        this.listeners = {};

        /**
         * @member {Object} Events.prototype.object
         * @description  åå¸åºç¨ç¨åºäºä»¶çå¯¹è±¡ã
         */
        this.object = object;

        /**
         * @member {HTMLElement} Events.prototype.element
         * @description æ¥åæµè§å¨äºä»¶ç DOM èç¹ã
         */
        this.element = null;

        /**
         * @member {Array.<string>} Events.prototype.eventTypes
         * @description æ¯æçäºä»¶ç±»ååè¡¨ã
         */
        this.eventTypes = [];

        /**
         * @member {function} Events.prototype.eventHandler
         * @description ç»å®å¨åç´ ä¸çäºä»¶å¤çå¨å¯¹è±¡ã
         */
        this.eventHandler = null;

        /**
         * @member {boolean} [Events.prototype.fallThrough=false]
         * @description æ¯å¦åè®¸äºä»¶å¤çä¹ååä¸ä¼ éï¼åæ³¡ï¼ï¼ä¸º false çæ¶åé»æ­¢äºä»¶åæ³¡ã
         */
        this.fallThrough = fallThrough;

        /**
         * @member {boolean} [Events.prototype.includeXY=false]
         * @description å¤æ­æ¯å¦è®© xy å±æ§èªå¨åå»ºå°æµè§å¨ä¸çé¼ æ äºä»¶ï¼ä¸è¬è®¾ç½®ä¸º falseï¼å¦æè®¾ç½®ä¸º trueï¼é¼ æ äºä»¶å°ä¼å¨äºä»¶ä¼ éè¿ç¨ä¸­èªå¨äº§ç xy å±æ§ã
         *              å¯æ ¹æ®äºä»¶å¯¹è±¡ç 'evt.object' å±æ§å¨ç¸å³çäºä»¶å¥æä¸è°ç¨ getMousePosition å½æ°ãè¿ä¸ªéé¡¹ä¹ æ¯é»è®¤ä¸º false çåå å¨äºï¼å½åå»ºä¸ä¸ª
         *              äºä»¶å¯¹è±¡ï¼å¶ä¸»è¦ç®çæ¯ç®¡çãå¨ä¸ä¸ª div çç¸å¯¹å®ä½çé¼ æ äºä»¶ï¼å°å¶è®¾ä¸º true ä¹æ¯ææä¹çãè¿ä¸ªéé¡¹ä¹å¯ä»¥ç¨æ¥æ§å¶æ¯å¦æµæ¶ç¼å­ãå¦æ
         *              è®¾ä¸º false ä¸æµæ¶ï¼å¦æè®¾ä¸º trueï¼ç¨ this.clearMouseCache() æ¸é¤ç¼å­åç§»ï¼è¾¹çåç´ åç§»ï¼åç´ å¨é¡µé¢çä½ç½®åç§»ï¼ã
         * @example
         *  function named(evt) {
         *        this.xy = this.object.events.getMousePosition(evt);
         *  }
         */
        this.includeXY = false;

        /**
         * @member {Object} Events.prototype.extensions
         * @description äºä»¶æ©å±ãKeys ä»£è¡¨äºä»¶ç±»åï¼values ä»£è¡¨äºä»¶å¯¹è±¡ã
         */
        this.extensions = {};

        /**
         * @member {Object} Events.prototype.extensionCount
         * @description äºä»¶æ©å±æ°éã
         */
        this.extensionCount = {};
        /**
         * @member {Object} Events.prototype.clearMouseListener
         * @description å¾ç§»é¤çé¼ æ çå¬äºä»¶ã
         */
        this.clearMouseListener = null;

        Util.extend(this, options);

        if (eventTypes != null) {
            for (var i = 0, len = eventTypes.length; i < len; i++) {
                this.addEventType(eventTypes[i]);
            }
        }

        if (element != null) {
            this.attachToElement(element);
        }

        this.CLASS_NAME = "SuperMap.Events";
    }

    /**
     * @function Events.prototype.destroy
     * @description ç§»é¤å½åè¦ç´  element ä¸çææäºä»¶çå¬åå¤çã
     */
    destroy() {
        for (var e in this.extensions) {
            if (typeof this.extensions[e] !== "boolean") {
                this.extensions[e].destroy();
            }
        }
        this.extensions = null;
        if (this.element) {
            Event.stopObservingElement(this.element);
            if (this.element.hasScrollEvent) {
                Event.stopObserving(
                    window, "scroll", this.clearMouseListener
                );
            }
        }
        this.element = null;

        this.listeners = null;
        this.object = null;
        this.eventTypes = null;
        this.fallThrough = null;
        this.eventHandler = null;
    }

    /**
     * @function Events.prototype.addEventType
     * @description å¨æ­¤äºä»¶å¯¹è±¡ä¸­æ·»å æ°çäºä»¶ç±»åï¼å¦æè¿ä¸ªäºä»¶ç±»åå·²ç»æ·»å è¿äºï¼åä¸åä»»ä½äºæã
     * @param {string} eventName - äºä»¶åã
     */
    addEventType(eventName) {
        if (!this.listeners[eventName]) {
            this.eventTypes.push(eventName);
            this.listeners[eventName] = [];
        }
    }

    /**
     * @function Events.prototype.attachToElement
     * @description ç» DOM åç´ ç»å®æµè§å¨äºä»¶ã
     * @param {HTMLElement} element - ç»å®æµè§å¨äºä»¶ç DOM åç´ ã
     */
    attachToElement(element) {
        if (this.element) {
            Event.stopObservingElement(this.element);
        } else {
            // keep a bound copy of handleBrowserEvent() so that we can
            // pass the same function to both Event.observe() and .stopObserving()
            this.eventHandler = FunctionExt.bindAsEventListener(
                this.handleBrowserEvent, this
            );

            // to be used with observe and stopObserving
            this.clearMouseListener = FunctionExt.bind(
                this.clearMouseCache, this
            );
        }
        this.element = element;
        for (var i = 0, len = this.BROWSER_EVENTS.length; i < len; i++) {
            var eventType = this.BROWSER_EVENTS[i];

            // every browser event has a corresponding application event
            // (whether it's listened for or not).
            this.addEventType(eventType);

            // use Prototype to register the event cross-browser
            Event.observe(element, eventType, this.eventHandler);
        }
        // disable dragstart in IE so that mousedown/move/up works normally
        Event.observe(element, "dragstart", Event.stop);
    }


    /**
     * @function Events.prototype.on
     * @description å¨ä¸ä¸ªç¸åçèå´åæ³¨åçå¬å¨çæ¹æ³ï¼æ­¤æ¹æ³è°ç¨ register å½æ°ã
     * @example
     * // æ³¨åä¸ä¸ª "loadstart" çå¬äºä»¶
     * events.on({"loadstart": loadStartListener});
     *
     * // åæ ·æ³¨åä¸ä¸ª "loadstart" çå¬äºä»¶
     * events.register("loadstart", undefined, loadStartListener);
     *
     * // åæ¶ä¸ºå¯¹è±¡æ³¨åå¤ä¸ªçå¬äºä»¶
     * events.on({
     *     "loadstart": loadStartListener,
     *     "loadend": loadEndListener,
     *     scope: object
     * });
     *
     * // åæ¶ä¸ºå¯¹è±¡æ³¨åå¤ä¸ªçå¬äºä»¶ï¼å¤æ¬¡è°ç¨ register æ¹æ³
     * events.register("loadstart", object, loadStartListener);
     * events.register("loadend", object, loadEndListener);
     *
     *
     * @param {Object} object - æ·»å çå¬çå¯¹è±¡ã
     */
    on(object) {
        for (var type in object) {
            if (type !== "scope" && object.hasOwnProperty(type)) {
                this.register(type, object.scope, object[type]);
            }
        }
    }


    /**
     * @function Events.prototype.register
     * @description å¨äºä»¶å¯¹è±¡ä¸æ³¨åä¸ä¸ªäºä»¶ãå½äºä»¶è¢«è§¦åæ¶ï¼'func' å½æ°è¢«è°ç¨ï¼åè®¾æä»¬è§¦åä¸ä¸ªäºä»¶ï¼
     *              æå® Bounds ä½ä¸º "obj"ï¼å½äºä»¶è¢«è§¦åæ¶ï¼åè°å½æ°çä¸ä¸æä½ä¸º Bounds å¯¹è±¡ã
     * @param {string} type - äºä»¶æ³¨åèçåå­ã
     * @param {Object} [obj=this.object] - å¯¹è±¡ç»å®çåè°ã
     * @param {function} [func] - åè°å½æ°ï¼å¦ææ²¡æç¹å®çåè°ï¼åè¿ä¸ªå½æ°ä¸åä»»ä½äºæã
     * @param {(boolean|Object)} [priority] - å½ä¸º true æ¶å°æ°ççå¬å å¨äºä»¶éåçåé¢ã
     */
    register(type, obj, func, priority) {
        if (type in Events && !this.extensions[type]) {
            this.extensions[type] = new Events[type](this);
        }
        if ((func != null) &&
            (Util.indexOf(this.eventTypes, type) !== -1)) {

            if (obj == null) {
                obj = this.object;
            }
            var listeners = this.listeners[type];
            if (!listeners) {
                listeners = [];
                this.listeners[type] = listeners;
                this.extensionCount[type] = 0;
            }
            var listener = {obj: obj, func: func};
            if (priority) {
                listeners.splice(this.extensionCount[type], 0, listener);
                if (typeof priority === "object" && priority.extension) {
                    this.extensionCount[type]++;
                }
            } else {
                listeners.push(listener);
            }
        }
    }

    /**
     * @function Events.prototype.registerPriority
     * @description ç¸åçæ³¨åæ¹æ³ï¼ä½æ¯å¨åé¢å¢å æ°ççå¬èäºä»¶æ¥è¯¢èä»£æ¿å°æ¹æ³çç»æã
     * @param {string} type - äºä»¶æ³¨åèçåå­ã
     * @param {Object} [obj=this.object] - å¯¹è±¡ç»å®çåè°ã
     * @param {function} [func] - åè°å½æ°ï¼å¦ææ²¡æç¹å®çåè°ï¼åè¿ä¸ªå½æ°ä¸åä»»ä½äºæã
     */
    registerPriority(type, obj, func) {
        this.register(type, obj, func, true);
    }


    /**
     * @function Events.prototype.un
     * @description å¨ä¸ä¸ªç¸åçèå´ååæ¶æ³¨åçå¬å¨çæ¹æ³ï¼æ­¤æ¹æ³è°ç¨ unregister å½æ°ã
     * @example
     * // ç§»é¤ "loadstart" äºä»¶çå¬
     * events.un({"loadstart": loadStartListener});
     *
     * // ä½¿ç¨ "unregister" æ¹æ³ç§»é¤ "loadstart" äºä»¶çå¬
     * events.unregister("loadstart", undefined, loadStartListener);
     *
     * // åæ¶å¯¹è±¡å¤ä¸ªäºä»¶çå¬
     * events.un({
     *     "loadstart": loadStartListener,
     *     "loadend": loadEndListener,
     *     scope: object
     * });
     *
     * // åæ¶å¯¹è±¡å¤ä¸ªäºä»¶çå¬ï¼å¤æ¬¡è°ç¨unregisteræ¹æ³ã
     * events.unregister("loadstart", object, loadStartListener);
     * events.unregister("loadend", object, loadEndListener);
     *
     * @param {Object} object - ç§»é¤çå¬çå¯¹è±¡ã
     */
    un(object) {
        for (var type in object) {
            if (type !== "scope" && object.hasOwnProperty(type)) {
                this.unregister(type, object.scope, object[type]);
            }
        }
    }

    /**
     * @function Events.prototype.unregister
     * @description åæ¶æ³¨åã
     * @param {string} type - äºä»¶ç±»åã
     * @param {Object} [obj=this.object] - å¯¹è±¡ç»å®çåè°ã
     * @param {function} [func] - åè°å½æ°ï¼å¦ææ²¡æç¹å®çåè°ï¼åè¿ä¸ªå½æ°ä¸åä»»ä½äºæã
     */
    unregister(type, obj, func) {
        if (obj == null) {
            obj = this.object;
        }
        var listeners = this.listeners[type];
        if (listeners != null) {
            for (var i = 0, len = listeners.length; i < len; i++) {
                if (listeners[i].obj === obj && listeners[i].func === func) {
                    listeners.splice(i, 1);
                    break;
                }
            }
        }
    }


    /**
     * @function Events.prototype.remove
     * @description å é¤æä¸ªäºä»¶ç±»åçææçå¬ï¼å¦æè¯¥äºä»¶ç±»åæ²¡ææ³¨åï¼åä¸åä»»ä½æä½ã
     * @param {string} type - äºä»¶ç±»åã
     */
    remove(type) {
        if (this.listeners[type] != null) {
            this.listeners[type] = [];
        }
    }

    /**
     * @function Events.prototype.triggerEvent
     * @description è§¦åä¸ä¸ªç¹å®çæ³¨åäºä»¶ã
     * @param {string} type - è§¦åäºä»¶ç±»åã
     * @param {Event} evt - äºä»¶å¯¹è±¡ã
     * @returns {Event|boolean} çå¬å¯¹è±¡ï¼å¦æè¿åæ¯ falseï¼ååæ­¢çå¬ã
     */
    triggerEvent(type, evt) {
        var listeners = this.listeners[type];

        // fast path
        if (!listeners || listeners.length == 0) {
            return undefined;
        }

        // prep evt object with object & div references
        if (evt == null) {
            evt = {};
        }
        evt.object = this.object;
        evt.element = this.element;
        if (!evt.type) {
            evt.type = type;
        }

        // execute all callbacks registered for specified type
        // get a clone of the listeners array to
        // allow for splicing during callbacks
        listeners = listeners.slice();
        var continueChain;
        for (var i = 0, len = listeners.length; i < len; i++) {
            var callback = listeners[i];
            // bind the context to callback.obj
            continueChain = callback.func.apply(callback.obj, [evt]);

            if ((continueChain != undefined) && (continueChain === false)) {
                // if callback returns false, execute no more callbacks.
                break;
            }
        }
        // don't fall through to other DOM elements
        if (!this.fallThrough) {
            Event.stop(evt, true);
        }
        return continueChain;
    }


    /**
     * @function Events.prototype.handleBrowserEvent
     * @description å¯¹ triggerEvent å½æ°çåè£ï¼ç»äºä»¶å¯¹è±¡è®¾ç½®äº xy å±æ§ï¼å³å½åé¼ æ ç¹ç xy åæ ï¼ã
     * @param {Event} evt - äºä»¶å¯¹è±¡ã
     */
    handleBrowserEvent(evt) {
        var type = evt.type, listeners = this.listeners[type];
        if (!listeners || listeners.length == 0) {
            // noone's listening, bail out
            return;
        }
        // add clientX & clientY to all events - corresponds to average x, y
        var touches = evt.touches;
        if (touches && touches[0]) {
            var x = 0;
            var y = 0;
            var num = touches.length;
            var touch;
            for (var i = 0; i < num; ++i) {
                touch = touches[i];
                x += touch.clientX;
                y += touch.clientY;
            }
            evt.clientX = x / num;
            evt.clientY = y / num;
        }
        if (this.includeXY) {
            evt.xy = this.getMousePosition(evt);
        }
        this.triggerEvent(type, evt);
    }


    /**
     * @function Events.prototype.clearMouseCache
     * @description æ¸é¤é¼ æ ç¼å­ã
     */
    clearMouseCache() {
        this.element.scrolls = null;
        this.element.lefttop = null;
        var body = document.body;
        if (body && !((body.scrollTop != 0 || body.scrollLeft != 0) &&
                navigator.userAgent.match(/iPhone/i))) {
            this.element.offsets = null;
        }
    }

    /**
     * @function Events.prototype.getMousePosition
     * @description è·åå½åé¼ æ çä½ç½®ã
     * @param {Event} evt - äºä»¶å¯¹è±¡ã
     * @returns {Pixel} å½åçé¼ æ ç xy åæ ç¹ã
     */
    getMousePosition(evt) {
        if (!this.includeXY) {
            this.clearMouseCache();
        } else if (!this.element.hasScrollEvent) {
            Event.observe(window, "scroll", this.clearMouseListener);
            this.element.hasScrollEvent = true;
        }

        if (!this.element.scrolls) {
            var viewportElement = Util.getViewportElement();
            this.element.scrolls = [
                viewportElement.scrollLeft,
                viewportElement.scrollTop
            ];
        }

        if (!this.element.lefttop) {
            this.element.lefttop = [
                (document.documentElement.clientLeft || 0),
                (document.documentElement.clientTop || 0)
            ];
        }

        if (!this.element.offsets) {
            this.element.offsets = Util.pagePosition(this.element);
        }

        return new Pixel(
            (evt.clientX + this.element.scrolls[0]) - this.element.offsets[0]
            - this.element.lefttop[0],
            (evt.clientY + this.element.scrolls[1]) - this.element.offsets[1]
            - this.element.lefttop[1]
        );
    }

}
Events.prototype.BROWSER_EVENTS = [
  "mouseover", "mouseout",
  "mousedown", "mouseup", "mousemove",
  "click", "dblclick", "rightclick", "dblrightclick",
  "resize", "focus", "blur",
  "touchstart", "touchmove", "touchend",
  "keydown", "MSPointerDown", "MSPointerUp", "pointerdown", "pointerup",
  "MSGestureStart", "MSGestureChange", "MSGestureEnd",
  "contextmenu"
];

;// CONCATENATED MODULE: ./src/common/commontypes/Feature.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class Feature
 * @deprecatedclass SuperMap.Feature
 * @category BaseTypes Geometry
 * @classdesc è¦ç´ ç±»ç»åäºå°çåå±æ§ï¼Feature ç±»åæ¶å·æ marker å lonlat å±æ§ã
 * @param {SuperMap.Layer} layer - å¾å±ã
 * @param {LonLat} lonlat - ç»çº¬åº¦ã
 * @param {Object} data - æ°æ®å¯¹è±¡ã
 * @usage
 */
class Feature {


    constructor(layer, lonlat, data) {
        this.CLASS_NAME = "SuperMap.Feature";
        /**
         * @deprecated
         * @member {SuperMap.Layer} Feature.prototype.layer
         * @description å¾å±ã
         */
        this.layer = layer;

        /**
         * @member {string} Feature.prototype.id
         * @description è¦ç´  IDã
         */
        this.id = Util.createUniqueID(this.CLASS_NAME + "_");

        /**
         * @member {LonLat} Feature.prototype.lonlat
         * @description ç»çº¬åº¦ã
         *
         */
        this.lonlat = lonlat;

        /**
         * @member {Object} Feature.prototype.data
         * @description æ°æ®å¯¹è±¡ã
         */
        this.data = (data != null) ? data : {};

    }

    /**
     * @function Feature.prototype.destroy
     * @description éæ¾ç¸å³èµæºã
     */
    destroy() {
        this.id = null;
        this.lonlat = null;
        this.data = null;
    }
}

;// CONCATENATED MODULE: ./src/common/commontypes/Vector.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class FeatureVector
 * @aliasclass Feature.Vector
 * @deprecatedclass SuperMap.Feature.Vector
 * @category BaseTypes Geometry
 * @classdesc ç¢éè¦ç´ ç±»ãè¯¥ç±»å·æ Geometry å±æ§å­æ¾å ä½ä¿¡æ¯ï¼
 * attributes å±æ§å­æ¾éå ä½ä¿¡æ¯ï¼å¦å¤è¿åå«äº style å±æ§ï¼ç¨æ¥å®ä¹ç¢éè¦ç´ çæ ·å¼ï¼
 * å¶ä¸­ï¼é»è®¤çæ ·å¼å¨ {@link FeatureVector.style} ç±»ä¸­å®ä¹ï¼å¦ææ²¡æç¹å«çæå®å°ä½¿ç¨é»è®¤çæ ·å¼ã
 * @extends {Feature}
 * @param {Geometry} geometry - è¦ç´ çå ä½ä¿¡æ¯ã
 * @param {Object} [attributes] - æè¿°è¦ç´ çä»»æçå¯åºååå±æ§ï¼å°è¦æ å°å° attributes å±æ§ä¸­çå¯¹è±¡ã
 * @param {Object} [style] - æ ·å¼å¯¹è±¡ã
 * @example
 * var geometry = new GeometryPoint(-115,10);
 *  var style = {
     *      strokeColor:"#339933",
     *      strokeOpacity:1,
     *      strokeWidth:3,
     *      pointRadius:6
     *  }
 *  var pointFeature = new FeatureVector(geometry,null,style);
 *  vectorLayer.addFeatures(pointFeature);
 * @usage
 */
// TRASH THIS
const State = {
  /** states */
  UNKNOWN: 'Unknown',
  INSERT: 'Insert',
  UPDATE: 'Update',
  DELETE: 'Delete'
};
class Vector extends Feature {


    constructor(geometry, attributes, style) {
        super(null, null, attributes);
        /**
         * @member {string} FeatureVector.prototype.fid
         * @description fid
         */
        this.fid = null;

        /**
         * @member {Geometry} FeatureVector.prototype.geometry
         * @description å­æ¾å ä½ä¿¡æ¯ã
         */
        this.geometry = geometry ? geometry : null;

        /**
         * @member {Object} FeatureVector.prototype.attributes
         * @description æè¿°è¦ç´ çä»»æçå¯åºååå±æ§ã
         */
        this.attributes = {};

        if (attributes) {
            this.attributes = Util.extend(this.attributes, attributes);
        }

        /**
         * @member {Bounds} FeatureVector.prototype.bounds
         * @description éå¶è¦ç´ å ä½çè¾¹çã
         */
        this.bounds = null;

        /**
         * @member {string} FeatureVector.prototype.state
         * @description state
         */
        this.state = null;

        /**
         * @member {Object} FeatureVector.prototype.style
         * @description è¦ç´ çæ ·å¼å±æ§ï¼å°å¾æ¥è¯¢è¿åç feature ç styleï¼8C åä¸ºnullã
         */
        this.style = style ? style : null;

        /**
         * @member {string} FeatureVector.prototype.url
         * @description å¦æè®¾ç½®äºè¿ä¸ªå±æ§ï¼å¨æ´æ°æèå é¤è¦ç´ æ¶éè¦èè {@link HTTP} ã
         */
        this.url = null;

        this.lonlat = null;

        this.CLASS_NAME = "SuperMap.Feature.Vector";

        Vector.style = {
            'default': {
                fillColor: "#ee9900",
                fillOpacity: 0.4,
                hoverFillColor: "white",
                hoverFillOpacity: 0.8,
                strokeColor: "#ee9900",
                strokeOpacity: 1,
                strokeWidth: 1,
                strokeLinecap: "round",
                strokeDashstyle: "solid",
                hoverStrokeColor: "red",
                hoverStrokeOpacity: 1,
                hoverStrokeWidth: 0.2,
                pointRadius: 6,
                hoverPointRadius: 1,
                hoverPointUnit: "%",
                pointerEvents: "visiblePainted",
                cursor: "inherit",
                fontColor: "#000000",
                labelAlign: "cm",
                labelOutlineColor: "white",
                labelOutlineWidth: 3
            },
            'select': {
                fillColor: "blue",
                fillOpacity: 0.4,
                hoverFillColor: "white",
                hoverFillOpacity: 0.8,
                strokeColor: "blue",
                strokeOpacity: 1,
                strokeWidth: 2,
                strokeLinecap: "round",
                strokeDashstyle: "solid",
                hoverStrokeColor: "red",
                hoverStrokeOpacity: 1,
                hoverStrokeWidth: 0.2,
                pointRadius: 6,
                hoverPointRadius: 1,
                hoverPointUnit: "%",
                pointerEvents: "visiblePainted",
                cursor: "pointer",
                fontColor: "#000000",
                labelAlign: "cm",
                labelOutlineColor: "white",
                labelOutlineWidth: 3

            },
            'temporary': {
                fillColor: "#66cccc",
                fillOpacity: 0.2,
                hoverFillColor: "white",
                hoverFillOpacity: 0.8,
                strokeColor: "#66cccc",
                strokeOpacity: 1,
                strokeLinecap: "round",
                strokeWidth: 2,
                strokeDashstyle: "solid",
                hoverStrokeColor: "red",
                hoverStrokeOpacity: 1,
                hoverStrokeWidth: 0.2,
                pointRadius: 6,
                hoverPointRadius: 1,
                hoverPointUnit: "%",
                pointerEvents: "visiblePainted",
                //cursor:"inherit",
                cursor: "default",
                fontColor: "#000000",
                labelAlign: "cm",
                labelOutlineColor: "white",
                labelOutlineWidth: 3

            },
            'delete': {
                display: "none"
            }
        };
    }

    /**
     * @function FeatureVector.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        if (this.layer) {
            this.layer.removeFeatures(this);
            this.layer = null;
        }

        this.geometry = null;
        super.destroy();
    }

    /**
     * @function FeatureVector.prototype.clone
     * @description å¤å¶ç¢éè¦ç´ ï¼å¹¶è¿åå¤å¶åçæ°å¯¹è±¡ã
     * @returns {FeatureVector} ç¸åè¦ç´ çæ°çç¢éè¦ç´ ã
     */
    clone() {
        return new Vector(
            this.geometry ? this.geometry.clone() : null,
            this.attributes,
            this.style);
    }

    /**
     * @function FeatureVector.prototype.toState
     * @description è®¾ç½®æ°ç¶æã
     * @param {string} state - ç¶æã
     */
    toState(state) {
        if (state === State.UPDATE) {
            switch (this.state) {
                case State.UNKNOWN:
                case State.DELETE:
                    this.state = state;
                    break;
                case State.UPDATE:
                case State.INSERT:
                    break;
            }
        } else if (state === State.INSERT) {
            switch (this.state) {
                case State.UNKNOWN:
                    break;
                default:
                    this.state = state;
                    break;
            }
        } else if (state === State.DELETE) {
            switch (this.state) {
                case State.INSERT:
                    // the feature should be destroyed
                    break;
                case State.DELETE:
                    break;
                case State.UNKNOWN:
                case State.UPDATE:
                    this.state = state;
                    break;
            }
        } else if (state === State.UNKNOWN) {
            this.state = state;
        }
    }
}
/**
 *
 * @typedef {Object} FeatureVector.style
 * @description Feature æå¤§éçæ ·å¼å±æ§ï¼å¦ææ²¡æç¹å«çæå®å°ä½¿ç¨é»è®¤çæ ·å¼ï¼
 * å¤§é¨åæ ·å¼éè¿ SVG æ åå®ä¹å±æ§ã
 * - fill properties èµæä»ç»ï¼{@link http://www.w3.org/TR/SVG/painting.html#FillProperties}
 * - stroke properties èµæä»ç»ï¼{@link http://www.w3.org/TR/SVG/painting.html#StrokeProperties}
 * @property {boolean} [fill] - ä¸éè¦å¡«ååè®¾ç½®ä¸º falseã
 * @property {string} [fillColor='#ee9900'] - åå­è¿å¶å¡«åé¢è²ã
 * @property {number} [fillOpacity=0.4] - å¡«åä¸éæåº¦ã
 * @property {boolean} [stroke] - ä¸éè¦æè¾¹åè®¾ä¸º falseã
 * @property {string} [strokeColor='#ee9900'] - åå­è¿å¶æè¾¹é¢è²ã
 * @property {number} [strokeOpacity=0.4] - æè¾¹çä¸éæåº¦(0-1)ã
 * @property {number} [strokeWidth=1] - åç´ æè¾¹å®½åº¦ã
 * @property {string} [strokeLinecap='round'] - strokeLinecap æä¸ç§ç±»å buttï¼roundï¼squareã
 * @property {string} [strokeDashstyle='solid'] - æ dotï¼dashï¼dashdotï¼longdashï¼longdashdotï¼solid å ç§æ ·å¼ã
 * @property {boolean} [graphic] - ä¸éè¦åè®¾ç½®ä¸º falseã
 * @property {number} [pointRadius=6] - åç´ ç¹åå¾ã
 * @property {string} [pointerEvents='visiblePainted'] - pointerEventsã
 * @property {string} [cursor] - cursorã
 * @property {boolean} [allowRotate='false'] - æ¯å¦åè®¸å¾æ éçè¿è¡æ¹åæè½¬ãç¨äºæ¶ç©ºæ°æ®å¾å±ã
 * @property {string} [externalGraphic] - è¿æ¥å°ç¨æ¥æ¸²æç¹çå¤é¨çå¾å½¢ã
 * @property {number} [graphicWidth] - å¤é¨å¾è¡¨çåç´ å®½åº¦ã
 * @property {number} [graphicHeight] - å¤é¨å¾è¡¨çé«å®½åº¦ã
 * @property {number} [graphicOpacity] - å¤é¨å¾è¡¨çä¸éæåº¦(0-1)ã
 * @property {number} [graphicXOffset] - å¤é¨å¾è¡¨æ²¿çxæ¹åçåç§»éã
 * @property {number} [graphicYOffset] - å¤é¨å¾è¡¨æ²¿çyæ¹åçåç§»é Pixelã
 * @property {number} [rotation] - ä¸ä¸ªå¾è¡¨æ²¿çå¶ä¸­å¿ç¹ï¼æèåç§»ä¸­å¿æå®ç¹ï¼å¨é¡ºæ¶éæ¹åæè½¬ã
 * @property {number} [graphicZIndex] - æ¸²ææ¶ä½¿ç¨çç´¢å¼å¼ã
 * @property {string} [graphicName='circle'] - æ¸²æç¹æ¶å¾æ ä½¿ç¨çåå­ãæ¯æ"circle" , "square", "star", "x", "cross", "triangle"ã
 * @property {string} [graphicTitle] - å¤é¨å¾è¡¨çæç¤ºæ¡ã
 * @property {string} [backgroundGraphic] - å¤é¨å¾è¡¨çèæ¯ã
 * @property {number} [backgroundGraphicZIndex] - èæ¯å¾æ¸²ææ¶ä½¿ç¨çç´¢å¼å¼ã
 * @property {number} [backgroundXOffset] - èæ¯å¾å¨ x è½´çåç§»éã
 * @property {number} [backgroundYOffset] - èæ¯å¾å¨ y è½´çåç§»éã
 * @property {number} [backgroundHeight] - èæ¯å¾çé«åº¦ãå¦ææ²¡æè®¾ç½®ï¼å°ç¨ graphicHeightã
 * @property {number} [backgroundWidth] - èæ¯å¾çå®½åº¦ãå¦ææ²¡æè®¾ç½®ï¼å°ç¨ graphicWidthã
 * @property {boolean} [isUnicode=false] - è¿ä¸ªå±æ§è¦éå label å±æ§æ¥ç¨ï¼å½ä¸º trueæ¶ï¼label å°±å¯ä»¥ä½¿ç¨ unicode ç¼ç ï¼
 * æ¯å¦ "a" ç unicode åå­è¿å¶ç¼ç ä¸º 61ï¼å label å±æ§å¯ä»¥ä¸º "&#x61;",å¶ä¸­ "&#" ä¸ºåç¼ï¼æ å¿è¿ä¸ªä¸º unicode ç¼ç ï¼
 * "x" æ¯æ 16 è¿å¶,è¿æ¶é¡µé¢æ¾ç¤ºçæ¯ "a"ï¼å½æ­¤å¼ä¸º false çæ¶åï¼label çåå®¹ä¼è¢«ç´æ¥è¾åºï¼
 * æ¯å¦ï¼label ä¸º "&#x61;"ï¼è¿æ¶é¡µé¢æ¾ç¤ºçä¹æ¯ "&#x61;"ã
 * @property {string} [label] - å¯éçæ ç­¾ææ¬ã
 * @property {string} [labelAlign='cm'] - æ ç­¾å¯¹é½ï¼æ¯ç±ä¸¤ä¸ªå­ç¬¦ç»æçå­ç¬¦ä¸²ï¼å¦ï¼"lt", "cm", "rb"ï¼
 * å¶ä¸­ç¬¬ä¸ä¸ªå­ç¬¦ä»£è¡¨æ°´å¹³æ¹åä¸çå¯¹é½ï¼"l"=left, "c"=center, "r"=rightï¼
 * ç¬¬äºä¸ªå­ç¬¦ä»£è¡¨åç´æ¹åä¸çå¯¹é½ï¼"t"=top, "m"=middle, "b"=bottomã
 * @property {number} [labelXOffset] - æ ç­¾å¨ x è½´æ¹åçåç§»éã
 * @property {number} [labelYOffset] - æ ç­¾å¨ y è½´æ¹åçåç§»éã
 * @property {boolean} [labelSelect=false] - å¦æè®¾ä¸º trueï¼æ ç­¾å¯ä»¥éç¨ SelectFeature æè similar æ§ä»¶ã
 * @property {string} [fontColor='#000000'] - æ ç­¾å­ä½é¢è²ã
 * @property {number} [fontOpacity] - æ ç­¾éæåº¦ (0-1)ã
 * @property {string} [fontFamily] - æ ç­¾çå­ä½ç±»åã
 * @property {string} [fontSize] - æ ç­¾çå­ä½å¤§å°ã
 * @property {string} [fontStyle] - æ ç­¾çå­ä½æ ·å¼ã
 * @property {string} [fontWeight] - æ ç­¾çå­ä½ç²ç»ã
 * @property {string} [display] - å¦æ display å±æ§è®¾ç½®ä¸º ânoneâï¼ç¬¦å·å°æ²¡æä»»ä½ææã
 * @example
 *  // labelçç¨æ³å¦ä¸ï¼
 *  function addGeoTest(){
 *  var geometry = new GeometryPoint(105, 35);
 *  var pointFeature = new FeatureVector(geometry);
 *  var styleTest = {
 *        label:"supermap",
 *        fontColor:"#0000ff",
 *        fontOpacity:"0.5",
 *        fontFamily:"é¶ä¹¦",
 *        fontSize:"8em",
 *        fontWeight:"bold",
 *        fontStyle:"italic",
 *        labelSelect:"true",
 *     }
 *           pointFeature.style = styleTest;
 *          vectorLayer.addFeatures([pointFeature]);
 * }
     */



;// CONCATENATED MODULE: ./src/common/commontypes/index.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





























;// CONCATENATED MODULE: ./src/common/format/Format.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class Format
 * @deprecatedclass SuperMap.Format
 * @classdesc è¯»ååç§æ ¼å¼çæ ¼å¼ç±»åºç±»ãå¶å­ç±»åºè¯¥åå«å¹¶å®ç° read å write æ¹æ³ã
 * @category BaseTypes Format
 * @param {Object} options - å¯éåæ°ã
 * @param {boolean} [options.keepData=false] - å¦æè®¾ç½®ä¸º trueï¼ data å±æ§ä¼æåè¢«è§£æçå¯¹è±¡ï¼ä¾å¦ JSON æ xml æ°æ®å¯¹è±¡ï¼ã
 * @param {Object} [options.data] - å½ keepData å±æ§è®¾ç½®ä¸º trueï¼è¿æ¯ä¼ éç» read æä½çè¦è¢«è§£æçå­ç¬¦ä¸²ã
 * @usage
 */
class Format {


    constructor(options) {
        /**
         * @member {Object} Format.prototype.data
         * @description å½ keepData å±æ§è®¾ç½®ä¸º trueï¼è¿æ¯ä¼ éç» read æä½çè¦è¢«è§£æçå­ç¬¦ä¸²ã
         */
        this.data = null;

        /**
         * @member {Object} [Format.prototype.keepData=false]
         * @description ä¿ææè¿è¯»å°çæ°æ®çå¼ç¨ï¼éè¿ data å±æ§ï¼ã
         */
        this.keepData = false;

        Util.extend(this, options);
        this.options = options;

        this.CLASS_NAME = "SuperMap.Format";
    }

    /**
     * @function Format.prototype.destroy
     * @description éæ¯è¯¥æ ¼å¼ç±»ï¼éæ¾ç¸å³èµæºã
     */
    destroy() {
        //ç¨æ¥éæ¯è¯¥æ ¼å¼ç±»ï¼éæ¾ç¸å³èµæº
    }

    /**
     * @function Format.prototype.read
     * @description æ¥ä»å­ç¬¦ä¸²ä¸­è¯»åæ°æ®ã
     * @param {string} data - è¯»åçæ°æ®ã
     */
    read(data) { // eslint-disable-line no-unused-vars
        //ç¨æ¥ä»å­ç¬¦ä¸²ä¸­è¯»åæ°æ®
    }

    /**
     * @function Format.prototype.write
     * @description å°å¯¹è±¡åæå­ç¬¦ä¸²ã
     * @param {Object} object - å¯åºååçå¯¹è±¡ã
     * @returns {string} å¯¹è±¡è½¬ååçå­ç¬¦ä¸²ã
     */
    write(object) { // eslint-disable-line no-unused-vars
        //ç¨æ¥åå­ç¬¦ä¸²
    }
}

;// CONCATENATED MODULE: ./src/common/format/JSON.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class JSONFormat
 * @aliasclass Format.JSON
 * @deprecatedclass SuperMap.Format.JSON
 * @classdesc å®å¨çè¯»å JSON çè§£æç±»ãä½¿ç¨ {@link JSONFormat} æé å½æ°åå»ºæ°å®ä¾ã
 * @category BaseTypes Format
 * @param {Object} [options] - å¯éåæ°ã
 * @param {string} [options.indent="    "] - ç¨äºæ ¼å¼åè¾åºï¼indent å­ç¬¦ä¸²ä¼å¨æ¯æ¬¡ç¼©è¿çæ¶åä½¿ç¨ä¸æ¬¡ã
 * @param {string} [options.space=" "] - ç¨äºæ ¼å¼åè¾åºï¼space å­ç¬¦ä¸²ä¼å¨åå¼å¯¹ç ":" åè¾¹æ·»å ã
 * @param {string} [options.newline="\n"] - ç¨äºæ ¼å¼åè¾åº, newline å­ç¬¦ä¸²ä¼ç¨å¨æ¯ä¸ä¸ªåå¼å¯¹ææ°ç»é¡¹æ«å°¾ã
 * @param {number} [options.level=0] - ç¨äºæ ¼å¼åè¾åº, è¡¨ç¤ºçæ¯ç¼©è¿çº§å«ã
 * @param {boolean} [options.pretty=false] - æ¯å¦å¨åºååçæ¶åä½¿ç¨é¢å¤çç©ºæ ¼æ§å¶ç»æãå¨ write æ¹æ³ä¸­ä½¿ç¨ã
 * @param {boolean} [options.nativeJSON] - éè¦è¢«æ³¨åççå¬å¨å¯¹è±¡ã
 * @extends {Format}
 * @usage
 */
class JSONFormat extends Format {

    constructor(options) {
        super(options);
        /**
         * @member {string} [JSONFormat.prototype.indent="    "]
         * @description ç¨äºæ ¼å¼åè¾åºï¼indent å­ç¬¦ä¸²ä¼å¨æ¯æ¬¡ç¼©è¿çæ¶åä½¿ç¨ä¸æ¬¡ã
         */
        this.indent = "    ";

        /**
         * @member {string} [JSONFormat.prototype.space=" "]
         * @description ç¨äºæ ¼å¼åè¾åºï¼space å­ç¬¦ä¸²ä¼å¨åå¼å¯¹ç ":" åè¾¹æ·»å ã
         */
        this.space = " ";

        /**
         * @member {string} [JSONFormat.prototype.newline="\n"]
         * @description ç¨äºæ ¼å¼åè¾åº, newline å­ç¬¦ä¸²ä¼ç¨å¨æ¯ä¸ä¸ªåå¼å¯¹ææ°ç»é¡¹æ«å°¾ã
         */
        this.newline = "\n";

        /**
         * @member {number} [JSONFormat.prototype.level=0]
         * @description ç¨äºæ ¼å¼åè¾åº, è¡¨ç¤ºçæ¯ç¼©è¿çº§å«ã
         */
        this.level = 0;

        /**
         * @member {boolean} [JSONFormat.prototype.pretty=false]
         * @description æ¯å¦å¨åºååçæ¶åä½¿ç¨é¢å¤çç©ºæ ¼æ§å¶ç»æãå¨ write æ¹æ³ä¸­ä½¿ç¨ã
         */
        this.pretty = false;

        /**
         * @member {boolean} JSONFormat.prototype.nativeJSON
         * @description å¤æ­æµè§å¨æ¯å¦åçæ¯æ JSON æ ¼å¼æ°æ®ã
         */
        this.nativeJSON = (function () {
            return !!(window.JSON && typeof JSON.parse === "function" && typeof JSON.stringify === "function");
        })();

        this.CLASS_NAME = "SuperMap.Format.JSON";
        /**
         * @member JSONFormat.prototype.serialize
         * @description æä¾ä¸äºç±»åå¯¹è±¡è½¬ JSON å­ç¬¦ä¸²çæ¹æ³ã
         */
        this.serialize = {
            /**
             * @function JSONFormat.serialize.object
             * @description æå¯¹è±¡è½¬æ¢ä¸º JSON å­ç¬¦ä¸²ã
             * @param {Object} object - å¯åºååçå¯¹è±¡ã
             * @returns {string} JSON å­ç¬¦ä¸²ã
             */
            'object': function (object) {
                // three special objects that we want to treat differently
                if (object == null) {
                    return "null";
                }
                if (object.constructor === Date) {
                    return this.serialize.date.apply(this, [object]);
                }
                if (object.constructor === Array) {
                    return this.serialize.array.apply(this, [object]);
                }
                var pieces = ['{'];
                this.level += 1;
                var key, keyJSON, valueJSON;

                var addComma = false;
                for (key in object) {
                    if (object.hasOwnProperty(key)) {
                        // recursive calls need to allow for sub-classing
                        keyJSON = this.write.apply(this,
                            [key, this.pretty]);
                        valueJSON = this.write.apply(this,
                            [object[key], this.pretty]);
                        if (keyJSON != null && valueJSON != null) {
                            if (addComma) {
                                pieces.push(',');
                            }
                            pieces.push(this.writeNewline(), this.writeIndent(),
                                keyJSON, ':', this.writeSpace(), valueJSON);
                            addComma = true;
                        }
                    }
                }

                this.level -= 1;
                pieces.push(this.writeNewline(), this.writeIndent(), '}');
                return pieces.join('');
            },

            /**
             * @function JSONFormat.serialize.array
             * @description ææ°ç»è½¬æ¢æ JSON å­ç¬¦ä¸²ã
             * @param {Array} array - å¯åºååçæ°ç»ã
             * @returns {string} JSON å­ç¬¦ä¸²ã
             */
            'array': function (array) {
                var json;
                var pieces = ['['];
                this.level += 1;

                for (var i = 0, len = array.length; i < len; ++i) {
                    // recursive calls need to allow for sub-classing
                    json = this.write.apply(this,
                        [array[i], this.pretty]);
                    if (json != null) {
                        if (i > 0) {
                            pieces.push(',');
                        }
                        pieces.push(this.writeNewline(), this.writeIndent(), json);
                    }
                }

                this.level -= 1;
                pieces.push(this.writeNewline(), this.writeIndent(), ']');
                return pieces.join('');
            },

            /**
             * @function JSONFormat.serialize.string
             * @description æå­ç¬¦ä¸²è½¬æ¢æ JSON å­ç¬¦ä¸²ã
             * @param {string} string - å¯åºååçå­ç¬¦ä¸²ã
             * @returns {string} JSON å­ç¬¦ä¸²ã
             */
            'string': function (string) {
                // If the string contains no control characters, no quote characters, and no
                // backslash characters, then we can simply slap some quotes around it.
                // Otherwise we must also replace the offending characters with safe
                // sequences.
                var m = {
                    '\b': '\\b',
                    '\t': '\\t',
                    '\n': '\\n',
                    '\f': '\\f',
                    '\r': '\\r',
                    '"': '\\"',
                    '\\': '\\\\'
                };
                /*eslint-disable no-control-regex*/
                if (/["\\\x00-\x1f]/.test(string)) {
                    return '"' + string.replace(/([\x00-\x1f\\"])/g, function (a, b) {
                        var c = m[b];
                        if (c) {
                            return c;
                        }
                        c = b.charCodeAt();
                        return '\\u00' +
                            Math.floor(c / 16).toString(16) +
                            (c % 16).toString(16);
                    }) + '"';
                }
                return '"' + string + '"';
            },

            /**
             * @function JSONFormat.serialize.number
             * @description ææ°å­è½¬æ¢æ JSON å­ç¬¦ä¸²ã
             * @param {number} number - å¯åºååçæ°å­ã
             * @returns {string} JSON å­ç¬¦ä¸²ã
             */
            'number': function (number) {
                return isFinite(number) ? String(number) : "null";
            },

            /**
             * @function JSONFormat.serialize.boolean
             * @description Transform a boolean into a JSON string.
             * @param {boolean} bool - The boolean to be serialized.
             * @returns {string} A JSON string representing the boolean.
             */
            'boolean': function (bool) {
                return String(bool);
            },

            /**
             * @function JSONFormat.serialize.object
             * @description å°æ¥æå¯¹è±¡è½¬æ¢æ JSON å­ç¬¦ä¸²ã
             * @param {Date} date - å¯åºååçæ¥æå¯¹è±¡ã
             * @returns {string} JSON å­ç¬¦ä¸²ã
             */
            'date': function (date) {
                function format(number) {
                    // Format integers to have at least two digits.
                    return (number < 10) ? '0' + number : number;
                }

                return '"' + date.getFullYear() + '-' +
                    format(date.getMonth() + 1) + '-' +
                    format(date.getDate()) + 'T' +
                    format(date.getHours()) + ':' +
                    format(date.getMinutes()) + ':' +
                    format(date.getSeconds()) + '"';
            }
        };
    }

    /**
     * @function JSONFormat.prototype.read
     * @description å°ä¸ä¸ªç¬¦å JSON ç»æçå­ç¬¦ä¸²è¿è¡è§£æã
     * @param {string} json - ç¬¦å JSON ç»æçå­ç¬¦ä¸²ã
     * @param {function} filter - è¿æ»¤æ¹æ³ï¼æç»ç»æçæ¯ä¸ä¸ªé®å¼å¯¹é½ä¼è°ç¨è¯¥è¿æ»¤æ¹æ³ï¼å¹¶å¨å¯¹åºçå¼çä½ç½®æ¿æ¢æè¯¥æ¹æ³è¿åçå¼ã
     * @returns {(Object|string|Array|number|boolean)} å¯¹è±¡ï¼æ°ç»ï¼å­ç¬¦ä¸²ææ°å­ã
     */
    read(json, filter) {
        var object;
        if (this.nativeJSON) {
            try {
                object = JSON.parse(json, filter);
            } catch (e) {
                // Fall through if the regexp test fails.
                return { data: json}
            }
        }

        if (this.keepData) {
            this.data = object;
        }

        return object;
    }

    /**
     * @function JSONFormat.prototype.write
     * @description åºååä¸ä¸ªå¯¹è±¡å°ä¸ä¸ªç¬¦å JSON æ ¼å¼çå­ç¬¦ä¸²ã
     * @param {Object|string|Array|number|boolean} value - éè¦è¢«åºååçå¯¹è±¡ï¼æ°ç»ï¼å­ç¬¦ä¸²ï¼æ°å­ï¼å¸å°å¼ã
     * @param {boolean} [pretty=false] - æ¯å¦å¨åºååçæ¶åä½¿ç¨é¢å¤çç©ºæ ¼æ§å¶ç»æãå¨ write æ¹æ³ä¸­ä½¿ç¨ã
     * @returns {string} ç¬¦å JSON æ ¼å¼çå­ç¬¦ä¸²ã
     *
     */
    write(value, pretty) {
        this.pretty = !!pretty;
        var json = null;
        var type = typeof value;
        if (this.serialize[type]) {
            try {
                json = (!this.pretty && this.nativeJSON) ?
                    JSON.stringify(value) :
                    this.serialize[type].apply(this, [value]);
            } catch (err) {
                //console.error("Trouble serializing: " + err);
            }
        }
        return json;
    }

    /**
     * @function JSONFormat.prototype.writeIndent
     * @description æ ¹æ®ç¼©è¿çº§å«è¾åºä¸ä¸ªç¼©è¿å­ç¬¦ä¸²ã
     * @private
     * @returns {string} ä¸ä¸ªéå½çç¼©è¿å­ç¬¦ä¸²ã
     */
    writeIndent() {
        var pieces = [];
        if (this.pretty) {
            for (var i = 0; i < this.level; ++i) {
                pieces.push(this.indent);
            }
        }
        return pieces.join('');
    }

    /**
     * @function JSONFormat.prototype.writeNewline
     * @description å¨æ ¼å¼åè¾åºæ¨¡å¼æåµä¸è¾åºä»£è¡¨æ°ä¸è¡çå­ç¬¦ä¸²ã
     * @private
     * @returns {string} ä»£è¡¨æ°çä¸è¡çå­ç¬¦ä¸²ã
     */
    writeNewline() {
        return (this.pretty) ? this.newline : '';
    }

    /**
     * @function JSONFormat.prototype.writeSpace
     * @private
     * @description å¨æ ¼å¼åè¾åºæ¨¡å¼æåµä¸è¾åºä¸ä¸ªä»£è¡¨ç©ºæ ¼çå­ç¬¦ä¸²ã
     * @returns {string} ç©ºæ ¼å­ç¬¦ä¸²ã
     */
    writeSpace() {
        return (this.pretty) ? this.space : '';
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/ServerColor.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/

/**
 * @class ServerColor
 * @deprecatedclass SuperMap.ServerColor
 * @category iServer Map Theme
 * @classdesc é¢è²ç±»ãè¯¥ç±»ä½¿ç¨ä¸åè²ï¼ RGB ï¼æ¥è¡¨è¾¾é¢è²ã
 * @param {Object} options - å¯éåæ°ã
 * @param {number} [options.red=255] - è·åæè®¾ç½®çº¢è²å¼ã
 * @param {number} [options.green=0] - è·åæè®¾ç½®ç»¿è²å¼ã
 * @param {number} [options.blue=0] - è·åæè®¾ç½®èè²å¼ã
 * @usage
 */
class ServerColor {

    constructor(red, green, blue) {

        /**
         * @member {number} [ServerColor.prototype.red=255]
         * @description è·åæè®¾ç½®çº¢è²å¼ã
         */
        this.red = (!red && red != 0)?255:red;

        /**
         * @member {number} [ServerColor.prototype.green=0]
         * @description è·åæè®¾ç½®ç»¿è²å¼ã
         */
        this.green = green||0;

        /**
         * @member {number} [ServerColor.prototype.blue=0]
         * @description è·åæè®¾ç½®èè²å¼ã
         */
        this.blue = blue||0;

        this.CLASS_NAME = "SuperMap.ServerColor";
    }

    /**
     * @function ServerColor.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.red = null;
        me.green = null;
        me.blue = null;
    }


    /**
     * @function ServerColor.formJson
     * @description å° JSON å¯¹è±¡è½¬åä¸º ServerColor å¯¹è±¡ã
     * @param {Object} jsonObject - è¦è½¬æ¢ç JSON å¯¹è±¡ã
     * @returns {ServerColor} è½¬ååç ServerColor å¯¹è±¡ã
     */
    static fromJson(jsonObject) {
        if (!jsonObject) {
            return;
        }
        var color = new ServerColor();
        var red = 255;
        if (jsonObject.red !== null) {
            red = Number(jsonObject.red);
        }
        color.red = red;

        var green = 0;
        if (jsonObject.green !== null) {
            green = Number(jsonObject.green);
        }
        color.green = green;

        var blue = 0;
        if (jsonObject.blue !== null) {
            blue = Number(jsonObject.blue);
        }
        color.blue = blue;
        return color;
    }

}



;// CONCATENATED MODULE: ./src/common/iServer/ServerStyle.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class ServerStyle
 * @deprecatedclass SuperMap.ServerStyle
 * @category  iServer Map Theme
 * @classdesc æå¡ç«¯ç¢éè¦ç´ é£æ ¼ç±»ãè¯¥ç±»ç¨äºå®ä¹ç¹ç¶ç¬¦å·ãçº¿ç¶ç¬¦å·ãå¡«åç¬¦å·é£æ ¼åå¶ç¸å³å±æ§ã
 * @param {Object} options - åæ°ã
 * @param {FillGradientMode} options.fillGradientMode - æ¸åå¡«åé£æ ¼çæ¸åç±»åã
 * @param {ServerColor} [options.fillBackColor=[255,255,255]] - å¡«åèæ¯é¢è²ã
 * @param {boolean} [options.fillBackOpaque=false] - èæ¯æ¯å¦ä¸éæã
 * @param {ServerColor} [options.fillForeColor=[255,0,0]] - å¡«åé¢è²ã
 * @param {number} [options.fillGradientAngle=0] - æ¸åå¡«åçæè½¬è§åº¦ã
 * @param {number} [options.fillGradientOffsetRatioX=0] - æ¸åå¡«åä¸­å¿ç¹ç¸å¯¹äºå¡«ååºåèå´ä¸­å¿ç¹çæ°´å¹³åç§»ç¾åæ¯ã
 * @param {number} [options.fillGradientOffsetRatioY=0] - å¡«åä¸­å¿ç¹ç¸å¯¹äºå¡«ååºåèå´ä¸­å¿ç¹çåç´åç§»ç¾åæ¯ã
 * @param {number} [options.fillOpaqueRate=100] - å¡«åä¸éæåº¦ã
 * @param {number} [options.fillSymbolID=0] - å¡«åç¬¦å·çç¼ç ã
 * @param {ServerColor} [options.lineColor] - ç¢éè¦ç´ çè¾¹çº¿é¢è²ãé»è®¤ lineColor = new ServerColor(0, 0, 0)ã
 * @param {number} [options.lineSymbolID=0] - çº¿ç¶ç¬¦å·çç¼ç ã
 * @param {number} [options.lineWidth=1] - è¾¹çº¿çå®½åº¦ã
 * @param {number} [options.markerAngle=0] - ç¹ç¶ç¬¦å·çæè½¬è§åº¦ã
 * @param {number} [options.markerSize=1] - ç¹ç¶ç¬¦å·çå¤§å°ã
 * @param {number} [options.markerSymbolID=-1] - ç¹ç¶ç¬¦å·çç¼ç ã
 * @usage
 */
class ServerStyle {

    constructor(options) {
        /**
         * @member {ServerColor} ServerStyle.prototype.fillBackColor
         * @description å¡«åèæ¯é¢è²ãå½å¡«åæ¨¡å¼ä¸ºæ¸åå¡«åæ¶ï¼è¯¥é¢è²ä¸ºå¡«åç»æ­¢è²ã
         */
        this.fillBackColor = new ServerColor(255, 255, 255);

        /**
         * @member {boolean} [ServerStyle.prototype.fillBackOpaque=false]
         * @description èæ¯æ¯å¦ä¸éæãfalse è¡¨ç¤ºéæã
         */
        this.fillBackOpaque = false;

        /**
         * @member {ServerColor} ServerStyle.prototype.fillForeColor
         * @description å¡«åé¢è²ãå½å¡«åæ¨¡å¼ä¸ºæ¸åå¡«åæ¶ï¼è¯¥é¢è²ä¸ºå¡«åèµ·å§é¢è²ã
         */
        this.fillForeColor = new ServerColor(255, 0, 0);

        /**
         * @member {FillGradientMode} ServerStyle.prototype.fillGradientMode
         * @description æ¸åå¡«åé£æ ¼çæ¸åç±»åã
         */
        this.fillGradientMode = null;

        /**
         * @member {number} ServerStyle.prototype.fillGradientAngle -
         * @description æ¸åå¡«åçæè½¬è§åº¦ãåä½ä¸ºåº¦ï¼ç²¾ç¡®å° 0.1 åº¦ï¼éæ¶éæ¹åä¸ºæ­£æ¹åã
         */
        this.fillGradientAngle = 0;

        /**
         * @member {number} ServerStyle.prototype.fillGradientOffsetRatioX
         * @description æ¸åå¡«åä¸­å¿ç¹ç¸å¯¹äºå¡«ååºåèå´ä¸­å¿ç¹çæ°´å¹³åç§»ç¾åæ¯ãå®ä»¬çå³ç³»å¦ä¸ï¼è®¾å¡«ååºåèå´ä¸­å¿ç¹çåæ ä¸ºï¼x0, y0ï¼ï¼
         *              å¡«åä¸­å¿ç¹çåæ ä¸ºï¼x, yï¼ï¼å¡«ååºåèå´çå®½åº¦ä¸º aï¼æ°´å¹³åç§»ç¾åæ¯ä¸º dxï¼å x=x0 + a*dx/100ã
         */
        this.fillGradientOffsetRatioX = 0;

        /**
         * @member {number} ServerStyle.prototype.fillGradientOffsetRatioY
         * @description å¡«åä¸­å¿ç¹ç¸å¯¹äºå¡«ååºåèå´ä¸­å¿ç¹çåç´åç§»ç¾åæ¯ãå®ä»¬çå³ç³»å¦ä¸ï¼<br>
         *              è®¾å¡«ååºåèå´ä¸­å¿ç¹çåæ ä¸ºï¼x0, y0ï¼ï¼å¡«åä¸­å¿ç¹çåæ ä¸ºï¼x, yï¼ï¼å¡«ååºåèå´çé«åº¦ä¸º bï¼åç´åç§»ç¾åæ¯ä¸º dyï¼å y=y0 + b*dx/100ã
         */
        this.fillGradientOffsetRatioY = 0;

        /**
         * @member {number} [ServerStyle.prototype.fillOpaqueRate=100]
         * @description å¡«åä¸éæåº¦ãåæ³å¼ä¸º 0 - 100 çæ°å¼ãå¶ä¸­ä¸º 0 è¡¨ç¤ºå®å¨éæï¼
         *              100 è¡¨ç¤ºå®å¨ä¸éæãèµå¼å°äº 0 æ¶æç§ 0 å¤çï¼å¤§äº 100 æ¶æç§ 100 å¤çã
         */
        this.fillOpaqueRate = 100;

        /**
         * @member {number} ServerStyle.prototype.fillSymbolID
         * @description å¡«åç¬¦å·çç¼ç ãæ­¤ç¼ç ç¨äºå¯ä¸æ è¯åæ®éå¡«åé£æ ¼çå¡«åç¬¦å·ã
         *              å³äºå¡«åç¬¦å·çæ ·å¼ä¸å¯¹åºç ID å·è¯·å¨ SuperMap æ¡é¢è½¯ä»¶ä¸­æ¥æ¾ã
         */
        this.fillSymbolID = 0;

        /**
         * @member {ServerColor} ServerStyle.prototype.lineColor
         * @description ç¢éè¦ç´ çè¾¹çº¿é¢è²ãå¦æç­çº§ç¬¦å·æ¯ç¹ç¬¦å·ï¼ç¹ç¬¦å·çé¢è²ç± lineColor æ§å¶ã
         */
        this.lineColor = new ServerColor(0, 0, 0);

        /**
         * @member {number} [ServerStyle.prototype.lineSymbolID=0]
         * @description çº¿ç¶ç¬¦å·çç¼ç ãæ­¤ç¼ç ç¨äºå¯ä¸æ è¯åæ®éå¡«åé£æ ¼çå¡«åç¬¦å·ã
         *              å³äºçº¿ç¶ç¬¦å·çæ ·å¼ä¸å¯¹åºç ID å·è¯·å¨ SuperMap æ¡é¢è½¯ä»¶ä¸­æ¥æ¾ã
         */
        this.lineSymbolID = 0;

        /**
         * @member {number} [ServerStyle.prototype.lineWidth=1.0]
         * @description è¾¹çº¿çå®½åº¦ãåä½ä¸ºæ¯«ç±³ï¼ç²¾åº¦å° 0.1ã
         */
        this.lineWidth = 1;

        /**
         * @member {number} [ServerStyle.prototype.markerAngle=0]
         * @description ç¹ç¶ç¬¦å·çæè½¬è§åº¦ãä»¥åº¦ä¸ºåä½ï¼ç²¾ç¡®å° 0.1 åº¦ï¼éæ¶éæ¹åä¸ºæ­£æ¹åã
         */
        this.markerAngle = 0;

        /**
         * @member {number} [ServerStyle.prototype.markerSize=1.0]
         * @description ç¹ç¶ç¬¦å·çå¤§å°ãåä½ä¸ºæ¯«ç±³ï¼ç²¾åº¦ä¸º 0.1ãå½è¯¥å±æ§è®¾ç½®ä¸º0æ¶ï¼éç¨ç¬¦å·é»è®¤å¤§å° 1.0 æ¾ç¤ºã
         *              å½è¯¥å±æ§è®¾ç½®ä¸ºéæ³å¼æ¶ï¼äº¤ç±æå¡å¨é»è®¤å¤çã
         */
        this.markerSize = 1;

        /**
         * @member {number} [ServerStyle.prototype.markerSymbolID=-1]
         * @description ç¹ç¶ç¬¦å·çç¼ç ãæ­¤ç¼ç ç¨äºå¯ä¸æ è¯åç¹ç¶ç¬¦å·ã
         *              å³äºçº¿ç¶ç¬¦å·çæ ·å¼ä¸å¯¹åºç ID å·è¯·å¨ SuperMap æ¡é¢è½¯ä»¶ä¸­æ¥æ¾ã
         */
        this.markerSymbolID = -1;
        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = "SuperMap.ServerStyle";
    }

    /**
     * @function ServerStyle.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        if (me.fillBackColor) {
            me.fillBackColor.destroy();
            me.fillBackColor = null;
        }
        me.fillBackOpaque = null;

        if (me.fillForeColor) {
            me.fillForeColor.destroy();
            me.fillForeColor = null;
        }
        me.fillGradientMode = null;
        me.fillGradientAngle = null;
        me.fillGradientOffsetRatioX = null;
        me.fillGradientOffsetRatioY = null;
        me.fillOpaqueRate = null;
        me.fillSymbolID = null;
        if (me.lineColor) {
            me.lineColor.destroy();
            me.lineColor = null;
        }
        me.lineSymbolID = null;
        me.lineWidth = null;
        me.markerAngle = null;
        me.markerSize = null;
        me.markerSymbolID = null;
    }

    /**
     * @function ServerStyle.prototype.toServerJSONObject
     * @description è½¬æ¢æå¯¹åºç JSON æ ¼å¼å¯¹è±¡ã
     * @returns {Object} å¯¹åºç JSON æ ¼å¼å¯¹è±¡.
     */
    toServerJSONObject() {
        var styleObj = {};
        styleObj = Util.copyAttributes(styleObj, this);
        //ææ¶åå¿½ç¥serverColorå¾Jsonçè½¬æ¢
        return styleObj;
    }

    /**
     * @function ServerStyle.fromJson
     * @description å°JSONå¯¹è±¡è½¬æ¢ä¸º ServerStyle å¯¹è±¡ã
     * @param {Object} jsonObject - è¦è½¬æ¢ç JSON å¯¹è±¡ã
     * @returns {ServerStyle} è½¬ååç ServerStyle å¯¹è±¡ã
     */
    static fromJson(jsonObject) {
        if (!jsonObject) {
            return;
        }
        return new ServerStyle({
            fillBackColor: ServerColor.fromJson(jsonObject.fillBackColor),
            fillBackOpaque: jsonObject.fillBackOpaque,
            fillForeColor: ServerColor.fromJson(jsonObject.fillForeColor),
            fillGradientMode: jsonObject.fillGradientMode,
            fillGradientAngle: jsonObject.fillGradientAngle,
            fillGradientOffsetRatioX: jsonObject.fillGradientOffsetRatioX,
            fillGradientOffsetRatioY: jsonObject.fillGradientOffsetRatioY,
            fillOpaqueRate: jsonObject.fillOpaqueRate,
            fillSymbolID: jsonObject.fillSymbolID,
            lineColor: ServerColor.fromJson(jsonObject.lineColor),
            lineSymbolID: jsonObject.lineSymbolID,
            lineWidth: jsonObject.lineWidth,
            markerAngle: jsonObject.markerAngle,
            markerSize: jsonObject.markerSize,
            markerSymbolID: jsonObject.markerSymbolID
        });
    }

}



;// CONCATENATED MODULE: ./src/common/iServer/PointWithMeasure.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class PointWithMeasure
 * @deprecatedclass SuperMap.PointWithMeasure
 * @category iServer SpatialAnalyst RouteLocator
 * @classdesc è·¯ç±ç¹ç±»ãè·¯ç±ç¹æ¯æå·æçº¿æ§åº¦éå¼ (Measure) çäºç»´å°çåæ ç¹ã
 * @param {Object} options - åæ°ã
 * @param {number} options.measure - åº¦éå¼ï¼å³è·¯ç±å¯¹è±¡å±æ§å¼ Mã
 * @param {number} options.x - å°çåæ ç³»ä¸ç X åæ å¼ã
 * @param {number} options.y - å°çåæ ç³»ä¸ç Y åæ å¼ã
 * @extends {GeometryPoint}
 * @usage
 */
class PointWithMeasure extends Point {

    constructor(options) {
        super(options);

        /**
         * @member {number} PointWithMeasure.prototype.measure
         * @description åº¦éå¼ï¼å³è·¯ç±å¯¹è±¡å±æ§å¼ Mã
         */
        this.measure = null;

        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = "SuperMap.PointWithMeasure";
    }

    /**
     * @function PointWithMeasure.prototype.equals
     * @description å¤æ­ä¸¤ä¸ªè·¯ç±ç¹å¯¹è±¡æ¯å¦ç¸ç­ãå¦æä¸¤ä¸ªè·¯ç±ç¹å¯¹è±¡å·æç¸åçåæ ä»¥ååº¦éå¼ï¼åè®¤ä¸ºæ¯ç¸ç­çã
     * @param {PointWithMeasure} geom - éè¦å¤æ­çè·¯ç±ç¹å¯¹è±¡ã
     * @returns {boolean} ä¸¤ä¸ªè·¯ç±ç¹å¯¹è±¡æ¯å¦ç¸ç­ï¼true ä¸ºç¸ç­ï¼false ä¸ºä¸ç­ï¼ã
     */
    equals(geom) {
        var equals = false;
        if (geom != null) {
            var isValueEquals = this.x === geom.x && this.y === geom.y && this.measure === geom.measure;
            var isNaNValue = isNaN(this.x) && isNaN(this.y) && isNaN(this.measure);
            var isNaNGeometry = isNaN(geom.x) && isNaN(geom.y) && isNaN(geom.measure);
            equals = ( isValueEquals || ( isNaNValue && isNaNGeometry ));
        }
        return equals;
    }


    /**
     * @function PointWithMeasure.prototype.toJson
     * @description è½¬æ¢ä¸º JSON å¯¹è±¡ã
     * */
     toJson() {
        var result = "{";
        if (this.measure != null && this.measure != undefined) {
            result += "\"measure\":" + this.measure + ",";
        }
        result += "\"x\":" + this.x + ",";
        result += "\"y\":" + this.y;
        result += "}";
        return result;
    }


     /**
     * @function PointWithMeasure.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.measure = null;
        me.x = null;
        me.y = null;
    }

    /**
     * @function PointWithMeasure.fromJson
     * @description å° JSON å¯¹è±¡è½¬æ¢ä¸º{@link PointWithMeasure} å¯¹è±¡ã
     * @param {Object} jsonObject - JSON å¯¹è±¡è¡¨ç¤ºçè·¯ç±ç¹ã
     * @returns {PointWithMeasure} è½¬ååç PointWithMeasure å¯¹è±¡ã
     */
    static fromJson(jsonObject) {
        if (!jsonObject) {
            return;
        }
        return new PointWithMeasure({
            x: jsonObject.x,
            y: jsonObject.y,
            measure: jsonObject.measure
        });
    }

}


;// CONCATENATED MODULE: ./src/common/iServer/Route.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/






/**
 * @class Route
 * @deprecatedclass SuperMap.Route
 * @category iServer SpatialAnalyst RouteCalculateMeasure
 * @classdesc è·¯ç±å¯¹è±¡ç±»ãè·¯ç±å¯¹è±¡ä¸ºä¸ç³»åæåºçå¸¦æå±æ§å¼ M ç xï¼y åæ å¯¹ï¼å¶ä¸­ M å¼ä¸ºè¯¥ç»ç¹çè·ç¦»å±æ§ï¼å°å·²ç¥ç¹çè·ç¦»ï¼ã
 * @param {Array.<Geometry>} points - å½¢æè·¯ç±å¯¹è±¡ççº¿æ°ç»ã
 * @param {Object} options - åæ°ã
 * @param {number} options.id - è·¯ç±å¯¹è±¡å¨æ°æ®åºä¸­ç idã
 * @param {number} options.length - è·¯ç±å¯¹è±¡çé¿åº¦ãåä½ä¸æ°æ®éçåä½ç¸åã
 * @param {number} [options.maxM] - æå¤§çº¿æ§åº¦éå¼ï¼å³ææç»ç¹å°èµ·å§ç¹çéç®è·ç¦»ä¸­æå¤§å¼ã
 * @param {number} [options.minM] - æå°çº¿æ§åº¦éå¼ï¼å³ææç»ç¹å°èµ·å§ç¹çéç®è·ç¦»ä¸­æå°å¼ã
 * @param {string} [options.type] - æ°æ®ç±»åï¼å¦ï¼"LINEM"ã
 * @extends GeometryCollection
 * @usage
 */
class Route extends Collection {

    constructor(points, options) {
        super(points, options);

        /**
         * @member {number} Route.prototype.id
         * @description è·¯ç±å¯¹è±¡å¨æ°æ®åºä¸­ç IDã
         */
        this.id = null;

        /**
         * @member {number} Route.prototype.center
         * @description è·¯ç±å¯¹è±¡çä¸­å¿ç¹ã
         */
        this.center = null;

        /**
         * @member {string} Route.prototype.style
         * @description è·¯ç±å¯¹è±¡çæ ·å¼ã
         */
        this.style = null;

        /**
         * @member {number} Route.prototype.length
         * @description è·¯ç±å¯¹è±¡çé¿åº¦ãåä½ä¸æ°æ®éçåä½ç¸åã
         */
        this.length = null;

        /**
         *  @member {number} Route.prototype.maxM
         *  @description æå¤§çº¿æ§åº¦éå¼ï¼å³ææç»ç¹å°èµ·å§ç¹çéç®è·ç¦»ä¸­æå¤§å¼ã
         */
        this.maxM = null;

        /**
         * @member {number} Route.prototype.minM
         * @description æå°çº¿æ§åº¦éå¼ï¼å³ææç»ç¹å°èµ·å§ç¹çéç®è·ç¦»ä¸­æå°å¼ã
         */
        this.minM = null;

        /**
         * @member {Array.<number>} Route.prototype.parts
         * @description æå¡ç«¯å ä½å¯¹è±¡ä¸­åä¸ªå­å¯¹è±¡æåå«çèç¹ä¸ªæ°ã
         */
        this.parts = null;

        /**
         * @member {Array.<Object>} Route.prototype.points
         * @description è·¯ç±å¯¹è±¡çææè·¯ç±ç¹ã
         * @example
         * (start code)
         * [
         *  {
         *      "measure": 0,
         *      "y": -4377.027184298267,
         *      "x": 4020.0045221720466
         *  },
         *  {
         *      "measure": 37.33288381391519,
         *      "y": -4381.569363260499,
         *      "x": 4057.0600591960642
         *  }
         * ]
         * (end)
         */
        this.points = null;

        /**
         * @member {string} Route.prototype.type
         * @description æå¡ç«¯å ä½å¯¹è±¡ç±»åã
         */
        this.type = null;

        /**
         * @member {Array.<string>} [Route.prototype.componentTypes=LineString]
         * @description components å­å¨ççå ä½å¯¹è±¡ææ¯æçå ä½ç±»åæ°ç»ã
         */
        this.componentTypes = ["SuperMap.Geometry.LinearRing", "SuperMap.Geometry.LineString"];

        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = "SuperMap.Route";
        this.geometryType = "LINEM";
    }

    /**
     *
     * @function Route.prototype.toJson
     * @description è½¬æ¢ä¸º JSON å¯¹è±¡ã
     * @returns {Object} JSON å¯¹è±¡ã
     */
    toJson() {
        var result = "{";
        if (this.id != null && this.id != undefined) {
            result += "\"id\":" + this.id + ",";
        }
        if (this.center != null && this.center != undefined) {
            result += "\"center\":" + this.center + ",";
        }
        if (this.style != null && this.style != undefined) {
            result += "\"style\":" + this.style + ",";
        }
        if (this.length != null && this.length != undefined) {
            result += "\"length\":" + this.length + ",";
        }
        if (this.maxM != null && this.maxM != undefined) {
            result += "\"maxM\":" + this.maxM + ",";
        }
        if (this.minM != null && this.minM != undefined) {
            result += "\"minM\":" + this.minM + ",";
        }
        if (this.type != null && this.type != undefined) {
            result += "\"type\":\"" + this.type + "\",";
        }
        if (this.parts != null && this.parts != undefined) {
            result += "\"parts\":[" + this.parts[0];

            for (var i = 1; i < this.parts.length; i++) {
                result += "," + this.parts[i];
            }
            result += "],";
        }
        if (this.components != null && this.components.length > 0) {
            result += "\"points\":[";
            for (var j = 0, len = this.components.length; j < len; j++) {
                for (var k = 0, len2 = this.components[j].components.length; k < len2; k++) {
                    result += this.components[j].components[k].toJson() + ",";
                }
            }
            result = result.replace(/,$/g, '');
            result += "]";
        }
        result = result.replace(/,$/g, '');
        result += "}";
        return result;
    }


    /**
     * @function Route.prototype.destroy
     * @override
     */
    destroy() {
        var me = this;
        me.id = null;
        me.center = null;
        me.style = null;
        me.length = null;
        me.maxM = null;
        me.minM = null;
        me.type = null;
        me.parts = null;
        me.components.length = 0;
        me.components = null;
        me.componentTypes = null;
    }


    /**
     * @function Route.fromJson
     * @description å° JSON å¯¹è±¡è½¬æ¢ä¸º Route å¯¹è±¡ã
     * @param {Object} [jsonObject] - JSON å¯¹è±¡è¡¨ç¤ºçè·¯ç±å¯¹è±¡ã
     * @returns {Route} è½¬ååç Route å¯¹è±¡ã
     */
    static fromJson(jsonObject) {
        if (!jsonObject) {
            return;
        }

        var geoParts = jsonObject.parts || [],
            geoPoints = jsonObject.points || [],
            len = geoParts.length,
            lineList = [];
        if (len > 0) {
            for (var i = 0, pointIndex = 0, pointList = []; i < len; i++) {
                for (var j = 0; j < geoParts[i]; j++) {
                    pointList.push(PointWithMeasure.fromJson(geoPoints[pointIndex + j]));
                }
                pointIndex += geoParts[i];
                //å¤æ­çº¿æ¯å¦é­åï¼å¦æé­åï¼åè¿åLinearRingï¼å¦åè¿åLineString
                if (pointList[0].equals(pointList[geoParts[i] - 1])) {
                    lineList.push(new LinearRing(pointList));
                } else {
                    lineList.push(new LineString(pointList));
                }
                pointList = [];
            }

        } else {
            return null;
        }

        return new Route(lineList, {
            id: jsonObject.id,
            center: jsonObject.center,
            style: jsonObject.style,
            length: jsonObject.length,
            maxM: jsonObject.maxM,
            minM: jsonObject.minM,
            type: jsonObject.type,
            parts: jsonObject.parts
        });
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/ServerGeometry.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/













/**
 * @class ServerGeometry
 * @deprecatedclass SuperMap.ServerGeometry
 * @category  iServer Data Feature
 * @classdesc æå¡ç«¯å ä½å¯¹è±¡ç±»ãè¯¥ç±»æè¿°å ä½å¯¹è±¡ï¼ç¢éï¼çç¹å¾æ°æ®ï¼åæ ç¹å¯¹ãå ä½å¯¹è±¡çç±»åç­ï¼ãåºäºæå¡ç«¯çç©ºé´åæãç©ºé´å³ç³»è¿ç®ãæ¥è¯¢ç­ GIS æå¡åè½ä½¿ç¨æå¡ç«¯å ä½å¯¹è±¡ã
 * @param {Object} options - åæ°ã
 * @param {string} options.id - æå¡ç«¯å ä½å¯¹è±¡å¯ä¸æ è¯ç¬¦ã
 * @param {Array.<number>} options.parts - æå¡ç«¯å ä½å¯¹è±¡ä¸­åä¸ªå­å¯¹è±¡æåå«çèç¹ä¸ªæ°ã
 * @param {Array.<GeometryPoint>} options.points - ç»æå ä½å¯¹è±¡çèç¹çåæ å¯¹æ°ç»ã
 * @param {GeometryType} options.type - å ä½å¯¹è±¡çç±»åã
 * @param {ServerStyle} [options.style] - æå¡ç«¯å ä½å¯¹è±¡çé£æ ¼ã
 * @usage
 */
class ServerGeometry {
    constructor(options) {
        /**
         * @member {string} ServerGeometry.prototype.id
         * @description æå¡ç«¯å ä½å¯¹è±¡å¯ä¸æ è¯ç¬¦ã
         */
        this.id = 0;

        /**
         * @member {ServerStyle} [ServerGeometry.prototype.style]
         * @description æå¡ç«¯å ä½å¯¹è±¡çé£æ ¼ï¼ServerStyleï¼ã
         */
        this.style = null;

        /**
         * @member {Array.<number>} ServerGeometry.prototype.parts
         * @description æå¡ç«¯å ä½å¯¹è±¡ä¸­åä¸ªå­å¯¹è±¡æåå«çèç¹ä¸ªæ°ã<br>
         * 1.å ä½å¯¹è±¡ä»ç»æä¸å¯ä»¥åä¸ºç®åå ä½å¯¹è±¡åå¤æå ä½å¯¹è±¡ã
         * ç®åå ä½å¯¹è±¡ä¸å¤æå ä½å¯¹è±¡çåºå«ï¼ç®åçå ä½å¯¹è±¡ä¸è¬ä¸ºåä¸å¯¹è±¡ï¼
         * èå¤æçå ä½å¯¹è±¡ç±å¤ä¸ªç®åå¯¹è±¡ç»ææç»è¿ä¸å®çç©ºé´è¿ç®ä¹åäº§çï¼
         * å¦ï¼ç©å½¢ä¸ºç®åçåºåå¯¹è±¡ï¼èä¸­ç©ºçç©å½¢ä¸ºå¤æçåºåå¯¹è±¡ã<br>
         * 2.éå¸¸æåµï¼ä¸ä¸ªç®åå ä½å¯¹è±¡çå­å¯¹è±¡å°±æ¯å®æ¬èº«ï¼
         * å æ­¤å¯¹äºç®åå¯¹è±¡æ¥è¯´çè¯¥å­æ®µä¸ºé¿åº¦ä¸º1çæ´åæ°ç»ï¼
         * è¯¥å­æ®µçå¼å°±æ¯è¿ä¸ªç®åå¯¹è±¡èç¹çä¸ªæ°ã
         * å¦æä¸ä¸ªå ä½å¯¹è±¡æ¯ç±å ä¸ªç®åå¯¹è±¡ç»åèæçï¼
         * ä¾å¦ï¼ä¸ä¸ªå²ç¶å ä½å¯¹è±¡ç± 3 ä¸ªç®åçå¤è¾¹å½¢ç»æèæï¼
         * é£ä¹è¿ä¸ªå²ç¶çå ä½å¯¹è±¡ç Parts å­æ®µå¼å°±æ¯ä¸ä¸ªé¿åº¦ä¸º 3 çæ´åæ°ç»ï¼
         * æ°ç»ä¸­æ¯ä¸ªæåçå¼åå«ä»£è¡¨è¿ä¸ä¸ªå¤è¾¹å½¢æåå«çèç¹ä¸ªæ°ã
         */
        this.parts = null;

        /**
         * @member {Array.<GeometryPoint>} ServerGeometry.prototype.points
         * @description ç»æå ä½å¯¹è±¡çèç¹çåæ å¯¹æ°ç»ã<br>
         * 1.ææå ä½å¯¹è±¡ï¼ç¹ãçº¿ãé¢ï¼é½æ¯ç±ä¸äºç®åçç¹åæ ç»æçï¼
         * è¯¥å­æ®µå­æ¾äºç»æå ä½å¯¹è±¡çç¹åæ çæ°ç»ã
         * å¯¹äºç®åçé¢å¯¹è±¡ï¼ä»çèµ·ç¹åç»ç¹çåæ ç¹ç¸åã<br>
         * 2.å¯¹äºå¤æçå ä½å¯¹è±¡ï¼æ ¹æ® Parts å±æ§æ¥ç¡®å®æ¯ä¸ä¸ªç»æå¤æå ä½å¯¹è±¡çç®åå¯¹è±¡æå¯¹åºçèç¹çä¸ªæ°ï¼
         * ä»èç¡®å® Points å­æ®µä¸­åæ å¯¹çåéå½å±é®é¢ã
         */
        this.points = null;

        /**
         * @member {GeometryType} ServerGeometry.prototype.type
         * @description å ä½å¯¹è±¡çç±»åï¼GeometryTypeï¼ã
         */
        this.type = null;

        /**
         * @member {Object} ServerGeometry.prototype.prjCoordSys
         * @description æå½±åæ åæ°ï¼ç°ä»å¨ç¼å²åºåæä¸­ææã
         */
        this.prjCoordSys = null;
        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = 'SuperMap.ServerGeometry';
    }

    /**
     * @function ServerGeometry.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.id = null;
        me.style = null;
        me.parts = null;
        me.partTopo = null;
        me.points = null;
        me.type = null;
        me.prjCoordSys = null;
    }

    /**
     * @function ServerGeometry.prototype.toGeometry
     * @description å°æå¡ç«¯å ä½å¯¹è±¡ ServerGeometry è½¬æ¢ä¸ºå®¢æ·ç«¯å ä½å¯¹è±¡ Geometryã
     * @returns {Geometry} è½¬æ¢åçå®¢æ·ç«¯å ä½å¯¹è±¡ã
     */
    toGeometry() {
        var me = this,
            geoType = me.type;
        switch (geoType.toUpperCase()) {
            case GeometryType.POINT:
                return me.toGeoPoint();
            case GeometryType.LINE:
                return me.toGeoLine();
            case GeometryType.LINEM:
                return me.toGeoLinem();
            case GeometryType.REGION:
                return me.toGeoRegion();
            case GeometryType.POINTEPS:
                return me.toGeoPoint();
            case GeometryType.LINEEPS:
                return me.toGeoLineEPS();
            case GeometryType.REGIONEPS:
                return me.toGeoRegionEPS();
            case GeometryType.GEOCOMPOUND:
                return me.transformGeoCompound();
        }
    }

    /**
     * @function ServerGeometry.prototype.toGeoPoint
     * @description å°æå¡ç«¯çç¹å ä½å¯¹è±¡è½¬æ¢ä¸ºå®¢æ·ç«¯å ä½å¯¹è±¡ãåæ¬ PointãMultiPointã
     * @returns {Geometry} è½¬æ¢åçå®¢æ·ç«¯å ä½å¯¹è±¡ã
     */
    toGeoPoint() {
        var me = this,
            geoParts = me.parts || [],
            geoPoints = me.points || [],
            len = geoParts.length;
        if (len > 0) {
            if (len === 1) {
                return new Point(geoPoints[0].x, geoPoints[0].y);
            } else {
                var pointList = [];
                for (let i = 0; i < len; i++) {
                    pointList.push(new Point(geoPoints[i].x, geoPoints[i].y));
                }
                return new MultiPoint(pointList);
            }
        } else {
            return null;
        }
    }

    /**
     * @function ServerGeometry.prototype.toGeoLine
     * @description å°æå¡ç«¯ççº¿å ä½å¯¹è±¡è½¬æ¢ä¸ºå®¢æ·ç«¯å ä½å¯¹è±¡ãåæ¬ GeometryLinearRingãGeometryLineStringãGeometryMultiLineStringã
     * @returns {Geometry} è½¬æ¢åçå®¢æ·ç«¯å ä½å¯¹è±¡ã
     */
    toGeoLine() {
        var me = this,
            geoParts = me.parts || [],
            geoPoints = me.points || [],
            len = geoParts.length;
        if (len > 0) {
            if (len === 1) {
                let pointList = [];
                for (let i = 0; i < geoParts[0]; i++) {
                    pointList.push(new Point(geoPoints[i].x, geoPoints[i].y));
                }
                //å¤æ­çº¿æ¯å¦é­åï¼å¦æé­åï¼åè¿åLinearRingï¼å¦åè¿åLineString
                if (pointList[0].equals(pointList[geoParts[0] - 1])) {
                    return new LinearRing(pointList);
                } else {
                    return new LineString(pointList);
                }
            } else {
                let lineList = [];
                for (let i = 0; i < len; i++) {
                    let pointList = [];
                    for (let j = 0; j < geoParts[i]; j++) {
                        pointList.push(new Point(geoPoints[j].x, geoPoints[j].y));
                    }
                    lineList.push(new LineString(pointList));
                    geoPoints.splice(0, geoParts[i]);
                }
                return new MultiLineString(lineList);
            }
        } else {
            return null;
        }
    }

    /**
     * @function ServerGeometry.prototype.toGeoLineEPS
     * @description å°æå¡ç«¯ççº¿å ä½å¯¹è±¡è½¬æ¢ä¸ºå®¢æ·ç«¯å ä½å¯¹è±¡ãåæ¬ GeometryLinearRingãGeometryLineStringãGeometryMultiLineStringã
     * @returns {Geometry} è½¬æ¢åçå®¢æ·ç«¯å ä½å¯¹è±¡ã
     */
    toGeoLineEPS() {
        var me = this,
            geoParts = me.parts || [],
            geoPoints = me.points || [],
            i,
            j,
            pointList,
            lineList,
            lineEPS,
            len = geoParts.length;
        if (len > 0) {
            if (len === 1) {
                for (i = 0, pointList = []; i < geoParts[0]; i++) {
                    pointList.push(new Point(geoPoints[i].x, geoPoints[i].y, geoPoints[i].type));
                }
                //å¤æ­çº¿æ¯å¦é­åï¼å¦æé­åï¼åè¿åLinearRingï¼å¦åè¿åLineString
                if (pointList[0].equals(pointList[geoParts[0] - 1])) {
                    lineEPS = LineString.createLineEPS(pointList);
                    return new LinearRing(lineEPS);
                } else {
                    lineEPS = LineString.createLineEPS(pointList);
                    return new LineString(lineEPS);
                }
            } else {
                for (i = 0, lineList = []; i < len; i++) {
                    for (j = 0, pointList = []; j < geoParts[i]; j++) {
                        pointList.push(new Point(geoPoints[j].x, geoPoints[j].y));
                    }
                    lineEPS = LineString.createLineEPS(pointList);
                    lineList.push(new LineString(lineEPS));
                    geoPoints.splice(0, geoParts[i]);
                }
                return new MultiLineString(lineList);
            }
        } else {
            return null;
        }
    }

    /**
     * @function ServerGeometry.prototype.toGeoLinem
     * @description å°æå¡ç«¯çè·¯ç±çº¿å ä½å¯¹è±¡è½¬æ¢ä¸ºå®¢æ·ç«¯å ä½å¯¹è±¡ãåæ¬ LinearRingãLineStringãMultiLineStringã
     * @returns {Geometry} è½¬æ¢åçå®¢æ·ç«¯å ä½å¯¹è±¡ã
     */
    toGeoLinem() {
        var me = this;
        return Route.fromJson(me);
    }

    /**
     * @function ServerGeometry.prototype.toGeoRegion
     * @description å°æå¡ç«¯çé¢å ä½å¯¹è±¡è½¬æ¢ä¸ºå®¢æ·ç«¯å ä½å¯¹è±¡ãç±»åä¸º GeometryPolygonã
     * @returns {Geometry} è½¬æ¢åçå®¢æ·ç«¯å ä½å¯¹è±¡ã
     */
    toGeoRegion() {
        var me = this,
            geoParts = me.parts || [],
            geoTopo = me.partTopo || [],
            geoPoints = me.points || [],
            len = geoParts.length;
        if (len <= 0) {
            return null;
        }
        var polygonArray = [];
        var pointList = [];
        if (len == 1) {
            for (let i = 0; i < geoPoints.length; i++) {
                pointList.push(new Point(geoPoints[i].x, geoPoints[i].y));
            }
            polygonArray.push(new Polygon([new LinearRing(pointList)]));
            return new MultiPolygon(polygonArray);
        }
        //å¤çå¤æé¢
        var CCWArray = [];
        var areaArray = [];
        var polygonArrayTemp = [];
        var polygonBounds = [];
        //polyonå²æ´æ è¯æ°ç»ï¼åå§é½æ¯å²ã
        var CCWIdent = [];
        for (let i = 0, pointIndex = 0; i < len; i++) {
            for (let j = 0; j < geoParts[i]; j++) {
                pointList.push(new Point(geoPoints[pointIndex + j].x, geoPoints[pointIndex + j].y));
            }
            pointIndex += geoParts[i];
            var polygon = new Polygon([new LinearRing(pointList)]);
            pointList = [];
            polygonArrayTemp.push(polygon);
            if (geoTopo.length === 0) {
                polygonBounds.push(polygon.getBounds());
            }
            CCWIdent.push(1);
            areaArray.push(polygon.getArea());
        }
        //iServer 9Dæ°å¢å­æ®µ
        if (geoTopo.length === 0) {
            //æ ¹æ®é¢ç§¯æåº
            ServerGeometry.bubbleSort(areaArray, polygonArrayTemp, geoTopo, polygonBounds);
            //å²æ´åºå±å¤æ­ååï¼å°ææçå­å¯¹è±¡æç§é¢ç§¯æåºï¼é¢ç§¯æå¤§çç´æ¥å¤å®ä¸ºå²ï¼1ï¼ï¼ä»é¢ç§¯æ¬¡å¤§çå¼å§å¤çï¼
            // å¦æåç°è¯¥å¯¹è±¡å¨æä¸ªé¢ç§¯å¤§äºå®çå¯¹è±¡ä¹ä¸­ï¼å³è¢«åå«ï¼ï¼åæ ¹æ®åå«å®çå¯¹è±¡çæ è¯ï¼1 or -1ï¼ï¼æå®å¶æ è¯ï¼-1 or 1ï¼ï¼
            // ä¾æ¬¡å¤çå®ææå¯¹è±¡ï¼å°±å¾å°äºä¸ä¸ªæ è¯æ°ç»ï¼1è¡¨ç¤ºå²ï¼-1è¡¨ç¤ºæ´
            //ç®æ polygonç´¢å¼åè¡¨ -1æ ç¤ºæ²¡æè¢«ä»»ä½polygonåå«ï¼
            var targetArray = [];
            for (let i = 1; i < polygonArrayTemp.length; i++) {
                for (let j = i - 1; j >= 0; j--) {
                    targetArray[i] = -1;
                    if (polygonBounds[j].containsBounds(polygonBounds[i])) {
                        CCWIdent[i] = CCWIdent[j] * -1;
                        if (CCWIdent[i] < 0) {
                            targetArray[i] = j;
                        }
                        break;
                    }
                }
            }
            for (let i = 0; i < polygonArrayTemp.length; i++) {
                if (CCWIdent[i] > 0) {
                    polygonArray.push(polygonArrayTemp[i]);
                } else {
                    polygonArray[targetArray[i]].components = polygonArray[targetArray[i]].components.concat(
                        polygonArrayTemp[i].components
                    );
                    //å ä½
                    polygonArray.push('');
                }
            }
        } else {
            polygonArray = new Array();
            for (let i = 0; i < polygonArrayTemp.length; i++) {
                if (geoTopo[i] && geoTopo[i] == -1) {
                    CCWArray = CCWArray.concat(polygonArrayTemp[i].components);
                } else {
                    if (CCWArray.length > 0 && polygonArray.length > 0) {
                        polygonArray[polygonArray.length - 1].components =
                            polygonArray[polygonArray.length - 1].components.concat(CCWArray);
                        CCWArray = [];
                    }
                    polygonArray.push(polygonArrayTemp[i]);
                }
                if (i == len - 1) {
                    var polyLength = polygonArray.length;
                    if (polyLength) {
                        polygonArray[polyLength - 1].components =
                            polygonArray[polyLength - 1].components.concat(CCWArray);
                    } else {
                        for (let k = 0, length = CCWArray.length; k < length; k++) {
                            polygonArray.push(new Polygon(CCWArray));
                        }
                    }
                }
            }
        }
        return new MultiPolygon(polygonArray);
    }

    /**
     * @function ServerGeometry.prototype.toGeoRegionEPS
     * @description å°æå¡ç«¯çé¢å ä½å¯¹è±¡è½¬æ¢ä¸ºå®¢æ·ç«¯å ä½å¯¹è±¡ãç±»åä¸º Polygonã
     * @returns {Geometry} è½¬æ¢åçå®¢æ·ç«¯å ä½å¯¹è±¡ã
     */
    toGeoRegionEPS() {
        var me = this,
            geoParts = me.parts || [],
            geoTopo = me.partTopo || [],
            geoPoints = me.points || [],
            len = geoParts.length;

        if (len <= 0) {
            return null;
        }
        var polygonArray = [];
        var pointList = [];
        var lineEPS;
        if (len == 1) {
            for (var i = 0; i < geoPoints.length; i++) {
                pointList.push(new Point(geoPoints[i].x, geoPoints[i].y));
            }

            lineEPS = LineString.createLineEPS(pointList);
            polygonArray.push(new Polygon([new LinearRing(lineEPS)]));
            return new MultiPolygon(polygonArray);
        }
        //å¤çå¤æé¢
        var CCWArray = [];
        var areaArray = [];
        var polygonArrayTemp = [];
        var polygonBounds = [];
        //polyonå²æ´æ è¯æ°ç»ï¼åå§é½æ¯å²ã
        var CCWIdent = [];
        for (let i = 0, pointIndex = 0; i < len; i++) {
            for (let j = 0; j < geoParts[i]; j++) {
                pointList.push(new Point(geoPoints[pointIndex + j].x, geoPoints[pointIndex + j].y));
            }
            pointIndex += geoParts[i];

            lineEPS = LineString.createLineEPS(pointList);
            var polygon = new Polygon([new LinearRing(lineEPS)]);
            pointList = [];
            polygonArrayTemp.push(polygon);
            if (geoTopo.length === 0) {
                polygonBounds.push(polygon.getBounds());
            }
            CCWIdent.push(1);
            areaArray.push(polygon.getArea());
        }
        //iServer 9Dæ°å¢å­æ®µ
        if (geoTopo.length === 0) {
            //æ ¹æ®é¢ç§¯æåº
            ServerGeometry.bubbleSort(areaArray, polygonArrayTemp, geoTopo, polygonBounds);
            //å²æ´åºå±å¤æ­ååï¼å°ææçå­å¯¹è±¡æç§é¢ç§¯æåºï¼é¢ç§¯æå¤§çç´æ¥å¤å®ä¸ºå²ï¼1ï¼ï¼ä»é¢ç§¯æ¬¡å¤§çå¼å§å¤çï¼
            // å¦æåç°è¯¥å¯¹è±¡å¨æä¸ªé¢ç§¯å¤§äºå®çå¯¹è±¡ä¹ä¸­ï¼å³è¢«åå«ï¼ï¼åæ ¹æ®åå«å®çå¯¹è±¡çæ è¯ï¼1 or -1ï¼ï¼æå®å¶æ è¯ï¼-1 or 1ï¼ï¼
            // ä¾æ¬¡å¤çå®ææå¯¹è±¡ï¼å°±å¾å°äºä¸ä¸ªæ è¯æ°ç»ï¼1è¡¨ç¤ºå²ï¼-1è¡¨ç¤ºæ´
            //ç®æ polygonç´¢å¼åè¡¨ -1æ ç¤ºæ²¡æè¢«ä»»ä½polygonåå«ï¼
            var targetArray = [];
            for (let i = 1; i < polygonArrayTemp.length; i++) {
                for (let j = i - 1; j >= 0; j--) {
                    targetArray[i] = -1;
                    if (polygonBounds[j].containsBounds(polygonBounds[i])) {
                        CCWIdent[i] = CCWIdent[j] * -1;
                        if (CCWIdent[i] < 0) {
                            targetArray[i] = j;
                        }
                        break;
                    }
                }
            }
            for (let i = 0; i < polygonArrayTemp.length; i++) {
                if (CCWIdent[i] > 0) {
                    polygonArray.push(polygonArrayTemp[i]);
                } else {
                    polygonArray[targetArray[i]].components = polygonArray[targetArray[i]].components.concat(
                        polygonArrayTemp[i].components
                    );
                    //å ä½
                    polygonArray.push('');
                }
            }
        } else {
            polygonArray = new Array();
            for (let i = 0; i < polygonArrayTemp.length; i++) {
                if (geoTopo[i] && geoTopo[i] == -1) {
                    CCWArray = CCWArray.concat(polygonArrayTemp[i].components);
                } else {
                    if (CCWArray.length > 0 && polygonArray.length > 0) {
                        polygonArray[polygonArray.length - 1].components =
                            polygonArray[polygonArray.length - 1].components.concat(CCWArray);
                        CCWArray = [];
                    }
                    polygonArray.push(polygonArrayTemp[i]);
                }
                if (i == len - 1) {
                    var polyLength = polygonArray.length;
                    if (polyLength) {
                        polygonArray[polyLength - 1].components =
                            polygonArray[polyLength - 1].components.concat(CCWArray);
                    } else {
                        for (let k = 0, length = CCWArray.length; k < length; k++) {
                            polygonArray.push(new Polygon(CCWArray));
                        }
                    }
                }
            }
        }
        return new MultiPolygon(polygonArray);
    }
    transformGeoCompound() {
        const me = this,
            geoParts = me.geoParts || [],
            len = geoParts.length;
        if (len <= 0) {
            return null;
        }
        const geometryList = [];
        for (let index = 0; index < len; index++) {
            const geometry = geoParts[index];
            geometryList.push(new ServerGeometry(geometry).toGeometry());
        }
        return new Collection(geometryList);
    }

    /**
     * @function ServerGeometry.prototype.fromJson
     * @description å° JSON å¯¹è±¡è¡¨ç¤ºæå¡ç«¯å ä½å¯¹è±¡è½¬æ¢ä¸º ServerGeometryã
     * @param {Object} jsonObject - è¦è½¬æ¢ç JSON å¯¹è±¡ã
     * @returns {ServerGeometry} è½¬æ¢åç ServerGeometry å¯¹è±¡ã
     */
    static fromJson(jsonObject) {
        if (!jsonObject) {
            return;
        }
        return new ServerGeometry({
            id: jsonObject.id,
            style: ServerStyle.fromJson(jsonObject.style),
            parts: jsonObject.parts,
            partTopo: jsonObject.partTopo,
            points: jsonObject.points,
            center: jsonObject.center,
            length: jsonObject.length,
            maxM: jsonObject.maxM,
            minM: jsonObject.minM,
            type: jsonObject.type
        });
    }

    /**
     * @function ServerGeometry.prototype.fromGeometry
     * @description å°å®¢æ·ç«¯ Geometry è½¬æ¢ææå¡ç«¯ ServerGeometryã
     * @param {Geometry} geometry - è¦è½¬æ¢çå®¢æ·ç«¯ Geometry å¯¹è±¡ã
     * @returns {ServerGeometry} è½¬æ¢åç ServerGeometry å¯¹è±¡ã
     */
    static fromGeometry(geometry) {
        if (!geometry) {
            return;
        }
        var id = 0,
            parts = [],
            points = [],
            type = null,
            icomponents = geometry.components,
            className = geometry.CLASS_NAME,
            prjCoordSys = { epsgCode: geometry.SRID };

        if (!isNaN(geometry.id)) {
            id = geometry.id;
        }
        //åç¹çæ¹æ³ï¼æ²¡æ³ï¼ä¸ºäºæ¯ææå¿æ ç»ï¼ææ¶é´å°±å¾å¨æ¹
        if (
            className != 'SuperMap.Geometry.LinearRing' &&
            className != 'SuperMap.Geometry.LineString' &&
            (geometry instanceof MultiPoint || geometry instanceof MultiLineString)
        ) {
            let ilen = icomponents.length;
            for (let i = 0; i < ilen; i++) {
                const vertices = icomponents[i].getVertices();
                let partPointsCount = vertices.length;
                parts.push(partPointsCount);
                for (let j = 0; j < partPointsCount; j++) {
                    points.push(new Point(vertices[j].x, vertices[j].y));
                }
            }
            //è¿éclassNameä¸æ¯å¤ç¹å°±å¨é¨æ¯ç®çº¿
            type = className == 'SuperMap.Geometry.MultiPoint' ? GeometryType.POINT : GeometryType.LINE;
        } else if (geometry instanceof MultiPolygon) {
            let ilen = icomponents.length;
            for (let i = 0; i < ilen; i++) {
                let polygon = icomponents[i],
                    linearRingOfPolygon = polygon.components,
                    linearRingOfPolygonLen = linearRingOfPolygon.length;
                for (let j = 0; j < linearRingOfPolygonLen; j++) {
                    const vertices = linearRingOfPolygon[j].getVertices();
                    const partPointsCount = vertices.length + 1;
                    parts.push(partPointsCount);
                    for (let k = 0; k < partPointsCount - 1; k++) {
                        points.push(new Point(vertices[k].x, vertices[k].y));
                    }
                    points.push(
                        new Point(vertices[0].x, vertices[0].y)
                    );
                }
            }
            type = GeometryType.REGION;
        } else if (geometry instanceof Polygon) {
            let ilen = icomponents.length;
            for (let i = 0; i < ilen; i++) {
                const vertices = icomponents[i].getVertices();
                let partPointsCount = vertices.length + 1;
                parts.push(partPointsCount);
                for (let j = 0; j < partPointsCount - 1; j++) {
                  points.push(new Point(vertices[j].x, vertices[j].y));
                }
                points.push(new Point(vertices[0].x, vertices[0].y));
            }
            type = GeometryType.REGION;
        } else {
            const vertices = geometry.getVertices();
            let geometryVerticesCount = vertices.length;
            for (let j = 0; j < geometryVerticesCount; j++) {
                points.push(new Point(vertices[j].x, vertices[j].y));
            }
            if (geometry instanceof LinearRing) {
                points.push(new Point(vertices[0].x, vertices[0].y));
                geometryVerticesCount++;
            }
            parts.push(geometryVerticesCount);
            type = geometry instanceof Point ? GeometryType.POINT : GeometryType.LINE;
        }

        return new ServerGeometry({
            id: id,
            style: null,
            parts: parts,
            points: points,
            type: type,
            prjCoordSys: prjCoordSys
        });
    }

    /**
     * @function ServerGeometry.prototype.IsClockWise
     * @description å¤æ­ linearRing ä¸­çç¹çé¡ºåºãè¿åå¼å¤§äº 0ï¼éæ¶éï¼å°äº 0ï¼é¡ºæ¶éã
     * @param {Geometry} geometry - è¦è½¬æ¢çå®¢æ·ç«¯ Geometry å¯¹è±¡ã
     * @returns {number} è¿åå¼å¤§äº 0ï¼éæ¶éï¼å°äº 0ï¼é¡ºæ¶éã
     */
    static IsClockWise(points) {
        var length = points.length;
        if (length < 3) {
            return 0.0;
        }
        var s = points[0].y * (points[length - 1].x - points[1].x);
        points.push(points[0]);
        for (var i = 1; i < length; i++) {
            s += points[i].y * (points[i - 1].x - points[i + 1].x);
        }
        return s * 0.5;
    }

    static bubbleSort(areaArray, pointList, geoTopo, polygonBounds) {
        for (var i = 0; i < areaArray.length; i++) {
            for (var j = 0; j < areaArray.length; j++) {
                if (areaArray[i] > areaArray[j]) {
                    var d = areaArray[j];
                    areaArray[j] = areaArray[i];
                    areaArray[i] = d;
                    var b = pointList[j];
                    pointList[j] = pointList[i];
                    pointList[i] = b;
                    if (geoTopo && geoTopo.length > 0) {
                        var c = geoTopo[j];
                        geoTopo[j] = geoTopo[i];
                        geoTopo[i] = c;
                    }
                    if (polygonBounds && polygonBounds.length > 0) {
                        var f = polygonBounds[j];
                        polygonBounds[j] = polygonBounds[i];
                        polygonBounds[i] = f;
                    }
                }
            }
        }
    }
}


;// CONCATENATED MODULE: ./src/common/format/GeoJSON.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/














/**
 * @class GeoJSONFormat
 * @aliasclass Format.GeoJSON
 * @deprecatedclass SuperMap.Format.GeoJSON
 * @classdesc  GeoJSON çè¯»ååãä½¿ç¨ {@link GeoJSONObject} æé å¨åå»ºä¸ä¸ª GeoJSON è§£æå¨ã
 * @category BaseTypes Format
 * @param {Object} [options] - å¯éåæ°ã
 * @param {string} [options.indent="    "] - ç¨äºæ ¼å¼åè¾åºï¼indent å­ç¬¦ä¸²ä¼å¨æ¯æ¬¡ç¼©è¿çæ¶åä½¿ç¨ä¸æ¬¡ã
 * @param {string} [options.space=" "] - ç¨äºæ ¼å¼åè¾åºï¼space å­ç¬¦ä¸²ä¼å¨åå¼å¯¹ç ":" åè¾¹æ·»å ã
 * @param {string} [options.newline="\n"] - ç¨äºæ ¼å¼åè¾åº, newline å­ç¬¦ä¸²ä¼ç¨å¨æ¯ä¸ä¸ªåå¼å¯¹ææ°ç»é¡¹æ«å°¾ã
 * @param {number} [options.level=0] - ç¨äºæ ¼å¼åè¾åº, è¡¨ç¤ºçæ¯ç¼©è¿çº§å«ã
 * @param {boolean} [options.pretty=false] - æ¯å¦å¨åºååçæ¶åä½¿ç¨é¢å¤çç©ºæ ¼æ§å¶ç»æãå¨ write æ¹æ³ä¸­ä½¿ç¨ã
 * @param {boolean} [options.nativeJSON] - éè¦è¢«æ³¨åççå¬å¨å¯¹è±¡ã
 * @param {boolean} [options.ignoreExtraDims=true] - å¿½ç¥ç»´åº¦è¶è¿ 2 çå ä½è¦ç´ ã
 * @extends {JSONFormat}
 * @usage
 */
class GeoJSON extends JSONFormat {


    constructor(options) {
        super(options);
        /**
         * @member {boolean} [GeoJSONFormat.prototype.ignoreExtraDims=true]
         * @description å¿½ç¥ç»´åº¦è¶è¿ 2 çå ä½è¦ç´ ã
         */
        this.ignoreExtraDims = true;

        this.CLASS_NAME = "SuperMap.Format.GeoJSON";
        /**
         * @member {Object} GeoJSONFormat.prototype.parseCoords
         * @private
         * @description ä¸ä¸ªå±æ§åå¯¹åºç GeoJSON å¯¹è±¡çå ä½ç±»åçå¯¹è±¡ãæ¯ä¸ªå±æ§å¶å®é½æ¯ä¸ä¸ªå®éä¸åè§£æç¨çæ¹æ³ã
         */
        this.parseCoords = {
            /**
             * @function GeoJSONFormat.parseCoords.point
             * @description å°ä¸ç»åæ è½¬æä¸ä¸ª {@link Geometry} å¯¹è±¡ã
             * @param {Object} array - GeoJSON çæ®µä¸­çä¸ç»åæ ã
             * @returns {Geometry} ä¸ä¸ªå ä½å¯¹è±¡ã
             */
            "point": function (array) {
                if (this.ignoreExtraDims === false &&
                    array.length != 2) {
                    throw "Only 2D points are supported: " + array;
                }
                return new Point(array[0], array[1]);
            },

            /**
             * @function GeoJSONFormat.parseCoords.multipoint
             * @description å°åæ ç»æ°ç»è½¬åæä¸ºä¸ä¸ª {@link Geometry} å¯¹è±¡ã
             * @param {Object} array - GeoJSON çæ®µä¸­çåæ ç»æ°ç»ã
             * @returns {Geometry} ä¸ä¸ªå ä½å¯¹è±¡ã
             */
            "multipoint": function (array) {
                var points = [];
                var p = null;
                for (var i = 0, len = array.length; i < len; ++i) {
                    try {
                        p = this.parseCoords["point"].apply(this, [array[i]]);
                    } catch (err) {
                        throw err;
                    }
                    points.push(p);
                }
                return new MultiPoint(points);
            },

            /**
             * @function GeoJSONFormat.parseCoords.linestring
             * @description å°åæ ç»æ°ç»è½¬åæä¸ºä¸ä¸ª {@link Geometry} å¯¹è±¡ã
             * @param {Object} array - GeoJSON çæ®µä¸­çåæ ç»æ°ç»ã
             * @returns {Geometry} ä¸ä¸ªå ä½å¯¹è±¡ã
             */
            "linestring": function (array) {
                var points = [];
                var p = null;
                for (var i = 0, len = array.length; i < len; ++i) {
                    try {
                        p = this.parseCoords["point"].apply(this, [array[i]]);
                    } catch (err) {
                        throw err;
                    }
                    points.push(p);
                }
                return new LineString(points);
            },

            /**
             * @function GeoJSONFormat.parseCoords.multilinestring
             * @description å°åæ ç»æ°ç»è½¬åæä¸ºä¸ä¸ª {@link Geometry} å¯¹è±¡ã
             * @param {Object} array - GeoJSON çæ®µä¸­çåæ ç»æ°ç»ã
             * @returns {Geometry} ä¸ä¸ªå ä½å¯¹è±¡ã
             */
            "multilinestring": function (array) {
                var lines = [];
                var l = null;
                for (var i = 0, len = array.length; i < len; ++i) {
                    try {
                        l = this.parseCoords["linestring"].apply(this, [array[i]]);
                    } catch (err) {
                        throw err;
                    }
                    lines.push(l);
                }
                return new MultiLineString(lines);
            },

            /**
             * @function GeoJSONFormat.parseCoords.polygon
             * @description å°åæ ç»æ°ç»è½¬åæä¸ºä¸ä¸ª {@link Geometry} å¯¹è±¡ã
             * @returns {Geometry} ä¸ä¸ªå ä½å¯¹è±¡ã
             */
            "polygon": function (array) {
                var rings = [];
                var r, l;
                for (var i = 0, len = array.length; i < len; ++i) {
                    try {
                        l = this.parseCoords["linestring"].apply(this, [array[i]]);
                    } catch (err) {
                        throw err;
                    }
                    r = new LinearRing(l.components);
                    rings.push(r);
                }
                return new Polygon(rings);
            },

            /**
             * @function GeoJSONFormat.parseCoords.multipolygon
             * @description å°åæ ç»æ°ç»è½¬åæä¸ºä¸ä¸ª {@link Geometry} å¯¹è±¡ã
             * @param {Object} array - GeoJSON çæ®µä¸­çåæ ç»æ°ç»ã
             * @returns {Geometry} ä¸ä¸ªå ä½å¯¹è±¡ã
             */
            "multipolygon": function (array) {
                var polys = [];
                var p = null;
                for (var i = 0, len = array.length; i < len; ++i) {
                    try {
                        p = this.parseCoords["polygon"].apply(this, [array[i]]);
                    } catch (err) {
                        throw err;
                    }
                    polys.push(p);
                }
                return new MultiPolygon(polys);
            },

            /**
             * @function GeoJSONFormat.parseCoords.box
             * @description å°åæ ç»æ°ç»è½¬åæä¸ºä¸ä¸ª {@link Geometry} å¯¹è±¡ã
             * @param {Array} array - GeoJSON çæ®µä¸­çåæ ç»æ°ç»ã
             * @returns {Geometry} ä¸ä¸ªå ä½å¯¹è±¡ã
             */
            "box": function (array) {
                if (array.length != 2) {
                    throw "GeoJSON box coordinates must have 2 elements";
                }
                return new Polygon([
                    new LinearRing([
                        new Point(array[0][0], array[0][1]),
                        new Point(array[1][0], array[0][1]),
                        new Point(array[1][0], array[1][1]),
                        new Point(array[0][0], array[1][1]),
                        new Point(array[0][0], array[0][1])
                    ])
                ]);
            }

        };
        /**
         * @member {Object} GeoJSONFormat.prototype.extract
         * @private
         * @description ä¸ä¸ªå±æ§åå¯¹åºçGeoJSONç±»åçå¯¹è±¡ãå¶å¼ä¸ºç¸åºçå®éçè§£ææ¹æ³ã
         */
        this.extract = {
            /**
             * @function GeoJSONFormat.extract.feature
             * @description è¿åä¸ä¸ªè¡¨ç¤ºåä¸ªè¦ç´ å¯¹è±¡ç GeoJSON çä¸é¨åã
             * @param {SuperMap.ServerFeature} feature - iServer è¦ç´ å¯¹è±¡ã
             * @returns {Object} ä¸ä¸ªè¡¨ç¤ºç¹çå¯¹è±¡ã
             */
            'feature': function (feature) {
                var geom = this.extract.geometry.apply(this, [feature.geometry]);
                var json = {
                    "type": "Feature",
                    "properties": this.createAttributes(feature),
                    "geometry": geom
                };

                if (feature.geometry && feature.geometry.type === 'TEXT') {
                    json.properties.texts = feature.geometry.texts;
                    json.properties.textStyle = feature.geometry.textStyle;
                }
                if (feature.fid) {
                    json.id = feature.fid;
                }
                if (feature.ID) {
                    json.id = feature.ID;
                }
                return json;
            },


            /**
             * @function GeoJSONFormat.extract.geometry
             * @description è¿åä¸ä¸ªè¡¨ç¤ºåä¸ªå ä½å¯¹è±¡ç GeoJSON çä¸é¨åã
             * @param {Object} geometry - iServer å ä½å¯¹è±¡ã
             * @returns {Object} ä¸ä¸ªè¡¨ç¤ºå ä½ä½çå¯¹è±¡ã
             */
            'geometry': function (geometry) {
                if (geometry == null) {
                    return null;
                }
                if (!geometry.parts && geometry.points) {
                    geometry.parts = [geometry.points.length];
                }
                var geo = geometry.hasOwnProperty('geometryType')
                    ? geometry
                    : new ServerGeometry(geometry).toGeometry() || geometry;
                var geometryType = geo.geometryType || geo.type;
                var data;
                if (geometryType === "LinearRing") {
                    geometryType = "LineString";
                }
                if (geometryType === "LINEM") {
                    geometryType = "MultiLineString";
                }
                data = this.extract[geometryType.toLowerCase()].apply(this, [geo]);
                geometryType = geometryType === 'TEXT' ? 'Point' : geometryType;
                var json;
                if (geometryType === "Collection") {
                    json = {
                        "type": "GeometryCollection",
                        "geometries": data
                    };
                } else {
                    json = {
                        "type": geometryType,
                        "coordinates": data
                    };
                }
                return json;
            },


            /**
             * @function GeoJSONFormat.extract.point
             * @description ä»ä¸ä¸ªç¹å¯¹è±¡ä¸­è¿åä¸ä¸ªåæ ç»ã
             * @param {GeometryPoint} point - ä¸ä¸ªç¹å¯¹è±¡ã
             * @returns {Array} ä¸ä¸ªè¡¨ç¤ºä¸ä¸ªç¹çåæ ç»ã
             */
            'point': function (point) {
                var p = [point.x, point.y];
                for (var name in point) {
                    if (name !== "x" && name !== "y" && point[name] !== null && !isNaN(point[name])) {
                        p.push(point[name]);
                    }
                }
                return p;
            },

            /**
             * @function GeoJSONFormat.extract.point
             * @description ä»ä¸ä¸ªææ¬å¯¹è±¡ä¸­è¿åä¸ä¸ªåæ ç»ã
             * @param {Object} geo - ä¸ä¸ªææ¬å¯¹è±¡ã
             * @returns {Array} ä¸ä¸ªè¡¨ç¤ºä¸ä¸ªç¹çåæ ç»ã
             */
            'text': function (geo) {
                return [geo.points[0].x, geo.points[0].y];
            },

            /**
             * @function GeoJSONFormat.extract.multipoint
             * @description ä»ä¸ä¸ªå¤ç¹å¯¹è±¡ä¸­è¿ä¸ä¸ªåæ ç»æ°ç»ã
             * @param {GeometryMultiPoint} multipoint - å¤ç¹å¯¹è±¡ã
             * @returns {Array} ä¸ä¸ªè¡¨ç¤ºå¤ç¹çåæ ç»æ°ç»ã
             */
            'multipoint': function (multipoint) {
                var array = [];
                for (var i = 0, len = multipoint.components.length; i < len; ++i) {
                    array.push(this.extract.point.apply(this, [multipoint.components[i]]));
                }
                return array;
            },

            /**
             * @function GeoJSONFormat.extract.linestring
             * @description ä»ä¸ä¸ªçº¿å¯¹è±¡ä¸­è¿åä¸ä¸ªåæ ç»æ°ç»ã
             * @param {Linestring} linestring - çº¿å¯¹è±¡ã
             * @returns {Array} ä¸ä¸ªè¡¨ç¤ºçº¿å¯¹è±¡çåæ ç»æ°ç»ã
             */
            'linestring': function (linestring) {
                var array = [];
                for (var i = 0, len = linestring.components.length; i < len; ++i) {
                    array.push(this.extract.point.apply(this, [linestring.components[i]]));
                }
                return array;
            },

            /**
             * @function GeoJSONFormat.extract.multilinestring
             * @description ä»ä¸ä¸ªå¤çº¿å¯¹è±¡ä¸­è¿åä¸ä¸ªçº¿æ°ç»ã
             * @param {GeometryMultiLineString} multilinestring - å¤çº¿å¯¹è±¡ã
             *
             * @returns {Array} ä¸ä¸ªè¡¨ç¤ºå¤çº¿ççº¿æ°ç»ã
             */
            'multilinestring': function (multilinestring) {
                var array = [];
                for (var i = 0, len = multilinestring.components.length; i < len; ++i) {
                    array.push(this.extract.linestring.apply(this, [multilinestring.components[i]]));
                }
                return array;
            },

            /**
             * @function GeoJSONFormat.extract.polygon
             * @description ä»ä¸ä¸ªé¢å¯¹è±¡ä¸­è¿åä¸ç»çº¿ç¯ã
             * @param {GeometryPolygon} polygon - é¢å¯¹è±¡ã
             * @returns {Array} ä¸ç»è¡¨ç¤ºé¢ççº¿ç¯ã
             */
            'polygon': function (polygon) {
                var array = [];
                for (var i = 0, len = polygon.components.length; i < len; ++i) {
                    array.push(this.extract.linestring.apply(this, [polygon.components[i]]));
                }
                return array;
            },

            /**
             * @function GeoJSONFormat.extract.multipolygon
             * @description ä»ä¸ä¸ªå¤é¢å¯¹è±¡ä¸­è¿åä¸ç»é¢ã
             * @param {GeometryMultiPolygon} multipolygon - å¤é¢å¯¹è±¡ã
             * @returns {Array} ä¸ç»è¡¨ç¤ºå¤é¢çé¢ã
             */
            'multipolygon': function (multipolygon) {
                var array = [];
                for (var i = 0, len = multipolygon.components.length; i < len; ++i) {
                    array.push(this.extract.polygon.apply(this, [multipolygon.components[i]]));
                }
                return array;
            },

            /**
             * @function GeoJSONFormat.extract.collection
             * @description ä»ä¸ä¸ªå ä½è¦ç´ éåä¸­ä¸ç»å ä½è¦ç´ æ°ç»ã
             * @param {GeometryCollection} collection - å ä½è¦ç´ éåã
             * @returns {Array} ä¸ç»è¡¨ç¤ºå ä½è¦ç´ éåçå ä½è¦ç´ æ°ç»ã
             */
            'collection': function (collection) {
                var len = collection.components.length;
                var array = new Array(len);
                for (var i = 0; i < len; ++i) {
                    array[i] = this.extract.geometry.apply(this, [collection.components[i]]);
                }
                return array;
            }
        };
    }

    /**
     * @function GeoJSONFormat.prototype.read
     * @description å° GeoJSON å¯¹è±¡æèGeoJSON å¯¹è±¡å­ç¬¦ä¸²è½¬æ¢ä¸º SuperMap Feature å¯¹è±¡ã
     * @param {GeoJSONObject} json - GeoJSON å¯¹è±¡ã
     * @param {string} [type='FeaureCollection'] - å¯éçå­ç¬¦ä¸²ï¼å®å³å®äºè¾åºçæ ¼å¼ãæ¯æçå¼æï¼"Geometry","Feature"ï¼å "FeatureCollection"ï¼å¦ææ­¤å¼ä¸ºnullã
     * @param {function} filter - å¯¹è±¡ä¸­æ¯ä¸ªå±æ¬¡æ¯ä¸ªé®å¼å¯¹é½ä¼è°ç¨æ­¤å½æ°å¾åºä¸ä¸ªç»æãæ¯ä¸ªå¼é½ä¼è¢« filter å½æ°çç»æææ¿æ¢æãè¿ä¸ªå½æ°å¯è¢«ç¨æ¥å°æäºå¯¹è±¡è½¬åææä¸ªç±»ç¸åºçå¯¹è±¡ï¼æèå°æ¥æå­ç¬¦ä¸²è½¬åæDateå¯¹è±¡ã
     * @returns {Object}  è¿åå¼ä¾èµäº type åæ°çå¼ã
     *     -å¦æ type ç­äº "FeatureCollection"ï¼è¿åå¼å°ä¼æ¯ {@link FeatureVector} æ°ç»ã
     *     -å¦æ type ä¸º "Geometry",è¾å¥ç JSON å¯¹è±¡å¿é¡»è¡¨ç¤ºä¸ä¸ªå¯ä¸çå ä½ä½ï¼ç¶åè¿åå¼å°±ä¼æ¯ {@link Geometry}ã
     *     -å¦æ type ä¸º "Feature"ï¼è¾å¥ç JSON å¯¹è±¡ä¹å¿é¡»è¡¨ç¤ºçä¸ä¸ªè¦ç´ ï¼è¿æ ·è¿åå¼æä¼æ¯ {@link FeatureVector}ã
     */

    read(json, type, filter) {
        type = (type) ? type : "FeatureCollection";
        var results = null;
        var obj = null;
        if (typeof json == "string") {
            obj = super.read(json, filter);
        } else {
            obj = json;
        }
        if (!obj) {
            //console.error("Bad JSON: " + json);
        } else if (typeof (obj.type) != "string") {
            //console.error("Bad GeoJSON - no type: " + json);
        } else if (this.isValidType(obj, type)) {
            switch (type) {
                case "Geometry":
                    try {
                        results = this.parseGeometry(obj);
                    } catch (err) {
                        //console.error(err);
                    }
                    break;
                case "Feature":
                    try {
                        results = this.parseFeature(obj);
                        results.type = "Feature";
                    } catch (err) {
                        //console.error(err);
                    }
                    break;
                case "FeatureCollection":
                    // for type FeatureCollection, we allow input to be any type
                    results = [];
                    switch (obj.type) {
                        case "Feature":
                            try {
                                results.push(this.parseFeature(obj));
                            } catch (err) {
                                results = null;
                                //console.error(err);
                            }
                            break;
                        case "FeatureCollection":
                            for (var i = 0, len = obj.features.length; i < len; ++i) {
                                try {
                                    results.push(this.parseFeature(obj.features[i]));
                                } catch (err) {
                                    results = null;
                                    // console.error(err);
                                }
                            }
                            break;
                        default:
                            try {
                                var geom = this.parseGeometry(obj);
                                results.push(new Vector(geom));
                            } catch (err) {
                                results = null;
                                //console.error(err);
                            }
                    }
                    break;
                default:
                    break;
            }
        }
        return results;
    }

    /**
     * @function GeoJSONFormat.prototype.write
     * @description iServer Geometry JSON å¯¹è±¡ è½¬ GeoJSONå¯¹è±¡å­ç¬¦ä¸²ã
     * @param {Object} obj - iServer Geometry JSON å¯¹è±¡ã
     * @param {boolean} [pretty=false] - æ¯å¦ä½¿ç¨æ¢è¡åç¼©è¿æ¥æ§å¶è¾åºã
     * @returns {GeoJSONObject} ä¸ä¸ª GeoJSON å­ç¬¦ä¸²ï¼å®è¡¨ç¤ºäºè¾å¥çå ä½å¯¹è±¡ï¼è¦ç´ å¯¹è±¡ï¼æèè¦ç´ å¯¹è±¡æ°ç»ã
     */
    write(obj, pretty) {
        return super.write(this.toGeoJSON(obj), pretty);
    }
    /**
     * @function GeoJSONFormat.prototype.fromGeoJSON
     * @version 9.1.1
     * @description å° GeoJSON å¯¹è±¡æèGeoJSON å¯¹è±¡å­ç¬¦ä¸²è½¬æ¢ä¸ºiServer Feature JSONã
     * @param {GeoJSONObject} json - GeoJSON å¯¹è±¡ã
     * @param {string} [type='FeaureCollection'] - å¯éçå­ç¬¦ä¸²ï¼å®å³å®äºè¾åºçæ ¼å¼ãæ¯æçå¼æï¼"Geometry","Feature"ï¼å "FeatureCollection"ï¼å¦ææ­¤å¼ä¸ºnullã
     * @param {function} filter - å¯¹è±¡ä¸­æ¯ä¸ªå±æ¬¡æ¯ä¸ªé®å¼å¯¹é½ä¼è°ç¨æ­¤å½æ°å¾åºä¸ä¸ªç»æãæ¯ä¸ªå¼é½ä¼è¢« filter å½æ°çç»æææ¿æ¢æãè¿ä¸ªå½æ°å¯è¢«ç¨æ¥å°æäºå¯¹è±¡è½¬åææä¸ªç±»ç¸åºçå¯¹è±¡ï¼æèå°æ¥æå­ç¬¦ä¸²è½¬åæDateå¯¹è±¡ã
     * @returns {Object}  iServer Feature JSONã
     */
    fromGeoJSON(json, type, filter) {
        let feature = this.read(json, type, filter);
        if (!Util.isArray(feature)) {
            return this._toiSevrerFeature(feature);
        }
        return feature.map((element) => {
            return this._toiSevrerFeature(element);
        })
    }

    /**
     * @function GeoJSONFormat.prototype.toGeoJSON
     * @version 9.1.1
     * @description å° iServer Feature JSON å¯¹è±¡è½¬æ¢ä¸º GeoJSON å¯¹è±¡ã
     * @param {Object} obj - iServer Feature JSONã
     * @returns {GeoJSONObject}  GeoJSON å¯¹è±¡ã
     */
    toGeoJSON(obj) {
        var geojson = {
            "type": null
        };
        if (Util.isArray(obj)) {
            geojson.type = "FeatureCollection";
            var numFeatures = obj.length;
            geojson.features = new Array(numFeatures);
            for (var i = 0; i < numFeatures; ++i) {
                var element = obj[i];
                if (isGeometry(element)) {
                    let feature = {};
                    feature.geometry = element;
                    geojson.features[i] = this.extract.feature.apply(this, [feature]);
                } else {
                    geojson.features[i] = this.extract.feature.apply(this, [element]);
                }
            }
        } else if (isGeometry(obj)) {
            let feature = {};
            feature.geometry = obj;
            geojson = this.extract.feature.apply(this, [feature]);
        } else {
            geojson = this.extract.feature.apply(this, [obj]);
        }

        function isGeometry(input) {
            return (input.hasOwnProperty("parts") && input.hasOwnProperty("points")) || input.hasOwnProperty("geoParts");
        }

        return geojson;

    }
    /**
     *  @function GeoJSONFormat.prototype.isValidType
     *  @description æ£æ¥ä¸ä¸ª GeoJSON å¯¹è±¡æ¯å¦åç»å®çç±»åç¸ç¬¦çåæ³çå¯¹è±¡ã
     *  @returns {boolean} GeoJSON æ¯å¦æ¯ç»å®ç±»åçåæ³å¯¹è±¡ã
     *  @private
     */
    isValidType(obj, type) {
        var valid = false;
        switch (type) {
            case "Geometry":
                if (Util.indexOf(
                    ["Point", "MultiPoint", "LineString", "MultiLineString",
                        "Polygon", "MultiPolygon", "Box", "GeometryCollection"
                    ],
                    obj.type) == -1) {
                    // unsupported geometry type
                    //console.error("Unsupported geometry type: " +
                    // obj.type);
                } else {
                    valid = true;
                }
                break;
            case "FeatureCollection":
                // allow for any type to be converted to a feature collection
                valid = true;
                break;
            default:
                // for Feature types must match
                if (obj.type == type) {
                    valid = true;
                } else {
                    //console.error("Cannot convert types from " +
                    //obj.type + " to " + type);
                }
        }
        return valid;
    }

    /**
     * @function GeoJSONFormat.prototype.parseFeature
     * @description å°ä¸ä¸ª GeoJSON ä¸­ç feature è½¬åæ {@link FeatureVector}> å¯¹è±¡ã
     * @private
     * @param {GeoJSONObject} obj - ä» GeoJSON å¯¹è±¡ä¸­åå»ºä¸ä¸ªå¯¹è±¡ã
     * @returns {FeatureVector} ä¸ä¸ªè¦ç´ ã
     */
    parseFeature(obj) {
        var feature, geometry, attributes, bbox;
        attributes = (obj.properties) ? obj.properties : {};
        bbox = (obj.geometry && obj.geometry.bbox) || obj.bbox;
        try {
            geometry = this.parseGeometry(obj.geometry);
        } catch (err) {
            // deal with bad geometries
            throw err;
        }
        feature = new Vector(geometry, attributes);
        if (bbox) {
            feature.bounds = Bounds.fromArray(bbox);
        }
        if (obj.id) {
            feature.geometry.id = obj.id;
            feature.fid = obj.id;
        }
        return feature;
    }


    /**
     * @function GeoJSONFormat.prototype.parseGeometry
     * @description å°ä¸ä¸ª GeoJSON ä¸­çå ä½è¦ç´ è½¬åæ {@link Geometry} å¯¹è±¡ã
     * @param {GeoJSONObject} obj - ä» GeoJSON å¯¹è±¡ä¸­åå»ºä¸ä¸ªå¯¹è±¡ã
     * @returns {Geometry} ä¸ä¸ªå ä½è¦ç´ ã
     * @private
     */
    parseGeometry(obj) {
        if (obj == null) {
            return null;
        }
        var geometry;
        if (obj.type == "GeometryCollection") {
            if (!(Util.isArray(obj.geometries))) {
                throw "GeometryCollection must have geometries array: " + obj;
            }
            var numGeom = obj.geometries.length;
            var components = new Array(numGeom);
            for (var i = 0; i < numGeom; ++i) {
                components[i] = this.parseGeometry.apply(
                    this, [obj.geometries[i]]
                );
            }
            geometry = new Collection(components);
        } else {
            if (!(Util.isArray(obj.coordinates))) {
                throw "Geometry must have coordinates array: " + obj;
            }
            if (!this.parseCoords[obj.type.toLowerCase()]) {
                throw "Unsupported geometry type: " + obj.type;
            }
            try {
                geometry = this.parseCoords[obj.type.toLowerCase()].apply(
                    this, [obj.coordinates]
                );
            } catch (err) {
                // deal with bad coordinates
                throw err;
            }
        }
        return geometry;
    }


    /**
     * @function GeoJSONFormat.prototype.createCRSObject
     * @description ä»ä¸ä¸ªè¦ç´ å¯¹è±¡ä¸­åå»ºä¸ä¸ªåæ åèç³»å¯¹è±¡ã
     * @param {FeatureVector} object - è¦ç´ å¯¹è±¡ã
     * @private
     * @returns {GeoJSONObject} ä¸ä¸ªå¯ä½ä¸º GeoJSON å¯¹è±¡ç CRS å±æ§ä½¿ç¨çå¯¹è±¡ã
     */
    createCRSObject(object) {
        var proj = object.layer.projection.toString();
        var crs = {};
        if (proj.match(/epsg:/i)) {
            var code = parseInt(proj.substring(proj.indexOf(":") + 1));
            if (code == 4326) {
                crs = {
                    "type": "name",
                    "properties": {
                        "name": "urn:ogc:def:crs:OGC:1.3:CRS84"
                    }
                };
            } else {
                crs = {
                    "type": "name",
                    "properties": {
                        "name": "EPSG:" + code
                    }
                };
            }
        }
        return crs;
    }
    _toiSevrerFeature(feature) {
        const attributes = feature.attributes;
        const attrNames = [];
        const attrValues = [];
        for (var attr in attributes) {
            attrNames.push(attr);
            attrValues.push(attributes[attr]);
        }
        const newFeature = {
            fieldNames: attrNames,
            fieldValues: attrValues,
            geometry: ServerGeometry.fromGeometry(feature.geometry)
        };
        newFeature.geometry.id = feature.fid;
        return newFeature;
    }
    createAttributes(feature) {
        if (!feature) {
            return null;
        }
        var attr = {};
        processFieldsAttributes(feature, attr);
        var exceptKeys = ["fieldNames", "fieldValues", "geometry", "stringID", "ID"];
        for (var key in feature) {
            if (exceptKeys.indexOf(key) > -1) {
                continue;
            }
            attr[key] = feature[key];
        }

        function processFieldsAttributes(feature, attributes) {
            if (!(feature.hasOwnProperty("fieldNames") && feature.hasOwnProperty("fieldValues"))) {
                return;
            }
            var names = feature.fieldNames,
                values = feature.fieldValues;
            for (var i in names) {
                attributes[names[i]] = values[i];
            }
        }

        return attr;
    }
}

;// CONCATENATED MODULE: ./src/common/format/WKT.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/











/**
 * @class WKTFormat
 * @aliasclass Format.WKT
 * @deprecatedclass SuperMap.Format.WKT
 * @classdesc ç¨äºè¯»åå¸¸è§ææ¬çç±»ãéè¿ {@link WKTFormat} æé å¨æ¥åå»ºä¸ä¸ªæ°çå®ä¾ã
 * @category BaseTypes Format
 * @extends {Format}
 * @param {Object} options - å¯éçéé¡¹å¯¹è±¡ï¼å¶å±æ§å°è¢«è®¾ç½®å°å®ä¾ãoption å·ä½éç½®é¡¹ç»§æ¿èª {@link Format}ã
 * @usage
 */
class WKT extends Format {

    constructor(options) {
        super(options);
        this.regExes = {
            'typeStr': /^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,
            'spaces': /\s+/,
            'parenComma': /\)\s*,\s*\(/,
            'doubleParenComma': /\)\s*\)\s*,\s*\(\s*\(/,  // can't use {2} here
            'trimParens': /^\s*\(?(.*?)\)?\s*$/
        };
        this.CLASS_NAME = "SuperMap.Format.WKT"; /**
         * @private
         * @description Object with properties corresponding to the geometry types.
         * Property values are functions that do the actual data extraction.
         */
        this.extract = {
            /**
             * @description Return a space delimited string of point coordinates.
             * @param {GeometryPoint} point
             * @returns  {string} A string of coordinates representing the point
             */
            'point': function (point) {
                return point.x + ' ' + point.y;
            },

            /**
             * @description  Return a comma delimited string of point coordinates from a multipoint.
             * @param {GeometryMultiPoint} multipoint
             * @returns  {string} A string of point coordinate strings representing
             *                  the multipoint
             */
            'multipoint'(multipoint) {
                var array = [];
                for (var i = 0, len = multipoint.components.length; i < len; ++i) {
                    array.push('(' +
                        this.extract.point.apply(this, [multipoint.components[i]]) +
                        ')');
                }
                return array.join(',');
            },

            /**
             * @description  Return a comma delimited string of point coordinates from a line.
             * @param {GeometryLineString} linestring
             * @returns  {string} A string of point coordinate strings representing
             *                  the linestring
             */
            'linestring'(linestring) {
                var array = [];
                for (var i = 0, len = linestring.components.length; i < len; ++i) {
                    array.push(this.extract.point.apply(this, [linestring.components[i]]));
                }
                return array.join(',');
            },

            /**
             * @description  Return a comma delimited string of linestring strings from a multilinestring.
             * @param {GeometryMultiLineString} multilinestring
             * @returns  {string} A string of of linestring strings representing
             *                  the multilinestring
             */
            'multilinestring'(multilinestring) {
                var array = [];
                for (var i = 0, len = multilinestring.components.length; i < len; ++i) {
                    array.push('(' +
                        this.extract.linestring.apply(this, [multilinestring.components[i]]) +
                        ')');
                }
                return array.join(',');
            },

            /**
             * @description  Return a comma delimited string of linear ring arrays from a polygon.
             * @param {GeometryPolygon} polygon
             * @returns  {string} An array of linear ring arrays representing the polygon
             */
            'polygon'(polygon) {
                var array = [];
                for (var i = 0, len = polygon.components.length; i < len; ++i) {
                    array.push('(' +
                        this.extract.linestring.apply(this, [polygon.components[i]]) +
                        ')');
                }
                return array.join(',');
            },

            /**
             * @description  Return an array of polygon arrays from a multipolygon.
             * @param {GeometryMultiPolygon} multipolygon
             * @returns  {string} An array of polygon arrays representing
             *                  the multipolygon
             */
            'multipolygon'(multipolygon) {
                var array = [];
                for (var i = 0, len = multipolygon.components.length; i < len; ++i) {
                    array.push('(' +
                        this.extract.polygon.apply(this, [multipolygon.components[i]]) +
                        ')');
                }
                return array.join(',');
            },

            /**
             * @description  Return the WKT portion between 'GEOMETRYCOLLECTION(' and ')' for an <GeometryCollection>
             * @param {GeometryCollection} collection
             * @returns  {string} internal WKT representation of the collection
             */
            'collection'(collection) {
                var array = [];
                for (var i = 0, len = collection.components.length; i < len; ++i) {
                    array.push(this.extractGeometry.apply(this, [collection.components[i]]));
                }
                return array.join(',');
            }

        };

        /**
         * @private
         * @description Object with properties corresponding to the geometry types.
         * Property values are functions that do the actual parsing.
         */
        this.parse = {
            /**
             * @private
             * @description  Return point feature given a point WKT fragment.
             * @param {string} str A WKT fragment representing the point
             * @returns  {FeatureVector} A point feature
             *
             */
            'point': function (str) {
                var coords = StringExt.trim(str).split(this.regExes.spaces);
                return new Vector(new Point(coords[0], coords[1])
                );
            },

            /**
             * @description  Return a multipoint feature given a multipoint WKT fragment.
             * @param {string} A WKT fragment representing the multipoint
             * @returns  {FeatureVector} A multipoint feature
             * @private
             */
            'multipoint': function (str) {
                var point;
                var points = StringExt.trim(str).split(',');
                var components = [];
                for (var i = 0, len = points.length; i < len; ++i) {
                    point = points[i].replace(this.regExes.trimParens, '$1');
                    components.push(this.parse.point.apply(this, [point]).geometry);
                }
                return new Vector(
                    new MultiPoint(components)
                );
            },

            /**
             * @description  Return a linestring feature given a linestring WKT fragment.
             * @param {string} A WKT fragment representing the linestring
             * @returns  {FeatureVector} A linestring feature
             * @private
             */
            'linestring': function (str) {
                var points = StringExt.trim(str).split(',');
                var components = [];
                for (var i = 0, len = points.length; i < len; ++i) {
                    components.push(this.parse.point.apply(this, [points[i]]).geometry);
                }
                return new Vector(
                    new LineString(components)
                );
            },

            /**
             * @description  Return a multilinestring feature given a multilinestring WKT fragment.
             * @param {string} A WKT fragment representing the multilinestring
             * @returns  {FeatureVector} A multilinestring feature
             * @private
             */
            'multilinestring': function (str) {
                var line;
                var lines = StringExt.trim(str).split(this.regExes.parenComma);
                var components = [];
                for (var i = 0, len = lines.length; i < len; ++i) {
                    line = lines[i].replace(this.regExes.trimParens, '$1');
                    components.push(this.parse.linestring.apply(this, [line]).geometry);
                }
                return new Vector(
                    new MultiLineString(components)
                );
            },

            /**
             * @description  Return a polygon feature given a polygon WKT fragment.
             * @param {string} A WKT fragment representing the polygon
             * @returns  {FeatureVector} A polygon feature
             * @private
             */
            'polygon': function (str) {
                var ring, linestring, linearring;
                var rings = StringExt.trim(str).split(this.regExes.parenComma);
                var components = [];
                for (var i = 0, len = rings.length; i < len; ++i) {
                    ring = rings[i].replace(this.regExes.trimParens, '$1');
                    linestring = this.parse.linestring.apply(this, [ring]).geometry;
                    linearring = new LinearRing(linestring.components);
                    components.push(linearring);
                }
                return new Vector(
                    new Polygon(components)
                );
            },

            /**
             * @private
             * @description  Return a multipolygon feature given a multipolygon WKT fragment.
             * @param {string} A WKT fragment representing the multipolygon
             * @returns  {FeatureVector} A multipolygon feature
             *
             */
            'multipolygon': function (str) {
                var polygon;
                var polygons = StringExt.trim(str).split(this.regExes.doubleParenComma);
                var components = [];
                for (var i = 0, len = polygons.length; i < len; ++i) {
                    polygon = polygons[i].replace(this.regExes.trimParens, '$1');
                    components.push(this.parse.polygon.apply(this, [polygon]).geometry);
                }
                return new Vector(
                    new MultiPolygon(components)
                );
            },


            /**
             * @description  Return an array of features given a geometrycollection WKT fragment.
             * @param {string} A WKT fragment representing the geometrycollection
             * @returns  {Array} An array of FeatureVector
             * @private
             */
            'geometrycollection': function (str) {
                // separate components of the collection with |
                str = str.replace(/,\s*([A-Za-z])/g, '|$1');
                var wktArray = StringExt.trim(str).split('|');
                var components = [];
                for (var i = 0, len = wktArray.length; i < len; ++i) {
                    components.push(this.read(wktArray[i]));
                }
                return components;
            }

        };

    }


    /**
     * @function WKTFormat.prototype.read
     * @description ååºåå WKT å­ç¬¦ä¸²å¹¶è¿ååéç¹å¾æåéç¹å¾æ°ç»ã æ¯æ POINTãMULTIPOINTãLINESTRINGãMULTILINESTRINGãPOLYGONãMULTIPOLYGON å GEOMETRYCOLLECTION ç WKTã
     * @param {string} wkt - WKT å­ç¬¦ä¸²ã
     * @returns {FeatureVector|Array} GEOMETRYCOLLECTION WKT çç¢éè¦ç´ æèç¢éè¦ç´ æ°ç»ã
     */
    read(wkt) {
        var features, type, str;
        wkt = wkt.replace(/[\n\r]/g, " ");
        var matches = this.regExes.typeStr.exec(wkt);
        if (matches) {
            type = matches[1].toLowerCase();
            str = matches[2];
            if (this.parse[type]) {
                features = this.parse[type].apply(this, [str]);
            }
        }
        return features;
    }


    /**
     * @function WKTFormat.prototype.write
     * @description å°ç¢éè¦ç´ æç¢éè¦ç´ æ°ç»åºååä¸º WKT å­ç¬¦ä¸²ã
     * @param {(FeatureVector|Array)} features - ç¢éè¦ç´ æç¢éè¦ç´ æ°ç»ã
     * @returns {string} è¡¨ç¤ºå ä½ç WKT å­ç¬¦ä¸²ã
     */
    write(features) {
        var collection, geometry, isCollection;
        if (features.constructor === Array) {
            collection = features;
            isCollection = true;
        } else {
            collection = [features];
            isCollection = false;
        }
        var pieces = [];
        if (isCollection) {
            pieces.push('GEOMETRYCOLLECTION(');
        }
        for (var i = 0, len = collection.length; i < len; ++i) {
            if (isCollection && i > 0) {
                pieces.push(',');
            }
            geometry = collection[i].geometry;
            pieces.push(this.extractGeometry(geometry));
        }
        if (isCollection) {
            pieces.push(')');
        }
        return pieces.join('');
    }

    /**
     * @function WKTFormat.prototype.extractGeometry
     * @description ä¸ºåä¸ª Geometry å¯¹è±¡æé  WKT çå¥å£ç¹ã
     * @param {Geometry} geometry - Geometry å¯¹è±¡ã
     * @returns {string} è¡¨ç¤ºå ä½ç WKT å­ç¬¦ä¸²ã
     */
    extractGeometry(geometry) {
        var type = geometry.CLASS_NAME.split('.')[2].toLowerCase();
        if (!this.extract[type]) {
            return null;
        }
        var wktType = type === 'collection' ? 'GEOMETRYCOLLECTION' : type.toUpperCase();
        var data = wktType + '(' + this.extract[type].apply(this, [geometry]) + ')';
        return data;
    }
}

;// CONCATENATED MODULE: ./src/common/format/index.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/









;// CONCATENATED MODULE: ./src/common/control/TimeControlBase.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class TimeControlBase
 * @deprecatedclass SuperMap.TimeControlBase
 * @classdesc æ¶é´æ§å¶åºç±»ç±»ã
 * @category  Control
 * @param {Object} options - å¯éåæ°ã
 * @param {number} [options.speed=1] - éåº¦ãä¸è½å°äº 0ï¼ï¼æ¯å¸§æ¸²æçæ°æ®ä¹é´çé´éä¸º1ï¼ï¼è®¾ç½®è¶å¤§éåº¦è¶å¿«ã
 * @param {number} [options.frequency=1000] - å·æ°é¢çï¼åä½ msï¼ï¼æå¡å¨å·æ°çæ¶é´é´éã
 * @param {number} [options.startTime=0] - èµ·å§æ¶é´ï¼å¿é¡»ä¸ºæ°å­ï¼ä¸å°äºç­äº endTimeãå¦æä¸è®¾ç½®ï¼åå§åæ¶ä¸º 0ï¼å»ºè®®è®¾ç½®ã
 * @param {number} [options.endTime] - ç»ææ¶é´ï¼å¿é¡»ä¸ºæ°å­ï¼ä¸å¤§äºç­äº startTimeãå¦æä¸è®¾ç½®ï¼åå§åæ¶ä»¥å½åæ¶é´è¿è¡è®¾ç½®ï¼å»ºè®®è®¾ç½®ã
 * @param {boolean} [options.repeat=true] - æ¯å¦éå¤å¾ªç¯ã
 * @param {boolean} [options.reverse=false] - æ¯å¦ååã
 * @usage
 */
class TimeControlBase {


    constructor(options) {
        //è®¾ç½®æ­¥é¿ï¼å·æ°é¢çãå¼å§ç»ææ¶é´ãæ¯å¦å¾ªç¯ãæ¯å¦åå
        var me = this;
        options = options || {};


        /**
         * @member {number} [TimeControlBase.prototype.speed=1]
         * @description æ­¥é¿ï¼å¿é¡»ä¸ºéè´æ°ï¼é»è®¤ä¸º1ï¼è¡¨ç¤ºååä¸¤æ¬¡æ¸²æçæ°æ®ä¹é´çé´éä¸º1ï¼
         */
        this.speed = (options.speed && options.speed >= 0) ? options.speed : 1;

        /**
         * @member {number} [TimeControlBase.prototype.frequency=1000]
         * @description å·æ°é¢ç(åä½ms)ï¼æå¡å¨å·æ°çæ¶é´é´éã
         */
        this.frequency = (options.speed && options.frequency >= 0) ? options.frequency : 1000;

        /**
         * @member {number} [TimeControlBase.prototype.startTime=0]
         * @description è®°å½çèµ·å§æ¶é´ï¼å¿é¡»ä¸ºæ°å­ï¼
         *              å¦æä¸è®¾ç½®ï¼åå§åæ¶ä¸º0ï¼å»ºè®®è®¾ç½®
         */
        this.startTime = (options.startTime && options.startTime != null) ? options.startTime : 0;

        /**
         * @member {number} TimeControlBase.prototype.endTime
         * @description è®°å½çç»ææ¶é´ï¼å¿é¡»ä¸ºæ°å­ï¼
         *              å¦æä¸è®¾ç½®ï¼åå§åæ¶ä»¥å½åæ¶é´è¿è¡è®¾ç½®ï¼å»ºè®®è®¾ç½®
         */
        this.endTime = (options.endTime && options.endTime != null && options.endTime >= me.startTime) ? options.endTime : +new Date();

        /**
         * @member {boolean} [TimeControlBase.prototype.repeat=true]
         * @description æ¯å¦éå¤å¾ªç¯ã
         */
        this.repeat = (options.repeat !== undefined) ? options.repeat : true;

        /**
         * @member {boolean} [TimeControlBase.prototype.reverse=false]
         * @description æ¯å¦ååã
         */
        this.reverse = (options.reverse !== undefined) ? options.reverse : false;

        /**
         * @member {number} TimeControlBase.prototype.currentTime
         * @description è®°å½è¿æçæ¶é´ï¼ä¹å°±æ¯å½åå¸§è¿è¡å°çæ¶é´ã
         */
        this.currentTime = null;

        /**
         * @member {number} TimeControlBase.prototype.oldTime
         * @description è®°å½ä¸ä¸å¸§çæ¶é´ï¼ä¹å°±æ¯ä¹åè¿è¡å°çæ¶é´ã
         */
        this.oldTime = null;

        /**
         * @member {boolean} [TimeControlBase.prototype.running=false]
         * @description è®°å½å½åæ¯å¦å¤äºè¿è¡ä¸­ã
         */
        this.running = false;


        /**
         * @private
         * @member {Array.<string>} TimeControlBase.prototype.EVENT_TYPES
         * @description æ­¤ç±»æ¯æçäºä»¶ç±»åã
         *
         */
        this.EVENT_TYPES = ["start", "pause", "stop"];

        /**
         * @private
         * @member {Events} TimeControlBase.prototype.events
         * @description äºä»¶
         */
        me.events = new Events(this, null, this.EVENT_TYPES);

        me.speed = Number(me.speed);
        me.frequency = Number(me.frequency);
        me.startTime = Number(me.startTime);
        me.endTime = Number(me.endTime);

        me.startTime = Date.parse(new Date(me.startTime));
        me.endTime = Date.parse(new Date(me.endTime));

        //åå§åå½åæ¶é´
        me.currentTime = me.startTime;

        this.CLASS_NAME = "SuperMap.TimeControlBase";
    }


    /**
     * @function TimeControlBase.prototype.updateOptions
     * @description æ´æ°åæ°ã
     * @param {Object} options - è®¾ç½®åæ°å¾å¯éåæ°ãè®¾ç½®æ­¥é¿ï¼å·æ°é¢çãå¼å§ç»ææ¶é´ãæ¯å¦å¾ªç¯ãæ¯å¦ååã
     */
    updateOptions(options) {
        //è®¾ç½®æ­¥é¿ï¼å·æ°é¢çãå¼å§ç»ææ¶é´ãæ¯å¦å¾ªç¯ãæ¯å¦åå
        var me = this;
        options = options || {};
        if (options.speed && options.speed >= 0) {
            me.speed = options.speed;
            me.speed = Number(me.speed);
        }

        if (options.speed && options.frequency >= 0) {
            me.frequency = options.frequency;
            me.frequency = Number(me.frequency);
        }

        if (options.startTime && options.startTime != null) {
            me.startTime = options.startTime;
            me.startTime = Date.parse(new Date(me.startTime));
        }

        if (options.endTime && options.endTime != null && options.endTime >= me.startTime) {
            me.endTime = options.endTime;
            me.endTime = Date.parse(new Date(me.endTime));
        }

        if (options.repeat != null) {
            me.repeat = options.repeat;
        }

        if (options.reverse != null) {
            me.reverse = options.reverse;
        }
    }


    /**
     * @function TimeControlBase.prototype.start
     * @description å¼å§ã
     */
    start() {
        var me = this;

        if (!me.running) {
            me.running = true;
            me.tick();
            me.events.triggerEvent('start', me.currentTime);
        }
    }


    /**
     * @function TimeControlBase.prototype.pause
     * @description æåã
     */
    pause() {
        var me = this;
        me.running = false;
        me.events.triggerEvent('pause', me.currentTime);
    }


    /**
     * @function TimeControlBase.prototype.stop
     * @description åæ­¢ï¼åæ­¢åè¿åèµ·å§ç¶æã
     */
    stop() {
        var me = this;
        //åæ­¢æ¶ æ¶é´è®¾ç½®ä¸ºå¼å§æ¶é´
        me.currentTime = me.startTime;
        //å¦ææ­£å¨è¿è¡ï¼ä¿®æ¹ä¸ºåå§æ¶é´å³å¯ç»å¶ä¸å¸§
        if (me.running) {
            me.running = false;
        }
        me.events.triggerEvent('stop', me.currentTime);
    }


    /**
     * @function TimeControlBase.prototype.toggle
     * @description å¼å³åæ¢ï¼åæ¢çæ¯å¼å§åæåã
     */
    toggle() {
        var me = this;

        if (me.running) {
            me.pause();
        } else {
            me.start();
        }
    }


    /**
     * @function TimeControlBase.prototype.setSpeed
     * @description è®¾ç½®æ­¥é¿ã
     * @param {number} [speed=1] - æ­¥é¿ï¼å¿é¡»ä¸ºéè´æ°ã
     * @returns {boolean} true ä»£è¡¨è®¾ç½®æåï¼false è®¾ç½®å¤±è´¥ï¼speed å°äº 0 æ¶å¤±è´¥ï¼ã
     */
    setSpeed(speed) {
        var me = this;
        if (speed >= 0) {
            me.speed = speed;
            return true;
        }
        return false;
    }


    /**
     * @function TimeControlBase.prototype.getSpeed
     * @description è·åæ­¥é¿ã
     * @returns {number} è¿åå½åçæ­¥é¿
     */
    getSpeed() {
        return this.speed;
    }


    /**
     * @function TimeControlBase.prototype.setFrequency
     * @description è®¾ç½®å·æ°é¢çã
     * @param {number} [frequency=1000] - å·æ°é¢çï¼åä½ä¸º msã
     * @returns {boolean} true ä»£è¡¨è®¾ç½®æåï¼false è®¾ç½®å¤±è´¥ï¼frequency å°äº 0 æ¶å¤±è´¥ï¼ã
     */
    setFrequency(frequency) {
        var me = this;
        if (frequency >= 0) {
            me.frequency = frequency;
            return true;
        }
        return false;
    }


    /**
     * @function TimeControlBase.prototype.getFrequency
     * @description è·åå·æ°é¢çã
     * @returns {number} è¿åå½åçå·æ°é¢çã
     */
    getFrequency() {
        return this.frequency;
    }


    /**
     * @function TimeControlBase.prototype.setStartTime
     * @description è®¾ç½®èµ·å§æ¶é´ï¼è®¾ç½®å®æåå¦æå½åæ¶é´å°äºèµ·å§æ¶é´ï¼åä»èµ·å§æ¶é´å¼å§ã
     * @param {number} startTime - éè¦è®¾ç½®çèµ·å§æ¶é´ã
     * @returns {boolean} true ä»£è¡¨è®¾ç½®æåï¼false è®¾ç½®å¤±è´¥ï¼startTime å¤§äºç»ææ¶é´æ¶å¤±è´¥ï¼ã
     */
    setStartTime(startTime) {
        var me = this;
        startTime = Date.parse(new Date(startTime));
        //èµ·å§æ¶é´ä¸å¾å¤§äºç»ææ¶é´
        if (startTime > me.endTime) {
            return false;
        }
        me.startTime = startTime;
        //å¦æå½åæ¶é´å°äºäºèµ·å§æ¶é´ï¼åä»å½åèµ·å§æ¶é´å¼å§
        if (me.currentTime < me.startTime) {
            me.currentTime = me.startTime;
            me.tick();
        }
        return true;
    }


    /**
     * @function TimeControlBase.prototype.getStartTime
     * @description è·åèµ·å§æ¶é´ã
     * @returns {number} è¿åå½åçèµ·å§æ¶é´ã
     */
    getStartTime() {
        return this.startTime;
    }


    /**
     * @function TimeControlBase.prototype.setEndTime
     * @description è®¾ç½®ç»ææ¶é´ï¼è®¾ç½®å®æåå¦æå½åæ¶é´å¤§äºç»æï¼åä»èµ·å§æ¶é´å¼å§ã
     * @param {number} endTime - éè¦è®¾ç½®çç»ææ¶é´ã
     * @returns {boolean} true ä»£è¡¨è®¾ç½®æåï¼false è®¾ç½®å¤±è´¥ï¼endTime å°äºå¼å§æ¶é´æ¶å¤±è´¥ï¼ã
     */
    setEndTime(endTime) {
        var me = this;
        me.endTime = Date.parse(new Date(me.endTime));
        //ç»ææ¶é´ä¸å¾å°äºå¼å§æ¶é´
        if (endTime < me.startTime) {
            return false;
        }
        me.endTime = endTime;
        //å¦æå½åæ¶é´å¤§äºäºç»ææ¶é´ï¼åä»èµ·å§æ¶é´å¼å§
        if (me.currentTime >= me.endTime) {
            me.currentTime = me.startTime;
            me.tick();
        }
        return true;
    }


    /**
     * @function TimeControlBase.prototype.getEndTime
     * @description è·åç»ææ¶é´ã
     * @returns {number} è¿åå½åçç»ææ¶é´ã
     */
    getEndTime() {
        return this.endTime;
    }


    /**
     * @function TimeControlBase.prototype.setCurrentTime
     * @description è®¾ç½®å½åæ¶é´ã
     * @param {number} currentTime - éè¦è®¾ç½®çå½åæ¶é´ã
     * @returns {boolean} true ä»£è¡¨è®¾ç½®æåï¼false è®¾ç½®å¤±è´¥ã
     */
    setCurrentTime(currentTime) {
        var me = this;
        me.currentTime = Date.parse(new Date(me.currentTime));
        //ç»ææ¶é´ä¸å¾å°äºå¼å§æ¶é´
        if (currentTime >= me.startTime && currentTime <= me.endTime) {
            me.currentTime = currentTime;
            me.startTime = me.currentTime;
            me.tick();
            return true;
        }
        return false;
    }


    /**
     * @function TimeControlBase.prototype.getCurrentTime
     * @description è·åå½åæ¶é´ã
     * @returns {number} è¿åå½åæ¶é´ã
     */
    getCurrentTime() {
        return this.currentTime;
    }


    /**
     * @function TimeControlBase.prototype.setRepeat
     * @description è®¾ç½®æ¯å¦éå¤å¾ªç¯ã
     * @param {boolean} [repeat=true] - æ¯å¦éå¤å¾ªç¯ã
     */
    setRepeat(repeat) {
        this.repeat = repeat;
    }


    /**
     * @function TimeControlBase.prototype.getRepeat
     * @description è·åæ¯å¦éå¤å¾ªç¯ï¼é»è®¤æ¯ trueã
     * @returns {boolean} è¿åæ¯å¦éå¤å¾ªç¯ã
     */
    getRepeat() {
        return this.repeat;
    }


    /**
     * @function TimeControlBase.prototype.setReverse
     * @description è®¾ç½®æ¯å¦ååã
     * @param {boolean} [reverse=false] - æ¯å¦ååã
     */
    setReverse(reverse) {
        this.reverse = reverse;
    }


    /**
     * @function TimeControlBase.prototype.getReverse
     * @description è·åæ¯å¦ååï¼é»è®¤æ¯falseã
     * @returns {boolean} è¿åæ¯å¦ååã
     */
    getReverse() {
        return this.reverse;
    }


    /**
     * @function TimeControlBase.prototype.getRunning
     * @description è·åè¿è¡ç¶æã
     * @returns {boolean} true ä»£è¡¨æ­£å¨è¿è¡ï¼false åè¡¨æ²¡æè¿è¡ã
     */
    getRunning() {
        return this.running;
    }


    /**
     * @function TimeControlBase.prototype.destroy
     * @description éæ¯ Animator å¯¹è±¡ï¼éæ¾èµæºã
     */
    destroy() {
        var me = this;
        me.speed = null;
        me.frequency = null;
        me.startTime = null;
        me.endTime = null;
        me.currentTime = null;
        me.repeat = null;
        me.running = false;
        me.reverse = null;
    }


    tick() {
        //TODO æ¯æ¬¡å·æ°æ§è¡çæä½ãå­ç±»å®ç°
    }

}


;// CONCATENATED MODULE: ./src/common/control/TimeFlowControl.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class TimeFlowControl
 * @deprecatedclass SuperMap.TimeFlowControl
 * @category  Control
 * @classdesc æ¶é´ç®¡çç±»ãæ­¤ç±»åªè´è´£æ¶é´ä¸çæ§å¶ï¼å·ä½æ§è¡çæä½éè¦ç¨æ·å¨åå§åæ¶çåè°å½æ°åé¨è¿è¡å®ç°ã
 * å¦è®¾ç½®èµ·å§æ¶é´ä¸º 1000ï¼ç»ææ¶é´æ¯ 2000ï¼æ­¥é¿è®¾ç½®ä¸º 1ï¼
 * é£ä¹è¡¨ç¤ºæç§æ¯æ¬¡1å¹´ï¼å¯ä»¥éè¿ setSpeed è¿è¡ä¿®æ¹ï¼çååä»å¬å 1000 å¹´å¼å§å°å¬å 2000 å¹´ä¸ºæ­¢ï¼é»è®¤æ¯ 1 ç§ä¼ 1 æ¬¡ï¼éè¿ setFrequency ä¿®æ¹ï¼
 * @extends {TimeControlBase}
 * @param {function} callback - æ¯æ¬¡å·æ°åè°å½æ°ãå·ä½çææéè¦ç¨æ·å¨æ­¤åè°å½æ°éé¢å®ç°ã
 * @param {Object} options - å¯éåæ°ã
 * @param {number} [options.speed=1] - æ­¥é¿ï¼åä½ msï¼ãä¸è½å°äº 0ï¼ï¼æ¯æ¬¡å·æ°çæ°æ®ä¹é´çé´éä¸º 1msï¼ã
 * @param {number} [options.frequency=1000] - å·æ°é¢çï¼åä½ msï¼ã
 * @param {number} [options.startTime=0] - èµ·å§æ¶é´ï¼å¿é¡»ä¸ºæ°å­ï¼ä¸å°äºç­äº endTimeãå¦æä¸è®¾ç½®ï¼åå§åæ¶ä¸º 0ï¼å»ºè®®è®¾ç½®ã
 * @param {number} [options.endTime] - ç»ææ¶é´ï¼å¿é¡»ä¸ºæ°å­ï¼ä¸å¤§äºç­äº startTimeãå¦æä¸è®¾ç½®ï¼åå§åæ¶ä½¿ç¨ new Date() ä»¥å½åæ¶é´è¿è¡è®¾ç½®ï¼å»ºè®®è®¾ç½®ã
 * @param {boolean} [options.repeat=true] - æ¯å¦éå¤å¾ªç¯ã
 * @param {boolean} [options.reverse=false] - æ¯å¦ååã
 * @usage
 */
class TimeFlowControl extends TimeControlBase {


    constructor(callback, options) {
        super(options);
        var me = this;
        /**
         * @member TimeFlowControl.prototype.callback -{function}
         * @description æ¯æ¬¡å·æ°æ§è¡çåè°å½æ°ã
         */
        me.callback = callback;

        //åè®©IEä¸æ¯æbindæ¹æ³
        if (!Function.prototype.bind) {
            Function.prototype.bind = function (oThis) {
                if (typeof this !== "function") {
                    throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");
                }
                var aArgs = Array.prototype.slice.call(arguments, 1),
                    fToBind = this,
                    fNOP = function () {
                        //empty Function
                    },
                    fBound = function () {
                        return fToBind.apply(this instanceof fNOP && oThis
                            ? this
                            : oThis,
                            aArgs.concat(Array.prototype.slice.call(arguments)));
                    };
                fNOP.prototype = this.prototype;
                fBound.prototype = new fNOP();
                return fBound;
            };
        }
        //ä¿è¯ this.tick çä¸ä¸æè¿æ¯ TimeControl è¿ä¸ªå¯¹è±¡
        me.update = me.update.bind(me);

        me.oldTime = me.currentTime;

        me.CLASS_NAME = "SuperMap.TimeFlowControl";
    }


    /**
     * @function TimeFlowControl.prototype.updateOptions
     * @override
     */
    updateOptions(options) {
        options = options || {};
        super.updateOptions(options);
    }


    /**
     * @function TimeFlowControl.prototype.start
     * @override
     */
    start() {
        var me = this;
        if (me.running) {
            return;
        }
        me.running = true;
        if (me.reverse) {
            if (me.currentTime === me.startTime) {
                me.oldTime = me.endTime;
                me.currentTime = me.oldTime;
            }
        } else {
            if (me.oldTime === me.endTime) {
                me.currentTime = me.startTime;
                me.oldTime = me.currentTime;
            }
        }
        me.tick();
    }


    /**
     * @function TimeFlowControl.prototype.stop
     * @override
     */
    stop() {
        super.stop();
        var me = this;
        me.oldTime = me.currentTime;

        if (me.running) {
            me.running = false;
        }
        //æ¸é¤å®æ¶tick
        me.intervalId && window.clearTimeout(me.intervalId);
    }


    /**
     * @function TimeFlowControl.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
        var me = this;
        me.oldTime = null;
        me.callback = null;
    }


    /**
     * @function TimeFlowControl.prototype.tick
     * @description å®æ¶å·æ°ã
     */
    tick() {
        var me = this;
        me.intervalId && window.clearInterval(me.intervalId);
        me.intervalId = null;
        me.update();
        me.intervalId = window.setInterval(me.update, me.frequency);
    }

    /**
     * @function TimeFlowControl.prototype.update
     * @description æ´æ°æ§ä»¶ã
     */
    update() {
        var me = this;

        //å¤å®æ¯å¦è¿éè¦ç»§ç»­
        if (!me.running) {
            return;
        }
        //è°ç¨åè°å½æ°
        me.callback && me.callback(me.currentTime);    //destroyä¹åcallbackå°±ä¸ºç©ºï¼æä»¥éè¦å¤å®ä¸ä¸

        if (!me.reverse) {
            //å¦æç¸ç­ï¼åä»£è¡¨ä¸ä¸å¸§å·²ç»è¿è¡å°äºæåï¼ä¸ä¸å¸§è¿è¡åå§åçç¶æ
            if (me.currentTime === me.endTime) {
                //ä¸å¾ªç¯æ¶
                if (!me.repeat) {
                    me.running = false;
                    me.stop();
                    return null;
                }
                me.stop();
                me.currentTime = me.startTime;
                me.oldTime = me.currentTime;
                me.start();
            } else {//å¦åæ¶é´éå¢
                me.oldTime = me.currentTime;
                me.currentTime += me.speed;
            }

            if (me.currentTime >= me.endTime) {
                me.currentTime = me.endTime;
            }

        } else {
            //å¦æç¸ç­ï¼åä»£è¡¨ä¸ä¸å¸§å·²ç»è¿è¡å°äºæåï¼ä¸ä¸å¸§è¿è¡ç»æçç¶æ
            if (me.currentTime === me.startTime) {
                //ä¸å¾ªç¯æ¶
                if (!me.repeat) {
                    me.running = false;
                    return null;
                }

                me.oldTime = me.endTime;
                me.currentTime = me.oldTime;
            } else {//å¦åæ¶é´éå
                me.currentTime = me.oldTime;
                me.oldTime -= me.speed;
            }

            if (me.oldTime <= me.startTime) {
                me.oldTime = me.startTime;
            }
        }

    }


}


;// CONCATENATED MODULE: ./src/common/control/index.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/








// EXTERNAL MODULE: ./node_modules/promise-polyfill/dist/polyfill.js
var polyfill = __webpack_require__(107);
// EXTERNAL MODULE: ./node_modules/fetch-ie8/fetch.js
var fetch = __webpack_require__(693);
// EXTERNAL MODULE: ./node_modules/fetch-jsonp/build/fetch-jsonp.js
var fetch_jsonp = __webpack_require__(144);
var fetch_jsonp_default = /*#__PURE__*/__webpack_require__.n(fetch_jsonp);
;// CONCATENATED MODULE: ./src/common/util/FetchRequest.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





let FetchRequest_fetch = window.fetch;
var setFetch = function (newFetch) {
    FetchRequest_fetch = newFetch;
}
var RequestJSONPPromise = {
  limitLength: 1500,
  queryKeys: [],
  queryValues: [],
  supermap_callbacks: {},
  addQueryStrings: function (values) {
      var me = this;
      for (var key in values) {
          me.queryKeys.push(key);
          if (typeof values[key] !== 'string') {
              values[key] = Util.toJSON(values[key]);
          }
          var tempValue = encodeURIComponent(values[key]);
          me.queryValues.push(tempValue);
      }
  },
  issue: function (config) {
      var me = this,
          uid = me.getUid(),
          url = config.url,
          splitQuestUrl = [];
      var p = new Promise(function (resolve) {
          me.supermap_callbacks[uid] = function (response) {
              delete me.supermap_callbacks[uid];
              resolve(response);
          };
      });

      // me.addQueryStrings({
      //     callback: "RequestJSONPPromise.supermap_callbacks[" + uid + "]"
      // });
      var sectionURL = url,
          keysCount = 0; //æ­¤æ¬¡sectionURLä¸­æå¤å°ä¸ªkey
      var length = me.queryKeys ? me.queryKeys.length : 0;
      for (var i = 0; i < length; i++) {
          if (sectionURL.length + me.queryKeys[i].length + 2 >= me.limitLength) {
              //+2 for ("&"or"?")and"="
              if (keysCount == 0) {
                  return false;
              }
              splitQuestUrl.push(sectionURL);
              sectionURL = url;
              keysCount = 0;
              i--;
          } else {
              if (sectionURL.length + me.queryKeys[i].length + 2 + me.queryValues[i].length > me.limitLength) {
                  var leftValue = me.queryValues[i];
                  while (leftValue.length > 0) {
                      var leftLength = me.limitLength - sectionURL.length - me.queryKeys[i].length - 2; //+2 for ("&"or"?")and"="
                      if (sectionURL.indexOf('?') > -1) {
                          sectionURL += '&';
                      } else {
                          sectionURL += '?';
                      }
                      var tempLeftValue = leftValue.substring(0, leftLength);
                      //é¿å æªæ­sectionURLæ¶ï¼å°ç±»ä¼¼äº%22è¿æ ·çç¬¦å·æªæä¸¤åï¼ä»èå¯¼è´æå¡ç«¯ç»è£sectionURLæ¶åçéè¯¯
                      if (tempLeftValue.substring(leftLength - 1, leftLength) === '%') {
                          leftLength -= 1;
                          tempLeftValue = leftValue.substring(0, leftLength);
                      } else if (tempLeftValue.substring(leftLength - 2, leftLength - 1) === '%') {
                          leftLength -= 2;
                          tempLeftValue = leftValue.substring(0, leftLength);
                      }

                      sectionURL += me.queryKeys[i] + '=' + tempLeftValue;
                      leftValue = leftValue.substring(leftLength);
                      if (tempLeftValue.length > 0) {
                          splitQuestUrl.push(sectionURL);
                          sectionURL = url;
                          keysCount = 0;
                      }
                  }
              } else {
                  keysCount++;
                  if (sectionURL.indexOf('?') > -1) {
                      sectionURL += '&';
                  } else {
                      sectionURL += '?';
                  }
                  sectionURL += me.queryKeys[i] + '=' + me.queryValues[i];
              }
          }
      }
      splitQuestUrl.push(sectionURL);
      me.send(
          splitQuestUrl,
          'RequestJSONPPromise.supermap_callbacks[' + uid + ']',
          config && config.proxy
      );
      return p;
  },

  getUid: function () {
      var uid = new Date().getTime(),
          random = Math.floor(Math.random() * 1e17);
      return uid * 1000 + random;
  },

  send: function (splitQuestUrl, callback, proxy) {
      var len = splitQuestUrl.length;
      if (len > 0) {
          var jsonpUserID = new Date().getTime();
          for (var i = 0; i < len; i++) {
              var url = splitQuestUrl[i];
              if (url.indexOf('?') > -1) {
                  url += '&';
              } else {
                  url += '?';
              }
              url += 'sectionCount=' + len;
              url += '&sectionIndex=' + i;
              url += '&jsonpUserID=' + jsonpUserID;
              if (proxy) {
                  url = decodeURIComponent(url);
                  url = proxy + encodeURIComponent(url);
              }
              fetch_jsonp_default()(url, {
                  jsonpCallbackFunction: callback,
                  timeout: 30000
              });
          }
      }
  },

  GET: function (config) {
      var me = this;
      me.queryKeys.length = 0;
      me.queryValues.length = 0;
      me.addQueryStrings(config.params);
      return me.issue(config);
  },

  POST: function (config) {
      var me = this;
      me.queryKeys.length = 0;
      me.queryValues.length = 0;
      me.addQueryStrings({
          requestEntity: config.data
      });
      return me.issue(config);
  },

  PUT: function (config) {
      var me = this;
      me.queryKeys.length = 0;
      me.queryValues.length = 0;
      me.addQueryStrings({
          requestEntity: config.data
      });
      return me.issue(config);
  },
  DELETE: function (config) {
      var me = this;
      me.queryKeys.length = 0;
      me.queryValues.length = 0;
      me.addQueryStrings({
          requestEntity: config.data
      });
      return me.issue(config);
  }
};

var CORS;
var RequestTimeout;
/**
 * @function setCORS
 * @description è®¾ç½®æ¯å¦åè®¸è·¨åè¯·æ±ï¼å¨å±éç½®ï¼ä¼åçº§ä½äº service ä¸ç crossOring åæ°ã
 * @category BaseTypes Util
 * @param {boolean} cors - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   {namespace}.setCORS(cors);
 *
 *   // å¼ç¨çåæ³
 *   SuperMap.setCORS(cors);
 *
 * </script>
 *
 * // ES6 Import
 * import { setCORS } from '{npm}';
 *
 * setCORS(cors);
 * ```
 */
var setCORS = function (cors) {
    CORS = cors;
}
/**
 * @function isCORS
 * @description æ¯æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @category BaseTypes Util
 * @returns {boolean} æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.isCORS();
 *
 *   // å¼ç¨çåæ³
 *   const result = SuperMap.isCORS();
 *
 * </script>
 *
 * // ES6 Import
 * import { isCORS } from '{npm}';
 *
 * const result = isCORS();
 * ```
 */
var isCORS = function () {
    if (CORS != undefined) {
        return CORS;
    }
    return window.XMLHttpRequest && 'withCredentials' in new window.XMLHttpRequest();
}
/**
 * @function setRequestTimeout
 * @description è®¾ç½®è¯·æ±è¶æ¶æ¶é´ã
 * @param {number} [timeout=45] - è¯·æ±è¶æ¶æ¶é´ï¼åä½ç§ã
 * @private
 * @usage
 * ```
 * // æµè§å¨
  <script type="text/javascript" src="{cdn}"></script>
  <script>
    {namespace}.setRequestTimeout(timeout);

    // å¼ç¨çåæ³
    SuperMap.setRequestTimeout(timeout);

  </script>

  // ES6 Import
  import { setRequestTimeout } from '{npm}';

  setRequestTimeout(timeout);
 * ```
 */
var setRequestTimeout = function (timeout) {
    return RequestTimeout = timeout;
}
/**
 * @function getRequestTimeout
 * @description è·åè¯·æ±è¶æ¶æ¶é´ã
 * @returns {number} è¯·æ±è¶æ¶æ¶é´ã
 * @private
 * @usage
 * ```
 * // æµè§å¨
  <script type="text/javascript" src="{cdn}"></script>
  <script>
    {namespace}.getRequestTimeout();

    // å¼ç¨çåæ³
    SuperMap.getRequestTimeout();

  </script>

  // ES6 Import
  import { getRequestTimeout } from '{npm}';

  getRequestTimeout();
 * ```
 */
var getRequestTimeout = function () {
    return RequestTimeout || 45000;
}

/**
 * @name FetchRequest
 * @namespace
 * @category BaseTypes Util
 * @description è·åè¯·æ±ã
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.FetchRequest.commit(method, url, params, options);
 *
 * </script>
 *
 * // ES6 Import
 * import { FetchRequest } from '{npm}';
 *
 * const result = FetchRequest.commit(method, url, params, options);
 *
 * ```
 */
var FetchRequest = {
    /**
     * @function FetchRequest.commit
     * @description commit è¯·æ±ã
     * @param {string} method - è¯·æ±æ¹æ³ã
     * @param {string} url - è¯·æ±å°åã
     * @param {string} params - è¯·æ±åæ°ã
     * @param {Object} options - è¯·æ±çéç½®å±æ§ã
     * @returns {Promise} Promise å¯¹è±¡ã
     */
    commit: function (method, url, params, options) {
        method = method ? method.toUpperCase() : method;
        switch (method) {
            case 'GET':
                return this.get(url, params, options);
            case 'POST':
                return this.post(url, params, options);
            case 'PUT':
                return this.put(url, params, options);
            case 'DELETE':
                return this.delete(url, params, options);
            default:
                return this.get(url, params, options);
        }
    },
    /**
     * @function FetchRequest.supportDirectRequest
     * @description supportDirectRequest è¯·æ±ã
     * @param {string} url - è¯·æ±å°åã
     * @param {Object} options - è¯·æ±çéç½®å±æ§ã
     * @returns {boolean} æ¯å¦åè®¸è·¨åè¯·æ±ã
     */
    supportDirectRequest: function (url, options) {
        if (Util.isInTheSameDomain(url)) {
            return true;
        }
        if (options.crossOrigin != undefined) {
            return options.crossOrigin;
        } else {
            return isCORS() || options.proxy;
        }
    },
    /**
     * @function FetchRequest.get
     * @description get è¯·æ±ã
     * @param {string} url - è¯·æ±å°åã
     * @param {string} params - è¯·æ±åæ°ã
     * @param {Object} options - è¯·æ±çéç½®å±æ§ã
     * @returns {Promise} Promise å¯¹è±¡ã
     */
    get: function (url, params, options) {
        options = options || {};
        var type = 'GET';
        url = Util.urlAppend(url, this._getParameterString(params || {}));
        url = this._processUrl(url, options);
        if (!this.supportDirectRequest(url, options)) {
            url = url.replace('.json', '.jsonp');
            var config = {
                url: url,
                data: params
            };
            return RequestJSONPPromise.GET(config);
        }
        if (!this.urlIsLong(url)) {
            return this._fetch(url, params, options, type);
        } else {
            return this._postSimulatie(type, url.substring(0, url.indexOf('?')), Util.getParameters(url), options);
        }
    },
    /**
     * @function FetchRequest.delete
     * @description delete è¯·æ±ã
     * @param {string} url - è¯·æ±å°åã
     * @param {string} params - è¯·æ±åæ°ã
     * @param {Object} options -è¯·æ±çéç½®å±æ§ã
     * @returns {Promise} Promise å¯¹è±¡ã
     */
    delete: function (url, params, options) {
        options = options || {};
        var type = 'DELETE';
        url = Util.urlAppend(url, this._getParameterString(params || {}));
        url = this._processUrl(url, options);
        if (!this.supportDirectRequest(url, options)) {
            url = url.replace('.json', '.jsonp');
            var config = {
                url: url += "&_method=DELETE",
                data: params
            };
            return RequestJSONPPromise.DELETE(config);
        }
        if (this.urlIsLong(url)) {
            return this._postSimulatie(type, url.substring(0, url.indexOf('?')), Util.getParameters(url), options);
        }
        return this._fetch(url, params, options, type);
    },
    /**
     * @function FetchRequest.post
     * @description post è¯·æ±ã
     * @param {string} url - è¯·æ±å°åã
     * @param {string} params - è¯·æ±åæ°ã
     * @param {Object} options - è¯·æ±çéç½®å±æ§ã
     * @returns {Promise} Promise å¯¹è±¡ã
     */
    post: function (url, params, options) {
        options = options || {};
        if (!this.supportDirectRequest(url, options)) {
            url = url.replace('.json', '.jsonp');
            var config = {
                url: url += "&_method=POST",
                data: params
            };
            return RequestJSONPPromise.POST(config);
        }
        return this._fetch(this._processUrl(url, options), params, options, 'POST');
    },
    /**
     * @function FetchRequest.put
     * @description put è¯·æ±ã
     * @param {string} url - è¯·æ±å°åã
     * @param {string} params - è¯·æ±åæ°ã
     * @param {Object} options - è¯·æ±çéç½®å±æ§ã
     * @returns {Promise} Promise å¯¹è±¡ã
     */
    put: function (url, params, options) {
        options = options || {};
        url = this._processUrl(url, options);
        if (!this.supportDirectRequest(url, options)) {
            url = url.replace('.json', '.jsonp');
            var config = {
                url: url += "&_method=PUT",
                data: params
            };
            return RequestJSONPPromise.PUT(config);
        }
        return this._fetch(url, params, options, 'PUT');
    },
    /**
     * @function FetchRequest.urlIsLong
     * @description url çå­èé¿åº¦æ¯å¦å¤ªé¿ã
     * @param {string} url - è¯·æ±å°åã
     * @returns {boolean} url çå­èé¿åº¦æ¯å¦å¤ªé¿ã
     */
    urlIsLong: function (url) {
        //å½åurlçå­èé¿åº¦ã
        var totalLength = 0,
            charCode = null;
        for (var i = 0, len = url.length; i < len; i++) {
            //è½¬åä¸ºUnicodeç¼ç 
            charCode = url.charCodeAt(i);
            if (charCode < 0x007f) {
                totalLength++;
            } else if ((0x0080 <= charCode) && (charCode <= 0x07ff)) {
                totalLength += 2;
            } else if ((0x0800 <= charCode) && (charCode <= 0xffff)) {
                totalLength += 3;
            }
        }
        return totalLength < 2000 ? false : true;
    },
    _postSimulatie: function (type, url, params, options) {
        var separator = url.indexOf('?') > -1 ? '&' : '?';
        url += separator + '_method=' + type;
        if (typeof params !== 'string') {
            params = JSON.stringify(params);
        }
        return this.post(url, params, options);
    },

    _processUrl: function (url, options) {
        if (this._isMVTRequest(url)) {
            return url;
        }

        if (url.indexOf('.json') === -1 && !options.withoutFormatSuffix) {
            if (url.indexOf('?') < 0) {
                url += '.json';
            } else {
                var urlArrays = url.split('?');
                if (urlArrays.length === 2) {
                    url = urlArrays[0] + '.json?' + urlArrays[1];
                }
            }
        }
        if (options && options.proxy) {
            if (typeof options.proxy === 'function') {
                url = options.proxy(url);
            } else {
                url = decodeURIComponent(url);
                url = options.proxy + encodeURIComponent(url);
            }
        }
        return url;
    },

    _fetch: function (url, params, options, type) {
        options = options || {};
        options.headers = options.headers || {};
        if (!options.headers['Content-Type'] && !FormData.prototype.isPrototypeOf(params)) {
            options.headers['Content-Type'] = 'application/x-www-form-urlencoded;charset=UTF-8';
        }
        if (options.timeout) {
            return this._timeout(
                options.timeout,
                FetchRequest_fetch(url, {
                    method: type,
                    headers: options.headers,
                    body: type === 'PUT' || type === 'POST' ? params : undefined,
                    credentials: this._getWithCredentials(options),
                    mode: 'cors',
                    timeout: getRequestTimeout()
                }).then(function (response) {
                    return response;
                })
            );
        }
        return FetchRequest_fetch(url, {
            method: type,
            body: type === 'PUT' || type === 'POST' ? params : undefined,
            headers: options.headers,
            credentials: this._getWithCredentials(options),
            mode: 'cors',
            timeout: getRequestTimeout()
        }).then(function (response) {
            return response;
        });
    },

    _getWithCredentials: function (options) {
        if (options.withCredentials === true) {
            return 'include';
        }
        if (options.withCredentials === false) {
            return 'omit';
        }
        return 'same-origin';
    },

    _fetchJsonp: function (url, options) {
        options = options || {};
        return fetch_jsonp_default()(url, {
            method: 'GET',
            timeout: options.timeout
        }).then(function (response) {
            return response;
        });
    },

    _timeout: function (seconds, promise) {
        return new Promise(function (resolve, reject) {
            setTimeout(function () {
                reject(new Error('timeout'));
            }, seconds);
            promise.then(resolve, reject);
        });
    },

    _getParameterString: function (params) {
        var paramsArray = [];
        for (var key in params) {
            var value = params[key];
            if (value != null && typeof value !== 'function') {
                var encodedValue;
                if (Array.isArray(value) || value.toString() === '[object Object]') {
                    encodedValue = encodeURIComponent(JSON.stringify(value));
                } else {
                    encodedValue = encodeURIComponent(value);
                }
                paramsArray.push(encodeURIComponent(key) + '=' + encodedValue);
            }
        }
        return paramsArray.join('&');
    },

    _isMVTRequest: function (url) {
        return url.indexOf('.mvt') > -1 || url.indexOf('.pbf') > -1;
    }
}

;// CONCATENATED MODULE: ./src/common/security/SecurityManager.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class SecurityManager
 * @deprecatedclass SuperMap.SecurityManager
 * @category Security
 * @classdesc å®å¨ç®¡çä¸­å¿ï¼æä¾ iServer,iPortal,Online ç»ä¸æéè®¤è¯ç®¡çã
 *  > ä½¿ç¨è¯´æï¼
 *  > åå»ºä»»ä½ä¸ä¸ªæå¡ä¹åè°ç¨ {@link SecurityManager.registerToken}æ
 *  > {@link SecurityManager.registerKey}æ³¨åå­æ®ã
 *  > åéè¯·æ±æ¶æ ¹æ® url æèæå¡ id è·åç¸åºç key æè token å¹¶èªå¨æ·»å å°æå¡å°åä¸­ã
 * @usage
 */
class SecurityManager {
    /**
     * @description ä»æå¡å¨è·åä¸ä¸ªtoken,å¨æ­¤ä¹åè¦æ³¨åæå¡å¨ä¿¡æ¯ã
     * @function SecurityManager.generateToken
     * @param {string} url - æå¡å¨åå+ç«¯å£ï¼å¦ï¼http://localhost:8092ã
     * @param {TokenServiceParameter} tokenParam - token ç³è¯·åæ°ã
     * @returns {Promise} åå« token ä¿¡æ¯ç Promise å¯¹è±¡ã
     */

    static generateToken(url, tokenParam) {
        var serverInfo = this.servers[url];
        if (!serverInfo) {
            return;
        }
        return FetchRequest.post(serverInfo.tokenServiceUrl, JSON.stringify(tokenParam.toJSON())).then(function(
            response
        ) {
            return response.text();
        });
    }

    /**
     * @description æ³¨åå®å¨æå¡å¨ç¸å³ä¿¡æ¯ã
     * @function SecurityManager.registerServers
     * @param {ServerInfo} serverInfos - æå¡å¨ä¿¡æ¯ã
     */
    static registerServers(serverInfos) {
        this.servers = this.servers || {};
        if (!Util.isArray(serverInfos)) {
            serverInfos = [serverInfos];
        }
        for (var i = 0; i < serverInfos.length; i++) {
            var serverInfo = serverInfos[i];
            this.servers[serverInfo.server] = serverInfo;
        }
    }

    /**
     * @description æå¡è¯·æ±é½ä¼èªå¨å¸¦ä¸è¿ä¸ª tokenã
     * @function SecurityManager.registerToken
     * @param {string} url -æå¡å¨åå+ç«¯å£ï¼å¦http://localhost:8090ã
     * @param {string} token - token
     */
    static registerToken(url, token) {
        this.tokens = this.tokens || {};
        if (!url || !token) {
            return;
        }
        var domain = this._getTokenStorageKey(url);
        this.tokens[domain] = token;
    }

    /**
     * @description æ³¨å key,ids ä¸ºæ°ç»(å­å¨ä¸ä¸ª key å¯¹åºå¤ä¸ªæå¡)ã
     * @function SecurityManager.registerKey
     * @param {Array} ids - å¯ä»¥æ¯æå¡ id æ°ç»æè url å°åæ°ç»æè webAPI ç±»åæ°ç»ã
     * @param {string} key - key
     */
    static registerKey(ids, key) {
        this.keys = this.keys || {};
        if (!ids || ids.length < 1 || !key) {
            return;
        }

        ids = Util.isArray(ids) ? ids : [ids];
        for (var i = 0; i < ids.length; i++) {
            var id = this._getUrlRestString(ids[0]) || ids[0];
            this.keys[id] = key;
        }
    }

    /**
     * @description è·åæå¡å¨ä¿¡æ¯ã
     * @function SecurityManager.getServerInfo
     * @param {string} url - æå¡å¨åå+ç«¯å£ï¼å¦ï¼http://localhost:8092ã
     * @returns {ServerInfo} æå¡å¨ä¿¡æ¯ã
     */
    static getServerInfo(url) {
        this.servers = this.servers || {};
        return this.servers[url];
    }

    /**
     * @description æ ¹æ® Url è·åtokenã
     * @function SecurityManager.getToken
     * @param {string} url - æå¡å¨åå+ç«¯å£ï¼å¦ï¼http://localhost:8092ã
     * @returns {string} token
     */
    static getToken(url) {
        if (!url) {
            return;
        }
        this.tokens = this.tokens || {};
        var domain = this._getTokenStorageKey(url);
        return this.tokens[domain];
    }

    /**
     * @description æ ¹æ® Url è·å keyã
     * @function SecurityManager.getKey
     * @param {string} id - id
     * @returns {string} key
     */
    static getKey(id) {
        this.keys = this.keys || {};
        var key = this._getUrlRestString(id) || id;
        return this.keys[key];
    }

    /**
     * @description iServer ç»å½éªè¯ã
     * @function SecurityManager.loginiServer
     * @param {string} url - iServer é¦é¡µå°åï¼å¦ï¼http://localhost:8090/iserverã
     * @param {string} username - ç¨æ·åã
     * @param {string} password - å¯ç ã
     * @param {boolean} [rememberme=false] - æ¯å¦è®°ä½ã
     * @returns {Promise} åå« iServer ç»å½è¯·æ±ç»æç Promise å¯¹è±¡ã
     */
    static loginiServer(url, username, password, rememberme) {
        url = Util.urlPathAppend(url, 'services/security/login');
        var loginInfo = {
            username: username && username.toString(),
            password: password && password.toString(),
            rememberme: rememberme
        };
        loginInfo = JSON.stringify(loginInfo);
        var requestOptions = {
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8'
            }
        };
        return FetchRequest.post(url, loginInfo, requestOptions).then(function(response) {
            return response.json();
        });
    }

    /**
     * @description iServerç»åºã
     * @function SecurityManager.logoutiServer
     * @param {string} url - iServer é¦é¡µå°å,å¦ï¼http://localhost:8090/iserverã
     * @returns {Promise} æ¯å¦ç»åºæåã
     */
    static logoutiServer(url) {
        url = Util.urlPathAppend(url, 'services/security/logout');
        var requestOptions = {
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8'
            },
            withoutFormatSuffix: true
        };
        return FetchRequest.get(url, '', requestOptions)
            .then(function() {
                return true;
            })
            .catch(function() {
                return false;
            });
    }

    /**
     * @description Online ç»å½éªè¯ã
     * @function SecurityManager.loginOnline
     * @param {string} callbackLocation - è·³è½¬ä½ç½®ã
     * @param {boolean} [newTab=true] - æ¯å¦æ°çªå£æå¼ã
     */
    static loginOnline(callbackLocation, newTab) {
        var loginUrl = SecurityManager.SSO + '/login?service=' + callbackLocation;
        this._open(loginUrl, newTab);
    }

    /**
     * @description iPortalç»å½éªè¯ã
     * @function SecurityManager.loginiPortal
     * @param {string} url - iportal é¦é¡µå°å,å¦ï¼http://localhost:8092/iportal.
     * @param {string} username - ç¨æ·åã
     * @param {string} password - å¯ç ã
     * @returns {Promise} åå« iPortal ç»å½è¯·æ±ç»æç Promise å¯¹è±¡ã
     */
    static loginiPortal(url, username, password) {
        url = Util.urlPathAppend(url, 'web/login');
        var loginInfo = {
            username: username && username.toString(),
            password: password && password.toString()
        };
        loginInfo = JSON.stringify(loginInfo);
        var requestOptions = {
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8'
            },
            withCredentials: true
        };
        return FetchRequest.post(url, loginInfo, requestOptions).then(function(response) {
            return response.json();
        });
    }

    /**
     * @description iPortal ç»åºã
     * @function SecurityManager.logoutiPortal
     * @param {string} url - iportal é¦é¡µå°å,å¦ï¼http://localhost:8092/iportal.
     * @returns {Promise} å¦æç»åºæåï¼è¿å true;å¦åè¿å falseã
     */
    static logoutiPortal(url) {
        url = Util.urlPathAppend(url, 'services/security/logout');
        var requestOptions = {
            headers: {
                'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8'
            },
            withCredentials: true,
            withoutFormatSuffix: true
        };
        return FetchRequest.get(url, '', requestOptions)
            .then(function() {
                return true;
            })
            .catch(function() {
                return false;
            });
    }

    /**
     * @description iManager ç»å½éªè¯ã
     * @function SecurityManager.loginManager
     * @param {string} url - iManager å°åãå°ååæ°ä¸º iManager é¦é¡µå°åï¼å¦ï¼ http://localhost:8390/imanagerã
     * @param {Object} [loginInfoParams] - iManager ç»å½åæ°ã
     * @param {string} loginInfoParams.userName - ç¨æ·åã
     * @param {string} loginInfoParams.password - å¯ç ã
     * @param {Object} options
     * @param {boolean} [options.isNewTab=true] - ä¸ååæ¶æ¯å¦å¨æ°çªå£æå¼ç»å½é¡µé¢ã
     * @returns {Promise} åå« iManager ç»å½è¯·æ±ç»æç Promise å¯¹è±¡ã
     */
    static loginManager(url, loginInfoParams, options) {
        if (!Util.isInTheSameDomain(url)) {
            var isNewTab = options ? options.isNewTab : true;
            this._open(url, isNewTab);
            return;
        }
        var requestUrl = Util.urlPathAppend(url, 'icloud/security/tokens');
        var params = loginInfoParams || {};
        var loginInfo = {
            username: params.userName && params.userName.toString(),
            password: params.password && params.password.toString()
        };
        loginInfo = JSON.stringify(loginInfo);
        var requestOptions = {
            headers: {
                Accept: '*/*',
                'Content-Type': 'application/json'
            }
        };
        var me = this;
        return FetchRequest.post(requestUrl, loginInfo, requestOptions).then(function(response) {
            response.text().then(function(result) {
                me.imanagerToken = result;
                return result;
            });
        });
    }

    /**
     * @description æ¸ç©ºå¨é¨éªè¯ä¿¡æ¯ã
     * @function SecurityManager.destroyAllCredentials
     */
    static destroyAllCredentials() {
        this.keys = null;
        this.tokens = null;
        this.servers = null;
    }

    /**
     * @description æ¸ç©ºä»¤çä¿¡æ¯ã
     * @function SecurityManager.destroyToken
     * @param {string} url - iportal é¦é¡µå°å,å¦ï¼http://localhost:8092/iportal.
     */
    static destroyToken(url) {
        if (!url) {
            return;
        }
        var domain = this._getTokenStorageKey(url);
        this.tokens = this.tokens || {};
        if (this.tokens[domain]) {
            delete this.tokens[domain];
        }
    }

    /**
     * @description æ¸ç©ºæå¡ææç ã
     * @function SecurityManager.destroyKey
     * @param {string} url - iServer é¦é¡µå°å,å¦ï¼http://localhost:8090/iserverã
     */
    static destroyKey(url) {
        if (!url) {
            return;
        }
        this.keys = this.keys || {};
        var key = this._getUrlRestString(url) || url;
        if (this.keys[key]) {
            delete this.keys[key];
        }
    }

    /**
     * @description æå¡URLè¿½å ææä¿¡æ¯ï¼ææä¿¡æ¯éåéè¿SecurityManager.registerKeyæSecurityManager.registerTokenæ³¨åã
     * @version 10.1.2
     * @function SecurityManager.appendCredential
     * @param {string} url - æå¡URL
     * @returns {string} ç»å®äºtokenæèkeyçæå¡URL
     */
    static appendCredential(url) {
        var newUrl = url;
        var value = this.getToken(url);
        var credential = value ? new Credential(value, 'token') : null;
		if (!credential) {
            value = this.getKey(url);
            credential = value ? new Credential(value, 'key') : null;
          }
        if (credential) {
            newUrl = Util.urlAppend(newUrl, credential.getUrlParameters());
        }
        return newUrl;
    }

    static _open(url, newTab) {
        newTab = newTab != null ? newTab : true;
        var offsetX = window.screen.availWidth / 2 - this.INNER_WINDOW_WIDTH / 2;
        var offsetY = window.screen.availHeight / 2 - this.INNER_WINDOW_HEIGHT / 2;
        var options =
            'height=' +
            this.INNER_WINDOW_HEIGHT +
            ', width=' +
            this.INNER_WINDOW_WIDTH +
            ',top=' +
            offsetY +
            ', left=' +
            offsetX +
            ',toolbar=no, menubar=no, scrollbars=no, resizable=no, location=no, status=no';
        if (newTab) {
            window.open(url, 'login');
        } else {
            window.open(url, 'login', options);
        }
    }

    static _getTokenStorageKey(url) {
        var patten = /(.*?):\/\/([^\/]+)/i;
        var result = url.match(patten);
        if (!result) {
            return url;
        }
        return result[0];
    }

    static _getUrlRestString(url) {
        if (!url) {
            return url;
        }
        // var patten = /http:\/\/(.*\/rest)/i;
        var patten = /(http|https):\/\/(.*\/rest)/i;
        var result = url.match(patten);
        if (!result) {
            return url;
        }
        return result[0];
    }
}
SecurityManager.INNER_WINDOW_WIDTH = 600;
SecurityManager.INNER_WINDOW_HEIGHT = 600;
SecurityManager.SSO = 'https://sso.supermap.com';
SecurityManager.ONLINE = 'https://www.supermapol.com';

;// CONCATENATED MODULE: ./src/common/iManager/iManagerServiceBase.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class IManagerServiceBase
 * @aliasclass iManagerServiceBase
 * @deprecatedclass SuperMap.iManagerServiceBase
 * @classdesc iManager æå¡åºç±»ï¼ææééå¶çç±»éè¦å®ç°æ­¤ç±»ï¼ã
 * @category iManager
 * @param {string} url - iManager é¦é¡µå°åï¼å¦ï¼http://localhost:8390/imanagerã
 * @param {Object} options - å¯éåæ°ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class IManagerServiceBase {

    constructor(url,options) {
        if (url) {
            var end = url.substr(url.length - 1, 1);
            this.serviceUrl = end === "/" ? url.substr(0, url.length - 2) : url;
        }
        this.options = options || {};
        this.CLASS_NAME = "SuperMap.iManagerServiceBase";
    }

    /**
     * @function IManagerServiceBase.prototype.request
     * @description å­ç±»ç»ä¸éè¿è¯¥æ¹æ³åéè¯·æ±ã
     * @param {string} url - è¯·æ± URLã
     * @param {string} [method='GET'] - è¯·æ±ç±»åã
     * @param {Object} [requestOptions] - è¯·æ±éé¡¹ã
     * @param {Object} param - è¯·æ±åæ°ã
     * @description åéè¯·æ±ã
     * @returns {Promise} Promise å¯¹è±¡ã
     */
    request(method, url, param, requestOptions) {
        requestOptions = requestOptions || {
            headers: {
                'Accept': '*/*',
                'Content-Type': 'application/json'
            }
        };
        if (!requestOptions.hasOwnProperty("withCredentials")) {
            requestOptions['withCredentials'] = true;
        }
        requestOptions['crossOrigin'] = this.options.crossOrigin;
        requestOptions['headers'] = this.options.headers;
        var token = SecurityManager.imanagerToken;
        if (token) {
            if (!requestOptions.headers) {
                requestOptions.headers = [];
            }
            requestOptions.headers['X-Auth-Token'] = token;
        }
        if (param) {
            param = JSON.stringify(param);
        }
        return FetchRequest.commit(method, url, param, requestOptions).then(function (response) {
            return response.json();
        });
    }

}


;// CONCATENATED MODULE: ./src/common/iManager/iManagerCreateNodeParam.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class IManagerCreateNodeParam
 * @aliasclass iManagerCreateNodeParam
 * @deprecatedclass SuperMap.iManagerCreateNodeParam
 * @classdesc iManager åå»ºèç¹åæ°ã
 * @category iManager
 * @param {Object} [params] - èç¹åæ°ã
 * @usage
 */
class IManagerCreateNodeParam {

    constructor(params) {
        params = params || {};
        this.nodeSpec = 'SMALL';              //åå¼èå´: ['SMALL','MEDIUM','LARGE'] ä»¥åèªå®ä¹çç¯å¢è§æ ¼åç§°
        this.nodeCount = 1;                   //è¦åå»ºvmçä¸ªæ°
        this.nodeName = '';                   //vmåç§°
        this.password = '';                   //vmçå¯ç ,ç©ºè¡¨ç¤ºéæºåé
        this.description = '';                //æè¿°ä¿¡æ¯
        this.physicalMachineName = '';        //vmæå±çç©çæºåç§°.
        this.ips = [];                        //vmçip,ç©ºæ°ç»è¡¨ç¤ºéæºåé
        this.userName = '';                   //vmæå±ç¨æ·
        Util.extend(this, params);
    }

}

;// CONCATENATED MODULE: ./src/common/iManager/iManager.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class IManager
 * @aliasclass iManager
 * @deprecatedclass SuperMap.iManager
 * @classdesc iManager æå¡ç±»ã
 * @category iManager
 * @param {string} serviceUrl - iManager é¦é¡µå°åã
 * @usage
 */
class IManager extends IManagerServiceBase {

    constructor(iManagerUrl) {
        super(iManagerUrl);
    }

    /**
     * @function IManager.prototype.load
     * @description è·åæææå¡æ¥å£ï¼éªè¯æ¯å¦å·²ç»å½ææã
     * @returns {Promise} Promise å¯¹è±¡ã
     */
    load() {
        return this.request("GET", this.serviceUrl + '/web/api/service.json');
    }

    /**
     * @function IManager.prototype.createIServer
     * @param {IManagerCreateNodeParam} createParam - åå»ºåæ°ã
     * @description åå»º iServerã
     * @returns {Promise} Promise å¯¹è±¡ã
     */
    createIServer(createParam) {
        return this.request("POST", this.serviceUrl + '/icloud/web/nodes/server.json', new IManagerCreateNodeParam(createParam));
    }

    /**
     * @function IManager.prototype.createIPortal
     * @param {IManagerCreateNodeParam} createParam - åå»ºåæ°ã
     * @description åå»º iPortalã
     * @returns {Promise} Promise å¯¹è±¡ã
     */
    createIPortal(createParam) {
        return this.request("POST", this.serviceUrl + '/icloud/web/nodes/portal.json', new IManagerCreateNodeParam(createParam));
    }

    /**
     * @function IManager.prototype.iServerList
     * @description è·åææåå»ºç iServerã
     * @returns {Promise} Promise å¯¹è±¡ã
     */
    iServerList() {
        return this.request("GET", this.serviceUrl + '/icloud/web/nodes/server.json');
    }

    /**
     * @function IManager.prototype.iPortalList
     * @description è·åææåå»ºç iPortalã
     * @returns {Promise} Promise å¯¹è±¡ã
     */
    iPortalList() {
        return this.request("GET", this.serviceUrl + '/icloud/web/nodes/portal.json');
    }

    /**
     * @function IManager.prototype.startNodes
     * @param {Array.<string>} ids - éè¦å¯å¨èç¹ç ID æ°ç»ãe.g:['1']ã
     * @description å¯å¨èç¹ã
     * @returns {Promise} Promise å¯¹è±¡ã
     */
    startNodes(ids) {
        return this.request("POST", this.serviceUrl + '/icloud/web/nodes/started.json', ids);
    }

    /**
     * @function IManager.prototype.stopNodes
     * @param {Array.<string>} ids - éè¦åæ­¢èç¹ç ID æ°ç»ãe.g:['1']ã
     * @description åæ­¢èç¹ã
     * @returns {Promise} Promise å¯¹è±¡ã
     */
    stopNodes(ids) {
        return this.request("POST", this.serviceUrl + '/icloud/web/nodes/stopped.json', ids);
    }
}


;// CONCATENATED MODULE: ./src/common/iManager/index.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/








;// CONCATENATED MODULE: ./src/common/iPortal/iPortalServiceBase.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class IPortalServiceBase
 * @aliasclass iPortalServiceBase
 * @deprecatedclass SuperMap.iPortalServiceBase
 * @classdesc iPortal æå¡åºç±»ï¼ææééå¶çç±»éè¦å®ç°æ­¤ç±»ï¼ã
 * @category iPortal/Online Core
 * @param {string} url - æå¡å°åã
 * @param {Object} options - å¯éåæ°ã
 * @param {boolean} [options.withCredentials=false] - è¯·æ±æ¯å¦æºå¸¦ cookieã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class IPortalServiceBase {

    constructor(url, options) {
        options = options || {};
        this.serviceUrl = url;
        this.CLASS_NAME = "SuperMap.iPortalServiceBase";
        this.withCredentials = options.withCredentials || false;
        this.crossOrigin = options.crossOrigin
        this.headers = options.headers
    }

    /**
     * @function IPortalServiceBase.prototype.request
     * @description å­ç±»ç»ä¸éè¿è¯¥æ¹æ³åéè¯·æ±ã
     * @param {string} [method='GET'] - è¯·æ±ç±»åã
     * @param {string} url - æå¡å°åã
     * @param {Object} param - è¯·æ±åæ°ã
     * @param {Object} [requestOptions] - fetch è¯·æ±éç½®é¡¹ã
     * @returns {Promise} è¿ååå«è¯·æ±ç»æç Promise å¯¹è±¡ã
     */

    request(method, url, param, requestOptions = {headers: this.headers, crossOrigin: this.crossOrigin, withCredentials: this.withCredentials }) {
        url = SecurityManager.appendCredential(url);
        return FetchRequest.commit(method, url, param, requestOptions).then(function (response) {
            return response.json();
        });
    }


}


;// CONCATENATED MODULE: ./src/common/iPortal/iPortalQueryParam.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class IPortalQueryParam
 * @aliasclass iPortalQueryParam
 * @deprecatedclass SuperMap.iPortalQueryParam
 * @classdesc iPortal èµæºæ¥è¯¢åæ°ã
 * @version 10.0.1
 * @category iPortal/Online Resources ResourcesQuery
 * @param {Object} params - å¯éåæ°ã
 * @param {ResourceType} [params.resourceType] - èµæºç±»å
 * @param {number} [params.pageSize] - åé¡µä¸­æ¯é¡µå¤§å°ã
 * @param {number} [params.currentPage] - åé¡µé¡µç ã
 * @param {OrderBy} [params.orderBy] - æåºå­æ®µã
 * @param {OrderType} [params.orderType] - æ ¹æ®ååºè¿æ¯éåºè¿æ»¤ã
 * @param {SearchType} [params.searchType] - æ ¹æ®æ¥è¯¢çèå´è¿è¡è¿æ»¤ã
 * @param {Array} [params.tags] - æ ç­¾ã
 * @param {Array} [params.dirIds] - ç®å½ id
 * @param {Array} [params.resourceSubTypes] - æ ¹æ®èµæºçå­ç±»åè¿è¡è¿æ»¤ã
 * @param {AggregationTypes} [params.aggregationTypes] - èåæ¥è¯¢çç±»åã
 * @param {string} [params.text] - 	æç´¢çå³é®è¯ã
 * @param {Array} [params.groupIds] - 	æ ¹æ®ç¾¤ç»è¿è¡è¿æ»¤ã
 * @param {Array} [params.departmentIds] - æ ¹æ®é¨é¨è¿è¡è¿æ»¤ã
 * @usage
 */
class IPortalQueryParam {

    constructor(params) {
        params = params || {};
        this.resourceType = ""; // ç©ºä¸ºå¨é¨ MAP SERVICE SCENE DATA INSIGHTS_WORKSPACE MAP_DASHBOARD
        this.pageSize = 12; // æ¯é¡µå¤å°æ¡
        this.currentPage = 1; // ç¬¬å é¡µ
        this.orderBy = "UPDATETIME"; // UPDATETIME HEATLEVEL
        this.orderType = "DESC"; // DESC ASC
        this.searchType = "PUBLIC"; // PUBLIC SHARETOME_RES MYDEPARTMENT_RES MYGROUP_RES MY_RES
        this.tags = [];  // æ ç­¾
        this.dirIds = []; // ç±»å«
        this.resourceSubTypes = []; // ç±»å
        this.aggregationTypes = []; // TAG TYPE SUBTYPE
        this.text = ""; // æç´¢å­æ®µ
        this.groupIds = []; // ç¾¤ç»Idè¿æ»¤
        this.departmentIds = []; // é¨é¨Idè¿æ»¤
        Util.extend(this, params);
    }
}


;// CONCATENATED MODULE: ./src/common/iPortal/iPortalQueryResult.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class IPortalQueryResult
 * @aliasclass iPortalQueryResult
 * @deprecatedclass SuperMap.iPortalQueryResult
 * @classdesc iPortal èµæºç»æéå°è£ç±»ã
 * @version 10.0.1
 * @category iPortal/Online Resources ResourcesQuery
 * @param {Object} queryResult - å¯éåæ°ã
 * @param {Array} [queryResult.content] - é¡µé¢åå®¹ã
 * @param {number} [queryResult.total] - æ»è®°å½æ°ã
 * @param {number} [queryResult.currentPage] - å½åç¬¬å é¡µã
 * @param {number} [queryResult.pageSize] - æ¯é¡µå¤§å°ã
 * @param {Object} [queryResult.aggregations] - èåæ¥è¯¢çç»æã
 * @usage
 */
class IPortalQueryResult {
    constructor(queryResult) {
        queryResult = queryResult || {};
        this.content = [];
        this.total = 0;
        this.currentPage = 1;
        this.pageSize = 12;
        this.aggregations = null;
        Util.extend(this, queryResult);
    }

}



;// CONCATENATED MODULE: ./src/common/iPortal/iPortalResource.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class IPortalResource
 * @aliasclass iPortalResource
 * @deprecatedclass SuperMap.iPortalResource
 * @classdesc iPortal èµæºè¯¦æç±»ã
 * @version 10.0.1
 * @category iPortal/Online Resources
 * @param {string} portalUrl - æå¡å°åã
 * @param {Object} resourceInfo - å¯éåæ°ã
 * @param {Array} [resourceInfo.authorizeSetting] - èµæºçææä¿¡æ¯
 * @param {string} [resourceInfo.bounds] - èµæºçåæ èå´
 * @param {string} [resourceInfo.bounds4326] - èµæºçåæ èå´ï¼è½¬æ¢ä¸ºEPSG 4326åæ ç³»ç»åçå°çèå´ã
 * @param {string} [resourceInfo.checkStatus] - èµæºçå®¡æ ¸ç¶æï¼å¯ä»¥æ¯ï¼ç©º,SUCCESSFUL,UNCHECKED,FAILED
 * @param {Date} [resourceInfo.createTime] - èµæºçåå»ºæ¶é´
 * @param {string} [resourceInfo.description] - èµæºæè¿°
 * @param {number} [resourceInfo.dirId] - èµæºæå¨çé¨æ·ç®å½çid
 * @param {number} [resourceInfo.epsgCode] - é¨æ·èµæºåºäºçåæ ç³»çEPSGå¼ã
 * @param {number} [resourceInfo.heatLevel] - è®°å½èµæºçè®¿é®éæä¸è½½éã
 * @param {string} [resourceInfo.id] - èµæºå­å¨å°ElasticSearchä¸­çææ¡£id
 * @param {string} [resourceInfo.name] - èµæºåç§°
 * @param {number} [resourceInfo.personalDirId] - èµæºæå¨çä¸ªäººç®å½çid
 * @param {number} [resourceInfo.resourceId] - èµæºè¡¨(maps,servicesç­)éçid
 * @param {string} [resourceInfo.resourceSubType] - æç±»èµæºçå·ä½å­ç±»åã
 * @param {ResourceType} [resourceInfo.resourceType] - èµæºç±»å
 * @param {number} [resourceInfo.serviceRootUrlId] - æ¹éæ³¨åæå¡æ¶ï¼æå¡æ ¹å°åçID
 * @param {Array} [resourceInfo.tags] - èµæºçæ ç­¾
 * @param {string} [resourceInfo.thumbnail] - èµæºçç¼©ç¥å¾
 * @param {Date} [resourceInfo.updateTime] - èµæºçæ´æ°æ¶é´
 * @param {string} [resourceInfo.userName] - æç´¢çå³é®è¯
 * @param {Object} [resourceInfo.sourceJSON] - æä¾äºé¨æ·é¡¹ç®è¿åçææä¿¡æ¯ã
 * @extends {IPortalServiceBase}
 * @usage
 */
class IPortalResource extends IPortalServiceBase {
    constructor(portalUrl, resourceInfo) {
        super(portalUrl);
        resourceInfo = resourceInfo || {};
        this.authorizeSetting = [];
        this.bounds = "";
        this.bounds4326 = "";
        this.checkStatus = "";
        this.createTime = 0;
        this.description = null;
        this.dirId = null;
        this.epsgCode = 0;
        this.heatLevel = 0;
        this.id = 0;
        this.name = "";
        this.personalDirId = null;
        this.resourceId = 0;
        this.resourceSubType = null;
        this.resourceType = null;
        this.serviceRootUrlId = null;
        this.tags = null;
        this.thumbnail = null;
        this.updateTime = 0;
        this.userName = "";
        this.sourceJSON = {};//è¿åé¨æ·èµæºè¯¦ç»ä¿¡æ¯
        Util.extend(this, resourceInfo); // INSIGHTS_WORKSPACE MAP_DASHBOARD
        this.resourceUrl = portalUrl + "/web/"+this.resourceType.replace("_","").toLowerCase()+"s/" + this.resourceId;
        if (this.withCredentials) {
            this.resourceUrl = portalUrl + "/web/mycontent/"+this.resourceType.replace("_","").toLowerCase()+"s/" + this.resourceId;
        }
        // if (this.id) {
        //     this.mapUrl = mapUrl + "/" + this.id;
        // }
    }

    /**
     * @function IPortalResource.prototype.load
     * @description å è½½èµæºä¿¡æ¯ã
     * @returns {Promise} è¿å Promise å¯¹è±¡ãå¦ææåï¼Promise æ²¡æè¿åå¼ï¼è¯·æ±è¿åç»æèªå¨å¡«åå°è¯¥ç±»çå±æ§ä¸­ï¼å¦æå¤±è´¥ï¼Promise è¿åå¼åå«éè¯¯ä¿¡æ¯ã
     */
    load() {
        var me = this;
        return me.request("GET", me.resourceUrl + ".json")
            .then(function (resourceInfo) {
                if (resourceInfo.error) {
                    return resourceInfo;
                }
                me.sourceJSON = resourceInfo;
            });
    }

    /**
     * @function IPortalResource.prototype.update
     * @description æ´æ°èµæºå±æ§ä¿¡æ¯ã
     * @returns {Promise} è¿ååå«æ´æ°æä½ç¶æç Promise å¯¹è±¡ã
     */
    update() {
        var resourceName = this.resourceType.replace("_","").toLowerCase();
        var options = {
            headers: {'Content-Type': 'application/x-www-form-urlencoded'}
        };
        if( resourceName === 'data') {
            this.resourceUrl = this.resourceUrl + "/attributes.json";
        }
        var entity = JSON.stringify(this.sourceJSON);
        //å¯¹æå¡èµæºè¿è¡ç¼è¾æ¶ï¼è¯·æ±ä½åå®¹åªçå³é®å­å­æ®µï¼ç®åå¦ææ¯å¨é¨å­æ®µ æ´æ°è¿åæå ä½å¶å®æ²¡æçæ­£çæ´æ°ï¼
        if( resourceName === 'service') {
            var serviceInfo = {
                authorizeSetting:this.sourceJSON.authorizeSetting,
                metadata:this.sourceJSON.metadata,
                tags:this.sourceJSON.tags,
                thumbnail:this.sourceJSON.thumbnail,
                tokenRefreshUrl:this.sourceJSON.tokenRefreshUrl
            };
            entity = JSON.stringify(serviceInfo);
        }
        return this.request("PUT", this.resourceUrl, entity, options);
    }

}



;// CONCATENATED MODULE: ./src/common/iPortal/iPortalShareParam.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class IPortalShareParam
 * @aliasclass iPortalShareParam
 * @deprecatedclass SuperMap.iPortalShareParam
 * @classdesc iPortal èµæºå±äº«åæ°ã
 * @version 10.0.1
 * @category iPortal/Online Resources ResourcesShare
 * @param {Object} params - å¯éåæ°ã
 * @param {ResourceType} [params.resourceType] - èµæºç±»åã
 * @param {Array} [params.ids] - èµæºçidæ°ç»ã
 * @param {IPortalShareEntity} [params.entities] - èµæºçå®ä½å±äº«åæ°
 * @usage
 */
class IPortalShareParam {

    constructor(params) {
        params = params || {};
        this.ids = [];
        this.entities = [];
        this.resourceType = ""; // MAP SERVICE SCENE DATA INSIGHTS_WORKSPACE MAP_DASHBOARD
        Util.extend(this, params);
    }
}


;// CONCATENATED MODULE: ./src/common/iPortal/iPortal.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/







/**
 * @class IPortal
 * @aliasclass iPortal
 * @deprecatedclass SuperMap.iPortal
 * @classdesc å¯¹æ¥ SuperMap iPortal åºç¡æå¡ã
 * @category iPortal/Online Resources
 * @extends {IPortalServiceBase}
 * @param {string} iportalUrl - æå¡å°åã
 * @param {Object} options - å¯éåæ°ã
 * @param {boolean} [options.withCredentials] - è¯·æ±æ¯å¦æºå¸¦ cookieã
 * @usage
 */
class IPortal extends IPortalServiceBase {
    constructor(iportalUrl, options) {
        super(iportalUrl, options);
        this.iportalUrl = iportalUrl;
        options = options || {};
        this.withCredentials = options.withCredentials || false;
    }

    /**
     * @function IPortal.prototype.load
     * @description å è½½é¡µé¢ã
     * @returns {Promise} åå« iportal web èµæºä¿¡æ¯ç Promise å¯¹è±¡ã
     */
    load() {
        return FetchRequest.get(this.iportalUrl + "/web");
    }

    /**
     * @function IPortal.prototype.queryResources
     * @description æ¥è¯¢èµæºã
     * @version 10.0.1
     * @param {IPortalQueryParam} queryParams - æ¥è¯¢åæ°ã
     * @returns {Promise} åå«ææèµæºç»æç Promise å¯¹è±¡ã
     */
    queryResources(queryParams) {
        if (!(queryParams instanceof IPortalQueryParam)) {
            return new Promise( function(resolve){
                resolve(
                    "queryParams is not instanceof iPortalQueryParam !"
                );
            });
        }
        var me = this;
        var resourceUrl = this.iportalUrl + "/gateway/catalog/resource/search.json";
        queryParams.t = new Date().getTime();
        return this.request("GET", resourceUrl, queryParams).then(function(result) {
            var content = [];
            result.content.forEach(function(item) {
                content.push(new IPortalResource(me.iportalUrl, item));
            });
            let queryResult = new IPortalQueryResult();
            queryResult.content = content;
            queryResult.total = result.total;
            queryResult.currentPage = result.currentPage;
            queryResult.pageSize = result.pageSize;
            queryResult.aggregations = result.aggregations;
            return queryResult;
        });
    }


    /**
     * @function IPortal.prototype.updateResourcesShareSetting
     * @description æ´æ°å±äº«è®¾ç½®ã
     * @version 10.0.1
     * @param {IPortalShareParam} shareParams - å±äº«çåæ°ã
     * @returns {Promise} åå«å±äº«èµæºç»æç Promise å¯¹è±¡ã
     */
    updateResourcesShareSetting(shareParams) {
        if (!(shareParams instanceof IPortalShareParam)) {
            return new Promise( function(resolve){
                resolve(
                    "shareParams is not instanceof iPortalShareParam !"
                );
            });
        }
        var resourceUrlName = shareParams.resourceType.replace("_","").toLowerCase()+"s";
        if(resourceUrlName === "datas"){
            resourceUrlName = "mycontent/"+resourceUrlName;
        }
        var cloneShareParams = {
            ids: shareParams.ids,
            entities: shareParams.entities
        }
        var shareUrl = this.iportalUrl + "/web/"+resourceUrlName+"/sharesetting.json";
        return this.request("PUT", shareUrl, JSON.stringify(cloneShareParams)).then(function(result) {
            return result;
        });
    }
}

;// CONCATENATED MODULE: ./src/common/iPortal/iPortalShareEntity.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class IPortalShareEntity
 * @aliasclass iPortalShareEntity
 * @deprecatedclass SuperMap.iPortalShareEntity
 * @classdesc iPortal èµæºå±äº«å®ä½åæ°ã
 * @version 10.0.1
 * @category iPortal/Online Resources ResourcesShare
 * @param {Object} shareEntity - å¯éåæ°ã
 * @param {PermissionType} [shareEntity.permissionType] - æéç±»åã
 * @param {EntityType} [shareEntity.entityType] - å®ä½ç±»åã
 * @param {string} [shareEntity.entityName] - å®ä½ Nameãå¯¹åºç USERï¼ç¨æ·ï¼ã ROLEï¼è§è²ï¼ãGROUPï¼ç¨æ·ç»ï¼ãIPORTALGROUPï¼ç¾¤ç»ï¼çåç§°ã
 * @param {number} [shareEntity.entityId] - å®ä½ç idãç¨äºç¾¤ç»çææã
 * @usage
 */
class IPortalShareEntity {

    constructor(shareEntity) {
        shareEntity = shareEntity || {};
        this.permissionType = ""; // SEARCH READ READWRITE DOWNLOAD
        this.entityType = ""; // USER DEPARTMENT IPORTALGROUP
        this.entityName = "GUEST"; // GUEST or å·ä½ç¨æ· name
        this.entityId = null;
        Util.extend(this, shareEntity);
    }
}


;// CONCATENATED MODULE: ./src/common/iPortal/iPortalAddResourceParam.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
 

 /**
  * @class IPortalAddResourceParam
  * @aliasclass iPortalAddResourceParam
  * @deprecatedclass SuperMap.iPortalAddResourceParam
  * @classdesc iPortal æ·»å èµæºåæ°ã
  * @version 10.0.1
  * @category iPortal/Online Resources ResourcesShare
  * @param {Object} params - å¯éåæ°ã
  * @param {string} [params.rootUrl] - æå¡å°åã
  * @param {Array} [params.tags] - æ ç­¾ã
  * @param {IPortalShareEntity} [params.entities] - èµæºçå®ä½å±äº«åæ°
  * @usage
  */
 class IPortalAddResourceParam {

     constructor(params) {
         params = params || {};
         this.rootUrl = "";
         this.tags = [];
         this.entities = [];
         Util.extend(this, params);
     }
 }


;// CONCATENATED MODULE: ./src/common/iPortal/iPortalRegisterServiceParam.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class IPortalRegisterServiceParam
 * @aliasclass iPortalRegisterServiceParam
 * @deprecatedclass SuperMap.iPortalRegisterServiceParam
 * @classdesc iPortal æ³¨åæå¡åæ°ã
 * @version 10.0.1
 * @category iPortal/Online Resources Data
 * @param {Object} params - å¯éåæ°ã
 * @param {string} [params.type] - æå¡ç±»åã
 * @param {Array} [params.tags] - æå¡æ ç­¾ã
 * @param {IPortalShareEntity} [params.entities] - èµæºçå®ä½å±äº«åæ°
 * @param {Object} [params.metadata] - æå¡åä¿¡æ¯ã
 * @param {Array} [params.addedMapNames] - å°å¾æå¡åè¡¨ã
 * @param {Array} [params.addedSceneNames] - åºæ¯æå¡åè¡¨ã
 * @usage
 */
class IPortalRegisterServiceParam {

    constructor(params) {
        params = params || {};
        this.type = ""; // SUPERMAP_REST ARCGIS_REST WMS WFS WCS WPS WMTS OTHERS
        this.tags = [];
        this.entities = [];
        this.metadata = {};
        this.addedMapNames = [];
        this.addedSceneNames = [];
        Util.extend(this, params);
    }
}


;// CONCATENATED MODULE: ./src/common/iPortal/iPortalAddDataParam.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
 

 /**
  * @class IPortalAddDataParam
  * @aliasclass iPortalAddDataParam
  * @deprecatedclass SuperMap.iPortalAddDataParam
  * @classdesc iPortal ä¸ä¼ /æ³¨åæ°æ®æéçåæ°ã
  * @version 10.0.1
  * @category iPortal/Online Resources Data
  * @param {Object} params - åæ°ã
  * @param {string} params.fileName - æä»¶åç§°
  * @param {DataItemType} params.type - æ°æ®ç±»åã
  * @param {Array} [params.tags] - æ°æ®çæ ç­¾
  * @param {IPortalDataMetaInfoParam} [params.dataMetaInfo] - æ°æ®åä¿¡æ¯
  * @usage
  */
 class IPortalAddDataParam {

     constructor(params) {
        params = params || {};
        this.fileName = "";
        this.type = "";
        this.tags = [];
        this.dataMetaInfo = {};
        Util.extend(this, params);
     }
 }


;// CONCATENATED MODULE: ./src/common/iPortal/iPortalDataMetaInfoParam.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
 

 /**
  * @class IPortalDataMetaInfoParam
  * @aliasclass iPortalDataMetaInfoParam
  * @deprecatedclass SuperMap.iPortalDataMetaInfoParam
  * @classdesc iPortal ä¸ä¼ æ°æ®/æ³¨åæ°æ®åä¿¡æ¯æéçåæ°ã
  * @version 10.0.1
  * @category iPortal/Online Resources Data
  * @param {Object} params - åæ°ã
  * @param {string} params.xField - X åæ å­æ®µ
  * @param {string} params.yField - Y åæ å­æ®µ
  * @param {number} params.xIndex - xæå¨åï¼å³ç³»åå­å¨ä¸CSVæEXCELæ°æ®æ¶å¿å¡«ï¼
  * @param {number} params.yIndex - yæå¨åï¼å³ç³»åå­å¨ä¸CSVæEXCELæ°æ®æ¶å¿å¡«ï¼
  * @param {Array.<string>} [params.fieldTypes] - è®¾ç½®å­æ®µç±»åï¼å³ç³»åå­å¨ä¸CSVæEXCELæ°æ®æ¶å¯éå¡«ï¼ãé»è®¤ç±»åä¸ºï¼WTEXTãè¯¥åæ°æç§CSVæä»¶å­æ®µé¡ºåºä»å·¦å°å³ä¾æ¬¡è®¾ç½®ï¼å¶ä¸­é»è®¤å­æ®µç±»åå¯çç¥ä¸è®¾ç½®ãä¾å¦ï¼CSVæä»¶ä¸­æ10ä¸ªå­æ®µï¼å¦æåªéè®¾å®ç¬¬1ï¼2ï¼4ä¸ªå­æ®µï¼å¯è®¾ç½®ä¸º['a','b',,'c']ã
  * @param {string} params.separator - åéç¬¦ï¼å³ç³»åå­å¨ä¸CSVæ°æ®æ¶å¿å¡«ï¼
  * @param {boolean} params.firstRowIsHead - æ¯å¦å¸¦è¡¨å¤´ï¼å³ç³»åå­å¨ä¸CSVæ°æ®æ¶å¿å¡«ï¼
  * @param {boolean} params.url - HDFSæ³¨åç®å½å°å
  * @param {IPortalDataStoreInfoParam} params.dataStoreInfo - æ³¨åæ°æ®æ¶çæ°æ®å­å¨ä¿¡æ¯
  * @usage
  */
 class IPortalDataMetaInfoParam {

     constructor(params) {
        params = params || {};
        this.xField = "";
        this.yField = "";
        this.fileEncoding = "UTF-8";

        this.xIndex = 1;
        this.yIndex = 1;
        this.fieldTypes = [];
        this.separator = "";
        this.firstRowIsHead = true;

        this.url = "";
        this.dataStoreInfo = {};
        Util.extend(this, params);
     }
 }


;// CONCATENATED MODULE: ./src/common/iPortal/iPortalDataStoreInfoParam.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
 

 /**
  * @class IPortalDataStoreInfoParam
  * @aliasclass iPortalDataStoreInfoParam
  * @deprecatedclass SuperMap.iPortalDataStoreInfoParam
  * @classdesc iPortal æ³¨åä¸ä¸ªHBASE HDFSæ°æ®å­å¨ç±»ã
  * @version 10.0.1
  * @category iPortal/Online Resources Data
  * @param {Object} params - åæ°ã
  * @param {string} params.type - å¤§æ°æ®æä»¶å±äº«ç±»ååç©ºé´æ°æ®åºç±»åï¼åæ¬å¤§æ°æ®æä»¶å±äº«HDFS ç®å½(HDFS)åç©ºé´æ°æ®åºHBASE
  * @param {string} params.url - HDFSæ°æ®å­å¨ç®å½å°å
  * @param {IPortalDataConnectionInfoParam} [params.connectionInfo] - HBASEç©ºé´æ°æ®åºæå¡çè¿æ¥ä¿¡æ¯
  * @usage
  */
 class IPortalDataStoreInfoParam {

     constructor(params) {
        params = params || {};
        this.type = "";
        this.url = "";
        this.connectionInfo = {};
        Util.extend(this, params);
     }
 }


;// CONCATENATED MODULE: ./src/common/iPortal/iPortalDataConnectionInfoParam.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
 

 /**
  * @class IPortalDataConnectionInfoParam
  * @aliasclass iPortalDataConnectionInfoParam
  * @deprecatedclass SuperMap.iPortalDataConnectionInfoParam
  * @classdesc iPortal HBASEæ°æ®æºè¿æ¥ä¿¡æ¯ç±»ã
  * @version 10.0.1
  * @category iPortal/Online Resources Data
  * @param {Object} params - åæ°ã
  * @param {string} params.dataBase - æ°æ®æºè¿æ¥çæ°æ®åºåã
  * @param {string} params.server - æå¡å°åã
  * @usage
  */
 class IPortalDataConnectionInfoParam {

     constructor(params) {
        params = params || {};
        this.dataBase = "";
        this.server = "";
        Util.extend(this, params);
     }
 }


;// CONCATENATED MODULE: ./src/common/iPortal/iPortalUser.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/







/**
 * @class IPortalUser
 * @aliasclass iPortalUser
 * @deprecatedclass SuperMap.iPortalUser
 * @classdesc iPortal é¨æ·ä¸­ç¨æ·ä¿¡æ¯çå°è£ç±»ãç¨äºç®¡çç¨æ·èµæºï¼åæ¬å¯å é¤ï¼æ·»å èµæºã
 * @version 10.0.1
 * @category iPortal/Online Resources
 * @param {string} iportalUrl - æå¡å°åã
 * @extends {IPortalServiceBase}
 * @usage
 */
class IPortalUser extends IPortalServiceBase {
    constructor(iportalUrl) {
        super(iportalUrl);
        this.iportalUrl = iportalUrl;
    }

    /**
     * @function IPortalUser.prototype.deleteResources
     * @description å é¤èµæºã
     * @param {Object} params - å é¤èµæºæéçåæ°å¯¹è±¡ï¼{ids,resourceType}ã
     * @returns {Promise} è¿ååå«å é¤æä½ç¶æç Promise å¯¹è±¡ã
     */
    deleteResources(params) {
        var resourceName = params.resourceType.replace("_","").toLowerCase();
        var deleteResourceUrl = this.iportalUrl+"/web/" + resourceName +"s.json?ids=" + encodeURI(JSON.stringify(params.ids));
        if( resourceName === 'data') {
            deleteResourceUrl = this.iportalUrl + "/web/mycontent/datas/delete.json";
            return this.request("POST", deleteResourceUrl, JSON.stringify(params.ids));
        }
        return this.request("DELETE", deleteResourceUrl);
    }

    /**
     * @function IPortalUser.prototype.addMap
     * @description æ·»å å°å¾ã
     * @version 10.1.0
     * @param {IPortalAddResourceParam} addMapParams - æ·»å å°å¾çåæ°ã
     * @returns {Promise} è¿ååå«æ·»å å°å¾ç»æç Promise å¯¹è±¡ã
     */
    addMap(addMapParams) {
        if (!(addMapParams instanceof IPortalAddResourceParam)) {
            return this.getErrMsgPromise("addMapParams is not instanceof IPortalAddResourceParam !");
        }
        let cloneAddMapParams = {
            rootUrl: addMapParams.rootUrl,
            tags: addMapParams.tags,
            authorizeSetting: addMapParams.entities
        }
        let addMapUrl = this.iportalUrl + "/web/maps/batchaddmaps.json";
        return this.request("POST", addMapUrl, JSON.stringify(cloneAddMapParams)).then(function(result) {
            return result;
        });
    }

    /**
     * @function IPortalUser.prototype.addScene
     * @description æ·»å åºæ¯ã
     * @version 10.1.0
     * @param {IPortalAddResourceParam} addSceneParams - æ·»å åºæ¯çåæ°ã
     * @returns {Promise} è¿ååå«æ·»å åºæ¯ç»æç Promise å¯¹è±¡ã
     */
    addScene(addSceneParams) {
        if (!(addSceneParams instanceof IPortalAddResourceParam)) {
            return this.getErrMsgPromise("addSceneParams is not instanceof IPortalAddResourceParam !");
        }
        let cloneAddSceneParams = {
            rootUrl: addSceneParams.rootUrl,
            tags: addSceneParams.tags,
            authorizeSetting: addSceneParams.entities
        }
        let addSceneUrl = this.iportalUrl + "/web/scenes/batchaddscenes.json";
        return this.request("POST", addSceneUrl, JSON.stringify(cloneAddSceneParams)).then(function(result) {
            return result;
        });
    }

    /**
     * @function IPortalUser.prototype.registerService
     * @description æ³¨åæå¡ã
     * @version 10.1.0
     * @param {IPortalRegisterServiceParam} registerParams - æ³¨åæå¡çåæ°ã
     * @returns {Promise} è¿ååå«æ³¨åæå¡ç»æç Promise å¯¹è±¡ã
     */
    registerService(registerParams) {
        if(!(registerParams instanceof IPortalRegisterServiceParam)) {
            return this.getErrMsgPromise("registerParams is not instanceof IPortalRegisterServiceParam !");
        }
        let cloneRegisterParams = {
            type: registerParams.type,
            tags: registerParams.tags,
            authorizeSetting: registerParams.entities,
            metadata: registerParams.metadata,
            addedMapNames: registerParams.addedMapNames,
            addedSceneNames: registerParams.addedSceneNames
        }
        let registerUrl = this.iportalUrl + "/web/services.json";
        return this.request("POST", registerUrl, JSON.stringify(cloneRegisterParams)).then(result => {
            return result;
        });
    }

    /**
     * @function IPortalUser.prototype.getErrMsgPromise
     * @description è·ååå«éè¯¯ä¿¡æ¯çPromiseå¯¹è±¡ã
     * @version 10.1.0
     * @param {string} errMsg - ä¼ å¥çéè¯¯ä¿¡æ¯ã
     * @returns {Promise} è¿ååå«éè¯¯ä¿¡æ¯ç Promise å¯¹è±¡ã
     */
    getErrMsgPromise(errMsg) {
        return new Promise(resolve => {
            resolve(errMsg);
        })
    }

    /**
     * @function IPortalUser.prototype.uploadDataRequest
     * @description ä¸ä¼ æ°æ®ã
     * @version 10.1.0
     * @param {number} id - ä¸ä¼ æ°æ®çèµæºidã
     * @param {Object} formData - è¯·æ±ä½ä¸ºææ¬æ°æ®æµã
     * @returns {Promise} è¿ååå«ä¸ä¼ æ°æ®æä½ç Promise å¯¹è±¡ã
     */
    uploadDataRequest(id,formData) {
        var uploadDataUrl = this.iportalUrl + "/web/mycontent/datas/"+id+"/upload.json";
        return this.request("POST",uploadDataUrl,formData);
    }

    /**
     * @function IPortalUser.prototype.addData
     * @description ä¸ä¼ /æ³¨åæ°æ®ã
     * @version 10.1.0
     * @param {IPortalAddDataParam} params - ä¸ä¼ /æ³¨åæ°æ®æéçåæ°ã
     * @param {Object} [formData] - è¯·æ±ä½ä¸ºææ¬æ°æ®æµ(ä¸ä¼ æ°æ®æ¶ä¼ å¥)ã
     * @returns {Promise} è¿åä¸ä¼ /æ³¨åæ°æ®ç Promise å¯¹è±¡ã
     */
    addData(params,formData) {
        if(!(params instanceof IPortalAddDataParam)){
            return this.getErrMsgPromise("params is not instanceof iPortalAddDataParam !");
        }
        var datasUrl = this.iportalUrl + "/web/mycontent/datas.json";
        var entity = {
            fileName:params.fileName,
            tags:params.tags,
            type:params.type
        };
        var type = params.type.toLowerCase();
        var dataMetaInfo;
        if(type === "excel" || type === "csv"){
            if(!(params.dataMetaInfo instanceof IPortalDataMetaInfoParam)){
                return  this.getErrMsgPromise("params.dataMetaInfo is not instanceof iPortalDataMetaInfoParam !");
            }
            dataMetaInfo = {
                xField:params.dataMetaInfo.xField,
                yField:params.dataMetaInfo.yField
            }
            if(type === 'csv') {
                dataMetaInfo.fileEncoding = params.dataMetaInfo.fileEncoding
            }
            entity.coordType = "WGS84";
            entity.dataMetaInfo = dataMetaInfo;
        }else if(type === "hdfs" || type === "hbase") {
            if(!(params.dataMetaInfo instanceof IPortalDataMetaInfoParam)){
                return this.getErrMsgPromise("params.dataMetaInfo is not instanceof iPortalDataMetaInfoParam !");
            }
            if(!(params.dataMetaInfo.dataStoreInfo instanceof IPortalDataStoreInfoParam)){
                return this.getErrMsgPromise("params.dataMetaInfo.dataStoreInfo is not instanceof iPortalDataStoreInfoParam !");
            }
            var dataStoreInfo = {
                type:params.dataMetaInfo.dataStoreInfo.type
            }
            switch (type) {
                case "hdfs":
                    dataStoreInfo.url = params.dataMetaInfo.dataStoreInfo.url;
                    dataMetaInfo = {
                        url: params.dataMetaInfo.url,
                        dataStoreInfo:dataStoreInfo
                    }
                    break;
                case "hbase":
                    if(!(params.dataMetaInfo.dataStoreInfo.connectionInfo instanceof IPortalDataConnectionInfoParam)){
                        return this.getErrMsgPromise("params.dataMetaInfo.dataStoreInfo.connectionInfo is not instanceof iPortalDataConnectionInfoParam !");
                    }
                    dataStoreInfo.connectionInfo = {
                        dataBase:params.dataMetaInfo.dataStoreInfo.connectionInfo.dataBase,
                        server:params.dataMetaInfo.dataStoreInfo.connectionInfo.server,
                        engineType:'HBASE'
                    }
                    dataStoreInfo.datastoreType = "SPATIAL";//è¯¥å­æ®µSPATIALè¡¨ç¤ºHBASEæ³¨å
                    dataMetaInfo = {
                        dataStoreInfo:dataStoreInfo
                    }
                    break;
            }
            entity.dataMetaInfo = dataMetaInfo;
        }
        return this.request("POST",datasUrl,JSON.stringify(entity)).then(res=>{
            if(type === "hdfs" || type === "hbase"){
                return res;
            }else {
                if(res.childID) {
                    return this.uploadDataRequest(res.childID,formData);
                }else {
                    return res.customResult;
                }
            }
        })
    }

    /**
     * @function IPortalUser.prototype.publishOrUnpublish
     * @description åå¸/åæ¶åå¸ã
     * @version 10.1.0
     * @param {Object} options - åå¸/åæ¶åå¸æ°æ®æå¡æéçåæ°ã
     * @param {Object} options.dataId - æ°æ®é¡¹idã
     * @param {Object} options.serviceType - åå¸çæå¡ç±»åï¼ç®åæ¯æåå¸çæå¡ç±»ååæ¬ï¼RESTDATA, RESTMAP, RESTREALSPACE, RESTSPATIALANALYSTã
     * @param {Object} [options.dataServiceId] - åå¸çæå¡ idã
     * @param {boolean} forPublish - æ¯å¦åæ¶åå¸ã
     * @returns {Promise} è¿ååå¸/åæ¶åå¸æ°æ®æå¡ç Promise å¯¹è±¡ã
     */
    publishOrUnpublish(option,forPublish){
        if(!option.dataId || !option.serviceType) {
            return this.getErrMsgPromise("option.dataID and option.serviceType are Required!");
        }
        var dataId = option.dataId;
        var dataServiceId = option.dataServiceId;
        var serviceType = option.serviceType;
        var publishUrl = this.iportalUrl + "/web/mycontent/datas/" + dataId + "/publishstatus.json?serviceType=" + serviceType;
        if (dataServiceId) {
            publishUrl += "&dataServiceId=" + dataServiceId;
        }
        return this.request("PUT",publishUrl,JSON.stringify(forPublish)).then(res=>{
            // åèµ·æå¡ç¶ææ¥è¯¢
            if(forPublish) {
                // åå¸æå¡çç»æå¼æ­¥å¤ç
                //  var publishStateUrl = this.iportalUrl + "web/mycontent/datas/" + dataId + "/publishstatus.rjson";
                if (!dataServiceId) { // åå¸æå¡æ¶ä¼åä¼ serviceIDsï¼åå¸æå¡ä¹åserviceIDsä¸ºç©º
                    dataServiceId = res.customResult;
                }
                return dataServiceId;
            }else {
                // åæ¶åå¸çç»æåæ­¥å¤ç
                return res;
            }
        });
    }

    /**
     * @function IPortalUser.prototype.getDataPublishedStatus
     * @description æ¥è¯¢æå¡ç¶æï¼åèµ·æå¡ç¶ææ¥è¯¢ã
     * @version 10.1.0
     * @param {number} dataId - æ¥è¯¢æå¡ç¶æçæ°æ®é¡¹idã
     * @param {string} dataServiceId - åå¸çæå¡idã
     * @returns {Promise} è¿åæ¥è¯¢æå¡ç¶æç Promise å¯¹è±¡ã
     */
    getDataPublishedStatus(dataId,dataServiceId){
        var publishStateUrl = this.iportalUrl + "/web/mycontent/datas/" + dataId + "/publishstatus.json?dataServiceId="+dataServiceId+"&forPublish=true";
        return this.request("GET",publishStateUrl);
    }

    /**
     * @function IPortalUser.prototype.unPublishedDataService
     * @description åæ¶åå¸ã
     * @version 10.1.0
     * @param {Object} options - åæ¶åå¸æå¡å·ä½åæ°ã
     * @param {Object} options.dataId - æ°æ®é¡¹idã
     * @param {Object} options.serviceType - åå¸çæå¡ç±»åï¼ç®åæ¯æåå¸çæå¡ç±»ååæ¬ï¼RESTDATA, RESTMAP, RESTREALSPACE, RESTSPATIALANALYSTã
     * @param {Object} [options.dataServiceId] - åå¸çæå¡ idã
     * @returns {Promise} è¿ååæ¶åå¸æ°æ®æå¡ç Promise å¯¹è±¡ã
     */
    unPublishDataService(option){
        return this.publishOrUnpublish(option,false);
    }

    /**
     * @function IPortalUser.prototype.publishedDataService
     * @description åå¸æ°æ®æå¡ã
     * @version 10.1.0
     * @param {Object} options - åå¸æ°æ®æå¡å·ä½åæ°ã
     * @param {Object} options.dataId - æ°æ®é¡¹idã
     * @param {Object} options.serviceType - åå¸çæå¡ç±»åï¼ç®åæ¯æåå¸çæå¡ç±»ååæ¬ï¼RESTDATA, RESTMAP, RESTREALSPACE, RESTSPATIALANALYSTã
     * @param {Object} [options.dataServiceId] - åå¸çæå¡ idã
     * @returns {Promise} è¿ååå¸æ°æ®æå¡ç Promise å¯¹è±¡ã
     */
    publishDataService(option){
        return this.publishOrUnpublish(option,true);
    }
}

;// CONCATENATED MODULE: ./src/common/iPortal/index.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





























;// CONCATENATED MODULE: ./src/common/iServer/CommonServiceBase.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/







/**
 * @class CommonServiceBase
 * @deprecatedclass SuperMap.CommonServiceBase
 * @category  iServer Core
 * @classdesc å¯¹æ¥ iServer åç§æå¡ç Service çåºç±»ã
 * @param {string} url - æå¡å°åã
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - äºä»¶çå¬å¨å¯¹è±¡ãæ processCompleted å±æ§å¯ä¼ å¥å¤çå®æåçåè°å½æ°ãprocessFailed å±æ§ä¼ å¥å¤çå¤±è´¥åçåè°å½æ°ã
 * @param {string} [options.proxy] - æå¡ä»£çå°åã
 * @param {boolean} [options.withCredentials=false] - è¯·æ±æ¯å¦æºå¸¦ cookieã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class CommonServiceBase {
    constructor(url, options) {
        let me = this;

        this.EVENT_TYPES = ['processCompleted', 'processFailed'];

        this.events = null;

        this.eventListeners = null;

        this.url = null;

        this.urls = null;

        this.proxy = null;

        this.index = null;

        this.length = null;

        this.options = null;

        this.totalTimes = null;

        this.POLLING_TIMES = 3;

        this._processSuccess = null;

        this._processFailed = null;

        this.isInTheSameDomain = null;

        this.withCredentials = false;

        if (Util.isArray(url)) {
            me.urls = url;
            me.length = url.length;
            me.totalTimes = me.length;
            if (me.length === 1) {
                me.url = url[0];
            } else {
                me.index = parseInt(Math.random() * me.length);
                me.url = url[me.index];
            }
        } else {
            me.totalTimes = 1;
            me.url = url;
        }

        if (Util.isArray(url) && !me.isServiceSupportPolling()) {
            me.url = url[0];
            me.totalTimes = 1;
        }

        options = options || {};
        this.crossOrigin = options.crossOrigin;
        this.headers = options.headers;
        Util.extend(this, options);

        me.isInTheSameDomain = Util.isInTheSameDomain(me.url);

        me.events = new Events(me, null, me.EVENT_TYPES, true);
        if (me.eventListeners instanceof Object) {
            me.events.on(me.eventListeners);
        }

        this.CLASS_NAME = 'SuperMap.CommonServiceBase';
    }

    /**
     * @function CommonServiceBase.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨çèµæºå±æ§ç½®ç©ºã
     */
    destroy() {
        let me = this;
        if (Util.isArray(me.urls)) {
            me.urls = null;
            me.index = null;
            me.length = null;
            me.totalTimes = null;
        }
        me.url = null;
        me.options = null;
        me._processSuccess = null;
        me._processFailed = null;
        me.isInTheSameDomain = null;

        me.EVENT_TYPES = null;
        if (me.events) {
            me.events.destroy();
            me.events = null;
        }
        if (me.eventListeners) {
            me.eventListeners = null;
        }
    }

    /**
     * @function  CommonServiceBase.prototype.request
     * @description: è¯¥æ¹æ³ç¨äºåæå¡åéè¯·æ±ã
     * @param {Object} options - åæ°ã
     * @param {string} [options.method='GET'] - è¯·æ±æ¹å¼ï¼åæ¬ "GET"ï¼"POST"ï¼"PUT"ï¼"DELETE"ã
     * @param {string} [options.url] - åéè¯·æ±çå°åã
     * @param {Object} [options.params] - ä½ä¸ºæ¥è¯¢å­ç¬¦ä¸²æ·»å å° URL ä¸­çä¸ç»é®å¼å¯¹ï¼æ­¤åæ°åªéç¨äº GET æ¹å¼åéçè¯·æ±ã
     * @param {string} [options.data] - åéå°æå¡å¨çæ°æ®ã
     * @param {function} options.success - è¯·æ±æååçåè°å½æ°ã
     * @param {function} options.failure - è¯·æ±å¤±è´¥åçåè°å½æ°ã
     * @param {Object} [options.scope] - å¦æåè°å½æ°æ¯å¯¹è±¡çä¸ä¸ªå¬å±æ¹æ³ï¼è®¾å®è¯¥å¯¹è±¡çèå´ã
     * @param {boolean} [options.isInTheSameDomain] - è¯·æ±æ¯å¦å¨å½ååä¸­ã
     * @param {boolean} [options.withCredentials=false] - è¯·æ±æ¯å¦æºå¸¦ cookieã
     * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
     * @param {Object} [options.headers] - è¯·æ±å¤´ã
     */
    request(options) {
        let me = this;
        options.url = options.url || me.url;
        options.proxy = options.proxy || me.proxy;
        options.withCredentials = options.withCredentials != undefined ? options.withCredentials : me.withCredentials;
        options.crossOrigin = options.crossOrigin != undefined ? options.crossOrigin : me.crossOrigin;
        options.headers = options.headers || me.headers;
        options.isInTheSameDomain = me.isInTheSameDomain;
        options.withoutFormatSuffix = options.scope.withoutFormatSuffix || false;
        //ä¸ºurlæ·»å å®å¨è®¤è¯ä¿¡æ¯çæ®µ
        options.url = SecurityManager.appendCredential(options.url);

        me.calculatePollingTimes();
        me._processSuccess = options.success;
        me._processFailed = options.failure;
        options.scope = me;
        options.success = me.getUrlCompleted;
        options.failure = me.getUrlFailed;
        me.options = options;
        me._commit(me.options);
    }

    /**
     * @function CommonServiceBase.prototype.getUrlCompleted
     * @description è¯·æ±æååæ§è¡æ­¤æ¹æ³ã
     * @param {Object} result - æå¡å¨è¿åçç»æå¯¹è±¡ã
     */
    getUrlCompleted(result) {
        let me = this;
        me._processSuccess(result);
    }

    /**
     * @function CommonServiceBase.prototype.getUrlFailed
     * @description è¯·æ±å¤±è´¥åæ§è¡æ­¤æ¹æ³ã
     * @param {Object} result - æå¡å¨è¿åçç»æå¯¹è±¡ã
     */
    getUrlFailed(result) {
        let me = this;
        if (me.totalTimes > 0) {
            me.totalTimes--;
            me.ajaxPolling();
        } else {
            me._processFailed(result);
        }
    }

    /**
     *
     * @function CommonServiceBase.prototype.ajaxPolling
     * @description è¯·æ±å¤±è´¥åï¼å¦æå©ä½è¯·æ±å¤±è´¥æ¬¡æ°ä¸ä¸º 0ï¼éæ°è·å URL åéè¯·æ±
     */
    ajaxPolling() {
        let me = this,
            url = me.options.url,
            re = /^http:\/\/([a-z]{9}|(\d+\.){3}\d+):\d{0,4}/;
        me.index = parseInt(Math.random() * me.length);
        me.url = me.urls[me.index];
        url = url.replace(re, re.exec(me.url)[0]);
        me.options.url = url;
        me.options.isInTheSameDomain = Util.isInTheSameDomain(url);
        me._commit(me.options);
    }

    /**
     * @function CommonServiceBase.prototype.calculatePollingTimes
     * @description è®¡ç®å©ä½è¯·æ±å¤±è´¥æ§è¡æ¬¡æ°ã
     */
    calculatePollingTimes() {
        let me = this;
        if (me.times) {
            if (me.totalTimes > me.POLLING_TIMES) {
                if (me.times > me.POLLING_TIMES) {
                    me.totalTimes = me.POLLING_TIMES;
                } else {
                    me.totalTimes = me.times;
                }
            } else {
                if (me.times < me.totalTimes) {
                    me.totalTimes = me.times;
                }
            }
        } else {
            if (me.totalTimes > me.POLLING_TIMES) {
                me.totalTimes = me.POLLING_TIMES;
            }
        }
        me.totalTimes--;
    }

    /**
     * @function CommonServiceBase.prototype.isServiceSupportPolling
     * @description å¤æ­æå¡æ¯å¦æ¯æè½®è¯¢ã
     */
    isServiceSupportPolling() {
        let me = this;
        return !(
            me.CLASS_NAME === 'SuperMap.REST.ThemeService' || me.CLASS_NAME === 'SuperMap.REST.EditFeaturesService'
        );
    }

    /**
     * @function CommonServiceBase.prototype.serviceProcessCompleted
     * @description ç¶æå®æï¼æ§è¡æ­¤æ¹æ³ã
     * @param {Object} result - æå¡å¨è¿åçç»æå¯¹è±¡ã
     */
    serviceProcessCompleted(result) {
        result = Util.transformResult(result);
        this.events.triggerEvent('processCompleted', {
            result: result
        });
    }

    /**
     * @function CommonServiceBase.prototype.serviceProcessFailed
     * @description ç¶æå¤±è´¥ï¼æ§è¡æ­¤æ¹æ³ã
     * @param {Object} result - æå¡å¨è¿åçç»æå¯¹è±¡ã
     */
    serviceProcessFailed(result) {
        result = Util.transformResult(result);
        let error = result.error || result;
        this.events.triggerEvent('processFailed', {
            error: error
        });
    }

    _commit(options) {
        if (options.method === 'POST' || options.method === 'PUT' || options.method === 'PATCH') {
            if (options.params) {
                options.url = Util.urlAppend(options.url, Util.getParameterString(options.params || {}));
            }
            if (typeof options.data === 'object') {
                try {
                    options.params = Util.toJSON(options.data);
                } catch (e) {
                    console.log('ä¸æ¯jsonå¯¹è±¡');
                }
            } else {
                options.params = options.data;
            }
        }
        FetchRequest.commit(options.method, options.url, options.params, {
            headers: options.headers,
            withoutFormatSuffix: options.withoutFormatSuffix,
            withCredentials: options.withCredentials,
            crossOrigin: options.crossOrigin,
            timeout: options.async ? 0 : null,
            proxy: options.proxy
        })
            .then(function (response) {
                if (response.text) {
                    return response.text();
                }
                if (response.json) {
                    return response.json();
                }
                return response;
            })
            .then(function (text) {
                let requestResult = text;
                if (typeof text === 'string') {
                    requestResult = new JSONFormat().read(text);
                }
                if (
                    !requestResult ||
                    requestResult.error ||
                    (requestResult.code >= 300 && requestResult.code !== 304)
                ) {
                    if (requestResult && requestResult.error) {
                        requestResult = {
                            error: requestResult.error
                        };
                    } else {
                        requestResult = {
                            error: requestResult
                        };
                    }
                }
                return requestResult;
            })
            .catch(function (e) {
                return { error: e };
            })
            .then((requestResult) => {
                if (requestResult.error) {
                    var failure = options.scope ? FunctionExt.bind(options.failure, options.scope) : options.failure;
                    failure(requestResult);
                } else {
                    requestResult.succeed = requestResult.succeed == undefined ? true : requestResult.succeed;
                    var success = options.scope ? FunctionExt.bind(options.success, options.scope) : options.success;
                    success(requestResult);
                }
            });
    }
}


/**
 * æå¡å¨è¯·æ±åè°å½æ°
 * @callback RequestCallback
 * @category BaseTypes Util
 * @example
 * var requestCallback = function (serviceResult){
 *      console.log(serviceResult.result);
 * }
 * new QueryService(url).queryByBounds(param, requestCallback);
 * @param {Object} serviceResult
 * @param {Object} serviceResult.result æå¡å¨è¿åç»æã
 * @param {Object} serviceResult.object åå¸åºç¨ç¨åºäºä»¶çå¯¹è±¡ã
 * @param {Object} serviceResult.type äºä»¶ç±»åã
 * @param {Object} serviceResult.element æ¥åæµè§å¨äºä»¶ç DOM èç¹ã
 */

;// CONCATENATED MODULE: ./src/common/iServer/GeoCodingParameter.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class GeoCodingParameter
 * @deprecatedclass SuperMap.GeoCodingParameter
 * @category  iServer AddressMatch
 * @classdesc å°çæ­£åå¹éåæ°ç±»ã
 * @param {Object} options - åæ°ã
 * @param {string} options.address - å°ç¹å³é®è¯ã
 * @param {number} [options.fromIndex] - è®¾ç½®è¿åå¯¹è±¡çèµ·å§ç´¢å¼å¼ã
 * @param {number} [options.toIndex] - è®¾ç½®è¿åå¯¹è±¡çç»æç´¢å¼å¼ã
 * @param {Array.<string>} [options.filters] - è¿æ»¤å­æ®µï¼éå®æ¥è¯¢åºåã
 * @param {string} [options.prjCoordSys] - æ¥è¯¢ç»æçåæ ç³»ã
 * @param {number} [options.maxReturn] - æå¤§è¿åç»ææ°ã
 * @usage
 */
class GeoCodingParameter {
    constructor(options) {
        if (options.filters && typeof(options.filters) === 'string') {
            options.filters =  options.filters.split(',');
        }
        /**
         * @member {string} GeoCodingParameter.prototype.address
         * @description å°ç¹å³é®è¯ã
         */
        this.address = null;

        /**
         * @member {number} [GeoCodingParameter.prototype.fromIndex]
         * @description è®¾ç½®è¿åå¯¹è±¡çèµ·å§ç´¢å¼å¼ã
         */
        this.fromIndex = null;

        /**
         * @member {number} [GeoCodingParameter.prototype.toIndex]
         * @description è®¾ç½®è¿åå¯¹è±¡çç»æç´¢å¼å¼ã
         */
        this.toIndex = null;

        /**
         * @member {Array.<string>} [GeoCodingParameter.prototype.filters]
         * @description è¿æ»¤å­æ®µï¼éå®æ¥è¯¢åºåã
         */
        this.filters = null;

        /**
         * @member {string} [GeoCodingParameter.prototype.prjCoordSys]
         * @description  æ¥è¯¢ç»æçåæ ç³»ã
         */
        this.prjCoordSys = null;

        /**
         * @member {number} [GeoCodingParameter.prototype.maxReturn]
         * @description æå¤§è¿åç»ææ°ã
         */
        this.maxReturn = null;
        Util.extend(this, options);
    }

    /**
     * @function GeoCodingParameter.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        this.address = null;
        this.fromIndex = null;
        this.toIndex = null;
        this.filters = null;
        this.prjCoordSys = null;
        this.maxReturn = null;
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/GeoDecodingParameter.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class GeoDecodingParameter
 * @deprecatedclass SuperMap.GeoDecodingParameter
 * @category iServer AddressMatch
 * @classdesc å°çååå¹éåæ°ç±»ã
 * @param {Object} options - åæ°ã
 * @param {number} options.x - æ¥è¯¢ä½ç½®çæ¨ªåæ ã
 * @param {number} options.y - æ¥è¯¢ä½ç½®ççºµåæ ã
 * @param {number} [options.fromIndex] - è®¾ç½®è¿åå¯¹è±¡çèµ·å§ç´¢å¼å¼ã
 * @param {Array.<string>} [options.filters] - è¿æ»¤å­æ®µï¼éå®æ¥è¯¢åºåã
 * @param {string} [options.prjCoordSys] - æ¥è¯¢ç»æçåæ ç³»ã
 * @param {number} [options.maxReturn] - æå¤§è¿åç»ææ°ã
 * @param {number} [options.geoDecodingRadius] - æ¥è¯¢åå¾ã
 * @usage
 */
class GeoDecodingParameter {


    constructor(options) {

        if (options.filters) {
            options.filters = options.filters.split(',');
        }
        /**
         * @member {number} GeoDecodingParameter.prototype.x
         * @description æ¥è¯¢ä½ç½®çæ¨ªåæ ã
         */
        this.x = null;

        /**
         * @member {number} GeoDecodingParameter.prototype.y
         * @description æ¥è¯¢ä½ç½®ççºµåæ ã
         */
        this.y = null;
        /**
         * @member {number} [GeoDecodingParameter.prototype.fromIndex]
         * @description  è®¾ç½®è¿åå¯¹è±¡çèµ·å§ç´¢å¼å¼ã
         */
        this.fromIndex = null;

        /**
         * @member {number} [GeoDecodingParameter.prototype.toIndex]
         * @description è®¾ç½®è¿åå¯¹è±¡çç»æç´¢å¼å¼ã
         */
        this.toIndex = null;

        /**
         * @member {Array.<string>} [GeoDecodingParameter.prototype.filters]
         * @description è¿æ»¤å­æ®µï¼éå®æ¥è¯¢åºåã
         */
        this.filters = null;

        /**
         * @member {string} [GeoDecodingParameter.prototype.prjCoordSys]
         * @description æ¥è¯¢ç»æçåæ ç³»ã
         */
        this.prjCoordSys = null;

        /**
         *  @member {number} [GeoDecodingParameter.prototype.maxReturn]
         *  @description æå¤§è¿åç»ææ°ã
         */
        this.maxReturn = null;

        /**
         * @member {number} GeoDecodingParameter.prototype.geoDecodingRadius
         * @description æ¥è¯¢åå¾ã
         */
        this.geoDecodingRadius = null;
        Util.extend(this, options);
    }

    /**
     * @function GeoDecodingParameter.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        this.x = null;
        this.y = null;
        this.fromIndex = null;
        this.toIndex = null;
        this.filters = null;
        this.prjCoordSys = null;
        this.maxReturn = null;
        this.geoDecodingRadius = null;
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/AddressMatchService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class AddressMatchService
 * @deprecatedclass SuperMap.AddressMatchService
 * @category iServer AddressMatch
 * @classdesc å°åå¹éæå¡ï¼åæ¬æ­£åå¹éåååå¹éã
 * @param {string} url - æå¡å°åã
 * @param {Object} options - å¯éåæ°ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class AddressMatchService_AddressMatchService extends CommonServiceBase {
    constructor(url, options) {
        super(url, options);
        this.options = options || {};
        this.CLASS_NAME = 'SuperMap.AddressMatchService';
    }

    /**
     * @function AddressMatchService.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function AddressMatchService.prototype.code
     * @param {string} url - æ­£åå°åå¹éæå¡å°åã
     * @param {GeoCodingParameter} params - æ­£åå°åå¹éæå¡åæ°ã
     */
    code(url, params) {
        if (!(params instanceof GeoCodingParameter)) {
            return;
        }
        this.processAsync(url, params);
    }

    /**
     * @function AddressMatchService.prototype.decode
     * @param {string} url - ååå°åå¹éæå¡å°åã
     * @param {GeoDecodingParameter} params - ååå°åå¹éæå¡åæ°ã
     */
    decode(url, params) {
        if (!(params instanceof GeoDecodingParameter)) {
            return;
        }
        this.processAsync(url, params);
    }

    /**
     * @function AddressMatchService.prototype.processAsync
     * @description è´è´£å°å®¢æ·ç«¯çå¨æåæ®µæå¡åæ°ä¼ éå°æå¡ç«¯ã
     * @param {string} url - æå¡å°åã
     * @param {Object} params - åæ°ã
     */

    processAsync(url, params) {
        this.request({
            method: 'GET',
            url,
            params,
            scope: this,
            success: this.serviceProcessCompleted,
            failure: this.serviceProcessFailed
        });
    }

    /**
     * @function AddressMatchService.prototype.serviceProcessCompleted
     * @param {Object} result - æå¡å¨è¿åçç»æå¯¹è±¡ã
     * @description æå¡æµç¨æ¯å¦å®æ
     */
    serviceProcessCompleted(result) {
        if (result.succeed) {
            delete result.succeed;
        }
        super.serviceProcessCompleted(result);
    }

    /**
     * @function AddressMatchService.prototype.serviceProcessCompleted
     * @param {Object} result - æå¡å¨è¿åçç»æå¯¹è±¡ã
     * @description æå¡æµç¨æ¯å¦å¤±è´¥
     */
    serviceProcessFailed(result) {
        super.serviceProcessFailed(result);
    }
}


;// CONCATENATED MODULE: ./src/common/iServer/AggregationParameter.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class AggregationParameter
 * @deprecatedclass SuperMap.AggregationParameter
 * @classdesc èåæ¥è¯¢åæ°è®¾ç½®ï¼è¯¥åæ°ä»æ¯ææ°æ®æ¥æº Elasticsearch æå¡çæ°æ®æå¡ã
 * @category iServer Data FeatureResults
 * @param {Object} options - åæ°ã
 * @param {string} options.aggName - èååç§°ã
 * @param {string} options.aggFieldName - èåå­æ®µã
 * @usage
 */
class AggregationParameter {
    constructor(options) {
        /**
         * @member {string} AggregationParameter.prototype.aggName
         * @description èååç§°ã
         */
        this.aggName = null;
        /**
         * @member {string} AggregationParameter.prototype.aggFieldName
         * @description èåå­æ®µã
         */
        this.aggFieldName = null;

        this.CLASS_NAME = 'SuperMap.AggregationParameter';
        Util.extend(this, options);
    }

    destroy() {
        var me = this;
        me.aggName = null;
        me.aggFieldName = null;
        me.aggType = null;
    }
}


;// CONCATENATED MODULE: ./src/common/iServer/BucketAggParameter.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class BucketAggParameter
 * @deprecatedclass SuperMap.BucketAggParameter
 * @classdesc å­èåç±»æ¥è¯¢åæ°è®¾ç½®ï¼è¯¥åæ°ä»æ¯ææ°æ®æ¥æº Elasticsearch æå¡çSupermap iServerçrestæ°æ®æå¡ã
 * @category iServer Data FeatureResults
 * @param {Object} options - åæ°ã
 * @param {Array.<MetricsAggParameter>} options.subAggs - å­èåç±»éåã
 * @extends {AggregationParameter}
 * @usage
 */
class BucketAggParameter extends AggregationParameter {
    constructor(options) {
        super();
        /**
         * @member {Array.<MetricsAggParameter>} BucketAggParameter.prototype.subAggs
         * @description å­èåç±»éåã
         */
        this.subAggs = null;
        this.aggType = null;

        this.CLASS_NAME = 'SuperMap.BucketAggParameter';
        Util.extend(this, options);
    }

    destroy() {
        var me = this;
        if (me.subAggs) {
            me.subAggs = null;
        }
    }
}


;// CONCATENATED MODULE: ./src/common/iServer/MetricsAggParameter.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class MetricsAggParameter
 * @deprecatedclass SuperMap.MetricsAggParameter
 * @classdesc ææ èåæ¥è¯¢åæ°ç±»ï¼è¯¥åæ°ä»æ¯ææ°æ®æ¥æº Elasticsearch æå¡çSupermap iServerçrestæ°æ®æå¡ã
 * @category iServer Data FeatureResults
 * @param {Object} options - å¯éåæ°ã
 * @param {MetricsAggType} [options.aggType = 'avg'] - èåç±»åã
 * @extends {AggregationParameter}
 * @usage
 */
class MetricsAggParameter extends AggregationParameter {
    constructor(option) {
        super();
        /**
         * @member {MetricsAggType} [MetricsAggParameter.prototype.aggType=MetricsAggType.AVG]
         * @description ææ èåç±»åã
         */
        this.aggType = MetricsAggType.AVG;

        Util.extend(this, option);
        this.CLASS_NAME = 'SuperMap.MetricsAggParameter';
    }

    destroy() {
        super.destroy();
        var me = this;
        me.aggType = null;
    }
}


;// CONCATENATED MODULE: ./src/common/iServer/AreaSolarRadiationParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class AreaSolarRadiationParameters
 * @deprecatedclass SuperMap.AreaSolarRadiationParameters
 * @category iServer SpatialAnalyst SolarRadiationAnalyst
 * @classdesc å°åºå¤ªé³è¾å°åæ°ç±»ã
 * @param {Object} options - åæ°ã
 * @param {string} options.dataset - è¦ç¨æ¥åå°åºå¤ªé³è¾å°æ°æ®æºä¸­æ°æ®éçåç§°ãè¯¥åç§°ç¨å½¢å¦"æ°æ®éåç§°@æ°æ®æºå«å"çå½¢å¼æ¥è¡¨ç¤ºï¼ä¾å¦ï¼JingjinTerrain@Jingjinã
 * @param {string} options.targetDatasourceName - æå®çå­å¨ç»ææ°æ®éçæ°æ®æºåç§°, ä¾å¦ï¼"Jingjin"ã
 * @param {string} options.totalGridName - æå®å°åºå¤ªé³è¾å°æ»è¾å°éæ°æ®éçåç§°ã
 * @param {string} options.diffuseDatasetGridName - æå®å°åºå¤ªé³è¾å°æ£å°è¾å°éæ°æ®éçåç§°ã
 * @param {string} options.durationDatasetGridName - æå®å°åºå¤ªé³è¾å°å¤ªé³ç´å°æç»­æ¶é´æ°æ®éçåç§°ã
 * @param {string} options.directDatasetGridName - æå®å°åºå¤ªé³è¾å°ç´å°è¾å°éæ°æ®éçåç§°ã
 * @param {number} options.latitude - å¾è®¡ç®åºåççº¬åº¦å¼ã
 * @param {string} [options.timeMode = 'MULTIDAYS'] - æ¶é´æ¨¡å¼ãå¯éå¼"WITHINDAY"ï¼åæ¥ï¼æ"MULTIDAYS"ï¼å¤æ¥ï¼ã
 * @param {number} options.dayStart - èµ·å§æ¥æï¼å¹´åçç¬¬å å¤©ï¼ã
 * @param {number} options.dayEnd - ç»ææ¥æï¼å¹´åçç¬¬å å¤©ï¼ã
 * @param {number} [options.hourStart] - èµ·å§æ¶é´ï¼ä¸å¤©ä¸­çç¬¬å ä¸ªå°æ¶ï¼ã
 * @param {number} [options.hourEnd] - ç»ææ¶é´ï¼ä¸å¤©ä¸­çç¬¬å ä¸ªå°æ¶ï¼ã
 * @param {number} [options.transmittance] - å¤ªé³è¾å°ç©¿è¿å¤§æ°çéå°çã
 * @param {number} [options.hourInterval=0.5] - è®¡ç®æ¶çå°æ¶é´éï¼è®¾ç½®çè¶å°è®¡ç®éè¶å¤§å¹¶ä¸è®¡ç®ç»ææ´ç²¾ç¡®ï¼å¦æä¿®æ¹æ­¤åæ°ï¼å¿é¡»ä½¿ç¨æ´æ°ï¼ã
 * @param {number} [options.dayInterval=5] - è®¡ç®æ¶çå¤©æ°é´éï¼è®¾ç½®çè¶å°è®¡ç®éè¶å¤§å¹¶ä¸è®¡ç®ç»ææ´ç²¾ç¡®ï¼å¿é¡»ä½¿ç¨æ´æ°ï¼ã
 * @param {boolean} [options.deleteExistResultDataset=false] - å¦æç¨æ·å½åçç»ææ°æ®éåç§°ä¸å·²æçæ°æ®ééåï¼æ¯å¦å é¤å·²æçæ°æ®éã
 * @usage
 */
class AreaSolarRadiationParameters {

    constructor(options) {
        /**
         *  @member {string} AreaSolarRadiationParameters.prototype.dataset
         *  @description è¦ç¨æ¥åå°åºå¤ªé³è¾å°æ°æ®æºä¸­æ°æ®éçåç§°ãè¯¥åç§°ç¨å½¢å¦âæ°æ®éåç§°@æ°æ®æºå«åâå½¢å¼æ¥è¡¨ç¤ºï¼ä¾å¦ï¼JingjinTerrain@Jingjinãæ³¨ï¼å°åºå¤ªé³è¾å°æ°æ®å¿é¡»ä¸ºæ æ ¼æ°æ®éã
         */
        this.dataset = null;

        /**
         * @member {string} AreaSolarRadiationParameters.prototype.targetDatasourceName
         * @description æå®çå­å¨ç»ææ°æ®éçæ°æ®æºåç§°ï¼ä¾å¦ï¼"Jingjin"ã
         */
        this.targetDatasourceName = null;

        /**
         * @member {string} AreaSolarRadiationParameters.prototype.totalGridName
         * @description æå®å°åºå¤ªé³è¾å°æ»è¾å°éæ°æ®éçåç§°ã
         */
        this.totalGridName = null;

        /**
         * @member {string} AreaSolarRadiationParameters.prototype.diffuseDatasetGridName
         * @description æå®å°åºå¤ªé³è¾å°æ£å°è¾å°éæ°æ®éçåç§°ã
         */
        this.diffuseDatasetGridName = null;

        /**
         * @member {string} AreaSolarRadiationParameters.prototype.durationDatasetGridName
         * @description  æå®å°åºå¤ªé³è¾å°å¤ªé³ç´å°æç»­æ¶é´æ°æ®éçåç§°ã
         */
        this.durationDatasetGridName = null;

        /**
         * @member {string} AreaSolarRadiationParameters.prototype.directDatasetGridName
         * @description æå®å°åºå¤ªé³è¾å°ç´å°è¾å°éæ°æ®éçåç§°ã
         */
        this.directDatasetGridName = null;

        /**
         * @member {number} AreaSolarRadiationParameters.prototype.latitude
         * @description å¾è®¡ç®åºåççº¬åº¦å¼ã
         */
        this.latitude = null;

        /**
         *  @member {string} [AreaSolarRadiationParameters.prototype.timeMode='MULTIDAYS']
         *  @description æ¶é´æ¨¡å¼ãå¯éå¼"WITHINDAY"ï¼åæ¥ï¼æ"MULTIDAYS"ï¼å¤æ¥ï¼ã
         */
        this.timeMode = "MULTIDAYS";

        /**
         *  @member {number} AreaSolarRadiationParameters.prototype.dayStart
         *  @description èµ·å§æ¥æï¼å¹´åçç¬¬å å¤©ï¼ã
         */
        this.dayStart = null;

        /**
         *  @member {number} AreaSolarRadiationParameters.prototype.dayEnd
         * @description ç»ææ¥æï¼å¹´åçç¬¬å å¤©ï¼ã
         */
        this.dayEnd = null;

        /**
         * @member {number} [AreaSolarRadiationParameters.prototype.hourStart]
         * @description èµ·å§æ¶é´ï¼ä¸å¤©ä¸­çç¬¬å ä¸ªå°æ¶ï¼ã
         */
        this.hourStart = null;

        /**
         * @member {number} [AreaSolarRadiationParameters.prototype.hourEnd]
         * @description ç»ææ¶é´ï¼ä¸å¤©ä¸­çç¬¬å ä¸ªå°æ¶ï¼ã
         */
        this.hourEnd = null;

        /**
         * @member {number} [AreaSolarRadiationParameters.prototype.transmittance]
         * @description å¤ªé³è¾å°ç©¿è¿å¤§æ°çéå°çã
         */
        this.transmittance = null;

        /**
         *  @member {number} [AreaSolarRadiationParameters.prototype.hourInterval=0.5]
         *  @description è®¡ç®æ¶çå°æ¶é´éï¼è®¾ç½®çè¶å°è®¡ç®éè¶å¤§å¹¶ä¸è®¡ç®ç»ææ´ç²¾ç¡®, å¦æä¿®æ¹æ­¤åæ°ï¼å¿é¡»ä½¿ç¨æ´æ°ï¼
         */
        this.hourInterval = null;

        /**
         * @member {number} [AreaSolarRadiationParameters.prototype.dayInterval=5]
         * @description è®¡ç®æ¶çå¤©æ°é´éï¼è®¾ç½®çè¶å°è®¡ç®éè¶å¤§å¹¶ä¸è®¡ç®ç»ææ´ç²¾ç¡®, å¿é¡»ä½¿ç¨æ´æ°ï¼
         */
        this.dayInterval = null;

        /**
         * @member {boolean} [AreaSolarRadiationParameters.prototype.deleteExistResultDataset=false]
         * @description å¦æç¨æ·å½åçç»ææ°æ®éåç§°ä¸å·²æçæ°æ®ééåï¼æ¯å¦å é¤å·²æçæ°æ®éã
         */
        this.deleteExistResultDataset = false;

        Util.extend(this, options);

        this.CLASS_NAME = "SuperMap.AreaSolarRadiationParameters";
    }

    /**
     * @function AreaSolarRadiationParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.dataset = null;
        me.zFactor = 1.0;
        me.averageCurvatureName = null;
        me.profileCurvatureName = null;
        me.planCurvatureName = null;
        me.deleteExistResultDataset = true;
    }

    /**
     * @function AreaSolarRadiationParameters.toObject
     * @param {AreaSolarRadiationParameters} param - å°åºå¤ªé³è¾å°åæ°ç±»ã
     * @param {AreaSolarRadiationParameters} tempObj - å°åºå¤ªé³è¾å°åæ°å¯¹è±¡ã
     * @returns {Object} JSONå¯¹è±¡ã
     * @description å°AreaSolarRadiationParameterså¯¹è±¡è½¬æ¢æJSONå¯¹è±¡ã
     */
    static toObject(param, tempObj) {
        var parameter = {};
        for (var name in param) {
            if (name !== "dataset") {
                var name1 = (name === "latitude" || name === "timeMode" || name === "dayStart");
                var name2 = (name === "dayEnd" || name === "hourStart" || name === "hourEnd");
                var name3 = (name === "transmittance" || name === "hourInterval" || name === "dayInterval");
                if (name1 || name2 || name3) {
                    parameter[name] = param[name];
                } else {
                    tempObj[name] = param[name];
                }
            }
        }
        tempObj["parameter"] = parameter;
    }
}

;// CONCATENATED MODULE: ./src/common/iServer/SpatialAnalystBase.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class SpatialAnalystBase
 * @deprecatedclass SuperMap.SpatialAnalystBase
 * @category  iServer Core
 * @classdesc ç©ºé´åææå¡åºç±»ã
 * @param {string} url - å°åã
 * @param {Object} options - å¯éåæ°ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @extends {CommonServiceBase}
 * @usage
 */
class SpatialAnalystBase extends CommonServiceBase {

    constructor(url, options) {
        super(url, options);
        /**
         * @member {DataFormat} [SpatialAnalystBase.prototype.format=DataFormat.GEOJSON]
         * @description æ¥è¯¢ç»æè¿åæ ¼å¼ï¼ç®åæ¯æ iServerJSON å GeoJSON ä¸¤ç§æ ¼å¼ï¼åæ°æ ¼å¼ä¸º "ISERVER"ï¼"GEOJSON"ã
         */
        this.format = DataFormat.GEOJSON;
        this.CLASS_NAME = "SuperMap.SpatialAnalystBase";
    }

    /**
     * @function SpatialAnalystBase.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
        this.format = null;
    }

    /**
     * @function SpatialAnalystBase.prototype.serviceProcessCompleted
     * @description åæå®æï¼æ§è¡æ­¤æ¹æ³ã
     * @param {Object} result - æå¡å¨è¿åçç»æå¯¹è±¡ã
     */
    serviceProcessCompleted(result) {
        var me = this, analystResult;
        result = Util.transformResult(result);
        if (result && me.format === DataFormat.GEOJSON && typeof me.toGeoJSONResult === 'function') {
            //æ¹éåææ¶ä¼è¿åå¤ä¸ªç»æ
            if (Util.isArray(result)) {
                for (var i = 0; i < result.length; i++) {
                    result[i] = me.toGeoJSONResult(result[i])
                }
                analystResult = result;

            } else {
                analystResult = me.toGeoJSONResult(result);
            }
        }
        if (!analystResult) {
            analystResult = result;
        }
        me.events.triggerEvent("processCompleted", {result: analystResult});
    }

    /**
     * @function SpatialAnalystBase.prototype.toGeoJSONResult
     * @description å°å«æ geometry çæ°æ®è½¬æ¢ä¸º GeoJSON æ ¼å¼ã
     * @param {Object} result - æå¡å¨è¿åçç»æå¯¹è±¡ã
     *
     */
    toGeoJSONResult(result) {
        if (!result) {
            return null;
        }
        //æ¹éå å åææ¶ç»æè¿æ ·å¤ç
        if (result.result && result.result.resultGeometry) {
            result = result.result
        }
        var geoJSONFormat = new GeoJSON();
        if (result.recordsets) {
            for (var i = 0, recordsets = result.recordsets, len = recordsets.length; i < len; i++) {
                if (recordsets[i].features) {
                    recordsets[i].features = geoJSONFormat.toGeoJSON(recordsets[i].features);
                }
            }
        } else if (result.recordset && result.recordset.features) {
            result.recordset.features =geoJSONFormat.toGeoJSON(result.recordset.features);
        }
        if (result.resultGeometry) {
            result.resultGeometry = geoJSONFormat.toGeoJSON(result.resultGeometry);
        }
        if (result.regions) {
            result.regions = geoJSONFormat.toGeoJSON(result.regions);
        }

        return result;
    }

}


;// CONCATENATED MODULE: ./src/common/iServer/AreaSolarRadiationService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class AreaSolarRadiationService
 * @deprecatedclass SuperMap.AreaSolarRadiationService
 * @category iServer SpatialAnalyst SolarRadiationAnalyst
 * @classdesc å°åºå¤ªé³è¾å°æå¡ç±»ã
 * @param {string} url - æå¡çè®¿é®å°åãå¦ï¼</br>http://localhost:8090/iserver/services/spatialanalyst-sample/restjsr/spatialanalystã</br>
 * @param {Object} options - åæ°ã</br>
 * @param {Object} options.eventListeners - éè¦è¢«æ³¨åççå¬å¨å¯¹è±¡ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @extends {SpatialAnalystBase}
 * @example ä¾å¦ï¼
 * (start code)
 * var myAreaSolarRadiationService = new AreaSolarRadiationService(url);
 * myAreaSolarRadiationService.on({
     *     "processCompleted": processCompleted,
     *     "processFailed": processFailed
     *     }
 * );
 * (end)
 * @usage
 */
class AreaSolarRadiationService extends SpatialAnalystBase {

    constructor(url, options) {
        super(url, options);
        this.CLASS_NAME = "SuperMap.AreaSolarRadiationService";
    }

    /**
     * @function AreaSolarRadiationService.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function AreaSolarRadiationService.prototype.processAsync
     * @description è´è´£å°å®¢æ·ç«¯çæ¥è¯¢åæ°ä¼ éå°æå¡ç«¯ã
     * @param {AreaSolarRadiationParameters} parameter - å°åºå¤ªé³è¾å°åæ°ã
     */
    processAsync(parameter) {
        if (!(parameter instanceof AreaSolarRadiationParameters)) {
            return;
        }
        var me = this;
        var parameterObject = {};

        if (parameter instanceof AreaSolarRadiationParameters) {
            me.url = Util.urlPathAppend(me.url, `datasets/${parameter.dataset}/solarradiation`);
        }
        me.url = Util.urlAppend(me.url, 'returnContent=true');
        AreaSolarRadiationParameters.toObject(parameter, parameterObject);
        var jsonParameters = Util.toJSON(parameterObject);

        me.request({
            method: 'POST',
            data: jsonParameters,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }
}



;// CONCATENATED MODULE: ./src/common/iServer/BufferDistance.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class BufferDistance
 * @deprecatedclass SuperMap.BufferDistance
 * @category iServer SpatialAnalyst BufferAnalyst
 * @classdesc ç¼å²åºåæçç¼å²è·ç¦»ç±»ãéè¿è¯¥ç±»å¯ä»¥è®¾ç½®ç¼å²åºåæçç¼å²è·ç¦»ï¼è·ç¦»å¯ä»¥æ¯æ°å¼ä¹å¯ä»¥æ¯æ°å¼åçå­æ®µè¡¨è¾¾å¼ã
 * @param {Object} options - å¯éåæ°ã
 * @param {string} [options.exp] - ä»¥æ°å¼åçå­æ®µè¡¨è¾¾å¼ä½ä¸ºç¼å²åºåæçè·ç¦»å¼ã
 * @param {number} [options.value=100] - ä»¥æ°å¼ä½ä¸ºç¼å²åºåæçè·ç¦»å¼ãåä½ï¼ç±³ã
 * @usage
 */
class BufferDistance {


    constructor(options) {
        /**
         * @member {string} [BufferDistance.prototype.exp]
         * @description ä»¥æ°å¼åçå­æ®µè¡¨è¾¾å¼ä½ä¸ºç¼å²åºåæçè·ç¦»å¼ã
         */
        this.exp = null;

        /**
         * @member {number} [BufferDistance.prototype.value=100]
         * @description ä»¥æ°å¼ä½ä¸ºç¼å²åºåæçè·ç¦»å¼ãåä½ï¼ç±³ã
         */
        this.value = 100;

        Util.extend(this, options);

        this.CLASS_NAME = "SuperMap.BufferDistance";
    }

    /**
     * @function BufferDistance.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        this.exp = null;
        this.value = null;
    }


}

;// CONCATENATED MODULE: ./src/common/iServer/BufferSetting.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class BufferSetting
 * @deprecatedclass SuperMap.BufferSetting
 * @category iServer SpatialAnalyst BufferAnalyst
 * @classdesc ç¼å²åºåæéç¨è®¾ç½®ç±»ã
 * @param {Object} options - å¯éåæ°ã
 * @param {BufferEndType} [options.endType=BufferEndType.FLAT] - ç¼å²åºç«¯ç¹æä¸¾å¼ã
 * @param {BufferDistance} [options.leftDistance=100] - å·¦ä¾§ç¼å²è·ç¦»ã
 * @param {BufferDistance} [options.rightDistance=100] - å³ä¾§ç¼å²è·ç¦»ã
 * @param {number} [options.semicircleLineSegment=4] - åå¤´ç¼å²åå¼§å¤çº¿æ®µçä¸ªæ°ã
 * @param {BufferRadiusUnit} [options.radiusUnit=BufferRadiusUnit.METER] - ç¼å²åå¾åä½ã
 * @usage
 */
class BufferSetting {


    constructor(options) {
        /**
         * @member {BufferEndType} [BufferSetting.prototype.endType = BufferEndType.FLAT]
         * @description ç¼å²åºç«¯ç¹æä¸¾å¼ãåä¸ºå¹³å¤´ååå¤´ä¸¤ç§ã
         */
        this.endType = BufferEndType.FLAT;

        /**
         * @member {BufferDistance} [BufferSetting.prototype.leftDistance=100]
         * @description å·¦ä¾§ç¼å²è·ç¦»ã
         * å½ä¸º GeometryBufferAnalyst æ¶ï¼åä½ä¸ºé»è®¤å°å¾çæå½±ç³»çåä½ï¼å¦3857ä¸ºç±³ï¼4326ä¸ºåº¦ï¼ï¼
         * å½ä¸º DatasetBufferAnalyst æ¶ï¼åä½éè¿{@link BufferSetting.radiusUnit}è®¾ç½®ï¼é»è®¤å¨é¨ä¸ºç±³ï¼ã
         */
        this.leftDistance = new BufferDistance();

        /**
         * @member {BufferDistance} [BufferSetting.prototype.rightDistance=100]
         * @description å³ä¾§ç¼å²è·ç¦»ã
         * å½ä¸º GeometryBufferAnalyst æ¶ï¼åä½ä¸ºé»è®¤å°å¾çæå½±ç³»çåä½ï¼å¦3857ä¸ºç±³ï¼4326ä¸ºåº¦ï¼ï¼
         * å½ä¸º DatasetBufferAnalyst æ¶ï¼åä½éè¿{@link BufferSetting#radiusUnit}è®¾ç½®ï¼é»è®¤å¨é¨ä¸ºç±³ï¼ã
         */
        this.rightDistance = new BufferDistance();

        /**
         * @member {number} [BufferSetting.prototype.semicircleLineSegment=4]
         * @description åå¤´ç¼å²åå¼§å¤çº¿æ®µçä¸ªæ°ãå³ç¨å¤å°ä¸ªçº¿æ®µæ¥æ¨¡æä¸ä¸ªååã
         */
        this.semicircleLineSegment = 4;

        /**
         * @member {BufferRadiusUnit} [BufferSetting.prototype.radiusUnit = BufferRadiusUnit.METER]
         * @description ç¼å²åå¾åä½ï¼å¯ä»¥æ¯{@link BufferRadiusUnit.METER}ã{@link BufferRadiusUnit.MILLIMETER}ã
         * {@link BufferRadiusUnit.CENTIMETER}ã{@link BufferRadiusUnit.DECIMETER}ã{@link BufferRadiusUnit.KILOMETER}ã
         * {@link BufferRadiusUnit.FOOT}ã{@link BufferRadiusUnit.INCH}ã{@link BufferRadiusUnit.MILE}ã{@link BufferRadiusUnit.YARD}ã
         * ä»å¯¹BufferAnalystææã
         */
        this.radiusUnit = BufferRadiusUnit.METER;

        if (options) {
            Util.extend(this, options);
        }
        this.CLASS_NAME = "SuperMap.BufferSetting";
    }


    /**
     * @function BufferSetting.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        let me = this;
        me.endType = null;
        if (me.leftDistance) {
            me.leftDistance.destroy();
            me.leftDistance = null;
        }
        if (me.rightDistance) {
            me.rightDistance.destroy();
            me.rightDistance = null;
        }
        me.semicircleLineSegment = null;
        me.radiusUnit = null;
    }
}

;// CONCATENATED MODULE: ./src/common/iServer/BufferAnalystParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class BufferAnalystParameters
 * @deprecatedclass SuperMap.BufferAnalystParameters
 * @category iServer SpatialAnalyst BufferAnalyst
 * @classdesc ç¼å²åºåæåæ°åºç±»ã
 * @param {Object} options - åæ°ã
 * @param {BufferSetting} [options.bufferSetting] - è®¾ç½®ç¼å²åºéç¨åæ°ãä¸ºç¼å²åºåææä¾å¿è¦çåæ°ä¿¡æ¯ï¼åæ¬å·¦ç¼å²è·ç¦»ãå³ç¼å²è·ç¦»ãç«¯ç¹ç±»åãåå¤´ç¼å²åå¼§å¤çº¿æ®µçä¸ªæ°ä¿¡æ¯ã
 * @usage
 */
class BufferAnalystParameters {


    constructor(options) {
        var me = this;
        /**
         * @member {BufferSetting} [BufferAnalystParameters.prototype.bufferSetting]
         * @description è®¾ç½®ç¼å²åºéç¨åæ°ãä¸ºç¼å²åºåææä¾å¿è¦çåæ°ä¿¡æ¯ï¼åæ¬å·¦ç¼å²è·ç¦»ãå³ç¼å²è·ç¦»ãç«¯ç¹ç±»åãåå¤´ç¼å²åå¼§å¤çº¿æ®µçä¸ªæ°ä¿¡æ¯ã
         */
        me.bufferSetting = new BufferSetting();
        Util.extend(this, options);
        this.CLASS_NAME = "SuperMap.BufferAnalystParameters";
    }


    /**
     * @function BufferAnalystParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        if (me.bufferSetting) {
            me.bufferSetting.destroy();
            me.bufferSetting = null;
        }
    }


}

;// CONCATENATED MODULE: ./src/common/iServer/DataReturnOption.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class DataReturnOption
 * @deprecatedclass SuperMap.DataReturnOption
 * @category iServer Data Dataset
 * @classdesc æ°æ®è¿åè®¾ç½®ç±»ã
 * @param {Object} options - åæ°ã
 * @param {number} [options.expectCount=1000] - è®¾ç½®è¿åçæå¤§è®°å½æ°ï¼å°äºæèç­äº 0 æ¶è¡¨ç¤ºè¿åææè®°å½æ°ã
 * @param {string} [options.dataset] - è®¾ç½®ç»ææ°æ®éæ è¯ï¼å½ dataReturnMode ä¸º {@link DataReturnMode.DATASET_ONLY}æ{@link DataReturnMode.DATASET_AND_RECORDSET}æ¶ææï¼
 *                                   ä½ä¸ºè¿åæ°æ®éçåç§°ãè¯¥åç§°ç¨å½¢å¦âæ°æ®éåç§°@æ°æ®æºå«åâå½¢å¼æ¥è¡¨ç¤ºã
 * @param {DataReturnMode} [options.dataReturnMode=DataReturnMode.RECORDSET_ONLY] - æ°æ®è¿åæ¨¡å¼ã
 * @param {boolean} [options.deleteExistResultDataset=true] - å¦æç¨æ·å½åçç»ææ°æ®éåç§°ä¸å·²æçæ°æ®ééåï¼æ¯å¦å é¤å·²æçæ°æ®éã
 * @usage
 */
class DataReturnOption {


    constructor(options) {

        /**
         * @member {number} [DataReturnOption.prototype.expectCount=1000]
         * @description è®¾ç½®è¿åçæå¤§è®°å½æ°ï¼å°äºæèç­äº0æ¶è¡¨ç¤ºè¿åææè®°å½æ°ã
         */
        this.expectCount = 1000;

        /**
         * @member {string} [DataReturnOption.prototype.dataset]
         * @description è®¾ç½®ç»ææ°æ®éæ è¯ï¼å½dataReturnModeä¸º {@link DataReturnMode.DATASET_ONLY}
         * æ{@link DataReturnMode.DATASET_AND_RECORDSET}æ¶ææï¼
         * ä½ä¸ºè¿åæ°æ®éçåç§°ãè¯¥åç§°ç¨å½¢å¦"æ°æ®éåç§°@æ°æ®æºå«å"å½¢å¼æ¥è¡¨ç¤ºã
         */
        this.dataset = null;

        /**
         * @member {DataReturnMode} [DataReturnOption.prototype.dataReturnMode=DataReturnMode.RECORDSET_ONLY]
         * @description æ°æ®è¿åæ¨¡å¼ã
         */
        this.dataReturnMode = DataReturnMode.RECORDSET_ONLY;

        /**
         * @member {boolean} [DataReturnOption.prototype.deleteExistResultDataset=true]
         * @description å¦æç¨æ·å½åçç»ææ°æ®éåç§°ä¸å·²æçæ°æ®ééåï¼æ¯å¦å é¤å·²æçæ°æ®éã
         */
        this.deleteExistResultDataset = true;

        Util.extend(this, options);
        this.CLASS_NAME = "SuperMap.DataReturnOption";
    }

    /**
     * @function DataReturnOption.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.expectCount = null;
        me.dataset = null;
        me.dataReturnMode = null;
        me.deleteExistResultDataset = null;
    }


}

;// CONCATENATED MODULE: ./src/common/iServer/FilterParameter.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class FilterParameter
 * @deprecatedclass SuperMap.FilterParameter
 * @category iServer Data FeatureResults
 * @classdesc æ¥è¯¢è¿æ»¤æ¡ä»¶åæ°ç±»ãè¯¥ç±»ç¨äºè®¾ç½®æ¥è¯¢æ°æ®éçæ¥è¯¢è¿æ»¤åæ°ã
 * @param {Object} options - åæ°ã
 * @param {string} options.attributeFilter - å±æ§è¿æ»¤æ¡ä»¶ã
 * @param {string} options.name - æ¥è¯¢æ°æ®éåç§°æèå¾å±åç§°ã
 * @param {Array.<JoinItem>} [options.joinItems] - ä¸å¤é¨è¡¨çè¿æ¥ä¿¡æ¯ JoinItem æ°ç»ã
 * @param {Array.<LinkItem>} [options.linkItems] - ä¸å¤é¨è¡¨çå³èä¿¡æ¯ LinkItem æ°ç»ã
 * @param {Array.<string>} [options.ids] - æ¥è¯¢ id æ°ç»ï¼å³å±æ§è¡¨ä¸­ç SmID å¼ã
 * @param {string} [options.orderBy] - æ¥è¯¢æåºçå­æ®µï¼orderBy çå­æ®µé¡»ä¸ºæ°å¼åçã
 * @param {string} [options.groupBy] - æ¥è¯¢åç»æ¡ä»¶çå­æ®µã
 * @param {Array.<string>} [options.fields] - æ¥è¯¢å­æ®µæ°ç»ã
 * @usage
 */
class FilterParameter {


    constructor(options) {
        /**
         * @member {string} FilterParameter.prototype.attributeFilter
         * @description å±æ§è¿æ»¤æ¡ä»¶ã
         * ç¸å½äº SQL è¯­å¥ä¸­ç WHERE å­å¥ï¼å¶æ ¼å¼ä¸ºï¼WHERE <æ¡ä»¶è¡¨è¾¾å¼>ï¼
         * attributeFilter å°±æ¯å¶ä¸­çâæ¡ä»¶è¡¨è¾¾å¼âã
         * è¯¥å­æ®µçç¨æ³ä¸º attributeFilter = "è¿æ»¤æ¡ä»¶"ã
         * ä¾å¦ï¼è¦æ¥è¯¢å­æ®µ fieldValue å°äº100çè®°å½ï¼è®¾ç½® attributeFilter = "fieldValue < 100"ï¼
         * è¦æ¥è¯¢å­æ®µ name çå¼ä¸ºâéåºâçè®°å½ï¼è®¾ç½® attributeFilter = "name like '%éåº%'"ï¼ç­ç­ã
         */
        this.attributeFilter = null;

        /**
         * @member {string} FilterParameter.prototype.name
         * @description æ¥è¯¢æ°æ®éåç§°æèå¾å±åç§°ï¼æ ¹æ®å®éçæ¥è¯¢å¯¹è±¡èå®ã
         * ä¸è¬æåµä¸è¯¥å­æ®µä¸ºæ°æ®éåç§°ï¼ä½å¨è¿è¡ä¸å°å¾ç¸å³åè½çæä½æ¶ï¼
         * éè¦è®¾ç½®ä¸ºå¾å±åç§°ï¼å¾å±åç§°æ ¼å¼ï¼æ°æ®éåç§°@æ°æ®æºå«åï¼ã
         * å ä¸ºä¸ä¸ªå°å¾çå¾å±å¯è½æ¯æ¥èªäºä¸åæ°æ®æºçæ°æ®éï¼
         * èä¸åçæ°æ®æºä¸­å¯è½å­å¨ååçæ°æ®éï¼
         * ä½¿ç¨æ°æ®éåç§°ä¸è½å¯ä¸çç¡®å®æ°æ®éï¼
         * æä»¥å¨è¿è¡ä¸å°å¾ç¸å³åè½çæä½æ¶ï¼è¯¥å¼éè¦è®¾ç½®ä¸ºå¾å±åç§°ã
         */
        this.name = null;

        /**
         * @member {Array.<JoinItem>} [FilterParameter.prototype.joinItems]
         * @description ä¸å¤é¨è¡¨çè¿æ¥ä¿¡æ¯ JoinItem æ°ç»ã
         */
        this.joinItems = null;

        /**
         * @member {Array.<LinkItem>} [FilterParameter.prototype.linkItems]
         * @description ä¸å¤é¨è¡¨çå³èä¿¡æ¯ LinkItem æ°ç»ã
         */
        this.linkItems = null;

        /**
         * @member {Array.<string>} [FilterParameter.prototype.ids]
         * @description æ¥è¯¢ id æ°ç»ï¼å³å±æ§è¡¨ä¸­ç SmID å¼ã
         */
        this.ids = null;

        /**
         * @member {string} [FilterParameter.prototype.orderBy]
         * @description æ¥è¯¢æåºçå­æ®µï¼orderByçå­æ®µé¡»ä¸ºæ°å¼åçã
         * ç¸å½äº SQL è¯­å¥ä¸­ç ORDER BY å­å¥ï¼å¶æ ¼å¼ä¸ºï¼ORDER BY <åå>ï¼
         * ååå³å±æ§è¡¨ä¸­æ¯ä¸åçåç§°ï¼ååå¯ç§°ä¸ºå±æ§ï¼å¨ SuperMap ä¸­åç§°ä¸ºå­æ®µã
         * å¯¹åä¸ªå­æ®µæåºæ¶ï¼è¯¥å­æ®µçç¨æ³ä¸º orderBy = "å­æ®µå"ï¼
         * å¯¹å¤ä¸ªå­æ®µæåºæ¶ï¼å­æ®µä¹é´ä»¥è±æéå·è¿è¡åå²ï¼ç¨æ³ä¸º orderBy = "å­æ®µå1, å­æ®µå2"ã
         * ä¾å¦ï¼ç°æä¸ä¸ªå½å®¶æ°æ®éï¼å®æä¸¤ä¸ªå­æ®µåå«ä¸ºâSmAreaâåâpop_1994âï¼
         * åå«è¡¨ç¤ºå½å®¶çé¢ç§¯å1994å¹´çåå½äººå£æ°éã
         * å¦æè¦æç§åå½äººå£æ°éå¯¹è®°å½è¿è¡æåºï¼å orderBy = "pop_1994"ï¼
         * å¦æè¦ä»¥é¢ç§¯åäººå£è¿è¡æåºï¼å orderBy = "SmArea, pop_1994"ã
         */
        this.orderBy = null;


        /**
         * @member {string} [FilterParameter.prototype.groupBy]
         * @description æ¥è¯¢åç»æ¡ä»¶çå­æ®µã
         * ç¸å½äº SQL è¯­å¥ä¸­ç GROUP BY å­å¥ï¼å¶æ ¼å¼ä¸ºï¼GROUP BY <åå>ï¼
         * ååå³å±æ§è¡¨ä¸­æ¯ä¸åçåç§°ï¼ååå¯ç§°ä¸ºå±æ§ï¼å¨ SuperMap ä¸­åç§°ä¸ºå­æ®µã
         * å¯¹åä¸ªå­æ®µåç»æ¶ï¼è¯¥å­æ®µçç¨æ³ä¸º groupBy = "å­æ®µå"ï¼
         * å¯¹å¤ä¸ªå­æ®µåç»æ¶ï¼å­æ®µä¹é´ä»¥è±æéå·è¿è¡åå²ï¼ç¨æ³ä¸º groupBy = "å­æ®µå1, å­æ®µå2"ã
         * ä¾å¦ï¼ç°æä¸ä¸ªå¨çåå¸æ°æ®éï¼è¯¥æ°æ®éæä¸¤ä¸ªå­æ®µåå«ä¸ºâContinentâåâCountryâï¼
         * åå«è¡¨ç¤ºæä¸ªåå¸æå±çæ´²åå½å®¶ã
         * å¦æè¦æç§å½å®¶å¯¹å¨ççåå¸è¿è¡åç»ï¼ å¯ä»¥è®¾ç½® groupBy = "Country"ï¼
         * å¦æä»¥æ´²åå½å®¶å¯¹åå¸è¿è¡åç»ï¼è®¾ç½® groupBy = "Continent, Country"ã
         */
        this.groupBy = null;

        /**
         * @member {Array.<string>} [FilterParameter.prototype.fields]
         * @description æ¥è¯¢å­æ®µæ°ç»ï¼å¦æä¸è®¾ç½®åä½¿ç¨ç³»ç»è¿åçææå­æ®µã
         */
        this.fields = null;
        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = "SuperMap.FilterParameter";
    }


    /**
     * @function FilterParameter.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.attributeFilter = null;
        me.name = null;
        if (me.joinItems) {
            for (let i = 0, joinItems = me.joinItems, len = joinItems.length; i < len; i++) {
                joinItems[i].destroy();
            }
            me.joinItems = null;
        }
        if (me.linkItems) {
            for (let i = 0, linkItems = me.linkItems, len = linkItems.length; i < len; i++) {
                linkItems[i].destroy();
            }
            me.linkItems = null;
        }
        me.ids = null;
        me.orderBy = null;
        me.groupBy = null;
        me.fields = null;
    }


}

;// CONCATENATED MODULE: ./src/common/iServer/DatasetBufferAnalystParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class DatasetBufferAnalystParameters
 * @deprecatedclass SuperMap.DatasetBufferAnalystParameters
 * @category iServer SpatialAnalyst BufferAnalyst
 * @classdesc æ°æ®éç¼å²åºåæåæ°ç±»ã
 * @param {Object} options - åæ°ã
 * @param {string} options.dataset - è¦ç¨æ¥åç¼å²åºåæçæ°æ®æºä¸­æ°æ®éçåç§°ãè¯¥åç§°ç¨å½¢å¦âæ°æ®éåç§°@æ°æ®æºå«åâå½¢å¼æ¥è¡¨ç¤ºã
 * @param {FilterParameter} [options.filterQueryParameter] - è®¾ç½®æ°æ®éä¸­å ä½å¯¹è±¡çè¿æ»¤æ¡ä»¶ãåªææ»¡è¶³æ­¤æ¡ä»¶çå ä½å¯¹è±¡æåä¸ç¼å²åºåæã
 * @param {DataReturnOption} [options.resultSetting] - ç»æè¿åè®¾ç½®ç±»ã
 * @param {boolean} [options.isAttributeRetained=true] - æ¯å¦ä¿çè¿è¡ç¼å²åºåæçå¯¹è±¡çå­æ®µå±æ§ãå½ isUnion å­æ®µä¸º false æ¶è¯¥å­æ®µææã
 * @param {boolean} [options.isUnion=false] - æ¯å¦å°ç¼å²åºä¸æºè®°å½éä¸­çå¯¹è±¡åå¹¶åè¿åãå¯¹äºé¢å¯¹è±¡èè¨ï¼è¦æ±æºæ°æ®éä¸­çé¢å¯¹è±¡ä¸ç¸äº¤ã
 * @param {BufferSetting} [options.bufferSetting] - è®¾ç½®ç¼å²åºéç¨åæ°ã
 *
 * @extends {BufferAnalystParameters}
 * @usage
 */
class DatasetBufferAnalystParameters extends BufferAnalystParameters {


    constructor(options) {
        super(options);
        /**
         * @member {string} DatasetBufferAnalystParameters.prototype.dataset
         * @description è¦ç¨æ¥åç¼å²åºåæçæ°æ®æºä¸­æ°æ®éçåç§°ãè¯¥åç§°ç¨å½¢å¦âæ°æ®éåç§°@æ°æ®æºå«åâå½¢å¼æ¥è¡¨ç¤ºã
         */
        this.dataset = null;

        /**
         *  @member {FilterParameter} [DatasetBufferAnalystParameters.prototype.filterQueryParameter]
         *  @description è®¾ç½®æ°æ®éä¸­å ä½å¯¹è±¡çè¿æ»¤æ¡ä»¶ãåªææ»¡è¶³æ­¤æ¡ä»¶çå ä½å¯¹è±¡æåä¸ç¼å²åºåæã
         */
        this.filterQueryParameter = new FilterParameter();

        /**
         * @member {DataReturnOption} [DatasetBufferAnalystParameters.prototype.resultSetting]
         * @description ç»æè¿åè®¾ç½®ç±»ã
         */
        this.resultSetting = new DataReturnOption();

        /**
         * @member {boolean} [DatasetBufferAnalystParameters.prototype.isAttributeRetained=true]
         * @description æ¯å¦ä¿çè¿è¡ç¼å²åºåæçå¯¹è±¡çå­æ®µå±æ§ãå½ isUnion å­æ®µä¸º false æ¶è¯¥å­æ®µææã
         */
        this.isAttributeRetained = true;

        /**
         * @member {boolean} [DatasetBufferAnalystParameters.prototype.isUnion=false]
         * @description æ¯å¦å°ç¼å²åºä¸æºè®°å½éä¸­çå¯¹è±¡åå¹¶åè¿åãå¯¹äºé¢å¯¹è±¡èè¨ï¼è¦æ±æºæ°æ®éä¸­çé¢å¯¹è±¡ä¸ç¸äº¤ã
         */
        this.isUnion = false;

        Util.extend(this, options);

        this.CLASS_NAME = "SuperMap.DatasetBufferAnalystParameters";
    }


    /**
     * @function DatasetBufferAnalystParameters.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
        var me = this;
        me.dataset = null;
        if (me.filterQueryParameter) {
            me.filterQueryParameter.destroy();
            me.filterQueryParameter = null;
        }
        if (me.resultSetting) {
            me.resultSetting.destroy();
            me.resultSetting = null;
        }
        me.isAttributeRetained = null;
        me.isUnion = null;
    }

    /**
     * @function DatasetBufferAnalystParameters.toObject
     * @param {DatasetBufferAnalystParameters} datasetBufferAnalystParameters - æ°æ®éç¼å²åºåæåæ°ç±»ã
     * @param {DatasetBufferAnalystParameters} tempObj - æ°æ®éç¼å²åºåæåæ°å¯¹è±¡ã
     * @description å°æ°æ®éç¼å²åºåæåæ°å¯¹è±¡è½¬æ¢ä¸º JSON å¯¹è±¡ã
     * @returns {Object} JSON å¯¹è±¡ã
     */
    static toObject(datasetBufferAnalystParameters, tempObj) {
        for (var name in datasetBufferAnalystParameters) {
            if (name === "bufferSetting") {
                datasetBufferAnalystParameters.bufferSetting.radiusUnit = datasetBufferAnalystParameters.bufferSetting.radiusUnit.toUpperCase();
                tempObj.bufferAnalystParameter = datasetBufferAnalystParameters.bufferSetting;
            } else if (name === "resultSetting") {
                tempObj.dataReturnOption = datasetBufferAnalystParameters.resultSetting;
            } else if (name === "dataset") {
                continue;
            } else {
                tempObj[name] = datasetBufferAnalystParameters[name];
            }
        }
    }

}


;// CONCATENATED MODULE: ./src/common/iServer/GeometryBufferAnalystParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class GeometryBufferAnalystParameters
 * @deprecatedclass SuperMap.GeometryBufferAnalystParameters
 * @category  iServer SpatialAnalyst BufferAnalyst
 * @classdesc å ä½å¯¹è±¡ç¼å²åºåæåæ°ç±»
 * å¯¹æå®çæä¸ªå ä½å¯¹è±¡åç¼å²åºåæãéè¿è¯¥ç±»å¯ä»¥æå®è¦åç¼å²åºåæçå ä½å¯¹è±¡ãç¼å²åºåæ°ç­ã
 * @param {Object} options - åæ°ã
 * @param {GeoJSONObject} options.sourceGeometry - è¦åç¼å²åºåæçå ä½å¯¹è±¡ã
 * @param {number} options.sourceGeometrySRID - ç¼å²åºå ä½å¯¹è±¡æå½±åæ åæ°, å¦ 4326ï¼3857ã
 * @param {BufferSetting} [options.bufferSetting] - è®¾ç½®ç¼å²åºéç¨åæ°ã
 * @extends {BufferAnalystParameters}
 * @usage
 */
class GeometryBufferAnalystParameters extends BufferAnalystParameters {


    constructor(options) {
        super(options);
        /**
         * @member {GeoJSONObject} GeometryBufferAnalystParameters.prototype.sourceGeometry
         * @description è¦åç¼å²åºåæçå ä½å¯¹è±¡ã<br>
         * ç¹ç±»åå¯ä»¥æ¯ï¼{@link GeometryPoint}|{@link L.Marker}|{@link L.CircleMarker}|{@link L.Circle}|{@link L.GeoJSON}|{@link ol.geom.Point}|{@link ol.format.GeoJSON}ã</br>
         * çº¿ç±»åå¯ä»¥æ¯ï¼{@link GeometryLineString}|{@link GeometryLinearRing}|{@link L.Polyline}|{@link L.GeoJSON}|{@link ol.geom.LineString}|{@link ol.format.GeoJSON}ã</br>
         * é¢ç±»åå¯ä»¥æ¯ï¼{@link GeometryPolygon}|{@link L.Polygon}|{@link L.GeoJSON}|{@link ol.geom.Polygon}|{@link ol.format.GeoJSON}ã
         */
        this.sourceGeometry = null;

        /**
         * @member {number} GeometryBufferAnalystParameters.prototype.sourceGeometrySRID
         * @description ç¼å²åºå ä½å¯¹è±¡æå½±åæ åæ°, å¦ 4326ï¼3857ã
         */
        this.sourceGeometrySRID = null;

        if (options) {
            Util.extend(this, options);
        }
        this.CLASS_NAME = " SuperMap.GeometryBufferAnalystParameters";
    }

    /**
     * @function GeometryBufferAnalystParameters.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
        var me = this;
        if (me.sourceGeometry) {
            me.sourceGeometry.destroy();
            me.sourceGeometry = null;
        }
    }

    /**
     * @function GeometryBufferAnalystParameters.toObject
     * @param {GeometryBufferAnalystParameters} geometryBufferAnalystParameters - å ä½å¯¹è±¡ç¼å²åºåæåæ°ç±»ã
     * @param {GeometryBufferAnalystParameters} tempObj - å ä½å¯¹è±¡ç¼å²åºåæåæ°å¯¹è±¡ã
     * @description å°å ä½å¯¹è±¡ç¼å²åºåæåæ°å¯¹è±¡è½¬æ¢ä¸º JSON å¯¹è±¡ã
     * @returns {Object} JSON å¯¹è±¡ã
     */
    static toObject(geometryBufferAnalystParameters, tempObj) {
        for (var name in geometryBufferAnalystParameters) {
            if (name === "bufferSetting") {
                var tempBufferSetting = {};
                for (var key in geometryBufferAnalystParameters.bufferSetting) {
                    tempBufferSetting[key] = geometryBufferAnalystParameters.bufferSetting[key];
                }
                tempObj.analystParameter = tempBufferSetting;
            } else if (name === "sourceGeometry") {
                tempObj.sourceGeometry = ServerGeometry.fromGeometry(geometryBufferAnalystParameters.sourceGeometry);

            } else {
                tempObj[name] = geometryBufferAnalystParameters[name];
            }
        }
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/BufferAnalystService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class BufferAnalystService
 * @deprecatedclass SuperMap.BufferAnalystService
 * @category iServer SpatialAnalyst BufferAnalyst
 * @classdesc ç¼å²åºåææå¡ç±»ã
 * è¯¥ç±»è´è´£å°å®¢æ·è®¾ç½®çç¼å²åºåæåæ°ä¼ éç»æå¡ç«¯ï¼å¹¶æ¥æ¶æå¡ç«¯è¿åçç¼å²åºåæç»ææ°æ®ã
 * ç¼å²åºåæç»æéè¿è¯¥ç±»æ¯æçäºä»¶ççå¬å½æ°åæ°è·åã
 * @param {string} url - æå¡çè®¿é®å°åãå¦ï¼http://localhost:8090/iserver/services/spatialanalyst-changchun/restjsr/spatialanalystã
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - éè¦è¢«æ³¨åççå¬å¨å¯¹è±¡ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @extends {SpatialAnalystBase}
 * @example ä¾å¦ï¼
 * (start code)
 * var myBufferAnalystService = new BufferAnalystService(url, {
     *     eventListeners: {
     *           "processCompleted": bufferCompleted,
     *           "processFailed": bufferFailed
     *           }
     *    });
 * (end)
 * @usage
 */
class BufferAnalystService extends SpatialAnalystBase {


    constructor(url, options) {
        super(url, options);
        /**
         * @member {string} BufferAnalystService.prototype.mode
         * @description ç¼å²åºåæç±»å
         */
        this.mode = null;
        if (options) {
            Util.extend(this, options);
        }
        this.CLASS_NAME = "SuperMap.BufferAnalystService";
    }


    /**
     * @function BufferAnalystService.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
        this.mode = null;
    }


    /**
     * @method BufferAnalystService.prototype.processAsync
     * @description è´è´£å°å®¢æ·ç«¯çæ¥è¯¢åæ°ä¼ éå°æå¡ç«¯ã
     * @param {BufferAnalystParameters} parameter - ç¼å²åºåæåæ°
     */
    processAsync(parameter) {
        var parameterObject = {};
        var me = this;
        if (parameter instanceof DatasetBufferAnalystParameters) {
            me.mode = 'datasets';
            me.url = Util.urlPathAppend(me.url, 'datasets/' + parameter.dataset + '/buffer');
            DatasetBufferAnalystParameters.toObject(parameter, parameterObject);
        } else if (parameter instanceof GeometryBufferAnalystParameters) {
            me.mode = 'geometry';
            me.url = Util.urlPathAppend(me.url, 'geometry/buffer');
            GeometryBufferAnalystParameters.toObject(parameter, parameterObject);
        }

        var jsonParameters = Util.toJSON(parameterObject);
        me.url = Util.urlAppend(me.url, 'returnContent=true');
        me.request({
            method: "POST",
            data: jsonParameters,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/DatasourceConnectionInfo.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/

 // eslint-disable-line no-unused-vars

/**
 * @class DatasourceConnectionInfo
 * @deprecatedclass SuperMap.DatasourceConnectionInfo
 * @category  iServer Data Datasource
 * @classdesc æ°æ®æºè¿æ¥ä¿¡æ¯ç±»ãè¯¥ç±»åæ¬äºè¿è¡æ°æ®æºè¿æ¥çææä¿¡æ¯ï¼å¦æè¦è¿æ¥çæå¡å¨åç§°ãæ°æ®åºåç§°ãç¨æ·åä»¥åå¯ç ç­ã
 *            å½ä¿å­ä¸ºå·¥ä½ç©ºé´æ¶ï¼ å·¥ä½ç©ºé´ä¸­çæ°æ®æºçè¿æ¥ä¿¡æ¯é½å°å­å¨å°å·¥ä½ç©ºé´æä»¶ä¸­ãå¯¹äºä¸åç±»åçæ°æ®æºï¼å¶è¿æ¥ä¿¡æ¯ææåºå«ã
 *            æä»¥å¨ä½¿ ç¨è¯¥ç±»æåå«çæåæ¶ï¼è¯·æ³¨æè¯¥æåæéç¨çæ°æ®æºç±»åãå¯¹äºä»æ°æ®æºå¯¹è±¡ä¸­è¿åçæ°æ®è¿æ¥ä¿¡æ¯å¯¹è±¡ï¼åªæ connect æ¹æ³å¯ä»¥è¢«ä¿®æ¹ï¼
 *            å¶ä»åå®¹æ¯ä¸å¯ä»¥è¢«ä¿®æ¹çãå¯¹äºç¨æ·åå»ºçæ°æ®æºè¿æ¥ä¿¡æ¯å¯¹è±¡ï¼å¶åå®¹é½å¯ä»¥ä¿®æ¹ã
 * @param {Object} options - åæ°ã
 * @param {string} options.alias - æ°æ®æºå«åã
 * @param {string} options.dataBase - æ°æ®æºè¿æ¥çæ°æ®åºåã
 * @param {boolean} [options.connect] - æ°æ®æºæ¯å¦èªå¨è¿æ¥æ°æ®ã
 * @param {string} [options.driver] - ä½¿ç¨ ODBC(Open Database Connectivityï¼å¼æ¾æ°æ®åºäºè¿)çæ°æ®åºçé©±å¨ç¨åºåã
 * @param {EngineType} [options.engineType] - æ°æ®æºè¿æ¥çå¼æç±»åã
 * @param {boolean} [options.exclusive] - æ¯å¦ä»¥ç¬å æ¹å¼æå¼æ°æ®æºã
 * @param {boolean} [options.OpenLinkTable] - æ¯å¦ææ°æ®åºä¸­çå¶ä»é SuperMap æ°æ®è¡¨ä½ä¸º LinkTable æå¼ã
 * @param {string} [options.password] - ç»å½æ°æ®æºè¿æ¥çæ°æ®åºææä»¶çå¯ç ã
 * @param {boolean} [options.readOnly] - æ¯å¦ä»¥åªè¯»æ¹å¼æå¼æ°æ®æºã
 * @param {string} [options.server] - æ°æ®åºæå¡å¨åæ SDB æä»¶åã
 * @param {string} [options.user] - ç»å½æ°æ®åºçç¨æ·åã
 * @usage
 */
class DatasourceConnectionInfo {


    constructor(options) {

        /**
         * @member {string} DatasourceConnectionInfo.prototype.alias
         * @description æ°æ®æºå«åã
         */
        this.alias = null;

        /**
         * @member {boolean} [DatasourceConnectionInfo.prototype.connect]
         * @description æ°æ®æºæ¯å¦èªå¨è¿æ¥æ°æ®ã
         */
        this.connect = null;

        /**
         * @member {string} DatasourceConnectionInfo.prototype.dataBase
         * @description æ°æ®æºè¿æ¥çæ°æ®åºåã
         */
        this.dataBase = null;

        /**
         * @member {string} [DatasourceConnectionInfo.prototype.driver]
         * @description ä½¿ç¨ ODBC(Open Database Connectivityï¼å¼æ¾æ°æ®åºäºè¿) çæ°æ®åºçé©±å¨ç¨åºåã
         * å¶ä¸­ï¼å¯¹äº SQL Server æ°æ®åºä¸ iServer åå¸ç WMTS æå¡ï¼æ­¤ä¸ºå¿è®¾åæ°ã
         * å¯¹äº SQL Server æ°æ®åºï¼å®ä½¿ç¨ ODBC è¿æ¥ï¼æè®¾ç½®çé©±å¨ç¨åºåä¸º "SQL Server" æ "SQL Native Client"ï¼
         * å¯¹äº iServer åå¸ç WMTS æå¡ï¼è®¾ç½®çé©±å¨åç§°ä¸º "WMTS"ã
         */
        this.driver = null;

        /**
         * @member {EngineType} [DatasourceConnectionInfo.prototype.engineType]
         * @description æ°æ®æºè¿æ¥çå¼æç±»åã
         */
        this.engineType = null;

        /**
         * @member {boolean} [DatasourceConnectionInfo.prototype.exclusive]
         * @description æ¯å¦ä»¥ç¬å æ¹å¼æå¼æ°æ®æºã
         */
        this.exclusive = null;

        /**
         * @member {boolean} [DatasourceConnectionInfo.prototype.OpenLinkTable]
         * @description æ¯å¦ææ°æ®åºä¸­çå¶ä»é SuperMap æ°æ®è¡¨ä½ä¸º LinkTable æå¼ã
         */
        this.OpenLinkTable = null;

        /**
         * @member {string} [DatasourceConnectionInfo.prototype.password]
         * @description ç»å½æ°æ®æºè¿æ¥çæ°æ®åºææä»¶çå¯ç ã
         */
        this.password = null;

        /**
         * @member {boolean} [DatasourceConnectionInfo.prototype.readOnly]
         * @description æ¯å¦ä»¥åªè¯»æ¹å¼æå¼æ°æ®æºã
         */
        this.readOnly = null;

        /**
         * @member {string} [DatasourceConnectionInfo.prototype.server]
         * @description æ°æ®åºæå¡å¨åãæä»¶åææå¡å°åã
         * 1.å¯¹äº SDB å UDB æä»¶ï¼ä¸ºå¶æä»¶çç»å¯¹è·¯å¾ãæ³¨æï¼å½ç»å¯¹è·¯å¾çé¿åº¦è¶è¿ UTF-8 ç¼ç æ ¼å¼ç 260 å­èé¿åº¦ï¼è¯¥æ°æ®æºæ æ³æå¼ã
         * 2.å¯¹äº Oracle æ°æ®åºï¼å¶æå¡å¨åä¸ºå¶ TNS æå¡åç§°ã
         * 3.å¯¹äº SQL Server æ°æ®åºï¼å¶æå¡å¨åä¸ºå¶ç³»ç»ç DSN(Database Source Name) åç§°ã
         * 4.å¯¹äº PostgreSQL æ°æ®åºï¼å¶æå¡å¨åä¸º âIP:ç«¯å£å·âï¼é»è®¤çç«¯å£å·æ¯ 5432ã
         * 5.å¯¹äº DB2 æ°æ®åºï¼å·²ç»è¿è¡äºç¼ç®ï¼æä»¥ä¸éè¦è¿è¡æå¡å¨çè®¾ç½®ã
         * 6.å¯¹äº Kingbase æ°æ®åºï¼å¶æå¡å¨åä¸ºå¶ IP å°åã
         * 7.å¯¹äº GoogleMaps æ°æ®æºï¼å¶æå¡å¨å°åï¼é»è®¤è®¾ç½®ä¸º â{@link http://maps.google.com}âï¼ä¸ä¸å¯æ´æ¹ã
         * 8.å¯¹äº SuperMapCould æ°æ®æºï¼ä¸ºå¶æå¡å°åã
         * 9.å¯¹äº MAPWORLD æ°æ®æºï¼ä¸ºå¶æå¡å°åï¼é»è®¤è®¾ç½®ä¸º â{@link http://www.tianditu.cn}âï¼ä¸ä¸å¯æ´æ¹ã
         * 10.å¯¹äº OGC å REST æ°æ®æºï¼ä¸ºå¶æå¡å°åã
         */
        this.server = null;

        /**
         * @member {string} DatasourceConnectionInfo.prototype.user
         * @description ç»å½æ°æ®åºçç¨æ·åã
         */
        this.user = null;

        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = "SuperMap.DatasourceConnectionInfo";
    }

    /**
     * @function DatasourceConnectionInfo.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.alias = null;
        me.connect = null;
        me.dataBase = null;
        me.driver = null;
        me.engineType = null;
        me.exclusive = null;
        me.OpenLinkTable = null;
        me.password = null;
        me.readOnly = null;
        me.server = null;
        me.user = null;
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/OutputSetting.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class OutputSetting
 * @deprecatedclass SuperMap.OutputSetting
 * @category  iServer ProcessingService
 * @classdesc åå¸å¼åæè¾åºç±»åè®¾ç½®ç±»ã
 * @param {Object} options - åæ°ã
 * @param {DatasourceConnectionInfo} options.datasourceInfo - æ°æ®æºè¿æ¥ä¿¡æ¯ã
 * @param {string} [options.datasetName='analystResult'] - ç»ææ°æ®éåç§°ã
 * @param {OutputType} [options.type=OutputType.UDB] - è¾åºç±»åã
 * @param {string} [options.outputPath] - åæç»æè¾åºè·¯å¾ã
 * @usage
 */
class OutputSetting {

    constructor(options) {

        /**
         * @member {OutputType} OutputSetting.prototype.type
         * @description åå¸å¼åæçè¾åºç±»åã
         */
        this.type = OutputType.UDB;

        /**
         * @member {string} [OutputSetting.prototype.datasetName='analystResult']
         * @description åå¸å¼åæçè¾åºç»ææ°æ®éåç§°ã
         */
        this.datasetName = "analystResult";

        /**
         * @member {DatasourceConnectionInfo} OutputSetting.prototype.datasourceInfo
         * @description åå¸å¼åæçè¾åºç»ææ°æ®æºè¿æ¥ä¿¡æ¯ã
         */
        this.datasourceInfo = null;

        /**
         * @member {string} [OutputSetting.prototype.outputPath]
         * @description åå¸å¼åæçåæç»æè¾åºè·¯å¾ã
         */
        this.outputPath = "";

        Util.extend(this, options);
        this.CLASS_NAME = "SuperMap.OutputSetting";
    }

    /**
     * @function OutputSetting.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.type = null;
        me.datasetName = null;
        me.outputPath = null;
        if (me.datasourceInfo instanceof DatasourceConnectionInfo) {
            me.datasourceInfo.destroy();
            me.datasourceInfo = null;
        }
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/MappingParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class MappingParameters
 * @deprecatedclass SuperMap.MappingParameters
 * @category  iServer ProcessingService
 * @classdesc åæåç»æå¯è§åçåæ°ç±»ã
 * @param {Object} options - åæ°ã
 * @param {Array.<ThemeGridRangeItem>} [options.items] - æ æ ¼åæ®µä¸é¢å¾å­é¡¹æ°ç»ã
 * @param {number} [options.numericPrecision=1] - ç²¾åº¦ï¼æ­¤å­æ®µç¨äºè®¾ç½®åæç»ææ ç­¾ä¸é¢å¾ä¸­æ ç­¾æ°å¼çç²¾åº¦ï¼å¦â1âè¡¨ç¤ºç²¾ç¡®å°å°æ°ç¹çåä¸ä½ã
 * @param {RangeMode} [options.rangeMode=RangeMode.EQUALINTERVAL] - ä¸é¢å¾åæ®µæ¨¡å¼ã
 * @param {number} [options.rangeCount] - ä¸é¢å¾åæ®µä¸ªæ°ã
 * @param {ColorGradientType} [options.colorGradientType=ColorGradientType.YELLOW_RED] - ä¸é¢å¾é¢è²æ¸åæ¨¡å¼ã
 * @usage
 */
class MappingParameters {

    constructor(options) {

        /**
         * @member {Array.<ThemeGridRangeItem>} [MappingParameters.prototype.items]
         * @description æ æ ¼åæ®µä¸é¢å¾å­é¡¹æ°ç»ã
         */
        this.items = null;

        /**
         * @member {number} [MappingParameters.prototype.numericPrecision=1]
         * @description ç²¾åº¦ï¼æ­¤å­æ®µç¨äºè®¾ç½®åæç»ææ ç­¾ä¸é¢å¾ä¸­æ ç­¾æ°å¼çç²¾åº¦ï¼å¦â1âè¡¨ç¤ºç²¾ç¡®å°å°æ°ç¹çåä¸ä½ã
         */
        this.numericPrecision = 1;

        /**
         * @member {RangeMode} [MappingParameters.prototype.RangeMode=RangeMode.EQUALINTERVAL]
         * @description ä¸é¢å¾åæ®µæ¨¡å¼ã
         */
        this.rangeMode = RangeMode.EQUALINTERVAL;

        /**
         * @member {number} [MappingParameters.prototype.rangeCount]
         * @description ä¸é¢å¾åæ®µä¸ªæ°ã
         */
        this.rangeCount = "";

        /**
         * @member {ColorGradientType} [MappingParameters.prototype.colorGradientType=ColorGradientType.YELLOW_RED]
         * @description ä¸é¢å¾é¢è²æ¸åæ¨¡å¼ã
         */
        this.colorGradientType = ColorGradientType.YELLOW_RED;

        Util.extend(this, options);
        this.CLASS_NAME = "SuperMap.MappingParameters";
    }

    /**
     * @function MappingParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        if (me.items) {
            if (me.items.length > 0) {
                for (var item in me.items) {
                    me.items[item].destroy();
                    me.items[item] = null;
                }
            }
            me.items = null;
        }
        me.numericPrecision = null;
        me.rangeMode = null;
        me.rangeCount = null;
        me.colorGradientType = null;
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/BuffersAnalystJobsParameter.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class BuffersAnalystJobsParameter
 * @deprecatedclass SuperMap.BuffersAnalystJobsParameter
 * @category iServer ProcessingService BufferAnalyst
 * @classdesc ç¼å²åºåæä»»å¡åæ°ç±»ã
 * @param {Object} options - åæ°ã
 * @param {string} options.datasetName - æ°æ®éåã
 * @param {(SuperMap.Bounds|L.Bounds|L.LatLngBounds|ol.extent|mapboxgl.LngLatBounds|GeoJSONObject)} [options.bounds] - åæèå´ï¼é»è®¤ä¸ºå¨å¾èå´ï¼ã
 * @param {string} [options.distance='15'] - ç¼å²è·ç¦»ï¼æç¼å²åºåå¾ã
 * @param {string} [options.distanceField='pickup_latitude'] - ç¼å²åºåæè·ç¦»å­æ®µã
 * @param {AnalystSizeUnit} [options.distanceUnit=AnalystSizeUnit.METER] - ç¼å²è·ç¦»åä½åä½ã
 * @param {OutputSetting} [options.output] - è¾åºåæ°è®¾ç½®ã
 * @param {MappingParameters} [options.mappingParameters] - åæåç»æå¯è§åçåæ°ç±»ã
 * @usage
 */
class BuffersAnalystJobsParameter {
    constructor(options) {
        /**
         * @member {string} BuffersAnalystJobsParameter.prototype.datasetName
         * @description æ°æ®éåã
         */
        this.datasetName = '';

        /**
         * @member {(SuperMap.Bounds|L.Bounds|L.LatLngBounds|ol.extent|mapboxgl.LngLatBounds|GeoJSONObject)} BuffersAnalystJobsParameter.prototype.bounds
         * @description åæèå´ã
         */
        this.bounds = '';

        /**
         * @member {string} [BuffersAnalystJobsParameter.prototype.distance='15']
         * @description ç¼å²è·ç¦»ï¼æç§°ä¸ºç¼å²åºåå¾ãå½ç¼å²è·ç¦»å­æ®µä½ç©ºæ¶ï¼æ­¤åæ°ææã
         */
        this.distance = '';

        /**
         * @member {string} [BuffersAnalystJobsParameter.prototype.distanceField='pickup_latitude']
         * @description ç¼å²è·ç¦»å­æ®µã
         */
        this.distanceField = '';

        /**
         * @member {AnalystSizeUnit} [BuffersAnalystJobsParameter.prototype.distanceUnit=AnalystSizeUnit.METER]
         * @description ç¼å²è·ç¦»åä½ã
         */
        this.distanceUnit = AnalystSizeUnit.METER;

        /**
         * @member {string} BuffersAnalystJobsParameter.prototype.dissolveField
         * @description èåå­æ®µï¼æ ¹æ®å­æ®µå¼å¯¹ç¼å²åºç»æé¢å¯¹è±¡è¿è¡èåã
         */
        this.dissolveField = '';

        /**
         * @member {OutputSetting} [BuffersAnalystJobsParameter.prototype.output]
         * @description è¾åºåæ°è®¾ç½®ç±»ã
         */
        this.output = null;

        /**
         * @member {MappingParameters} [BuffersAnalystJobsParameter.prototype.mappingParameters]
         * @description åæåç»æå¯è§åçåæ°ç±»ã
         */
        this.mappingParameters = null;

        if (!options) {
            return this;
        }
        Util.extend(this, options);

        this.CLASS_NAME = 'SuperMap.BuffersAnalystJobsParameter';
    }

    /**
     * @function BuffersAnalystJobsParameter.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        this.datasetName = null;
        this.bounds = null;
        this.distance = null;
        this.distanceField = null;
        this.distanceUnit = null;
        this.dissolveField = null;
        if (this.output instanceof OutputSetting) {
            this.output.destroy();
            this.output = null;
        }
        if (this.mappingParameters instanceof MappingParameters) {
            this.mappingParameters.destroy();
            this.mappingParameters = null;
        }
    }

    /**
     * @function BuffersAnalystJobsParameter.toObject
     * @param {BuffersAnalystJobsParameter} BuffersAnalystJobsParameter - ç¼å²åºåæä»»å¡åæ°ã
     * @param {Object} tempObj - ç®æ å¯¹è±¡ã
     * @description çæç¼å²åºåæä»»å¡å¯¹è±¡ã
     */
    static toObject(BuffersAnalystJobsParameter, tempObj) {
        for (var name in BuffersAnalystJobsParameter) {
            if (name === 'datasetName') {
                tempObj['input'] = tempObj['input'] || {};
                tempObj['input'][name] = BuffersAnalystJobsParameter[name];
                continue;
            }
            if (name === 'output') {
                tempObj['output'] = tempObj['output'] || {};
                tempObj['output'] = BuffersAnalystJobsParameter[name];
                continue;
            }

            tempObj['analyst'] = tempObj['analyst'] || {};
            if (name === 'bounds' && BuffersAnalystJobsParameter[name]) {
                tempObj['analyst'][name] = BuffersAnalystJobsParameter[name].toBBOX();
            } else {
                tempObj['analyst'][name] = BuffersAnalystJobsParameter[name];
            }
            if (name === 'mappingParameters') {
                tempObj['analyst'][name] = tempObj['analyst'][name] || {};
                tempObj['analyst']['mappingParameters'] = BuffersAnalystJobsParameter[name];
            }
        }
    }
}


;// CONCATENATED MODULE: ./src/common/iServer/ProcessingServiceBase.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class ProcessingServiceBase
 * @deprecatedclass SuperMap.ProcessingServiceBase
 * @category  iServer Core
 * @classdesc åå¸å¼åææå¡åºç±»
 * @extends {CommonServiceBase}
 * @param {string} url - æå¡å°åã
 * @param {Object} options - åæ°ã
 * @param {Events} options.events - å¤çææäºä»¶çå¯¹è±¡ã
 * @param {number} options.index - æå¡è®¿é®å°åå¨æ°ç»ä¸­çä½ç½®ã
 * @param {number} options.length - æå¡è®¿é®å°åæ°ç»é¿åº¦ã
 * @param {Object} [options.eventListeners] - äºä»¶çå¬å¨å¯¹è±¡ãæ processCompleted å±æ§å¯ä¼ å¥å¤çå®æåçåè°å½æ°ãprocessFailed å±æ§ä¼ å¥å¤çå¤±è´¥åçåè°å½æ°ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class ProcessingServiceBase extends CommonServiceBase {

    constructor(url, options) {
        options = options || {};
        /*
         * Constant: EVENT_TYPES
         * {Array.<string>}
         * æ­¤ç±»æ¯æçäºä»¶ç±»å
         * - *processCompleted* åå»ºæååè§¦åçäºä»¶ã
         * - *processFailed* åå»ºå¤±è´¥åè§¦åçäºä»¶ ã
         * - *processRunning* åå»ºè¿ç¨çæ´ä¸ªé¶æ®µé½ä¼è§¦åçäºä»¶ï¼ç¨äºè·ååå»ºè¿ç¨çç¶æ ã
         */
        options.EVENT_TYPES = ["processCompleted", "processFailed", "processRunning"];
        super(url, options);

        this.CLASS_NAME = "SuperMap.ProcessingServiceBase";
    }

    /**
     * @function ProcessingServiceBase.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function ProcessingServiceBase.prototype.getJobs
     * @description è·ååå¸å¼åæä»»å¡ã
     * @param {string} url - èµæºå°åã
     */
    getJobs(url) {
        var me = this;
        FetchRequest.get(SecurityManager.appendCredential(url), null, {
            proxy: me.proxy
        }).then(function (response) {
            return response.json();
        }).then(function (result) {
            me.events.triggerEvent("processCompleted", {
                result: result
            });
        }).catch(function (e) {
            me.eventListeners.processFailed({
                error: e
            });
        });
    }

    /**
     * @function ProcessingServiceBase.prototype.addJob
     * @description æ·»å åå¸å¼åæä»»å¡ã
     * @param {string} url - èµæºæ ¹å°åã
     * @param {Object} params - åå»ºä¸ä¸ªç©ºé´åæçè¯·æ±åæ°ã
     * @param {string} paramType - è¯·æ±åæ°ç±»åã
     * @param {number} seconds - å¼å§åå»ºåï¼è·ååå»ºæåç»æçæ¶é´é´éã
     */
    addJob(url, params, paramType, seconds) {
        var me = this,
            parameterObject = null;
        if (params && params instanceof paramType) {
            parameterObject = new Object();
            paramType.toObject(params, parameterObject);
        }
        let headers = Object.assign({
          'Content-Type': 'application/x-www-form-urlencoded'
        }, me.headers || {})
        var options = {
            proxy: me.proxy,
            headers,
            withCredentials: me.withCredentials,
            crossOrigin: me.crossOrigin,
            isInTheSameDomain: me.isInTheSameDomain
        };
        FetchRequest.post(SecurityManager.appendCredential(url), JSON.stringify(parameterObject), options).then(function (response) {
            return response.json();
        }).then(function (result) {
            if (result.succeed) {
                me.serviceProcessCompleted(result, seconds);
            } else {
                me.serviceProcessFailed(result);
            }
        }).catch(function (e) {
            me.serviceProcessFailed({
                error: e
            });
        });
    }

    serviceProcessCompleted(result, seconds) {
        result = Util.transformResult(result);
        seconds = seconds || 1000;
        var me = this;
        if (result) {
            var id = setInterval(function () {
                FetchRequest.get(SecurityManager.appendCredential(result.newResourceLocation), {
                        _t: new Date().getTime()
                    })
                    .then(function (response) {
                        return response.json();
                    }).then(function (job) {
                        me.events.triggerEvent("processRunning", {
                            id: job.id,
                            state: job.state
                        });
                        if (job.state.runState === 'LOST' || job.state.runState === 'KILLED' || job.state.runState === 'FAILED') {
                            clearInterval(id);
                            me.events.triggerEvent("processFailed", {
                                error: job.state.errorMsg,
                                state: job.state.runState
                            });
                        }
                        if (job.state.runState === 'FINISHED' && job.setting.serviceInfo) {
                            clearInterval(id);
                            me.events.triggerEvent("processCompleted", {
                                result: job
                            });
                        }
                    }).catch(function (e) {
                        clearInterval(id);
                        me.events.triggerEvent("processFailed", {
                            error: e
                        });
                    });
            }, seconds);
        }
    }

    serviceProcessFailed(result) {
        super.serviceProcessFailed(result);
    }
}

;// CONCATENATED MODULE: ./src/common/iServer/BuffersAnalystJobsService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class BuffersAnalystJobsService
 * @deprecatedclass SuperMap.BuffersAnalystJobsService
 * @category iServer ProcessingService BufferAnalyst
 * @classdesc ç¼å²åºåææå¡ç±»
 * @extends {ProcessingServiceBase}
 * @param {string} url - æå¡å°åã
 * @param {Object} options - åæ°ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class BuffersAnalystJobsService extends ProcessingServiceBase {
    constructor(url, options) {
        super(url, options);
        this.url = Util.urlPathAppend(this.url, 'spatialanalyst/buffers');
        this.CLASS_NAME = 'SuperMap.BuffersAnalystJobsService';
    }

    /**
     *@override
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function BuffersAnalystJobsService.prototype.getBufferJobs
     * @description è·åç¼å²åºåæææä»»å¡
     */
    getBuffersJobs() {
        super.getJobs(this.url);
    }

    /**
     * @function BuffersAnalystJobsService.prototype.getBufferJob
     * @description è·åæå®idçç¼å²åºåææå¡
     * @param {string} id - æå®è¦è·åæ°æ®çidã
     */
    getBuffersJob(id) {
        super.getJobs(Util.urlPathAppend(this.url, id));
    }

    /**
     * @function BuffersAnalystJobsService.prototype.addBufferJob
     * @description æ°å»ºç¼å²åºåææå¡
     * @param {BuffersAnalystJobsParameter} params - åå»ºä¸ä¸ªç©ºé´åæçè¯·æ±åæ°ã
     * @param {number} seconds - å¼å§åå»ºåï¼è·ååå»ºæåç»æçæ¶é´é´éã
     */
    addBuffersJob(params, seconds) {
        super.addJob(this.url, params, BuffersAnalystJobsParameter, seconds);
    }
}


;// CONCATENATED MODULE: ./src/common/iServer/BurstPipelineAnalystParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class BurstPipelineAnalystParameters
 * @deprecatedclass SuperMap.BurstPipelineAnalystParameters
 * @category iServer NetworkAnalyst BurstAnalyse
 * @classdesc çç®¡åæåæ°ç±»ã
 * @param {Object} options - åæ°ã
 * @param {Array.<number>} options.sourceNodeIDs - æå®çè®¾æ½ç¹ ID æ°ç»ã
 * @param {number} [options.edgeID] - æå®çå¼§æ®µIDï¼edgeID ä¸ nodeID å¿é¡»æå®ä¸ä¸ªã
 * @param {number} [options.nodeID] - æå®çç»ç¹IDï¼edgeID ä¸ nodeID å¿é¡»æå®ä¸ä¸ªã
 * @param {boolean} [options.isUncertainDirectionValid=false] - æå®ä¸ç¡®å®æµåæ¯å¦ææã
 * @usage
 */
class BurstPipelineAnalystParameters {


    constructor(options) {
        var me = this;
        /**
         * @member {Array.<number>} BurstPipelineAnalystParameters.prototype.sourceNodeIDs
         * @description æå®çè®¾æ½ç¹ ID æ°ç»ã
         */
        this.sourceNodeIDs = null;

        /**
         * @member {number} [BurstPipelineAnalystParameters.prototype.edgeID]
         * @description æå®çå¼§æ®µ IDï¼edgeID ä¸ nodeID å¿é¡»æå®ä¸ä¸ªã
         */
        this.edgeID = null;

        /**
         * @member {number} [BurstPipelineAnalystParameters.prototype.nodeID]
         * @description æå®çç»ç¹ IDï¼edgeID ä¸ nodeID å¿é¡»æå®ä¸ä¸ªã
         */
        this.nodeID = null;

        /**
         * @member {boolean} [BurstPipelineAnalystParameters.prototype.isUncertainDirectionValid=false]
         * @description æå®ä¸ç¡®å®æµåæ¯å¦ææã
         * æå®ä¸º trueï¼è¡¨ç¤ºä¸ç¡®å®æµåææï¼éå°ä¸ç¡®å®æµåæ¶åæç»§ç»­è¿è¡ã
         * æå®ä¸º falseï¼è¡¨ç¤ºä¸ç¡®å®æµåæ æï¼éå°ä¸ç¡®å®æµåå°åæ­¢å¨è¯¥æ¹åä¸ç»§ç»­æ¥æ¾ã
         */
        this.isUncertainDirectionValid = false;

        Util.extend(me, options);

        this.CLASS_NAME = "SuperMap.BurstPipelineAnalystParameters";
    }

    /**
     * @function BurstPipelineAnalystParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.sourceNodeIDs = null;
        me.edgeID = null;
        me.nodeID = null;
        me.isUncertainDirectionValid = null;
    }


}

;// CONCATENATED MODULE: ./src/common/iServer/NetworkAnalystServiceBase.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class NetworkAnalystServiceBase
 * @deprecatedclass SuperMap.NetworkAnalystServiceBase
 * @category iServer Core
 * @classdesc ç½ç»åææå¡åºç±»ã
 * @extends {CommonServiceBase}
 * @param {string} url - æå¡å°åã
 * @param {Object} options - å¯éåæ°ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class NetworkAnalystServiceBase extends CommonServiceBase {

    constructor(url, options) {
        super(url, options);
        /**
         * @member {DataFormat} [NetworkAnalystServiceBase.prototype.format=DataFormat.GEOJSON]
         * @description æ¥è¯¢ç»æè¿åæ ¼å¼ï¼ç®åæ¯æ iServerJSON å GeoJSON ä¸¤ç§æ ¼å¼ï¼åæ°æ ¼å¼ä¸º "ISERVER","GEOJSON"
         */
        this.format = DataFormat.GEOJSON;

        this.CLASS_NAME = "SuperMap.NetworkAnalystServiceBase";
    }

    /**
     * @function NetworkAnalystServiceBase.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨çèµæºå±æ§ç½®ç©ºã
     */
    destroy() {
        super.destroy();
        this.format = null;
    }

    /**
     * @function NetworkAnalystServiceBase.prototype.serviceProcessCompleted
     * @description åæå®æï¼æ§è¡æ­¤æ¹æ³ã
     * @param {Object} result - æå¡å¨è¿åçç»æå¯¹è±¡ã
     */
    serviceProcessCompleted(result) {
        var me = this, analystResult;
        result = Util.transformResult(result);
        if (result && me.format === DataFormat.GEOJSON && typeof me.toGeoJSONResult === 'function') {
            analystResult = me.toGeoJSONResult(result);
        }
        if (!analystResult) {
            analystResult = result;
        }
        me.events.triggerEvent("processCompleted", {result: analystResult});
    }

    /**
     * @function NetworkAnalystServiceBase.prototype.toGeoJSONResult
     * @description å°å«æ geometry çæ°æ®è½¬æ¢ä¸º GeoJSON æ ¼å¼ãåªå¤çç»æä¸­çè·¯ç±ï¼ç±å­ç±»å®ç°ã
     * @param {Object} result - æå¡å¨è¿åçç»æå¯¹è±¡ã
     * @returns {GeoJSONObject} GeoJSON å¯¹è±¡ã
     */
    toGeoJSONResult(result) { // eslint-disable-line no-unused-vars
        return null;
    }
}

;// CONCATENATED MODULE: ./src/common/iServer/BurstPipelineAnalystService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class BurstPipelineAnalystService
 * @deprecatedclass SuperMap.BurstPipelineAnalystService
 * @category iServer NetworkAnalyst BurstAnalyse
 * @classdesc çç®¡åææå¡ç±»ï¼å³å°ç»å®å¼§æ®µæèç¹ä½ä¸ºçç®¡ç¹æ¥è¿è¡åæï¼è¿åå³é®ç»ç¹ ID æ°ç»ãæ®éç»ç¹ ID æ°ç»åå¶ä¸ä¸æ¸¸å¼§æ®µ ID æ°ç»ã
 * @extends {NetworkAnalystServiceBase}
 * @param {string} url - ç½ç»åææå¡å°åãè¯·æ±ç½ç»åææå¡ï¼URLåºä¸ºï¼
 *                       http://{æå¡å¨å°å}:{æå¡ç«¯å£å·}/iserver/services/{ç½ç»åææå¡å}/rest/networkanalyst/{ç½ç»æ°æ®é@æ°æ®æº}ï¼
 *                       ä¾å¦: "http://localhost:8090/iserver/services/test/rest/networkanalyst/WaterNet@FacilityNet"ã
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - éè¦è¢«æ³¨åççå¬å¨å¯¹è±¡ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class BurstPipelineAnalystService extends NetworkAnalystServiceBase {

    constructor(url, options) {
        super(url, options);
        this.CLASS_NAME = "SuperMap.BurstPipelineAnalystService";
    }

    /**
     * @function BurstPipelineAnalystService.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function BurstPipelineAnalystService.prototype.processAsync
     * @description è´è´£å°å®¢æ·ç«¯çæ¥è¯¢åæ°ä¼ éå°æå¡ç«¯ã
     * @params {BurstPipelineAnalystParameters} params - çç®¡åæåæ°ç±»
     */
    processAsync(params) {
        if (!(params instanceof BurstPipelineAnalystParameters)) {
            return null;
        }
        var me = this, jsonObject;
        me.url = Util.urlPathAppend(me.url, 'burstAnalyse');
        jsonObject = {
            sourceNodeIDs: params.sourceNodeIDs,
            isUncertainDirectionValid: params.isUncertainDirectionValid
        };

        //å¿ä¼ åæ°ä¸æ­£ç¡®ï¼å°±ç»æ­¢
        if (params.edgeID !== null && params.nodeID !== null) {
            throw new Error('edgeID and nodeID cannot be null at the same time.');
        }
        if (params.edgeID === null && params.nodeID === null) {
            throw new Error('edgeID and nodeID cannot be null at the same time.');
        }
        if (params.edgeID !== null) {
            jsonObject.edgeID = params.edgeID;
        } else {
            jsonObject.nodeID = params.nodeID;
        }

        me.request({
            method: "GET",
            params: jsonObject,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }


}

;// CONCATENATED MODULE: ./src/common/iServer/ChartFeatureInfoSpecsService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class ChartFeatureInfoSpecsService
 * @deprecatedclass SuperMap.ChartFeatureInfoSpecsService
 * @category  iServer Map Chart
 * @classdesc æµ·å¾ç©æ ä¿¡æ¯æå¡ç±»ï¼éè¿è¯¥æå¡ç±»å¯ä»¥æ¥è¯¢å°æå¡ç«¯æ¯æçæææµ·å¾ç©æ ä¿¡æ¯ã
 *            ç¨æ·å¯ä»¥éè¿ä¸¤ç§æ¹å¼è·åæ¥è¯¢ç»æï¼
 *            ä¸ç§æ¯éè¿çå¬ ChartFeatureInfoSpecsEvent.PROCESS_COMPLETE äºä»¶ï¼
 *            å¦ä¸ç§æ¯ä½¿ç¨ AsyncResponder ç±»å®ç°å¼æ­¥å¤çã
 * @extends {CommonServiceBase}
 * @param {string} url - å°å¾ï¼ç¹ææµ·å¾ï¼æå¡å°åã
 *        å¦ï¼"http://localhost:8090/iserver/services/map-ChartW/rest/maps/æµ·å¾"ã
 *        åéè¯·æ±æ ¼å¼ç±»ä¼¼äºï¼"http://localhost:8090/iserver/services/map-ChartW/rest/maps/æµ·å¾/chartFeatureInfoSpecs.json"ã
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - äºä»¶çå¬å¨å¯¹è±¡ãæprocessCompletedå±æ§å¯ä¼ å¥å¤çå®æåçåè°å½æ°ãprocessFailedå±æ§ä¼ å¥å¤çå¤±è´¥åçåè°å½æ°ã
 * @param {DataFormat} [options.format] - æ¥è¯¢ç»æè¿åæ ¼å¼ï¼ç®åæ¯æ iServerJSON å GeoJSON ä¸¤ç§æ ¼å¼ï¼åæ°æ ¼å¼ä¸º"ISERVER","GEOJSON"ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class ChartFeatureInfoSpecsService extends CommonServiceBase {

    constructor(url, options) {
        super(url, options);
        this.CLASS_NAME = "SuperMap.ChartFeatureInfoSpecsService";
    }

    /**
     * @function ChartFeatureInfoSpecsService.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
        Util.reset(this);
    }

    /**
     * @function ChartFeatureInfoSpecsService.prototype.processAsync
     * @description æ ¹æ®å°å¾ï¼ç¹ææµ·å¾ï¼æå¡å°åä¸æå¡ç«¯å®æå¼æ­¥éè®¯ï¼è·åç©æ ä¿¡æ¯ã
     *              å½æ¥è¯¢ç©æ ä¿¡æ¯æåæ¶ï¼å°è§¦å ChartFeatureInfoSpecsEvent.PROCESS_COMPLETE
     *              äºä»¶ãç¨å¯ä»¥éè¿æ·ä¸¤ç§æ¹å¼è·åå¾å±ä¿¡æ¯:
     *              1. éè¿ AsyncResponder ç±»è·åï¼æ¨èä½¿ç¨ï¼ï¼
     *              2. éè¿çå¬ ChartFeatureInfoSpecsEvent.PROCESS_COMPLETE äºä»¶è·åã
     */
    processAsync() {
        var me = this, method = "GET";
        if (!me.isTempLayers) {
            Util.urlPathAppend(me.url,'chartFeatureInfoSpecs');
        }
        me.request({
            method: method,
            params: null,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }
}

;// CONCATENATED MODULE: ./src/common/iServer/ChartQueryFilterParameter.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class ChartQueryFilterParameter
 * @deprecatedclass SuperMap.ChartQueryFilterParameter
 * @category  iServer Map Chart
 * @classdesc æµ·å¾æ¥è¯¢è¿æ»¤åæ°ç±»ï¼ç¨äºè®¾ç½®æµ·å¾æ¥è¯¢çè¿æ»¤åæ°ãåæ¬ï¼ç©æ ä»£ç ãç©æ å¯åºç¨å¯¹è±¡çéæ©ï¼æ¯å¦æ¥è¯¢ç¹ãçº¿æé¢ï¼ãå±æ§å­æ®µè¿æ»¤æ¡ä»¶ã
 * @param {Object} options - åæ°ã
 * @param {string} options.attributeFilter - å±æ§å­æ®µè¿æ»¤æ¡ä»¶ã
 * @param {number} options.chartFeatureInfoSpecCode - æ¥è¯¢çç©æ ä»£å·ã
 * @param {boolean} [options.isQueryPoint] - æ¯å¦æ¥è¯¢ç¹ã
 * @param {boolean} [options.isQueryLine] - æ¯å¦æ¥è¯¢çº¿ã
 * @param {boolean} [options.isQueryRegion] - æ¯å¦æ¥è¯¢é¢ã
 * @usage
 */
class ChartQueryFilterParameter {


    constructor(options) {
        /**
         * @member {boolean} [ChartQueryFilterParameter.prototype.isQueryPoint]
         * @description æ¯å¦æ¥è¯¢ç¹ã
         */
        this.isQueryPoint = null;

        /**
         * @member {boolean} [ChartQueryFilterParameter.prototype.isQueryLine]
         * @description æ¯å¦æ¥è¯¢çº¿ã
         */
        this.isQueryLine = null;

        /**
         * @member {boolean} [ChartQueryFilterParameter.prototype.isQueryRegion]
         * @description æ¯å¦æ¥è¯¢é¢ã
         */
        this.isQueryRegion = null;

        /**
         * @member {string} ChartQueryFilterParameter.prototype.attributeFilter
         * @description å±æ§å­æ®µè¿æ»¤æ¡ä»¶ã
         */
        this.attributeFilter = null;

        /**
         * @member {number} ChartQueryFilterParameter.prototype.chartFeatureInfoSpecCode
         * @description æ¥è¯¢çç©æ ä»£å·ã
         */
        this.chartFeatureInfoSpecCode = null;

        Util.extend(this, options);

        this.CLASS_NAME = "SuperMap.ChartQueryFilterParameter";
    }

    /**
     * @function ChartQueryFilterParameter.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.isQueryPoint = null;
        me.isQueryLine = null;
        me.isQueryRegion = null;
        me.attributeFilter = null;
        me.chartFeatureInfoSpecCode = null;
    }

    /**
     * @function ChartQueryFilterParameter.prototype.toJson
     * @description å°å±æ§ä¿¡æ¯è½¬åæ JSON æ ¼å¼å­ç¬¦ä¸²ã
     */
    toJson() {
        var json = "";
        json += "\"isQueryPoint\":" + this.isQueryPoint + ",";
        json += "\"isQueryLine\":" + this.isQueryLine + ",";
        json += "\"isQueryRegion\":" + this.isQueryRegion + ",";
        if (this.attributeFilter) {
            json += "\"attributeFilter\": \"" + this.attributeFilter + "\",";
        }
        json += "\"chartFeatureInfoSpecCode\":" + this.chartFeatureInfoSpecCode;
        json = "{" + json + "}";
        return json;
    }


}

;// CONCATENATED MODULE: ./src/common/iServer/ChartQueryParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class ChartQueryParameters
 * @deprecatedclass SuperMap.ChartQueryParameters
 * @category iServer Map Chart
 * @classdesc æµ·å¾æ¥è¯¢åæ°ç±»ï¼è¯¥ç±»ç¨äºè®¾ç½®æµ·å¾æ¥è¯¢æ¶çç¸å³åæ°ï¼æµ·å¾æ¥è¯¢åä¸ºæµ·å¾å±æ§æ¥è¯¢åæµ·å¾èå´æ¥è¯¢ä¸¤ç±»ï¼éè¿å±æ§ queryMode æå®æ¥è¯¢æ¨¡å¼ã
 *            å¿è®¾å±æ§æï¼queryModeãchartLayerNamesãchartQueryFilterParametersãå½è¿è¡æµ·å¾èå´æ¥è¯¢æ¶ï¼å¿è®¾å±æ§è¿åæ¬ boundsã
 * @param {Object} options - åæ°ã
 * @param {string} options.queryMode - æµ·å¾æ¥è¯¢æ¨¡å¼ç±»åï¼æ¯æä¸¤ç§æ¥è¯¢æ¹å¼ï¼æµ·å¾å±æ§æ¥è¯¢ï¼"ChartAttributeQuery"ï¼åæµ·å¾ç©ºé´æ¥è¯¢ï¼"ChartBoundsQuery"ï¼ã
 * @param {Array.<string>} options.chartLayerNames - æ¥è¯¢çæµ·å¾å¾å±çåç§°ã
 * @param {Array.<ChartQueryFilterParameter>} options.chartQueryFilterParameters - æµ·å¾æ¥è¯¢è¿æ»¤åæ°ãåæ¬ï¼ç©æ ä»£ç ãç©æ å¯åºç¨å¯¹è±¡çéæ©ï¼æ¯å¦æ¥è¯¢ç¹ãçº¿æé¢ï¼ãå±æ§å­æ®µè¿æ»¤æ¡ä»¶ã
 * @param {(SuperMap.Bounds|L.Bounds|L.LatLngBounds|ol.extent|mapboxgl.LngLatBounds|GeoJSONObject)} options.bounds - æµ·å¾æ¥è¯¢èå´ãå½è¿è¡æµ·å¾èå´æ¥è¯¢æ¶ï¼æ­¤ä¸ºå¿éåæ°ã
 * @param {boolean} [options.returnContent=true] - è·åæè®¾ç½®æ¯è¿åæ¥è¯¢ç»æè®°å½é recordsetsï¼è¿æ¯è¿åæ¥è¯¢ç»æçèµæº resourceInfoã
 * @param {number} [options.startRecord=0] - æ¥è¯¢èµ·å§è®°å½ä½ç½®ã
 * @param {number} [options.expectCount] - æææ¥è¯¢ç»æè¿åçè®°å½æ°ï¼è¯¥å¼å¤§äº0ã
 * @usage
 */
class ChartQueryParameters {


    constructor(options) {
        /**
         * @member {string} ChartQueryParameters.prototype.queryMode
         * @description æµ·å¾æ¥è¯¢æ¨¡å¼ç±»åï¼æ¯æä¸¤ç§æ¥è¯¢æ¹å¼ï¼æµ·å¾å±æ§æ¥è¯¢ï¼"ChartAttributeQuery"ï¼åæµ·å¾ç©ºé´æ¥è¯¢ï¼"ChartBoundsQuery"ï¼ ã
         */
        this.queryMode = null;

        /**
         * @member {(SuperMap.Bounds|L.Bounds|L.LatLngBounds|ol.extent|mapboxgl.LngLatBounds|GeoJSONObject)} ChartQueryParameters.prototype.bounds
         * @description æµ·å¾æ¥è¯¢èå´ã
         */
         this.bounds = null;

        /**
         * @member {Array.<string>} ChartQueryParameters.prototype.chartLayerNames
         * @description æ¥è¯¢çæµ·å¾å¾å±çåç§°ã
         */
        this.chartLayerNames = null;

        /**
         * @member {Array.<ChartQueryFilterParameter>} ChartQueryParameters.prototype.chartQueryFilterParameters
         * @description æµ·å¾æ¥è¯¢è¿æ»¤åæ°ãåæ¬ï¼ç©æ ä»£ç ãç©æ å¯åºç¨å¯¹è±¡çéæ©ï¼æ¯å¦æ¥è¯¢ç¹ãçº¿æé¢ï¼ãå±æ§å­æ®µè¿æ»¤æ¡ä»¶ã
         */
        this.chartQueryFilterParameters = null;

        /**
         * @member {boolean} [ChartQueryParameters.prototype.returnContent=true]
         * @description è·åæè®¾ç½®æ¯è¿åæ¥è¯¢ç»æè®°å½é recordsetsï¼è¿æ¯è¿åæ¥è¯¢ç»æçèµæº resourceInfoã
         */
        this.returnContent = true;

        /**
         * @member {number} [ChartQueryParameters.prototype.startRecord=0]
         * @description æ¥è¯¢èµ·å§è®°å½ä½ç½®ã
         */
        this.startRecord = 0;

        /**
         * @member {number} [ChartQueryParameters.prototype.expectCount]
         * @description æææ¥è¯¢ç»æè¿åçè®°å½æ°ï¼è¯¥å¼å¤§äº0ã
         */
        this.expectCount = null;
        Util.extend(this, options);

        this.CLASS_NAME = "SuperMap.ChartQueryParameters";
    }

    /**
     * @function ChartQueryParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.queryMode = null;
        me.bounds = null;
        me.chartLayerNames = null;
        me.chartQueryFilterParameters = null;
        me.returnContent = true;
        me.startRecord = 0;
        me.expectCount = null;
    }

    /**
     * @function ChartQueryParameters.prototype.getVariablesJson
     * @description å°å±æ§ä¿¡æ¯è½¬æ¢æè½å¤è¢«æå¡è¯å«ç JSON æ ¼å¼å­ç¬¦ä¸²ã
     * @returns {string} JSON å­ç¬¦ä¸²ã
     */
    getVariablesJson() {
        var json = "";

        json += "\"queryMode\":\"" + this.queryMode + "\",";

        if (this.chartLayerNames && this.chartLayerNames.length) {
            var chartLayersArray = [];
            var layerLength = this.chartLayerNames.length;
            for (var i = 0; i < layerLength; i++) {
                chartLayersArray.push("\"" + this.chartLayerNames[i] + "\"");
            }
            var layerNames = "[" + chartLayersArray.join(",") + "]";
            json += "\"chartLayerNames\":" + layerNames + ",";
        }

        if (this.queryMode === "ChartBoundsQuery" && this.bounds) {
            json += "\"bounds\":" + "{" + "\"leftBottom\":" + "{" + "\"x\":" + this.bounds.left + "," +
                "\"y\":" + this.bounds.bottom + "}" + "," + "\"rightTop\":" + "{" + "\"x\":" + this.bounds.right + "," +
                "\"y\":" + this.bounds.top + "}" + "},";
        }

        if (this.chartQueryFilterParameters && this.chartQueryFilterParameters.length) {
            var chartParamArray = [];
            var chartLength = this.chartQueryFilterParameters.length;
            for (var j = 0; j < chartLength; j++) {
                var chartQueryFilterParameter = this.chartQueryFilterParameters[j];
                if (!(chartQueryFilterParameter instanceof ChartQueryFilterParameter)) {
                    continue;
                }
                chartParamArray.push(chartQueryFilterParameter.toJson());
            }
            var chartParamsJson = "[" + chartParamArray.join(",") + "]";
            chartParamsJson = "\"chartQueryParams\":" + chartParamsJson + ",";
            chartParamsJson += "\"startRecord\":" + this.startRecord + ",";
            chartParamsJson += "\"expectCount\":" + this.expectCount;
            chartParamsJson = "{" + chartParamsJson + "}";
            json += "\"chartQueryParameters\":" + chartParamsJson;
        }
        json = "{" + json + "}";
        return json;
    }
}

;// CONCATENATED MODULE: ./src/common/iServer/QueryParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class QueryParameters
 * @deprecatedclass SuperMap.QueryParameters
 * @category  iServer Map QueryResults
 * @classdesc æ¥è¯¢åæ°åºç±»ãè·ç¦»æ¥è¯¢ãSQL æ¥è¯¢ãå ä½å°ç©æ¥è¯¢ç­åèªçåæ°åç»§æ¿æ­¤ç±»ã
 * @param {Object} options - åæ°ã
 * @param {Array.<FilterParameter>} options.queryParams - æ¥è¯¢è¿æ»¤æ¡ä»¶åæ°æ°ç»ã
 * @param {string} [options.customParams] - èªå®ä¹åæ°ï¼ä¾æ©å±ä½¿ç¨ã
 * @param {Object} [options.prjCoordSys] - èªå®ä¹åæ°ï¼ä¾ SuperMap Online æä¾çå¨ææå½±æ¥è¯¢æ©å±ä½¿ç¨ãå¦ {"epsgCode":3857}ã
 * @param {number} [options.expectCount=100000] - ææè¿åç»æè®°å½ä¸ªæ°ã
 * @param {GeometryType} [options.networkType=GeometryType.LINE] - ç½ç»æ°æ®éå¯¹åºçæ¥è¯¢ç±»åã
 * @param {QueryOption} [options.queryOption=QueryOption.ATTRIBUTEANDGEOMETRY] - æ¥è¯¢ç»æç±»åæä¸¾ç±»ã
 * @param {number} [options.startRecord=0] - æ¥è¯¢èµ·å§è®°å½å·ã
 * @param {number} [options.holdTime=10] - èµæºå¨æå¡ç«¯ä¿å­çæ¶é´,åä½ä¸ºåéã
 * @param {boolean} [options.returnCustomResult=false] - ä»ä¾ä¸ç»´ä½¿ç¨ã
 * @param {boolean} [options.returnFeatureWithFieldCaption = false] - è¿åçæ¥è¯¢ç»æè¦ç´ å­æ®µæ è¯æ¯å¦ä¸ºå­æ®µå«åãä¸º false æ¶ï¼è¿åçæ¯å­æ®µåï¼ä¸º true æ¶ï¼è¿åçæ¯å­æ®µå«åã
 * @usage
 */
class QueryParameters {


    constructor(options) {
        if (!options) {
            return;
        }
        /**
         * @member {string} [QueryParameters.prototype.customParams]
         * @description èªå®ä¹åæ°ï¼ä¾æ©å±ä½¿ç¨ã
         */
        this.customParams = null;

        /**
         * @member {Object} [QueryParameters.prototype.prjCoordSys]
         * @description èªå®ä¹åæ°ï¼ä¾ SuperMap Online æä¾çå¨ææå½±æ¥è¯¢æ©å±ä½¿ç¨ãå¦ {"epsgCode":3857}
         */
        this.prjCoordSys = null;

        /**
         * @member {number} [QueryParameters.prototype.expectCount=100000]
         * @description ææè¿åç»æè®°å½ä¸ªæ°ï¼é»è®¤è¿å100000æ¡æ¥è¯¢è®°å½ï¼
         *              å¦æå®éä¸è¶³100000æ¡åè¿åå®éè®°å½æ¡æ°ã
         */
        this.expectCount = 100000;

        /**
         * @member {GeometryType} [QueryParameters.prototype.networkType=GeometryType.LINE]
         * @description ç½ç»æ°æ®éå¯¹åºçæ¥è¯¢ç±»åï¼åä¸ºç¹åçº¿ä¸¤ç§ç±»åã
         */
        this.networkType = GeometryType.LINE;

        /**
         * @member {QueryOption} [QueryParameters.prototype.queryOption=QueryOption.ATTRIBUTEANDGEOMETRY]
         * @description æ¥è¯¢ç»æç±»åæä¸¾ç±»ã
         *              è¯¥ç±»æè¿°æ¥è¯¢ç»æè¿åç±»åï¼åæ¬åªè¿åå±æ§ã
         *              åªè¿åå ä½å®ä½ä»¥åè¿åå±æ§åå ä½å®ä½ã
         */
        this.queryOption = QueryOption.ATTRIBUTEANDGEOMETRY;

        /**
         * @member {Array.<FilterParameter>} QueryParameters.prototype.queryParams
         * @description æ¥è¯¢è¿æ»¤æ¡ä»¶åæ°æ°ç»ã
         *              è¯¥ç±»ç¨äºè®¾ç½®æ¥è¯¢æ°æ®éçæ¥è¯¢è¿æ»¤åæ°ã
         */
        this.queryParams = null;

        /**
         * @member {number} [QueryParameters.prototype.startRecord=0]
         * @description æ¥è¯¢èµ·å§è®°å½å·ã
         */
        this.startRecord = 0;

        /**
         * @member {number} [QueryParameters.prototype.holdTime=10]
         * @description èµæºå¨æå¡ç«¯ä¿å­çæ¶é´ï¼åä½ä¸ºåéã
         */
        this.holdTime = 10;

        /**
         * @member {boolean} [QueryParameters.prototype.returnCustomResult=false]
         * @description ä»ä¾ä¸ç»´ä½¿ç¨ã
         */
        this.returnCustomResult = false;
        /**
         * @member {boolean} [QueryParameters.prototype.returnFeatureWithFieldCaption=false]
         * @description è¿åçæ¥è¯¢ç»æè¦ç´ å­æ®µæ è¯æ¯å¦ä¸ºå­æ®µå«åãä¸º false æ¶ï¼è¿åçæ¯å­æ®µåï¼ä¸º true æ¶ï¼è¿åçæ¯å­æ®µå«åã
         */
        this.returnFeatureWithFieldCaption = false;
        Util.extend(this, options);

        this.CLASS_NAME = "SuperMap.QueryParameters";
    }

    /**
     * @function QueryParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.customParams = null;
        me.expectCount = null;
        me.networkType = null;
        me.queryOption = null;
        if (me.queryParams) {
            for (var i = 0, qps = me.queryParams, len = qps.length; i < len; i++) {
                qps[i].destroy();
            }
            me.queryParams = null;
        }
        me.startRecord = null;
        me.holdTime = null;
        me.returnCustomResult = null;
        me.prjCoordSys = null;
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/ChartQueryService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/







/**
 * @class ChartQueryService
 * @deprecatedclass SuperMap.ChartQueryService
 * @category  iServer Map Chart
 * @classdesc æµ·å¾æ¥è¯¢æå¡ç±»ãè¯¥ç±»è´è´£å°æµ·å¾æ¥è¯¢æéåæ°ï¼ChartQueryParametersï¼ä¼ éè³æå¡ç«¯ï¼å¹¶è·åæå¡ç«¯çè¿åç»æã
 *      ç¨æ·å¯ä»¥éè¿ä¸¤ç§æ¹å¼è·åæ¥è¯¢ç»æï¼
 *      1.éè¿ AsyncResponder ç±»è·åï¼æ¨èä½¿ç¨ï¼ï¼
 *      2.éè¿çå¬ QueryEvent.PROCESS_COMPLETE äºä»¶è·åã
 * @extends {CommonServiceBase}
 * @param {string} url - å°å¾æ¥è¯¢æå¡è®¿é®å°åãå¦ï¼"http://localhost:8090/iserver/services/map-ChartW/rest/maps/æµ·å¾"ã
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - äºä»¶çå¬å¨å¯¹è±¡ãæprocessCompletedå±æ§å¯ä¼ å¥å¤çå®æåçåè°å½æ°ãprocessFailedå±æ§ä¼ å¥å¤çå¤±è´¥åçåè°å½æ°ã
 * @param {DataFormat} [options.format] - æ¥è¯¢ç»æè¿åæ ¼å¼ï¼ç®åæ¯æ iServerJSON å GeoJSON ä¸¤ç§æ ¼å¼ãåæ°æ ¼å¼ä¸º"ISERVER","GEOJSON"ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @example
 * ä¸é¢ç¤ºä¾æ¾ç¤ºäºå¦ä½è¿è¡æµ·å¾å±æ§æ¥è¯¢ï¼
 * var nameArray = ["GB4X0000_52000"];
 * var chartQueryFilterParameter = new ChartQueryFilterParameter({
 *       isQueryPoint:true,
 *        isQueryLine:true,
 *        isQueryRegion:true,
 *        attributeFilter:"SmID<10",
 *        chartFeatureInfoSpecCode:1
 *    });
 *
 * var chartQueryParameters = new ChartQueryParameters({
 *        queryMode:"ChartAttributeQuery",
 *        chartLayerNames:nameArray,
 *        returnContent:true,
 *        chartQueryFilterParameters:[chartQueryFilterParameter]
 *    });
 *
 * var chartQueryService = new ChartQueryService(url);
 *
 * chartQueryService.events.on({
 *        "processCompleted":processCompleted,
 *        "processFailed":processFailed
 *    });
 * chartQueryService.processAsync(chartQueryParameters);
 * @usage
 */
class ChartQueryService extends CommonServiceBase {


    constructor(url, options) {
        super(url, options);
        options = options || {};

        /**
         * @member {boolean} ChartQueryService.prototype.returnContent
         * @description æ¯å¦ç«å³è¿åæ°åå»ºèµæºçè¡¨è¿°è¿æ¯è¿åæ°èµæºçURIã
         */
        this.returnContent = null;

        /**
         * @member {DataFormat} ChartQueryService.prototype.format
         * @description æ¥è¯¢ç»æè¿åæ ¼å¼ï¼ç®åæ¯æiServerJSON åGeoJSONä¸¤ç§æ ¼å¼
         *              åæ°æ ¼å¼ä¸º"ISERVER","GEOJSON",GEOJSON
         */
        this.format = DataFormat.GEOJSON;

        Util.extend(this, options);
        var me = this;
        if (options.format) {
            me.format = options.format.toUpperCase();
        }

        if (!me.url) {
            return;
        }
        me.url = Util.urlPathAppend(me.url, 'queryResults');

        this.CLASS_NAME = "SuperMap.ChartQueryService";
    }


    /**
     * @function ChartQueryService.prototype.destroy
     * @override
     */
    destroy() {
        var me = this;
        CommonServiceBase.prototype.destroy.apply(this, arguments);
        me.returnContent = null;
        me.format = null;
    }


    /**
     * @function ChartQueryService.prototype.processAsync
     * @description ä½¿ç¨æå¡å°å URL å®ä¾å ChartQueryService å¯¹è±¡ã
     * @param {ChartQueryParameters} params - æ¥è¯¢åæ°ã
     */
    processAsync(params) {
        //todoéç¹éè¦æ·»å ä»£ç çå°æ¹
        if (!(params instanceof ChartQueryParameters)) {
            return;
        }
        var me = this, jsonParameters;
        me.returnContent = params.returnContent;
        jsonParameters = params.getVariablesJson();
        if (me.returnContent) {
            me.url = Util.urlAppend(me.url, 'returnContent=true');
        }
        me.request({
            method: "POST",
            data: jsonParameters,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }


    /**
     * @function ChartQueryService.prototype.serviceProcessCompleted
     * @description æ¥è¯¢å®æï¼æ§è¡æ­¤æ¹æ³ã
     * @param {Object} result - æå¡å¨è¿åçç»æå¯¹è±¡ã
     */
    serviceProcessCompleted(result) {
        var me = this;
        result = Util.transformResult(result);
        if (result && result.recordsets && me.format === DataFormat.GEOJSON) {
            for (var i = 0, recordsets = result.recordsets, len = recordsets.length; i < len; i++) {
                if (recordsets[i].features) {
                    var geoJSONFormat = new GeoJSON();
                    recordsets[i].features = geoJSONFormat.toGeoJSON(recordsets[i].features);
                }
            }

        }
        me.events.triggerEvent("processCompleted", {result: result});
    }

    /**
     * @function ChartQueryService.prototype.getQueryParameters
     * @description å° JSON å¯¹è±¡è¡¨ç¤ºçæ¥è¯¢åæ°è½¬åä¸º QueryParameters å¯¹è±¡ã
     * @param {Object} params - JSON å­ç¬¦ä¸²è¡¨ç¤ºçæ¥è¯¢åæ°ã
     * @returns {QueryParameters} è¿åæ¥è¯¢ç»æ
     */
    getQueryParameters(params) {
        return new QueryParameters({
            queryMode: params.queryMode,
            bounds: params.bounds,
            chartLayerNames: params.chartLayerNames,
            chartQueryFilterParameters: params.chartQueryFilterParameters,
            returnContent: params.returnContent
        });
    }
}

;// CONCATENATED MODULE: ./src/common/iServer/ClipParameter.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class ClipParameter
 * @deprecatedclass SuperMap.ClipParameter
 * @category iServer SpatialAnalyst InterpolationAnalyst
 * @classdesc ç¨äºè£åªçåæ°ãä¼åä½¿ç¨ç¨æ·æå®çè£åªåºåå¤è¾¹å½¢è¿è¡è£åªï¼ä¹å¯ä»¥éè¿æå®æ°æ®æºåæ°æ®éåï¼ä»èä½¿ç¨æå®æ°æ®éçè¾¹çå¤è¾¹å½¢è¿è¡è£åªã
 * @param {Object} options - å¯éåæ°ã
 * @param {string} [options.clipDatasetName] - è£åªçæ°æ®éåã
 * @param {string} [options.clipDatasourceName] - è£åªçæ°æ®éæå¨æ°æ®æºçåå­ã
 * @param {GeometryPolygon|L.Polygon|L.GeoJSON|ol.geom.Polygon|ol.format.GeoJSON|GeoJSONObject}} [options.clipRegion] - ç¨æ·æå®çè£åªåºåã
 * @param {boolean} [options.isClipInRegion=true] - æ¯å¦å¯¹è£åªåºåçæ°æ®éè¿è¡è£åªã
 * @param {boolean} [options.isExactClip=true] - æ¯å¦ä½¿ç¨ç²¾ç¡®è£åªã
 * @usage
 */
class ClipParameter {


    constructor(options) {
        /**
         * @member {string} ClipParameter.prototype.clipDatasetName
         * @description ç¨äºè£åªçæ°æ®éåï¼clipDatasetName ä¸ clipRegion å¿é¡»è®¾ç½®ä¸ä¸ªã
         */
        this.clipDatasetName = null;

        /**
         * @member {string} ClipParameter.prototype.clipDatasourceName
         * @description ç¨äºè£åªçæ°æ®éæå¨æ°æ®æºçåå­ãå½ clipRegion ä¸è®¾ç½®æ¶èµ·ä½ç¨ã
         */
        this.clipDatasourceName = null;

        /**
         * @member {GeometryPolygon|L.Polygon|L.GeoJSON|ol.geom.Polygon|ol.format.GeoJSON|GeoJSONObject} ClipParameter.prototype.clipRegion
         * @description ç¨æ·æå®çè£åªåºåï¼ä¼åä½¿ç¨ï¼clipDatasetName ä¸ clipRegion å¿é¡»è®¾ç½®ä¸ä¸ªã
         */
        this.clipRegion = null;

        /**
         * @member {boolean} [ClipParameter.prototype.isClipInRegion=true]
         * @description æ¯å¦å¯¹è£åªåºåçæ°æ®éè¿è¡è£åªãè¥ä¸º trueï¼åå¯¹è£åªåºååçç»æè¿è¡è£åªï¼è¥ä¸º falseï¼åå¯¹è£åªåºåå¤çç»æè¿è¡è£åªã
         */
        this.isClipInRegion = true;

        /**
         * @member {boolean} [ClipParameter.prototype.isExactClip=true]
         * @description æ¯å¦ä½¿ç¨ç²¾ç¡®è£åªã
         */
        this.isExactClip = null;

        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = "SuperMap.ClipParameter";
    }


    /**
     * @function ClipParameter.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.clipDatasetName = null;
        me.clipDatasourceName = null;
        me.clipRegion = null;
        me.isClipInRegion = null;
        me.isExactClip = null;
    }


    /**
     * @function ClipParameter.prototype.toJSON
     * @description å° ClipParameter å¯¹è±¡è½¬åä¸º JSON å­ç¬¦ä¸²ã
     * @returns {string} è¿åè½¬æ¢åç JSON å­ç¬¦ä¸²ã
     */
    toJSON() {
        return Util.toJSON({
            isClipInRegion: this.isClipInRegion,
            clipDatasetName: this.clipDatasetName,
            clipDatasourceName: this.clipDatasourceName,
            isExactClip: this.isExactClip,
            clipRegion: ServerGeometry.fromGeometry(this.clipRegion)
        });
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/ColorDictionary.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class ColorDictionary
 * @deprecatedclass SuperMap.ColorDictionary
 * @category  iServer Map Theme
 * @classdesc é¢è²å¯¹ç§è¡¨ç±»ãé¢è²å¯¹ç§è¡¨ä¸­çé®åä¸ºå·ä½çé«ç¨å¼ï¼é®å¼è¡¨ç¤ºè¯¥é«ç¨å¼è¦æ¾ç¤ºçé¢è²ã
 * å¯¹äºæ æ ¼å¾å±ä¸­é«ç¨å¼å°äºé¢è²å¯¹ç§è¡¨ä¸­é«ç¨æå°å¼çç¹ä½¿ç¨é¢è²å¯¹ç§è¡¨ä¸­é«ç¨æå°å¼å¯¹åºçé¢è²ï¼
 * å¯¹äºæ æ ¼å¾å±ä¸­é«ç¨å¼å¤§äºé¢è²å¯¹ç§è¡¨ä¸­é«ç¨æå¤§å¼çç¹ä½¿ç¨é¢è²å¯¹ç§è¡¨ä¸­é«ç¨æå¤§å¼å¯¹åºçé¢è²ï¼
 * å¯¹äºæ æ ¼å¾å±ä¸­é«ç¨å¼å¨é¢è²å¯¹ç§è¡¨ä¸­æ²¡æå¯¹åºé¢è²çç¹ï¼åæ¥æ¾é¢è²å¯¹ç§è¡¨ä¸­ä¸å½åé«ç¨å¼ç¸é»çä¸¤ä¸ªé«ç¨å¯¹åºçé¢è²ï¼
 * ç¶åéè¿æ¸åè¿ç®è¦æ¾ç¤ºçé¢è²ãå¦æè®¾ç½®äºé¢è²å¯¹ç§è¡¨çè¯ï¼åé¢è²è¡¨è®¾ç½®æ æã
 * @param {Object} options - åæ°ã
 * @param {number} options.elevation - é«ç¨å¼ã
 * @param {ServerColor} options.color - æå¡ç«¯é¢è²ç±»ã
 * @usage
 */
class ColorDictionary {


    constructor(options) {
        options = options || {};

        /**
         * @member {number} ColorDictionary.prototype.elevation
         * @description é«ç¨å¼ã
         */
        this.elevation = null;

        /**
         * @member {ServerColor} ColorDictionary.prototype.color
         * @description æå¡ç«¯é¢è²ç±»ã
         */
        this.color = null;

        Util.extend(this, options);

        var me = this,
            c = me.color;
        if (c) {
            me.color = new ServerColor(c.red, c.green, c.blue);
        }

        this.CLASS_NAME = "SuperMap.ColorDictionary";
    }

    /**
     * @function ColorDictionary.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        Util.reset(this);
    }

    /**
     * @function ColorDictionary.prototype.toServerJSONObject
     * @description è½¬æ¢æå¯¹åºç JSON æ ¼å¼å¯¹è±¡ã
     * @returns {Object} JSON å¯¹è±¡ã
     */
    toServerJSONObject() {
        var dataObj = {};
        dataObj = Util.copyAttributes(dataObj, this);
        return dataObj;
    }
}



;// CONCATENATED MODULE: ./src/common/iServer/TransportationAnalystResultSetting.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class TransportationAnalystResultSetting
 * @deprecatedclass SuperMap.TransportationAnalystResultSetting
 * @category  iServer NetworkAnalyst
 * @classdesc äº¤éç½ç»åæç»æåæ°ç±»ãéè¿è¯¥ç±»è®¾ç½®äº¤éç½ç»åæè¿åçç»æï¼åæ¬æ¯å¦è¿åå¾çãæ¯å¦è¿åå¼§æ®µç©ºé´ä¿¡æ¯ãæ¯å¦è¿åç»ç¹ç©ºé´ä¿¡æ¯ç­ã
 * @param {Object} options - å¯éåæ°ã
 * @param {boolean} [options.returnEdgeFeatures=false] - æ¯å¦å¨åæç»æä¸­åå«å¼§æ®µè¦ç´ éåã
 * @param {boolean} [options.returnEdgeGeometry=false] - è¿åçå¼§æ®µè¦ç´ éåä¸­æ¯å¦åå«å ä½å¯¹è±¡ä¿¡æ¯ã
 * @param {boolean} [options.returnEdgeIDs=false] - è¿åç»æä¸­æ¯å¦åå«ç»è¿å¼§æ®µ ID éåã
 * @param {boolean} [options.returnNodeFeatures=false] - æ¯å¦å¨åæç»æä¸­åå«ç»ç¹è¦ç´ éåã
 * @param {boolean} [options.returnNodeGeometry=false] - è¿åçç»ç¹è¦ç´ éåä¸­æ¯å¦åå«å ä½å¯¹è±¡ä¿¡æ¯ã
 * @param {boolean} [options.returnNodeIDs=false] - è¿åç»æä¸­æ¯å¦åå«ç»è¿ç»ç¹ ID éåã
 * @param {boolean} [options.returnPathGuides=false] - è¿ååæç»æä¸­æ¯å¦åå«è¡é©¶å¯¼å¼éåã
 * @param {boolean} [options.returnRoutes=false] - è¿ååæç»æä¸­æ¯å¦åå«è·¯ç±å¯¹è±¡çéåã
 * @usage
 */
class TransportationAnalystResultSetting {

    constructor(options) {
        if (!options) {
            return;
        }

        /**
         * @member {boolean} TransportationAnalystResultSetting.prototype.returnEdgeFeatures
         * @description æ¯å¦å¨åæç»æä¸­åå«å¼§æ®µè¦ç´ éåãå¼§æ®µè¦ç´ åæ¬å¼§æ®µçç©ºé´ä¿¡æ¯åå±æ§ä¿¡æ¯ã
         */
        this.returnEdgeFeatures = false;

        /**
         * @member {boolean} [TransportationAnalystResultSetting.prototype.returnEdgeGeometry=false]
         * @description è¿åçå¼§æ®µè¦ç´ éåä¸­æ¯å¦åå«å ä½å¯¹è±¡ä¿¡æ¯ã
         */
        this.returnEdgeGeometry = false;

        /**
         * @member {boolean} [TransportationAnalystResultSetting.prototype.returnEdgeIDs=false]
         * @description è¿åç»æä¸­æ¯å¦åå«ç»è¿å¼§æ®µ ID éåã
         */
        this.returnEdgeIDs = false;

        /**
         * @member {boolean} [TransportationAnalystResultSetting.prototype.returnNodeFeatures=false]
         * @description æ¯å¦å¨åæç»æä¸­åå«ç»ç¹è¦ç´ éåã
         * ç»ç¹è¦ç´ åæ¬ç»ç¹çç©ºé´ä¿¡æ¯åå±æ§ä¿¡æ¯ãå¶ä¸­è¿åçç»ç¹è¦ç´ æ¯å¦åå«ç©ºé´ä¿¡æ¯å¯éè¿ returnNodeGeometry å­æ®µè®¾ç½®ã
         */
        this.returnNodeFeatures = false;

        /**
         * @member {boolean} [TransportationAnalystResultSetting.prototype.returnNodeGeometry=false]
         * @description è¿åçç»ç¹è¦ç´ éåä¸­æ¯å¦åå«å ä½å¯¹è±¡ä¿¡æ¯ã
         */
        this.returnNodeGeometry = false;

        /**
         * @member {boolean} [TransportationAnalystResultSetting.prototype.returnNodeIDs=false]
         * @description è¿åç»æä¸­æ¯å¦åå«ç»è¿ç»ç¹ ID éåã
         */
        this.returnNodeIDs = false;

        /**
         * @member {boolean} TransportationAnalystResultSetting.prototype.returnPathGuides
         * @description è¿ååæç»æä¸­æ¯å¦åå«è¡é©¶å¯¼å¼éåã
         */
        this.returnPathGuides = false;

        /**
         * @member {boolean} TransportationAnalystResultSetting.prototype.returnRoutes
         * @description è¿ååæç»æä¸­æ¯å¦åå«è·¯ç±å¯¹è±¡çéåã
         */
        this.returnRoutes = false;

        Util.extend(this, options);

        this.CLASS_NAME = "SuperMap.TransportationAnalystResultSetting";
    }

    /**
     * @function TransportationAnalystResultSetting.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.returnEdgeFeatures = null;
        me.returnEdgeGeometry = null;
        me.returnEdgeIDs = null;
        me.returnNodeFeatures = null;
        me.returnNodeGeometry = null;
        me.returnNodeIDs = null;
        me.returnPathGuides = null;
        me.returnRoutes = null;
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/TransportationAnalystParameter.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class TransportationAnalystParameter
 * @deprecatedclass SuperMap.TransportationAnalystParameter
 * @category  iServer NetworkAnalyst
 * @classdesc äº¤éç½ç»åæéç¨åæ°ç±»ãè¯¥ç±»ä¸»è¦ç¨æ¥æä¾äº¤éç½ç»åææéçéç¨åæ°ã
 * éè¿æ¬ç±»å¯ä»¥è®¾ç½®éç¢è¾¹ãéç¢ç¹ãæå¼å­æ®µä¿¡æ¯çåç§°æ è¯ãè½¬åæå¼å­æ®µç­ä¿¡æ¯ï¼è¿å¯ä»¥å¯¹åæç»æåå«çåå®¹è¿è¡ä¸äºè®¾ç½®ã
 * @param {Object} options - åæ°ã
 * @param {Array.<number>} options.barrierEdgeIDs - ç½ç»åæä¸­éç¢å¼§æ®µç ID æ°ç»ã
 * @param {Array.<number>} options.barrierNodeIDs - ç½ç»åæä¸­éç¢ç¹ç ID æ°ç»ã
 * @param {string} options.turnWeightField - è½¬åæéå­æ®µçåç§°ã
 * @param {TransportationAnalystResultSetting} options.resultSetting - åæç»æè¿ååå®¹ã
 * @param {Array.<GeometryPoint|L.Point|L.LatLng|ol.geom.Point|mapboxgl.LngLat|mapboxgl.Point|Array.<number>>} [options.barrierPoints] - ç½ç»åæä¸­ Point2D ç±»åçéç¢ç¹æ°ç»ã
 * @param {string} [options.weightFieldName] - é»åå­æ®µçåç§°ã
 * @usage
 */
class TransportationAnalystParameter {

    constructor(options) {

        if (!options) {
            return;
        }
        /**
         * @member {Array.<number>} TransportationAnalystParameter.prototype.barrierEdgeIDs
         * @description ç½ç»åæä¸­éç¢å¼§æ®µç ID æ°ç»ãå¼§æ®µè®¾ç½®ä¸ºéç¢è¾¹ä¹åï¼è¡¨ç¤ºååé½ä¸éã
         */
        this.barrierEdgeIDs = null;

        /**
         * @member {Array.<number>} TransportationAnalystParameter.prototype.barrierNodeIDs
         * @description ç½ç»åæä¸­éç¢ç¹ç ID æ°ç»ãç»ç¹è®¾ç½®ä¸ºéç¢ç¹ä¹åï¼è¡¨ç¤ºä»»ä½æ¹åé½ä¸è½éè¿æ­¤ç»ç¹ã
         */
        this.barrierNodeIDs = null;

        /**
         * @member {Array.<GeometryPoint|L.Point|L.LatLng|ol.geom.Point|mapboxgl.LngLat|mapboxgl.Point|Array.<number>>}  TransportationAnalystParameter.prototype.barrierPoints
         * @description ç½ç»åæä¸­ Point2D ç±»åçéç¢ç¹æ°ç»ãéç¢ç¹è¡¨ç¤ºä»»ä½æ¹åé½ä¸è½éè¿æ­¤ç¹ã</br>
         * å½åç½ç»åæåæ°ç±»ä¸­ç isAnalyzeById å±æ§è®¾ç½®ä¸º false æ¶ï¼è¯¥å±æ§æçæã
         */
        this.barrierPoints = null;

        /**
         * @member {string} [TransportationAnalystParameter.prototype.weightFieldName]
         * @description é»åå­æ®µçåç§°ï¼æ è¯äºè¿è¡ç½ç»åææ¶æä½¿ç¨çé»åå­æ®µï¼ä¾å¦è¡¨ç¤ºæ¶é´ãé¿åº¦ç­çå­æ®µé½å¯ä»¥ç¨ä½é»åå­æ®µã
         * è¯¥å­æ®µé»å¼ä¸ºæå¡å¨åå¸çææèè´¹å­æ®µçç¬¬ä¸ä¸ªå­æ®µã
         */
        this.weightFieldName = null;

        /**
         * @member {string} TransportationAnalystParameter.prototype.turnWeightField
         * @description è½¬åæéå­æ®µçåç§°ã
         */
        this.turnWeightField = null;

        /**
         *  @member {TransportationAnalystResultSetting} TransportationAnalystParameter.prototype.resultSetting
         *  @description åæç»æè¿ååå®¹ã
         */
        this.resultSetting = new TransportationAnalystResultSetting();

        Util.extend(this, options);

        this.CLASS_NAME = "SuperMap.TransportationAnalystParameter";
    }

    /**
     * @function TransportationAnalystParameter.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.barrierEdgeIDs = null;
        me.barrierNodeIDs = null;
        me.weightFieldName = null;
        me.turnWeightField = null;
        if (me.resultSetting) {
            me.resultSetting.destroy();
            me.resultSetting = null;
        }
        if (me.barrierPoints && me.barrierPoints.length) {
            for (var i in me.barrierPoints) {
                me.barrierPoints[i].destroy();
            }
        }
        me.barrierPoints = null;
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/ComputeWeightMatrixParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class ComputeWeightMatrixParameters
 * @deprecatedclass SuperMap.ComputeWeightMatrixParameters
 * @category iServer NetworkAnalyst WeightMatrix
 * @classdesc èè´¹ç©éµåæåæ°ç±»ãæ ¹æ®äº¤éç½ç»åæåæ°ä¸­çèè´¹å­æ®µè¿åä¸ä¸ªèè´¹ç©éµãè¯¥ç©éµæ¯ä¸ä¸ªäºç»´æ°ç»ï¼ç¨æ¥å­å¨ä»»æä¸¤ç¹é´çèµæºæ¶èã
 * @param {Object} options - åæ°ã
 * @param {boolean} [options.isAnalyzeById=false] - æ¯å¦éè¿èç¹ ID æå®è·¯å¾åæçç»ç¹ã
 * @param {Array.<GeometryPoint|L.LatLng|L.Point|ol.geom.Point|mapboxgl.LngLat|Array.<number>>} options.nodes - è¦è®¡ç®èè´¹ç©éµçç¹æ°ç»ã
 * @param {TransportationAnalystParameter} [options.parameter] - äº¤éç½ç»åæéç¨åæ°ã
 * @usage
 */
class ComputeWeightMatrixParameters {


    constructor(options) {
        /**
         * @member {boolean} [ComputeWeightMatrixParameters.prototype.isAnalyzeById=false]
         * @description æ¯å¦éè¿èç¹ ID æå®è·¯å¾åæçç»ç¹ï¼å³éè¿åæ ç¹æå®ã
         */
        this.isAnalyzeById = false;

        /**
         * @member {Array.<GeometryPoint|L.LatLng|L.Point|ol.geom.Point|mapboxgl.LngLat|Array.<number>>} ComputeWeightMatrixParameters.prototype.nodes
         * @description è¦è®¡ç®èè´¹ç©éµçç¹æ°ç»ã
         *              å½ {@link ComputeWeightMatrixParameters.isAnalyzeById} = false æ¶ï¼nodes åºä¸ºç¹çåæ æ°ç»ï¼
         *              å½ {@link ComputeWeightMatrixParameters.isAnalyzeById} = true æ¶ï¼nodes åºä¸ºç¹ç ID æ°ç»ã
         */
        this.nodes = null;

        /**
         * @member {TransportationAnalystParameter} ComputeWeightMatrixParameters.prototype.parameter
         * @description äº¤éç½ç»åæéç¨åæ°ã
         */
        this.parameter = new TransportationAnalystParameter();

        Util.extend(this, options);

        this.CLASS_NAME = "SuperMap.ComputeWeightMatrixParameters";
    }

    /**
     * @function ComputeWeightMatrixParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.isAnalyzeById = null;
        me.nodes = null;
        if (me.parameter) {
            me.parameter.destroy();
            me.parameter = null;
        }
    }
}

;// CONCATENATED MODULE: ./src/common/iServer/ComputeWeightMatrixService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class ComputeWeightMatrixService
 * @deprecatedclass SuperMap.ComputeWeightMatrixService
 * @category  iServer NetworkAnalyst WeightMatrix
 * @classdesc èè´¹ç©éµåææå¡ç±»ã
 *            èè´¹ç©éµæ¯æ ¹æ®äº¤éç½ç»åæåæ°ä¸­çèè´¹å­æ®µæ¥è®¡ç®ä¸ä¸ªäºç»´æ°ç»ï¼
 *            ç¨æ¥å­å¨æå®çä»»æä¸¤ç¹é´çèµæºæ¶èã
 *            èè´¹ç©éµåæç»æéè¿è¯¥ç±»æ¯æçäºä»¶ççå¬å½æ°åæ°è·å
 * @extends {NetworkAnalystServiceBase}
 * @example
 * var mycomputeWeightMatrixService = new ComputeWeightMatrixService(url,{
 *     eventListeners: {
 *	       "processCompleted": computeWeightMatrixCompleted,
 *		   "processFailed": computeWeightMatrixnError
 *	   }
 * });
 * @param {string} url - èè´¹ç©éµåææå¡å°åãè¯·æ±æå¡çURLåºä¸ºï¼
 *                       http://{æå¡å¨å°å}:{æå¡ç«¯å£å·}/iserver/services/{ç½ç»åææå¡å}/rest/networkanalyst/{ç½ç»æ°æ®é@æ°æ®æº}ï¼
 *                       ä¾å¦ï¼"http://localhost:8090/iserver/services/components-rest/rest/networkanalyst/RoadNet@Changchun"ã
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - éè¦è¢«æ³¨åççå¬å¨å¯¹è±¡ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class ComputeWeightMatrixService extends NetworkAnalystServiceBase {

    constructor(url, options) {
        super(url, options);
        this.CLASS_NAME = "SuperMap.ComputeWeightMatrixService";
    }


    /**
     * @function ComputeWeightMatrixService.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
    }


    /**
     * @function ComputeWeightMatrixService.prototype.processAsync
     * @description è´è´£å°å®¢æ·ç«¯çæ¥è¯¢åæ°ä¼ éå°æå¡ç«¯ã
     * @param {ComputeWeightMatrixParameters} params - èè´¹ç©éµåæåæ°ç±»
     */
    processAsync(params) {
        if (!(params instanceof ComputeWeightMatrixParameters)) {
            return;
        }
        var me = this,
            jsonObject;
        me.url = Util.urlPathAppend(me.url, 'weightmatrix');
        jsonObject = {
            parameter: Util.toJSON(params.parameter),
            nodes: me.getJson(params.isAnalyzeById, params.nodes)
        };
        me.request({
            method: "GET",
            params: jsonObject,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }

    /**
     * @function ComputeWeightMatrixService.prototype.getJson
     * @description å°å¯¹è±¡è½¬åä¸ºJSONå­ç¬¦ä¸²ã
     * @param {boolean} isAnalyzeById - æ¯å¦éè¿idåæ
     * @param {Array.<ComputeWeightMatrixParameters>} params - åæåæ°æ°ç»
     * @returns {string} è½¬ååçJSONå­ç¬¦ä¸²ã
     */
    getJson(isAnalyzeById, params) {
        var jsonString = "[",
            len = params ? params.length : 0;

        if (isAnalyzeById === false) {
            for (let i = 0; i < len; i++) {
                if (i > 0) {
                    jsonString += ",";
                }
                jsonString += '{"x":' + params[i].x + ',"y":' + params[i].y + '}';
            }
        } else if (isAnalyzeById === true) {
            for (let i = 0; i < len; i++) {
                if (i > 0) {
                    jsonString += ",";
                }
                jsonString += params[i];
            }
        }
        jsonString += ']';
        return jsonString;
    }
}

;// CONCATENATED MODULE: ./src/common/iServer/DataFlowService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class DataFlowService
 * @deprecatedclass SuperMap.DataFlowService
 * @category iServer DataFlow
 * @classdesc æ°æ®æµæå¡ç±»
 * @extends {CommonServiceBase}
 * @param {string} url - æ°æ®æµæå¡å°å
 * @param {Object} options - åæ°ã
 * @param {function} options.style - è®¾ç½®æ°æ®å è½½æ ·å¼ã
 * @param {function} [options.onEachFeature] - è®¾ç½®æ¯ä¸ªæ°æ®å è½½popupç­ã
 * @param {GeoJSONObject} [options.geometry] - æå®å ä½èå´ï¼è¯¥èå´åçè¦ç´ æè½è¢«è®¢éã
 * @param {Object} [options.excludeField] - -æé¤å­æ®µã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class DataFlowService_DataFlowService extends CommonServiceBase {


    constructor(url, options) {
        options = options || {};
        /*
         * @constant EVENT_TYPES
         * {Array.<string>}
         * æ­¤ç±»æ¯æçäºä»¶ç±»å
         */
        options.EVENT_TYPES = ["broadcastSocketConnected", "broadcastSocketClosed", "broadcastSocketError", "broadcastFailed", "broadcastSucceeded", "subscribeSocketConnected", "subscribeSocketClosed", "subscribeSocketError", "messageSucceeded", "setFilterParamSucceeded"]
        super(url, options);

        /**
         * @member {GeoJSONObject} DataFlowService.prototype.geometry
         * @description æå®å ä½èå´ï¼è¯¥èå´åçè¦ç´ æè½è¢«è®¢éã
         */
        this.geometry = null;

        /**
         * @member {Object} DataFlowService.prototype.prjCoordSys
         * @description å¨ææå½±åæ°
         */
        this.prjCoordSys = null;

        /**
         * @member {Object} DataFlowService.prototype.excludeField
         * @description æé¤å­æ®µ
         */
        this.excludeField = null;

        Util.extend(this, options);

        this.CLASS_NAME = "SuperMap.DataFlowService";
    }

    /**
     * @function DataFlowService.prototype.initBroadcast
     * @description åå§åå¹¿æ­
     * @returns {DataFlowService}
     */
    initBroadcast() {
        var me = this;
        this.broadcastWebSocket = this._connect(Util.urlPathAppend(me.url, 'broadcast'));
        this.broadcastWebSocket.onopen = function (e) {
            me.broadcastWebSocket.isOpen = true;
            e.eventType = 'broadcastSocketConnected';
            me.events.triggerEvent('broadcastSocketConnected', e);
        };
        this.broadcastWebSocket.onclose = function (e) {
            if (me.broadcastWebSocket) {
                me.broadcastWebSocket.isOpen = false;
            }
            e.eventType = 'broadcastSocketClosed';
            me.events.triggerEvent('broadcastSocketClosed', e);
        };
        this.broadcastWebSocket.onerror = function (e) {
            e.eventType = 'broadcastSocketError';
            me.events.triggerEvent('broadcastSocketError', e);
        };
        return this;
    }

    /**
     * @function DataFlowService.prototype.broadcast
     * @description å è½½å¹¿æ­æ°æ®ã
     * @param {GeoJSONObject} geoJSONFeature - JSON æ ¼å¼çè¦ç´ æ°æ®ã
     */
    broadcast(geoJSONFeature) {
        if (!this.broadcastWebSocket||!this.broadcastWebSocket.isOpen) {
            this.events.triggerEvent('broadcastFailed');
            return;
        }
        this.broadcastWebSocket.send(JSON.stringify(geoJSONFeature));
        this.events.triggerEvent('broadcastSucceeded');

    }

    /**
     * @function DataFlowService.prototype.initSubscribe
     * @description åå§åè®¢éæ°æ®
     * @returns {DataFlowService} DataFlowServiceçå®ä¾å¯¹è±¡ã
     */
    initSubscribe() {
        var me = this;
        this.subscribeWebSocket = this._connect(Util.urlPathAppend(me.url, 'subscribe'));
        this.subscribeWebSocket.onopen = function (e) {
            me.subscribeWebSocket.send(me._getFilterParams());
            e.eventType = 'subscribeSocketConnected';
            me.events.triggerEvent('subscribeSocketConnected', e);
        };
        this.subscribeWebSocket.onclose = function (e) {
            e.eventType = 'subscribeWebSocketClosed';
            me.events.triggerEvent('subscribeWebSocketClosed', e);
        };
        this.subscribeWebSocket.onerror = function (e) {
            e.eventType = 'subscribeSocketError';
            me.events.triggerEvent('subscribeSocketError', e);
        };
        this.subscribeWebSocket.onmessage = function (e) {
            me._onMessage(e);
        };
        return this;
    }


    /**
     * @function DataFlowService.prototype.setExcludeField
     * @description è®¾ç½®æé¤å­æ®µ
     * @param {Object} excludeField - æé¤å­æ®µ
     * @returns {DataFlowService} DataFlowServiceçå®ä¾å¯¹è±¡ã
     */
    setExcludeField(excludeField) {
        this.excludeField = excludeField;
        this.subscribeWebSocket.send(this._getFilterParams());
        return this;
    }

    /**
     * @function DataFlowService.prototype.setGeometry
     * @description è®¾ç½®æ·»å çå ä½è¦ç´ æ°æ®
     * @param {GeoJSONObject} geometry - æå®å ä½èå´ï¼è¯¥èå´åçè¦ç´ æè½è¢«è®¢éã
     * @returns {DataFlowService} DataFlowServiceçå®ä¾å¯¹è±¡ã
     */
    setGeometry(geometry) {
        this.geometry = geometry;
        this.subscribeWebSocket.send(this._getFilterParams());
        return this;
    }

    /**
     * @function DataFlowService.prototype.unSubscribe
     * @description ç»æè®¢éæ°æ®
     */
    unSubscribe() {
        if (!this.subscribeWebSocket) {
            return;
        }
        this.subscribeWebSocket.close();
        this.subscribeWebSocket = null;
    }

    /**
     * @function DataFlowService.prototype.unBroadcast
     * @description ç»æå è½½å¹¿æ­
     */
    unBroadcast() {
        if (!this.broadcastWebSocket) {
            return;
        }
        this.broadcastWebSocket.close();
        this.broadcastWebSocket = null;
    }

    /**
     * @function DataFlowService.prototype.destroy
     * @override
     */
    destroy() {
        CommonServiceBase.prototype.destroy.apply(this, arguments);
        var me = this;
        me.geometry = null;
        me.prjCoordSys = null;
        me.excludeField = null;
        this.unBroadcast();
        this.unSubscribe();

    }


    _getFilterParams() {
        var filter = {
            filterParam: {
                prjCoordSys: this.prjCoordSys,
                excludeField: this.excludeField,
                geometry: this.geometry
            }
        };
        return Util.toJSON(filter);
    }


    _onMessage(e) {
        if (e.data && e.data.indexOf("filterParam") >= 0) {
            var filterParam = JSON.parse(e.data);
            e.filterParam = filterParam;
            e.eventType = 'setFilterParamSucceeded';
            this.events.triggerEvent('setFilterParamSucceeded', e);
            return;
        }
        var feature = JSON.parse(e.data);
        e.featureResult = feature;
        e.eventType = 'messageSucceeded';
        this.events.triggerEvent('messageSucceeded', e);
    }


    _connect(url) {
        url = SecurityManager.appendCredential(url);
        if ("WebSocket" in window) {
            return new WebSocket(url);
        } else if ("MozWebSocket" in window) {
            var mozWebSocket = window.MozWebSocket;
            return new mozWebSocket(url);
        } else {
            console.log("no WebSocket");
            return null;
        }
    }
}

;// CONCATENATED MODULE: ./src/common/iServer/DatasetInfo.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class DatasetInfo
 * @deprecatedclass SuperMap.DatasetInfo
 * @category  iServer Data Dataset
 * @classdesc æ°æ®éä¿¡æ¯ç±»ã
 * æ°æ®éä¸è¬ä¸ºå­å¨å¨ä¸èµ·çç¸å³æ°æ®çéåï¼æ ¹æ®æ°æ®ç±»åçä¸åï¼åä¸ºç¢éæ°æ®éãæ æ ¼æ°æ®éï¼griddatasetï¼å
 * å½±åæ°æ®éï¼image datasetï¼ï¼ä»¥åä¸ºäºå¤çç¹å®é®é¢èè®¾è®¡çæ°æ®éï¼å¦æææ°æ®éï¼ç½ç»æ°æ®éç­ã
 * æ°æ®éæ¯ GIS æ°æ®ç»ç»çæå°åä½ãå¶ä¸­ç¢éæ°æ®éæ¯ç±åç§ç±»åç©ºé´è¦ç´ ç»æçéåï¼
 * æä»¥ä¹å¯ä»¥ç§°ä¸ºè¦ç´ éãæ ¹æ®è¦ç´ çç©ºé´ç¹å¾çä¸åï¼ç¢éæ°æ®éååä¸ºç¹æ°æ®éï¼
 * çº¿æ°æ®éï¼é¢æ°æ®éç­ï¼åç¢éæ°æ®éæ¯ç©ºé´ç¹å¾åæ§è´¨ç¸åçæ°æ®ç»ç»èµ·æ¥çéåã
 * ç®åçæ¬æ¯æçæ°æ®éä¸»è¦æç¹æ°æ®éï¼çº¿æ°æ®éï¼é¢æ°æ®éï¼ææ¬æ°æ®éï¼å¤åæ°æ®éï¼CAD æ°æ®éï¼ã
 * ç½ç»æ°æ®éï¼æ æ ¼æ°æ®éï¼grid datasetï¼åå½±åæ°æ®éï¼image datasetï¼ã
 * @param {Object} options - åæ°ã
 * @param {Bounds} [options.bounds] - æ°æ®éèå´ã
 * @param {string} [options.dataSourceName] - æ°æ®æºåç§°ã
 * @param {string} [options.description] - æ°æ®éçæè¿°ä¿¡æ¯ã
 * @param {string} [options.encodeType] - æ°æ®éå­å¨æ¶çåç¼©ç¼ç æ¹å¼ã
 * @param {boolean} [options.isReadOnly] - æ°æ®éæ¯å¦ä¸ºåªè¯»ã
 * @param {string} options.name - æ°æ®éåç§°ã
 * @param {Object} [options.prjCoordSys] - æ°æ®éçæå½±ä¿¡æ¯ãå¦ï¼prjCoordSys={"epsgCode":3857}ã
 * @param {string} [options.tableName] - è¡¨åã
 * @param {string} options.type - æ°æ®éç±»åãä¸»è¦æç¹æ°æ®éï¼çº¿æ°æ®éï¼é¢æ°æ®éï¼ææ¬æ°æ®éï¼å¤åæ°æ®éï¼CAD æ°æ®éï¼ãç½ç»æ°æ®éï¼æ æ ¼æ°æ®éï¼grid datasetï¼åå½±åæ°æ®éï¼image datasetï¼ã
 * @usage
 */
class DatasetInfo {


    constructor(options) {
        options = options || {};

        /**
         * @member {Bounds} [DatasetInfo.prototype.bounds]
         * @description æ°æ®éèå´ï¼è¯¥å­æ®µåªè¯»ã
         */
        this.bounds = null;

        /**
         * @member {string} [DatasetInfo.prototype.dataSourceName]
         * @description æ°æ®æºåç§°ï¼è¯¥å­æ®µåªè¯»ã
         */
        this.dataSourceName = null;

        /**
         * @member {string} [DatasetInfo.prototype.description]
         * @description æ°æ®éçæè¿°ä¿¡æ¯ã
         */
        this.description = null;

        /**
         * @member {string} [DatasetInfo.prototype.encodeType]
         * @description æ°æ®éå­å¨æ¶çåç¼©ç¼ç æ¹å¼ï¼è¯¥å­æ®µåªè¯»ã
         */
        this.encodeType = null;

        /**
         * @member {boolean} [DatasetInfo.prototype.isReadOnly]
         * @description æ°æ®éæ¯å¦ä¸ºåªè¯»ã
         */
        this.isReadOnly = null;

        /**
         * @member {string} DatasetInfo.prototype.name
         * @description æ°æ®éåç§°ï¼è¯¥å­æ®µå¿é¡»ä¸åªè¯»ã
         */
        this.name = null;

        /**
         * @member {Object} [DatasetInfo.prototype.prjCoordSys]
         * @description æ°æ®éçæå½±ä¿¡æ¯ã
         */
        this.prjCoordSys = null;

        /**
         * @member {string} [DatasetInfo.prototype.tableName]
         * @description è¡¨åï¼è¯¥å­æ®µåªè¯»ã
         */
        this.tableName = null;

        /**
         * @member {string} DatasetInfo.prototype.type
         * @description æ°æ®éç±»åï¼è¯¥å­æ®µå¿è®¾ãä¸»è¦æç¹æ°æ®éï¼çº¿æ°æ®éï¼é¢æ°æ®éï¼ææ¬æ°æ®éï¼å¤åæ°æ®éï¼CAD æ°æ®éï¼ãç½ç»æ°æ®éï¼æ æ ¼æ°æ®éï¼grid datasetï¼åå½±åæ°æ®éï¼image datasetï¼ã
         */
        this.type = null;

        Util.extend(this, options);

        var b = this.bounds;
        if (b) {
            this.bounds = new Bounds(b.leftBottom.x, b.leftBottom.y, b.rightTop.x, b.rightTop.y);
        }
        this.CLASS_NAME = "SuperMap.DatasetInfo";
    }

    /**
     * @function DatasetInfo.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        Util.reset(this);
    }

    /**
     * @function DatasetInfo.prototype.toServerJSONObject
     * @description è½¬æ¢æå¯¹åºç JSON æ ¼å¼å¯¹è±¡ã
     * @returns {Object} JSON å¯¹è±¡ã
     */
    toServerJSONObject() {
        var dataObj = {};
        dataObj = Util.copyAttributes(dataObj, this);
        if (dataObj.bounds) {
            if (dataObj.bounds.toServerJSONObject) {
                dataObj.bounds = dataObj.bounds.toServerJSONObject();
            }
        }
        return dataObj;
    }
}

;// CONCATENATED MODULE: ./src/common/iServer/OverlayAnalystParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class OverlayAnalystParameters
 * @deprecatedclass SuperMap.OverlayAnalystParameters
 * @category  iServer SpatialAnalyst OverlayAnalyst
 * @classdesc å å åæåæ°åºç±»ãæ°æ®éå å åæåæ°åå ä½å¯¹è±¡å å åæåæ°åç»§æ¿æ­¤åºç±»ã
 * @param {Object} options - åæ°ã
 * @usage
 */
class OverlayAnalystParameters {


    constructor(options) {
        /**
         * @member {OverlayOperationType} [OverlayAnalystParameters.prototype.operation=OverlayOperationType.UNION]
         * @description æå®å å åææä½ç±»åã
         */
        this.operation = OverlayOperationType.UNION;

        if (options) {
            Util.extend(this, options);
        }
        this.CLASS_NAME = "SuperMap.OverlayAnalystParameters";
    }

    /**
     * @function OverlayAnalystParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.operation = null;
    }


}

;// CONCATENATED MODULE: ./src/common/iServer/DatasetOverlayAnalystParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/






/**
 * @class DatasetOverlayAnalystParameters
 * @deprecatedclass SuperMap.DatasetOverlayAnalystParameters
 * @category  iServer SpatialAnalyst OverlayAnalyst
 * @classdesc æ°æ®éå å åæåæ°ç±»ã
 * @param {Object} options - åæ°ã
 * @param {string} options.operateDataset -æ°æ®éåç§°ã
 * @param {string} options.sourceDataset - æºæ°æ®éåç§°ã
 * @param {Array.<string>} [options.operateDatasetFields] - å å åæä¸­æä½æ°æ®éä¿çå¨ç»ææ°æ®éä¸­çå­æ®µååè¡¨ã
 * @param {FilterParameter} [options.operateDatasetFilter] - è®¾ç½®æä½æ°æ®éä¸­ç©ºé´å¯¹è±¡è¿æ»¤æ¡ä»¶ã
 * @param {Array.<GeometryPolygon|L.Polygon|ol.geom.Polygon|GeoJSONObject>} [options.operateRegions] - æä½é¢å¯¹è±¡éåï¼è¡¨ç¤ºä¸è¿äºé¢å¯¹è±¡è¿è¡å å åæãä¸ operateDataset åæ°äºæ¥ï¼å²çªæ¶ä»¥ operateDataset ä¸ºåã
 * @param {Array.<string>} [options.sourceDatasetFields] - å å åæä¸­æºæ°æ®éä¿çå¨ç»ææ°æ®éä¸­çå­æ®µååè¡¨ã
 * @param {FilterParameter} [options.sourceDatasetFilter] - è®¾ç½®æºæ°æ®éä¸­ç©ºé´å¯¹è±¡è¿æ»¤æ¡ä»¶ã
 * @param {number} [options.tolerance=0] - å®¹éã
 * @param {OverlayOperationType} options.operation - å å æä½æä¸¾å¼ã
 * @param {DataReturnOption} [options.resultSetting] - ç»æè¿åè®¾ç½®ç±»ã
 * @extends {GetFeaturesParametersBase}
 * @usage
 */
class DatasetOverlayAnalystParameters extends OverlayAnalystParameters {


    constructor(options) {
        super(options);
        /**
         * @member {string} DatasetOverlayAnalystParameters.prototype.operateDataset
         * @description å å åæä¸­æä½æ°æ®éçåç§°ã
         */
        this.operateDataset = null;

        /**
         * @member {Array.<string>} [DatasetOverlayAnalystParameters.prototype.operateDatasetFields]
         * @description å å åæä¸­æä½æ°æ®éä¿çå¨ç»ææ°æ®éä¸­çå­æ®µååè¡¨ã
         */
        this.operateDatasetFields = [];

        /**
         * @member {FilterParameter} DatasetOverlayAnalystParameters.prototype.operateDatasetFilter
         * @description è®¾ç½®æä½æ°æ®éä¸­ç©ºé´å¯¹è±¡è¿æ»¤æ¡ä»¶ã
         */
        this.operateDatasetFilter = new FilterParameter();

        /**
         * @member {Array.<GeometryPolygon|L.Polygon|ol.geom.Polygon|GeoJSONObject>} [DatasetOverlayAnalystParameters.prototype.operateRegions]
         * @description æä½é¢å¯¹è±¡éåï¼è¡¨ç¤ºä¸è¿äºé¢å¯¹è±¡è¿è¡å å åæãä¸ operateDataset åæ°äºæ¥ï¼å²çªæ¶ä»¥ operateDataset ä¸ºåã
         */
        this.operateRegions = [];


        /**
         * @member {string} DatasetOverlayAnalystParameters.prototype.sourceDataset
         * @description å å åæä¸­æºæ°æ®éçåç§°ã
         */
        this.sourceDataset = null;


        /**
         * @member {Array.<string>} [DatasetOverlayAnalystParameters.prototype.sourceDatasetFields]
         * @description å å åæä¸­æºæ°æ®éä¿çå¨ç»ææ°æ®éä¸­çå­æ®µååè¡¨ã
         */
        this.sourceDatasetFields = [];


        /**
         * @member {FilterParameter} [DatasetOverlayAnalystParameters.prototype.filterQueryParameter]
         * @description è®¾ç½®æºæ°æ®éä¸­ç©ºé´å¯¹è±¡è¿æ»¤æ¡ä»¶ã
         */
        this.sourceDatasetFilter = new FilterParameter();

        /**
         * @member {number} [DatasetOverlayAnalystParameters.prototype.tolerance=0]
         * @description å®¹éã
         */
        this.tolerance = 0;

        /**
         * @member {DataReturnOption} [DatasetOverlayAnalystParameters.prototype.resultSetting]
         * @description ç»æè¿åè®¾ç½®ç±»ã
         */
        this.resultSetting = new DataReturnOption();

        Util.extend(this, options);

        this.CLASS_NAME = "SuperMap.DatasetOverlayAnalystParameters";
    }


    /**
     * @function DatasetOverlayAnalystParameters.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();

        var me = this;
        me.operateDataset = null;
        me.operateDatasetFields = null;
        if (me.operateDatasetFilter) {
            me.operateDatasetFilter.destroy();
            me.operateDatasetFilter = null;
        }
        if (me.operateRegions) {
            for (var i = 0, opRegions = me.operateRegions, len = opRegions.length; i < len; i++) {
                opRegions[i].destroy();
            }
            me.operateRegions = null;
        }
        me.sourceDataset = null;
        me.sourceDatasetFields = null;
        if (me.sourceDatasetFilter) {
            me.sourceDatasetFilter.destroy();
            me.sourceDatasetFilter = null;
        }
        me.tolerance = null;
        if (me.resultSetting) {
            me.resultSetting.destroy();
            me.resultSetting = null;
        }
    }

    /**
     * @function DatasetOverlayAnalystParameters.toObject
     * @param {DatasetOverlayAnalystParameters} datasetOverlayAnalystParameters - æ°æ®éå å åæåæ°ç±»ã
     * @param {DatasetOverlayAnalystParameters} tempObj - æ°æ®éå å åæåæ°å¯¹è±¡ã
     * @description å°æ°æ®éå å åæåæ°ç±»è½¬æ¢ä¸º JSON å¯¹è±¡ã
     * @returns {Object} JSON å¯¹è±¡ã
     */
    static toObject(datasetOverlayAnalystParameters, tempObj) {
        for (var name in datasetOverlayAnalystParameters) {
            if (name === "sourceDataset") {
                continue;
            } else if (name === "operateRegions") {
                tempObj.operateRegions = [];
                var ors = datasetOverlayAnalystParameters.operateRegions;
                for (var index in ors) {
                    if (ors.hasOwnProperty(index)) {    //icl542
                        tempObj.operateRegions[index] = ServerGeometry.fromGeometry(ors[index]);
                    }
                }
            } else if (name === "resultSetting") {
                tempObj.dataReturnOption = datasetOverlayAnalystParameters.resultSetting;
            } else {
                tempObj[name] = datasetOverlayAnalystParameters[name];
            }
        }
    }


}

;// CONCATENATED MODULE: ./src/common/iServer/SurfaceAnalystParametersSetting.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class SurfaceAnalystParametersSetting
 * @deprecatedclass SuperMap.SurfaceAnalystParametersSetting
 * @category  iServer SpatialAnalyst SurfaceAnalyst
 * @classdesc è¡¨é¢åæåæ°è®¾ç½®ç±»ã
 * éè¿è¯¥ç±»å¯ä»¥è®¾ç½®è¡¨é¢åææåç­å¼çº¿ãæåç­å¼é¢çä¸äºåæ°ï¼åæ¬åºåå¼ãç­å¼è·ãåæ»åº¦ãåæ»æ¹æ³ç­ã
 * @param {Object} options - åæ°ã
 * @param {GeometryPolygon|L.Polygon|ol.geom.Polygon|GeoJSONObject} [options.clipRegion] - è£åªé¢å¯¹è±¡ï¼å¦æä¸éè¦å¯¹æä½ç»æè¿è¡è£åªï¼å¯ä»¥ä½¿ç¨ null å¼åä»£è¯¥åæ°ã
 * @param {number} [options.datumValue=0] - æåç­å¼çº¿ãæåç­å¼é¢çåºåå¼ã
 * @param {Array.<number>} options.expectedZValues - ææåæç»æç Z å¼éåã
 * @param {number} [options.interval=0] - ç­å¼è·ãç­å¼è·æ¯ä¸¤æ¡ç­å¼çº¿ä¹é´çé´éå¼ã
 * @param {number} [options.resampleTolerance=0] - ééæ ·å®¹éã
 * @param {SmoothMethod} [options.smoothMethod=SmoothMethod.BSPLINE] - åæ»å¤çæä½¿ç¨çæ¹æ³ã
 * @param {number} [options.smoothness=0] - ç­å¼çº¿æç­å¼é¢çè¾¹ççº¿çåæ»åº¦ã
 * @usage
 */
class SurfaceAnalystParametersSetting {

    constructor(options) {
        /**
         * @member {GeometryPolygon|L.Polygon|ol.geom.Polygon|GeoJSONObject} [SurfaceAnalystParametersSetting.prototype.clipRegion]
         * @description è·åæè®¾ç½®è£åªé¢å¯¹è±¡ï¼å¦æä¸éè¦å¯¹æä½ç»æè¿è¡è£åªï¼å¯ä»¥ä½¿ç¨ null å¼åä»£è¯¥åæ°ã
         */
        this.clipRegion = null;

        /**
         * @member {number} [SurfaceAnalystParametersSetting.prototype.datumValue=0]
         * @description è·åæè®¾ç½®è¡¨é¢åæä¸­æåç­å¼çº¿ãæåç­å¼é¢çåºåå¼ã
         * åºåå¼æ¯ä½ä¸ºä¸ä¸ªçæç­å¼çº¿çåå§èµ·ç®å¼ï¼å¹¶ä¸ä¸å®æ¯æå°ç­å¼çº¿çå¼ã ä¾å¦ï¼é«ç¨èå´ä¸º 220 -1550 ç DEM æ æ ¼æ°æ®ï¼
         * å¦æè®¾åºåå¼ä¸º 0ï¼ ç­å¼è·ä¸º 50ï¼åæåç­å¼çº¿æ¶ï¼ä»¥åºåå¼ 0 ä¸ºèµ·ç¹ï¼ç­å¼è· 50 ä¸ºé´éæåç­å¼çº¿ï¼
         * å ä¸ºç»å®é«ç¨çæå°å¼æ¯ 220ï¼æä»¥ï¼å¨ç»å®èå´åæåç­å¼çº¿çæå°é«ç¨æ¯ 250ã
         * æåç­å¼çº¿çç»ææ¯ï¼æå°ç­å¼çº¿å¼ä¸º 250ï¼æå¤§ç­å¼çº¿å¼ä¸º 1550ã
         */
        this.datumValue = 0;
        /**
         * @member {Array.<number>} SurfaceAnalystParametersSetting.prototype.expectedZValues
         * @description è·åæè®¾ç½®ææåæç»æç Z å¼éåã
         *              Z å¼éåå­å¨ä¸ç³»åæ°å¼ï¼è¯¥æ°å¼ä¸ºå¾æåç­å¼çº¿çå¼ãå³ä»é«ç¨å¼å¨ Z å¼éåä¸­çç­å¼çº¿ä¼è¢«æåã
         */
        this.expectedZValues = null;

        /**
         *  @member {number} [SurfaceAnalystParametersSetting.prototype.interval=0]
         *  @description è·åæè®¾ç½®ç­å¼è·ãç­å¼è·æ¯ä¸¤æ¡ç­å¼çº¿ä¹é´çé´éå¼ã
         */
        this.interval = 0;

        /**
         * @member {number} [SurfaceAnalystParametersSetting.prototype.resampleTolerance=0]
         * @description è·åæè®¾ç½®ééæ ·å®¹éã
         *              å®¹éå¼è¶å¤§ï¼éæ ·ç»ææ°æ®è¶ç®åãå½åæç»æåºç°äº¤åæ¶ï¼å¯éè¿è°æ´ééæ ·å®¹éä¸ºè¾å°çå¼æ¥å¤çã
         */
        this.resampleTolerance = 0;

        /**
         * @member {SmoothMethod} [SurfaceAnalystParametersSetting.prototype.smoothMethod=SmoothMethod.BSPLINE]
         * @description è·åæè®¾ç½®åæ»å¤çæä½¿ç¨çæ¹æ³ã
         */
        this.smoothMethod = SmoothMethod.BSPLINE;

        /**
         * @member {number} [SurfaceAnalystParametersSetting.prototype.smoothness=0]
         * @description è·åæè®¾ç½®è¡¨é¢åæä¸­ç­å¼çº¿æç­å¼é¢çè¾¹ççº¿çåæ»åº¦ã
         * ä»¥ä¸º 0-5 ä¸ºä¾ï¼åæ»åº¦ä¸º 0 è¡¨ç¤ºä¸è¿è¡åæ»æä½ï¼å¼è¶å¤§è¡¨ç¤ºåæ»åº¦è¶é«ã
         * éçåæ»åº¦çå¢å ï¼æåçç­å¼çº¿è¶åæ».å½ç¶åæ»åº¦è¶å¤§ï¼
         * è®¡ç®æéçæ¶é´åå ç¨çåå­ä¹å°±è¶å¤§ãèä¸ï¼å½ç­å¼è·è¾å°æ¶ï¼
         * åæ»åº¦å¤ªé«ä¼åºç°ç­å¼çº¿ç¸äº¤çé®é¢ã
         */
        this.smoothness = 0;

        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = "SuperMap.SurfaceAnalystParametersSetting";
    }


    /**
     * @function SurfaceAnalystParametersSetting.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        if (me.clipRegion) {
            me.clipRegion.destroy();
            me.clipRegion = null;
        }

        me.datumValue = null;
        me.expectedZValues = null;
        me.interval = null;
        me.resampleTolerance = null;
        me.smoothMethod = null;
        me.smoothness = null;
    }
    /**
     * @function SurfaceAnalystParametersSetting.prototype.toJSON
     * @description å°å¯¹è±¡è½¬åä¸º JSON å­ç¬¦ä¸²ã
     * @returns {string} å¯¹è±¡ JSON å­ç¬¦ä¸²ã
     */
    toJSON() {
        let json = "'datumValue':" + Util.toJSON(this.datumValue);
        json += ",'interval':" + Util.toJSON(this.interval);
        json += ",'resampleTolerance':" + Util.toJSON(this.resampleTolerance);
        json += ",'smoothMethod':" + Util.toJSON(this.smoothMethod);
        json += ",'smoothness':" + Util.toJSON(this.smoothness);
        if (this.expectedZValues != null) {
            json += "," + "'expectedZValues':" + Util.toJSON(this.expectedZValues);
        }
        if (this.clipRegion != null) {
            var serverGeometry = this.clipRegion;
            if (this.clipRegion instanceof Geometry && this.clipRegion.components) {
                serverGeometry = ServerGeometry.fromGeometry(this.clipRegion)
            }
            json += ",'clipRegion':" + Util.toJSON(serverGeometry);
        }
        return "{" + json + "}";
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/SurfaceAnalystParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class SurfaceAnalystParameters
 * @deprecatedclass SuperMap.SurfaceAnalystParameters
 * @category  iServer SpatialAnalyst SurfaceAnalyst
 * @classdesc è¡¨é¢åææåæä½åæ°ç±»ãéè¿è¯¥ç±»å¯ä»¥ä¸ºè¿è¡è¡¨é¢åææä¾åæ°ä¿¡æ¯ï¼åæ¬è¡¨é¢åæçæ¹æ³æåç­å¼çº¿ãæåç­å¼é¢åä¸­é´ç»æçåè¾¨çï¼
 * {@link DatasetSurfaceAnalystParameters} å {@link GeometrySurfaceAnalystParameters} ç»§æ¿èªè¯¥ç±»ã
 * @param {Object} options - åæ°ã
 * @param {SurfaceAnalystParametersSetting} options.extractParameter - è¡¨é¢åæåæ°è®¾ç½®ç±»ã
 * @param {number} options.resolution - æå®ä¸­é´ç»æï¼æ æ ¼æ°æ®éï¼çåè¾¨çã
 * @param {DataReturnOption} options.resultSetting - ç»æè¿åè®¾ç½®ç±»ã
 * @param {SurfaceAnalystMethod} [options.surfaceAnalystMethod=SurfaceAnalystMethod.ISOLINE] - è·åæè®¾ç½®è¡¨é¢åæçæåæ¹æ³ï¼æåç­å¼çº¿åæåç­å¼é¢ã
 * @usage
 */
class SurfaceAnalystParameters {

    constructor(options) {
        /**
         * @member {number} SurfaceAnalystParameters.prototype.resolution
         * @description è·åæè®¾ç½®æå®ä¸­é´ç»æï¼æ æ ¼æ°æ®éï¼çåè¾¨çã
         */
        this.resolution = 0;

        /**
         * @member {SurfaceAnalystParametersSetting} SurfaceAnalystParameters.prototype.extractParameter
         * @description è·åæè®¾ç½®è¡¨é¢åæåæ°ã
         * å¨è¿è¡ç¹æ°æ®éè¿è¡æåç­å¼é¢åææ¶ï¼ææ¶ä¸æ¯æ SurfaceAnalystParametersSetting ç±»ä¸­ç expectedZValues å­æ®µã
         */
        this.extractParameter = new SurfaceAnalystParametersSetting();

        /**
         * @member {DataReturnOption} SurfaceAnalystParameters.prototype.resultSetting
         * @description ç»æè¿åè®¾ç½®ç±»ã
         */
        this.resultSetting = new DataReturnOption();

        /**
         * @member {SurfaceAnalystMethod} [SurfaceAnalystParameters.prototype.surfaceAnalystMethod=SurfaceAnalystMethod.ISOLINE]
         * @description è·åæè®¾ç½®è¡¨é¢åæçæåæ¹æ³ï¼æåç­å¼çº¿åæåç­å¼é¢ã
         */
        this.surfaceAnalystMethod = SurfaceAnalystMethod.ISOLINE;

        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = "SuperMap.SurfaceAnalystParameters";
    }

    /**
     * @function SurfaceAnalystParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.resolution = null;
        if (me.extractParameter) {
            me.extractParameter.destroy();
            me.extractParameter = null;
        }
        if (me.resultSetting) {
            me.resultSetting.destroy();
            me.resultSetting = null;
        }
        me.surfaceAnalystMethod = null;
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/DatasetSurfaceAnalystParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/






/**
 * @class DatasetSurfaceAnalystParameters
 * @deprecatedclass SuperMap.DatasetSurfaceAnalystParameters
 * @category iServer SpatialAnalyst SurfaceAnalyst
 * @classdesc æ°æ®éè¡¨é¢åæåæ°ç±»ãè¯¥ç±»å¯¹æ°æ®éè¡¨é¢åææç¨å°çåæ°è¿è¡è®¾ç½®ã
 * @param {Object} options - åæ°ã
 * @param {string} options.dataset - æ°æ®éåç§°ã
 * @param {string} options.zValueFieldName - å­æ®µåç§°ã
 * @param {number} options.resolution - æå®ä¸­é´ç»æï¼æ æ ¼æ°æ®éï¼çåè¾¨çã
 * @param {SurfaceAnalystParametersSetting} options.extractParameter - è¡¨é¢åæåæ°è®¾ç½®ç±»ãè·åæè®¾ç½®è¡¨é¢åæåæ°ã
 * @param {FilterParameter} [options.filterQueryParameter] - æ¥è¯¢è¿æ»¤æ¡ä»¶åæ°ã
 * @param {DataReturnOption} [options.resultSetting] - ç»æè¿åè®¾ç½®ç±»ã
 * @param {SurfaceAnalystMethod} [options.surfaceAnalystMethod=SurfaceAnalystMethod.ISOLINE] - è¡¨é¢åæçæåæ¹æ³ï¼æåç­å¼çº¿åæåç­å¼é¢ã
 * @extends {SurfaceAnalystParameters}
 * @usage
 */
class DatasetSurfaceAnalystParameters extends SurfaceAnalystParameters {


    constructor(options) {
        super(options);
        /**
         * @member {string} DatasetSurfaceAnalystParameters.prototype.dataset
         * @description è¦ç¨æ¥åæ°æ®éè¡¨é¢åæçæ°æ®æºä¸­æ°æ®éçåç§°ãè¯¥åç§°ç¨å½¢å¦ "æ°æ®éåç§°@æ°æ®æºå«å" å½¢å¼æ¥è¡¨ç¤ºï¼ä¾å¦ï¼Country@Worldã
         */
        this.dataset = null;

        /**
         *  @member {FilterParameter} DatasetSurfaceAnalystParameters.prototype.filterQueryParameter
         *  @description è·åæè®¾ç½®æ¥è¯¢è¿æ»¤æ¡ä»¶åæ°ã
         */
        this.filterQueryParameter = new FilterParameter();

        /**
         * @member {string} DatasetSurfaceAnalystParameters.prototype.zValueFieldName
         * @description è·åæè®¾ç½®ç¨äºæåæä½çå­æ®µåç§°ãæåç­å¼çº¿æ¶ï¼å°ä½¿ç¨è¯¥å­æ®µä¸­çå¼ï¼å¯¹ç¹è®°å½éä¸­çç¹æ°æ®è¿è¡æå¼åæï¼å¾å°æ æ ¼æ°æ®éï¼ä¸­é´ç»æï¼ï¼æ¥çä»æ æ ¼æ°æ®éæåç­å¼çº¿ã
         */
        this.zValueFieldName = null;

        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = "SuperMap.DatasetSurfaceAnalystParameters";
    }

    /**
     * @function DatasetSurfaceAnalystParameters.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
        var me = this;
        me.dataset = null;
        if (me.filterQueryParameter) {
            me.filterQueryParameter.destroy();
            me.filterQueryParameter = null;
        }
        me.zValueFieldName = null;
    }

    /**
     * @function DatasetSurfaceAnalystParameters.toObject
     * @param {DatasetSurfaceAnalystParameters} datasetSurfaceAnalystParameters - æ°æ®éè¡¨é¢åæåæ°ç±»ã
     * @param {DatasetSurfaceAnalystParameters} tempObj - æ°æ®éè¡¨é¢åæåæ°å¯¹è±¡ã
     * @description å°æ°æ®éè¡¨é¢åæåæ°å¯¹è±¡è½¬æ¢ä¸º JSON å¯¹è±¡ã
     * @returns JSON å¯¹è±¡ã
     */
    static toObject(datasetSurfaceAnalystParameters, tempObj) {
        for (var name in datasetSurfaceAnalystParameters) {
            if (name === "filterQueryParameter") {
                tempObj.filterQueryParameter = datasetSurfaceAnalystParameters.filterQueryParameter;
            }
            if (name === "extractParameter") {
                if (datasetSurfaceAnalystParameters.extractParameter.clipRegion instanceof Geometry && datasetSurfaceAnalystParameters.extractParameter.clipRegion.components) {
                    datasetSurfaceAnalystParameters.extractParameter.clipRegion = ServerGeometry.fromGeometry(datasetSurfaceAnalystParameters.extractParameter.clipRegion);
                }
                tempObj.extractParameter = datasetSurfaceAnalystParameters.extractParameter;
            } else if (name === "dataset") {
                continue;
            } else if (name === "surfaceAnalystMethod") {
                continue;
            } else {
                tempObj[name] = datasetSurfaceAnalystParameters[name];
            }
        }
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/ThiessenAnalystParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class ThiessenAnalystParameters
 * @deprecatedclass SuperMap.ThiessenAnalystParameters
 * @category  iServer SpatialAnalyst ThiessenPolygonAnalyst
 * @classdesc æ³°æ£®å¤è¾¹å½¢åæåæ°åºç±»ã
 * @param {Object} options - å¯éåæ°ã
 * @param {GeometryPolygon|L.Polygon|ol.geom.Polygon|GeoJSONObject} [options.clipRegion] - ç»ææ°æ®è£åªåºåï¼å¯ä»¥ä¸º nullï¼è¡¨ç¤ºä¸å¯¹ç»æè¿è¡è£åªã
 * @param {boolean} [options.createResultDataset=false] - æ¯å¦è¿åç»ææ°æ®éã
 * @param {string} [options.resultDatasetName] - æå®ç»ææ°æ®éåç§°ã
 * @param {string} [options.resultDatasourceName] - æå®ç»ææ°æ®éæå¨æ°æ®æºï¼é»è®¤ä¸ºå½åæ°æ®æºã
 * @param {boolean} [options.returnResultRegion=true] - æ¯å¦è¿ååæå¾å°çå¤è¾¹å½¢é¢æ°ç»ã
 * @usage
 */
class ThiessenAnalystParameters {

    constructor(options) {
        if (!options) {
            return;
        }
        /**
         * @member {GeometryPolygon|L.Polygon|ol.geom.Polygon|GeoJSONObject} [ThiessenAnalystParameters.prototype.clipRegion]
         * @description ç»ææ°æ®è£åªåºåï¼å¯ä»¥ä¸º nullï¼è¡¨ç¤ºä¸å¯¹ç»æè¿è¡è£åªã
         */
        this.clipRegion = null;

        /**
         *  @member {boolean} [ThiessenAnalystParameters.prototype.createResultDataset=false]
         *  @description æ¯å¦è¿åç»ææ°æ®éãå¦æä¸º trueï¼åå¿é¡»è®¾ç½®å±æ§ resultDatasetName å resultDatasourceNameã
         */
        this.createResultDataset = false;

        /**
         * @member {string} ThiessenAnalystParameters.prototype.resultDatasetName
         * @description æå®ç»ææ°æ®éåç§°ã
         */
        this.resultDatasetName = null;

        /**
         * @member {string} ThiessenAnalystParameters.prototype.resultDatasourceName
         * @description æå®ç»ææ°æ®éæå¨æ°æ®æºã
         */
        this.resultDatasourceName = null;

        /**
         * @member {boolean} ThiessenAnalystParameters.prototype.returnResultRegion
         * @description æ¯å¦è¿ååæå¾å°çå¤è¾¹å½¢é¢æ°ç»ã
         */
        this.returnResultRegion = true;

        Util.extend(this, options);

        this.CLASS_NAME = "SuperMap.ThiessenAnalystParameters";
    }

    /**
     * @function ThiessenAnalystParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        if (me.clipRegion) {
            me.clipRegion.destroy();
            me.clipRegion = null;
        }
        me.createResultDataset = null;
        me.resultDatasetName = null;
        me.resultDatasourceName = null;
        me.returnResultRegion = null;
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/DatasetThiessenAnalystParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class DatasetThiessenAnalystParameters
 * @deprecatedclass SuperMap.DatasetThiessenAnalystParameters
 * @category iServer SpatialAnalyst ThiessenAnalyst
 * @classdesc æ°æ®éæ³°æ£®å¤è¾¹å½¢åæåæ°ç±»ã
 * @param {Object} options - åæ°ã
 * @param {FilterParameter} [options.filterQueryParameter] - è¿æ»¤åæ°ç±»ï¼å³å¯¹æ°æ®éä¸­çææç¹è¿è¡åæã
 * @extends {ThiessenAnalystParameters}
 * @usage
 */
class DatasetThiessenAnalystParameters extends ThiessenAnalystParameters {


    constructor(options) {
        super(options);
        /**
         * @member {FilterParameter} [DatasetThiessenAnalystParameters.prototype.filterQueryParameter]
         * @description è¿æ»¤æ¡ä»¶ï¼å¯¹å¾åææ°æ®éä¸­çç¹è¿è¡è¿æ»¤ï¼å³å¯¹æ°æ®éä¸­çææç¹è¿è¡åæã
         * @example
         *  var filterQueryParameter = new FilterParameter({
         *   name: "Countries@World",
         *   attributeFilter: "SmID>100"
         *  });
         */
        this.filterQueryParameter = null;

        /**
         * @member {string} DatasetThiessenAnalystParameters.prototype.dataset
         * @description æ°æ®éåç§°å¾åæçæ°æ®éåç§°ï¼è¯·ä½¿ç¨ "datasetName@datasourceName" æ ¼å¼æ¥è¡¨ç¤ºã
         */
        this.dataset = null;

        if (options) {
            Util.extend(this, options);
        }


        this.CLASS_NAME = "SuperMap.DatasetThiessenAnalystParameters";
    }

    /**
     * @function DatasetThiessenAnalystParameters.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
        var me = this;
        if (me.filterQueryParameter) {
            me.filterQueryParameter.destroy();
            me.filterQueryParameter = null;
        }
    }

    /**
     * @function DatasetThiessenAnalystParameters.toObject
     * @param {DatasetThiessenAnalystParameters} datasetThiessenAnalystParameters - æ³°æ£®å¤è¾¹å½¢åææå¡åæ°ç±»ã
     * @param {DatasetThiessenAnalystParameters} tempObj - æ³°æ£®å¤è¾¹å½¢åææå¡åæ°å¯¹è±¡ã
     * @description å°æ³°æ£®å¤è¾¹å½¢åææå¡åæ°å¯¹è±¡è½¬æ¢ä¸º JSON å¯¹è±¡ã
     * @returns JSON å¯¹è±¡ã
     */
    static toObject(datasetThiessenAnalystParameters, tempObj) {
        for (var name in datasetThiessenAnalystParameters) {
            if (name === "clipRegion") {
                tempObj.clipRegion = ServerGeometry.fromGeometry(datasetThiessenAnalystParameters.clipRegion);
            } else {
                tempObj[name] = datasetThiessenAnalystParameters[name];
            }
        }
    }

}


;// CONCATENATED MODULE: ./src/common/iServer/DatasourceService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class DatasourceService
 * @deprecatedclass SuperMap.DatasourceService
 * @category iServer Data Datasource
 * @classdesc æ°æ®æºæ¥è¯¢æå¡ã
 * @param {string} url - æå¡å°åãå¦è®¿é®World Dataæå¡ï¼åªéå°urlè®¾ä¸ºï¼http://localhost:8090/iserver/services/data-world/rest/data å³å¯ã
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - äºä»¶çå¬å¨å¯¹è±¡ãæprocessCompletedå±æ§å¯ä¼ å¥å¤çå®æåçåè°å½æ°ãprocessFailedå±æ§ä¼ å¥å¤çå¤±è´¥åçåè°å½æ°ã
 * @param {DataFormat} [options.format=DataFormat.GEOJSON] - æ¥è¯¢ç»æè¿åæ ¼å¼ï¼ç®åæ¯æ iServerJSON å GeoJSON ä¸¤ç§æ ¼å¼ãåæ°æ ¼å¼ä¸º "ISERVER"ï¼"GEOJSON"ã
 * @param {string} options.datasource - è¦æ¥è¯¢çæ°æ®éæå¨çæ°æ®æºåç§°ã
 * @param {string} options.dataset - è¦æ¥è¯¢çæ°æ®éåç§°ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @extends {CommonServiceBase}
 * @usage
 */

class DatasourceService_DatasourceService extends CommonServiceBase {

    constructor(url, options) {
        super(url, options);
        if (options) {
            Util.extend(this, options);
        }
        this.CLASS_NAME = "SuperMap.DatasourceService";
    }


    /**
     * @function DatasourceService.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
    }


    /**
     * @function DatasourceService.prototype.getDatasourceService
     * @description è·åæå®æ°æ®æºä¿¡æ¯ã
     */
    getDatasourceService(datasourceName) {
        var me = this;
        me.url = Util.urlPathAppend(me.url,`datasources/name/${datasourceName}`);
        me.request({
            method: "GET",
            data: null,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }

    /**
     * @function DatasourceService.prototype.getDatasourcesService
     * @description è·åæææ°æ®æºä¿¡æ¯ã
     */
    getDatasourcesService() {
        var me = this;
        me.url = Util.urlPathAppend(me.url,`datasources`);
        me.request({
            method: "GET",
            data: null,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }
    /**
     * @function DatasourceService.prototype.setDatasourceService
     * @description æ´æ°æ°æ®æºä¿¡æ¯ã
     */
    setDatasourceService(params) {
        if (!params) {
            return;
        }
        var me = this;
        var jsonParamsStr = Util.toJSON(params);
        me.request({
            method: "PUT",
            data: jsonParamsStr,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }
}

;// CONCATENATED MODULE: ./src/common/iServer/DensityKernelAnalystParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class DensityKernelAnalystParameters
 * @deprecatedclass SuperMap.DensityKernelAnalystParameters
 * @category  iServer SpatialAnalyst DensityAnalyst
 * @classdesc æ ¸å¯åº¦åæåæ°ç±»ã
 * @param {Object} options - åæ°ã
 * @param {string} options.dataset - è¦ç¨æ¥åæ ¸å¯åº¦åææ°æ®æºä¸­æ°æ®éçåç§°ãè¯¥åç§°ç¨å½¢å¦ "æ°æ®éåç§°@æ°æ®æºå«å" å½¢å¼æ¥è¡¨ç¤ºï¼ä¾å¦ï¼BaseMap_P@Jingjinã
 * @param {string} options.fieldName - ç¨äºè¿è¡æ ¸å¯åº¦åæçæµéå¼çå­æ®µåç§°ï¼æ ¸å¯åº¦åæä¸æ¯æææ¬ç±»åçå­æ®µã
 * @param {string} options.resultGridName - æå®ç»ææ°æ®éåç§°ã
 * @param {(SuperMap.Bounds|L.Bounds|L.LatLngBounds|ol.extent|mapboxgl.LngLatBounds|GeoJSONObject)} [options.bounds] - æ ¸å¯åº¦åæçèå´ï¼ç¨äºç¡®å®ç»ææ æ ¼æ°æ®éçèå´ãå¦æç¼ºçï¼åé»è®¤ä¸ºåæ°æ®éçèå´ã
 * @param {number} [options.searchRadius] - æ æ ¼é»ååç¨äºè®¡ç®å¯åº¦çæ¥æ¾åå¾ï¼åä½ä¸å½åæ°æ®éç¸åãé»è®¤å¼ä¸ºå½åæ°æ®éçé¿å®½ä¸­çæå¤§å¼é¤30ã
 * @param {number} [options.resultGridDatasetResolution] - å¯åº¦åæç»ææ æ ¼æ°æ®çåè¾¨çï¼åä½ä¸å½åæ°æ®éç¸åãé»è®¤å¼ä¸ºå½åæ°æ®éçé¿å®½ä¸­çæå°å¼é¤500ã
 * @param {string} [options.targetDatasource] - æå®çå­å¨ç»ææ°æ®éçæ°æ®æºï¼é»è®¤ä¸ºå½ååæçæ°æ®éæå¨çæ°æ®æºã
 * @param {boolean} [options.deleteExistResultDataset=false] - å¦æç¨æ·å½åçç»ææ°æ®éåç§°ä¸å·²æçæ°æ®ééåï¼æ¯å¦å é¤å·²æçæ°æ®éã
 * @usage
 */
class DensityKernelAnalystParameters {


    constructor(options) {
        /**
         * @member {string} DensityKernelAnalystParameters.prototype.dataset
         * @description è¦ç¨æ¥åæ ¸å¯åº¦åææ°æ®æºä¸­æ°æ®éçåç§°ã
         * è¯¥åç§°ç¨å½¢å¦ "æ°æ®éåç§°@æ°æ®æºå«å" å½¢å¼æ¥è¡¨ç¤ºï¼ä¾å¦ï¼Railway@Changchunã
         * æ³¨ï¼æ ¸å¯åº¦åææ¯æç¹æ°æ®éåçº¿æ°æ®éã
         */
        this.dataset = null;

        /**
         * @member {(SuperMap.Bounds|L.Bounds|L.LatLngBounds|ol.extent|mapboxgl.LngLatBounds|GeoJSONObject)} [DensityKernelAnalystParameters.prototype.bounds]
         * @description æ ¸å¯åº¦åæçèå´ï¼ç¨äºç¡®å®ç»ææ æ ¼æ°æ®éçèå´ã
         * å¦æç¼ºçï¼åé»è®¤ä¸ºåæ°æ®éçèå´ã
         */
        this.bounds = null;

        /**
         * @member {string} DensityKernelAnalystParameters.prototype.fieldName
         * @description ç¨äºè¿è¡æ ¸å¯åº¦åæçæµéå¼çå­æ®µåç§°ï¼æ ¸å¯åº¦åæä¸æ¯æææ¬ç±»åçå­æ®µã
         */
        this.fieldName = null;

        /**
         * @member {number} [DensityKernelAnalystParameters.prototype.resultGridDatasetResolution]
         * @description å¯åº¦åæç»ææ æ ¼æ°æ®çåè¾¨çï¼åä½ä¸å½åæ°æ®éç¸åãé»è®¤å¼ä¸ºå½åæ°æ®éçé¿å®½ä¸­çæå°å¼é¤500ã
         */
        this.resultGridDatasetResolution = null;

        /**
         * @member {number} [DensityKernelAnalystParameters.prototype.searchRadius]
         * @description æ æ ¼é»ååç¨äºè®¡ç®å¯åº¦çæ¥æ¾åå¾ï¼åä½ä¸å½åæ°æ®éç¸åãé»è®¤å¼ä¸ºå½åæ°æ®éçé¿å®½ä¸­çæå¤§å¼é¤30ã
         */
        this.searchRadius = null;

        /**
         * @member {string} [DensityKernelAnalystParameters.prototype.targetDatasource]
         * @description æå®çå­å¨ç»ææ°æ®éçæ°æ®æºï¼é»è®¤ä¸ºå½ååæçæ°æ®éæå¨çæ°æ®æºã
         */
        this.targetDatasource = null;

        /**
         * @member {string} DensityKernelAnalystParameters.prototype.resultGridName
         * @description æå®ç»ææ°æ®éåç§°ã
         */
        this.resultGridName = null;

        /**
         * @member {boolean} [DensityKernelAnalystParameters.prototype.deleteExistResultDataset=false]
         * @description å¦æç¨æ·å½åçç»ææ°æ®éåç§°ä¸å·²æçæ°æ®ééåï¼æ¯å¦å é¤å·²æçæ°æ®éã
         */
        this.deleteExistResultDataset = false;
        Util.extend(this, options);

        this.CLASS_NAME = "SuperMap.DensityKernelAnalystParameters";

    }


    /**
     * @function DensityKernelAnalystParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.dataset = null;
        me.bounds = null;
        me.fieldName = null;
        me.resultGridDatasetResolution = null;
        me.searchRadius = null;

        me.targetDatasource = null;
        me.resultGridName = null;
        me.deleteExistResultDataset = null;
    }

    /**
     * @function DensityKernelAnalystParameters.toObject
     * @param {DensityKernelAnalystParameters} densityKernelAnalystParameters -æ ¸å¯åº¦åæåæ°ç±»ã
     * @param {DensityKernelAnalystParameters} tempObj - æ ¸å¯åº¦åæåæ°å¯¹è±¡ã
     * @description å°æ ¸å¯åº¦åæåæ°å¯¹è±¡è½¬æ¢æ JSON å¯¹è±¡ã
     * @returns JSON å¯¹è±¡ã
     */
    static toObject(densityKernelAnalystParameters, tempObj) {
        for (var name in densityKernelAnalystParameters) {
            if (name !== "dataset") {
                tempObj[name] = densityKernelAnalystParameters[name];
            }
        }
    }

}


;// CONCATENATED MODULE: ./src/common/iServer/DensityAnalystService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class DensityAnalystService
 * @deprecatedclass SuperMap.DensityAnalystService
 * @category iServer SpatialAnalyst DensityAnalyst
 * @classdesc
 * å¯åº¦åææå¡ç±»ï¼å¯åº¦åæå¯è®¡ç®æ¯ä¸ªè¾åºæ æ ¼ååå¨å´åå½¢é»ååè¾å¥çç¹æçº¿å¯¹è±¡çå¯åº¦ã
 * å¯åº¦åæï¼å¨æç§æä¹ä¸æ¥è¯´ï¼ç¸å½äºå¨è¡¨é¢ä¸å°è¾å¥çç¹çº¿å¯¹è±¡çæµéå¼æ£å¼æ¥ï¼å°æ¯ä¸ªç¹æçº¿å¯¹è±¡çæµééåå¸å¨æ´ä¸ªç ç©¶åºåï¼å¹¶è®¡ç®è¾åºæ æ ¼ä¸­æ¯ä¸ªååçå¯åº¦å¼ãç®åæä¾1ç§å¯åº¦åæï¼æ ¸å¯åº¦åæï¼Kernelï¼ã
 * @param {string} url - æå¡å°åãå¦ http://localhost:8090/iserver/services/spatialanalyst-changchun/restjsr/spatialanalyst ã
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - éè¦è¢«æ³¨åççå¬å¨å¯¹è±¡ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @extends {SpatialAnalystBase}
 * @example  ä¾å¦ï¼
 *  var myDensityAnalystService = new DensityAnalystService(url);
 *  myDensityAnalystService.on({
 *     "processCompleted": processCompleted,
 *     "processFailed": processFailed
 *     }
 *  );
 * @usage
 */
class DensityAnalystService extends SpatialAnalystBase {


    constructor(url, options) {
        super(url, options);
        /**
         * @member {string} DensityAnalystService.prototype.mode
         * @description å¯åº¦åæç±»åã
         */
        this.mode = null;

        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = "SuperMap.DensityAnalystService";
    }

    /**
     * @function DensityAnalystService.prototype.destroy
     * @description éæ¾èµæº,å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        super.destroy();
        this.mode = null;
    }

    /**
     * @function DensityAnalystService.prototype.processAsync
     * @description è´è´£å°å®¢æ·ç«¯çæ¥è¯¢åæ°ä¼ éå°æå¡ç«¯ã
     * @param {DensityKernelAnalystParameters} parameter - æ ¸å¯åº¦åæåæ°ã
     */
    processAsync(parameter) {
        var me = this;
        var parameterObject = new Object();

        if (parameter instanceof DensityKernelAnalystParameters) {
            me.url = Util.urlPathAppend(me.url, 'datasets/' + parameter.dataset + '/densityanalyst/kernel');
            me.mode = "kernel";
        }

        DensityKernelAnalystParameters.toObject(parameter, parameterObject);
        var jsonParameters = Util.toJSON(parameterObject);
        me.url = Util.urlAppend(me.url, 'returnContent=true');

        me.request({
            method: "POST",
            data: jsonParameters,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/EditFeaturesParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class EditFeaturesParameters
 * @deprecatedclass SuperMap.EditFeaturesParameters
 * @category iServer Data Feature
 * @classdesc æ°æ®éæ·»å ãä¿®æ¹ãå é¤åæ°ç±»ã
 * @param {Object} options - åæ°ã
 * @param {Array.<FeatureVector|GeoJSONObject|ol.Feature>} options.features - å½åéè¦åå»ºæèæ¯ä¿®æ¹çè¦ç´ éã
 * @param {boolean} [options.returnContent=false] - æ¯å¦è¿åè¦ç´ åå®¹ãå¦æä¸ºtrueåè¿ååå»ºè¦ç´ ç ID æ°ç»ï¼å¦åè¿å featureResult èµæºç URIã
 * @param {EditType} [options.editType=EditType.ADD] - POST å¨ä½ç±»å (ADDãUPDATEãDELETE)ã
 * @param {Array.<string|number>} [options.IDs] - å é¤è¦ç´ æ¶çè¦ç´ ç ID æ°ç»ã
 * @usage
 */
class EditFeaturesParameters {


    constructor(options) {
        /**
         * @member {string} EditFeaturesParameters.prototype.dataSourceName
         * @description å½åéè¦åå»ºæèæ¯ä¿®æ¹çè¦ç´ çæ°æ®æºã
         */
        this.dataSourceName = null;

        /**
         * @member {string} EditFeaturesParameters.prototype.dataSetName
         * @description å½åéè¦åå»ºæèæ¯ä¿®æ¹çè¦ç´ çæ°æ®éã
         */
        this.dataSetName = null;

        /**
         * @member {Array.<FeatureVector|GeoJSONObject|ol.Feature>} EditFeaturesParameters.prototype.features
         * @description å½åéè¦åå»ºæèæ¯ä¿®æ¹çè¦ç´ éã
         */
        this.features = null;

        /**
         * @member {EditType} [EditFeaturesParameters.prototype.editType=EditType.ADD]
         * @description è¦ç´ éæ´æ°ç±»å (addãupdateãdelete)ã
         */
        this.editType = EditType.ADD;

        /**
         * @member {Array.<string|number>} [EditFeaturesParameters.prototype.IDs]
         * @description æ§è¡å é¤æ¶è¦ç´ é ID éåã
         */
        this.IDs = null;

        /**
         * @member {boolean} [EditFeaturesParameters.prototype.returnContent=false]
         * @description è¦ç´ æ·»å æ¶ï¼isUseBatch ä¸ä¼ æä¼ ä¸º false çæåµä¸ææã
         *              true è¡¨ç¤ºç´æ¥è¿åæ°åå»ºçè¦ç´ ç ID æ°ç»ï¼false è¡¨ç¤ºè¿ååå»ºç featureResult èµæºç URIã
         */
        this.returnContent = false;

        /**
         * @member {boolean} [EditFeaturesParameters.prototype.isUseBatch=false]
         * @description æ¯å¦ä½¿ç¨æ¹éæ·»å è¦ç´ åè½ï¼è¦ç´ æ·»å æ¶ææãæ¹éæ·»å è½å¤æé«è¦ç´ ç¼è¾æçãtrue è¡¨ç¤ºæ¹éæ·»å ï¼false è¡¨ç¤ºä¸ä½¿ç¨æ¹éæ·»å ã
         */
        this.isUseBatch = false;
        Util.extend(this, options);

        this.CLASS_NAME = "SuperMap.EditFeaturesParameters";
    }


    /**
     * @function EditFeaturesParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.dataSourceName = null;
        me.dataSetName = null;
        me.features = null;
        me.editType = null;
        me.IDs = null;
        me.returnContent = null;
    }

    /**
     * @function EditFeaturesParameters.prototype.toJsonParameters
     * @description å° EditFeaturesParameters å¯¹è±¡åæ°è½¬æ¢ä¸º JSON å­ç¬¦ä¸²ã
     * @param {EditFeaturesParameters} params - å°ç©ç¼è¾åæ°ã
     * @returns {string} JSON å­ç¬¦ä¸²ã
     */
    static toJsonParameters(params) {
        var feature,
            len,
            features,
            editType = params.editType;

        if (editType === EditType.DELETE) {
            if (params.IDs === null) {
                return;
            }

            features = {ids: params.IDs};
        } else {
            features = [];
            if (params.features) {
                len = params.features.length;
                for (var i = 0; i < len; i++) {
                    feature = params.features[i];
                    feature.geometry = ServerGeometry.fromGeometry(feature.geometry);
                    features.push(feature);
                }
            }
        }

        return Util.toJSON(features);
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/EditFeaturesService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/






/**
 * @class EditFeaturesService
 * @deprecatedclass SuperMap.EditFeaturesService
 * @category  iServer Data Feature
 * @classdesc æ°æ®æå¡ä¸­æ°æ®éæ·»å ãæ´æ°ãå é¤æå¡ç±»ã
 * @extends {CommonServiceBase}
 * @param {string} url - æå¡ç«¯çæ°æ®æå¡èµæºå°åãè¯·æ±æ°æ®æå¡ä¸­æ°æ®éç¼è¾æå¡ï¼URL åºä¸ºï¼</br>
 * http://{æå¡å¨å°å}:{æå¡ç«¯å£å·}/iserver/services/{æ°æ®æå¡å}/rest/data/datasources/name/{æ°æ®æºå}/datasets/name/{æ°æ®éå} ã</br>
 * ä¾å¦ï¼http://localhost:8090/iserver/services/data-jingjin/rest/data/datasources/name/Jingjin/datasets/name/Landuse_R
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - äºä»¶çå¬å¨å¯¹è±¡ãæprocessCompletedå±æ§å¯ä¼ å¥å¤çå®æåçåè°å½æ°ãprocessFailedå±æ§ä¼ å¥å¤çå¤±è´¥åçåè°å½æ°ã
 * @param {DataFormat} [format] -æ¥è¯¢ç»æè¿åæ ¼å¼ï¼ç®åæ¯æiServerJSON åGeoJSONä¸¤ç§æ ¼å¼ãåæ°æ ¼å¼ä¸º"ISERVER","GEOJSON"ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @example
 * var myService = new EditFeaturesService(url, {eventListeners: {
 *     "processCompleted": editFeatureCompleted,
 *     "processFailed": editFeatureError
 *       }
 * };
 * @usage
 */
class EditFeaturesService extends CommonServiceBase {


    constructor(url, options) {
        super(url, options);
        /**
         * @member {boolean} [EditFeaturesService.prototype.returnContent=false]
         * @descriptionè¦ç´ æ·»å æ¶ï¼isUseBatch ä¸ä¼ æä¼ ä¸º false çæåµä¸ææãtrue è¡¨ç¤ºç´æ¥è¿åæ°åå»ºçè¦ç´ ç ID æ°ç»;false è¡¨ç¤ºè¿ååå»ºç featureResult èµæºç URIã
         */
        this.returnContent = false;

        /**
         * @member {boolean} [EditFeaturesService.prototype.isUseBatch=false]
         * @description æ¯å¦ä½¿ç¨æ¹éæ·»å è¦ç´ åè½ï¼è¦ç´ æ·»å æ¶ææã
         *              æ¹éæ·»å è½å¤æé«è¦ç´ ç¼è¾æçã
         *              true è¡¨ç¤ºæ¹éæ·»å ï¼false è¡¨ç¤ºä¸ä½¿ç¨æ¹éæ·»å ã
         */
        this.isUseBatch = false;

        if (options) {
            Util.extend(this, options);
        }
        this.url = Util.urlPathAppend(this.url, 'features');

        this.CLASS_NAME = "SuperMap.EditFeaturesService";
    }


    /**
     * @function EditFeaturesService.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
        var me = this;
        me.returnContent = null;
        me.isUseBatch = null;
        me.fromIndex = null;
        me.toIndex = null;
    }


    /**
     * @function EditFeaturesService.prototype.processAsync
     * @description è´è´£å°å®¢æ·ç«¯çæ´æ°åæ°ä¼ éå°æå¡ç«¯ã
     * @param {EditFeaturesParameters} params - ç¼è¾è¦ç´ åæ°ã
     */
    processAsync(params) {
        if (!(params instanceof EditFeaturesParameters)) {
            return;
        }
        var me = this,
            method = "POST",
            ids = "",
            editType = params.editType,
            jsonParameters = null;

        me.returnContent = params.returnContent;
        me.isUseBatch = params.isUseBatch;
        jsonParameters = EditFeaturesParameters.toJsonParameters(params);
        if (editType === EditType.DELETE) {
            ids = Util.toJSON(params.IDs);
            jsonParameters = ids;
            var urlWithIds = Util.urlAppend(me.url, Util.getParameterString({ids}))
            if(FetchRequest.urlIsLong(urlWithIds)) {
                me.url = Util.urlAppend(me.url, Util.getParameterString({_method: 'DELETE'}));
                method = "POST";
            } else{
                me.url = urlWithIds;
                method = "DELETE";
            }
           
        } else if (editType === EditType.UPDATE) {
            method = "PUT";
        } else {
            if (me.isUseBatch) {
                me.url = Util.urlAppend(me.url, `isUseBatch=${me.isUseBatch}`);
                me.returnContent = false;
            }
            if (me.returnContent) {
                me.url = Util.urlAppend(me.url, 'returnContent=true');
                method = "POST";
            }
        }

        me.request({
            method: method,
            data: jsonParameters,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/FacilityAnalyst3DParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class FacilityAnalyst3DParameters
 * @deprecatedclass SuperMap.FacilityAnalyst3DParameters
 * @category  iServer FacilityAnalyst3D
 * @classdesc æè¿è®¾æ½åæåæ°åºç±»ãæè¿è®¾æ½åææ¯æå¨ç½ç»ä¸ç»å®ä¸ä¸ªäºä»¶ç¹åä¸ç»è®¾æ½ç¹ï¼æ¥æ¾ä»äºä»¶ç¹å°è®¾æ½ç¹ï¼æä»è®¾æ½ç¹å°äºä»¶ç¹ï¼ä»¥æå°èè´¹è½å°è¾¾çæä½³è·¯å¾ã
 * è®¾æ½ç¹ä¸è¬ä¸ºå­¦æ ¡ãè¶å¸ãå æ²¹ç«ç­æå¡è®¾æ½ï¼äºä»¶ç¹ä¸ºéè¦æå¡è®¾æ½çäºä»¶ä½ç½®ãä¾å¦äºä»¶åçç¹æ¯ä¸èµ·äº¤éäºæï¼è¦æ±æ¥æ¾å¨ 10 åéåè½å°è¾¾çæè¿å»é¢ï¼
 * è¶è¿ 10 åéè½å°è¾¾çé½ä¸äºèèãæ­¤ä¾ä¸­ï¼äºæåçå°å³æ¯ä¸ä¸ªäºä»¶ç¹ï¼å¨è¾¹çå»é¢åæ¯è®¾æ½ç¹ãæè¿è®¾æ½æ¥æ¾å®éä¸ä¹æ¯ä¸ç§è·¯å¾åæï¼å æ­¤å¯¹è·¯å¾åæèµ·
 * ä½ç¨çéç¢è¾¹ãéç¢ç¹ãè½¬åè¡¨ãèè´¹ç­å±æ§å¨æè¿è®¾æ½åææ¶åæ ·å¯è®¾ç½®ã
 * @param {Object} options - åæ°ã
 * @param {string} options.weightName - æå®çæå¼å­æ®µä¿¡æ¯å¯¹è±¡çåç§°ã
 * @param {number} [options.edgeID] - æå®çå¼§æ®µ IDï¼edgeID ä¸ nodeID å¿é¡»æå®ä¸ä¸ªã
 * @param {number} [options.nodeID] - æå®çç»ç¹ IDï¼edgeID ä¸ nodeID å¿é¡»æå®ä¸ä¸ªã
 * @param {boolean} [options.isUncertainDirectionValid=false] - æå®ä¸ç¡®å®æµåæ¯å¦ææãæå®ä¸º trueï¼è¡¨ç¤ºä¸ç¡®å®æµåææï¼éå°ä¸ç¡®å®æµåæ¶åæç»§ç»­è¿è¡ï¼
 *                                                      æå®ä¸º falseï¼è¡¨ç¤ºä¸ç¡®å®æµåæ æï¼éå°ä¸ç¡®å®æµåå°åæ­¢å¨è¯¥æ¹åä¸ç»§ç»­æ¥æ¾ã
 * @usage
 */
class FacilityAnalyst3DParameters {


    constructor(options) {
        /**
         * @member {number} [FacilityAnalyst3DParameters.prototype.edgeID]
         * @description æå®çå¼§æ®µ IDï¼edgeID ä¸ nodeID å¿é¡»æå®ä¸ä¸ªã
         */
        this.edgeID = null;

        /**
         * @member {number} [FacilityAnalyst3DParameters.prototype.nodeID]
         * @description æå®çç»ç¹ IDï¼edgeID ä¸ nodeID å¿é¡»æå®ä¸ä¸ªã
         */
        this.nodeID = null;

        /**
         * @member {string} FacilityAnalyst3DParameters.prototype.weightName
         * @description æå®çæå¼å­æ®µä¿¡æ¯å¯¹è±¡çåç§°ã
         */
        this.weightName = null;

        /**
         * @member {boolean} [FacilityAnalyst3DParameters.prototype.isUncertainDirectionValid=false]
         * @description æå®ä¸ç¡®å®æµåæ¯å¦ææãæå®ä¸º trueï¼è¡¨ç¤ºä¸ç¡®å®æµåææï¼éå°ä¸ç¡®å®æµåæ¶åæç»§ç»­è¿è¡ï¼
         *              æå®ä¸º falseï¼è¡¨ç¤ºä¸ç¡®å®æµåæ æï¼éå°ä¸ç¡®å®æµåå°åæ­¢å¨è¯¥æ¹åä¸ç»§ç»­æ¥æ¾
         */
        this.isUncertainDirectionValid = false;
        Util.extend(this, options);
        this.CLASS_NAME = "SuperMap.FacilityAnalyst3DParameters";

    }

    /**
     * @function FacilityAnalyst3DParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.edgeID = null;
        me.nodeID = null;
        me.weightName = null;
        me.isUncertainDirectionValid = null;
    }
}

;// CONCATENATED MODULE: ./src/common/iServer/FacilityAnalystSinks3DParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class FacilityAnalystSinks3DParameters
 * @deprecatedclass SuperMap.FacilityAnalystSinks3DParameters
 * @category  iServer FacilityAnalyst3D Sinks
 * @classdesc æè¿è®¾æ½åæåæ°ç±»(æ±æ¥æ¾èµæº)ãæè¿è®¾æ½åææ¯æå¨ç½ç»ä¸ç»å®ä¸ä¸ªäºä»¶ç¹åä¸ç»è®¾æ½ç¹ï¼æ¥æ¾ä»äºä»¶ç¹å°è®¾æ½ç¹(æä»è®¾æ½ç¹å°äºä»¶ç¹)ä»¥æå°èè´¹è½å°è¾¾çæä½³è·¯å¾ã
 *            è®¾æ½ç¹ä¸è¬ä¸ºå­¦æ ¡ãè¶å¸ãå æ²¹ç«ç­æå¡è®¾æ½ï¼äºä»¶ç¹ä¸ºéè¦æå¡è®¾æ½çäºä»¶ä½ç½®ãä¾å¦äºä»¶åçç¹æ¯ä¸èµ·äº¤éäºæï¼è¦æ±æ¥æ¾å¨10åéåè½å°è¾¾çæè¿å»é¢ï¼è¶è¿10åé
 *            è½å°è¾¾çé½ä¸äºèèãæ­¤ä¾ä¸­ï¼äºæåçå°å³æ¯ä¸ä¸ªäºä»¶ç¹ï¼å¨è¾¹çå»é¢åæ¯è®¾æ½ç¹ãæè¿è®¾æ½æ¥æ¾å®éä¸ä¹æ¯ä¸ç§è·¯å¾åæï¼å æ­¤å¯¹è·¯å¾åæèµ·ä½ç¨çéç¢è¾¹ãéç¢ç¹ã
 *            è½¬åè¡¨ãèè´¹ç­å±æ§å¨æè¿è®¾æ½åææ¶åæ ·å¯è®¾ç½®ã
 * @extends {FacilityAnalyst3DParameters}
 * @param {Object} options - åæ°ã
 * @param {string} options.weightName - æå®çæå¼å­æ®µä¿¡æ¯å¯¹è±¡çåç§°ã
 * @param {number} [options.edgeID] - æå®çå¼§æ®µ IDï¼edgeID ä¸ nodeID å¿é¡»æå®ä¸ä¸ªã
 * @param {number} [options.nodeID] - æå®çç»ç¹ IDï¼edgeID ä¸ nodeID å¿é¡»æå®ä¸ä¸ªã
 * @param {boolean} [options.isUncertainDirectionValid=false] - æå®ä¸ç¡®å®æµåæ¯å¦ææãæå®ä¸º trueï¼è¡¨ç¤ºä¸ç¡®å®æµåææï¼éå°ä¸ç¡®å®æµåæ¶åæç»§ç»­è¿è¡ï¼
 * æå®ä¸º falseï¼è¡¨ç¤ºä¸ç¡®å®æµåæ æï¼éå°ä¸ç¡®å®æµåå°åæ­¢å¨è¯¥æ¹åä¸ç»§ç»­æ¥æ¾ã
 * @usage
 */
class FacilityAnalystSinks3DParameters extends FacilityAnalyst3DParameters {

    constructor(options) {
        super(options);
        this.CLASS_NAME = "SuperMap.FacilityAnalystSinks3DParameters";
    }


    /**
     * @function FacilityAnalystSinks3DParameters.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
    }


}

;// CONCATENATED MODULE: ./src/common/iServer/FacilityAnalystSinks3DService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class FacilityAnalystSinks3DService
 * @deprecatedclass SuperMap.FacilityAnalystSinks3DService
 * @category iServer FacilityAnalyst3D Sinks
 * @classdesc  æè¿è®¾æ½åææå¡ç±»(æ±æ¥æ¾èµæº)<br>
 *             æè¿è®¾æ½åææ¯æå¨ç½ç»ä¸ç»å®ä¸ä¸ªäºä»¶ç¹åä¸ç»è®¾æ½ç¹ï¼
 *             æ¥æ¾ä»äºä»¶ç¹å°è®¾æ½ç¹(æä»è®¾æ½ç¹å°äºä»¶ç¹)ä»¥æå°èè´¹è½å°è¾¾çæä½³è·¯å¾ã
 *             è¯¥ç±»è´è´£å°å®¢æ·ç«¯æå®çæè¿è®¾æ½åæåæ°ä¼ éç»æå¡ç«¯ï¼å¹¶æ¥æ¶æå¡ç«¯è¿åçç»ææ°æ®ã
 *             æè¿è®¾æ½åæç»æéè¿è¯¥ç±»æ¯æçäºä»¶ççå¬å½æ°åæ°è·å
 * @extends {CommonServiceBase}
 * @example
 * var myFacilityAnalystSinks3DService = new FacilityAnalystSinks3DService(url, {
 *     eventListeners: {
 *	       "processCompleted": facilityAnalystSinks3DCompleted,
 *		   "processFailed": facilityAnalystSinks3DError
 *		   }
 * });
 * @param {string} url - ç½ç»åææå¡å°åãè¯·æ±ç½ç»åææå¡ï¼URLåºä¸ºï¼<br>
 *                       http://{æå¡å¨å°å}:{æå¡ç«¯å£å·}/iserver/services/{ç½ç»åææå¡å}/rest/networkanalyst/{ç½ç»æ°æ®é@æ°æ®æº}ï¼<br>
 *                       ä¾å¦:"http://localhost:8090/iserver/services/components-rest/rest/networkanalyst/RoadNet@Changchun"ã<br>
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - éè¦è¢«æ³¨åççå¬å¨å¯¹è±¡ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class FacilityAnalystSinks3DService extends CommonServiceBase {

    constructor(url, options) {
        super(url, options);
        this.CLASS_NAME = "SuperMap.FacilityAnalystSinks3DService";
    }


    /**
     * @function FacilityAnalystSinks3DService.prototype.destroy
     * @override
     */
    destroy() {
        CommonServiceBase.prototype.destroy.apply(this, arguments);
    }


    /**
     * @function FacilityAnalystSinks3DService.prototype.processAsync
     * @description è´è´£å°å®¢æ·ç«¯çæ¥è¯¢åæ°ä¼ éå°æå¡ç«¯ã
     * @param {FacilityAnalystSinks3DParameters} params - æè¿è®¾æ½åæåæ°ç±»(æ±æ¥æ¾èµæº)
     */
    processAsync(params) {
        if (!(params instanceof FacilityAnalystSinks3DParameters)) {
            return;
        }
        var me = this, jsonObject;
        me.url = Util.urlPathAppend(me.url, 'sinks');
        jsonObject = {
            edgeID: params.edgeID,
            nodeID: params.nodeID,
            weightName: params.weightName,
            isUncertainDirectionValid: params.isUncertainDirectionValid
        };
        me.request({
            method: "GET",
            params: jsonObject,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/FacilityAnalystSources3DParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class FacilityAnalystSources3DParameters
 * @deprecatedclass SuperMap.FacilityAnalystSources3DParameters
 * @category  iServer FacilityAnalyst3D Sources
 * @classdesc æè¿è®¾æ½åæåæ°ç±»(æºæ¥æ¾èµæº)ãæè¿è®¾æ½åææ¯æå¨ç½ç»ä¸ç»å®ä¸ä¸ªäºä»¶ç¹åä¸ç»è®¾æ½ç¹ï¼æ¥æ¾ä»äºä»¶ç¹å°è®¾æ½ç¹(æä»è®¾æ½ç¹å°äºä»¶ç¹)ä»¥æå°èè´¹è½å°è¾¾çæä½³è·¯å¾ã
 *            è®¾æ½ç¹ä¸è¬ä¸ºå­¦æ ¡ãè¶å¸ãå æ²¹ç«ç­æå¡è®¾æ½ï¼äºä»¶ç¹ä¸ºéè¦æå¡è®¾æ½çäºä»¶ä½ç½®ãä¾å¦äºä»¶åçç¹æ¯ä¸èµ·äº¤éäºæï¼è¦æ±æ¥æ¾å¨10åéåè½å°è¾¾çæè¿å»é¢ï¼è¶è¿10å
 *            éè½å°è¾¾çé½ä¸äºèèãæ­¤ä¾ä¸­ï¼äºæåçå°å³æ¯ä¸ä¸ªäºä»¶ç¹ï¼å¨è¾¹çå»é¢åæ¯è®¾æ½ç¹ãæè¿è®¾æ½æ¥æ¾å®éä¸ä¹æ¯ä¸ç§è·¯å¾åæï¼å æ­¤å¯¹è·¯å¾åæèµ·ä½ç¨çéç¢è¾¹ãéç¢
 *            ç¹ãè½¬åè¡¨ãèè´¹ç­å±æ§å¨æè¿è®¾æ½åææ¶åæ ·å¯è®¾ç½®ã
 * @extends {FacilityAnalyst3DParameters}
 * @param {Object} options - åæ°ã
 * @param {string} options.weightName - æå®çæå¼å­æ®µä¿¡æ¯å¯¹è±¡çåç§°ã
 * @param {number} [options.edgeID] - æå®çå¼§æ®µ IDï¼edgeID ä¸ nodeID å¿é¡»æå®ä¸ä¸ªã
 * @param {number} [options.nodeID] - æå®çç»ç¹ IDï¼edgeID ä¸ nodeID å¿é¡»æå®ä¸ä¸ªã
 * @param {boolean} [options.isUncertainDirectionValid=false] - æå®ä¸ç¡®å®æµåæ¯å¦ææãæå®ä¸º trueï¼è¡¨ç¤ºä¸ç¡®å®æµåææï¼éå°ä¸ç¡®å®æµåæ¶åæç»§ç»­è¿è¡ï¼
 * æå®ä¸º falseï¼è¡¨ç¤ºä¸ç¡®å®æµåæ æï¼éå°ä¸ç¡®å®æµåå°åæ­¢å¨è¯¥æ¹åä¸ç»§ç»­æ¥æ¾ã
 * @usage
 */
class FacilityAnalystSources3DParameters extends FacilityAnalyst3DParameters {


    constructor(options) {
        super(options);
        this.CLASS_NAME = "SuperMap.FacilityAnalystSources3DParameters";
    }

    /**
     * @function FacilityAnalystSources3DParameters.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
    }


}

;// CONCATENATED MODULE: ./src/common/iServer/FacilityAnalystSources3DService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class FacilityAnalystSources3DService
 * @deprecatedclass SuperMap.FacilityAnalystSources3DService
 * @category  iServer FacilityAnalyst3D Sources
 * @classdesc æè¿è®¾æ½åææå¡ç±»(æºæ¥æ¾èµæº)
 *            æè¿è®¾æ½åææ¯æå¨ç½ç»ä¸ç»å®ä¸ä¸ªäºä»¶ç¹åä¸ç»è®¾æ½ç¹ï¼
 *            æ¥æ¾ä»äºä»¶ç¹å°è®¾æ½ç¹(æä»è®¾æ½ç¹å°äºä»¶ç¹)ä»¥æå°èè´¹è½å°è¾¾çæä½³è·¯å¾ã
 *            è¯¥ç±»è´è´£å°å®¢æ·ç«¯æå®çæè¿è®¾æ½åæåæ°ä¼ éç»æå¡ç«¯ï¼å¹¶æ¥æ¶æå¡ç«¯è¿åçç»ææ°æ®ã
 *            æè¿è®¾æ½åæç»æéè¿è¯¥ç±»æ¯æçäºä»¶ççå¬å½æ°åæ°è·åã
 * @extends {CommonServiceBase}
 * @param {string} url - æå¡å°åãè¯·æ±ç½ç»åææå¡ï¼URLåºä¸ºï¼
 *                       http://{æå¡å¨å°å}:{æå¡ç«¯å£å·}/iserver/services/{ç½ç»åææå¡å}/rest/networkanalyst/{ç½ç»æ°æ®é@æ°æ®æº}ï¼
 *                       ä¾å¦:"http://localhost:8090/iserver/services/components-rest/rest/networkanalyst/RoadNet@Changchun"ã
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - éè¦è¢«æ³¨åççå¬å¨å¯¹è±¡ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class FacilityAnalystSources3DService extends CommonServiceBase {

    constructor(url, options) {
        super(url, options);

        this.CLASS_NAME = "SuperMap.FacilityAnalystSources3DService";
    }


    /**
     * @function FacilityAnalystSources3DService.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
    }


    /**
     * @function FacilityAnalystSources3DService.prototype.processAsync
     * @description è´è´£å°å®¢æ·ç«¯çæ¥è¯¢åæ°ä¼ éå°æå¡ç«¯ã
     * @param {FacilityAnalystSources3DParameters} params - æè¿è®¾æ½åæåæ°ç±»ï¼æºæ¥æ¾èµæºï¼
     */
    processAsync(params) {
        if (!(params instanceof FacilityAnalystSources3DParameters)) {
            return;
        }
        var me = this, jsonObject;
        me.url = Util.urlPathAppend(me.url, 'sources');
        jsonObject = {
            edgeID: params.edgeID,
            nodeID: params.nodeID,
            weightName: params.weightName,
            isUncertainDirectionValid: params.isUncertainDirectionValid
        };
        me.request({
            method: "GET",
            params: jsonObject,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/FacilityAnalystStreamParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class FacilityAnalystStreamParameters
 * @deprecatedclass SuperMap.FacilityAnalystStreamParameters
 * @category iServer NetworkAnalyst UpstreamCirticalFaclilities
 * @classdesc ä¸æ¸¸/ä¸æ¸¸å³é®è®¾æ½æ¥æ¾èµæºåæ°ç±»ã
 * @param {Object} options - åæ°ã
 * @param {Array.<number>} options.sourceNodeIDs - æå®çè®¾æ½ç¹ ID æ°ç»ã
 * @param {number} options.queryType - åæç±»åï¼åªè½æ¯ 0 (ä¸æ¸¸å³é®è®¾æ½æ¥è¯¢) æèæ¯ 1ï¼ä¸æ¸¸å³é®è®¾æ½æ¥è¯¢ï¼ã
 * @param {number} [options.edgeID] - æå®çå¼§æ®µ IDï¼edgeID ä¸ nodeID å¿é¡»æå®ä¸ä¸ªã
 * @param {number} [options.nodeID] - æå®çç»ç¹ IDï¼edgeID ä¸ nodeID å¿é¡»æå®ä¸ä¸ªã
 * @param {boolean} [options.isUncertainDirectionValid=false] - æå®ä¸ç¡®å®æµåæ¯å¦ææã
 * @usage
 */
class FacilityAnalystStreamParameters {


    constructor(options) {
        /**
         * @member {Array.<number>} [FacilityAnalystStreamParameters.prototype.sourceNodeIDs]
         * @description æå®çè®¾æ½ç¹ ID æ°ç»ã
         */
        this.sourceNodeIDs = null;

        /**
         * @member {number} [FacilityAnalystStreamParameters.prototype.edgeID]
         * @description æå®çå¼§æ®µ IDï¼edgeID ä¸ nodeID å¿é¡»æå®ä¸ä¸ªã
         */
        this.edgeID = null;

        /**
         * @member {number} [FacilityAnalystStreamParameters.prototype.nodeID]
         * @description æå®çç»ç¹ IDï¼edgeID ä¸ nodeID å¿é¡»æå®ä¸ä¸ªã
         */
        this.nodeID = null;

        /**
         * @member {boolean} [FacilityAnalystStreamParameters.prototype.isUncertainDirectionValid=false]
         * @description æå®ä¸ç¡®å®æµåæ¯å¦ææãæå®ä¸º trueï¼è¡¨ç¤ºä¸ç¡®å®æµåææï¼éå°ä¸ç¡®å®æµåæ¶åæç»§ç»­è¿è¡ï¼
         *              æå®ä¸º falseï¼è¡¨ç¤ºä¸ç¡®å®æµåæ æï¼éå°ä¸ç¡®å®æµåå°åæ­¢å¨è¯¥æ¹åä¸ç»§ç»­æ¥æ¾ã
         */
        this.isUncertainDirectionValid = false;

        /**
         * @member {number} FacilityAnalystStreamParameters.prototype.queryType
         * @description åæç±»åï¼åªè½æ¯ 0 (ä¸æ¸¸å³é®è®¾æ½æ¥è¯¢) æèæ¯ 1ï¼ä¸æ¸¸å³é®è®¾æ½æ¥è¯¢ï¼ã
         */
        this.queryType = null;
        Util.extend(this, options);
        this.CLASS_NAME = "SuperMap.FacilityAnalystStreamParameters";
    }


    /**
     * @function FacilityAnalystStreamParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.edgeID = null;
        me.nodeID = null;
        me.weightName = null;
        me.isUncertainDirectionValid = null;
        me.type = null;
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/FacilityAnalystStreamService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class FacilityAnalystStreamService
 * @deprecatedclass SuperMap.FacilityAnalystStreamService
 * @category iServer NetworkAnalyst UpstreamCirticalFaclilities
 * @classdesc ä¸æ¸¸/ä¸æ¸¸ å³é®è®¾æ½æ¥æ¾èµæºæå¡ç±»ï¼å³æ¥æ¾ç»å®å¼§æ®µæèç¹çä¸æ¸¸/ä¸æ¸¸ä¸­çå³é®è®¾æ½ç»ç¹ï¼è¿åå³é®ç»ç¹ ID æ°ç»åå¶ä¸æ¸¸å¼§æ®µ ID æ°ç»ã
 * @extends NetworkAnalystServiceBase
 * @param {string} url - æå¡å°åãè¯·æ±ç½ç»åææå¡ï¼URLåºä¸ºï¼
 *                       http://{æå¡å¨å°å}:{æå¡ç«¯å£å·}/iserver/services/{ç½ç»åææå¡å}/rest/networkanalyst/{ç½ç»æ°æ®é@æ°æ®æº}ï¼
 *                       ä¾å¦: "http://localhost:8090/iserver/services/test/rest/networkanalyst/WaterNet@FacilityNet";
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - éè¦è¢«æ³¨åççå¬å¨å¯¹è±¡ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class FacilityAnalystStreamService extends NetworkAnalystServiceBase {

    constructor(url, options) {
        super(url, options);
        this.CLASS_NAME = "SuperMap.FacilityAnalystStreamService";
    }


    /**
     * @function FacilityAnalystStreamService.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
    }


    /**
     * @function FacilityAnalystStreamService.prototype.processAsync
     * @description è´è´£å°å®¢æ·ç«¯çæ¥è¯¢åæ°ä¼ éå°æå¡ç«¯ã
     * @param {FacilityAnalystStreamParameters} params - ä¸æ¸¸/ä¸æ¸¸å³é®è®¾æ½æ¥æ¾èµæºåæ°ç±»ã
     */
    processAsync(params) {
        if (!(params instanceof FacilityAnalystStreamParameters)) {
            return;
        }
        var me = this,
            jsonObject;
        //URL éè¿åæ°ç±»åæ¥å¤æ­æ¯ ä¸æ¸¸ è¿æ¯ä¸æ¸¸ æ¥è¯¢
        if (params.queryType === 0) {
            me.url = Util.urlPathAppend(me.url, 'upstreamcirticalfaclilities');
        } else if (params.queryType === 1) {
            me.url = Util.urlPathAppend(me.url, 'downstreamcirticalfaclilities');
        } else {
            return;
        }

        jsonObject = {
            sourceNodeIDs: params.sourceNodeIDs,
            isUncertainDirectionValid: params.isUncertainDirectionValid
        };

        if (params.edgeID !== null && params.nodeID !== null) {
            return;
        }
        if (params.edgeID === null && params.nodeID === null) {
            return;
        }
        if (params.edgeID !== null) {
            jsonObject.edgeID = params.edgeID;
        } else {
            jsonObject.nodeID = params.nodeID;
        }

        me.request({
            method: "GET",
            params: jsonObject,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/FacilityAnalystTracedown3DParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class FacilityAnalystTracedown3DParameters
 * @deprecatedclass SuperMap.FacilityAnalystTracedown3DParameters
 * @category iServer FacilityAnalyst3D TraceDownResult
 * @classdesc ä¸æ¸¸è¿½è¸ªèµæºåæ°ç±»ã
 * @extends {FacilityAnalyst3DParameters}
 * @param {Object} options - åæ°ã
 * @param {string} options.weightName - æå®çæå¼å­æ®µä¿¡æ¯å¯¹è±¡çåç§°ã
 * @param {number} [options.edgeID] - æå®çå¼§æ®µ IDï¼edgeID ä¸ nodeID å¿é¡»æå®ä¸ä¸ªã
 * @param {number} [options.nodeID] - æå®çç»ç¹ IDï¼edgeID ä¸ nodeID å¿é¡»æå®ä¸ä¸ªã
 * @param {boolean} [options.isUncertainDirectionValid=false] - æå®ä¸ç¡®å®æµåæ¯å¦ææãæå®ä¸º trueï¼è¡¨ç¤ºä¸ç¡®å®æµåææï¼éå°ä¸ç¡®å®æµåæ¶åæç»§ç»­è¿è¡ï¼
 * æå®ä¸º falseï¼è¡¨ç¤ºä¸ç¡®å®æµåæ æï¼éå°ä¸ç¡®å®æµåå°åæ­¢å¨è¯¥æ¹åä¸ç»§ç»­æ¥æ¾ã
 * @usage
 */
class FacilityAnalystTracedown3DParameters extends FacilityAnalyst3DParameters {

    constructor(options) {
        super(options);
        this.CLASS_NAME = "SuperMap.FacilityAnalystTracedown3DParameters";
    }

    /**
     * @function FacilityAnalystTracedown3DParameters.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
    }


}

;// CONCATENATED MODULE: ./src/common/iServer/FacilityAnalystTracedown3DService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class FacilityAnalystTracedown3DService
 * @deprecatedclass SuperMap.FacilityAnalystTracedown3DService
 * @category iServer FacilityAnalyst3D TraceDownResult
 * @classdesc ä¸æ¸¸è¿½è¸ªèµæºæå¡ç±»
 * @extends {CommonServiceBase}
 * @param {string} url - æå¡å°åãè¯·æ±ç½ç»åææå¡ï¼URLåºä¸ºï¼
 *                       http://{æå¡å¨å°å}:{æå¡ç«¯å£å·}/iserver/services/{ç½ç»åææå¡å}/rest/networkanalyst/{ç½ç»æ°æ®é@æ°æ®æº}ï¼
 *                       ä¾å¦:"http://localhost:8090/iserver/services/components-rest/rest/networkanalyst/RoadNet@Changchun"ã
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - éè¦è¢«æ³¨åççå¬å¨å¯¹è±¡ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class FacilityAnalystTracedown3DService extends CommonServiceBase {

    constructor(url, options) {
        super(url, options);
        this.CLASS_NAME = "SuperMap.FacilityAnalystTracedown3DService";
    }

    /**
     * @function FacilityAnalystTracedown3DService.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function FacilityAnalystTracedown3DService.prototype.processAsync
     * @description è´è´£å°å®¢æ·ç«¯çæ¥è¯¢åæ°ä¼ éå°æå¡ç«¯ã
     * @param {FacilityAnalystTracedown3DParameters} params - ä¸æ¸¸è¿½è¸ªèµæºåæ°ç±»ã
     */
    processAsync(params) {
        if (!(params instanceof FacilityAnalystTracedown3DParameters)) {
            return;
        }
        var me = this, jsonObject;
        me.url = Util.urlPathAppend(me.url, 'tracedownresult');

        jsonObject = {
            edgeID: params.edgeID,
            nodeID: params.nodeID,
            weightName: params.weightName,
            isUncertainDirectionValid: params.isUncertainDirectionValid
        };
        me.request({
            method: "GET",
            params: jsonObject,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }


}

;// CONCATENATED MODULE: ./src/common/iServer/FacilityAnalystTraceup3DParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class FacilityAnalystTraceup3DParameters
 * @deprecatedclass SuperMap.FacilityAnalystTraceup3DParameters
 * @category iServer FacilityAnalyst3D TraceUpResult
 * @classdesc ä¸æ¸¸è¿½è¸ªèµæºåæ°ç±»ã
 * @extends {FacilityAnalyst3DParameters}
 * @param {Object} options - åæ°ã
 * @param {string} options.weightName - æå®çæå¼å­æ®µä¿¡æ¯å¯¹è±¡çåç§°ã
 * @param {number} [options.edgeID] - æå®çå¼§æ®µIDï¼edgeID ä¸ nodeID å¿é¡»æå®ä¸ä¸ªã
 * @param {number} [options.nodeID] - æå®çç»ç¹IDï¼edgeID ä¸ nodeID å¿é¡»æå®ä¸ä¸ªã
 * @param {boolean} [options.isUncertainDirectionValid=false] - æå®ä¸ç¡®å®æµåæ¯å¦ææãæå®ä¸º trueï¼è¡¨ç¤ºä¸ç¡®å®æµåææï¼éå°ä¸ç¡®å®æµåæ¶åæç»§ç»­è¿è¡ï¼
 * æå®ä¸º falseï¼è¡¨ç¤ºä¸ç¡®å®æµåæ æï¼éå°ä¸ç¡®å®æµåå°åæ­¢å¨è¯¥æ¹åä¸ç»§ç»­æ¥æ¾ã
 * @usage
 */
class FacilityAnalystTraceup3DParameters extends FacilityAnalyst3DParameters {

    constructor(options) {
        super(options);
        this.CLASS_NAME = "SuperMap.FacilityAnalystTraceup3DParameters";
    }

    /**
     * @function FacilityAnalystTraceup3DParameters.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
    }


}

;// CONCATENATED MODULE: ./src/common/iServer/FacilityAnalystTraceup3DService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class FacilityAnalystTraceup3DService
 * @deprecatedclass SuperMap.FacilityAnalystTraceup3DService
 * @category iServer FacilityAnalyst3D TraceUpResult
 * @classdesc ä¸æ¸¸è¿½è¸ªèµæºæå¡ç±»
 * @extends {CommonServiceBase}
 * @param {string} url - æå¡å°åãè¯·æ±ç½ç»åææå¡ï¼URLåºä¸ºï¼
 *                       http://{æå¡å¨å°å}:{æå¡ç«¯å£å·}/iserver/services/{ç½ç»åææå¡å}/rest/networkanalyst/{ç½ç»æ°æ®é@æ°æ®æº}ï¼
 *                       ä¾å¦:"http://localhost:8090/iserver/services/components-rest/rest/networkanalyst/RoadNet@Changchun"ã
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - éè¦è¢«æ³¨åççå¬å¨å¯¹è±¡ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class FacilityAnalystTraceup3DService extends CommonServiceBase {
    constructor(url, options) {
        super(url, options);
        this.CLASS_NAME = "SuperMap.FacilityAnalystTraceup3DService";
    }

    /**
     * @function FacilityAnalystTraceup3DService.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function FacilityAnalystTraceup3DService.prototype.processAsync
     * @description è´è´£å°å®¢æ·ç«¯çæ¥è¯¢åæ°ä¼ éå°æå¡ç«¯ã
     * @param {FacilityAnalystTraceup3DParameters} params - ä¸æ¸¸è¿½è¸ªèµæºåæ°ç±»
     */
    processAsync(params) {
        if (!(params instanceof FacilityAnalystTraceup3DParameters)) {
            return;
        }
        var me = this, jsonObject;
        me.url = Util.urlPathAppend(me.url, 'traceupresult');
        jsonObject = {
            edgeID: params.edgeID,
            nodeID: params.nodeID,
            weightName: params.weightName,
            isUncertainDirectionValid: params.isUncertainDirectionValid
        };
        me.request({
            method: "GET",
            params: jsonObject,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/FacilityAnalystUpstream3DParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class FacilityAnalystUpstream3DParameters
 * @deprecatedclass SuperMap.FacilityAnalystUpstream3DParameters
 * @category iServer FacilityAnalyst3D UpstreamCirticalFaclilities
 * @classdesc ä¸æ¸¸å³é®è®¾æ½æ¥æ¾èµæºåæ°ç±»ã
 * @extends {FacilityAnalyst3DParameters}
 * @param {Object} options - åæ°ã
 * @param {Array.<number>} options.sourceNodeIDs - æå®çè®¾æ½ç¹ ID æ°ç»ã
 * @param {number} [options.edgeID] - æå®çå¼§æ®µIDãedgeID ä¸ nodeID å¿é¡»æå®ä¸ä¸ªã
 * @param {number} [options.nodeID] - æå®çç»ç¹IDãedgeID ä¸ edgeID å¿é¡»æå®ä¸ä¸ªã
 * @param {boolean} [options.isUncertainDirectionValid=false] - æå®ä¸ç¡®å®æµåæ¯å¦ææãæå®ä¸º trueï¼è¡¨ç¤ºä¸ç¡®å®æµåææï¼éå°ä¸ç¡®å®æµåæ¶åæç»§ç»­è¿è¡ï¼
 * æå®ä¸º falseï¼è¡¨ç¤ºä¸ç¡®å®æµåæ æï¼éå°ä¸ç¡®å®æµåå°åæ­¢å¨è¯¥æ¹åä¸ç»§ç»­æ¥æ¾ã
 * @usage
 */
class FacilityAnalystUpstream3DParameters extends FacilityAnalyst3DParameters {


    constructor(options) {
        super(options);
        options = options || {};
        this.sourceNodeIDs = null;
        Util.extend(this, options);
        this.CLASS_NAME = "SuperMap.FacilityAnalystUpstream3DParameters";
    }


    /**
     * @function FacilityAnalystUpstream3DParameters.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
        this.sourceNodeIDs = null;
    }


}

;// CONCATENATED MODULE: ./src/common/iServer/FacilityAnalystUpstream3DService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class FacilityAnalystUpstream3DService
 * @deprecatedclass SuperMap.FacilityAnalystUpstream3DService
 * @category  iServer FacilityAnalyst3D UpstreamCirticalFaclilities
 * @classdesc ä¸æ¸¸å³é®è®¾æ½æ¥æ¾èµæºæå¡ç±»
 * @extends {CommonServiceBase}
 * @param {string} url - æå¡å°åãè¯·æ±ç½ç»åææå¡ï¼URLåºä¸ºï¼
 *                       http://{æå¡å¨å°å}:{æå¡ç«¯å£å·}/iserver/services/{ç½ç»åææå¡å}/rest/networkanalyst/{ç½ç»æ°æ®é@æ°æ®æº}ï¼
 *                       ä¾å¦:"http://localhost:8090/iserver/services/components-rest/rest/networkanalyst/RoadNet@Changchun"ã
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - éè¦è¢«æ³¨åççå¬å¨å¯¹è±¡ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class FacilityAnalystUpstream3DService extends CommonServiceBase {

    constructor(url, options) {
        super(url, options);
        this.CLASS_NAME = "SuperMap.FacilityAnalystUpstream3DService";
    }

    /**
     * @function FacilityAnalystUpstream3DService.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function FacilityAnalystUpstream3DService.prototype.processAsync
     * @description è´è´£å°å®¢æ·ç«¯çæ¥è¯¢åæ°ä¼ éå°æå¡ç«¯ã
     * @param {FacilityAnalystUpstream3DParameters} params - ä¸æ¸¸å³é®è®¾æ½æ¥æ¾èµæºåæ°ç±»
     */
    processAsync(params) {
        if (!(params instanceof FacilityAnalystUpstream3DParameters)) {
            return;
        }
        var me = this, jsonObject;
        me.url = Util.urlPathAppend(me.url, 'upstreamcirticalfaclilities');
        jsonObject = {
            sourceNodeIDs: params.sourceNodeIDs,
            edgeID: params.edgeID,
            nodeID: params.nodeID,
            isUncertainDirectionValid: params.isUncertainDirectionValid
        };
        me.request({
            method: "GET",
            params: jsonObject,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }
}


;// CONCATENATED MODULE: ./src/common/iServer/FieldParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class FieldParameters
 * @deprecatedclass SuperMap.FieldParameters
 * @category iServer Data Field
 * @classdesc å­æ®µä¿¡æ¯æ¥è¯¢åæ°ç±»ã
 * @param {Object} options - åæ°ã
 * @param {string} options.datasource - æ°æ®æºåç§°ã
 * @param {string} options.dataset - æ°æ®éåç§°ã
 * @usage
 */
class FieldParameters {


    constructor(options) {
        /**
         * @member {string} FieldParameters.prototype.datasource
         * @description è¦æ¥è¯¢çæ°æ®éæå¨çæ°æ®æºåç§°ã
         */
        this.datasource = null;

        /**
         *  @member {string} FieldParameters.prototype.dataset
         *  @description è¦æ¥è¯¢çæ°æ®éåç§°ã
         */
        this.dataset = null;

        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = "SuperMap.FieldParameters";
    }

    /**
     * @function FieldParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.datasource = null;
        me.dataset = null;
    }

}


;// CONCATENATED MODULE: ./src/common/iServer/FieldStatisticsParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class FieldStatisticsParameters
 * @deprecatedclass SuperMap.FieldStatisticsParameters
 * @category iServer Data Field
 * @classdesc å­æ®µç»è®¡ä¿¡æ¯æ¥è¯¢åæ°ç±»ã
 * @param {Object} options - åæ°ã
 * @param {string} options.datasource - æ°æ®æºåç§°ã
 * @param {string} options.dataset - æ°æ®éåç§°ã
 * @param {string} options.fieldName - å­æ®µåã
 * @param {(string.<StatisticMode>|Array.<string.<StatisticMode>>)} statisticMode - å­æ®µç»è®¡æ¹æ³ç±»åã
 * @extends {FieldParameters}
 * @usage
 */
class FieldStatisticsParameters extends FieldParameters {


    constructor(options) {
        super(options);
        /**
         * @member {string} FieldStatisticsParameters.prototype.fieldName
         * @description å­æ®µå
         */
        this.fieldName = null;

        /**
         * @member {(string.<StatisticMode>|Array.<string.<StatisticMode>>)} FieldStatisticsParameters.prototype.statisticMode
         * @description å­æ®µç»è®¡æ¹æ³ç±»å
         */
        this.statisticMode = null;

        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = "SuperMap.FieldStatisticsParameters";
    }

    /**
     * @function FieldStatisticsParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.fieldName = null;
        me.statisticMode = null;
    }

}


;// CONCATENATED MODULE: ./src/common/iServer/FieldStatisticService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class FieldStatisticService
 * @deprecatedclass SuperMap.FieldStatisticService
 * @category iServer Data Field
 * @classdesc å­æ®µæ¥è¯¢ç»è®¡æå¡ç±»ãç¨æ¥å®æå¯¹æå®æ°æ®éæå®å­æ®µçæ¥è¯¢ç»è®¡åæï¼å³æ±å¹³åå¼ï¼æå¤§å¼ç­ã
 * @extends {CommonServiceBase}
 * @param {string} url - æå¡å°åãå¦è®¿é® World Map æå¡ï¼åªéå° url è®¾ä¸ºï¼http://localhost:8090/iserver/services/data-world/rest/data å³å¯ã
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - äºä»¶çå¬å¨å¯¹è±¡ãæ processCompleted å±æ§å¯ä¼ å¥å¤çå®æåçåè°å½æ°ãprocessFailed å±æ§ä¼ å¥å¤çå¤±è´¥åçåè°å½æ°ã
 * @param {DataFormat} [options.format] - æ¥è¯¢ç»æè¿åæ ¼å¼ï¼ç®åæ¯æ iServerJSON åGeoJSON ä¸¤ç§æ ¼å¼ãåæ°æ ¼å¼ä¸º "ISERVER","GEOJSON"ã
 * @param {string} options.datasource - æ°æ®éæå¨çæ°æ®æºåç§°ã
 * @param {string} options.dataset - æ°æ®éåç§°ã
 * @param {string} options.field - æ¥è¯¢ç»è®¡çç®æ å­æ®µåç§°ã
 * @param {StatisticMode} options.statisticMode - å­æ®µæ¥è¯¢ç»è®¡çæ¹æ³ç±»åã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @example
 * var myService = new FieldStatisticService(url, {eventListeners: {
 *     "processCompleted": fieldStatisticCompleted,
 *     "processFailed": fieldStatisticError
 *     }ï¼
 *     datasource: "World",
 *     dataset: "Countries",
 *     field: "SmID",
 *     statisticMode: StatisticMode.AVERAGE
 * };
 * @usage
 */


class FieldStatisticService extends CommonServiceBase {


    constructor(url, options) {
        super(url, options);
        /**
         * @member {string} FieldStatisticService.prototype.datasource
         * @description æ°æ®éæå¨çæ°æ®æºåç§°ã
         */
        this.datasource = null;


        /**
         * @member {string} FieldStatisticService.prototype.dataset
         * @description æ°æ®éåç§°ã
         */
        this.dataset = null;

        /**
         * @member {string} FieldStatisticService.prototype.field
         * @description æ¥è¯¢ç»è®¡çç®æ å­æ®µåç§°ã
         */
        this.field = null;

        /**
         * @member {StatisticMode} FieldStatisticService.prototype.statisticMode
         * @description å­æ®µæ¥è¯¢ç»è®¡çæ¹æ³ç±»åã
         */
        this.statisticMode = null;
        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = "SuperMap.FieldStatisticService";
    }


    /**
     * @function FieldStatisticService.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
        var me = this;
        me.datasource = null;
        me.dataset = null;
        me.field = null;
        me.statisticMode = null;
    }


    /**
     * @function FieldStatisticService.prototype.processAsync
     * @description æ§è¡æå¡ï¼è¿è¡æå®å­æ®µçæ¥è¯¢ç»è®¡ã
     */
    processAsync() {
        var me = this,
            fieldStatisticURL = "datasources/" + me.datasource + "/datasets/" + me.dataset + "/fields/" + me.field + "/" + me.statisticMode;
        me.url = Util.urlPathAppend(me.url, fieldStatisticURL);

        me.request({
            method: "GET",
            data: null,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/FindClosestFacilitiesParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class FindClosestFacilitiesParameters
 * @deprecatedclass SuperMap.FindClosestFacilitiesParameters
 * @category iServer NetworkAnalyst ClosestFacility
 * @classdesc æè¿è®¾æ½åæåæ°ç±»ã
 * @param {Object} options - åæ°ã
 * @param {GeometryPoint|L.LatLng|L.Point|ol.geom.Point|mapboxgl.LngLat|mapboxgl.Point|Array.<number>} options.event - äºä»¶ç¹ï¼ä¸è¬ä¸ºéè¦è·å¾æå¡è®¾æ½æå¡çäºä»¶ä½ç½®ã
 * @param {Array.<GeometryPoint|L.LatLng|L.Point|ol.geom.Point|mapboxgl.LngLat|mapboxgl.Point|Array.<number>>}  options.facilities - è®¾æ½ç¹éåï¼ä¸è¬ä¸ºæä¾æå¡çæå¡è®¾æ½ä½ç½®ã
 * @param {number} [options.expectFacilityCount=1] - è¦æ¥æ¾çè®¾æ½ç¹æ°éã
 * @param {boolean} [options.fromEvent=false] - æ¯å¦ä»äºä»¶ç¹å°è®¾æ½ç¹è¿è¡æ¥æ¾ã
 * @param {boolean} [options.isAnalyzeById=false] - äºä»¶ç¹åè®¾æ½ç¹æ¯å¦éè¿èç¹ ID å·æ¥æå®ã
 * @param {number} [options.maxWeight=0] - æ¥æ¾åå¾ãåä½ä¸è¯¥ç±»ä¸­ parameter å­æ®µï¼äº¤éç½ç»åæéç¨åæ°ï¼ä¸­è®¾ç½®çèè´¹å­æ®µä¸è´ã
 * @param {TransportationAnalystParameter} [options.parameter] - äº¤éç½ç»åæéç¨åæ°ã
 * @usage
 */
class FindClosestFacilitiesParameters {


    constructor(options) {
        /**
         * @member {GeometryPoint|L.LatLng|L.Point|ol.geom.Point|mapboxgl.LngLat|mapboxgl.Point|Array.<number>} FindClosestFacilitiesParameters.prototype.event
         * @description äºä»¶ç¹ï¼ä¸è¬ä¸ºéè¦è·å¾æå¡è®¾æ½æå¡çäºä»¶ä½ç½®ã
         *              å¯ä»¥éè¿ä¸¤ç§æ¹å¼èµäºäºä»¶ç¹ï¼å½è¯¥ç±»ä¸­å­æ®µ isAnalyzeById = true æ¶ï¼åºè¾å¥äºä»¶ç¹ ID å·ï¼å½ isAnalyzeById = false æ¶ï¼åºè¾å¥äºä»¶ç¹åæ ã
         */
        this.event = null;

        /**
         * @member {number} [FindClosestFacilitiesParameters.prototype.expectFacilityCount=1]
         * @description è¦æ¥æ¾çè®¾æ½ç¹æ°éã
         */
        this.expectFacilityCount = 1;

        /**
         * @member {Array.<GeometryPoint|L.LatLng|L.Point|ol.geom.Point|mapboxgl.LngLat|mapboxgl.Point|Array.<number>>} [FindClosestFacilitiesParameters.prototype.facilities=false]
         * @description è®¾æ½ç¹éåï¼ä¸è¬ä¸ºæä¾æå¡çæå¡è®¾æ½ä½ç½®ã
         *              å¯ä»¥éè¿ä¸¤ç§æ¹å¼èµäºè®¾æ½ç¹ï¼å½è¯¥ç±»ä¸­å­æ®µ isAnalyzeById = true æ¶ï¼åºè¾å¥è®¾æ½ç¹ ID å·ï¼å½ isAnalyzeById = false æ¶ï¼åºè¾å¥è®¾æ½ç¹åæ ã
         */
        this.facilities = null;

        /**
         * @member {boolean} [FindClosestFacilitiesParameters.prototype.fromEvent=false]
         * @description æ¯å¦ä»äºä»¶ç¹å°è®¾æ½ç¹è¿è¡æ¥æ¾ãæè¿è®¾æ½åæä¸»è¦æ¯éè¿è®¾æ½ç¹åäºä»¶ç¹ä¹é´æä¼çè·¯çº¿æ¥åæå¨ä¸å®èå´ååªä¸ªæåªäºè®¾æ½ä¸äºä»¶ç¹ææä¼è·¯çº¿çå³ç³»ã
         *              è¿ä¸ªè¡èµ°çº¿è·¯æ¯éè¿ç½ç»å¾å±è¿è¡ç½ç»åæç®æ³è®¡ç®åºæ¥çä¸¤ç¹é´çæä¼è·¯çº¿ãç±äºå­å¨ä» A ç¹å° B ç¹ä¸ä» B ç¹å° A ç¹çèè´¹ä¸ä¸æ ·çæåµï¼å æ­¤èµ·æ­¢ç¹
         *              ä¸åå¯è½ä¼å¾å°ä¸åçæä¼è·¯çº¿ãå æ­¤å¨è¿è¡æè¿è®¾æ½åæä¹åï¼éè¦è®¾ç½®è·åçæä¼è·¯çº¿çæ¹åï¼å³æ¯ä»¥äºä»¶ç¹ä½ä¸ºèµ·ç¹å°æè¿è®¾æ½ç¹çæ¹ååæï¼è¿æ¯ä»¥æ
         *              è¿è®¾æ½ç¹ä¸ºèµ·ç¹å°äºä»¶ç¹çæ¹ååæãå¦æéè¦ä»¥äºä»¶ç¹ä½ä¸ºèµ·ç¹å°è®¾æ½ç¹æ¹åè¿è¡æ¥æ¾ï¼è®¾ç½®è¯¥å­æ®µå¼ä¸º trueï¼è®¾ç½®ä¸º falseï¼è¡¨ç¤ºä»è®¾æ½ç¹å°äºä»¶ç¹è¿è¡æ¥æ¾ã
         */
        this.fromEvent = false;

        /**
         * @member {boolean} [FindClosestFacilitiesParameters.prototype.isAnalyzeById=false]
         * @description äºä»¶ç¹åè®¾æ½ç¹æ¯å¦éè¿èç¹ ID å·æ¥æå®ï¼è®¾ç½®ä¸º falseï¼è¡¨ç¤ºéè¿åæ ç¹æå®äºä»¶ç¹åè®¾æ½ç¹ã
         */
        this.isAnalyzeById = false;

        /**
         * @member {number} [FindClosestFacilitiesParameters.prototype.maxWeight=0]
         * @description æ¥æ¾åå¾ãåä½ä¸è¯¥ç±»ä¸­ parameter å­æ®µï¼äº¤éç½ç»åæéç¨åæ°ï¼ä¸­è®¾ç½®çèè´¹å­æ®µä¸è´ã
         *              ä¾å¦äºä»¶åçç¹æ¯ä¸èµ·äº¤éäºæï¼è¦æ±æ¥æ¾å¨ 10 åéåè½å°è¾¾çæè¿å»é¢ï¼è¶è¿ 10 åéè½å°è¾¾çé½ä¸äºèèã
         *              é£ä¹éè¦å°ç½ç»åæåæ°ä¸­ parameter.weightFieldName è®¾ç½®ä¸ºè¡¨ç¤ºæ¶é´çå­æ®µï¼ç¶åè®¾ç½®æ¥æ¾èå´çåå¾å¼ä¸º10ã
         */
        this.maxWeight = 0;

        /**
         * @member {TransportationAnalystParameter} [FindClosestFacilitiesParameters.prototype.parameter]
         * @description äº¤éç½ç»åæéç¨åæ°ãéè¿æ¬ç±»å¯ä»¥è®¾ç½®éç¢è¾¹ãéç¢ç¹ãæå¼å­æ®µä¿¡æ¯çåç§°æ è¯ãè½¬åæå¼å­æ®µç­ä¿¡æ¯ã
         *              å®ä¸º TransportationAnalystParameter ç±»åï¼è½ç¶ä¸ºå¯éåæ°ï¼ä½æ¯å¦æä¸è®¾ç½®å¶ä¸­ç resultSetting å­æ®µï¼
         *              åè¿åç»æç©ºé´ä¿¡æ¯ç­é½ä¸ºç©ºã
         */
        this.parameter = new TransportationAnalystParameter();
        Util.extend(this, options);

        this.CLASS_NAME = "SuperMap.FindClosestFacilitiesParameters";
    }

    /**
     * @function FindClosestFacilitiesParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.event = null;
        me.expectFacilityCount = null;
        me.facilities = null;
        me.fromEvent = null;
        me.isAnalyzeById = null;
        me.maxWeight = null;
        if (me.parameter) {
            me.parameter.destroy();
            me.parameter = null;
        }
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/FindClosestFacilitiesService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class FindClosestFacilitiesService
 * @deprecatedclass SuperMap.FindClosestFacilitiesService
 * @category  iServer NetworkAnalyst ClosestFacility
 * @classdesc æè¿è®¾æ½åææå¡ç±»ã
 *            æè¿è®¾æ½åææ¯æå¨ç½ç»ä¸ç»å®ä¸ä¸ªäºä»¶ç¹åä¸ç»è®¾æ½ç¹ï¼
 *            æ¥æ¾ä»äºä»¶ç¹å°è®¾æ½ç¹(æä»è®¾æ½ç¹å°äºä»¶ç¹)ä»¥æå°èè´¹è½å°è¾¾çæä½³è·¯å¾ã
 *            è¯¥ç±»è´è´£å°å®¢æ·ç«¯æå®çæè¿è®¾æ½åæåæ°ä¼ éç»æå¡ç«¯ï¼å¹¶æ¥æ¶æå¡ç«¯è¿åçç»ææ°æ®ã
 *            æè¿è®¾æ½åæç»æéè¿è¯¥ç±»æ¯æçäºä»¶ççå¬å½æ°åæ°è·å
 * @extends {NetworkAnalystServiceBase}
 * @example
 * var myfindClosestFacilitiesService = new FindClosestFacilitiesService(url, {
 *     eventListeners: {
 *	       "processCompleted": findClosestFacilitiesCompleted,
 *		   "processFailed": findClosestFacilitiesError
 *		   }
 * });
 * @param {string} url - æå¡å°åãè¯·æ±ç½ç»åææå¡ï¼URLåºä¸ºï¼
 *                       http://{æå¡å¨å°å}:{æå¡ç«¯å£å·}/iserver/services/{ç½ç»åææå¡å}/rest/networkanalyst/{ç½ç»æ°æ®é@æ°æ®æº}ï¼
 *                       ä¾å¦:"http://localhost:8090/iserver/services/components-rest/rest/networkanalyst/RoadNet@Changchun"ã
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - éè¦è¢«æ³¨åççå¬å¨å¯¹è±¡ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class FindClosestFacilitiesService extends NetworkAnalystServiceBase {
    constructor(url, options) {
        super(url, options);

        this.CLASS_NAME = "SuperMap.FindClosestFacilitiesService";
    }

    /**
     * @function FindClosestFacilitiesService.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function FindClosestFacilitiesService.prototype.processAsync
     * @description è´è´£å°å®¢æ·ç«¯çæ¥è¯¢åæ°ä¼ éå°æå¡ç«¯ã
     * @param {FindClosestFacilitiesParameters} params - æè¿è®¾æ½åææå¡åæ°ç±»
     */
    processAsync(params) {
        if (!(params instanceof FindClosestFacilitiesParameters)) {
            return;
        }
        var me = this,
            jsonObject;
        me.url = Util.urlPathAppend(me.url, 'closestfacility');
        jsonObject = {
            expectFacilityCount: params.expectFacilityCount,
            fromEvent: params.fromEvent,
            maxWeight: params.maxWeight,
            parameter: Util.toJSON(params.parameter),
            event: Util.toJSON(params.event),
            facilities: me.getJson(params.isAnalyzeById, params.facilities)
        };
        me.request({
            method: "GET",
            params: jsonObject,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }

    /**
     * @function FindClosestFacilitiesService.prototype.getJson
     * @description å°å¯¹è±¡è½¬åä¸ºJSONå­ç¬¦ä¸²ã
     * @param {boolean} isAnalyzeById - æ¯å¦éè¿IDæ¥åæ
     * @param {Array.<Object>} params - åæåæ°æ°ç»
     * @returns {Object} è½¬ååçJSONå­ç¬¦ä¸²ã
     */
    getJson(isAnalyzeById, params) {
        var jsonString = "[",
            len = params ? params.length : 0;

        if (isAnalyzeById === false) {
            for (let i = 0; i < len; i++) {
                if (i > 0) {
                    jsonString += ",";
                }
                jsonString += '{"x":' + params[i].x + ',"y":' + params[i].y + '}';
            }
        } else if (isAnalyzeById === true) {
            for (let i = 0; i < len; i++) {
                if (i > 0) {
                    jsonString += ",";
                }
                jsonString += params[i];
            }
        }
        jsonString += ']';
        return jsonString;
    }

    /**
     * @function FindClosestFacilitiesService.prototype.toGeoJSONResult
     * @description å°å«æ geometry çæ°æ®è½¬æ¢ä¸º GeoJSON æ ¼å¼ã
     * @param {Object} result - æå¡å¨è¿åçç»æå¯¹è±¡ã
     */
    toGeoJSONResult(result) {
        if (!result || !result.facilityPathList) {
            return result;
        }

        var geoJSONFormat = new GeoJSON();
        result.facilityPathList.map(function (path) {
            if (path.route) {
                path.route = geoJSONFormat.toGeoJSON(path.route);
            }
            if (path.pathGuideItems) {
                path.pathGuideItems = geoJSONFormat.toGeoJSON(path.pathGuideItems);

            }
            if (path.edgeFeatures) {
                path.edgeFeatures = geoJSONFormat.toGeoJSON(path.edgeFeatures);
            }
            if (path.nodeFeatures) {
                path.nodeFeatures = geoJSONFormat.toGeoJSON(path.nodeFeatures);
            }
            return path;
        });
        return result;
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/FindLocationParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class FindLocationParameters
 * @deprecatedclass SuperMap.FindLocationParameters
 * @category iServer NetworkAnalyst Location
 * @classdesc éåååºåæåæ°ç±»ã
 * @param {Object} options - åæ°ã
 * @param {string} options.turnWeightField - è½¬åæå¼å­æ®µçåç§°ã
 * @param {string} options.weightName - é»åå­æ®µçåç§°ï¼æ è¯äºè¿è¡ç½ç»åææ¶æä½¿ç¨çé»åå­æ®µã
 * @param {Array.<SupplyCenter>} options.supplyCenters - èµæºä¾ç»ä¸­å¿éåã
 * @param {number} [options.expectedSupplyCenterCount=1] - ææç¨äºæç»è®¾æ½éåçèµæºä¾ç»ä¸­å¿æ°éã
 * @param {boolean} [options.isFromCenter=false] - æ¯å¦ä»ä¸­å¿ç¹å¼å§åéèµæºã
 * @usage
 */
class FindLocationParameters {


    constructor(options) {
        /**
         * @member {number} [FindLocationParameters.prototype.expectedSupplyCenterCount=1]
         * @description ææç¨äºæç»è®¾æ½éåçèµæºä¾ç»ä¸­å¿æ°éã
         *              å½è¾å¥å¼ä¸º 0 æ¶ï¼æç»è®¾æ½éåçèµæºä¾ç»ä¸­å¿æ°éé»è®¤ä¸ºè¦çåæåºååçæéæå°çä¾ç»ä¸­å¿æ°ã
         */
        this.expectedSupplyCenterCount = null;

        /**
         * @member {boolean} [FindLocationParameters.prototype.isFromCenter=false]
         * @description æ¯å¦ä»ä¸­å¿ç¹å¼å§åéèµæºã
         *              ç±äºç½è·¯æ°æ®ä¸­çå¼§æ®µå·ææ­£åé»åï¼å³å¼§æ®µçæ­£åé»åå¼ä¸å¶ååé»åå¼å¯è½ä¸åï¼
         *              å æ­¤ï¼å¨è¿è¡åææ¶ï¼ä»èµæºä¾ç»ä¸­å¿å¼å§åéèµæºå°éæ±ç¹ä¸ä»éæ±ç¹åèµæºä¾ç»ä¸­å¿åéè¿ä¸¤ç§åéå½¢å¼ä¸ï¼æå¾çåæç»æä¼ä¸åã
         */
        this.isFromCenter = false;


        /**
         * @member {Array.<SupplyCenter>} FindLocationParameters.prototype.supplyCenters
         * @description èµæºä¾ç»ä¸­å¿éåã
         *              èµæºä¾ç»ä¸­å¿æ¯æä¾èµæºåæå¡çè®¾æ½ï¼å¯¹åºäºç½ç»ç»ç¹ï¼
         *              èµæºä¾ç»ä¸­å¿çç¸å³ä¿¡æ¯åæ¬èµæºéãæå¤§é»åå¼ãèµæºä¾ç»ä¸­å¿ç±»åï¼èµæºä¾ç»ä¸­å¿å¨ç½ç»ä¸­æå¤ç»ç¹ç ID ç­ï¼ä»¥ä¾¿å¨è¿è¡éåååºåææ¶ä½¿ç¨ã
         */
        this.supplyCenters = null;

        /**
         * @member {string} FindLocationParameters.prototype.turnWeightField
         * @description è½¬åæå¼å­æ®µçåç§°ã
         */
        this.turnWeightField = null;

        /**
         * @member {string} FindLocationParameters.prototype.weightName
         * @description é»åå­æ®µçåç§°ï¼æ è¯äºè¿è¡ç½ç»åææ¶æä½¿ç¨çé»åå­æ®µã
         */
        this.weightName = null;
        Util.extend(this, options);
        this.CLASS_NAME = "SuperMap.FindLocationParameters";
    }

    /**
     * @function FindLocationParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.expectedSupplyCenterCount = null;
        me.isFromCenter = null;
        me.turnWeightField = null;
        me.weightName = null;
        if (me.supplyCenters) {
            for (var i = 0, supplyCenters = me.supplyCenters, len = supplyCenters.length; i < len; i++) {
                supplyCenters[i].destroy();
            }
            me.supplyCenters = null;
        }
    }


}

;// CONCATENATED MODULE: ./src/common/iServer/FindLocationService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class FindLocationService
 * @deprecatedclass SuperMap.FindLocationService
 * @category iServer NetworkAnalyst Location
 * @classdesc éåååºåææå¡ç±»ã
 *            éåååºåææ¯ä¸ºäºç¡®å®ä¸ä¸ªæå¤ä¸ªå¾å»ºè®¾æ½çæä½³ææä¼ä½ç½®ï¼ä½¿å¾è®¾æ½å¯ä»¥ç¨ä¸ç§æç»æµææçæ¹å¼ä¸ºéæ±æ¹æä¾æå¡æèååã
 *            éåååºä¸ä»ä»æ¯ä¸ä¸ªéåè¿ç¨ï¼è¿è¦å°éæ±ç¹çéæ±åéå°ç¸åºçæ°å»ºè®¾æ½çæå¡åºä¸­ï¼å æ­¤ç§°ä¹ä¸ºéåä¸ååºã
 *            éåååºåæç»æéè¿è¯¥ç±»æ¯æçäºä»¶ççå¬å½æ°åæ°è·å
 * @extends {NetworkAnalystServiceBase}
 * @example
 * (start code)
 * var findLocationService = new FindLocationService(url, {
 *     eventListeners: {
 *         "processCompleted": findLocationCompleted,
 *		   "processFailed": findLocationError
 *		   }
 * });
 * (end)
 * @param {string} url - æå¡å°åã
 *                       å¦ http://localhost:8090/iserver/services/transportationanalyst-sample/rest/networkanalyst/RoadNet@Changchun ã
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - éè¦è¢«æ³¨åççå¬å¨å¯¹è±¡ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class FindLocationService extends NetworkAnalystServiceBase {

    constructor(url, options) {
        super(url, options);

        this.CLASS_NAME = "SuperMap.FindLocationService";
    }

    /**
     * @function FindLocationService.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function FindLocationService.prototype.processAsync
     * @description è´è´£å°å®¢æ·ç«¯çæ¥è¯¢åæ°ä¼ éå°æå¡ç«¯ã
     * @param {FindLocationParameters} params - éåååºåææå¡åæ°ç±»
     */
    processAsync(params) {
        if (!(params instanceof FindLocationParameters)) {
            return;
        }
        var me = this,
            jsonObject;
        me.url = Util.urlPathAppend(me.url, 'location');
        jsonObject = {
            isFromCenter: params.isFromCenter,
            expectedSupplyCenterCount: params.expectedSupplyCenterCount,
            weightName: params.weightName,
            turnWeightField: params.turnWeightField,
            returnEdgeFeature: true,
            returnEdgeGeometry: true,
            returnNodeFeature: true,
            mapParameter: Util.toJSON(params.mapParameter),
            supplyCenters: me.getCentersJson(params.supplyCenters)
        };
        me.request({
            method: "GET",
            params: jsonObject,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }

    /**
     * @function FindLocationService.prototype.getCentersJson
     * @description å°æ°ç»å¯¹è±¡è½¬åä¸ºJSONå­ç¬¦ä¸²ã
     * @param {Array} params - éè¦è½¬æ¢çåæ°
     * @returns {string} è½¬ååçJSONå­ç¬¦ä¸²ã
     */
    getCentersJson(params) {
        var json = "[",
            len = params ? params.length : 0;
        for (var i = 0; i < len; i++) {
            if (i > 0) {
                json += ",";
            }
            json += Util.toJSON(params[i]);
        }
        json += "]";
        return json;
    }

    /**
     * @function FindLocationService.prototype.toGeoJSONResult
     * @description å°å«æ geometry çæ°æ®è½¬æ¢ä¸º GeoJSON æ ¼å¼ã
     * @param {Object} result - æå¡å¨è¿åçç»æå¯¹è±¡ã
     */
    toGeoJSONResult(result) {
        if (!result) {
            return null;
        }
        var geoJSONFormat = new GeoJSON();
        if (result.demandResults) {
            result.demandResults = geoJSONFormat.toGeoJSON(result.demandResults);
        }
        if (result.supplyResults) {
            result.supplyResults = geoJSONFormat.toGeoJSON(result.supplyResults);
        }

        return result;
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/FindMTSPPathsParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class FindMTSPPathsParameters
 * @deprecatedclass SuperMap.FindMTSPPathsParameters
 * @category iServer NetworkAnalyst MTSPPath
 * @classdesc å¤æè¡ååæåæ°ç±»
 * @param {Object} options - åæ°ã
 * @param {Array.<GeometryPoint|L.LatLng|L.Point|ol.geom.Point|mapboxgl.LngLat|mapboxgl.Point|Array.<number>>} options.centers - ééä¸­å¿éåã
 * @param {Array.<GeometryPoint|L.LatLng|L.Point|ol.geom.Point|mapboxgl.LngLat|mapboxgl.Point|Array.<number>>} options.nodes - ééç®æ éåã
 * @param {boolean} [options.hasLeastTotalCost=false] - ééæ¨¡å¼æ¯å¦ä¸ºæ»è±è´¹æå°æ¹æ¡ã
 * @param {boolean} [options.isAnalyzeById=false] - æ¯å¦éè¿èç¹ ID å·æ¥æå®ééä¸­å¿ç¹åééç®çç¹ï¼å³éè¿åæ ç¹æå®ã
 * @param {TransportationAnalystParameter} [options.parameter] - äº¤éç½ç»åæéç¨åæ°ã
 * @usage
 */
class FindMTSPPathsParameters {


    constructor(options) {
        /**
         * @member {Array.<GeometryPoint|L.LatLng|L.Point|ol.geom.Point|mapboxgl.LngLat|mapboxgl.Point|Array.<number>>} FindMTSPPathsParameters.prototype.centers
         * @description ééä¸­å¿éåã
         *              å½ FindMTSPPathsParameters.isAnalyzeById = false æ¶ï¼centers åºä¸ºç¹çåæ æ°ç»ï¼
         *              å½ FindMTSPPathsParameters.isAnalyzeById = true æ¶ï¼centers åºä¸ºç¹ç ID æ°ç»ã
         */
        this.centers = null;

        /**
         * @member {boolean} [FindMTSPPathsParameters.prototype.hasLeastTotalCost=false]
         * @description ééæ¨¡å¼æ¯å¦ä¸ºæ»è±è´¹æå°æ¹æ¡ã
         *              è¥ä¸º trueï¼åæç§æ»è±è´¹æå°çæ¨¡å¼è¿è¡ééï¼æ­¤æ¶å¯è½ä¼åºç°æå ä¸ªééä¸­å¿ç¹ééçè±è´¹è¾å¤èå¶ä»ééä¸­å¿ç¹çè±è´¹å¾å°çæåµã
         *              è¥ä¸º falseï¼åä¸ºå±é¨æä¼ï¼æ­¤æ¹æ¡ä¼æ§å¶æ¯ä¸ªééä¸­å¿ç¹çè±è´¹ï¼ä½¿åä¸ªä¸­å¿ç¹è±è´¹ç¸å¯¹å¹³åï¼æ­¤æ¶æ»è±è´¹ä¸ä¸å®æå°ã
         */
        this.hasLeastTotalCost = false;

        /**
         * @member {boolean} [FindMTSPPathsParameters.prototype.isAnalyzeById=false]
         * @description æ¯å¦éè¿èç¹ ID å·æ¥æå®ééä¸­å¿ç¹åééç®çç¹ï¼å³éè¿åæ ç¹æå®ã
         */
        this.isAnalyzeById = false;

        /**
         * @member {Array.<GeometryPoint|L.LatLng|L.Point|ol.geom.Point|mapboxgl.LngLat|mapboxgl.Point|Array.<number>>} FindMTSPPathsParameters.prototype.nodes
         * @description ééç®æ éåã
         *              å½ FindMTSPPathsParameters.isAnalyzeById = false æ¶ï¼nodes åºä¸ºç¹çåæ æ°ç»ï¼
         *              å½ FindMTSPPathsParameters.isAnalyzeById = true æ¶ï¼nodes åºä¸ºç¹ç ID æ°ç»ã
         */
        this.nodes = null;

        /**
         * @member {TransportationAnalystParameter} [FindMTSPPathsParameters.prototype.parameter]
         * @description äº¤éç½ç»åæéç¨åæ°ã
         *              éè¿æ¬ç±»å¯ä»¥è®¾ç½®éç¢è¾¹ãéç¢ç¹ãæå¼å­æ®µä¿¡æ¯çåç§°æ è¯ãè½¬åæå¼å­æ®µç­ä¿¡æ¯ã
         *              TransportationAnalystParameter ç±»åï¼å®è½ç¶ä¸ºå¯éåæ°ï¼ä½æ¯å¦æä¸è®¾ç½®å¶ä¸­ç resultSetting å­æ®µï¼åè¿åç»æç©ºé´ä¿¡æ¯ç­é½ä¸ºç©ºã
         */
        this.parameter = new TransportationAnalystParameter();
        Util.extend(this, options);

        this.CLASS_NAME = "SuperMap.FindMTSPPathsParameters";
    }

    /**
     * @function FindMTSPPathsParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.centers = null;
        me.hasLeastTotalCost = null;
        me.isAnalyzeById = null;
        me.nodes = null;
        me.maxWeight = null;
        if (me.parameter) {
            me.parameter.destroy();
            me.parameter = null;
        }
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/FindMTSPPathsService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class FindMTSPPathsService
 * @deprecatedclass SuperMap.FindMTSPPathsService
 * @category  iServer NetworkAnalyst MTSPPath
 * @classdesc å¤æè¡ååææå¡ç±»
 *            å¤æè¡ååæä¹ç§°ä¸ºç©æµééï¼æ¯æå¨ç½ç»æ°æ®éä¸­ï¼ç»å® M ä¸ªééä¸­å¿ç¹å N ä¸ªééç®çå°ï¼Mï¼N ä¸ºå¤§äºé¶çæ´æ°ï¼ã
 *            æ¥æ¾ç»æµææçééè·¯å¾ï¼å¹¶ç»åºç¸åºçè¡èµ°è·¯çº¿ã
 *            ç©æµééåè½å°±æ¯è§£å³å¦ä½åçåéééæ¬¡åºåéè´§è·¯çº¿ï¼ä½¿ééæ»è±è´¹è¾¾å°æå°ææ¯ä¸ªééä¸­å¿çè±è´¹è¾¾å°æå°ã
 *            è¯¥ç±»è´è´£å°å®¢æ·ç«¯æå®çå¤æè¡ååæåæ°ä¼ éç»æå¡ç«¯ï¼å¹¶æ¥æ¶æå¡ç«¯è¿åçç»ææ°æ®ã
 *            å¤æè¡ååæç»æéè¿è¯¥ç±»æ¯æçäºä»¶ççå¬å½æ°åæ°è·å
 * @extends {NetworkAnalystServiceBase}
 * @example
 * var myFindMTSPPathsService = new FindMTSPPathsService(url, {
 *     eventListeners: {
 *         "processCompleted": findMTSPPathsCompleted,
 *		   "processFailed": findMTSPPathsError
 *		   }
 * });
 * @param {string} url - æå¡å°åãè¯·æ±ç½ç»åææå¡ï¼URLåºä¸ºï¼
 *                       http://{æå¡å¨å°å}:{æå¡ç«¯å£å·}/iserver/services/ç½ç»åææå¡å}/rest/networkanalyst/{ç½ç»æ°æ®é@æ°æ®æº}ï¼
 *                       ä¾å¦:"http://localhost:8090/iserver/services/components-rest/rest/networkanalyst/RoadNet@Changchun"ã
 * @param {Object} options - äºæå¡æ¶æéå¯éåæ°ãå¦ï¼
 * @param {Object} options.eventListeners - éè¦è¢«æ³¨åççå¬å¨å¯¹è±¡ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class FindMTSPPathsService extends NetworkAnalystServiceBase {

    constructor(url, options) {
        super(url, options);

        this.CLASS_NAME = "SuperMap.FindMTSPPathsService";
    }

    /**
     * @function FindMTSPPathsService.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function FindMTSPPathsService..prototype.processAsync
     * @description è´è´£å°å®¢æ·ç«¯çæ¥è¯¢åæ°ä¼ éå°æå¡ç«¯ã
     * @param {FindMTSPPathsParameters} params - å¤æè¡ååææå¡åæ°ç±»
     */
    processAsync(params) {
        if (!(params instanceof FindMTSPPathsParameters)) {
            return;
        }
        var me = this,
            jsonObject,
            //end = me.url.substr(me.url.length - 1, 1),
            centers = me.getJson(params.isAnalyzeById, params.centers),
            nodes = me.getJson(params.isAnalyzeById, params.nodes);
        me.url = Util.urlPathAppend(me.url, 'mtsppath');
        jsonObject = {
            centers: centers,
            nodes: nodes,
            parameter: Util.toJSON(params.parameter),
            hasLeastTotalCost: params.hasLeastTotalCost
        };
        me.request({
            method: "GET",
            params: jsonObject,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }

    /**
     * @function FindMTSPPathsService.prototype.getJson
     * @description å°å¯¹è±¡è½¬åä¸ºJSONå­ç¬¦ä¸²ã
     * @param {boolean} isAnalyzeById - æ¯å¦éè¿idåæ
     * @param {Array} params - éè¦è½¬æ¢çæ°å­
     * @returns {Object} è½¬ååçJSONå­ç¬¦ä¸²ã
     */
    getJson(isAnalyzeById, params) {
        var jsonString = "[",
            len = params ? params.length : 0;

        if (isAnalyzeById === false) {
            for (let i = 0; i < len; i++) {
                if (i > 0) {
                    jsonString += ",";
                }
                jsonString += '{"x":' + params[i].x + ',"y":' + params[i].y + '}';
            }
        } else if (isAnalyzeById === true) {
            for (let i = 0; i < len; i++) {
                if (i > 0) {
                    jsonString += ",";
                }
                jsonString += params[i];
            }
        }
        jsonString += ']';
        return jsonString;
    }

    /**
     * @function FindMTSPPathsService.prototype.toGeoJSONResult
     * @description å°å«æ geometry çæ°æ®è½¬æ¢ä¸º GeoJSON æ ¼å¼ã
     * @param {Object} result - æå¡å¨è¿åçç»æå¯¹è±¡ã
     */
    toGeoJSONResult(result) {
        if (!result || !result.pathList) {
            return null;
        }
        var geoJSONFormat = new GeoJSON();
        result.pathList.map(function (path) {
            if (path.route) {
                path.route = geoJSONFormat.toGeoJSON(path.route);
            }
            if (path.pathGuideItems) {
                path.pathGuideItems = geoJSONFormat.toGeoJSON(path.pathGuideItems);
            }
            if (path.edgeFeatures) {
                path.edgeFeatures = geoJSONFormat.toGeoJSON(path.edgeFeatures);
            }
            if (path.nodeFeatures) {
                path.nodeFeatures = geoJSONFormat.toGeoJSON(path.nodeFeatures);
            }
            return path;
        });
        return result;
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/FindPathParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class FindPathParameters
 * @deprecatedclass SuperMap.FindPathParameters
 * @category  iServer NetworkAnalyst Path
 * @classdesc æä½³è·¯å¾åæåæ°ç±»ãæä½³è·¯å¾æ¯å¨ç½ç»æ°æ®éä¸­æå®ä¸äºç»ç¹ï¼æç§é¡ºåºè®¿é®ç»ç¹ä»èæ±è§£èµ·æ­¢ç¹ä¹é´é»ææå°çè·¯å¾ã
 * ä¾å¦å¦æè¦é¡ºåºè®¿é® 1ã2ã3ã4 åä¸ªç»ç¹ï¼åéè¦åå«æ¾å°1ã2ç»ç¹é´çæä½³è·¯å¾ R1â2ï¼2ã3 é´çæä½³è·¯å¾ R2â3 å 3ã4 ç»ç¹é´çæä½³è·¯å¾ R3â4ï¼
 * é¡ºåºè®¿é® 1ã2ã3ã4 åä¸ªç»ç¹çæä½³è·¯å¾å°±æ¯ R = R1â2 + R2â3 + R3â4ã
 * é»æå°±æ¯æä»ä¸ç¹å°å¦ä¸ç¹çèè´¹ï¼å¨å®éåºç¨ä¸­æä»¬å¯ä»¥å°è·ç¦»ãæ¶é´ãè±è´¹ç­ä½ä¸ºé»ææ¡ä»¶ã
 * é»ææå°ä¹å°±å¯ä»¥çè§£ä¸ºä»ä¸ç¹å°å¦ä¸ç¹è·ç¦»æç­ãæ¶é´æå°ãè±è´¹æä½ç­ãå½ä¸¤ç¹é´è·ç¦»æç­æ¶ä¸ºæç­è·¯å¾ï¼å®æ¯æä½³è·¯å¾é®é¢çä¸ä¸ªç¹ä¾ã
 * é»æå¼éè¿ {@link TransportationAnalystParameter#weightFieldName}è®¾ç½®ã
 * è®¡ç®æä½³è·¯å¾é¤äºåé»æå½±åå¤ï¼è¿åè½¬åå­æ®µçå½±åãè½¬åå¼éè¿ {@link TransportationAnalystParameter#turnWeightField} è®¾ç½®ã
 *
 * @param {Object} options - åæ°ã
 * @param {Array.<GeometryPoint|L.LatLng|L.Point|ol.geom.Point|mapboxgl.LngLat|mapboxgl.Point|Array.<number>>} options.nodes - æä½³è·¯å¾åæç»è¿çç»ç¹æè®¾æ½ç¹æ°ç»ãè¯¥å­æ®µè³å°åå«ä¸¤ä¸ªç¹ã
 * @param {boolean} [options.isAnalyzeById=false] - æ¯å¦éè¿èç¹ ID æå®è·¯å¾åæçç»ç¹ã
 * @param {boolean} [options.hasLeastEdgeCount=false] - æ¯å¦æç§å¼§æ®µæ°æå°çè¿è¡æä½³è·¯å¾åæã
 * @param {TransportationAnalystParameter} [options.parameter] - äº¤éç½ç»åæéç¨åæ°ã
 * @usage
 */
class FindPathParameters {

    constructor(options) {

        /**
         * @member {boolean} [FindPathParameters.prototype.isAnalyzeById=false]
         * @description æ¯å¦éè¿èç¹ ID æå®è·¯å¾åæçç»ç¹ã
         *              æå®è·¯å¾åæç»è¿çç»ç¹æè®¾æ½ç¹æä¸¤ç§æ¹å¼ï¼è¾å¥ç»ç¹ ID å·æç´æ¥è¾å¥ç¹åæ ã
         *              å½è¯¥å­æ®µä¸º true æ¶ï¼è¡¨ç¤ºéè¿ç»ç¹ ID æå®éç»ç¹ï¼å³ FindPathParameters.nodes = [ID1,ID2,...]ï¼
         *              åä¹è¡¨ç¤ºéè¿ç»ç¹åæ æå®éç»ç¹ï¼å³ FindPathParameters.nodes = [{x1,y1},{x2,y2},...] ã
         */
        this.isAnalyzeById = false;

        /**
         * @member {boolean} [FindPathParameters.prototype.hasLeastEdgeCount=false]
         * @description æ¯å¦æç§å¼§æ®µæ°æå°çè¿è¡æä½³è·¯å¾åæã
         *              true è¡¨ç¤ºæç§å¼§æ®µæ°æå°è¿è¡åæï¼è¿åå¼§æ®µæ°æå°çè·¯å¾ä¸­ä¸ä¸ªé»ææå°çæä½³è·¯å¾ï¼
         *              false è¡¨ç¤ºç´æ¥è¿åé»ææå°çè·¯å¾ï¼èä¸èèå¼§æ®µçå¤å°ã
         */
        this.hasLeastEdgeCount = null;

        /**
         * @member {Array.<GeometryPoint|L.LatLng|L.Point|ol.geom.Point|mapboxgl.LngLat|mapboxgl.Point|Array.<number>>} FindPathParameters.prototype.nodes
         * @description æä½³è·¯å¾åæç»è¿çç»ç¹æè®¾æ½ç¹æ°ç»ï¼å¿è®¾å­æ®µãè¯¥å­æ®µè³å°åå«ä¸¤ä¸ªç¹ã
         *              å½ FindPathParameters.isAnalyzeById = false æ¶ï¼nodes åºä¸ºç¹çåæ æ°ç»ï¼
         *              å½ FindPathParameters.isAnalyzeById = true æ¶ï¼nodes åºä¸ºç¹ç ID æ°ç»ã
         */
        this.nodes = null;

        /**
         * @member {TransportationAnalystParameter} FindPathParameters.prototype.parameter
         * @description äº¤éç½ç»åæéç¨åæ°ã
         */
        this.parameter = new TransportationAnalystParameter();
        Util.extend(this, options);

        this.CLASS_NAME = "SuperMap.FindPathParameters";
    }


    /**
     * @function FindPathParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.isAnalyzeById = null;
        me.hasLeastEdgeCount = null;
        me.nodes = null;
        if (me.parameter) {
            me.parameter.destroy();
            me.parameter = null;
        }
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/FindPathService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class FindPathService
 * @deprecatedclass SuperMap.FindPathService
 * @category iServer NetworkAnalyst Path
 * @classdesc æä½³è·¯å¾åææå¡ç±»ã
 *            æä½³è·¯å¾æ¯å¨ç½ç»æ°æ®éä¸­æå®ä¸äºèç¹ï¼æç§èç¹çéæ©é¡ºåºï¼
 *            é¡ºåºè®¿é®è¿äºèç¹ä»èæ±è§£èµ·æ­¢ç¹ä¹é´é»ææå°çè·¯ç»ã
 *            è¯¥ç±»è´è´£å°å®¢æ·ç«¯æå®çæä½³è·¯å¾åæåæ°ä¼ éç»æå¡ç«¯ï¼å¹¶æ¥æ¶æå¡ç«¯è¿åçç»ææ°æ®ã
 *            æä½³è·¯å¾åæç»æéè¿è¯¥ç±»æ¯æçäºä»¶ççå¬å½æ°åæ°è·å
 * @extends {NetworkAnalystServiceBase}
 * @example
 * var myFindPathService = new FindPathService(url, {
 *     eventListeners: {
 *	       "processCompleted": findPathCompleted,
 *		   "processFailed": findPathError
 *		   }
 * });
 * @param {string} url - æå¡å°åãè¯·æ±ç½ç»åææå¡ï¼URLåºä¸ºï¼
 *                       http://{æå¡å¨å°å}:{æå¡ç«¯å£å·}/iserver/services/{ç½ç»åææå¡å}/rest/networkanalyst/{ç½ç»æ°æ®é@æ°æ®æº}ï¼
 *                       ä¾å¦:"http://localhost:8090/iserver/services/components-rest/rest/networkanalyst/RoadNet@Changchun"ã
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - éè¦è¢«æ³¨åççå¬å¨å¯¹è±¡ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class FindPathService extends NetworkAnalystServiceBase {

    constructor(url, options) {
        super(url, options);

        this.CLASS_NAME = "SuperMap.FindPathService";
    }

    /**
     * @function FindPathService.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function FindPathService.prototype.processAsync
     * @description è´è´£å°å®¢æ·ç«¯çæ¥è¯¢åæ°ä¼ éå°æå¡ç«¯ã
     * @param {FindPathParameters} params - æä½³è·¯å¾åææå¡åæ°ç±»
     */
    processAsync(params) {
        if (!(params instanceof FindPathParameters)) {
            return;
        }
        var me = this, jsonObject;
        me.url = Util.urlPathAppend(me.url, 'path');
        jsonObject = {
            hasLeastEdgeCount: params.hasLeastEdgeCount,
            parameter: Util.toJSON(params.parameter),
            nodes: me.getJson(params.isAnalyzeById, params.nodes)
        };
        me.request({
            method: "GET",
            params: jsonObject,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }

    /**
     * @function FindPathService.prototype.getJson
     * @description å°å¯¹è±¡è½¬åä¸ºJSONå­ç¬¦ä¸²ã
     * @param {boolean} isAnalyzeById - æ¯å¦éè¿idåæ
     * @param {Array} params - éè¦è½¬æ¢çæ°å­
     * @returns {Object} è½¬ååçJSONå­ç¬¦ä¸²ã
     */
    getJson(isAnalyzeById, params) {
        var jsonString = "[",
            len = params ? params.length : 0;

        if (isAnalyzeById === false) {
            for (let i = 0; i < len; i++) {
                if (i > 0) {
                    jsonString += ",";
                }
                jsonString += '{"x":' + params[i].x + ',"y":' + params[i].y + '}';
            }
        } else if (isAnalyzeById === true) {
            for (let i = 0; i < len; i++) {
                if (i > 0) {
                    jsonString += ",";
                }
                jsonString += params[i];
            }
        }
        jsonString += ']';
        return jsonString;
    }

    /**
     * @function FindMTSPPathsService.prototype.toGeoJSONResult
     * @description å°å«æ geometry çæ°æ®è½¬æ¢ä¸º GeoJSON æ ¼å¼ã
     * @param {Object} result - æå¡å¨è¿åçç»æå¯¹è±¡ã
     */
    toGeoJSONResult(result) {
        if (!result || !result.pathList || result.pathList.length < 1) {
            return null;
        }
        var geoJSONFormat = new GeoJSON();
        result.pathList.forEach(function (path) {
            if (path.route) {
                path.route = geoJSONFormat.toGeoJSON(path.route);
            }
            if (path.pathGuideItems) {
                path.pathGuideItems = geoJSONFormat.toGeoJSON(path.pathGuideItems);

            }
            if (path.edgeFeatures) {
                path.edgeFeatures = geoJSONFormat.toGeoJSON(path.edgeFeatures);
            }
            if (path.nodeFeatures) {
                path.nodeFeatures = geoJSONFormat.toGeoJSON(path.nodeFeatures);
            }
        });
        return result;
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/FindServiceAreasParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class FindServiceAreasParameters
 * @deprecatedclass SuperMap.FindServiceAreasParameters
 * @category iServer NetworkAnalyst ServiceArea
 * @classdesc æå¡åºåæåæ°ç±»ã
 *            æå¡åºåææ¯ä»¥æå®æå¡ç«ç¹ä¸ºä¸­å¿ï¼å¨ä¸å®æå¡èå´åæ¥æ¾ç½ç»ä¸æå¡ç«ç¹è½å¤æä¾æå¡çåºåèå´ã
 *            ä¾å¦ï¼è®¡ç®æå¿«é¤åºè½å¤å¨30åéåéè¾¾å¿«é¤çåºåã
 * @param {Object} options - åæ°ã
 * @param {Array.<number>} options.weights - æ¯ä¸ªæå¡ç«ç¹æä¾æå¡çé»ååå¾ï¼è¶è¿è¿ä¸ªé»ååå¾çåºåä¸äºèèï¼å¶åä½ä¸é»åå­æ®µä¸è´ã
 * @param {Array.<GeometryPoint|L.LatLng|L.Point|ol.geom.Point|mapboxgl.LngLat|mapboxgl.Point|Array.<number>>} options.centers - æå¡ç«ç¹æ°ç»ã
 * @param {boolean} [options.isAnalyzeById=false] - æ¯å¦éè¿èç¹ ID æå®è·¯å¾åæçç»ç¹ã
 * @param {boolean} [options.isCenterMutuallyExclusive=false] - æ¯å¦ä¸­å¿ç¹äºæ¥ã
 * @param {boolean} [options.isFromCenter=false] - æ¯å¦ä»ä¸­å¿ç¹å¼å§åæã
 * @param {TransportationAnalystParameter} [options.parameter] - äº¤éç½ç»åæéç¨åæ°ã
 * @usage
 */
class FindServiceAreasParameters {


    constructor(options) {
        /**
         * @member {boolean} [FindServiceAreasParameters.prototype.isAnalyzeById=false]
         * @description æ¯å¦éè¿èç¹ ID æå®è·¯å¾åæçç»ç¹ã
         *              æå®è·¯å¾åæç»è¿çç»ç¹æè®¾æ½ç¹æä¸¤ç§æ¹å¼ï¼è¾å¥ç»ç¹ ID å·æç´æ¥è¾å¥ç¹åæ ã
         *              å½è¯¥å­æ®µä¸º true æ¶ï¼è¡¨ç¤ºéè¿ç»ç¹ ID æå®éç»ç¹ï¼å³ FindServiceAreasParameters.centers = [ID1,ID2,...]ï¼
         *              åä¹è¡¨ç¤ºéè¿ç»ç¹åæ æå®éç»ç¹ï¼å³ FindServiceAreasParameters.centers = [{x1,y1},{x2,y2},...]ã
         */
        this.isAnalyzeById = false;

        /**
         * @member {boolean} [FindServiceAreasParameters.prototype.isCenterMutuallyExclusive=false]
         * @description æ¯å¦ä¸­å¿ç¹äºæ¥ï¼å³æç§ä¸­å¿ç¹çè·ç¦»è¿è¡å¤æ­æ¯å¦è¦è¿è¡äºæ¥å¤çã
         *              è¥åæåºçæå¡åºæéå çé¨åï¼åéè¿è®¾ç½®è¯¥åæ°è¿è¡äºæ¥å¤çã
         */
        this.isCenterMutuallyExclusive = false;

        /**
         * @member {Array.<GeometryPoint|L.LatLng|L.Point|ol.geom.Point|mapboxgl.LngLat|mapboxgl.Point|Array.<number>>} FindServiceAreasParameters.prototype.centers
         * @description æå¡ç«ç¹æ°ç»ã
         *              å½è¯¥ç±»ç iSAnalyzeById = true æ¶ï¼éè¿ç»ç¹ ID å·æå®æå¡ç«ç¹ï¼å½ iSAnalyzeById = false æ¶ï¼éè¿ç¹åæ æå®æå¡ç«ç¹ã
         */
        this.centers = null;

        /**
         * @member {boolean} [FindServiceAreasParameters.prototype.isFromCenter=false]
         * @description æ¯å¦ä»ä¸­å¿ç¹å¼å§åæã
         *              ä»ä¸­å¿ç¹å¼å§åæåä¸ä»ä¸­å¿ç¹å¼å§åæï¼ä½ç°äºæå¡ä¸­å¿åéè¦è¯¥æå¡çéæ±å°çå³ç³»æ¨¡å¼ã
         *              ä»ä¸­å¿ç¹å¼å§åæï¼æ¯ä¸ä¸ªæå¡ä¸­å¿åæå¡éæ±å°æä¾æå¡ï¼
         *              èä¸ä»ä¸­å¿ç¹å¼å§åæï¼æ¯ä¸ä¸ªæå¡éæ±å°ä¸»å¨å°æå¡ä¸­å¿è·å¾æå¡ã
         */
        this.isFromCenter = false;

        /**
         * APIProperty: weights
         * @member {Array.<number>} FindServiceAreasParameters.prototype.weights
         * @description æ¯ä¸ªæå¡ç«ç¹æä¾æå¡çé»ååå¾ï¼å³è¶è¿è¿ä¸ªé»ååå¾çåºåä¸äºèèï¼å¶åä½ä¸é»åå­æ®µä¸è´ã
         *              è¯¥å­æ®µä¸ºä¸ä¸ªæ°ç»ï¼æ°ç»é¿åº¦è·æå¡ä¸­å¿ä¸ªæ°ä¸è´ï¼æç§ç´¢å¼é¡ºåºä¸ç«ç¹ä¸ä¸å¯¹åºï¼æ¯ä¸ªåç´ è¡¨ç¤ºäºå¨å¯¹æ¯ä¸ªæå¡ä¸­å¿è¿è¡æå¡åºåææ¶ï¼æç¨çæå¡åå¾ã
         */
        this.weights = null;

        /**
         * @member {TransportationAnalystParameter} FindServiceAreasParameters.prototype.parameter
         * @description äº¤éç½ç»åæéç¨åæ°ã
         */
        this.parameter = new TransportationAnalystParameter();

        Util.extend(this, options);

        this.CLASS_NAME = "SuperMap.FindServiceAreasParameters";
    }

    /**
     * @function FindServiceAreasParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.isAnalyzeById = null;
        me.isCenterMutuallyExclusive = null;
        me.centers = null;
        me.isFromCenter = null;
        me.weights = null;
        if (me.parameter) {
            me.parameter.destroy();
            me.parameter = null;
        }
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/FindServiceAreasService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class FindServiceAreasService
 * @deprecatedclass SuperMap.FindServiceAreasService
 * @category iServer NetworkAnalyst ServiceArea
 * @classdesc æå¡åºåææå¡ç±»ã
 *            æå¡åºåææ¯ä»¥æå®æå¡ç«ç¹ä¸ºä¸­å¿ï¼
 *            å¨ä¸å®æå¡èå´åæ¥æ¾ç½ç»ä¸æå¡ç«ç¹è½å¤æä¾æå¡çåºåèå´ã
 *            è¯¥ç±»è´è´£å°å®¢æ·ç«¯æå®çæå¡åºåæåæ°ä¼ éç»æå¡ç«¯ï¼å¹¶æ¥æ¶æå¡ç«¯è¿åçç»ææ°æ®ã
 *            æå¡åºåæç»æéè¿è¯¥ç±»æ¯æçäºä»¶ççå¬å½æ°åæ°è·å
 * @extends {NetworkAnalystServiceBase}
 * @example
 * var myFindServiceAreasService = new FindServiceAreasService(url, {
 *          eventListeners: {
 *              "processCompleted": findServiceAreasCompleted,
 *              "processFailed": findServiceAreasError
 *          }
 * });
 * @param {string} url - æå¡å°åãè¯·æ±ç½ç»åææå¡ï¼URLåºä¸ºï¼
 *                       http://{æå¡å¨å°å}:{æå¡ç«¯å£å·}/iserver/services/{ç½ç»åææå¡å}/rest/networkanalyst/{ç½ç»æ°æ®é@æ°æ®æº}ï¼
 *                       ä¾å¦:"http://localhost:8090/iserver/services/components-rest/rest/networkanalyst/RoadNet@Changchun"ã
 * @param {Object} options - äºæå¡æ¶æéå¯éåæ°ãå¦ï¼
 * @param {Object} options.eventListeners - éè¦è¢«æ³¨åççå¬å¨å¯¹è±¡
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class FindServiceAreasService extends NetworkAnalystServiceBase {

    constructor(url, options) {
        super(url, options);

        this.CLASS_NAME = "SuperMap.FindServiceAreasService";
    }

    /**
     * @function FindServiceAreasService.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function FindServiceAreasService.prototype.processAsync
     * @description è´è´£å°å®¢æ·ç«¯çæ¥è¯¢åæ°ä¼ éå°æå¡ç«¯ã
     * @param {FindServiceAreasParameters} params - æå¡åºåææå¡åæ°ç±»
     */
    processAsync(params) {
        if (!(params instanceof FindServiceAreasParameters)) {
            return;
        }
        var me = this, jsonObject;
        me.url = Util.urlPathAppend(me.url, 'servicearea');
        jsonObject = {
            isFromCenter: params.isFromCenter,
            isCenterMutuallyExclusive: params.isCenterMutuallyExclusive,
            parameter: Util.toJSON(params.parameter),
            centers: me.getJson(params.isAnalyzeById, params.centers),
            weights: me.getJson(true, params.weights)
        };
        me.request({
            method: "GET",
            params: jsonObject,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }

    /**
     * @function FindServiceAreasService.prototype.getJson
     * @description å°å¯¹è±¡è½¬åä¸ºJSONå­ç¬¦ä¸²ã
     * @param {boolean} isAnalyzeById - æ¯å¦éè¿idåæ
     * @param {Array} params - éè¦è½¬æ¢çæ°å­
     * @returns {Object} è½¬ååçJSONå­ç¬¦ä¸²ã
     */
    getJson(isAnalyzeById, params) {
        var jsonString = "[",
            len = params ? params.length : 0;

        if (isAnalyzeById === false) {
            for (let i = 0; i < len; i++) {
                if (i > 0) {
                    jsonString += ",";
                }
                jsonString += '{"x":' + params[i].x + ',"y":' + params[i].y + '}';
            }
        } else if (isAnalyzeById === true) {
            for (let i = 0; i < len; i++) {
                if (i > 0) {
                    jsonString += ",";
                }
                jsonString += params[i];
            }
        }
        jsonString += ']';
        return jsonString;
    }

    /**
     * @function FindServiceAreasService.prototype.toGeoJSONResult
     * @description å°å«æ geometry çæ°æ®è½¬æ¢ä¸º GeoJSON æ ¼å¼ã
     * @param {Object} result - æå¡å¨è¿åçç»æå¯¹è±¡ãã
     */
    toGeoJSONResult(result) {
        if (!result || !result.serviceAreaList) {
            return result;
        }
        var geoJSONFormat = new GeoJSON();
        result.serviceAreaList.map(function (serviceArea) {
            if (serviceArea.serviceRegion) {
                serviceArea.serviceRegion = geoJSONFormat.toGeoJSON(serviceArea.serviceRegion);
            }
            if (serviceArea.edgeFeatures) {
                serviceArea.edgeFeatures = geoJSONFormat.toGeoJSON(serviceArea.edgeFeatures);
            }
            if (serviceArea.nodeFeatures) {
                serviceArea.nodeFeatures = geoJSONFormat.toGeoJSON(serviceArea.nodeFeatures);
            }
            if (serviceArea.routes) {
                serviceArea.routes = geoJSONFormat.toGeoJSON(serviceArea.routes);
            }
            return serviceArea;
        });

        return result;
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/FindTSPPathsParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class FindTSPPathsParameters
 * @deprecatedclass SuperMap.FindTSPPathsParameters
 * @category iServer NetworkAnalyst TSPPath
 * @classdesc æè¡ååæåæ°ç±»ã
 * æè¡ååææ¯è·¯å¾åæçä¸ç§ï¼å®ä»èµ·ç¹å¼å§ï¼é»è®¤ä¸ºç¨æ·æå®çç¬¬ä¸ç¹ï¼æ¥æ¾è½å¤éåææéç»ç¹ä¸è±è´¹æå°çè·¯å¾ã
 * æè¡ååæä¹å¯ä»¥æå®å°è¾¾çç»ç¹ï¼è¿æ¶æ¥æ¾ä»èµ·ç¹è½å¤éåææéç»ç¹æåå°è¾¾ç»ç¹ï¼ä¸è±è´¹æå°çè·¯å¾ã
 * æè¡ååæåæä½³è·¯å¾åæé½æ¯å¨ç½ç»ä¸­å¯»æ¾éåææç«ç¹çæç»æµçè·¯å¾ï¼åºå«æ¯å¨éåç½ç»ææç«ç¹çè¿ç¨ä¸­å¯¹ç»ç¹è®¿é®é¡ºåºä¸å
 * æä½³è·¯å¾åæå¿é¡»æç§æå®é¡ºåºå¯¹ç«ç¹è¿è¡è®¿é®ï¼èæè¡ååææ¯æ åºçè·¯å¾åæã
 * @param {Object} options - åæ°ã
 * @param {boolean} [options.endNodeAssigned=false] - æ¯å¦æå®ç»æ­¢ç¹ï¼å°æå®çéç»ç¹çæåä¸ä¸ªç¹ä½ä¸ºç»æ­¢ç¹ãtrue è¡¨ç¤ºæå®ç»æ­¢ç¹ï¼åæè¡åå¿é¡»æåä¸ä¸ªè®¿é®ç»æ­¢ç¹ã
 * @param {boolean} [options.isAnalyzeById=false] - æ¯å¦éè¿èç¹ ID å·æ¥æå®ééä¸­å¿ç¹åééç®çç¹ã
 * @param {Array.<GeometryPoint|L.LatLng|L.Point|ol.geom.Point|mapboxgl.LngLat|mapboxgl.Point|Array.<number>>} options.nodes - ééç®æ éåã
 * @param {TransportationAnalystParameter} [options.parameter] - äº¤éç½ç»åæéç¨åæ°ã
 * @usage
 */
class FindTSPPathsParameters {


    constructor(options) {
        /**
         * @member {boolean} [FindTSPPathsParameters.prototype.endNodeAssigned=false]
         * @description æ¯å¦æå®ç»æ­¢ç¹ï¼å°æå®çéç»ç¹çæåä¸ä¸ªç¹ä½ä¸ºç»æ­¢ç¹ã
         *              true è¡¨ç¤ºæå®ç»æ­¢ç¹ï¼åæè¡åå¿é¡»æåä¸ä¸ªè®¿é®ç»æ­¢ç¹ã
         */
        this.endNodeAssigned = false;

        /**
         * @member {boolean} [FindTSPPathsParameters.prototype.isAnalyzeById=false]
         * @description æ¯å¦éè¿èç¹ ID å·æ¥æå®éç»ç¹ã
         */
        this.isAnalyzeById = false;

        /**
         * @member {Array.<GeometryPoint|L.LatLng|L.Point|ol.geom.Point|mapboxgl.LngLat|mapboxgl.Point|Array.<number>>} FindTSPPathsParameters.prototype.nodes
         * @description æè¡ååæéç»ç¹æ°ç»ã
         *              å½ FindTSPPathsParameters.isAnalyzeById = false æ¶ï¼nodes åºä¸ºç¹çåæ æ°ç»ï¼
         *              å½ FindTSPPathsParameters.isAnalyzeById = true æ¶ï¼nodes åºä¸ºç¹ç ID æ°ç»ã
         */
        this.nodes = null;

        /**
         * @member {TransportationAnalystParameter} [FindTSPPathsParameters.prototype.parameter]
         * @description äº¤éç½ç»åæéç¨åæ°ãéè¿æ¬ç±»å¯ä»¥è®¾ç½®éç¢è¾¹ãéç¢ç¹ãæå¼å­æ®µä¿¡æ¯çåç§°æ è¯ãè½¬åæå¼å­æ®µç­ä¿¡æ¯ã
         *              TransportationAnalystParameter ç±»åï¼å®è½ç¶ä¸ºå¯éåæ°ï¼ä½æ¯å¦æä¸è®¾ç½®å¶ä¸­ç resultSetting
         *              å­æ®µï¼åè¿åç»æç©ºé´ä¿¡æ¯ç­é½ä¸ºç©ºã
         */
        this.parameter = new TransportationAnalystParameter();
        Util.extend(this, options);

        this.CLASS_NAME = "SuperMap.FindTSPPathsParameters";
    }

    /**
     * @function FindTSPPathsParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.endNodeAssigned = null;
        me.isAnalyzeById = null;
        me.nodes = null;
        if (me.parameter) {
            me.parameter.destroy();
            me.parameter = null;
        }
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/FindTSPPathsService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class FindTSPPathsService
 * @deprecatedclass SuperMap.FindTSPPathsService
 * @category  iServer NetworkAnalyst TSPPath
 * @classdesc æè¡ååææå¡ç±»
 *            æè¡ååææ¯è·¯å¾åæçä¸ç§ï¼å®ä»èµ·ç¹å¼å§ï¼é»è®¤ä¸ºç¨æ·æå®çç¬¬ä¸ç¹ï¼æ¥æ¾è½å¤éåææéç»ç¹ä¸è±è´¹æå°çè·¯å¾ã
 *            æè¡ååæä¹å¯ä»¥æå®å°è¾¾çç»ç¹ï¼è¿æ¶æ¥æ¾ä»èµ·ç¹è½å¤éåææéç»ç¹æåå°è¾¾ç»ç¹ï¼ä¸è±è´¹æå°çè·¯å¾ã
 *            è¯¥ç±»è´è´£å°å®¢æ·ç«¯æå®çæè¡ååæåæ°ä¼ éç»æå¡ç«¯ï¼å¹¶æ¥æ¶æå¡ç«¯è¿åçç»ææ°æ®ã
 *            æè¡ååæç»æéè¿è¯¥ç±»æ¯æçäºä»¶ççå¬å½æ°åæ°è·å
 * @extends {NetworkAnalystServiceBase}
 * @example
 * (start code)
 * var myFindTSPPathsService = new FindTSPPathsService(url, {
 *     eventListeners: {
 *	      "processCompleted": findTSPPathsCompleted,
 *		  "processFailed": findTSPPathsError
 *		  }
 *  });
 * (end)
 * @param {string} url - ç½ç»åææå¡å°åãè¯·æ±ç½ç»åææå¡ï¼URLåºä¸ºï¼
 *                       http://{æå¡å¨å°å}:{æå¡ç«¯å£å·}/iserver/services/{ç½ç»åææå¡å}/rest/networkanalyst/{ç½ç»æ°æ®é@æ°æ®æº}ï¼
 *                       ä¾å¦:"http://localhost:8090/iserver/services/components-rest/rest/networkanalyst/RoadNet@Changchun"ã
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - éè¦è¢«æ³¨åççå¬å¨å¯¹è±¡ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class FindTSPPathsService extends NetworkAnalystServiceBase {

    constructor(url, options) {
        super(url, options);

        this.CLASS_NAME = "SuperMap.FindTSPPathsService";
    }

    /**
     * @function FindTSPPathsService.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function FindTSPPathsService.prototype.processAsync
     * @description è´è´£å°å®¢æ·ç«¯çæ¥è¯¢åæ°ä¼ éå°æå¡ç«¯ã
     * @param {FindTSPPathsParameters} params - æè¡ååææå¡åæ°ç±»ã
     */
    processAsync(params) {
        if (!(params instanceof FindTSPPathsParameters)) {
            return;
        }
        var me = this, jsonObject;
        me.url = Util.urlPathAppend(me.url, 'tsppath');
        jsonObject = {
            parameter: Util.toJSON(params.parameter),
            endNodeAssigned: params.endNodeAssigned,
            nodes: me.getNodesJson(params)
        };
        me.request({
            method: "GET",
            params: jsonObject,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }

    /**
     * @function FindTSPPathsService.prototype.getNodesJson
     * @description å°èç¹å¯¹è±¡è½¬åä¸ºJSONå­ç¬¦ä¸²ã
     * @param {FindTSPPathsParameters} params - æè¡ååææå¡åæ°ç±»ã
     * @returns {string} è½¬ååçJSONå­ç¬¦ä¸²ã
     */
    getNodesJson(params) {
        var jsonParameters = "", nodesString, i, len, nodes;
        if (params.isAnalyzeById === false) {
            for (nodesString = "[", i = 0, nodes = params.nodes, len = nodes.length; i < len; i++) {
                if (i > 0) {
                    nodesString += ",";
                }
                nodesString += '{"x":' + nodes[i].x + ',"y":' + nodes[i].y + '}';
            }
            nodesString += ']';
            jsonParameters += nodesString;
        } else if (params.isAnalyzeById === true) {
            let nodeIDsString = "[", nodes = params.nodes, len = nodes.length;
            for (let i = 0; i < len; i++) {
                if (i > 0) {
                    nodeIDsString += ",";
                }
                nodeIDsString += nodes[i];
            }
            nodeIDsString += ']';
            jsonParameters += nodeIDsString;
        }
        return jsonParameters;
    }

    /**
     * @function FindTSPPathsService.prototype.toGeoJSONResult
     * @description å°å«æ geometry çæ°æ®è½¬æ¢ä¸º GeoJSON æ ¼å¼ã
     * @param {Object} result - æå¡å¨è¿åçç»æå¯¹è±¡ã
     */
    toGeoJSONResult(result) {
        if (!result || !result.tspPathList) {
            return null;
        }
        var geoJSONFormat = new GeoJSON();
        result.tspPathList.forEach(function (path) {
            if (path.route) {
                path.route = geoJSONFormat.toGeoJSON(path.route);
            }
            if (path.pathGuideItems) {
                path.pathGuideItems = geoJSONFormat.toGeoJSON(path.pathGuideItems);
            }
            if (path.edgeFeatures) {
                path.edgeFeatures = geoJSONFormat.toGeoJSON(path.edgeFeatures);
            }
            if (path.nodeFeatures) {
                path.nodeFeatures = geoJSONFormat.toGeoJSON(path.nodeFeatures);
            }
        });
        return result;
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/GenerateSpatialDataParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class GenerateSpatialDataParameters
 * @deprecatedclass SuperMap.GenerateSpatialDataParameters
 * @category iServer SpatialAnalyst GenerateSpatialData
 * @classdesc å¨æåæ®µæä½åæ°ç±»ãéè¿è¯¥ç±»å¯ä»¥ä¸ºå¨æåæ®µæä¾åæ°ä¿¡æ¯ã
 * @param {Object} options - åæ°ã
 * @param {string} options.routeTable - è·¯ç±æ°æ®éã
 * @param {string} options.routeIDField - è·¯ç±æ°æ®éçæ è¯å­æ®µã
 * @param {string} options.eventTable - ç¨äºçæç©ºé´æ°æ®çäºä»¶è¡¨åã
 * @param {DataReturnOption} options.dataReturnOption - è®¾ç½®æ°æ®è¿åéé¡¹ã
 * @param {string} [options.attributeFilter] - å±æ§è¿æ»¤æ¡ä»¶ã
 * @param {string} options.eventRouteIDField - ç¨äºçæç©ºé´æ°æ®çäºä»¶è¡¨çè·¯ç±æ è¯å­æ®µã
 * @param {string} [options.measureField] - ç¨äºçæç©ºé´æ°æ®çäºä»¶è¡¨çå»åº¦å­æ®µï¼åªæå½äºä»¶ä¸ºç¹äºä»¶çæ¶åè¯¥å±æ§æææä¹ã
 * @param {string} [options.measureStartField] - ç¨äºçæç©ºé´æ°æ®çäºä»¶è¡¨çèµ·å§å»åº¦å­æ®µï¼åªæå½äºä»¶ä¸ºçº¿äºä»¶çæ¶åè¯¥å±æ§æææä¹ã
 * @param {string} [options.measureEndField] - ç¨äºçæç©ºé´æ°æ®çäºä»¶è¡¨çç»æ­¢å»åº¦å­æ®µï¼åªæå½äºä»¶ä¸ºçº¿äºä»¶çæ¶åè¯¥å±æ§æææä¹ã
 * @param {string} [options.measureOffsetField] - å»åº¦åç§»éå­æ®µã
 * @param {string} [options.errorInfoField] - éè¯¯ä¿¡æ¯å­æ®µï¼ç´æ¥åå¥åäºä»¶è¡¨ï¼ç¨äºæè¿°äºä»¶æªè½çæå¯¹åºçç¹æçº¿æ¶çéè¯¯ä¿¡æ¯ã
 * @param {Array.<string>} [options.retainedFields] - æ¬²ä¿çå°ç»æç©ºé´æ°æ®ä¸­çå­æ®µéåï¼ç³»ç»å­æ®µé¤å¤ï¼ã
 * @usage
 */
class GenerateSpatialDataParameters {


    constructor(options) {
        /**
         * @member {string} GenerateSpatialDataParameters.prototype.routeTable
         * @description è·¯ç±æ°æ®éã
         */
        this.routeTable = null;

        /**
         * @member {string} GenerateSpatialDataParameters.prototype.routeIDField
         * @description è·¯ç±æ°æ®éçæ è¯å­æ®µã
         */
        this.routeIDField = null;
        /**
         * @member {string} [GenerateSpatialDataParameters.prototype.attributeFilter]
         * @description å±æ§è¿æ»¤æ¡ä»¶ã
         * å½ {@link GenerateSpatialDataParameters.prototype.dataReturnOption.dataReturnMode}  ä¸º {@link DataReturnMode.DATASET_AND_RECORDSET} æ {@link DataReturnMode.RECORDSET_ONLY} æ¶ææã
         */
        this.attributeFilter = null;
        /**
         * @member {string} GenerateSpatialDataParameters.prototype.eventTable
         * @description ç¨äºçæç©ºé´æ°æ®çäºä»¶è¡¨åã
         */
        this.eventTable = null;

        /**
         * @member {string} GenerateSpatialDataParameters.prototype.eventRouteIDField
         * @description ç¨äºçæç©ºé´æ°æ®çäºä»¶è¡¨çè·¯ç±æ è¯å­æ®µã
         */
        this.eventRouteIDField = null;

        /**
         * @member {string} [GenerateSpatialDataParameters.prototype.measureField]
         * @description ç¨äºçæç©ºé´æ°æ®çäºä»¶è¡¨çå»åº¦å­æ®µï¼åªæå½äºä»¶ä¸ºç¹äºä»¶çæ¶åè¯¥å±æ§æææä¹
         */
        this.measureField = null;

        /**
         * @member {string} [GenerateSpatialDataParameters.prototype.measureStartField]
         * @description ç¨äºçæç©ºé´æ°æ®çäºä»¶è¡¨çèµ·å§å»åº¦å­æ®µï¼åªæå½äºä»¶ä¸ºçº¿äºä»¶çæ¶åè¯¥å±æ§æææä¹ã
         */
        this.measureStartField = null;

        /**
         * @member {string} [GenerateSpatialDataParameters.prototype.measureEndField]
         * @description ç¨äºçæç©ºé´æ°æ®çäºä»¶è¡¨çç»æ­¢å»åº¦å­æ®µï¼åªæå½äºä»¶ä¸ºçº¿äºä»¶çæ¶åè¯¥å±æ§æææä¹ã
         */
        this.measureEndField = null;

        /**
         * @member {string} [GenerateSpatialDataParameters.prototype.measureOffsetField]
         * @description å»åº¦åç§»éå­æ®µã
         */
        this.measureOffsetField = null;

        /**
         * @member {string} [GenerateSpatialDataParameters.prototype.errorInfoField]
         * @description éè¯¯ä¿¡æ¯å­æ®µï¼ç´æ¥åå¥åäºä»¶è¡¨ï¼ç¨äºæè¿°äºä»¶æªè½çæå¯¹åºçç¹æçº¿æ¶çéè¯¯ä¿¡æ¯ã
         */
        this.errorInfoField = null;

        /**
         * @member {Array.<string>} [GenerateSpatialDataParameters.prototype.retainedFields]
         * @description æ¬²ä¿çå°ç»æç©ºé´æ°æ®ä¸­çå­æ®µéåï¼ç³»ç»å­æ®µé¤å¤ï¼ã
         * çæç©ºé´æ°æ®æ¶ï¼æ è®ºæ¯å¦æå®ä¿çå­æ®µï¼è·¯ç± ID å­æ®µãå»åº¦åç§»éå­æ®µãå»åº¦å¼å­æ®µï¼ç¹äºä»¶ä¸ºå»åº¦å­æ®µï¼çº¿äºä»¶æ¯èµ·å§åç»æ­¢å»åº¦å­æ®µï¼é½ä¼ä¿çå°ç»æç©ºé´æ°æ®ä¸­ï¼
         * å¦ææ²¡ææå® retainedFields åæ°æè retainedFields åæ°æ°ç»é¿åº¦ä¸º 0ï¼åè¿åææç¨æ·å­æ®µã
         */
        this.retainedFields = null;

        /**
         * @member {DataReturnOption} GenerateSpatialDataParameters.prototype.dataReturnOption
         * @description è®¾ç½®æ°æ®è¿åçéé¡¹ã
         */
        this.dataReturnOption = null;
        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = "SuperMap.GenerateSpatialDataParameters";
    }


    /**
     * @function GenerateSpatialDataParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        if (me.routeTable) {
            me.routeTable = null;
        }
        me.routeIDField = null;
        me.attributeFilter = null;
        me.eventTable = null;
        me.eventRouteIDField = null;
        me.measureField = null;
        me.measureStartField = null;
        me.measureEndField = null;
        me.measureOffsetField = null;
        me.errorInfoField = null;
        if (me.dataReturnOption) {
            me.dataReturnOption.destroy();
            me.dataReturnOption = null;
        }
    }


}

;// CONCATENATED MODULE: ./src/common/iServer/GenerateSpatialDataService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class GenerateSpatialDataService
 * @deprecatedclass SuperMap.GenerateSpatialDataService
 * @category iServer SpatialAnalyst GenerateSpatialData
 * @classdesc å¨æåæ®µåææå¡ç±»ãè¯¥ç±»è´è´£å°å®¢æ·è®¾ç½®çå¨æåæ®µåææå¡åæ°ä¼ éç»æå¡ç«¯ï¼å¹¶æ¥æ¶æå¡ç«¯è¿åçå¨æåæ®µåæç»ææ°æ®ã
 * è·åçç»ææ°æ®åæ¬ originResult ãresult ä¸¤ç§ï¼å¶ä¸­ï¼originResult ä¸ºæå¡ç«¯è¿åçç¨ JSON å¯¹è±¡è¡¨ç¤ºçå¨æåæ®µåæç»ææ°æ®ï¼result ä¸ºæå¡ç«¯è¿åçå¨æåæ®µåæç»ææ°æ®ã
 * @param {string} url - æå¡å°åãå¦ http://localhost:8090/iserver/services/spatialanalyst-changchun/restjsr/spatialanalystã
 * @param {Object} options - åæ°ã</br>
 * @param {Object} options.eventListeners - éè¦è¢«æ³¨åççå¬å¨å¯¹è±¡ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @extends {SpatialAnalystBase}
 * @example å®ä¾åè¯¥ç±»å¦ä¸ä¾æç¤ºï¼
 * (start code)
 *  function GenerateSpatialData(){
     *
     *  //éç½®æ°æ®è¿åéé¡¹(option)
     *  var option = new DataReturnOption({
     *      expectCount: 1000,
     *      dataset: "generateSpatialData",
     *      deleteExistResultDataset: true,
     *      dataReturnMode: DataReturnMode.DATASET_ONLY
     *  }),
     *  //éç½®å¨æåæ®µåæ°(Parameters)
     *  parameters = new GenerateSpatialDataParameters({
     *      routeTable: "RouteDT_road@Changchun",
     *      routeIDField: "RouteID",
     *      eventTable: "LinearEventTabDT@Changchun",
     *      eventRouteIDField: "RouteID",
     *      measureField: "",
     *      measureStartField: "LineMeasureFrom",
     *      measureEndField: "LineMeasureTo",
     *      measureOffsetField: "",
     *      errorInfoField: "",
     *      retainedFields:[],
     *      dataReturnOption: option
     *  }),
     *  //éç½®å¨æåæ®µiService
     *  iService = new GenerateSpatialDataService(Changchun_spatialanalyst, {
     *      eventListeners: {
     *          processCompleted: generateCompleted,
     *          processFailed: generateFailded
     *      }
     *  });
     *  //æ§è¡
     *  iService.processAsync(parameters);
     *  function Completed(generateSpatialDataEventArgs){//todo};
     *  function Error(generateSpatialDataEventArgs){//todo};
     * (end)
     * @usage
     */
class GenerateSpatialDataService extends SpatialAnalystBase {

    constructor(url, options) {
        super(url, options);

        this.CLASS_NAME = "SuperMap.GenerateSpatialDataService";
    }

    /**
     * @function GenerateSpatialDataService.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
    }


    /**
     * @function GenerateSpatialDataService.prototype.processAsync
     * @description è´è´£å°å®¢æ·ç«¯çå¨æåæ®µæå¡åæ°ä¼ éå°æå¡ç«¯ã
     * @param {GenerateSpatialDataParameters} params - å¨æåæ®µæä½åæ°ç±»ã
     */
    processAsync(params) {
        if (!(params instanceof GenerateSpatialDataParameters)) {
            return;
        }
        var me = this,
            jsonParameters;

        jsonParameters = me.getJsonParameters(params);

        me.request({
            method: "POST",
            data: jsonParameters,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }


    /**
     * @function GenerateSpatialDataService.prototype.getJsonParameters
     * @description å°åæ°è½¬åä¸º JSON å­ç¬¦ä¸²ã
     * @param {GenerateSpatialDataParameters} params - å¨æåæ®µæä½åæ°ç±»ã
     * @returns {string}è½¬ååçJSONå­ç¬¦ä¸²ã
     */
    getJsonParameters(params) {
        var jsonParameters = "",
            jsonStr = "datasets/" + params.routeTable + "/linearreferencing/generatespatialdata",
            me = this;

        me.url = Util.urlPathAppend(me.url, jsonStr);
        me.url = Util.urlAppend(me.url, 'returnContent=true');
        jsonParameters = Util.toJSON(params);
        return jsonParameters;
    }


}

;// CONCATENATED MODULE: ./src/common/iServer/GeoHashGridAggParameter.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class GeoHashGridAggParameter
 * @deprecatedclass SuperMap.GeoHashGridAggParameter
 * @classdesc æ ¼ç½èåæ¥è¯¢åæ°ç±»ï¼è¯¥åæ°ä»æ¯ææ°æ®æ¥æº Elasticsearch æå¡çSupermap iServerçrestæ°æ®æå¡ã
 * @category iServer Data FeatureResults
 * @param {Object} options - å¯éåæ°ã
 * @param {number} [options.precision=5] - ç²¾åº¦ã
 * @extends {BucketAggParameter}
 * @usage
 */
class GeoHashGridAggParameter extends BucketAggParameter {
    constructor(options) {
        super();
        /**
         * @member {number} [GeoHashGridAggParameter.prototype.precision=5]
         * @description ç½æ ¼ä¸­æ°å­çç²¾åº¦ã
         */
        this.precision = 5;
        Util.extend(this, options);
        /**
         * @member {BucketAggType} [GeoHashGridAggParameter.prototype.aggType=BucketAggType.GEOHASH_GRID]
         * @description æ ¼ç½èåç±»åã
         */
        this.aggType = BucketAggType.GEOHASH_GRID;

        this.CLASS_NAME = 'SuperMap.GeoHashGridAggParameter';
    }

    destroy() {
        super.destroy();
        this.aggType = null;
        this.precision = null;
    }

    /**
     * @function GeoHashGridAggParameter.toJsonParameters
     * @description å°å¯¹è±¡è½¬ä¸º JSON æ ¼å¼ã
     * @param param è½¬æ¢å¯¹è±¡ã
     * @returns {Object}
     */
    static toJsonParameters(param) {
        var parameters = {
            aggName: param.aggName,
            aggFieldName: param.aggFieldName,
            aggType: param.aggType,
            precision: param.precision
        };
        return Util.toJson(parameters);
    }
}


;// CONCATENATED MODULE: ./src/common/iServer/GeometryOverlayAnalystParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class GeometryOverlayAnalystParameters
 * @deprecatedclass SuperMap.GeometryOverlayAnalystParameters
 * @category  iServer SpatialAnalyst OverlayAnalyst
 * @classdesc
 * å ä½å¯¹è±¡å å åæåæ°ç±»ãå¯¹æå®çæä¸¤ä¸ªå ä½å¯¹è±¡åå å åæãéè¿è¯¥ç±»å¯ä»¥æå®è¦åå å åæçå ä½å¯¹è±¡ãå å æä½ç±»åã
 * @param {Object} options - åæ°ã
 * @param {GeoJSONObject} options.operateGeometry - å å åæçæä½å ä½å¯¹è±¡ã<br>
 * ç¹ç±»åå¯ä»¥æ¯ï¼{@link GeometryPoint}|{@link L.Marker}|{@link L.CircleMarker}|{@link L.Circle}|{@link L.GeoJSON}|{@link ol.geom.Point}|{@link ol.format.GeoJSON}|{@link GeoJSONObject}ã<br>
 * çº¿ç±»åå¯ä»¥æ¯ï¼{@link GeometryLineString}|{@link GeometryLinearRing}|{@link L.Polyline}|{@link L.GeoJSON}|{@link ol.geom.LineString}|{@link GeoJSONObject}ã<br>
 * é¢ç±»åå¯ä»¥æ¯ï¼{@link GeometryPolygon}|{@link L.Polygon}|{@link L.GeoJSON}|{@link ol.geom.Polygon}|{@link GeoJSONObject}ã<br>
 * @param {GeoJSONObject} options.sourceGeometry - å å åæçæºå ä½å¯¹è±¡ã
 * @param {Array.<GeoJSONFeature>} [options.operateGeometries] - æ¹éå å åæçæä½å ä½å¯¹è±¡æ°ç»ã
 * @param {Array.<GeoJSONFeature>} [options.sourceGeometries] -æ¹éå å åæçæºå ä½å¯¹è±¡æ°ç»ã
 * @param {OverlayOperationType} [options.operation] - å å æä½æä¸¾å¼ã
 * @extends {OverlayAnalystParameters}
 * @usage
 */
class GeometryOverlayAnalystParameters extends OverlayAnalystParameters {

    constructor(options) {
        super(options);
        if (options && options.operateGeometry) {
            this.operateGeometry = options.operateGeometry;
        }
        if (options && options.sourceGeometry) {
            this.sourceGeometry = options.sourceGeometry;
        }
        if (options && options.operateGeometries) {
            this.operateGeometries = options.operateGeometries;
        }
        if (options && options.sourceGeometries) {
            this.sourceGeometries = options.sourceGeometries;
        }

        if (options) {
            Util.extend(this, options);
        }
        this.CLASS_NAME = "SuperMap.GeometryOverlayAnalystParameters";
    }

    /**
     * @function GeometryOverlayAnalystParameters.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
        var me = this;
        if (me.sourceGeometry) {
            me.sourceGeometry.destroy();
            me.sourceGeometry = null;
        }

        if (me.sourceGeometries) {
            me.sourceGeometries.destroy();
            me.sourceGeometries = null;
        }
        if (me.sourceGeometry) {
            me.sourceGeometry.destroy();
            me.sourceGeometry = null;
        }

        if (me.operateGeometries) {
            me.operateGeometries.destroy();
            me.operateGeometries = null;
        }
    }

    /**
     * @function GeometryOverlayAnalystParameters.toObject
     * @param {GeometryOverlayAnalystParameters} geometryOverlayAnalystParameters - å ä½å¯¹è±¡å å åæåæ°ç±»ã
     * @param {GeometryOverlayAnalystParameters} tempObj - å ä½å¯¹è±¡å å åæåæ°å¯¹è±¡ã
     * @description å°å ä½å¯¹è±¡å å åæåæ°å¯¹è±¡è½¬æ¢ä¸º JSON å¯¹è±¡ã
     * @returns {Object} JSON å¯¹è±¡ã
     */
    static toObject(geometryOverlayAnalystParameters, tempObj) {
        for (var name in geometryOverlayAnalystParameters) {
            if (name === "sourceGeometry") {
                tempObj.sourceGeometry = ServerGeometry.fromGeometry(geometryOverlayAnalystParameters.sourceGeometry);

            } else if (name === "sourceGeometries") {
                var sourceGeometries = [];
                for (var i = 0; i < geometryOverlayAnalystParameters.sourceGeometries.length; i++) {
                    sourceGeometries.push(ServerGeometry.fromGeometry(geometryOverlayAnalystParameters.sourceGeometries[i]));
                }
                tempObj.sourceGeometries = sourceGeometries;

            } else if (name === "operateGeometry") {
                tempObj.operateGeometry = ServerGeometry.fromGeometry(geometryOverlayAnalystParameters.operateGeometry);

            } else if (name === "operateGeometries") {
                var operateGeometries = [];
                for (var j = 0; j < geometryOverlayAnalystParameters.operateGeometries.length; j++) {
                    operateGeometries.push(ServerGeometry.fromGeometry(geometryOverlayAnalystParameters.operateGeometries[j]));
                }
                tempObj.operateGeometries = operateGeometries;

            } else {
                tempObj[name] = geometryOverlayAnalystParameters[name];
            }
        }
    }
}

;// CONCATENATED MODULE: ./src/common/iServer/GeometrySurfaceAnalystParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class GeometrySurfaceAnalystParameters
 * @deprecatedclass SuperMap.GeometrySurfaceAnalystParameters
 * @category  iServer SpatialAnalyst SurfaceAnalyst
 * @classdesc å ä½å¯¹è±¡è¡¨é¢åæåæ°ç±»ãè¯¥ç±»å¯¹å ä½å¯¹è±¡è¡¨é¢åææç¨å°çåæ°è¿è¡è®¾ç½®ã
 * @param {Object} options - åæ°ã
 * @param {Array.<GeometryPoint|L.LatLng|L.Point|ol.geom.Point|mapboxgl.LngLat|Array.<number>>} options.points - è¡¨é¢åæçåæ ç¹æ°ç»ã
 * @param {Array.<number>} options.zValues - è¡¨é¢åæçåæ ç¹ç Z å¼æ°ç»ã
 * @param {number} [options.resolution] - è·åæè®¾ç½®æå®ä¸­é´ç»æï¼æ æ ¼æ°æ®éï¼çåè¾¨çã
 * @param {DataReturnOption} [options.resultSetting] - ç»æè¿åè®¾ç½®ç±»ã
 * @param {SurfaceAnalystParametersSetting} options.extractParameter - è·åæè®¾ç½®è¡¨é¢åæåæ°ã
 * @param {SurfaceAnalystMethod} [options.surfaceAnalystMethod = SurfaceAnalystMethod.ISOLINE] - è·åæè®¾ç½®è¡¨é¢åæçæåæ¹æ³ï¼æåç­å¼çº¿åæåç­å¼é¢ã
 * @extends {SurfaceAnalystParameters}
 * @usage
 */
class GeometrySurfaceAnalystParameters extends SurfaceAnalystParameters {


    constructor(options) {
        super(options);
        /**
         * @member {Array.<GeometryPoint|L.LatLng|L.Point|ol.geom.Point|mapboxgl.LngLat|Array.<number>>} GeometrySurfaceAnalystParameters.prototype.points
         * @description è·åæè®¾ç½®ç¨äºè¡¨é¢åæçåæ ç¹æ°ç»ã
         */
        this.points = null;

        /**
         * @member {Array.<number>} GeometrySurfaceAnalystParameters.prototype.zValues
         * @description è·åæè®¾ç½®ç¨äºæåæä½çå¼ãæåç­å¼çº¿æ¶ï¼å°ä½¿ç¨è¯¥æ°ç»ä¸­çå¼ï¼
         * å¯¹å ä½å¯¹è±¡ä¸­çåæ ç¹æ°ç»è¿è¡æå¼åæï¼å¾å°æ æ ¼æ°æ®éï¼ä¸­é´ç»æï¼ï¼æ¥çä»æ æ ¼æ°æ®éæåç­å¼çº¿ã
         */
        this.zValues = null;
        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = "SuperMap.GeometrySurfaceAnalystParameters";
    }

    /**
     * @function GeometrySurfaceAnalystParameters.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
        var me = this;
        if (me.points) {
            for (var i = 0, points = me.points, len = points.length; i < len; i++) {
                points[i].destroy();
            }
            me.points = null;
        }
        me.zValues = null;
    }

}


;// CONCATENATED MODULE: ./src/common/iServer/GeometryThiessenAnalystParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class GeometryThiessenAnalystParameters
 * @deprecatedclass SuperMap.GeometryThiessenAnalystParameters
 * @constructs GeometryThiessenAnalystParameters
 * @category iServer SpatialAnalyst ThiessenPolygonAnalyst
 * @classdesc å ä½å¯¹è±¡æ³°æ£®å¤è¾¹å½¢åæåæ°ç±»ãå¯¹æå®çæä¸ªå ä½å¯¹è±¡åæ³°æ£®å¤è¾¹å½¢åæãéè¿è¯¥ç±»å¯ä»¥æå®è¦åæ³°æ£®å¤è¾¹å½¢åæçå ä½å¯¹è±¡ãè¿åæ°æ®éåç§°ç­ã
 * @param {Object} options - åæ°ã
 * @param {Array.<GeometryPoint|L.LatLng|L.Point|ol.geom.Point|mapboxgl.LngLat|Array.<number>>} options.points - ä½¿ç¨ç¹æ°ç»è¿è¡åææ¶ä½¿ç¨çå ä½å¯¹è±¡ã
 * @extends {ThiessenAnalystParameters}
 * @usage
 */

class GeometryThiessenAnalystParameters extends ThiessenAnalystParameters {


    constructor(options) {
        super(options);
        /**
         * @member {Array.<GeometryPoint|L.LatLng|L.Point|ol.geom.Point|mapboxgl.LngLat|Array.<number>>} GeometryThiessenAnalystParameters.prototype.points
         * @description ä½¿ç¨ç¹æ°ç»è¿è¡åææ¶ä½¿ç¨çå ä½å¯¹è±¡ã
         */
        this.points = null;
        if (options) {
            Util.extend(this, options);
        }
        this.CLASS_NAME = "SuperMap.GeometryThiessenAnalystParameters";
    }

    /**
     * @function GeometryThiessenAnalystParameters.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
        var me = this;
        if (me.points) {
            for (var i = me.points.length - 1; i >= 0; i--) {
                me.points[i].destroy();
            }
            me.points = null;
        }
    }

    /**
     * @function GeometryThiessenAnalystParameters.toObject
     * @param {GeometryThiessenAnalystParameters} geometryThiessenAnalystParameters - å ä½å¯¹è±¡æ³°æ£®å¤è¾¹å½¢åæåæ°ç±»ã
     * @param {GeometryThiessenAnalystParameters} tempObj - å ä½å¯¹è±¡æ³°æ£®å¤è¾¹å½¢åæåæ°å¯¹è±¡ã
     * @description å°å ä½å¯¹è±¡æ³°æ£®å¤è¾¹å½¢åæåæ°å¯¹è±¡è½¬æ¢ä¸º JSON å¯¹è±¡ã
     * @returns {Object} JSON å¯¹è±¡ã
     */
    static toObject(geometryThiessenAnalystParameters, tempObj) {
        for (var name in geometryThiessenAnalystParameters) {
            if (name === "clipRegion") {
                tempObj.clipRegion = ServerGeometry.fromGeometry(geometryThiessenAnalystParameters.clipRegion);
            } else {
                tempObj[name] = geometryThiessenAnalystParameters[name];
            }
        }
    }


}

;// CONCATENATED MODULE: ./src/common/iServer/GeoprocessingService.js


/**
 * @class GeoprocessingService
 * @deprecatedclass SuperMap.GeoprocessingService
 * @category  iServer ProcessingAutomationService
 * @classdesc å¤çèªå¨åæå¡æ¥å£çåºç±»ã
 * @version 10.1.0
 * @extends {CommonServiceBase}
 * @param {string} url - æå¡å°åã
 * @param {Object} options - åæ°ã
 * @param {Events} options.events - å¤çææäºä»¶çå¯¹è±¡ã
 * @param {Object} [options.eventListeners] - äºä»¶çå¬å¨å¯¹è±¡ãæ processCompleted å±æ§å¯ä¼ å¥å¤çå®æåçåè°å½æ°ãprocessFailed å±æ§ä¼ å¥å¤çå¤±è´¥åçåè°å½æ°ã
 * @usage
 */
class GeoprocessingService_GeoprocessingService extends CommonServiceBase {
    constructor(url, options) {
        options = options || {};
        options.EVENT_TYPES = ['processCompleted', 'processFailed', 'processRunning'];
        super(url, options);
        this.CLASS_NAME = 'SuperMap.GeoprocessingService';
        this.headers = {};
        this.crossOrigin = true;
    }
    /**
     * @function GeoprocessingService.prototype.getTools
     * @description è·åå¤çèªå¨åå·¥å·åè¡¨ã
     */
    getTools() {
        this._get(`${this.url}/list`);
    }
    /**
     * @function GeoprocessingService.prototype.getTool
     * @description è·åå¤çèªå¨åå·¥å·çIDãåç§°ãæè¿°ãè¾å¥åæ°ãç¯å¢åæ°åè¾åºç»æç­ç¸å³åæ°ã
     * @param {string} identifier - å¤çèªå¨åå·¥å·IDã
     */
    getTool(identifier) {
        this._get(`${this.url}/${identifier}`);
    }
    /**
     * @function GeoprocessingService.prototype.execute
     * @description åæ­¥æ§è¡å¤çèªå¨åå·¥å·ã
     * @param {string} identifier - å¤çèªå¨åå·¥å·IDã
     * @param {Object} parameter - å¤çèªå¨åå·¥å·çè¾å¥åæ°ã
     * @param {Object} environment - å¤çèªå¨åå·¥å·çç¯å¢åæ°ã
     */
    execute(identifier, parameter, environment) {
        parameter = parameter ? parameter : null;
        environment = environment ? environment : null;
        const executeParamter = { parameter, environment };
        this._get(`${this.url}/${identifier}/execute`, executeParamter);
    }
    /**
     * @function GeoprocessingService.prototype.submitJob
     * @description å¼æ­¥æ§è¡å¤çèªå¨åå·¥å·ã
     * @param {string} identifier - å¤çèªå¨åå·¥å·IDã
     * @param {Object} parameter - å¤çèªå¨åå·¥å·çè¾å¥åæ°ã
     * @param {Object} environments - å¤çèªå¨åå·¥å·çç¯å¢åæ°ã
     */
    submitJob(identifier, parameter, environments) {
        parameter = parameter ? parameter : null;
        environments = environments ? environments : null;
        const asyncParamter = { parameter: parameter, environments: environments };
        this.request({
            url: `${this.url}/${identifier}/jobs`,
            headers: { 'Content-type': 'application/json' },
            method: 'POST',
            data: JSON.stringify(asyncParamter),
            scope: this,
            success: this.serviceProcessCompleted,
            failure: this.serviceProcessFailed
        });
    }

    /**
     * @function GeoprocessingService.prototype.waitForJobCompletion
     * @description è·åå¤çèªå¨åå¼æ­¥æ§è¡ç¶æä¿¡æ¯ã
     * @param {string} jobId - å¤çèªå¨åä»»å¡IDã
     * @param {string} identifier - å¤çèªå¨åå·¥å·IDã
     * @param {Object} options - ç¶æä¿¡æ¯åæ°ã
     * @param {number} options.interval - å®æ¶å¨æ¶é´é´éã
     * @param {function} options.statusCallback - ä»»å¡ç¶æçåè°å½æ°ã
     */
    waitForJobCompletion(jobId, identifier, options) {
        const me = this;
        const timer = setInterval(function () {
            const serviceProcessCompleted = function (serverResult) {
                const state = serverResult.state.runState;
                if (options.statusCallback) {
                    options.statusCallback(state);
                }
                switch (state) {
                    case 'FINISHED':
                        clearInterval(timer);
                        me.events.triggerEvent('processCompleted', {
                            result: serverResult
                        });
                        break;
                    case 'FAILED':
                        clearInterval(timer);
                        me.events.triggerEvent('processFailed', {
                            result: serverResult
                        });
                        break;
                    case 'CANCELED':
                        clearInterval(timer);
                        me.events.triggerEvent('processFailed', {
                            result: serverResult
                        });
                        break;
                }
            };
            me._get(`${me.url}/${identifier}/jobs/${jobId}`, null, serviceProcessCompleted);
        }, options.interval);
    }

    /**
     * @function GeoprocessingService.prototype.getJobInfo
     * @description è·åå¤çèªå¨åä»»å¡çæ§è¡ä¿¡æ¯ã
     * @param {string} identifier - å¤çèªå¨åå·¥å·IDã
     * @param {string} jobId - å¤çèªå¨åä»»å¡IDã
     */
    getJobInfo(identifier, jobId) {
        this._get(`${this.url}/${identifier}/jobs/${jobId}`);
    }

    /**
     * @function GeoprocessingService.prototype.cancelJob
     * @description åæ¶å¤çèªå¨åä»»å¡çå¼æ­¥æ§è¡ã
     * @param {string} identifier - å¤çèªå¨åå·¥å·IDã
     * @param {string} jobId - å¤çèªå¨åä»»å¡IDã
     */
    cancelJob(identifier, jobId) {
        this._get(`${this.url}/${identifier}/jobs/${jobId}/cancel`);
    }
    /**
     * @function GeoprocessingService.prototype.getJobs
     * @description è·åå¤çèªå¨åæå¡ä»»å¡åè¡¨ã
     * @param {string} identifier - å¤çèªå¨åå·¥å·IDã(ä¼ åä»£è¡¨identifierç®å­çä»»å¡åè¡¨ï¼ä¸ä¼ åä»£è¡¨ææä»»å¡çåè¡¨)
     */
    getJobs(identifier) {
        let url = `${this.url}/jobs`;
        if (identifier) {
            url = `${this.url}/${identifier}/jobs`;
        }
        this._get(url);
    }
    /**
     * @function GeoprocessingService.prototype.getResults
     * @description å¤çèªå¨åå·¥å·æ§è¡çç»æç­,æ¯æç»æè¿æ»¤ã
     * @param {string} identifier - å¤çèªå¨åå·¥å·IDã
     * @param {string} jobId - å¤çèªå¨åä»»å¡IDã
     * @param {string} filter - è¾åºå¼æ­¥ç»æçidã(å¯éï¼ä¼ å¥filteråæ°æ¶å¯¹è¯¥å¤çèªå¨åå·¥å·æ§è¡çç»æè¿è¡è¿æ»¤è·åï¼ä¸å¡«åæ¶æ¾ç¤ºææçæ§è¡ç»æ)
     */
    getResults(identifier, jobId, filter) {
        let url = `${this.url}/${identifier}/jobs/${jobId}/results`;
        if (filter) {
            url = `${url}/${filter}`;
        }
        this._get(url);
    }
    _get(url, paramter, serviceProcessCompleted, serviceProcessFailed) {
        this.request({
            url: url,
            method: 'GET',
            params: paramter,
            headers: { 'Content-type': 'application/json' },
            scope: this,
            success: serviceProcessCompleted ? serviceProcessCompleted : this.serviceProcessCompleted,
            failure: serviceProcessFailed ? serviceProcessFailed : this.serviceProcessFailed
        });
    }
}

;// CONCATENATED MODULE: ./src/common/iServer/GeoRelationAnalystParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class GeoRelationAnalystParameters
 * @deprecatedclass SuperMap.GeoRelationAnalystParameters
 * @category iServer SpatialAnalyst GeoRelationAnalyst
 * @classdesc ç©ºé´å³ç³»åææå¡åæ°ç±»ãä½¿ç¨è¯¥ç±»å¯ä»¥ä¸ºç©ºé´å³ç³»åææå¡æä¾æéçåæ°ä¿¡æ¯ã
 * @param {Object} options - åæ°ã
 * @param {FilterParameter} options.sourceFilter - ç©ºé´å³ç³»åæä¸­çæºæ°æ®éæ¥è¯¢åæ°ãä» name, ids, attributeFilter å fields å­æ®µææã
 * @param {FilterParameter} options.referenceFilter - ç©ºé´å³ç³»åæä¸­çåèæ°æ®éæ¥è¯¢åæ°ãä» name, ids, attributeFilter å fields å­æ®µææã
 * @param {SpatialRelationType} options.spatialRelationType - æå®çç©ºé´å³ç³»ç±»åã
 * @param {boolean} [options.isBorderInside] - è¾¹çå¤çæ¹å¼ï¼å³ä½äºé¢è¾¹çº¿ä¸çç¹æ¯å¦è¢«é¢åå«ãæ­¤åæ°ä»ç¨äºç©ºé´å³ç³»ä¸ºåå«æè¢«åå«çæåµã
 * @param {boolean} [options.returnFeature] - æ¯å¦è¿å Feature ä¿¡æ¯ã
 * @param {boolean} [options.returnGeoRelatedOnly=true] - ä»è¿åæ»¡è¶³æå®ç©ºé´å³ç³»çç©ºé´å¯¹è±¡ã
 * @param {number} [options.startRecord=0] - åæç»æèµ·å§è®°å½ä½ç½®ã
 * @param {number} [options.expectCount=500] - ç©ºé´å³ç³»åæææè¿åç»æè®°å½æ°ï¼å¦æå®éä¸è¶³500æ¡ç»æåè¿åææåæç»æã
 * @usage
 */
class GeoRelationAnalystParameters {


    constructor(options) {
        /**
         *  @member {string} GeoRelationAnalystParameters.prototype.dataset
         *  @description æºæ°æ®éåç§°ã
         */
        this.dataset = null;

        /**
         * @member {FilterParameter} GeoRelationAnalystParameters.prototype.sourceFilter
         * @description ç©ºé´å³ç³»åæä¸­çæºæ°æ®éæ¥è¯¢åæ°ãä» idsãattributeFilter å fields å­æ®µææã
         */
        this.sourceFilter = null;

        /**
         * @member {FilterParameter} GeoRelationAnalystParameters.prototype.referenceFilter
         * @description ç©ºé´å³ç³»åæä¸­çåèæ°æ®éæ¥è¯¢åæ°ãä» nameï¼idsï¼attributeFilter å fields å­æ®µææã
         */
        this.referenceFilter = null;

        /**
         * @member {SpatialRelationType} GeoRelationAnalystParameters.prototype.spatialRelationType
         * @description æå®çç©ºé´å³ç³»ç±»åã
         */
        this.spatialRelationType = null;

        /**
         * @member {boolean} [GeoRelationAnalystParameters.prototype.isBorderInside]
         * @description è¾¹çå¤çæ¹å¼ï¼å³ä½äºé¢è¾¹çº¿ä¸çç¹æ¯å¦è¢«é¢åå«ãæ­¤åæ°ä»ç¨äºç©ºé´å³ç³»ä¸ºåå«æè¢«åå«çæåµã
         */
        this.isBorderInside = null;

        /**
         * @member {boolean} [GeoRelationAnalystParameters.prototype.returnFeature]
         * @description æ¯å¦è¿å Feature ä¿¡æ¯ã
         */
        this.returnFeature = null;

        /**
         * @member {boolean} [GeoRelationAnalystParameters.prototype.returnGeoRelatedOnly=true]
         * @description æ¯å¦ä»è¿åæ»¡è¶³æå®ç©ºé´å³ç³»çç©ºé´å¯¹è±¡ã
         */
        this.returnGeoRelatedOnly = null;

        /**
         * @member {number} [GeoRelationAnalystParameters.prototype.returnGeoRelatedOnly=0]
         * @description åæç»æèµ·å§è®°å½ä½ç½®ã
         */
        this.startRecord = 0;

        /**
         * @member {number} [GeoRelationAnalystParameters.prototype.expectCount=500]
         * @description ç©ºé´å³ç³»åæææè¿åç»æè®°å½æ°ï¼å¦æå®éä¸è¶³ 500 æ¡ç»æåè¿åææåæç»æã
         */
        this.expectCount = 500;
        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = "SuperMap.GeoRelationAnalystParameters";
    }

    /**
     * @function GeoRelationAnalystParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        if (me.sourceFilter) {
            me.sourceFilter.destroy();
        }
        me.sourceFilter = null;

        if (me.referenceFilter) {
            me.referenceFilter.destroy();
        }
        me.referenceFilter = null;

        me.dataset = null;
        me.spatialRelationType = null;
        me.isBorderInside = null;
        me.returnFeature = null;
        me.returnGeoRelatedOnly = null;
        me.startRecord = null;
        me.expectCount = null;
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/GeoRelationAnalystService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class GeoRelationAnalystService
 * @deprecatedclass SuperMap.GeoRelationAnalystService
 * @category iServer SpatialAnalyst GeoRelationAnalyst
 * @classdesc ç©ºé´å³ç³»åææå¡ç±»ãè¯¥ç±»è´è´£å°å®¢æ·è®¾ç½®çç©ºé´å³ç³»åææå¡åæ°ä¼ éç»æå¡ç«¯ï¼å¹¶æ¥æ¶æå¡ç«¯è¿åçç©ºé´å³ç³»åæç»ææ°æ®ã
 * @param {string} url - æå¡å°åãå¦ http://localhost:8090/iserver/services/spatialanalyst-changchun/restjsr/spatialanalystã
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - éè¦è¢«æ³¨åççå¬å¨å¯¹è±¡ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @extends {SpatialAnalystBase}
 * @example å®ä¾åè¯¥ç±»å¦ä¸ä¾æç¤ºï¼
 * (start code)
 *  function datasetGeoRelationAnalystProcess() {
     *      var referenceFilter = new FilterParameter({
     *                              name:"Frame_R@Changchun",
     *                              attributeFilter:"SmID>0"});
     *      var sourceFilter = new FilterParameter({
     *                          attributeFilter:"SmID>0"});
     *      //åå§åæå¡ç±»
     *      var datasetGeoRelationService = new GeoRelationAnalystService(
     *          "http://localhost:8090/iserver/services/spatialanalyst-changchun/restjsr/spatialanalyst/"),
     *      //æå»ºåæ°ç±»
     *      datasetGeoRelationParameters = new GeoRelationAnalystParameters({
     *          dataset: "Park@Changchun",
     *          startRecord: 0,
     *          expectCount: 20,
     *          sourceFilter: sourceFilter,
     *          referenceFilter: referenceFilter,
     *          spatialRelationType: SpatialRelationType.INTERSECT,
     *          isBorderInside: true,
     *          returnFeature: true,
     *          returnGeoRelatedOnly: true
     *      });
     *      datasetGeoRelationService.events.on({
     *          "processCompleted": datasetGeoRelationAnalystCompleted,
     *          "processFailed": datasetGeoRelationAnalystFailed});
     *      //æ§è¡
     *      datasetGeoRelationService.processAsync(datasetGeoRelationParameters);
     *  }
 *  function Completed(datasetGeoRelationAnalystCompleted){//todo};
 *  function Error(datasetGeoRelationAnalystFailed){//todo};
 * (end)
 * @usage
 */
class GeoRelationAnalystService extends SpatialAnalystBase {

    constructor(url, options) {
        super(url, options);
        this.CLASS_NAME = "SuperMap.GeoRelationAnalystService";
    }

    /**
     * @function GeoRelationAnalystService.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function GeoRelationAnalystService.prototype.processAsync
     * @description è´è´£å°å®¢æ·ç«¯çç©ºé´å³ç³»åæåæ°ä¼ éå°æå¡ç«¯
     * @param {GeoRelationAnalystParameters} parameter - ç©ºé´å³ç³»åææéçåæ°ä¿¡æ¯ã
     */
    processAsync(parameter) {
        if (!(parameter instanceof GeoRelationAnalystParameters)) {
            return;
        }
        var me = this;
        me.url = Util.urlPathAppend(me.url, 'datasets/' + parameter.dataset + '/georelation');
        var jsonParameters = Util.toJSON(parameter);

        me.url = Util.urlAppend(me.url, 'returnContent=true');

        me.request({
            method: "POST",
            data: jsonParameters,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }


}

;// CONCATENATED MODULE: ./src/common/iServer/DatasetService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class DatasetService
 * @deprecatedclass SuperMap.DatasetService
 * @category iServer Data Dataset
 * @classdesc æ°æ®éæ¥è¯¢æå¡ã
 * @param {string} url - æå¡çè®¿é®å°åãå¦è®¿é®World Dataæå¡ï¼åªéå°urlè®¾ä¸ºï¼http://localhost:8090/iserver/services/data-world/rest/data å³å¯ã
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - äºä»¶çå¬å¨å¯¹è±¡ãæprocessCompletedå±æ§å¯ä¼ å¥å¤çå®æåçåè°å½æ°ãprocessFailedå±æ§ä¼ å¥å¤çå¤±è´¥åçåè°å½æ°ã
 * @param {DataFormat} [options.format=DataFormat.GEOJSON] - æ¥è¯¢ç»æè¿åæ ¼å¼ï¼ç®åæ¯æ iServerJSON å GeoJSON ä¸¤ç§æ ¼å¼ãåæ°æ ¼å¼ä¸º "ISERVER"ï¼"GEOJSON"ã
 * @param {string}options.datasource - æ°æ®æºåç§°ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class DatasetService_DatasetService extends CommonServiceBase {

    constructor(url, options) {
        super(url, options);
        if(!options){
            return;
        }
        /**
         * @member {string} DatasetService.prototype.datasource
         * @description è¦æ¥è¯¢çæ°æ®éæå¨çæ°æ®æºåç§°ã
         */
        this.datasource = null;

        /**
         *  @member {string} DatasetService.prototype.dataset
         *  @description è¦æ¥è¯¢çæ°æ®éåç§°ã
         */
        this.dataset = null;

        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = "SuperMap.DatasetService";
    }

    /**
     * @function DatasetService.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
        var me = this;
        me.datasource = null;
        me.dataset = null;
    }

    /**
     * @function DatasetService.prototype.getDatasetsService
     * @description æ§è¡æå¡ï¼æ¥è¯¢æ°æ®éæå¡ã
     */
    getDatasetsService(params) {
        var me = this;
        me.url = Util.urlPathAppend(me.url,`datasources/name/${params}/datasets`);
        me.request({
            method: "GET",
            data: null,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }

    /**
     * @function DatasetService.prototype.getDatasetService
     * @description æ§è¡æå¡ï¼æ¥è¯¢æ°æ®éä¿¡æ¯æå¡ã
     */
    getDatasetService(datasourceName, datasetName) {
        var me = this;
        me.url = Util.urlPathAppend(me.url,`datasources/name/${datasourceName}/datasets/name/${datasetName}`);
        me.request({
            method: "GET",
            data: null,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }

    /**
     * @function DatasetService.prototype.setDatasetService
     * @description æ§è¡æå¡ï¼æ´æ¹æ°æ®éä¿¡æ¯æå¡ã
     */
    setDatasetService(params) {
        if (!params) {
            return;
        }
        var me = this;
        var jsonParamsStr = Util.toJSON(params);
        me.request({
            method: "PUT",
            data: jsonParamsStr,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }

     /**
     * @function DatasetService.prototype.deleteDatasetService
     * @description æ§è¡æå¡ï¼å é¤æ°æ®éä¿¡æ¯æå¡ã
     */
    deleteDatasetService() {
        var me = this;
        me.request({
            method: "DELETE",
            data: null,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/GetFeaturesParametersBase.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class GetFeaturesParametersBase
 * @deprecatedclass SuperMap.GetFeaturesParametersBase
 * @category  iServer Data FeatureResults
 * @classdesc è¦ç´ æ¥è¯¢åæ°åºç±»ã
 * @param {Object} options - åæ°ã
 * @param {Array.<string>} options.datasetNames - æ°æ®éåç§°åè¡¨ã
 * @param {boolean} [options.returnContent=true] - æ¯å¦ç´æ¥è¿åæ¥è¯¢ç»æã
 * @param {number} [options.fromIndex=0] - æ¥è¯¢ç»æçæå°ç´¢å¼å·ã
 * @param {number} [options.toIndex=19] - æ¥è¯¢ç»æçæå¤§ç´¢å¼å·ã
 * @param {string|number} [options.targetEpsgCode] - å¨ææå½±çç®æ åæ ç³»å¯¹åºç EPSG Codeï¼ä½¿ç¨æ­¤åæ°æ¶ï¼returnContent åæ°éä¸º trueã
 * @param {Object} [options.targetPrj] - å¨ææå½±çç®æ åæ ç³»ãä½¿ç¨æ­¤åæ°æ¶ï¼returnContent åæ°éä¸º trueã å¦ï¼prjCoordSys={"epsgCode":3857}ãå½åæ¶è®¾ç½® targetEpsgCode åæ°æ¶ï¼æ­¤åæ°ä¸çæã
 * @param {MetricsAggParameter|GeoHashGridAggParameter} [options.aggregations] - èåæ¥è¯¢åæ°ãè¯¥åæ°ä»æ¯ææ°æ®æ¥æº Elasticsearch æå¡çSupermap iServerçrestæ°æ®æå¡ã
 * @usage
 */
class GetFeaturesParametersBase {
    constructor(options) {
        /**
         * @member {Array.<string>} GetFeaturesParametersBase.prototype.datasetName
         * @description æ°æ®ééåä¸­çæ°æ®éåç§°åè¡¨ã
         */
        this.datasetNames = null;

        /**
         * @member {string} GetFeaturesParametersBase.prototype.targetEpsgCode
         * @description å¨ææå½±çç®æ åæ ç³»å¯¹åºç EPSG Codeï¼ä½¿ç¨æ¶éè®¾ç½® returnContent åæ°ä¸º trueã
         */
        this.targetEpsgCode = null;

        /**
         * @member {Object} GetFeaturesParametersBase.prototype.targetPrj
         * @description å¨ææå½±çç®æ åæ ç³»ãä½¿ç¨æ¶éè®¾ç½® returnContent åæ°ä¸º trueã å¦ï¼prjCoordSys={"epsgCode":3857}ãå½åæ¶è®¾ç½® targetEpsgCode åæ°æ¶ï¼æ­¤åæ°ä¸çæã
         */
        this.targetPrj = null;

        /**
         * @member {boolean} [GetFeaturesParametersBase.prototype.returnContent=true]
         * @description æ¯å¦ç«å³è¿åæ°åå»ºèµæºçè¡¨è¿°è¿æ¯è¿åæ°èµæºç URIã
         *              å¦æä¸º trueï¼åç´æ¥è¿åæ°åå»ºèµæºï¼å³æ¥è¯¢ç»æçè¡¨è¿°ã
         *              å¦æä¸º falseï¼åè¿åçæ¯æ¥è¯¢ç»æèµæºç URIã
         */
        this.returnContent = true;

        /**
         * @member {number} [GetFeaturesParametersBase.prototype.fromIndex=0]
         * @description æ¥è¯¢ç»æçæå°ç´¢å¼å·ãå¦æè¯¥å¼å¤§äºæ¥è¯¢ç»æçæå¤§ç´¢å¼å·ï¼åæ¥è¯¢ç»æä¸ºç©ºã
         */
        this.fromIndex = 0;

        /**
         * @member {number} [GetFeaturesParametersBase.prototype.toIndex=19]
         * @description æ¥è¯¢ç»æçæå¤§ç´¢å¼å·ãå¦æè¯¥å¼å¤§äºæ¥è¯¢ç»æçæå¤§ç´¢å¼å·ï¼åä»¥æ¥è¯¢ç»æçæå¤§ç´¢å¼å·ä¸ºç»æ­¢ç´¢å¼å·ã
         */
        this.toIndex = 19;

        /**
         * @member {boolean} [GetFeaturesParametersBase.prototype.returnCountOnly=false]
         * @description åªè¿åæ¥è¯¢ç»æçæ»æ°ã
         */
        this.returnCountOnly = false;

        /**
         * @member {number} [GetFeaturesParametersBase.prototype.maxFeatures=1000]
         * @description è¿è¡ SQL æ¥è¯¢æ¶ï¼ç¨äºè®¾ç½®æå¡ç«¯è¿åæ¥è¯¢ç»ææ¡ç®æ°éã
         */
        this.maxFeatures = null;

        /**
         * @member {number} [GetFeaturesParametersBase.prototype.hasGeometry=true]
         * @description è¿åç»ææ¯å¦åå«Geometry
         */
        this.hasGeometry = true;

        /**
         * @member {MetricsAggParameter|GeoHashGridAggParameter} GetFeaturesParametersBase.prototype.aggregations
         * @description èåæ¥è¯¢åæ°ï¼è¯¥åæ°ä»æ¯ææ°æ®æ¥æº Elasticsearch æå¡çSupermap iServerçrestæ°æ®æå¡ã
         */
        this.aggregations = null;

        Util.extend(this, options);

        this.CLASS_NAME = 'SuperMap.GetFeaturesParametersBase';
    }

    /**
     *
     * @function GetFeaturesParametersBase.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.datasetNames = null;
        me.returnContent = null;
        me.fromIndex = null;
        me.toIndex = null;
        me.hasGeometry = null;
        me.maxFeatures = null;
        me.targetEpsgCode = null;
        me.targetPrj = null;
        if (me.aggregation) {
            me.aggregation = null;
        }
    }
}

;// CONCATENATED MODULE: ./src/common/iServer/GetFeaturesByBoundsParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class GetFeaturesByBoundsParameters
 * @deprecatedclass SuperMap.GetFeaturesByBoundsParameters
 * @category iServer Data FeatureResults
 * @classdesc æ°æ®éèå´æ¥è¯¢åæ°ç±»ï¼è¯¥ç±»ç¨äºè®¾ç½®æ°æ®éèå´æ¥è¯¢çç¸å³åæ°ã
 * @param {Object} options - åæ°ã
 * @param {(SuperMap.Bounds|L.Bounds|L.LatLngBounds|ol.extent|mapboxgl.LngLatBounds|GeoJSONObject)} options.bounds - æ¥è¯¢çèå´å¯¹è±¡ã
 * @param {Array.<string>} options.datasetNames - æ°æ®éåç§°åè¡¨ã
 * @param {string} [options.attributeFilter] - èå´æ¥è¯¢å±æ§è¿æ»¤æ¡ä»¶ã
 * @param {Array.<string>} [options.fields] - è®¾ç½®æ¥è¯¢ç»æè¿åå­æ®µãé»è®¤è¿åææå­æ®µã
 * @param {SpatialQueryMode} [options.spatialQueryMode=SpatialQueryMode.CONTAIN] - ç©ºé´æ¥è¯¢æ¨¡å¼å¸¸éã
 * @param {boolean} [options.returnContent=true] - æ¯å¦ç´æ¥è¿åæ¥è¯¢ç»æã
 * @param {number} [options.fromIndex=0] - æ¥è¯¢ç»æçæå°ç´¢å¼å·ã
 * @param {number} [options.toIndex=19] - æ¥è¯¢ç»æçæå¤§ç´¢å¼å·ã
 * @param {string|number} [options.targetEpsgCode] - å¨ææå½±çç®æ åæ ç³»å¯¹åºç EPSG Codeï¼ä½¿ç¨æ­¤åæ°æ¶ï¼returnContent åæ°éä¸º trueã
 * @param {Object} [options.targetPrj] - å¨ææå½±çç®æ åæ ç³»ãä½¿ç¨æ­¤åæ°æ¶ï¼returnContent åæ°éä¸º trueã å¦ï¼prjCoordSys={"epsgCode":3857}ãå½åæ¶è®¾ç½® targetEpsgCode åæ°æ¶ï¼æ­¤åæ°ä¸çæã
 * @param {MetricsAggParameter|GeoHashGridAggParameter} [options.aggregations] - èåæ¥è¯¢åæ°ãè¯¥åæ°ä»æ¯ææ°æ®æ¥æº Elasticsearch æå¡çSupermap iServerçrestæ°æ®æå¡ã
 * @extends {GetFeaturesParametersBase}
 * @usage
 */

class GetFeaturesByBoundsParameters extends GetFeaturesParametersBase {
    constructor(options) {
        super(options);
        /**
         * @member {string} GetFeaturesByBoundsParameters.prototype.getFeatureMode
         * @description æ°æ®éæ¥è¯¢æ¨¡å¼ãèå´æ¥è¯¢æ "BOUNDS"ï¼"BOUNDS_ATTRIBUTEFILTER" ä¸¤ç§ï¼å½ç¨æ·è®¾ç½® attributeFilter æ¶ä¼èªå¨åæ¢å° BOUNDS_ATTRIBUTEFILTER è®¿é®æå¡ã
         */
        this.getFeatureMode = GetFeaturesByBoundsParameters.getFeatureMode.BOUNDS;

        /**
         * @member {(SuperMap.Bounds|L.Bounds|L.LatLngBounds|ol.extent|mapboxgl.LngLatBounds|GeoJSONObject)} GetFeaturesByBoundsParameters.prototype.bounds
         * @description ç¨äºæ¥è¯¢çèå´å¯¹è±¡ã
         *
         */
        this.bounds = null;

        /**
         * @member {Array.<string>} GetFeaturesByBoundsParameters.prototype.fields
         * @description è®¾ç½®æ¥è¯¢ç»æè¿åå­æ®µãå½æå®äºè¿åç»æå­æ®µåï¼å GetFeaturesResult ä¸­ç features çå±æ§å­æ®µåªåå«ææå®çå­æ®µãä¸è®¾ç½®å³è¿åå¨é¨å­æ®µã
         */
        this.fields = null;

        /**
         * @member {string} GetFeaturesByBoundsParameters.prototype.attributeFilter
         * @description èå´æ¥è¯¢å±æ§è¿æ»¤æ¡ä»¶ã
         */
        this.attributeFilter = null;

        /**
         * @member {SpatialQueryMode} [GetFeaturesByBoundsParameters.prototype.spatialQueryMode=SpatialQueryMode.CONTAIN]
         * @description ç©ºé´æ¥è¯¢æ¨¡å¼å¸¸éã
         */
        this.spatialQueryMode = SpatialQueryMode.CONTAIN;

        Util.extend(this, options);
        this.CLASS_NAME = 'SuperMap.GetFeaturesByBoundsParameters';
    }

    /**
     * @function GetFeaturesByBoundsParameters.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
        var me = this;
        if (me.bounds) {
            me.bounds.destroy();
            me.bounds = null;
        }
        if (me.fields) {
            while (me.fields.length > 0) {
                me.fields.pop();
            }
            me.fields = null;
        }
        me.attributeFilter = null;
        me.spatialQueryMode = null;
        me.getFeatureMode = null;
    }

    /**
     * @function GetFeaturesByBoundsParameters.toJsonParameters
     * @description å° {@link GetFeaturesByBoundsParameters} å¯¹è±¡åæ°è½¬æ¢ä¸º JSON å­ç¬¦ä¸²ã
     * @param {GetFeaturesByBoundsParameters} params - èå´æ¥è¯¢åæ°ã
     * @returns {string} è½¬ååç JSON å­ç¬¦ä¸²ã
     *
     */
    static toJsonParameters(params) {
        var filterParameter, bounds, parasByBounds;

        bounds = {
            leftBottom: { x: params.bounds.left, y: params.bounds.bottom },
            rightTop: { x: params.bounds.right, y: params.bounds.top }
        };
        parasByBounds = {
            datasetNames: params.datasetNames,
            getFeatureMode: GetFeaturesByBoundsParameters.getFeatureMode.BOUNDS,
            bounds: bounds,
            spatialQueryMode: params.spatialQueryMode
        };
        if (params.fields) {
            filterParameter = new FilterParameter();
            filterParameter.name = params.datasetNames;
            filterParameter.fields = params.fields;
            parasByBounds.queryParameter = filterParameter;
        }
        if (params.attributeFilter) {
            parasByBounds.attributeFilter = params.attributeFilter;
            parasByBounds.getFeatureMode = GetFeaturesByBoundsParameters.getFeatureMode.BOUNDS_ATTRIBUTEFILTER;
        }
        if (params.maxFeatures && !isNaN(params.maxFeatures)) {
            parasByBounds.maxFeatures = params.maxFeatures;
        }

        if (typeof params.hasGeometry === 'boolean') {
          parasByBounds.hasGeometry = params.hasGeometry;
        }

        if (params.targetEpsgCode) {
            parasByBounds.targetEpsgCode = params.targetEpsgCode;
        }
        if (!params.targetEpsgCode && params.targetPrj) {
            parasByBounds.targetPrj = params.targetPrj;
        }
        if (params.aggregations) {
            parasByBounds.aggregations = params.aggregations;
        }

        return Util.toJSON(parasByBounds);
    }
}

GetFeaturesByBoundsParameters.getFeatureMode = {
    BOUNDS: 'BOUNDS',
    BOUNDS_ATTRIBUTEFILTER: 'BOUNDS_ATTRIBUTEFILTER'
};


;// CONCATENATED MODULE: ./src/common/iServer/GetFeaturesServiceBase.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class GetFeaturesServiceBase
 * @deprecatedclass SuperMap.GetFeaturesServiceBase
 * @category  iServer Data FeatureResults
 * @classdesc æ°æ®æå¡ä¸­æ°æ®éæ¥è¯¢æå¡åºç±»ãè·åç»ææ°æ®ç±»åä¸º Objectãåå« result å±æ§ï¼result çæ°æ®æ ¼å¼æ ¹æ® format åæ°å³å®ä¸º GeoJSON æè iServerJSONã
 * @extends CommonServiceBase
 * @param {string} url - æå¡å°åãè¯·æ±æ°æ®æå¡ä¸­æ°æ®éæ¥è¯¢æå¡ï¼
 * URLåºä¸ºï¼http://{æå¡å¨å°å}:{æå¡ç«¯å£å·}/iserver/services/{æ°æ®æå¡å}/rest/data/
 * ä¾å¦ï¼"http://localhost:8090/iserver/services/data-jingjin/rest/data/"
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - äºä»¶çå¬å¨å¯¹è±¡ãæ processCompleted å±æ§å¯ä¼ å¥å¤çå®æåçåè°å½æ°ãprocessFailed å±æ§ä¼ å¥å¤çå¤±è´¥åçåè°å½æ°ã
 * @param {DataFormat} [options.format=DataFormat.GEOJSON] - æ¥è¯¢ç»æè¿åæ ¼å¼ï¼ç®åæ¯æ iServerJSON å GeoJSON ä¸¤ç§æ ¼å¼ãåæ°æ ¼å¼ä¸º "ISERVER"ï¼"GEOJSON"ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @example
 * var myService = new GetFeaturesServiceBase(url, {
 *     eventListeners: {
 *         "processCompleted": getFeatureCompleted,
 *         "processFailed": getFeatureError
 *     }
 * });
 * @usage
 */
class GetFeaturesServiceBase extends CommonServiceBase {

    constructor(url, options) {
        super(url, options);
        options = options || {};

        /**
         * @member {boolean} [GetFeaturesServiceBase.prototype.returnContent=true]
         * @description æ¯å¦ç«å³è¿åæ°åå»ºèµæºçè¡¨è¿°è¿æ¯è¿åæ°èµæºç URIã
         * å¦æä¸º trueï¼åç´æ¥è¿åæ°åå»ºèµæºï¼å³æ¥è¯¢ç»æçè¡¨è¿°ã
         * å¦æä¸º falseï¼åè¿åçæ¯æ¥è¯¢ç»æèµæºç URIã
         */
        this.returnContent = true;

        /**
         * @member {number} [GetFeaturesServiceBase.prototype.fromIndex=0]
         * @description æ¥è¯¢ç»æçæå°ç´¢å¼å·ãå¦æè¯¥å¼å¤§äºæ¥è¯¢ç»æçæå¤§ç´¢å¼å·ï¼åæ¥è¯¢ç»æä¸ºç©ºã
         */
        this.fromIndex = 0;

        /**
         * @member {number} [GetFeaturesServiceBase.prototype.toIndex=19]
         * @description æ¥è¯¢ç»æçæå¤§ç´¢å¼å·ã
         * å¦æè¯¥å¼å¤§äºæ¥è¯¢ç»æçæå¤§ç´¢å¼å·ï¼åä»¥æ¥è¯¢ç»æçæå¤§ç´¢å¼å·ä¸ºç»æ­¢ç´¢å¼å·ã
         */
        this.toIndex = 19;

         /**
         * @member {number} [GetFeaturesServiceBase.prototype.hasGeometry=true]
         * @description è¿åç»ææ¯å¦åå«Geometry
         */
        this.hasGeometry = true;

        /**
         * @member {number} [GetFeaturesServiceBase.prototype.maxFeatures=1000]
         * @description è¿è¡ SQL æ¥è¯¢æ¶ï¼ç¨äºè®¾ç½®æå¡ç«¯è¿åæ¥è¯¢ç»ææ¡ç®æ°éã
         */
        this.maxFeatures = null;

        /**
         * @member {string} [GetFeaturesServiceBase.prototype.format=DataFormat.GEOJSON]
         * @description æ¥è¯¢ç»æè¿åæ ¼å¼ï¼ç®åæ¯æ iServerJSON å GeoJSON ä¸¤ç§æ ¼å¼ã
         * åæ°æ ¼å¼ä¸º "ISERVER"ï¼"GEOJSON"ã
         */
        this.format = DataFormat.GEOJSON;

        Util.extend(this, options);
        this.url = Util.urlPathAppend(this.url, 'featureResults');

        this.CLASS_NAME = "SuperMap.GetFeaturesServiceBase";
    }

    /**
     * @function GetFeaturesServiceBase.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        super.destroy();
        var me = this;
        me.returnContent = null;
        me.fromIndex = null;
        me.toIndex = null;
        me.maxFeatures = null;
        me.format = null;
        me.hasGeometry = null;
    }

    /**
     * @function GetFeaturesServiceBase.prototype.processAsync
     * @description å°å®¢æ·ç«¯çæ¥è¯¢åæ°ä¼ éå°æå¡ç«¯ã
     * @param {Object} params - æ¥è¯¢åæ°ã
     */
    processAsync(params) {
        if (!params) {
            return;
        }
        var me = this,
            jsonParameters = null,
            firstPara = true;

        me.returnContent = params.returnContent;
        me.fromIndex = params.fromIndex;
        me.toIndex = params.toIndex;
        me.maxFeatures = params.maxFeatures;
        me.hasGeometry = params.hasGeometry;
        if (me.returnContent) {
            me.url = Util.urlAppend(me.url, 'returnContent=' + me.returnContent);
            firstPara = false;
        }
        var isValidNumber = me.fromIndex != null && me.toIndex != null && !isNaN(me.fromIndex) && !isNaN(me.toIndex);
        if (isValidNumber && me.fromIndex >= 0 && me.toIndex >= 0 && !firstPara) {
            me.url = Util.urlAppend(me.url, `fromIndex=${me.fromIndex}&toIndex=${me.toIndex}`);
        }

        if (params.returnCountOnly) {
            me.url = Util.urlAppend(me.url, "&returnCountOnly=" + params.returnContent)
        }

        jsonParameters = me.getJsonParameters(params);
        me.request({
            method: "POST",
            data: jsonParameters,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }

    /**
     * @function GetFeaturesServiceBase.prototype.getFeatureComplete
     * @description æ¥è¯¢å®æï¼æ§è¡æ­¤æ¹æ³ã
     * @param {Object} result - æå¡å¨è¿åçç»æå¯¹è±¡ã
     */
    serviceProcessCompleted(result) {
        var me = this;
        result = Util.transformResult(result);
        if (me.format === DataFormat.GEOJSON && result.features) {
            var geoJSONFormat = new GeoJSON();
            result.features = geoJSONFormat.toGeoJSON(result.features);
        }
        me.events.triggerEvent("processCompleted", {result: result});
    }


}

;// CONCATENATED MODULE: ./src/common/iServer/GetFeaturesByBoundsService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class GetFeaturesByBoundsService
 * @deprecatedclass SuperMap.GetFeaturesByBoundsService
 * @category iServer Data FeatureResults
 * @classdesc æ°æ®éèå´æ¥è¯¢æå¡ç±»,æ¥è¯¢ä¸æå®èå´å¯¹è±¡ç¬¦åä¸å®ç©ºé´å³ç³»çç¢éè¦ç´ ã
 * @description æ°æ®éèå´æ¥è¯¢æå¡ç±»æé å½æ°ã
 * @extends {GetFeaturesServiceBase}
 * @param {string} url - æå¡å°åãè¯·æ±æ°æ®æå¡ä¸­æ°æ®éæ¥è¯¢æå¡ï¼URL åºä¸ºï¼http://{æå¡å¨å°å}:{æå¡ç«¯å£å·}/iserver/services/{æ°æ®æå¡å}/rest/data/ï¼
 * ä¾å¦ï¼"http://localhost:8090/iserver/services/data-jingjin/rest/data/"
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - äºä»¶çå¬å¨å¯¹è±¡ãæ processCompleted å±æ§å¯ä¼ å¥å¤çå®æåçåè°å½æ°ãprocessFailed å±æ§ä¼ å¥å¤çå¤±è´¥åçåè°å½æ°ã
 * @param {DataFormat} [options.format=DataFormat.GEOJSON] - æ¥è¯¢ç»æè¿åæ ¼å¼ï¼ç®åæ¯æ iServerJSON å GeoJSON ä¸¤ç§æ ¼å¼ãåæ°æ ¼å¼ä¸º "ISERVER"ï¼"GEOJSON"ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @example
 * var myGetFeaturesByBoundsService = new SuperMa.GetFeaturesByBoundsService(url, {
 *     eventListeners: {
 *           "processCompleted": getFeatureCompleted,
 *           "processFailed": getFeatureError
 *           }
 * });
 * function getFeatureCompleted(object){//todo};
 * function getFeatureError(object){//todo}
 * @usage
 */

class GetFeaturesByBoundsService extends GetFeaturesServiceBase {

    constructor(url, options) {
        super(url, options);

        this.CLASS_NAME = "SuperMap.GetFeaturesByBoundsService";
    }

    /**
     * @function GetFeaturesByBoundsService.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function GetFeaturesByBoundsService.prototype.getJsonParameters
     * @description å°æ¥è¯¢åæ°è½¬åä¸º JSON å­ç¬¦ä¸²ãå¨æ¬ç±»ä¸­éåæ­¤æ¹æ³ï¼å¯ä»¥å®ç°ä¸åç§ç±»çæ¥è¯¢ï¼ID, SQL, Buffer, Geometry,Boundsç­ï¼ã
     * @param params {GetFeaturesByBoundsParameters}
     * @returns {string} è½¬ååç JSON å­ç¬¦ä¸²ã
     *
     */
    getJsonParameters(params) {
        return GetFeaturesByBoundsParameters.toJsonParameters(params);
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/GetFeaturesByBufferParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class GetFeaturesByBufferParameters
 * @deprecatedclass SuperMap.GetFeaturesByBufferParameters
 * @category iServer Data FeatureResults
 * @classdesc æ°æ®éç¼å²åºæ¥è¯¢åæ°ç±»ã
 * @param {Object} options - åæ°ã
 * @param {number} options.bufferDistance - buffer è·ç¦»ï¼åä½ä¸ææ¥è¯¢å¾å±å¯¹åºçæ°æ®éåä½ç¸åã
 * @param {GeoJSONObject} options.geometry - ç©ºé´æ¥è¯¢æ¡ä»¶ã
 * @param {Array.<string>} options.dataSetNames - æ°æ®ééåä¸­çæ°æ®éåç§°åè¡¨ã
 * @param {Array.<string>} [options.fields] - è®¾ç½®æ¥è¯¢ç»æè¿åå­æ®µãé»è®¤è¿åææå­æ®µã
 * @param {string} [options.attributeFilter] - å±æ§æ¥è¯¢æ¡ä»¶ã
 * @param {boolean} [options.returnContent=true] - æ¯å¦ç´æ¥è¿åæ¥è¯¢ç»æã
 * @param {number} [options.fromIndex=0] - æ¥è¯¢ç»æçæå°ç´¢å¼å·ã
 * @param {number} [options.toIndex=19] - æ¥è¯¢ç»æçæå¤§ç´¢å¼å·ã
 * @param {string|number} [options.targetEpsgCode] - å¨ææå½±çç®æ åæ ç³»å¯¹åºç EPSG Codeï¼ä½¿ç¨æ­¤åæ°æ¶ï¼returnContent åæ°éä¸º trueã
 * @param {Object} [options.targetPrj] - å¨ææå½±çç®æ åæ ç³»ãä½¿ç¨æ­¤åæ°æ¶ï¼returnContent åæ°éä¸º trueã å¦ï¼prjCoordSys={"epsgCode":3857}ãå½åæ¶è®¾ç½® targetEpsgCode åæ°æ¶ï¼æ­¤åæ°ä¸çæã
 * @extends {GetFeaturesParametersBase}
 * @usage
 */
class GetFeaturesByBufferParameters extends GetFeaturesParametersBase {
    constructor(options) {
        super(options);
        /**
         * @member {number} GetFeaturesByBufferParameters.prototype.bufferDistance
         * @description buffer è·ç¦»,åä½ä¸ææ¥è¯¢å¾å±å¯¹åºçæ°æ®éåä½ç¸åã
         */
        this.bufferDistance = null;

        /**
         * @member {string} GetFeaturesByBufferParameters.prototype.attributeFilter
         * @description å±æ§æ¥è¯¢æ¡ä»¶ã
         */
        this.attributeFilter = null;

        /**
         * @member {GeoJSONObject} GetFeaturesByBufferParameters.prototype.geometry
         * @description ç©ºé´æ¥è¯¢æ¡ä»¶ã <br>
         * ç¹ç±»åå¯ä»¥æ¯ï¼{@link GeometryPoint}|{@link L.Marker}|{@link L.CircleMarker}|{@link L.Circle}|{@link L.GeoJSON}|{@link ol.geom.Point}|{@link ol.format.GeoJSON}|{@link mapboxgl.LngLat}|{@link mapboxgl.Point}|{@link GeoJSONObject}ã</br>
         * çº¿ç±»åå¯ä»¥æ¯ï¼{@link GeometryLineString}|{@link GeometryLinearRing}|{@link L.Polyline}|{@link L.GeoJSON}|{@link ol.geom.LineString}|{@link ol.format.GeoJSON}|{@link GeoJSONObject}ã</br>
         * é¢ç±»åå¯ä»¥æ¯ï¼{@link GeometryPolygon}|{@link L.Polygon}|{@link L.GeoJSON}|{@link ol.geom.Polygon}|{@link ol.format.GeoJSON}|{@link mapboxgl.LngLatBounds}|{@link GeoJSONObject}ã
         */
        this.geometry = null;

        /**
         * @member {Array.<string>} GetFeaturesByBufferParameters.prototype.fields
         * @description è®¾ç½®æ¥è¯¢ç»æè¿åå­æ®µãå½æå®äºè¿åç»æå­æ®µåï¼å GetFeaturesResult ä¸­ç features çå±æ§å­æ®µåªåå«ææå®çå­æ®µãä¸è®¾ç½®å³è¿åå¨é¨å­æ®µã
         */
        this.fields = null;
        Util.extend(this, options);
        this.CLASS_NAME = 'SuperMap.GetFeaturesByBufferParameters';
    }

    /**
     * @function GetFeaturesByBufferParameters.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
        var me = this;
        me.bufferDistance = null;
        me.attributeFilter = null;
        if (me.fields) {
            while (me.fields.length > 0) {
                me.fields.pop();
            }
            me.fields = null;
        }
        if (me.geometry) {
            me.geometry.destroy();
            me.geometry = null;
        }
    }

    /**
     * @function GetFeaturesByBufferParameters.toJsonParameters
     * @description å° GetFeaturesByBufferParameters å¯¹è±¡è½¬æ¢ä¸º JSON å­ç¬¦ä¸²ã
     * @param {GetFeaturesByBufferParameters} params - æ°æ®éç¼å²åºæ¥è¯¢åæ°å¯¹è±¡ã
     * @returns {string} è½¬ååç JSON å­ç¬¦ä¸²ã
     */
    static toJsonParameters(params) {
        var filterParameter, paramsByBuffer, geometry;
        geometry = ServerGeometry.fromGeometry(params.geometry);
        paramsByBuffer = {
            datasetNames: params.datasetNames,
            getFeatureMode: 'BUFFER',
            bufferDistance: params.bufferDistance,
            geometry: geometry
        };
        if (params.fields) {
            filterParameter = new FilterParameter();
            filterParameter.name = params.datasetNames;
            filterParameter.fields = params.fields;
            paramsByBuffer.queryParameter = filterParameter;
        }
        if (params.attributeFilter) {
            paramsByBuffer.attributeFilter = params.attributeFilter;
            paramsByBuffer.getFeatureMode = 'BUFFER_ATTRIBUTEFILTER';
        }
        if (params.maxFeatures && !isNaN(params.maxFeatures)) {
            paramsByBuffer.maxFeatures = params.maxFeatures;
        }

        if (typeof params.hasGeometry === 'boolean') {
            paramsByBuffer.hasGeometry = params.hasGeometry;
        }

        if (params.targetEpsgCode) {
            paramsByBuffer.targetEpsgCode = params.targetEpsgCode;
        }
        if (!params.targetEpsgCode && params.targetPrj) {
            paramsByBuffer.targetPrj = params.targetPrj;
        }
        return Util.toJSON(paramsByBuffer);
    }
}


;// CONCATENATED MODULE: ./src/common/iServer/GetFeaturesByBufferService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class GetFeaturesByBufferService
 * @deprecatedclass SuperMap.GetFeaturesByBufferService
 * @category iServer Data FeatureResults
 * @classdesc æ°æ®æå¡ä¸­æ°æ®éç¼å²åºæ¥è¯¢æå¡ç±»ã
 * @param {string} url - æå¡å°åãè¯·æ±æ°æ®æå¡ä¸­æ°æ®éæ¥è¯¢æå¡ï¼
 * URL åºä¸ºï¼http://{æå¡å¨å°å}:{æå¡ç«¯å£å·}/iserver/services/{æ°æ®æå¡å}/rest/data/ï¼
 * ä¾å¦ï¼"http://localhost:8090/iserver/services/data-jingjin/rest/data/"
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - äºä»¶çå¬å¨å¯¹è±¡ãæprocessCompletedå±æ§å¯ä¼ å¥å¤çå®æåçåè°å½æ°ãprocessFailedå±æ§ä¼ å¥å¤çå¤±è´¥åçåè°å½æ°ã
 * @param {DataFormat} [options.format=DataFormat.GEOJSON] - æ¥è¯¢ç»æè¿åæ ¼å¼ï¼ç®åæ¯æ iServerJSON å GeoJSON ä¸¤ç§æ ¼å¼ãåæ°æ ¼å¼ä¸º "ISERVER"ï¼"GEOJSON"ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @extends {GetFeaturesServiceBase}
 * @example
 * var myGetFeaturesByBufferService = new GetFeaturesByBufferService(url, {
 *     eventListeners: {
 *           "processCompleted": GetFeaturesCompleted,
 *           "processFailed": GetFeaturesError
 *           }
 * });
 * function GetFeaturesCompleted(object){//todo};
 * function GetFeaturesError(object){//todo};
 * @usage
 */

class GetFeaturesByBufferService extends GetFeaturesServiceBase {

    constructor(url, options) {
        super(url, options);

        this.CLASS_NAME = "SuperMap.GetFeaturesByBufferService";
    }

    /**
     * @function GetFeaturesByBufferService.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function GetFeaturesByBufferService.prototype.getJsonParameters
     * @description å°æ¥è¯¢åæ°è½¬åä¸º JSON å­ç¬¦ä¸²ãå¨æ¬ç±»ä¸­éåæ­¤æ¹æ³ï¼å¯ä»¥å®ç°ä¸åç§ç±»çæ¥è¯¢ï¼IDs, SQL, Buffer, Geometryç­ï¼ã
     * @param {GetFeaturesByBufferParameters} params - æ°æ®éç¼å²åºæ¥è¯¢åæ°ç±»ã
     * @returns {Object} è½¬ååç JSON å­ç¬¦ä¸²ã
     */
    getJsonParameters(params) {
        if (!(params instanceof GetFeaturesByBufferParameters)) {
            return;
        }
        return GetFeaturesByBufferParameters.toJsonParameters(params);
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/GetFeaturesByGeometryParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/






/**
 * @class GetFeaturesByGeometryParameters
 * @deprecatedclass SuperMap.GetFeaturesByGeometryParameters
 * @category iServer Data FeatureResults
 * @classdesc æ°æ®éå ä½æ¥è¯¢åæ°ç±»ãè¯¥ç±»ç¨äºè®¾ç½®æ°æ®éå ä½æ¥è¯¢çç¸å³åæ°ã
 * @param {Object} options - åæ°ã
 * @param {GeoJSONObject} options.geometry - æ¥è¯¢çå ä½å¯¹è±¡ã
 * @param {Array.<string>} options.datasetNames - æ°æ®ééåä¸­çæ°æ®éåç§°åè¡¨ã
 * @param {string} [options.attributeFilter] - å ä½æ¥è¯¢å±æ§è¿æ»¤æ¡ä»¶ã
 * @param {Array.<string>} [options.fields] - è®¾ç½®æ¥è¯¢ç»æè¿åå­æ®µãé»è®¤è¿åææå­æ®µã
 * @param {SpatialQueryMode} [options.spatialQueryMode=SpatialQueryMode.CONTAIN] - ç©ºé´æ¥è¯¢æ¨¡å¼å¸¸éã
 * @param {boolean} [options.returnContent=true] - æ¯å¦ç´æ¥è¿åæ¥è¯¢ç»æã
 * @param {number} [options.fromIndex=0] - æ¥è¯¢ç»æçæå°ç´¢å¼å·ã
 * @param {number} [options.toIndex=19] - æ¥è¯¢ç»æçæå¤§ç´¢å¼å·ã
 * @param {string|number} [options.targetEpsgCode] - å¨ææå½±çç®æ åæ ç³»å¯¹åºç EPSG Codeï¼ä½¿ç¨æ­¤åæ°æ¶ï¼returnContent åæ°éä¸º trueã
 * @param {Object} [options.targetPrj] - å¨ææå½±çç®æ åæ ç³»ãä½¿ç¨æ­¤åæ°æ¶ï¼returnContent åæ°éä¸º trueã å¦ï¼prjCoordSys={"epsgCode":3857}ãå½åæ¶è®¾ç½® targetEpsgCode åæ°æ¶ï¼æ­¤åæ°ä¸çæã
 * @param {MetricsAggParameter|GeoHashGridAggParameter} [options.aggregations] - èåæ¥è¯¢åæ°ãè¯¥åæ°ä»æ¯ææ°æ®æ¥æº Elasticsearch æå¡çSupermap iServerçrestæ°æ®æå¡ã
 * @extends {GetFeaturesParametersBase}
 * @usage
 */
class GetFeaturesByGeometryParameters extends GetFeaturesParametersBase {
    constructor(options) {
        super(options);
        /**
         * @member {string} GetFeaturesByGeometryParameters.prototype.getFeatureMode
         * @description æ°æ®éæ¥è¯¢æ¨¡å¼ãå ä½æ¥è¯¢æ "SPATIAL"ï¼"SPATIAL_ATTRIBUTEFILTER" ä¸¤ç§ï¼å½ç¨æ·è®¾ç½® attributeFilter æ¶ä¼èªå¨åæ¢å° SPATIAL_ATTRIBUTEFILTER è®¿é®æå¡ã
         */
        this.getFeatureMode = 'SPATIAL';

        /**
         * @member {GeoJSONObject} GetFeaturesByGeometryParameters.prototype.geometry
         * @description ç¨äºæ¥è¯¢çå ä½å¯¹è±¡ã </br>
         * ç¹ç±»åå¯ä»¥æ¯ï¼{@link GeometryPoint}|{@link L.Marker}|{@link L.CircleMarker}|{@link L.Circle}|{@link L.GeoJSON}|{@link ol.geom.Point}|{@link ol.format.GeoJSON}|{@link mapboxgl.LngLat}|{@link mapboxgl.Point}|{@link GeoJSONObject}ã</br>
         * çº¿ç±»åå¯ä»¥æ¯ï¼{@link GeometryLineString}|{@link GeometryLinearRing}|{@link L.Polyline}|{@link L.GeoJSON}|{@link ol.geom.LineString}|{@link ol.format.GeoJSON}|{@link GeoJSONObject}ã</br>
         * é¢ç±»åå¯ä»¥æ¯ï¼{@link GeometryPolygon}|{@link L.Polygon}|{@link L.GeoJSON}|{@link ol.geom.Polygon}|{@link ol.format.GeoJSON}|{@link mapboxgl.LngLatBounds}|{@link GeoJSONObject}ã
         */
        this.geometry = null;

        /**
         * @member {Array.<string>} GetFeaturesByGeometryParameters.prototype.fields
         * @description è®¾ç½®æ¥è¯¢ç»æè¿åå­æ®µãå½æå®äºè¿åç»æå­æ®µåï¼å GetFeaturesResult ä¸­ç features çå±æ§å­æ®µåªåå«ææå®çå­æ®µãä¸è®¾ç½®å³è¿åå¨é¨å­æ®µã
         */
        this.fields = null;

        /**
         * @member {string} GetFeaturesByGeometryParameters.prototype.attributeFilter
         *  @description å ä½æ¥è¯¢å±æ§è¿æ»¤æ¡ä»¶ã
         */
        this.attributeFilter = null;

        /**
         * @member {SpatialQueryMode} [GetFeaturesByGeometryParameters.prototype.spatialQueryMode=SpatialQueryMode.CONTAIN]
         * @description ç©ºé´æ¥è¯¢æ¨¡å¼å¸¸éã
         */
        this.spatialQueryMode = SpatialQueryMode.CONTAIN;
        Util.extend(this, options);

        this.CLASS_NAME = 'SuperMap.GetFeaturesByGeometryParameters';
    }

    /**
     * @function GetFeaturesByGeometryParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        super.destroy();
        var me = this;
        if (me.geometry) {
            me.geometry.destroy();
            me.geometry = null;
        }
        if (me.fields) {
            while (me.fields.length > 0) {
                me.fields.pop();
            }
            me.fields = null;
        }
        me.attributeFilter = null;
        me.spatialQueryMode = null;
        me.getFeatureMode = null;
    }

    /**
     * @function GetFeaturesByGeometryParameters.toJsonParameters
     * @description å° GetFeaturesByGeometryParameters å¯¹è±¡åæ°è½¬æ¢ä¸º JSON å­ç¬¦ä¸²ã
     * @param {GetFeaturesByGeometryParameters} params - æ¥è¯¢åæ°å¯¹è±¡ã
     * @returns {string} è½¬ååç JSON å­ç¬¦ä¸²ã
     */
    static toJsonParameters(params) {
        var filterParameter, geometry, parasByGeometry;

        geometry = ServerGeometry.fromGeometry(params.geometry);
        parasByGeometry = {
            datasetNames: params.datasetNames,
            getFeatureMode: 'SPATIAL',
            geometry: geometry,
            spatialQueryMode: params.spatialQueryMode
        };
        if (params.fields) {
            filterParameter = new FilterParameter();
            filterParameter.name = params.datasetNames;
            filterParameter.fields = params.fields;
            parasByGeometry.queryParameter = filterParameter;
        }
        if (params.attributeFilter) {
            parasByGeometry.attributeFilter = params.attributeFilter;
            parasByGeometry.getFeatureMode = 'SPATIAL_ATTRIBUTEFILTER';
        }

        if (params.maxFeatures && !isNaN(params.maxFeatures)) {
            parasByGeometry.maxFeatures = params.maxFeatures;
        }

        if (typeof params.hasGeometry === 'boolean') {
            parasByGeometry.hasGeometry = params.hasGeometry;
        }

        if (params.targetEpsgCode) {
            parasByGeometry.targetEpsgCode = params.targetEpsgCode;
        }
        if (!params.targetEpsgCode && params.targetPrj) {
            parasByGeometry.targetPrj = params.targetPrj;
        }
        if (params.aggregations) {
            parasByGeometry.aggregations = params.aggregations;
        }

        return Util.toJSON(parasByGeometry);
    }
}


;// CONCATENATED MODULE: ./src/common/iServer/GetFeaturesByGeometryService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class GetFeaturesByGeometryService
 * @deprecatedclass SuperMap.GetFeaturesByGeometryService
 * @category iServer Data FeatureResults
 * @classdesc æ°æ®éå ä½æ¥è¯¢æå¡ç±»ï¼æ¥è¯¢ä¸æå®å ä½å¯¹è±¡ç¬¦åä¸å®ç©ºé´å³ç³»çç¢éè¦ç´ ã
 * @param {string} url - æå¡å°åãè¯·æ±æ°æ®æå¡ä¸­æ°æ®éæ¥è¯¢æå¡ã
 * URL åºä¸ºï¼http://{æå¡å¨å°å}:{æå¡ç«¯å£å·}/iserver/services/{æ°æ®æå¡å}/rest/dataï¼
 * ä¾å¦ï¼"http://localhost:8090/iserver/services/data-jingjin/rest/data"
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - äºä»¶çå¬å¨å¯¹è±¡ãæprocessCompletedå±æ§å¯ä¼ å¥å¤çå®æåçåè°å½æ°ãprocessFailedå±æ§ä¼ å¥å¤çå¤±è´¥åçåè°å½æ°ã
 * @param {DataFormat} [options.format=DataFormat.GEOJSON] - æ¥è¯¢ç»æè¿åæ ¼å¼ï¼ç®åæ¯æ iServerJSON å GeoJSON ä¸¤ç§æ ¼å¼ãåæ°æ ¼å¼ä¸º "ISERVER"ï¼"GEOJSON"ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @extends {GetFeaturesServiceBase}
 * @example
 * var myService = new GetFeaturesByGeometryService(url, {
     *     eventListeners: {
     *           "processCompleted": getFeatureCompleted,
     *           "processFailed": getFeatureError
     *           }
     * });
 * function getFeatureCompleted(object){//todo};
 * function getFeatureError(object){//todo}
 * @usage
 */
class GetFeaturesByGeometryService extends GetFeaturesServiceBase {

    constructor(url, options) {
        super(url, options);
        this.CLASS_NAME = "SuperMap.GetFeaturesByGeometryService";
    }

    /**
     * @function GetFeaturesByGeometryService.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function GetFeaturesByGeometryService.prototype.getJsonParameters
     * @param {GetFeaturesByGeometryParameters} params - æ°æ®éå ä½æ¥è¯¢åæ°ç±»ã
     * @description å°æ¥è¯¢åæ°è½¬åä¸º JSON å­ç¬¦ä¸²ã
     * å¨æ¬ç±»ä¸­éåæ­¤æ¹æ³ï¼å¯ä»¥å®ç°ä¸åç§ç±»çæ¥è¯¢ï¼ID, SQL, Buffer, Geometryç­ï¼ã
     * @returns {Object} è½¬ååç JSON å­ç¬¦ä¸²ã
     */
    getJsonParameters(params) {
        return GetFeaturesByGeometryParameters.toJsonParameters(params);
    }


}

;// CONCATENATED MODULE: ./src/common/iServer/GetFeaturesByIDsParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class GetFeaturesByIDsParameters
 * @deprecatedclass SuperMap.GetFeaturesByIDsParameters
 * @category  iServer Data FeatureResults
 * @classdesc ID æ¥è¯¢åæ°ç±»ã
 * @param {Object} options - åæ°ã
 * @param {Array.<number>} options.IDs - æå®æ¥è¯¢çåç´  ID ä¿¡æ¯ã
 * @param {Array.<string>} [options.fields] - è®¾ç½®æ¥è¯¢ç»æè¿åå­æ®µãé»è®¤è¿åææå­æ®µã
 * @param {Array.<string>} options.dataSetNames - æ°æ®ééåä¸­çæ°æ®éåç§°åè¡¨ã
 * @param {boolean} [options.returnContent=true] - æ¯å¦ç´æ¥è¿åæ¥è¯¢ç»æã
 * @param {number} [options.fromIndex=0] - æ¥è¯¢ç»æçæå°ç´¢å¼å·ã
 * @param {number} [options.toIndex=19] - æ¥è¯¢ç»æçæå¤§ç´¢å¼å·ã
 * @param {string|number} [options.targetEpsgCode] - å¨ææå½±çç®æ åæ ç³»å¯¹åºç EPSG Codeï¼ä½¿ç¨æ­¤åæ°æ¶ï¼returnContent åæ°éä¸º trueã
 * @param {Object} [options.targetPrj] - å¨ææå½±çç®æ åæ ç³»ãä½¿ç¨æ­¤åæ°æ¶ï¼returnContent åæ°éä¸º trueã å¦ï¼prjCoordSys={"epsgCode":3857}ãå½åæ¶è®¾ç½® targetEpsgCode åæ°æ¶ï¼æ­¤åæ°ä¸çæã
 * @param {MetricsAggParameter|GeoHashGridAggParameter} [options.aggregations] - èåæ¥è¯¢åæ°ãè¯¥åæ°ä»æ¯ææ°æ®æ¥æº Elasticsearch æå¡çSupermap iServerçrestæ°æ®æå¡ã
 * @extends {GetFeaturesParametersBase}
 * @usage
 */
class GetFeaturesByIDsParameters extends GetFeaturesParametersBase {
    constructor(options) {
        super(options);
        /**
         * @member {string} GetFeaturesByIDsParameters.prototype.getFeatureMode
         * @description æ°æ®éæ¥è¯¢æ¨¡å¼ã
         */
        this.getFeatureMode = 'ID';

        /**
         * @member {Array.<number>} GetFeaturesByIDsParameters.prototype.IDs
         * @description æè¦æ¥è¯¢æå®çåç´  ID ä¿¡æ¯ã
         */
        this.IDs = null;

        /**
         *  @member {Array.<string>} GetFeaturesByIDsParameters.prototype.fields
         *  @description è®¾ç½®æ¥è¯¢ç»æè¿åå­æ®µãå½æå®äºè¿åç»æå­æ®µåï¼å GetFeaturesResult ä¸­ç features çå±æ§å­æ®µåªåå«ææå®çå­æ®µãä¸è®¾ç½®å³è¿åå¨é¨å­æ®µã
         */
        this.fields = null;
        Util.extend(this, options);

        this.CLASS_NAME = 'SuperMap.GetFeaturesByIDsParameters';
    }

    /**
     * @function GetFeaturesByIDsParameters.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
        var me = this;
        me.IDs = null;
        me.getFeatureMode = null;
        if (me.fields) {
            while (me.fields.length > 0) {
                me.fields.pop();
            }
            me.fields = null;
        }
    }

    /**
     * @function GetFeaturesByIDsParameters.toJsonParameters
     * @description å° GetFeaturesByIDsParameters å¯¹è±¡è½¬æ¢ä¸º JSON å­ç¬¦ä¸²ã
     * @param {GetFeaturesByIDsParameters} params - ID æ¥è¯¢åæ°å¯¹è±¡ã
     * @returns {string} è½¬ååç JSON å­ç¬¦ä¸²ã
     */
    static toJsonParameters(params) {
        var parasByIDs, filterParameter;

        parasByIDs = {
            datasetNames: params.datasetNames,
            getFeatureMode: 'ID',
            ids: params.IDs
        };
        if (params.fields) {
            filterParameter = new FilterParameter();
            filterParameter.name = params.datasetNames;
            filterParameter.fields = params.fields;
            parasByIDs.queryParameter = filterParameter;
        }
        if (params.targetEpsgCode) {
            parasByIDs.targetEpsgCode = params.targetEpsgCode;
        }

        if (typeof params.hasGeometry === 'boolean') {
            parasByIDs.hasGeometry = params.hasGeometry;
        }

        if (!params.targetEpsgCode && params.targetPrj) {
            parasByIDs.targetPrj = params.targetPrj;
        }
        if (params.aggregations) {
            parasByIDs.aggregations = params.aggregations;
        }

        return Util.toJSON(parasByIDs);
    }
}


;// CONCATENATED MODULE: ./src/common/iServer/GetFeaturesByIDsService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class GetFeaturesByIDsService
 * @deprecatedclass SuperMap.GetFeaturesByIDsService
 * @category iServer Data FeatureResults
 * @classdesc æ°æ®éIDæ¥è¯¢æå¡ç±»ãå¨æ°æ®ééåä¸­æ¥æ¾æå® ID å·å¯¹åºçç©ºé´å°ç©è¦ç´ ã
 * @param {string} url - æå¡å°åãè¯·æ±æ°æ®æå¡ä¸­æ°æ®éæ¥è¯¢æå¡ã
 *                       URL åºä¸ºï¼http://{æå¡å¨å°å}:{æå¡ç«¯å£å·}/iserver/services/{æ°æ®æå¡å}/rest/data/ï¼</br>
 *                       ä¾å¦ï¼"http://localhost:8090/iserver/services/data-jingjin/rest/data/"
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - äºä»¶çå¬å¨å¯¹è±¡ãæprocessCompletedå±æ§å¯ä¼ å¥å¤çå®æåçåè°å½æ°ãprocessFailedå±æ§ä¼ å¥å¤çå¤±è´¥åçåè°å½æ°ã
 * @param {DataFormat} [options.format=DataFormat.GEOJSON] - æ¥è¯¢ç»æè¿åæ ¼å¼ï¼ç®åæ¯æ iServerJSON å GeoJSON ä¸¤ç§æ ¼å¼ãåæ°æ ¼å¼ä¸º "ISERVER"ï¼"GEOJSON"ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @extends {GetFeaturesServiceBase}
 * @example
 * var myGetFeaturesByIDsService = new GetFeaturesByIDsService(url, {
 *     eventListeners: {
 *         "processCompleted": getFeatureCompleted,
 *         "processFailed": getFeatureError
 *            }
 *     });
 * function getFeatureCompleted(object){//todo};
 * function getFeatureError(object){//todo}
 * @usage
 */
class GetFeaturesByIDsService extends GetFeaturesServiceBase {


    constructor(url, options) {
        super(url, options);

        this.CLASS_NAME = "SuperMap.GetFeaturesByIDsService";
    }

    /**
     * @function GetFeaturesByIDsService.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function GetFeaturesByIDsService.prototype.getJsonParameters
     * @description å°æ¥è¯¢åæ°è½¬åä¸º JSON å­ç¬¦ä¸²ã
     * å¨æ¬ç±»ä¸­éåæ­¤æ¹æ³ï¼å¯ä»¥å®ç°ä¸åç§ç±»çæ¥è¯¢ï¼ID, SQL, Buffer, Geometryç­ï¼ã
     * @param {GetFeaturesByIDsParameters} params - IDæ¥è¯¢åæ°ç±»ã
     * @returns {string} è½¬ååç JSON å­ç¬¦ä¸²ã
     */
    getJsonParameters(params) {
        return GetFeaturesByIDsParameters.toJsonParameters(params);
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/GetFeaturesBySQLParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class GetFeaturesBySQLParameters
 * @deprecatedclass SuperMap.GetFeaturesBySQLParameters
 * @category iServer Data FeatureResults
 * @classdesc æ°æ®é SQL æ¥è¯¢åæ°ç±»ã
 * @param {Object} options - åæ°ã
 * @param {FilterParameter} options.queryParameter - æ¥è¯¢è¿æ»¤æ¡ä»¶åæ°ã
 * @param {Array.<string>} options.datasetNames - æ°æ®ééåä¸­çæ°æ®éåç§°åè¡¨ã
 * @param {boolean} [options.returnContent=true] - æ¯å¦ç´æ¥è¿åæ¥è¯¢ç»æã
 * @param {number} [options.fromIndex=0] - æ¥è¯¢ç»æçæå°ç´¢å¼å·ã
 * @param {number} [options.toIndex=19] - æ¥è¯¢ç»æçæå¤§ç´¢å¼å·ã
 * @param {string|number} [options.targetEpsgCode] - å¨ææå½±çç®æ åæ ç³»å¯¹åºç EPSG Codeï¼ä½¿ç¨æ­¤åæ°æ¶ï¼returnContent åæ°éä¸º trueã
 * @param {Object} [options.targetPrj] - å¨ææå½±çç®æ åæ ç³»ãä½¿ç¨æ­¤åæ°æ¶ï¼returnContent åæ°éä¸º trueã å¦ï¼prjCoordSys={"epsgCode":3857}ãå½åæ¶è®¾ç½® targetEpsgCode åæ°æ¶ï¼æ­¤åæ°ä¸çæã
 * @param {MetricsAggParameter|GeoHashGridAggParameter} [options.aggregations] - èåæ¥è¯¢åæ°ãè¯¥åæ°ä»æ¯ææ°æ®æ¥æº Elasticsearch æå¡çSupermap iServerçrestæ°æ®æå¡ã
 * @extends {GetFeaturesParametersBase}
 * @usage
 */
class GetFeaturesBySQLParameters extends GetFeaturesParametersBase {
    constructor(options) {
        super(options);
        /**
         * @member {string} GetFeaturesBySQLParameters.prototype.getFeatureMode
         * @description æ°æ®éæ¥è¯¢æ¨¡å¼ã
         */
        this.getFeatureMode = 'SQL';

        /**
         * @member {FilterParameter} GetFeaturesBySQLParameters.prototype.queryParameter
         * @description æ¥è¯¢è¿æ»¤æ¡ä»¶åæ°ç±»ã
         */
        this.queryParameter = null;

        Util.extend(this, options);

        this.CLASS_NAME = 'SuperMap.GetFeaturesBySQLParameters';
    }

    /**
     * @function GetFeaturesBySQLParameters.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
        var me = this;
        me.getFeatureMode = null;
        if (me.queryParameter) {
            me.queryParameter.destroy();
            me.queryParameter = null;
        }
    }

    /**
     * @function GetFeaturesBySQLParameters.prototype.toJsonParameters
     * @description å° GetFeaturesBySQLParameters å¯¹è±¡è½¬æ¢ä¸º JSON å­ç¬¦ä¸²ã
     * @param {GetFeaturesBySQLParameters} params - æ°æ®é SQL æ¥è¯¢åæ°å¯¹è±¡ã
     * @returns {string} è½¬ååç JSON å­ç¬¦ä¸²ã
     */
    static toJsonParameters(params) {
        var paramsBySql = {
            datasetNames: params.datasetNames,
            getFeatureMode: 'SQL',
            queryParameter: params.queryParameter
        };
        if (params.maxFeatures && !isNaN(params.maxFeatures)) {
            paramsBySql.maxFeatures = params.maxFeatures;
        }
        if (typeof params.hasGeometry === 'boolean') {
            paramsBySql.hasGeometry = params.hasGeometry;
        }
        if (params.aggregations) {
            paramsBySql.aggregations = params.aggregations;
        }
        if (params.targetEpsgCode) {
            paramsBySql.targetEpsgCode = params.targetEpsgCode;
        }
        if (!params.targetEpsgCode && params.targetPrj) {
            paramsBySql.targetPrj = params.targetPrj;
        }
        if (params.aggregations) {
            paramsBySql.aggregations = params.aggregations;
        }
        return Util.toJSON(paramsBySql);
    }
}


;// CONCATENATED MODULE: ./src/common/iServer/GetFeaturesBySQLService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class GetFeaturesBySQLService
 * @deprecatedclass SuperMap.GetFeaturesBySQLService
 * @constructs GetFeaturesBySQLService
 * @category iServer Data FeatureResults
 * @classdesc æ°æ®æå¡ä¸­æ°æ®é SQL æ¥è¯¢æå¡ç±»ãå¨ä¸ä¸ªæå¤ä¸ªæå®çå¾å±ä¸æ¥è¯¢ç¬¦å SQL æ¡ä»¶çç©ºé´å°ç©ä¿¡æ¯ã
 * @param {string} url - æå¡å°åãè¯·æ±æ°æ®æå¡ä¸­æ°æ®éæ¥è¯¢æå¡ï¼
 *                       URL åºä¸ºï¼http://{æå¡å¨å°å}:{æå¡ç«¯å£å·}/iserver/services/{æ°æ®æå¡å}/rest/data/ï¼</br>
 *                       ä¾å¦ï¼"http://localhost:8090/iserver/services/data-jingjin/rest/data/"
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - äºä»¶çå¬å¨å¯¹è±¡ãæprocessCompletedå±æ§å¯ä¼ å¥å¤çå®æåçåè°å½æ°ãprocessFailedå±æ§ä¼ å¥å¤çå¤±è´¥åçåè°å½æ°ã
 * @param {DataFormat} [options.format=DataFormat.GEOJSON] - æ¥è¯¢ç»æè¿åæ ¼å¼ï¼ç®åæ¯æ iServerJSON å GeoJSON ä¸¤ç§æ ¼å¼ãåæ°æ ¼å¼ä¸º "ISERVER"ï¼"GEOJSON"ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @extends {GetFeaturesServiceBase}
 * @example
 * var myGetFeaturesBySQLService = new GetFeaturesBySQLService(url, {
     *     eventListeners: {
     *         "processCompleted": GetFeaturesCompleted,
     *         "processFailed": GetFeaturesError
     *         }
     * });
 * function getFeaturesCompleted(object){//todo};
 * function getFeaturesError(object){//todo};
 * @usage
 */
class GetFeaturesBySQLService extends GetFeaturesServiceBase {

    constructor(url, options) {
        super(url, options);
        this.CLASS_NAME = "SuperMap.GetFeaturesBySQLService";
    }

    /**
     * @function GetFeaturesBySQLService.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
    }

    /*
     * @function GetFeaturesBySQLService.prototype.getJsonParameters
     * @description å°æ¥è¯¢åæ°è½¬åä¸º JSON å­ç¬¦ä¸²ã
     * å¨æ¬ç±»ä¸­éåæ­¤æ¹æ³ï¼å¯ä»¥å®ç°ä¸åç§ç±»çæ¥è¯¢ï¼ID, SQL, Buffer, Geometryç­ï¼ã
     * @param {GetFeaturesBySQLParameters} params - æ°æ®éSQLæ¥è¯¢åæ°ç±»ã
     * @returns {string} è½¬ååç JSON å­ç¬¦ä¸²ã
     */
    getJsonParameters(params) {
        return GetFeaturesBySQLParameters.toJsonParameters(params);
    }


}

;// CONCATENATED MODULE: ./src/common/iServer/GetFieldsService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class GetFieldsService
 * @deprecatedclass SuperMap.GetFieldsService
 * @category iServer Data Field
 * @classdesc å­æ®µæ¥è¯¢æå¡ï¼æ¯ææ¥è¯¢æå®æ°æ®éçä¸­ææå±æ§å­æ®µï¼fieldï¼çéåã
 * @param {string} url - æå¡å°åãå¦è®¿é®World Mapæå¡ï¼åªéå°urlè®¾ä¸ºï¼http://localhost:8090/iserver/services/data-world/rest/data å³å¯ã
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - äºä»¶çå¬å¨å¯¹è±¡ãæprocessCompletedå±æ§å¯ä¼ å¥å¤çå®æåçåè°å½æ°ãprocessFailedå±æ§ä¼ å¥å¤çå¤±è´¥åçåè°å½æ°ã
 * @param {DataFormat} [options.format=DataFormat.GEOJSON] - æ¥è¯¢ç»æè¿åæ ¼å¼ï¼ç®åæ¯æ iServerJSON å GeoJSON ä¸¤ç§æ ¼å¼ãåæ°æ ¼å¼ä¸º "ISERVER"ï¼"GEOJSON"ã
 * @param {string}options.datasource - æ°æ®æºåç§°ã
 * @param {string}options.dataset - æ°æ®éåç§°ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @extends {CommonServiceBase}
 * @example
 * var myService = new GetFieldsService(url, {eventListeners: {
 *     "processCompleted": getFieldsCompleted,
 *     "processFailed": getFieldsError
 *     },
 *     datasource: "World",
 *     dataset: "Countries"
 * };
 * @usage
 */
class GetFieldsService extends CommonServiceBase {


    constructor(url, options) {
        super(url, options);
        /**
         * @member {string} GetFieldsService.prototype.datasource
         * @description è¦æ¥è¯¢çæ°æ®éæå¨çæ°æ®æºåç§°ã
         */
        this.datasource = null;

        /**
         *  @member {string} GetFieldsService.prototype.dataset
         *  @description è¦æ¥è¯¢çæ°æ®éåç§°ã
         */
        this.dataset = null;
        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = "SuperMap.GetFieldsService";
    }


    /**
     * @function GetFieldsService.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
        var me = this;
        me.datasource = null;
        me.dataset = null;
    }


    /**
     * @function GetFieldsService.prototype.processAsync
     * @description æ§è¡æå¡ï¼æ¥è¯¢æå®æ°æ®éçå­æ®µä¿¡æ¯ã
     */
    processAsync() {
        var me = this;
        me.url = Util.urlPathAppend(me.url,`datasources/${me.datasource}/datasets/${me.dataset}/fields`);
        me.request({
            method: "GET",
            data: null,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }
}

;// CONCATENATED MODULE: ./src/common/iServer/GetGridCellInfosParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class GetGridCellInfosParameters
 * @deprecatedclass SuperMap.GetGridCellInfosParameters
 * @category iServer Data Grid
 * @classdesc æ°æ®æå¡æ æ ¼æ¥è¯¢åæ°ç±»ã
 * @param {Object} options - åæ°ã
 * @param {string} options.datasetName - æ°æ®éåç§°ã
 * @param {string} options.dataSourceName - æ°æ®æºåç§°ã
 * @param {number} options.X - å°çä½ç½® X è½´ã
 * @param {number} options.Y - å°çä½ç½® Y è½´ã
 * @usage
 */
class GetGridCellInfosParameters {


    constructor(options) {
        /**
         * @member {string} GetGridCellInfosParameters.prototype.datasetName
         * @description æ°æ®éåç§°ã
         */
        this.datasetName = null;

        /**
         * @member {string} GetGridCellInfosParameters.prototype.dataSourceName
         * @description æ°æ®æºåç§°ã
         */
        this.dataSourceName = null;

        /**
         * @member {number} GetGridCellInfosParameters.prototype.X
         * @description è¦æ¥è¯¢çå°çä½ç½® X è½´ã
         */
        this.X = null;

        /**
         * @member {number} GetGridCellInfosParameters.prototype.Y
         * @description è¦æ¥è¯¢çå°çä½ç½® Y è½´ã
         */
        this.Y = null;
        Util.extend(this, options);

        this.CLASS_NAME = "SuperMap.GetGridCellInfosParameters";
    }


    /**
     * @function GetGridCellInfosParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨çèµæºå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.datasetName = null;
        me.dataSourceName = null;
        me.X = null;
        me.Y = null;
    }


}


;// CONCATENATED MODULE: ./src/common/iServer/GetGridCellInfosService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class GetGridCellInfosService
 * @deprecatedclass SuperMap.GetGridCellInfosService
 * @category iServer Data Grid
 * @classdesc æ°æ®æ æ ¼æ¥è¯¢æå¡ï¼æ¯ææ¥è¯¢æå®å°çä½ç½®çæ æ ¼ä¿¡æ¯ã
 * @param {string} url - æå¡å°åãä¾å¦: http://localhost:8090/iserver/services/data-jingjin/rest/data
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - äºä»¶çå¬å¨å¯¹è±¡ãæprocessCompletedå±æ§å¯ä¼ å¥å¤çå®æåçåè°å½æ°ãprocessFailedå±æ§ä¼ å¥å¤çå¤±è´¥åçåè°å½æ°ã<br>
 * @param {DataFormat} [options.format=DataFormat.GEOJSON] - æ¥è¯¢ç»æè¿åæ ¼å¼ï¼ç®åæ¯æ iServerJSON å GeoJSON ä¸¤ç§æ ¼å¼ãåæ°æ ¼å¼ä¸º "ISERVER"ï¼"GEOJSON"ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @extends {CommonServiceBase}
 * @example
 * var myService = new GetGridCellInfosService(url, {eventListeners: {
 *     "processCompleted": queryCompleted,
 *     "processFailed": queryError
 *     }
 * });
 * @usage
 */
class GetGridCellInfosService extends CommonServiceBase {


    constructor(url, options) {
        super(url, options);
        /**
         * @member {string} GetGridCellInfosService.prototype.datasetName
         * @description æ°æ®éåç§°ã
         */
        this.datasetName = null;

        /**
         * @member {string} GetGridCellInfosService.prototype.dataSourceName
         * @description æ°æ®æºåç§°ã
         */
        this.dataSourceName = null;

        /**
         * @member {string} GetGridCellInfosService.prototype.datasetType
         * @description æ°æ®éç±»åã
         */
        this.datasetType = null;

        /**
         * @member {number} GetGridCellInfosService.prototype.X
         * @description è¦æ¥è¯¢çå°çä½ç½®Xè½´
         */
        this.X = null;

        /**
         * @member {number} GetGridCellInfosService.prototype.Y
         * @description è¦æ¥è¯¢çå°çä½ç½®Yè½´
         */
        this.Y = null;
        if (options) {
            Util.extend(this, options);
        }
        this.CLASS_NAME = "SuperMap.GetGridCellInfosService";
    }

    /**
     * @function GetGridCellInfosService.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
        var me = this;
        me.X = null;
        me.Y = null;
        me.datasetName = null;
        me.dataSourceName = null;
        me.datasetType = null;
    }

    /**
     * @function GetGridCellInfosService.prototype.processAsync
     * @description æ§è¡æå¡ï¼æ¥è¯¢æ°æ®éä¿¡æ¯ã
     * @param {GetGridCellInfosParameters} params - æ¥è¯¢åæ°ã
     */
    processAsync(params) {
        if (!(params instanceof GetGridCellInfosParameters)) {
            return;
        }
        Util.extend(this, params);
        var me = this;
        me.url = Util.urlPathAppend(me.url,`datasources/${me.dataSourceName}/datasets/${me.datasetName}`);
        me.queryRequest(me.getDatasetInfoCompleted, me.getDatasetInfoFailed);
    }

    /**
     * @function GetGridCellInfosService.prototype.queryRequest
     * @description æ§è¡æå¡ï¼æ¥è¯¢ã
     * @callback {function} successFun - æååæ§è¡çå½æ°ã
     * @callback {function} failedFunc - å¤±è´¥åæ§è¡çå½æ°ã
     */
    queryRequest(successFun, failedFunc) {
        var me = this;
        me.request({
            method: "GET",
            data: null,
            scope: me,
            success: successFun,
            failure: failedFunc
        });
    }

    /**
     * @function GetGridCellInfosService.prototype.getDatasetInfoCompleted
     * @description æ°æ®éæ¥è¯¢å®æï¼æ§è¡æ­¤æ¹æ³ã
     * @param {Object} result - æå¡å¨è¿åçç»æå¯¹è±¡ã
     */
    getDatasetInfoCompleted(result) {
        var me = this;
        result = Util.transformResult(result);
        me.datasetType = result.datasetInfo.type;
        me.queryGridInfos();
    }

    /**
     * @function GetGridCellInfosService.prototype.queryGridInfos
     * @description æ§è¡æå¡ï¼æ¥è¯¢æ°æ®éæ æ ¼ä¿¡æ¯ä¿¡æ¯ã
     */
    queryGridInfos() {
        var me = this;
        me.url = Util.urlPathAppend(me.url, me.datasetType == 'GRID' ? 'gridValue' : 'imageValue');
        if (me.X != null && me.Y != null) {
            me.url = Util.urlAppend(me.url, `x=${me.X}&y=${me.Y}`);
        }
        me.queryRequest(me.serviceProcessCompleted, me.serviceProcessFailed);
    }


    /**
     * @function GetGridCellInfosService.prototype.getDatasetInfoFailed
     * @description æ°æ®éæ¥è¯¢å¤±è´¥ï¼æ§è¡æ­¤æ¹æ³ã
     * @param {Object} result - æå¡å¨è¿åçç»æå¯¹è±¡ã
     */
    getDatasetInfoFailed(result) {
        var me = this;
        me.serviceProcessFailed(result);
    }
}

;// CONCATENATED MODULE: ./src/common/iServer/Theme.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class CommonTheme
 * @aliasclass Theme
 * @deprecatedclass SuperMap.Theme
 * @category  iServer Map Theme
 * @classdesc ä¸é¢å¾åºç±»ã
 * @param {string} type - ä¸é¢å¾ç±»åã
 * @param {Object} options - å¯éåæ°ã
 * @param {ThemeMemoryData} [options.memoryData] - ä¸é¢å¾åå­æ°æ®ã
 * @usage
 */
class Theme {

    constructor(type, options) {
        if (!type) {
            return this;
        }
        /**
         * @member {ThemeMemoryData} CommonTheme.prototype.memoryData
         * @description ä¸é¢å¾åå­æ°æ®ã<br>
         *              ç¨åå­æ°æ®å¶ä½ä¸é¢å¾çæ¹å¼ä¸è¡¨è¾¾å¼å¶ä½ä¸é¢å¾çæ¹å¼äºæ¥ï¼åèä¼åçº§è¾é«ã
         *              ç¬¬ä¸ä¸ªåæ°ä»£è¡¨ä¸é¢å¼ï¼å³æ°æ®éä¸­ç¨æ¥åä¸é¢å¾çå­æ®µæè¡¨è¾¾å¼çå¼ï¼ç¬¬äºä¸ªåæ°ä»£è¡¨å¤é¨å¼ãå¨å¶ä½ä¸é¢å¾æ¶ï¼ä¼ç¨å¤é¨å¼ä»£æ¿ä¸é¢å¼æ¥å¶ä½ç¸åºçä¸é¢å¾ã
         */
        this.memoryData = null;

        /**
         * @member {string} CommonTheme.prototype.type
         * @description ä¸é¢å¾ç±»åã
         */
        this.type = type;

        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = "SuperMap.Theme";
    }

    /**
     * @function CommonTheme.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        if (me.memoryData) {
            me.memoryData.destroy();
            me.memoryData = null;
        }
        me.type = null;
    }

    /**
     * @function CommonTheme.prototype.toServerJSONObject
     * @description è½¬æ¢æå¯¹åºç JSON æ ¼å¼å¯¹è±¡ã
     * @returns {Object} å¯¹åºç JSON æ ¼å¼å¯¹è±¡ã
     */
    toServerJSONObject() {
        //return å­ç±»å®ç°
        return;
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/ServerTextStyle.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class ServerTextStyle
 * @deprecatedclass SuperMap.ServerTextStyle
 * @category  iServer Map Theme
 * @classdesc æå¡ç«¯ææ¬é£æ ¼ç±»ãè¯¥ç±»ç¨äºå®ä¹ææ¬é£æ ¼çç¸å³å±æ§ã
 * @param {Object} options - å¯éåæ°ã
 * @param {TextAlignment} [options.align=TextAlignment.BASELINECENTER] - ææ¬çå¯¹é½æ¹å¼ã
 * @param {ServerColor} [options.backColor] - ææ¬çèæ¯è²ãé»è®¤ backColor = new ServerColor(255, 255, 255)ã
 * @param {ServerColor} [options.foreColor] - ææ¬çåæ¯è²ãé»è®¤ foreColor = new ServerColor(0, 0, 0)ã
 * @param {boolean} [options.backOpaque=false] - ææ¬èæ¯æ¯å¦ä¸éæã
 * @param {boolean} [options.sizeFixed=true] - ææ¬å¤§å°æ¯å¦åºå®ã
 * @param {number} [options.fontHeight=6] - ææ¬å­ä½çé«åº¦ã
 * @param {number} [options.fontWidth=0] - ææ¬å­ä½çå®½åº¦ã
 * @param {number} [options.fontWeight=400] - ææ¬å­ä½çç£æ°ã
 * @param {string} [options.fontName='Times New Roman'] - ææ¬å­ä½çåç§°ã
 * @param {boolean} [options.bold=false] - ææ¬æ¯å¦ä¸ºç²ä½å­ã
 * @param {boolean} [options.italic=false] - ææ¬æ¯å¦éç¨æä½ã
 * @param {number} [options.italicAngle=0] - å­ä½å¾æè§åº¦ã
 * @param {boolean} [options.shadow=false] - ææ¬æ¯å¦æé´å½±ã
 * @param {boolean} [options.strikeout=false] - ææ¬å­ä½æ¯å¦å å é¤çº¿ã
 * @param {boolean} [options.outline=false] - æ¯å¦ä»¥è½®å»çæ¹å¼æ¥æ¾ç¤ºææ¬çèæ¯ã
 * @param {number} [options.opaqueRate=0] - æ³¨è®°æå­çä¸éæåº¦ã
 * @param {boolean} [options.underline=false] - ææ¬å­ä½æ¯å¦å ä¸åçº¿ã
 * @param {number} [options.rotation=0.0] -  ææ¬æè½¬çè§åº¦ã
 * @usage
 */
class ServerTextStyle {


    constructor(options) {
        /**
         * @member {TextAlignment} [ServerTextStyle.prototype.align= TextAlignment.BASELINECENTER]
         * @description ææ¬çå¯¹é½æ¹å¼ã
         */
        this.align = TextAlignment.BASELINECENTER;

        /**
         * @member {ServerColor} [ServerTextStyle.prototype.backColor=(255, 255, 255)]
         * @description ææ¬çèæ¯è²ã
         */
        this.backColor = new ServerColor(255, 255, 255);

        /**
         * @member {ServerColor} [ServerTextStyle.prototype.foreColor=(0, 0, 0)]
         * @description ææ¬çåæ¯è²ã
         */
        this.foreColor = new ServerColor(0, 0, 0);

        /**
         * @member {boolean} [ServerTextStyle.prototype.backOpaque=false]
         * @description ææ¬èæ¯æ¯å¦ä¸éæãtrue è¡¨ç¤ºææ¬èæ¯ä¸éæã
         */
        this.backOpaque = false;

        /**
         * @member {boolean} [ServerTextStyle.prototype.sizeFixed=true]
         * @description ææ¬å¤§å°æ¯å¦åºå®ãè®¾ç½®ä¸º trueï¼è¡¨ç¤ºå¾çä¸ºåºå®åç´ å¤§å°ï¼å·ä½å¤§å°è¯·åè fontHeightãå½è®¾ä¸º false æ¶ï¼å¾çä¼éçå°å¾ç¼©æ¾èç¼©æ¾ã
         */
        this.sizeFixed = true;

        /**
         * @member {number} [ServerTextStyle.prototype.fontHeight=6]
         * @description ææ¬å­ä½çé«åº¦ï¼åä½ä¸ sizeFixed æå³ï¼å½ sizeFixed ä¸º False æ¶ï¼å³éåºå®ææ¬å¤§å°æ¶ä½¿ç¨å°å¾åæ åä½ï¼
         *              å¦å°çåæ ç³»ä¸çå°å¾ä¸­åä½ä¸ºåº¦ï¼å½ sizeFixed ä¸º True æ¶ï¼åä½ä¸ºæ¯«ç±³ï¼mmï¼ã
         */
        this.fontHeight = 6;

        /**
         * @member {number} [ServerTextStyle.prototype.fontWidth=0]
         * @description ææ¬å­ä½çå®½åº¦ãå­ä½çå®½åº¦ä»¥è±æå­ç¬¦ä¸ºæ åï¼ç±äºä¸ä¸ªä¸­æå­ç¬¦ç¸å½äºä¸¤ä¸ªè±æå­ç¬¦ã
         */
        this.fontWidth = 0;

        /**
         * @member {number} [ServerTextStyle.prototype.fontWeight=400]
         * @description ææ¬å­ä½çç£æ°ãè¡¨ç¤ºç²ä½çå·ä½æ°å¼ãåå¼èå´ä¸ºä»0ï¼900ä¹é´çæ´ç¾æ°ã
         */
        this.fontWeight = 400;

        /**
         * @member {string} [ServerTextStyle.prototype.fontName="Times New Roman"]
         * @description ææ¬å­ä½çåç§°ã
         */
        this.fontName = "Times New Roman";

        /**
         * @member {boolean} [ServerTextStyle.prototype.bold=false]
         * @description ææ¬æ¯å¦ä¸ºç²ä½å­ãtrue è¡¨ç¤ºä¸ºç²ä½ãfalse è¡¨ç¤ºææ¬ä¸æ¯ç²ä½å­ã
         */
        this.bold = false;

        /**
         * @member {boolean} [ServerTextStyle.prototype.italic=false]
         * @description ææ¬æ¯å¦éç¨æä½ãtrue è¡¨ç¤ºéç¨æä½ã
         */
        this.italic = false;

        /**
         * @member {number} [ServerTextStyle.prototype.italicAngle=0]
         * @description å­ä½å¾æè§åº¦ãæ­£è´åº¦ä¹é´ï¼ä»¥åº¦ä¸ºåä½ï¼ç²¾ç¡®å°0.1åº¦ãå½å¾æè§åº¦ä¸º0åº¦ï¼ä¸ºç³»ç»é»è®¤çå­ä½å¾ææ ·å¼ã
         *              æ­£è´åº¦æ¯æä»¥çºµè½´ä¸ºèµ·å§é¶åº¦çº¿ï¼å¶çºµè½´å·¦ä¾§ä¸ºæ­£ï¼å³ä¾§ä¸ºè´ãåè®¸çæå¤§è§åº¦ä¸º60ï¼æå°-60ãå¤§äº60æç§60å¤çï¼å°äº-60æç§-60å¤çãç®ååªå¯¹æ ç­¾ä¸é¢å¾ææã
         */
        this.italicAngle = 0;

        /**
         * @member {boolean} [ServerTextStyle.prototype.shadow=false]
         * @description ææ¬æ¯å¦æé´å½±ãtrue è¡¨ç¤ºç»ææ¬å¢å é´å½±ãfalse è¡¨ç¤ºææ¬æ²¡æé´å½±ã
         */
        this.shadow = false;

        /**
         * @member {boolean} [ServerTextStyle.prototype.strikeout=false]
         * @description ææ¬å­ä½æ¯å¦å å é¤çº¿ãtrue è¡¨ç¤ºå å é¤çº¿ãfalse è¡¨ç¤ºææ¬å­ä½ä¸å å é¤çº¿ã
         */
        this.strikeout = false;

        /**
         * @member {boolean} [ServerTextStyle.prototype.outline=false]
         * @description æ¯å¦ä»¥è½®å»çæ¹å¼æ¥æ¾ç¤ºææ¬çèæ¯ãtrue è¡¨ç¤ºä»¥è½®å»çæ¹å¼æ¥æ¾ç¤ºææ¬çèæ¯ãfalse è¡¨ç¤ºä¸ä»¥è½®å»çæ¹å¼æ¥æ¾ç¤ºææ¬çèæ¯ã
         */
        this.outline = false;

        /**
         * @member {number} [ServerTextStyle.prototype.opaqueRate=0]
         * @description æ³¨è®°æå­çä¸éæåº¦ãä¸éæåº¦çèå´ä¸º0-100ã0è¡¨ç¤ºéæã
         */
        this.opaqueRate = 0;

        /**
         * @member {boolean} [ServerTextStyle.prototype.underline=false]
         * @description ææ¬å­ä½æ¯å¦å ä¸åçº¿ãtrue è¡¨ç¤ºå ä¸åçº¿ã
         */
        this.underline = false;

        /**
         * @member {number} [ServerTextStyle.prototype.rotation=0.0]
         * @description ææ¬æè½¬çè§åº¦ãéæ¶éæ¹åä¸ºæ­£æ¹åï¼åä½ä¸ºåº¦ï¼ç²¾ç¡®å°0.1åº¦ã
         */
        this.rotation = 0.0;

        if (options) {
            Util.extend(this, options);
        }

       this.CLASS_NAME = "SuperMap.ServerTextStyle";
    }


    /**
     * @function ServerTextStyle.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.align = null;
        if (me.backColor) {
            me.backColor.destroy();
            me.backColor = null;
        }
        if (me.foreColor) {
            me.foreColor.destroy();
            me.foreColor = null;
        }
        me.backOpaque = null;
        me.sizeFixed = null;
        me.fontHeight = null;
        me.fontWidth = null;
        me.fontWeight = null;
        me.fontName = null;
        me.bold = null;
        me.italic = null;
        me.italicAngle = null;
        me.shadow = null;
        me.strikeout = null;
        me.outline = null;
        me.opaqueRate = null;
        me.underline = null;
        me.rotation = null;
    }

    /**
     * @function ServerTextStyle.fromObj
     * @description ä»ä¼ å¥å¯¹è±¡è·æå¡ç«¯ææ¬é£æ ¼ç±»ã
     * @param {Object} obj - ä¼ å¥å¯¹è±¡
     * @returns {ServerTextStyle} è¿åæå¡ç«¯ææ¬é£æ ¼å¯¹è±¡
     */
    static fromObj(obj) {
        var res = new ServerTextStyle(obj);
        Util.copy(res, obj);
        res.backColor = ServerColor.fromJson(obj.backColor);
        res.foreColor = ServerColor.fromJson(obj.foreColor);
        return res;
    }

}


;// CONCATENATED MODULE: ./src/common/iServer/ThemeLabelItem.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class ThemeLabelItem
 * @deprecatedclass SuperMap.ThemeLabelItem
 * @category  iServer Map Theme
 * @classdesc åæ®µæ ç­¾ä¸é¢å¾çå­é¡¹ãæ ç­¾ä¸é¢å¾ç¨ä¸é¢å¼å¯¹ç¹ãçº¿ãé¢ç­å¯¹è±¡åæ æ³¨ã
 * å¼å¾æ³¨æçæ¯ï¼åæ®µæ ç­¾ä¸é¢å¾åè®¸ç¨æ·éè¿ rangeExpression å­æ®µæå®ç¨äºåæ®µçæ°å¼åå­æ®µï¼
 * åä¸èå´æ®µåçæ ç­¾å·æç¸åçæ¾ç¤ºé£æ ¼ï¼å¶ä¸­æ¯ä¸ä¸ªèå´æ®µå°±æ¯ä¸ä¸ªä¸é¢å¾å­é¡¹ï¼
 * æ¯ä¸ä¸ªå­é¡¹é½å·æå¶åç§°ãé£æ ¼ãèµ·å§å¼åç»æ­¢å¼ãæ³¨æï¼æ¯ä¸ªåæ®µæè¡¨ç¤ºçèå´ä¸º [Start, End)ãä¾å¦ï¼æ ç­¾ä¸é¢å¾çåæ®µç¹æä¸¤ä¸ªå­é¡¹ï¼
 * ä»ä»¬æä»£è¡¨çåæ®µåºé´åå«ä¸º[0,5)ï¼[5,10)ãé£ä¹éè¦åå«è®¾ç½® ThemeLabelItem[0].start=0ï¼
 *  ThemeLabelItem[0].end=5ï¼SuperMap.ThemeLabelItem[1].start=5ï¼SuperMap.ThemeLabelItem[1].end=10ã
 * @param {Object} options - å¯éåæ°ã
 * @param {string} [options.caption] - å­é¡¹çåç§°ã
 * @param {number} [options.end=0] - å­é¡¹çç»æ­¢å¼ã
 * @param {number} [options.start=0] - å­é¡¹çåæ®µèµ·å§å¼ã
 * @param {boolean} [options.visible=true] - å­é¡¹æ¯å¦å¯è§ã
 * @param {ServerTextStyle} [options.style] - å­é¡¹ææ¬çæ¾ç¤ºé£æ ¼ã
 * @usage
 */
class ThemeLabelItem {

    constructor(options) {
        /**
         * @member {string} [ThemeLabelItem.prototype.caption]
         * @description æ ç­¾ä¸é¢å­é¡¹çæ é¢ã
         */
        this.caption = null;

        /**
         * @member {number} [ThemeLabelItem.prototype.end=0]
         * @description æ ç­¾ä¸é¢å¾å­é¡¹çç»æ­¢å¼ãå¦æè¯¥å­é¡¹æ¯åæ®µä¸­æåä¸ä¸ªå­é¡¹ï¼é£ä¹è¯¥ç»æ­¢å¼å°±æ¯åæ®µçæå¤§å¼ï¼
         *              å¦æä¸æ¯æåä¸é¡¹ï¼è¯¥ç»æ­¢å¼å¿é¡»ä¸å¶ä¸ä¸å­é¡¹çèµ·å§å¼ç¸åï¼å¦åç³»ç»æåºå¼å¸¸ã
         */
        this.end = 0;

        /**
         * @member {number} [ThemeLabelItem.prototype.start=0]
         * @description æ ç­¾ä¸é¢å¾å­é¡¹çåæ®µèµ·å§å¼ãå¦æè¯¥å­é¡¹æ¯åæ®µä¸­ç¬¬ä¸é¡¹ï¼é£ä¹è¯¥èµ·å§å¼å°±æ¯åæ®µçæå°å¼ï¼
         *              å¦æè¯¥å­é¡¹çåºå·å¤§äºç­äº 1 çæ¶åï¼è¯¥èµ·å§å¼å¿é¡»ä¸åä¸å­é¡¹çç»æ­¢å¼ç¸åï¼å¦åç³»ç»ä¼æåºå¼å¸¸ã
         */
        this.start = 0;

        /**
         * @member {boolean} [ThemeLabelItem.prototype.visible=true]
         * @description æ ç­¾ä¸é¢å¾å­é¡¹æ¯å¦å¯è§ãå¦ææ ç­¾ä¸é¢å¾å­é¡¹å¯è§ï¼åä¸º trueï¼å¦åä¸º falseã
         */
        this.visible = true;

        /**
         * @member {ServerTextStyle} ThemeLabelItem.prototype.style
         * @description æ ç­¾ä¸é¢å¾å­é¡¹ææ¬çæ¾ç¤ºé£æ ¼ãåç§é£æ ¼çä¼åçº§ä»é«å°ä½ä¸ºï¼<br>
         *              uniformMixedStyleï¼æ ç­¾ææ¬çå¤åé£æ ¼ï¼ï¼ThemeLabelItem.styleï¼åæ®µå­é¡¹çææ¬é£æ ¼ï¼ï¼uniformStyleï¼ç»ä¸ææ¬é£æ ¼ï¼ã
         */
        this.style = new ServerTextStyle();

        if (options) {
            Util.extend(this, options);
        }
        this.CLASS_NAME = "SuperMap.ThemeLabelItem";

    }


    /**
     * @function ThemeLabelItem.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.caption = null;
        me.end = null;
        me.start = null;
        if (me.style) {
            me.style.destroy();
            me.style = null;
        }
        me.visible = null;
    }

    /**
     * @function ThemeLabelItem.fromObj
     * @description ä»ä¼ å¥å¯¹è±¡è·ååæ®µæ ç­¾ä¸é¢å¾çå­é¡¹ç±»ã
     * @param {Object} obj - ä¼ å¥å¯¹è±¡ã
     * @returns {ThemeLabelItem} ThemeLabelItem å¯¹è±¡ã
     */
    static fromObj(obj) {
        if (!obj) {
            return;
        }
        var t = new ThemeLabelItem();
        Util.copy(t, obj);
        return t;
    }

}


;// CONCATENATED MODULE: ./src/common/iServer/ThemeUniqueItem.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class ThemeUniqueItem
 * @deprecatedclass SuperMap.ThemeUniqueItem
 * @category  iServer Map Theme
 * @classdesc åå¼ä¸é¢å¾å­é¡¹ç±»ãåå¼ä¸é¢å¾æ¯å°ä¸é¢å¼ç¸åçè¦ç´ å½ä¸ºä¸ç±»ï¼ä¸ºæ¯ä¸ç±»è®¾å®ä¸ç§æ¸²æé£æ ¼ï¼å¶ä¸­æ¯ä¸ç±»å°±æ¯ä¸ä¸ªä¸é¢å¾å­é¡¹ãæ¯å¦ï¼å©ç¨åå¼ä¸é¢å¾å¶ä½è¡æ¿åºåå¾ï¼Name å­æ®µä»£è¡¨
 * ç/ç´è¾å¸åï¼è¯¥å­æ®µç¨æ¥åä¸é¢åéï¼å¦æè¯¥å­æ®µçå­æ®µå¼æ»å±æ 5 ç§ä¸åå¼ï¼åè¯¥è¡æ¿åºåå¾æ 5 ä¸ªä¸é¢å¾å­é¡¹ã
 * @param {Object} options - åæ°ã
 * @param {string} options.unique - å­é¡¹çåå¼å­æ®µã
 * @param {string} [options.caption] - å­é¡¹çæ é¢ã
 * @param {ServerStyle} [options.style] - å­é¡¹çé£æ ¼ã
 * @param {boolean} [options.visible=true] - å­é¡¹æ¯å¦å¯è§ã
 * @usage
 */
class ThemeUniqueItem {

    constructor(options) {
        /**
         * @member {string} [ThemeUniqueItem.prototype.caption]
         * @description åå¼ä¸é¢å¾å­é¡¹çæ é¢ã
         */
        this.caption = null;

        /**
         * @member {ServerStyle} [ThemeUniqueItem.prototype.style]
         * @description åå¼ä¸é¢å¾å­é¡¹çæ¾ç¤ºé£æ ¼ã
         */
        this.style = new ServerStyle();

        /**
         * @member {string} ThemeUniqueItem.prototype.unique
         * @description åå¼ä¸é¢å¾å­é¡¹çå¼ï¼å¯ä»¥ä¸ºæ°å­ãå­ç¬¦ä¸²ç­ã
         */
        this.unique = null;

        /**
         * @member {boolean} [ThemeUniqueItem.prototype.visible=true]
         * @description åå¼ä¸é¢å¾å­é¡¹çå¯è§æ§ã
         */
        this.visible = true;

        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = "SuperMap.ThemeUniqueItem";
    }

    /**
     * @function ThemeUniqueItem.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.caption = null;
        me.unique = null;

        if (me.style) {
            me.style.destroy();
            me.style = null;
        }
        me.visible = null;
    }

    /**
     * @function ThemeUniqueItem.prototype.toServerJSONObject
     * @description è½¬æ¢æå¯¹åºç JSON æ ¼å¼å¯¹è±¡ã
     * @returns {Object} å¯¹åºç JSON æ ¼å¼å¯¹è±¡ã
     */
    toServerJSONObject() {
        var obj = {};
        obj = Util.copyAttributes(obj, this);
        if (obj.style) {
            if (obj.style.toServerJSONObject) {
                obj.style = obj.style.toServerJSONObject();
            }
        }
        return obj;
    }

    /**
     * @function ThemeUniqueItem.fromObj
     * @description ä»ä¼ å¥å¯¹è±¡è·ååå¼ä¸é¢å¾å­é¡¹ç±»ã
     * @param {Object} obj - ä¼ å¥å¯¹è±¡ã
     * @returns {ThemeUniqueItem} ThemeUniqueItem å¯¹è±¡ã
     */
    static fromObj(obj) {
        var res = new ThemeUniqueItem();
        Util.copy(res, obj);
        res.style = ServerStyle.fromJson(obj.style);
        return res;

    }

}



;// CONCATENATED MODULE: ./src/common/iServer/ThemeOffset.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class ThemeOffset
 * @deprecatedclass SuperMap.ThemeOffset
 * @category  iServer Map Theme
 * @classdesc ä¸é¢å¾ä¸­ææ¬æç¬¦å·ç¸å¯¹äºè¦ç´ åç¹çåç§»éè®¾ç½®ç±»ã
 *            éè¿è¯¥ç±»å¯ä»¥è®¾ç½®ä¸é¢å¾ä¸­æ è®°ææ¬æç¬¦å·çåç§»éä»¥ååç§»éæ¯å¦éå°å¾ç¼©æ¾èæ¹åã
 * @param {Object} options - å¯éåæ°ã
 * @param {boolean} [options.offsetFixed=false] - å½åä¸é¢å¾æ¯å¦åºå®æ è®°ææ¬æç¬¦å·çåç§»éã
 * @param {string} [options.offsetX='0.0'] - ä¸é¢å¾ä¸­ææ¬æç¬¦å·ç¸å¯¹äºè¦ç´ åç¹çæ°´å¹³åç§»éã
 * @param {string} [options.offsetY='0.0'] - ä¸é¢å¾ä¸­ææ¬æç¬¦å·ç¸å¯¹äºè¦ç´ åç¹çåç´åç§»éã
 * @usage
 */
class ThemeOffset {

    constructor(options) {
        /**
         * @member {boolean} [ThemeOffset.prototype.offsetFixed=false]
         * @description å½åä¸é¢å¾æ¯å¦åºå®æ è®°ææ¬æç¬¦å·çåç§»éãæè°åºå®åç§»éï¼åææ¬æç¬¦å·çåç§»éä¸éå°å¾çç¼©æ¾èååã
         */
        this.offsetFixed = false;

        /**
         * @member {string} [ThemeOffset.prototype.offsetX=0.0]
         * @description ä¸é¢å¾ä¸­ææ¬æç¬¦å·ç¸å¯¹äºè¦ç´ åç¹çæ°´å¹³åç§»éãåç§»éçåä½ä¸ºå°å¾åä½ã
         *              è¯¥åç§»éçå¼ä¸ºä¸ä¸ªå¸¸éå¼æèå­æ®µè¡¨è¾¾å¼æè¡¨ç¤ºçå¼ï¼å³å¦æå­æ®µè¡¨è¾¾å¼ä¸º SmIDï¼å¶ä¸­ SmID = 2ï¼é£ä¹æ°´å¹³åç§»éä¸º2ã
         */
        this.offsetX = "0.0";

        /**
         * @member {string} [ThemeOffset.prototype.offsetY=0.0]
         * @description ä¸é¢å¾ä¸­ææ¬æç¬¦å·ç¸å¯¹äºè¦ç´ åç¹çåç´åç§»éãåç§»éçåä½ä¸ºå°å¾åä½ã
         *              è¯¥åç§»éçå¼ä¸ºä¸ä¸ªå¸¸éå¼æèå­æ®µè¡¨è¾¾å¼æè¡¨ç¤ºçå¼ï¼å³å¦æå­æ®µè¡¨è¾¾å¼ä¸º SmIDï¼å¶ä¸­ SmID = 2ï¼é£ä¹åç´åç§»éä¸º2ã
         */
        this.offsetY = "0.0";

        if (options) {
            Util.extend(this, options);
        }
        this.CLASS_NAME = "SuperMap.ThemeOffset";
    }

    /**
     * @function ThemeOffset.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.offsetFixed = null;
        me.offsetX = null;
        me.offsetY = null;
    }

    /**
     * @function ThemeOffset.fromObj
     * @description ä»ä¼ å¥å¯¹è±¡è·åä¸é¢å¾ä¸­ææ¬æç¬¦å·ç¸å¯¹äºè¦ç´ åç¹çåç§»éè®¾ç½®ç±»ã
     * @param {Object} obj - ä¼ å¥å¯¹è±¡ã
     * @returns {ThemeOffset} ThemeOffset å¯¹è±¡ã
     */
    static fromObj(obj) {
        if (!obj) {
            return;
        }
        var res = new ThemeOffset();
        Util.copy(res, obj);
        return res;
    }

}


;// CONCATENATED MODULE: ./src/common/iServer/LabelMixedTextStyle.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class LabelMixedTextStyle
 * @deprecatedclass SuperMap.LabelMixedTextStyle
 * @category iServer Map Theme
 * @classdesc æ ç­¾ææ¬å¤åé£æ ¼ç±»ã
 * è¯¥ç±»ä¸»è¦ç¨äºå¯¹æ ç­¾ä¸é¢å¾ä¸­æ ç­¾çææ¬åå®¹è¿è¡é£æ ¼è®¾ç½®ãéè¿è¯¥ç±»ç¨æ·å¯ä»¥ä½¿æ ç­¾çæå­æ¾ç¤ºä¸åçé£æ ¼ï¼æ¯å¦ææ¬ âåé©¬æéå±±âï¼éè¿æ¬ç±»å¯ä»¥å°åä¸ä¸ªå­ç¨çº¢è²æ¾ç¤ºï¼åä¸¤ä¸ªå­ç¨èè²æ¾ç¤ºãå¯¹åä¸ææ¬è®¾ç½®ä¸åçé£æ ¼å®è´¨ä¸æ¯å¯¹ææ¬çå­ç¬¦è¿è¡åæ®µï¼åä¸åæ®µåçå­ç¬¦å·æç¸åçæ¾ç¤ºé£æ ¼ãå¯¹å­ç¬¦åæ®µæä¸¤ç§æ¹å¼ï¼ä¸ç§æ¯å©ç¨åéç¬¦å¯¹ææ¬è¿è¡åæ®µï¼å¦ä¸ç§æ¯æ ¹æ®åæ®µç´¢å¼å¼è¿è¡åæ®µï¼</br>
 *  1.å©ç¨åéç¬¦å¯¹ææ¬è¿è¡åæ®µ: æ¯å¦ææ¬ â5&109â è¢«åéç¬¦ â&â åä¸º â5â å â109â ä¸¤é¨åï¼
 *     å¨æ¾ç¤ºæ¶ï¼â5â ååéç¬¦ â&â ä½¿ç¨åä¸ä¸ªé£æ ¼ï¼å­ç¬¦ä¸² â109â ä½¿ç¨ç¸åçé£æ ¼ã<br>
 *  2.å©ç¨åæ®µç´¢å¼å¼è¿è¡åæ®µ: ææ¬ä¸­å­ç¬¦çç´¢å¼å¼æ¯ä»¥0å¼å§çæ´æ°ï¼æ¯å¦ææ¬ âç ç©æçå³°âï¼
 *     ç¬¬ä¸ä¸ªå­ç¬¦ï¼âç âï¼çç´¢å¼å¼ä¸º 0ï¼ç¬¬äºä¸ªå­ç¬¦ï¼âç©âï¼çç´¢å¼å¼ä¸º 1ï¼ä»¥æ­¤ç±»æ¨ï¼å½è®¾ç½®åæ®µç´¢å¼å¼ä¸º 1ï¼3ï¼4ï¼9 æ¶ï¼
 *     å­ç¬¦åæ®µèå´ç¸åºçå°±æ¯ (-âï¼1)ï¼[1ï¼3)ï¼[3ï¼4)ï¼[4ï¼9)ï¼[9ï¼+â)ï¼å¯ä»¥çåºç´¢å¼å·ä¸º 0 çå­ç¬¦ï¼å³âç â ï¼å¨ç¬¬ä¸ä¸ªåæ®µåï¼
 *     ç´¢å¼å·ä¸º 1ï¼2 çå­ç¬¦ï¼å³âç©âãâæâï¼ä½äºç¬¬äºä¸ªåæ®µåï¼ç´¢å¼å·ä¸º 3 çå­ç¬¦ï¼âçâï¼å¨ç¬¬ä¸ä¸ªåæ®µåï¼ç´¢å¼å·ä¸º 4 çå­ç¬¦ï¼âå³°âï¼å¨ç¬¬åä¸ªåæ®µåï¼å¶ä½åæ®µä¸­æ²¡æå­ç¬¦ã
 * @param {Object} options - å¯éåæ°ã
 * @param {ServerTextStyle} [options.defaultStyle] - é»è®¤çææ¬å¤åé£æ ¼ã
 * @param {string} [options.separator] - ææ¬çåéç¬¦ã
 * @param {boolean} [options.separatorEnabled=false] - ææ¬çåéç¬¦æ¯å¦ææã
 * @param {Array.<number>} [options.splitIndexes] - åæ®µç´¢å¼å¼ï¼åæ®µç´¢å¼å¼ç¨æ¥å¯¹ææ¬ä¸­çå­ç¬¦è¿è¡åæ®µã
 * @param {Array.<ServerTextStyle>} [options.styles] - ææ¬æ ·å¼éåã
 * @usage
 */
class LabelMixedTextStyle {

    constructor(options) {
        /**
         * @member {ServerTextStyle} LabelMixedTextStyle.prototype.defaultStyle
         * @description é»è®¤çææ¬å¤åé£æ ¼ï¼å³ ServerTextStyle åå­æ®µçé»è®¤å¼ã
         */
        this.defaultStyle = null;

        /**
         * @member {string} LabelMixedTextStyle.prototype.separator
         * @description ææ¬çåéç¬¦ï¼åéç¬¦çé£æ ¼ä¸åä¸ä¸ªå­ç¬¦çé£æ ¼ä¸æ ·ãææ¬çåéç¬¦æ¯ä¸ä¸ªå°ææ¬åå²å¼çç¬¦å·ï¼
         *              æ¯å¦ææ¬ â5_109â è¢« â _ â åéä¸º â5â å â109â ä¸¤é¨åï¼åè®¾æé£æ ¼æ°ç»ï¼style1ãstyle2ã
         *              å¨æ¾ç¤ºæ¶ï¼â5â ååéç¬¦ â _ â ä½¿ç¨ Style1 é£æ ¼æ¸²æï¼å­ç¬¦ä¸² â109â ä½¿ç¨ Style2 çé£æ ¼ã
         */
        this.separator = null;

        /**
         * @member {boolean} [LabelMixedTextStyle.prototype.separatorEnabled=false]
         * @description ææ¬çåéç¬¦æ¯å¦ææãåéç¬¦æææ¶å©ç¨åéç¬¦å¯¹ææ¬è¿è¡åæ®µï¼æ ææ¶æ ¹æ®ææ¬ä¸­å­ç¬¦çä½ç½®è¿è¡åæ®µã
         *              åæ®µåï¼åä¸åæ®µåçå­ç¬¦å·æç¸åçæ¾ç¤ºé£æ ¼ã
         */
        this.separatorEnabled = false;

        /**
         * @member {Array.<number>} LabelMixedTextStyle.prototype.splitIndexes
         * @description åæ®µç´¢å¼å¼ï¼åæ®µç´¢å¼å¼ç¨æ¥å¯¹ææ¬ä¸­çå­ç¬¦è¿è¡åæ®µã
         *              ææ¬ä¸­å­ç¬¦çç´¢å¼å¼æ¯ä»¥ 0 å¼å§çæ´æ°ï¼æ¯å¦ææ¬âç ç©æçå³°âï¼ç¬¬ä¸ä¸ªå­ç¬¦ï¼âç âï¼çç´¢å¼å¼ä¸º0ï¼ç¬¬äºä¸ªå­ç¬¦ï¼âç©âï¼çç´¢å¼å¼ä¸º 1ï¼
         *              ä»¥æ­¤ç±»æ¨ï¼å½è®¾ç½®åæ®µç´¢å¼å¼æ°ç»ä¸º [1ï¼3ï¼4ï¼9] æ¶ï¼å­ç¬¦åæ®µèå´ç¸åºçå°±æ¯ (-âï¼1)ï¼[1ï¼3)ï¼[3ï¼4)ï¼[4ï¼9)ï¼[9ï¼+â)ï¼
         *              å¯ä»¥çåºç´¢å¼å·ä¸º 0 çå­ç¬¦ï¼å³ âç âï¼å¨ç¬¬ä¸ä¸ªåæ®µåï¼ç´¢å¼å·ä¸º 1ï¼2 çå­ç¬¦ï¼å³ âç©âãâæâï¼ä½äºç¬¬äºä¸ªåæ®µåï¼
         *              ç´¢å¼å·ä¸º 3 çå­ç¬¦ï¼âçâï¼å¨ç¬¬ä¸ä¸ªåæ®µåï¼ç´¢å¼å·ä¸º 4 çå­ç¬¦ï¼âå³°âï¼å¨ç¬¬åä¸ªåæ®µåï¼å¶ä½åæ®µä¸­æ²¡æå­ç¬¦ã
         */
        this.splitIndexes = null;

        /**
         * @member {Array.<ServerTextStyle>} LabelMixedTextStyle.prototype.styles
         * @description ææ¬æ ·å¼éåãææ¬æ ·å¼éåä¸­çæ ·å¼æ ¹æ®ç´¢å¼ä¸ä¸ååæ®µä¸ä¸å¯¹åºï¼
         *              å¦ææåæ®µæ²¡æé£æ ¼å¯¹åºåä½¿ç¨ defaultStyleã
         */
        this.styles = new ServerTextStyle();

        if (options) {
            Util.extend(this, options);
        }
        this.CLASS_NAME = "SuperMap.LabelMixedTextStyle"
    }

    /**
     * @function LabelMixedTextStyle.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        if (me.defaultStyle) {
            me.defaultStyle.destroy();
            me.defaultStyle = null;
        }
        me.separator = null;
        me.separatorEnabled = null;
        if (me.splitIndexes) {
            me.splitIndexes = null;
        }
        if (me.styles) {
            for (var i = 0, styles = me.styles, len = styles.length; i < len; i++) {
                styles[i].destroy();
            }
            me.styles = null;
        }
    }

    /**
     * @function LabelMixedTextStyle.fromObj
     * @description ä»ä¼ å¥å¯¹è±¡è·åæ ç­¾ææ¬å¤åé£æ ¼ç±»ã
     * @param {Object} obj - ä¼ å¥å¯¹è±¡ã
     * @returns {LabelMixedTextStyle} è¿åæ°ç LabelMixedTextStyle å¯¹è±¡ã
     */
    static fromObj(obj) {
        if (!obj) {
            return;
        }
        var res = new LabelMixedTextStyle();
        var stys = obj.styles;
        Util.copy(res, obj);
        res.defaultStyle = new ServerTextStyle(obj.defaultStyle);
        if (stys) {
            res.styles = [];
            for (var i = 0, len = stys.length; i < len; i++) {
                res.styles.push(new ServerTextStyle(stys[i]));
            }
        }
        return res;
    }

}



;// CONCATENATED MODULE: ./src/common/iServer/ThemeLabelText.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class ThemeLabelText
 * @deprecatedclass SuperMap.ThemeLabelText
 * @category  iServer Map Theme
 * @classdesc æ ç­¾ä¸­ææ¬é£æ ¼ç±»ã
 *            éè¿è¯¥ç±»å¯ä»¥è®¾ç½®æ ç­¾ä¸­çææ¬å­ä½å¤§å°åæ¾ç¤ºé£æ ¼ã
 * @param {Object} options - åæ°ã
 * @param {number} [options.maxTextHeight=0] - æ ç­¾ä¸­ææ¬çæå¤§é«åº¦ã
 * @param {number} [options.maxTextWidth=0] - æ ç­¾ä¸­ææ¬çæå¤§å®½åº¦ã
 * @param {number} [options.minTextHeight=0] - æ ç­¾ä¸­ææ¬çæå°é«åº¦ã
 * @param {number} [options.minTextWidth=0] - æ ç­¾ä¸­ææ¬çæå°å®½åº¦ã
 * @param {ServerTextStyle} [options.uniformStyle] - ç»ä¸ææ¬é£æ ¼ã
 * @param {LabelMixedTextStyle} [options.uniformMixedStyle] - æ ç­¾ä¸é¢å¾ç»ä¸çææ¬å¤åé£æ ¼ã
 * @usage
 */
class ThemeLabelText {

    constructor(options) {
        /**
         * @member {number} [ThemeLabelText.prototype.maxTextHeight=0]
         * @description æ ç­¾ä¸­ææ¬çæå¤§é«åº¦ãå½æ ç­¾ææ¬ä¸åºå®å¤§å°æ¶ï¼å³ ServerTextStyle.sizeFixed = false ææï¼
         *              å½æ¾å¤§åçææ¬é«åº¦è¶è¿æå¤§é«åº¦ä¹åå°±ä¸åæ¾å¤§ãé«åº¦åä½ä¸ºæ¯«ç±³ã
         */
        this.maxTextHeight = 0;

        /**
         * @member {number} [ThemeLabelText.prototype.maxTextWidth=0]
         * @description æ ç­¾ä¸­ææ¬çæå¤§å®½åº¦ãå½æ ç­¾ææ¬ä¸åºå®å¤§å°æ¶ï¼å³ ServerTextStyle.sizeFixed = false ææï¼
         *              å½æ¾å¤§åçææ¬å®½åº¦è¶è¿æå¤§é«åº¦ä¹åå°±ä¸åæ¾å¤§ãå®½åº¦åä½ä¸ºæ¯«ç±³ã
         */
        this.maxTextWidth = 0;

        /**
         * @member {number} [ThemeLabelText.prototype.minTextHeight=0]
         * @description æ ç­¾ä¸­ææ¬çæå°é«åº¦ãå½æ ç­¾ææ¬ä¸åºå®å¤§å°æ¶ï¼å³ ServerTextStyle.sizeFixed = false ææï¼
         *              å½ç¼©å°åçææ¬é«åº¦å°äºæå°é«åº¦ä¹åå°±ä¸åç¼©å°ãé«åº¦åä½ä¸ºæ¯«ç±³ã
         */
        this.minTextHeight = 0;

        /**
         * @member {number} [ThemeLabelText.prototype.minTextWidth=0]
         * @description æ ç­¾ä¸­ææ¬çæå°å®½åº¦ãå½æ ç­¾ææ¬ä¸åºå®å¤§å°æ¶ï¼å³ ServerTextStyle.sizeFixed = false ææï¼
         *              å½ç¼©å°åçææ¬å®½åº¦å°äºæå°å®½åº¦ä¹åå°±ä¸åç¼©å°ãå®½åº¦åä½ä¸ºæ¯«ç±³ã
         */
        this.minTextWidth = 0;

        /**
         * @member {ServerTextStyle} [ThemeLabelText.prototype.uniformStyle]
         * @description ç»ä¸ææ¬é£æ ¼ãå½æ ç­¾ä¸é¢å¾å­é¡¹çä¸ªæ°å¤§äºç­äº1æ¶ï¼
         *              uniformStyle ä¸èµ·ä½ç¨ï¼åæ ç­¾çé£æ ¼ä½¿ç¨å­é¡¹ä¸­è®¾ç½®çé£æ ¼ãåç§é£æ ¼çä¼åçº§ä»é«å°ä½ä¸ºï¼uniformMixedStyleï¼æ ç­¾ææ¬çå¤åé£æ ¼ï¼ï¼
         *              ThemeLabelItem.styleï¼åæ®µå­é¡¹çææ¬é£æ ¼ï¼ï¼uniformStyleï¼ç»ä¸ææ¬é£æ ¼ï¼ã
         */
        this.uniformStyle = new ServerTextStyle();

        /**
         *@member {LabelMixedTextStyle} [ThemeLabelText.prototype.uniformMixedStyle]
         *@description  æ ç­¾ä¸é¢å¾ç»ä¸çææ¬å¤åé£æ ¼ãéè¿è¯¥ç±»å¯ä»¥ä½¿åä¸ä¸ªæ 
         *              ç­¾ä¸­çæå­ä½¿ç¨å¤ç§é£æ ¼æ¾ç¤ºãåç§é£æ ¼çä¼åçº§ä»é«å°ä½ä¸ºï¼uniformMixedStyleï¼æ ç­¾ææ¬çå¤åé£æ ¼ï¼ï¼
         *              ThemeLabelItem.styleï¼åæ®µå­é¡¹çææ¬é£æ ¼ï¼ï¼uniformStyleï¼ç»ä¸ææ¬é£æ ¼ï¼ã
         */
        this.uniformMixedStyle =  null;

        if (options) {
            Util.extend(this, options);
        }
        this.CLASS_NAME = "SuperMap.ThemeLabelText";
    }

    /**
     * @function ThemeLabelText.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.maxTextHeight = null;
        me.maxTextWidth = null;
        me.minTextHeight = null;
        me.minTextWidth = null;
        if (me.uniformStyle) {
            me.uniformStyle.destroy();
            me.uniformStyle = null;
        }
        if (me.uniformMixedStyle) {
            me.uniformMixedStyle.destroy();
            me.uniformMixedStyle = null;
        }
    }

    /**
     * @function ThemeLabelText.fromObj
     * @description ä»ä¼ å¥å¯¹è±¡è·åæ ç­¾ä¸­ææ¬é£æ ¼ç±»ã
     * @param {Object} obj - ä¼ å¥å¯¹è±¡ã
     * @returns {ThemeLabelText} ThemeLabelText å¯¹è±¡ã
     */
    static fromObj(obj) {
        if (!obj) {
            return;
        }
        var res = new ThemeLabelText();
        Util.copy(res, obj);
        res.uniformStyle = ServerTextStyle.fromObj(obj.uniformStyle);
        res.uniformMixedStyle = LabelMixedTextStyle.fromObj(obj.uniformMixedStyle);
        return res;
    }
}


;// CONCATENATED MODULE: ./src/common/iServer/ThemeLabelAlongLine.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class ThemeLabelAlongLine
 * @deprecatedclass SuperMap.ThemeLabelAlongLine
 * @category  iServer Map Theme
 * @classdesc æ ç­¾æ²¿çº¿æ æ³¨æ ·å¼ç±»ã
 * @param {Object} options - å¯éåæ°ã
 * @param {boolean} [options.isAlongLine=true] - æ¯å¦æ²¿çº¿æ¾ç¤ºææ¬ã
 * @param {AlongLineDirection} [options.alongLineDirection=AlongLineDirection.LB_TO_RT] - æ ç­¾æ²¿çº¿æ æ³¨æ¹åã
 * @param {boolean} [options.angleFixed=false] - å½æ²¿çº¿æ¾ç¤ºææ¬æ¶ï¼æ¯å¦å°ææ¬è§åº¦åºå®ã
 * @param {boolean} [options.repeatedLabelAvoided=false] - æ²¿çº¿å¾ªç¯æ æ³¨æ¶æ¯å¦é¿åæ ç­¾éå¤æ æ³¨ã
 * @param {boolean} [options.repeatIntervalFixed=false] - å¾ªç¯æ æ³¨é´éæ¯å¦åºå®ã
 * @param {number} [options.labelRepeatInterval=0] - æ²¿çº¿ä¸å¾ªç¯æ æ³¨æ¶å¾ªç¯æ æ³¨çé´éã
 * @usage
 */
class ThemeLabelAlongLine {


    constructor(options) {
        /**
         * @member {boolean} [ThemeLabelAlongLine.prototype.isAlongLine=true]
         * @description æ¯å¦æ²¿çº¿æ¾ç¤ºææ¬ãtrue è¡¨ç¤ºæ²¿çº¿æ¾ç¤ºææ¬ï¼false è¡¨ç¤ºæ­£å¸¸æ¾ç¤ºææ¬ã
         */
        this.isAlongLine = true;

        /**
         * @member {AlongLineDirection} [ThemeLabelAlongLine.prototype.alongLineDirection=AlongLineDirection.LB_TO_RT]
         * @description æ ç­¾æ²¿çº¿æ æ³¨æ¹åã
         */
        this.alongLineDirection = AlongLineDirection.LB_TO_RT;

        /**
         * @member {boolean} [ThemeLabelAlongLine.prototype.angleFixed=false]
         * @description å½æ²¿çº¿æ¾ç¤ºææ¬æ¶ï¼æ¯å¦å°ææ¬è§åº¦åºå®ãtrue è¡¨ç¤ºæåºå®ææ¬è§åº¦æ¾ç¤ºææ¬ï¼false è¡¨ç¤ºæç§æ²¿çº¿è§åº¦æ¾ç¤ºææ¬ã
         *              å¦æåºå®è§åº¦ï¼åæææ ç­¾åææè®¾ç½®çææ¬é£æ ¼ä¸­å­ä½çæè½¬è§åº¦æ¥æ¾ç¤ºï¼ä¸èèæ²¿çº¿æ æ³¨çæ¹åï¼
         *              å¦æä¸åºå®è§åº¦ï¼å¨æ¾ç¤ºæ ç­¾æ¶ä¼åæ¶èèå­ä½çæè½¬è§åº¦åæ²¿çº¿æ æ³¨çæ¹åã
         */
        this.angleFixed = false;

        /**
         * @member {boolean} ThemeLabelAlongLine.prototype.repeatedLabelAvoided
         * @description æ²¿çº¿å¾ªç¯æ æ³¨æ¶æ¯å¦é¿åæ ç­¾éå¤æ æ³¨ã
         */
        this.repeatedLabelAvoided = false;

        /**
         * @member {boolean} [ThemeLabelAlongLine.prototype.repeatIntervalFixed=false]
         * @description å¾ªç¯æ æ³¨é´éæ¯å¦åºå®ãtrue è¡¨ç¤ºä½¿ç¨åºå®å¾ªç¯æ æ³¨é´éï¼å³ä½¿ç¨é»è¾åæ æ¥æ¾ç¤ºå¾ªç¯æ æ³¨é´éï¼
         *              false è¡¨ç¤ºå¾ªç¯æ æ³¨é´ééå°å¾çç¼©æ¾èååï¼å³ä½¿ç¨å°çåæ æ¥æ¾ç¤ºå¾ªç¯æ æ³¨é´éã
         */
        this.repeatIntervalFixed = false;

        /**
         * @member {number} [ThemeLabelAlongLine.prototype.labelRepeatInterval=0]
         * @description æ²¿çº¿ä¸å¾ªç¯æ æ³¨æ¶å¾ªç¯æ æ³¨çé´éãé¿åº¦çåä½ä¸å°å¾çå°çåä½ä¸è´ãåªæè®¾å® RepeatedLabelAvoided ä¸º true
         *              çæ¶åï¼labelRepeatInterval å±æ§æææã
         */
        this.labelRepeatInterval = 0;

        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = "SuperMap.ThemeLabelAlongLine";
    }


    /**
     * @function ThemeLabelAlongLine.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.isAlongLine = null;
        me.alongLineDirection = null;
        me.angleFixed = null;
        me.repeatedLabelAvoided = null;
        me.repeatIntervalFixed = null;
        me.labelRepeatInterval = null;
    }

    /**
     * @function ThemeLabelAlongLine.fromObj
     * @description ä»ä¼ å¥å¯¹è±¡è·åæ ç­¾æ²¿çº¿æ æ³¨æ ·å¼ç±»ã
     * @param {Object} obj - ä¼ å¥å¯¹è±¡ã
     * @returns {ThemeLabelAlongLine} ThemeLabelAlongLine å¯¹è±¡ã
     */
    static fromObj(obj) {
        if (!obj) {
            return;
        }
        var t = new ThemeLabelAlongLine();
        Util.copy(t, obj);
        return t;
    }

}


;// CONCATENATED MODULE: ./src/common/iServer/ThemeLabelBackground.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class ThemeLabelBackground
 * @deprecatedclass SuperMap.ThemeLabelBackground
 * @category  iServer Map Theme
 * @classdesc æ ç­¾èæ¯é£æ ¼ç±»ãéè¿è¯¥ç±»å¯ä»¥è®¾ç½®æ ç­¾çèæ¯å½¢ç¶åé£æ ¼ã
 * @param {Object} options - å¯éåæ°ã
 * @param {LabelBackShape} [options.labelBackShape=LabelBackShape.NONE] - æ ç­¾ä¸é¢å¾ä¸­æ ç­¾èæ¯çå½¢ç¶æä¸¾ç±»ã
 * @param {ServerStyle} [options.backStyle] - æ ç­¾ä¸é¢å¾ä¸­æ ç­¾èæ¯é£æ ¼ã
 * @usage
 */
class ThemeLabelBackground {

    constructor(options) {
        /**
         * @member {LabelBackShape} [ThemeLabelBackground.prototype.labelBackShape=LabelBackShape.NONE]
         * @description æ ç­¾ä¸é¢å¾ä¸­æ ç­¾èæ¯é£æ ¼ãå½èæ¯å½¢ç¶
         *              labelBackShape å±æ§è®¾ä¸º NONEï¼å³æ èæ¯å½¢ç¶ï¼ æ¶ï¼backStyle å±æ§æ æã
         */
        this.labelBackShape = LabelBackShape.NONE;

        /**
         * @member {ServerStyle} [ThemeLabelBackground.prototype.backStyle]
         * @description æ ç­¾ä¸é¢å¾ä¸­æ ç­¾èæ¯çå½¢ç¶æä¸¾ç±»ãèæ¯ç±»åå¯
         *              ä»¥æ¯ç©å½¢ãåè§ç©å½¢ãè±å½¢ãæ¤­åå½¢ãä¸è§å½¢åç¬¦å·ç­ï¼å³ä¸ä½¿ç¨ä»»ä½çå½¢ç¶ä½ä¸ºæ ç­¾çèæ¯ã
         */
        this.backStyle = new ServerStyle();

        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = "SuperMap.ThemeLabelBackground";
    }

    /**
     * @function ThemeLabelBackground.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.labelBackShape = null;
        if (me.backStyle) {
            me.backStyle.destroy();
            me.backStyle = null;
        }
    }

    /**
     * @function ThemeLabelBackground.fromObj
     * @description ä»ä¼ å¥å¯¹è±¡è·åæ ç­¾èæ¯é£æ ¼ç±»ã
     * @param {Object} obj - ä¼ å¥å¯¹è±¡ã
     * @returns {ThemeLabelBackground} ThemeLabelBackground å¯¹è±¡ã
     */
    static fromObj(obj) {
        if (!obj) {
            return;
        }
        var t = new ThemeLabelBackground();
        t.labelBackShape = obj.labelBackShape;
        t.backStyle = ServerStyle.fromJson(obj.backStyle);

        return t;
    }

}


;// CONCATENATED MODULE: ./src/common/iServer/ThemeLabel.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/










/**
 * @class ThemeLabel
 * @deprecatedclass SuperMap.ThemeLabel
 * @category  iServer Map Theme
 * @classdesc æ ç­¾ä¸é¢å¾ç±»ã
 * @extends CommonTheme
 * @param {Object} options - åæ°ã
 * @param {Array.<ThemeLabelItem>} options.items - å­é¡¹æ°ç»ã
 * @param {string} options.labelExpression - æ æ³¨å­æ®µè¡¨è¾¾å¼ã
 * @param {Array.<LabelImageCell|LabelSymbolCell|LabelThemeCell>} options.matrixCells - ç©éµæ ç­¾åç´ æ°ç»ã
 * @param {ThemeLabelAlongLine} [options.alongLine] - æ ç­¾æ²¿çº¿æ æ³¨æ¹åæ ·å¼ç±»ã
 * @param {ThemeLabelBackground} [options.background] - æ ç­¾çèæ¯é£æ ¼ç±»ã
 * @param {LabelOverLengthMode} [options.labelOverLengthMode=LabelOverLengthMode.NONE] - è¶é¿æ ç­¾çå¤çæ¨¡å¼æä¸¾ç±»ã
 * @param {number} [options.maxLabelLength=256] - æ ç­¾å¨æ¯ä¸è¡æ¾ç¤ºçæå¤§é¿åº¦ã
 * @param {number} [options.numericPrecision=0] - éè¿è¯¥å­æ®µè®¾ç½®å¶æ¾ç¤ºçç²¾åº¦ã
 * @param {ThemeOffset} [options.offset] - æå®æ ç­¾ä¸é¢å¾ä¸­æ è®°ææ¬ç¸å¯¹äºè¦ç´ åç¹çåç§»éå¯¹è±¡ã
 * @param {boolean} [options.overlapAvoided=true] - æ¯å¦åè®¸ä»¥ææ¬é¿è®©æ¹å¼æ¾ç¤ºææ¬ã
 * @param {string} [options.rangeExpression] - å¶ä½åæ®µæ ç­¾ä¸é¢çåæ®µå­æ®µæå­æ®µè¡¨è¾¾å¼ã
 * @param {boolean} [options.smallGeometryLabeled=false] - æ¯å¦æ¾ç¤ºé¿åº¦å¤§äºè¢«æ æ³¨å¯¹è±¡æ¬èº«é¿åº¦çæ ç­¾ã
 * @param {ThemeLabelText} options.text - æ ç­¾ä¸­ææ¬é£æ ¼ã
 * @param {number} [options.textSpace=0] - æ²¿çº¿æ æ³¨ï¼ç¸é»ä¸¤ä¸ªæå­ä¹é´çé´è·ï¼åä½å½åè®¾ç½®çå­é«ã
 * @param {ThemeMemoryData} [options.memoryData] - ä¸é¢å¾åå­æ°æ®ã
 * @usage
 */
class ThemeLabel extends Theme {


    constructor(options) {
        super("LABEL", options);
        /**
         * @member {ThemeLabelAlongLine} [ThemeLabel.prototype.alongLine]
         * @description æ ç­¾æ²¿çº¿æ æ³¨æ¹åæ ·å¼ç±»ã
         *              å¨è¯¥ç±»ä¸­å¯ä»¥è®¾ç½®æ ç­¾æ¯å¦æ²¿çº¿æ æ³¨ä»¥åæ²¿çº¿æ æ³¨çå¤ç§æ¹å¼ãæ²¿çº¿æ æ³¨å±æ§åªéç¨äºçº¿æ°æ®éä¸é¢å¾ã
         */
        this.alongLine = new ThemeLabelAlongLine();

        /**
         * @member {ThemeLabelBackground} [ThemeLabel.prototype.background]
         * @description æ ç­¾ä¸é¢å¾ä¸­æ ç­¾çèæ¯é£æ ¼ç±»ãéè¿è¯¥å­æ®µå¯ä»¥è®¾ç½®æ ç­¾çèæ¯å½¢ç¶åé£æ ¼ã
         */
        this.background = new ThemeLabelBackground();

        /**
         * @member {Array.<ThemeLabelItem>} [ThemeLabel.prototype.items]
         * @description åæ®µæ ç­¾ä¸é¢å¾çå­é¡¹æ°ç»ãåæ®µæ ç­¾ä¸é¢å¾ä½¿ç¨ rangeExpression
         *              æå®æ°å­åçå­æ®µä½ä¸ºåæ®µæ°æ®ï¼items ä¸­çæ¯ä¸ªå­å¯¹è±¡ç [startï¼end) åæ®µå¼å¿é¡»æ¥æºäºå±æ§ rangeExpression çå­æ®µå¼ãæ¯ä¸ªå­é¡¹æ¥æèªå·±çé£æ ¼ã
         */
        this.items = null;

        /**
         * @member {Array.<ThemeLabelUniqueItem>} ThemeLabel.prototype.uniqueItems
         * @description åå¼æ ç­¾ä¸é¢å¾å­é¡¹æ°ç»ãåå¼æ ç­¾ä¸é¢å¾ä½¿ç¨ uniqueExpressionåå¼æ ç­¾ä¸é¢å¾å­é¡¹éåã
         */
        this.uniqueItems = null;

        /**
         * @member {string} ThemeLabel.prototype.labelExpression
         * @description æ æ³¨å­æ®µè¡¨è¾¾å¼ãç³»ç»å° labelExpression å¯¹åºçå­æ®µæå­æ®µè¡¨è¾¾å¼çå¼ä»¥æ ç­¾çå½¢å¼æ¾ç¤ºå¨å¾å±ä¸­ã
         */
        this.labelExpression = null;

        /**
         * @member {LabelOverLengthMode} [ThemeLabel.prototype.labelOverLengthMode=LabelOverLengthMode.NONE] - æ ç­¾ä¸é¢å¾ä¸­è¶é¿æ ç­¾çå¤çæ¨¡å¼æä¸¾ç±»ã
         * @description å¯¹äºæ ç­¾çé¿åº¦è¶è¿è®¾ç½®çæ ç­¾æå¤§é¿åº¦ maxLabelLength æ¶ç§°ä¸ºè¶é¿æ ç­¾ã
         */
        this.labelOverLengthMode = LabelOverLengthMode.NONE;

        /**
         * @member {Array.<LabelImageCell|LabelSymbolCell|LabelThemeCell>} ThemeLabel.prototype.matrixCells
         * @description ç©éµæ ç­¾åç´ æ°ç»ï¼ç¨äºå¶ä½ç©éµæ ç­¾ä¸é¢å¾ã
         *              æ°ç»ä¸­å¯ä»¥æ¾ç½®ç¬¦å·ç±»åçç©éµæ ç­¾åç´ åå¾çç±»åçç©éµæ ç­¾åç´ ã
         */
        this.matrixCells = null;

        /**
         * @member {number} [ThemeLabel.prototype.maxLabelLength=256]
         * @description æ ç­¾å¨æ¯ä¸è¡æ¾ç¤ºçæå¤§é¿åº¦ï¼ä¸ä¸ªä¸­æä¸ºä¸¤ä¸ªå­ç¬¦ã
         *              å¦æè¶è¿æå¤§é¿åº¦ï¼å¯ä»¥éç¨ä¸¤ç§æ¹å¼æ¥å¤çï¼ä¸ç§æ¯æ¢è¡çæ¨¡å¼è¿è¡æ¾ç¤ºï¼å¦ä¸ç§æ¯ä»¥çç¥å·æ¹å¼æ¾ç¤ºãåä½ä¸ºå­ç¬¦ã
         */
        this.maxLabelLength = 256;

        /**
         * @member {number} [ThemeLabel.prototype.numericPrecision=0]
         * @description å¦ææ¾ç¤ºçæ ç­¾åå®¹ä¸ºæ°å­ï¼éè¿è¯¥å­æ®µè®¾ç½®å¶æ¾ç¤ºçç²¾åº¦ãä¾å¦æ ç­¾å¯¹åºçæ°å­æ¯8071.64529347ï¼
         *              å¦æè¯¥å±æ§ä¸º0æ¶ï¼æ¾ç¤º8071ï¼ä¸º1æ¶ï¼æ¾ç¤º8071.6ï¼ä¸º3æ¶ï¼åæ¯8071.645ã
         */
        this.numericPrecision = 0;

        /**
         * @member {ThemeOffset} [ThemeLabel.prototype.offset]
         * @description ç¨äºè®¾ç½®æ ç­¾ä¸é¢å¾ä¸­æ è®°ææ¬ç¸å¯¹äºè¦ç´ åç¹çåç§»éå¯¹è±¡ã
         */
        this.offset = new ThemeOffset();

        /**
         * @member {boolean} [ThemeLabel.prototype.overlapAvoided=true]
         * @description æ¯å¦åè®¸ä»¥ææ¬é¿è®©æ¹å¼æ¾ç¤ºææ¬ãtrue è¡¨ç¤ºèªå¨é¿åææ¬å çãåªéå¯¹è¯¥æ ç­¾ä¸é¢å¾å±ä¸­çææ¬æ°æ®ã
         *              å¨æ ç­¾éå åº¦å¾å¤§çæåµä¸ï¼å³ä½¿ä½¿ç¨èªå¨é¿è®©åè½ï¼å¯è½ä¹æ æ³å®å¨é¿åæ ç­¾éå ç°è±¡ã
         */
        this.overlapAvoided = true;

        /**
         * @member {string} ThemeLabel.prototype.rangeExpression
         * @description å¶ä½åæ®µæ ç­¾ä¸é¢çåæ®µå­æ®µæå­æ®µè¡¨è¾¾å¼ãè¯¥è¡¨è¾¾å¼å¯¹åºçå­æ®µï¼æèå­æ®µè¡¨è¾¾å¼ï¼çå¼åºè¯¥ä¸ºæ°å¼åã
         *              è¯¥å­æ®µä¸ items åæ®µå­é¡¹èåä½¿ç¨ï¼æ¯ä¸ªå­é¡¹çèµ·å§å¼ [startï¼end)æ¥æºäº rangeExpression å­æ®µå¼ã
         *              æå labelExpression æå®çæ ç­¾å­æ®µï¼æ ç­¾ä¸é¢å¾è¦æ¾ç¤ºçå·ä½åå®¹ï¼ä¼æ ¹æ®åæ®µå­é¡¹çé£æ ¼è¿è¡åæ®µæ¾ç¤ºã
         */
        this.rangeExpression = null;

        /**
         * @member {string} ThemeLabel.prototype.uniqueExpression
         * @description ç¨äºå¶ä½åå¼ä¸é¢å¾çå­æ®µæå­æ®µè¡¨è¾¾å¼ã
         *              è¯¥å­æ®µå¼çæ°æ®ç±»åå¯ä»¥ä¸ºæ°å¼åæå­ç¬¦åãå¦æè®¾ç½®å­æ®µè¡¨è¾¾å¼ï¼åªè½æ¯ç¸åæ°æ®ç±»åå­æ®µé´çè¿ç®ãå¿é¡»ä¸labelExpressionä¸èµ·ä½¿ç¨ã
         */
        this.uniqueExpression = null;

        /**
         * @member {boolean} [ThemeLabel.prototype.smallGeometryLabeled=false]
         * @description æ¯å¦æ¾ç¤ºé¿åº¦å¤§äºè¢«æ æ³¨å¯¹è±¡æ¬èº«é¿åº¦çæ ç­¾ãå¨æ ç­¾çé¿åº¦å¤§äºçº¿æèé¢å¯¹è±¡æ¬èº«çé¿åº¦æ¶ï¼
         *              å¦æè¯¥å¼ä¸º trueï¼åæ ç­¾æå­ä¼å å å¨ä¸èµ·æ¾ç¤ºï¼ä¸ºäºæ¸æ¥å®æ´çæ¾ç¤ºè¯¥æ ç­¾ï¼
         *              å¯ä»¥éç¨æ¢è¡æ¨¡å¼æ¥æ¾ç¤ºæ ç­¾ï¼ä½å¿é¡»ä¿è¯æ¯è¡çé¿åº¦å°äºå¯¹è±¡æ¬èº«çé¿åº¦ã
         */
        this.smallGeometryLabeled = false;

        /**
         * @member {ThemeLabelText} ThemeLabel.prototype.text
         * @description æ ç­¾ä¸­ææ¬é£æ ¼ã
         */
        this.text = new ThemeLabelText();

        /**
         * @member {number} [ThemeLabel.prototype.textSpace=0]
         * @description æ²¿çº¿æ æ³¨ï¼ç¸é»ä¸¤ä¸ªæå­ä¹é´çé´è·ï¼åä½å½åè®¾ç½®çå­é«ã
         */
        this.textSpace = 0;

        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = "SuperMap.ThemeLabel";
    }


    /**
     * @function ThemeLabel.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
        var me = this;
        me.alongLine = null;
        if (me.background) {
            me.background.destroy();
            me.background = null;
        }
        if (me.items) {
            for (var i = 0, items = me.items, len = items.length; i < len; i++) {
                items[i].destroy();
            }
            me.items = null;
        }
        if (me.uniqueItems) {
            for (var j = 0, uniqueItems = me.uniqueItems, uniqueLen = uniqueItems.length; j < uniqueLen; j++) {
                uniqueItems[j].destory();
            }
            me.uniqueItems = null;
        }
        me.labelExpression = null;
        me.labelOverLengthMode = null;
        me.matrixCells = null;
        me.maxLabelLength = null;
        me.numericPrecision = null;
        me.overlapAvoided = null;
        me.rangeExpression = null;
        me.uniqueExpression = null;
        if (me.offset) {
            me.offset.destroy();
            me.offset = null;
        }
        me.overlapAvoided = null;
        me.smallGeometryLabeled = null;
        if (me.text) {
            me.text.destroy();
            me.text = null;
        }
        me.textSpace = null;
    }

    /**
     * @function ThemeLabel.prototype.toJSON
     * @description å°themeLabelå¯¹è±¡è½¬åä¸º JSON å­ç¬¦ä¸²ã
     * @returns {string} è¿åè½¬æ¢åç JSON å­ç¬¦ä¸²ã
     */
    toJSON() {
        return Util.toJSON(this.toServerJSONObject());
    }

    /**
     * @function ThemeLabel.prototype.toServerJSONObject
     * @description è½¬æ¢æå¯¹åºç JSON æ ¼å¼å¯¹è±¡ã
     * @returns {Object} å¯¹åºç JSON æ ¼å¼å¯¹è±¡ã
     */
    toServerJSONObject() {
        var obj = {};
        obj.type = this.type;
        obj.memoryData = this.memoryData;
        if (this.alongLine) {
            obj.alongLine = this.alongLine.isAlongLine;
            obj.alongLineDirection = this.alongLine.alongLineDirection;
            obj.angleFixed = this.alongLine.angleFixed;
            obj.isLabelRepeated = this.alongLine.isLabelRepeated;
            obj.labelRepeatInterval = this.alongLine.labelRepeatInterval;
            obj.repeatedLabelAvoided = this.alongLine.repeatedLabelAvoided;
            obj.repeatIntervalFixed = this.alongLine.repeatIntervalFixed;
        }
        if (this.offset) {
            obj.offsetFixed = this.offset.offsetFixed;
            obj.offsetX = this.offset.offsetX;
            obj.offsetY = this.offset.offsetY;
        }
        if (this.text) {
            obj.maxTextHeight = this.text.maxTextHeight;
            obj.maxTextWidth = this.text.maxTextWidth;
            obj.minTextHeight = this.text.minTextHeight;
            obj.minTextWidth = this.text.minTextWidth;
            obj.uniformStyle = this.text.uniformStyle;
            obj.uniformMixedStyle = this.text.uniformMixedStyle;
        }
        if (this.background) {
            obj.labelBackShape = this.background.labelBackShape;
            obj.backStyle = this.background.backStyle;
        }
        obj.labelOverLengthMode = this.labelOverLengthMode;
        obj.maxLabelLength = this.maxLabelLength;
        obj.smallGeometryLabeled = this.smallGeometryLabeled;
        obj.rangeExpression = this.rangeExpression;
        obj.uniqueExpression = this.uniqueExpression;
        obj.numericPrecision = this.numericPrecision;
        obj.items = this.items;
        obj.uniqueItems = this.uniqueItems;
        obj.labelExpression = this.labelExpression;
        obj.overlapAvoided = this.overlapAvoided;
        obj.matrixCells = this.matrixCells;
        obj.textSpace = this.textSpace;
        return obj;
    }

    /**
     * @function ThemeLabel.fromObj
     * @description ä»ä¼ å¥å¯¹è±¡è·åæ ç­¾ä¸é¢å¾ç±»ã
     * @param {Object} obj - ä¼ å¥å¯¹è±¡ã
     * @returns {ThemeLabel} ThemeLabel å¯¹è±¡ã
     */
    static fromObj(obj) {
        if (!obj) {
            return;
        }
        var lab = new ThemeLabel();
        var itemsL = obj.items, itemsU = obj.uniqueItems, cells = obj.matrixCells;
        obj.matrixCells = null;
        Util.copy(lab, obj);
        lab.alongLine = ThemeLabelAlongLine.fromObj(obj);
        lab.background = ThemeLabelBackground.fromObj(obj);
        if (itemsL) {
            lab.items = [];
            for (var i = 0, len = itemsL.length; i < len; i++) {
                lab.items.push(ThemeLabelItem.fromObj(itemsL[i]));
            }
        }
        if (itemsU) {
            lab.uniqueItems = [];
            for (let j = 0, uniqueLen = itemsU.length; j < uniqueLen; j++) {
                lab.uniqueItems.push(ThemeUniqueItem.fromObj(itemsU[j]));
            }
        }
        if (cells) {
            lab.matrixCells = [];
            for (let i = 0, len = cells.length; i < len; i++) {
                //TODO
                //lab.matrixCells.push(LabelMatrixCell.fromObj(cells[i]));
            }
        }
        lab.offset = ThemeOffset.fromObj(obj);
        lab.text = ThemeLabelText.fromObj(obj);
        return lab;
    }

}


;// CONCATENATED MODULE: ./src/common/iServer/ThemeUnique.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/







/**
 * @class ThemeUnique
 * @deprecatedclass SuperMap.ThemeUnique
 * @category  iServer Map Theme
 * @classdesc åå¼ä¸é¢å¾ãåå¼ä¸é¢å¾æ¯å©ç¨ä¸åçé¢è²æç¬¦å·ï¼çº¿åãå¡«åï¼è¡¨ç¤ºå¾å±ä¸­æä¸å±æ§ä¿¡æ¯çä¸åå±æ§å¼ï¼å±æ§å¼ç¸åçè¦ç´ å·æç¸åçæ¸²æé£æ ¼ãåå¼ä¸é¢å¾å¤ç¨äºå·æåç±»å±æ§çå°å¾ä¸ï¼
 * æ¯å¦åå£¤ç±»ååå¸å¾ãåå°å©ç¨å¾ãè¡æ¿åºåå¾ç­ãåå¼ä¸é¢å¾çéè¡¨ç¤ºç°è±¡è´¨çå·®å«ï¼ä¸è¬ä¸è¡¨ç¤ºæ°éçç¹å¾ãå°¤å¶æ¯æäº¤åæéå ç°è±¡æ¶ï¼æ­¤ç±»ä¸æ¨èä½¿ç¨ï¼ä¾å¦ï¼æ°æåå¸åºç­ã
 * @extends {CommonTheme}
 * @param {Object} options - åæ°ã
 * @param {Array.<ThemeUniqueItem>} options.items - å­é¡¹ç±»æ°ç»ã
 * @param {string} options.uniqueExpression - æå®åå¼ä¸é¢å¾çå­æ®µæå­æ®µè¡¨è¾¾å¼ã
 * @param {ServerStyle} [options.defaultStyle] - æªåä¸åå¼ä¸é¢å¾å¶ä½çå¯¹è±¡çæ¾ç¤ºé£æ ¼ã
 * @param {ColorGradientType} [options.colorGradientType=ColorGradientType.YELLOW_RED] - æ¸åé¢è²æä¸¾ç±»ã
 * @param {ThemeMemoryData} [options.memoryData] - ä¸é¢å¾åå­æ°æ®ã
 * @usage
 */
class ThemeUnique extends Theme {

    constructor(options) {
        super("UNIQUE", options);
        /**
         * @member {ServerStyle} ThemeUnique.prototype.defaultStyle
         * @description æªåä¸åå¼ä¸é¢å¾å¶ä½çå¯¹è±¡çæ¾ç¤ºé£æ ¼ã
         *              éè¿åå¼ä¸é¢å¾å­é¡¹æ°ç» ï¼itemsï¼å¯ä»¥æå®æäºè¦ç´ åä¸åå¼ä¸é¢å¾å¶ä½ï¼å¯¹äºé£äºæ²¡æè¢«åå«çè¦ç´ ï¼å³ä¸åå åå¼ä¸é¢è¡¨è¾¾çè¦ç´ ï¼ä½¿ç¨è¯¥é£æ ¼æ¾ç¤ºã
         */
        this.defaultStyle = new ServerStyle();

        /**
         * @member {Array.<ThemeUniqueItem>} ThemeUnique.prototype.items
         * @description åå¼ä¸é¢å¾å­é¡¹ç±»æ°ç»ã
         *              åå¼ä¸é¢å¾æ¯å°ä¸é¢å¼ç¸åçè¦ç´ å½ä¸ºä¸ç±»ï¼ä¸ºæ¯ä¸ç±»è®¾å®ä¸ç§æ¸²æé£æ ¼ï¼å¶ä¸­æ¯ä¸ç±»å°±æ¯ä¸ä¸ªä¸é¢å¾å­é¡¹ãæ¯å¦ï¼å©ç¨åå¼ä¸é¢å¾å¶ä½è¡æ¿åºåå¾ï¼
         *              Name å­æ®µä»£è¡¨ç/ç´è¾å¸åï¼è¯¥å­æ®µç¨æ¥åä¸é¢åéï¼å¦æè¯¥å­æ®µçå­æ®µå¼æ»å±æ5ç§ä¸åå¼ï¼åè¯¥è¡æ¿åºåå¾æ 5 ä¸ªä¸é¢å¾å­é¡¹ã
         */
        this.items = null;

        /**
         * @member {string} ThemeUnique.prototype.uniqueExpression
         * @description ç¨äºå¶ä½åå¼ä¸é¢å¾çå­æ®µæå­æ®µè¡¨è¾¾å¼ã
         *              è¯¥å­æ®µå¼çæ°æ®ç±»åå¯ä»¥ä¸ºæ°å¼åæå­ç¬¦åãå¦æè®¾ç½®å­æ®µè¡¨è¾¾å¼ï¼åªè½æ¯ç¸åæ°æ®ç±»åå­æ®µé´çè¿ç®ã
         */
        this.uniqueExpression = null;

        /**
         * @member {ColorGradientType} [ThemeUnique.prototype.colorGradientType=ColorGradientType.YELLOW_RED]
         * @description æ¸åé¢è²æä¸¾ç±»ã
         *              æ¸åè²æ¯ç±èµ·å§è²æ ¹æ®ä¸å®ç®æ³éæ¸è¿æ¸¡å°ç»æ­¢è²çä¸ç§æ··ååé¢è²ã
         *              è¯¥ç±»ä½ä¸ºåå¼ä¸é¢å¾åæ°ç±»ãåæ®µä¸é¢å¾åæ°ç±»çå±æ§ï¼è´è´£è®¾ç½®åå¼ä¸é¢å¾ãåæ®µä¸é¢å¾çéè²æ¹æ¡ï¼å¨é»è®¤æåµä¸ä¸é¢å¾ææå­é¡¹ä¼æ ¹æ®è¿ä¸ªéè²æ¹æ¡å®æå¡«åã
         *              ä½å¦æä¸ºæå ä¸ªå­é¡¹çé£æ ¼è¿è¡åç¬è®¾ç½®åï¼è®¾ç½®äº ThemeUniqueItem æ ThemeRangeItem ç±»ä¸­Styleå±æ§ï¼ï¼
         *              è¯¥éè²æ¹æ¡å¯¹äºè¿å ä¸ªå­é¡¹å°ä¸èµ·ä½ç¨ã
         */
        this.colorGradientType = ColorGradientType.YELLOW_RED;

        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = "SuperMap.ThemeUnique";
    }

    /**
     * @function ThemeUnique.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
        var me = this;
        me.uniqueExpression = null;
        me.colorGradientType = null;
        if (me.items) {
            if (me.items.length > 0) {
                for (var item in me.items) {
                    me.items[item].destroy();
                    me.items[item] = null;
                }
            }
            me.items = null;
        }

        if (me.defaultStyle) {
            me.defaultStyle.destroy();
            me.defaultStyle = null;
        }
    }


    /**
     * @function ThemeUnique.prototype.toServerJSONObject
     * @description è½¬æ¢æå¯¹åºç JSON æ ¼å¼å¯¹è±¡ã
     * @returns {Object} å¯¹åºç JSON æ ¼å¼å¯¹è±¡ã
     */
    toServerJSONObject() {
        var obj = {};
        obj = Util.copyAttributes(obj, this);
        if (obj.defaultStyle) {
            if (obj.defaultStyle.toServerJSONObject) {
                obj.defaultStyle = obj.defaultStyle.toServerJSONObject();
            }
        }
        if (obj.items) {
            var items = [],
                len = obj.items.length;
            for (var i = 0; i < len; i++) {
                items.push(obj.items[i].toServerJSONObject());
            }
            obj.items = items;
        }
        return obj;
    }

    /**
     * @function ThemeUnique.fromObj
     * @description ä»ä¼ å¥å¯¹è±¡è·ååå¼ä¸é¢å¾ç±»ã
     * @param {Object} obj - ä¼ å¥å¯¹è±¡ã
     * @returns {ThemeUnique} ThemeUnique å¯¹è±¡ã
     */
    static fromObj(obj) {
        var res = new ThemeUnique();
        var uItems = obj.items;
        var len = uItems ? uItems.length : 0;
        Util.extend(res, obj);
        res.items = [];
        res.defaultStyle = ServerStyle.fromJson(obj.defaultStyle);
        for (var i = 0; i < len; i++) {
            res.items.push(ThemeUniqueItem.fromObj(uItems[i]));
        }
        return res;
    }

}


;// CONCATENATED MODULE: ./src/common/iServer/ThemeGraphAxes.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class ThemeGraphAxes
 * @deprecatedclass SuperMap.ThemeGraphAxes
 * @category  iServer Map Theme
 * @classdesc ç»è®¡ä¸é¢å¾åæ è½´æ ·å¼ç±»ã
 * @param {Object} options - åæ°ã
 * @param {ServerColor} [options.axesColor=(0, 0, 0)] - åæ è½´é¢è²ã
 * @param {boolean} [options.axesDisplayed=false] - æ¯å¦æ¾ç¤ºåæ è½´ã
 * @param {boolean} [options.axesGridDisplayed=false] - æ¯å¦å¨ç»è®¡å¾åæ è½´ä¸æ¾ç¤ºç½æ ¼ã
 * @param {boolean} [options.axesTextDisplayed=false] - æ¯å¦æ¾ç¤ºåæ è½´çææ¬æ æ³¨ã
 * @param {ServerTextStyle} [options.axesTextStyle] - ç»è®¡ç¬¦å·çæå¤§æå°å°ºå¯¸ã
 * @usage
 */
class ThemeGraphAxes {

    constructor(options) {

        /**
         * @member {ServerColor} [ThemeGraphAxes.prototype.axesColor=(0, 0, 0)]
         * @description åæ è½´é¢è²ãå½ axesDisplayed = true æ¶ææã
         */
        this.axesColor =  new ServerColor(0, 0, 0);

        /**
         * @member {boolean} [ThemeGraphAxes.prototype.axesDisplayed=false]
         * @description æ¯å¦æ¾ç¤ºåæ è½´ã<br>
         *              ç±äºé¥¼ç¶å¾åç¯ç¶å¾æ åæ è½´ï¼æè¯¥å±æ§ä»¥åææä¸åæ è½´è®¾ç½®ç¸å³çå±æ§é½ä¸éç¨äºå®ä»¬ãå¹¶ä¸åªæå½è¯¥å¼ä¸º true æ¶ï¼å¶å®è®¾ç½®åæ è½´çå±æ§æèµ·ä½ç¨ã
         */
        this.axesDisplayed = false;

        /**
         * @member {boolean} [ThemeGraphAxes.prototype.axesGridDisplayed=false]
         * @description æ¯å¦å¨ç»è®¡å¾åæ è½´ä¸æ¾ç¤ºç½æ ¼ã
         */
        this.axesGridDisplayed = false;

        /**
         * @member {boolean} [ThemeGraphAxes.prototype.axesTextDisplayed=false]
         * @description æ¯å¦æ¾ç¤ºåæ è½´çææ¬æ æ³¨ã
         */
        this.axesTextDisplayed = false;

        /**
         * @member {ServerTextStyle} ThemeGraphAxes.prototype.axesTextStyle
         * @description åæ è½´ææ¬é£æ ¼ãå½ axesTextDisplayed = true æ¶ææã
         */
        this.axesTextStyle =  new ServerTextStyle();

        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = "SuperMap.ThemeGraphAxes";
    }

    /**
     * @function ThemeGraphAxes.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        if (me.axesColor) {
            me.axesColor.destroy();
            me.axesColor = null;
        }
        me.axesDisplayed = null;
        me.axesGridDisplayed = null;
        me.axesTextDisplayed = null;
        if (me.axesTextStyle) {
            me.axesTextStyle.destroy();
            me.axesTextStyle = null;
        }
    }

    /**
     * @function ThemeGraphAxes.fromObj
     * @description ä»ä¼ å¥å¯¹è±¡è·åç»è®¡ä¸é¢å¾åæ è½´æ ·å¼ç±»ã
     * @param {Object} obj - ä¼ å¥å¯¹è±¡ã
     * @returns {ThemeGraphAxes} ThemeGraphAxes å¯¹è±¡ã
     */
    static fromObj(obj) {
        if (!obj) {
            return;
        }
        var res = new ThemeGraphAxes();
        Util.copy(res, obj);
        res.axesColor = ServerColor.fromJson(obj.axesColor);
        res.axesTextStyle = ServerTextStyle.fromObj(obj.axesTextStyle);
        return res;
    }

}


;// CONCATENATED MODULE: ./src/common/iServer/ThemeGraphSize.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class ThemeGraphSize
 * @deprecatedclass SuperMap.ThemeGraphSize
 * @category  iServer Map Theme
 * @classdesc ç»è®¡ä¸é¢å¾ç¬¦å·å°ºå¯¸ç±»ã
 * @param {Object} options - åæ°ã
 * @param {number} [options.maxGraphSize=0] - ç»è®¡å¾ä¸­æ¾ç¤ºçæå¤§å¾è¡¨å°ºå¯¸åºåå¼ã
 * @param {number} [options.minGraphSize=0] - ç»è®¡å¾ä¸­æ¾ç¤ºçæå°å¾è¡¨å°ºå¯¸åºåå¼ã
 * @usage
 */
class ThemeGraphSize {

    constructor(options) {
        /**
         * @member {number} [ThemeGraphSize.prototype.maxGraphSize=0]
         * @description è·åæè®¾ç½®ç»è®¡å¾ä¸­æ¾ç¤ºçæå¤§å¾è¡¨å°ºå¯¸åºåå¼ï¼åä½ä¸ºåç´ ã
         */
        this.maxGraphSize = 0;

        /**
         * @member {number} [ThemeGraphSize.prototype.minGraphSize=0]
         * @description è·åæè®¾ç½®ç»è®¡å¾ä¸­æ¾ç¤ºçæå°å¾è¡¨å°ºå¯¸åºåå¼ï¼åä½ä¸ºåç´ ã
         */
        this.minGraphSize = 0;

        if (options) {
            Util.extend(this, options);
        }

       this.CLASS_NAME = "SuperMap.ThemeGraphSize";
    }

    /**
     * @function ThemeGraphSize.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.maxGraphSize = null;
        me.minGraphSize = null;
    }

    /**
     * @function ThemeGraphSize.fromObj
     * @description ä»ä¼ å¥å¯¹è±¡è·ç»è®¡ä¸é¢å¾ç¬¦å·å°ºå¯¸ç±»ã
     * @param {Object} obj - ä¼ å¥å¯¹è±¡ã
     * @returns {ThemeGraphSize}  ThemeGraphSize å¯¹è±¡ã
     */
    static fromObj(obj) {
        var res = new ThemeGraphSize();
        Util.copy(res, obj);
        return res;
    }

}


;// CONCATENATED MODULE: ./src/common/iServer/ThemeGraphText.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class ThemeGraphText
 * @deprecatedclass SuperMap.ThemeGraphText
 * @category  iServer Map Theme
 * @classdesc ç»è®¡å¾æå­æ æ³¨é£æ ¼ç±»ã
 * @param {Object} options - å¯éåæ°ã
 * @param {boolean} [options.graphTextDisplayed=false] - æ¯å¦æ¾ç¤ºç»è®¡å¾ä¸çæå­æ æ³¨ã
 * @param {ThemeGraphTextFormat} [options.graphTextFormat=ThemeGraphTextFormat.CAPTION] - ç»è®¡ä¸é¢å¾ææ¬æ¾ç¤ºæ ¼å¼ã
 * @param {ServerTextStyle} [options.graphTextStyle] - ç»è®¡å¾ä¸çæå­æ æ³¨é£æ ¼ã
 * @usage
 */
class ThemeGraphText {

    constructor(options) {

        /**
         * @member {boolean} [ThemeGraphText.prototype.graphTextDisplayed=false]
         * @description æ¯å¦æ¾ç¤ºç»è®¡å¾ä¸çæå­æ æ³¨ã
         */
        this.graphTextDisplayed = false;

        /**
         * @member {ThemeGraphTextFormat} [ThemeGraphText.prototype.graphTextFormat=ThemeGraphTextFormat.CAPTION]
         * @description ç»è®¡ä¸é¢å¾ææ¬æ¾ç¤ºæ ¼å¼ã
         *              ææ¬æ¾ç¤ºæ ¼å¼åæ¬ç¾åæ°ãçå®æ°å¼ãæ é¢ãæ é¢+ç¾åæ°ãæ é¢+çå®æ°å¼ã
         */
        this.graphTextFormat = ThemeGraphTextFormat.CAPTION;

        /**
         * @member {ServerTextStyle} ThemeGraphText.prototype.graphTextStyle
         * @description ç»è®¡å¾ä¸çæå­æ æ³¨é£æ ¼ã
         */
        this.graphTextStyle =  new ServerTextStyle();

        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = "SuperMap.ThemeGraphText";
    }

    /**
     * @function ThemeGraphText.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.graphTextDisplayed = null;
        me.graphTextFormat = null;
        if (me.graphTextStyle) {
            me.graphTextStyle.destroy();
            me.graphTextStyle = null;
        }
    }

    /**
     * @function ThemeGraphText.fromObj
     * @description ä»ä¼ å¥å¯¹è±¡è·åç»è®¡å¾æå­æ æ³¨é£æ ¼ç±»ã
     * @param {Object} obj - ä¼ å¥å¯¹è±¡ã
     * @returns {ThemeGraphText} ThemeGraphText å¯¹è±¡ã
     */
    static fromObj(obj) {
        var res = new ThemeGraphText();
        Util.copy(res, obj);
        res.graphTextStyle = ServerTextStyle.fromObj(obj.graphTextStyle);
        return res;

    }

}


;// CONCATENATED MODULE: ./src/common/iServer/ThemeGraphItem.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class ThemeGraphItem
 * @deprecatedclass SuperMap.ThemeGraphItem
 * @category  iServer Map Theme
 * @classdesc ç»è®¡ä¸é¢å¾å­é¡¹ç±»ã
 * @param {Object} options - åæ°ã
 * @param {string} [options.caption] - ä¸é¢å¾å­é¡¹çåç§°ã
 * @param {string} options.graphExpression - ç»è®¡ä¸é¢å¾çä¸é¢åéã
 * @param {Array.<number>} [options.memoryDoubleValues] - åå­æ°ç»æ¹å¼å¶ä½ä¸é¢å¾æ¶çå¼æ°ç»ã
 * @param {ServerStyle} [options.uniformStyle] - ç»è®¡ä¸é¢å¾å­é¡¹çæ¾ç¤ºé£æ ¼
 * @usage
 */
class ThemeGraphItem {

    constructor(options) {

        /**
         * @member {string} [ThemeGraphItem.prototype.caption]
         * @description ä¸é¢å¾å­é¡¹çåç§°ã
         */
        this.caption = null;

        /**
         * @member {string} ThemeGraphItem.prototype.graphExpression
         * @description ç»è®¡ä¸é¢å¾çä¸é¢åéãä¸é¢åéå¯ä»¥æ¯ä¸ä¸ªå­æ®µæå­æ®µè¡¨è¾¾å¼ãå­æ®µå¿é¡»ä¸ºæ°å¼åï¼è¡¨è¾¾å¼åªè½ä¸ºæ°å¼åçå­æ®µé´çè¿ç®ã
         */
        this.graphExpression = null;

        /**
         * @member {Array.<number>} [ThemeGraphItem.prototype.memoryDoubleValues]
         * @description åå­æ°ç»æ¹å¼å¶ä½ä¸é¢å¾æ¶çå¼æ°ç»ã<br>
         *              åå­æ°ç»æ¹å¼å¶ä½ä¸é¢å¾æ¶ï¼åªå¯¹ SmID å¼å¨é®æ°ç»ï¼{@link ThemeGraph#memoryKeys}ï¼ä¸­çè®°å½å¶ä½ä¸é¢å¾ã
         *              å¼æ°ç»çæ°å¼ä¸ªæ°å¿é¡»ä¸é®æ°ç»ä¸­æ°å¼çä¸ªæ°ä¸è´ã å¼æ°ç»ä¸­çå¼å°ä»£æ¿åæ¥çä¸é¢å¼æ¥å¶ä½ç»è®¡ä¸é¢å¾ã
         *              æ¯å¦ï¼å©ç¨é¢ç§¯å­æ®µåå¨é¿å­æ®µï¼å³æä¸¤ä¸ªç»è®¡ä¸é¢å¾å­é¡¹ ï¼ä½ä¸ºä¸é¢åéå¶ä½ç»è®¡ä¸é¢å¾ã
         */
        this.memoryDoubleValues = null;

        /**
         * @member {ServerStyle} [ThemeGraphItem.prototype.uniformStyle]
         * @description ç»è®¡ä¸é¢å¾å­é¡¹çæ¾ç¤ºé£æ ¼ã
         *              æ¯ä¸ä¸ªç»è®¡ä¸é¢å¾å­é¡¹é½å¯¹åºä¸ç§æ¾ç¤ºé£æ ¼ã
         */
        this.uniformStyle = new ServerStyle();

        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = "SuperMap.ThemeGraphItem";
    }

    /**
     * @function ThemeGraphItem.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.caption = null;
        me.graphExpression = null;
        me.memoryDoubleValues = null;
        me.uniformStyle = null;
    }

    /**
     * @function ThemeGraphItem.fromObj
     * @description ä»ä¼ å¥å¯¹è±¡è·åç»è®¡ä¸é¢å¾å­é¡¹ç±»ã
     * @param {Object} obj - ä¼ å¥å¯¹è±¡ã
     * @returns {ThemeGraphItem} ThemeGraphItem å¯¹è±¡ã
     */
    static fromObj(obj) {
        if (!obj) {
            return;
        }
        var res = new ThemeGraphItem();
        Util.copy(res, obj);
        res.uniformStyle = ServerStyle.fromJson(obj.uniformStyle);
        return res;
    }

}


;// CONCATENATED MODULE: ./src/common/iServer/ThemeGraph.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/










/**
 * @class ThemeGraph
 * @deprecatedclass SuperMap.ThemeGraph
 * @category  iServer Map Theme
 * @classdesc ç»è®¡ä¸é¢å¾ç±»ã
 * @extends {CommonTheme}
 * @param {Object} options - åæ°ã
 * @param {Array.<ThemeGraphItem>} options.items - ç»è®¡ä¸é¢å¾å­é¡¹éåã
 * @param {number}  [options.barWidth=0] - æ±ç¶ä¸é¢å¾ä¸­æ¯ä¸ä¸ªæ±çå®½åº¦ã
 * @param {GraduatedMode} [options.graduatedMode=GraduatedMode.CONSTANT] - ç»è®¡å¾ä¸­å°çè¦ç´ çå¼ä¸å¾è¡¨å°ºå¯¸é´çæ å°å³ç³»ã
 * @param {ThemeGraphAxes} [options.graphAxes] - ç»è®¡å¾ä¸­åæ è½´æ ·å¼ç¸å³ä¿¡æ¯ã
 * @param {ThemeGraphSize} [options.graphSize=0] - ç»è®¡ç¬¦å·çæå¤§æå°å°ºå¯¸ã
 * @param {boolean} [options.graphSizeFixed=false] - ç¼©æ¾å°å¾æ¶ç»è®¡å¾ç¬¦å·æ¯å¦åºå®å¤§å°ã
 * @param {ThemeGraphText} [options.graphText] - ç»è®¡å¾ä¸çæå­æ¯å¦å¯ä»¥è§ä»¥åæå­æ æ³¨é£æ ¼ã
 * @param {GraphAxesTextDisplayMode} [options.graphAxesTextDisplayMode=GraphAxesTextDisplayMode.NONE] - ç»è®¡ä¸é¢å¾åæ è½´ææ¬æ¾ç¤ºæ¨¡å¼ã
 * @param {ThemeGraphType} [options.graphType=ThemeGraphType.AREA] - ç»è®¡ä¸é¢å¾ç±»åã
 * @param {Array.<number>} [options.memoryKeys] - ä»¥åå­æ°ç»æ¹å¼å¶ä½ä¸é¢å¾æ¶çé®æ°ç»ã
 * @param {boolean} [options.negativeDisplayed=false] - ä¸é¢å¾ä¸­æ¯å¦æ¾ç¤ºå±æ§ä¸ºè´å¼çæ°æ®ã
 * @param {ThemeOffset} [options.offset] - ç»è®¡å¾ç¸å¯¹äºè¦ç´ åç¹çåç§»éã
 * @param {boolean} [options.overlapAvoided=true] - ç»è®¡å¾æ¯å¦éç¨é¿è®©æ¹å¼æ¾ç¤ºã
 * @param {number} [options.roseAngle=0] - ç»è®¡å¾ä¸­ç«ç°å¾æä¸ç»´ç«ç°å¾ç¨äºç­åçè§åº¦ã
 * @param {number} [options.startAngle=0] - é¥¼ç¶ç»è®¡å¾æå½¢çèµ·å§è§åº¦ã
 * @usage
 */
class ThemeGraph extends Theme {

    constructor(options) {
        super("GRAPH", options);
        /**
         * @member {number} [ThemeGraph.prototype.barWidth=0]
         * @description æ±ç¶ä¸é¢å¾ä¸­æ¯ä¸ä¸ªæ±çå®½åº¦ãä½¿ç¨å°å¾åæ åä½ã
         *              åªæéæ©çç»è®¡å¾ç±»åä¸ºæ±ç¶å¾ï¼æ±ç¶å¾ãä¸ç»´æ±ç¶å¾ãå å æ±ç¶å¾ãä¸ç»´å å æ±ç¶å¾ï¼æ¶ï¼æ­¤é¡¹æå¯è®¾ç½®ã
         */
        this.barWidth = 0;

        /**
         * @member {GraduatedMode} [ThemeGraph.prototype.graduatedMode=GraduatedMode.CONSTANT]
         * @description ç»è®¡å¾ä¸­å°çè¦ç´ çå¼ä¸å¾è¡¨å°ºå¯¸é´çæ å°å³ç³»ï¼å¸¸æ°ãå¯¹æ°ãå¹³æ¹æ ¹ï¼ï¼å³åçº§æ¹å¼ã
         *              åçº§ä¸»è¦æ¯ä¸ºäºåå°å¶ä½ç»è®¡ä¸é¢å¾ä¸­æ°æ®å¤§å°ä¹é´çå·®å¼ï¼ä½¿å¾ç»è®¡å¾çè§è§æææ¯è¾å¥½ï¼åæ¶ä¸åç±»å«ä¹é´çæ¯è¾ä¹è¿æ¯ææä¹çã
         *              æä¾ä¸ç§åçº§æ¨¡å¼ï¼å¸¸æ°ãå¯¹æ°åå¹³æ¹æ ¹ï¼å¯¹äºæå¼ä¸ºè´æ°çå­æ®µï¼ä¸å¯ä»¥éç¨å¯¹æ°åå¹³æ¹æ ¹çåçº§æ¹å¼ãä¸åçç­çº§æ¹å¼ç¨äºç¡®å®ç¬¦å·å¤§å°çæ°å¼æ¯ä¸ç¸åçã
         */
        this.graduatedMode = GraduatedMode.CONSTANT;

        /**
         * @member {ThemeGraphAxes} ThemeGraph.prototype.graphAxes
         * @description ç¨äºè®¾ç½®ç»è®¡å¾ä¸­åæ è½´æ ·å¼ç¸å³ä¿¡æ¯ï¼å¦åæ è½´é¢è²ãæ¯å¦æ¾ç¤ºãåæ ææ¬æ ·å¼ç­ã
         */
        this.graphAxes = new ThemeGraphAxes();

        /**
         * @member {ThemeGraphSize} [ThemeGraph.prototype.graphSize=0]
         * @description ç¨äºè®¾ç½®ç»è®¡ç¬¦å·çæå¤§æå°å°ºå¯¸ã
         */
        this.graphSize = new ThemeGraphSize();

        /**
         * @member {boolean} [ThemeGraph.prototype.graphSizeFixed=false]
         * @description ç¼©æ¾å°å¾æ¶ç»è®¡å¾ç¬¦å·æ¯å¦åºå®å¤§å°ãå³ç»è®¡å¾ç¬¦å·å°éå°å¾ç¼©æ¾ã
         */
        this.graphSizeFixed = false;

        /**
         * @member {ThemeGraphText} ThemeGraph.prototype.graphText
         * @description ç»è®¡å¾ä¸çæå­æ¯å¦å¯ä»¥è§ä»¥åæå­æ æ³¨é£æ ¼ã
         */
        this.graphText =  new ThemeGraphText();

        /**
         * @member {ThemeGraphType} [ThemeGraph.prototype.graphType=ThemeGraphType.AREA]
         * @description ç»è®¡ä¸é¢å¾ç±»åãSuperMap æä¾äºå¤ç§ç±»åçç»è®¡å¾ï¼
         *              åå«ä¸ºé¢ç§¯å¾ãé¶æ¢¯å¾ãæçº¿å¾ãç¹ç¶å¾ãæ±ç¶å¾ãä¸ç»´æ±ç¶å¾ãé¥¼å¾ãä¸ç»´é¥¼å¾ãç«ç°å¾ãä¸ç»´ç«ç°å¾ãå å æ±ç¶å¾ãä¸ç»´å å æ±ç¶å¾ãç¯ç¶å¾ãé»è®¤ä¸ºé¢ç§¯å¾ã
         */
        this.graphType = ThemeGraphType.AREA;

        /**
         * @member {GraphAxesTextDisplayMode} [ThemeGraph.prototype.graphAxesTextDisplayMode=GraphAxesTextDisplayMode.NONE]
         * @description ç»è®¡ä¸é¢å¾åæ è½´ææ¬æ¾ç¤ºæ¨¡å¼ã
         */
        this.graphAxesTextDisplayMode = GraphAxesTextDisplayMode.NONE;

        /**
         * @member {Array.<ThemeGraphItem>} ThemeGraph.prototype.items
         * @description ç»è®¡ä¸é¢å¾å­é¡¹éåã
         *              ç»è®¡ä¸é¢å¾å¯ä»¥åºäºå¤ä¸ªåéï¼åæ å¤ç§å±æ§ï¼å³å¯ä»¥å°å¤ä¸ªä¸é¢åéçå¼ç»å¶å¨ä¸ä¸ªç»è®¡å¾ä¸ãæ¯ä¸ä¸ªä¸é¢åéå¯¹åºçç»è®¡å¾å³ä¸ºä¸ä¸ªä¸é¢å¾å­é¡¹ã
         *              å¯¹äºæ¯ä¸ªä¸é¢å¾å­é¡¹å¯ä»¥ä¸ºå¶è®¾ç½®æ é¢ãé£æ ¼ï¼çè³å¯ä»¥å°è¯¥å­é¡¹åå¶ä½æèå´åæ®µä¸é¢å¾ã
         */
        this.items = null;

        /**
         * @member {Array.<number>} ThemeGraph.prototype.memoryKeys
         * @description ä»¥åå­æ°ç»æ¹å¼å¶ä½ä¸é¢å¾æ¶çé®æ°ç»ã
         *              é®æ°ç»åçæ°å¼ä»£è¡¨ SmID å¼ï¼å®ä¸ {@link ThemeGraphItem} ç±»ä¸­çå¼æ°ç»ï¼{@link ThemeGraphItem#memoryDoubleValues}ï¼è¦å³èèµ·æ¥åºç¨ã
         *              é®æ°ç»ä¸­æ°å¼çä¸ªæ°å¿é¡»è¦ä¸å¼æ°ç»çæ°å¼ä¸ªæ°ä¸è´ãå¼æ°ç»ä¸­çå¼å°ä»£æ¿åæ¥çä¸é¢å¼æ¥å¶ä½ç»è®¡ä¸é¢å¾ã
         *              ç®åææçä¸é¢å¾é½æ¯æä»¥åå­æ°ç»çæ¹å¼å¶ä½ä¸é¢å¾ï¼ä½ç»è®¡ä¸é¢å¾ä¸å¶ä»ä¸é¢å¾æå®åå­æ°ç»çæ¹å¼ä¸åï¼
         *              ç»è®¡ä¸é¢å¾ä½¿ç¨ memoryKeys æå®åå­æ°ç»ï¼èå¶ä»ä¸é¢å¾åä½¿ç¨ memoryData æ¥æå®åå­æ°ç»ã
         * @example
         *  memoryKeys çä½¿ç¨æ¹æ³å¦ä¸ï¼
         *  function addThemeGraph() {
         *      removeTheme();
         *       //åå»ºç»è®¡ä¸é¢å¾å¯¹è±¡ï¼ThemeGraph å¿è®¾ itemsã
         *       //ä¸é¢å¾åæ° ThemeParameters å¿è®¾ themeï¼å³ä»¥è®¾ç½®å¥½çåæ®µä¸é¢å¾å¯¹è±¡ï¼ãdataSourceName å datasetName
         *      var style1 = new ServerStyle({
         *                   fillForeColor: new ServerColor(92,73,234),
         *                   lineWidth: 0.1
         *               }),
         *               style2 = new ServerStyle({
         *                   fillForeColor: new ServerColor(211,111,240),
         *                   lineWidth: 0.1
         *               }),
         *               item1 = new ThemeGraphItem({
         *                   memoryDoubleValues:[1.18,0.95,0.37,1.31,0.8,1.5],
         *                  caption: "1992-1995äººå£å¢é¿ç",
         *                  graphExpression: "Pop_Rate95",
         *                   uniformStyle: style1
         *               }),
         *               item2 = new ThemeGraphItem({
         *               //ä»¥åå­æ°ç»æ¹å¼å¶ä½ä¸é¢å¾æ¶çå¼æ°ç»
         *                   memoryDoubleValues:[2.71,0,0.74,3.1,2.2,3.5],
         *                   caption: "1995-1999äººå£å¢é¿ç",  //ä¸é¢å¾å­é¡¹çåç§°
         *                   graphExpression: "Pop_Rate99",  //ç»è®¡ä¸é¢å¾çä¸é¢åé
         *                   uniformStyle: style2      //ç»è®¡ä¸é¢å¾å­é¡¹çæ¾ç¤ºé£æ ¼
         *               }),
         *               themeGraph  = new ThemeGraph({
         *               //ä»¥åå­æ°ç»æ¹å¼å¶ä½ä¸é¢å¾æ¶çé®æ°ç»ï¼é®æ°ç»åçæ°å¼ä»£è¡¨ SmID å¼
         *                    memoryKeys:[1,2,4,8,10,12],
         *                   items: new Array(item1,item2),
         *                   barWidth: 0.03,
         *                    //ç»è®¡å¾ä¸­å°çè¦ç´ çå¼ä¸å¾è¡¨å°ºå¯¸é´çæ å°å³ç³»ä¸ºå¹³æ¹æ ¹
         *                   graduatedMode: GraduatedMode.SQUAREROOT,
         *                   //graphAxesç¨äºè®¾ç½®ç»è®¡å¾ä¸­åæ è½´æ ·å¼ç¸å³ä¿¡æ¯
         *                   graphAxes: new ThemeGraphAxes({
         *                       axesDisplayed: true
         *                   }),
         *                   graphSize: new ThemeGraphSize({
         *                       maxGraphSize: 1,
         *                       minGraphSize: 0.35
         *                   }),
         *                   //ç»è®¡å¾ä¸çæå­æ¯å¦å¯ä»¥è§ä»¥åæå­æ æ³¨é£æ ¼
         *                   graphText: new ThemeGraphText({
         *                       graphTextDisplayed: true,
         *                       graphTextFormat: ThemeGraphTextFormat.VALUE,
         *                       graphTextStyle: new ServerTextStyle({
         *                           sizeFixed: true,
         *                           fontHeight: 9,
         *                           fontWidth: 5
         *                       })
         *                   }),
         *                   //ç»è®¡ä¸é¢å¾ç±»åä¸ºä¸ç»´æ±ç¶å¾
         *                   graphType: ThemeGraphType.BAR3D
         *               }),
         *                   //ä¸é¢å¾åæ°å¯¹è±¡
         *               themeParameters = new ThemeParameters({
         *                   themes: [themeGraph],
         *                   dataSourceNames: ["Jingjin"],
         *                   datasetNames: ["BaseMap_R"]
         *               }),
         *                   //ä¸æå¡ç«¯äº¤äº
         *               themeService=new ThemeService(url, {
         *                   eventListeners: {
         *                       "processCompleted": ThemeCompleted,
         *                        "processFailed": themeFailed
         *                  }
         *              });
         *       themeService.processAsync(themeParameters);
         *   }
         */
        this.memoryKeys = null;

        /**
         * @member {boolean} [ThemeGraph.prototype.negativeDisplayed=false]
         * @description ä¸é¢å¾ä¸­æ¯å¦æ¾ç¤ºå±æ§ä¸ºè´å¼çæ°æ®ãtrue è¡¨ç¤ºæ¾ç¤ºï¼falese ä¸æ¾ç¤ºã
         */
        this.negativeDisplayed = false;

        /**
         * @member {ThemeOffset} ThemeGraph.prototype.offset
         * @description ç¨äºè®¾ç½®ç»è®¡å¾ç¸å¯¹äºè¦ç´ åç¹çåç§»éã
         */
        this.offset = new ThemeOffset();

        /**
         * @member {boolean} ThemeGraph.prototype.overlapAvoided
         * @description ç»è®¡å¾æ¯å¦éç¨é¿è®©æ¹å¼æ¾ç¤ºã<br>
         *              1.å¯¹æ°æ®éå¶ä½ç»è®¡ä¸é¢å¾:å½ç»è®¡å¾éç¨é¿è®©æ¹å¼æ¾ç¤ºæ¶ï¼å¦æ overlapAvoided ä¸º trueï¼åå¨ç»è®¡å¾éå åº¦å¾å¤§çæåµä¸ï¼
         *              ä¼åºç°æ æ³å®å¨é¿åç»è®¡å¾éå çç°è±¡ï¼å¦æ overlapAvoided ä¸º falseï¼ä¼è¿æ»¤æä¸äºç»è®¡å¾ï¼ä»èä¿è¯ææçç»è®¡å¾åä¸éå ã<br>
         *              2.å¯¹æ°æ®éåæ¶å¶ä½ç»è®¡ä¸é¢å¾åæ ç­¾ä¸é¢å¾ï¼å½ç»è®¡å¾ä¸æ¾ç¤ºå­é¡¹ææ¬æ¶ï¼æ ç­¾ä¸é¢å¾çæ ç­¾å³ä½¿åç»è®¡å¾éå ï¼ä¸¤èä¹é½å¯æ­£å¸¸æ¾ç¤ºï¼
         *              å½ç»è®¡å¾æ¾ç¤ºå­é¡¹ææ¬æ¶ï¼å¦æç»è®¡å¾ä¸­çå­é¡¹ææ¬åæ ç­¾ä¸é¢å¾ä¸­çæ ç­¾ä¸éå ï¼åä¸¤èåæ­£å¸¸æ¾ç¤ºï¼å¦æéå ï¼åä¼è¿æ»¤æç»è®¡å¾çå­é¡¹ææ¬ï¼åªæ¾ç¤ºæ ç­¾ã
         */
        this.overlapAvoided = true;

        /**
         * @member {number} [ThemeGraph.prototype.roseAngle=0]
         * @description ç»è®¡å¾ä¸­ç«ç°å¾æä¸ç»´ç«ç°å¾ç¨äºç­åçè§åº¦ï¼é»è®¤ä¸º 0 åº¦ï¼ç²¾ç¡®å° 0.1 åº¦ãå¨è§åº¦ä¸º0æèå¤§äº 360 åº¦çæåµä¸åä½¿ç¨ 360 åº¦æ¥ç­åå¶ä½ç»è®¡å¾çå­æ®µæ°ã
         */
        this.roseAngle = 0;

        /**
         * @member {number} [ThemeGraph.prototype.startAngle=0]
         * @description é¥¼ç¶ç»è®¡å¾æå½¢çèµ·å§è§åº¦ãç²¾ç¡®å° 0.1 åº¦ï¼ä»¥æ°´å¹³æ¹åä¸ºæ­£åãåªæéæ©çç»è®¡å¾ç±»åä¸ºé¥¼ç¶å¾ï¼é¥¼å¾ãä¸ç»´é¥¼å¾ãç«ç°å¾ãä¸ç»´ç«ç°å¾ï¼æ¶ï¼æ­¤é¡¹æå¯è®¾ç½®ã
         */
        this.startAngle = 0;

        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = "SuperMap.ThemeGraph";
    }


    /**
     * @function ThemeGraph.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
        var me = this;
        me.barWidth = null;
        me.graduatedMode = null;
        if (me.graphAxes) {
            me.graphAxes.destroy();
            me.graphAxes = null;
        }
        if (me.graphSize) {
            me.graphSize.destroy();
            me.graphSize = null;
        }
        me.graphSizeFixed = null;
        if (me.graphText) {
            me.graphText.destroy();
            me.graphText = null;
        }
        me.graphType = null;
        if (me.items) {
            for (var i = 0, items = me.items, len = items.length; i < len; i++) {
                items[i].destroy();
            }
            me.items = null;
        }
        me.memoryKeys = null;
        me.negativeDisplayed = null;
        if (me.offset) {
            me.offset.destroy();
            me.offset = null;
        }
        me.overlapAvoided = null;
        me.roseAngle = null;
        me.startAngle = null;
        me.graphAxesTextDisplayMode = null;
    }

    /**
     * @function ThemeGraph.prototype.toJSON
     * @description å° ThemeGraph å¯¹è±¡è½¬åä¸º JSON å­ç¬¦ä¸²ã
     * @returns {string} è¿åè½¬æ¢åç JSON å­ç¬¦ä¸²ã
     */
    toJSON() {
        return Util.toJSON(this.toServerJSONObject());
    }

    /**
     * @function ThemeGraph.prototype.toServerJSONObject
     * @description è½¬æ¢æå¯¹åºç JSON æ ¼å¼å¯¹è±¡ã
     * @returns {Object} å¯¹åºç JSON æ ¼å¼å¯¹è±¡ã
     */
    toServerJSONObject() {
        var obj = {};
        obj.type = this.type;
        if (this.graphText) {
            obj.graphTextDisplayed = this.graphText.graphTextDisplayed;
            obj.graphTextFormat = this.graphText.graphTextFormat;
            obj.graphTextStyle = this.graphText.graphTextStyle;
        }
        if (this.graphAxes) {
            obj.axesColor = this.graphAxes.axesColor;
            obj.axesDisplayed = this.graphAxes.axesDisplayed;
            obj.axesGridDisplayed = this.graphAxes.axesGridDisplayed;
            obj.axesTextDisplayed = this.graphAxes.axesTextDisplayed;
            obj.axesTextStyle = this.graphAxes.axesTextStyle;
        }
        if (this.graphSize) {
            obj.maxGraphSize = this.graphSize.maxGraphSize;
            obj.minGraphSize = this.graphSize.minGraphSize;
        }
        if (this.offset) {
            obj.offsetFixed = this.offset.offsetFixed;
            obj.offsetX = this.offset.offsetX;
            obj.offsetY = this.offset.offsetY;
        }
        obj.barWidth = this.barWidth;
        obj.graduatedMode = this.graduatedMode;
        obj.graphSizeFixed = this.graphSizeFixed;
        obj.graphType = this.graphType;
        obj.graphAxesTextDisplayMode = this.graphAxesTextDisplayMode;
        obj.items = this.items;
        obj.memoryKeys = this.memoryKeys;
        obj.negativeDisplayed = this.negativeDisplayed;
        obj.overlapAvoided = this.overlapAvoided;
        obj.roseAngle = this.roseAngle;
        obj.startAngle = this.startAngle;
        return obj;
    }

    /**
     * @function ThemeGraph.fromObj
     * @description ä»ä¼ å¥å¯¹è±¡è·åç»è®¡ä¸é¢å¾ç±»ã
     * @param {Object} obj - ä¼ å¥å¯¹è±¡ã
     * @returns {ThemeGraph} ThemeGraph å¯¹è±¡ã
     */
    static fromObj(obj) {
        var res = new ThemeGraph();
        var itemsG = obj.items;
        var len = itemsG ? itemsG.length : 0;
        Util.copy(res, obj);
        res.items = [];
        res.graphAxes = ThemeGraphAxes.fromObj(obj);
        res.graphSize = ThemeGraphSize.fromObj(obj);
        res.graphText = ThemeGraphText.fromObj(obj);
        res.offset = ThemeOffset.fromObj(obj);
        for (var i = 0; i < len; i++) {
            res.items.push(ThemeGraphItem.fromObj(itemsG[i]));
        }
        return res;
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/ThemeDotDensity.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class ThemeDotDensity
 * @deprecatedclass SuperMap.ThemeDotDensity
 * @category  iServer Map Theme
 * @classdesc ç¹å¯åº¦ä¸é¢å¾ãç¹å¯åº¦ä¸é¢å¾ç¨ä¸å®å¤§å°ãå½¢ç¶ç¸åçç¹è¡¨ç¤ºç°è±¡åå¸èå´ãæ°éç¹å¾ååå¸å¯åº¦ãç¹çå¤å°åæä»£è¡¨çæä¹ç±å°å¾çåå®¹ç¡®å®ã
 *              ç¹å¯åº¦ä¸é¢å¾å©ç¨å¾å±çæä¸æ°å¼å±æ§ä¿¡æ¯ï¼ä¸é¢å¼ï¼æ å°ä¸ºä¸åç­çº§ï¼æ¯ä¸çº§å«ä½¿ç¨ä¸åæ°éæè¡¨ç°ä¸ºå¯åº¦çç¹ç¬¦å·æ¥è¡¨ç¤ºã
 *              è¯¥ä¸é¢å¼å¨åä¸ªååºåçåå¸æåµï¼ä½ç°ä¸ååºåçç¸å¯¹æ°éå·®å¼ãå¤ç¨äºå·ææ°éç¹å¾çå°å¾ä¸ï¼
 *              æ¯å¦è¡¨ç¤ºä¸åå°åºçç²®é£äº§éãGDPãäººå£ç­çåçº§ï¼ä¸»è¦éå¯¹åºåæé¢ç¶çè¦ç´ ï¼å èï¼ç¹å¯åº¦ä¸é¢å¾éç¨äºé¢æ°æ®éã
 *              æ³¨æï¼ç¹å¯åº¦ä¸é¢å¾ä¸­ç¹çåå¸æ¯éæºçï¼å¹¶ä¸ä»£è¡¨å®éçåå¸ä½ç½®ãå³ä½¿å¨ç¸å³è®¾ç½®å®å¨ç¸åçæåµä¸ï¼
 *              æ¯æ¬¡å¶ä½åºçä¸é¢å¾ï¼ç¹çæ°éç¸åï¼ä½ç¹çä½ç½®é½æå·®å¼ã
 * @extends {CommonTheme}
 * @param {Object} options - åæ°ã
 * @param {string} options.dotExpression - åå»ºç¹å¯åº¦ä¸é¢å¾çå­æ®µæå­æ®µè¡¨è¾¾å¼ã
 * @param {ServerStyle} [options.style] - ç¹å¯åº¦ä¸é¢å¾ä¸­ç¹çé£æ ¼ã
 * @param {number} [options.value] - ä¸é¢å¾ä¸­æ¯ä¸ä¸ªç¹æä»£è¡¨çæ°å¼ã
 * @param {ThemeMemoryData} [options.memoryData] - ä¸é¢å¾åå­æ°æ®ã
 * @usage
 */
class ThemeDotDensity extends Theme {

    constructor(options) {
        super("DOTDENSITY", options);
        /**
         * @member {string} ThemeDotDensity.prototype.dotExpression
         * @description åå»ºç¹å¯åº¦ä¸é¢å¾çå­æ®µæå­æ®µè¡¨è¾¾å¼ãç¹çæ°ç®æå¯éç¨åº¦çæ¥æºã
         */
        this.dotExpression = null;

        /**
         * @member {ServerStyle} ThemeDotDensity.prototype.style
         * @description ç¹å¯åº¦ä¸é¢å¾ä¸­ç¹çé£æ ¼ã
         */
        this.style =  new ServerStyle();

        /**
         * @member {number} ThemeDotDensity.prototype.value
         * @description ä¸é¢å¾ä¸­æ¯ä¸ä¸ªç¹æä»£è¡¨çæ°å¼ã<br>
         *              ç¹å¼çç¡®å®ä¸å°å¾æ¯ä¾å°ºä»¥åç¹çå¤§å°æå³ãå°å¾æ¯ä¾å°ºè¶å¤§ï¼ç¸åºçå¾é¢èå´ä¹è¶å¤§ï¼
         *              ç¹ç¸åºå°±å¯ä»¥è¶å¤ï¼æ­¤æ¶ç¹å¼å°±å¯ä»¥è®¾ç½®ç¸å¯¹å°ä¸äºãç¹å½¢ç¶è¶å¤§ï¼
         *              ç¹å¼ç¸åºå°±åºè¯¥è®¾ç½®çå°ä¸äºãç¹å¼è¿å¤§æè¿å°é½æ¯ä¸åéçã
         */
        this.value = null;

        if (options) {
            Util.extend(this, options);
        }
        this.CLASS_NAME = "SuperMap.ThemeDotDensity";
    }

    /**
     * @function ThemeDotDensity.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.dotExpression = null;
        me.value = null;

        if (me.style) {
            me.style.destroy();
            me.style = null;
        }
    }


    /**
     * @function ThemeDotDensity.prototype.toServerJSONObject
     * @description è½¬æ¢æå¯¹åºç JSON æ ¼å¼å¯¹è±¡ã
     * @returns {Object} å¯¹åºç JSON æ ¼å¼å¯¹è±¡ã
     */
    toServerJSONObject() {
        var obj = {};
        obj = Util.copyAttributes(obj, this);
        if (obj.style) {
            if (obj.style.toServerJSONObject) {
                obj.style = obj.style.toServerJSONObject();
            }
        }
        return obj;
    }

    /**
     * @function ThemeDotDensity.fromObj
     * @description ä»ä¼ å¥å¯¹è±¡è·åç¹å¯åº¦ä¸é¢å¾ä¸­ç¹çé£æ ¼ã
     * @param {Object} obj - ä¼ å¥å¯¹è±¡ã
     * @returns {ThemeDotDensity} ThemeDotDensity å¯¹è±¡ã
     */
    static fromObj(obj) {
        if (!obj) {
            return;
        }
        var res = new ThemeDotDensity();
        Util.copy(res, obj);
        res.style = ServerStyle.fromJson(obj.style);
        return res;
    }


}



;// CONCATENATED MODULE: ./src/common/iServer/ThemeGraduatedSymbolStyle.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class ThemeGraduatedSymbolStyle
 * @deprecatedclass SuperMap.ThemeGraduatedSymbolStyle
 * @category  iServer Map Theme
 * @classdesc ç­çº§ç¬¦å·ä¸é¢å¾æ­£è´é¶å¼æ¾ç¤ºé£æ ¼ç±»ã
 * @param {Object} options - åæ°ã
 * @param {boolean} [options.negativeDisplayed=false] - æ¯å¦æ¾ç¤ºè´å¼ã
 * @param {ServerStyle} [options.negativeStyle] - è´å¼çç­çº§ç¬¦å·é£æ ¼ã
 * @param {ServerStyle} [options.positiveStyle] - æ­£å¼çç­çº§ç¬¦å·é£æ ¼ã
 * @param {boolean} [options.zeroDisplayed=false] - æ¯å¦æ¾ç¤º 0 å¼ã
 * @param {ServerStyle} [options.zeroStyle] - 0 å¼çç­çº§ç¬¦å·é£æ ¼ã
 * @usage
 */
class ThemeGraduatedSymbolStyle {

    constructor(options) {
        /**
         * @member {boolean} [ThemeGraduatedSymbolStyle.prototype.negativeDisplayed=false]
         * @description æ¯å¦æ¾ç¤ºè´å¼ã
         */
        this.negativeDisplayed = false;

        /**
         * @member {ServerStyle} [ThemeGraduatedSymbolStyle.prototype.negativeStyle]
         * @description è´å¼çç­çº§ç¬¦å·é£æ ¼ã
         */
        this.negativeStyle = new ServerStyle();

        /**
         * @member {ServerStyle} [ThemeGraduatedSymbolStyle.prototype.positiveStyle]
         * @description æ­£å¼çç­çº§ç¬¦å·é£æ ¼ã
         */
        this.positiveStyle = new ServerStyle();

        /**
         * @member {boolean} [ThemeGraduatedSymbolStyle.prototype.zeroDisplayed=false]
         * @description æ¯å¦æ¾ç¤º 0 å¼ã
         */
        this.zeroDisplayed = false;

        /**
         * @member {ServerStyle} ThemeGraduatedSymbolStyle.prototype.zeroStyle
         * @description 0 å¼çç­çº§ç¬¦å·é£æ ¼ã
         */
        this.zeroStyle = new ServerStyle();

        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = "SuperMap.ThemeGraduatedSymbolStyle";
    }

    /**
     * @function ThemeGraduatedSymbolStyle.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.negativeDisplayed = null;
        me.negativeStyle = null;
        me.positiveStyle = null;
        me.zeroDisplayed = null;
        me.zeroStyle = null;
    }

    /**
     * @function ThemeGraduatedSymbolStyle.fromObj
     * @description ä»ä¼ å¥å¯¹è±¡è·åç­çº§ç¬¦å·ä¸é¢å¾æ­£è´é¶å¼æ¾ç¤ºé£æ ¼ç±»ã
     * @param {Object} obj - ä¼ å¥å¯¹è±¡ã
     * @returns {ThemeGraduatedSymbolStyle} ThemeGraduatedSymbolStyle å¯¹è±¡ã
     */
    static fromObj(obj) {
        if (!obj) {
            return;
        }
        var res = new ThemeGraduatedSymbolStyle();
        Util.copy(res, obj);
        res.negativeStyle = ServerStyle.fromJson(obj.negativeStyle);
        res.positiveStyle = ServerStyle.fromJson(obj.positiveStyle);
        res.zeroStyle = ServerStyle.fromJson(obj.zeroStyle);
        return res;
    }

}




;// CONCATENATED MODULE: ./src/common/iServer/ThemeGraduatedSymbol.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/






/**
 * @class ThemeGraduatedSymbol
 * @deprecatedclass SuperMap.ThemeGraduatedSymbol
 * @category  iServer Map Theme
 * @classdesc ç­çº§ç¬¦å·ä¸é¢å¾ã
 * @extends {CommonTheme}
 * @param {Object} options - åæ°ã
 * @param {ThemeGraduatedSymbolStyle} options.style - ç­çº§ç¬¦å·ä¸é¢å¾æ­£è´é¶å¼æ¾ç¤ºé£æ ¼ç±»ã
 * @param {string} options.expression - ç­çº§ç¬¦å·ä¸é¢å¾çå­æ®µæå­æ®µè¡¨è¾¾å¼ã
 * @param {number} [options.baseValue=0] - ç­çº§ç¬¦å·ä¸é¢å¾çåºåå¼ï¼åä½åä¸é¢åéçåä½ã
 * @param {GraduatedMode} [options.graduatedMode=GraduatedMode.CONSTANT] - ç­çº§ç¬¦å·ä¸é¢å¾åçº§æ¨¡å¼ã
 * @param {ThemeOffset} [options.offset] - æå®æ ç­¾ä¸é¢å¾ä¸­æ è®°ææ¬ç¸å¯¹äºè¦ç´ åç¹çåç§»éå¯¹è±¡ã
 * @param {ThemeMemoryData} [options.memoryData] - ä¸é¢å¾åå­æ°æ®ã
 * @usage
 */
class ThemeGraduatedSymbol extends Theme {

    constructor(options) {
        super("GRADUATEDSYMBOL", options);
        /**
         * @member {number} [ThemeGraduatedSymbol.prototype.baseValue=0]
         * @description ç­çº§ç¬¦å·ä¸é¢å¾çåºåå¼ï¼åä½åä¸é¢åéçåä½ã<br>
         *              ä¾æ®æ­¤å¼ç³»ç»ä¼èªå¨æ ¹æ®åçº§æ¹å¼è®¡ç®å¶ä½å¼å¯¹åºçç¬¦å·å¤§å°ï¼æ¯ä¸ªç¬¦å·çæ¾ç¤ºå¤§å°ç­äº
         *              ThemeValueSection.positiveStyleï¼æ zeroStyleï¼negativeStyleï¼.markerSize * value / basevalueï¼
         *              å¶ä¸­ value æ¯ expression ææå®å­æ®µå¯¹åºçå¼ç»è¿åçº§è®¡ç®ä¹åçå¼ãé»è®¤å¼ä¸º0ï¼å»ºè®®éè¿å¤æ¬¡å°è¯è®¾ç½®è¯¥å¼æè½è¾¾å°è¾å¥½çæ¾ç¤ºææã
         */
        this.baseValue = 0;

        /**
         * @member {string} ThemeGraduatedSymbol.prototype.expression
         * @description ç¨äºåå»ºç­çº§ç¬¦å·ä¸é¢å¾çå­æ®µæå­æ®µè¡¨è¾¾å¼ï¼å­æ®µæå­æ®µè¡¨è¾¾å¼åºä¸ºæ°å¼åã
         */
        this.expression = null;

        /**
         * @member {GraduatedMode} [ThemeGraduatedSymbol.prototype.graduatedMode=GraduatedMode.CONSTANT]
         * @description ç­çº§ç¬¦å·ä¸é¢å¾åçº§æ¨¡å¼ã<br>
         *              åçº§ä¸»è¦æ¯ä¸ºäºåå°å¶ä½ç­çº§ç¬¦å·ä¸é¢å¾ä¸­æ°æ®å¤§å°ä¹é´çå·®å¼ãå¦ææ°æ®ä¹é´å·®è·è¾å¤§ï¼åå¯ä»¥éç¨å¯¹æ°æèå¹³æ¹æ ¹çåçº§æ¹å¼æ¥è¿è¡ï¼
         *              è¿æ ·å°±åå°äºæ°æ®ä¹é´çç»å¯¹å¤§å°çå·®å¼ï¼ä½¿å¾ç­çº§ç¬¦å·å¾çè§è§æææ¯è¾å¥½ï¼åæ¶ä¸åç±»å«ä¹é´çæ¯è¾ä¹æ¯ææä¹çã
         *              æä¸ç§åçº§æ¨¡å¼ï¼å¸¸æ°ãå¯¹æ°åå¹³æ¹æ ¹ï¼å¯¹äºæå¼ä¸ºè´æ°çå­æ®µï¼å¨ç¨å¯¹æ°æå¹³æ¹æ ¹æ¹å¼åçº§æ¶ï¼é»è®¤å¯¹è´æ°åæ­£ã
         *              ä¸åçåçº§æ¨¡å¼ç¨äºç¡®å®ç¬¦å·å¤§å°çæ°å¼æ¯ä¸ç¸åçï¼å¸¸æ°æç§å­æ®µçåå§æ°æ®è¿è¡ï¼å¯¹æ°åæ¯å¯¹æ¯æ¡è®°å½å¯¹åºçä¸é¢åéåèªç¶å¯¹æ°ï¼
         *              å¹³æ¹æ ¹åæ¯å¯¹å¶åå¹³æ¹æ ¹ï¼ç¶åç¨æç»å¾å°çç»ææ¥ç¡®å®å¶ç­çº§ç¬¦å·çå¤§å°ã
         */
        this.graduatedMode = GraduatedMode.CONSTAN;

        /**
         * @member {ThemeOffset} [ThemeGraduatedSymbol.prototype.offset]
         * @description ç¨äºè®¾ç½®ç­çº§ç¬¦å·å¾ç¸å¯¹äºè¦ç´ åç¹çåç§»éã
         */
        this.offset =  new ThemeOffset();

        /**
         * @member {ThemeGraduatedSymbolStyle} ThemeGraduatedSymbol.prototype.style
         * @description ç¨äºè®¾ç½®ç­çº§ç¬¦å·å¾æ­£è´åé¶å¼æ¾ç¤ºé£æ ¼ã
         */
        this.style =  new ThemeGraduatedSymbolStyle();

        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = "SuperMap.ThemeGraduatedSymbol";
    }

    /**
     * @function ThemeGraduatedSymbol.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        super.destroy();
        var me = this;
        me.expression = null;
        me.graduatedMode = GraduatedMode.CONSTANT;
        if (me.offset) {
            me.offset.destroy();
            me.offset = null;
        }
        if (me.style) {
            me.style.destroy();
            me.style = null;
        }
    }


    /**
     * @function ThemeGraduatedSymbol.prototype.toJSON
     * @description å° themeLabel å¯¹è±¡è½¬åä¸º JSON å­ç¬¦ä¸²ã
     * @returns {string} è¿åè½¬æ¢åç JSON å­ç¬¦ä¸²ã
     */
    toJSON() {
        return Util.toJSON(this.toServerJSONObject());
    }


    /**
     * @function ThemeGraduatedSymbol.prototype.toServerJSONObject
     * @description è½¬æ¢æå¯¹åºç JSON æ ¼å¼å¯¹è±¡ã
     * @returns {Object} å¯¹åºç JSON æ ¼å¼å¯¹è±¡ã
     */
    toServerJSONObject() {
        var obj = {};
        obj.type = this.type;
        obj.memoryData = this.memoryData;
        obj.baseValue = this.baseValue;
        obj.expression = this.expression;
        obj.graduatedMode = this.graduatedMode;
        if (this.offset) {
            obj.offsetFixed = this.offset.offsetFixed;
            obj.offsetX = this.offset.offsetX;
            obj.offsetY = this.offset.offsetY;
        }
        if (this.style) {
            obj.negativeStyle = this.style.negativeStyle;
            obj.negativeDisplayed = this.style.negativeDisplayed;
            obj.positiveStyle = this.style.positiveStyle;
            obj.zeroDisplayed = this.style.zeroDisplayed;
            obj.zeroStyle = this.style.zeroStyle;
        }
        return obj;
    }

    /**
     * @function ThemeGraduatedSymbol.fromObj
     * @description ä»ä¼ å¥å¯¹è±¡è·åç­çº§ç¬¦å·ä¸é¢å¾ã
     * @param {Object} obj - ä¼ å¥å¯¹è±¡ã
     * @returns {ThemeGraduatedSymbol} ç­çº§ç¬¦å·ä¸é¢å¾å¯¹è±¡ã
     */
    static fromObj(obj) {
        if (!obj) {
            return;
        }
        var res = new ThemeGraduatedSymbol();
        Util.copy(res, obj);
        res.offset = ThemeOffset.fromObj(obj);
        res.style = ThemeGraduatedSymbolStyle.fromObj(obj);
        return res;
    }

}


;// CONCATENATED MODULE: ./src/common/iServer/ThemeRangeItem.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class ThemeRangeItem
 * @deprecatedclass SuperMap.ThemeRangeItem
 * @category  iServer Map Theme
 * @classdesc èå´åæ®µä¸é¢å¾å­é¡¹ç±»ãå¨åæ®µä¸é¢å¾ä¸­ï¼å­æ®µå¼æç§æç§åæ®µæ¨¡å¼è¢«åæå¤ä¸ªèå´æ®µï¼
 * æ¯ä¸ªèå´æ®µå³ä¸ºä¸ä¸ªå­é¡¹ï¼åä¸èå´æ®µçè¦ç´ å±äºåä¸ä¸ªåæ®µä¸é¢å¾å­é¡¹ã
 * æ¯ä¸ªå­é¡¹é½æå¶åæ®µèµ·å§å¼ãç»æ­¢å¼ãåç§°åé£æ ¼ç­ãæ¯ä¸ªåæ®µæè¡¨ç¤ºçèå´ä¸º[start, end)ã
 * @param {Object} options - åæ°ã
 * @param {string} [options.caption] - å­é¡¹çæ é¢ã
 * @param {number} [options.end=0] - å­é¡¹çç»æ­¢å¼ã
 * @param {number} [options.start=0] - å­é¡¹çèµ·å§å¼ã
 * @param {ServerStyle} options.style - å­é¡¹çé£æ ¼ã
 * @param {boolean} [options.visible=true] - å­é¡¹æ¯å¦å¯è§ã
 * @usage
 */
class ThemeRangeItem {

    constructor(options) {
        /**
         * @member {string} [ThemeRangeItem.prototype.caption]
         * @description åæ®µä¸é¢å¾å­é¡¹çæ é¢ã
         */
        this.caption = null;

        /**
         * @member {number} [ThemeRangeItem.prototype.end=0]
         * @description åæ®µä¸é¢å¾å­é¡¹çç»æ­¢å¼ï¼å³è¯¥æ®µä¸é¢å¼èå´çæå¤§å¼ã<br>
         *              å¦æè¯¥å­é¡¹æ¯åæ®µä¸­æåä¸ä¸ªå­é¡¹ï¼åè¯¥ç»æ­¢å¼åºå¤§äºåæ®µå­æ®µï¼ThemeRange ç±»ç rangeExpression å±æ§ï¼çæå¤§å¼ï¼è¥è¯¥ç»æ­¢å¼å°äºåæ®µå­æ®µæå¤§å¼ï¼
         *              åå©ä½é¨åç±åé¨éæºå®ä¹å¶é¢è²ï¼å¦æä¸æ¯æåä¸é¡¹ï¼è¯¥ç»æ­¢å¼å¿é¡»ä¸å¶ä¸ä¸å­é¡¹çèµ·å§å¼ç¸åï¼å¦åç³»ç»æåºå¼å¸¸ï¼
         *              å¦æè®¾ç½®äºèå´åæ®µæ¨¡å¼ååæ®µæ°ï¼åä¼èªå¨è®¡ç®æ¯æ®µçèå´ [start, end)ï¼ææ éè®¾ç½® [start, end)ï¼å½ç¶å¯ä»¥è®¾ç½®ï¼é£ä¹ç»æå°±ä¼ææ¨è®¾ç½®çå¼å¯¹åæ®µç»æè¿è¡è°æ´ã
         */
        this.end = 0;

        /**
         * @member {number} [ThemeRangeItem.prototype.start=0]
         * @description åæ®µä¸é¢å¾å­é¡¹çèµ·å§å¼ï¼å³è¯¥æ®µä¸é¢å¼èå´çæå°å¼ã<br>
         *              å¦æè¯¥å­é¡¹æ¯åæ®µä¸­ç¬¬ä¸ä¸ªå­é¡¹ï¼é£ä¹è¯¥èµ·å§å¼å°±æ¯åæ®µçæå°å¼ï¼å¦æå­é¡¹çåºå·å¤§äºç­äº 1 çæ¶åï¼è¯¥èµ·å§å¼å¿é¡»ä¸åä¸å­é¡¹çç»æ­¢å¼ç¸åï¼å¦åç³»ç»ä¼æåºå¼å¸¸ã
         *              å¦æè®¾ç½®äºèå´åæ®µæ¨¡å¼ååæ®µæ°ï¼åä¼èªå¨è®¡ç®æ¯æ®µçèå´ [start, end)ï¼ææ éè®¾ç½® [start, end)ï¼å½ç¶å¯ä»¥è®¾ç½®ï¼é£ä¹ç»æå°±ä¼ææ¨è®¾ç½®çå¼å¯¹åæ®µç»æè¿è¡è°æ´ã
         */
        this.start = 0;

        /**
         * @member {ServerStyle} ThemeRangeItem.prototype.style
         * @description åæ®µä¸é¢å¾å­é¡¹çé£æ ¼ã
         *              æ¯ä¸ä¸ªåæ®µä¸é¢å¾å­é¡¹é½å¯¹åºä¸ç§æ¾ç¤ºé£æ ¼ã
         */
        this.style = new ServerStyle();

        /**
         * @member {boolean} [ThemeRangeItem.prototype.visible=true]
         * @description åæ®µä¸é¢å¾å­é¡¹æ¯å¦å¯è§ã
         */
        this.visible = true;

        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = "SuperMap.ThemeRangeItem";
    }

    /**
     * @function ThemeRangeItem.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.caption = null;
        me.end = null;
        me.start = null;

        if (me.style) {
            me.style.destroy();
            me.style = null;
        }
        me.visible = null;
    }

    /**
     * @function ThemeRangeItem.prototypetoServerJSONObject
     * @description è½¬æ¢æå¯¹åºç JSON æ ¼å¼å¯¹è±¡ã
     * @returns {Object} å¯¹åºç JSON æ ¼å¼å¯¹è±¡ã
     */
    toServerJSONObject() {
        var obj = {};
        obj = Util.copyAttributes(obj, this);
        if (obj.style) {
            if (obj.style.toServerJSONObject) {
                obj.style = obj.style.toServerJSONObject();
            }
        }
        return obj;
    }

    /**
     * @function ThemeRangeItem.fromObj
     * @description ä»ä¼ å¥å¯¹è±¡è·åèå´åæ®µä¸é¢å¾å­é¡¹ç±»ã
     * @param {Object} obj - ä¼ å¥å¯¹è±¡ã
     * @returns {ThemeRangeItem} ThemeRangeItem å¯¹è±¡ã
     */
    static fromObj(obj) {
        if (!obj) {
            return;
        }
        var res = new ThemeRangeItem();
        Util.copy(res, obj);
        res.style = ServerStyle.fromJson(obj.style);
        return res;
    }
}


;// CONCATENATED MODULE: ./src/common/iServer/ThemeRange.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class ThemeRange
 * @deprecatedclass SuperMap.ThemeRange
 * @category  iServer Map Theme
 * @classdesc èå´åæ®µä¸é¢å¾ã
 * èå´åæ®µä¸é¢å¾æ¯æç§æå®çåæ®µæ¹æ³ï¼å¦ï¼ç­è·ç¦»åæ®µæ³ï¼å¯¹å­æ®µçå±æ§å¼è¿è¡åæ®µï¼ä½¿ç¨ä¸åçé¢è²æç¬¦å·ï¼çº¿åãå¡«åï¼è¡¨ç¤ºä¸åèå´æ®µè½çå±æ§å¼å¨æ´ä½ä¸çåå¸æåµï¼ä½ç°åºåçå·®å¼ã
 * å¨åæ®µä¸é¢å¾ä¸­ï¼ä¸é¢å¼æç§æç§åæ®µæ¹å¼è¢«åæå¤ä¸ªèå´æ®µï¼è¦ç´ æ ¹æ®åèªçä¸é¢å¼è¢«åéå°å¶ä¸­ä¸ä¸ªèå´æ®µä¸­ï¼å¨åä¸ä¸ªèå´æ®µä¸­çè¦ç´ ä½¿ç¨ç¸åçé¢è²ï¼å¡«åï¼ç¬¦å·ç­é£æ ¼è¿è¡æ¾ç¤ºã
 * åæ®µä¸é¢å¾æåºäºçä¸é¢åéå¿é¡»ä¸ºæ°å¼åï¼åæ®µä¸é¢å¾ä¸è¬ç¨æ¥åæ è¿ç»­åå¸ç°è±¡çæ°éæç¨åº¦ç¹å¾ï¼å¦éæ°´éçåå¸ï¼åå£¤ä¾µèå¼ºåº¦çåå¸ç­ã
 * @extends {CommonTheme}
 * @param {Object} options - åæ°ã
 * @param {Array.<ThemeRangeItem>} options.items - å­é¡¹æ°ç»ã
 * @param {string} options.rangeExpression - åæ®µå­æ®µè¡¨è¾¾å¼ã
 * @param {number} options.rangeParameter - åæ®µåæ°ã
 * @param {number} options.rangeParameter - åæ®µåæ°ã
 * @param {RangeMode} [options.rangeMode=RangeMode.EQUALINTERVAL] - åæ®µæ¨¡å¼ã
 * @param {ColorGradientType} [options.colorGradientType=ColorGradientType.YELLOW_RED] - æ¸åé¢è²æä¸¾ç±»ã
 * @param {ThemeMemoryData} [options.memoryData] - ä¸é¢å¾åå­æ°æ®ã
 * @usage
 */
class ThemeRange extends Theme {

    constructor(options) {
        super("RANGE", options);
        /**
         * @member {string} ThemeRange.prototype.precision
         * @description ç²¾ååº¦
         */
        this.precision = '1.0E-12';

        /**
         * @member {Array.<ThemeRangeItem>} ThemeRange.prototype.items
         * @description åæ®µä¸é¢å¾å­é¡¹æ°ç»ã<br>
         *              å¨åæ®µä¸é¢å¾ä¸­ï¼å­æ®µå¼æç§æç§åæ®µæ¨¡å¼è¢«åæå¤ä¸ªèå´æ®µï¼æ¯ä¸ªèå´æ®µå³ä¸ºä¸ä¸ªå­é¡¹ï¼åä¸èå´æ®µçè¦ç´ å±äºåä¸ä¸ªåæ®µä¸é¢å¾å­é¡¹ã
         *              æ¯ä¸ªå­é¡¹é½æå¶åæ®µèµ·å§å¼ãç»æ­¢å¼ãåç§°åé£æ ¼ç­ãæ¯ä¸ªåæ®µæè¡¨ç¤ºçèå´ä¸º [start, end)ã
         *              å¦æè®¾ç½®äºèå´åæ®µæ¨¡å¼ååæ®µæ°ï¼åä¼èªå¨è®¡ç®æ¯æ®µçèå´ [start, end)ï¼ææ éè®¾ç½® [start, end)ï¼å½ç¶å¯ä»¥è®¾ç½®ï¼é£ä¹ç»æå°±ä¼æç§æ¨è®¾ç½®çå¼å¯¹åæ®µç»æè¿è¡è°æ´ã
         */
        this.items = null;

        /**
         * @member {string} ThemeRange.prototype.rangeExpression
         * @description åæ®µå­æ®µè¡¨è¾¾å¼ã<br>
         *              ç±äºèå´åæ®µä¸é¢å¾åºäºåç§åæ®µæ¹æ³æ ¹æ®ä¸å®çè·ç¦»è¿è¡åæ®µï¼å èèå´åæ®µä¸é¢å¾æåºäºçå­æ®µå¼çæ°æ®ç±»åå¿é¡»ä¸ºæ°å¼åãå¯¹äºå­æ®µè¡¨è¾¾å¼ï¼åªè½ä¸ºæ°å¼åçå­æ®µé´çè¿ç®ã
         */
        this.rangeExpression = null;

        /**
         * @member {RangeMode} [ThemeRange.prototype.rangeMode=RangeMode.EQUALINTERVAL]
         * @description åæ®µä¸é¢å¾çåæ®µæ¨¡å¼ã<br>
         *              å¨åæ®µä¸é¢å¾ä¸­ï¼ä½ä¸ºä¸é¢åéçå­æ®µæè¡¨è¾¾å¼çå¼æç§æç§åæ®µæ¹å¼è¢«åæå¤ä¸ªèå´æ®µã
         *              ç®å SuperMap æä¾çåæ®µæ¹å¼åæ¬ï¼ç­è·ç¦»åæ®µæ³ãå¹³æ¹æ ¹åæ®µæ³ãæ åå·®åæ®µæ³ãå¯¹æ°åæ®µæ³ãç­è®¡æ°åæ®µæ³åèªå®ä¹è·ç¦»æ³ï¼
         *              æ¾ç¶è¿äºåæ®µæ¹æ³æ ¹æ®ä¸å®çè·ç¦»è¿è¡åæ®µï¼å èèå´åæ®µä¸é¢å¾æåºäºçä¸é¢åéå¿é¡»ä¸ºæ°å¼åã
         */
        this.rangeMode = RangeMode.EQUALINTERVAL;

        /**
         * @member {number} ThemeRange.prototype.rangeParameter
         * @description åæ®µåæ°ã
         *              å½åæ®µæ¨¡å¼ä¸ºç­è·ç¦»åæ®µæ³ï¼å¹³æ¹æ ¹åæ®µï¼å¯¹æ°åæ®µæ³ï¼è®¡æ°åæ®µæ³å¶ä¸­ä¸ç§æ¨¡å¼æ¶ï¼è¯¥åæ°ç¨äºè®¾ç½®åæ®µä¸ªæ°ï¼å½åæ®µæ¨¡å¼ä¸ºæ åå·®åæ®µæ³æ¶ï¼
         *              è¯¥åæ°ä¸èµ·ä½ç¨ï¼å½åæ®µæ¨¡å¼ä¸ºèªå®ä¹è·ç¦»æ¶ï¼è¯¥åæ°ç¨äºè®¾ç½®èªå®ä¹è·ç¦»ã
         */
        this.rangeParameter = 0;

        /**
         * @member {ColorGradientType} [ThemeRange.prototype.colorGradientType=ColorGradientType.YELLOW_RED]
         * @description æ¸åé¢è²æä¸¾ç±»ã<br>
         *              æ¸åè²æ¯ç±èµ·å§è²æ ¹æ®ä¸å®ç®æ³éæ¸è¿æ¸¡å°ç»æ­¢è²çä¸ç§æ··ååé¢è²ã
         *              è¯¥ç±»ä½ä¸ºåå¼ä¸é¢å¾åæ°ç±»ãåæ®µä¸é¢å¾åæ°ç±»çå±æ§ï¼è´è´£è®¾ç½®åå¼ä¸é¢å¾ãåæ®µä¸é¢å¾çéè²æ¹æ¡ï¼å¨é»è®¤æåµä¸ä¸é¢å¾ææå­é¡¹ä¼æ ¹æ®è¿ä¸ªéè²
         *              æ¹æ¡å®æå¡«*åãä½å¦æä¸ºæå ä¸ªå­é¡¹çé£æ ¼è¿è¡åç¬è®¾ç½®åï¼è®¾ç½®äº {@link ThemeUniqueItem} æ {@link ThemeRangeItem} ç±»ä¸­Styleå±æ§ï¼ï¼
         *              è¯¥éè²æ¹æ¡å¯¹äºè¿å ä¸ªå­é¡¹å°ä¸èµ·ä½ç¨ã
         */
        this.colorGradientType = ColorGradientType.YELLOW_RED;

        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = "SuperMap.ThemeRange";
    }


    /**
     * @function ThemeRange.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
        var me = this;
        if (me.items) {
            if (me.items.length > 0) {
                for (var item in me.items) {
                    me.items[item].destroy();
                    me.items[item] = null;
                }
            }
            me.items = null;
        }
        me.rangeExpression = null;
        me.rangeMode = null;
        me.rangeParameter = null;
        me.colorGradientType = null;
    }

    /**
     * @function ThemeRange.fromObj
     * @description ä»ä¼ å¥å¯¹è±¡è·åèå´åæ®µä¸é¢å¾ç±»ã
     * @param {Object} obj - ä¼ å¥å¯¹è±¡ã
     * @returns {ThemeRange} ThemeRange å¯¹è±¡ã
     */
    static fromObj(obj) {
        if (!obj) {
            return;
        }
        var res = new ThemeRange();
        Util.copy(res, obj);
        var itemsR = obj.items;
        var len = itemsR ? itemsR.length : 0;
        res.items = [];
        for (var i = 0; i < len; i++) {
            res.items.push(ThemeRangeItem.fromObj(itemsR[i]));
        }
        return res;
    }

}


;// CONCATENATED MODULE: ./src/common/iServer/UGCLayer.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class UGCLayer
 * @deprecatedclass SuperMap.UGCLayer
 * @category  iServer Map Layer
 * @classdesc SuperMap å¾å±ç±»ã
 * @param {Object} options - åæ°ã
 * @param {Bounds} options.bounds - å¾å±èå´ã
 * @param {string} options.name - å¾å±çåç§°ã
 * @param {UGCLayerType} options.type  - å¾å±ç±»å
 * @param {string} [options.caption] - å¾å±çæ é¢ã
 * @param {string} [options.description] - å¾å±çæè¿°ä¿¡æ¯ã
 * @param {boolean} [options.queryable] - å¾å±ä¸­çå¯¹è±¡æ¯å¦å¯ä»¥æ¥è¯¢ã
 * @param {boolean} [options.subUGCLayers] - æ¯å¦åè®¸å¾å±çç¬¦å·å¤§å°éå¾ç¼©æ¾ã
 * @param {boolean} [options.visible=false] - å°å¾å¯¹è±¡å¨åä¸èå´åæ¶ï¼æ¯å¦éå æ¾ç¤ºã
 * @usage
 */
class UGCLayer {

    constructor(options) {
        options =  options || {};
        /**
         * @member {Bounds} UGCLayer.prototype.bounds
         * @description å¾å±èå´ã
         */
        this.bounds = null;

        /**
         * @member {string} [UGCLayer.prototype.caption]
         * @description å¾å±çæ é¢ãé»è®¤æåµä¸å¾å±çæ é¢ä¸å¾å±çåç§°ä¸è´ãå¨å¾ä¾ãå¾å±æ§å¶åè¡¨ä¸­æ¾ç¤ºçå¾å±åç§°å°±æ¯è¯¥å¾å±çæ é¢å¼ã
         */
        this.caption = null;

        /**
         * @member {string} UGCLayer.prototype.description
         * @description å¾å±çæè¿°ä¿¡æ¯ã
         */
        this.description = null;

        /**
         * @member {string} UGCLayer.prototype.name
         * @description å¾å±çåç§°ãå¾å±çåç§°å¨å¾å±æå¨çå°å¾ä¸­å¯ä¸æ è¯æ­¤å¾å±ãè¯¥å±æ§åºåå¤§å°åã
         */
        this.name = null;

        /**
         * @member {boolean} UGCLayer.prototype.queryable
         * @description å¾å±ä¸­çå¯¹è±¡æ¯å¦å¯ä»¥æ¥è¯¢ã
         */
        this.queryable = null;

        /**
         * @member {Array} UGCLayer.prototype.subLayers
         * @description å­å¾å±éã
         */
        this.subLayers = null;

        /**
         * @member {UGCLayerType} UGCLayer.prototype.type
         * @description å¾å±ç±»åã
         */
        this.type = null;

        /**
         * @member {boolean} UGCLayer.prototype.visible
         * @description å°å¾å¯¹è±¡å¨åä¸èå´åæ¶ï¼æ¯å¦éå æ¾ç¤ºã
         */
        this.visible = null;

        Util.extend(this, options);

        this.CLASS_NAME = "SuperMap.UGCLayer";
    }

    /**
     * @function UGCLayer.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        Util.reset(me);
    }

    /**
     * @function UGCLayer.prototype.fromJson
     * @description å°æå¡ç«¯ JSON å¯¹è±¡è½¬æ¢æå½åå®¢æ·ç«¯å¯¹è±¡ã
     * @param {Object} jsonObject - è¦è½¬æ¢ç JSON å¯¹è±¡ã
     */
    fromJson(jsonObject) {
        jsonObject = jsonObject ? jsonObject : {};
        Util.extend(this, jsonObject);
        var b = this.bounds;
        if (b) {
            this.bounds = new Bounds(b.leftBottom.x, b.leftBottom.y, b.rightTop.x, b.rightTop.y);
        }
    }


    /**
     * @function UGCLayer.prototype.toServerJSONObject
     * @description è½¬æ¢æå¯¹åºç JSON æ ¼å¼å¯¹è±¡ã
     * @returns {Object} å¯¹åºç JSON æ ¼å¼å¯¹è±¡ã
     */
    toServerJSONObject() {
        var jsonObject = {};
        jsonObject = Util.copyAttributes(jsonObject, this);
        if (jsonObject.bounds) {
            if (jsonObject.bounds.toServerJSONObject) {
                jsonObject.bounds = jsonObject.bounds.toServerJSONObject();
            }
        }
        return jsonObject;
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/UGCMapLayer.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class UGCMapLayer
 * @deprecatedclass SuperMap.UGCMapLayer
 * @category  iServer Map Layer
 * @classdesc SuperMap å°å¾å¾å±ç±»ã
 * @extends {UGCLayer}
 * @param {Object} options - å¯éåæ°ã
 * @param {boolean} [options.completeLineSymbolDisplayed] - æ¯å¦æ¾ç¤ºå®æ´çº¿åã
 * @param {number} [options.maxScale] - å°å¾æå¤§æ¯ä¾å°ºã
 * @param {number} [options.minScale] - å°å¾æå°æ¯ä¾å°ºã
 * @param {number} [options.minVisibleGeometrySize] - å ä½å¯¹è±¡çæå°å¯è§å¤§å°ï¼ä»¥åç´ ä¸ºåä½ã
 * @param {number} [options.opaqueRate] - å¾å±çä¸éæåº¦ã
 * @param {boolean} [options.symbolScalable] - æ¯å¦åè®¸å¾å±çç¬¦å·å¤§å°éå¾ç¼©æ¾ã
 * @param {number} [options.symbolScale] - å¾å±çç¬¦å·ç¼©æ¾åºåæ¯ä¾å°ºã
 * @param {boolean} [options.overlapDisplayed=false] - å°å¾å¯¹è±¡å¨åä¸èå´åæ¶ï¼æ¯å¦éå æ¾ç¤ºã
 * @param {OverlapDisplayedOptions} [options.overlapDisplayedOptions] - å°å¾çåçè¿æ»¤æ¾ç¤ºéé¡¹ï¼å½overlapDisplayed ä¸º false æ¶ææã
 * @usage
 */
class UGCMapLayer extends UGCLayer {

    constructor(options) {
        options = options || {};
        super(options);
        /**
         * @member {boolean} UGCMapLayer.prototype.completeLineSymbolDisplayed
         * @description æ¯å¦æ¾ç¤ºå®æ´çº¿åã
         */
        this.completeLineSymbolDisplayed = null;

        /**
         * @member {number} UGCMapLayer.prototype.maxScale
         * @description å°å¾æå¤§æ¯ä¾å°ºã
         */
        this.maxScale = null;

        /**
         * @member {number} UGCMapLayer.prototype.minScale
         * @description å°å¾æå°æ¯ä¾å°ºã
         */
        this.minScale = null;

        /**
         * @member {number} UGCMapLayer.prototype.minVisibleGeometrySize
         * @description å ä½å¯¹è±¡çæå°å¯è§å¤§å°ï¼ä»¥åç´ ä¸ºåä½ã
         */
        this.minVisibleGeometrySize = null;

        /**
         * @member {number} UGCMapLayer.prototype.opaqueRate
         * @description å¾å±çä¸éæåº¦ã
         */
        this.opaqueRate = null;
        /**
         * @member {boolean} UGCMapLayer.prototype.symbolScalable
         * @description æ¯å¦åè®¸å¾å±çç¬¦å·å¤§å°éå¾ç¼©æ¾ã
         */
        this.symbolScalable = null;

        /**
         * @member {number} UGCMapLayer.prototype.symbolScale
         * @description å¾å±çç¬¦å·ç¼©æ¾åºåæ¯ä¾å°ºã
         */
        this.symbolScale = null;

        /**
         * @member {boolean} [UGCMapLayer.prototype.overlapDisplayed=false]
         * @description å°å¾å¯¹è±¡å¨åä¸èå´åæ¶ï¼æ¯å¦éå æ¾ç¤ºã
         */
        this.overlapDisplayed = null;

        /**
         * @member {OverlapDisplayedOptions} UGCMapLayer.prototype.overlapDisplayedOptions
         * @description å°å¾çåçè¿æ»¤æ¾ç¤ºéé¡¹ï¼å½ overlapDisplayed ä¸º false æ¶ææã
         */
        this.overlapDisplayedOptions = null;

        this.CLASS_NAME = "SuperMap.UGCMapLayer";
    }

    /**
     * @function UGCMapLayer.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
        Util.reset(this);
    }


    /**
     * @function UGCMapLayer.prototype.fromJson
     * @description å°æå¡ç«¯ JSON å¯¹è±¡è½¬æ¢æå½åå®¢æ·ç«¯å¯¹è±¡
     * @param {Object} jsonObject - è¦è½¬æ¢ç JSON å¯¹è±¡ã
     */
    fromJson(jsonObject) {
        super.fromJson(jsonObject);
    }


    /**
     * @function UGCMapLayer.prototype.toServerJSONObject
     * @description è½¬æ¢æå¯¹åºç JSON æ ¼å¼å¯¹è±¡ã
     * @returns {Object} å¯¹åºç JSON æ ¼å¼å¯¹è±¡ã
     */
    toServerJSONObject() {
        return super.toServerJSONObject();
    }

}


;// CONCATENATED MODULE: ./src/common/iServer/JoinItem.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class JoinItem
 * @deprecatedclass SuperMap.JoinItem
 * @category iServer Data FeatureResults
 * @classdesc è¿æ¥ä¿¡æ¯ç±»ã
 * è¯¥ç±»ç¨äºç¢éæ°æ®éä¸å¤é¨è¡¨çè¿æ¥ãå¤é¨è¡¨å¯ä»¥ä¸ºå¦ä¸ä¸ªç¢éæ°æ®éï¼å¶ä¸­çº¯å±æ§æ°æ®éä¸­æ²¡æç©ºé´å ä½ä¿¡æ¯ï¼æå¯¹åºç DBMS è¡¨ï¼ä¹å¯ä»¥æ¯ç¨æ·èªå»ºçä¸å¡è¡¨ã
 * éè¦æ³¨æçæ¯ï¼ç¢éæ°æ®éä¸å¤é¨è¡¨å¿é¡»å±äºåä¸æ°æ®æºãè¡¨ä¹é´çèç³»çå»ºç«æä¸¤ç§æ¹å¼ï¼ä¸ç§æ¯è¿æ¥ï¼joinï¼ï¼ä¸ç§æ¯å³èï¼linkï¼ã
 * è¿æ¥ï¼å®éä¸æ¯ä¾æ®ç¸åçå­æ®µå°ä¸ä¸ªå¤é¨è¡¨è¿½å å°æå®çè¡¨ï¼èå³èæ¯åºäºä¸ä¸ªç¸åçå­æ®µå®ä¹äºä¸¤ä¸ªè¡¨æ ¼ä¹é´çèç³»ï¼ä½ä¸æ¯å®éçè¿½å ã
 * ç¨äºè¿æ¥ä¸¤ä¸ªè¡¨çå­æ®µçåç§°ä¸ä¸å®ç¸åï¼ä½ç±»åå¿é¡»ä¸è´ãå½ä¸¤ä¸ªè¡¨æ ¼ä¹é´å»ºç«äºè¿æ¥ï¼éè¿å¯¹ä¸»è¡¨è¿è¡æä½ï¼å¯ä»¥å¯¹å¤é¨è¡¨è¿è¡æ¥è¯¢ï¼å¶ä½ä¸é¢å¾ä»¥ååæç­ã
 * å½ä¸¤ä¸ªè¡¨æ ¼ä¹é´æ¯ä¸å¯¹ä¸æå¤å¯¹ä¸çå³ç³»æ¶ï¼å¯ä»¥ä½¿ç¨ join è¿æ¥ãå½ä¸ºå¤å¯¹ä¸çå³ç³»æ¶ï¼åè®¸æå®å¤ä¸ªå­æ®µä¹é´çå³èã
 *ï¼æ³¨æï¼JoinItem ç®åæ¯æå·¦è¿æ¥ååè¿æ¥ï¼ä¸æ¯æå¨è¿æ¥åå³è¿æ¥ï¼UDB å¼æä¸æ¯æåè¿æ¥ãå¹¶ä¸ç¨äºå»ºç«è¿æ¥çä¸¤ä¸ªè¡¨å¿é¡»å¨åä¸ä¸ªæ°æ®æºä¸ã)
 * @param {Object} options - åæ°ã
 * @param {string} options.foreignTableName - å¤é¨è¡¨çåç§°ã
 * @param {string} options.joinFilter - ç¢éæ°æ®éä¸å¤é¨è¡¨ä¹é´çè¿æ¥è¡¨è¾¾å¼ï¼å³è®¾å®ä¸¤ä¸ªè¡¨ä¹é´å³èçå­æ®µã
 * @param {JoinType} options.joinType - ä¸¤ä¸ªè¡¨ä¹é´è¿æ¥ç±»åã
 * @example ä¸é¢ä»¥ SQL æ¥è¯¢è¯´æ joinItem çä½¿ç¨æ¹æ³ï¼
 *(start code)
 *   function queryBySQL() {
     *       // è®¾ç½®ä¸å¤é¨è¡¨çè¿æ¥ä¿¡æ¯
     *       var joinItem = new JoinItem({
     *           foreignTableName: "foreignTable",
     *           joinFilter: "foreignTable.CONTINENT = Countries.CONTINENT",
     *           joinType: "LEFTJOIN"
     *       })
     *       var queryParam, queryBySQLParams, queryBySQLService;
     *       // è®¾ç½®æ¥è¯¢åæ°ï¼å¨æ¥è¯¢åæ°ä¸­æ·»å joinItemå³èæ¡ä»¶ä¿¡æ¯
     *       queryParam = new FilterParameter({
     *            name: "Countries@World",
     *            joinItems: [joinItem]
     *         }),
     *       queryBySQLParams = new QueryBySQLParameters({
     *             queryParams: [queryParam]
     *         }),
     *       queryBySQLService = new QueryBySQLService(url, {
     *             eventListeners: { "processCompleted": processCompleted, "processFailed": processFailed}
     *         });
     *       queryBySQLService.processAsync(queryBySQLParams);
     *  }
 *  function processCompleted(queryEventArgs) {//todo}
 *  function processFailed(e) {//todo}
 * (end)
 * @usage
 */
class JoinItem {

    constructor(options) {
        /**
         * @member {string} JoinItem.prototype.foreignTableName
         * @description å¤é¨è¡¨çåç§°ã
         * å¦æå¤é¨è¡¨çåç§°æ¯ä»¥ âè¡¨å@æ°æ®æºåâ å½åæ¹å¼ï¼åè¯¥å±æ§åªéèµå¼è¡¨åã
         * ä¾å¦ï¼å¤é¨è¡¨ Name@changchunï¼Name ä¸ºè¡¨åï¼changchun ä¸ºæ°æ®æºåç§°ï¼åè¯¥å±æ§çèµå¼åºä¸ºï¼Nameã
         */
        this.foreignTableName = null;

        /**
         * @member {string} JoinItem.prototype.joinFilter
         * @description ç¢éæ°æ®éä¸å¤é¨è¡¨ä¹é´çè¿æ¥è¡¨è¾¾å¼ï¼å³è®¾å®ä¸¤ä¸ªè¡¨ä¹é´å³èçå­æ®µã
         * ä¾å¦ï¼å°æ¿å±é¢æ°æ®éï¼Buildingï¼ç district å­æ®µä¸æ¿å±æ¥æèççº¯å±æ§æ°æ®éï¼Ownerï¼ç region å­æ®µç¸è¿æ¥ï¼
         * ä¸¤ä¸ªæ°æ®éå¯¹åºçè¡¨åç§°åå«ä¸º Table_Building å Table_Ownerï¼
         * åè¿æ¥è¡¨è¾¾å¼ä¸º Table_Building.district = Table_Owner.regionã
         * å½æå¤ä¸ªå­æ®µç¸è¿æ¥æ¶ï¼ç¨ AND å°å¤ä¸ªè¡¨è¾¾å¼ç¸è¿ã
         */
        this.joinFilter = null;

        /**
         * @member {JoinType} JoinItem.prototype.joinType
         * @description ä¸¤ä¸ªè¡¨ä¹é´è¿æ¥ç±»åã
         * è¿æ¥ç±»åå³å®äºå¯¹ä¸¤ä¸ªè¡¨è¿è¡è¿æ¥æ¥è¯¢åè¿åçè®°å½çæåµã
         */
        this.joinType = null;

        if (options) {
            Util.extend(this, options);
        }
        this.CLASS_NAME = "SuperMap.JoinItem";
    }


    /**
     * @function JoinItem.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.foreignTableName = null;
        me.joinFilter = null;
        me.joinType = null;
    }

    /**
     * @function JoinItem.prototype.toServerJSONObject
     * @description è½¬æ¢æå¯¹åºç JSON æ ¼å¼å¯¹è±¡ã
     */
    toServerJSONObject() {
        var dataObj = {};
        dataObj = Util.copyAttributes(dataObj, this);
        //joinFilteråºæ¬æ¯ä¸ªçº¯å±æ§å¯¹è±¡ï¼è¿éä¸ååè½¬æ¢
        return dataObj;
    }
}

;// CONCATENATED MODULE: ./src/common/iServer/UGCSubLayer.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class UGCSubLayer
 * @deprecatedclass SuperMap.UGCSubLayer
 * @category  iServer Map Layer
 * @classdesc å°å¾æå¡å¾å±å±æ§ä¿¡æ¯ç±»ãå½±åå¾å±ï¼Imageï¼ãä¸é¢å¾å±ï¼ServerThemeï¼ãæ æ ¼å¾å±ï¼Gridï¼ãç¢éå¾å±ï¼Vectorï¼ç­å¾å±åç»§æ¿è¯¥ç±»ã
 * @extends {UGCMapLayer}
 * @param {Object} options - åæ°ã
 * @param {DatasetInfo} options.datasetInfo - æ°æ®éä¿¡æ¯ã
 * @param {string} [options.displayFilter] - å¾å±æ¾ç¤ºè¿æ»¤æ¡ä»¶ã
 * @param {JoinItem} [options.joinItems] - è¿æ¥ä¿¡æ¯ç±»ã
 * @param {string} [options.representationField] - å­å¨å¶å¾è¡¨è¾¾ä¿¡æ¯çå­æ®µã
 * @param {LayerType} [options.ugcLayerType] - å¾å±ç±»åã
 * @usage
 */
class UGCSubLayer extends UGCMapLayer {


    constructor(options) {
        options = options || {};
        super(options);
        /**
         * @member {DatasetInfo} UGCSubLayer.prototype.datasetInfo
         * @description æ°æ®éä¿¡æ¯ã
         */
        this.datasetInfo = null;

        /**
         * @member {string} UGCSubLayer.prototype.displayFilter
         * @description å¾å±æ¾ç¤ºè¿æ»¤æ¡ä»¶ã
         */
        this.displayFilter = null;

        /**
         * @member {JoinItem} UGCSubLayer.prototype.joinItems
         * @description è¿æ¥ä¿¡æ¯ç±»ã
         */
        this.joinItems = null;

        /**
         * @member {string} UGCSubLayer.prototype.representationField
         * @description å­å¨å¶å¾è¡¨è¾¾ä¿¡æ¯çå­æ®µã
         */
        this.representationField = null;

        /**
         * @member {LayerType} UGCSubLayer.prototype.ugcLayerType
         * @description å¾å±ç±»åã
         */
        this.ugcLayerType = null;

        this.CLASS_NAME = "SuperMap.UGCSubLayer";
    }


    /**
     * @function UGCSubLayer.prototype.fromJson
     * @description å°æå¡ç«¯ JSON å¯¹è±¡è½¬æ¢æå½åå®¢æ·ç«¯å¯¹è±¡
     * @param {Object} jsonObject - è¦è½¬æ¢ç JSON å¯¹è±¡ã
     */
    fromJson(jsonObject) {
        super.fromJson(jsonObject);
        if (this.datasetInfo) {
            this.datasetInfo = new DatasetInfo(this.datasetInfo);
        }
        if (this.joinItems && this.joinItems.length) {
            var newJoinItems = [];
            for (var i = 0; i < this.joinItems.length; i++) {
                newJoinItems[i] = new JoinItem(this.joinItems[i]);
            }
            this.joinItems = newJoinItems;
        }
    }

    /**
     * @function UGCSubLayer.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
        Util.reset(this);
    }


    /**
     * @function UGCSubLayer.prototype.toServerJSONObject
     * @description è½¬æ¢æå¯¹åºç JSON æ ¼å¼å¯¹è±¡ã
     * @returns {Object} å¯¹åºç JSON æ ¼å¼å¯¹è±¡ã
     */
    toServerJSONObject() {
        var jsonObject = super.toServerJSONObject();
        if (jsonObject.joinItems) {
            var joinItems = [];
            for (var i = 0; i < jsonObject.joinItems.length; i++) {
                if (jsonObject.joinItems[i].toServerJSONObject) {
                    joinItems[i] = jsonObject.joinItems[i].toServerJSONObject();
                }

            }
            jsonObject.joinItems = joinItems;
        }
        if (jsonObject.datasetInfo) {
            if (jsonObject.datasetInfo.toServerJSONObject) {
                jsonObject.datasetInfo = jsonObject.datasetInfo.toServerJSONObject();
            }
        }
        return jsonObject;
    }

}


;// CONCATENATED MODULE: ./src/common/iServer/ServerTheme.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/










/**
 * @class ServerTheme
 * @deprecatedclass SuperMap.ServerTheme
 * @category  iServer Map Theme
 * @classdesc SuperMap ä¸é¢å¾å¾å±ç±»ã
 * @extends {UGCSubLayer}
 * @param {CommonTheme} theme - ä¸é¢å¾å¯¹è±¡ã
 * @param {LonLat} themeElementPosition - ä¸é¢å¾åç´ ä½ç½®ã
 * @usage
 */
class ServerTheme extends UGCSubLayer {

    constructor(options) {
        options = options || {};
        super(options);

        /**
         * @member {CommonTheme} ServerTheme.prototype.theme
         * @description ä¸é¢å¾å¯¹è±¡ã
         */
        this.theme = null;

        /**
         * @member {LonLat} ServerTheme.prototype.themeElementPosition
         * @description ä¸é¢å¾åç´ ä½ç½®ã
         */
        this.themeElementPosition = null;

        this.CLASS_NAME = "SuperMap.ServerTheme";

    }


    /**
     * @function ServerTheme.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     * @override
     */
    destroy() {
        super.destroy();
        Util.reset(this);
    }


    /**
     * @function ServerTheme.prototype.fromJson
     * @description å°æå¡ç«¯ JSON å¯¹è±¡è½¬æ¢æå½åå®¢æ·ç«¯å¯¹è±¡
     * @param {Object} jsonObject - è¦è½¬æ¢ç JSON å¯¹è±¡ã
     */
    fromJson(jsonObject) {
        super.fromJson(jsonObject);
        var themeObj = this.theme;
        var themeT = themeObj && themeObj.type;
        switch (themeT) {
            case 'LABEL':
                this.theme = ThemeLabel.fromObj(themeObj);
                break;
            case 'UNIQUE':
                this.theme = ThemeUnique.fromObj(themeObj);
                break;
            case 'GRAPH':
                this.theme = ThemeGraph.fromObj(themeObj);
                break;
            case 'DOTDENSITY':
                this.theme = ThemeDotDensity.fromObj(themeObj);
                break;
            case 'GRADUATEDSYMBOL':
                this.theme = ThemeGraduatedSymbol.fromObj(themeObj);
                break;
            case 'RANGE':
                this.theme = ThemeRange.fromObj(themeObj);
                break;
            default:
                break;
        }
        if (this.themeElementPosition) {
            //å¾æµè¯
            this.themeElementPosition = new LonLat(this.themeElementPosition.x, this.themeElementPosition.y);
        }
    }

    /**
     * @function ServerTheme.prototype.toServerJSONObject
     * @description è½¬æ¢æå¯¹åºç JSON æ ¼å¼å¯¹è±¡ã
     */
    toServerJSONObject() {
        //æ®éå±æ§ç´æ¥èµå¼
        var jsonObject = super.toServerJSONObject();

        if (jsonObject.themeElementPosition) {
            if (jsonObject.themeElementPosition.toServerJSONObject) {
                jsonObject.themeElementPosition = jsonObject.themeElementPosition.toServerJSONObject();
            }
        }
        if (jsonObject.theme) {
            if (jsonObject.theme.toServerJSONObject) {
                jsonObject.theme = jsonObject.theme.toServerJSONObject();
            }
        }
        return jsonObject;
    }

}


;// CONCATENATED MODULE: ./src/common/iServer/Grid.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/






/**
 * @class Grid
 * @deprecatedclass SuperMap.Grid
 * @category iServer Map Layer
 * @classdesc SuperMap æ æ ¼å¾å±ç±»ã
 * @extends {UGCSubLayer}
 * @param {Object} options - å¯éåæ°ã
 * @param {Array.<Object>} [options.colorDictionary] - é¢è²å¯¹ç§è¡¨å¯¹è±¡ã
 * @param {number} [options.brightness] - Grid å¾å±çäº®åº¦ã
 * @param {ColorGradientType} [options.colorGradientType] - é¢è²æ¸åæä¸¾ã
 * @param {ServerColor} [options.colors] - é¢è²è¡¨å¯¹è±¡ã
 * @param {number} [options.contrast] - Grid å¾å±çå¯¹æ¯åº¦ã
 * @param {GridType} [options.gridType] - æ ¼ç½ç±»åã
 * @param {number} [options.horizontalSpacing] - æ ¼ç½æ°´å¹³é´éå¤§å°ã
 * @param {boolean} [options.sizeFixed] - æ ¼ç½æ¯å¦åºå®å¤§å°ï¼å¦æä¸åºå®å¤§å°ï¼åæ ¼ç½éçå°å¾ç¼©æ¾ã
 * @param {ServerStyle} [options.solidStyle] - æ ¼ç½å®çº¿çæ ·å¼ã
 * @param {ServerColor} [options.specialColor] - æ æ ¼æ°æ®éæ å¼æ°æ®çé¢è²ã
 * @param {number} [options.specialValue] - å¾å±çç¹æ®å¼ã
 * @param {boolean} [options.specialValueTransparent] - å¾å±çç¹æ®å¼ï¼specialValueï¼æå¤åºåæ¯å¦éæã
 * @param {number} [options.verticalSpacing] - æ ¼ç½åç´é´éå¤§å°ã
 * @usage
 */
class Grid extends UGCSubLayer {


    constructor(options) {
        options = options || {};
        super(options);

        /**
         * @member {Array.<ColorDictionary>} Grid.prototype.colorDictionarys
         * @description é¢è²å¯¹ç§è¡¨å¯¹è±¡ã
         */
        this.colorDictionarys = null;

        /**
         * @member {number} Grid.prototype.brightness
         * @description Grid å¾å±çäº®åº¦ã
         */
        this.brightness = null;

        /**
         * @member {ColorGradientType} Grid.prototype.colorGradientType
         * @description æ¸åé¢è²æä¸¾å¼ã
         */
        this.colorGradientType = null;

        /**
         * @member {ServerColor} Grid.prototype.colors
         * @description é¢è²è¡¨å¯¹è±¡ã
         */
        this.colors = null;

        /**
         * @member {number} Grid.prototype.contrast
         * @description Grid å¾å±çå¯¹æ¯åº¦ã
         */
        this.contrast = null;

        /**
         * @member {ServerStyle} Grid.prototype.dashStyle
         * @description æ æ ¼æ°æ®éç¹æ®å¼æ°æ®çé¢è²ã
         */
        this.dashStyle = null;

        /**
         * @member {GridType} Grid.prototype.gridType
         * @description æ ¼ç½ç±»åã
         */
        this.gridType = null;

        /**
         * @member {number} Grid.prototype.horizontalSpacing
         * @description æ ¼ç½æ°´å¹³é´éå¤§å°ã
         */
        this.horizontalSpacing = null;

        /**
         * @member {boolean} Grid.prototype.sizeFixed
         * @description æ ¼ç½æ¯å¦åºå®å¤§å°ï¼å¦æä¸åºå®å¤§å°ï¼åæ ¼ç½éçå°å¾ç¼©æ¾ã
         */
        this.sizeFixed = null;

        /**
         * @member {ServerStyle} Grid.prototype.solidStyle
         * @description æ ¼ç½å®çº¿çæ ·å¼ã
         */
        this.solidStyle = null;

        /**
         * @member {ServerColor} Grid.prototype.specialColor
         * @description æ æ ¼æ°æ®éæ å¼æ°æ®çé¢è²ã
         */
        this.specialColor = null;

        /**
         * @member {number} Grid.prototype.specialValue
         * @description å¾å±çç¹æ®å¼ã
         */
        this.specialValue = null;

        /**
         * @member {boolean} Grid.prototype.specialValueTransparent
         * @description å¾å±çç¹æ®å¼ï¼specialValueï¼æå¤åºåæ¯å¦éæã
         */
        this.specialValueTransparent = null;

        /**
         * @member {number} Grid.prototype.verticalSpacing
         * @description æ ¼ç½åç´é´éå¤§å°ã
         */
        this.verticalSpacing = null;


        this.CLASS_NAME = "SuperMap.Grid";
    }

    /**
     * @function Grid.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        super.destroy();
        Util.reset(this);
    }

    /**
     * @function Grid.prototype.fromJson
     * @description å°æå¡ç«¯ JSON å¯¹è±¡è½¬æ¢æå½åå®¢æ·ç«¯å¯¹è±¡ã
     * @param {Object} jsonObject - è¦è½¬æ¢ç JSON å¯¹è±¡ã
     */
    fromJson(jsonObject) {
        super.fromJson(jsonObject);
        if (this.specialColor) {
            this.specialColor = new ServerColor(this.specialColor.red,
                this.specialColor.green,
                this.specialColor.blue);
        }
        if (this.colors) {
            var colors = [],
                color;
            for (var i in this.colors) {
                color = this.colors[i];
                colors.push(new ServerColor(color.red, color.green, color.blue));
            }
            this.colors = colors;
        }
        if (this.dashStyle) {
            this.dashStyle = new ServerStyle(this.dashStyle);
        }
        if (this.solidStyle) {
            this.solidStyle = new ServerStyle(this.solidStyle);
        }
        if (this.colorDictionary) {
            var colorDics = [],
                colorDic;
            for (var key in this.colorDictionary) {
                colorDic = this.colorDictionary[key];
                colorDics.push(new ColorDictionary({elevation: key, color: colorDic}));
            }
            this.colorDictionarys = colorDics;
        }
        delete this.colorDictionary;
    }

    /**
     * @function Grid.prototype.toServerJSONObject
     * @description è½¬æ¢æå¯¹åºç JSON å¯¹è±¡ã
     * @returns JSON å¯¹è±¡ã
     */
    toServerJSONObject() {
        var jsonObject = super.toServerJSONObject();

        if (jsonObject.dashStyle) {
            if (jsonObject.dashStyle.toServerJSONObject) {
                jsonObject.dashStyle = jsonObject.dashStyle.toServerJSONObject();
            }
        }
        if (jsonObject.solidStyle) {
            if (jsonObject.solidStyle.toServerJSONObject) {
                jsonObject.solidStyle = jsonObject.solidStyle.toServerJSONObject();
            }
        }
        return jsonObject;
    }

}


;// CONCATENATED MODULE: ./src/common/iServer/Image.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class UGCImage
 * @deprecatedclass SuperMap.Image
 * @category iServer Map Layer
 * @classdesc SuperMap å½±åå¾å±ç±»
 * @extends {UGCSubLayer}
 * @param {Object} options - å¯éåæ°ã
 * @param {ColorSpaceType} [options.colorSpaceType] - è¿åå½±åå¾å±çè²å½©æ¾ç¤ºæ¨¡å¼ã
 * @param {number} [options.brightness] - å½±åå¾å±çäº®åº¦ã
 * @param {Array.<number>} [options.displayBandIndexes] - è¿åå½åå½±åå¾å±æ¾ç¤ºçæ³¢æ®µç´¢å¼ã
 * @param {number} [options.contrast] - å½±åå¾å±çå¯¹æ¯åº¦ã
 * @param {boolean} [options.transparent] - æ¯å¦èæ¯éæã
 * @param {ServerColor} [options.transparentColor] - è¿åèæ¯éæè²ã
 * @param {number} [options.transparentColorTolerance] - èæ¯éæè²å®¹éã
 * @usage
 * @private
 */
class UGCImage extends UGCSubLayer {


    constructor(options) {
        options = options || {};
        super(options);
        /**
         * @member {number} UGCImage.prototype.brightness
         * @description å½±åå¾å±çäº®åº¦ã
         */
        this.brightness = null;

        /**
         * @member {ColorSpaceType} UGCImage.prototype.colorSpaceType
         * @description è¿åå½±åå¾å±çè²å½©æ¾ç¤ºæ¨¡å¼ã
         */
        this.colorSpaceType = null;

        /**
         * @member {number} UGCImage.prototype.contrast
         * @description å½±åå¾å±çå¯¹æ¯åº¦ã
         */
        this.contrast = null;

        /**
         * @member {Array.<number>} UGCImage.prototype.displayBandIndexes
         * @description è¿åå½åå½±åå¾å±æ¾ç¤ºçæ³¢æ®µç´¢å¼ã
         */
        this.displayBandIndexes = null;

        /**
         * @member {boolean} UGCImage.prototype.transparent
         * @description æ¯å¦èæ¯éæã
         */
        this.transparent = null;

        /**
         * @member {ServerColor} UGCImage.prototype.transparentColor
         * @description è¿åèæ¯éæè²ã
         */
        this.transparentColor = null;

        /**
         * @member {number} UGCImage.prototype.transparentColorTolerance
         * @description èæ¯éæè²å®¹éã
         */
        this.transparentColorTolerance = null;

        this.CLASS_NAME = "SuperMap.Image";
    }

    /**
     * @function UGCImage.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
        Util.reset(this);
    }

    /**
     * @function UGCImage.prototype.fromJson
     * @description å°æå¡ç«¯ JSON å¯¹è±¡è½¬æ¢æå½åå®¢æ·ç«¯å¯¹è±¡ã
     * @param {Object} jsonObject - è¦è½¬æ¢ç JSON å¯¹è±¡ã
     */
    fromJson(jsonObject) {
        super.fromJson(jsonObject);
        if (this.transparentColor) {
            this.transparentColor = new ServerColor(this.transparentColor.red,
                this.transparentColor.green,
                this.transparentColor.blue);
        }
    }

    /**
     * @function UGCImage.prototype.toServerJSONObject
     * @description è½¬æ¢æå¯¹åºç JSON æ ¼å¼å¯¹è±¡ã
     */
    toServerJSONObject() {
        return super.toServerJSONObject();
    }


}

;// CONCATENATED MODULE: ./src/common/iServer/Vector.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class Vector
 * @deprecatedclass SuperMap.Vector
 * @category  iServer Map Layer
 * @classdesc SuperMap ç¢éå¾å±ç±»ã
 * @extends {UGCSubLayer}
 * @param {Object} options - å¯éåæ°ã
 * @param {ServerStyle} [options.style] - ç¢éå¾å±çé£æ ¼ã
 * @usage
 */

class Vector_Vector extends UGCSubLayer {

    constructor(options) {
        options = options || {};
        super(options);
        /**
         * @member {ServerStyle} Vector.prototype.style
         * @description ç¢éå¾å±çé£æ ¼ã
         */
        this.style = null;

        this.CLASS_NAME = "SuperMap.Vector";
    }

    /**
     * @function Vector.prototype.destroy
     * @description éæ¯å¯¹è±¡ï¼å°å¶å±æ§ç½®ç©ºã
     * @override
     */
    destroy() {
        super.destroy();
        Util.reset(this);
    }

    /**
     * @function Vector.prototype.fromJson
     * @description å°æå¡ç«¯ JSON å¯¹è±¡è½¬æ¢æå½åå®¢æ·ç«¯å¯¹è±¡ã
     * @param {Object} jsonObject - è¦è½¬æ¢ç JSON å¯¹è±¡ã
     */
    fromJson(jsonObject) {
        super.fromJson(jsonObject);
        var sty = this.style;
        if (sty) {
            this.style = new ServerStyle(sty);
        }
    }

    /**
     * @function Vector.prototype.toServerJSONObject
     * @description è½¬æ¢æå¯¹åºç JSON æ ¼å¼å¯¹è±¡ã
     * @returns {Object} å¯¹åºç JSON æ ¼å¼å¯¹è±¡
     */
    toServerJSONObject() {
        var jsonObject = super.toServerJSONObject();
        if (jsonObject.style) {
            if (jsonObject.style.toServerJSONObject) {
                jsonObject.style = jsonObject.style.toServerJSONObject();
            }
        }
        return jsonObject;
    }
}


;// CONCATENATED MODULE: ./src/common/iServer/GetLayersInfoService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/







/**
 * @class GetLayersInfoService
 * @deprecatedclass SuperMap.GetLayersInfoService
 * @category iServer Map Layer
 * @classdesc è·åå¾å±ä¿¡æ¯æå¡ç±»æé å½æ°ã
 * @extends {CommonServiceBase}
 * @param {string} url - æå¡å°åãè¯·æ±å°å¾æå¡,URL åºä¸ºï¼
 *        http://{æå¡å¨å°å}:{æå¡ç«¯å£å·}/iserver/services/{å°å¾æå¡å}/rest/maps/{å°å¾å}ï¼
 *        å¦ http://localhost:8090/iserver/services/map-world/rest/maps/World ã
 *        å¦ææ¥è¯¢ä¸´æ¶å¾å±çä¿¡æ¯ï¼è¯·æå®å®æçurlï¼åå«ä¸´æ¶å¾å±IDä¿¡æ¯ï¼å¦ï¼
 *        http://localhost:8090/iserver/services/map-world/rest/maps/World/tempLayersSet/resourceID
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - äºä»¶çå¬å¨å¯¹è±¡ãæprocessCompletedå±æ§å¯ä¼ å¥å¤çå®æåçåè°å½æ°ãprocessFailedå±æ§ä¼ å¥å¤çå¤±è´¥åçåè°å½æ°ã
 * @param {DataFormat} [options.format=DataFormat.GEOJSON] - æ¥è¯¢ç»æè¿åæ ¼å¼ï¼ç®åæ¯æ iServerJSON å GeoJSON ä¸¤ç§æ ¼å¼ãåæ°æ ¼å¼ä¸º "ISERVER"ï¼"GEOJSON"ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @param {boolean} options.isTempLayers - å½åurlå¯¹åºçå¾å±æ¯å¦æ¯ä¸´æ¶å¾å±ã
 * @usage
 */
class GetLayersInfoService extends CommonServiceBase {


    constructor(url, options) {
        super(url, options);
        /**
         * @member {boolean} GetLayersInfoService.prototype.isTempLayers
         * @description å½åurlå¯¹åºçå¾å±æ¯å¦æ¯ä¸´æ¶å¾å±ã
         */
        this.isTempLayers = false;
        if (options) {
            Util.extend(this, options);
        }
        this.CLASS_NAME = "SuperMap.GetLayersInfoService";
    }

    /**
     * @function GetLayersInfoService.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
        Util.reset(this);
    }

    /**
     * @function GetLayersInfoService.prototype.processAsync
     * @description è´è´£å°å®¢æ·ç«¯çæ´æ°åæ°ä¼ éå°æå¡ç«¯ã
     */
    processAsync() {
        var me = this,
            method = "GET";
        if (!me.isTempLayers) {
            me.url = Util.urlPathAppend(me.url, 'layers');
        }
        me.request({
            method: method,
            params: null,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }

    /**
     * @function GetLayersInfoService.prototype.serviceProcessCompleted
     * @description ç¼è¾å®æï¼æ§è¡æ­¤æ¹æ³ã
     * @param {Object} result - æå¡å¨è¿åçç»æå¯¹è±¡ã
     */
    serviceProcessCompleted(result) {
        var me = this, existRes, layers, len;
        result = Util.transformResult(result);

        existRes = !!result && result.length > 0;
        layers = existRes ? result[0].subLayers.layers : null;
        len = layers ? layers.length : 0;
        me.handleLayers(len, layers);
        me.events.triggerEvent("processCompleted", {result: result[0]});
    }

    /**
     * TODO ä¸é¢å¾æ¶åå¯è½ä¼ç¨å°
     * @function GetLayersInfoService.prototype.handleLayers
     * @description å¤ç iServer æ°å¢å¾å±ç»æ°æ® (subLayers.layers ä¸­å¯è½è¿ä¼å«æ subLayers.layers)
     * @param {number} len - subLayers.layersçé¿åº¦
     * @param {Array.<number>} layers - subLayers.layersçé¿åº¦æ°ç»
     */
    handleLayers(len, layers) {
        var me = this, tempLayer;
        if (len) {
            for (var i = 0; i < len; i++) {
                if (layers[i].subLayers && layers[i].subLayers.layers && layers[i].subLayers.layers.length > 0) {
                    me.handleLayers(layers[i].subLayers.layers.length, layers[i].subLayers.layers);
                } else {
                    var type = layers[i].ugcLayerType;
                    switch (type) {
                        case 'THEME':
                            tempLayer = new ServerTheme();
                            tempLayer.fromJson(layers[i]);
                            layers[i] = tempLayer;
                            break;
                        case 'GRID':
                            tempLayer = new Grid();
                            tempLayer.fromJson(layers[i]);
                            layers[i] = tempLayer;
                            break;
                        case 'IMAGE':
                            tempLayer = new UGCImage();
                            tempLayer.fromJson(layers[i]);
                            layers[i] = tempLayer;
                            break;
                        case 'VECTOR':
                            tempLayer = new Vector_Vector();
                            tempLayer.fromJson(layers[i]);
                            layers[i] = tempLayer;
                            break;
                        default:
                            break;
                    }
                }

            }
        }
    }


}

;// CONCATENATED MODULE: ./src/common/iServer/InterpolationAnalystParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class InterpolationAnalystParameters
 * @deprecatedclass SuperMap.InterpolationAnalystParameters
 * @category iServer SpatialAnalyst InterpolationAnalyst
 * @classdesc æå¼åæåæ°ç±»ã
 * @param {Object} options - åæ°ã
 * @param {(SuperMap.Bounds|L.Bounds|L.LatLngBounds|ol.extent|mapboxgl.LngLatBounds|GeoJSONObject)} options.bounds - æå¼åæçèå´ï¼ç¨äºç¡®å®ç»ææ æ ¼æ°æ®éçèå´ã
 * @param {string} options.outputDatasetName - æå¼åæç»ææ°æ®éçåç§°ã
 * @param {string} options.outputDatasourceName - æå¼åæç»ææ°æ®æºçåç§°ã
 * @param {string} [options.zValueFieldName] - è¿è¡æå¼åæçå­æ®µåç§°ï¼æå¼åæä¸æ¯æææ¬ç±»åçå­æ®µã
 * @param {string} [options.dataset] - å¾åæçæ°æ®éåç§°ãå½æå¼åæç±»åï¼InterpolationAnalystTypeï¼ä¸º dataset æ¶ï¼æ­¤ä¸ºå¿éåæ°ã
 * @param {Array.<GeometryPoint|L.LatLng|L.Point|ol.geom.Point|mapboxgl.LngLat|Array.<number>>} [options.inputPoints] - ç¨äºåæå¼åæçç¦»æ£ç¹éåãå½æå¼åæç±»åï¼InterpolationAnalystTypeï¼ä¸º geometry æ¶ï¼æ­¤åæ°ä¸ºå¿è®¾åæ°ã
 * @param {number} [options.searchRadius=0] - æ¥æ¾åå¾ï¼å³åä¸è¿ç®ç¹çæ¥æ¾èå´ï¼ä¸ç¹æ°æ®éåä½ç¸åã
 * @param {number} [options.zValueScale=1] - è¿è¡æå¼åæå¼çç¼©æ¾æ¯çã
 * @param {number} [options.resolution] - æå¼ç»ææ æ ¼æ°æ®éçåè¾¨çï¼å³ä¸ä¸ªååæä»£è¡¨çå®å°è·ç¦»ï¼ä¸ç¹æ°æ®éåä½ç¸åã
 * @param {FilterParameter} [options.filterQueryParameter] - å±æ§è¿æ»¤æ¡ä»¶ã
 * @param {PixelFormat} [options.pixelFormat] - æå®ç»ææ æ ¼æ°æ®éå­å¨çåç´ æ ¼å¼ã
 * @param {string} [options.InterpolationAnalystType="dataset"] - æå¼åæç±»åï¼"dataset" æ "geometry"ï¼ã
 * @usage
 */
class InterpolationAnalystParameters {

    constructor(options) {
        if (!options) {
            return;
        }
        /**
         * @member {(SuperMap.Bounds|L.Bounds|L.LatLngBounds|ol.extent|mapboxgl.LngLatBounds|GeoJSONObject)} InterpolationAnalystParameters.prototype.bounds
         * @description æå¼åæçèå´ï¼ç¨äºç¡®å®ç»ææ æ ¼æ°æ®éçèå´ã
         * å¦æç¼ºçï¼åé»è®¤ä¸ºåæ°æ®éçèå´ãé´äºæ­¤æå¼æ¹æ³ä¸ºåææ¹æ³ï¼åæ°æ®éçèå´åçæå¼ç»ææç¸å¯¹æåèä»·å¼ï¼
         * å æ­¤å»ºè®®æ­¤åæ°ä¸å¤§äºåæ°æ®éèå´ã
         */
        this.bounds = null;

        /**
         * @member {number} [InterpolationAnalystParameters.prototype.searchRadius=0]
         * @description æ¥æ¾åå¾ï¼å³åä¸è¿ç®ç¹çæ¥æ¾èå´ï¼ä¸ç¹æ°æ®éåä½ç¸åã
         * è®¡ç®æä¸ªä½ç½®çZ å¼æ¶ï¼ä¼ä»¥è¯¥ä½ç½®ä¸ºåå¿ï¼ä»¥æ¥æ¾èå´çå¼ä¸ºåå¾ï¼è½å¨è¿ä¸ªèå´åçéæ ·ç¹é½å°åä¸è¿ç®ã
         * è¯¥å¼éè¦æ ¹æ®å¾æå¼ç¹æ°æ®çåå¸ç¶åµåç¹æ°æ®éèå´è¿è¡è®¾ç½®ã
         */
        this.searchRadius = 0;

        /**
         * @member {string} InterpolationAnalystParameters.prototype.zValueFieldName
         * @description æ°æ®éæå¼åæä¸­ï¼ç¨äºæå®è¿è¡æå¼åæçç®æ å­æ®µåï¼æå¼åæä¸æ¯æææ¬ç±»åçå­æ®µã
         * å«ä¹ä¸ºæ¯ä¸ªæå¼ç¹å¨æå¼è¿ç¨ä¸­çæéï¼å¯ä»¥å°ææç¹æ­¤å­æ®µå¼è®¾ç½®ä¸º 1ï¼å³ææç¹å¨æ´ä½æå¼ä¸­æéç¸åã
         * å½æå¼åæç±»åï¼InterpolationAnalystTypeï¼ä¸º dataset æ¶ï¼æ­¤ä¸ºå¿éåæ°ã
         */
        this.zValueFieldName = null;

        /**
         * @member {number} [InterpolationAnalystParameters.prototype.zValueScale=1]
         * @description ç¨äºè¿è¡æå¼åæå¼çç¼©æ¾æ¯çã
         * åå æå¼åæçå¼å°ä¹ä»¥è¯¥åæ°å¼ååè¿è¡æå¼ï¼ä¹å°±æ¯å¯¹è¿è¡æå¼åæçå¼è¿è¡ç»ä¸çæ©å¤§æç¼©å°ã
         */
        this.zValueScale = 1;

        /**
         * @member {number} InterpolationAnalystParameters.prototype.resolution
         * @description æå¼ç»ææ æ ¼æ°æ®éçåè¾¨çï¼å³ä¸ä¸ªååæä»£è¡¨çå®å°è·ç¦»ï¼ä¸ç¹æ°æ®éåä½ç¸åã
         * è¯¥å¼ä¸è½è¶è¿å¾åææ°æ®éçèå´è¾¹é¿ã
         * ä¸è¯¥å¼è®¾ç½®æ¶ï¼åºè¯¥èèç¹æ°æ®éèå´å¤§å°æ¥åå¼ï¼ä¸è¬ä¸ºç»ææ æ ¼è¡åå¼ï¼å³ç»ææ æ ¼æ°æ®éèå´é¤ä»¥åè¾¨çï¼ï¼å¨ 500 ä»¥åå¯ä»¥è¾å¥½å°ä½ç°å¯åº¦èµ°å¿ã
         */
        this.resolution = null;

        /**
         * @member {FilterParameter} [InterpolationAnalystParameters.prototype.filterQueryParameter]
         * @description è¿æ»¤æ¡ä»¶ï¼å¯¹åææ°æ®éä¸­çç¹è¿è¡è¿æ»¤ï¼è®¾ç½®ä¸º null è¡¨ç¤ºå¯¹æ°æ®éä¸­çææç¹è¿è¡åæã
         */
        this.filterQueryParameter = null;

        /**
         * @member {string} InterpolationAnalystParameters.prototype.outputDatasetName
         * @description æå¼åæç»ææ°æ®éçåç§°ã
         */
        this.outputDatasetName = null;

        /**
         * @member {string} InterpolationAnalystParameters.prototype.outputDatasourceName
         * @description æå¼åæç»ææ°æ®æºçåç§°ã
         */
        this.outputDatasourceName = null;

        /**
         * @member {PixelFormat} [InterpolationAnalystParameters.prototype.pixelFormat]
         * @description æå®ç»ææ æ ¼æ°æ®éå­å¨çåç´ æ ¼å¼ãæ¯æå­å¨çåç´ æ ¼å¼æ BIT16ãBIT32ãDOUBLEãSINGLEãUBIT1ãUBIT4ãUBIT8ãUBIT24ãUBIT32ã
         */
        this.pixelFormat = null;

        /**
         * @member {string} [InterpolationAnalystParameters.prototype.dataset]
         * @description ç¨æ¥åæå¼åæçæ°æ®æºä¸­æ°æ®éçåç§°ï¼è¯¥åç§°ç¨å½¢å¦ "æ°æ®éåç§°@æ°æ®æºå«å" å½¢å¼æ¥è¡¨ç¤ºã
         * å½æå¼åæç±»åï¼InterpolationAnalystTypeï¼ä¸º dataset æ¶ï¼æ­¤ä¸ºå¿éåæ°ã
         */
        this.dataset = null;

        /**
         * @member {Array.<GeometryPoint|L.LatLng|L.Point|ol.geom.Point|mapboxgl.LngLat|Array.<number>>} [InterpolationAnalystParameters.prototype.inputPoints]
         * @description ç¨äºåæå¼åæçç¦»æ£ç¹ï¼ç¦»æ£ç¹åæ¬Zå¼ï¼éåã
         * å½æå¼åæç±»åï¼InterpolationAnalystTypeï¼ä¸º geometry æ¶ï¼æ­¤åæ°ä¸ºå¿è®¾åæ°ã
         * éè¿ç¦»æ£ç¹ç´æ¥è¿è¡æå¼åæä¸éè¦æå®è¾å¥æ°æ®éinputDatasourceNameï¼inputDatasetNameä»¥åzValueFieldNameã
         */
        this.inputPoints = null;

        /**
         * @member {string} [InterpolationAnalystParameters.prototype.InterpolationAnalystType="dataset"]
         * @description  æå¼åæç±»åãå·®å¼åæåæ¬æ°æ®éæå¼åæåå ä½æå¼åæä¸¤ç±»ï¼
         *               "dataset" è¡¨ç¤ºå¯¹æ°æ®éè¿è¡æå¼åæï¼"geometry" è¡¨ç¤ºå¯¹ç¦»æ£ç¹æ°ç»è¿è¡æå¼åæã
         */
        this.InterpolationAnalystType = "dataset";

        /**
         * @member {ClipParameter} InterpolationAnalystParameters.prototype.clipParam
         * @description å¯¹æå¼åæç»æè¿è¡è£åªçåæ°ã
         */
        this.clipParam = null;

        Util.extend(this, options);
        this.CLASS_NAME = "SuperMap.InterpolationAnalystParameters";
    }

    /**
     * @function InterpolationAnalystParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.bounds = null;
        me.searchRadius = null;
        me.zValueFieldName = null;
        me.zValueScale = null;

        me.resolution = null;
        me.filterQueryParameter = null;
        me.outputDatasetName = null;
        me.pixelFormat = null;
    }

    /**
     * @function InterpolationAnalystParameters.toObject
     * @param {InterpolationAnalystParameters} interpolationAnalystParameters - æå¼åæåæ°ç±»ã
     * @param {InterpolationAnalystParameters} tempObj - æå¼åæåæ°å¯¹è±¡ã
     * @description å°æå¼åæåæ°å¯¹è±¡è½¬æ¢æ JSON å¯¹è±¡ã
     * @returns JSON å¯¹è±¡ã
     */
    static toObject(interpolationAnalystParameters, tempObj) {
        for (var name in interpolationAnalystParameters) {
            if (name === "inputPoints" && interpolationAnalystParameters.InterpolationAnalystType === "geometry") {
                var objs = [];
                for (var i = 0; i < interpolationAnalystParameters.inputPoints.length; i++) {
                    var item = interpolationAnalystParameters.inputPoints[i];
                    var obj = {
                        x: item.x,
                        y: item.y,
                        z: item.tag
                    };
                    objs.push(obj);
                }
                tempObj[name] = objs;
            } else {
                tempObj[name] = interpolationAnalystParameters[name];
            }
        }
    }
}

;// CONCATENATED MODULE: ./src/common/iServer/InterpolationRBFAnalystParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class InterpolationRBFAnalystParameters
 * @deprecatedclass SuperMap.InterpolationRBFAnalystParameters
 * @category iServer SpatialAnalyst InterpolationAnalyst
 * @classdesc æ ·æ¡æå¼ï¼å¾ååºå½æ°æå¼æ³ï¼åæåæ°ç±»ã
 * @extends {InterpolationAnalystParameters}
 * @param {Object} options - åæ°ã
 * @param {(SuperMap.Bounds|L.Bounds|L.LatLngBounds|ol.extent|mapboxgl.LngLatBounds|GeoJSONObject)} options.bounds - æå¼åæçèå´ï¼ç¨äºç¡®å®ç»ææ æ ¼æ°æ®éçèå´ã
 * @param {string} options.searchMode - æå¼è¿ç®æ¶ï¼æ¥æ¾åä¸è¿ç®ç¹çæ¹å¼ï¼æåºå®ç¹æ°æ¥æ¾ãå®é¿æ¥æ¾ãåæ¥æ¾ã
 * @param {string} options.outputDatasetName - æå¼åæç»ææ°æ®éçåç§°ã
 * @param {string} options.outputDatasourceName - æå¼åæç»ææ°æ®æºçåç§°ã
 * @param {string} [options.zValueFieldName] - å­å¨ç¨äºè¿è¡æå¼åæçå­æ®µåç§°ï¼æå¼åæä¸æ¯æææ¬ç±»åçå­æ®µãå½æå¼åæç±»å(SuperMap.InterpolationAnalystType)ä¸º dataset æ¶ï¼æ­¤ä¸ºå¿éåæ°ã
 * @param {number} [options.smooth=0.1] - åæ»ç³»æ°ï¼è¯¥å¼è¡¨ç¤ºæå¼å½æ°æ²çº¿ä¸ç¹çé¼è¿ç¨åº¦ï¼å¼åä¸º0å°1ã
 * @param {number} [options.tension=40] - å¼ åç³»æ°ï¼ç¨äºè°æ´ç»ææ æ ¼æ°æ®è¡¨é¢çç¹æ§ã
 * @param {number} [options.expectedCount=12] - ãåºå®ç¹æ°æ¥æ¾ãæ¹å¼ä¸ï¼è®¾ç½®åä¸å·®å¼è¿ç®çç¹æ°ã
 * @param {number} [options.searchRadius=0] - ãå®é¿æ¥æ¾ãæ¹å¼ä¸ï¼è®¾ç½®åä¸è¿ç®ç¹çæ¥æ¾èå´ã
 * @param {number} [options.maxPointCountForInterpolation=200] - ãåæ¥æ¾ãæ¹å¼ä¸ï¼è®¾ç½®æå¤åä¸æå¼çç¹æ°ã
 * @param {number} [options.maxPointCountInNode=50] - ãåæ¥æ¾ãæ¹å¼ä¸ï¼è®¾ç½®åä¸ªååæå¤åä¸è¿ç®ç¹æ°ã
 * @param {number} [options.zValueScale=1] - ç¨äºè¿è¡æå¼åæå¼çç¼©æ¾æ¯çã
 * @param {number} [options.resolution] - æå¼ç»ææ æ ¼æ°æ®éçåè¾¨çï¼å³ä¸ä¸ªååæä»£è¡¨çå®å°è·ç¦»ï¼ä¸ç¹æ°æ®éåä½ç¸åã
 * @param {FilterParameter} [options.filterQueryParameter] - å±æ§è¿æ»¤æ¡ä»¶ã
 * @param {string} [options.pixelFormat] - æå®ç»ææ æ ¼æ°æ®éå­å¨çåç´ æ ¼å¼ã
 * @param {string} [options.dataset] - è¦ç¨æ¥åæå¼åæçæ°æ®æºä¸­æ°æ®éçåç§°ãè¯¥åç§°ç¨å½¢å¦âæ°æ®éåç§°@æ°æ®æºå«åâå½¢å¼æ¥è¡¨ç¤ºãå½æå¼åæç±»å(InterpolationAnalystType)ä¸º dataset æ¶ãæ­¤ä¸ºå¿éåæ°ã
 * @param {Array.<GeometryPoint|L.LatLng|L.Point|ol.geom.Point|mapboxgl.LngLat|Array.<number>>} [options.inputPoints] - ç¨äºåæå¼åæçç¦»æ£ç¹éåãå½æå¼åæç±»åï¼InterpolationAnalystTypeï¼ä¸º geometry æ¶ãæ­¤ä¸ºå¿éåæ°ã
 * @example
 * var myInterpolationRBFAnalystParameters = new InterpolationRBFAnalystParameters({
 *     dataset:"SamplesP@Interpolation",
 *     smooth: 0.1,
 *     tension: 40,
 *     searchMode: "QUADTREE",
 *     maxPointCountForInterpolation: 20,
 *     maxPointCountInNode: 5,
 *     pixelFormat: "BIT16",
 *     zValueFieldName: "AVG_TMP",
 *     resolution: 3000,
 *     filterQueryParameter: {
 *         attributeFilter: ""
 *     },
 *     outputDatasetName: "myRBF"
 * });
 * @usage
 */
class InterpolationRBFAnalystParameters extends InterpolationAnalystParameters {

    constructor(options) {
        super(options);
        /**
         * @member {number} [InterpolationRBFAnalystParameters.prototype.smooth=0.1]
         * @description åæ»ç³»æ°ï¼å¼åä¸º 0 å° 1ï¼å¸¸ç¨åå¼å¦ 0ã0.001ã0.01ã0.1ãå 0.5ã
         * è¯¥å¼è¡¨ç¤ºæå¼å½æ°æ²çº¿ä¸ç¹çé¼è¿ç¨åº¦ï¼æ­¤æ°å¼è¶å¤§ï¼å½æ°æ²çº¿ä¸ç¹çåå·®è¶å¤§ï¼åä¹è¶å°ã
         */
        this.smooth = 0.1;

        /**
         * @member {number} [InterpolationRBFAnalystParameters.prototype.tension=40]
         * @description å¼ åç³»æ°ï¼å¸¸ç¨åå¼å¦ 0ã1ã5 å 10ã
         * ç¨äºè°æ´ç»ææ æ ¼æ°æ®è¡¨é¢çç¹æ§ï¼å¼ åè¶å¤§ï¼æå¼æ¶æ¯ä¸ªç¹å¯¹è®¡ç®ç»æå½±åè¶å°ï¼åä¹è¶å¤§ã
         */
        this.tension = 40;

        /**
         * @member {SearchMode} InterpolationRBFAnalystParameters.prototype.searchMode
         * @description æå¼è¿ç®æ¶ï¼æ¥æ¾åä¸è¿ç®ç¹çæ¹å¼ï¼æåºå®ç¹æ°æ¥æ¾ãå®é¿æ¥æ¾ãåæ¥æ¾ãå¿è®¾åæ°ã
         * å·ä½å¦ä¸ï¼
         * {KDTREE_FIXED_COUNT} ä½¿ç¨ KDTREE çåºå®ç¹æ°æ¹å¼æ¥æ¾åä¸åæåæçç¹ã
         * {KDTREE_FIXED_RADIUS} ä½¿ç¨ KDTREE çå®é¿æ¹å¼æ¥æ¾åä¸åæåæçç¹ã
         * {QUADTREE} ä½¿ç¨ QUADTREE æ¹å¼æ¥æ¾åä¸åæåæçç¹ï¼åæ¥æ¾ï¼ã
         */
        this.searchMode = null;

        /**
         * @member {number} [InterpolationRBFAnalystParameters.prototype.expectedCount=12]
         * @description ãåºå®ç¹æ°æ¥æ¾ãæ¹å¼ä¸ï¼è®¾ç½®å¾æ¥æ¾çç¹æ°ï¼å³åä¸å·®å¼è¿ç®çç¹æ°ã
         */
        this.expectedCount = 12;

        /**
         * @member {number} [InterpolationRBFAnalystParameters.prototype.maxPointCountForInterpolation=200]
         * @description ãåæ¥æ¾ãæ¹å¼ä¸ï¼æå¤åä¸æå¼çç¹æ°ã
         */
        this.maxPointCountForInterpolation = 200;

        /**
         * @member {number} [InterpolationRBFAnalystParameters.prototype.maxPointCountInNode=50]
         * @description ãåæ¥æ¾ãæ¹å¼ä¸ï¼åä¸ªååæå¤åä¸è¿ç®ç¹æ°ã
         */
        this.maxPointCountInNode = 50;

        if (options) {
            Util.extend(this, options);
        }
        this.CLASS_NAME = "SuperMap.InterpolationRBFAnalystParameters";

    }


    /**
     * @function InterpolationRBFAnalystParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        super.destroy();
        var me = this;
        me.smooth = null;
        me.tension = null;
        me.searchMode = null;
        me.expectedCount = null;
        me.maxPointCountForInterpolation = null;
        me.maxPointCountInNode = null;
    }

    /**
     * @function InterpolationRBFAnalystParameters.toObject
     * @param {InterpolationRBFAnalystParameters} datasetInterpolationRBFAnalystParameters - æ ·æ¡æå¼ï¼å¾ååºå½æ°æå¼æ³ï¼åæåæ°ç±»
     * @param {InterpolationRBFAnalystParameters} tempObj - æ ·æ¡æå¼ï¼å¾ååºå½æ°æå¼æ³ï¼åæåæ°å¯¹è±¡
     * @description å°æ ·æ¡æå¼ï¼å¾ååºå½æ°æå¼æ³ï¼åæåæ°å¯¹è±¡è½¬æ¢ä¸º JSON å¯¹è±¡ã
     * @returns JSON å¯¹è±¡ã
     */
    static toObject(datasetInterpolationRBFAnalystParameters, tempObj) {
        for (var name in datasetInterpolationRBFAnalystParameters) {
            tempObj[name] = datasetInterpolationRBFAnalystParameters[name];

        }
    }
}


;// CONCATENATED MODULE: ./src/common/iServer/InterpolationDensityAnalystParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class InterpolationDensityAnalystParameters
 * @deprecatedclass SuperMap.InterpolationDensityAnalystParameters
 * @category iServer SpatialAnalyst InterpolationAnalyst
 * @classdesc ç¹å¯åº¦å·®å¼åæåæ°ç±»ã
 * @param {Object} options - åæ°ã
 * @param {(SuperMap.Bounds|L.Bounds|L.LatLngBounds|ol.extent|mapboxgl.LngLatBounds|GeoJSONObject)} options.bounds - æå¼åæçèå´ï¼ç¨äºç¡®å®ç»ææ æ ¼æ°æ®éçèå´ã
 * @param {string} options.outputDatasourceName - æå¼åæç»ææ°æ®æºçåç§°ã
 * @param {string} options.outputDatasetName - æå¼åæç»ææ°æ®éçåç§°ã
 * @param {number} [options.searchRadius=0] - æ¥æ¾åå¾ï¼å³åä¸è¿ç®ç¹çæ¥æ¾èå´ï¼ä¸ç¹æ°æ®éåä½ç¸åã
 * @param {string} [options.zValueFieldName] - è¿è¡æå¼åæçå­æ®µåç§°ï¼æå¼åæä¸æ¯æææ¬ç±»åçå­æ®µãå½æå¼åæç±»å(InterpolationAnalystParameters.prototype.InterpolationAnalystType)ä¸º dataset æ¶ãæ­¤ä¸ºå¿éåæ°ã
 * @param {number} [options.zValueScale=1] - è¿è¡æå¼åæå¼çç¼©æ¾æ¯çã
 * @param {number} [options.resolution] - æå¼ç»ææ æ ¼æ°æ®éçåè¾¨çï¼å³ä¸ä¸ªååæä»£è¡¨çå®å°è·ç¦»ï¼ä¸ç¹æ°æ®éåä½ç¸åã
 * @param {FilterParameter} [options.filterQueryParameter] - å±æ§è¿æ»¤æ¡ä»¶ã
 * @param {string} [options.pixelFormat] - æå®ç»ææ æ ¼æ°æ®éå­å¨çåç´ æ ¼å¼ã
 * @param {string} [options.dataset] - ç¨æ¥åæå¼åæçæ°æ®æºä¸­æ°æ®éçåç§°ï¼è¯¥åç§°ç¨å½¢å¦ "æ°æ®éåç§°@æ°æ®æºå«å" å½¢å¼æ¥è¡¨ç¤ºãå½æå¼åæç±»åï¼InterpolationAnalystParameters.prototype.InterpolationAnalystTypeï¼ä¸º dataset æ¶ï¼æ­¤ä¸ºå¿éåæ°ã
 * @param {Array.<GeometryPoint|L.LatLng|L.Point|ol.geom.Point|mapboxgl.LngLat|Array.<number>>} [options.inputPoints] - ç¨äºåæå¼åæçç¦»æ£ç¹éåãå½æå¼åæç±»åï¼InterpolationAnalystParameters.prototype.InterpolationAnalystTypeï¼ä¸º geometry æ¶ï¼æ­¤ä¸ºå¿éåæ°ã
 * @extends {InterpolationAnalystParameters}
 * @example
 * var myInterpolationDensityAnalystParameters = new InterpolationDensityAnalystParameters({
 *      dataset: "SamplesP@Interpolation",
 *      searchRadius: "100000",
 *      pixelFormat: "BIT16",
 *      zValueFieldName: "AVG_TMP",
 *      resolution: 3000,
 *      filterQueryParameter: {
 *          attributeFilter: ""
 *      },
 *      outputDatasetName: "myDensity"
 * });
 * @usage
 */
class InterpolationDensityAnalystParameters extends InterpolationAnalystParameters {


    constructor(options) {
        super(options);
        if (options) {
            Util.extend(this, options);
        }
        this.CLASS_NAME = "SuperMap.InterpolationDensityAnalystParameters";
    }

    /**
     * @function InterpolationDensityAnalystParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        super.destroy();
    }
}

;// CONCATENATED MODULE: ./src/common/iServer/InterpolationIDWAnalystParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class InterpolationIDWAnalystParameters
 * @deprecatedclass SuperMap.InterpolationIDWAnalystParameters
 * @category  iServer SpatialAnalyst InterpolationAnalyst
 * @classdesc åè·ç¦»å ææå¼ï¼IDWï¼åæåæ°ç±»ã
 * @param {Object} options - åæ°ã
 * @param {(SuperMap.Bounds|L.Bounds|L.LatLngBounds|ol.extent|mapboxgl.LngLatBounds|GeoJSONObject)} options.bounds - æå¼åæçèå´ï¼ç¨äºç¡®å®ç»ææ æ ¼æ°æ®éçèå´ã
 * @param {string} options.searchMode - æå¼è¿ç®æ¶ï¼æ¥æ¾åä¸è¿ç®ç¹çæ¹å¼ï¼æ¯æåºå®ç¹æ°æ¥æ¾ãå®é¿æ¥æ¾ã
 * @param {string} options.outputDatasetName - æå¼åæç»ææ°æ®éçåç§°ã
 * @param {string} options.outputDatasourceName - æå¼åæç»ææ°æ®æºçåç§°ã
 * @param {string} [options.zValueFieldName] - è¿è¡æå¼åæçå­æ®µåç§°ï¼æå¼åæä¸æ¯æææ¬ç±»åçå­æ®µãå½æå¼åæç±»å(SuperMap.InterpolationAnalystType)ä¸º dataset æ¶ï¼æ­¤ä¸ºå¿éåæ°ã
 * @param {number} [options.expectedCount=12] - ãåºå®ç¹æ°æ¥æ¾ãæ¹å¼ä¸ï¼è®¾ç½®å¾æ¥æ¾çç¹æ°ï¼å³åä¸å·®å¼è¿ç®çç¹æ°ã
 * @param {number} [options.searchRadius=0] - ãå®é¿æ¥æ¾ãæ¹å¼ä¸ï¼è®¾ç½®æ¥æ¾åå¾ï¼å³åä¸è¿ç®ç¹çæ¥æ¾èå´ï¼ä¸ç¹æ°æ®éåä½ç¸åã
 * @param {number} [options.power=2] - è·ç¦»æéè®¡ç®çå¹æ¬¡ã
 * @param {number} [options.zValueScale=1] - ç¨äºè¿è¡æå¼åæå¼çç¼©æ¾æ¯çã
 * @param {number} [options.resolution] - æå¼ç»ææ æ ¼æ°æ®éçåè¾¨çï¼å³ä¸ä¸ªååæä»£è¡¨çå®å°è·ç¦»ï¼ä¸ç¹æ°æ®éåä½ç¸åã
 * @param {FilterParameter} [options.filterQueryParameter] - å±æ§è¿æ»¤æ¡ä»¶ã
 * @param {string} [options.pixelFormat] - æå®ç»ææ æ ¼æ°æ®éå­å¨çåç´ æ ¼å¼ã
 * @param {string} [options.dataset] - è¦ç¨æ¥åæå¼åæçæ°æ®æºä¸­æ°æ®éçåç§°ãè¯¥åç§°ç¨å½¢å¦âæ°æ®éåç§°@æ°æ®æºå«åâå½¢å¼æ¥è¡¨ç¤ºãå½æå¼åæç±»å(SuperMap.InterpolationAnalystType)ä¸º dataset æ¶ï¼æ­¤ä¸ºå¿éåæ°ã
 * @param {Array.<GeometryPoint|L.LatLng|L.Point|ol.geom.Point|mapboxgl.LngLat|Array.<number>>} [options.inputPoints] - ç¨äºåæå¼åæçç¦»æ£ç¹éåãå½æå¼åæç±»åï¼SuperMap.InterpolationAnalystTypeï¼ä¸º geometry æ¶ï¼æ­¤ä¸ºå¿éåæ°ã
 * @extends {InterpolationAnalystParameters}
 * @example ä¾å¦ï¼
 * var myInterpolationIDWAnalystParameters = new InterpolationIDWAnalystParameters({
 *      dataset:"SamplesP@Interpolation",
 *      power: 2,
 *      searchMode: "KDTREE_FIXED_COUNT",
 *      expectedCount: 12,
 *      pixelFormat: "BIT16",
 *      zValueFieldName: "AVG_TMP",
 *      resolution: 3000,
 *      filterQueryParameter: {
 *          attributeFilter: ""
 *      },
 *      outputDatasetName: "myIDW"
 * });
 * @usage
 */
class InterpolationIDWAnalystParameters extends InterpolationAnalystParameters {



    constructor(options) {
        super(options);
        /**
         * @member {number} [InterpolationIDWAnalystParameters.prototype.power=2]
         * @description è·ç¦»æéè®¡ç®çå¹æ¬¡ã
         * è¯¥å¼å³å®äºæå¼ä¸éçéåº¦ï¼å¹æ¬¡è¶å¤§ï¼éè·ç¦»çå¢å¤§æå¼ä¸éè¶å¿«ï¼è·ç¦»é¢æµç¹è¶è¿çç¹çæå¼ä¹è¶å°ã
         * çè®ºä¸ï¼åæ°å¼å¿é¡»å¤§äº0ï¼ä½æ¯0.5å°3ä¹é´æ¶è¿ç®ç»ææ´åçï¼å æ­¤æ¨èå¼ä¸º0.5~3ã
         */
        this.power = 2;

        /**
         * @member {SearchMode} InterpolationIDWAnalystParameters.prototype.searchMode
         * @description æå¼è¿ç®æ¶ï¼æ¥æ¾åä¸è¿ç®ç¹çæ¹å¼ï¼æ¯æåºå®ç¹æ°æ¥æ¾ãå®é¿æ¥æ¾ã
         * å·ä½å¦ä¸ï¼
         * {KDTREE_FIXED_COUNT} ä½¿ç¨ KDTREE çåºå®ç¹æ°æ¹å¼æ¥æ¾åä¸åæåæçç¹ã
         * {KDTREE_FIXED_RADIUS} ä½¿ç¨ KDTREE çå®é¿æ¹å¼æ¥æ¾åä¸åæåæçç¹ã
         */
        this.searchMode = null;

        /**
         * @member {number} [InterpolationIDWAnalystParameters.prototype.expectedCount=12]
         * @description ãåºå®ç¹æ°æ¥æ¾ãæ¹å¼ä¸ï¼è®¾ç½®å¾æ¥æ¾çç¹æ°ï¼å³åä¸å·®å¼è¿ç®çç¹æ°ã
         */
        this.expectedCount = 12;
        if (options) {
            Util.extend(this, options);
        }
        this.CLASS_NAME = "SuperMap.InterpolationIDWAnalystParameters";
    }

    /**
     * @function InterpolationIDWAnalystParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        super.destroy();
        var me = this;
        me.power = null;
        me.searchMode = null;
        me.expectedCount = null;
    }
}


;// CONCATENATED MODULE: ./src/common/iServer/InterpolationKrigingAnalystParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class InterpolationKrigingAnalystParameters
 * @deprecatedclass SuperMap.InterpolationKrigingAnalystParameters
 * @category iServer SpatialAnalyst InterpolationAnalyst
 * @classdesc ååéæå¼åæåæ°ç±»ãéè¿è¯¥ç±»å¯ä»¥è®¾ç½®ååéæå¼åææéçåæ°ã
 * ååéï¼Krigingï¼æ³ä¸ºå°ç»è®¡å­¦ä¸ä¸ç§ç©ºé´æ°æ®åæå¤çæ¹æ³ï¼ä¸»è¦çç®çæ¯å©ç¨åæ°æ®ç¹é´åå¼æ°ï¼varianceï¼çå¤§å°æ¥æ¨æ±æä¸æªç¥ç¹ä¸åå·²ç¥ç¹çæéå³ç³»ï¼
 * åç±åæ°æ®ç¹çå¼åå¶ä¸æªç¥ç¹çæéå³ç³»æ¨æ±æªç¥ç¹çå¼ãKriging æ³æå¤§çç¹è²ä¸ä»æ¯æä¾ä¸ä¸ªæå°ä¼°è®¡è¯¯å·®çé¢æµå¼ï¼å¹¶ä¸å¯æç¡®çæåºè¯¯å·®å¼çå¤§å°ã
 * ä¸è¬èè¨ï¼è®¸å¤å°è´¨åæ°ï¼å¦å°å½¢é¢ï¼æ¬èº«å³å·æè¿ç»­æ§ï¼æå¨ä¸æ®µè·ç¦»åçä»»ä¸¤ç¹å¿æç©ºé´ä¸çå³ç³»ãåä¹ï¼å¨ä¸ä¸è§åé¢ä¸çä¸¤ç¹è¥ç¸è·çè¿ï¼
 * åå¨ç»è®¡æä¹ä¸å¯è§ä¸ºäºä¸ºç¬ç« (stastically indepedent)ãè¿ç§éè·ç¦»èæ¹åçç©ºé´ä¸è¿ç»­æ§ï¼å¯ç¨ååå¼å¾ (semivariogram) æ¥è¡¨ç°ã
 * å æ­¤ï¼è¥æ³ç±å·²ç¥çæ£ä¹±ç¹æ¥æ¨æ±æä¸æªç¥ç¹çå¼ï¼åå¯å©ç¨ååå¼å¾æ¨æ±åå·²ç¥ç¹ä¸æªç¥ç¹çç©ºé´å³ç³»ï¼å³ä»¥ä¸åä¸ªåæ°ï¼<br>
 * 1.åéå¼ï¼nuggetï¼ï¼å½éæ ·ç¹é´è·ä¸º0æ¶ï¼çè®ºä¸ååå¼å½æ°å¼ä¸º0ï¼ä½æ¶é´ä¸ä¸¤éæ ·ç¹éå¸¸æ¥è¿æ¶ååå¼å½æ°å¼å¹¶ä¸ä¸º0ï¼å³äº§çäºä¸å¾æç¤ºçåéæåºï¼
 * å¯¹åºçååå¼å½æ°å¼ä¸ºåéå¼ãåéå¼å¯è½ç±äºæµéè¯¯å·®æèç©ºé´åå¼äº§çã<br>
 * 2.åºå°å¼ï¼sillï¼ï¼éçéæ ·ç¹é´è·çä¸æ­å¢å¤§ï¼ååå¼å½æ°çå¼è¶åä¸ä¸ªç¨³å®çå¸¸æ°ï¼è¯¥å¸¸æ°æä¸ºåºå°å¼ãå°è¾¾åºå°å¼åï¼ååå¼å½æ°çå¼ä¸åééæ ·ç¹é´è·èæ¹åï¼
 *   å³å¤§äºæ­¤é´è·çéæ ·ç¹ä¸åå·æç©ºé´ç¸å³æ§ã<br>
 * 3.ååºå°å¼ï¼åºå°å¼ä¸åéå¼çå·®å¼ã<br>
 * 4.èªç¸å³éå¼ï¼rangeï¼ï¼ä¹ç§°åç¨ï¼æ¯ååå¼å½æ°å¼è¾¾å°åºå°å¼æ¶ï¼éæ ·ç¹çé´è·ãè¶è¿èªç¸å³éå¼çéæ ·ç¹ä¸åå·æç©ºé´ç¸å³æ§ï¼å°ä¸å¯¹é¢æµç»æäº§çå½±åã<br>
 * ç¶åï¼ç±æ­¤ç©ºé´åæ°æ¨æ±ååå¼æ°ï¼ç±åæ°æ®ç¹é´çååå¼æ°å¯æ¨æ±æªç¥ç¹ä¸å·²ç¥ç¹é´çæéå³ç³»ï¼è¿èæ¨æ±åºæªç¥ç¹çå¼ã
 * ååéæ³çä¼ç¹æ¯ä»¥ç©ºé´ç»è®¡å­¦ä½ä¸ºå¶åå®ççè®ºåºç¡ï¼ç©çå«ä¹æç¡®ï¼ä¸ä½è½ä¼°è®¡æµå®åæ°çç©ºé´åå¼åå¸ï¼èä¸è¿å¯ä»¥ä¼°ç®åæ°çæ¹å·®åå¸ãååéæ³çç¼ºç¹æ¯è®¡ç®æ­¥éª¤è¾ç¦çï¼
 * è®¡ç®éå¤§ï¼ä¸åå¼å½æ°ææ¶éè¦æ ¹æ®ç»éªäººä¸ºéå®ã
 *
 * ç±ä¸è¿°å¯ç¥ï¼ååå¼å½æ°æ¯ååéæå¼çå³é®ï¼å æ­¤éæ©åéçååå¼å½æ°æ¨¡åéå¸¸éè¦ï¼SuperMap æä¾äºä»¥ä¸ä¸ç§ååå¼å½æ°æ¨¡åï¼<br>
 * 1.ææ°åï¼EXPONENTIALï¼ï¼éç¨äºç©ºé´ç¸å³å³ç³»éæ ·æ¬é´è·çå¢å æææ°éåçæåµï¼å¶ç©ºé´èªç¸å³å³ç³»å¨æ ·æ¬é´è·çæ ç©·è¿å¤å®å¨æ¶å¤±ã<br>
 * 2.çåï¼SPHERICALï¼ï¼éç¨äºç©ºé´èªç¸å³å³ç³»éæ ·æ¬é´è·çå¢å èéæ¸åå°ï¼ç´å°è¶åºä¸å®çè·ç¦»æ¶ç©ºé´èªç¸å³å³ç³»æ¶å¤±çæåµã<br>
 * 3.é«æ¯åï¼GAUSSIANï¼ï¼éç¨äºååå¼å½æ°å¼æ¸è¿å°é¼è¿åºå°å¼çæåµã<br>
 *
 * ååå¼å½æ°ä¸­ï¼æä¸ä¸ªå³é®åæ°å³æå¼çå­æ®µå¼çææï¼å¹³åå¼ï¼ï¼ç±äºå¯¹äºæ­¤åæ°çä¸åå¤çæ¹æ³èè¡çåºäºä¸åç Kriging æ¹æ³ãSuperMapçå·®å¼åè½åºäºä»¥ä¸ä¸ç§å¸¸ç¨ Kriging ç®æ³ï¼<br>
 * 1.ç®åååéï¼Simple Krigingï¼ï¼è¯¥æ¹æ³åå®ç¨äºæå¼çå­æ®µå¼çææï¼å¹³åå¼ï¼å·²ç¥çæä¸å¸¸æ°ã<br>
 * 2.æ®éååéï¼Krigingï¼ï¼è¯¥æ¹æ³åå®ç¨äºæå¼çå­æ®µå¼çææï¼å¹³åå¼ï¼æªç¥ä¸æå®ãå®å©ç¨ä¸å®çæ°å­¦å½æ°ï¼éè¿å¯¹ç»å®çç©ºé´ç¹è¿è¡æåæ¥ä¼°ç®ååæ ¼çå¼ï¼
 *      çææ ¼ç½æ°æ®éãå®ä¸ä»å¯ä»¥çæä¸ä¸ªè¡¨é¢ï¼è¿å¯ä»¥ç»åºé¢æµç»æçç²¾åº¦æèç¡®å®æ§çåº¦éãå æ­¤ï¼æ­¤æ¹æ³è®¡ç®ç²¾åº¦è¾é«ï¼å¸¸ç¨äºå°å­¦é¢åã
 * 3.æ³ååéï¼Universal Krigingï¼ï¼è¯¥æ¹æ³åå®ç¨äºæå¼çå­æ®µå¼çææï¼å¹³åå¼ï¼æ¯æªç¥çåéãå¨æ ·ç¹æ°æ®ä¸­å­å¨æç§ä¸»å¯¼è¶å¿ä¸è¯¥è¶å¿å¯ä»¥éè¿æä¸ä¸ªç¡®å®
 *      çå½æ°æèå¤é¡¹å¼è¿è¡æåçæåµä¸ï¼éç¨æ³ååéæå¼æ³ã<br>
 * @param {Object} options - åæ°ã
 * @param {string} options.type - ååéæå¼çç±»åã
 * @param {(SuperMap.Bounds|L.Bounds|L.LatLngBounds|ol.extent|mapboxgl.LngLatBounds|GeoJSONObject)} options.bounds - æå¼åæçèå´ï¼ç¨äºç¡®å®ç»ææ æ ¼æ°æ®éçèå´ã
 * @param {string} options.searchMode - æå¼è¿ç®æ¶ï¼æ¥æ¾åä¸è¿ç®ç¹çæ¹å¼ï¼æåºå®ç¹æ°æ¥æ¾ãå®é¿æ¥æ¾ãåæ¥æ¾ã
 * @param {string} options.outputDatasetName - æå¼åæç»ææ°æ®éçåç§°ã
 * @param {string} options.outputDatasourceName - æå¼åæç»ææ°æ®æºçåç§°ã
 * @param {string} [options.zValueFieldName] - å­å¨ç¨äºè¿è¡æå¼åæçå­æ®µåç§°ï¼æå¼åæä¸æ¯æææ¬ç±»åçå­æ®µãå½æå¼åæç±»å(InterpolationAnalystParameters.prototype.InterpolationAnalystType)ä¸º dataset æ¶ï¼æ­¤ä¸ºå¿éåæ°ã
 * @param {number} [options.mean] - ãç®åååéãç±»åä¸ï¼æå¼å­æ®µçå¹³åå¼ã
 * @param {number} [options.angle=0] - ååéç®æ³ä¸­æè½¬è§åº¦å¼ã
 * @param {number} [options.nugget=0] - ååéç®æ³ä¸­åéæåºå¼ã
 * @param {number} [options.range=0] - ååéç®æ³ä¸­èªç¸å³éå¼ï¼åä½ä¸åæ°æ®éåä½ç¸åã
 * @param {number} [options.sill=0] - ååéç®æ³ä¸­åºå°å¼ã
 * @param {string} [options.variogramMode="SPHERICAL"] - ååéæå¼æ¶çååå½æ°ç±»åã
 * @param {string} [options.exponent='exp1'] - ãæ³ååéãç±»åä¸ï¼ç¨äºæå¼çæ ·ç¹æ°æ®ä¸­è¶å¿é¢æ¹ç¨çé¶æ°ï¼å¯éå¼ä¸º exp1ãexp2ã
 * @param {number} [options.expectedCount=12] - ãåºå®ç¹æ°æ¥æ¾ãæ¹å¼ä¸ï¼è®¾ç½®å¾æ¥æ¾çç¹æ°ï¼ãå®é¿æ¥æ¾ãæ¹å¼ä¸ï¼è®¾ç½®æ¥æ¾çæå°ç¹æ°ã
 * @param {number} [options.searchRadius=0] - ãå®é¿æ¥æ¾ãæ¹å¼ä¸ï¼è®¾ç½®åä¸è¿ç®ç¹çæ¥æ¾èå´ã
 * @param {number} [options.maxPointCountForInterpolation=200] - ãåæ¥æ¾ãæ¹å¼ä¸ï¼è®¾ç½®æå¤åä¸æå¼çç¹æ°ã
 * @param {number} [options.maxPointCountInNode=50] - ãåæ¥æ¾ãæ¹å¼ä¸ï¼è®¾ç½®åä¸ªååæå¤åä¸è¿ç®ç¹æ°ã
 * @param {number} [options.zValueScale=1] - ç¨äºè¿è¡æå¼åæå¼çç¼©æ¾æ¯çã
 * @param {number} [options.resolution] - æå¼ç»ææ æ ¼æ°æ®éçåè¾¨çï¼å³ä¸ä¸ªååæä»£è¡¨çå®å°è·ç¦»ï¼ä¸ç¹æ°æ®éåä½ç¸åã
 * @param {FilterParameter} [options.filterQueryParameter] - å±æ§è¿æ»¤æ¡ä»¶ã
 * @param {string} [options.pixelFormat] - æå®ç»ææ æ ¼æ°æ®éå­å¨çåç´ æ ¼å¼ã
 * @param {string} [options.dataset] - è¦ç¨æ¥åæå¼åæçæ°æ®æºä¸­æ°æ®éçåç§°ãè¯¥åç§°ç¨å½¢å¦ âæ°æ®éåç§°@æ°æ®æºå«åâ å½¢å¼æ¥è¡¨ç¤ºãå½æå¼åæç±»åï¼InterpolationAnalystParameters.prototype.InterpolationAnalystTypeï¼ä¸º dataset æ¶ã
 * @param {Array.<GeometryPoint|L.LatLng|L.Point|ol.geom.Point|mapboxgl.LngLat|Array.<number>>} [options.inputPoints] - ç¨äºåæå¼åæçç¦»æ£ç¹éåãå½æå¼åæç±»åï¼InterpolationAnalystParameters.prototype.InterpolationAnalystTypeï¼ä¸º geometry æ¶ã
 * @extends {InterpolationAnalystParameters}
 * @example ä¾å¦ï¼
 * var myInterpolationKrigingAnalystParameters = new InterpolationKrigingAnalystParameters({
 *     dataset:"SamplesP@Interpolation",
 *     type: "KRIGING",
 *     angle: 0,
 *     mean: 5,
 *     nugget: 30,
 *     range: 50,
 *     sill: 300,
 *     variogramMode: "EXPONENTIAL",
 *     searchMode: "QUADTREE",
 *     maxPointCountForInterpolation: 20,
 *     maxPointCountInNode: 5,
 *     pixelFormat: "BIT16",
 *     zValueFieldName: "AVG_TMP",
 *     resolution: 30000,
 *     filterQueryParameter: {
 *         attributeFilter: ""
 *     },
 *     outputDatasetName: "myKriging"
 * });
 * @usage
 */
class InterpolationKrigingAnalystParameters extends InterpolationAnalystParameters {

    constructor(options) {
        super(options);
        /**
         * @member {InterpolationAlgorithmType} InterpolationKrigingAnalystParameters.prototype.type
         * @description ååéæå¼çç±»åã
         * å·ä½å¦ä¸ï¼<br>
         * {KRIGING} æ®éååéæå¼æ³ã
         * {SimpleKriging} ç®åååéæå¼æ³ã
         * {UniversalKriging} æ³ååéæå¼æ³ã
         */
        this.type = null;

        /**
         * @member {number} InterpolationKrigingAnalystParameters.prototype.mean
         * @description ãç®åååéãæ¹å¼ä¸ï¼æå¼å­æ®µçå¹³åå¼ã
         * å³éæ ·ç¹æå¼å­æ®µå¼æ»åé¤ä»¥éæ ·ç¹æ°ç®ã
         */
        this.mean = null;

        /**
         * @member {number} [InterpolationKrigingAnalystParameters.prototype.angle=0]
         * @description ååéç®æ³ä¸­æè½¬è§åº¦å¼ã
         * æ­¤è§åº¦å¼æç¤ºäºæ¯ä¸ªæ¥æ¾é»åç¸å¯¹äºæ°´å¹³æ¹åéæ¶éæè½¬çè§åº¦ã
         */
        this.angle = 0;

        /**
         * @member {number} [InterpolationKrigingAnalystParameters.prototype.nugget=0]
         * @description ååéç®æ³ä¸­åéæåºå¼ã
         */
        this.nugget = 0;

        /**
         * @member {number} [InterpolationKrigingAnalystParameters.prototype.range=0]
         * @description ååéç®æ³ä¸­èªç¸å³éå¼ï¼åä½ä¸åæ°æ®éåä½ç¸åã
         */
        this.range = 0;

        /**
         * @member {number} [InterpolationKrigingAnalystParameters.prototype.sill=0]
         * @description ååéç®æ³ä¸­åºå°å¼ã
         */
        this.sill = 0;

        /**
         * @member {VariogramMode} [InterpolationKrigingAnalystParameters.prototype.variogramMode=VariogramMode.SPHERICAL]
         * @description ååéæå¼æ¶çååå½æ°ç±»åã
         * ç¨æ·æéæ©çååå½æ°ç±»åä¼å½±åæªç¥ç¹çé¢æµï¼ç¹å«æ¯æ²çº¿å¨åç¹å¤çä¸åå½¢ç¶æéè¦æä¹ã
         * æ²çº¿å¨åç¹å¤è¶é¡ï¼åè¾è¿é¢åå¯¹è¯¥é¢æµå¼çå½±åå°±è¶å¤§ï¼å æ­¤è¾åºè¡¨é¢å°±ä¼è¶ä¸åæ»ã
         */
        this.variogramMode = VariogramMode.SPHERICAL;

        /**
         * @member {Exponent} [InterpolationKrigingAnalystParameters.prototype.exponent=Exponent.EXP1]
         * @description ãæ³ååéãç±»åä¸ï¼ç¨äºæå¼çæ ·ç¹æ°æ®ä¸­è¶å¿é¢æ¹ç¨çé¶æ°ã
         */
        this.exponent = Exponent.EXP1;

        /**
         * @member {SearchMode} InterpolationKrigingAnalystParameters.prototype.searchMode
         * @description æå¼è¿ç®æ¶ï¼æ¥æ¾åä¸è¿ç®ç¹çæ¹å¼ï¼æåºå®ç¹æ°æ¥æ¾ãå®é¿æ¥æ¾ãåæ¥æ¾ãæ­¤ä¸ºå¿éåæ°ã
         * ç®åååéåæ³ååéä¸æ¯æåæ¥æ¾ã
         * å·ä½å¦ä¸ï¼<br>
         * {KDTREE_FIXED_COUNT} ä½¿ç¨ KDTREE çåºå®ç¹æ°æ¹å¼æ¥æ¾åä¸åæåæçç¹ã<br>
         * {KDTREE_FIXED_RADIUS} ä½¿ç¨ KDTREE çå®é¿æ¹å¼æ¥æ¾åä¸åæåæçç¹ã<br>
         * {QUADTREE} ä½¿ç¨ QUADTREE æ¹å¼æ¥æ¾åä¸åæåæçç¹ï¼åæ¥æ¾ï¼ã
         */
        this.searchMode = null;

        /**
         * @member {number} [InterpolationKrigingAnalystParameters.prototype.expectedCount=12]
         * @description ãåºå®ç¹æ°æ¥æ¾ãæ¹å¼ä¸ï¼è®¾ç½®å¾æ¥æ¾çç¹æ°ï¼å³åä¸å·®å¼è¿ç®çç¹æ°ï¼é»è®¤å¼ä¸º12ã
         * ãå®é¿æ¥æ¾ãæ¹å¼ä¸ï¼è®¾ç½®æ¥æ¾çæå°ç¹æ°ï¼é»è®¤å¼ä¸º12ã
         */
        this.expectedCount = 12;

        /**
         * @member {number} [InterpolationKrigingAnalystParameters.prototype.maxPointCountForInterpolation=200]
         * @description ãåæ¥æ¾ãæ¹å¼ä¸ï¼æå¤åä¸æå¼çç¹æ°ã
         * ä»ç¨äºæ®éååéæå¼ï¼ç®åååéåæ³ååéä¸æ¯æåæ¥æ¾ã
         */
        this.maxPointCountForInterpolation = 200;

        /**
         * @member {number} [InterpolationKrigingAnalystParameters.prototype.maxPointCountInNode=50]
         * @description ãåæ¥æ¾ãæ¹å¼ä¸ï¼è®¾ç½®åä¸ªååæå¤åä¸è¿ç®ç¹æ°ã
         * ä»ç¨äºæ®éååéæå¼ï¼ç®åååéåæ³ååéä¸æ¯æåæ¥æ¾ã
         */
        this.maxPointCountInNode = 50;
        if (options) {
            Util.extend(this, options);
        }
        this.CLASS_NAME = "SuperMap.InterpolationKrigingAnalystParameters";
    }

    /**
     * @function InterpolationKrigingAnalystParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        super.destroy();
        var me = this;
        me.type = null;
        me.mean = null;
        me.angle = null;
        me.nugget = null;
        me.range = null;
        me.sill = null;
        me.variogramMode = null;
        me.exponent = null;
        me.searchMode = null;
        me.expectedCount = null;
        me.maxPointCountForInterpolation = null;
        me.maxPointCountInNode = null;
    }
}

;// CONCATENATED MODULE: ./src/common/iServer/InterpolationAnalystService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/








/**
 * @class InterpolationAnalystService
 * @deprecatedclass SuperMap.InterpolationAnalystService
 * @category iServer SpatialAnalyst InterpolationAnalyst
 * @classdesc æå¼åææå¡ç±»ã
 * æå¼åæå¯ä»¥å°æéçéæ ·ç¹æ°æ®ï¼éè¿æå¼ç®æ³å¯¹éæ ·ç¹å¨å´çæ°å¼æåµè¿è¡é¢æµï¼å¯ä»¥ææ¡ç ç©¶åºååæ°æ®çæ»ä½åå¸ç¶åµï¼ä»èä½¿éæ ·çç¦»æ£ç¹ä¸ä»ä»åæ å¶æå¨ä½ç½®çæ°å¼æåµï¼
 * è¿å¯ä»¥åæ åºåçæ°å¼åå¸ãç®åSuperMap iServerçæå¼åè½æä¾ä»ç¹æ°æ®éæå¼å¾å°æ æ ¼æ°æ®éçåè½ï¼æ¯æä»¥ä¸å¸¸ç¨çåææ¹æ³ï¼
 * åæ¬ï¼åè·ç¦»å ææå¼ãååéï¼Krigingï¼æå¼æ³ãæ ·æ¡ï¼å¾ååºå½æ°ï¼Radial Basis Functionï¼æå¼ãç¹å¯åº¦æå¼ã
 * @param {string} url - æå¡å°åãå¦ http://localhost:8090/iserver/services/spatialanalyst-changchun/restjsr/spatialanalystã
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - éè¦è¢«æ³¨åççå¬å¨å¯¹è±¡ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @extends {SpatialAnalystBase}
 * @example ä¾å¦ï¼
 * (start code)
 * var myTInterpolationAnalystService = new InterpolationAnalystService(url);
 * myTInterpolationAnalystService.events.on({
     *     "processCompleted": processCompleted,
     *     "processFailed": processFailed
     *     }
 * );
 * (end)
 * @usage
 */
class InterpolationAnalystService extends SpatialAnalystBase {


    constructor(url, options) {
        super(url, options);
        /**
         * @member {string} InterpolationAnalystService.prototype.mode
         * @description æå¼åæç±»åã
         */

        this.mode = null;
        if (options) {
            Util.extend(this, options);
        }
    }

    /**
     * @function InterpolationAnalystService.prototype.destroy
     * @description éæ¾èµæº,å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        super.destroy();
        this.mode = null;
        this.CLASS_NAME = "SuperMap.InterpolationAnalystService";
    }

    /**
     * @function InterpolationAnalystService.prototype.processAsync
     * @description è´è´£å°å®¢æ·ç«¯çæ¥è¯¢åæ°ä¼ éå°æå¡ç«¯ã
     * @param {InterpolationDensityAnalystParameters|InterpolationIDWAnalystParameters|InterpolationRBFAnalystParameters|InterpolationKrigingAnalystParameters} parameter - æå¼åæåæ°ç±»ã
     */
    processAsync(parameter) {
        var parameterObject = {};
        var me = this;

        if (parameter instanceof InterpolationDensityAnalystParameters) {
            me.mode = 'Density';
            if (parameter.InterpolationAnalystType === 'geometry') {
                me.url = Util.urlPathAppend(me.url, 'geometry/interpolation/density');
            } else {
                me.url = Util.urlPathAppend(me.url, 'datasets/' + parameter.dataset + '/interpolation/density');
            }
        } else if (parameter instanceof InterpolationIDWAnalystParameters) {
            me.mode = 'IDW';
            if (parameter.InterpolationAnalystType === 'geometry') {
                me.url = Util.urlPathAppend(me.url, 'geometry/interpolation/idw');
            } else {
                me.url = Util.urlPathAppend(me.url, 'datasets/' + parameter.dataset + '/interpolation/idw');
            }
        } else if (parameter instanceof InterpolationRBFAnalystParameters) {
            me.mode = 'RBF';
            if (parameter.InterpolationAnalystType === 'geometry') {
                me.url = Util.urlPathAppend(me.url, 'geometry/interpolation/rbf');
            } else {
                me.url = Util.urlPathAppend(me.url, 'datasets/' + parameter.dataset + '/interpolation/rbf');
            }
        } else if (parameter instanceof InterpolationKrigingAnalystParameters) {
            me.mode = 'Kriging';
            if (parameter.InterpolationAnalystType === 'geometry') {
                me.url = Util.urlPathAppend(me.url, 'geometry/interpolation/kriging');
            } else {
                me.url = Util.urlPathAppend(me.url, 'datasets/' + parameter.dataset + '/interpolation/kriging');
            }
        }
        InterpolationAnalystParameters.toObject(parameter, parameterObject);
        var jsonParameters = Util.toJSON(parameterObject);
        me.url = Util.urlAppend(me.url, 'returnContent=true');

        me.request({
            method: "POST",
            data: jsonParameters,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }
}

;// CONCATENATED MODULE: ./src/common/iServer/KernelDensityJobParameter.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/






/**
 * @class KernelDensityJobParameter
 * @deprecatedclass SuperMap.KernelDensityJobParameter
 * @category iServer ProcessingService DensityAnalyst
 * @classdesc æ ¸å¯åº¦åææå¡åæ°ç±»ã
 * @param {Object} options - åæ°ã
 * @param {string} options.datasetName - æ°æ®éåã
 * @param {string} options.fields - æéç´¢å¼ã
 * @param {(SuperMap.Bounds|L.Bounds|L.LatLngBounds|ol.extent|mapboxgl.LngLatBounds|GeoJSONObject)} [options.query] - åæèå´ï¼é»è®¤ä¸ºå¨å¾èå´ï¼ã
 * @param {number} [options.resolution=80] - åè¾¨çã
 * @param {number} [options.method=0] - åææ¹æ³ã
 * @param {number} [options.meshType=0] - åæç±»åã
 * @param {number} [options.radius=300] - åæçå½±ååå¾ã
 * @param {OutputSetting} [options.output] - è¾åºåæ°è®¾ç½®ã
 * @param {MappingParameters} [options.mappingParameters] - åæåç»æå¯è§åçåæ°ç±»ã
 * @usage
 */
class KernelDensityJobParameter {

    constructor(options) {
        if (!options) {
            return;
        }
        /**
         * @member {string} KernelDensityJobParameter.prototype.datasetName
         * @description æ°æ®éåã
         */
        this.datasetName = "";

        /**
         * @member {SuperMap.Bounds|L.Bounds|L.LatLngBounds|ol.extent|mapboxgl.LngLatBounds|GeoJSONObject} [KernelDensityJobParameter.prototype.query]
         * @description åæèå´ã
         */
        this.query = "";

        /**
         * @member {number} [KernelDensityJobParameter.prototype.resolution=80]
         * @description ç½æ ¼å¤§å°ã
         */
        this.resolution = 80;

        /**
         * @member {number} [KernelDensityJobParameter.prototype.method=0]
         * @description åææ¹æ³ã
         */
        this.method = 0;

        /**
         * @member {number} [KernelDensityJobParameter.prototype.meshType=0]
         * @description åæç±»åã
         */
        this.meshType = 0;

        /**
         * @member {string} KernelDensityJobParameter.prototype.fields
         * @description æéç´¢å¼ã
         */
        this.fields = "";

        /**
         * @member {number} [KernelDensityJobParameter.prototype.radius=300]
         * @description åæçå½±ååå¾ã
         */
        this.radius = 300;

        /**
         * @member {AnalystSizeUnit} [KernelDensityJobParameter.prototype.meshSizeUnit=AnalystSizeUnit.METER]
         * @description ç½æ ¼å¤§å°åä½ã
         */
        this.meshSizeUnit = AnalystSizeUnit.METER;

        /**
         * @member {AnalystSizeUnit} [KernelDensityJobParameter.prototype.radiusUnit=AnalystSizeUnit.METER]
         * @description æç´¢åå¾åä½ã
         */
        this.radiusUnit = AnalystSizeUnit.METER;

        /**
         * @member {AnalystAreaUnit} [KernelDensityJobParameter.prototype.areaUnit=AnalystAreaUnit.SQUAREMILE]
         * @description é¢ç§¯åä½ã
         */
        this.areaUnit = AnalystAreaUnit.SQUAREMILE;

        /**
         * @member {OutputSetting} KernelDensityJobParameter.prototype.output
         * @description è¾åºåæ°è®¾ç½®ç±»
         */
        this.output = null;

        /**
         * @member {MappingParameters} [KernelDensityJobParameter.prototype.mappingParameters]
         * @description åæåç»æå¯è§åçåæ°ç±»ã
         */
        this.mappingParameters = null;

        Util.extend(this, options);

        this.CLASS_NAME = "SuperMap.KernelDensityJobParameter";
    }

    /**
     * @function KernelDensityJobParameter.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        this.datasetName = null;
        this.query = null;
        this.resolution = null;
        this.method = null;
        this.radius = null;
        this.meshType = null;
        this.fields = null;
        this.meshSizeUnit = null;
        this.radiusUnit = null;
        this.areaUnit = null;
        if (this.output instanceof OutputSetting) {
            this.output.destroy();
            this.output = null;
        }
        if (this.mappingParameters instanceof MappingParameters) {
            this.mappingParameters.destroy();
            this.mappingParameters = null;
        }
    }

    /**
     * @function KernelDensityJobParameter.toObject
     * @param {KernelDensityJobParameter} kernelDensityJobParameter - æ ¸å¯åº¦åææå¡åæ°ç±»ã
     * @param {KernelDensityJobParameter} tempObj - æ ¸å¯åº¦åææå¡åæ°å¯¹è±¡ã
     * @description å°æ ¸å¯åº¦åææå¡åæ°å¯¹è±¡è½¬æ¢ä¸º JSON å¯¹è±¡ã
     * @returns JSON å¯¹è±¡ã
     */
    static toObject(kernelDensityJobParameter, tempObj) {
        for (var name in kernelDensityJobParameter) {
            if (name === "datasetName") {
                tempObj['input'] = tempObj['input'] || {};
                tempObj['input'][name] = kernelDensityJobParameter[name];
                continue;
            }
            if (name === "output") {
                tempObj['output'] = tempObj['output'] || {};
                tempObj['output'] = kernelDensityJobParameter[name];
                continue;
            }

            tempObj['analyst'] = tempObj['analyst'] || {};
            if (name === 'query' && kernelDensityJobParameter[name]) {
                tempObj['analyst'][name] = kernelDensityJobParameter[name].toBBOX();
            } else {
                tempObj['analyst'][name] = kernelDensityJobParameter[name];
            }
            if (name === 'mappingParameters') {
                tempObj['analyst'][name] = tempObj['analyst'][name] || {};
                tempObj['analyst']['mappingParameters'] = kernelDensityJobParameter[name];
            }
        }
    }
}

;// CONCATENATED MODULE: ./src/common/iServer/KernelDensityJobsService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class KernelDensityJobsService
 * @deprecatedclass SuperMap.KernelDensityJobsService
 * @category  iServer ProcessingService DensityAnalyst
 * @classdesc æ ¸å¯åº¦åææå¡ç±»
 * @extends {ProcessingServiceBase}
 * @param {string} url - æå¡å°åã
 * @param {Object} options - å¯éåæ°ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class KernelDensityJobsService extends ProcessingServiceBase {

    constructor(url, options) {
        super(url, options);
        this.url = Util.urlPathAppend(this.url, 'spatialanalyst/density');
        this.CLASS_NAME = "SuperMap.KernelDensityJobsService";
    }

    /**
     * @function KernelDensityJobsService.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function KernelDensityJobsService.prototype.getKernelDensityJobs
     * @description è·åæ ¸å¯åº¦åæä»»å¡
     */
    getKernelDensityJobs() {
        super.getJobs(this.url);
    }

    /**
     * @function KernelDensityJobsService.prototype.getKernelDensityJobs
     * @description è·åæå®idçæ ¸å¯åº¦åææå¡
     * @param {string} id - æå®è¦è·åæ°æ®çid
     */
    getKernelDensityJob(id) {
        super.getJobs(Util.urlPathAppend(this.url, id));
    }

    /**
     * @function KernelDensityJobsService.prototype.addKernelDensityJob
     * @description æ°å»ºæ ¸å¯åº¦åææå¡
     * @param {KernelDensityJobParameter} params - æ ¸å¯åº¦åææå¡åæ°ç±»ã
     * @param {number} seconds - å¼å§åå»ºåï¼è·ååå»ºæåç»æçæ¶é´é´éã
     */
    addKernelDensityJob(params, seconds) {
        super.addJob(this.url, params, KernelDensityJobParameter, seconds);
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/LabelMatrixCell.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/

/**
 * @class LabelMatrixCell
 * @deprecatedclass SuperMap.LabelMatrixCell
 * @category iServer Map Theme
 * @classdesc ç©éµæ ç­¾åç´ æ½è±¡ç±»ãè¯¥ç±»å¯ä»¥åå« n*n ä¸ªç©éµæ ç­¾åç´ ï¼ç©éµæ ç­¾åç´ çç±»åå¯ä»¥æ¯å¾çï¼ç¬¦å·ï¼æ ç­¾ä¸é¢å¾ç­ã
 *            ç¬¦å·ç±»åçç©éµæ ç­¾åç´ ç±»ãå¾çç±»åçç©éµæ ç­¾åç´ ç±»åä¸é¢å¾ç±»åçç©éµæ ç­¾åç´ ç±»åç»§æ¿èªè¯¥ç±»ã
 * @usage
 */
class LabelMatrixCell {
    constructor() {
        this.CLASS_NAME = "LabelMatrixCell";
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/LabelImageCell.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class LabelImageCell
 * @deprecatedclass SuperMap.LabelImageCell
 * @category iServer Map Theme
 * @classdesc å¾çç±»åçç©éµæ ç­¾åç´ ç±»ãè¯¥ç±»ç»§æ¿èª {@link LabelMatrixCell}ç±»ï¼ä¸»è¦å¯¹ç©éµæ ç­¾ä¸­çä¸é¢å¾ç±»åçç©éµæ ç­¾åç´ è¿è¡è®¾ç½®ã
 * ç©éµæ ç­¾ä¸é¢å¾æ¯æ ç­¾ä¸é¢å¾ï¼ThemeLabelï¼çä¸ç§ï¼å¶ä¸­ç©éµæ ç­¾ä¸­çå¡«ååç´ åå¯åä¸ºå¾çç±»åï¼{@link LabelImageCell}ï¼ã
 * ç¬¦å·ç±»åï¼{@link LabelSymbolCell}ï¼ãä¸é¢å¾ç±»åï¼{@link LabelThemeCell}ï¼ä¸ç§ï¼è¯¥ç±»æ¯è¿ä¸ç§ç±»åçç©éµæ ç­¾åç´ å¶ä¸­çä¸ç§ï¼
 * ç¨äºå®ä¹ç¬¦å·ç±»åçç©éµæ ç­¾ï¼å¦ç¬¦å· ID å­æ®µåç§°ï¼ç¬¦å· ID ä¸ SuperMap æ¡é¢äº§åä¸­ç¹ãçº¿ãé¢ç¬¦å·ç ID å¯¹åºï¼ ãå¤§å°ç­ã
 * ç¨æ·å¨å®ç°ç©éµæ ç­¾ä¸é¢å¾æ¶åªéå°å®ä¹å¥½çç©éµæ ç­¾åç´ èµå¼äº {@link ThemeLabel#matrixCells} å±æ§å³å¯ãmatrixCells æ¯ä¸ä¸ªäºç»´æ°ç»ï¼
 * æ¯ä¸ç»´å¯ä»¥æ¯ä»»æç±»åçç©éµæ ç­¾åç´ ç»æçæ°ç»ï¼ä¹å¯æ¯åä¸ªæ ç­¾åç´ ç»æçæ°ç»ï¼å³æ°ç»ä¸­åªæä¸ä¸ªåç´ ï¼ã
 * @extends {LabelMatrixCell}
 * @param {Object} options - å¯éåæ°ã
 * @param {number} [options.height=0] - è®¾ç½®å¾ççé«åº¦ï¼åä½ä¸ºæ¯«ç±³ã
 * @param {string} [options.pathField] - è®¾ç½®ç©éµæ ç­¾åç´ æä½¿ç¨å¾ççè·¯å¾ã
 * @param {number} [options.rotation=0.0] - å¾ççæè½¬è§åº¦ãéæ¶éæ¹åä¸ºæ­£æ¹åï¼åä½ä¸ºåº¦ï¼ç²¾ç¡®å°0.1åº¦ã
 * @param {number} [options.width=0] - è®¾ç½®å¾ççå®½åº¦ï¼åä½ä¸ºæ¯«ç±³ã
 * @param {boolean} [options.sizeFixed=false] - æ¯å¦åºå®å¾ççå¤§å°ã
 * @usage
 */
class LabelImageCell extends LabelMatrixCell {

    constructor(options) {
        super(options);
        /**
         * @member {number} LabelImageCell.prototype.height
         * @description è®¾ç½®å¾ççé«åº¦ï¼åä½ä¸ºæ¯«ç±³ã
         */
        this.height = 0;

        /**
         * @member {string} LabelImageCell.prototype.pathField
         * @description è®¾ç½®ç©éµæ ç­¾åç´ æä½¿ç¨çå¾çè·¯å¾å¯¹åºçå­æ®µåã
         */
        this.pathField = null;

        /**
         * @member {number} [LabelImageCell.prototype.rotation=0.0]
         * @description å¾ççæè½¬è§åº¦ãéæ¶éæ¹åä¸ºæ­£æ¹åï¼åä½ä¸ºåº¦ï¼ç²¾ç¡®å°0.1åº¦ã
         */
        this.rotation = 0.0;

        /**
         * @member {number} LabelImageCell.prototype.width
         * @description è®¾ç½®å¾ççå®½åº¦ï¼åä½ä¸ºæ¯«ç±³ã
         */
        this.width = 0;

        /**
         * @member {boolean} [LabelImageCell.prototype.sizeFixed=false]
         * @description æ¯å¦åºå®å¾ççå¤§å°ã
         */
        this.sizeFixed = false;

        /**
         * @member {string} LabelImageCell.prototype.type
         * @description å¶ä½ç©éµä¸é¢å¾æ¶æ¯å¿é¡»çã
         */
        this.type = "IMAGE";

        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = "SuperMap.LabelImageCell";
    }

    /**
     * @function LabelImageCell.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.height = null;
        me.pathField = null;
        me.rotation = null;
        me.width = null;
        me.sizeFixed = null;
    }
}

;// CONCATENATED MODULE: ./src/common/iServer/LabelSymbolCell.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class LabelSymbolCell
 * @deprecatedclass SuperMap.LabelSymbolCell
 * @category  iServer Map Theme
 * @classdesc ç¬¦å·ç±»åçç©éµæ ç­¾åç´ ç±»ã
 * è¯¥ç±»ç»§æ¿èª {@link LabelMatrixCell}ç±»ï¼ä¸»è¦å¯¹ç©éµæ ç­¾ä¸­çä¸é¢å¾ç±»åçç©éµæ ç­¾åç´ è¿è¡è®¾ç½®ã
 * ç©éµæ ç­¾ä¸é¢å¾æ¯æ ç­¾ä¸é¢å¾ï¼{@link ThemeLabel}ï¼çä¸ç§ï¼å¶ä¸­ç©éµæ ç­¾ä¸­çå¡«ååç´ åå¯åä¸ºå¾çç±»åï¼{@link LabelImageCell}ï¼ã
 * ç¬¦å·ç±»åï¼{@link LabelSymbolCell}ï¼ãä¸é¢å¾ç±»åï¼{@link LabelThemeCell}ï¼ä¸ç§ï¼è¯¥ç±»æ¯è¿ä¸ç§ç±»åçç©éµæ ç­¾åç´ å¶ä¸­çä¸ç§ï¼
 * ç¨äºå®ä¹ç¬¦å·ç±»åçç©éµæ ç­¾ï¼å¦ç¬¦å· ID å­æ®µåç§°ï¼ç¬¦å· ID ä¸ SuperMap æ¡é¢äº§åä¸­ç¹ãçº¿ãé¢ç¬¦å·ç ID å¯¹åºï¼ ãå¤§å°ç­ã
 * ç¨æ·å¨å®ç°ç©éµæ ç­¾ä¸é¢å¾æ¶åªéå°å®ä¹å¥½çç©éµæ ç­¾åç´ èµå¼äº {@link ThemeLabel#matrixCells} å±æ§å³å¯ãmatrixCells å±æ¯ä¸ä¸ªäºç»´æ°ç»ï¼
 * æ¯ä¸ç»´å¯ä»¥æ¯ä»»æç±»åçç©éµæ ç­¾åç´ ç»æçæ°ç»ï¼ä¹å¯æ¯åä¸ªæ ç­¾åç´ ç»æçæ°ç»ï¼å³æ°ç»ä¸­åªæä¸ä¸ªåç´ ï¼ã
 * @extends {LabelMatrixCell}
 * @param {Object} options - åæ°ã
 * @param {ServerStyle} options.style - è·åæè®¾ç½®ç¬¦å·æ ·å¼ã
 * @param {string} options.symbolIDField - ç¬¦å· ID æç¬¦å· ID æå¯¹åºçå­æ®µåç§°ã
 * @usage
 */
class LabelSymbolCell extends LabelMatrixCell {

    constructor(options) {
        super(options);
        /**
         * @member {ServerStyle} LabelSymbolCell.prototype.style
         * @description è·åæè®¾ç½®ç¬¦å·æ ·å¼ââ {@link ServerStyle} å¯¹è±¡ï¼åæ¬ç¬¦å·å¤§å°ï¼{@link ServerStyle#markerSize}ï¼
         *              åç¬¦å·æè½¬ï¼{@link ServerStyle#markerAngle}ï¼è§åº¦ï¼å¶ä¸­ç¨äºè®¾ç½®ç¬¦å· ID çå±æ§ï¼{@link ServerStyle#markerSymbolID}ï¼å¨æ­¤å¤ä¸èµ·ä½ç¨ã
         */
        this.style = new ServerStyle();

        /**
         * @member {string} LabelSymbolCell.prototype.symbolIDField
         * @description è·åæè®¾ç½®ç¬¦å· ID æç¬¦å· ID æå¯¹åºçå­æ®µåç§°ã
         */
        this.symbolIDField = null;

        /**
         * @member {string} LabelSymbolCell.prototype.type
         * @description å¶ä½ç©éµä¸é¢å¾æ¶æ¯å¿é¡»çã
         */
        this.type = "SYMBOL";

        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = "SuperMap.LabelSymbolCell";
    }

    /**
     * @function LabelSymbolCell.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        if (me.style) {
            me.style.destroy();
            me.style = null;
        }
        me.symbolIDField = null;
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/LabelThemeCell.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class LabelThemeCell
 * @deprecatedclass SuperMap.LabelThemeCell
 * @category iServer Map Theme
 * @classdesc ä¸é¢å¾ç±»åçç©éµæ ç­¾åç´ ç±»ã
 * è¯¥ç±»ç»§æ¿èª {@link LabelMatrixCell} ç±»ï¼ä¸»è¦å¯¹ç©éµæ ç­¾ä¸­çä¸é¢å¾ç±»åçç©éµæ ç­¾åç´ è¿è¡è®¾ç½®ã
 *              ç©éµæ ç­¾ä¸é¢å¾æ¯æ ç­¾ä¸é¢å¾ï¼{@link ThemeLabel}ï¼çä¸ç§ï¼å¶ä¸­ç©éµæ ç­¾ä¸­çå¡«ååç´ åå¯åä¸ºå¾çç±»åï¼{@link LabelImageCell}ï¼ã
 *              ç¬¦å·ç±»åï¼{@link LabelSymbolCell}ï¼ãä¸é¢å¾ç±»åï¼{@link LabelThemeCell}ï¼ä¸ç§ï¼è¯¥ç±»æ¯è¿ä¸ç§ç±»åçç©éµæ ç­¾åç´ å¶ä¸­çä¸ç§ï¼
 *              ç¨äºå®ä¹ç¬¦å·ç±»åçç©éµæ ç­¾ï¼å¦ç¬¦å· ID å­æ®µåç§°ï¼ç¬¦å· ID ä¸ SuperMap æ¡é¢äº§åä¸­ç¹ãçº¿ãé¢ç¬¦å·ç ID å¯¹åºï¼ ãå¤§å°ç­ã
 *              ç¨æ·å¨å®ç°ç©éµæ ç­¾ä¸é¢å¾æ¶åªéå°å®ä¹å¥½çç©éµæ ç­¾åç´ èµå¼äº {@link ThemeLabel#matrixCells} å±æ§å³å¯ãmatrixCells å±æ¯ä¸ä¸ªäºç»´æ°ç»ï¼
 *              æ¯ä¸ç»´å¯ä»¥æ¯ä»»æç±»åçç©éµæ ç­¾åç´ ç»æçæ°ç»ï¼ä¹å¯æ¯åä¸ªæ ç­¾åç´ ç»æçæ°ç»ï¼å³æ°ç»ä¸­åªæä¸ä¸ªåç´ ï¼ã
 * @extends {LabelMatrixCell}
 * @param {Object} options -åæ°ã
 * @param {ThemeLabel} options.themeLabel - ä½ä¸ºç©éµæ ç­¾åç´ çæ ç­¾ä¸é¢å¾ç±»ã
 * @usage
 */
class LabelThemeCell extends LabelMatrixCell {


    constructor(options) {
        super(options);
        /**
         * @member {ThemeLabel} LabelThemeCell.prototype.themeLabel
         * @description ä½¿ç¨ä¸é¢å¾å¯¹è±¡ä½ä¸ºç©éµæ ç­¾çä¸ä¸ªåç´ ã
         */
        this.themeLabel =  new ThemeLabel();

        /**
         * @member {string} LabelThemeCell.prototype.type
         * @description å¶ä½ç©éµä¸é¢å¾æ¶æ¯å¿é¡»çã
         */
        this.type = "THEME";

        if (options) {
            Util.extend(this, options);
        }
        this.CLASS_NAME = " SuperMap.LabelThemeCell";
    }

    /**
     * @function LabelThemeCell.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        if (me.themeLabel) {
            me.themeLabel.destroy();
            me.themeLabel = null;
        }
    }


}

;// CONCATENATED MODULE: ./src/common/iServer/LayerStatus.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class LayerStatus
 * @deprecatedclass SuperMap.LayerStatus
 * @category iServer Map TempLayersSet
 * @classdesc å­å¾å±æ¾ç¤ºåæ°ç±»ãè¯¥ç±»å­å¨äºåä¸ªå­å¾å±çåå­åæ¯å¦å¯è§çç¶æã
 * @param {Object} options - åæ°ã
 * @param {string} options.layerName - å¾å±åç§°ã
 * @param {boolean} [options.isVisible=true] - å¾å±æ¯å¦å¯è§ï¼true è¡¨ç¤ºå¯è§ã
 * @param {string} [options.displayFilter] - å¾å±æ¾ç¤º SQL è¿æ»¤æ¡ä»¶ã
 * @usage
 */
class LayerStatus {

    constructor(options) {
        /**
         * @member {string} LayerStatus.prototype.layerName
         * @description è·åæè®¾ç½®å¾å±åç§°ã
         */
        this.layerName = null;

        /**
         * @member {boolean} LayerStatus.prototype.isVisible
         * @description è·åæè®¾ç½®å¾å±æ¯å¦å¯è§ï¼true è¡¨ç¤ºå¯è§ã
         */
        this.isVisible = null;

        /**
         * @member {string} [LayerStatus.prototype.displayFilter]
         * @description å¾å±æ¾ç¤º SQL è¿æ»¤æ¡ä»¶ï¼å¦ layerStatus.displayFilter = "smid < 10"ï¼è¡¨ç¤ºä»æ¾ç¤º smid å¼å°äº 10 çå¯¹è±¡ã
         */
        this.displayFilter = null;

        /**
         * @member {Object} [LayerStatus.prototype.fieldValuesDisplayFilter]
         * @property {Array.<number>} values - è¦è¿æ»¤çå¼ã
         * @property {string} fieldName - è¦è¿æ»¤çå­æ®µåç§°åªæ¯ææ°å­ç±»åçå­æ®µã
         * @property {string} fieldValuesDisplayMode - ç®åæä¸¤ä¸ª DISPLAY/DISABLEãå½ä¸º DISPLAY æ¶ï¼è¡¨ç¤ºåªæ¾ç¤ºä»¥ä¸è®¾ç½®çç¸åºå±æ§å¼çè¦ç´ ï¼å¦åè¡¨ç¤ºä¸æ¾ç¤ºä»¥ä¸è®¾ç½®çç¸åºå±æ§å¼çè¦ç´ ã
         */

        this.fieldValuesDisplayFilter = null;

        if (options) {
            Util.extend(this, options);
        }
        this.CLASS_NAME = "SuperMap.LayerStatus";
    }

    /**
     * @function LayerStatus.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.layerName = null;
        me.isVisible = null;
        me.displayFilter = null;
    }


    /**
     * @function LayerStatus.prototype.toJSON
     * @description çæå¯¹åºç JSONã
     * @returns {Object} å¯¹åºç JSONã
     */
    toJSON() {
        var json = '{';
        json += '"type":"UGC",';
        var v = [];
        if (this.layerName) {
            v.push('"name":"' + this.layerName + '"');
            v.push('"visible":' + this.isVisible);
        }

        if (this.displayFilter) {
            v.push('"displayFilter":"' + this.displayFilter + '"');
        }

        if (this.minScale || this.minScale == 0) {
            v.push('"minScale":' + this.minScale);
        }

        if (this.maxScale || this.maxScale == 0) {
            v.push('"maxScale":' + this.maxScale);
        }

        if (this.fieldValuesDisplayFilter) {
            v.push('"fieldValuesDisplayFilter":' + Util.toJSON(this.fieldValuesDisplayFilter));
        }

        json += v;
        json += '}';

        return json;
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/LinkItem.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class LinkItem
 * @deprecatedclass SuperMap.LinkItem
 * @constructs LinkItem
 * @category iServer Data FeatureResults
 * @classdesc å³èä¿¡æ¯ç±»ãè¯¥ç±»ç¨äºç¢éæ°æ®éä¸å¤é¨è¡¨çå³èã å¤é¨è¡¨æ¯å¦ä¸ä¸ªæ°æ®éï¼å¶ä¸­çº¯å±æ§æ°æ®éä¸­æ²¡æç©ºé´å ä½ä¿¡æ¯ï¼ä¸­ç DBMS è¡¨,
 * ç¢éæ°æ®éä¸å¤é¨è¡¨å¯ä»¥å±äºä¸åçæ°æ®æºï¼ä½æ°æ®æºç±»åç®ååªæ¯æ SQL Server å Oracle ç±»åãä½¿ç¨ LinkItem æ¶ï¼
 * ç©ºé´æ°æ®åå±æ§æ°æ®å¿é¡»æ»¡è¶³å³èæ¡ä»¶ï¼å³ä¸»ç©ºé´æ°æ®éä¸å¤é¨å±æ§è¡¨ä¹é´å­å¨å³èå­æ®µã{@link LinkItem}
 * åªæ¯æå·¦è¿æ¥ï¼UDBãPostgreSQL å DB2 æ°æ®æºä¸æ¯æ {@link LinkItem}ï¼å¦å¤ï¼ç¨äºå»ºç«å³èå³ç³»çä¸¤ä¸ªè¡¨å¯ä»¥ä¸å¨åä¸ä¸ªæ°æ®æºä¸ãæ³¨æï¼<br>
 * 1.ä½¿ç¨ {@link LinkItem} ççº¦ææ¡ä»¶ä¸ºï¼ç©ºé´æ°æ®åå±æ§æ°æ®å¿é¡»æå³èæ¡ä»¶ï¼å³ä¸»ç©ºé´æ°æ®éä¸å¤é¨å±æ§è¡¨ä¹é´å­å¨å³èå­æ®µï¼<br>
 * 2.ä½¿ç¨å¤å³èè¡¨å¶ä½ä¸é¢å¾æ¶ï¼æå³èçå­æ®µå¿é¡»è®¾ç½®è¡¨åï¼ä¾å¦ï¼å¦ææå³èçå­æ®µä¸º BaseMap_R æ°æ®éç SmIDï¼å°±è¦åæ BaseMap_R.SMIDã
 * @param {Object} options - åæ°ã
 * @param {DatasourceConnectionInfo} options.datasourceConnectionInfo - å³èçå¤é¨æ°æ®æºä¿¡æ¯ã
 * @param {Array.<string>} options.foreignKeys - ä¸»ç©ºé´æ°æ®éçå¤é®ã
 * @param {string} options.foreignTable - å³èçå¤é¨å±æ§è¡¨çåç§°ã
 * @param {Array.<string>} options.linkFields - æ¬²ä¿ççå¤é¨å±æ§è¡¨çå­æ®µã
 * @param {string} options.linkFilter - ä¸å¤é¨å±æ§è¡¨çè¿æ¥æ¡ä»¶ã
 * @param {string} options.name - æ­¤å³èä¿¡æ¯å¯¹è±¡çåç§°ã
 * @param {Array.<string>} options.primaryKeys - å³èçå¤é¨å±æ§è¡¨çä¸»é®ã
 * @example ä¸é¢ä»¥ SQL æ¥è¯¢è¯´æ linkitem çä½¿ç¨æ¹æ³ï¼
 *  function queryBySQL() {
 *      // è®¾ç½®å³èçå¤é¨æ°æ®åºä¿¡æ¯,aliasè¡¨ç¤ºæ°æ®åºå«å
 *      var dc = new DatasourceConnectionInfo({
 *          dataBase: "RelQuery",
 *          server: "{ip}:{port}",
 *          user: "sa",
 *          password: "map",
 *          driver: "SQL Server",
 *          connect: true,
 *          OpenLinkTable: false,
 *          alias: "RelQuery",
 *          engineType: EngineType.SQLPLUS,
 *          readOnly: false,
 *          exclusive: false
 *      });
 *     // è®¾ç½®å³èä¿¡æ¯
 *      var linkItem = new LinkItem({
 *          datasourceConnectionInfo: dc,
 *          foreignKeys: ["name"],
 *          foreignTable: "Pop_2011",
 *          linkFields: ["SmID as Pid","pop"],
 *          name: "link",
 *          primatryKeys: ["name"],
 *      });
 *      // è®¾ç½®æ¥è¯¢åæ°ï¼å¨æ¥è¯¢åæ°ä¸­æ·»å linkItemå³èæ¡ä»¶ä¿¡æ¯
 *      var queryParam, queryBySQLParams, queryBySQLService;
 *      queryParam = new FilterParameter({
 *          name: "Province@RelQuery",
 *          fields: ["SmID","name"],
 *          attributeFilter: "SmID<7",
 *          linkItems: [linkItem]
 *       }),
 *      queryBySQLParams = new QueryBySQLParameters({
 *           queryParams: [queryParam]
 *              }),
 *      queryBySQLService = new QueryBySQLService(url, {
     *          eventListeners: {
     *              "processCompleted": processCompleted,
     *              "processFailed": processFailed
     *              }
     *      });
     *      queryBySQLService.processAsync(queryBySQLParams);
     *  }
 *  function processCompleted(queryEventArgs) {//todo}
 *  function processFailed(e) {//todo}
 * @usage
 */
class LinkItem {


    constructor(options) {

        /**
         * @member {DatasourceConnectionInfo} LinkItem.prototype.datasourceConnectionInfo
         * @description å³èçå¤é¨æ°æ®æºä¿¡æ¯ã
         */
        this.datasourceConnectionInfo = null;

        /**
         * @member {Array.<string>} LinkItem.prototype.foreignKeys
         * @description ä¸»ç©ºé´æ°æ®éçå¤é®ã
         */
        this.foreignKeys = null;

        /**
         * @member {string} LinkItem.prototype.foreignTable
         * @description å³èçå¤é¨å±æ§è¡¨çåç§°ï¼ç®åä»æ¯æ Supermap ç®¡ççè¡¨ï¼å³å¦ä¸ä¸ªç¢éæ°æ®éæå¯¹åºç DBMS è¡¨ã
         */
        this.foreignTable = null;

        /**
         * @member {Array.<string>} LinkItem.prototype.linkFields
         * @description æ¬²ä¿ççå¤é¨å±æ§è¡¨çå­æ®µãå¦æä¸è®¾ç½®å­æ®µæèè®¾ç½®çå­æ®µå¨å¤é¨å±æ§è¡¨ä¸­ä¸å­å¨çè¯åä¸è¿
         * åä»»ä½å¤é¨å±æ§è¡¨çå±æ§ä¿¡æ¯ãå¦ææ¬²ä¿ççå¤é¨è¡¨å­æ®µä¸ä¸»è¡¨å­æ®µå­å¨ååï¼åè¿éè¦æå®ä¸ä¸ªä¸å­å¨å­æ®µåä½ä¸ºå¤é¨è¡¨çå­æ®µå«åã
         */
        this.linkFields = null;

        /**
         * @member {string} LinkItem.prototype.linkFilter
         * @description ä¸å¤é¨å±æ§è¡¨çè¿æ¥æ¡ä»¶ã
         */
        this.linkFilter = null;

        /**
         * @member {string} LinkItem.prototype.name
         * @description æ­¤å³èä¿¡æ¯å¯¹è±¡çåç§°ã
         */
        this.name = null;

        /**
         * @member {Array.<string>} LinkItem.prototype.primaryKeys
         * @description éè¦å³èçå¤é¨å±æ§è¡¨çä¸»é®ã
         */
        this.primaryKeys = null;

        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = "SuperMap.LinkItem";
    }

    /**
     * @function LinkItem.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        if (me.datasourceConnectionInfo instanceof DatasourceConnectionInfo) {
            me.datasourceConnectionInfo.destroy();
            me.datasourceConnectionInfo = null;
        }
        me.foreignKeys = null;
        me.foreignTable = null;
        me.linkFields = null;
        me.linkFilter = null;
        me.name = null;
        me.primaryKeys = null;
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/MapService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class MapService
 * @deprecatedclass SuperMap.MapService
 * @category iServer Map
 * @classdesc å°å¾ä¿¡æ¯æå¡ç±»ã
 * @extends {CommonServiceBase}
 * @example
 * var myMapService = new MapService(url, {
 * eventListeners:{
 *     "processCompleted": MapServiceCompleted,
 *       "processFailed": MapServiceFailed
 *       }
 * });
 *
 * @param {string} url - æå¡å°åãå¦ï¼http://localhost:8090/iserver/services/map-world/rest/maps/World+Map ã
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - äºä»¶çå¬å¨å¯¹è±¡ãæ processCompleted å±æ§å¯ä¼ å¥å¤çå®æåçåè°å½æ°ãprocessFailed å±æ§ä¼ å¥å¤çå¤±è´¥åçåè°å½æ°ã
 * @param {DataFormat} [options.format=DataFormat.GEOJSON] - æ¥è¯¢ç»æè¿åæ ¼å¼ï¼ç®åæ¯æ iServerJSON å GeoJSON ä¸¤ç§æ ¼å¼ãåæ°æ ¼å¼ä¸º "ISERVER"ï¼"GEOJSON"ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class MapService_MapService extends CommonServiceBase {


    constructor(url, options) {
        super(url, options);
        /**
         * @member {string} MapService.prototype.projection
         * @description æ ¹æ®æå½±åæ°è·åå°å¾ç¶æä¿¡æ¯ãå¦"EPSG:4326"
         */
        this.projection = null;

        this.CLASS_NAME = "SuperMap.MapService";
        if (options) {
            Util.extend(this, options);
        }
        var me = this;

        if (me.projection) {
            var arr = me.projection.split(":");
            if (arr instanceof Array) {
                if (arr.length === 2) {
                    me.url = Util.urlAppend(me.url,`prjCoordSys=${encodeURIComponent(`{\"epsgCode\":"${arr[1]}"}`)}`)
                }
                if (arr.length === 1) {
                    me.url = Util.urlAppend(me.url,`prjCoordSys=${encodeURIComponent(`{\"epsgCode\":"${arr[0]}"}`)}`)
                }
            }
        }
    }

    /**
     * @function  destroy
     * @description éæ¾èµæºï¼å°å¼ç¨çèµæºå±æ§ç½®ç©ºã
     */
    destroy() {
        super.destroy();
        var me = this;
        if (me.events) {
            me.events.un(me.eventListeners);
            me.events.listeners = null;
            me.events.destroy();
            me.events = null;
            me.eventListeners = null;
        }
    }

    /**
     * @function  MapService.prototype.processAsync
     * @description è´è´£å°å®¢æ·ç«¯çè®¾ç½®çåæ°ä¼ éå°æå¡ç«¯ï¼ä¸æå¡ç«¯å®æå¼æ­¥éè®¯ã
     */
    processAsync() {
        var me = this;
        me.request({
            method: "GET",
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }

    /*
     * Method: getMapStatusCompleted
     * è·åå°å¾ç¶æå®æï¼æ§è¡æ­¤æ¹æ³ã
     *
     * Parameters:
     * {Object} result - æå¡å¨è¿åçç»æå¯¹è±¡ã
     */
    serviceProcessCompleted(result) {
        var me = this;
        result = Util.transformResult(result);
        var codeStatus = (result.code >= 200 && result.code < 300) || result.code == 0 || result.code === 304;
        var isCodeValid = result.code && codeStatus;
        if (!result.code || isCodeValid) {
            me.events && me.events.triggerEvent("processCompleted", {result: result});
        } else {
            ////å¨æ²¡ætokenæ¯è¿åçæ¯200ï¼ä½æ¯å¶å®æ¯æ²¡ææéï¼æä»¥è¿éä¹åºè¯¥æ¯è§¦åå¤±è´¥äºä»¶
            me.events.triggerEvent("processFailed", {error: result});
        }
    }

}


;// CONCATENATED MODULE: ./src/common/iServer/MathExpressionAnalysisParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class MathExpressionAnalysisParameters
 * @deprecatedclass SuperMap.MathExpressionAnalysisParameters
 * @category iServer SpatialAnalyst GridMathAnalyst
 * @classdesc æ æ ¼ä»£æ°è¿ç®åæ°ç±»ã
 * @param {Object} options - åæ°ã
 * @param {string} options.dataset - æå®æ æ ¼ä»£æ°è¿ç®æ°æ®æºä¸­æ°æ®éçåç§°ãè¯¥åç§°ç¨å½¢å¦"æ°æ®éåç§°@æ°æ®æºå«å"å½¢å¼æ¥è¡¨ç¤ºï¼ä¾å¦ï¼BaseMap_P@Jingjinã
 * @param {string} options.resultGridName - æå®ç»ææ°æ®éåç§°ã
 * @param {string} options.expression - æå®çæ æ ¼è¿ç®è¡¨è¾¾å¼ãå¦ï¼[DatasourceAlias1.Raster1]*2-10ã
 * @param {string} options.targetDatasource - æå®å­å¨ç»ææ°æ®éçæ°æ®æºã
 * @param {GeometryPolygon|L.Polygon|ol.geom.Polygon|GeoJSONObject} [options.extractRegion] - æ æ ¼ä»£æ°è¿ç®çèå´ï¼æå®æ°æ®éä¸­åä¸æ æ ¼ä»£æ°è¿ç®çåºåã
 *                                                                                        å¦æç¼ºçï¼åè®¡ç®å¨é¨åºåï¼å¦æåä¸è¿ç®çæ°æ®éèå´ä¸ä¸è´ï¼å°ä½¿ç¨æææ°æ®éçèå´çäº¤éä½ä¸ºè®¡ç®åºå ã
 * @param {boolean} [options.isZip=false] - æ¯å¦å¯¹ç»ææ°æ®éè¿è¡åç¼©å¤çã
 * @param {boolean} [options.ignoreNoValue=false] - æ¯å¦å¿½ç¥æ å¼æ æ ¼æ°æ®ãtrue è¡¨ç¤ºå¿½ç¥æ å¼æ°æ®ï¼å³æ å¼æ æ ¼ä¸åä¸è¿ç®ã
 * @param {boolean} [options.deleteExistResultDataset=false] - å¦æç¨æ·å½åçç»ææ°æ®éåç§°ä¸å·²æçæ°æ®ééåï¼æ¯å¦å é¤å·²æçæ°æ®éã
 * @usage
 */
class MathExpressionAnalysisParameters {

    constructor(options) {
        if (!options) {
            return;
        }
        /**
         * @member {string} MathExpressionAnalysisParameters.prototype.dataset
         * @description è¦ç¨æ¥åæ æ ¼ä»£æ°è¿ç®æ°æ®æºä¸­æ°æ®éçåç§°ã
         * è¯¥åç§°ç¨å½¢å¦"æ°æ®éåç§°@æ°æ®æºå«å"å½¢å¼æ¥è¡¨ç¤ºï¼ä¾å¦ï¼JingjinTerrain@Jingjinã
         *
         */
        this.dataset = null;

        /**
         * @member {GeometryPolygon|L.Polygon|ol.geom.Polygon|GeoJSONObject} [MathExpressionAnalysisParameters.prototype.extractRegion]
         * @description æ æ ¼ä»£æ°è¿ç®çèå´ï¼æå®æ°æ®éä¸­åä¸æ æ ¼ä»£æ°è¿ç®çåºåã
         * å¦æç¼ºçï¼åè®¡ç®å¨é¨åºåï¼å¦æåä¸è¿ç®çæ°æ®éèå´ä¸ä¸è´ï¼å°ä½¿ç¨æææ°æ®éçèå´çäº¤éä½ä¸ºè®¡ç®åºå ã
         */
        this.extractRegion = null;

        /**
         * @member {string} MathExpressionAnalysisParameters.prototype.expression
         * @description æå®çæ æ ¼è¿ç®è¡¨è¾¾å¼ãå¦ï¼"[DatasourceAlias1.Raster1]*2-10"ã
         */
        this.expression = null;

        /**
         * @member {boolean} [MathExpressionAnalysisParameters.prototype.isZip=false]
         * @description æ¯å¦å¯¹ç»ææ°æ®éè¿è¡åç¼©å¤çã
         */
        this.isZip = false;

        /**
         * @member {boolean} [MathExpressionAnalysisParameters.prototype.ignoreNoValue=false]
         * @description æ¯å¦å¿½ç¥æ å¼æ æ ¼æ°æ®ã
         */
        this.ignoreNoValue = false;

        /**
         * @member {string} MathExpressionAnalysisParameters.prototype.targetDatasource
         * @description æå®å­å¨ç»ææ°æ®éçæ°æ®æºã
         */
        this.targetDatasource = null;

        /**
         * @member {string} MathExpressionAnalysisParameters.prototype.resultGridName
         * @description æå®ç»ææ°æ®éåç§°ã
         */
        this.resultGridName = null;

        /**
         * @member {boolean} [MathExpressionAnalysisParameters.prototype.deleteExistResultDataset=false]
         * @description å¦æç¨æ·å½åçç»ææ°æ®éåç§°ä¸å·²æçæ°æ®ééåï¼æ¯å¦å é¤å·²æçæ°æ®éã
         */
        this.deleteExistResultDataset = false;

        Util.extend(this, options);

        this.CLASS_NAME = "SuperMap.MathExpressionAnalysisParameters"
    }


    /**
     * @function MathExpressionAnalysisParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.dataset = null;
        me.bounds = null;
        me.expression = null;
        me.isZip = true;
        me.ignoreNoValue = true;
        me.targetDatasource = null;
        me.resultGridName = null;
        me.deleteExistResultDataset = null;
    }

    /**
     * @function MathExpressionAnalysisParameters.toObject
     * @param {Object} mathExpressionAnalysisParameters - æ æ ¼ä»£æ°è¿ç®åæ°ã
     * @param {Object} tempObj - ç®æ å¯¹è±¡ã
     * @description çææ æ ¼ä»£æ°è¿ç®å¯¹è±¡ã
     */
    static toObject(mathExpressionAnalysisParameters, tempObj) {
        for (var name in mathExpressionAnalysisParameters) {
            if (name !== "dataset") {
                tempObj[name] = mathExpressionAnalysisParameters[name];
            }

            if (name === "extractRegion") {
                if (mathExpressionAnalysisParameters[name]) {
                    var bs = mathExpressionAnalysisParameters[name].components[0].components;
                    var region = {},
                        points = [],
                        type = "REGION";

                    var len = bs.length;
                    for (var i = 0; i < len - 1; i++) {
                        var poi = {};
                        poi["x"] = bs[i].x;
                        poi["y"] = bs[i].y;
                        points.push(poi);
                    }


                    region["points"] = points;
                    region["type"] = type;

                    tempObj[name] = region;
                }
            }
        }
    }
}

;// CONCATENATED MODULE: ./src/common/iServer/MathExpressionAnalysisService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class MathExpressionAnalysisService
 * @deprecatedclass SuperMap.MathExpressionAnalysisService
 * @category  iServer SpatialAnalyst GridMathAnalyst
 * @classdesc æ æ ¼ä»£æ°è¿ç®æå¡ç±»ã
 * @param {string} url - æå¡å°åãå¦ http://localhost:8090/iserver/services/spatialanalyst-changchun/restjsr/spatialanalyst
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - éè¦è¢«æ³¨åççå¬å¨å¯¹è±¡ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @extends {SpatialAnalystBase}
 * @example ä¾å¦ï¼
 * (start code)
 * var myMathExpressionAnalysisService = new MathExpressionAnalysisService(url);
 * myMathExpressionAnalysisService.on({
     *     "processCompleted": processCompleted,
     *     "processFailed": processFailed
     *     }
 * );
 * (end)
 * @usage
 */
class MathExpressionAnalysisService extends SpatialAnalystBase {

    constructor(url, options) {
        super(url, options);

        this.CLASS_NAME = "SuperMap.MathExpressionAnalysisService";
    }

    /**
     * @override
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function MathExpressionAnalysisService.prototype.processAsync
     * @description è´è´£å°å®¢æ·ç«¯çæ¥è¯¢åæ°ä¼ éå°æå¡ç«¯ã
     * @param {MathExpressionAnalysisParameters} parameter - æ æ ¼ä»£æ°è¿ç®åæ°ç±»ã
     */
    processAsync(parameter) {
        var me = this;
        var parameterObject = {};

        if (parameter instanceof MathExpressionAnalysisParameters) {
            me.url = Util.urlPathAppend(me.url, 'datasets/' + parameter.dataset + '/mathanalyst');
        }

        MathExpressionAnalysisParameters.toObject(parameter, parameterObject);
        var jsonParameters = Util.toJSON(parameterObject);
        me.url = Util.urlAppend(me.url, 'returnContent=true');
        me.request({
            method: "POST",
            data: jsonParameters,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/MeasureParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class MeasureParameters
 * @deprecatedclass SuperMap.MeasureParameters
 * @category iServer Map Measure
 * @classdesc éç®åæ°ç±»ã
 * @param {GeoJSONObject} geometry - è¦éç®çå ä½å¯¹è±¡ã
 * @param {Object} options - å¯éåæ°ã
 * @param {Unit} [options.unit=Unit.METER] - éç®åä½ã
 * @param {string} [options.prjCoordSys] - ç¨æ¥æå®è¯¥éç®æä½æä½¿ç¨çæå½±ã
 * @param {string} [options.distanceMode="Geodesic"] - ç¨æ¥æå®éç®çæ¹å¼ä¸ºæçé¢é¿åº¦ 'Geodesic' æèå¹³é¢é¿åº¦ 'Planar' æ¥è®¡ç®ã
 * @usage
 */
class MeasureParameters {



    constructor(geometry, options) {
        if (!geometry) {
            return;
        }
        /**
         * @member {GeoJSONObject} MeasureParameters.prototype.geometry
         * @description è¦éç®çå ä½å¯¹è±¡ã<br>
         * ç¹ç±»åå¯ä»¥æ¯ï¼{@link GeometryPoint}|{@link L.Marker}|{@link L.CircleMarker}|{@link L.Circle}|{@link L.GeoJSON}|{@link ol.geom.Point}|{@link ol.format.GeoJSON}|{@link GeoJSONObject}ã<br>
         * çº¿ç±»åå¯ä»¥æ¯ï¼{@link GeometryLineString}|{@link GeometryLinearRing}|{@link L.Polyline}|{@link L.GeoJSON}|{@link ol.geom.LineString}|{@link ol.format.GeoJSON}|{@link GeoJSONObject}ã<br>
         * é¢ç±»åå¯ä»¥æ¯ï¼{@link GeometryPolygon}|{@link L.Polygon}|{@link L.GeoJSON}|{@link ol.geom.Polygon}|{@link ol.format.GeoJSON}|{@link GeoJSONObject}ã
         */
        this.geometry = geometry;

        /**
         * @member {Unit} [MeasureParameters.prototype.unit=Unit.METER]
         * @description éç®åä½ãå³éç®ç»æä»¥ç±³ä¸ºåä½ã
         */
        this.unit = Unit.METER;

        /**
         * @member {string} [MeasureParameters.prototype.prjCoordSys]
         * @description ç¨æ¥æå®è¯¥éç®æä½æä½¿ç¨çæå½±ã
         */
        this.prjCoordSys = null;

        /**
         * @member {string} [MeasureParameters.prototype.distanceMode="Geodesic"]
         * @description ç¨æ¥æå®éç®çæ¹å¼ä¸ºæçé¢é¿åº¦ 'Geodesic' æèå¹³é¢é¿åº¦ 'Planar' æ¥è®¡ç®ã
         * @example
         * var param = new MeasureParameters(getmetry,{distanceMode:'Planar'});
         */
        this.distanceMode = null;
        if (options) {
            Util.extend(this, options);
        }
        this.CLASS_NAME = "SuperMap.MeasureParameters";
    }

    /**
     * @function MeasureParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.geometry = null;
        me.unit = null;
        me.prjCoordSys = null;
    }
}

;// CONCATENATED MODULE: ./src/common/iServer/MeasureService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/






/**
 * @class MeasureService
 * @deprecatedclass SuperMap.MeasureService
 * @category iServer Map Measure
 * @classdesc éç®æå¡ç±»ã
 *            è¯¥ç±»è´è´£å°éç®åæ°ä¼ éå°æå¡ç«¯ï¼å¹¶è·åæå¡ç«¯è¿åçéç®ç»æã
 * @extends {CommonServiceBase}
 * @example
 * var myMeasuerService = new MeasureService(url, {
 *      measureMode: MeasureMode.DISTANCE,
 *      eventListeners:{
 *          "processCompleted": measureCompleted
 *      }
 * });
 * @param {string} url - æå¡å°åãå¦ï¼http://localhost:8090/iserver/services/map-world/rest/maps/World+Map ã
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - äºä»¶çå¬å¨å¯¹è±¡ãæ processCompleted å±æ§å¯ä¼ å¥å¤çå®æåçåè°å½æ°ãprocessFailed å±æ§ä¼ å¥å¤çå¤±è´¥åçåè°å½æ°ã
 * @param {DataFormat} [options.format=DataFormat.GEOJSON] - æ¥è¯¢ç»æè¿åæ ¼å¼ï¼ç®åæ¯æ iServerJSON å GeoJSON ä¸¤ç§æ ¼å¼ãåæ°æ ¼å¼ä¸º "ISERVER"ï¼"GEOJSON"ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @param {MeasureMode} options.measureMode - éç®æ¨¡å¼ï¼åæ¬è·ç¦»éç®æ¨¡å¼åé¢ç§¯éç®æ¨¡å¼ã
 * @usage
 */
class MeasureService_MeasureService extends CommonServiceBase {


    constructor(url, options) {
        super(url, options);
        /**
         * @member {MeasureMode} [MeasureService.prototype.measureMode=MeasureMode.DISTANCE]
         * @description éç®æ¨¡å¼ï¼åæ¬è·ç¦»éç®æ¨¡å¼åé¢ç§¯éç®æ¨¡å¼ã
         */
        this.measureMode = MeasureMode.DISTANCE;

        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = "SuperMap.MeasureService";
    }

    /**
     * @override
     */
    destroy() {
        super.destroy();
        var me = this;
        me.measureMode = null;
    }

    /**
     * @function MeasureService.prototype.processAsync
     * @description è´è´£å°å®¢æ·ç«¯çéç®åæ°ä¼ éå°æå¡ç«¯ã
     * @param {MeasureParameters} params - éç®åæ°ã
     */
    processAsync(params) {
        if (!(params instanceof MeasureParameters)) {
            return;
        }
        var me = this,
            geometry = params.geometry,
            pointsCount = 0,
            point2ds = null;
        if (!geometry) {
            return;
        }
        me.url = Util.urlPathAppend(me.url, me.measureMode === MeasureMode.AREA ? 'area' : 'distance');
        var serverGeometry = ServerGeometry.fromGeometry(geometry);
        if (!serverGeometry) {
            return;
        }
        pointsCount = serverGeometry.parts[0];
        point2ds = serverGeometry.points.splice(0, pointsCount);

        var prjCoordSysTemp, prjCodeTemp, paramsTemp;
        if (params.prjCoordSys) {
            if (typeof (params.prjCoordSys) === "object") {
                prjCodeTemp = params.prjCoordSys.projCode;
                prjCoordSysTemp = '{"epsgCode"' + prjCodeTemp.substring(prjCodeTemp.indexOf(":"), prjCodeTemp.length) + "}";
            } else if (typeof (params.prjCoordSys) === "string") {
                prjCoordSysTemp = '{"epsgCode"' + params.prjCoordSys.substring(params.prjCoordSys.indexOf(":"), params.prjCoordSys.length) + "}";
            }
            paramsTemp = {
                "point2Ds": Util.toJSON(point2ds),
                "unit": params.unit,
                "prjCoordSys": prjCoordSysTemp,
                "distanceMode": params.distanceMode || 'Geodesic'
            };
        } else {
            paramsTemp = {"point2Ds": Util.toJSON(point2ds), "unit": params.unit, "distanceMode": params.distanceMode || 'Geodesic'};
        }

        me.request({
            method: "GET",
            params: paramsTemp,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });

    }

}

;// CONCATENATED MODULE: ./src/common/iServer/OverlapDisplayedOptions.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class OverlapDisplayedOptions
 * @deprecatedclass SuperMap.OverlapDisplayedOptions
 * @category iServer Map Layer
 * @classdesc å°å¾åçè¿æ»¤æ¾ç¤ºéé¡¹ãå¨ææ¬æä¸é¢å¾åç´ æ¾ç¤ºè¾å¯éçåºåï¼ææ¬ä¹é´æä¸é¢åç´ ä¹é´ä¼åçç¸äºåççç°è±¡ï¼
 * è¯¥ç±»å¯ä»¥åå«æ§å¶åç§ç±»åçå¯¹è±¡çåçæ¾ç¤ºæåµï¼è¿èå¾å¥½å°å¤çå°å¾ä¸­åç§ç±»åå¯¹è±¡çåçæ¾ç¤ºé®é¢ã
 * @param {Object} options - å¯éåæ°ã
 * @param {boolean} [options.allowPointOverlap=true] - ç¹åç¹åçæ¶æ¯å¦æ¾ç¤ºåççç¹å¯¹è±¡ã
 * @param {boolean} [options.allowPointWithTextDisplay=true] - æ ç­¾åç¸åºæ®éå¾å±ä¸çç¹æ¯å¦ä¸èµ·è¿æ»¤æ¾ç¤º,å¦æè¿æ»¤æ¾ç¤ºï¼
 *                                                             åªä»¥å¾å±éåä¸­å¯¹åºæ°æ®éçç´¢å¼æå°çå¾å±çç¹é£æ ¼æ¥ç»å¶ç¹ã
 * @param {boolean} [options.allowTextOverlap=false] - ææ¬åçæ¶æ¯å¦æ¾ç¤ºåççææ¬å¯¹è±¡ã
 * @param {boolean} [options.allowTextAndPointOverlap=true] - ææ¬åç¹åçæ¶æ¯å¦æ¾ç¤ºåççææ¬æç¹å¯¹è±¡ï¼æ­¤å±æ§ä¸å¤çææ¬ä¹é´çåçåç¹ä¹é´çåçï¼ã
 * @param {boolean} [options.allowThemeGraduatedSymbolOverlap=false] - ç­çº§ç¬¦å·åç´ åçæ¶æ¯å¦æ¾ç¤ºåççç­çº§ç¬¦å·åç´ ã
 * @param {boolean} [options.allowThemeGraphOverlap=false] - ç»è®¡ä¸é¢å¾åç´ åçæ¶æ¯å¦æ¾ç¤ºåççç»è®¡ä¸é¢å¾åç´ ã
 * @param {number} [options.horizontalOverlappedSpaceSize=0] - ä¸¤ä¸ªå¯¹è±¡ä¹é´çæ¨ªååçé´è·ï¼åä½ä¸º 0.1 æ¯«ç±³ï¼è· verticalOverlappedSpaceSize ç»åä½¿ç¨ï¼
 *                                                             å½ä¸¤ä¸ªå¯¹è±¡çæ¨ªåé´è·å°äºè¯¥å¼ï¼ä¸çºµåé´è·å°äº verticalOverlappedSpaceSize æ¶è®¤ä¸ºåçã
 * @param {number} [options.verticalOverlappedSpaceSize=0] - ä¸¤ä¸ªå¯¹è±¡ä¹é´ççºµååçé´è·ï¼åä½ä¸º 0.1 æ¯«ç±³ï¼è· horizontalOverlappedSpaceSize ç»åä½¿ç¨ï¼
 *                                                           å½ä¸¤ä¸ªå¯¹è±¡ççºµåé´è·å°äºè¯¥å¼ï¼ä¸æ¨ªåé´è·å°äº horizontalOverlappedSpaceSize æ¶è®¤ä¸ºåçã
 * @usage
 */
class OverlapDisplayedOptions {

    constructor(options) {
        options = options || {};
        /**
         * @member {boolean} [OverlapDisplayedOptions.prototype.allowPointOverlap=true]
         * @description ç¹åç¹åçæ¶æ¯å¦æ¾ç¤ºåççç¹å¯¹è±¡ã
         */
        this.allowPointOverlap = true;

        /**
         * @member {boolean} [OverlapDisplayedOptions.prototype.allowPointWithTextDisplay=true]
         * @description æ ç­¾åç¸åºæ®éå¾å±ä¸çç¹æ¯å¦ä¸èµ·è¿æ»¤æ¾ç¤ºï¼å¦æè¿æ»¤æ¾ç¤ºï¼
         * åªä»¥å¾å±éåä¸­å¯¹åºæ°æ®éçç´¢å¼æå°çå¾å±çç¹é£æ ¼æ¥ç»å¶ç¹ã
         */
        this.allowPointWithTextDisplay = true;

        /**
         * @member {boolean} [OverlapDisplayedOptions.prototype.allowTextOverlap=false]
         * @description ææ¬åçæ¶æ¯å¦æ¾ç¤ºåççææ¬å¯¹è±¡ã
         */
        this.allowTextOverlap = false;

        /**
         * @member {boolean} [OverlapDisplayedOptions.prototype.allowTextAndPointOverlap=true]
         * @description  ææ¬åç¹åçæ¶æ¯å¦æ¾ç¤ºåççææ¬æç¹å¯¹è±¡ï¼æ­¤å±æ§ä¸å¤çææ¬ä¹é´çåçåç¹ä¹é´çåçï¼ã
         */
        this.allowTextAndPointOverlap = true;

        /**
         * @member {boolean} [OverlapDisplayedOptions.prototype.allowThemeGraduatedSymbolOverlap=false]
         * @description ç­çº§ç¬¦å·åç´ åçæ¶æ¯å¦æ¾ç¤ºåççç­çº§ç¬¦å·åç´ ã
         */
        this.allowThemeGraduatedSymbolOverlap = false;

        /**
         * @member {boolean} [OverlapDisplayedOptions.prototype.allowThemeGraphOverlap=false]
         * @description ç»è®¡ä¸é¢å¾åç´ åçæ¶æ¯å¦æ¾ç¤ºåççç»è®¡ä¸é¢å¾åç´ ã
         */
        this.allowThemeGraphOverlap = false;

        /**
         * @member {number} [OverlapDisplayedOptions.prototype.horizontalOverlappedSpaceSize=0]
         * @description ä¸¤ä¸ªå¯¹è±¡ä¹é´çæ¨ªååçé´è·ï¼åä½ä¸º0.1æ¯«ç±³ï¼è· verticalOverlappedSpaceSize ç»åä½¿ç¨ï¼
         * å½ä¸¤ä¸ªå¯¹è±¡çæ¨ªåé´è·å°äºè¯¥å¼ï¼ä¸çºµåé´è·å°äº verticalOverlappedSpaceSize æ¶è®¤ä¸ºåçã
         */
        this.horizontalOverlappedSpaceSize = 0;

        /**
         * @member {number} [OverlapDisplayedOptions.prototype.verticalOverlappedSpaceSize=0]
         * @description ä¸¤ä¸ªå¯¹è±¡ä¹é´ççºµååçé´è·ï¼åä½ä¸º0.1æ¯«ç±³ï¼è· horizontalOverlappedSpaceSize ç»åä½¿ç¨ï¼
         * å½ä¸¤ä¸ªå¯¹è±¡ççºµåé´è·å°äºè¯¥å¼ï¼ä¸æ¨ªåé´è·å°äº horizontalOverlappedSpaceSize æ¶è®¤ä¸ºåçã
         */
        this.verticalOverlappedSpaceSize = 0;

        Util.extend(this, options);
        this.ugcLayer = new UGCLayer(options);

        this.CLASS_NAME = "SuperMap.OverlapDisplayedOptions";
    }

    /**
     * @function OverlapDisplayedOptions.prototype.destroy
     * @description éæ¾èµæºï¼å°èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        Util.reset(this);
    }


    /**
     * @function OverlapDisplayedOptions.prototype.fromJson
     * @description å°æå¡ç«¯ JSON å¯¹è±¡è½¬æ¢æå½åå®¢æ·ç«¯å¯¹è±¡ã
     * @param {Object} jsonObject - è¦è½¬æ¢ç JSON å¯¹è±¡ã
     */
    fromJson(jsonObject) {
        this.ugcLayer.fromJson.apply(this, [jsonObject]);
    }


    /**
     * @function OverlapDisplayedOptions.prototype.toServerJSONObject
     * @description è½¬æ¢æå¯¹åºç JSON æ ¼å¼å¯¹è±¡ã
     * @returns {Object} å¯¹åºç JSON æ ¼å¼å¯¹è±¡ã
     */
    toServerJSONObject() {
        var jsonObject = this.ugcLayer.toServerJSONObject.apply(this, arguments);
        return jsonObject;
    }


    /**
     * @function OverlapDisplayedOptions.prototype.toString
     * @description è½¬æ¢æå¯¹åºç tileLayer è¯·æ±ç¦çæ¶ overlapDisplayedOptions åæ°ã
     * @returns {string} å¯¹åºç tileLayer è¯·æ±ç¦çæ¶ overlapDisplayedOptions åæ°ã
     */

    toString() {
        var jsonObject = this.ugcLayer.toServerJSONObject.apply(this, arguments);
        var str = "{";
        for (var attr in jsonObject) {
            if (jsonObject.hasOwnProperty(attr)) {
                str += "'" + attr + "':" + jsonObject[attr] + ",";
            }
        }
        str = str.substr(0, str.length - 1);
        str += "}";
        return str;
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/OverlayAnalystService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class OverlayAnalystService
 * @deprecatedclass SuperMap.OverlayAnalystService
 * @category iServer SpatialAnalyst OverlayAnalyst
 * @classdesc å å åææå¡ç±»ã
 * è¯¥ç±»è´è´£å°å®¢æ·è®¾ç½®çå å åæåæ°ä¼ éç»æå¡ç«¯ï¼å¹¶æ¥æ¶æå¡ç«¯è¿åçå å åæç»ææ°æ®ã
 * å å åæç»æéè¿è¯¥ç±»æ¯æçäºä»¶ççå¬å½æ°åæ°è·å
 * @param {string} url - æå¡å°åãå¦http://localhost:8090/iserver/services/spatialanalyst-changchun/restjsr/spatialanalystã
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - éè¦è¢«æ³¨åççå¬å¨å¯¹è±¡ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @extends {CommonServiceBase}
 * @example ä¾å¦ï¼
 * (start code)
 * var myOverlayAnalystService = new OverlayAnalystService(url, {
 *     eventListeners: {
 *	       "processCompleted": OverlayCompleted,
 *		   "processFailed": OverlayFailed
 *		   }
 * });
 * (end)
 * @usage
 */

class OverlayAnalystService extends SpatialAnalystBase {

    constructor(url, options) {
        super(url, options);

        /**
         * @member {string} OverlayAnalystService.prototype.mode
         * @description å å åæç±»å
         */
        this.mode = null;

        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = "SuperMap.OverlayAnalystService";
    }

    /**
     * @override
     */
    destroy() {
        super.destroy();
        this.mode = null;
    }

    /**
     * @function OverlayAnalystService.prototype.processAsync
     * @description è´è´£å°å®¢æ·ç«¯çæ¥è¯¢åæ°ä¼ éå°æå¡ç«¯ã
     * @param {OverlayAnalystParameters} parameter - å å åæåæ°ç±»ã
     */
    processAsync(parameter) {
        var parameterObject = {};
        var me = this;

        if (parameter instanceof DatasetOverlayAnalystParameters) {
            me.mode = "datasets";
            me.url = Util.urlPathAppend(me.url, 'datasets/' + parameter.sourceDataset + '/overlay');
            DatasetOverlayAnalystParameters.toObject(parameter, parameterObject);
        } else if (parameter instanceof GeometryOverlayAnalystParameters) {
            me.mode = "geometry";
            //æ¯æä¼ å¥å¤ä¸ªå ä½è¦ç´ è¿è¡å å åæ
            if(parameter.operateGeometries && parameter.sourceGeometries){
                me.url = Util.urlPathAppend(me.url, 'geometry/overlay/batch');
                me.url = Util.urlAppend(me.url, 'ignoreAnalystParam=true');
            }else {
                me.url = Util.urlPathAppend(me.url, 'geometry/overlay');
            }
            GeometryOverlayAnalystParameters.toObject(parameter, parameterObject);
        }
        me.url = Util.urlAppend(me.url, 'returnContent=true');
        var jsonParameters = Util.toJSON(parameterObject);
        me.request({
            method: "POST",
            data: jsonParameters,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }
}

;// CONCATENATED MODULE: ./src/common/iServer/OverlayGeoJobParameter.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class OverlayGeoJobParameter
 * @deprecatedclass SuperMap.OverlayGeoJobParameter
 * @category iServer ProcessingService OverlayAnalyst
 * @classdesc å å åæä»»å¡åæ°ç±»ã
 * @param {Object} options - åæ°ã
 * @param {string} options.datasetName - æ°æ®éåã
 * @param {string} options.datasetOverlay - å å å¯¹è±¡æå¨çæ°æ®éåç§°ã
 * @param {string} options.srcFields - è¾å¥æ°æ®éè¦ä¿ççå­æ®µã
 * @param {string} [options.overlayFields] - å å æ°æ®éè¦ä¿ççå­æ®µãå¯¹åææ¨¡å¼ä¸º clipãupdateãerase æ¶ï¼æ­¤åæ°æ æã
 * @param {string} [options.mode] - å å åææ¨¡å¼ã
 * @param {OutputSetting} [options.output] - è¾åºåæ°è®¾ç½®ã
 * @param {MappingParameters} [options.mappingParameters] - åæåç»æå¯è§åçåæ°ç±»ã
 * @usage
 */
class OverlayGeoJobParameter {

    constructor(options) {
        if (!options) {
            return;
        }
        /**
         * @member {string} OverlayGeoJobParameter.prototype.datasetName
         * @description æ°æ®éåã
         */
        this.datasetName = "";

        /**
         * @member {string} OverlayGeoJobParameter.prototype.datasetOverlay
         * @description å å å¯¹è±¡æå¨çæ°æ®éåç§°ã
         */
        this.datasetOverlay = "";

        /**
         * @member {string} [OverlayGeoJobParameter.prototype.mode]
         * @description å å åææ¨¡å¼ã
         */
        this.mode = "";

        /**
         * @member {string} OverlayGeoJobParameter.prototype.srcFields
         * @description è¾å¥æ°æ®éè¦ä¿ççå­æ®µã
         */
        this.srcFields = "";

        /**
         * @member {string} OverlayGeoJobParameter.prototype.overlayFields
         * @description å å æ°æ®éè¦ä¿ççå­æ®µï¼å¯¹åææ¨¡å¼ä¸º clipãupdateãerase æ¶ï¼æ­¤åæ°æ æã
         */
        this.overlayFields = "";

        /**
         * @member {OutputSetting} [OverlayGeoJobParameter.prototype.output]
         * @description è¾åºåæ°è®¾ç½®ç±»ã
         */
        this.output = null;

        /**
        * @member {MappingParameters} [OverlayGeoJobParameter.prototype.mappingParameters]
        * @description åæåç»æå¯è§åçåæ°ç±»ã
        */
        this.mappingParameters = null;

        Util.extend(this, options);
        this.CLASS_NAME = "SuperMap.OverlayGeoJobParameter";
    }

    /**
     * @function OverlayGeoJobParameter.prototype.destroy
     * @description éæ¾èµæºï¼å°èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        this.datasetName = null;
        this.datasetOverlay = null;
        this.mode = null;
        this.srcFields = null;
        this.overlayFields = null;
        if (this.output instanceof OutputSetting) {
            this.output.destroy();
            this.output = null;
        }
        if (this.mappingParameters instanceof MappingParameters) {
            this.mappingParameters.destroy();
            this.mappingParameters = null;
        }
    }

    /**
     * @function OverlayGeoJobParameter.toObject
     * @param {Object} OverlayGeoJobParameter - ç¹èååæä»»å¡åæ°ã
     * @param {Object} tempObj - ç®æ å¯¹è±¡ã
     * @description çæç¹èååæä»»å¡å¯¹è±¡ã
     */
    static toObject(OverlayGeoJobParameter, tempObj) {
        for (var name in OverlayGeoJobParameter) {
            if (name == "datasetName") {
                tempObj['input'] = tempObj['input'] || {};
                tempObj['input'][name] = OverlayGeoJobParameter[name];
                continue;
            }
            if (name === "output") {
                tempObj['output'] = tempObj['output'] || {};
                tempObj['output'] = OverlayGeoJobParameter[name];
                continue;
            }

            tempObj['analyst'] = tempObj['analyst'] || {};
            tempObj['analyst'][name] = OverlayGeoJobParameter[name];
            if(name === 'mappingParameters'){
                tempObj['analyst'][name] = tempObj['analyst'][name] || {};
                tempObj['analyst']['mappingParameters'] = OverlayGeoJobParameter[name];
            }
        }
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/OverlayGeoJobsService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class OverlayGeoJobsService
 * @deprecatedclass SuperMap.OverlayGeoJobsService
 * @category iServer ProcessingService OverlayAnalyst
 * @classdesc å å åæä»»å¡ç±»ã
 * @param {string} url - æå¡å°åã
 * @param {Object} options - åæ°ã
 * @param {Events} options.events - å¤çææäºä»¶çå¯¹è±¡ã
 * @param {Object} [options.eventListeners] - äºä»¶çå¬å¨å¯¹è±¡ãæ processCompleted å±æ§å¯ä¼ å¥å¤çå®æåçåè°å½æ°ãprocessFailed å±æ§ä¼ å¥å¤çå¤±è´¥åçåè°å½æ°ã
 * @param {number} options.index - æå¡è®¿é®å°åå¨æ°ç»ä¸­çä½ç½®ã
 * @param {number} options.length - æå¡è®¿é®å°åæ°ç»é¿åº¦ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class OverlayGeoJobsService extends ProcessingServiceBase {
    constructor(url, options) {
        super(url, options);
        this.url = Util.urlPathAppend(this.url, 'spatialanalyst/overlay');
        this.CLASS_NAME = 'SuperMap.OverlayGeoJobsService';
    }

    /**
     * @override
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function OverlayGeoJobsService.prototype.getOverlayGeoJobs
     * @description è·åå å åæä»»å¡
     */
    getOverlayGeoJobs() {
        super.getJobs(this.url);
    }

    /**
     * @function OverlayGeoJobsService.prototype.getOverlayGeoJob
     * @description è·åæå®idçå å åæä»»å¡
     * @param {string} id - æå®è¦è·åæ°æ®çid
     */
    getOverlayGeoJob(id) {
        super.getJobs(Util.urlPathAppend(this.url, id));
    }

    /**
     * @function OverlayGeoJobsService.prototype.addOverlayGeoJob
     * @description æ°å»ºç¹å å ææå¡
     * @param {OverlayGeoJobParameter} params - åå»ºä¸ä¸ªå å åæçè¯·æ±åæ°ã
     * @param {number} seconds - å¼å§åå»ºåï¼è·ååå»ºæåç»æçæ¶é´é´éã
     */
    addOverlayGeoJob(params, seconds) {
        super.addJob(this.url, params, OverlayGeoJobParameter, seconds);
    }
}

;// CONCATENATED MODULE: ./src/common/iServer/QueryByBoundsParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class QueryByBoundsParameters
 * @deprecatedclass SuperMap.QueryByBoundsParameters
 * @category  iServer Map QueryResults
 * @classdesc Bounds æ¥è¯¢åæ°ç±»ãè¯¥ç±»ç¨äºè®¾ç½® Bounds æ¥è¯¢çç¸å³åæ°ã
 * @extends {QueryParameters}
 * @param {Object} options - åæ°ã
 * @param {(SuperMap.Bounds|L.Bounds|L.LatLngBounds|ol.extent|mapboxgl.LngLatBounds|GeoJSONObject)} options.bounds - æå®çæ¥è¯¢èå´ã
 * @param {Array.<FilterParameter>} options.queryParams - æ¥è¯¢è¿æ»¤æ¡ä»¶åæ°æ°ç»ã
 * @param {string} [options.customParams] - èªå®ä¹åæ°ï¼ä¾æ©å±ä½¿ç¨ã
 * @param {Object} [options.prjCoordSys] -èªå®ä¹åæ°ï¼ä¾ SuperMap Online æä¾çå¨ææå½±æ¥è¯¢æ©å±ä½¿ç¨ãå¦ {"epsgCode":3857}ã
 * @param {number} [options.expectCount=100000] - ææè¿åç»æè®°å½ä¸ªæ°ã
 * @param {GeometryType} [options.networkType=GeometryType.LINE] - ç½ç»æ°æ®éå¯¹åºçæ¥è¯¢ç±»åã
 * @param {QueryOption} [options.queryOption=QueryOption.ATTRIBUTEANDGEOMETRY] - æ¥è¯¢ç»æç±»åæä¸¾ç±»ã
 * @param {number} [options.startRecord=0] - æ¥è¯¢èµ·å§è®°å½å·ã
 * @param {number} [options.holdTime=10] - èµæºå¨æå¡ç«¯ä¿å­çæ¶é´ï¼åä½ä¸ºåéã
 * @param {boolean} [options.returnCustomResult=false] - ä»ä¾ä¸ç»´ä½¿ç¨ã
 * @param {boolean} [options.returnContent=true] - æ¯å¦ç«å³è¿åæ°åå»ºèµæºçè¡¨è¿°è¿æ¯è¿åæ°èµæºç URIã
 * @param {boolean} [options.returnFeatureWithFieldCaption = false] - è¿åçæ¥è¯¢ç»æè¦ç´ å­æ®µæ è¯æ¯å¦ä¸ºå­æ®µå«åãä¸º false æ¶ï¼è¿åçæ¯å­æ®µåï¼ä¸º true æ¶ï¼è¿åçæ¯å­æ®µå«åã
 * @usage
 */
class QueryByBoundsParameters extends QueryParameters {

    constructor(options) {
        options = options || {};
        super(options);
        /**
         * @member {boolean} [QueryByBoundsParameters.prototype.returnContent=true]
         * @description æ¯å¦ç«å³è¿åæ°åå»ºèµæºçè¡¨è¿°è¿æ¯è¿åæ°èµæºç URIã
         *              å¦æä¸º trueï¼åç´æ¥è¿åæ°åå»ºèµæºï¼å³æ¥è¯¢ç»æçè¡¨è¿°ã
         *              ä¸º falseï¼åè¿åçæ¯æ¥è¯¢ç»æèµæºç URIã
         */
        this.returnContent = true;

        /**
         * @member {(SuperMap.Bounds|L.Bounds|L.LatLngBounds|ol.extent|mapboxgl.LngLatBounds|GeoJSONObject)} QueryByBoundsParameters.prototype.bounds
         * @description æå®çæ¥è¯¢èå´ã
         */
        this.bounds = null;

        Util.extend(this, options);

        this.CLASS_NAME = "SuperMap.QueryByBoundsParameters";
    }

    /**
     * @function QueryByBoundsParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        super.destroy();
        var me = this;
        me.returnContent = null;
        if (me.bounds) {
            me.bounds = null;
        }

    }
}

;// CONCATENATED MODULE: ./src/common/iServer/QueryService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/






/**
 * @class QueryService
 * @deprecatedclass SuperMap.QueryService
 * @category  iServer Map QueryResults
 * @classdesc æ¥è¯¢æå¡åºç±»ã
 * @extends {CommonServiceBase}
 * @param {string} url - æå¡å°åãè¯·æ±å°å¾æ¥è¯¢æå¡ç URL åºä¸ºï¼http://{æå¡å¨å°å}:{æå¡ç«¯å£å·}/iserver/services/{å°å¾æå¡å}/rest/maps/{å°å¾å}ï¼
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - äºä»¶çå¬å¨å¯¹è±¡ãæprocessCompletedå±æ§å¯ä¼ å¥å¤çå®æåçåè°å½æ°ãprocessFailedå±æ§ä¼ å¥å¤çå¤±è´¥åçåè°å½æ°ã
 * @param {DataFormat} [options.format=DataFormat.GEOJSON] - æ¥è¯¢ç»æè¿åæ ¼å¼ï¼ç®åæ¯æ iServerJSON å GeoJSON ä¸¤ç§æ ¼å¼ãåæ°æ ¼å¼ä¸º "ISERVER"ï¼"GEOJSON"ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @example
 * var myService = new QueryService(url, {
 *     eventListeners: {
 *	       "processCompleted": queryCompleted,
 *		   "processFailed": queryError
 *		   }
 * };
 * @usage
 */
class QueryService extends CommonServiceBase {
    constructor(url, options) {
        super(url, options);

        /**
         * @member {boolean} QueryService.prototype.returnContent
         * @description æ¯å¦ç«å³è¿åæ°åå»ºèµæºçè¡¨è¿°è¿æ¯è¿åæ°èµæºçURIã
         */
        this.returnContent = false;

        /**
         * @member {string} QueryService.prototype.format
         * @description æ¥è¯¢ç»æè¿åæ ¼å¼ï¼ç®åæ¯æiServerJSON åGeoJSONä¸¤ç§æ ¼å¼ãåæ°æ ¼å¼ä¸º"ISERVER","GEOJSON"ã
         */
        this.format = DataFormat.GEOJSON;

        this.returnFeatureWithFieldCaption = false;

        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = "SuperMap.QueryService";
        if (!this.url) {
            return;
        }
        if (options && options.format) {
            this.format = options.format.toUpperCase();
        }
        this.url = Util.urlPathAppend(this.url,'queryResults');
    }

    /**
     * @function QueryService.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        super.destroy();
        var me = this;
        me.returnContent = null;
        me.format = null;
    }

    /**
     * @function QueryService.prototype.processAsync
     * @description è´è´£å°å®¢æ·ç«¯çæ¥è¯¢åæ°ä¼ éå°æå¡ç«¯ã
     * @param {QueryParameters} params - æ¥è¯¢åæ°ã
     */
    processAsync(params) {
        if (!(params instanceof QueryParameters)) {
            return;
        }
        var me = this,
            returnCustomResult = null,
            jsonParameters = null;
        me.returnContent = params.returnContent;

        jsonParameters = me.getJsonParameters(params);
        if (me.returnContent) {
            me.url = Util.urlAppend(me.url, 'returnContent=' + me.returnContent);
        } else {
            //ä»ä¾ä¸ç»´ä½¿ç¨ è·åé«äº®å¾ççbounds
            returnCustomResult = params.returnCustomResult;
            if (returnCustomResult) {
                me.url = Util.urlAppend(me.url, 'returnCustomResult=' + returnCustomResult);
            }
        }
        me.returnFeatureWithFieldCaption = params.returnFeatureWithFieldCaption;
        me.request({
            method: "POST",
            data: jsonParameters,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }

    /**
     * @function QueryService.prototype.serviceProcessCompleted
     * @description æ¥è¯¢å®æï¼æ§è¡æ­¤æ¹æ³ã
     * @param {Object} result - æå¡å¨è¿åçç»æå¯¹è±¡ã
     */
    serviceProcessCompleted(result) {
        var me = this;
        result = Util.transformResult(result);
        var geoJSONFormat = new GeoJSON();
        if (result && result.recordsets) {
            for (var i = 0, recordsets = result.recordsets, len = recordsets.length; i < len; i++) {
                if (recordsets[i].features) {
                    if (me.returnFeatureWithFieldCaption === true) {
                        recordsets[i].features.map((feature) => {
                            feature.fieldNames = recordsets[i].fieldCaptions;
                            return feature;
                        })
                    }
                    if (me.format === DataFormat.GEOJSON) {
                        recordsets[i].features = geoJSONFormat.toGeoJSON(recordsets[i].features);
                    }
                }
            }
        }

        me.events.triggerEvent("processCompleted", {
            result: result
        });
    }

    /**
     * @function QueryService.prototype.getQueryParameters
     * @description å° JSON å¯¹è±¡è¡¨ç¤ºçæ¥è¯¢åæ°è½¬åä¸º QueryParameters å¯¹è±¡ã
     * @param {Object} params - JSON å­ç¬¦ä¸²è¡¨ç¤ºçæ¥è¯¢åæ°ã
     * @returns {QueryParameters} è¿åè½¬ååç QueryParameters å¯¹è±¡ã
     */
    getQueryParameters(params) {
        return new QueryParameters({
            customParams: params.customParams,
            expectCount: params.expectCount,
            networkType: params.networkType,
            queryOption: params.queryOption,
            queryParams: params.queryParams,
            startRecord: params.startRecord,
            prjCoordSys: params.prjCoordSys,
            holdTime: params.holdTime
        });
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/QueryByBoundsService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class QueryByBoundsService
 * @deprecatedclass SuperMap.QueryByBoundsService
 * @category  iServer Map QueryResults
 * @classdesc Bounds æ¥è¯¢æå¡ç±»ã
 * @augments {QueryService}
 * @example
 * (start end)
 * var myQueryByBoundsService = new QueryByBoundsService(url, {
 *     eventListeners: {
 *         "processCompleted": queryCompleted,
 *		   "processFailed": queryError
 *		   }
 * });
 * function queryCompleted(object){//todo};
 * function queryError(object){//todo};
 * (end)
 * @param {string} url - æå¡å°åãå¦è®¿é®World Mapæå¡ï¼åªéå°urlè®¾ä¸º: http://localhost:8090/iserver/services/map-world/rest/maps/World+Map å³å¯ã
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - äºä»¶çå¬å¨å¯¹è±¡ãæprocessCompletedå±æ§å¯ä¼ å¥å¤çå®æåçåè°å½æ°ãprocessFailedå±æ§ä¼ å¥å¤çå¤±è´¥åçåè°å½æ°ã<br>
 * @param {DataFormat} [options.format=DataFormat.GEOJSON] - æ¥è¯¢ç»æè¿åæ ¼å¼ï¼ç®åæ¯æ iServerJSON å GeoJSON ä¸¤ç§æ ¼å¼ãåæ°æ ¼å¼ä¸º "ISERVER"ï¼"GEOJSON"ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class QueryByBoundsService extends QueryService {

    constructor(url, options) {
        super(url, options);
        this.CLASS_NAME = "SuperMap.QueryByBoundsService";
    }

    /**
     * @override
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function QueryByBoundsService.prototype.getJsonParameters
     * @description å°æ¥è¯¢åæ°è½¬åä¸º JSON å­ç¬¦ä¸²ã
     *              å¨æ¬ç±»ä¸­éåæ­¤æ¹æ³ï¼å¯ä»¥å®ç°ä¸åç§ç±»çæ¥è¯¢ï¼sql, geometry, distance, bounds ç­ï¼ã
     * @param {QueryByBoundsParameters} params - Bounds æ¥è¯¢åæ°ã
     * @returns {Object} è½¬ååç JSON å­ç¬¦ä¸²ã
     */
    getJsonParameters(params) {
        if (!(params instanceof QueryByBoundsParameters)) {
            return null;
        }
        var me = this,
            jsonParameters = "",
            qp = null,
            bounds = params.bounds;
        qp = me.getQueryParameters(params);
        jsonParameters += "'queryMode':'BoundsQuery','queryParameters':";
        jsonParameters += Util.toJSON(qp);
        jsonParameters += ",'bounds': {'rightTop':{'y':" + bounds.top + ",'x':" +
            bounds.right + "},'leftBottom':{'y':" + bounds.bottom + ",'x':" + bounds.left + "}}";
        jsonParameters = "{" + jsonParameters + "}";
        return jsonParameters;
    }

}


;// CONCATENATED MODULE: ./src/common/iServer/QueryByDistanceParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class QueryByDistanceParameters
 * @deprecatedclass SuperMap.QueryByDistanceParameters
 * @category  iServer Map QueryResults
 * @classdesc Distance æ¥è¯¢åæ°ç±»ã
 *            è¯¥ç±»ç¨äºè®¾ç½® Distance æ¥è¯¢çç¸å³åæ°ã
 * @extends {QueryParameters}
 * @param {Object} options - åæ°ã
 * @param {GeoJSONObject} options.geometry - ç¨äºæ¥è¯¢çå ä½å¯¹è±¡ã
 * @param {Array.<FilterParameter>} options.queryParams - æ¥è¯¢è¿æ»¤æ¡ä»¶åæ°æ°ç»ã
 * @param {number} options.distance - æ¥è¯¢è·ç¦»ï¼åä½ä¸ææ¥è¯¢å¾å±å¯¹åºçæ°æ®éåä½ç¸åãè·ç¦»æ¥è¯¢æ¶ï¼è¡¨ç¤ºè·ç¦»å°ç©çè·ç¦»ãæè¿å°ç©æ¥è¯¢æ¶ï¼è¡¨ç¤ºæç´¢çèå´ãæ­¤ä¸ºå¿éåæ°ã
 * @param {string} [options.customParams] - èªå®ä¹åæ°ï¼ä¾æ©å±ä½¿ç¨ã
 * @param {Object} [options.prjCoordSys] -èªå®ä¹åæ°ï¼ä¾ SuperMap Online æä¾çå¨ææå½±æ¥è¯¢æ©å±ä½¿ç¨ãå¦ {"epsgCode":3857}ã
 * @param {number} [options.expectCount=100000] - ææè¿åç»æè®°å½ä¸ªæ°ã
 * @param {GeometryType} [options.networkType=GeometryType.LINE] - ç½ç»æ°æ®éå¯¹åºçæ¥è¯¢ç±»åã
 * @param {QueryOption} [options.queryOption=QueryOption.ATTRIBUTEANDGEOMETRY] - æ¥è¯¢ç»æç±»åæä¸¾ç±»ã
 * @param {number} [options.startRecord=0] - æ¥è¯¢èµ·å§è®°å½å·ã
 * @param {number} [options.holdTime=10] - èµæºå¨æå¡ç«¯ä¿å­çæ¶é´ï¼åä½ä¸ºåéã
 * @param {boolean} [options.returnCustomResult=false] -ä»ä¾ä¸ç»´ä½¿ç¨ã
 * @param {boolean} [options.isNearest=false] - æ¯å¦ä¸ºæè¿è·ç¦»æ¥è¯¢ã
 * @param {boolean} [options.returnContent=true] - æ¯å¦ç«å³è¿åæ°åå»ºèµæºçè¡¨è¿°è¿æ¯è¿åæ°èµæºç URIã
 * @param {boolean} [options.returnFeatureWithFieldCaption = false] - è¿åçæ¥è¯¢ç»æè¦ç´ å­æ®µæ è¯æ¯å¦ä¸ºå­æ®µå«åãä¸º false æ¶ï¼è¿åçæ¯å­æ®µåï¼ä¸º true æ¶ï¼è¿åçæ¯å­æ®µå«åã
 * @usage
 */
class QueryByDistanceParameters extends QueryParameters {


    constructor(options) {
        options = options || {};
        super(options);
        /**
         * @member {number} [QueryByDistanceParameters.prototype.distance=0]
         * @description æ¥è¯¢è·ç¦»ï¼åä½ä¸ææ¥è¯¢å¾å±å¯¹åºçæ°æ®éåä½ç¸åã
         *              è·ç¦»æ¥è¯¢æ¶ï¼è¡¨ç¤ºè·ç¦»å°ç©çè·ç¦»ãæè¿å°ç©æ¥è¯¢æ¶ï¼è¡¨ç¤ºæç´¢çèå´ã
         */

        /**
         * @member {GeoJSONObject} QueryByDistanceParameters.prototype.geometry
         * @description ç¨äºæ¥è¯¢çå°çå¯¹è±¡ã<br>
         * ç¹ç±»åå¯ä»¥æ¯ï¼{@link GeometryPoint}|{@link L.Marker}|{@link L.CircleMarker}|{@link L.Circle}|{@link L.GeoJSON}|{@link ol.geom.Point}|{@link ol.format.GeoJSON}|{@link mapboxgl.LngLat}|{@link mapboxgl.Point}|{@link GeoJSONObject}ã<br>
         * çº¿ç±»åå¯ä»¥æ¯ï¼{@link GeometryLineString}|{@link GeometryLinearRing}|{@link L.Polyline}|{@link L.GeoJSON}|{@link ol.geom.LineString}|{@link ol.format.GeoJSON}|{@link GeoJSONObject}ã<br>
         * é¢ç±»åå¯ä»¥æ¯ï¼{@link GeometryPolygon}|{@link L.Polygon}|{@link L.GeoJSON}|{@link ol.geom.Polygon}|{@link ol.format.GeoJSON}|{@link mapboxgl.LngLatBounds}|{@link GeoJSONObject}ã
         */
        this.geometry = null;

        /**
         * @member {boolean} [QueryByDistanceParameters.prototype.isNearest=false]
         * @description æ¯å¦ä¸ºæè¿è·ç¦»æ¥è¯¢ã<br>
         *               å»ºè®®è¯¥å±æ§ä¸ expectCountï¼ç»§æ¿èª {@link QueryParameters}ï¼å±æ§èåä½¿ç¨ã
         *               å½è¯¥å±æ§ä¸º true æ¶ï¼å³è¡¨ç¤ºæ¥æ¾æè¿å°ç©ï¼å¦ææ¥è¯¢ç»ææ°å¤§äºææè¿åçç»æè®°å½æ°ï¼expectCountï¼ï¼
         *               åæ¥æ¾ç»æä¸ºæ¥è¯¢æ»è®°å½ä¸­è·ç¦»ä¸­å¿æè¿ç expectCount ä¸ªå°ç©ã
         *               å½è¯¥å±æ§ä¸ºä¸ä¸º true æ¶ï¼å¦ææ¥è¯¢ç»ææ°å¤§äºææè¿åçç»æè®°å½æ°ï¼expectCountï¼ï¼
         *               åæ¥æ¾ç»æä¸ºä»æ¥è¯¢æ»è®°å½ä¸­éæºæ½åç expectCount ä¸ªå°ç©ã
         *               ç®åæ¥è¯¢ç»æä¸æ¯ææè¿è¿è·ç¦»æåºã
         */
        this.isNearest = null;

        /**
         * @member {boolean} [QueryByDistanceParameters.prototype.returnContent=true]
         * @description æ¯å¦ç«å³è¿åæ°åå»ºèµæºçè¡¨è¿°è¿æ¯è¿åæ°èµæºç URIã
         *               å¦æä¸º trueï¼åç´æ¥è¿åæ°åå»ºèµæºï¼å³æ¥è¯¢ç»æçè¡¨è¿°ã
         *               ä¸º falseï¼åè¿åçæ¯æ¥è¯¢ç»æèµæºç URIã
         */
        this.returnContent = true;


        Util.extend(this, options);

        this.CLASS_NAME = "SuperMap.QueryByDistanceParameters";
    }

    /**
     * @function QueryByDistanceParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        super.destroy();
        var me = this;
        me.returnContent = null;
        me.distance = null;
        me.isNearest = null;
        if (me.geometry) {
            me.geometry.destroy();
            me.geometry = null;
        }
    }


}

;// CONCATENATED MODULE: ./src/common/iServer/QueryByDistanceService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class QueryByDistanceService
 * @deprecatedclass SuperMap.QueryByDistanceService
 * @category  iServer Map QueryResults
 * @classdesc Distanceæ¥è¯¢æå¡ç±»ã
 * @extends {QueryService}
 * @example
 * var myQueryByDistService = new QueryByDistanceService(url, {
 *     eventListeners: {
 *         "processCompleted": queryCompleted,
 *		   "processFailed": queryError
 *		   }
 * });
 * function queryCompleted(object){//todo};
 * function queryError(object){//todo};
 * @param {string} url - æå¡å°åãå¦è®¿é®World Mapæå¡ï¼åªéå°urlè®¾ä¸ºï¼http://localhost:8090/iserver/services/map-world/rest/maps/World+Map å³å¯ã
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - äºä»¶çå¬å¨å¯¹è±¡ãæprocessCompletedå±æ§å¯ä¼ å¥å¤çå®æåçåè°å½æ°ãprocessFailedå±æ§ä¼ å¥å¤çå¤±è´¥åçåè°å½æ°ã
 * @param {DataFormat} [options.format=DataFormat.GEOJSON] - æ¥è¯¢ç»æè¿åæ ¼å¼ï¼ç®åæ¯æ iServerJSON å GeoJSON ä¸¤ç§æ ¼å¼ãåæ°æ ¼å¼ä¸º "ISERVER"ï¼"GEOJSON"ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class QueryByDistanceService extends QueryService {

    constructor(url, options) {
        super(url, options);
        this.CLASS_NAME = "SuperMap.QueryByDistanceService";
    }

    /**
     * @override
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function QueryByDistanceService.prototype.getJsonParameters
     * @description å°æ¥è¯¢åæ°è½¬åä¸º JSON å­ç¬¦ä¸²ã
     *              å¨æ¬ç±»ä¸­éåæ­¤æ¹æ³ï¼å¯ä»¥å®ç°ä¸åç§ç±»çæ¥è¯¢ï¼sql, geometry, distance, boundsç­ï¼ã
     * @param {QueryByDistanceParameters} params - Distance æ¥è¯¢åæ°ç±»ã
     * @returns {Object} è½¬ååç JSON å­ç¬¦ä¸²ã
     */
    getJsonParameters(params) {
        if (!(params instanceof QueryByDistanceParameters)) {
            return;
        }
        var me = this,
            jsonParameters = "",
            qp = me.getQueryParameters(params);
        var sg = ServerGeometry.fromGeometry(params.geometry);

        jsonParameters += params.isNearest ? "'queryMode':'FindNearest','queryParameters':" : "'queryMode':'DistanceQuery','queryParameters':";
        jsonParameters += Util.toJSON(qp);
        jsonParameters += ",'geometry':" + Util.toJSON(sg) + ",'distance':" + params.distance;
        jsonParameters = "{" + jsonParameters + "}";
        return jsonParameters;
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/QueryByGeometryParameters.js
 /* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
  * This program are made available under the terms of the Apache License, Version 2.0
  * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class QueryByGeometryParameters
 * @deprecatedclass SuperMap.QueryByGeometryParameters
 * @category  iServer Map QueryResults
 * @classdesc Geometry æ¥è¯¢åæ°ç±»ã
 *            è¯¥ç±»ç¨äºè®¾ç½® Geometryæ¥è¯¢çç¸å³åæ°ã
 * @extends {QueryParameters}
 * @param {Object} options - åæ°ã
 * @param {Array.<FilterParameter>} options.queryParams - æ¥è¯¢è¿æ»¤æ¡ä»¶åæ°æ°ç»ã
 * @param {GeoJSONObject} options.geometry - æ¥è¯¢çå ä½å¯¹è±¡ã
 * @param {string} [options.customParams] - èªå®ä¹åæ°ï¼ä¾æ©å±ä½¿ç¨ã
 * @param {QueryOption} [options.queryOption=QueryOption.ATTRIBUTEANDGEOMETRY] - æ¥è¯¢ç»æç±»åæä¸¾ç±»ã
 * @param {Object} [options.prjCoordSys] -èªå®ä¹åæ°ï¼ä¾SuperMap Onlineæä¾çå¨ææå½±æ¥è¯¢æ©å±ä½¿ç¨ãå¦ {"epsgCode":3857}ã
 * @param {number} [options.expectCount=100000] - ææè¿åç»æè®°å½ä¸ªæ°ã
 * @param {GeometryType} [options.networkType=GeometryType.LINE] - ç½ç»æ°æ®éå¯¹åºçæ¥è¯¢ç±»åã
 * @param {boolean} [options.returnCustomResult=false] -ä»ä¾ä¸ç»´ä½¿ç¨ã
 * @param {number} [options.startRecord=0] - æ¥è¯¢èµ·å§è®°å½å·ã
 * @param {number} [options.holdTime=10] - èµæºå¨æå¡ç«¯ä¿å­çæ¶é´ï¼åä½ä¸ºåéã
 * @param {boolean} [options.returnContent=true] - æ¯å¦ç«å³è¿åæ°åå»ºèµæºçè¡¨è¿°è¿æ¯è¿åæ°èµæºç URIã
 * @param {boolean} [options.returnFeatureWithFieldCaption = false] - è¿åçæ¥è¯¢ç»æè¦ç´ å­æ®µæ è¯æ¯å¦ä¸ºå­æ®µå«åãä¸º false æ¶ï¼è¿åçæ¯å­æ®µåï¼ä¸º true æ¶ï¼è¿åçæ¯å­æ®µå«åã
 * @param {SpatialQueryMode} [spatialQueryMode=SpatialQueryMode.INTERSECT] - ç©ºé´æ¥è¯¢æ¨¡å¼ã
 * @usage
 */
class QueryByGeometryParameters extends QueryParameters {


    constructor(options) {
        options = options || {};
        super(options);

        /**
         * @member {boolean} [QueryByGeometryParameters.prototype.returnContent=true]
         * @description æ¯å¦ç«å³è¿åæ°åå»ºèµæºçè¡¨è¿°è¿æ¯è¿åæ°èµæºç URIã<br>
         *              å¦æä¸º trueï¼åç´æ¥è¿åæ°åå»ºèµæºï¼å³æ¥è¯¢ç»æçè¡¨è¿°ã<br>
         *              ä¸º falseï¼åè¿åçæ¯æ¥è¯¢ç»æèµæºç URIã
         */
        this.returnContent = true;

        /**
         * @member {GeoJSONObject} QueryByGeometryParameters.prototype.geometry
         * @description ç¨äºæ¥è¯¢çå ä½å¯¹è±¡ã<br>
         * ç¹ç±»åå¯ä»¥æ¯ï¼{@link GeometryPoint}|{@link L.Marker}|{@link L.CircleMarker}|{@link L.Circle}|{@link L.GeoJSON}|{@link ol.geom.Point}|{@link ol.format.GeoJSON}|{@link mapboxgl.LngLat}|{@link mapboxgl.Point}|{@link GeoJSONObject}ã<br>
         * çº¿ç±»åå¯ä»¥æ¯ï¼{@link GeometryLineString}|{@link GeometryLinearRing}|{@link L.Polyline}|{@link L.GeoJSON}|{@link ol.geom.LineString}|{@link ol.format.GeoJSON}|{@link GeoJSONObject}ã<br>
         * é¢ç±»åå¯ä»¥æ¯ï¼{@link GeometryPolygon}|{@link L.Polygon}|{@link L.GeoJSON}|{@link ol.geom.Polygon}|{@link ol.format.GeoJSON}|{@link mapboxgl.LngLatBounds}|{@link GeoJSONObject}ã
         */
        this.geometry = null;

        /**
         * @member {SpatialQueryMode} [QueryByGeometryParameters.prototype.spatialQueryMode=SpatialQueryMode.INTERSECT]
         * @description ç©ºé´æ¥è¯¢æ¨¡å¼ã
         */
        this.spatialQueryMode = SpatialQueryMode.INTERSECT;

        Util.extend(this, options);

        this.CLASS_NAME = "SuperMap.QueryByGeometryParameters";
    }

    /**
     * @function QueryByGeometryParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        super.destroy();
        var me = this;
        me.returnContent = null;
        me.geometry = null;
        me.spatialQueryMode = null;
    }


}

;// CONCATENATED MODULE: ./src/common/iServer/QueryByGeometryService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class QueryByGeometryService
 * @deprecatedclass SuperMap.QueryByGeometryService
 * @category  iServer Map QueryResults
 * @classdesc Geometryæ¥è¯¢æå¡ç±»ã
 * @extends {QueryService}
 * @example
 * var myQueryByGeometryService = new QueryByGeometryService(url, {
 *     eventListeners: {
 *	      "processCompleted": queryCompleted,
 *		  "processFailed": queryError
 *		  }
 * });
 * function queryCompleted(object){//todo};
 * function queryError(object){//todo};
 * @param {string} url - æå¡å°åãå¦è®¿é®World Mapæå¡ï¼åªéå°urlè®¾ä¸º: http://localhost:8090/iserver/services/map-world/rest/maps/World+Map å³å¯ã
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - äºä»¶çå¬å¨å¯¹è±¡ãæprocessCompletedå±æ§å¯ä¼ å¥å¤çå®æåçåè°å½æ°ãprocessFailedå±æ§ä¼ å¥å¤çå¤±è´¥åçåè°å½æ°ã
 * @param {DataFormat} [options.format=DataFormat.GEOJSON] - æ¥è¯¢ç»æè¿åæ ¼å¼ï¼ç®åæ¯æ iServerJSON å GeoJSON ä¸¤ç§æ ¼å¼ãåæ°æ ¼å¼ä¸º "ISERVER"ï¼"GEOJSON"ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class QueryByGeometryService extends QueryService {
    constructor(url, options) {
        super(url, options);
        this.CLASS_NAME = "SuperMap.QueryByGeometryService";
    }

    /**
     * @override
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function QueryByGeometryService.prototype.getJsonParameters
     * @description å°æ¥è¯¢åæ°è½¬åä¸º JSON å­ç¬¦ä¸²ã
     *              å¨æ¬ç±»ä¸­éåæ­¤æ¹æ³ï¼å¯ä»¥å®ç°ä¸åç§ç±»çæ¥è¯¢ï¼sql, geometry, distance, boundsç­ï¼ã
     * @param {QueryByGeometryParameters} params - Geometry æ¥è¯¢åæ°ç±»ã
     * @returns {Object} è½¬ååç JSON å­ç¬¦ä¸²ã
     */
    getJsonParameters(params) {
        if (!(params instanceof QueryByGeometryParameters)) {
            return;
        }
        var me = this,
            jsonParameters = "",
            qp = null,
            geometry = params.geometry,
            sg = ServerGeometry.fromGeometry(geometry);
        qp = me.getQueryParameters(params);
        jsonParameters += "'queryMode':'SpatialQuery','queryParameters':";
        jsonParameters += Util.toJSON(qp) + ",'geometry':" + Util.toJSON(sg)
            + ",'spatialQueryMode':" + Util.toJSON(params.spatialQueryMode);
        jsonParameters = "{" + jsonParameters + "}";
        return jsonParameters;
    }

}


;// CONCATENATED MODULE: ./src/common/iServer/QueryBySQLParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class QueryBySQLParameters
 * @deprecatedclass SuperMap.QueryBySQLParameters
 * @category  iServer Map QueryResults
 * @classdesc SQL æ¥è¯¢åæ°ç±»ã
 *            è¯¥ç±»ç¨äºè®¾ç½® SQL æ¥è¯¢çç¸å³åæ°ã
 * @extends {QueryParameters}
 * @param {Object} options - åæ°ã
 * @param {Array.<FilterParameter>} options.queryParams - æ¥è¯¢è¿æ»¤æ¡ä»¶åæ°æ°ç»ã
 * @param {string} [options.customParams] - èªå®ä¹åæ°ï¼ä¾æ©å±ä½¿ç¨ã
 * @param {Object} [options.prjCoordSys] - èªå®ä¹åæ°ï¼ä¾ SuperMap Online æä¾çå¨ææå½±æ¥è¯¢æ©å±ä½¿ç¨ãå¦ {"epsgCode":3857}ã
 * @param {number} [options.expectCount=100000] - ææè¿åç»æè®°å½ä¸ªæ°ã
 * @param {GeometryType} [options.networkType=GeometryType.LINE] - ç½ç»æ°æ®éå¯¹åºçæ¥è¯¢ç±»åã
 * @param {QueryOption} [options.queryOption=QueryOption.ATTRIBUTEANDGEOMETRY] - æ¥è¯¢ç»æç±»åæä¸¾ç±»ã
 * @param {number} [options.startRecord=0] - æ¥è¯¢èµ·å§è®°å½å·ã
 * @param {number} [options.holdTime=10] - èµæºå¨æå¡ç«¯ä¿å­çæ¶é´ï¼åä½ä¸ºåéã
 * @param {boolean} [options.returnCustomResult=false] - ä»ä¾ä¸ç»´ä½¿ç¨ã
 * @param {boolean} [options.returnContent=true] - æ¯å¦ç«å³è¿åæ°åå»ºèµæºçè¡¨è¿°è¿æ¯è¿åæ°èµæºç URIã
 * @param {boolean} [options.returnFeatureWithFieldCaption = false] - è¿åçæ¥è¯¢ç»æè¦ç´ å­æ®µæ è¯æ¯å¦ä¸ºå­æ®µå«åãä¸º false æ¶ï¼è¿åçæ¯å­æ®µåï¼ä¸º true æ¶ï¼è¿åçæ¯å­æ®µå«åã
 * @usage
 */
class QueryBySQLParameters extends QueryParameters {

    constructor(options) {
        options = options || {};
        super(options);
        /**
         * @member {boolean} [QueryBySQLParameters.prototype.returnContent=true]
         * @description æ¯å¦ç«å³è¿åæ°åå»ºèµæºçè¡¨è¿°è¿æ¯è¿åæ°èµæºç URIã
         *              å¦æä¸º trueï¼åç´æ¥è¿åæ°åå»ºèµæºï¼å³æ¥è¯¢ç»æçè¡¨è¿°ã
         *              ä¸º falseï¼åè¿åçæ¯æ¥è¯¢ç»æèµæºç URIã
         */
        this.returnContent = true;
        Util.extend(this, options);
        this.CLASS_NAME = "SuperMap.QueryBySQLParameters";
    }

    /**
     * @function QueryBySQLParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        super.destroy();
        var me = this;
        me.returnContent = null;
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/QueryBySQLService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class QueryBySQLService
 * @deprecatedclass SuperMap.QueryBySQLService
 * @category  iServer Map QueryResults
 * @classdesc SQL æ¥è¯¢æå¡ç±»ãå¨ä¸ä¸ªæå¤ä¸ªæå®çå¾å±ä¸æ¥è¯¢ç¬¦å SQL æ¡ä»¶çç©ºé´å°ç©ä¿¡æ¯ã
 * @extends {QueryService}
 * @example
 * var queryParam = new FilterParameter({
 *     name: "Countries@World.1",
 *     attributeFilter: "Pop_1994>1000000000 and SmArea>900"
 * });
 * var queryBySQLParams = new QueryBySQLParameters({
 *     queryParams: [queryParam]
 * });
 * var myQueryBySQLService = new QueryBySQLService(url, {eventListeners: {
 *     "processCompleted": queryCompleted,
 *     "processFailed": queryError
 *	   }
 * });
 * queryBySQLService.processAsync(queryBySQLParams);
 * function queryCompleted(object){//todo};
 * function queryError(object){//todo};
 * @param {string} url - æå¡å°åãå¦è®¿é®World Mapæå¡ï¼åªéå°urlè®¾ä¸º: http://localhost:8090/iserver/services/map-world/rest/maps/World+Map å³å¯ã
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - äºä»¶çå¬å¨å¯¹è±¡ãæprocessCompletedå±æ§å¯ä¼ å¥å¤çå®æåçåè°å½æ°ãprocessFailedå±æ§ä¼ å¥å¤çå¤±è´¥åçåè°å½æ°ã
 * @param {DataFormat} [options.format=DataFormat.GEOJSON] - æ¥è¯¢ç»æè¿åæ ¼å¼ï¼ç®åæ¯æ iServerJSON å GeoJSON ä¸¤ç§æ ¼å¼ãåæ°æ ¼å¼ä¸º "ISERVER"ï¼"GEOJSON"ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class QueryBySQLService extends QueryService {
    constructor(url, options) {
        super(url, options);
        this.CLASS_NAME = "SuperMap.QueryBySQLService";
    }

    /**
     * @override
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function QueryBySQLService.prototype.getJsonParameters
     * @description å°æ¥è¯¢åæ°è½¬åä¸º JSON å­ç¬¦ä¸²ã
     *              å¨æ¬ç±»ä¸­éåæ­¤æ¹æ³ï¼å¯ä»¥å®ç°ä¸åç§ç±»çæ¥è¯¢ï¼sql, geometry, distance, boundsç­ï¼ã
     * @param {QueryBySQLParameters} params - SQL æ¥è¯¢åæ°ç±»ã
     * @returns {Object} è½¬ååç JSON å­ç¬¦ä¸²ã
     */
    getJsonParameters(params) {
        if (!(params instanceof QueryBySQLParameters)) {
            return;
        }
        var me = this,
            jsonParameters = "",
            qp = null;
        qp = me.getQueryParameters(params);
        jsonParameters += "'queryMode':'SqlQuery','queryParameters':";
        jsonParameters += Util.toJSON(qp);
        jsonParameters = "{" + jsonParameters + "}";
        return jsonParameters;
    }

}


;// CONCATENATED MODULE: ./src/common/iServer/RouteCalculateMeasureParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class RouteCalculateMeasureParameters
 * @deprecatedclass SuperMap.RouteCalculateMeasureParameters
 * @category  iServer SpatialAnalyst RouteCalculateMeasure
 * @classdesc åºäºè·¯ç±å¯¹è±¡è®¡ç®æå®ç¹ M å¼æä½çåæ°ç±»ãéè¿è¯¥ç±»æä¾åæ°ä¿¡æ¯ã
 * @param {Object} options - åæ°ã
 * @param {(Route|L.Polyline|ol.geom.LineString|GeoJSONObject)} options.sourceRoute - è·¯ç±å¯¹è±¡ãè¯¥å¯¹è±¡å¯ä»¥æ¯ç¨æ·èªå·±çææå¨æ°æ®æºä¸­æ¥è¯¢å¾å°çç¬¦åæ åçè·¯ç±å¯¹è±¡ã
 * @param {GeometryPoint|L.LatLng|L.Point|ol.geom.Point|mapboxgl.LngLat|Array.<number>} options.point - äºç»´å°çåæ ç¹å¯¹è±¡ï¼åå« x,y åæ å¼å±æ§çå¯¹è±¡ã
 * @param {number} [options.tolerance] - å®¹éå¼ã
 * @param {boolean} [options.isIgnoreGap=false] - æ¯å¦å¿½ç¥å­å¯¹è±¡ä¹é´çè·ç¦»ã
 * @usage
 */
class RouteCalculateMeasureParameters {

    constructor(options) {
        if (!options) {
            return this;
        }
        /**
         * @member {(Route|L.Polyline|ol.geom.LineString|GeoJSONObject)} RouteCalculateMeasureParameters.prototype.sourceRoute
         * @description è·¯ç±å¯¹è±¡ãè¯¥å¯¹è±¡å¯ä»¥æ¯ç¨æ·èªå·±çææå¨æ°æ®æºä¸­æ¥è¯¢å¾å°çç¬¦åæ åçè·¯ç±å¯¹è±¡ã
         */
        this.sourceRoute = null;

        /**
         * @member {GeometryPoint|L.LatLng|L.Point|ol.geom.Point|mapboxgl.LngLat|Array.<number>} RouteCalculateMeasureParameters.prototype.point
         * @description äºç»´å°çåæ ç¹å¯¹è±¡ï¼åå« x,y åæ å¼å±æ§çå¯¹è±¡ã
         */
        this.point = null;

        /**
         * @member {number} [RouteCalculateMeasureParameters.prototype.tolerance]
         * @description å®¹éå¼ã
         */
        this.tolerance = null;

        /**
         * @member {boolean} [RouteCalculateMeasureParameters.prototype.isIgnoreGap=false]
         * @description æ¯å¦å¿½ç¥å­å¯¹è±¡ä¹é´çè·ç¦»ã
         */
        this.isIgnoreGap = false;

        Util.extend(this, options);

        this.CLASS_NAME = "SuperMap.RouteCalculateMeasureParameters";
    }

    /**
     * @function RouteCalculateMeasureParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.sourceRoute = null;
        me.point = null;
        if (me.tolerance) {
            me.tolerance = null;
        }
        if (me.isIgnoreGap) {
            me.isIgnoreGap = false;
        }
    }
}

;// CONCATENATED MODULE: ./src/common/iServer/RouteCalculateMeasureService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class RouteCalculateMeasureService
 * @deprecatedclass SuperMap.RouteCalculateMeasureService
 * @category  iServer SpatialAnalyst RouteCalculateMeasure
 * @classdesc åºäºè·¯ç±å¯¹è±¡è®¡ç®æå®ç¹ M å¼æä½çæå¡ç±»ã
 *            è¯¥ç±»è´è´£å°å®¢æ·è®¾ç½®çè®¡ç®æå®ç¹ç M å¼åæ°ä¼ éç»æå¡ç«¯ï¼å¹¶æ¥æ¶æå¡ç«¯è¿åç
 *            æå®ç¹ç M å¼ãéè¿è¯¥ç±»æ¯æçäºä»¶ççå¬å½æ°åæ°è·åã
 * @extends {SpatialAnalystBase}
 * @param {string} url - æå¡å°åãå¦ http://localhost:8090/iserver/services/spatialanalyst-changchun/restjsr/spatialanalyst
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - éè¦è¢«æ³¨åççå¬å¨å¯¹è±¡ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @example å®ä¾åè¯¥ç±»å¦ä¸ä¾æç¤ºï¼
 * (start code)
 * var parameters = new RouteCalculateMeasureParameters({
     *     "sourceRoute":{
     *         "type":"LINEM",
     *        "parts":[4],
     *         "points":[
     *             {
     *                 "measure":0,
     *                 "y":-6674.466867067764,
     *                 "x":3817.3527876130133
     *             },
     *             {
     *                 "measure":199.57954019411724,
     *                 "y":-6670.830929417594,
     *                 "x":3617.806369901496
     *             },
     *             {
     *                 "measure":609.3656478634477,
     *                "y":-6877.837541432356,
     *                 "x":3264.1498746678444
     *             },
     *             {
     *                 "measure":936.0174126282958,
     *                 "y":-7038.687780615184,
     *                 "x":2979.846206068903
     *             }
     *         ]
     *     },
     *     "tolerance":1,
     *     "point":{
     *         "x":3330.7754269417,
     *         "y":-6838.8394457216
     *     },
     *     "isIgnoreGap":false
     * });
 *
 * var routeCalculateMeasureService = new RouteCalculateMeasureService(spatialAnalystURL, {
     *     eventListeners:{
     *         processCompleted:calculateCompleted,
     *         processFailed:calculateFailded
     *     }
     * );
     * routeCalculateMeasureService.processAsync(parameters);
     *
     *  //æ§è¡
     * function calculateCompleted(){todo}
     * function calculateFailded(){todo}
     * (end)
     * @usage
     */
class RouteCalculateMeasureService extends SpatialAnalystBase {

    constructor(url, options) {
        super(url, options);
        this.CLASS_NAME = "SuperMap.RouteCalculateMeasureService";
    }

    /**
     * @override
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function RouteCalculateMeasureService.prototype.processAsync
     * @description è´è´£å°å®¢æ·ç«¯çåºäºè·¯ç±å¯¹è±¡è®¡ç®æå®ç¹ M å¼æä½çåæ°ä¼ éå°æå¡ç«¯ã
     * @param {RouteCalculateMeasureParameters} params - åºäºè·¯ç±å¯¹è±¡è®¡ç®æå®ç¹ M å¼æä½çåæ°ç±»ã
     */
    processAsync(params) {
        if (!(params instanceof RouteCalculateMeasureParameters)) {
            return;
        }
        var me = this, jsonParameters;

        jsonParameters = me.getJsonParameters(params);

        me.request({
            method: "POST",
            data: jsonParameters,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }

    /**
     * @function RouteCalculateMeasureService.prototype.getJsonParameters
     * @description å°åæ°è½¬åä¸º JSON å­ç¬¦ä¸²ã
     * @param {RouteCalculateMeasureParameters} params - åºäºè·¯ç±å¯¹è±¡è®¡ç®æå®ç¹ M å¼æä½çåæ°ç±»ã
     * @returns {Object} è½¬ååç JSON å­ç¬¦ä¸²ã
     */
    getJsonParameters(params) {
        var jsonParameters, jsonStr = "geometry/calculatemeasure", me = this;
        me.url = Util.urlPathAppend(me.url, jsonStr);
        me.url = Util.urlAppend(me.url, 'returnContent=true');
        jsonParameters = Util.toJSON(params);
        return jsonParameters;
    }

}


;// CONCATENATED MODULE: ./src/common/iServer/RouteLocatorParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class RouteLocatorParameters
 * @deprecatedclass SuperMap.RouteLocatorParameters
 * @category  iServer SpatialAnalyst RouteLocator
 * @classdesc è·¯ç±å¯¹è±¡å®ä½ç©ºé´å¯¹è±¡çåæ°ç±»ã
 * åæ°æä¸¤ç§æ¹å¼ï¼åå«ä¸º Geometry å Dataset ä¸¤ç§ï¼åèéè¦æå® sourceRoute å¯¹è±¡ä½ä¸ºåæ°ï¼åèéè¦ datasetï¼routeIDFieldï¼routeID ä¸ä¸ªåæ°
 * å¦æç¨æ·ä¸¤ç§åæ°åè®¾ç½®ï¼ä¼åéæ© Dataset æ¹å¼ã
 * @param {Object} options - åæ°ã
 * @param {(Route|L.Polyline|ol.geom.LineString|GeoJSONObject)} options.sourceRoute - è·¯ç±å¯¹è±¡ã
 * @param {number} options.measure - å®ä½ç¹ç M å¼ãåªå½è·¯ç±å¯¹è±¡å®ä½ç¹æ¶ææä¹ã
 * @param {string} [options.type] -  ç±»åï¼ç¹ or çº¿ã
 * @param {number} [options.offset=0] - å®ä½ç¹åç§»éãåªå½è·¯ç±å¯¹è±¡å®ä½ç¹æ¶ææä¹ã
 * @param {boolean} [options.isIgnoreGap=false] - æ¯å¦å¿½ç¥å­å¯¹è±¡ä¹é´çè·ç¦»ãå³ä¸å¿½ç¥å­å¯¹è±¡ä¹é´çè·ç¦»ã
 * @param {number} [options.startMeasure] - å®ä½çº¿çèµ·å§ M å¼ãåªå½è·¯ç±å¯¹è±¡å®ä½çº¿æ¶ææä¹ã
 * @param {number} [options.endMeasure] - å®ä½çº¿çç»æ­¢ M å¼ãåªå½è·¯ç±å¯¹è±¡å®ä½çº¿æ¶ææä¹ã
 * @usage
 */
class RouteLocatorParameters {

    constructor(options) {
        if (!options) {
            return this;
        }
        /**
         * @member {(Route|L.Polyline|ol.geom.LineString|GeoJSONObject)} RouteLocatorParameters.prototype.sourceRoute
         * @description è·¯ç±å¯¹è±¡ã
         */
        this.sourceRoute = null;

        /**
         * @member {string} RouteLocatorParameters.prototype.dataset
         * @description è¦ç¨æ¥åç¼å²åºåæçæ°æ®æºä¸­æ°æ®éçåç§°ãè¯¥åç§°ç¨å½¢å¦"æ°æ®éåç§°@æ°æ®æºå«å"å½¢å¼æ¥è¡¨ç¤ºã
         */
        this.dataset = null;

        /**
         * @member {string} RouteLocatorParameters.prototype.routeIDField
         * @description  è·¯ç±å¯¹è±¡æå¨çå­æ®µåç§°ã
         *
         */
        this.routeIDField = null;

        /**
         * @member {number} RouteLocatorParameters.prototype.routeID
         * @description è·¯ç±å¯¹è±¡æ è¯ã
         *
         */
        this.routeID = null;

        /**
         * @member {string} [RouteLocatorParameters.prototype.type]
         * @description ç±»åï¼ç¹ or çº¿ã
         * å¯éå¼ä¸º:
         * LINE :æ ¹æ®èµ·å§ M å¼åç»æ­¢ M å¼å®ä½çº¿å¯¹è±¡ã
         * POINT : æ ¹æ® M å¼å®ä½ç¹å¯¹è±¡ã
         */
        this.type = null;

        /**
         * @member {number} RouteLocatorParameters.prototype.measure
         * @description å®ä½ç¹ç M å¼ãåªå½è·¯ç±å¯¹è±¡å®ä½ç¹æ¶ææä¹ã
         */
        this.measure = null;

        /**
         * @member {number} [RouteLocatorParameters.prototype.offset=0]
         * @description å®ä½ç¹åç§»éãåªå½è·¯ç±å¯¹è±¡å®ä½ç¹æ¶ææä¹ã
         */
        this.offset = 0;

        /**
         * @member {boolean} [RouteLocatorParameters.prototype.isIgnoreGap=false]
         * @description æ¯å¦å¿½ç¥å­å¯¹è±¡ä¹é´çè·ç¦»ã
         */
        this.isIgnoreGap = false;

        /**
         *  @member {number} [RouteLocatorParameters.prototype.startMeasure]
         *  @description å®ä½çº¿çèµ·å§ M å¼ãåªå½è·¯ç±å¯¹è±¡å®ä½çº¿æ¶ææä¹ã
         */
        this.startMeasure = null;

        /**
         *  @member {number} [RouteLocatorParameters.prototype.endMeasure]
         *  @description å®ä½çº¿çç»æ­¢ M å¼ãåªå½è·¯ç±å¯¹è±¡å®ä½çº¿æ¶ææä¹ã
         */
        this.endMeasure = null;

        var routeFromClient = options.sourceRoute;
        var routeHandle = {};
        if (routeFromClient && routeFromClient instanceof Geometry && routeFromClient.components) {
            routeHandle.type = routeFromClient.type;
            routeHandle.parts = routeFromClient.parts;
            var parts = [];
            for (var i = 0, len = routeFromClient.components.length; i < len; i++) {
                parts = parts.concat(routeFromClient.components[i].components);
            }
            routeHandle.points = parts;
            options.sourceRoute = routeHandle;
        }
        Util.extend(this, options);
        this.CLASS_NAME = "SuperMap.RouteLocatorParameters";
    }


    /**
     * @function RouteLocatorParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.sourceRoute = null;
        me.type = null;
        me.measure = null;
        me.offset = 0;
        me.isIgnoreGap = false;
        me.startMeasure = null;
        me.endMeasure = null;
        me.dataset = null;
        me.routeID = null;
        me.routeIDField = null;
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/RouteLocatorService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class RouteLocatorService
 * @deprecatedclass SuperMap.RouteLocatorService
 * @category iServer SpatialAnalyst RouteLocator
 * @classdesc è·¯ç±å¯¹è±¡å®ä½ç©ºé´å¯¹è±¡çæå¡ç±»ã
 * @extends {SpatialAnalystBase}
 * @param {string} url -æå¡å°åãå¦ http://localhost:8090/iserver/services/spatialanalyst-changchun/restjsr/spatialanalystã
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - éè¦è¢«æ³¨åççå¬å¨å¯¹è±¡ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @example å®ä¾åè¯¥ç±»å¦ä¸ä¾æç¤ºï¼
 * (start code)
 * var routeLocatorParameters_point = new RouteLocatorParameters({
     *   "sourceRoute":{
     *       "type":"LINEM",
     *       "parts":[4],
     *       "points":[
     *           {
     *               "measure":0,
     *               "y":-6674.466867067764,
     *               "x":3817.3527876130133
     *           },
     *           {
     *               "measure":199.57954019411724,
     *               "y":-6670.830929417594,
     *               "x":3617.806369901496
     *          },
     *           {
     *               "measure":609.3656478634477,
     *               "y":-6877.837541432356,
     *               "x":3264.1498746678444
     *           },
     *           {
     *               "measure":936.0174126282958,
     *               "y":-7038.687780615184,
     *               "x":2979.846206068903
     *           }
     *       ]
     *   },
     *   "type":"POINT",
     *   "measure":10,
     *   "offset":3,
     *   "isIgnoreGap":true
     * });
     * var routeLocatorService = new RouteLocatorService(spatialAnalystURL, {
     *     eventListeners:{
     *         processCompleted:routeLocatorCompleted,
     *         processFailed:routeLocatorFailded
     *     }
     * );
     * routeLocatorService.processAsync(routeLocatorParameters_point);
     *
     *  //æ§è¡
     * function routeLocatorCompleted(){todo}
     * function routeLocatorFailded(){todo}
     * (end)
     * @usage
     */
class RouteLocatorService extends SpatialAnalystBase {

    constructor(url, options) {
        super(url, options);
        this.CLASS_NAME = "SuperMap.RouteLocatorService";
    }

    /**
     * @override
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function RouteLocatorService.prototype.processAsync
     * @description è´è´£å°å®¢æ·ç«¯çåºäºè·¯ç±å¯¹è±¡è®¡ç®æå®ç¹ M å¼æä½çåæ°ä¼ éå°æå¡ç«¯ã
     * @param {RouteLocatorParameters} params - è·¯ç±å¯¹è±¡å®ä½ç©ºé´å¯¹è±¡çåæ°ç±»ã
     */
    processAsync(params) {
        if (!(params instanceof RouteLocatorParameters)) {
            return;
        }
        var me = this, jsonParameters;

        jsonParameters = me.getJsonParameters(params);

        me.request({
            method: "POST",
            data: jsonParameters,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }

    /**
     * @function RouteLocatorService.prototype.processAsync
     * @description å°åæ°è½¬åä¸º JSON å­ç¬¦ä¸²ã
     * @param {RouteLocatorParameters} params - è·¯ç±å¯¹è±¡å®ä½ç©ºé´å¯¹è±¡çåæ°ç±»ã
     * @returns {Object} è½¬ååçJSONå­ç¬¦ä¸²ã
     */
    getJsonParameters(params) {
        var jsonParameters, jsonStr = "geometry/routelocator", me = this;

        if (params.dataset) {
            jsonStr = "datasets/" + params.dataset + "/linearreferencing/routelocator";
            params.sourceRoute = null;
        }
        me.url = Util.urlPathAppend(me.url, jsonStr);
        me.url = Util.urlAppend(me.url, 'returnContent=true');
        jsonParameters = Util.toJSON(params);
        return jsonParameters;
    }

}


;// CONCATENATED MODULE: ./src/common/iServer/ServerFeature.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class ServerFeature
 * @deprecatedclass SuperMap.ServerFeature
 * @category  iServer Data Feature
 * @classdesc æå¡ç«¯ç¢éè¦ç´ ç±»ãè¯¥ç±»æè¿°äºæå¡ç«¯è¿åçç¢éè¦ç´ çç¸å³ä¿¡æ¯ï¼åæ¬å­æ®µåå ä½ä¿¡æ¯ã
 * @param {ServerGeometry} geometry - ç¢éè¦ç´ çå ä½ä¿¡æ¯ã
 * @param {Object} options - åæ°ã
 * @param {Array.<string>} [options.fieldNames] - ç¢éè¦ç´ çå±æ§å­æ®µåéåã
 * @param {Array.<string>} [options.fieldValues] - ç¢éè¦ç´ çå±æ§å­æ®µå¼éåã
 * @usage
 */
class ServerFeature {

    constructor(options) {

        /**
         * @member {Array.<string>} [ServerFeature.prototype.fieldNames]
         * @description ç¢éè¦ç´ çå±æ§å­æ®µåéåã
         */
        this.fieldNames = null;

        /**
         * @member {Array.<string>} [ServerFeature.prototype.fieldValues]
         * @description ç¢éè¦ç´ çå±æ§å­æ®µå¼éåã
         */
        this.fieldValues = null;

        /**
         * @member {ServerGeometry} ServerFeature.prototype.geometry
         * @description ç¢éè¦ç´ çå ä½ä¿¡æ¯ã
         */
        this.geometry = null;
        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = "SuperMap.ServerFeature";
    }

    /**
     * @function ServerFeature.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.fieldNames = null;
        me.fieldValues = null;
        if (me.geometry) {
            me.geometry.destroy();
            me.geometry = null;
        }
    }

    /**
     * @function ServerFeature.prototype.toFeature
     * @description å°æå¡ç«¯ç¢éè¦ç´  ServerFeature è½¬æ¢ä¸ºå®¢æ·ç«¯ç¢éè¦ç´  Featureã
     * @returns {Vector} è½¬æ¢åçå®¢æ·ç«¯ç¢éè¦ç´ ã
     */
    toFeature() {
        var names, values, geo,
            attr = {},
            me = this,
            feature;

        names = me.fieldNames;
        values = me.fieldValues;
        for (var i in names) {
            attr[names[i]] = values[i];
        }
        if (me.geometry) {
            geo = me.geometry.toGeometry();
        }
        feature = new Vector(geo, attr);
        if (me.geometry && me.geometry.id) {
            feature.fid = me.geometry.id;
        }

        return feature;
    }

    /**
     * @function ServerFeature.prototype.fromJson
     * @description å° JSON å¯¹è±¡è¡¨ç¤ºæå¡ç«¯ç¢éè¦ç´ è½¬æ¢ä¸º ServerFeatureã
     * @param {Object} jsonObject - è¦è½¬æ¢ç JSON å¯¹è±¡ã
     * @returns {ServerFeature} è½¬ååç ServerFeature å¯¹è±¡ã
     */
    static fromJson(jsonObject) {
        var geo = null;
        if (!jsonObject) {
            return;
        }
        geo = jsonObject.geometry;
        if (geo) {
            geo = ServerGeometry.fromJson(geo);
        }
        return new ServerFeature({
            fieldNames: jsonObject.fieldNames,
            fieldValues: jsonObject.fieldValues,
            geometry: geo
        });
    }

}


;// CONCATENATED MODULE: ./src/common/iServer/SetDatasourceParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class SetDatasourceParameters
 * @deprecatedclass SuperMap.SetDatasourceParameters
 * @category iServer Data Datasource
 * @classdesc è®¾ç½®æ°æ®æºä¿¡æ¯åæ°ç±»ã
 * @param {Object} options - åæ°ã
 * @param {string} options.datasourceName - æ°æ®æºåç§°ã
 * @param {string} options.description - æ°æ®æºæè¿°ä¿¡æ¯ã
 * @param {string} options.coordUnit - åæ åä½ã
 * @param {string} options.distanceUnit - è·ç¦»åä½ã
 * @usage
 */
class SetDatasourceParameters {

    constructor(options) {
        if (!options) {
            return;
        }

        /**
         * @member {string} SetDatasourceParameters.prototype.datasourceName
         * @description æ°æ®æºåç§°ã
         */
        this.datasourceName = null;

        /**
         * @member {string} SetDatasourceParameters.prototype.description
         * @description æ°æ®æºæè¿°ä¿¡æ¯ã
         */
        this.description = null;

        /**
         * @member {string} SetDatasourceParameters.prototype.coordUnit
         * @description åæ åä½ã
         */
        this.coordUnit = null;

        /**
         * @member {string} SetDatasourceParameters.prototype.distanceUnit
         * @description è·ç¦»åä½ã
         */
        this.distanceUnit = null;

        if (options) {
            Util.extend(this, options);
        }
        this.CLASS_NAME = "SuperMap.SetDatasourceParameters";
    }

    /**
     * @function SetDatasourceParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.datasourceName = null;
        me.description = null;
        me.coordUnit = null;
        me.distanceUnit = null;
    }

}


;// CONCATENATED MODULE: ./src/common/iServer/SetLayerInfoParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class SetLayerInfoParameters
 * @deprecatedclass SuperMap.SetLayerInfoParameters
 * @category  iServer Map TempLayersSet
 * @classdesc è®¾ç½®å¾å±ä¿¡æ¯åæ°ç±»ã
 * @param {Object} options - åæ°ã
 * @param {string} options.resourceID - ä¸´æ¶å¾å±çèµæº IDã
 * @param {string} options.tempLayerName - ä¸´æ¶å¾å±ä¸çå­å¾å±åã
 * @param {string} options.layerInfo - è¦æ´æ°çå¾å±ä¿¡æ¯ã
 * @usage
 */
class SetLayerInfoParameters {

    constructor(options) {
        options = options || {};
        /**
         * @member {string} SetLayerInfoParameters.prototype.resourceID
         * @description ä¸´æ¶å¾å±çèµæº IDã
         */
        this.resourceID = null;

        /**
         * @member {string} SetLayerInfoParameters.prototype.tempLayerName
         * @description ä¸´æ¶å¾å±ä¸å­å¾å±ï¼æèå¶å­å¾å±ï¼åï¼å¦ï¼Countries@World.3@@Worldã
         */
        this.tempLayerName = null;

        /**
         * @member {Object} SetLayerInfoParameters.prototype.layerInfo
         * @description è¦æ´æ°çå¾å±ä¿¡æ¯ï¼åå«ä¿®æ¹åæªä¿®æ¹çææå­æ®µï¼ãè¯¥åæ°å¯ä»¥éè¿å¾å±ä¿¡æ¯æå¡è·åï¼ç¶åå¯¹è¿åå¼ä¸­ subLayers.layers[i] å¾å±ä¿¡æ¯å±æ§è¿è¡ä¿®æ¹ã
         */
        this.layerInfo = null;

        Util.extend(this, options);

        this.CLASS_NAME = "SuperMap.SetLayerInfoParameters";
    }

    /**
     * @function SetLayerInfoParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.resourceID = null;
        me.tempLayerName = null;
        me.layerInfo = null;
    }

}


;// CONCATENATED MODULE: ./src/common/iServer/SetLayerInfoService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class SetLayerInfoService
 * @deprecatedclass SuperMap.SetLayerInfoService
 * @category  iServer Map TempLayersSet
 * @classdesc è®¾ç½®å¾å±ä¿¡æ¯æå¡ç±»ãå¯ä»¥å®ç°ä¸´æ¶å¾å±ä¸­å­å¾å±çä¿®æ¹
 *            è¯¥ç±»è´è´£å°å¾å±è®¾ç½®åæ°ä¼ éå°æå¡ç«¯ï¼å¹¶è·åæå¡ç«¯è¿åçç»æä¿¡æ¯ã
 * @extends {CommonServiceBase}
 * @param {string} url - æå¡å°åãè¯·æ±å°å¾æå¡ï¼URL åºä¸ºï¼
 *                 http://{æå¡å¨å°å}:{æå¡ç«¯å£å·}/iserver/services/{å°å¾æå¡å}/rest/maps/{å°å¾å}/tempLayersSet/{tempLayerID}/Rivers@World@@World"ï¼
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - äºä»¶çå¬å¨å¯¹è±¡ãæprocessCompletedå±æ§å¯ä¼ å¥å¤çå®æåçåè°å½æ°ãprocessFailedå±æ§ä¼ å¥å¤çå¤±è´¥åçåè°å½æ°ã
 * @param {DataFormat} [options.format=DataFormat.GEOJSON] - æ¥è¯¢ç»æè¿åæ ¼å¼ï¼ç®åæ¯æ iServerJSON å GeoJSON ä¸¤ç§æ ¼å¼ãåæ°æ ¼å¼ä¸º "ISERVER"ï¼"GEOJSON"ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class SetLayerInfoService extends CommonServiceBase {


    constructor(url, options) {
        super(url, options);
        if (options) {
            Util.extend(this, options);
        }
        this.CLASS_NAME = "SuperMap.SetLayerInfoService";
    }

    /**
     * @override
     */
    destroy() {
        super.destroy();
        Util.reset(this);
    }

    /**
     * @function SetLayerInfoService.prototype.processAsync
     * @description è´è´£å°å®¢æ·ç«¯çæ´æ°åæ°ä¼ éå°æå¡ç«¯ã
     * @param {Object} params - ä¿®æ¹åçå¾å±èµæºä¿¡æ¯ã
     *        è¯¥åæ°å¯ä»¥ä½¿ç¨è·åå¾å±ä¿¡æ¯æå¡<{@link GetLayersInfoService}>è¿åå¾å±ä¿¡æ¯ï¼è§£æç»æresult.subLayers.layers[i]ï¼ç¶åå¯¹å¶å±æ§è¿è¡ä¿®æ¹æ¥è·åã
     */
    processAsync(params) {
        if (!params) {
            return;
        }
        var me = this;
        var jsonParamsStr = Util.toJSON(params);
        me.request({
            method: "PUT",
            data: jsonParamsStr,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }
}


;// CONCATENATED MODULE: ./src/common/iServer/SetLayersInfoParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class SetLayersInfoParameters
 * @deprecatedclass SuperMap.SetLayersInfoParameters
 * @category  iServer Map TempLayersSet
 * @classdesc è®¾ç½®å¾å±ä¿¡æ¯åæ°ç±»ã
 * @param {Object} options - åæ°ã
 * @param {boolean} [options.isTempLayers=false] - æ¯å¦æ¯ä¸´æ¶å¾å±ã
 * @param {string} options.resourceID - ä¸´æ¶å¾å±èµæº IDã
 * @param {Object} options.layersInfo - è¦æ´æ°çå¾å±ä¿¡æ¯ã
 * @usage
 */
class SetLayersInfoParameters {

    constructor(options) {
        options = options || {};
        /**
         * @member {boolean} [SetLayersInfoParameters.prototype.isTempLayers=false]
         * @description æ¯å¦æ¯ä¸´æ¶å¾å±ã
         */
        this.isTempLayers = null;
        /**
         * @member {string} SetLayersInfoParameters.prototype.resourceID
         * @description ä¸´æ¶å¾å±èµæº IDï¼
         */
        this.resourceID = null;

        /**
         * @member {Object} SetLayersInfoParameters.prototype.layersInfo
         * @description è¦æ´æ°çå¾å±ä¿¡æ¯ï¼åå«ä¿®æ¹åæªä¿®æ¹çææå­æ®µï¼ãè¯¥åæ°å¯ä»¥éè¿å¾å±ä¿¡æ¯æå¡è·åï¼ç¶åå¯¹è¿åå¼ä¸­ subLayers.layers[i] å¾å±ä¿¡æ¯å±æ§è¿è¡ä¿®æ¹ã
         */
        this.layersInfo = null;

        Util.extend(this, options);

        this.CLASS_NAME = "SuperMap.SetLayersInfoParameters";
    }


    /**
     * @function SetLayersInfoParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.isTempLayers = null;
        me.resourceID = null;
        me.layersInfo = null;
    }



}


;// CONCATENATED MODULE: ./src/common/iServer/SetLayersInfoService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class SetLayersInfoService
 * @deprecatedclass SuperMap.SetLayersInfoService
 * @category  iServer Map TempLayersSet
 * @classdesc  è®¾ç½®å¾å±ä¿¡æ¯æå¡ç±»ãå¯ä»¥å®ç°åå»ºæ°çä¸´æ¶å¾å±åå¯¹ç°æä¸´æ¶å¾å±çä¿®æ¹ï¼
 *             å½ isTempLayers ä¸º falseçæ¶åæ§è¡åå»ºä¸´æ¶å¾å±ãå½ isTempLayers ä¸º ture å¹¶ä¸ä¸´æ¶å¾å±èµæº resourceID è¢«è®¾ç½®æææ¶æ§è¡å¯¹ä¸´æ¶å¾å±çç¼è¾ã
 *             è¯¥ç±»è´è´£å°å¾å±è®¾ç½®åæ°ä¼ éå°æå¡ç«¯ï¼å¹¶è·åæå¡ç«¯è¿åçç»æä¿¡æ¯ã
 * @extends {CommonServiceBase}
 * @param url - {string} æå¡å°åãè¯·æ±å°å¾æå¡,URL åºä¸ºï¼
 *              http://{æå¡å¨å°å}:{æå¡ç«¯å£å·}/iserver/services/{å°å¾æå¡å}/rest/maps/{å°å¾å}ï¼
 * @param {Object} options - åæ°ã
 * @param {string} options.resourceID - å¾å±èµæºIDï¼ä¸´æ¶å¾å±çèµæºIDæ è®°ã
 * @param {boolean} options.isTempLayers - å½åurlå¯¹åºçå¾å±æ¯å¦æ¯ä¸´æ¶å¾å±ã
 * @param {Object} options.eventListeners - äºä»¶çå¬å¨å¯¹è±¡ãæprocessCompletedå±æ§å¯ä¼ å¥å¤çå®æåçåè°å½æ°ãprocessFailedå±æ§ä¼ å¥å¤çå¤±è´¥åçåè°å½æ°ã
 * @param {DataFormat} [options.format=DataFormat.GEOJSON] - æ¥è¯¢ç»æè¿åæ ¼å¼ï¼ç®åæ¯æ iServerJSON å GeoJSON ä¸¤ç§æ ¼å¼ãåæ°æ ¼å¼ä¸º "ISERVER"ï¼"GEOJSON"ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class SetLayersInfoService extends CommonServiceBase {


    constructor(url, options) {
        super(url, options);
        /**
         * @member {string} SetLayersInfoService.prototype.resourceID
         * @description å¾å±èµæºIDï¼ä¸´æ¶å¾å±çèµæºIDæ è®°ã
         */
        this.resourceID = null;

        /**
         * @function {boolean} SetLayersInfoService.prototype.isTempLayers
         * @description å½åurlå¯¹åºçå¾å±æ¯å¦æ¯ä¸´æ¶å¾å±ã
         */
        this.isTempLayers = false;

        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = "SuperMap.SetLayersInfoService";
    }

    /**
     * @override
     */
    destroy() {
        super.destroy();
        Util.reset(this);
    }

    /**
     * @function SetLayersInfoService.prototype.processAsync
     * @description è´è´£å°å®¢æ·ç«¯çæ´æ°åæ°ä¼ éå°æå¡ç«¯ã
     * @param {Object} params - ä¿®æ¹åçå¾å±èµæºä¿¡æ¯ãè¯¥åæ°å¯ä»¥ä½¿ç¨è·åå¾å±ä¿¡æ¯æå¡ <{@link GetLayersInfoService}>è¿åå¾å±ä¿¡æ¯ï¼ç¶åå¯¹å¶å±æ§è¿è¡ä¿®æ¹æ¥è·åã
     */
    processAsync(params) {
        if (!params) {
            return;
        }
        var jsonParams,
            subLayers = [],
            me = this,
            method = "";


        //åå»ºä¸´æ¶å¾å±åè®¾ç½®ä¿®æ¹ä¸´æ¶å¾å±ä¿¡æ¯å¯¹åºä¸åçèµæºURL
        if (me.isTempLayers) {
            me.url = Util.urlPathAppend(me.url, "tempLayersSet/" + me.resourceID);
            method = "PUT";
        } else {
            me.url = Util.urlPathAppend(me.url, "tempLayersSet");
            method = "POST";
        }
        if (!params.subLayers) {
            params.subLayers = {layers: []}
        }
        if (!params.subLayers.layers) {
            params.subLayers.layers = [];
        }
        var layers = params.subLayers.layers,
            len = layers.length;
        for (let i in layers) {
            if (layers[i].ugcLayerType === "GRID") {
                var colorDictionary = {};
                var colorDics = layers[i].colorDictionarys;
                for (var j in colorDics) {
                    var key = colorDics[j].elevation;
                    colorDictionary[key] = colorDics[j].color;
                }
            }
            layers[i].colorDictionary = colorDictionary;
            delete layers[i].colorDictionarys;
        }

        for (let i = 0; i < len; i++) {
            if (layers[i].toJsonObject) {
                //å°å¾å±ä¿¡æ¯è½¬æ¢ææå¡ç«¯è½è¯å«çç®åjsonå¯¹è±¡
                subLayers.push(layers[i].toJsonObject());
            } else {
                subLayers.push(layers[i]);
            }
        }
        jsonParams = Util.extend(jsonParams, params);
        jsonParams.subLayers = {"layers": subLayers};
        jsonParams.object = null;
        var jsonParamsStr = Util.toJSON([jsonParams]);
        me.request({
            method: method,
            data: jsonParamsStr,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }

}


;// CONCATENATED MODULE: ./src/common/iServer/SetLayerStatusParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class SetLayerStatusParameters
 * @deprecatedclass SuperMap.SetLayerStatusParameters
 * @category  iServer Map TempLayersSet
 * @classdesc å­å¾å±æ¾ç¤ºæ§å¶åæ°ç±»,è¯¥ç±»å­å¨äºåå­å¾å±æ¯å¦å¯è§çç¶æã
 *            æ³¨æå¨ SuperMap iClient ç³»åäº§åä¸­æè¯´çå¾å±ä¸ SuperMap Deskpro çå°å¾å¯¹åºï¼å­å¾å±ä¸ SuperMap Deskpro çå¾å±å¯¹åºã
 * @param {Object} options - åæ°ã
 * @param {Array.<LayerStatus>} options.layerStatusList - è·åæè®¾ç½®å¾å±å¯è§ç¶æï¼{@link LayerStatus}ï¼éåï¼
 *                                                                 éåä¸­çæ¯ä¸ª {@link LayerStatus} å¯¹è±¡ä»£è¡¨ä¸ä¸ªå­å¾å±çå¯è§ç¶æã
 * @param {number} [options.holdTime=15] - è·åæè®¾ç½®èµæºå¨æå¡ç«¯ä¿å­çæ¶é´ã
 * @param {string} [options.resourceID] - è·åæè®¾ç½®èµæºæå¡ IDã
 * @usage
 */
class SetLayerStatusParameters {

    constructor(options) {
        /**
         * @member {Array.<LayerStatus>} SetLayerStatusParameters.prototype.layerStatusList
         * @description è·åæè®¾ç½®å¾å±å¯è§ç¶æï¼{@link LayerStatus}ï¼éåï¼éåä¸­çæ¯ä¸ª {@link LayerStatus} å¯¹è±¡ä»£è¡¨ä¸ä¸ªå­å¾å±çå¯è§ç¶æã
         */
        this.layerStatusList = [];

        /**
         * @member {number} [SetLayerStatusParameters.prototype.holdTime=15]
         * @description è·åæè®¾ç½®èµæºå¨æå¡ç«¯ä¿å­çæ¶é´ãåä½ä¸ºåéã
         */
        this.holdTime = 15;

        /**
         * @member {string} SetLayerStatusParameters.prototype.resourceID
         * @description è·åæè®¾ç½®èµæºæå¡IDãå¦æè®¾ç½®è¯¥åæ°åä¼å¨æå®ç TempLayer è¿è¡å¾å±çæ¾ç¤ºæ§å¶ï¼
         *              å¦æä¸è®¾ç½®è¯¥åæ°ï¼åä¼é¦ååå»ºä¸ä¸ª TempLayer ï¼ç¶åå¨æ°åå»ºç TempLayer è¿è¡å¾å±çæ¾ç¤ºæ§å¶ã
         */
        this.resourceID = null;

        if (options) {
            Util.extend(this, options);
        }


    }

    /**
     * @function SetLayerStatusParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.layerStatusList = null;
        me.holdTime = null;
        me.resourceID = null;
    }

    /**
     * @function SetLayerStatusParameters.prototype.toJSON
     * @description çæ JSONã
     * @returns {Object} å¯¹åºç JSON å¯¹è±¡ã
     */
    toJSON() {
        var json = '{';
        json += '"layers":[';
        var v = [];
        for (var i = 0, len = this.layerStatusList.length; i < len; i++) {
            v.push(this.layerStatusList[i].toJSON());
        }

        json += v;
        json += ']';
        json += '}';

        return json;
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/SetLayerStatusService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class SetLayerStatusService
 * @deprecatedclass SuperMap.SetLayerStatusService
 * @category  iServer Map TempLayersSet
 * @classdesc  å­å¾å±æ¾ç¤ºæ§å¶æå¡ç±»ãè¯¥ç±»è´è´£å°å­å¾å±æ¾ç¤ºæ§å¶åæ°ä¼ éå°æå¡ç«¯ï¼å¹¶è·åæå¡ç«¯è¿åçå¾å±æ¾ç¤ºç¶æã
 *             ç¨æ·è·åæå¡ç«¯è¿åçåå­å¾å±æ¾ç¤ºç¶ææä¸¤ç§æ¹å¼ï¼
 *             ä¸ç§æ¯éè¿çå¬ SetLayerEvent.PROCESS_COMPLETE äºä»¶ï¼
 *             ä¸ç§æ¯ä½¿ç¨ AsyncResponder ç±»å®ç°å¼æ­¥å¤çã
 * @extends {CommonServiceBase}
 * @param {string} url - æå¡å°åãè¯·æ±å°å¾æå¡ï¼URL åºä¸ºï¼
 *                       http://{æå¡å¨å°å}:{æå¡ç«¯å£å·}/iserver/services/{å°å¾æå¡å}/rest/maps/{å°å¾å}ï¼
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - äºä»¶çå¬å¨å¯¹è±¡ãæprocessCompletedå±æ§å¯ä¼ å¥å¤çå®æåçåè°å½æ°ãprocessFailedå±æ§ä¼ å¥å¤çå¤±è´¥åçåè°å½æ°ã
 * @param {DataFormat} [options.format=DataFormat.GEOJSON] - æ¥è¯¢ç»æè¿åæ ¼å¼ï¼ç®åæ¯æ iServerJSON å GeoJSON ä¸¤ç§æ ¼å¼ãåæ°æ ¼å¼ä¸º "ISERVER"ï¼"GEOJSON"ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class SetLayerStatusService extends CommonServiceBase {



    constructor(url, options) {
        super(url, options);
        this.lastparams = null;

        this.mapUrl = url;
        if (options) {
            Util.extend(this, options);
        }
        this.CLASS_NAME = "SuperMap.SetLayerStatusService";
    }

    /**
     * @override
     */
    destroy() {
        super.destroy();
        Util.reset(this);
    }


    /**
     * @function SetLayerStatusService.prototype.processAsync
     * @description è´è´£å°å®¢æ·ç«¯çæ´æ°åæ°ä¼ éå°æå¡ç«¯ã
     * @param {Object} params - ä¿®æ¹åçå¾å±èµæºä¿¡æ¯ãè¯¥åæ°å¯ä»¥ä½¿ç¨è·åå¾å±ä¿¡æ¯æå¡{@link SetLayerStatusParameters}
     *                          è¿åå¾å±ä¿¡æ¯ï¼ç¶åå¯¹å¶å±æ§è¿è¡ä¿®æ¹æ¥è·åã
     */
    processAsync(params) {
        if (!(params instanceof SetLayerStatusParameters)) {
            return;
        }
        var me = this,
            method = "POST";
        me.url = me.mapUrl;

        if (params.resourceID == null) {
            me.url = Util.urlPathAppend(me.url, 'tempLayersSet');
            me.lastparams = params;

            me.request({
                method: method,
                scope: me,
                success: me.createTempLayerComplete,
                failure: me.serviceProcessFailed
            });
        } else {
            me.url = Util.urlPathAppend(me.url, "tempLayersSet/" + params.resourceID);
            me.url = Util.urlAppend(me.url, "elementRemain=true&reference=" + params.resourceID + "&holdTime=" + params.holdTime.toString());

            var jsonParameters = '[{';

            jsonParameters += '"type":"UGC",';
            if (params.layerStatusList != null && params.layerStatusList.length > 0) {
                jsonParameters += '"subLayers":' + params.toJSON();
            }
            jsonParameters += ',"visible":' + true + ',';
            jsonParameters += '"name":"' + this.getMapName(this.mapUrl) + '"';

            jsonParameters += '}]';

            me.request({
                method: "PUT",
                data: jsonParameters,
                scope: me,
                success: me.serviceProcessCompleted,
                failure: me.serviceProcessFailed
            });
        }
    }

    /**
     * @function SetLayerStatusService.prototype.createTempLayerComplete
     * @description è®¾ç½®å®æï¼æ§è¡æ­¤æ¹æ³ã
     * @param {Object} result - æå¡å¨è¿åçç»æå¯¹è±¡ï¼è®°å½è®¾ç½®æä½æ¯å¦æåã
     */
    createTempLayerComplete(result) {
        var me = this;
        result = Util.transformResult(result);
        if (result.succeed) {
            me.lastparams.resourceID = result.newResourceID;
        }

        me.processAsync(me.lastparams);
    }

    /**
     * @function SetLayerStatusService.prototype.getMapName
     * @description è·åå°å¾åç§°ã
     * @param {Object} url - æå¡å°åã
     */
    getMapName(url) {
        var mapUrl = url;
        if (mapUrl.charAt(mapUrl.length - 1) === "/") {
            mapUrl = mapUrl.substr(0, mapUrl.length - 1);
        }
        var index = mapUrl.lastIndexOf("/");
        var mapName = mapUrl.substring(index + 1, mapUrl.length);
        return mapName;
    }

    /**
     * @function SetLayerStatusService.prototype.setLayerCompleted
     * @description è®¾ç½®å®æï¼æ§è¡æ­¤æ¹æ³ã
     * @param {Object} result - æå¡å¨è¿åçç»æå¯¹è±¡ï¼è®°å½è®¾ç½®æä½æ¯å¦æåã
     */
    serviceProcessCompleted(result) {
        var me = this;
        result = Util.transformResult(result);
        if (result != null && me.lastparams != null) {
            result.newResourceID = me.lastparams.resourceID;
        }
        me.events.triggerEvent("processCompleted", {result: result});
    }

}


;// CONCATENATED MODULE: ./src/common/iServer/SingleObjectQueryJobsParameter.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class SingleObjectQueryJobsParameter
 * @deprecatedclass SuperMap.SingleObjectQueryJobsParameter
 * @category  iServer ProcessingService Query
 * @classdesc åå¯¹è±¡ç©ºé´æ¥è¯¢åæä»»å¡åæ°ç±»ã
 * @param {Object} options - åæ°ã
 * @param {string} options.datasetName - æ°æ®éåã
 * @param {string} options.datasetQuery - æ¥è¯¢å¯¹è±¡æå¨çæ°æ®éåç§°ã
 * @param {SpatialQueryMode} [options.mode=SpatialQueryMode.CONTAIN] - ç©ºé´æ¥è¯¢æ¨¡å¼ã
 * @param {OutputSetting} [options.output] - è¾åºåæ°è®¾ç½®ã
 * @param {MappingParameters} [options.mappingParameters] - åæåç»æå¯è§åçåæ°ç±»ã
 * @usage
 */
class SingleObjectQueryJobsParameter {

    constructor(options) {
        if (!options) {
            return;
        }
        /**
         * @member {string} SingleObjectQueryJobsParameter.prototype.datasetName
         * @description æ°æ®éåã
         */
        this.datasetName = "";

        /**
         * @member {string} SingleObjectQueryJobsParameter.prototype.datasetQuery
         * @description æ¥è¯¢å¯¹è±¡æå¨çæ°æ®éåç§°ã
         */
        this.datasetQuery = "";

        /**
         * @member {string} SingleObjectQueryJobsParameter.prototype.geometryQuery
         * @description æ¥è¯¢å¯¹è±¡æå¨çå ä½å¯¹è±¡ã
         */
        this.geometryQuery = "";

        /**
         * @member {SpatialQueryMode} [SingleObjectQueryJobsParameter.prototype.mode=SpatialQueryMode.CONTAIN]
         * @description ç©ºé´æ¥è¯¢æ¨¡å¼ ã
         */
        this.mode = SpatialQueryMode.CONTAIN;

        /**
         * @member {OutputSetting} [SingleObjectQueryJobsParameter.prototype.output]
         * @description è¾åºåæ°è®¾ç½®ç±»ã
         */
        this.output = null;

        /**
         * @member {MappingParameters} [SingleObjectQueryJobsParameter.prototype.mappingParameters]
         * @description åæåç»æå¯è§åçåæ°ç±»ã
         */
        this.mappingParameters = null;

        Util.extend(this, options);

        this.CLASS_NAME = "SuperMap.SingleObjectQueryJobsParameter";
    }

    /**
     * @function SingleObjectQueryJobsParameter.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        this.datasetName = null;
        this.datasetQuery = null;
        this.geometryQuery = null;
        this.mode = null;
        if (this.output instanceof OutputSetting) {
            this.output.destroy();
            this.output = null;
        }
        if (this.mappingParameters instanceof MappingParameters){
            this.mappingParameters.destroy();
            this.mappingParameters = null;
        }
    }

    /**
     * @function SingleObjectQueryJobsParameter.toObject
     * @param {Object} singleObjectQueryJobsParameter - åå¯¹è±¡ç©ºé´æ¥è¯¢åæä»»å¡åæ°ã
     * @param {Object} tempObj - ç®æ å¯¹è±¡ã
     * @description çæåå¯¹è±¡ç©ºé´æ¥è¯¢åæä»»å¡å¯¹è±¡ã
     */
    static toObject(singleObjectQueryJobsParameter, tempObj) {
        for (var name in singleObjectQueryJobsParameter) {
            if (name === "datasetName") {
                tempObj['input'] = tempObj['input'] || {};
                tempObj['input'][name] = singleObjectQueryJobsParameter[name];
                continue;
            }
            if (name === "output"){
                tempObj['output'] = tempObj['output'] || {};
                tempObj['output'] = singleObjectQueryJobsParameter[name];
                continue;
            }

            tempObj['analyst'] = tempObj['analyst'] || {};
            tempObj['analyst'][name] = singleObjectQueryJobsParameter[name];
            if(name === 'mappingParameters'){
                tempObj['analyst'][name] = tempObj['analyst'][name] || {};
                tempObj['analyst']['mappingParameters'] = singleObjectQueryJobsParameter[name];
            }
        }
    }

}


;// CONCATENATED MODULE: ./src/common/iServer/SingleObjectQueryJobsService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class SingleObjectQueryJobsService
 * @deprecatedclass SuperMap.SingleObjectQueryJobsService
 * @category  iServer ProcessingService Query
 * @classdesc åå¯¹è±¡æ¥è¯¢åææå¡ç±»
 * @extends {ProcessingServiceBase}
 * @param {string} url - æå¡å°åã
 * @param {Object} options - å¯éåæ°ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class SingleObjectQueryJobsService extends ProcessingServiceBase {
    constructor(url, options) {
        super(url, options);
        this.url = Util.urlPathAppend(this.url, 'spatialanalyst/query');
        this.CLASS_NAME = 'SuperMap.SingleObjectQueryJobsService';
    }

    /**
     *@override
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function SingleObjectQueryJobsService.protitype.getQueryJobs
     * @description è·ååå¯¹è±¡ç©ºé´æ¥è¯¢åæææä»»å¡
     */
    getQueryJobs() {
        super.getJobs(this.url);
    }

    /**
     * @function KernelDensityJobsService.protitype.getQueryJob
     * @description è·åæå®idçåå¯¹è±¡ç©ºé´æ¥è¯¢åææå¡
     * @param {string} id - æå®è¦è·åæ°æ®çid
     */
    getQueryJob(id) {
        super.getJobs(Util.urlPathAppend(this.url, id));
    }

    /**
     * @function SingleObjectQueryJobsService.protitype.addQueryJob
     * @description æ°å»ºåå¯¹è±¡ç©ºé´æ¥è¯¢åææå¡
     * @param {SingleObjectQueryJobsParameter} params - åå»ºä¸ä¸ªç©ºé´åæçè¯·æ±åæ°ã
     * @param {number} seconds - å¼å§åå»ºåï¼è·ååå»ºæåç»æçæ¶é´é´éã
     */
    addQueryJob(params, seconds) {
        super.addJob(this.url, params, SingleObjectQueryJobsParameter, seconds);
    }
}


;// CONCATENATED MODULE: ./src/common/iServer/StopQueryParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class StopQueryParameters
 * @deprecatedclass SuperMap.StopQueryParameters
 * @category  iServer TrafficTransferAnalyst TransferStops
 * @classdesc ç«ç¹æ¥è¯¢åæ°ç±»ã
 * @param {Object} options - åæ°ã
 * @param {string} options.keyWord - ç«ç¹åç§°å³é®å­ã
 * @param {boolean} [options.returnPosition=false] - æ¯å¦è¿åç«ç¹åæ ä¿¡æ¯ã
 * @usage
 */
class StopQueryParameters {

    constructor(options) {
        options = options || {};
        /**
         *  @member {string} StopQueryParameters.prototype.keyWord
         *  @description ç«ç¹åç§°å³é®å­ã
         */
        this.keyWord = null;

        /**
         * @member {boolean} [StopQueryParameters.prototype.returnPosition=false]
         * @description æ¯å¦è¿åç«ç¹åæ ä¿¡æ¯ã
         */
        this.returnPosition = false;

        Util.extend(this, options);

        this.CLASS_NAME = "SuperMap.StopQueryParameters";
    }

    /**
     * @function StopQueryParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        Util.reset(this);
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/StopQueryService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class StopQueryService
 * @deprecatedclass SuperMap.StopQueryService
 * @category  iServer TrafficTransferAnalyst TransferStops
 * @classdesc ç«ç¹æ¥è¯¢æå¡ç±»ã
 * è¿åç»æéè¿è¯¥ç±»æ¯æçäºä»¶ççå¬å½æ°åæ°è·å
 * @extends {CommonServiceBase}
 * @param {string} url - æå¡å°åã
 * ä¾å¦ï¼</br>"http://localhost:8090/iserver/services/traffictransferanalyst-sample/restjsr/traffictransferanalyst/Traffic-Changchun"ã
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - éè¦è¢«æ³¨åççå¬å¨å¯¹è±¡ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @example ä¾å¦ï¼
 * (start code)
 * var myService = new StopQueryService(url, {eventListeners: {
     *     "processCompleted": StopQueryCompleted,
     *     "processFailed": StopQueryError
     *     }
     * };
 * (end)
 * @usage
 *
 */

class StopQueryService extends CommonServiceBase {


    constructor(url, options) {
        super(url, options);
        options = options || {};
        Util.extend(this, options);
        this.CLASS_NAME = "SuperMap.StopQueryService";
    }

    /**
     *@override
     */
    destroy() {
        super.destroy();
        Util.reset(this);
    }

    /**
     * @function StopQueryService.prototype.processAsync
     * @description è´è´£å°å®¢æ·ç«¯çæ´æ°åæ°ä¼ éå°æå¡ç«¯ã
     * @param {StopQueryParameters} params - äº¤éæ¢ä¹åæ°ã
     */
    processAsync(params) {
        if (!(params instanceof StopQueryParameters)) {
            return;
        }
        var me = this;
        me.url = Util.urlPathAppend(me.url, 'stops/keyword/' + params.keyWord);
        me.request({
            method: "GET",
            params: {returnPosition: params.returnPosition},
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/SummaryAttributesJobsParameter.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class SummaryAttributesJobsParameter
 * @deprecatedclass SuperMap.SummaryAttributesJobsParameter
 * @category  iServer ProcessingService SummaryAttributes
 * @classdesc å±æ§æ±æ»åæä»»å¡åæ°ç±»ã
 * @param {Object} options - åæ°ã
 * @param {string} options.datasetName - æ°æ®éåã
 * @param {string} options.groupField - åç»å­æ®µã
 * @param {string} options.attributeField - å±æ§å­æ®µã
 * @param {string} options.statisticModes - ç»è®¡æ¨¡å¼ã
 * @param {OutputSetting} [options.output] -è¾åºåæ°è®¾ç½®ã
 * @param {MappingParameters} [options.mappingParameters] - åæåç»æå¯è§åçåæ°ç±»ã
 * @usage
 */
class SummaryAttributesJobsParameter {

    constructor(options) {
        if (!options) {
            return;
        }
        /**
         * @member {string} SummaryAttributesJobsParameter.prototype.datasetName
         * @description æ±æ»æ°æ®éåç§°ã
         */
        this.datasetName = "";
        /**
         * @member {string} SummaryAttributesJobsParameter.prototype.groupField
         * @description åç»å­æ®µã
         */
        this.groupField = "";
        /**
         * @member {string} SummaryAttributesJobsParameter.prototype.attributeField
         * @description å±æ§å­æ®µã
         */
        this.attributeField = "";
        /**
         * @member {string} SummaryAttributesJobsParameter.prototype.statisticModes
         * @description å±æ§æ±æ»ç»è®¡æ¨¡å¼ã
         */
        this.statisticModes = "";
        /**
         * @member {OutputSetting} SummaryAttributesJobsParameter.prototype.output
         * @description è¾åºåæ°è®¾ç½®ç±»ã
         */
        this.output = null;
        /**
         * @member {MappingParameters} [SummaryAttributesJobsParameter.prototype.mappingParameters]
         * @description åæåç»æå¯è§åçåæ°ç±»ã
         */
        this.mappingParameters = null;

        Util.extend(this, options);
        this.CLASS_NAME = "SuperMap.SummaryAttributesJobsParameter";
    }

    /**
     * @function SummaryAttributesJobsParameter.prototype.destroy
     * @description éæ¾èµæºï¼å°èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        this.datasetName = null;
        this.groupField = null;
        this.attributeField = null;
        this.statisticModes = null;
        if (this.output instanceof OutputSetting) {
            this.output.destroy();
            this.output = null;
        }
        if (this.mappingParameters instanceof MappingParameters){
            this.mappingParameters.destroy();
            this.mappingParameters = null;
        }
    }

    /**
     * @function SummaryAttributesJobsParameter.toObject
     * @param {Object} SummaryAttributesJobsParameter - å±æ§æ±æ»ä»»å¡åæ°ã
     * @param {Object} tempObj - ç®æ å¯¹è±¡ã
     * @description çæå±æ§æ±æ»åæä»»å¡å¯¹è±¡ã
     */
    static toObject(SummaryAttributesJobsParameter, tempObj) {
        for (var name in SummaryAttributesJobsParameter) {
            if (name === "datasetName") {
                tempObj['input'] = tempObj['input'] || {};
                tempObj['input'][name] = SummaryAttributesJobsParameter[name];
                continue;
            }
            if (name === "output") {
                tempObj['output'] = tempObj['output'] || {};
                tempObj['output'] = SummaryAttributesJobsParameter[name];
                continue;
            }

            tempObj['analyst'] = tempObj['analyst'] || {};
            tempObj['analyst'][name] = SummaryAttributesJobsParameter[name];
            if(name === 'mappingParameters'){
                tempObj['analyst'][name] = tempObj['analyst'][name] || {};
                tempObj['analyst']['mappingParameters'] = SummaryAttributesJobsParameter[name];
            }
        }
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/SummaryAttributesJobsService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class SummaryAttributesJobsService
 * @deprecatedclass SuperMap.SummaryAttributesJobsService
 * @category  iServer ProcessingService SummaryAttributes
 * @classdesc å±æ§æ±æ»åææå¡ç±»
 * @extends {ProcessingServiceBase}
 * @param {string} url - æå¡å°åã
 * @param {Object} options - å¯éåæ°ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class SummaryAttributesJobsService extends ProcessingServiceBase {

    constructor(url, options) {
        super(url, options);
        this.url = Util.urlPathAppend(this.url, 'spatialanalyst/summaryattributes');
        this.CLASS_NAME = "SuperMap.SummaryAttributesJobsService";
    }

    /**
     *@override
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function SummaryAttributesJobsService.protitype.getSummaryAttributesJobs
     * @description è·åå±æ§æ±æ»åæææä»»å¡
     */
    getSummaryAttributesJobs (){
        super.getJobs(this.url);
    }

    /**
     * @function SummaryAttributesJobsService.protitype.getSummaryAttributesJob
     * @description è·åæå®idçå±æ§æ±æ»åææå¡
     * @param {string} id - æå®è¦è·åæ°æ®çid
     */
    getSummaryAttributesJob(id) {
        super.getJobs(Util.urlPathAppend(this.url, id));
    }

    /**
     * @function SummaryAttributesJobsService.protitype.addSummaryAttributesJob
     * @description æ°å»ºå±æ§æ±æ»åææå¡
     * @param {SummaryAttributesJobsParameter} params - å±æ§æ±æ»åæä»»å¡åæ°ç±»ã
     * @param {number} seconds - åå»ºæåç»æçæ¶é´é´éã
     */
    addSummaryAttributesJob(params, seconds) {
        super.addJob(this.url, params, SummaryAttributesJobsParameter, seconds);
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/SummaryMeshJobParameter.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/






/**
 * @class SummaryMeshJobParameter
 * @deprecatedclass SuperMap.SummaryMeshJobParameter
 * @category  iServer ProcessingService AggregatePoints
 * @classdesc ç¹èååæä»»å¡åæ°ç±»ã
 * @param {Object} options - åæ°ã
 * @param {string} options.datasetName - æ°æ®éåã
 * @param {(SuperMap.Bounds|L.Bounds|L.LatLngBounds|ol.extent|mapboxgl.LngLatBounds|GeoJSONObject)} [options.query] - åæèå´ï¼é»è®¤ä¸ºå¨å¾èå´ï¼ã
 * @param {number} options.fields - æéç´¢å¼ã
 * @param {number} [options.resolution=100] - åè¾¨çã
 * @param {StatisticAnalystMode} [options.statisticModes=StatisticAnalystMode.AVERAGE] - åææ¨¡å¼ã
 * @param {number} [options.meshType=0] - åæç±»åã
 * @param {SummaryType} [options.type=SummaryType.SUMMARYMESH] - èåç±»åã
 * @param {OutputSetting} [options.output] - è¾åºåæ°è®¾ç½®ã
 * @param {MappingParameters} [options.mappingParameters] - åæåç»æå¯è§åçåæ°ç±»ã
 * @usage
 */
class SummaryMeshJobParameter {

    constructor(options) {
        if (!options) {
            return;
        }
        /**
         * @member {string} SummaryMeshJobParameter.prototype.datasetName
         * @description æ°æ®éåã
         */
        this.datasetName = "";

        /**
         * @member {string} SummaryMeshJobParameter.prototype.regionDataset
         * @description èåé¢æ°æ®éï¼èåç±»åä¸ºå¤è¾¹å½¢èåæ¶ä½¿ç¨çåæ°ï¼ã
         */
        this.regionDataset = "";

        /**
         * @member {(SuperMap.Bounds|L.Bounds|L.LatLngBounds|ol.extent|mapboxgl.LngLatBounds|GeoJSONObject)} SummaryMeshJobParameter.prototype.query
         * @description åæèå´ï¼èåç±»åä¸ºç½æ ¼é¢èåæ¶ä½¿ç¨çåæ°ï¼ã
         */
        this.query = "";

        /**
         * @member {number} [SummaryMeshJobParameter.prototype.resolution=100]
         * @description åè¾¨çï¼èåç±»åä¸ºç½æ ¼é¢èåæ¶ä½¿ç¨çåæ°ï¼ã
         */
        this.resolution = 100;

        /**
         * @member {number} [SummaryMeshJobParameter.prototype.meshType=0]
         * @description  ç½æ ¼é¢ç±»åï¼èåç±»åä¸ºç½æ ¼é¢èåæ¶ä½¿ç¨çåæ°ï¼ï¼åå¼ï¼0 æ 1ã
         */
        this.meshType = 0;

        /**
         * @member {StatisticAnalystMode} [SummaryMeshJobParameter.prototype.statisticModes=StatisticAnalystMode.AVERAGE]
         * @description ç»è®¡æ¨¡å¼ã
         */
        this.statisticModes = StatisticAnalystMode.AVERAGE;

        /**
         * @member {number} SummaryMeshJobParameter.prototype.fields
         * @description æéå­æ®µã
         */
        this.fields = "";

        /**
         * @member {SummaryType} [SummaryMeshJobParameter.prototype.type=SummaryType.SUMMARYMESH]
         * @description èåç±»åã
         */
        this.type = SummaryType.SUMMARYMESH;

        /**
         * @member {OutputSetting} [SummaryMeshJobParameter.prototype.output]
         * @description è¾åºåæ°è®¾ç½®ç±»ã
         */
        this.output = null;

        /**
         * @member {MappingParameters} [SummaryMeshJobParameter.prototype.mappingParameters]
         * @description åæåç»æå¯è§åçåæ°ç±»ã
         */
        this.mappingParameters = null;

        Util.extend(this, options);

        this.CLASS_NAME = "SuperMap.SummaryMeshJobParameter";
    }


    /**
     * @function SummaryMeshJobParameter.prototype.destroy
     * @description éæ¾èµæºï¼å°èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        this.datasetName = null;
        this.query = null;
        this.resolution = null;
        this.statisticModes = null;
        this.meshType = null;
        this.fields = null;
        this.regionDataset = null;
        this.type = null;
        if (this.output instanceof OutputSetting) {
            this.output.destroy();
            this.output = null;
        }
        if (this.mappingParameters instanceof MappingParameters){
            this.mappingParameters.destroy();
            this.mappingParameters = null;
        }
    }

    /**
     * @function SummaryMeshJobParameter.toObject
     * @param {Object} summaryMeshJobParameter - ç¹èååæä»»å¡åæ°ã
     * @param {Object} tempObj - ç®æ å¯¹è±¡ã
     * @description çæç¹èååæä»»å¡å¯¹è±¡ã
     */
    static toObject(summaryMeshJobParameter, tempObj) {
        for (var name in summaryMeshJobParameter) {
            if (name === "datasetName") {
                tempObj['input'] = tempObj['input'] || {};
                tempObj['input'][name] = summaryMeshJobParameter[name];
                continue;
            }
            if (name === "type") {
                tempObj['type'] = summaryMeshJobParameter[name];
                continue;
            }
            if (name === "output") {
                tempObj['output'] = tempObj['output'] || {};
                tempObj['output'] = summaryMeshJobParameter[name];
                continue;
            }
            if (summaryMeshJobParameter.type === 'SUMMARYMESH' && name !== 'regionDataset' || summaryMeshJobParameter.type === 'SUMMARYREGION' && !contains(['meshType', 'resolution', 'query'], name)) {
                tempObj['analyst'] = tempObj['analyst'] || {};
                if (name === 'query' && summaryMeshJobParameter[name]) {
                    tempObj['analyst'][name] = summaryMeshJobParameter[name].toBBOX();
                } else {
                    tempObj['analyst'][name] = summaryMeshJobParameter[name];
                }
                if(name === 'mappingParameters'){
                    tempObj['analyst'][name] = tempObj['analyst'][name] || {};
                    tempObj['analyst']['mappingParameters'] = summaryMeshJobParameter[name];
                }
            }

        }

        function contains(arr, obj) {
            var i = arr.length;
            while (i--) {
                if (arr[i] === obj) {
                    return true;
                }
            }
            return false;
        }
    }

}


;// CONCATENATED MODULE: ./src/common/iServer/SummaryMeshJobsService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class SummaryMeshJobsService
 * @deprecatedclass SuperMap.SummaryMeshJobsService
 * @category  iServer ProcessingService AggregatePoints
 * @classdesc ç¹èååæä»»å¡ç±»ã
 * @param {string} url - æå¡å°åã
 * @param {Object} options - åæ°ã
 * @param {Events} options.events - å¤çææäºä»¶çå¯¹è±¡ã
 * @param {Object} [options.eventListeners] - äºä»¶çå¬å¨å¯¹è±¡ãæ processCompleted å±æ§å¯ä¼ å¥å¤çå®æåçåè°å½æ°ãprocessFailed å±æ§ä¼ å¥å¤çå¤±è´¥åçåè°å½æ°ã
 * @param {number} options.index - æå¡å°åå¨æ°ç»ä¸­çä½ç½®ã
 * @param {number} options.length - æå¡å°åæ°ç»é¿åº¦ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class SummaryMeshJobsService extends ProcessingServiceBase {
    constructor(url, options) {
        super(url, options);
        this.url = Util.urlPathAppend(this.url, 'spatialanalyst/aggregatepoints');
        this.CLASS_NAME = 'SuperMap.SummaryMeshJobsService';
    }

    /**
     * @override
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function SummaryMeshJobsService.prototype.getSummaryMeshJobs
     * @description è·åç¹èååæä»»å¡
     */
    getSummaryMeshJobs() {
        super.getJobs(this.url);
    }

    /**
     * @function SummaryMeshJobsService.prototype.getSummaryMeshJob
     * @description è·åæå®ipçç¹èååæä»»å¡
     * @param {string} id - æå®è¦è·åæ°æ®çid
     */
    getSummaryMeshJob(id) {
        super.getJobs(Util.urlPathAppend(this.url, id));
    }

    /**
     * @function SummaryMeshJobsService.prototype.addSummaryMeshJob
     * @description æ°å»ºç¹èååææå¡
     * @param {SummaryMeshJobParameter} params - åå»ºä¸ä¸ªç©ºé´åæçè¯·æ±åæ°ã
     * @param {number} seconds - å¼å§åå»ºåï¼è·ååå»ºæåç»æçæ¶é´é´éã
     */
    addSummaryMeshJob(params, seconds) {
        super.addJob(this.url, params, SummaryMeshJobParameter, seconds);
    }
}


;// CONCATENATED MODULE: ./src/common/iServer/SummaryRegionJobParameter.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class SummaryRegionJobParameter
 * @deprecatedclass SuperMap.SummaryRegionJobParameter
 * @category  iServer ProcessingService SummaryRegion
 * @classdesc åºåæ±æ»åæä»»å¡åæ°ç±»ã
 * @param {Object} options - åæ°ã
 * @param {string} options.datasetName - æ°æ®éåã
 * @param {(SuperMap.Bounds|L.Bounds|L.LatLngBounds|ol.extent|mapboxgl.LngLatBounds|GeoJSONObject)} [options.query] - åæèå´ï¼é»è®¤ä¸ºå¨å¾èå´ï¼ã
 * @param {string} [options.standardFields] - æ åå±æ§å­æ®µåç§°ã
 * @param {string} [options.weightedFields] - æéå­æ®µåç§°ã
 * @param {StatisticAnalystMode} [options.standardStatisticModes] - æ åå±æ§å­æ®µçç»è®¡æ¨¡å¼ãstandardSummaryFields ä¸º true æ¶å¿å¡«ã
 * @param {StatisticAnalystMode} [options.weightedStatisticModes] - æéå­æ®µçç»è®¡æ¨¡å¼ãweightedSummaryFields ä¸º true æ¶å¿å¡«ã
 * @param {boolean} [options.sumShape=true] - æ¯å¦ç»è®¡é¿åº¦æé¢ç§¯ã
 * @param {boolean} [options.standardSummaryFields=false] - æ¯å¦ä»¥æ åå±å­æ®µç»è®¡ã
 * @param {boolean} [options.weightedSummaryFields=false] - æ¯å¦ä»¥æéå­æ®µç»è®¡ã
 * @param {number} [options.resolution=100] - ç½æ ¼å¤§å°ã
 * @param {number} [options.meshType=0] - ç½æ ¼é¢æ±æ»ç±»åã
 * @param {AnalystSizeUnit} [options.meshSizeUnit=AnalystSizeUnit.METER] - ç½æ ¼å¤§å°åä½ã
 * @param {SummaryType} [options.type=SummaryType.SUMMARYMESH] - æ±æ»ç±»åã
 * @param {OutputSetting} [options.output] - è¾åºåæ°è®¾ç½®ã
 * @param {MappingParameters} [options.mappingParameters] - åæåç»æå¯è§åçåæ°ç±»ã
 * @usage
 */
class SummaryRegionJobParameter {

    constructor(options) {
        if (!options) {
            return;
        }

        /**
         * @member {string} SummaryRegionJobParameter.prototype.datasetName
         * @description æ°æ®éåã
         */
        this.datasetName = "";

        /**
         * @member {string} SummaryRegionJobParameter.prototype.regionDataset
         * @description æ±æ»æ°æ®æºï¼å¤è¾¹å½¢æ±æ»æ¶ç¨å°çåæ°ï¼ã
         */
        this.regionDataset = "";

        /**
         * @member {boolean} [SummaryRegionJobParameter.prototype.sumShape=true]
         * @description æ¯å¦ç»è®¡é¿åº¦æé¢ç§¯ã
         */
        this.sumShape = true;

        /**
         * @member {(SuperMap.Bounds|L.Bounds|L.LatLngBounds|ol.extent|mapboxgl.LngLatBounds|GeoJSONObject)} SummaryRegionJobParameter.prototype.query
         * @description åæèå´ã
         */
        this.query = "";

        /**
         * @member {boolean} [SummaryRegionJobParameter.prototype.standardSummaryFields=false]
         * @description æ¯å¦ä»¥æ åå±å­æ®µç»è®¡ã
         */
        this.standardSummaryFields = false;

        /**
         * @member {string} SummaryRegionJobParameter.prototype.standardFields
         * @description æ åå±æ§å­æ®µåç§°ãä»æ¯æç³»ç»å­æ®µä»¥å¤çæ´å½¢ãé¿æ´å½¢ãæµ®ç¹åçå­æ®µçåç§°ãstandardSummaryFields ä¸º true æ¶å¿å¡«ã
         */
        this.standardFields = "";

        /**
         * @member {StatisticAnalystMode} SummaryRegionJobParameter.prototype.standardStatisticModes
         * @description æ åå±æ§å­æ®µçç»è®¡æ¨¡å¼ãstandardSummaryFields ä¸º true æ¶å¿å¡«ã
         */
        this.standardStatisticModes = "";

        /**
         * @member {boolean} [SummaryRegionJobParameter.prototype.weightedSummaryFields=false]
         * @description æ¯å¦ä»¥æéå­æ®µç»è®¡ã
         */
        this.weightedSummaryFields = false;

        /**
         * @member {string} SummaryRegionJobParameter.prototype.weightedFields
         * @description æéå­æ®µåç§°ãä»æ¯æç³»ç»å­æ®µä»¥å¤çæ´å½¢ãé¿æ´å½¢ãæµ®ç¹åçå­æ®µçåç§°ãweightedSummaryFields ä¸º true æ¶å¿å¡«ã
         */
        this.weightedFields = "";

        /**
         * @member {StatisticAnalystMode} SummaryRegionJobParameter.prototype.weightedStatisticModes
         * @description ä»¥æéå­æ®µç»è®¡çç»è®¡æ¨¡å¼ãæéå­æ®µçç»è®¡æ¨¡å¼ãweightedSummaryFields ä¸º true æ¶å¿å¡«ã
         */
        this.weightedStatisticModes = "";

        /**
         * @member {number} [SummaryRegionJobParameter.prototype.meshType=0]
         * @description ç½æ ¼é¢æ±æ»ç±»åã
         */
        this.meshType = 0;

        /**
         * @member {number} [SummaryRegionJobParameter.prototype.resolution=100]
         * @description ç½æ ¼å¤§å°ã
         */
        this.resolution = 100;

        /**
         * @member {AnalystSizeUnit} [SummaryRegionJobParameter.prototype.meshSizeUnit=AnalystSizeUnit.METER]
         * @description ç½æ ¼å¤§å°åä½ã
         */
        this.meshSizeUnit = AnalystSizeUnit.METER;

        /**
         * @member {SummaryType} [SummaryRegionJobParameter.prototype.type=SummaryType.SUMMARYMESH]
         * @description æ±æ»ç±»åã
         */
        this.type = SummaryType.SUMMARYMESH;

        /**
         * @member {OutputSetting} SummaryRegionJobParameter.prototype.output
         * @description è¾åºåæ°è®¾ç½®ç±»
         */
        this.output = null;

        /**
         * @member {MappingParameters} [SummaryRegionJobParameter.prototype.mappingParameters]
         * @description åæåç»æå¯è§åçåæ°ç±»ã
         */
        this.mappingParameters = null;

        Util.extend(this, options);

        this.CLASS_NAME = "SuperMap.SummaryRegionJobParameter";
    }

    /**
     * @function SummaryRegionJobParameter.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        this.datasetName = null;
        this.sumShape = null;
        this.regionDataset = null;
        this.query = null;
        this.standardSummaryFields = null;
        this.standardFields = null;
        this.standardStatisticModes = null;
        this.weightedSummaryFields = null;
        this.weightedFields = null;
        this.weightedStatisticModes = null;
        this.meshType = null;
        this.resolution = null;
        this.meshSizeUnit = null;
        this.type = null;
        if (this.output instanceof OutputSetting) {
            this.output.destroy();
            this.output = null;
        }
        if (this.mappingParameters instanceof MappingParameters){
            this.mappingParameters.destroy();
            this.mappingParameters = null;
        }
    }

    /**
     * @function SummaryRegionJobParameter.toObject
     * @param {Object} summaryRegionJobParameter - ç¢éè£åªåæä»»å¡åæ°ã
     * @param {Object} tempObj - ç®æ å¯¹è±¡ã
     * @description çæåºåæ±æ»åææå¡å¯¹è±¡ã
     */
    static toObject(summaryRegionJobParameter, tempObj) {
        for (var name in summaryRegionJobParameter) {
            if (name === "datasetName") {
                tempObj['input'] = tempObj['input'] || {};
                tempObj['input'][name] = summaryRegionJobParameter[name];
                continue;
            }
            if (name === "type") {
                tempObj['type'] = summaryRegionJobParameter[name];
                continue;
            }
            if (name === "type") {
                tempObj['type'] = summaryRegionJobParameter[name];
                continue;
            }
            if (name === "output") {
                tempObj['output'] = tempObj['output'] || {};
                tempObj['output'] = summaryRegionJobParameter[name];
                continue;
            }
            if (summaryRegionJobParameter.type === "SUMMARYREGION" || summaryRegionJobParameter.type === "SUMMARYMESH" && name !== "regionDataset") {
                tempObj['analyst'] = tempObj['analyst'] || {};
                if (name === 'query' && summaryRegionJobParameter[name]) {
                    tempObj['analyst'][name] = summaryRegionJobParameter[name].toBBOX();
                } else {
                    tempObj['analyst'][name] = summaryRegionJobParameter[name];
                }
                if(name === 'mappingParameters'){
                    tempObj['analyst'][name] = tempObj['analyst'][name] || {};
                    tempObj['analyst']['mappingParameters'] = summaryRegionJobParameter[name];
                }

            }
        }
    }

}


;// CONCATENATED MODULE: ./src/common/iServer/SummaryRegionJobsService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class SummaryRegionJobsService
 * @deprecatedclass SuperMap.SummaryRegionJobsService
 * @category  iServer ProcessingService SummaryRegion
 * @classdesc åºåæ±æ»åææå¡ç±»
 * @extends {ProcessingServiceBase}
 * @param {string} url - æå¡å°åã
 * @param {Object} options - å¯éåæ°ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class SummaryRegionJobsService extends ProcessingServiceBase {
    constructor(url, options) {
        super(url, options);
        this.url = Util.urlPathAppend(this.url, 'spatialanalyst/summaryregion');
        this.CLASS_NAME = 'SuperMap.SummaryRegionJobsService';
    }

    /**
     *@override
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function SummaryRegionJobsService.prototype.getSummaryRegionJobs
     * @description è·ååºåæ±æ»åæä»»å¡éåã
     */
    getSummaryRegionJobs() {
        super.getJobs(this.url);
    }

    /**
     * @function SummaryRegionJobsService.prototype.getSummaryRegionJob
     * @description è·åæå®idçåºåæ±æ»åæä»»å¡ã
     * @param {string} id -è¦è·ååºåæ±æ»åæä»»å¡çid
     */
    getSummaryRegionJob(id) {
        super.getJobs(Util.urlPathAppend(this.url, id));
    }

    /**
     * @function SummaryRegionJobsService.prototype.addSummaryRegionJob
     * @description æ°å»ºåºåæ±æ»ä»»å¡ã
     * @param {SummaryRegionJobParameter} params - åºåæ±æ»åæä»»å¡åæ°ç±»ã
     * @param {number} seconds - åå»ºæåç»æçæ¶é´é´éã
     */
    addSummaryRegionJob(params, seconds) {
        super.addJob(this.url, params, SummaryRegionJobParameter, seconds);
    }
}


;// CONCATENATED MODULE: ./src/common/iServer/SupplyCenter.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class SupplyCenter
 * @deprecatedclass SuperMap.SupplyCenter
 * @category  iServer NetworkAnalyst Location
 * @classdesc èµæºä¾ç»ä¸­å¿ç±»ãå¨èµæºåéåéåååºåæä¸¤ä¸ªåè½ä¸­ä½¿ç¨ã
 * @param {Object} options - åæ°ã
 * @param {number} options.maxWeight - æå¤§èè´¹å¼ã
 * @param {number} options.nodeID - ç»ç¹ ID å·ãèµæºä¾ç»ä¸­å¿å¿é¡»æ¯ç»ç¹ã
 * @param {number} options.resourceValue - è½æä¾çæå¤§æå¡éæååæ°éã
 * @param {SupplyCenterType} [options.type] - èµæºä¾ç»ä¸­å¿ç¹çç±»åå¸¸éã
 * @usage
 */
class SupplyCenter {

    constructor(options) {
        /**
         * @member {number} SupplyCenter.prototype.maxWeight
         * @description èµæºä¾ç»ä¸­å¿çæå¤§èè´¹å¼ãä¸­å¿ç¹æå¤§é»å¼è®¾ç½®è¶å°ï¼è¡¨ç¤ºä¸­å¿ç¹ææä¾çèµæºå¯å½±åèå´è¶å¤§ã
         *              æå¤§é»åå¼æ¯ç¨æ¥éå¶éæ±ç¹å°ä¸­å¿ç¹çè±è´¹ã
         *              å¦æéæ±ç¹ï¼å¼§æ®µæç»ç¹ï¼å°æ­¤ä¸­å¿çè±è´¹å¤§äºæå¤§é»åå¼ï¼åè¯¥éæ±ç¹ä¸å±äºè¯¥èµæºä¾ç»ä¸­å¿æä¾èµæºçèå´ã
         */
        this.maxWeight = null;

        /**
         * @member {number} SupplyCenter.prototype.nodeID
         * @description èµæºä¾ç»ä¸­å¿ç¹çç»ç¹ ID å·ï¼èµæºä¾ç»ä¸­å¿å¿é¡»æ¯ç»ç¹ã
         */
        this.nodeID = null;

        /**
         * @member {number} SupplyCenter.prototype.resourceValue
         * @description èµæºä¾ç»ä¸­å¿è½æä¾çæå¤§æå¡éæååæ°éãä¾å¦èµæºä¸­å¿ä¸ºå­¦æ ¡ï¼èµæºä¸­å¿èµæºéè¡¨ç¤ºè¯¥å­¦æ ¡è½å¤æ¥çº³å¤å°å­¦çã
         */
        this.resourceValue = null;

        /**
         * @member {SupplyCenterType} [SupplyCenter.prototype.type]
         * @description èµæºä¾ç»ä¸­å¿ç¹çç±»åå¸¸éãèµæºä¾ç»ä¸­å¿ç¹çç±»ååæ¬éä¸­å¿ï¼åºå®ä¸­å¿åå¯éä¸­å¿ã
         *              åºå®ä¸­å¿ç¨äºèµæºåéåæï¼åºå®ä¸­å¿åå¯éä¸­å¿ç¨äºéååæï¼éä¸­å¿å¨ä¸¤ç§ç½ç»åææ¶é½ä¸äºèèã
         */
        this.type = null;

        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = "SuperMap.SupplyCenter";
    }

    /**
     * @function SupplyCenter.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.maxWeight = null;
        me.nodeID = null;
        me.resourceValue = null;
        me.type = null;
    }

    /**
     * @function SupplyCenter.fromJson
     * @description å°æå¡ç«¯ JSON å¯¹è±¡è½¬æ¢æå½åå®¢æ·ç«¯å¯¹è±¡ã
     * @param {Object} jsonObject - è¦è½¬æ¢ç JSON å¯¹è±¡ã
     * @returns {SupplyCenter} SupplyCenter å¯¹è±¡ã
     */
    static fromJson(jsonObject) {
        if (!jsonObject) {
            return;
        }
        return new SupplyCenter({
            maxWeight: jsonObject.maxWeight,
            nodeID: jsonObject.nodeID,
            resourceValue: jsonObject.resourceValue,
            type: jsonObject.type
        });
    }

}



;// CONCATENATED MODULE: ./src/common/iServer/SurfaceAnalystService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/







/**
 * @class SurfaceAnalystService
 * @deprecatedclass SuperMap.SurfaceAnalystService
 * @category  iServer SpatialAnalyst SurfaceAnalyst
 * @classdesc è¡¨é¢åææå¡ç±»ã
 * è¯¥ç±»è´è´£å°å®¢æ·è®¾ç½®çè¡¨é¢åææå¡åæ°ä¼ éç»æå¡ç«¯ï¼å¹¶æ¥æ¶æå¡ç«¯è¿åçè¡¨é¢åææå¡åæç»ææ°æ®ã
 * è¡¨é¢åæç»æéè¿è¯¥ç±»æ¯æçäºä»¶ççå¬å½æ°åæ°è·å
 * @param {string} url - æå¡å°åãå¦ http://localhost:8090/iserver/services/spatialanalyst-changchun/restjsr/spatialanalyst
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - éè¦è¢«æ³¨åççå¬å¨å¯¹è±¡ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @extends {SpatialAnalystBase}
 * @example ä¾å¦ï¼
 * (start code)
 * var mySurfaceAnalystService = new SurfaceAnalystService(url, {
     *      eventListeners: {
     *	       "processCompleted": surfaceAnalysCompleted,
     *		   "processFailed": surfaceAnalysFailed
     *		   }
     * });
 * (end)
 * @usage
 */
class SurfaceAnalystService extends SpatialAnalystBase {

    constructor(url, options) {
        super(url, options);
        this.CLASS_NAME = "SuperMap.SurfaceAnalystService";
    }

    /**
     * @function SurfaceAnalystService.prototype.destroy
     * @description éæ¾èµæº,å°å¼ç¨çèµæºå±æ§ç½®ç©ºã
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function SurfaceAnalystService.prototype.processAsync
     * @description è´è´£å°å®¢æ·ç«¯çè¡¨é¢åææå¡åæ°ä¼ éå°æå¡ç«¯ã
     * @param {SurfaceAnalystParameters} params - è¡¨é¢åææåæä½åæ°ç±»ã
     */
    processAsync(params) {
        if (!(params instanceof SurfaceAnalystParameters)) {
            return;
        }
        var me = this, jsonParameters;
        jsonParameters = me.getJsonParameters(params);
        me.request({
            method: "POST",
            data: jsonParameters,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }

    /**
     * @function SurfaceAnalystService.prototype.getJsonParameters
     * @description å°åæ°è½¬åä¸º JSON å­ç¬¦ä¸²ã
     * @param {SurfaceAnalystParameters} params - è¡¨é¢åææåæä½åæ°ç±»ã
     * @returns {Object} è½¬ååçJSONå­ç¬¦ä¸²ã
     */
    getJsonParameters(params) {
        var jsonParameters = '';
        var parameterObject = {};
        var me = this;
        if (params instanceof DatasetSurfaceAnalystParameters) {
            me.url = Util.urlPathAppend(
                me.url,
                'datasets/' + params.dataset + '/' + params.surfaceAnalystMethod.toLowerCase()
            );
            DatasetSurfaceAnalystParameters.toObject(params, parameterObject);
            jsonParameters = Util.toJSON(parameterObject);
        } else if (params instanceof GeometrySurfaceAnalystParameters) {
            me.url = Util.urlPathAppend(me.url, 'geometry/' + params.surfaceAnalystMethod.toLowerCase());
            jsonParameters = Util.toJSON(params);
        } else {
            return;
        }
        me.url = Util.urlAppend(me.url, 'returnContent=true');
        return jsonParameters;
    }
}

;// CONCATENATED MODULE: ./src/common/iServer/TerrainCurvatureCalculationParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class TerrainCurvatureCalculationParameters
 * @deprecatedclass SuperMap.TerrainCurvatureCalculationParameters
 * @category  iServer SpatialAnalyst TerrainCalculation
 * @classdesc å°å½¢æ²çè®¡ç®åæ°ç±»ã
 * @param {Object} options - åæ°ã
 * @param {string} options.dataset - å°å½¢æ²çè®¡ç®æ°æ®æºä¸­æ°æ®éçåç§°ãè¯¥åç§°ç¨å½¢å¦"æ°æ®éåç§°@æ°æ®æºå«å"å½¢å¼æ¥è¡¨ç¤ºï¼ä¾å¦ï¼JingjinTerrain@Jingjinã
 * @param {string} options.averageCurvatureName - ç»ææ°æ®éï¼å¹³åæ²çæ°æ®éçåç§°ã
 * @param {string} options.profileCurvatureName - ç»ææ°æ®éï¼åé¢æ²çæ°æ®éçåç§°ã
 * @param {string} options.planCurvatureName - ç»ææ°æ®éï¼å¹³é¢æ²çæ°æ®éçåç§°ã
 * @param {number} [options.zFactor=1.0] - æå®çé«ç¨ç¼©æ¾ç³»æ°ã1.0 è¡¨ç¤ºä¸ç¼©æ¾ã
 * @param {boolean} [options.deleteExistResultDataset=false] - å¦æç¨æ·å½åçç»ææ°æ®éåç§°ä¸å·²æçæ°æ®ééåï¼æ¯å¦å é¤å·²æçæ°æ®éã
 * @usage
 */
class TerrainCurvatureCalculationParameters {

    constructor(options) {
        if (!options) {
            return;
        }
        /**
         * @member {string} TerrainCurvatureCalculationParameters.prototype.dataset
         * @description è¦ç¨æ¥åå°å½¢æ²çè®¡ç®æ°æ®æºä¸­æ°æ®éçåç§°ã
         * è¯¥åç§°ç¨å½¢å¦"æ°æ®éåç§°@æ°æ®æºå«å"å½¢å¼æ¥è¡¨ç¤ºï¼ä¾å¦ï¼JingjinTerrain@Jingjinã
         * æ³¨ï¼å°å½¢æ²çè®¡ç®å¿é¡»ä¸ºæ æ ¼æ°æ®éã
         */
        this.dataset = null;

        /**
         * @member {number} [TerrainCurvatureCalculationParameters.prototype.zFactor=1.0]
         * @description æå®çé«ç¨ç¼©æ¾ç³»æ°ã1.0 è¡¨ç¤ºä¸ç¼©æ¾ã
         * è¯¥å¼æ¯æå¨ DEM æ æ ¼æ°æ®ä¸­ï¼æ æ ¼å¼ï¼ Z åæ ï¼å³é«ç¨å¼ï¼ç¸å¯¹äº X å Y åæ çåä½åæ¢ç³»æ°ã
         * éå¸¸æ Xï¼Yï¼Z é½åå çè®¡ç®ä¸­ï¼éè¦å°é«ç¨å¼ä¹ä»¥ä¸ä¸ªé«ç¨ç¼©æ¾ç³»æ°ï¼ä½¿å¾ä¸èåä½ä¸è´ã
         * ä¾å¦ï¼XãY æ¹åä¸çåä½æ¯ç±³ï¼è Z æ¹åçåä½æ¯è±å°ºï¼ç±äº 1 è±å°ºç­äº 0.3048 ç±³ï¼åéè¦æå®ç¼©æ¾ç³»æ°ä¸º 0.3048ã
         */
        this.zFactor = 1.0;

        /**
         * @member {string} TerrainCurvatureCalculationParameters.prototype.averageCurvatureName
         * @description ç»ææ°æ®éï¼å¹³åæ²çæ°æ®éçåç§°ã
         */
        this.averageCurvatureName = null;

        /**
         * @member {string} TerrainCurvatureCalculationParameters.prototype.profileCurvatureName
         * @description ç»ææ°æ®éï¼åé¢æ²çæ°æ®éçåç§°ã
         */
        this.profileCurvatureName = "";

        /**
         * @member {string} TerrainCurvatureCalculationParameters.prototype.planCurvatureName
         * @description ç»ææ°æ®éï¼å¹³é¢æ²çæ°æ®éçåç§°ã
         */
        this.planCurvatureName = "";

        /**
         * @member {boolean} [TerrainCurvatureCalculationParameters.prototype.deleteExistResultDataset=false]
         * @description å¦æç¨æ·å½åçç»ææ°æ®éåç§°ä¸å·²æçæ°æ®ééåï¼æ¯å¦å é¤å·²æçæ°æ®éã
         */
        this.deleteExistResultDataset = false;

        Util.extend(this, options);

        this.CLASS_NAME = "SuperMap.TerrainCurvatureCalculationParameters";
    }


    /**
     * @function TerrainCurvatureCalculationParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.dataset = null;
        me.zFactor = 1.0;
        me.averageCurvatureName = null;
        me.profileCurvatureName = null;
        me.planCurvatureName = null;
        me.deleteExistResultDataset = true;
    }

    /**
     * @function TerrainCurvatureCalculationParameters.toObject
     * @param {Object} derrainCurvatureCalculationParameters - å°å½¢æ²çè®¡ç®åæ°ã
     * @param {Object} tempObj - ç®æ å¯¹è±¡ã
     * @description çæå°å½¢æ²çè®¡ç®å¯¹è±¡ã
     */
    static toObject(derrainCurvatureCalculationParameters, tempObj) {
        for (var name in derrainCurvatureCalculationParameters) {
            if (name !== "dataset") {
                tempObj[name] = derrainCurvatureCalculationParameters[name];
            }
        }
    }

}


;// CONCATENATED MODULE: ./src/common/iServer/TerrainCurvatureCalculationService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class TerrainCurvatureCalculationService
 * @deprecatedclass SuperMap.TerrainCurvatureCalculationService
 * @category  iServer SpatialAnalyst TerrainCalculation
 * @classdesc å°å½¢æ²çè®¡ç®æå¡ç±»ã
 * @extends {SpatialAnalystBase}
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - éè¦è¢«æ³¨åççå¬å¨å¯¹è±¡ã
 * @param {string} options.url - æå¡çè®¿é®å°åãå¦ http://localhost:8090/iserver/services/spatialanalyst-changchun/restjsr/spatialanalyst ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @example ä¾å¦ï¼
 * (start code)
 * var myTerrainCurvatureCalculationService = new TerrainCurvatureCalculationService(url);
 * myTerrainCurvatureCalculationService.on({
     *     "processCompleted": processCompleted,
     *     "processFailed": processFailed
     *     }
 * );
 * (end)
 * @usage
 */
class TerrainCurvatureCalculationService extends SpatialAnalystBase {

    constructor(url, options) {
        super(url, options);
        this.CLASS_NAME = "SuperMap.TerrainCurvatureCalculationService";
    }

    /**
     *@override
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function TerrainCurvatureCalculationService.prototype.processAsync
     * @description è´è´£å°å®¢æ·ç«¯çæ¥è¯¢åæ°ä¼ éå°æå¡ç«¯ã
     * @param {TerrainCurvatureCalculationParameters} parameter - å°å½¢æ²çè®¡ç®åæ°ç±»ã
     */
    processAsync(parameter) {
        var me = this;
        var parameterObject = {};

        if (parameter instanceof TerrainCurvatureCalculationParameters) {
            me.url = Util.urlPathAppend(me.url, 'datasets/' + parameter.dataset + '/terraincalculation/curvature');
        }

        TerrainCurvatureCalculationParameters.toObject(parameter, parameterObject);
        var jsonParameters = Util.toJSON(parameterObject);
        me.url = Util.urlAppend(me.url, 'returnContent=true');
        me.request({
            method: "POST",
            data: jsonParameters,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }
}


;// CONCATENATED MODULE: ./src/common/iServer/ThemeFlow.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class ThemeFlow
 * @deprecatedclass SuperMap.ThemeFlow
 * @private
 * @category  iServer Map Theme
 * @classdesc æ ç­¾æç¬¦å·æµå¨æ¾ç¤ºåçµå¼çº¿é£æ ¼è®¾ç½®ç±»ã
 *            éè¿è¯¥ç±»å¯ä»¥è®¾ç½®ä¸é¢å¾ä¸­ç¬¦å·æ¯å¦æµå¨æ¾ç¤ºãæ¯å¦ä½¿ç¨çµå¼çº¿ä»¥åçµå¼çº¿é£æ ¼ã
 * @param {Object} options - å¯éåæ°ã
 * @param {boolean} [options.flowEnabled=false] - æ¯å¦æµå¨æ¾ç¤ºæ ç­¾æç¬¦å·ã
 * @param {boolean} [options.leaderLineDisplayed=false] - æ¯å¦æ¾ç¤ºæ ç­¾æç¬¦å·åå®æ æ³¨çå¯¹è±¡ä¹é´ççµå¼çº¿ã
 * @param {ServerStyle} [options.leaderLineStyle] - æ ç­¾æç¬¦å·ä¸å¶æ æ³¨å¯¹è±¡ä¹é´çµå¼çº¿çé£æ ¼ã
 * @usage
 */
class ThemeFlow {

    constructor(options) {
        /**
         * @member {boolean} [ThemeFlow.prototype.flowEnabled=false]
         * @description æ¯å¦æµå¨æ¾ç¤ºæ ç­¾æç¬¦å·ã<br>
         *              å¯¹äºæ ç­¾ä¸é¢å¾èè¨ï¼å¯¹äºè·¨è¶æ¯è¾å¤§çåºååçº¿æ¡ç¶çå ä½å¯¹è±¡ï¼å¨ä¸ä¸ªå°å¾çªå£ä¸­ä¸è½å®å¨æ¾ç¤ºçæåµä¸ï¼å¦æå¶æ ç­¾ä½ç½®æ¯è¾åºå®ï¼
         *              å¨å½åå°å¾çªå£ä¸­è¯¥å¯¹è±¡çæ ç­¾ä¸å¯è§ï¼åéè¦éè¿å¹³ç§»å°å¾æ¥æ¥çå¯¹è±¡çæ ç­¾ä¿¡æ¯ãå¦æéç¨äºæµå¨æ¾ç¤ºçææï¼å¨å½åå°å¾çªå£ä¸­ï¼å¯¹è±¡å³ä½¿æ¯é¨åæ¾ç¤ºï¼
         *              å¶æ ç­¾ä¹ä¼æ¾ç¤ºå¨å½åå°å¾çªå£ä¸­ãå½å¹³ç§»å°å¾æ¶ï¼å¯¹è±¡çæ ç­¾ä¼éä¹ç§»å¨ï¼ä»¥ä¿è¯å¨å½åå°å¾çªå£ä¸­é¨åæå¨é¨æ¾ç¤ºçå¯¹è±¡å¶æ ç­¾é½å¯è§ï¼ä»èå¯ä»¥æ¹ä¾¿å°æ¥çåè¦ç´ çæ ç­¾ä¿¡æ¯ã
         */
        this.flowEnabled = false;

        /**
         * @member {boolean} [ThemeFlow.prototype.leaderLineDisplayed=false]
         * @description æ¯å¦æ¾ç¤ºæ ç­¾æç¬¦å·åå®æ æ³¨çå¯¹è±¡ä¹é´ççµå¼çº¿ãfalseè¡¨ç¤ºä¸æ¾ç¤ºæ ç­¾æç¬¦å·åå®æ æ³¨çå¯¹è±¡ä¹é´ççµå¼çº¿ã<br>
         *              åªæå½ flowEnabled ä¸º true æ¶ï¼çµå¼çº¿æèµ·ä½ç¨ãå¨å½æ ç­¾æµå¨æ¾ç¤ºæ¶ï¼å¶ä½ç½®ä¸åºå®ï¼ç±äºçµå¼çº¿å§ç»æåè¦ç´ çåç¹ï¼
         *              å èéè¿çµå¼çº¿æ¾ç¤ºåè½å¯ä»¥æ¾å°æµå¨çæ ç­¾æç¬¦å·å®éå¯¹åºçè¦ç´ ãæèæ¸²æç¬¦å·åç§»å®ææåçå¯¹è±¡æ¶ï¼å¾ä¸å¯¹è±¡ä¹é´å¯ä»¥éç¨çµå¼çº¿è¿è¡è¿æ¥ã
         */
        this.leaderLineDisplayed = false;

        /**
         * @member {ServerStyle} ThemeFlow.prototype.leaderLineStyle
         * @description æ ç­¾æç¬¦å·ä¸å¶æ æ³¨å¯¹è±¡ä¹é´çµå¼çº¿çé£æ ¼ã
         */
        this.leaderLineStyle =  new ServerStyle();

        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = "SuperMap.ThemeFlow";
    }

    /**
     * @function ThemeFlow.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.flowEnabled = null;
        me.leaderLineDisplayed = null;
        if (me.leaderLineStyle) {
            me.leaderLineStyle.destroy();
            me.leaderLineStyle = null;
        }
    }

    /**
     * @function ThemeFlow.fromObj
     * @description ä»ä¼ å¥å¯¹è±¡è·åæ ç­¾æç¬¦å·æµå¨æ¾ç¤ºåçµå¼çº¿é£æ ¼è®¾ç½®ç±»ã
     * @param {Object} obj - ä¼ å¥å¯¹è±¡ã
     * @returns {ThemeFlow} ThemeFlow å¯¹è±¡ã
     */
    static fromObj(obj) {
        if (!obj) {
            return;
        }
        var res = new ThemeFlow();
        Util.copy(res, obj);
        res.leaderLineStyle = ServerStyle.fromJson(obj.leaderLineStyle);
        return res;
    }

}


;// CONCATENATED MODULE: ./src/common/iServer/ThemeGridRangeItem.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class ThemeGridRangeItem
 * @deprecatedclass SuperMap.ThemeGridRangeItem
 * @category  iServer Map Theme
 * @classdesc æ æ ¼åæ®µä¸é¢å¾å­é¡¹ç±»ãå¨æ æ ¼åæ®µä¸é¢å¾ä¸­ï¼å°æ æ ¼å¼æç§æç§åæ®µæ¨¡å¼è¢«åæå¤ä¸ªèå´æ®µã
 * æ¬ç±»ç¨æ¥è®¾ç½®æ¯ä¸ªèå´æ®µçåæ®µèµ·å§å¼ãç»æ­¢å¼ãåç§°åé¢è²ç­ãæ¯ä¸ªåæ®µæè¡¨ç¤ºçèå´ä¸º [Start,End)ã
 * @param {Object} options - åæ°ã
 * @param {ServerColor} options.color - æ æ ¼åæ®µä¸é¢å¾ä¸­æ¯ä¸ä¸ªåæ®µä¸é¢å¾å­é¡¹çå¯¹åºçé¢è²ã
 * @param {string} [options.caption] - æ æ ¼åæ®µä¸é¢å¾å­é¡¹çæ é¢ã
 * @param {number} [options.end=0] - æ æ ¼åæ®µä¸é¢å¾å­é¡¹çç»æ­¢å¼ã
 * @param {number} [options.start=0] - æ æ ¼åæ®µä¸é¢å¾å­é¡¹çèµ·å§å¼ã
 * @param {boolean} [options.visible=true] - æ æ ¼åæ®µä¸é¢å¾å­é¡¹æ¯å¦å¯è§ã
 * @usage
 */
class ThemeGridRangeItem {

    constructor(options) {
        /**
         * @member {string} [ThemeGridRangeItem.prototype.caption]
         * @description æ æ ¼åæ®µä¸é¢å¾å­é¡¹çæ é¢ã
         */
        this.caption = null;

        /**
         * @member {ServerColor} ThemeGridRangeItem.prototype.color
         * @description æ æ ¼åæ®µä¸é¢å¾ä¸­æ¯ä¸ä¸ªåæ®µä¸é¢å¾å­é¡¹çå¯¹åºçé¢è²ã
         */
        this.color =  new ServerColor();

        /**
         * @member {number} [ThemeGridRangeItem.prototype.end=0]
         * @description æ æ ¼åæ®µä¸é¢å¾å­é¡¹çç»æ­¢å¼ï¼å³è¯¥æ®µä¸é¢å¼èå´çæå¤§å¼ã
         */
        this.end = 0;

        /**
         * @member {number} [ThemeGridRangeItem.prototype.start=0]
         * @description æ æ ¼åæ®µä¸é¢å¾å­é¡¹çèµ·å§å¼ï¼å³è¯¥æ®µä¸é¢å¼èå´çæå°å¼ã
         */
        this.start = 0;


        /**
         * @member {boolean} [ThemeGridRangeItem.prototype.visible=true]
         * @description æ æ ¼åæ®µä¸é¢å¾å­é¡¹æ¯å¦å¯è§ã
         */
        this.visible = true;

        if (options) {
            Util.extend(this, options);
        }
        this.CLASS_NAME = "SuperMap.ThemeGridRangeItem";
    }

    /**
     * @function ThemeGridRangeItem.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.caption = null;
        me.end = null;
        me.start = null;
        //éè¦éªè¯æ¯å¤å­å¨destroyæ¹æ³
        if (me.color) {
            me.color.destroy();
            me.color = null;
        }
        me.visible = null;
    }

    /**
     * @function ThemeGridRangeItem.prototype.toServerJSONObject
     * @description è½¬æ¢æå¯¹åºç JSON æ ¼å¼å¯¹è±¡ã
     * @returns {Object} å¯¹åºç JSON æ ¼å¼å¯¹è±¡ã
     */
    toServerJSONObject() {
        var obj = {};
        obj = Util.copyAttributes(obj, this);
        if (obj.color) {
            if (obj.color.toServerJSONObject) {
                obj.color = obj.color.toServerJSONObject();
            }
        }
        return obj;
    }

    /**
     * @function ThemeGridRangeItem.fromObj
     * @description ä»ä¼ å¥å¯¹è±¡è·åæ æ ¼åæ®µä¸é¢å¾å­é¡¹ç±»ã
     * @param {Object} obj - ä¼ å¥å¯¹è±¡ã
     * @returns {ThemeGridRangeItem} ThemeGridRangeItem å¯¹è±¡ã
     */
    static fromObj(obj) {
        if (!obj) {
            return;
        }
        var res = new ThemeGridRangeItem();
        Util.copy(res, obj);
        res.color = ServerColor.fromJson(obj.color);
        return res;
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/ThemeGridRange.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class ThemeGridRange
 * @deprecatedclass SuperMap.ThemeGridRange
 * @category  iServer Map Theme
 * @classdesc æ æ ¼åæ®µä¸é¢å¾ãæ æ ¼åæ®µä¸é¢å¾ï¼æ¯å°ææååæ ¼çå¼æç§æç§åæ®µæ¹å¼åæå¤ä¸ªèå´æ®µï¼å¼å¨åä¸ä¸ªèå´æ®µä¸­çååæ ¼ä½¿ç¨ç¸åçé¢è²è¿è¡æ¾ç¤ºãä¸è¬ç¨æ¥åæ è¿ç»­åå¸ç°è±¡çæ°éæç¨åº¦ç¹å¾ã
 * æ¯å¦æå¹´çå¨å½éæ°´éåå¸å¾ï¼å°åæ°è±¡ç«ç¹çè§æµå¼ç»è¿åæä¹åçæçæ æ ¼æ°æ®è¿è¡åæ®µæ¾ç¤ºã
 * è¯¥ç±»ç±»ä¼¼äºåæ®µä¸é¢å¾ç±»ï¼ä¸åç¹å¨äºåæ®µä¸é¢å¾çæä½å¯¹è±¡æ¯ç¢éæ°æ®ï¼èæ æ ¼åæ®µä¸é¢å¾çæä½å¯¹è±¡æ¯æ æ ¼æ°æ®ã
 * @extends {CommonTheme}
 * @param {Object} options - åæ°ã
 * @param {Array.<ThemeGridRangeItem>} options.items - æ æ ¼åæ®µä¸é¢å¾å­é¡¹æ°ç»ã
 * @param {boolean} [options.reverseColor=false] - æ¯å¦å¯¹æ æ ¼åæ®µä¸é¢å¾ä¸­åæ®µçé¢è²é£æ ¼è¿è¡ååºæ¾ç¤ºã
 * @param {RangeMode} [options.rangeMode=RangeMode.EQUALINTERVAL] - åæ®µä¸é¢å¾çåæ®µæ¨¡å¼ã
 * @param {number} [options.rangeParameter=0] - åæ®µåæ°ã
 * @param {ColorGradientType} [options.colorGradientType=ColorGradientType.YELLOW_RED] - æ¸åé¢è²æä¸¾ç±»ã
 * @usage
 */
class ThemeGridRange extends Theme {

    constructor(options) {
        super("GRIDRANGE", options);
        /**
         * @member {Array.<ThemeGridRangeItem>} ThemeGridRange.prototype.items
         * @description æ æ ¼åæ®µä¸é¢å¾å­é¡¹æ°ç»ã<br>
         *              å¨æ æ ¼åæ®µä¸é¢å¾ä¸­ï¼å°æ æ ¼å¼æç§æç§åæ®µæ¨¡å¼è¢«åæå¤ä¸ªèå´æ®µã
         *              æ¬ç±»ç¨æ¥è®¾ç½®æ¯ä¸ªæ æ ¼èå´æ®µçåæ®µèµ·å§å¼ãç»æ­¢å¼ãåç§°åé¢è²ç­ãæ¯ä¸ªåæ®µæè¡¨ç¤ºçèå´ä¸º [Start,End)ã
         */
        this.items = null;

        /**
         * @member {RangeMode} [ThemeGridRange.prototype.rangeMode=RangeMode.EQUALINTERVAL]
         * @description åæ®µä¸é¢å¾çåæ®µæ¨¡å¼ã<br>
         *              å¨æ æ ¼åæ®µä¸é¢å¾ä¸­ï¼ä½ä¸ºä¸é¢åéçå­æ®µæè¡¨è¾¾å¼çå¼æç§æç§åæ®µæ¹å¼è¢«åæå¤ä¸ªèå´æ®µã
         *              ç®å SuperMap æä¾çåæ®µæ¹å¼åæ¬ï¼ç­è·ç¦»åæ®µæ³ãå¹³æ¹æ ¹åæ®µæ³ãæ åå·®åæ®µæ³ãå¯¹æ°åæ®µæ³ãç­è®¡æ°åæ®µæ³åèªå®ä¹è·ç¦»æ³ï¼
         *              æ¾ç¶è¿äºåæ®µæ¹æ³æ ¹æ®ä¸å®çè·ç¦»è¿è¡åæ®µï¼å èèå´åæ®µä¸é¢å¾æåºäºçä¸é¢åéå¿é¡»ä¸ºæ°å¼åã
         */
        this.rangeMode = RangeMode.EQUALINTERVAL;

        /**
         * @member {number} [ThemeGridRange.prototype.rangeParameter=0]
         * @description åæ®µåæ°ã<br>
         *              å½åæ®µæ¨¡å¼ä¸ºç­è·ç¦»åæ®µæ³ï¼å¹³æ¹æ ¹åæ®µï¼å¯¹æ°åæ®µæ³ï¼è®¡æ°åæ®µæ³å¶ä¸­ä¸ç§æ¨¡å¼æ¶ï¼è¯¥åæ°ç¨äºè®¾ç½®åæ®µä¸ªæ°ï¼å¿è®¾ï¼å½åæ®µæ¨¡å¼ä¸ºæ åå·®åæ®µæ³æ¶ï¼
         *              è¯¥åæ°ä¸èµ·ä½ç¨ï¼å½åæ®µæ¨¡å¼ä¸ºèªå®ä¹è·ç¦»æ¶ï¼è¯¥åæ°ç¨äºè®¾ç½®èªå®ä¹è·ç¦»ã
         */
        this.rangeParameter = 0;

        /**
         * @member {ColorGradientType} [ThemeGridRange.prototype.colorGradientType=ColorGradientType.YELLOW_RED]
         * @description æ¸åé¢è²æä¸¾ç±»ã
         *
         */
        this.colorGradientType = ColorGradientType.YELLOW_RED;

        /**
         * @member {boolean} ThemeGridRange.prototype.reverseColor
         * @description æ¯å¦å¯¹æ æ ¼åæ®µä¸é¢å¾ä¸­åæ®µçé¢è²é£æ ¼è¿è¡ååºæ¾ç¤ºã
         */
        this.reverseColor = false;

        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = "SuperMap.ThemeGridRange";
    }

    /**
     * @function ThemeGridRange.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
        var me = this;
        if (me.items) {
            if (me.items.length > 0) {
                for (var item in me.items) {
                    me.items[item].destroy();
                    me.items[item] = null;
                }
            }
            me.items = null;
        }
        me.reverseColor = null;
        me.rangeMode = null;
        me.rangeParameter = null;
        me.colorGradientType = null;
    }

    /**
     * @function ThemeGridRange.fromObj
     * @description ä»ä¼ å¥å¯¹è±¡è·åæ æ ¼åæ®µä¸é¢å¾ã
     * @param {Object} obj - ä¼ å¥å¯¹è±¡ã
     * @returns {ThemeGridRange} ThemeGridRange å¯¹è±¡ã
     */
    static fromObj(obj) {
        if (!obj) {
            return;
        }
        var res = new ThemeGridRange();
        Util.copy(res, obj);
        var itemsR = obj.items;
        var len = itemsR ? itemsR.length : 0;
        res.items = [];
        for (var i = 0; i < len; i++) {
            res.items.push(ThemeGridRangeItem.fromObj(itemsR[i]));
        }
        return res;
    }

}



;// CONCATENATED MODULE: ./src/common/iServer/ThemeGridUniqueItem.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class ThemeGridUniqueItem
 * @deprecatedclass SuperMap.ThemeGridUniqueItem
 * @category  iServer Map Theme
 * @classdesc æ æ ¼åå¼ä¸é¢å¾å­é¡¹ç±»ã
 *            æ æ ¼åå¼ä¸é¢å¾æ¯å°å¼ç¸åçååæ ¼å½ä¸ºä¸ç±»ï¼æ¯ä¸ç±»æ¯ä¸ä¸ªä¸é¢å¾å­é¡¹ã
 * @param {Object} options - å¯éåæ°ã
 * @param {string} [options.caption] - å­é¡¹çåç§°ã
 * @param {ServerColor} [options.color] - å­é¡¹çæ¾ç¤ºé¢è²ã
 * @param {number} options.unique - å­é¡¹çä¸é¢å¼ï¼å³ååæ ¼çå¼ï¼å¼ç¸åçååæ ¼ä½äºä¸ä¸ªå­é¡¹åã
 * @param {boolean} [options.visible=true] - å­é¡¹æ¯å¦å¯è§ã
 * @usage
 */
class ThemeGridUniqueItem {

    constructor(options) {
        /**
         * @member {string} [ThemeGridUniqueItem.prototype.caption]
         * @description æ æ ¼åå¼ä¸é¢å¾å­é¡¹çåç§°ã
         */
        this.caption = null;

        /**
         * @member {ServerColor} [ThemeGridUniqueItem.prototype.color]
         * @description æ æ ¼åå¼ä¸é¢å¾å­é¡¹çæ¾ç¤ºé¢è²ã
         */
        this.color = new ServerColor();

        /**
         * @member {number} ThemeGridUniqueItem.prototype.unique
         * @description æ æ ¼åå¼ä¸é¢å¾å­é¡¹çä¸é¢å¼ï¼å³ååæ ¼çå¼ï¼å¼ç¸åçååæ ¼ä½äºä¸ä¸ªå­é¡¹åã
         */
        this.unique = null;

        /**
         * @member {boolean} [ThemeGridUniqueItem.prototype.visible=true]
         * @description æ æ ¼åå¼ä¸é¢å¾å­é¡¹æ¯å¦å¯è§ã
         */
        this.visible = true;

        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = "SuperMap.ThemeGridUniqueItem";
    }

    /**
     * @function ThemeGridUniqueItem.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.caption = null;
        me.unique = null;

        if (me.color) {
            me.color.destroy();
            me.color = null;
        }
        me.visible = null;
    }

    /**
     * @function ThemeGridUniqueItem.prototype.toServerJSONObject
     * @description è½¬æ¢æå¯¹åºç JSON æ ¼å¼å¯¹è±¡ã
     * @returns {Object} å¯¹åºç JSON æ ¼å¼å¯¹è±¡ã
     */
    toServerJSONObject() {
        var obj = {};
        obj = Util.copyAttributes(obj, this);
        if (obj.color) {
            if (obj.color.toServerJSONObject) {
                obj.color = obj.color.toServerJSONObject();
            }
        }
        return obj;
    }

    /**
     * @function ThemeGridUniqueItem.fromObj
     * @description ä»ä¼ å¥å¯¹è±¡è·åæ æ ¼åå¼ä¸é¢å¾å­é¡¹ç±»ã
     * @param {Object} obj - ä¼ å¥å¯¹è±¡ã
     * @returns {ThemeGridUniqueItem} ThemeGridUniqueItem å¯¹è±¡ã
     */
    static fromObj(obj) {
        var res = new ThemeGridUniqueItem();
        Util.copy(res, obj);
        res.color = ServerColor.fromJson(obj.color);
        return res;

    }

}


;// CONCATENATED MODULE: ./src/common/iServer/ThemeGridUnique.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class ThemeGridUnique
 * @deprecatedclass SuperMap.ThemeGridUnique
 * @category  iServer Map Theme
 * @classdesc æ æ ¼åå¼ä¸é¢å¾ç±»ãæ æ ¼åå¼ä¸é¢å¾æ¯å°ååæ ¼å¼ç¸åçå½ä¸ºä¸ç±»ï¼ä¸ºæ¯ä¸ç±»è®¾å®ä¸ç§é¢è²ï¼ä»èç¨æ¥åºåä¸åçç±»å«ã
 * éç¨äºç¦»æ£æ æ ¼æ°æ®åé¨åè¿ç»­æ æ ¼æ°æ®ï¼å¯¹äºååæ ¼å¼åä¸ç¸åçé£äºè¿ç»­æ æ ¼æ°æ®ï¼ä½¿ç¨æ æ ¼åå¼ä¸é¢å¾ä¸å·æä»»ä½æä¹ã
 * @extends {CommonTheme}
 * @param {Object} options - åæ°ã
 * @param {Array.<ThemeGridUniqueItem>} options.items - æ æ ¼åå¼ä¸é¢å¾å­é¡¹æ°ç»ã
 * @param {ServerColor} [options.defaultcolor] - æ æ ¼åå¼ä¸é¢å¾çé»è®¤é¢è²ã
 * @usage
 */
class ThemeGridUnique extends Theme {

    constructor(options) {
        super("GRIDUNIQUE", options);
        /**
         * @member {ServerColor} ThemeGridUnique.prototype.defaultcolor
         * @description æ æ ¼åå¼ä¸é¢å¾çé»è®¤é¢è²ã
         *              å¯¹äºé£äºæªå¨æ ¼ç½åå¼ä¸é¢å¾å­é¡¹ä¹åçè¦ç´ ä½¿ç¨è¯¥é¢è²æ¾ç¤ºã
         */
        this.defaultcolor = new ServerColor();

        /**
         * @member {Array.<ThemeGridUniqueItem>} ThemeGridUnique.prototype.items
         * @description æ æ ¼åå¼ä¸é¢å¾å­é¡¹æ°ç»ã
         *              æ æ ¼åå¼ä¸é¢å¾å°å¼ç¸åçååæ ¼å½ä¸ºä¸ç±»ï¼æ¯ä¸ç±»æ¯ä¸ä¸ªä¸é¢å¾å­é¡¹ã
         */
        this.items = null;

        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = "SuperMap.ThemeGridUnique";
    }

    /**
     * @function ThemeGridUnique.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
        var me = this;
        if (me.items) {
            if (me.items.length > 0) {
                for (var item in me.items) {
                    me.items[item].destroy();
                    me.items[item] = null;
                }
            }
            me.items = null;
        }

        if (me.defaultcolor) {
            me.defaultcolor.destroy();
            me.defaultcolor = null;
        }
    }

    /**
     * @function ThemeGridUnique.prototype.toServerJSONObject
     * @description è½¬æ¢æå¯¹åºç JSON æ ¼å¼å¯¹è±¡ã
     * @returns {Object} å¯¹åºç JSON æ ¼å¼å¯¹è±¡
     */
    toServerJSONObject() {
        var obj = {};
        obj = Util.copyAttributes(obj, this);
        if (obj.defaultcolor) {
            if (obj.defaultcolor.toServerJSONObject) {
                obj.defaultcolor = obj.defaultcolor.toServerJSONObject();
            }
        }
        if (obj.items) {
            var items = [],
                len = obj.items.length;
            for (var i = 0; i < len; i++) {
                items.push(obj.items[i].toServerJSONObject());
            }
            obj.items = items;
        }
        return obj;
    }

    /**
     * @function ThemeGridUnique.fromObj
     * @description ä»ä¼ å¥å¯¹è±¡è·åæ æ ¼åå¼ä¸é¢å¾ç±»ã
     * @param {Object} obj - ä¼ å¥å¯¹è±¡
     * @returns {ThemeGridUnique} ThemeGridUnique å¯¹è±¡
     */
    static fromObj(obj) {
        var res = new ThemeGridUnique();
        var uItems = obj.items;
        var len = uItems ? uItems.length : 0;
        Util.extend(res, obj);
        res.items = [];
        res.defaultcolor = ServerColor.fromJson(obj.defaultcolor);
        for (var i = 0; i < len; i++) {
            res.items.push(ThemeGridUniqueItem.fromObj(uItems[i]));
        }
        return res;
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/ThemeLabelUniqueItem.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class ThemeLabelUniqueItem
 * @deprecatedclass SuperMap.ThemeLabelUniqueItem
 * @category  iServer Map Theme
 * @classdesc åå¼æ ç­¾ä¸é¢å¾çå­é¡¹ãæ ç­¾ä¸é¢å¾ç¨ä¸é¢å¼å¯¹ç¹ãçº¿ãé¢ç­å¯¹è±¡åæ æ³¨ï¼å¼å¾æ³¨æçæ¯ï¼åå¼æ ç­¾ä¸é¢å¾åè®¸ç¨æ·éè¿ uniqueExpression
 * å­æ®µæå®ç¨äºåå¼çå­æ®µï¼åä¸å¼çæ ç­¾å·æç¸åçæ¾ç¤ºé£æ ¼ï¼å¶ä¸­æ¯ä¸ä¸ªå¼å°±æ¯ä¸ä¸ªä¸é¢å¾å­é¡¹ï¼
 * æ¯ä¸ä¸ªå­é¡¹é½å·æå¶åç§°ãé£æ ¼ãæå®çåå¼ãX æ¹ååç§»éå Y æ¹ååç§»éã
 * @param {Object} options - åæ°ã
 * @param {string} options.unique - å­é¡¹çå¼ï¼å¯ä»¥ä¸ºæ°å­ãå­ç¬¦ä¸²ç­ã
 * @param {string} [options.caption] - å­é¡¹çåç§°ã
 * @param {number} [options.offsetX=0] - æ ç­¾å¨ X æ¹ååç§»éã
 * @param {number} [options.offsetY=0] - æ ç­¾å¨ Y æ¹ååç§»éã
 * @param {boolean} [options.visible=true] - å­é¡¹æ¯å¦å¯è§ã
 * @param {ServerTextStyle} [options.style] - å­é¡¹ææ¬çæ¾ç¤ºé£æ ¼ã
 * @usage
 */
class ThemeLabelUniqueItem {

    constructor(options) {
        /**
         * @member {string} [ThemeLabelUniqueItem.prototype.caption]
         * @description æ ç­¾ä¸é¢å­é¡¹çæ é¢ã
         */
        this.caption = null;

        /**
         * @member {string} ThemeLabelUniqueItem.prototype.unique
         * @description åå¼ä¸é¢å¾å­é¡¹çå¼ï¼å¯ä»¥ä¸ºæ°å­ãå­ç¬¦ä¸²ç­ã
         */
        this.unique = null;

        /**
         * @member {number} [ThemeLabelUniqueItem.prototype.offsetX=0]
         * @description æ ç­¾å¨ X æ¹ååç§»éã
         */
        this.offsetX = 0;

        /**
         * @member {number} [ThemeLabelUniqueItem.prototype.offsetY=0]
         * @description æ ç­¾å¨ Y æ¹ååç§»éã
         */
        this.offsetY = 0;

        /**
         * @member {boolean} [ThemeLabelUniqueItem.prototype.visible=true]
         * @description æ ç­¾ä¸é¢å¾å­é¡¹æ¯å¦å¯è§ãå¦ææ ç­¾ä¸é¢å¾å­é¡¹å¯è§ï¼åä¸º trueï¼å¦åä¸º falseã
         */
        this.visible = true;

        /**
         * @member {ServerTextStyle} ThemeLabelUniqueItem.prototype.style
         * @description æ ç­¾ä¸é¢å¾å­é¡¹ææ¬çæ¾ç¤ºé£æ ¼ãåç§é£æ ¼çä¼åçº§ä»é«å°ä½ä¸ºï¼<br>
         *              uniformMixedStyleï¼æ ç­¾ææ¬çå¤åé£æ ¼ï¼ï¼ThemeLabelUniqueItem.styleï¼åå¼å­é¡¹çææ¬é£æ ¼ï¼ï¼uniformStyleï¼ç»ä¸ææ¬é£æ ¼ï¼ã
         */
        this.style = new ServerTextStyle();

        if (options) {
            Util.extend(this, options);
        }
        this.CLASS_NAME = "SuperMap.ThemeLabelUniqueItem";
    }

    /**
     * @function ThemeLabelUniqueItem.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.unique = null;
        me.caption = null;
        me.offsetX = null;
        me.offsetY = null;
        if (me.style) {
            me.style.destroy();
            me.style = null;
        }
        me.visible = null;
    }

    /**
     * @function ThemeLabelUniqueItem.fromObj
     * @description ä»ä¼ å¥å¯¹è±¡è·ååå¼æ ç­¾ä¸é¢å¾çå­é¡¹ç±»ã
     * @param {Object} obj - ä¼ å¥å¯¹è±¡ã
     * @returns {ThemeLabelUniqueItem} ThemeLabelUniqueItem å¯¹è±¡ã
     */
    static fromObj(obj) {
        if (!obj) {
            return;
        }
        var t = new ThemeLabelUniqueItem();
        Util.copy(t, obj);
        return t;
    }

}


;// CONCATENATED MODULE: ./src/common/iServer/ThemeMemoryData.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/

/**
 * @class ThemeMemoryData
 * @deprecatedclass SuperMap.ThemeMemoryData
 * @category  iServer Map Theme
 * @classdesc ä¸é¢å¾åå­æ°æ®ç±»ã
 * @param {Array} srcData - åå§å¼æ°ç»ã
 * @param {Array} targetData - å¤é¨å¼æ°ç»ã
 * @usage
 */
class ThemeMemoryData {

    constructor(srcData, targetData) {
        /**
         * @member {Array} ThemeMemoryData.prototype.srcData
         * @description åå§å¼æ°ç»ï¼è¯¥å±æ§å¼å°è¢« targetData å±æ§ææå®çå¼æ¿æ¢æï¼ç¶åå¶ä½ä¸é¢å¾ï¼ä½æ°æ®åºä¸­çå¼å¹¶ä¸ä¼æ¹åã
         */
        this.srcData = srcData;

        /**
         * @member {Array} ThemeMemoryData.prototype.targetData
         * @description å¤é¨å¼æ°ç»ï¼å³ç¨äºå¶ä½ä¸é¢å¾çåå­æ°æ®ï¼è®¾å®è¯¥å±æ§å¼åï¼ä¼å° srcData å±æ§ææå®çåå§å¼æ¿æ¢æå¶ä½ä¸é¢å¾ï¼ä½æ°æ®åºä¸­çå¼å¹¶ä¸ä¼æ¹åã
         */
        this.targetData = targetData;

        this.CLASS_NAME = "SuperMap.ThemeMemoryData";
    }

    /**
     * @function ThemeMemoryData.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.srcData = null;
        me.targetData = null;
    }


    /**
     * @function ThemeMemoryData.prototype.toJSON
     * @description å° ThemeMemoryData å¯¹è±¡è½¬åä¸º JSON å­ç¬¦ä¸²ã
     * @returns {string} è¿åè½¬æ¢åç JSON å­ç¬¦ä¸²ã
     */
    toJSON() {
        if (this.srcData && this.targetData) {
            var memoryDataStr = "";
            var count = Math.min(this.srcData.length, this.targetData.length);
            for (var i = 0; i < count; i++) {
                memoryDataStr += "\'" + this.srcData[i] + "\':\'" + this.targetData[i] + "\',";
            }
            //å»é¤å¤ä½çéå·
            if (i > 0) {
                memoryDataStr = memoryDataStr.substring(0, memoryDataStr.length - 1);
            }
            return "{" + memoryDataStr + "}";
        } else {
            return null;
        }
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/ThemeParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/

/**
 * @class ThemeParameters
 * @deprecatedclass SuperMap.ThemeParameters
 * @category  iServer Map Theme
 * @classdesc ä¸é¢å¾åæ°ç±»ã
 *            è¯¥ç±»å­å¨äºå¶ä½ä¸é¢æéçåæ°ï¼åæ¬æ°æ®æºãæ°æ®éåç§°åä¸é¢å¾å¯¹è±¡ã
 * @param {Object} options - åæ°ã
 * @param {Array.<string>} options.datasetNames - æ°æ®éæ°ç»ã
 * @param {Array.<string>} options.dataSourceNames - æ°æ®æºæ°ç»ã
 * @param {Array.<JoinItem>} [options.joinItems] - ä¸é¢å¾å¤é¨è¡¨çè¿æ¥ä¿¡æ¯ JoinItem æ°ç»ã
 * @param {Array.<CommonTheme>} options.themes - ä¸é¢å¾å¯¹è±¡åè¡¨ã
 * @param {Array.<string>} [options.displayFilters] - ä¸é¢å¾å±æ§è¿æ»¤æ¡ä»¶ã
 * @param {Array.<string>} [options.displayOrderBys] - ä¸é¢å¾å¯¹è±¡çæç¬¦å·å å æ¬¡åºæåºå­æ®µã
 * @param {Object} [options.fieldValuesDisplayFilter] - å¾å±è¦ç´ çæ¾ç¤ºåéèçè¿æ»¤å±æ§ï¼å¶å¸¦æä¸ä¸ªå±æ§ï¼åå«æ¯:valuesãfieldNameãfieldValuesDisplayModeã
 * @usage
 */
class ThemeParameters {

    constructor(options) {
        /**
         * @member {Array.<string>} ThemeParameters.prototype.datasetNames
         * @description è¦å¶ä½ä¸é¢å¾çæ°æ®éæ°ç»ã
         */
        this.datasetNames = null;

        /**
         * @member {Array.<string>} ThemeParameters.prototype.dataSourceNames
         * @description è¦å¶ä½ä¸é¢å¾çæ°æ®éæå¨çæ°æ®æºæ°ç»ã
         */
        this.dataSourceNames = null;

        /**
         * @member {Array.<JoinItem>} [ThemeParameters.prototype.joinItems]
         * @description è®¾ç½®ä¸å¤é¨è¡¨çè¿æ¥ä¿¡æ¯ JoinItem æ°ç»ã
         *               ä½¿ç¨æ­¤å±æ§å¯ä»¥å¶ä½ä¸å¤é¨è¡¨è¿æ¥çä¸é¢å¾ã
         */
        this.joinItems = null;

        /**
         * @member {Array.<CommonTheme>} ThemeParameters.prototype.themes
         * @description ä¸é¢å¾å¯¹è±¡åè¡¨ã
         *              è¯¥åæ°ä¸ºå®ä¾åçåç±»ä¸é¢å¾å¯¹è±¡çéåã
         */
        this.themes = null;

        /**
         * @member {Array.<string>} [ThemeParameters.prototype.displayFilters]
         * @description ä¸é¢å¾å±æ§è¿æ»¤æ¡ä»¶ã
         */
        this.displayFilters = null;

        /**
         * @member {Array.<string>}  [ThemeParameters.prototype.displayOrderBys]
         * @description ä¸é¢å¾å¯¹è±¡çæç¬¦å·å å æ¬¡åºæåºå­æ®µã
         */
        this.displayOrderBys = null;

        /**
         * @member {Object} [ThemeParameters.prototype.fieldValuesDisplayFilter]
         * @property {Array.<number>} values - å¾è¿æ»¤çå¼ã
         * @property {string} fieldName - å¾è¿æ»¤çå­æ®µåç§°åªæ¯ææ°å­ç±»åçå­æ®µã
         * @property {string} fieldValuesDisplayMode - ç®åä¸º DISPLAY/DISABLEãå½ä¸º DISPLAY æ¶ï¼è¡¨ç¤ºåªæ¾ç¤ºä»¥ä¸è®¾ç½®çç¸åºå±æ§å¼çè¦ç´ ï¼å¦åè¡¨ç¤ºä¸æ¾ç¤ºä»¥ä¸è®¾ç½®çç¸åºå±æ§å¼çè¦ç´ ã
         */
        this.fieldValuesDisplayFilter = null;

        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = "SuperMap.ThemeParameters";
    }


    /**
     * @function ThemeParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.datasetNames = null;
        me.dataSourceNames = null;
        if (me.joinItems) {
            for (let i = 0, joinItems = me.joinItems, len = joinItems.length; i < len; i++) {
                joinItems[i].destroy();
            }
            me.joinItems = null;
        }
        if (me.themes) {
            for (let i = 0, themes = me.themes, len = themes.length; i < len; i++) {
                themes[i].destroy();
            }
            me.themes = null;
        }
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/ThemeService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class ThemeService
 * @deprecatedclass SuperMap.ThemeService
 * @category  iServer Map Theme
 * @classdesc ä¸é¢å¾æå¡ç±»ã
 * @extends {CommonServiceBase}
 * @example
 * var myThemeService = new ThemeService(url, {
 *     eventListeners: {
 *           "processCompleted": themeCompleted,
 *           "processFailed": themeFailed
 *           }
 * });
 * @param {string} url - æå¡å°åãå¦ï¼http://localhost:8090/iserver/services/map-world/rest/maps/World+Map ã
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - éè¦è¢«æ³¨åççå¬å¨å¯¹è±¡ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class ThemeService_ThemeService extends CommonServiceBase {

    constructor(url, options) {
        super(url, options);
        if (options) {
            Util.extend(this, options);
        }
        this.url = Util.urlPathAppend(this.url, 'tempLayersSet');
        this.CLASS_NAME = 'SuperMap.ThemeService';
    }

    /**
     * @override
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function ThemeService.prototype.processAsync
     * @description è´è´£å°å®¢æ·ç«¯çä¸é¢å¾åæ°ä¼ éå°æå¡ç«¯ã
     * @param {ThemeParameters} params - ä¸é¢å¾åæ°ç±»ã
     */
    processAsync(params) {
        if (!(params instanceof ThemeParameters)) {
            return;
        }
        var me = this,
            jsonParameters = null;
        jsonParameters = me.getJsonParameters(params);
        me.request({
            method: "POST",
            data: jsonParameters,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }

    /**
     * @function ThemeService.prototype.getJsonParameters
     * @description å°ä¸é¢å¾åæ°åæ°è½¬åä¸º JSON å­ç¬¦ä¸²ã
     * @param {ThemeParameters} parameter - ä¸é¢å¾åæ°ç±»ã
     * @returns {Object} è½¬ååçJSONå­ç¬¦ä¸²ã
     */
    getJsonParameters(parameter) {
        var jsonParameters = "",
            themeObj = null,
            filters = null,
            orderBys = null,
            fieldValuesDisplayFilter;
        jsonParameters += "[{'type': 'UGC','subLayers': {'layers': [";

        for (var i = 0; i < parameter.themes.length; i++) {
            themeObj = parameter.themes[i];
            var jsonTheme = Util.toJSON(themeObj);
            jsonTheme = jsonTheme.slice(0, -1);

            jsonParameters += "{'theme': " + jsonTheme + "},'type': 'UGC','ugcLayerType': 'THEME',";
            filters = parameter.displayFilters;
            if (filters && filters.length > 0) {
                if (filters.length === 1) {
                    jsonParameters += "'displayFilter':\"" + filters[0] + "\",";
                } else {
                    jsonParameters += "'displayFilter':\"" + filters[i] + "\",";
                }
            }
            orderBys = parameter.displayOrderBy;
            if (orderBys && orderBys.length > 0) {
                if (orderBys.length === 1) {
                    jsonParameters += "'displayOrderBy':'" + orderBys[0] + "',";
                } else {
                    jsonParameters += "'displayOrderBy':'" + orderBys[i] + "',";
                }
            }

            fieldValuesDisplayFilter = parameter.fieldValuesDisplayFilter;
            if (fieldValuesDisplayFilter) {
                jsonParameters += "'fieldValuesDisplayFilter':" + Util.toJSON(fieldValuesDisplayFilter) + ",";
            }

            if (parameter.joinItems && parameter.joinItems.length > 0 && parameter.joinItems[i]) {
                jsonParameters += "'joinItems':[" + Util.toJSON(parameter.joinItems[i]) + "],";
            }
            if (parameter.datasetNames && parameter.dataSourceNames) {
                var datasetID = parameter.datasetNames[i] ? i : (parameter.datasetNames.length - 1);
                var dataSourceID = parameter.dataSourceNames[i] ? i : (parameter.dataSourceNames.length - 1);
                jsonParameters += "'datasetInfo': {'name': '" + parameter.datasetNames[datasetID] +
                    "','dataSourceName': '" + parameter.dataSourceNames[dataSourceID] + "'}},";
            } else {
                jsonParameters += "},";
            }
        }
        //å»é¤å¤ä½çéå·
        if (parameter.themes && parameter.themes.length > 0) {
            jsonParameters = jsonParameters.substring(0, jsonParameters.length - 1);
        }
        jsonParameters += "]},";
        var urlArray = this.url.split("/");
        var jsonMapName = urlArray[urlArray.length - 2];

        jsonParameters += "'name': '" + jsonMapName + "'}]";
        return jsonParameters;
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/ThiessenAnalystService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class ThiessenAnalystService
 * @deprecatedclass SuperMap.ThiessenAnalystService
 * @category  iServer SpatialAnalyst ThiessenPolygonAnalyst
 * @classdesc
 * æ³°æ£®å¤è¾¹å½¢åææå¡ç±»
 * è¯¥ç±»è´è´£å°å®¢æ·è®¾ç½®çæ³°æ£®å¤è¾¹å½¢åæåæ°ä¼ éç»æå¡ç«¯ï¼å¹¶æ¥æ¶æå¡ç«¯è¿åçåæç»ææ°æ®ã
 * æ³°æ£®å¤è¾¹å½¢åæç»æéè¿è¯¥ç±»æ¯æçäºä»¶ççå¬å½æ°åæ°è·å
 * æ³°æ£®å¤è¾¹å½¢åæçåæ°æ¯æä¸¤ç§ï¼å½åæ°ä¸º {@link DatasetThiessenAnalystParameters} ç±»å
 * æ¶ï¼æ§è¡æ°æ®éæ³°æ£®å¤è¾¹å½¢åæï¼å½åæ°ä¸º {@link GeometryThiessenAnalystParameters} ç±»åæ¶ï¼
 * æ§è¡å ä½å¯¹è±¡æ³°æ£®å¤è¾¹å½¢åæã
 * @param {string} url - æå¡å°åãå¦ http://localhost:8090/iserver/services/spatialanalyst-changchun/restjsr/spatialanalystã
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - éè¦è¢«æ³¨åççå¬å¨å¯¹è±¡ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @extends {SpatialAnalystBase}
 * @example ä¾å¦ï¼
 * (start code)
 * var myThiessenAnalystService = new ThiessenAnalystService(url, {
     *     eventListeners: {
     *           "processCompleted": bufferCompleted,
     *           "processFailed": bufferFailed
     *           }
     *    });
 * (end)
 * @usage
 */
class ThiessenAnalystService extends SpatialAnalystBase {


    constructor(url, options) {
        super(url, options);
        /**
         * @member {string} ThiessenAnalystService.prototype.mode
         * @description ç¼å²åºåæç±»å
         */
        this.mode = null;
        if (options) {
            Util.extend(this, options);
        }
        this.CLASS_NAME = "SuperMap.ThiessenAnalystService";
    }

    /**
     * @override
     */
    destroy() {
        super.destroy();
        this.mode = null;
    }

    /**
     * @function ThiessenAnalystService.prototype.processAsync
     * @description è´è´£å°å®¢æ·ç«¯çæ¥è¯¢åæ°ä¼ éå°æå¡ç«¯ã
     * @param {DatasetThiessenAnalystParameters|GeometryThiessenAnalystParameters} parameter - æ³°æ£®å¤è¾¹å½¢åæåæ°åºç±»ã
     */
    processAsync(parameter) {
        var parameterObject = {};
        var me = this;
        if (parameter instanceof DatasetThiessenAnalystParameters) {
            me.mode = "datasets";
            me.url = Util.urlPathAppend(me.url, 'datasets/' + parameter.dataset + '/thiessenpolygon');
            DatasetThiessenAnalystParameters.toObject(parameter, parameterObject);
        } else if (parameter instanceof GeometryThiessenAnalystParameters) {
            me.mode = "geometry";
            me.url = Util.urlPathAppend(me.url, 'geometry/thiessenpolygon');
            GeometryThiessenAnalystParameters.toObject(parameter, parameterObject);
        }

        var jsonParameters = Util.toJSON(parameterObject);
        me.url = Util.urlAppend(me.url, 'returnContent=true');
        me.request({
            method: "POST",
            data: jsonParameters,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }
}

;// CONCATENATED MODULE: ./src/common/iServer/GeometryBatchAnalystService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/







/**
 * @class GeometryBatchAnalystService
 * @deprecatedclass SuperMap.GeometryBatchAnalystService
 * @category iServer SpatialAnalyst BatchAnalyst
 * @classdesc æ¹éç©ºé´åææå¡ç±»
 * @description è¯¥ç±»è´è´£å°å®¢æ·è®¾ç½®çå å åæåæ°ä¼ éç»æå¡ç«¯ï¼å¹¶æ¥æ¶æå¡ç«¯è¿åçå å åæç»ææ°æ®ã
 *              è·åçç»ææ°æ®åæ¬ originResult ãresult ä¸¤ç§ï¼
 *              å¶ä¸­ï¼originResult ä¸ºæå¡ç«¯è¿åçç¨ JSON å¯¹è±¡è¡¨ç¤ºçéç®ç»ææ°æ®ï¼result ä¸ºæå¡ç«¯è¿åçéç®ç»ææ°æ®ã
 * @extends {SpatialAnalystBase}
 * @param {string} url - æå¡å°åãå¦ï¼http://localhost:8090/iserver/services/spatialanalyst-changchun/restjsr/spatialanalystã
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - éè¦è¢«æ³¨åççå¬å¨å¯¹è±¡ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @example
 * var myOverlayAnalystService = new GeometryBatchAnalystService(url, {
 *     eventListeners: {
 *	       "processCompleted": OverlayCompleted,
 *		   "processFailed": OverlayFailed
 *		   }
 * });
 * @usage
 */
class GeometryBatchAnalystService extends SpatialAnalystBase {

    constructor(url, options) {
        super(url, options);

        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = "SuperMap.GeometryBatchAnalystService";
    }

    /**
     * @function GeometryBatchAnalystService.prototype.processAsync
     * @description è´è´£å°å®¢æ·ç«¯çæ¥è¯¢åæ°ä¼ éå°æå¡ç«¯ã
     * @param {GeometryOverlayAnalystParameter} parameter - æ¹éå ä½å¯¹è±¡å å åæåæ°ç±»
     *
     */
    processAsync(parameters) {
        var me = this;
        me.url = Util.urlPathAppend(me.url, 'geometry/batchanalyst');
        me.url = Util.urlAppend(me.url, 'returnContent=true&ignoreAnalystParam=true');
        var parameterObjects = me._processParams(parameters);
        var jsonParameters = Util.toJSON(parameterObjects);

        me.request({
            method: "POST",
            data: jsonParameters,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }

    _processParams(parameters) {
        var me = this;
        if (!Util.isArray(parameters)) {
            return;
        }
        var processParams = [];
        parameters.map(function (item) {
            processParams.push(me._toJSON(item));
            return item;
        });

        return processParams;
    }

    _toJSON(parameter) {
        var tempObj = {};
        if(parameter.analystName ==="buffer"){
            tempObj.analystName = "buffer";
            tempObj.param = {};
            //å ä½å¯¹è±¡çæ¹éç©ºé´åæï¼
            GeometryBufferAnalystParameters.toObject(parameter.param, tempObj.param);

        }else if(parameter.analystName ==="overlay"){
            tempObj.analystName = "overlay";
            tempObj.param = {};
            GeometryOverlayAnalystParameters.toObject(parameter.param, tempObj.param);

        }else if(parameter.analystName ==="interpolationDensity"){
            tempObj.analystName = "interpolationDensity";
            tempObj.param = {};
            InterpolationAnalystParameters.toObject(parameter.param, tempObj.param);

        }else if(parameter.analystName ==="interpolationidw"){
            tempObj.analystName = "interpolationidw";
            tempObj.param = {};
            InterpolationAnalystParameters.toObject(parameter.param, tempObj.param);

        }else if(parameter.analystName ==="interpolationRBF"){
            tempObj.analystName = "interpolationRBF";
            tempObj.param = {};
            InterpolationAnalystParameters.toObject(parameter.param, tempObj.param);

        }else if(parameter.analystName ==="interpolationKriging"){
            tempObj.analystName = "interpolationKriging";
            tempObj.param = {};
            InterpolationAnalystParameters.toObject(parameter.param, tempObj.param);

        }else if(parameter.analystName ==="thiessenpolygon"){
            tempObj.analystName = "thiessenpolygon";
            tempObj.param = {};
            GeometryThiessenAnalystParameters.toObject(parameter.param, tempObj.param);

        }else {
            //isoline; isoregion; calculatemeasure; routelocator åç§åæä¸éè¦åå¤çåæ°
            return parameter;
        }
        return tempObj;
    }

    /**
     * @override
     */
    destroy() {
        super.destroy();
    }


}

;// CONCATENATED MODULE: ./src/common/iServer/TilesetsService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class TilesetsService
 * @deprecatedclass SuperMap.TilesetsService
 * @category  iServer Map Tilesets
 * @classdesc åçåè¡¨ä¿¡æ¯æ¥è¯¢æå¡ç±»ï¼å³æ¥è¯¢åçå°å¾æå¡çåçåè¡¨ï¼è¿ååçéåç§°ãå°å¾åçåæ°æ®ä¿¡æ¯ãåççæ¬éä¿¡æ¯ã
 * @extends {CommonServiceBase}
 * @param {string} url - æå¡å°åãURL åºä¸ºï¼
 *                       http://{æå¡å¨å°å}:{æå¡ç«¯å£å·}/iserver/services/{æå¡å}/rest/maps/mapï¼
 *                       ä¾å¦: "http://localhost:8090/iserver/services/test/rest/maps/tianlocal"ã
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - äºä»¶çå¬å¨å¯¹è±¡ãæ processCompleted å±æ§å¯ä¼ å¥å¤çå®æåçåè°å½æ°ãprocessFailed å±æ§ä¼ å¥å¤çå¤±è´¥åçåè°å½æ°ã
 * @param {DataFormat} [options.format=DataFormat.GEOJSON] - æ¥è¯¢ç»æè¿åæ ¼å¼ï¼ç®åæ¯æ iServerJSON å GeoJSON ä¸¤ç§æ ¼å¼ãåæ°æ ¼å¼ä¸º "ISERVER"ï¼"GEOJSON"ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class TilesetsService extends CommonServiceBase {

    constructor(url, options) {
        super(url, options);
        this.CLASS_NAME = "SuperMap.TilesetsService";
    }

    /**
     * @override
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function TilesetsService.prototype.processAsync
     * @description è´è´£å°å®¢æ·ç«¯çæ¥è¯¢åæ°ä¼ éå°æå¡ç«¯ã
     */
    processAsync() {
        if (!this.url) {
            return;
        }
        var me = this;
        me.url = Util.urlPathAppend(me.url, 'tilesets');
        me.request({
            method: "GET",
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }
}

;// CONCATENATED MODULE: ./src/common/iServer/TopologyValidatorJobsParameter.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class TopologyValidatorJobsParameter
 * @deprecatedclass SuperMap.TopologyValidatorJobsParameter
 * @category  iServer ProcessingService TopologyValidator
 * @classdesc æææ£æ¥åæä»»å¡åæ°ç±»ã
 * @param {Object} options - åæ°ã
 * @param {string} options.datasetName - æ°æ®éåã
 * @param {string} options.datasetTopology -æ£æ¥å¯¹è±¡æå¨çæ°æ®éåç§°ã
 * @param {TopologyValidatorRule} [options.rule=TopologyValidatorRule.REGIONNOOVERLAP] - æææ£æ¥è§åã
 * @param {string} [options.tolerance] - å®¹éã
 * @param {OutputSetting} [options.output] - è¾åºåæ°è®¾ç½®ã
 * @param {MappingParameters} [options.mappingParameters] - åæåç»æå¯è§åçåæ°ç±»ã
 * @usage
 */
class TopologyValidatorJobsParameter {

    constructor(options) {
        if (!options) {
            return;
        }
        /**
         * @member {string} TopologyValidatorJobsParameter.prototype.datasetName
         * @description æ°æ®éåã
         */
        this.datasetName = "";

        /**
         * @member {string} TopologyValidatorJobsParameter.prototype.datasetTopology
         * @description æææ£æ¥å¯¹è±¡æå¨çæ°æ®éåç§°ã
         */
        this.datasetTopology = "";

        /**
         * @member {string} [TopologyValidatorJobsParameter.prototype.tolerance]
         * @description å®¹éï¼æå®çææéè¯¯æ£æ¥æ¶ä½¿ç¨çå®¹éã
         */
        this.tolerance = "";

        /**
         * @member {TopologyValidatorRule} [TopologyValidatorJobsParameter.prototype.rule=TopologyValidatorRule.REGIONNOOVERLAP]
         * @description æææ£æ¥æ¨¡å¼ã
         */
        this.rule = TopologyValidatorRule.REGIONNOOVERLAP;

        /**
         * @member {OutputSetting} [TopologyValidatorJobsParameter.prototype.output]
         * @description è¾åºåæ°è®¾ç½®ç±»ã
         */
        this.output = null;

        /**
         * @member {MappingParameters} [TopologyValidatorJobsParameter.prototype.mappingParameters]
         * @description åæåç»æå¯è§åçåæ°ç±»ã
         */
        this.mappingParameters = null;

        Util.extend(this, options);

        this.CLASS_NAME = "SuperMap.TopologyValidatorJobsParameter";
    }

    /**
     * @function TopologyValidatorJobsParameter.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        this.datasetName = null;
        this.datasetTopology = null;
        this.tolerance = null;
        this.rule = null;
        if (this.output instanceof OutputSetting) {
            this.output.destroy();
            this.output = null;
        }
        if (this.mappingParameters instanceof MappingParameters) {
            this.mappingParameters.destroy();
            this.mappingParameters = null;
        }
    }

    /**
     * @function TopologyValidatorJobsParameter.toObject
     * @param {Object} TopologyValidatorJobsParameter -æææ£æ¥åæä»»å¡åæ°ã
     * @param {Object} tempObj - ç®æ å¯¹è±¡ã
     * @description çææææ£æ¥åæä»»å¡å¯¹è±¡ã
     */
    static toObject(TopologyValidatorJobsParameter, tempObj) {
        for (var name in TopologyValidatorJobsParameter) {
            if (name === "datasetName") {
                tempObj['input'] = tempObj['input'] || {};
                tempObj['input'][name] = TopologyValidatorJobsParameter[name];
                continue;
            }
            if (name === "output") {
                tempObj['output'] = tempObj['output'] || {};
                tempObj['output'] = TopologyValidatorJobsParameter[name];
                continue;
            }
            tempObj['analyst'] = tempObj['analyst'] || {};
            tempObj['analyst'][name] = TopologyValidatorJobsParameter[name];
            if(name === 'mappingParameters'){
                tempObj['analyst'][name] = tempObj['analyst'][name] || {};
                tempObj['analyst']['mappingParameters'] = TopologyValidatorJobsParameter[name];
            }
        }
    }
}

;// CONCATENATED MODULE: ./src/common/iServer/TopologyValidatorJobsService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class TopologyValidatorJobsService
 * @deprecatedclass SuperMap.TopologyValidatorJobsService
 * @category  iServer ProcessingService TopologyValidator
 * @classdesc æææ£æ¥åææå¡ç±»
 * @extends {ProcessingServiceBase}
 * @param {string} url - æå¡å°åã
 * @param {Object} options - å¯éåæ°ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class TopologyValidatorJobsService extends ProcessingServiceBase {

    constructor(url, options) {
        super(url, options);
        this.url = Util.urlPathAppend(this.url, 'spatialanalyst/topologyvalidator');
        this.CLASS_NAME = "SuperMap.TopologyValidatorJobsService";
    }

    /**
     *@override
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function TopologyValidatorJobsService.protitype.getTopologyValidatorJobs
     * @description è·åæææ£æ¥åæææä»»å¡
     */
    getTopologyValidatorJobs() {
        super.getJobs(this.url);
    }

    /**
     * @function TopologyValidatorJobsService.protitype.getTopologyValidatorJob
     * @description è·åæå®idçæææ£æ¥åææå¡
     * @param {string} id - æå®è¦è·åæ°æ®çid
     */
    getTopologyValidatorJob(id) {
        super.getJobs( Util.urlPathAppend(this.url, id));
    }

    /**
     * @function TopologyValidatorJobsService.protitype.addTopologyValidatorJob
     * @description æ°å»ºæææ£æ¥åææå¡
     * @param {TopologyValidatorJobsParameter} params - æææ£æ¥åæä»»å¡åæ°ç±»ã
     * @param {number} seconds -åå»ºæåç»æçæ¶é´é´éã
     */
    addTopologyValidatorJob(params, seconds) {
        super.addJob(this.url, params, TopologyValidatorJobsParameter, seconds);
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/TransferLine.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class TransferLine
 * @deprecatedclass SuperMap.TransferLine
 * @category  iServer TrafficTransferAnalyst TransferPath
 * @classdesc æ¢ä¹è·¯çº¿ä¿¡æ¯ç±»ã
 * @param {Object} options - åæ°ã
 * @param {number} options.lineID - ä¹è½¦è·¯çº¿ IDã
 * @param {string} options.lineName - ä¹è½¦è·¯çº¿åç§°ã
 * @param {string} options.lineAliasName - ä¹è½¦è·¯çº¿å«åã
 * @param {number} options.startStopIndex - ä¸è½¦ç«ç¹å¨æ¬å¬äº¤è·¯çº¿ä¸­çç´¢å¼ã
 * @param {string} options.startStopName - ä¸è½¦ç«ç¹åç§°ã
 * @param {string} options.startStopAliasName - ä¸è½¦ç«ç¹å«åã
 * @param {number} options.endStopIndex - ä¸è½¦ç«ç¹å¨æ¬å¬äº¤è·¯çº¿ä¸­çç´¢å¼ã
 * @param {string} options.endStopName - ä¸è½¦ç«ç¹åç§°ã
 * @param {string} options.endStopAliasName - ä¸è½¦ç«ç¹å«åã
 * @usage
 */
class TransferLine {

    constructor(options) {
        options = options || {};
        /**
         * @member {number} TransferLine.prototype.lineID
         * @description ä¹è½¦è·¯çº¿ IDã
         */
        this.lineID = null;

        /**
         * @member {string} TransferLine.prototype.lineName
         * @description ä¹è½¦è·¯çº¿åç§°ã
         */
        this.lineName = null;

        /**
         * @member {string} TransferLine.prototype.lineAliasName
         * @description ä¹è½¦è·¯çº¿å«åã
         */
        this.lineAliasName = null;

        /**
         * @member {number} TransferLine.prototype.startStopIndex
         * @description ä¸è½¦ç«ç¹å¨æ¬å¬äº¤è·¯çº¿ä¸­çç´¢å¼ã
         */
        this.startStopIndex = null;

        /**
         * @member {string} TransferLine.prototype.startStopName
         * @description ä¸è½¦ç«ç¹åç§°ã
         */
        this.startStopName = null;

        /**
         * @member {string} TransferLine.prototype.startStopAliasName
         * @description ä¸è½¦ç«ç¹å«åã
         */
        this.startStopAliasName = null;

        /**
         * @member {number} TransferLine.prototype.endStopIndex
         * @description ä¸è½¦ç«ç¹å¨æ¬å¬äº¤è·¯çº¿ä¸­çç´¢å¼ã
         */
        this.endStopIndex = null;

        /**
         * @member {string} TransferLine.prototype.endStopName
         * @description ä¸è½¦ç«ç¹åç§°ã
         */
        this.endStopName = null;

        /**
         * @member {string} TransferLine.prototype.endStopAliasName
         * @description ä¸è½¦ç«ç¹å«åã
         */
        this.endStopAliasName = null;

        Util.extend(this, options);

        this.CLASS_NAME = "SuperMap.TransferLine";
    }


    /**
     * @function TransferLine.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        Util.reset(this);
    }

    /**
     * @function TransferLine.fromJson
     * @description å°è¿åç»æè½¬åä¸º {@link TransferLine} å¯¹è±¡ã
     * @param {Object} jsonObject - æ°çè¿åç»æã
     * @returns {TransferLine} è½¬ååç {@link TransferLine} å¯¹è±¡ã
     */
    static fromJson(jsonObject) {
        if (!jsonObject) {
            return;
        }
        return new TransferLine({
            lineID: jsonObject['lineID'],
            lineName: jsonObject['lineName'],
            lineAliasName: jsonObject['lineAliasName'],
            startStopIndex: jsonObject['startStopIndex'],
            startStopName: jsonObject['startStopName'],
            startStopAliasName: jsonObject['startStopAliasName'],
            endStopIndex: jsonObject['endStopIndex'],
            endStopName: jsonObject['endStopName'],
            endStopAliasName: jsonObject['endStopAliasName']
        });
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/TransferPathParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class TransferPathParameters
 * @deprecatedclass SuperMap.TransferPathParameters
 * @category  iServer TrafficTransferAnalyst TransferPath
 * @classdesc äº¤éæ¢ä¹çº¿è·¯æ¥è¯¢åæ°ç±»ã
 * @param {Object} options - åæ°ã
 * @param {Array.<TransferLine>} options.transferLines - æ¬æ¢ä¹åæ®µåå¯ä¹è½¦çè·¯çº¿éåã
 * @param {Array.<GeometryPoint|L.Point|L.LatLng|ol.geom.Point|mapboxgl.LngLat|Array.<number>|number>} options.points - ä¸¤ç§æ¥è¯¢æ¹å¼ï¼æç§å¬äº¤ç«ç¹çèµ·æ­¢ ID è¿è¡æ¥è¯¢åæç§èµ·æ­¢ç¹çåæ è¿è¡æ¥è¯¢ã
 * @usage
 */
class TransferPathParameters {

    constructor(options) {
        options = options || {};
        /**
         * @member {Array.<TransferLine>} TransferPathParameters.prototype.transferLines
         * @description æ¬æ¢ä¹åæ®µåå¯ä¹è½¦çè·¯çº¿éåï¼éè¿äº¤éæ¢ä¹æ¹æ¡æ¥è¯¢å¾å°ã
         */
        this.transferLines = null;


        /**
         *  @member {Array.<GeometryPoint|L.Point|L.LatLng|ol.geom.Point|mapboxgl.LngLat|Array.<number>|number>} TransferPathParameters.prototype.points
         *  @description ä¸¤ç§æ¥è¯¢æ¹å¼ï¼<br>
         *           1. æç§å¬äº¤ç«ç¹çèµ·æ­¢IDè¿è¡æ¥è¯¢ï¼å points åæ°çç±»åä¸º int[]ï¼å½¢å¦ï¼[èµ·ç¹IDãç»ç¹ID]ï¼å¬äº¤ç«ç¹ç ID å¯¹åºæå¡æä¾èéç½®ä¸­çç«ç¹ ID å­æ®µï¼
         *           2. æç§èµ·æ­¢ç¹çåæ è¿è¡æ¥è¯¢ï¼å points åæ°çç±»åä¸º Point2D[]ï¼å½¢å¦ï¼[{"x":44,"y":39},{"x":45,"y":40}]ã
         */
        this.points = null;

        Util.extend(this, options);

       this.CLASS_NAME = "SuperMap.TransferPathParameters";
    }

    /**
     * @function TransferPathParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        Util.reset(this);
    }

    /**
     * @function TransferPathParameters.toJson
     * @description å° {@link TransferPathParameters} å¯¹è±¡åæ°è½¬æ¢ä¸º JSON å­ç¬¦ä¸²ã
     * @param {TransferPathParameters} params - äº¤éæ¢ä¹åæ°ã
     * @returns {string} è½¬ååç JSON å­ç¬¦ä¸²ã
     */
    static toJson(params) {
        if (params) {
            return Util.toJSON(params);
        }
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/TransferPathService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class TransferPathService
 * @deprecatedclass SuperMap.TransferPathService
 * @category  iServer TrafficTransferAnalyst TransferPath
 * @classdesc äº¤éæ¢ä¹çº¿è·¯æ¥è¯¢æå¡ç±»ï¼æ ¹æ®äº¤éæ¢ä¹åæç»æ(TransferSolutionResult)ï¼è·åæä¸æ¡ä¹è½¦è·¯çº¿çè¯¦ç»ä¿¡æ¯ã
 *            è¿åç»æéè¿è¯¥ç±»æ¯æçäºä»¶ççå¬å½æ°åæ°è·å
 * @extends {CommonServiceBase}
 * @example ä¾å¦ï¼
 * var myService = new TransferPathService(url, {eventListeners: {
 *     "processCompleted": TrafficTransferCompleted,
 *     "processFailed": TrafficTransferError
 *     }
 * };
 * @param {string} url - æå¡å°åã
 * ä¾å¦:</br>"http://localhost:8090/iserver/services/traffictransferanalyst-sample/restjsr/traffictransferanalyst/Traffic-Changchun"ã
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - éè¦è¢«æ³¨åççå¬å¨å¯¹è±¡ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class TransferPathService extends CommonServiceBase {

    constructor(url, options) {
        super(url, options);
        this.CLASS_NAME = "SuperMap.TransferPathService";
    }

    /**
     * @override
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function TransferPathService.prototype.processAsync
     * @description è´è´£å°å®¢æ·ç«¯çæ´æ°åæ°ä¼ éå°æå¡ç«¯ã
     * @param {TransferPathParameters} params - äº¤éæ¢ä¹åæ°ã
     */
    processAsync(params) {
        if (!(params instanceof TransferPathParameters)) {
            return;
        }
        var me = this,
            method = "GET",
            jsonParameters;

        me.url = Util.urlPathAppend(me.url, 'path');
        jsonParameters = {
            points: Util.toJSON(params.points),
            transferLines: Util.toJSON(params['transferLines'])
        };

        me.request({
            method: method,
            params: jsonParameters,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }

}


;// CONCATENATED MODULE: ./src/common/iServer/TransferSolutionParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class TransferSolutionParameters
 * @deprecatedclass SuperMap.TransferSolutionParameters
 * @category  iServer TrafficTransferAnalyst TransferSolutions
 * @classdesc äº¤éæ¢ä¹æ¹æ¡æ¥è¯¢åæ°ç±»ã
 * @param {Object} options - åæ°ã
 * @param {Array.<GeometryPoint|L.Point|L.LatLng|ol.geom.Point|mapboxgl.LngLat|Array.<number>|number>} options.points - ä¸¤ç§æ¥è¯¢æ¹å¼ï¼æç§å¬äº¤ç«ç¹çèµ·æ­¢IDè¿è¡æ¥è¯¢åæç§èµ·æ­¢ç¹çåæ è¿è¡æ¥è¯¢ã
 * @param {number} [options.solutionCount=6] - ä¹è½¦æ¹æ¡çæ°éã
 * @param {TransferTactic} [options.transferTactic=TransferTactic.LESS_TIME] - äº¤éæ¢ä¹ç­ç¥ç±»åï¼åæ¬æ¶é´æç­ãè·ç¦»æç­ãæå°æ¢ä¹ãæå°æ­¥è¡åç§éæ©ã
 * @param {TransferPreference} [options.transferPreference=TransferPreference.NONE] - ä¹è½¦åå¥½æä¸¾ã
 * @param {number} [options.walkingRatio=10] - æ­¥è¡ä¸å¬äº¤çæ¶èæéæ¯ã
 * @param {Array.<number>} [options.evadeLines] - é¿è®©è·¯çº¿ç IDã
 * @param {Array.<number>} [options.evadeStops] - é¿è®©ç«ç¹ç IDã
 * @param {Array.<number>} [options.priorLines] - ä¼åè·¯çº¿ç IDã
 * @param {Array.<number>} [options.priorStops] - ä¼åç«ç¹ç IDã
 * @param {string} [options.travelTime] - åºè¡çæ¶é´ã
 * @usage
 */
class TransferSolutionParameters {

    constructor(options) {
        options = options || {};
        /**
         *  @member {number} [TransferSolutionParameters.prototype.solutionCount=6]
         *  @description ä¹è½¦æ¹æ¡çæ°éã
         */
        this.solutionCount = 6;
        /**
         * @member {TransferPreference} [TransferSolutionParameters.prototype.transferPreference=TransferPreference.NONE]
         *  @description ä¹è½¦åå¥½æä¸¾ã
         */
        this.transferPreference = TransferPreference.NONE;

        /**
         *  @member {TransferTactic} [TransferSolutionParameters.prototype.transferTactic=TransferTactic|TransferTactic.LESS_TIME]
         *  @description äº¤éæ¢ä¹ç­ç¥ç±»åï¼åæ¬æ¶é´æç­ãè·ç¦»æç­ãæå°æ¢ä¹ãæå°æ­¥è¡åç§éæ©ã
         */
        this.transferTactic = TransferTactic.LESS_TIME;

        /**
         *  @member {number} [TransferSolutionParameters.prototype.walkingRatio=10]
         *  @description æ­¥è¡ä¸å¬äº¤çæ¶èæéæ¯ãæ­¤å¼è¶å¤§ï¼åæ­¥è¡å ç´ å¯¹äºæ¹æ¡éæ©çå½±åè¶å¤§ãä¾å¦ï¼</br>
         *  ä¾å¦ç°å¨æä¸¤ç§æ¢ä¹æ¹æ¡ï¼å¨ä»èèæ¶èå ç´ çæåµä¸ï¼ï¼</br>
         *  æ¹æ¡1ï¼åè½¦ 10 å¬éï¼èµ°è·¯ 1 å¬éï¼</br>
         *  æ¹æ¡2ï¼åè½¦ 15 å¬éï¼èµ°è·¯ 0.5 å¬éï¼</br>
         *  1. åè®¾æéæ¯ä¸º 15ï¼</br>
         *     â¢æ¹æ¡ 1 çæ»æ¶èä¸ºï¼10 + 1*15 = 25</br>
         *     â¢æ¹æ¡ 2 çæ»æ¶èä¸ºï¼15 + 0.5*15 = 22.5</br>
         *  æ­¤æ¶æ¹æ¡ 2 æ¶èæ´ä½ã</br>
         *  2. åè®¾æéæ¯ä¸º2ï¼</br>
         *     â¢æ¹æ¡ 1 çæ»æ¶èä¸ºï¼10+1*2 = 12</br>
         *     â¢æ¹æ¡ 2 çæ»æ¶èä¸ºï¼15+0.5*2 = 17</br>
         *  æ­¤æ¶æ¹æ¡ 1 æ¶èæ´ä½ã</br>
         */

        this.walkingRatio = null;

        /**
         *  @member {Array.<GeometryPoint|L.Point|L.LatLng|ol.geom.Point|mapboxgl.LngLat|Array.<number>|number>} TransferSolutionParameters.prototype.points
         *  @description ä¸¤ç§æ¥è¯¢æ¹å¼ï¼</br>
         *           1. æç§å¬äº¤ç«ç¹çèµ·æ­¢ ID è¿è¡æ¥è¯¢ï¼å points åæ°çç±»åä¸º int[]ï¼å½¢å¦ï¼[èµ·ç¹ IDãç»ç¹ ID]ï¼å¬äº¤ç«ç¹ç ID å¯¹åºæå¡æä¾èéç½®ä¸­çç«ç¹ ID å­æ®µï¼
         *           2. æç§èµ·æ­¢ç¹çåæ è¿è¡æ¥è¯¢ï¼å points åæ°çç±»åä¸º Point2D[]ï¼å½¢å¦ï¼[{"x":44,"y":39},{"x":45,"y":40}]ã
         */
        this.points = false;

        /**
         * @member {Array.<number>} [TransferSolutionParameters.prototype.evadeLinesnull]
         * @description é¿è®©è·¯çº¿ IDã
         * */
        this.evadeLines = null;

        /**
         * @member {Array.<number>} [TransferSolutionParameters.prototype.evadeStops=TransferLine]
         * @description é¿è®©ç«ç¹ IDã
         * */
        this.evadeStops = null;

        /**
         * @member {Array.<number>} [TransferSolutionParameters.prototype.priorLines]
         * @description ä¼åè·¯çº¿ IDã
         * */
        this.priorLines = null;

        /**
         * @member {Array.<number>} [TransferSolutionParameters.prototype.priorStops]
         * @description ä¼åç«ç¹ IDã
         * */
        this.priorStops = null;

        /**
         * @member {string} TransferSolutionParameters.prototype.travelTime
         * @description åºè¡çæ¶é´ï¼ æ ¼å¼æ¯ï¼"å°æ¶:åé"ï¼å¦ï¼"08:30"ãå¦æè®¾ç½®äºè¯¥åæ°ï¼å¨åææ¶ï¼åä¼èèçº¿è·¯çé¦æ«ç­è½¦æ¶é´çéå¶ï¼å³å¨è¿åçç»æä¸­ä¼æç¤ºå¬äº¤çé¦æ«ç­åè½¦æ¶é´ã
         */
        this.travelTime = null;

        Util.extend(this, options);

        this.CLASS_NAME = "SuperMap.TransferSolutionParameters";
    }

    /**
     * @function TransferSolutionParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        Util.reset(this);
    }


    /**
     * @function TransferSolutionParameters.toJsonParameters
     * @description å° {@link TransferSolutionParameters} å¯¹è±¡åæ°è½¬æ¢ä¸º JSON å­ç¬¦ä¸²ã
     * @param {TransferSolutionParameters} params - äº¤éæ¢ä¹åæ°ã
     * @returns {string} è½¬ååç JSON å­ç¬¦ä¸²ã
     */
    static toJson(params) {
        if (params) {
            return Util.toJSON(params);
        }
    }

}


;// CONCATENATED MODULE: ./src/common/iServer/TransferSolutionService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class TransferSolutionService
 * @deprecatedclass SuperMap.TransferSolutionService
 * @category  iServer TrafficTransferAnalyst TransferSolutions
 * @classdesc äº¤éæ¢ä¹æ¹æ¡æ¥è¯¢æå¡ç±»ã
 * è¿åç»æéè¿è¯¥ç±»æ¯æçäºä»¶ççå¬å½æ°åæ°è·åã
 * @param {string} url - æå¡å°åã
 * ä¾å¦:</br>"http://localhost:8090/iserver/services/traffictransferanalyst-sample/restjsr/traffictransferanalyst/Traffic-Changchun"ã
 * @param {Object} options - åæ°ã</br>
 * @param {Object} options.eventListeners - éè¦è¢«æ³¨åççå¬å¨å¯¹è±¡ã</br>
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @extends {CommonServiceBase}
 * @example ä¾å¦ï¼
 * (start code)
 * var myService = new TransferSolutionService(url, {eventListeners: {
     *     "processCompleted": trafficTransferCompleted,
     *     "processFailed": trafficTransferError
     *     }
     * };
 * (end)
 * @usage
 */
class TransferSolutionService extends CommonServiceBase {

    constructor(url, options) {
        super(url, options);
        this.CLASS_NAME = "SuperMap.TransferSolutionService";
    }

    /**
     * @override
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function TransferSolutionService.prototype.processAsync
     * @description è´è´£å°å®¢æ·ç«¯çæ´æ°åæ°ä¼ éå°æå¡ç«¯ã
     * @param {TransferSolutionParameters} params - äº¤éæ¢ä¹åæ°ã
     */
    processAsync(params) {
        if (!(params instanceof TransferSolutionParameters)) {
            return;
        }
        var me = this,
            method = "GET",
            jsonParameters;

        me.url = Util.urlPathAppend(me.url, 'solutions');
        jsonParameters = {
            points: Util.toJSON(params.points),
            walkingRatio: params['walkingRatio'],
            transferTactic: params['transferTactic'],
            solutionCount: params['solutionCount'],
            transferPreference: params["transferPreference"]
        };
        if (params.evadeLines) {
            jsonParameters["evadeLines"] = Util.toJSON(params.evadeLines);
        }
        if (params.evadeStops) {
            jsonParameters["evadeStops"] = Util.toJSON(params.evadeStops);
        }
        if (params.priorLines) {
            jsonParameters["priorLines"] = Util.toJSON(params.priorLines);
        }
        if (params.priorStops) {
            jsonParameters["priorStops"] = Util.toJSON(params.priorStops);
        }
        if (params.travelTime) {
            jsonParameters["travelTime"] = params.travelTime;
        }

        me.request({
            method: method,
            params: jsonParameters,
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }

}



;// CONCATENATED MODULE: ./src/common/iServer/UpdateEdgeWeightParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class UpdateEdgeWeightParameters
 * @deprecatedclass SuperMap.UpdateEdgeWeightParameters
 * @category  iServer NetworkAnalyst EdgeWeight
 * @classdesc è¾¹çèè´¹æéæ´æ°æå¡åæ°ç±»ã
 * @param {Object} options - åæ°ã
 * @param {string} options.edgeId - æå¨è¾¹ç IDã
 * @param {string} options.fromNodeId - èµ·å§è½¬åç¹ç IDã
 * @param {string} options.toNodeId - ç»æ­¢è½¬åç¹ç IDã
 * @param {string} options.weightField - è¾¹çèè´¹å­æ®µã
 * @param {string} options.edgeWeight - èè´¹æéã
 * @usage
 */
class UpdateEdgeWeightParameters {

    constructor(options) {
        if (!options) {
            return;
        }
        /**
         * @member {string} UpdateEdgeWeightParameters.prototype.edgeId
         * @description æå¨è¾¹ç IDã
         */
        this.edgeId = "";

        /**
         * @member {string} UpdateEdgeWeightParameters.prototype.fromNodeId
         * @description èµ·å§è½¬åç¹ç IDã
         */
        this.fromNodeId = "";

        /**
         * @member {string} UpdateEdgeWeightParameters.prototype.toNodeId
         * @description ç»æ­¢è½¬åç¹ç IDã
         */
        this.toNodeId = "";

        /**
         * @member {string} UpdateEdgeWeightParameters.prototype.weightField
         * @description è¾¹çèè´¹å­æ®µã
         */
        this.weightField = "";

        /**
         * @member {string} UpdateEdgeWeightParameters.prototype.edgeWeight
         * @description èè´¹æéã
         */
        this.edgeWeight = "";

        Util.extend(this, options);

        this.CLASS_NAME = "SuperMap.UpdateEdgeWeightParameters";
    }


    /**
     * @function UpdateEdgeWeightParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        this.edgeId = null;
        this.fromNodeId = null;
        this.toNodeId = null;
        this.weightField = null;
        this.edgeWeight = null;
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/CreateDatasetParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class CreateDatasetParameters
 * @deprecatedclass SuperMap.CreateDatasetParameters
 * @category iServer Data Dataset
 * @classdesc æ°æ®éåå»ºåæ°ç±»ã
 * @param {Object} options - åæ°ã
 * @param {string} options.datasourceName - æ°æ®æºåç§°ï¼æ­¤ä¸ºå¿éåæ°ã
 * @param {string} options.datasetName - æ°æ®éåç§°ï¼æ­¤ä¸ºå¿éåæ°ã
 * @param {string} options.datasetType - æ°æ®éç±»åãç®åæ¯æåå»ºçåºèéç±»åæï¼ç¹ãçº¿ãé¢ãææ¬ãå¤åï¼CADï¼åå±æ§æ°æ®éã
 * @usage
 */
class CreateDatasetParameters {

    constructor(options) {
        if (!options) {
            return;
        }

        /**
         * @member {string} CreateDatasetParameters.prototype.datasourceName
         * @description æ°æ®æºåç§°ï¼æ­¤ä¸ºå¿éåæ°ã
         */
         this.datasourceName = null;

        /**
         * @member {string} CreateDatasetParameters.prototype.datasetName
         * @description æ°æ®éåç§°ï¼æ­¤ä¸ºå¿éåæ°ã
         */
         this.datasetName = null;

        /**
         * @member {string} CreateDatasetParameters.prototype.datasetType
         * @description æ°æ®éç±»åãç®åæ¯æåå»ºçåºèéç±»åæï¼ç¹ãçº¿ãé¢ãææ¬ãå¤åï¼CADï¼åå±æ§æ°æ®éã
         */
        this.datasetType = null;

        if (options) {
            Util.extend(this, options);
        }
        this.CLASS_NAME = "SuperMap.CreateDatasetParameters";
    }
    /**
     * @function CreateDatasetParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.datasourceName = null;
        me.datasetName = null;
        me.datasetType = null;
    }
}


;// CONCATENATED MODULE: ./src/common/iServer/UpdateEdgeWeightService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class UpdateEdgeWeightService
 * @deprecatedclass SuperMap.UpdateEdgeWeightService
 * @category  iServer NetworkAnalyst EdgeWeight
 * @classdesc æ´æ°è¾¹çè¾¹çèè´¹æéæå¡
 * @extends {NetworkAnalystServiceBase}
 * @example
 *(start code)
 * var updateEdgeWeightService = new UpdateEdgeWeightService(url, {
 *     eventListeners: {
 *         "processCompleted": UpdateEdgeWeightCompleted,
 *		   "processFailed": UpdateEdgeWeightError
 *		   }
 * });
 * (end)
 * @param {string} url - æå¡å°åãå¦ï¼http://localhost:8090/iserver/services/transportationanalyst-sample/rest/networkanalyst/RoadNet@Changchun ã
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - éè¦è¢«æ³¨åççå¬å¨å¯¹è±¡ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class UpdateEdgeWeightService extends NetworkAnalystServiceBase {

    constructor(url, options) {
        super(url, options);
        this.CLASS_NAME = "SuperMap.UpdateEdgeWeightService";
    }

    /**
     * @override
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function UpdateEdgeWeightService.prototype.processAsync
     * @description å¼å§å¼æ­¥æ§è¡è¾¹çè¾¹çèè´¹æéçæ´æ°
     * @param {UpdateEdgeWeightParameters} params - è¾¹çèè´¹æéæ´æ°æå¡åæ°ç±»
     * @example
     * (code)
     *  var updateEdgeWeightParam=new SuperMapUpdateEdgeWeightParameters({
     *          edgeId:"20",
     *          fromNodeId:"26",
     *          toNodeId:"109",
     *          weightField:"time",
     *          edgeWeight:"25"
     *      });
     *  updateEdgeWeightService.processAsync(updateEdgeWeightParam);
     * (end)
     */
    processAsync(params) {
        if (!(params instanceof UpdateEdgeWeightParameters)) {
            return;
        }

        var me = this;
        var paramStr = me.parse(params);
        me.url = Util.urlPathAppend(me.url, paramStr);
        var data = params.edgeWeight ? params.edgeWeight : null;
        me.request({
            method: "PUT",
            scope: me,
            data: data,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }

    /**
    * @function UpdateEdgeWeightService.prototype.parse
    * @description å°æ´æ°æå¡åæ°è§£æä¸ºç¨â/âååéçå­ç¬¦ä¸²
    */
    parse(params) {
        if (!params) {
            return;
        }
        var paramStr = "";
        for (var attr in params) {
            if (params[attr] === "" || params[attr] === "edgeWeight") {
                continue;
            }
            switch (attr) {
                case "edgeId":
                    paramStr += "/edgeweight/" + params[attr];
                    break;
                case "fromNodeId":
                    paramStr += "/fromnode/" + params[attr];
                    break;
                case "toNodeId":
                    paramStr += "/tonode/" + params[attr];
                    break;
                case "weightField":
                    paramStr += "/weightfield/" + params[attr];
                    break;
                default :
                    break;
            }
        }
        return paramStr;
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/UpdateTurnNodeWeightParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class UpdateTurnNodeWeightParameters
 * @deprecatedclass SuperMap.UpdateTurnNodeWeightParameters
 * @category  iServer NetworkAnalyst TurnNodeWeight
 * @classdesc è½¬åèè´¹æéæ´æ°æå¡åæ°ç±»ã
 * @param {Object} options - åæ°ã
 * @param {string} options.nodeId - è½¬åç»ç¹ç  IDã
 * @param {string} options.fromEdgeId - èµ·å§è¾¹ç  IDã
 * @param {string} options.toEdgeId - ç»æ­¢è¾¹ç  IDã
 * @param {string} options.weightField - è½¬åç»ç¹çèè´¹å­æ®µã
 * @param {string} options.turnNodeWeight - èè´¹æéã
 * @usage
 */
class UpdateTurnNodeWeightParameters {

    constructor(options) {
        if (!options) {
            return;
        }
        /**
         * @member {string} UpdateTurnNodeWeightParameters.prototype.nodeId
         * @description è½¬åç»ç¹ç  IDã
         */
        this.nodeId = "";

        /**
         * @member {string} UpdateTurnNodeWeightParameters.prototype.fromEdgeId
         * @description èµ·å§è¾¹ç  IDã
         */
        this.fromEdgeId = "";

        /**
         * @member {string} UpdateTurnNodeWeightParameters.prototype.toEdgeId
         * @description ç»æ­¢è¾¹ç  IDã
         */
        this.toEdgeId = "";

        /**
         * @member {string} UpdateTurnNodeWeightParameters.prototype.weightField
         * @description è½¬åç»ç¹çèè´¹å­æ®µã
         */
        this.weightField = "";

        /**
         * @member {string} UpdateTurnNodeWeightParameters.prototype.turnNodeWeight
         * @description èè´¹æéã
         */
        this.turnNodeWeight = "";
        Util.extend(this, options);
        this.CLASS_NAME = "SuperMap.UpdateTurnNodeWeightParameters";
    }

    /**
     * @function UpdateTurnNodeWeightParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        this.nodeId = null;
        this.fromEdgeId = null;
        this.toEdgeId = null;
        this.weightField = null;
        this.turnNodeWeight = null;
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/UpdateTurnNodeWeightService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class UpdateTurnNodeWeightService
 * @deprecatedclass SuperMap.UpdateTurnNodeWeightService
 * @category  iServer NetworkAnalyst TurnNodeWeight
 * @classdesc è½¬åèè´¹æéæ´æ°æå¡ç±»
 * @extends {NetworkAnalystServiceBase}
 * @example
 * var UpdateTurnNodeWeightService = new UpdateTurnNodeWeightService(url, {
 *     eventListeners: {
 *         "processCompleted": UpdateTurnNodeWeightCompleted,
 *		   "processFailed": UpdateTurnNodeWeightError
 *		   }
 * });
 * @param {string} url - æå¡å°åãå¦:
 *                       http://localhost:8090/iserver/services/transportationanalyst-sample/rest/networkanalyst/RoadNet@Changchun ã
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - éè¦è¢«æ³¨åççå¬å¨å¯¹è±¡ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class UpdateTurnNodeWeightService extends NetworkAnalystServiceBase {

    constructor(url, options) {
        super(url, options);
        this.CLASS_NAME = "SuperMap.UpdateTurnNodeWeightService";
    }

    /**
     * @override
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function UpdateTurnNodeWeightService.prototype.processAsync
     * @description å¼å§å¼æ­¥æ§è¡è½¬åèè´¹æéçæ´æ°
     * @param {UpdateTurnNodeWeightParameters} params - è½¬åèè´¹æéæ´æ°æå¡åæ°ç±»
     * @example
     * (code)
     *  var updateTurnNodeWeightParam=new UpdateTurnNodeWeightParameters({
     *           nodeId:"106",
     *           fromEdgeId:"6508",
     *           toEdgeId:"6504",
     *           weightField:"TurnCost",
     *           turnNodeWeight:"50"
     *       });
     *  updateTurnNodeWeightService.processAsync(updateTurnNodeWeightParam);
     * (end)
     **/
    processAsync(params) {
        if (!(params instanceof UpdateTurnNodeWeightParameters)) {
            return;
        }
        var me = this;
        var paramStr = me.parse(params);
        me.url = Util.urlPathAppend(me.url, paramStr);
        var data = params.turnNodeWeight ? params.turnNodeWeight : null;
        me.request({
            method: "PUT",
            scope: me,
            data: data,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }

    /**
     * @function UpdateTurnNodeWeightService.prototype.parse
     * @description å°æ´æ°æå¡åæ°è§£æä¸ºç¨â/âååéçå­ç¬¦ä¸²
     */
    parse(params) {
        if (!params) {
            return;
        }
        var paramStr = "";
        for (var attr in params) {
            if (params[attr] === "" || params[attr] === "turnNodeWeight") {
                continue;
            }
            switch (attr) {
                case "nodeId":
                    paramStr += "/turnnodeweight/" + params[attr];
                    break;
                case "fromEdgeId":
                    paramStr += "/fromedge/" + params[attr];
                    break;
                case "toEdgeId":
                    paramStr += "/toedge/" + params[attr];
                    break;
                case "weightField":
                    paramStr += "/weightfield/" + params[attr];
                    break;
                default :
                    break;
            }
        }
        return paramStr;
    }

}

;// CONCATENATED MODULE: ./src/common/iServer/UpdateDatasetParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class UpdateDatasetParameters
 * @deprecatedclass SuperMap.UpdateDatasetParameters
 * @category iServer Data Dataset
 * @classdesc æ°æ®éä¿¡æ¯æ´æ¹åæ°ç±»ã
 * @param {Object} options - åæ°ã
 * @param {string} options.datasourceName - æ°æ®æºåç§°ã
 * @param {string} options.datasetName - æ°æ®éåç§°ã
 * @param {boolean} options.isFileCache - æ¯å¦ä½¿ç¨æä»¶å½¢å¼çç¼å­ãä»å¯¹æ°æ®åºåæ°æ®æºä¸­çç¢éæ°æ®éææã
 * @param {string} options.description - æ°æ®éæè¿°ä¿¡æ¯ã
 * @param {string} options.prjCoordSys - æå½±åæ ç³»ã
 * @param {Object} options.charset - ç¢éæ°æ®éçå­ç¬¦éãå½æ°æ®éç±»åä¸ºç¢éæ°æ®éæ¶ï¼å¯ä»¥ä¼ éæ­¤åæ°ãå¦æç¨æ·ä¼ éç©ºå¼ï¼åç¼ç æ¹å¼ä¿æä¸åã
 * @param {Array.<string>} options.palette - å½±åæ°æ®çé¢è²è°è²æ¿ãå½æ°æ®éç±»åä¸ºå½±åæ°æ®éæ¶ï¼å¯ä»¥ä¼ éæ­¤åæ°ã
 * @param {number} options.noValue - æ æ ¼æ°æ®éä¸­æ²¡ææ°æ®çååçæ æ ¼å¼ãå½æ°æ®éç±»åä¸ºæ æ ¼æ°æ®éæ¶ï¼å¯ä»¥ä¼ éæ­¤åæ°ã
 * @usage
 */
class UpdateDatasetParameters {

    constructor(options) {
        if (!options) {
            return;
        }

        /**
         * @member {string} UpdateDatasetParameters.prototype.datasourceName
         * @description æ°æ®æºåç§°ã
         */
        this.datasourceName = null;

        /**
         * @member {string} UpdateDatasetParameters.prototype.datasetName
         * @description æ°æ®éåç§°ã
         */
        this.datasetName = null;

        /**
         * @member {boolean} UpdateDatasetParameters.prototype.isFileCache
         * @description æ¯å¦ä½¿ç¨æä»¶å½¢å¼çç¼å­ãä»å¯¹æ°æ®åºåæ°æ®æºä¸­çç¢éæ°æ®éææã
         */
        this.isFileCache = null;

        /**
         * @member {string} UpdateDatasetParameters.prototype.description
         * @description æ°æ®éæè¿°ä¿¡æ¯ã
         */
        this.description = null;

        /**
         * @member {string} UpdateDatasetParameters.prototype.prjCoordSys
         * @description æå½±åæ ç³»ã
         */
        this.prjCoordSys = null;

        /**
         * @member {Object} UpdateDatasetParameters.prototype.charset
         * @description ç¢éæ°æ®éçå­ç¬¦éã
         */
        this.charset = null;

        /**
         * @member {Array.<string>} UpdateDatasetParameters.prototype.palette
         * @description å½±åæ°æ®çé¢è²è°è²æ¿ã
         */
        this.palette = null;

        /**
         * @member {number} UpdateDatasetParameters.prototype.noValue
         * @description æ æ ¼æ°æ®éä¸­æ²¡ææ°æ®çååçæ æ ¼å¼ã
         */
        this.noValue = null;

        if (options) {
            Util.extend(this, options);
        }
        this.CLASS_NAME = "SuperMap.UpdateDatasetParameters";
    }

    /**
     * @function UpdateDatasetParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.datasourceName = null;
        me.datasetName = null;
        me.isFileCache = null;
        me.prjCoordSys = null;
        me.charset = null;
        me.palette = null;
        me.noValue = null;
    }

}


;// CONCATENATED MODULE: ./src/common/iServer/VectorClipJobsParameter.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class VectorClipJobsParameter
 * @deprecatedclass SuperMap.VectorClipJobsParameter
 * @category  iServer ProcessingService VectorClip
 * @classdesc ç¢éè£åªåæä»»å¡åæ°ç±»ã
 * @param {Object} options - åæ°ã
 * @param {string} options.datasetName - æ°æ®éåã
 * @param {string} options.datasetOverlay - è£åªå¯¹è±¡æ°æ®éã
 * @param {ClipAnalystMode} [options.mode=ClipAnalystMode.CLIP] - è£åªåææ¨¡å¼ã
 * @param {OutputSetting} [options.output] - è¾åºåæ°è®¾ç½®ã
 * @param {MappingParameters} [options.mappingParameters] - åæåç»æå¯è§åçåæ°ç±»ã
 * @usage
 */
class VectorClipJobsParameter {

    constructor(options) {
        options = options || {};

        /**
         * @member {string} VectorClipJobsParameter.prototype.datasetName
         * @description æ°æ®éåã
         */
        this.datasetName = "";

        /**
         * @member {string} VectorClipJobsParameter.prototype.datasetOverlay
         * @description è£åªå¯¹è±¡æ°æ®éã
         */
        this.datasetVectorClip = "";

        /**
         * @member {string} VectorClipJobsParameter.prototype.geometryClip
         * @description è£åªå ä½å¯¹è±¡ã
         */
        this.geometryClip = "";

        /**
         * @member {ClipAnalystMode} [VectorClipJobsParameter.prototype.mode=ClipAnalystMode.CLIP]
         * @description è£åªåææ¨¡å¼ ã
         */
        this.mode = ClipAnalystMode.CLIP;

        /**
         * @member {OutputSetting} VectorClipJobsParameter.prototype.output
         * @description è¾åºåæ°è®¾ç½®ç±»ã
         */
        this.output = null;

        /**
         * @member {MappingParameters} [VectorClipJobsParameter.prototype.mappingParameters]
         * @description åæåç»æå¯è§åçåæ°ç±»ã
         */
        this.mappingParameters = null;

        Util.extend(this, options);

        this.CLASS_NAME = "SuperMap.VectorClipJobsParameter";
    }

    /**
     * @function VectorClipJobsParameter.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        this.datasetName = null;
        this.datasetVectorClip = null;
        this.geometryClip = null;
        this.mode = null;
        if (this.output instanceof OutputSetting) {
            this.output.destroy();
            this.output = null;
        }
        if (this.mappingParameters instanceof MappingParameters) {
            this.mappingParameters.destroy();
            this.mappingParameters = null;
        }
    }

    /**
     * @function VectorClipJobsParameter.toObject
     * @param {Object} vectorClipJobsParameter - åºåæ±æ»åææå¡åæ°ã
     * @param {Object} tempObj - ç®æ å¯¹è±¡ã
     * @description ç¢éè£åªåæä»»å¡å¯¹è±¡ã
     */
    static toObject(vectorClipJobsParameter, tempObj) {
        for (var name in vectorClipJobsParameter) {
            if (name === "datasetName") {
                tempObj['input'] = tempObj['input'] || {};
                tempObj['input'][name] = vectorClipJobsParameter[name];
                continue;
            }
            if (name === "output"){
                tempObj['output'] = tempObj['output'] || {};
                tempObj['output'] = vectorClipJobsParameter[name];
                continue;
            }
            tempObj['analyst'] = tempObj['analyst'] || {};
            tempObj['analyst'][name] = vectorClipJobsParameter[name];
            if(name === 'mappingParameters'){
                tempObj['analyst'][name] = tempObj['analyst'][name] || {};
                tempObj['analyst']['mappingParameters'] = vectorClipJobsParameter[name];
            }
        }
    }

}


;// CONCATENATED MODULE: ./src/common/iServer/VectorClipJobsService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class VectorClipJobsService
 * @deprecatedclass SuperMap.VectorClipJobsService
 * @category  iServer ProcessingService VectorClip
 * @classdesc ç¢éè£åªåææå¡ç±»
 * @extends {ProcessingServiceBase}
 * @param {string} url -æå¡å°åã
 * @param {Object} options - å¯éåæ°ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class VectorClipJobsService extends ProcessingServiceBase {
    constructor(url, options) {
        super(url, options);
        this.url = Util.urlPathAppend(this.url, 'spatialanalyst/vectorclip');
        this.CLASS_NAME = 'SuperMap.VectorClipJobsService';
    }

    /**
     *@override
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function VectorClipJobsService.protitype.getVectorClipJobs
     * @description è·åç¢éè£åªåæææä»»å¡
     */
    getVectorClipJobs() {
        super.getJobs(this.url);
    }

    /**
     * @function KernelDensityJobsService.protitype.getVectorClipJob
     * @description è·åæå®idçç¢éè£åªåææå¡
     * @param {string} id - æå®è¦è·åæ°æ®çid
     */
    getVectorClipJob(id) {
        super.getJobs(Util.urlPathAppend(this.url, id));
    }

    /**
     * @function VectorClipJobsService.protitype.addVectorClipJob
     * @description æ°å»ºç¢éè£åªåææå¡
     * @param {VectorClipJobsParameter} params - åå»ºä¸ä¸ªç©ºé´åæçè¯·æ±åæ°ã
     * @param {number} seconds - å¼å§åå»ºåï¼è·ååå»ºæåç»æçæ¶é´é´éã
     */
    addVectorClipJob(params, seconds) {
        super.addJob(this.url, params, VectorClipJobsParameter, seconds);
    }
}


;// CONCATENATED MODULE: ./src/common/iServer/RasterFunctionParameter.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class RasterFunctionParameter
 * @deprecatedclass SuperMap.RasterFunctionParameter
 * @category iServer Map Tile
 * @classdesc iServer å°å¾æå¡æ æ ¼åæåæ°åºç±»
 * @param {Object} options - åæ°ã
 * @param {RasterFunctionType} options.type - æ æ ¼åææ¹æ³ã
 * @usage
 */
class RasterFunctionParameter {
    constructor(options) {
        options = options || {};

        /**
         * @member {RasterFunctionType} [RasterFunctionParameter.prototype.type]
         * @description æ æ ¼åææ¹æ³ã
         */
        this.type = null;

        Util.extend(this, options);
        this.CLASS_NAME = 'SuperMap.RasterFunctionParameter';
    }

    /**
     * @function RasterFunctionParameter.prototype.destroy
     * @description éæ¾èµæºï¼å°èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        this.type = null;
    }
}


;// CONCATENATED MODULE: ./src/common/iServer/NDVIParameter.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class NDVIParameter
 * @deprecatedclass SuperMap.NDVIParameter
 * @category iServer Map Tile
 * @classdesc å½ä¸åæ¤è¢«ææ°åæ°ç±»
 * @param {Object} options - åæ°ã
 * @param {number} [options.redIndex=0] - çº¢åè°±æ³¢æ®µç´¢å¼ã
 * @param {number} [options.nirIndex=1] - è¿çº¢å¤åè°±æ³¢æ®µç´¢å¼ã
 * @param {string} [options.colorMap="0:ffffe5ff;0.1:f7fcb9ff;0.2:d9f0a3ff;0.3:addd8eff;0.4:78c679ff;0.5:41ab5dff;0.6:238443ff;0.7:006837ff;1:004529ff"] - é¢è²è¡¨ãç±æ æ ¼çä¸­æ­å¼åé¢è²åæ­¢ä¹é´çæ å°ç»æçï¼å¦0.3->d9f0a3ff æçæ¯[0,0.3)æ¾ç¤ºd9f0a3ffãä»åæ³¢æ®µæ°æ®æ¶è®¾å®ã
 * @extends {RasterFunctionParameter}
 * @usage
 */
class NDVIParameter extends RasterFunctionParameter {
    constructor(options) {
        super(options);
        /**
         * @member {number} [NDVIParameter.prototype.redIndex=0]
         * @description çº¢åè°±æ³¢æ®µç´¢å¼ã
         */
        this.redIndex = 0;

        /**
         * @member {number} [NDVIParameter.prototype.nirIndex=1]
         * @description è¿çº¢å¤åè°±æ³¢æ®µç´¢å¼ã
         */
        this.nirIndex = 1;

        /**
         * @member {string} [NDVIParameter.prototype.colorMap="0:ffffe5ff;0.1:f7fcb9ff;0.2:d9f0a3ff;0.3:addd8eff;0.4:78c679ff;0.5:41ab5dff;0.6:238443ff;0.7:006837ff;1:004529ff"]
         * @description é¢è²è¡¨ãç±æ æ ¼çä¸­æ­å¼åé¢è²åæ­¢ä¹é´çæ å°ç»æçï¼å¦0.3->d9f0a3ff æçæ¯[0,0.3)æ¾ç¤ºd9f0a3ffãä»åæ³¢æ®µæ°æ®æ¶è®¾å®ã
         */
        this.colorMap =
            '0:ffffe5ff;0.1:f7fcb9ff;0.2:d9f0a3ff;0.3:addd8eff;0.4:78c679ff;0.5:41ab5dff;0.6:238443ff;0.7:006837ff;1:004529ff';

        /**
         * @member {RasterFunctionType} [NDVIParameter.prototype.type]
         * @description æ æ ¼åææ¹æ³ã
         */
        this.type = RasterFunctionType.NDVI;
        Util.extend(this, options);

        this.CLASS_NAME = 'SuperMap.NDVIParameter';
    }

    /**
     * @function NDVIParameter.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
        this.redIndex = null;
        this.nirIndex = null;
        this.colorMap = null;
    }
    /**
     * @function NDVIParameter.prototype.toJSON
     * @description å° NDVIParameter å¯¹è±¡è½¬åä¸º JSON å­ç¬¦ä¸²ã
     * @returns {string} è¿åè½¬æ¢åç JSON å­ç¬¦ä¸²ã
     */
    toJSON() {
        return {
            redIndex: this.redIndex,
            nirIndex: this.nirIndex,
            colorMap: this.colorMap,
            type: this.type
        };
    }
}


;// CONCATENATED MODULE: ./src/common/iServer/HillshadeParameter.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class HillshadeParameter
 * @deprecatedclass SuperMap.HillshadeParameter
 * @category iServer Map Tile
 * @classdesc é´å½±é¢åæåæ°ç±»
 * @param {Object} options - å¯éåæ°ã
 * @param {number} [options.altitude=45] - é«äºå°å¹³çº¿çåæºé«åº¦è§ãé«åº¦è§ç±æ­£åº¦æ°è¡¨ç¤ºï¼0 åº¦ä»£è¡¨å°å¹³çº¿ï¼è 90 åº¦ä»£è¡¨å¤´é¡¶æ­£ä¸æ¹ã
 * @param {number} [options.azimuth=315] - åæºçæ¹ä½è§ãæ¹ä½è§ç±0å°360åº¦ä¹é´çæ­£åº¦æ°è¡¨ç¤ºï¼ä»¥åä¸ºåºåæ¹åæé¡ºæ¶éè¿è¡æµéã
 * @param {number} [options.zFactor=1] - ä¸ä¸ªè¡¨é¢ z åä½ä¸­å°é¢ x,y åä½çæ°éãz åä½ä¸è¾å¥è¡¨é¢ç x,y åä½ä¸åæ¶ï¼å¯ä½¿ç¨ z å å­è°æ´ z åä½çæµéåä½ãè®¡ç®æç»è¾åºè¡¨é¢æ¶ï¼å°ç¨ z å å­ä¹ä»¥è¾å¥è¡¨é¢ç z å¼ã
 *                                       z åä½ä¸è¾å¥è¡¨é¢ç x,y åä½ä¸åæ¶ï¼å¯ä½¿ç¨ z å å­è°æ´ z åä½çæµéåä½ãè®¡ç®æç»è¾åºè¡¨é¢æ¶ï¼å°ç¨ z å å­ä¹ä»¥è¾å¥è¡¨é¢ç z å¼ã
 *                                      å¦æ x,y åä½å z åä½éç¨ç¸åçæµéåä½ï¼å z å å­ä¸º 1ãè¿æ¯é»è®¤è®¾ç½®ã
 *                                      å¦æ x,y åä½å z åä½éç¨ä¸åçæµéåä½ï¼åå¿é¡»å° z å å­è®¾ç½®ä¸ºéå½çå å­ï¼å¦åä¼å¾å°éè¯¯çç»æãä¾å¦ï¼å¦æ z åä½æ¯è±å°ºè x,y åä½æ¯ç±³ï¼ååºä½¿ç¨ z å å­ 0.3048 å° z åä½ä»è±å°ºè½¬æ¢ä¸ºç±³ï¼1 è±å°º = 0.3048 ç±³ï¼ã
 *                                      å¦æè¾å¥æ æ ¼ä½äºçé¢åæ ç³»ä¸­ï¼å¦åè¿å¶åº¦çé¢åæ ç³»ï¼ï¼åçæçå±±ä½é´å½±å¯è½çèµ·æ¥å¾ç¬ç¹ãè¿æ¯å ä¸ºæ°´å¹³å°é¢åä½ä¸é«ç¨ z åä½ä¹é´çæµéå¼å­å¨å·®å¼ãç±äºç»åº¦çé¿åº¦éççº¬åº¦èååï¼å æ­¤éè¦ä¸ºè¯¥çº¬åº¦æå®ä¸ä¸ªéå½ç z å å­ãå¦æ x,y åä½æ¯åè¿å¶åº¦è Z åä½æ¯ç±³ï¼ç¹å®çº¬åº¦çä¸äºåéç Z å å­ä¸ºï¼
 *                                      Latitude     Z-factor
 *                                      0           0.00000898
 *                                      10           0.00000912
 *                                      20           0.00000956
 *                                      30           0.00001036
 *                                      40           0.00001171
 *                                      50           0.00001395
 *                                      60           0.00001792
 *                                      70           0.00002619
 *                                      80           0.00005156
 * @extends {RasterFunctionParameter}
 * @usage
 */
class HillshadeParameter extends RasterFunctionParameter {
    constructor(options) {
        super(options);
        /**
         * @member {number} [HillshadeParameter.prototype.altitude = 45]
         * @description é«äºå°å¹³çº¿çåæºé«åº¦è§ãé«åº¦è§ç±æ­£åº¦æ°è¡¨ç¤ºï¼0 åº¦ä»£è¡¨å°å¹³çº¿ï¼è 90 åº¦ä»£è¡¨å¤´é¡¶æ­£ä¸æ¹ã
         */
        this.altitude = 45;

        /**
         * @member {number} [HillshadeParameter.prototype.azimuth = 315]
         * @description åæºçæ¹ä½è§ãæ¹ä½è§ç±0å°360åº¦ä¹é´çæ­£åº¦æ°è¡¨ç¤ºï¼ä»¥åä¸ºåºåæ¹åæé¡ºæ¶éè¿è¡æµéã
         */
        this.azimuth = 315;

        /**
         * @member {number} [HillshadeParameter.prototype.zFactor = 1]
         * @description ä¸ä¸ªè¡¨é¢ z åä½ä¸­å°é¢ x,y åä½çæ°éãz åä½ä¸è¾å¥è¡¨é¢ç x,y åä½ä¸åæ¶ï¼å¯ä½¿ç¨ z å å­è°æ´ z åä½çæµéåä½ãè®¡ç®æç»è¾åºè¡¨é¢æ¶ï¼å°ç¨ z å å­ä¹ä»¥è¾å¥è¡¨é¢ç z å¼ã
         */
        this.zFactor = 1;

        /**
         * @member {RasterFunctionType} HillshadeParameter.prototype.type
         * @description æ æ ¼åææ¹æ³ã
         */
        this.type = RasterFunctionType.HILLSHADE;
        Util.extend(this, options);

        this.CLASS_NAME = 'SuperMap.HillshadeParameter';
    }

    /**
     * @function HillshadeParameter.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
        this.altitude = null;
        this.azimuth = null;
        this.zFactor = null;
    }
    /**
     * @function HillshadeParameter.prototype.toJSON
     * @description å° HillshadeParameter å¯¹è±¡è½¬åä¸º JSON å­ç¬¦ä¸²ã
     * @returns {string} è¿åè½¬æ¢åç JSON å­ç¬¦ä¸²ã
     */
    toJSON() {
        return {
            altitude: this.altitude,
            azimuth: this.azimuth,
            zFactor: this.zFactor,
            type: this.type
        };
    }
}


;// CONCATENATED MODULE: ./src/common/iServer/WebPrintingJobCustomItems.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class WebPrintingJobCustomItems
 * @deprecatedclass SuperMap.WebPrintingJobCustomItems
 * @classdesc Web æå°å¾ä¾åç´ åæ°ç±»ã
 * @version 10.1.0
 * @category iServer WebPrintingJob
 * @param {Object} option - åæ°ã
 * @param {string} option.name - å¾ä¾åç´ çåç§°ã
 * @param {string} option.picAsUrl - å¾ä¾åç´  Base64 æ ¼å¼å¾çã
 * @param {string} [option.picAsBase64] - å¾ä¾åç´ å¾ççè·åå°åãå¦æå·²å¡«äº url åæ°ï¼æ­¤åæ°å¯ä¸ä¼ 
 * @usage
 */
class WebPrintingJobCustomItems {
    constructor(option) {
        /**
         * @member {string} WebPrintingJobCustomItems.prototype.name
         * @description  å¾ä¾åç´ çåç§°ã
         */
        this.name = null;
        /**
         * @member {string} [WebPrintingJobCustomItems.prototype.picAsUrl]
         * @description  å¾ä¾åç´  Base64 æ ¼å¼å¾çã
         */
        this.picAsUrl = null;
        /**
         * @member {string} [WebPrintingJobCustomItems.prototype.picAsBase64]
         * @description  å¾ä¾åç´ å¾ççè·åå°åã
         */
        this.picAsBase64 = null;

        this.CLASS_NAME = 'SuperMap.WebPrintingJobCustomItems';
        Util.extend(this, option);
    }

    /**
     * @function WebPrintingJobCustomItems.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.name = null;
        me.picAsUrl = null;
        me.picAsBase64 = null;
    }

    /**
     * @function WebPrintingJobCustomItems.prototype.toJSON
     * @description å° WebPrintingJobCustomItems å¯¹è±¡è½¬åä¸º JSON å­ç¬¦ä¸²ã
     * @returns {string} è½¬æ¢åç JSON å­ç¬¦ä¸²ã
     */
    toJSON() {
        var params = {
            name: this.name
        };
        if (this.title) {
            params.title = this.title;
        }
        if (this.picAsUrl) {
            params.picAsUrl = this.picAsUrl;
        } else if (this.picAsBase64) {
            params.picAsBase64 = this.picAsBase64.replace(/^data:.+;base64,/, '');
        }
        return Util.toJSON(params);
    }
}


;// CONCATENATED MODULE: ./src/common/iServer/WebPrintingJobImage.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class WebPrintingJobImage
 * @deprecatedclass SuperMap.WebPrintingJobImage
 * @classdesc è¡¨è¾¾å°å°å¾çéæå¾çåæ°ç±»ã
 * @version 10.1.0
 * @category iServer WebPrintingJob
 * @param {Object} option - åæ°ã
 * @param {string} option.picAsUrl - å°å°å¾çå¾ç url å°åã
 * @param {string} [option.picAsBase64] - å°å°å¾çbase64ä½å¾çä¿¡æ¯ãå¦æå·²å¡«äº url åæ°ï¼æ­¤åæ°å¯ä¸ä¼ 
 * @usage
 */
class WebPrintingJobImage {
    constructor(option) {
        /**
         * @member {string} [WebPrintingJobImage.prototype.picAsUrl]
         * @description å°å°å¾çå¾ç url å°åã
         */
        this.picAsUrl = null;
        /**
         * @member {string} [WebPrintingJobImage.prototype.picAsBase64]
         * @description å°å°å¾çbase64ä½å¾çä¿¡æ¯ã
         */
        this.picAsBase64 = null;

        this.CLASS_NAME = 'SuperMap.WebPrintingJobImage';
        Util.extend(this, option);
    }

    /**
     * @function WebPrintingJobImage.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        this.picAsUrl = null;
        this.picAsBase64 = null;
    }

    /**
     * @function WebPrintingJobImage.prototype.toJSON
     * @description å° WebPrintingJobImage å¯¹è±¡è½¬åä¸º JSON å­ç¬¦ä¸²ã
     * @returns {string} è½¬æ¢åç JSON å­ç¬¦ä¸²ã
     */
    toJSON() {
        var params = {};
        if (this.picAsUrl) {
            params.picAsUrl = this.picAsUrl;
        }
        if (this.picAsBase64) {
            params.picAsBase64 = this.picAsBase64.replace(/^data:.+;base64,/, '');
        }
        return Util.toJSON(params);
    }
}


;// CONCATENATED MODULE: ./src/common/iServer/WebPrintingJobLayers.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
 

 /**
  * @class WebPrintingJobLayers
  * @deprecatedclass SuperMap.WebPrintingJobLayers
  * @classdesc å°å¾ä¾æ·»å å°å¸å±çä¸å¡å¾å±åæ°ç±»ã
  * @version 10.1.0
  * @category iServer WebPrintingJob
  * @param {Object} option - åæ°ã
  * @param {string} option.name - å¾å± name çå­ç¬¦ä¸²ãæ­¤ name å¿é¡»å¯ä¸ï¼å¹¶ä¸å¿é¡»ä¸å®ä¹ä¸å¡å¾å±ç LegendOptions_layers åç´ ä¸­çå¾å± name å¹éã
  * @usage
  */
 class WebPrintingJobLayers {
     constructor(option) {
         /**
          * @member {string} WebPrintingJobLayers.prototype.name
          * @description  å¾å± nameã
          */
         this.name = null;
         /**
          * @member {string} WebPrintingJobLayers.prototype.layerType
          * @description  å¾å± typeã
          */
         this.layerType = null;
         /**
          * @member {string} WebPrintingJobLayers.prototype.url
          * @description  å¾å± urlã
          */
         this.url = null;

         this.CLASS_NAME = 'SuperMap.WebPrintingJobLayers';
         Util.extend(this, option);
     }

     /**
     * @function WebPrintingJobLayers.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
     destroy() {
         this.name = null;
         this.layerType = null;
         this.url = null;
     }
 }


;// CONCATENATED MODULE: ./src/common/iServer/WebPrintingJobLegendOptions.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class WebPrintingJobLegendOptions
 * @deprecatedclass SuperMap.WebPrintingJobLegendOptions
 * @classdesc Web æå°å¾ä¾åæ°ç±»ã
 * @version 10.1.0
 * @category iServer WebPrintingJob
 * @param {Object} option - åæ°ã
 * @param {string} [option.title] - å¾ä¾åç§°ã
 * @param {string} [option.picAsUrl] - å¾ä¾çå¾ç url å°åã
 * @param {string} [option.picAsBase64] - å¾ä¾ç base64 ä½å¾çä¿¡æ¯ã
 * @param {WebPrintingJobLayers} [option.layers] - å¾ä¾çå¸å±ä¸å¡å¾å±åæ°ç±»ã
 * @param {WebPrintingJobCustomItems} [option.customItems] - èªå®ä¹å¾ä¾åç´ åæ°ç±»ã
 * @usage
 */
class WebPrintingJobLegendOptions {
    constructor(option) {
        /**
         * @member {string} WebPrintingJobLegendOptions.prototype.title
         * @description  å¾ä¾åç§°ã
         */
        this.title = null;
        /**
         * @member {string} [WebPrintingJobLegendOptions.prototype.picAsUrl]
         * @description  å¾ä¾çå¾ç url å°åã
         */
        this.picAsUrl = null;
        /**
         * @member {string} [WebPrintingJobLegendOptions.prototype.picAsBase64]
         * @description  å¾ä¾ç base64 ä½å¾çä¿¡æ¯ã
         */
        this.picAsBase64 = null;
        /**
         * @member {WebPrintingJobLayers} [WebPrintingJobLegendOptions.prototype.layers]
         * @description  å¾ä¾çå¸å±ä¸å¡å¾å±åæ°ç±»ã
         */
        this.layers = null;
        /**
         * @member {WebPrintingJobCustomItems} [WebPrintingJobLegendOptions.prototype.customItems]
         * @description  èªå®ä¹å¾ä¾åç´ åæ°ç±»ã
         */
        this.customItems = null;

        this.CLASS_NAME = 'SuperMap.WebPrintingJobLegendOptions';
        Util.extend(this, option);
    }

    /**
     * @function WebPrintingJobLegendOptions.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        this.title = null;
        this.picAsUrl = null;
        this.picAsBase64 = null;
        if (this.layers instanceof WebPrintingJobLayers) {
            this.layers.destroy();
            this.layers = null;
        }
        if (this.customItems instanceof WebPrintingJobCustomItems) {
            this.customItems.destroy();
            this.customItems = null;
        }
    }

    /**
     * @function WebPrintingJobLegendOptions.prototype.toJSON
     * @description å° WebPrintingJobLegendOptions å¯¹è±¡è½¬åä¸º JSON å­ç¬¦ä¸²ã
     * @returns {string} è½¬æ¢åç JSON å­ç¬¦ä¸²ã
     */
    toJSON() {
        var params = {
            title: this.title || ""
        };
        if (this.picAsUrl) {
            params.picAsUrl = this.picAsUrl;
        } else if (this.picAsBase64) {
            params.picAsBase64 = this.picAsBase64.replace(/^data:.+;base64,/, '');
        } else if (this.customItems) {
            params.customItems = this.customItems;
        }
        return Util.toJSON(params);
    }
}


;// CONCATENATED MODULE: ./src/common/iServer/WebPrintingJobLittleMapOptions.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class WebPrintingJobLittleMapOptions
 * @deprecatedclass SuperMap.WebPrintingJobLittleMapOptions
 * @classdesc Web æå°å°å°å¾åæ°ç±»ã
 * @version 10.1.0
 * @category iServer WebPrintingJob
 * @param {Object} option - åæ°ã
 * @param {GeometryPoint|L.Point|L.LatLng|ol.geom.Point|mapboxgl.LngLat|mapboxgl.Point|Array.<number>} option.center - å°å°å¾çä¸­å¿ç¹ã
 * @param {number} [option.scale] - å°å°å¾çæ¯ä¾å°ºã
 * @param {Array.<string>} [option.layerNames] - æå® WebMapä¸­å¾å±åç§°çåè¡¨ï¼ç¨äºæ¸²æå°å°å¾ã
 * @param {WebPrintingJobImage} [option.image] - è¡¨è¾¾å°å°å¾çéæå¾ç±»ã
 * @param {WebPrintingJobLayers} [option.layers] - æå® WebMap ä¸­ç layers å¾å±ç±»ã
 * @usage
 */

class WebPrintingJobLittleMapOptions {
    constructor(option) {
        /**
         * @member {GeometryPoint|L.Point|L.LatLng|ol.geom.Point|mapboxgl.LngLat|mapboxgl.Point|Array.<number>} WebPrintingJobLittleMapOptions.prototype.center
         * @description å°å°å¾çä¸­å¿ç¹ã
         */
        this.center = null;
        /**
         * @member {number} [WebPrintingJobLittleMapOptions.prototype.scale]
         * @description å°å°å¾çæ¯ä¾å°ºã
         */
        this.scale = null;
        /**
         * @member {Array.<string>} WebPrintingJobLittleMapOptions.prototype.layerNames
         * @description æå® WebMapä¸­å¾å±åç§°çåè¡¨ï¼ç¨äºæ¸²æå°å°å¾ã
         */
        this.layerNames = null;
        /**
         * @member {WebPrintingJobImage} [WebPrintingJobLittleMapOptions.prototype.image]
         * @description è¡¨è¾¾å°å°å¾çéæå¾ç±»ãæä¸æ¯æ
         */
        this.image = null;
        /**
         * @member {WebPrintingJobLayers} [WebPrintingJobLittleMapOptions.prototype.layers]
         * @description æå® WebMap ä¸­ç layers å¾å±ç±»ã
         */
        this.layers = null;

        this.CLASS_NAME = 'SuperMap.WebPrintingJobLittleMapOptions';
        Util.extend(this, option);
    }

    /**
     * @function WebPrintingJobLittleMapOptions.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        this.center = null;
        this.scale = null;
        this.layerNames = null;
        if (this.image instanceof WebPrintingJobImage) {
            this.image.destroy();
            this.image = null;
        }
        if (this.layers instanceof WebPrintingJobLayers) {
            this.layers.destroy();
            this.layers = null;
        }
    }

    /**
     * @function WebPrintingJobLittleMapOptions.prototype.toJSON
     * @description å° WebPrintingJobLittleMapOptions å¯¹è±¡è½¬åä¸º JSON å­ç¬¦ä¸²ã
     * @returns {string} è½¬æ¢åç JSON å­ç¬¦ä¸²ã
     */
    toJSON() {
        var params = {
            scale: this.scale,
            center: this.center
        };
        if (this.layerNames) {
            params.layerNames = this.layerNames;
        } else if (this.layers) {
            params.layers = this.layers;
        }
        if (this.image) {
            params.image = this.image;
        }
        return Util.toJSON(params);
    }
}


;// CONCATENATED MODULE: ./src/common/iServer/WebPrintingJobNorthArrowOptions.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class WebPrintingJobNorthArrowOptions
 * @deprecatedclass SuperMap.WebPrintingJobNorthArrowOptions
 * @classdesc Web æå°å°å¾æåéåæ°ç±»ã
 * @version 10.1.0
 * @category iServer WebPrintingJob
 * @param {Object} option - åæ°ã
 * @param {string} option.picAsUrl - æåéçå¾ç url å°åã
 * @param {string} [option.picAsBase64] - æåéçbase64ä½å¾çä¿¡æ¯ã
 * @usage
 */
class WebPrintingJobNorthArrowOptions {
    constructor(option) {
        /**
         * @member {string} WebPrintingJobNorthArrowOptions.prototype.picAsUrl
         * @description æåéçå¾ç url å°åã
         */
        this.picAsUrl = null;
        /**
         * @member {string} [WebPrintingJobNorthArrowOptions.prototype.picAsBase64]
         * @description æåéçbase64ä½å¾çä¿¡æ¯ã
         */
        this.picAsBase64 = null;

        this.CLASS_NAME = 'SuperMap.WebPrintingJobNorthArrowOptions';
        Util.extend(this, option);
    }

    /**
     * @function WebPrintingJobNorthArrowOptions.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        this.picAsUrl = null;
        this.picAsBase64 = null;
    }

    /**
     * @function WebPrintingJobNorthArrowOptions.prototype.toJSON
     * @description å° WebPrintingJobNorthArrowOptions å¯¹è±¡è½¬åä¸º JSON å­ç¬¦ä¸²ã
     * @returns {string} è½¬æ¢åç JSON å­ç¬¦ä¸²ã
     */
    toJSON() {
        var params = {};
        if (this.picAsUrl) {
            params.picAsUrl = this.picAsUrl;
        } else if (this.picAsBase64) {
            params.picAsBase64 = this.picAsBase64.replace(/^data:.+;base64,/, '');
        }
        return Util.toJSON(params);
    }
}


;// CONCATENATED MODULE: ./src/common/iServer/WebPrintingJobScaleBarOptions.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class WebPrintingJobScaleBarOptions
 * @deprecatedclass SuperMap.WebPrintingJobScaleBarOptions
 * @classdesc Web æå°æ¯ä¾å°ºåæ°ç±»ã
 * @category iServer WebPrintingJob
 * @version 10.1.0
 * @param {Object} option - åæ°ã
 * @param {string} [option.scaleText] - æ¯ä¾å°ºææ¬ä¿¡æ¯ãä¾å¦ï¼1:1000000
 * @param {WebScaleOrientationType} [option.orientation] - æ¯ä¾å°ºçæ¹ä½æ ·å¼ã
 * @param {WebScaleType} [option.type] - æ¯ä¾å°ºçæ ·å¼ã
 * @param {number} [option.intervals] - æ¯ä¾å°ºæ¡çæ®µæ°ã
 * @param {WebScaleUnit} [option.unit] - æ¯ä¾å°ºçåä½å¶ã
 * @usage
 */
class WebPrintingJobScaleBarOptions {
    constructor(option) {
        /**
         * @member {string} WebPrintingJobScaleBarOptions.prototype.scaleText
         * @description æ¯ä¾å°ºææ¬ä¿¡æ¯ã
         */
        this.scaleText = null;
        /**
         * @member {WebScaleOrientationType} [WebPrintingJobScaleBarOptions.prototype.orientation]
         * @description æ¯ä¾å°ºçæ¹ä½æ ·å¼ã
         */
        this.orientation = null;
        /**
         * @member {WebScaleType} [WebPrintingJobScaleBarOptions.prototype.type]
         * @description æ¯ä¾å°ºçæ ·å¼ã
         */
        this.type = null;
        /**
         * @member {Object} [WebPrintingJobScaleBarOptions.prototype.intervals]
         * @description æ¯ä¾å°ºæ¡çæ®µæ°ã
         */
        this.intervals = null;
        /**
         * @member {WebScaleUnit} [WebPrintingJobScaleBarOptions.prototype.unit]
         * @description æ¯ä¾å°ºçåä½å¶ã
         */
        this.unit = null;

        this.CLASS_NAME = 'SuperMap.WebPrintingJobScaleBarOptions';
        Util.extend(this, option);
    }

    /**
     * @function WebPrintingJobScaleBarOptions.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        this.scaleText = null;
        this.orientation = null;
        this.type = null;
        this.intervals = null;
        this.unit = null;
    }

    /**
     * @function WebPrintingJobScaleBarOptions.prototype.toJSON
     * @description å° WebPrintingJobScaleBarOptions å¯¹è±¡è½¬åä¸º JSON å­ç¬¦ä¸²ã
     * @returns {string} è½¬æ¢åç JSON å­ç¬¦ä¸²ã
     */
    toJSON() {
        var params = {
            scaleText: this.scaleText || "",
            type: this.type || "BAR",
            intervals: this.intervals || "",
            unit: this.unit || "METER"
        };
        if (this.orientation) {
            params.orientation = this.orientation;
        }
        return Util.toJSON(params);
    }
}


;// CONCATENATED MODULE: ./src/common/iServer/WebPrintingJobContent.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class WebPrintingJobContent
 * @deprecatedclass SuperMap.WebPrintingJobContent
 * @classdesc Web æå°åå®¹åæ°ç±»ã
 * @version 10.1.0
 * @category iServer WebPrintingJob
 * @param {Object} option - åæ°ã
 * @param {string} option.type - Web æå°åå®¹æ¯æçç±»åãç®åæ¯æçç±»åï¼WEBMAP
 * @param {string} [option.url] - å¾æå°ç SuperMap iPortal WebMap ç url å°åãä¾å¦ï¼http://supermapiportal:8190/iportal/web/maps/{mapid}/map.rjson
 * @param {string} [option.token] - å¦æå¾æå°çæ¯ SuperMap iPortal ç¨æ·ç§æç WebMapï¼éè¦æä¾ SuperMap iPortal ç¨æ·ç tokenã
 * @param {WebMapSummaryObject} [option.value] - ä¼ éçæ¯ä¸ä¸ªç¬¦å SuperMap WebMap è§èç WebMap ç JSON è¡¨è¾¾ï¼ä¹å¯ä»¥æ¯ä¸ä¸ªå®æ´ç SuperMap iPortal æ°æ®ä¸å¾å¶ä½ç WebMap ç json è¡¨è¾¾ãå¦æå·²å¡«äº url åæ°ï¼æ­¤åæ°å¯ä¸ä¼ 
 * @usage
 */
class WebPrintingJobContent {
    constructor(option) {
        /**
         * @member {string} WebPrintingJobContent.prototype.type
         * @description Web æå°åå®¹æ¯æçç±»åã
         */
        this.type = null;
        /**
         * @member {string} [WebPrintingJobContent.prototype.url]
         * @description å¾æå°ç SuperMap iPortal WebMap ç url å°åã
         */
        this.url = null;
        /**
         * @member {string} [WebPrintingJobContent.prototype.token]
         * @description å¦æå¾æå°çæ¯ SuperMap iPortal ç¨æ·ç§æç WebMapï¼éè¦æä¾ SuperMap iPortal ç¨æ·ç tokenã
         */
        this.token = null;
        /**
         * @member {WebMapSummaryObject} [WebPrintingJobContent.prototype.value]
         * @description ä¼ éçæ¯ä¸ä¸ªç¬¦å SuperMap WebMap è§èç WebMap ç JSON è¡¨è¾¾ï¼ä¹å¯ä»¥æ¯ä¸ä¸ªå®æ´ç SuperMap iPortal æ°æ®ä¸å¾å¶ä½ç WebMap ç json è¡¨è¾¾ã
         */
        this.value = null;

        this.CLASS_NAME = 'SuperMap.WebPrintingJobContent';
        Util.extend(this, option);
    }

    /**
     * @function WebPrintingJobContent.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        this.type =  false || "WEBMAP";
        this.url = null;
        this.token = null;
        this.value = null;
    }

    /**
     * @function WebPrintingJobContent.prototype.toJSON
     * @description å° WebPrintingJobContent å¯¹è±¡è½¬åä¸º JSON å­ç¬¦ä¸²ã
     * @returns {string} è½¬æ¢åç JSON å­ç¬¦ä¸²ã
     */
    toJSON() {
        var params = {
            type: this.type
        };
        if (this.token) {
            params.token = this.token;
        }
        if (this.url) {
            params.url = this.url;
        } else if (this.value) {
            params.value = this.value;
        }
        return Util.toJSON(params);
    }
}


;// CONCATENATED MODULE: ./src/common/iServer/WebPrintingJobLayoutOptions.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/






/**
 * @class WebPrintingJobLayoutOptions
 * @deprecatedclass SuperMap.WebPrintingJobLayoutOptions
 * @classdesc Web æå°çå¸å±åæ°ç±»ã
 * @version 10.1.0
 * @category iServer WebPrintingJob
 * @param {Object} option - åæ°ã
 * @param {string} option.templateName - å¸å±æ¨¡æ¿çåç§°ã
 * @param {string} option.title - å°å¾ä¸»æ é¢åç§°ã
 * @param {string} option.subTitle - å°å¾å¯æ é¢åç§°ã
 * @param {string} option.author - ä½èåç§°ã
 * @param {string} option.copyright - çæä¿¡æ¯ã
 * @param {WebPrintingJobLittleMapOptions} option.littleMapOptions - å°å°å¾åæ°ç±»ã
 * @param {WebPrintingJobLegendOptions} option.legendOptions - å¾ä¾åæ°ç±»ã
 * @param {WebPrintingJobScaleBarOptions} [option.scaleBarOptions] - å°å¾æ¯ä¾å°ºåæ°ç±»ã
 * @param {WebPrintingJobNorthArrowOptions} [option.northArrowOptions] - å°å¾æåéåæ°ç±»ã
 * @usage
 */
class WebPrintingJobLayoutOptions {
    constructor(option) {
        /**
         * @member {string} WebPrintingJobLayoutOptions.prototype.templateName
         * @description å¸å±æ¨¡æ¿çåç§°ã
         */
        this.templateName = null;
        /**
         * @member {string} WebPrintingJobLayoutOptions.prototype.title
         * @description å°å¾ä¸»æ é¢åç§°ã
         */
        this.title = null;
        /**
         * @member {string} WebPrintingJobLayoutOptions.prototype.subTitle
         * @description å°å¾å¯æ é¢åç§°ã
         */
        this.subTitle = null;
        /**
         * @member {string} WebPrintingJobLayoutOptions.prototype.author
         * @description å°å¾ä½èåç§°ã
         */
        this.author = null;
        /**
         * @member {string} WebPrintingJobLayoutOptions.prototype.copyright
         * @description å°å¾çæä¿¡æ¯ã
         */
        this.copyright = null;
        /**
         * @member {WebPrintingJobScaleBarOptions} [WebPrintingJobLayoutOptions.prototype.scaleBarOptions]
         * @description å°å¾æ¯ä¾å°ºåæ°ç±»ã
         */
        this.scaleBarOptions = null;
        /**
         * @member {WebPrintingJobNorthArrowOptions} [WebPrintingJobLayoutOptions.prototype.northArrowOptions]
         * @description å°å¾æåéåæ°ç±»ã
         */
        this.northArrowOptions = null;
        /**
         * @member {WebPrintingJobLittleMapOptions} WebPrintingJobLayoutOptions.prototype.littleMapOptions
         * @description å°å°å¾åæ°ç±»ã
         */
        this.littleMapOptions = null;
        /**
         * @member {WebPrintingJobLegendOptions} WebPrintingJobLayoutOptions.prototype.legendOptions
         * @description å¾ä¾åæ°ç±»ã
         */
        this.legendOptions = null;

        this.CLASS_NAME = 'SuperMap.WebPrintingJobLayoutOptions';
        Util.extend(this, option);
    }

    /**
     * @function WebPrintingJobLayoutOptions.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        this.templateName = null;
        this.title = null;
        this.subTitle = null;
        this.author = null;
        this.copyright = null;
        if (this.scaleBarOptions instanceof WebPrintingJobScaleBarOptions) {
            this.scaleBarOptions.destroy();
            this.scaleBarOptions = null;
        }
        if (this.northArrowOptions instanceof WebPrintingJobNorthArrowOptions) {
            this.northArrowOptions.destroy();
            this.northArrowOptions = null;
        }
        if (this.littleMapOptions instanceof WebPrintingJobLittleMapOptions) {
            this.littleMapOptions.destroy();
            this.littleMapOptions = null;
        }
        if (this.legendOptions instanceof WebPrintingJobLegendOptions) {
            this.legendOptions.destroy();
            this.legendOptions = null;
        }
    }

    /**
     * @function WebPrintingJobLayoutOptions.prototype.toJSON
     * @description å° WebPrintingJobLayoutOptions å¯¹è±¡è½¬åä¸º JSON å­ç¬¦ä¸²ã
     * @returns {string} è½¬æ¢åç JSON å­ç¬¦ä¸²ã
     */
    toJSON() {
        var params = {
            templateName: this.templateName,
            title: this.title,
            subTitle: this.subTitle,
            author: this.author,
            copyright: this.copyright
        };
        if (this.scaleBarOptions) {
            params.scaleBarOptions = this.scaleBarOptions;
        }
        if (this.northArrowOptions) {
            params.northArrowOptions = this.northArrowOptions;
        }
        if (this.littleMapOptions) {
            params.littleMapOptions = this.littleMapOptions;
        }
        if (this.legendOptions) {
            params.legendOptions = this.legendOptions;
        }
        return Util.toJSON(params);
    }
}


;// CONCATENATED MODULE: ./src/common/iServer/WebPrintingJobExportOptions.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class WebPrintingJobExportOptions
 * @deprecatedclass SuperMap.WebPrintingJobExportOptions
 * @classdesc Web æå°çè¾åºåæ°ç±»ã
 * @version 10.1.0
 * @category iServer WebPrintingJob
 * @param {Object} option - åæ°ã
 * @param {WebExportFormatType} option.format - Web æå°è¾åºçæ ¼å¼ï¼ç®åæ¯æï¼PNGãPDFã
 * @param {number} [option.dpi=96] - Web æå°è¾åºçåè¾¨çï¼åä½ä¸ºæ¯è±å¯¸ç¹æ°ãé»è®¤å¼ä¸º 96 dpiã
 * @param {number} [option.scale] - Web æå°è¾åºçå°å¾æ¯ä¾å°ºã
 * @param {number} [option.rotation] - Web æå°è¾åºçå°å¾è§åº¦ã
 * @param {GeometryPoint|L.Point|L.LatLng|ol.geom.Point|mapboxgl.LngLat|mapboxgl.Point|Array.<number>} [option.center] - Web æå°è¾åºçå°å¾ä¸­å¿ç¹ã
 * @usage
 */
class WebPrintingJobExportOptions {
    constructor(option) {
        /**
         * @member {WebExportFormatType} WebPrintingJobExportOptions.prototype.format
         * @description Web æå°è¾åºçæ ¼å¼ã
         */
        this.format = null;
        /**
         * @member {number} [WebPrintingJobExportOptions.prototype.dpi=96]
         * @description  Web æå°è¾åºçåè¾¨çï¼åä½ä¸ºæ¯è±å¯¸ç¹æ°ã
         */
        this.dpi = 96;
        /**
         * @member {number} [WebPrintingJobExportOptions.prototype.scale]
         * @description Web æå°è¾åºçå°å¾æ¯ä¾å°ºã
         */
        this.scale = null;
        /**
         * @member {number} [WebPrintingJobExportOptions.prototype.rotation]
         * @description Web æå°è¾åºçå°å¾è§åº¦ã
         */
        this.rotation = null;
        /**
         * @member {GeometryPoint|L.Point|L.LatLng|ol.geom.Point|mapboxgl.LngLat|mapboxgl.Point|Array.<number>} [WebPrintingJobExportOptions.prototype.center]
         * @description Web æå°è¾åºçå°å¾ä¸­å¿ç¹ã
         */
        this.center = null;

        this.CLASS_NAME = 'SuperMap.WebPrintingJobExportOptions';
        Util.extend(this, option);
    }

    /**
     * @function WebPrintingJobExportOptions.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        this.format = null;
        this.dpi = null;
        this.scale = null;
        this.rotation = null;
        this.center = null;
        this.outputSize = null;
    }

    /**
     * @function WebPrintingJobExportOptions.prototype.toJSON
     * @description å° WebPrintingJobExportOptions å¯¹è±¡è½¬åä¸º JSON å­ç¬¦ä¸²ã
     * @returns {string} è½¬æ¢åç JSON å­ç¬¦ä¸²ã
     */
    toJSON() {
        var params = {
            format: this.format || "PDF",
            dpi: this.dpi,
            scale: this.scale,
            center: this.center
        };
        if (this.rotation) {
            params.rotation = this.rotation;
        }
        if (this.outputSize) {
            params.outputSize = this.outputSize;
        }
        return Util.toJSON(params);
    }
}


;// CONCATENATED MODULE: ./src/common/iServer/WebPrintingJobParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class WebPrintingJobParameters
 * @deprecatedclass SuperMap.WebPrintingJobParameters
 * @category iServer WebPrintingJob
 * @version 10.1.0
 * @classdesc Web æå°åæ°ç±»ã
 * @param {Object} options - åæ°ã
 * @param {WebPrintingJobContent} options.content - Web æå°çåå®¹ç±»ã
 * @param {WebPrintingJobLayoutOptions} options.layoutOptions - Web æå°çå¸å±ç±»ï¼åå«åç§å¸å±åç´ çè®¾ç½®ã
 * @param {WebPrintingJobExportOptions} options.exportOptions - Web æå°çè¾åºç±»ï¼åå« DPIãé¡µé¢å¤§å°ç­ã
 * @usage
 */
class WebPrintingJobParameters {
    constructor(options) {
        if (!options) {
            return;
        }
        /**
         * @member {WebPrintingJobContent} WebPrintingJobParameters.prototype.content
         * @description Web æå°çåå®¹ç±»ã
         */
        this.content = null;

        /**
         * @member {WebPrintingJobLayoutOptions} WebPrintingJobParameters.prototype.layoutOptions
         * @description Web æå°çå¸å±ç±»ï¼åå«åç§å¸å±åç´ çè®¾ç½®ã
         */
        this.layoutOptions = null;

        /**
         * @member {WebPrintingJobExportOptions} WebPrintingJobParameters.prototype.exportOptions
         * @description Web æå°çè¾åºç±»ï¼åå« DPIãé¡µé¢å¤§å°ç­ã
         */
        this.exportOptions = null;

        Util.extend(this, options);

        this.CLASS_NAME = 'SuperMap.WebPrintingJobParameters';
    }

    /**
     * @function WebPrintingJobParameters.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        if (this.content instanceof WebPrintingJobContent) {
            this.content.destroy();
            this.content = null;
        }
        if (this.layoutOptions instanceof WebPrintingJobLayoutOptions) {
            this.layoutOptions.destroy();
            this.layoutOptions = null;
        }
        if (this.exportOptions instanceof WebPrintingJobExportOptions) {
            this.exportOptions.destroy();
            this.exportOptions = null;
        }
    }
}


;// CONCATENATED MODULE: ./src/common/iServer/WebPrintingService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class WebPrintingService
 * @deprecatedclass SuperMap.WebPrintingService
 * @category iServer WebPrintingJob
 * @version 10.1.0
 * @classdesc æå°å°å¾æå¡åºç±»ã
 * @extends {CommonServiceBase}
 * @param {string} url - æå¡å°åãè¯·æ±æå°å°å¾æå¡ç URL åºä¸ºï¼http://{æå¡å¨å°å}:{æå¡ç«¯å£å·}/iserver/services/webprinting/rest/webprinting/v1ã
 * @param {Object} options - åæ°ã
 * @param {Object} options.eventListeners - äºä»¶çå¬å¨å¯¹è±¡ãæprocessCompletedå±æ§å¯ä¼ å¥å¤çå®æåçåè°å½æ°ãprocessFailedå±æ§ä¼ å¥å¤çå¤±è´¥åçåè°å½æ°ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class WebPrintingService extends CommonServiceBase {
    constructor(url, options) {
        super(url, options);

        if (options) {
            Util.extend(this, options);
        }

        this.CLASS_NAME = 'SuperMap.WebPrintingService';
        if (!this.url) {
            return;
        }
    }

    /**
     * @function WebPrintingService.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function WebPrintingService.prototype.createWebPrintingJob
     * @description åå»º Web æå°ä»»å¡ã
     * @param {WebPrintingJobParameters} params - Web æå°çè¯·æ±åæ°ã
     */
    createWebPrintingJob(params) {
        if (!params) {
            return;
        }
        if (params.layoutOptions) {
            if (params.layoutOptions.legendOptions) {
                !params.layoutOptions.legendOptions.title && (params.layoutOptions.legendOptions.title = '');
                params.layoutOptions.legendOptions.picAsBase64 =
                    params.layoutOptions.legendOptions.picAsBase64 &&
                    params.layoutOptions.legendOptions.picAsBase64.replace(/^data:.+;base64,/, '');
                if (
                    params.layoutOptions.legendOptions.customItems &&
                    params.layoutOptions.legendOptions.customItems.hasOwnProperty('picAsBase64')
                ) {
                    params.layoutOptions.legendOptions.customItems.picAsBase64 = params.layoutOptions.legendOptions.customItems.picAsBase64.replace(
                        /^data:.+;base64,/,
                        ''
                    );
                }
            }
        }
        var me = this;
        me.request({
            url: me._processUrl('jobs'),
            method: 'POST',
            data: Util.toJSON(params),
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }

    /**
     * @function WebPrintingService.prototype.getPrintingJob
     * @description è·å Web æå°è¾åºææ¡£ä»»å¡ã
     * @param {string} jobId - Web æå°ä»»å¡ ID
     */
    getPrintingJob(jobId) {
        var me = this;
        var url = me._processUrl(`jobs/${jobId}`);
        me.request({
            url,
            method: 'GET',
            scope: me,
            success: function (result) {
                me.rollingProcess(result, url);
            },
            failure: me.serviceProcessFailed
        });
    }

    /**
     * @function WebPrintingService.prototype.getPrintingJobResult
     * @description è·å Web æå°ä»»å¡çè¾åºææ¡£ã
     * @param {string} jobId - Web æå°è¾å¥ææ¡£ä»»å¡ IDã
     */
    getPrintingJobResult(jobId) {
        var me = this;
        me.request({
            url: me._processUrl(`jobs/${jobId}/result`),
            method: 'GET',
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }

    /**
     * @function WebPrintingService.prototype.getLayoutTemplates
     * @description æ¥è¯¢ Web æå°æå¡ææå¯ç¨çæ¨¡æ¿ä¿¡æ¯ã
     */
    getLayoutTemplates() {
        var me = this;
        me.request({
            url: me._processUrl('layouts'),
            method: 'GET',
            scope: me,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }

    /**
     * @function WebPrintingService.prototype.rollingProcess
     * @description è½®è¯¢æ¥è¯¢ Web æå°ä»»å¡ã
     * @param {Object} result - æå¡å¨è¿åçç»æå¯¹è±¡ã
     */
    rollingProcess(result, url) {
        var me = this;
        if (!result) {
            return;
        }
        var id = setInterval(function () {
            me.request({
                url,
                method: 'GET',
                scope: me,
                success: function (result) {
                    switch (result.status) {
                        case 'FINISHED':
                            clearInterval(id);
                            me.serviceProcessCompleted(result);
                            break;
                        case 'ERROR':
                            clearInterval(id);
                            me.serviceProcessFailed(result);
                            break;
                        case 'RUNNING':
                            me.events.triggerEvent('processRunning', result);
                            break;
                    }
                },
                failure: me.serviceProcessFailed
            });
        }, 1000);
    }

    _processUrl(appendContent) {
        if (appendContent) {
            return Util.urlPathAppend(this.url, appendContent);
        }
        return this.url;
    }
}


;// CONCATENATED MODULE: ./src/common/iServer/ImageCollectionService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class ImageCollectionService
 * @deprecatedclass SuperMap.ImageCollectionService
 * @classdesc å½±åéåæå¡ç±»
 * @version 10.2.0
 * @category iServer Image
 * @param {string} url - æå¡å°åãä¾å¦: http://{ip}:{port}/iserver/{imageservice-imageserviceName}/restjsr/
 * @param {Object} options - åæ°ã
 * @param {string} options.collectionId å½±åéåï¼Collectionï¼çIDï¼å¨ä¸ä¸ªå½±åæå¡ä¸­å¯ä¸æ è¯å½±åéåã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @extends {CommonServiceBase}
 * @usage
 */
class ImageCollectionService_ImageCollectionService extends CommonServiceBase {
    constructor(url, options) {
        super(url, options);
        this.options = options || {};
        if (options) {
            Util.extend(this, options);
        }
        this.CLASS_NAME = 'SuperMap.ImageCollectionService';
    }

    /**
     * @function ImageCollectionService.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function ImageCollectionService.prototype.getLegend
     * @description è¿åå½åå½±åéåçå¾ä¾ä¿¡æ¯ãé»è®¤ä¸ºæå¡åå¸æéç½®çé£æ ¼ï¼æ¯ææ ¹æ®é£æ ¼åæ°çææ°çå¾ä¾ã
     * @param {Object} queryParams queryåæ°
     * @param {ImageRenderingRule} [queryParams.renderingRule] renderingRule å¯¹è±¡ï¼ç¨æ¥æå®å½±åçæ¸²æé£æ ¼ï¼ä»èç¡®å®å¾ä¾åå®¹ãå½±åçæ¸²æé£æ ¼åå«æä¼¸æ¾ç¤ºæ¹å¼ãé¢è²è¡¨ãæ³¢æ®µç»åä»¥ååºç¨æ æ ¼å½æ°è¿è¡å¿«éå¤çç­ãè¯¥åæ°æªè®¾ç½®æ¶ï¼å°ä½¿ç¨åå¸æå¡æ¶æéç½®çé£æ ¼ã
     */
    getLegend(queryParams) {
        var me = this;
        var pathParams = {
            collectionId: me.options.collectionId
        };
        var path = Util.convertPath('/collections/{collectionId}/legend', pathParams);
        var url = Util.urlPathAppend(me.url, path);
        this.request({
            method: 'GET',
            url,
            params: queryParams,
            scope: this,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }

    /**
     * @function ImageCollectionService.prototype.getStatistics
     * @description è¿åå½åå½±åéåçç»è®¡ä¿¡æ¯ãåæ¬æä»¶æ°éï¼æä»¶å¤§å°ç­ä¿¡æ¯ã
     */
    getStatistics() {
        var me = this;
        var pathParams = {
            collectionId: me.options.collectionId
        };
        var path = Util.convertPath('/collections/{collectionId}/statistics', pathParams);
        var url = Util.urlPathAppend(me.url, path);
        this.request({
            method: 'GET',
            url,
            scope: this,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }

    /**
     * @function ImageCollectionService.prototype.getTileInfo
     * @description è¿åå½±åéåææä¾çæå¡ç¦ççä¿¡æ¯ï¼åæ¬ï¼æ¯å±ç¦ççåè¾¨çï¼æ¯ä¾å°ºç­ä¿¡æ¯ï¼æ¹ä¾¿åç«¯è¿è¡å¾å±å å ã

     */
    getTileInfo() {
        var me = this;
        var pathParams = {
            collectionId: me.options.collectionId
        };
        var path = Util.convertPath('/collections/{collectionId}/tileInfo', pathParams);
        var url = Util.urlPathAppend(me.url, path);
        this.request({
            method: 'GET',
            url,
            scope: this,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }

    /**
     * @function ImageCollectionService.prototype.deleteItemByID
     * @description å é¤å½±åéåä¸­æå® ID ç Itemï¼å³ä»å½±åéåä¸­å é¤æå®çå½±åã
     * @param {string} featureId Feature çæ¬å°æ è¯ç¬¦ã
     */
    deleteItemByID(featureId) {
        var me = this;
        var pathParams = {
            collectionId: me.options.collectionId,
            featureId: featureId
        };
        var path = Util.convertPath('/collections/{collectionId}/items/{featureId}', pathParams);
        var url = Util.urlPathAppend(me.url, path);
        this.request({
            method: 'DELETE',
            url,
            scope: this,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }

    /**
     * @function ImageCollectionService.prototype.getItemByID
     * @description è¿åæå®IDï¼`collectionId`ï¼çå½±åéåä¸­çæå®IDï¼`featureId`ï¼çItemå¯¹è±¡ï¼å³è¿åå½±åéåä¸­æå®çå½±åã
     * @param {string} featureId Feature çæ¬å°æ è¯ç¬¦ã
     */
    getItemByID(featureId) {
        var me = this;
        var pathParams = {
            collectionId: me.options.collectionId,
            featureId: featureId
        };
        var path = Util.convertPath('/collections/{collectionId}/items/{featureId}', pathParams);
        var url = Util.urlPathAppend(me.url, path);
        this.request({
            method: 'GET',
            url,
            scope: this,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }
}


;// CONCATENATED MODULE: ./src/common/iServer/ImageService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class ImageService
 * @deprecatedclass SuperMap.ImageService
 * @classdesc å½±åæå¡ç±»
 * @version 10.2.0
 * @category iServer Image
 * @param {string} url - æå¡å°åãä¾å¦: http://{ip}:{port}/iserver/{imageservice-imageserviceName}/restjsr/
 * @param {Object} options - å¯éåæ°ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @extends {CommonServiceBase}
 * @usage
 */
class ImageService_ImageService extends CommonServiceBase {
    constructor(url, options) {
        super(url, options);
        this.options = options || {};
        if (options) {
            Util.extend(this, options);
        }
        this.CLASS_NAME = 'SuperMap.ImageService';
    }

    /**
     * @function ImageService.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function ImageService.prototype.getCollections
     * @description è¿åå½åå½±åæå¡ä¸­çå½±åéååè¡¨ï¼Collectionsï¼ã
     */
    getCollections() {
        var me = this;
        var path = Util.convertPath('/collections');
        var url = Util.urlPathAppend(me.url, path);
        this.request({
            method: 'GET',
            url,
            scope: this,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }

    /**
     * @function ImageService.prototype.getCollectionByID
     * @description IDå¼ç­äº`collectionId`åæ°å¼çå½±åéåï¼Collectionï¼ã IDå¼ç¨äºå¨æå¡ä¸­å¯ä¸æ è¯è¯¥å½±åéåã
     * @param {string} collectionId å½±åéåï¼Collectionï¼çIDï¼å¨ä¸ä¸ªå½±åæå¡ä¸­å¯ä¸æ è¯å½±åéåã
     */
    getCollectionByID(collectionId) {
        var pathParams = {
            collectionId: collectionId
        };
        var me = this;
        var path = Util.convertPath('/collections/{collectionId}', pathParams);
        var url = Util.urlPathAppend(me.url, path);
        this.request({
            method: 'GET',
            url,
            scope: this,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }

    /**
     * @function ImageSearchService.prototype.search
     * @description æ¥è¯¢ä¸è¿æ»¤æ¡ä»¶å¹éçå½±åæ°æ®ã
     * @param {ImageSearchParameter} [imageSearchParameter] æ¥è¯¢åæ°
     */
    search(imageSearchParameter) {
        var postBody = { ...(imageSearchParameter || {}) };
        var me = this;
        var path = Util.convertPath('/search');
        var url = Util.urlPathAppend(me.url, path);
        this.request({
            method: 'POST',
            url,
            data: postBody,
            scope: this,
            success: me.serviceProcessCompleted,
            failure: me.serviceProcessFailed
        });
    }
}


;// CONCATENATED MODULE: ./src/common/iServer/FieldsFilter.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class FieldsFilter
 * @deprecatedclass SuperMap.FieldsFilter
 * @category iServer Data Field
 * @classdesc æå®è¿åçç¨äºæè¿° Feature çå­æ®µã
 * @param {Object} options - å¯éåæ°ã
 * @param {Array.<string>} [options.include] å¯¹è¿åçå­æ®µåå®¹è¿è¡è¿æ»¤ï¼éä¿ççå­æ®µåè¡¨
 * @param {Array.<string>} [options.exclude] å¯¹è¿åçå­æ®µåå®¹è¿è¡è¿æ»¤ï¼éæé¤çå­æ®µåè¡¨
 * @usage
 */
class FieldsFilter {
  constructor(options) {
    /**
    * @description å¯¹è¿åçå­æ®µåå®¹è¿è¡è¿æ»¤ï¼éä¿ççå­æ®µåè¡¨
    * @member {Array.<string>} FieldsFilter.prototype.include
    */
    this.include = undefined;
    /**
    * @description å¯¹è¿åçå­æ®µåå®¹è¿è¡è¿æ»¤ï¼éæé¤çå­æ®µåè¡¨
    * @member {Array.<string>} FieldsFilter.prototype.exclude
    */
    this.exclude = undefined;

    this.CLASS_NAME = 'SuperMap.FieldsFilter';
    Util.extend(this, options);

  }

  /**
  * @function FieldsFilter.prototype.destroy
  * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
  */
  destroy() {
    var me = this;
    me.include = undefined;
    me.exclude = undefined;
  }

  /**
  * @function FieldsFilter.prototype.constructFromObject
  * @description ç®æ å¯¹è±¡æ°å¢è¯¥ç±»çå¯éåæ°ã
  * @param {Object} data è¦è½¬æ¢çæ°æ®.
  * @param {FieldsFilter} obj è¿åçæ¨¡å.
  * @return {FieldsFilter} è¿åç»æ
  */
  static constructFromObject(data, obj) {
    if (data) {
      obj = obj || new FieldsFilter();
      if (data.hasOwnProperty('include')) {
          obj.include = data.include
      }
      if (data.hasOwnProperty('exclude')) {
          obj.exclude = data.exclude
      }
    }
    return obj;
  }
}





;// CONCATENATED MODULE: ./src/common/iServer/Sortby.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class Sortby
 * @deprecatedclass SuperMap.Sortby
 * @classdesc éè¿æå®å­æ®µè¿è¡æåºçæ¹æ³ç±»ã
 * @category BaseTypes Util
 * @param {Object} options - åæ°ã
 * @param {string} options.field å±æ§åç§°ã
 * @param {Sortby.Direction} options.direction æåºè§åï¼ é»è®¤ååºã
 * @usage
 */
class Sortby {
  constructor(options) {
    /**
     * @description å±æ§åç§°
     * @member {string} Sortby.prototype.field
     */
    this.field = undefined;
    /**
     * @description æåºè§å
     * @member {Sortby.Direction} Sortby.prototype.direction
     * @default Sortby.Direction.ASC
     */
    this.direction = Sortby.Direction.ASC;

    this.CLASS_NAME = 'SuperMap.Sortby';
    Util.extend(this, options);
  }

  /**
   * @function Sortby.prototype.destroy
   * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
   */
  destroy() {
    var me = this;
    me.field = undefined;
    me.direction = 'ASC';
  }

  /**
   * @function Sortby.prototype.constructFromObject
   * @description ç®æ å¯¹è±¡æ°å¢è¯¥ç±»çå¯éåæ°ã
   * @param {Object} data è¦è½¬æ¢çæ°æ®ã
   * @param {Sortby} obj è¿åçæ¨¡åã
   * @return {Sortby} è¿åç»æã
   */
  static constructFromObject(data, obj) {
    if (data) {
      obj = obj || new Sortby();
      if (data.hasOwnProperty('field')) {
        obj.field = data.field;
      }
      if (data.hasOwnProperty('direction')) {
        obj.direction = data.direction;
      }
    }
    return obj;
  }
}
/**
 * @enum Direction
 * @description æåºçç±»åæä¸¾ã
 * @memberOf Sortby
 * @readonly
 * @type {string}
 */
Sortby.Direction = {
  ASC: 'ASC',
  DESC: 'DESC'
};

;// CONCATENATED MODULE: ./src/common/iServer/ImageSearchParameter.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class ImageSearchParameter
 * @deprecatedclass SuperMap.ImageSearchParameter
 * @classdesc å½±åæå¡æ¥è¯¢åæ°ç±»
 * @category iServer Image
 * @param {Object} options - å¯éåæ°ã
 * @param {Array.<number>} [options.bbox] æå®æ¥è¯¢èå´ãåªæå·æå ä½å¯¹è±¡ï¼geometryï¼å±æ§çFeaturesï¼å¹¶ä¸è¯¥å ä½å¯¹è±¡ä¸è¯¥åæ°æå®çèå´ç¸äº¤ç Features æä¼è¢«éæ©åºæ¥ã è¯¥åæ°å¯ä»¥åå«4ä¸ªæ°å¼æè6ä¸ªæ°å¼ï¼è¿åå³äºä½¿ç¨çåæ åèç³»ç»æ¯å¦åå«é«ç¨å¼ï¼  * å·¦ä¸è§åæ è½´ 1 çå¼ * å·¦ä¸è§åæ è½´ 2 çå¼ * åæ è½´ 3 çæå°å¼ï¼å¯éï¼ * å³ä¸è§åæ è½´ 1 çå¼ * å³ä¸è§åæ è½´ 2 çå¼ * åæ è½´ 3 çæå¤§å¼ï¼å¯éï¼  åæ åèç³»ç»ä¸º WGS 84 ç»åº¦/çº¬åº¦ (http://www.opengis.net/def/crs/OGC/1.3/CRS84).  å¯¹äº âWGS 84 ç»åº¦/çº¬åº¦â åæ åèç³»ç»ï¼ è¯¥åæ°å¼çæ ¼å¼éå¸¸ä¸ºï¼æå°ç»åº¦,æå°çº¬åº¦,æå¤§ç»åº¦,æå¤§çº¬åº¦ã  å¦æåå«äºé«ç¨å¼ï¼è¯¥åæ°çæ ¼å¼ä¸ºï¼æå°ç»åº¦,æå°çº¬åº¦,æå°é«ç¨å¼,æå¤§ç»åº¦,æå¤§çº¬åº¦,æå¤§é«ç¨å¼ã  å¦æä¸ä¸ª Feature å·æå¤ä¸ªç©ºé´å ä½å¯¹è±¡ï¼geometryï¼å±æ§ï¼ ç±æå¡å¨å³å®æ¯å¦ä½¿ç¨åä¸çç©ºé´å ä½å¯¹è±¡å±æ§ï¼è¿æ¯ä½¿ç¨ææç¸å³çå ä½å¯¹è±¡ä½ä¸ºæç»çæ¥è¯¢ç©ºé´èå´ã
 * @param {Array.<string>} [options.collections] å½±åéåçIDæ°ç»ï¼å°å¨è¯¥æå®çCollectionä¸­æç´¢Itemsã
 * @param {Array.<string>} [options.ids] åªè¿åæå® Item ç ID æ°ç»ä¸­çItemãè¿åç Item ç ID å¼æ°ç»ã è®¾ç½®äºè¯¥åæ°ï¼ææå¶ä»è¿æ»¤å¨åæ°ï¼é¤äºnextålimitï¼å°è¢«å¿½ç¥ã
 * @param {number} [options.limit] è¿åçæå¤§ç»ææ°ï¼å³ååºææ¡£åå«ç Item çæ°ç®ã
 * @param {FieldsFilter} [options.fields] éè¿âincludeâåâexcludeâå±æ§åå«æå®åªäºå­æ®µåå«å¨æ¥è¯¢ç»æç Feature æè¿°ä¸­ï¼åªäºéè¦æé¤ãè¿åç»æä¸­çstac_versionï¼idï¼bboxï¼assetsï¼linksï¼geometryï¼typeï¼propertiesè¿äºå­æ®µä¸ºå¿é¡»å­æ®µï¼è¥è¦è¿åç»æä¸­ä¸å«è¿ç§å­æ®µä¿¡æ¯ï¼éè¦æ¾ç¤ºå°è¿è¡æé¤è®¾ç½®ï¼å¦ï¼æé¤geometryåbboxå­æ®µï¼å¨POSTè¯·æ±ä¸­ï¼åéè¦å°è¿äºå­æ®µæ·»å å°âexcludeâå­æ®µä¸­ï¼ä¾å¦ï¼ "fields": { "exclude": ["geometry","bbox"] } } ãèå¯¹äºè¿åçâpropertiesâå¯¹è±¡ä¸­çæ©å±å­æ®µåå®¹ï¼å¯ä»¥å°å­æ®µåæ·»å å°âincludeâå­æ®µä¸­ï¼å¦ï¼ "fields": { "include": ["properties.SmFileName","properties.SmHighPS"] } } ï¼è¡¨ç¤ºproperties.SmFileNameåproperties.SmHighPS å±æ§é½åå«å¨æ¥è¯¢ç»æä¸­ã
 * @param {Object} [options.query] å®ä¹æ¥è¯¢åªäºå±æ§ï¼æ¥è¯¢è¿ç®ç¬¦å°åºç¨äºè¿äºå±æ§ãè¿ç®ç¬¦åæ¬ï¼eqãneqãgtãltãgteãlteãstartsWithãendsWithã containsãinã å¶ä¸­inæ¯Array.<string>ç±»å  ä¾å¦ï¼{ "SmFileName": { "eq":"B49C001002.tif" }}
 * @param {Array.<Sortby>} [options.sortby] ç±åå«å±æ§åç§°åæåºè§åçå¯¹è±¡ææçæ°ç»ã
 * @usage
 */
class ImageSearchParameter {
    constructor(options) {
        /**
         * @description æå®æ¥è¯¢èå´ãåªæå·æå ä½å¯¹è±¡ï¼geometryï¼å±æ§çFeaturesï¼å¹¶ä¸è¯¥å ä½å¯¹è±¡ä¸è¯¥åæ°æå®çèå´ç¸äº¤ç Features æä¼è¢«éæ©åºæ¥ã è¯¥åæ°å¯ä»¥åå«4ä¸ªæ°å¼æè6ä¸ªæ°å¼ï¼è¿åå³äºä½¿ç¨çåæ åèç³»ç»æ¯å¦åå«é«ç¨å¼ï¼  * å·¦ä¸è§åæ è½´ 1 çå¼ * å·¦ä¸è§åæ è½´ 2 çå¼ * åæ è½´ 3 çæå°å¼ï¼å¯éï¼ * å³ä¸è§åæ è½´ 1 çå¼ * å³ä¸è§åæ è½´ 2 çå¼ * åæ è½´ 3 çæå¤§å¼ï¼å¯éï¼  åæ åèç³»ç»ä¸º WGS 84 ç»åº¦/çº¬åº¦ (http://www.opengis.net/def/crs/OGC/1.3/CRS84).  å¯¹äº âWGS 84 ç»åº¦/çº¬åº¦â åæ åèç³»ç»ï¼ è¯¥åæ°å¼çæ ¼å¼éå¸¸ä¸ºï¼æå°ç»åº¦,æå°çº¬åº¦,æå¤§ç»åº¦,æå¤§çº¬åº¦ã  å¦æåå«äºé«ç¨å¼ï¼è¯¥åæ°çæ ¼å¼ä¸ºï¼æå°ç»åº¦,æå°çº¬åº¦,æå°é«ç¨å¼,æå¤§ç»åº¦,æå¤§çº¬åº¦,æå¤§é«ç¨å¼ã  å¦æä¸ä¸ª Feature å·æå¤ä¸ªç©ºé´å ä½å¯¹è±¡ï¼geometryï¼å±æ§ï¼ ç±æå¡å¨å³å®æ¯å¦ä½¿ç¨åä¸çç©ºé´å ä½å¯¹è±¡å±æ§ï¼è¿æ¯ä½¿ç¨ææç¸å³çå ä½å¯¹è±¡ä½ä¸ºæç»çæ¥è¯¢ç©ºé´èå´ã
         * @member {Array.<number>} ImageSearchParameter.prototype.bbox
         */
        this.bbox = undefined;
        /**
         * @description å½±åéåçIDæ°ç»ï¼å°å¨è¯¥æå®çCollectionä¸­æç´¢Itemsã
         * @member {Array.<string>} ImageSearchParameter.prototype.collections
         */
        this.collections = undefined;
        /**
         * @description è¿åç Item ç ID å¼æ°ç»ã è®¾ç½®äºè¯¥åæ°ï¼ææå¶ä»è¿æ»¤å¨åæ°ï¼é¤äºnextålimitï¼å°è¢«å¿½ç¥ã
         * @member {Array.<string>} ImageSearchParameter.prototype.ids
         */
        this.ids = undefined;
        /**
         * @description åé¡µè¿åçæå¤§ç»ææ°ã æå°å¼ä¸º1æå¤§å¼ä¸º10000
         * @member {number} ImageSearchParameter.prototype.limit
         */
        this.limit = undefined;
        /**
         * @description éè¿âincludeâåâexcludeâå±æ§åå«æå®åªäºå­æ®µåå«å¨æ¥è¯¢ç»æç Feature æè¿°ä¸­ï¼åªäºéè¦æé¤ãè¿åç»æä¸­çstac_versionï¼idï¼bboxï¼assetsï¼linksï¼geometryï¼typeï¼propertiesè¿äºå­æ®µä¸ºå¿é¡»å­æ®µï¼è¥è¦è¿åç»æä¸­ä¸å«è¿ç§å­æ®µä¿¡æ¯ï¼éè¦æ¾ç¤ºå°è¿è¡æé¤è®¾ç½®ï¼å¦ï¼æé¤geometryåbboxå­æ®µï¼å¨POSTè¯·æ±ä¸­ï¼åéè¦å°è¿äºå­æ®µæ·»å å°âexcludeâå­æ®µä¸­ï¼ä¾å¦ï¼ "fields": { "exclude": ["geometry","bbox"] } } ãèå¯¹äºè¿åçâpropertiesâå¯¹è±¡ä¸­çæ©å±å­æ®µåå®¹ï¼å¯ä»¥å°å­æ®µåæ·»å å°âincludeâå­æ®µä¸­ï¼å¦ï¼ "fields": { "include": ["properties.SmFileName","properties.SmHighPS"] } } ï¼è¡¨ç¤ºproperties.SmFileNameåproperties.SmHighPS å±æ§é½åå«å¨æ¥è¯¢ç»æä¸­ã
         * @member {FieldsFilter} ImageSearchParameter.prototype.fields
         */
        this.fields = undefined;
        /**
         * @description å®ä¹æ¥è¯¢åªäºå±æ§ï¼æ¥è¯¢è¿ç®ç¬¦å°åºç¨äºè¿äºå±æ§ã
         * @member {Object} ImageSearchParameter.prototype.query
         */
        this.query = undefined;
        /**
         * @description ç±åå«å±æ§åç§°åæåºè§åçå¯¹è±¡ææçæ°ç»ã
         * @member {Array.<Sortby>} ImageSearchParameter.prototype.sortby
         */
        this.sortby = undefined;

        this.CLASS_NAME = 'SuperMap.ImageSearchParameter';
        Util.extend(this, options);
    }

    /**
     * @function ImageSearchParameter.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        var me = this;
        me.bbox = undefined;
        me.collections = undefined;
        me.ids = undefined;
        me.limit = undefined;
        me.fields = undefined;
        me.query = undefined;
        me.sortby = undefined;
    }

    /**
     * @function ImageSearchParameter.prototype.constructFromObject
     * @description ç®æ å¯¹è±¡æ°å¢è¯¥ç±»çå¯éåæ°ã
     * @param {Object} data è¦è½¬æ¢çæ°æ®.
     * @param {ImageSearchParameter} obj è¿åçæ¨¡å.
     * @return {ImageSearchParameter} è¿åç»æ
     */
    static constructFromObject(data, obj) {
        if (data) {
            obj = obj || new ImageSearchParameter();
            if (data.hasOwnProperty('bbox')) {
                obj.bbox = data.bbox;
            }
            if (data.hasOwnProperty('collections')) {
                obj.collections = data.collections;
            }
            if (data.hasOwnProperty('ids')) {
                obj.ids = data.ids;
            }
            if (data.hasOwnProperty('limit')) {
                obj.limit = data.limit;
            }
            if (data.hasOwnProperty('fields')) {
                obj.fields = (FieldsFilter.constructFromObject && FieldsFilter.constructFromObject(data.fields, {})) || data.fields;
            }
            if (data.hasOwnProperty('query')) {
                obj.query = data.query;
            }
            if (data.hasOwnProperty('sortby')) {
                obj.sortby = data.sortby;
                if (data.sortby) {
                    obj.sortby = data.sortby.map((item) => {
                        return (Sortby.constructFromObject && Sortby.constructFromObject(item, {})) || item;
                    });
                }
            }
        }
        return obj;
    }
}

;// CONCATENATED MODULE: ./src/common/iServer/ImageStretchOption.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class ImageStretchOption
 * @deprecatedclass SuperMap.ImageStretchOption
 * @classdesc å½±åæä¼¸ç±»ã
 * @category iServer Image
 * @param {Object} options - å¯éåæ°ã
 * @param {ImageStretchOption.StretchType} [options.stretchType] å½±åæä¼¸ç±»åãè¯¥å±æ§çå¼æä»¥ä¸å ç§æåµï¼NONEï¼æ æä¼¸ï¼GAUSSIANï¼é«æ¯æä¼¸ï¼PERCENTCLIPï¼ç¾åæ¯æªæ­æä¼¸ï¼MINIMUMMAXIMUMï¼æå¼æä¼¸ï¼STANDARDDEVIATIONï¼æ åå·®æä¼¸ã
 * @param {number} [options.stdevCoefficient] æ åå·®ç³»æ°ã
 * @param {number} [options.gaussianCoefficient] é«æ¯ç³»æ°ã
 * @param {boolean} [options.useMedianValue] é«æ¯æä¼¸æ¶ï¼æ¯å¦ä½¿ç¨ä¸­é´å¼ï¼è¥è¯¥å±æ§å¼ä¸ºtrueï¼è¡¨ç¤ºä½¿ç¨ä¸­é´å¼ï¼falseï¼è¡¨ç¤ºä½¿ç¨å¹³åå¼ã
 * @param {number} [options.minPercent] ä½¿ç¨ç¾åæ¯æªæ­æä¼¸æ¶ï¼æé¤å½±åç´æ¹å¾æä½å¼åºåçååï¼è¯¥åæ°å¼ä¸ºè¿é¨åååå æ»ååç¾åæ¯ã
 * @param {number} [options.maxPercent] ä½¿ç¨ç¾åæ¯æªæ­æä¼¸æ¶ï¼æé¤å½±åç´æ¹å¾æé«å¼åºåçååï¼è¯¥åæ°å¼ä¸ºè¿é¨åååå æ»ååç¾åæ¯ã
 * @usage
 */
class ImageStretchOption {
  constructor(options) {
    /**
     * @description å½±åæä¼¸ç±»åãè¯¥å±æ§çå¼æä»¥ä¸å ç§æåµï¼NONEï¼æ æä¼¸ï¼GAUSSIANï¼é«æ¯æä¼¸ï¼PERCENTCLIPï¼ç¾åæ¯æªæ­æä¼¸ï¼MINIMUMMAXIMUMï¼æå¼æä¼¸ï¼STANDARDDEVIATIONï¼æ åå·®æä¼¸ã
     * @member {ImageStretchOption.StretchType} ImageStretchOption.prototype.stretchType
     */
    this.stretchType = undefined;
    /**
     * @description æ åå·®ç³»æ°ã
     * @member {number} ImageStretchOption.prototype.stdevCoefficient
     */
    this.stdevCoefficient = undefined;
    /**
     * @description é«æ¯ç³»æ°ã
     * @member {number} ImageStretchOption.prototype.gaussianCoefficient
     */
    this.gaussianCoefficient = undefined;
    /**
     * @description é«æ¯æä¼¸æ¶ï¼æ¯å¦ä½¿ç¨ä¸­é´å¼ï¼è¥è¯¥å±æ§å¼ä¸ºtrueï¼è¡¨ç¤ºä½¿ç¨ä¸­é´å¼ï¼falseï¼è¡¨ç¤ºä½¿ç¨å¹³åå¼ã
     * @member {boolean} ImageStretchOption.prototype.useMedianValue
     */
    this.useMedianValue = undefined;
    /**
     * @description ä½¿ç¨ç¾åæ¯æªæ­æä¼¸æ¶ï¼æé¤å½±åç´æ¹å¾æä½å¼åºåçååï¼è¯¥åæ°å¼ä¸ºè¿é¨åååå æ»ååç¾åæ¯ã
     * @member {number} ImageStretchOption.prototype.minPercent
     */
    this.minPercent = undefined;
    /**
     * @description ä½¿ç¨ç¾åæ¯æªæ­æä¼¸æ¶ï¼æé¤å½±åç´æ¹å¾æé«å¼åºåçååï¼è¯¥åæ°å¼ä¸ºè¿é¨åååå æ»ååç¾åæ¯ã
     * @member {number} ImageStretchOption.prototype.maxPercent
     */
    this.maxPercent = undefined;

    this.CLASS_NAME = 'SuperMap.ImageStretchOption';
    Util.extend(this, options);
  }

  /**
   * @function ImageStretchOption.prototype.destroy
   * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
   */
  destroy() {
    var me = this;
    me.stretchType = undefined;
    me.stdevCoefficient = undefined;
    me.gaussianCoefficient = undefined;
    me.useMedianValue = undefined;
    me.minPercent = undefined;
    me.maxPercent = undefined;
  }

  /**
   * @function ImageStretchOption.prototype.constructFromObject
   * @description ç®æ å¯¹è±¡æ°å¢è¯¥ç±»çå¯éåæ°ã
   * @param {Object} data è¦è½¬æ¢çæ°æ®.
   * @param {ImageStretchOption} obj è¿åçæ¨¡å.
   * @return {ImageStretchOption} è¿åç»æ
   */
  static constructFromObject(data, obj) {
    if (data) {
      obj = obj || new ImageStretchOption();
      if (data.hasOwnProperty('stretchType')) {
        obj.stretchType = data.stretchType;
      }
      if (data.hasOwnProperty('stdevCoefficient')) {
        obj.stdevCoefficient = data.stdevCoefficient;
      }
      if (data.hasOwnProperty('gaussianCoefficient')) {
        obj.gaussianCoefficient = data.gaussianCoefficient;
      }
      if (data.hasOwnProperty('useMedianValue')) {
        obj.useMedianValue = data.useMedianValue;
      }
      if (data.hasOwnProperty('minPercent')) {
        obj.minPercent = data.minPercent;
      }
      if (data.hasOwnProperty('maxPercent')) {
        obj.maxPercent = data.maxPercent;
      }
    }
    return obj;
  }
}
/**
 * @enum StretchType
 * @description å½±åæä¼¸ç±»åæä¸¾ã
 * @memberOf ImageStretchOption
 * @readonly
 * @type {string}
 */
ImageStretchOption.StretchType = {
  NONE: 'NONE',
  GAUSSIAN: 'GAUSSIAN',
  PERCENTCLIP: 'PERCENTCLIP',
  MINIMUMMAXIMUM: 'MINIMUMMAXIMUM',
  STANDARDDEVIATION: 'STANDARDDEVIATION'
};

;// CONCATENATED MODULE: ./src/common/iServer/ImageRenderingRule.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class ImageRenderingRule
 * @deprecatedclass SuperMap.ImageRenderingRule
 * @classdesc å®ä¹è¯·æ±çå½±åå¦ä½è¿è¡æ¸²ææèå¤çï¼å¦ï¼å½±åçæä¼¸æ¾ç¤ºæ¹å¼ãé¢è²è¡¨ãæ³¢æ®µç»åä»¥ååºç¨æ æ ¼å½æ°è¿è¡å¿«éå¤çç­ã
 * @category iServer Image
 * @param {Object} options - å¯éåæ°ã
 * @param {ImageRenderingRule.DisplayMode} [options.displayMode] å½±åæ¾ç¤ºæ¨¡å¼ï¼å¶ä¸­ï¼Compositeè¡¨ç¤ºå¤æ³¢æ®µç»åæ¾ç¤ºï¼Stretchedè¡¨ç¤ºåæ³¢æ®µæä¼¸æ¾ç¤ºã
 * @param {string} [options.displayBands] å½±åæ¾ç¤ºçæ³¢æ®µæèæ³¢æ®µç»åãè¥å½±åçæ¾ç¤ºæ¨¡å¼ä¸ºSTRETCHEDï¼è¯¥å±æ§æå®ä¸ä¸ªæ³¢æ®µçç´¢å¼å·(æ³¢æ®µç´¢å¼å·ä»0å¼å§è®¡æ°)ï¼è¥å½±åçæ¾ç¤ºæ¨¡å¼ä¸ºCOMPOSITEï¼è¯¥å±æ§ä¸ºç»åçæ³¢æ®µç´¢å¼å·ï¼ä¾å¦ï¼å±æ§å¼3,2,1è¡¨ç¤ºéç¨4æ³¢æ®µã3æ³¢æ®µã2æ³¢æ®µåå«å¯¹åº RãGãBé¢è²ééè¿è¡ç»åæ¾ç¤ºã
 * @param {ImageStretchOption} [options.stretchOption] å½±åçæä¼¸åæ°ã
 * @param {ImageRenderingRule.InterpolationMode} [options.interpolationMode] å½±åæ¾ç¤ºæ¶ä½¿ç¨çæå¼ç®æ³ã
 * @param {Array.<string>} [options.colorScheme] å½±åæä¼¸æ¾ç¤ºçé¢è²æ¹æ¡ãé¢è²æ¹æ¡ä¸ºRGBAé¢è²æ°ç»ã RGBAæ¯ä»£è¡¨Redï¼çº¢è²ï¼Greenï¼ç»¿è²ï¼Blueï¼èè²ï¼åAlphaçè²å½©ç©ºé´ãAlphaå¼å¯ä»¥çç¥ä¸åï¼è¡¨ç¤ºå®å¨ä¸éæãAlphaééè¡¨ç¤ºä¸éæåº¦åæ°ï¼è¥è¯¥å¼ä¸º0è¡¨ç¤ºå®å¨éæã ä¾å¦ï¼"255,0,0","0,255,0","0,0,255" è¡¨ç¤ºç±çº¢è²ãç»¿è²ãèè²ä¸ç§é¢è²ææçè²å¸¦ã
 * @param {Array.<string>} [options.colorTable] å½±åçé¢è²è¡¨ãé¢è²è¡¨ä¸ºæ æ ¼å¼ä¸RGBAé¢è²å¼çå¯¹ç§è¡¨ã RGBAæ¯ä»£è¡¨Redï¼çº¢è²ï¼Greenï¼ç»¿è²ï¼Blueï¼èè²ï¼åAlphaçè²å½©ç©ºé´ãAlphaå¼å¯ä»¥çç¥ä¸åï¼è¡¨ç¤ºå®å¨ä¸éæãAlphaééè¡¨ç¤ºä¸éæåº¦åæ°ï¼è¥è¯¥å¼ä¸º0è¡¨ç¤ºå®å¨éæã ä»¥ä¸ç¤ºä¾è¡¨ç¤ºè¯¥é¢è²å¯¹ç§è¡¨ç±ä¸ç»ææï¼ç¬¬ä¸ç»é«ç¨å¼ä¸º500ï¼å¯¹åºçé¢è²ä¸ºçº¢è²ï¼ç¬¬äºç»é«ç¨å¼ä¸º700ï¼å¯¹åºçé¢è²ä¸ºç»¿è²ï¼ç¬¬ä¸ç»é«ç¨å¼ä¸º700ï¼å¯¹åºçé¢è²ä¸ºèè²ã ç¤ºä¾ï¼"500: 255,0,0", "700: 0,255,0" , "900: 0,0,255"
 * @param {number} [options.brightness] å½±åæ¾ç¤ºçäº®åº¦ãæ°å¼èå´ä¸º-100å°100ï¼å¢å äº®åº¦ä¸ºæ­£ï¼éä½äº®åº¦ä¸ºè´ã
 * @param {number} [options.contrast] å½±åæ¾ç¤ºçå¯¹æ¯åº¦ãæ°å¼èå´ä¸º-100å°100ï¼å¢å å¯¹æ¯åº¦ä¸ºæ­£ï¼éä½å¯¹æ¯åº¦ä¸ºè´ã
 * @param {string} [options.noData] å½±åçæ å¼ãå½±åä¸ºå¤æ³¢æ®µæ¶ï¼éè¿éå·åé R,G,B é¢è²ééå¯¹åºæ³¢æ®µçæ å¼ã
 * @param {string} [options.noDataColor] å½±åçæ å¼çæ¾ç¤ºé¢è²ï¼æ¯æRGBé¢è²ï¼ä¾å¦ï¼255,0,0ï¼çº¢è²ï¼ï¼é£ä¹æ å¼å°ä»¥æå®ççº¢è²æ¾ç¤ºã
 * @param {boolean} [options.noDataTransparent] æ å¼æ¯å¦éææ¾ç¤ºï¼trueè¡¨ç¤ºéææ¾ç¤ºæ å¼ï¼å¦åä¸ºfalseã
 * @param {string} [options.backgroundValue] å½±åçèæ¯å¼ãå½±åä¸ºå¤æ³¢æ®µæ¶ï¼éè¿éå·åé R,G,B é¢è²ééå¯¹åºæ³¢æ®µçèæ¯å¼ã
 * @param {string} [options.backgroundColor] æå®èæ¯å¼çé¢è²ãæ¯ææå®RGBé¢è²ï¼ä¾å¦ï¼255,0,0ï¼çº¢è²ï¼ï¼é£ä¹èæ¯å¼å°ä»¥æå®ççº¢è²æ¾ç¤ºã
 * @param {boolean} [options.backgroundTransparent] èæ¯å¼æ¯å¦éææ¾ç¤ºï¼trueè¡¨ç¤ºéææ¾ç¤ºèæ¯å¼ï¼å¦åä¸ºfalseã
 * @param {Array.<ImageGFHillShade|ImageGFSlope|ImageGFAspect|ImageGFOrtho>} [options.gridFunctions] æ æ ¼å½æ°é¾ã
 * @usage
 */
class ImageRenderingRule {
  constructor(options) {
    /**
     * @description å½±åæ¾ç¤ºæ¨¡å¼ï¼å¶ä¸­ï¼Compositeè¡¨ç¤ºå¤æ³¢æ®µç»åæ¾ç¤ºï¼Stretchedè¡¨ç¤ºåæ³¢æ®µæä¼¸æ¾ç¤ºã
     * @member {ImageRenderingRule.DisplayMode} ImageRenderingRule.prototype.displayMode
     */
    this.displayMode = undefined;
    /**
     * @description å½±åæ¾ç¤ºçæ³¢æ®µæèæ³¢æ®µç»åãè¯¥åæ°ä¸ºä¸ä¸ªæ°ç»ï¼æ°ç»åç´ ä¸ºæ³¢æ®µç´¢å¼å·ãè¥å½±åçæ¾ç¤ºæ¨¡å¼ä¸ºStretchedï¼è¯¥å±æ§æå®ä¸ä¸ªæ¾ç¤ºçæ³¢æ®µï¼è¥å½±åçæ¾ç¤ºæ¨¡å¼ä¸ºCompositeï¼è¯¥å±æ§ä¸ºç»åçæ³¢æ®µç´¢å¼å·ï¼ä¾å¦ï¼å±æ§å¼4,3,2è¡¨ç¤ºéç¨4æ³¢æ®µã3æ³¢æ®µã2æ³¢æ®µåå«å¯¹åº RãGãBé¢è²ééè¿è¡ç»åæ¾ç¤ºã
     * @member {string} ImageRenderingRule.prototype.displayBands
     */
    this.displayBands = undefined;
    /**
     * @description å½±åçæä¼¸åæ°ã
     * @member {ImageStretchOption} ImageRenderingRule.prototype.stretchOption
     */
    this.stretchOption = undefined;
    /**
     * @description å½±åæ¾ç¤ºæ¶ä½¿ç¨çæå¼ç®æ³ã
     * @member {ImageRenderingRule.InterpolationMode} ImageRenderingRule.prototype.interpolationMode
     */
    this.interpolationMode = undefined;
    /**
     * @description å½±åæä¼¸æ¾ç¤ºçé¢è²æ¹æ¡ãé¢è²æ¹æ¡ä¸ºRGBAé¢è²æ°ç»ã RGBAæ¯ä»£è¡¨Redï¼çº¢è²ï¼Greenï¼ç»¿è²ï¼Blueï¼èè²ï¼åAlphaçè²å½©ç©ºé´ãAlphaå¼å¯ä»¥çç¥ä¸åï¼è¡¨ç¤ºå®å¨ä¸éæãAlphaééè¡¨ç¤ºä¸éæåº¦åæ°ï¼è¥è¯¥å¼ä¸º0è¡¨ç¤ºå®å¨éæã ä¾å¦ï¼"255,0,0","0,255,0","0,0,255" è¡¨ç¤ºç±çº¢è²ãç»¿è²ãèè²ä¸ç§é¢è²ææçè²å¸¦ã
     * @member {Array.<string>} ImageRenderingRule.prototype.colorScheme
     */
    this.colorScheme = undefined;
    /**
     * @description å½±åçé¢è²è¡¨ãé¢è²è¡¨ä¸ºæ æ ¼å¼ä¸RGBAé¢è²å¼çå¯¹ç§è¡¨ã RGBAæ¯ä»£è¡¨Redï¼çº¢è²ï¼Greenï¼ç»¿è²ï¼Blueï¼èè²ï¼åAlphaçè²å½©ç©ºé´ãAlphaå¼å¯ä»¥çç¥ä¸åï¼è¡¨ç¤ºå®å¨ä¸éæãAlphaééè¡¨ç¤ºä¸éæåº¦åæ°ï¼è¥è¯¥å¼ä¸º0è¡¨ç¤ºå®å¨éæã ä»¥ä¸ç¤ºä¾è¡¨ç¤ºè¯¥é¢è²å¯¹ç§è¡¨ç±ä¸ç»ææï¼ç¬¬ä¸ç»é«ç¨å¼ä¸º500ï¼å¯¹åºçé¢è²ä¸ºçº¢è²ï¼ç¬¬äºç»é«ç¨å¼ä¸º700ï¼å¯¹åºçé¢è²ä¸ºç»¿è²ï¼ç¬¬ä¸ç»é«ç¨å¼ä¸º700ï¼å¯¹åºçé¢è²ä¸ºèè²ã ç¤ºä¾ï¼"500: 255,0,0", "700: 0,255,0" , "900: 0,0,255"
     * @member {Array.<string>} ImageRenderingRule.prototype.colorTable
     */
    this.colorTable = undefined;
    /**
     * @description å½±åæ¾ç¤ºçäº®åº¦ãæ°å¼èå´ä¸º-100å°100ï¼å¢å äº®åº¦ä¸ºæ­£ï¼éä½äº®åº¦ä¸ºè´ã
     * @member {number} ImageRenderingRule.prototype.brightness
     */
    this.brightness = undefined;
    /**
     * @description å½±åæ¾ç¤ºçå¯¹æ¯åº¦ãæ°å¼èå´ä¸º-100å°100ï¼å¢å å¯¹æ¯åº¦ä¸ºæ­£ï¼éä½å¯¹æ¯åº¦ä¸ºè´ã
     * @member {number} ImageRenderingRule.prototype.contrast
     */
    this.contrast = undefined;
    /**
     * @description å½±åçæ å¼ãå½±åä¸ºå¤æ³¢æ®µæ¶ï¼éè¿éå·åé R,G,B é¢è²ééå¯¹åºæ³¢æ®µçæ å¼ã
     * @member {string} ImageRenderingRule.prototype.noData
     */
    this.noData = undefined;
    /**
     * @description å½±åçæ å¼çæ¾ç¤ºé¢è²ï¼æ¯æRGBé¢è²ï¼ä¾å¦ï¼255,0,0ï¼çº¢è²ï¼ï¼é£ä¹æ å¼å°ä»¥æå®ççº¢è²æ¾ç¤ºã
     * @member {string} ImageRenderingRule.prototype.noDataColor
     */
    this.noDataColor = undefined;
    /**
     * @description æ å¼æ¯å¦éææ¾ç¤ºï¼trueè¡¨ç¤ºéææ¾ç¤ºæ å¼ï¼å¦åä¸ºfalseã
     * @member {boolean} ImageRenderingRule.prototype.noDataTransparent
     */
    this.noDataTransparent = undefined;

    /**
     * @description å½±åçèæ¯å¼ãå½±åä¸ºå¤æ³¢æ®µæ¶ï¼éè¿éå·åé R,G,B é¢è²ééå¯¹åºæ³¢æ®µçèæ¯å¼ã
     * @member {string} ImageRenderingRule.prototype.backgroundValue
     */
    this.backgroundValue = undefined;
    /**
     * @description æå®èæ¯å¼çé¢è²ãæ¯ææå®RGBé¢è²ï¼ä¾å¦ï¼255,0,0ï¼çº¢è²ï¼ï¼é£ä¹èæ¯å¼å°ä»¥æå®ççº¢è²æ¾ç¤ºã
     * @member {string} ImageRenderingRule.prototype.backgroundColor
     */
    this.backgroundColor = undefined;
    /**
     * @description èæ¯å¼æ¯å¦éææ¾ç¤ºï¼trueè¡¨ç¤ºéææ¾ç¤ºèæ¯å¼ï¼å¦åä¸ºfalseã
     * @member {boolean} ImageRenderingRule.prototype.backgroundTransparent
     */
    this.backgroundTransparent = undefined;
    /**
     * @description æ æ ¼å½æ°éé¡¹ï¼éè¿åºç¨æ æ ¼å½æ°ï¼å¯ä»¥å¯¹å½±åè¿è¡å¿«éæ¾ç¤ºå¤çã
     * @member {Array.<ImageGFHillShade|ImageGFSlope|ImageGFAspect|ImageGFOrtho>} ImageRenderingRule.prototype.gridFunctions
     */
    this.gridFunctions = undefined;

    this.CLASS_NAME = 'SuperMap.ImageRenderingRule';
    Util.extend(this, options);
  }

  /**
   * @function ImageRenderingRule.prototype.destroy
   * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
   */
  destroy() {
    var me = this;
    me.displayMode = undefined;
    me.displayBands = undefined;
    me.stretchOption = undefined;
    me.interpolationMode = undefined;
    me.colorScheme = undefined;
    me.colorTable = undefined;
    me.brightness = undefined;
    me.contrast = undefined;
    me.noData = undefined;
    me.noDataColor = undefined;
    me.noDataTransparent = undefined;
    me.backgroundValue = undefined;
    me.backgroundColor = undefined;
    me.backgroundTransparent = undefined;
    me.gridFuncOptions = undefined;
  }

  /**
   * @function ImageRenderingRule.prototype.constructFromObject
   * @description ç®æ å¯¹è±¡æ°å¢è¯¥ç±»çå¯éåæ°ã
   * @param {Object} data è¦è½¬æ¢çæ°æ®.
   * @param {ImageRenderingRule} obj è¿åçæ¨¡å.
   * @return {ImageRenderingRule} è¿åç»æ
   */
  static constructFromObject(data, obj) {
    if (data) {
      obj = obj || new ImageRenderingRule();
      if (data.hasOwnProperty('displayMode')) {
        obj.displayMode = data.displayMode;
      }
      if (data.hasOwnProperty('displayBands')) {
        obj.displayBands = data.displayBands;
      }
      if (data.hasOwnProperty('stretchOption')) {
        obj.stretchOption =
          (ImageStretchOption.constructFromObject && ImageStretchOption.constructFromObject(data.stretchOption, {})) ||
          data.stretchOption;
      }
      if (data.hasOwnProperty('interpolationMode')) {
        obj.interpolationMode = data.interpolationMode;
      }
      if (data.hasOwnProperty('colorScheme')) {
        obj.colorScheme = data.colorScheme;
      }
      if (data.hasOwnProperty('colorTable')) {
        obj.colorTable = data.colorTable;
      }
      if (data.hasOwnProperty('brightness')) {
        obj.brightness = data.brightness;
      }
      if (data.hasOwnProperty('contrast')) {
        obj.contrast = data.contrast;
      }
      if (data.hasOwnProperty('noData')) {
        obj.noData = data.noData;
      }
      if (data.hasOwnProperty('noDataColor')) {
        obj.noDataColor = data.noDataColor;
      }
      if (data.hasOwnProperty('backgroundValue')) {
        obj.backgroundValue = data.backgroundValue;
      }
      if (data.hasOwnProperty('noDataTransparent')) {
        obj.noDataTransparent = data.noDataTransparent;
      }
      if (data.hasOwnProperty('backgroundColor')) {
        obj.backgroundColor = data.backgroundColor;
      }
      if (data.hasOwnProperty('backgroundTransparent')) {
        obj.backgroundTransparent = data.backgroundTransparent;
      }
      if (data.hasOwnProperty('gridFunctions')) {
        obj.gridFunctions = data.gridFunctions;
      }
    }
    return obj;
  }
}

/**
 * @enum DisplayMode
 * @description å½±åæ¾ç¤ºæ¨¡å¼ã
 * @memberOf ImageRenderingRule
 * @readonly
 * @type {string}
 */
ImageRenderingRule.DisplayMode = {
  COMPOSITE: 'COMPOSITE',
  STRETCHED: 'Stretched'
};

/**
 * @enum InterpolationMode
 * @description å½±åæ¾ç¤ºæ¶ä½¿ç¨çæå¼ç®æ³æä¸¾ã
 * @memberOf ImageRenderingRule
 * @readonly
 * @type {string}
 */
ImageRenderingRule.InterpolationMode = {
  NEARESTNEIGHBOR: 'NEARESTNEIGHBOR',
  HIGHQUALITYBILINEAR: 'HIGHQUALITYBILINEAR',
  DEFAULT: 'DEFAULT'
};

;// CONCATENATED MODULE: ./src/common/iServer/ImageGFHillShade.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class ImageGFHillShade
 * @deprecatedclass SuperMap.ImageGFHillShade
 * @classdesc æ æ ¼å½æ°å¯¹è±¡:å¯¹DEMæ°æ®çæä¸ç»´ææ¸²å¾ã
 * @category iServer Image
 * @param {Object} options - å¯éåæ°ã
 * @param {string} [options.girdFuncName='GFHillShade'] æ æ ¼å½æ°åç§°ï¼åæ°å¼ä¸ºï¼GFHillShadeã
 * @param {number} [options.Azimuth = 315] åæºæ¹ä½è§ãç¨äºç¡®å®åæºçæ¹åï¼æ¯ä»åæºæå¨ä½ç½®çæ­£åæ¹åçº¿èµ·ï¼ä¾é¡ºæ¶éæ¹åå°åæºä¸ç®æ æ¹åçº¿çå¤¹è§ï¼èå´ä¸º 0-360 åº¦ï¼ä»¥æ­£åæ¹åä¸º 0 åº¦ï¼ä¾é¡ºæ¶éæ¹åéå¢ãé»è®¤å¼ä¸ºï¼315ã
 * @param {number} [options.Altitude = 45] åæºé«åº¦è§ãç¨äºç¡®å®åæºç§å°çå¾æè§åº¦ï¼æ¯åæºä¸ç®æ çæ¹åçº¿ä¸æ°´å¹³é¢é´çå¤¹è§ï¼èå´ä¸º 0-90 åº¦ãå½åæºé«åº¦è§ä¸º 90 åº¦æ¶ï¼åæºæ­£å°å°è¡¨ãé»è®¤å¼ä¸ºï¼45ã
 * @param {number} [options.ZFactor = 1] é«ç¨ç¼©æ¾ç³»æ°ãå¦æè®¾ç½®ä¸º 1.0ï¼è¡¨ç¤ºä¸ç¼©æ¾ãé»è®¤å¼ä¸ºï¼1ã
 * @usage
*/
class ImageGFHillShade {
  constructor(options) {
    /**
    * @description æ æ ¼å½æ°åç§°ï¼åæ°å¼ä¸ºï¼GFHillShadeã
    * @member {string} ImageGFHillShade.prototype.girdFuncName
    * @default 'GFHillShade'
    */
    this.girdFuncName = 'GFHillShade';
    /**
    * @description åæºæ¹ä½è§ãç¨äºç¡®å®åæºçæ¹åï¼æ¯ä»åæºæå¨ä½ç½®çæ­£åæ¹åçº¿èµ·ï¼ä¾é¡ºæ¶éæ¹åå°åæºä¸ç®æ æ¹åçº¿çå¤¹è§ï¼èå´ä¸º 0-360 åº¦ï¼ä»¥æ­£åæ¹åä¸º 0 åº¦ï¼ä¾é¡ºæ¶éæ¹åéå¢ãé»è®¤å¼ä¸ºï¼315ã
    * @member {number} ImageGFHillShade.prototype.Azimuth
    */
    this.Azimuth = 315;
    /**
    * @description åæºé«åº¦è§ãç¨äºç¡®å®åæºç§å°çå¾æè§åº¦ï¼æ¯åæºä¸ç®æ çæ¹åçº¿ä¸æ°´å¹³é¢é´çå¤¹è§ï¼èå´ä¸º 0-90 åº¦ãå½åæºé«åº¦è§ä¸º 90 åº¦æ¶ï¼åæºæ­£å°å°è¡¨ãé»è®¤å¼ä¸ºï¼45ã
    * @member {number} ImageGFHillShade.prototype.Altitude
    */
    this.Altitude = 45;
    /**
    * @description é«ç¨ç¼©æ¾ç³»æ°ãå¦æè®¾ç½®ä¸º 1.0ï¼è¡¨ç¤ºä¸ç¼©æ¾ãé»è®¤å¼ä¸ºï¼1ã
    * @member {number} ImageGFHillShade.prototype.ZFactor
    */
    this.ZFactor = 1;

    this.CLASS_NAME = 'SuperMap.ImageGFHillShade';
    Util.extend(this, options);

  }

  /**
  * @function ImageGFHillShade.prototype.destroy
  * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
  */
  destroy() {
    var me = this;
    me.girdFuncName = 'GFHillShade';
    me.Azimuth = 315;
    me.Altitude = 45;
    me.ZFactor = 1;
  }

  /**
  * @function ImageGFHillShade.prototype.constructFromObject
  * @description ç®æ å¯¹è±¡æ°å¢è¯¥ç±»çå¯éåæ°ã
  * @param {Object} data è¦è½¬æ¢çæ°æ®.
  * @param {ImageGFHillShade} obj è¿åçæ¨¡å.
  * @return {ImageGFHillShade} è¿åç»æ
  */
  static constructFromObject(data, obj) {
    if (data) {
      obj = obj || new ImageGFHillShade();
      if (data.hasOwnProperty('girdFuncName')) {
          obj.girdFuncName = data.girdFuncName
      }
      if (data.hasOwnProperty('Azimuth')) {
          obj.Azimuth = data.Azimuth
      }
      if (data.hasOwnProperty('Altitude')) {
          obj.Altitude = data.Altitude
      }
      if (data.hasOwnProperty('ZFactor')) {
          obj.ZFactor = data.ZFactor
      }
    }
    return obj;
  }
}





;// CONCATENATED MODULE: ./src/common/iServer/ImageGFAspect.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class ImageGFAspect
 * @deprecatedclass SuperMap.ImageGFAspect
 * @classdesc æ æ ¼å½æ°å¯¹è±¡:å¯¹DEMæ°æ®çæå¡åæ¸²å¾ã
 * @category iServer Image
 * @param {Object} options -å¯éåæ°ã
 * @param {string} [options.girdFuncName='GFAspect'] æ æ ¼å½æ°åç§°ï¼åæ°å¼ä¸ºï¼GFAspectã
 * @param {number} [options.Azimuth] åæºæ¹ä½è§ï¼åºå®ä¸º360åº¦ã
 * @usage
*/
class ImageGFAspect {
  constructor(options) {
    /**
    * @description æ æ ¼å½æ°åç§°ï¼åæ°å¼ä¸ºï¼GFAspectã
    * @member {string} ImageGFAspect.prototype.girdFuncName
    * @default 'GFAspect'
    */
    this.girdFuncName = 'GFAspect';
    /**
    * @description åæºæ¹ä½è§ï¼åºå®ä¸º360åº¦ã
    * @member {number} ImageGFAspect.prototype.Azimuth
    */
    this.Azimuth = undefined;

    this.CLASS_NAME = 'SuperMap.ImageGFAspect';
    Util.extend(this, options);

  }

  /**
  * @function ImageGFAspect.prototype.destroy
  * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
  */
  destroy() {
    var me = this;
    me.girdFuncName = 'GFAspect';
    me.Azimuth = undefined;
  }

  /**
  * @function ImageGFAspect.prototype.constructFromObject
  * @description ç®æ å¯¹è±¡æ°å¢è¯¥ç±»çå¯éåæ°ã
  * @param {Object} data è¦è½¬æ¢çæ°æ®.
  * @param {ImageGFAspect} obj è¿åçæ¨¡å.
  * @return {ImageGFAspect} è¿åç»æ
  */
  static constructFromObject(data, obj) {
    if (data) {
      obj = obj || new ImageGFAspect();
      if (data.hasOwnProperty('girdFuncName')) {
          obj.girdFuncName = data.girdFuncName
      }
      if (data.hasOwnProperty('Azimuth')) {
          obj.Azimuth = data.Azimuth
      }
    }
    return obj;
  }
}





;// CONCATENATED MODULE: ./src/common/iServer/ImageGFOrtho.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class ImageGFOrtho
 * @deprecatedclass SuperMap.ImageGFOrtho
 * @classdesc æ æ ¼å½æ°å¯¹è±¡:å¯¹DEMæ°æ®çæä¸ç»´ææ¸²å¾ãè¯¥æ æ ¼å½æ°ä¸éè¦è¾å¥åæ°ï¼éç¨ç³»ç»é»è®¤è®¾ç½®ã
 * @category iServer Image
 * @param {Object} options - å¯éåæ°ã
 * @param {string} [options.girdFuncName='GFOrtho'] æ æ ¼å½æ°åç§°ï¼åæ°å¼ä¸ºï¼GFOrthoã
 * @usage
*/
class ImageGFOrtho {
  constructor(options) {
    /**
    * @description æ æ ¼å½æ°åç§°ï¼åæ°å¼ä¸ºï¼GFOrthoã
    * @member {string} ImageGFOrtho.prototype.girdFuncName
    * @default 'GFOrtho'
    */
    this.girdFuncName = 'GFOrtho';

    this.CLASS_NAME = 'SuperMap.ImageGFOrtho';
    Util.extend(this, options);

  }

  /**
  * @function ImageGFOrtho.prototype.destroy
  * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
  */
  destroy() {
    var me = this;
    me.girdFuncName = 'GFOrtho';
  }

  /**
  * @function ImageGFOrtho.prototype.constructFromObject
  * @description ç®æ å¯¹è±¡æ°å¢è¯¥ç±»çå¯éåæ°ã
  * @param {Object} data è¦è½¬æ¢çæ°æ®.
  * @param {ImageGFOrtho} obj è¿åçæ¨¡å.
  * @return {ImageGFOrtho} è¿åç»æ
  */
  static constructFromObject(data, obj) {
    if (data) {
      obj = obj || new ImageGFOrtho();
      if (data.hasOwnProperty('girdFuncName')) {
          obj.girdFuncName = data.girdFuncName
      }
    }
    return obj;
  }
}



;// CONCATENATED MODULE: ./src/common/iServer/ImageGFSlope.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class ImageGFSlope
 * @deprecatedclass SuperMap.ImageGFSlope
 * @classdesc æ æ ¼å½æ°å¯¹è±¡:å¯¹DEMæ°æ®çæå¡åº¦å¾ã
 * @category iServer Image
 * @param {Object} options - å¯éåæ°ã
 * @param {string} [options.girdFuncName='GFSlope'] æ æ ¼å½æ°åç§°ï¼åæ°å¼ä¸ºï¼GFSlopeã
 * @param {number} [options.Altitude = 45] åæºé«åº¦è§ãç¨äºç¡®å®åæºç§å°çå¾æè§åº¦ï¼æ¯åæºä¸ç®æ çæ¹åçº¿ä¸æ°´å¹³é¢é´çå¤¹è§ï¼èå´ä¸º 0-90 åº¦ãå½åæºé«åº¦è§ä¸º 90 åº¦æ¶ï¼åæºæ­£å°å°è¡¨ãé»è®¤å¼ä¸ºï¼45ã
 * @param {number} [options.ZFactor = 1] é«ç¨ç¼©æ¾ç³»æ°ãå¦æè®¾ç½®ä¸º 1.0ï¼è¡¨ç¤ºä¸ç¼©æ¾ãé»è®¤å¼ä¸ºï¼1ã
 * @usage
*/
class ImageGFSlope {
  constructor(options) {
    /**
    * @description æ æ ¼å½æ°åç§°ï¼åæ°å¼ä¸ºï¼GFSlopeã
    * @member {string} ImageGFSlope.prototype.girdFuncName
    * @default 'GFSlope'
    */
    this.girdFuncName = 'GFSlope';
    /**
    * @description åæºé«åº¦è§ãç¨äºç¡®å®åæºç§å°çå¾æè§åº¦ï¼æ¯åæºä¸ç®æ çæ¹åçº¿ä¸æ°´å¹³é¢é´çå¤¹è§ï¼èå´ä¸º 0-90 åº¦ãå½åæºé«åº¦è§ä¸º 90 åº¦æ¶ï¼åæºæ­£å°å°è¡¨ãé»è®¤å¼ä¸ºï¼45ã
    * @member {number} ImageGFSlope.prototype.Altitude
    */
    this.Altitude = 45;
    /**
    * @description é«ç¨ç¼©æ¾ç³»æ°ãå¦æè®¾ç½®ä¸º 1.0ï¼è¡¨ç¤ºä¸ç¼©æ¾ãé»è®¤å¼ä¸ºï¼1ã
    * @member {number} ImageGFSlope.prototype.ZFactor
    */
    this.ZFactor = 1;

    this.CLASS_NAME = 'SuperMap.ImageGFSlope';
    Util.extend(this, options);

  }

  /**
  * @function ImageGFSlope.prototype.destroy
  * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
  */
  destroy() {
    var me = this;
    me.girdFuncName = 'GFSlope';
    me.Altitude = 45;
    me.ZFactor = 1;
  }

  /**
  * @function ImageGFSlope.prototype.constructFromObject
  * @description ç®æ å¯¹è±¡æ°å¢è¯¥ç±»çå¯éåæ°ã
  * @param {Object} data è¦è½¬æ¢çæ°æ®.
  * @param {ImageGFSlope} obj è¿åçæ¨¡å.
  * @return {ImageGFSlope} è¿åç»æ
  */
  static constructFromObject(data, obj) {
    if (data) {
      obj = obj || new ImageGFSlope();
      if (data.hasOwnProperty('girdFuncName')) {
          obj.girdFuncName = data.girdFuncName
      }
      if (data.hasOwnProperty('Altitude')) {
          obj.Altitude = data.Altitude
      }
      if (data.hasOwnProperty('ZFactor')) {
          obj.ZFactor = data.ZFactor
      }
    }
    return obj;
  }
}





;// CONCATENATED MODULE: ./src/common/iServer/index.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


















































































































































































































































































































































































































































































































;// CONCATENATED MODULE: ./src/common/online/OnlineResources.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/

/**
 * @enum ServiceStatus
 * @category BaseTypes Constant
 * @description æå¡åå¸ç¶æã
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.ServiceStatus.DOES_NOT_INVOLVE;
 *
 * </script>
 * // ES6 Import
 * import { ServiceStatus } from '{npm}';
 *
 * const result = ServiceStatus.DOES_NOT_INVOLVE;
 * ```
 */
var ServiceStatus = {
    /** ä¸æ¶åï¼ä¸å¯åå¸ã */
    DOES_NOT_INVOLVE: "DOES_NOT_INVOLVE",
    /** åå¸å¤±è´¥ã */
    PUBLISH_FAILED: "PUBLISH_FAILED",
    /** å·²åå¸ã */
    PUBLISHED: "PUBLISHED",
    /** æ­£å¨åå¸ã */
    PUBLISHING: "PUBLISHING",
    /** æªåå¸ã */
    UNPUBLISHED: "UNPUBLISHED",
    /** åæ¶æå¡å¤±è´¥ã */
    UNPUBLISHED_FAILED: "UNPUBLISHED_FAILED"
};


/**
 * @enum DataItemOrderBy
 * @category BaseTypes Constant
 * @description æ°æ®æåºå­æ®µã
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.DataItemOrderBy.FILENAME;
 *
 * </script>
 * // ES6 Import
 * import { DataItemOrderBy } from '{npm}';
 *
 * const result = DataItemOrderBy.FILENAME;
 * ```
 */
var DataItemOrderBy = {
    /** FILENAME */
    FILENAME: "FILENAME",
    /** ID */
    ID: "ID",
    /** LASTMODIFIEDTIME */
    LASTMODIFIEDTIME: "LASTMODIFIEDTIME",
    /** NICKNAME */
    NICKNAME: "NICKNAME",
    /** SERVICESTATUS */
    SERVICESTATUS: "SERVICESTATUS",
    /** SIZE */
    SIZE: "SIZE",
    /** STATUS */
    STATUS: "STATUS",
    /** TYPE */
    TYPE: "TYPE",
    /** UPDATETIME */
    UPDATETIME: "UPDATETIME",
    /** USERNAME */
    USERNAME: "USERNAME"
};

/**
 * @enum FilterField {number}
 * @category BaseTypes Constant
 * @description å³é®å­æ¥è¯¢æ¶çè¿æ»¤å­æ®µã
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.FilterField.LINKPAGE;
 *
 * </script>
 * // ES6 Import
 * import { FilterField } from '{npm}';
 *
 * const result = FilterField.LINKPAGE;
 * ```
 */
var FilterField = {
    /** LINKPAGE */
    LINKPAGE: "LINKPAGE",
    /** MAPTITLE */
    MAPTITLE: "MAPTITLE",
    /** NICKNAME */
    NICKNAME: "NICKNAME",
    /** RESTITLE */
    RESTITLE: "RESTITLE",
    /** USERNAME */
    USERNAME: "USERNAME"
};


;// CONCATENATED MODULE: ./src/common/online/OnlineServiceBase.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class OnlineServiceBase
 * @deprecatedclass SuperMap.OnlineServiceBase
 * @classdesc Online æå¡åºç±»ï¼ä½¿ç¨ key ä½ä¸ºæééå¶çç±»éè¦å®ç°æ­¤ç±»ï¼ã
 * @category iPortal/Online Core
 * @param {Object} options - å¯éåæ°ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class OnlineServiceBase {

    constructor(options) {
        options = options || {};
        Util.extend(this, options);
        this.CLASS_NAME = "SuperMap.OnlineServiceBase";
    }

    /**
     * @function OnlineServiceBase.prototype.request
     * @description è¯·æ± online æå¡
     * @param {string} [method='GET'] - è¯·æ±æ¹å¼, 'GET', 'PUT', 'POST', 'DELETE'ã
     * @param {string} url - æå¡å°åã
     * @param {Object} param - URL æ¥è¯¢åæ°ã
     * @param {Object} [requestOptions] - http è¯·æ±åæ°, æ¯å¦è¯·æ±å¤´ï¼è¶æ¶æ¶é´ç­ã
     * @returns {Promise}  åå«è¯·æ±ç»æç Promise å¯¹è±¡ã
     */
    request(method, url, param, requestOptions = {}) {
        url = SecurityManager.appendCredential(url);
        requestOptions['crossOrigin'] = this.options.crossOrigin;
        requestOptions['headers'] = this.options.headers;
        return FetchRequest.commit(method, url, param, requestOptions).then(function(response) {
            return response.json();
        });
    }


}


;// CONCATENATED MODULE: ./src/common/online/OnlineData.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class OnlineData
 * @deprecatedclass SuperMap.OnlineData
 * @classdesc Online myData æå¡ã
 * @category iPortal/Online Resources Data
 * @param {string} serviceRootUrl - æå¡å°åã
 * @param {Object} options - å¯éåæ°ã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 * @extends OnlineServiceBase
 */
class OnlineData extends OnlineServiceBase {

    //TODO ç®åå¹¶æ²¡æå¯¹æ¥æå¡æ¯æçæææä½ï¼æ¥åéè¦è¡¥åå®æ´
    constructor(serviceRootUrl, options) {
        super(serviceRootUrl);
        options = options || {};
        //MD5
        this.MD5 = null;
        //æä»¶ç±»åã
        this.type = null;
        //æ°æ®ä¸ä¼ èåç§°ã
        this.userName = null;
        //æä»¶åç§°ã
        this.fileName = null;
        //æä»¶å¤§å°ï¼åä½ä¸º B ã
        this.size = null;
        //æå¡åå¸ç¶æã
        this.serviceStatus = null;
        //æå¡ id ã
        this.serviceId = null;
        //æ°æ®é¡¹ id ã
        this.id = null;
        //æåä¿®æ¹æ¶é´ã
        this.lastModfiedTime = null;
        //æä»¶ç¶æã
        this.status = null;
        //æ°æ®æä»¶å­å¨ id ã
        this.storageId = null;
        //æ°æ®çåå¸ä¿¡æ¯ã
        this.publishInfo = null;
        //æ°æ®çæéä¿¡æ¯ã
        this.authorizeSetting = null;
        //ç¨æ·çæµç§°ã
        this.nickname = null;
        //æ°æ®çæ ç­¾ã
        this.tags = [];
        //æ°æ®çæè¿°ä¿¡æ¯ã
        this.description = null;
        //æ°æ®åå¸çæå¡ä¿¡æ¯éåã
        this.dataItemServices = null;
        //æ°æ®åæ ç±»åã
        this.coordType = null;
        //æ°æ®å®¡æ ¸ä¿¡æ¯
        this.dataCheckResult = null;
        //æ°æ®åæ°æ®ä¿¡æ¯
        this.dataMetaInfo = null;
        //æ°æ®çç¼©ç¥å¾è·¯å¾ã
        this.thumbnail = null;

        Util.extend(this, options);
        if (this.id) {
            this.serviceUrl = serviceRootUrl + "/" + this.id;
        }
        this.CLASS_NAME = "SuperMap.OnlineData";
    }

    /**
     * @function OnlineData.prototype.load
     * @description éè¿ URL è¯·æ±è·åè¯¥æå¡å®æ´ä¿¡æ¯ã
     * @returns {Promise} ä¸åå«è¯·æ±ç»æç Promise å¯¹è±¡,è¯·æ±è¿åç»æèªå¨å¡«åå°è¯¥ç±»å±æ§ä¸­ã
     */
    load() {
        if (!this.serviceUrl) {
            return;
        }
        var me = this;
        return me.request("GET", this.serviceUrl).then(function (result) {
            Util.extend(me, result);
        });
    }

    /**
     * @function OnlineData.prototype.getPublishedServices
     * @description è·åæ°æ®åå¸çæææå¡ã
     * @returns {Object} æ°æ®åå¸çæææå¡ã
     */
    getPublishedServices() {
        return this.dataItemServices;
    }

    /**
     * @function OnlineData.prototype.getAuthorizeSetting
     * @description è·åæ°æ®çæéä¿¡æ¯ã
     * @returns {Object} æéä¿¡æ¯ã
     */
    getAuthorizeSetting() {
        return this.authorizeSetting;
    }


}


;// CONCATENATED MODULE: ./src/common/online/Online.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class Online
 * @deprecatedclass SuperMap.Online
 * @classdesc å¯¹æ¥ SuperMap Online ææåºç¡æå¡ã
 * @category iPortal/Online Resources
 * @example
 * var online=new Online();
 * var services = online.queryDatas(param);
 * service.then(function(services){
 *      var service= services[0];
 *      service.updateDataInfo();
 * })
 * @usage
 */
class Online {

    //TODO ç®åå¹¶æ²¡æå¯¹æ¥Onlineçæææä½ï¼éè¦è¡¥åå®æ´
    //æææ¥è¯¢è¿åçæ¯ä¸ä¸ªPromise,å¨å¤é¨ä½¿ç¨çæ¶åéè¿Promiseçthenæ¹æ³è·åå¼æ­¥ç»æ
    constructor() {
        this.rootUrl = "https://www.supermapol.com";
        this.webUrl = this.rootUrl + "/web";

        var mContentUrl = this.webUrl + "/mycontent";
        this.mDatasUrl = mContentUrl + "/datas";

        this.CLASS_NAME = "SuperMap.Online";
    }

    /**
     * @function Online.prototype.load
     * @description å è½½ onlineï¼éªè¯ online æ¯å¦å¯ç¨ã
     * @returns {Promise} åå«ç½ç»è¯·æ±ç»æç Promise å¯¹è±¡ã
     */
    load() {
        return FetchRequest.get(this.rootUrl).then(function (response) {
            return response;
        });
    }

    /**
     * @function Online.prototype.login
     * @description ç»å½Online
     */
    login() {
        SecurityManager.loginOnline(this.rootUrl, true);
    }

    /**
     * @function Online.prototype.queryDatas
     * @description æ¥è¯¢ Online âæçåå®¹â ä¸ âæçæ°æ®â æå¡ï¼éè¦ç»å½ç¶æè·åï¼ï¼å¹¶è¿åå¯æä½çæå¡å¯¹è±¡ã
     * @param {OnlineQueryDatasParameter} parameter - myDatas æå¡èµæºæ¥è¯¢åæ°ã
     * @returns {Promise} åå«æææ°æ®æå¡ä¿¡æ¯ç Promise å¯¹è±¡ã
     */
    queryDatas(parameter) {
        var me = this, url = me.mDatasUrl;
        if (parameter) {
            parameter = parameter.toJSON();
        }
        return FetchRequest.get(url, parameter).then(function (json) {
            if (!json || !json.content || json.content.length < 1) {
                return;
            }
            var services = [], contents = json.content, len = contents.length;
            for (var i = 0; i < len; i++) {
                var content = contents[i];
                var service = new OnlineData(me.mDatasUrl, content);
                services.push(service);
            }
            return services;
        });
    }
}

;// CONCATENATED MODULE: ./src/common/online/OnlineQueryDatasParameter.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class OnlineQueryDatasParameter
 * @deprecatedclass SuperMap.OnlineQueryDatasParameter
 * @classdesc myDatas æå¡èµæºæ¥è¯¢åæ°ã
 * @category iPortal/Online Resources Data
 * @param {Object} options - åæ°ã
 * @usage
 */
class OnlineQueryDatasParameter {
    constructor(options) {
        options = options || {};

        /**
         * @member {Array.<string>} OnlineQueryDatasParameter.prototype.userNames
         * @description æ°æ®ä½èåãå¯ä»¥æ ¹æ®æ°æ®ä½èåæ¥è¯¢ï¼é»è®¤æ¥è¯¢å¨é¨ã
         */
        this.userNames = null;
        /**
         * @member {Array.<Object>} OnlineQueryDatasParameter.prototype.types
         * @description  æ°æ®ç±»åã
         */
        this.types = null;
        /**
         * @member {string} OnlineQueryDatasParameter.prototype.fileName
         * @description  æä»¶åç§°ã
         */
        this.fileName = null;
        /**
         * @member {string} OnlineQueryDatasParameter.prototype.serviceStatuses
         * @description  æå¡åå¸ç¶æã
         */
        this.serviceStatuses = null;
        /**
         * @member {string} OnlineQueryDatasParameter.prototype.serviceId
         * @description  æå¡ IDã
         */
        this.serviceId = null;
        /**
         * @member {Array.<number>} OnlineQueryDatasParameter.prototype.ids
         * @description  ç±æ°æ®é¡¹ ID ç»æçæ´åæ°ç»ã
         */
        this.ids = null;
        /**
         * @member {Array.<string>} OnlineQueryDatasParameter.prototype.keywords
         * @description å³é®å­ã
         */
        this.keywords = null;
        /**
         * @member {string} OnlineQueryDatasParameter.prototype.orderBy
         * @description æåºå­æ®µã
         */
        this.orderBy = null;
        /**
         * @member {Array.<string>} OnlineQueryDatasParameter.prototype.tags
         * @description æ°æ®çæ ç­¾ã
         */
        this.tags = null;
        /**
         * @member {Array.<string>} OnlineQueryDatasParameter.prototype.filterFields
         * @description ç¨äºå³é®å­æ¥è¯¢æ¶çè¿æ»¤å­æ®µã
         */
        this.filterFields = null;

        Util.extend(this, options)

        this.CLASS_NAME = "SuperMap.OnlineQueryDatasParameter";
    }


    /**
     * @function OnlineQueryDatasParameter.prototype.toJSON
     * @description è¿åå¯¹åºç JSON å¯¹è±¡ã
     * @returns {Object} å¯¹åºç JSON å¯¹è±¡ã
     */
    toJSON() {
        var me = this;
        var jsonObj = {
            "types": me.types,
            "fileName": me.fileName,
            "serviceStatuses": me.serviceStatuses,
            "serviceId": me.serviceId,
            "ids": me.ids,
            "keywords": me.keywords,
            "orderBy": me.orderBy,
            "tags": me.tags,
            "filterFields": me.filterFields
        };
        for (var key in jsonObj) {
            if (jsonObj[key] == null) {
                delete jsonObj[key]
            }
        }
        return jsonObj;
    }

}

;// CONCATENATED MODULE: ./src/common/online/index.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/












;// CONCATENATED MODULE: ./src/common/security/KeyServiceParameter.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class KeyServiceParameter
 * @deprecatedclass SuperMap.KeyServiceParameter
 * @classdesc keyç³è¯·åæ°
 * @category Security
 * @param {Object} options - åæ°ã
 * @param {string} options.name - ç³è¯·æå¡åç§°ã
 * @param {number} options.serviceIds - æå¡ IDã
 * @param {ClientType} [options.clientType=ClientType.SERVER] - æå¡ç«¯ç±»åã
 * @param {number} options.limitation - æææ
 * @usage
 */
class KeyServiceParameter {

    constructor(options) {
        this.name = null;
        this.serviceIds = null;
        this.clientType = ClientType.SERVER;
        this.limitation = null;
        Util.extend(this, options);
        this.CLASS_NAME = "SuperMap.KeyServiceParameter";
    }

    /**
     * @function KeyServiceParameter.prototype.toJSON
     * @description è½¬æ¢æ JSON å¯¹è±¡
     * @returns {Object} åæ°ç JSON å¯¹è±¡
     */
    toJSON() {
        return {
            name: this.name,
            serviceIds: this.serviceIds,
            clientType: this.clientType,
            limitation: this.limitation
        }
    }

}


;// CONCATENATED MODULE: ./src/common/security/ServerInfo.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class ServerInfo
 * @deprecatedclass SuperMap.ServerInfo
 * @classdesc æå¡å¨ä¿¡æ¯(å®å¨ç¸å³)ï¼åå«æå¡å¨ç±»åï¼æå¡å°åï¼tokenæå¡å°åç­
 * @category Security
 * @param {string} type - æå¡å¨ç±»å
 * @param {Object} options - åæ°ã
 * @param {string} options.server - æå¡å¨å°å,å¦ï¼http://supermapiserver:8090/iserver
 * @param {string} [options.tokenServiceUrl] - å¦ï¼http://supermapiserver:8090/iserver/services/security/tokens.json
 * @param {string} [options.keyServiceUrl] - å¦ï¼http://supermapiserver:8092/web/mycontent/keys/register.json
 * @usage
 */
class ServerInfo {
    constructor(type, options) {
        /**
         * @member {ServerType} ServerInfo.prototype.type
         * @description æå¡å¨ç±»å
         */
        this.type = type;

        /**
         * @member {string} ServerInfo.prototype.server
         * @description æå¡å¨å°å
         */
        this.server = null;

        /**
         * @member {string} [ServerInfo.prototype.tokenServiceUrl]
         * @description å¦ï¼http://supermapiserver:8090/iserver/services/security/tokens.json
         */
        this.tokenServiceUrl = null;

        /**
         * @member {string} [ServerInfo.prototype.keyServiceUrl]
         * @description å¦ï¼http://supermapiserver:8092/web/mycontent/keys/register.json
         */
        this.keyServiceUrl = null;

        Util.extend(this, options);

        this.CLASS_NAME = "SuperMap.ServerInfo";
        this.type = this.type || ServerType.ISERVER;
        if (!this.server) {
            console.error('server url require is not  undefined')
        }
        // var patten = /http:\/\/([^\/]+)/i;
        //this.server = this.server.match(patten)[0];

        var tokenServiceSuffix = "/services/security/tokens";
        if (this.type === ServerType.ISERVER && this.server.indexOf("iserver") < 0) {
            tokenServiceSuffix = "/iserver" + tokenServiceSuffix;
        }

        if (!this.tokenServiceUrl) {
            this.tokenServiceUrl = Util.urlPathAppend(this.server, tokenServiceSuffix);
        }

        if (!this.keyServiceUrl) {
            if (this.type === ServerType.IPORTAL) {
                this.keyServiceUrl = Util.urlPathAppend(this.server, "/web/mycontent/keys/register");
            } else if (this.type === ServerType.ONLINE) {
                this.keyServiceUrl = Util.urlPathAppend(this.server, "/web/mycontent/keys");
            }
        }
    }

}


;// CONCATENATED MODULE: ./src/common/security/TokenServiceParameter.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class TokenServiceParameter
 * @deprecatedclass SuperMap.TokenServiceParameter
 * @classdesc token ç³è¯·åæ°ã
 * @category Security
 * @param {Object} options - åæ°ã
 * @param {string} options.username - ç¨æ·åã
 * @param {string} options.password - å¯ç ã
 * @param {ClientType} [options.clientType='ClientType.NONE'] - token ç³è¯·çå®¢æ·ç«¯æ è¯ç±»åã
 * @param {string} [options.ip] - clientType=IP æ¶ï¼æ­¤ä¸ºå¿éåæ°ã
 * @param {string} [options.referer] -clientType=Referer æ¶ï¼æ­¤ä¸ºå¿éåæ°ãå¦ææç§æå® URL çæ¹å¼ç³è¯·ä»¤çï¼åè®¾ç½®ç¸åºç URLã
 * @param {number} [options.expiration=60] - ç³è¯·ä»¤ççæææ,ä»åå¸ä»¤ççæ¶é´å¼å§è®¡ç®,åä½ä¸ºåéã
 * @usage
 *
 */
class TokenServiceParameter {
    constructor(options) {
        /**
         * @member {string} TokenServiceParameter.prototype.userName
         * @description ç¨æ·åã
         */
        this.userName = null;

        /**
         * @member {string} TokenServiceParameter.prototype.password
         * @description å¯ç ã
         */
        this.password = null;

        /**
         * @member {ClientType} TokenServiceParameter.prototype.clientType
         * @description token ç³è¯·çå®¢æ·ç«¯æ è¯ç±»åã
         */
        this.clientType = ClientType.NONE;

        /**
         * @member {string} [TokenServiceParameter.prototype.ip]
         * @description clientType=IP æ¶ï¼æ­¤ä¸ºå¿éåæ°ã
         */

        this.ip = null;
        /**
         * @member {string} [TokenServiceParameter.prototype.referer]
         * @description clientType=Referer æ¶ï¼æ­¤ä¸ºå¿éåæ°ãå¦ææç§æå® URL çæ¹å¼ç³è¯·ä»¤çï¼åè®¾ç½®ç¸åºç URLã
         */
        this.referer = null;

        /**
         * @member {number} TokenServiceParameter.prototype.expiration
         * @description ç³è¯·ä»¤ççæææï¼ä»åå¸ä»¤ççæ¶é´å¼å§è®¡ç®ï¼åä½ä¸ºåéã
         */
        this.expiration = 60;

        Util.extend(this, options);

        this.CLASS_NAME = "SuperMap.TokenServiceParameter";
    }

    /**
     * @function TokenServiceParameter.prototype.toJSON
     * @description å°ææä¿¡æ¯è½¬æ JSON å­ç¬¦ä¸²
     * @returns {string} åæ°ç JSON å­ç¬¦ä¸²
     */
    toJSON() {
        return {
            userName: this.userName,
            password: this.password,
            clientType: this.clientType,
            ip: this.ip,
            referer: this.referer,
            expiration: this.expiration
        }
    }

}


;// CONCATENATED MODULE: ./src/common/security/index.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/









;// CONCATENATED MODULE: external "function(){try{return elasticsearch}catch(e){return {}}}()"
const external_function_try_return_elasticsearch_catch_e_return_namespaceObject = function(){try{return elasticsearch}catch(e){return {}}}();
var external_function_try_return_elasticsearch_catch_e_return_default = /*#__PURE__*/__webpack_require__.n(external_function_try_return_elasticsearch_catch_e_return_namespaceObject);
;// CONCATENATED MODULE: ./src/common/thirdparty/elasticsearch/ElasticSearch.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class ElasticSearch
 * @deprecatedclass SuperMap.ElasticSearch
 * @classdesc ElasticSearchæå¡ç±»ã
 * @category ElasticSearch
 * @param {string} url - ElasticSearchæå¡å°åã
 * @param {Object} options - åæ°ã
 * @param {function} [options.change] - æå¡å¨è¿åæ°æ®åæ§è¡çå½æ°ãåºå¼,ä¸å»ºè®®ä½¿ç¨ãä½¿ç¨searchæmsearchæ¹æ³ã
 * @param {boolean} [options.openGeoFence=false] - æ¯å¦å¼å¯å°çå´æ éªè¯ï¼é»è®¤ä¸ºä¸å¼å¯ã
 * @param {function} [options.outOfGeoFence] - æ°æ®è¶åºå°çå´æ åæ§è¡çå½æ°ã
 * @param {Object} [options.geoFence] - å°çå´æ ã
 * @usage
 */

class ElasticSearch {

    constructor(url, options) {
        options = options || {};
        /**
         *  @member {string} ElasticSearch.prototype.url
         *  @description ElasticSearchæå¡å°å
         */
        this.url = url;
        /**
         *  @member {Object} ElasticSearch.prototype.client
         *  @description client ESå®¢æ·ç«¯
         */
        this.client = new (external_function_try_return_elasticsearch_catch_e_return_default()).Client({
            host: this.url
        });
        /**
         *  @deprecated
         *  @member {function} [ElasticSearch.prototype.change]
         *  @description æå¡å¨è¿åæ°æ®åæ§è¡çå½æ°ãåºå¼,ä¸å»ºè®®ä½¿ç¨ãä½¿ç¨searchæmsearchæ¹æ³ã
         */
        this.change = null;
        /**
         *  @member {boolean} [ElasticSearch.prototype.openGeoFence=false]
         *  @description æ¯å¦å¼å¯å°çå´æ éªè¯ï¼é»è®¤ä¸ºä¸å¼å¯ã
         */
        this.openGeoFence = false;
        /**
         *  @member {function} [ElasticSearch.prototype.outOfGeoFence]
         *  @description æ°æ®è¶åºå°çå´æ åæ§è¡çå½æ°
         */
        this.outOfGeoFence = null;

        /**
         * @member {Object} [ElasticSearch.prototype.geoFence]
         * @description å°çå´æ 
         * @example {
     *    radius: 1000,//åä½æ¯m
     *    center: [104.40, 30.43],
     *    unit: 'meter|degree'
     *  }
         */
        this.geoFence = null;

        /*
         * Constant: EVENT_TYPES
         * {Array.<String>}
         * æ­¤ç±»æ¯æçäºä»¶ç±»åã
         *
         */
        this.EVENT_TYPES = ['change', 'error', 'outOfGeoFence'];

        /**
         * @member {Events} ElasticSearch.prototype.events
         * @description äºä»¶
         */
        this.events = new Events(this, null, this.EVENT_TYPES);

        /**
         * @member {Object} ElasticSearch.prototype.eventListeners
         * @description å¬å¨å¯¹è±¡ï¼å¨æé å½æ°ä¸­è®¾ç½®æ­¤åæ°ï¼å¯éï¼ï¼å¯¹ MapService æ¯æçä¸¤ä¸ªäºä»¶ processCompleted ãprocessFailed è¿è¡çå¬ï¼
         * ç¸å½äºè°ç¨ Events.on(eventListeners)ã
         */
        this.eventListeners = null;
        Util.extend(this, options);
        if (this.eventListeners instanceof Object) {
            this.events.on(this.eventListeners);
        }
    }

    /**
     * @function  ElasticSearch.prototype.setGeoFence
     * @description è®¾ç½®å°çå´æ ï¼openGeoFenceåæ°ä¸ºtrueçæ¶åï¼è®¾ç½®çå°çå´æ æçæã
     * @param {Geometry} geoFence - å°çå´æ ã
     */

    setGeoFence(geoFence) {
        this.geoFence = geoFence;
    }

    /**
     * @function  ElasticSearch.prototype.bulk
     * @description æ¹éæä½APIï¼åè®¸æ§è¡å¤ä¸ªç´¢å¼/å é¤æä½ã
     * åæ°è®¾ç½®åè {@link https://www.elastic.co/guide/en/elasticsearch/client/javascript-api/current/api-reference.html#api-bulk}</br>
     * æ´å¤ä¿¡æ¯åè {@link https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-bulk.html}</br>
     * @param {Object} params - åæ°ã
     * @param {function} callback - åè°å½æ°ã
     */
    bulk(params, callback) {
        return this.client.bulk(params, callback);
    }

    /**
     * @function  ElasticSearch.prototype.clearScroll
     * @description éè¿æå®scrollåæ°è¿è¡æ¥è¯¢æ¥æ¸é¤å·²ç»åå»ºçscrollè¯·æ±ã
     * åæ°è®¾ç½®åè {@link https://www.elastic.co/guide/en/elasticsearch/client/javascript-api/current/api-reference.html#api-clearscroll}</br>
     *æ´å¤ä¿¡æ¯åè {@link https://www.elastic.co/guide/en/elasticsearch/reference/current/search-request-scroll.html}</br>
     * @param {Object} params - åæ°ã
     * @param {function} callback - åè°å½æ°ã
     */
    clearScroll(params, callback) {
        return this.client.clearScroll(params, callback);
    }

    /**
     * @function  ElasticSearch.prototype.count
     * @description è·åéç¾¤ãç´¢å¼ãç±»åææ¥è¯¢çææ¡£ä¸ªæ°ã
     * åæ°è®¾ç½®åè {@link https://www.elastic.co/guide/en/elasticsearch/client/javascript-api/current/api-reference.html#api-count}</br>
     * æ´å¤ä¿¡æ¯åè {@link https://www.elastic.co/guide/en/elasticsearch/reference/current/search-count.html}</br>
     * @param {Object} params - åæ°ã
     * @param {function} callback - åè°å½æ°ã
     */
    count(params, callback) {
        return this.client.count(params, callback);
    }

    /**
     * @function  ElasticSearch.prototype.create
     * @description å¨ç¹å®ç´¢å¼ä¸­æ·»å ä¸ä¸ªç±»ååçJSONææ¡£ï¼ä½¿å¶å¯æç´¢ãå¦æå·æç¸åindexï¼typeä¸idå·²ç»å­å¨çææ¡£å°åçéè¯¯ã</br>
     * åæ°è®¾ç½®åè {@link https://www.elastic.co/guide/en/elasticsearch/client/javascript-api/current/api-reference.html#api-create}
     * æ´å¤ä¿¡æ¯åè {@link https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-index_.html}
     * @param {Object} params - åæ°ã
     * @param {function} callback - åè°å½æ°ã
     */
    create(params, callback) {
        return this.client.create(params, callback);
    }

    /**
     * @function  ElasticSearch.prototype.delete
     * @description æ ¹æ®å¶IDä»ç¹å®ç´¢å¼ä¸­å é¤é®å¥çJSONææ¡£ã
     * åæ°è®¾ç½®åè {@link https://www.elastic.co/guide/en/elasticsearch/client/javascript-api/current/api-reference.html#api-delete}</br>
     * æ´å¤ä¿¡æ¯åè {@link https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-delete.html}</br>
     * @param {Object} params - åæ°ã
     * @param {function} callback - åè°å½æ°ã
     */
    delete(params, callback) {
        return this.client.delete(params, callback);
    }

    /**
     * @function  ElasticSearch.prototype.deleteByQuery
     * @description æ ¹æ®å¶IDä»ç¹å®ç´¢å¼ä¸­å é¤é®å¥çJSONææ¡£ã
     * åæ°è®¾ç½®åè {@link https://www.elastic.co/guide/en/elasticsearch/client/javascript-api/current/api-reference.html#api-deletebyquery}</br>
     * æ´å¤ä¿¡æ¯åè {@link https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-delete-by-query.html}</br>
     * @param {Object} params - åæ°ã
     * @param {function} callback - åè°å½æ°ã
     */
    deleteByQuery(params, callback) {
        return this.client.deleteByQuery(params, callback);
    }

    /**
     * @function  ElasticSearch.prototype.deleteScript
     * @description æ ¹æ®å¶IDå é¤èæ¬ã</br>
     * åæ°è®¾ç½®åè {@link https://www.elastic.co/guide/en/elasticsearch/client/javascript-api/current/api-reference.html#api-deletescript}</br>
     * æ´å¤ä¿¡æ¯åè {@link https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-scripting.html}</br>
     * @param {Object} params - åæ°ã
     * @param {function} callback - åè°å½æ°ã
     */
    deleteScript(params, callback) {
        return this.client.deleteScript(params, callback);
    }

    /**
     * @function  ElasticSearch.prototype.deleteTemplate
     * @description æ ¹æ®å¶IDå é¤æ¨¡æ¿ã</br>
     * åæ°è®¾ç½®åè {@link https://www.elastic.co/guide/en/elasticsearch/client/javascript-api/current/api-reference.html#api-deletetemplate}</br>
     * æ´å¤ä¿¡æ¯åè {@link https://www.elastic.co/guide/en/elasticsearch/reference/current/search-template.html}</br>
     * @param {Object} params - åæ°ã
     * @param {function} callback - åè°å½æ°ã
     */
    deleteTemplate(params, callback) {
        return this.client.deleteTemplate(params, callback);
    }

    /**
     * @function  ElasticSearch.prototype.exists
     * @description æ£æ¥ç»å®ææ¡£æ¯å¦å­å¨ã</br>
     * åæ°è®¾ç½®åè {@link https://www.elastic.co/guide/en/elasticsearch/client/javascript-api/current/api-reference.html#api-exists}</br>
     * æ´å¤ä¿¡æ¯åè {@link https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-get.html}</br>
     * @param {Object} params - åæ°ã
     * @param {function} callback - åè°å½æ°ã
     */
    exists(params, callback) {
        return this.client.exists(params, callback);
    }

    /**
     * @function  ElasticSearch.prototype.existsSource
     * @description æ£æ¥èµæºæ¯å¦å­å¨ã</br>
     * åæ°è®¾ç½®åè {@link https://www.elastic.co/guide/en/elasticsearch/client/javascript-api/current/api-reference.html#api-existssource}</br>
     * æ´å¤ä¿¡æ¯åè {@link https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-get.html}</br>
     * @param {Object} params - åæ°ã
     * @param {function} callback - åè°å½æ°ã
     */

    existsSource(params, callback) {
        return this.client.existsSource(params, callback);
    }

    /**
     * @function  ElasticSearch.prototype.explain
     * @description æä¾ä¸ç¹å®æ¥è¯¢ç¸å³çç¹å®ææ¡£åæ°çè¯¦ç»ä¿¡æ¯ãå®è¿ä¼åè¯æ¨ææ¡£æ¯å¦ä¸æå®çæ¥è¯¢å¹éã</br>
     * åæ°è®¾ç½®åè {@link https://www.elastic.co/guide/en/elasticsearch/client/javascript-api/current/api-reference.html#api-explain}</br>
     * æ´å¤ä¿¡æ¯åè {@link https://www.elastic.co/guide/en/elasticsearch/reference/current/search-explain.html}</br>
     * @param {Object} params - åæ°ã
     * @param {function} callback - åè°å½æ°ã
     */
    explain(params, callback) {
        return this.client.explain(params, callback);
    }

    /**
     * @function  ElasticSearch.prototype.fieldCaps
     * @description åè®¸æ£ç´¢å¤ä¸ªç´¢å¼ä¹é´çå­æ®µçåè½ã(å®éªæ§APIï¼å¯è½ä¼å¨æªæ¥çæ¬ä¸­å é¤)</br>
     * åæ°è®¾ç½®åè {@link https://www.elastic.co/guide/en/elasticsearch/client/javascript-api/current/api-reference.html#api-fieldcaps}</br>
     * æ´å¤ä¿¡æ¯åè {@link https://www.elastic.co/guide/en/elasticsearch/reference/current/search-field-caps.html}</br>
     * @param {Object} params - åæ°ã
     * @param {function} callback - åè°å½æ°ã
     */
    fieldCaps(params, callback) {
        return this.client.fieldCaps(params, callback);
    }


    /**
     * @function  ElasticSearch.prototype.get
     * @description ä»ç´¢å¼è·åä¸ä¸ªåºäºå¶idçç±»åçJSONææ¡£ã</br>
     * åæ°è®¾ç½®åè {@link https://www.elastic.co/guide/en/elasticsearch/client/javascript-api/current/api-reference.html#api-get}</br>
     * æ´å¤ä¿¡æ¯åè {@link https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-get.html}</br>
     * @param {Object} params - åæ°ã
     * @param {function} callback - åè°å½æ°ã
     */
    get(params, callback) {
        return this.client.get(params, callback);
    }

    /**
     * @function  ElasticSearch.prototype.getScript
     * @description è·åèæ¬ã</br>
     * åæ°è®¾ç½®åè {@link https://www.elastic.co/guide/en/elasticsearch/client/javascript-api/current/api-reference.html#api-getscript}</br>
     * æ´å¤ä¿¡æ¯åè {@link https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-scripting.html}</br>
     * @param {Object} params - åæ°ã
     * @param {function} callback - åè°å½æ°ã
     */
    getScript(params, callback) {
        return this.client.getScript(params, callback);
    }

    /**
     * @function  ElasticSearch.prototype.getSource
     * @description éè¿ç´¢å¼ï¼ç±»ååIDè·åææ¡£çæºã</br>
     * åæ°è®¾ç½®åè {@link https://www.elastic.co/guide/en/elasticsearch/client/javascript-api/current/api-reference.html#api-getsource}</br>
     * æ´å¤ä¿¡æ¯åè {@link https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-get.html}</br>
     * @param {Object} params - åæ°ã
     * @param {function} callback - åè°å½æ°ã
     */
    getSource(params, callback) {
        return this.client.getSource(params, callback);
    }

    /**
     * @function  ElasticSearch.prototype.getTemplate
     * @description è·åæ¨¡æ¿ã</br>
     * åæ°è®¾ç½®åè {@link https://www.elastic.co/guide/en/elasticsearch/client/javascript-api/current/api-reference.html#api-gettemplate}</br>
     * æ´å¤ä¿¡æ¯åè {@link https://www.elastic.co/guide/en/elasticsearch/reference/current/search-template.html}</br>
     * @param {Object} params - åæ°ã
     * @param {function} callback - åè°å½æ°ã
     */
    getTemplate(params, callback) {
        return this.client.getTemplate(params, callback);
    }

    /**
     * @function  ElasticSearch.prototype.index
     * @description å¨ç´¢å¼ä¸­å­å¨ä¸ä¸ªé®å¥çJSONææ¡£ï¼ä½¿å¶å¯æç´¢ã</br>
     * åæ°è®¾ç½®åè {@link https://www.elastic.co/guide/en/elasticsearch/client/javascript-api/current/api-reference.html#api-index}</br>
     * æ´å¤ä¿¡æ¯åè {@link https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-index_.html}</br>
     * @param {Object} params - åæ°ã
     * @param {function} callback - åè°å½æ°ã
     */
    index(params, callback) {
        return this.client.index(params, callback);
    }

    /**
     * @function  ElasticSearch.prototype.info
     * @description ä»å½åéç¾¤è·ååºæ¬ä¿¡æ¯ã</br>
     * åæ°è®¾ç½®åè {@link https://www.elastic.co/guide/en/elasticsearch/client/javascript-api/current/api-reference.html#api-info}</br>
     * æ´å¤ä¿¡æ¯åè {@link https://www.elastic.co/guide/index.html}</br>
     * @param {Object} params - åæ°ã
     * @param {function} callback - åè°å½æ°ã
     */
    info(params, callback) {
        return this.client.info(params, callback);
    }

    /**
     * @function  ElasticSearch.prototype.mget
     * @description æ ¹æ®ç´¢å¼ï¼ç±»åï¼å¯éï¼åidsæ¥è·åå¤ä¸ªææ¡£ãmgetæéçä¸»ä½å¯ä»¥éç¨ä¸¤ç§å½¢å¼ï¼ææ¡£ä½ç½®æ°ç»æææ¡£IDæ°ç»ã</br>
     * åæ°è®¾ç½®åè {@link https://www.elastic.co/guide/en/elasticsearch/client/javascript-api/current/api-reference.html#api-mget}</br>
     * æ´å¤ä¿¡æ¯åè {@link https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-multi-get.html}</br>
     * @param {Object} params - åæ°ã
     * @param {function} callback - åè°å½æ°ã
     */
    mget(params, callback) {
        return this.client.mget(params, callback);
    }

    /**
     * @function  ElasticSearch.prototype.msearch
     * @description å¨åä¸è¯·æ±ä¸­æ§è¡å¤ä¸ªæç´¢è¯·æ±ã</br>
     * åæ°è®¾ç½®åè {@link https://www.elastic.co/guide/en/elasticsearch/client/javascript-api/current/api-reference.html#api-msearch}</br>
     * æ´å¤ä¿¡æ¯åè {@link https://www.elastic.co/guide/en/elasticsearch/reference/current/search-multi-search.html}</br>
     * @param {Object} params - åæ°ã
     * @param {function} callback - è¯·æ±è¿åçåè°å½æ°ãä¹å¯ä»¥ä½¿ç¨thenè¡¨è¾¾å¼è·åè¿åç»æã
     *     åè°åæ°ï¼error,responseãç»æå­å¨å¨response.responsesä¸­
     */
    msearch(params, callback) {
        let me = this;

        return me.client.msearch(params)
            .then(function (resp) {
                me._update(resp.responses, callback);
                return resp;
            }, function (err) {
                callback(err);
                me.events.triggerEvent('error', {error: err});
                return err;
            });
    }

    /**
     * @function  ElasticSearch.prototype.msearchTemplate
     * @description å¨åä¸è¯·æ±ä¸­æ§è¡å¤ä¸ªæç´¢æ¨¡æ¿è¯·æ±ã</br>
     * åæ°è®¾ç½®åè {@link https://www.elastic.co/guide/en/elasticsearch/client/javascript-api/current/api-reference.html#api-msearchtemplate}</br>
     * æ´å¤ä¿¡æ¯åè {@link https://www.elastic.co/guide/en/elasticsearch/reference/current/search-template.html}</br>
     * @param {Object} params - åæ°ã
     * @param {function} callback - åè°å½æ°ã
     */
    msearchTemplate(params, callback) {
        return this.client.msearchTemplate(params, callback);
    }

    /**
     * @function  ElasticSearch.prototype.mtermvectors
     * @description å¤termvectors APIåè®¸ä¸æ¬¡è·å¾å¤ä¸ªtermvectorsã</br>
     * åæ°è®¾ç½®åè {@link https://www.elastic.co/guide/en/elasticsearch/client/javascript-api/current/api-reference.html#api-mtermvectors}</br>
     * æ´å¤ä¿¡æ¯åè {@link https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-multi-termvectors.html}</br>
     * @param {Object} params - åæ°ã
     * @param {function} callback - åè°å½æ°ã
     */
    mtermvectors(params, callback) {
        return this.client.mtermvectors(params, callback);
    }

    /**
     * @function  ElasticSearch.prototype.ping
     * @description æµè¯è¿æ¥ã</br>
     * åæ°è®¾ç½®åè {@link https://www.elastic.co/guide/en/elasticsearch/client/javascript-api/current/api-reference.html#api-ping}</br>
     * æ´å¤ä¿¡æ¯åè {@link https://www.elastic.co/guide/index.html}</br>
     * @param {Object} params - åæ°ã
     * @param {function} callback - åè°å½æ°ã
     */
    ping(params, callback) {
        return this.client.ping(params, callback);
    }

    /**
     * @function  ElasticSearch.prototype.putScript
     * @description æ·»å èæ¬ã</br>
     * åæ°è®¾ç½®åè {@link https://www.elastic.co/guide/en/elasticsearch/client/javascript-api/current/api-reference.html#api-putscript}</br>
     * æ´å¤ä¿¡æ¯åè {@link https://www.elastic.co/guide/en/elasticsearch/reference/current/modules-scripting.html}</br>
     * @param {Object} params - åæ°ã
     * @param {function} callback - åè°å½æ°ã
     */
    putScript(params, callback) {
        return this.client.putScript(params, callback);
    }

    /**
     * @function  ElasticSearch.prototype.putTemplate
     * @description æ·»å æ¨¡æ¿ã</br>
     * åæ°è®¾ç½®åè {@link https://www.elastic.co/guide/en/elasticsearch/client/javascript-api/current/api-reference.html#api-puttemplate}</br>
     * æ´å¤ä¿¡æ¯åè {@link https://www.elastic.co/guide/en/elasticsearch/reference/current/search-template.html}</br>
     * @param {Object} params - åæ°ã
     * @param {function} callback - åè°å½æ°ã
     */
    putTemplate(params, callback) {
        return this.client.putTemplate(params, callback);
    }

    /**
     * @function  ElasticSearch.prototype.reindex
     * @description éæ°ç´¢å¼ã</br>
     * åæ°è®¾ç½®åè {@link https://www.elastic.co/guide/en/elasticsearch/client/javascript-api/current/api-reference.html#api-reindex}</br>
     * æ´å¤ä¿¡æ¯åè {@link https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-reindex.html}</br>
     * @param {Object} params - åæ°ã
     * @param {function} callback - åè°å½æ°ã
     */
    reindex(params, callback) {
        return this.client.reindex(params, callback);
    }

    /**
     * @function  ElasticSearch.prototype.reindexRessrottle
     * @description éæ°ç´¢å¼ã</br>
     * åæ°è®¾ç½®åè {@link https://www.elastic.co/guide/en/elasticsearch/client/javascript-api/current/api-reference.html#api-reindexrethrottle}</br>
     * æ´å¤ä¿¡æ¯åè {@link https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-reindex.html}</br>
     * @param {Object} params - åæ°ã
     * @param {function} callback - åè°å½æ°ã
     */
    reindexRessrottle(params, callback) {
        return this.client.reindexRessrottle(params, callback);
    }

    /**
     * @function  ElasticSearch.prototype.renderSearchTemplate
     * @description æç´¢æ¨¡æ¿ã</br>
     * åæ°è®¾ç½®åè {@link https://www.elastic.co/guide/en/elasticsearch/client/javascript-api/current/api-reference.html#api-rendersearchtemplate}</br>
     * æ´å¤ä¿¡æ¯åè {@link https://www.elastic.co/guide/en/elasticsearch/reference/current/search-template.html}</br>
     * @param {Object} params - åæ°ã
     * @param {function} callback - åè°å½æ°ã
     */
    renderSearchTemplate(params, callback) {
        return this.client.renderSearchTemplate(params, callback);
    }

    /**
     * @function  ElasticSearch.prototype.scroll
     * @description  å¨search()è°ç¨ä¸­æå®æ»å¨åæ°ä¹åï¼æ»å¨æç´¢è¯·æ±ï¼æ£ç´¢ä¸ä¸ç»ç»æï¼ã</br>
     * åæ°è®¾ç½®åè {@link https://www.elastic.co/guide/en/elasticsearch/client/javascript-api/current/api-reference.html#api-scroll}</br>
     * æ´å¤ä¿¡æ¯åè {@link https://www.elastic.co/guide/en/elasticsearch/reference/current/search-request-scroll.html}</br>
     * @param {Object} params - åæ°ã
     * @param {function} callback - åè°å½æ°ã
     */
    scroll(params, callback) {
        return this.client.scroll(params, callback);
    }

    /**
     * @function  ElasticSearch.prototype.search
     * @description  å¨search()è°ç¨ä¸­æå®æ»å¨åæ°ä¹åï¼æ»å¨æç´¢è¯·æ±ï¼æ£ç´¢ä¸ä¸ç»ç»æï¼ã
     * åæ°è®¾ç½®åè {@link https://www.elastic.co/guide/en/elasticsearch/client/javascript-api/current/api-reference.html#api-search}</br>
     * æ´å¤ä¿¡æ¯åè {@link https://www.elastic.co/guide/en/elasticsearch/reference/current/search-search.html}</br>
     * @param {Object} params - åæ°ã
     * @param {function} callback - è¯·æ±è¿åçåè°å½æ°ãä¹å¯ä»¥ä½¿ç¨thenè¡¨è¾¾å¼è·åè¿åç»æã
     *     åè°åæ°ï¼error,response,ç»æå­å¨å¨response.responsesä¸­
     */
    search(params, callback) {
        let me = this;
        return me.client.search(params)
            .then(function (resp) {
                me._update(resp.responses, callback);
                return resp;
            }, function (err) {
                callback && callback(err);
                me.events.triggerEvent('error', {error: err});
                return err;
            });
    }

    /**
     * @function  ElasticSearch.prototype.searchShards
     * @description  è¿åè¦æ§è¡æç´¢è¯·æ±çç´¢å¼ååçã
     * åæ°è®¾ç½®åè {@link https://www.elastic.co/guide/en/elasticsearch/client/javascript-api/current/api-reference.html#api-searchshards}</br>
     * æ´å¤ä¿¡æ¯åè {@link https://www.elastic.co/guide/en/elasticsearch/reference/current/search-shards.html}</br>
     * @param {Object} params - åæ°ã
     * @param {function} callback - åè°å½æ°ã
     */
    searchShards(params, callback) {
        return this.client.searchShards(params, callback);
    }

    /**
     * @function  ElasticSearch.prototype.searchTemplate
     * @description  æç´¢æ¨¡æ¿ã
     * åæ°è®¾ç½®åè {@link https://www.elastic.co/guide/en/elasticsearch/client/javascript-api/current/api-reference.html#api-searchtemplate}</br>
     * æ´å¤ä¿¡æ¯åè {@link https://www.elastic.co/guide/en/elasticsearch/reference/current/search-suggesters.html}</br>
     * @param {Object} params - åæ°ã
     * @param {function} callback - åè°å½æ°ã
     */
    searchTemplate(params, callback) {
        return this.client.searchTemplate(params, callback);
    }

    /**
     * @function  ElasticSearch.prototype.suggest
     * @description è¯¥å»ºè®®åè½éè¿ä½¿ç¨ç¹å®çå»ºè®®èï¼åºäºææä¾çææ¬æ¥å»ºè®®ç±»ä¼¼çæ¯è¯­ã
     * åæ°è®¾ç½®åè {@link https://www.elastic.co/guide/en/elasticsearch/client/javascript-api/current/api-reference.html#api-suggest}</br>
     * æ´å¤ä¿¡æ¯åè {@link https://www.elastic.co/guide/en/elasticsearch/reference/current/search-suggesters.html}</br>
     * @param {Object} params - åæ°ã
     * @param {function} callback - åè°å½æ°ã
     */
    suggest(params, callback) {
        return this.client.suggest(params, callback);
    }

    /**
     * @function  ElasticSearch.prototype.termvectors
     * @description è¿åæå³ç¹å®ææ¡£å­æ®µä¸­çæ¯è¯­çä¿¡æ¯åç»è®¡ä¿¡æ¯ã
     * åæ°è®¾ç½®åè {@link https://www.elastic.co/guide/en/elasticsearch/client/javascript-api/current/api-reference.html#api-termvectors}</br>
     * æ´å¤ä¿¡æ¯åè {@link https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-termvectors.html}</br>
     * @param {Object} params - åæ°ã
     * @param {function} callback - åè°å½æ°ã
     */
    termvectors(params, callback) {
        return this.client.termvectors(params, callback);
    }

    /**
     * @function  ElasticSearch.prototype.update
     * @description æ´æ°ææ¡£çé¨åã
     * åæ°è®¾ç½®åè {@link https://www.elastic.co/guide/en/elasticsearch/client/javascript-api/current/api-reference.html#api-update}</br>
     * æ´å¤ä¿¡æ¯åè {@link https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-update.html}</br>
     * @param {Object} params - åæ°ã
     * @param {function} callback - åè°å½æ°ã
     */
    update(params, callback) {
        return this.client.update(params, callback);
    }

    /**
     * @function  ElasticSearch.prototype.updateByQuery
     * @description éè¿æ¥è¯¢APIæ¥æ´æ°ææ¡£ã
     * åæ°è®¾ç½®åè {@link https://www.elastic.co/guide/en/elasticsearch/client/javascript-api/current/api-reference.html#api-updatebyquery}</br>
     * æ´å¤ä¿¡æ¯åè {@link https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-update-by-query.html}</br>
     * @param {Object} params - åæ°ã
     * @param {function} callback - åè°å½æ°ã
     */
    updateByQuery(params, callback) {
        return this.client.updateByQuery(params, callback);
    }

    _update(data, callback) {
        let me = this;
        if (!data) {
            return;
        }
        me.data = data;
        if (me.openGeoFence && me.geoFence) {
            me._validateDatas(data);
        }
        me.events.triggerEvent('change', {data: me.data});
        //changeæ¹æ³å·²åºå¼ï¼ä¸å»ºè®®ä½¿ç¨ãå»ºè®®ä½¿ç¨searchæ¹æ³çç¬¬äºä¸ªåæ°ä¼ å¥è¯·æ±æåçåè°
        if (me.change) {
            me.change && me.change(data);
        } else {
            //å responsesæ¯ä¸ºäºä¿æè·åæ¥esèªèº«çæ°æ®ç»æä¸è´
            callback && callback(undefined, {responses: data});
        }
    }

    _validateDatas(datas) {
        if (!datas) {
            return;
        }
        if (!(datas instanceof Array)) {
            datas = [datas];
        }
        var i, len = datas.length;
        for (i = 0; i < len; i++) {
            this._validateData(datas[i]);
        }
    }

    _validateData(data) {
        let me = this;
        data.hits.hits.map(function (source) {
            let content = source._source;
            let meterUnit = me._getMeterPerMapUnit(me.geoFence.unit);
            let geoFenceCX = me.geoFence.center[0] * meterUnit;
            let geoFenceCY = me.geoFence.center[1] * meterUnit;
            let contentX = content.x * meterUnit;
            let contentY = content.y * meterUnit;
            let distance = me._distance(contentX, contentY, geoFenceCX, geoFenceCY);
            let radius = me.geoFence.radius;
            if (distance > radius) {
                me.outOfGeoFence && me.outOfGeoFence(data);
                me.events.triggerEvent('outOfGeoFence', {data: data});
            }
            return source;
        });
    }

    _distance(x1, y1, x2, y2) {
        return Math.sqrt((x1 - x2) * (x1 - x2) + (y1 - y2) * (y1 - y2));
    }

    _getMeterPerMapUnit(mapUnit) {
        let earchRadiusInMeters = 6378137;
        let meterPerMapUnit;
        if (mapUnit === 'meter') {
            meterPerMapUnit = 1;
        } else if (mapUnit === 'degree') {
            // æ¯åº¦è¡¨ç¤ºå¤å°ç±³ã
            meterPerMapUnit = Math.PI * 2 * earchRadiusInMeters / 360;
        }
        return meterPerMapUnit;
    }

}


;// CONCATENATED MODULE: ./src/common/thirdparty/elasticsearch/index.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



;// CONCATENATED MODULE: ./src/common/thirdparty/index.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




;// CONCATENATED MODULE: ./src/common/overlay/levelRenderer/Util.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
/**
 * @private
 * @class  LevelRenderer.Tool.Util
 * @category Visualization Theme
 * LevelRenderer åºç¡å·¥å·ç±»
 *
 */
class Util_Util {
    constructor() {
        /**
         * @member {Object} LevelRenderer.Tool.Util.prototype.BUILTIN_OBJECT
         * @description ç¨äºå¤çmergeæ¶æ æ³éåDateç­å¯¹è±¡çé®é¢
         */
        this.BUILTIN_OBJECT = {
            '[object Function]': 1,
            '[object RegExp]': 1,
            '[object Date]': 1,
            '[object Error]': 1,
            '[object CanvasGradient]': 1
        };

        /**
         * @member {Object} LevelRenderer.Tool.Util.prototype._ctx
         */
        this._ctx = null;

        /**
         * Property: _canvas
         * {Object}
         */
        this._canvas = null;

        /**
         * Property: _pixelCtx
         * {Object}
         */
        this._pixelCtx = null;

        /**
         * Property: _width
         * {Object}
         */
        this._width = null;

        /**
         * Property: _height
         * {Object}
         */
        this._height = null;

        /**
         * Property: _offsetX
         * {Object}
         */
        this._offsetX = 0;

        /**
         * Property: _offsetY
         * {Object}
         */
        this._offsetY = 0;

        this.CLASS_NAME = "SuperMap.LevelRenderer.Tool.Util";

    }


    /**
     * @function LevelRenderer.Tool.Util.prototype.clone
     * @description å¯¹ä¸ä¸ªobjectè¿è¡æ·±åº¦æ·è´ã
     *
     * @param {Object} source - éè¦è¿è¡æ·è´çå¯¹è±¡ã
     * @return {Object} æ·è´åçæ°å¯¹è±¡ã
     */
    clone(source) {
        var BUILTIN_OBJECT = this.BUILTIN_OBJECT;
        if (typeof source == 'object' && source !== null) {
            var result = source;
            if (source instanceof Array) {
                result = [];
                for (var i = 0, len = source.length; i < len; i++) {
                    result[i] = this.clone(source[i]);
                }
            } else if (!BUILTIN_OBJECT[Object.prototype.toString.call(source)]) {
                result = {};
                for (var key in source) {
                    if (source.hasOwnProperty(key)) {
                        result[key] = this.clone(source[key]);
                    }
                }
            }

            return result;
        }

        return source;
    }


    /**
     * @function LevelRenderer.Tool.Util.prototype.mergeItem
     * @description åå¹¶æºå¯¹è±¡çåä¸ªå±æ§å°ç®æ å¯¹è±¡ã
     *
     * @param {Object} target - ç®æ å¯¹è±¡ã
     * @param {Object} source - æºå¯¹è±¡ã
     * @param {string} key - é®ã
     * @param {boolean} overwrite - æ¯å¦è¦çã
     * @return {Object} ç®æ å¯¹è±¡
     */
    mergeItem(target, source, key, overwrite) {
        var BUILTIN_OBJECT = this.BUILTIN_OBJECT;
        if (source.hasOwnProperty(key)) {
            if (typeof target[key] == 'object'
                && !BUILTIN_OBJECT[Object.prototype.toString.call(target[key])]
            ) {
                // å¦æéè¦éå½è¦çï¼å°±éå½è°ç¨merge
                this.merge(
                    target[key],
                    source[key],
                    overwrite
                );
            } else if (overwrite || !(key in target)) {
                // å¦ååªå¤çoverwriteä¸ºtrueï¼æèå¨ç®æ å¯¹è±¡ä¸­æ²¡ææ­¤å±æ§çæåµ
                target[key] = source[key];
            }
        }
    }


    /**
     * @function LevelRenderer.Tool.Util.prototype.merge
     * @description åå¹¶æºå¯¹è±¡çå±æ§å°ç®æ å¯¹è±¡ã
     *
     * @param {Object} target - ç®æ å¯¹è±¡ã
     * @param {Object} source - æºå¯¹è±¡ã
     * @param {boolean} overwrite - æ¯å¦è¦çã
     * @return {Object} ç®æ å¯¹è±¡ã
     */
    merge(target, source, overwrite) {
        for (var i in source) {
            this.mergeItem(target, source, i, overwrite);
        }

        return target;
    }


    /**
     * @function LevelRenderer.Tool.Util.prototype.getContext
     * @description è·å Canvas ä¸ä¸æã
     * @return {Object} ä¸ä¸æã
     */
    getContext() {
        if (!this._ctx) {
            this._ctx = document.createElement('canvas').getContext('2d');
        }
        return this._ctx;
    }


    /**
     * @function LevelRenderer.Tool.Util.prototype.getPixelContext
     * @description è·ååç´ æ¾åä¸ç¨çä¸ä¸æã
     * @return {Object} åç´ æ¾åä¸ç¨çä¸ä¸æã
     */
    getPixelContext() {
        if (!this._pixelCtx) {
            this._canvas = document.createElement('canvas');
            this._width = this._canvas.width;
            this._height = this._canvas.height;
            this._pixelCtx = this._canvas.getContext('2d');
        }
        return this._pixelCtx;
    }


    /**
     * @function LevelRenderer.Tool.Util.prototype.adjustCanvasSize
     * @description å¦æåæ å¤å¨_canvaså¤é¨ï¼æ¹å_canvasçå¤§å°ï¼ä¿®æ¹canvasçå¤§å° éè¦éæ°è®¾ç½®translate
     *
     * @param {number} x - æ¨ªåæ ã
     * @param {number} y - çºµåæ ã
     *
     */
    adjustCanvasSize(x, y) {
        var _canvas = this._canvas;
        var _pixelCtx = this._pixelCtx;
        var _width = this._width;
        var _height = this._height;
        var _offsetX = this._offsetX;
        var _offsetY = this._offsetY;

        // æ¯æ¬¡å çé¿åº¦
        var _v = 100;
        var _flag;

        if (x + _offsetX > _width) {
            _width = x + _offsetX + _v;
            _canvas.width = _width;
            _flag = true;
        }

        if (y + _offsetY > _height) {
            _height = y + _offsetY + _v;
            _canvas.height = _height;
            _flag = true;
        }

        if (x < -_offsetX) {
            _offsetX = Math.ceil(-x / _v) * _v;
            _width += _offsetX;
            _canvas.width = _width;
            _flag = true;
        }

        if (y < -_offsetY) {
            _offsetY = Math.ceil(-y / _v) * _v;
            _height += _offsetY;
            _canvas.height = _height;
            _flag = true;
        }

        if (_flag) {
            _pixelCtx.translate(_offsetX, _offsetY);
        }
    }


    /**
     * @function LevelRenderer.Tool.Util.prototype.getPixelOffset
     * @description è·ååç´ canvasçåç§»éã
     * @return {Object} åç§»éã
     */
    getPixelOffset() {
        return {
            x: this._offsetX,
            y: this._offsetY
        };
    }


    /**
     * @function LevelRenderer.Tool.Util.prototype.indexOf
     * @description æ¥è¯¢æ°ç»ä¸­åç´ çindex
     * @return {Object} åç§»éã
     */
    indexOf(array, value) {
        if (array.indexOf) {
            return array.indexOf(value);
        }
        for (var i = 0, len = array.length; i < len; i++) {
            if (array[i] === value) {
                return i;
            }
        }
        return -1;
    }


    /**
     * @function LevelRenderer.Tool.Util.prototype.inherits
     * @description æé ç±»ç»§æ¿å³ç³»
     *
     * @param {function} clazz - æºç±»ã
     * @param {function} baseClazz - åºç±»ã
     * @return {Object} åç§»éã
     */
    inherits(clazz, baseClazz) {
        var clazzPrototype = clazz.prototype;

        function F() {
        }

        F.prototype = baseClazz.prototype;
        clazz.prototype = new F();

        for (var prop in clazzPrototype) {
            clazz.prototype[prop] = clazzPrototype[prop];
        }
        clazz.constructor = clazz;
    }
}

;// CONCATENATED MODULE: ./src/common/overlay/levelRenderer/Color.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class  LevelRenderer.Tool.Color
 * @category Visualization Theme
 * @classdesc LevelRenderer å·¥å·-é¢è²è¾å©ç±»
 * @private
 */
class Color {



    constructor() {
        /**
         * @member {LevelRenderer.Tool.Util} LevelRenderer.Tool.Color.prototype.util
         * @description LevelRenderer åºç¡å·¥å·å¯¹è±¡ã
         */
        this.util = new Util_Util();

        /**
         * @member {Object} LevelRenderer.Tool.Color.prototype._ctx
         * @description _ctxã
         */
        this._ctx = null;

        /**
         * @member {Array.<string>} LevelRenderer.Tool.Color.prototype.palette
         * @description é»è®¤è²æ¿ãè²æ¿æ¯ä¸ä¸ªåå«å¾è¡¨é»è®¤é¢è²ç³»åçæ°ç»ï¼å½è²æ¿ä¸­ææé¢è²è¢«ä½¿ç¨è¿åï¼åå°ä»æ°åå°è²æ¿ä¸­çç¬¬ä¸ä¸ªé¢è²ã
         */
        this.palette = [
            '#ff9277', ' #dddd00', ' #ffc877', ' #bbe3ff', ' #d5ffbb',
            '#bbbbff', ' #ddb000', ' #b0dd00', ' #e2bbff', ' #ffbbe3',
            '#ff7777', ' #ff9900', ' #83dd00', ' #77e3ff', ' #778fff',
            '#c877ff', ' #ff77ab', ' #ff6600', ' #aa8800', ' #77c7ff',
            '#ad77ff', ' #ff77ff', ' #dd0083', ' #777700', ' #00aa00',
            '#0088aa', ' #8400dd', ' #aa0088', ' #dd0000', ' #772e00'
        ];

        /**
         * @member {Array.<string>} LevelRenderer.Tool.Color.prototype._palette
         * @description å¤ä½è²æ¿ï¼ç¨äºå¤ä½  palette
         */
        this._palette = this.palette;

        /**
         * @member {string} LevelRenderer.Tool.Color.prototype.highlightColor
         * @description é«äº®è²
         */
        this.highlightColor = 'rgba(0,0,255,1)';

        /**
         * @member {string} LevelRenderer.Tool.Color.prototype._highlightColor
         * @description å¤ä½é«äº®è²
         */
        this._highlightColor = this.highlightColor;

        /**
         * @member {string} LevelRenderer.Tool.Color.prototype.colorRegExp
         * @description é¢è²æ ¼å¼ï¼æ­£åè¡¨è¾¾å¼ã
         */
        this.colorRegExp = /^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+%?)?)\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+%?(?:\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i;

        /**
         * @member {string} LevelRenderer.Tool.Color.prototype._nameColors
         * @description é¢è²åã
         */
        this._nameColors = {
            aliceblue: '#f0f8ff',
            antiquewhite: '#faebd7',
            aqua: '#0ff',
            aquamarine: '#7fffd4',
            azure: '#f0ffff',
            beige: '#f5f5dc',
            bisque: '#ffe4c4',
            black: '#000',
            blanchedalmond: '#ffebcd',
            blue: '#00f',
            blueviolet: '#8a2be2',
            brown: '#a52a2a',
            burlywood: '#deb887',
            cadetblue: '#5f9ea0',
            chartreuse: '#7fff00',
            chocolate: '#d2691e',
            coral: '#ff7f50',
            cornflowerblue: '#6495ed',
            cornsilk: '#fff8dc',
            crimson: '#dc143c',
            cyan: '#0ff',
            darkblue: '#00008b',
            darkcyan: '#008b8b',
            darkgoldenrod: '#b8860b',
            darkgray: '#a9a9a9',
            darkgrey: '#a9a9a9',
            darkgreen: '#006400',
            darkkhaki: '#bdb76b',
            darkmagenta: '#8b008b',
            darkolivegreen: '#556b2f',
            darkorange: '#ff8c00',
            darkorchid: '#9932cc',
            darkred: '#8b0000',
            darksalmon: '#e9967a',
            darkseagreen: '#8fbc8f',
            darkslateblue: '#483d8b',
            darkslategray: '#2f4f4f',
            darkslategrey: '#2f4f4f',
            darkturquoise: '#00ced1',
            darkviolet: '#9400d3',
            deeppink: '#ff1493',
            deepskyblue: '#00bfff',
            dimgray: '#696969',
            dimgrey: '#696969',
            dodgerblue: '#1e90ff',
            firebrick: '#b22222',
            floralwhite: '#fffaf0',
            forestgreen: '#228b22',
            fuchsia: '#f0f',
            gainsboro: '#dcdcdc',
            ghostwhite: '#f8f8ff',
            gold: '#ffd700',
            goldenrod: '#daa520',
            gray: '#808080',
            grey: '#808080',
            green: '#008000',
            greenyellow: '#adff2f',
            honeydew: '#f0fff0',
            hotpink: '#ff69b4',
            indianred: '#cd5c5c',
            indigo: '#4b0082',
            ivory: '#fffff0',
            khaki: '#f0e68c',
            lavender: '#e6e6fa',
            lavenderblush: '#fff0f5',
            lawngreen: '#7cfc00',
            lemonchiffon: '#fffacd',
            lightblue: '#add8e6',
            lightcoral: '#f08080',
            lightcyan: '#e0ffff',
            lightgoldenrodyellow: '#fafad2',
            lightgray: '#d3d3d3',
            lightgrey: '#d3d3d3',
            lightgreen: '#90ee90',
            lightpink: '#ffb6c1',
            lightsalmon: '#ffa07a',
            lightseagreen: '#20b2aa',
            lightskyblue: '#87cefa',
            lightslategray: '#789',
            lightslategrey: '#789',
            lightsteelblue: '#b0c4de',
            lightyellow: '#ffffe0',
            lime: '#0f0',
            limegreen: '#32cd32',
            linen: '#faf0e6',
            magenta: '#f0f',
            maroon: '#800000',
            mediumaquamarine: '#66cdaa',
            mediumblue: '#0000cd',
            mediumorchid: '#ba55d3',
            mediumpurple: '#9370d8',
            mediumseagreen: '#3cb371',
            mediumslateblue: '#7b68ee',
            mediumspringgreen: '#00fa9a',
            mediumturquoise: '#48d1cc',
            mediumvioletred: '#c71585',
            midnightblue: '#191970',
            mintcream: '#f5fffa',
            mistyrose: '#ffe4e1',
            moccasin: '#ffe4b5',
            navajowhite: '#ffdead',
            navy: '#000080',
            oldlace: '#fdf5e6',
            olive: '#808000',
            olivedrab: '#6b8e23',
            orange: '#ffa500',
            orangered: '#ff4500',
            orchid: '#da70d6',
            palegoldenrod: '#eee8aa',
            palegreen: '#98fb98',
            paleturquoise: '#afeeee',
            palevioletred: '#d87093',
            papayawhip: '#ffefd5',
            peachpuff: '#ffdab9',
            peru: '#cd853f',
            pink: '#ffc0cb',
            plum: '#dda0dd',
            powderblue: '#b0e0e6',
            purple: '#800080',
            red: '#f00',
            rosybrown: '#bc8f8f',
            royalblue: '#4169e1',
            saddlebrown: '#8b4513',
            salmon: '#fa8072',
            sandybrown: '#f4a460',
            seagreen: '#2e8b57',
            seashell: '#fff5ee',
            sienna: '#a0522d',
            silver: '#c0c0c0',
            skyblue: '#87ceeb',
            slateblue: '#6a5acd',
            slategray: '#708090',
            slategrey: '#708090',
            snow: '#fffafa',
            springgreen: '#00ff7f',
            steelblue: '#4682b4',
            tan: '#d2b48c',
            teal: '#008080',
            thistle: '#d8bfd8',
            tomato: '#ff6347',
            turquoise: '#40e0d0',
            violet: '#ee82ee',
            wheat: '#f5deb3',
            white: '#fff',
            whitesmoke: '#f5f5f5',
            yellow: '#ff0',
            yellowgreen: '#9acd32'
        };

        this.CLASS_NAME = "SuperMap.LevelRenderer.Tool.Color";
    }

    /**
     * @function LevelRenderer.Tool.Color.prototype.customPalette
     * @description èªå®ä¹è°è²æ¿ã
     * @param {Array.<string>} userPalete - é¢è²æ¿ã
     */
    customPalette(userPalete) {
        this.palette = userPalete;
    }

    /**
     * @function LevelRenderer.Tool.Color.prototype.resetPalette
     * @description å¤ä½é»è®¤è²æ¿ã
     */
    resetPalette() {
        this.palette = this._palette;
    }

    /**
     * @function LevelRenderer.Tool.Color.prototype.getColor
     * @description è·åè²æ¿é¢è²ã
     * @param {number} idx - è²æ¿ä½ç½®ã
     * @param {Array.<string>} userPalete - è²æ¿ã
     * @returns {string} é¢è²å¼ã
     */
    getColor(idx, userPalete) {
        idx = idx | 0;
        userPalete = userPalete || this.palette;
        return userPalete[idx % userPalete.length];
    }

    /**
     * @function LevelRenderer.Tool.Color.prototype.customHighlight
     * @description èªå®ä¹é»è®¤é«äº®é¢è²ã
     * @param {string} userHighlightColor - èªå®ä¹é«äº®è²ã
     */
    customHighlight(userHighlightColor) {
        this.highlightColor = userHighlightColor;
    }

    /**
     * @function LevelRenderer.Tool.Color.prototype.resetHighlight
     * @description éç½®é»è®¤é«äº®é¢è²ãå°å½åçé«äº®è²ä½ä¸ºé»è®¤é«äº®é¢è²
     */
    resetHighlight() {
        this.highlightColor = this._highlightColor;
    }

    /**
     * @function LevelRenderer.Tool.Color.prototype.getHighlightColor
     * @description è·åé»è®¤é«äº®é¢è²
     * @returns {string} é¢è²å¼ã
     */
    getHighlightColor() {
        return this.highlightColor;
    }

    /**
     * @function LevelRenderer.Tool.Color.prototype.getRadialGradient
     * @description å¾åæ¸åã
     * @param {number} x0 - æ¸åèµ·ç¹æ¨ªåæ ã
     * @param {number} y0 - æ¸åèµ·ç¹çºµåæ ã
     * @param {number} r0 - åå¾
     * @param {number} x1 - æ¸åç»ç¹æ¨ªåæ ã
     * @param {number} y1 - æ¸åç»ç¹çºµåæ ã
     * @param {number} r1 - åå¾
     * @param {Array} colorList - é¢è²åè¡¨ã
     * @returns {CanvasGradient} Cavans æ¸åé¢è²ã
     */
    getRadialGradient(x0, y0, r0, x1, y1, r1, colorList) {
        var util = this.util;

        if (!this._ctx) {
            this._ctx = util.getContext();
        }
        var gradient = this._ctx.createRadialGradient(x0, y0, r0, x1, y1, r1);
        for (var i = 0, l = colorList.length; i < l; i++) {

            gradient.addColorStop(colorList[i][0], colorList[i][1]);
        }
        gradient.__nonRecursion = true;
        return gradient;
    }


    /**
     * @function LevelRenderer.Tool.Color.prototype.getLinearGradient
     * @description çº¿æ§æ¸åã
     * @param {number} x0 - æ¸åèµ·ç¹æ¨ªåæ ã
     * @param {number} y0 - æ¸åèµ·ç¹çºµåæ ã
     * @param {number} x1 - æ¸åç»ç¹æ¨ªåæ ã
     * @param {number} y1 - æ¸åç»ç¹çºµåæ ã
     * @param {Array} colorList - é¢è²åè¡¨ã
     * @returns {CanvasGradient} Cavans æ¸åé¢è²ã
     */
    getLinearGradient(x0, y0, x1, y1, colorList) {
        var util = this.util;

        if (!this._ctx) {
            this._ctx = util.getContext();
        }
        var gradient = this._ctx.createLinearGradient(x0, y0, x1, y1);
        for (var i = 0, l = colorList.length; i < l; i++) {
            gradient.addColorStop(colorList[i][0], colorList[i][1]);
        }
        gradient.__nonRecursion = true;
        return gradient;
    }

    /**
     * @function LevelRenderer.Tool.Color.prototype.getStepColors
     * @description è·åä¸¤ç§é¢è²ä¹é´æ¸åé¢è²æ°ç»ã
     * @param {Object} start - èµ·å§é¢è²å¯¹è±¡ã
     * @param {Object} end - ç»æé¢è²å¯¹è±¡ã
     * @param {number} step - æ¸åçº§æ°ã
     * @returns {Array} é¢è²æ°ç»ã
     */
    getStepColors(start, end, step) {
        start = this.toRGBA(start);
        end = this.toRGBA(end);
        start = this.getData(start);
        end = this.getData(end);

        var colors = [];
        var stepR = (end[0] - start[0]) / step;
        var stepG = (end[1] - start[1]) / step;
        var stepB = (end[2] - start[2]) / step;
        var stepA = (end[3] - start[3]) / step;
        // çæé¢è²éå
        // fix by linfeng é¢è²å ç§¯
        for (var i = 0, r = start[0], g = start[1], b = start[2], a = start[3]; i < step; i++) {
            colors[i] = this.toColor([
                this.adjust(Math.floor(r), [0, 255]),
                this.adjust(Math.floor(g), [0, 255]),
                this.adjust(Math.floor(b), [0, 255]),
                a.toFixed(4) - 0
            ], 'rgba');
            r += stepR;
            g += stepG;
            b += stepB;
            a += stepA;
        }
        r = end[0];
        g = end[1];
        b = end[2];
        a = end[3];
        colors[i] = this.toColor([r, g, b, a], 'rgba');
        return colors;
    }

    /**
     * @function LevelRenderer.Tool.Color.prototype.getGradientColors
     * @description è·åæå®çº§æ°çæ¸åé¢è²æ°ç»ã
     * @param {Array.<string>} colors - é¢è²æ°ç»ã
     * @param {number} [step=20] - æ¸åçº§æ°ã
     * @returns {Array.<string>} é¢è²æ°ç»ã
     */
    getGradientColors(colors, step) {
        var ret = [];
        var len = colors.length;
        if (step === undefined) {
            step = 20;
        }
        if (len === 1) {
            ret = this.getStepColors(colors[0], colors[0], step);
        } else if (len > 1) {
            for (var i = 0, n = len - 1; i < n; i++) {
                var steps = this.getStepColors(colors[i], colors[i + 1], step);
                if (i < n - 1) {
                    steps.pop();
                }
                ret = ret.concat(steps);
            }
        }
        return ret;
    }

    /**
     * @function LevelRenderer.Tool.Color.prototype.toColor
     * @description é¢è²å¼æ°ç»è½¬ä¸ºæå®æ ¼å¼é¢è²ã
     * @param {Array} data - é¢è²å¼æ°ç»ã
     * @param {string} format - æ ¼å¼ï¼é»è®¤'rgb'
     * @returns {string} é¢è²ã
     */
    toColor(data, format) {
        format = format || 'rgb';
        if (data && (data.length === 3 || data.length === 4)) {
            data = this.map(data,
                function (c) {
                    return c > 1 ? Math.ceil(c) : c;
                }
            );

            if (format.indexOf('hex') > -1) {
                return '#' + ((1 << 24) + (data[0] << 16) + (data[1] << 8) + (+data[2])).toString(16).slice(1);
            } else if (format.indexOf('hs') > -1) {
                var sx = this.map(data.slice(1, 3),
                    function (c) {
                        return c + '%';
                    }
                );
                data[1] = sx[0];
                data[2] = sx[1];
            }

            if (format.indexOf('a') > -1) {
                if (data.length === 3) {
                    data.push(1);
                }
                data[3] = this.adjust(data[3], [0, 1]);
                return format + '(' + data.slice(0, 4).join(',') + ')';
            }

            return format + '(' + data.slice(0, 3).join(',') + ')';
        }
    }

    /**
     * @function LevelRenderer.Tool.Color.prototype.toArray
     * @description é¢è²å­ç¬¦ä¸²è½¬æ¢ä¸ºrgbaæ°ç»ã
     * @param {string} color - é¢è²ã
     * @returns {Array.<number>} é¢è²å¼æ°ç»ã
     */
    toArray(color) {
        color = this.trim(color);
        if (color.indexOf('rgba') < 0) {
            color = this.toRGBA(color);
        }

        var data = [];
        var i = 0;
        color.replace(/[\d.]+/g, function (n) {
            if (i < 3) {
                n = n | 0;
            } else {
                // Alpha
                n = +n;
            }
            data[i++] = n;
        });
        return data;
    }

    /**
     * @function LevelRenderer.Tool.Color.prototype.convert
     * @description é¢è²æ ¼å¼è½¬åã
     * @param {Array} data - é¢è²å¼æ°ç»ã
     * @param {string} format - æ ¼å¼ï¼é»è®¤'rgb'
     * @returns {string} é¢è²ã
     */
    convert(color, format) {
        if (!this.isCalculableColor(color)) {
            return color;
        }
        var data = this.getData(color);
        var alpha = data[3];
        if (typeof alpha === 'undefined') {
            alpha = 1;
        }

        if (color.indexOf('hsb') > -1) {
            data = this._HSV_2_RGB(data);
        } else if (color.indexOf('hsl') > -1) {
            data = this._HSL_2_RGB(data);
        }

        if (format.indexOf('hsb') > -1 || format.indexOf('hsv') > -1) {
            data = this._RGB_2_HSB(data);
        } else if (format.indexOf('hsl') > -1) {
            data = this._RGB_2_HSL(data);
        }

        data[3] = alpha;

        return this.toColor(data, format);
    }

    /**
     * @function LevelRenderer.Tool.Color.prototype.toRGBA
     * @description è½¬æ¢ä¸ºrgbaæ ¼å¼çé¢è²ã
     * @param {string} color - é¢è²ã
     * @returns {string} é¢è²ã
     */
    toRGBA(color) {
        return this.convert(color, 'rgba');
    }

    /**
     * @function LevelRenderer.Tool.Color.prototype.toRGB
     * @description è½¬æ¢ä¸ºrgbæ°å­æ ¼å¼çé¢è²ã
     * @param {string} color - é¢è²ã
     * @returns {string} é¢è²ã
     */
    toRGB(color) {
        return this.convert(color, 'rgb');
    }

    /**
     * @function LevelRenderer.Tool.Color.prototype.toHex
     * @description è½¬æ¢ä¸º16è¿å¶é¢è²ã
     * @param {string} color - é¢è²ã
     * @returns {string} 16è¿å¶é¢è²ï¼#rrggbbæ ¼å¼
     */
    toHex(color) {
        return this.convert(color, 'hex');
    }

    /**
     * @function LevelRenderer.Tool.Color.prototype.toHSVA
     * @description è½¬æ¢ä¸ºHSVé¢è²ã
     * @param {string} color - é¢è²ã
     * @returns {string} HSVAé¢è²ï¼hsva(h,s,v,a)
     */
    toHSVA(color) {
        return this.convert(color, 'hsva');
    }

    /**
     * @function LevelRenderer.Tool.Color.prototype.toHSV
     * @description è½¬æ¢ä¸ºHSVé¢è²ã
     * @param {string} color - é¢è²ã
     * @returns {string} HSVé¢è²ï¼hsv(h,s,v)
     */
    toHSV(color) {
        return this.convert(color, 'hsv');
    }

    /**
     * @function LevelRenderer.Tool.Color.prototype.toHSBA
     * @description è½¬æ¢ä¸ºHSBAé¢è²ã
     * @param {string} color - é¢è²ã
     * @returns {string} HSBAé¢è²ï¼hsba(h,s,b,a)
     */
    toHSBA(color) {
        return this.convert(color, 'hsba');
    }

    /**
     * @function LevelRenderer.Tool.Color.prototype.toHSB
     * @description è½¬æ¢ä¸ºHSBé¢è²ã
     * @param {string} color - é¢è²ã
     * @returns {string} HSBé¢è²ï¼hsb(h,s,b)
     */
    toHSB(color) {
        return this.convert(color, 'hsb');
    }

    /**
     * @function LevelRenderer.Tool.Color.prototype.toHSLA
     * @description è½¬æ¢ä¸ºHSLAé¢è²ã
     * @param {string} color - é¢è²ã
     * @returns {string} HSLAé¢è²ï¼hsla(h,s,l,a)
     */
    toHSLA(color) {
        return this.convert(color, 'hsla');
    }

    /**
     * @function LevelRenderer.Tool.Color.prototype.toHSL
     * @description è½¬æ¢ä¸ºHSLé¢è²ã
     * @param {string} color - é¢è²ã
     * @returns {string}  HSLé¢è²ï¼hsl(h,s,l)
     */
    toHSL(color) {
        return this.convert(color, 'hsl');
    }

    /**
     * @function LevelRenderer.Tool.Color.prototype.toName
     * @description è½¬æ¢é¢è²åã
     * @param {string} color - é¢è²ã
     * @returns {string} é¢è²å
     */
    toName(color) {
        for (var key in this._nameColors) {
            if (this.toHex(this._nameColors[key]) === this.toHex(color)) {
                return key;
            }
        }
        return null;
    }

    /**
     * @function LevelRenderer.Tool.Color.prototype.trim
     * @description ç§»é¤é¢è²ä¸­å¤ä½ç©ºæ ¼ã
     * @param {string} color - é¢è²ã
     * @returns {string} æ ç©ºæ ¼é¢è²
     */
    trim(color) {
        return String(color).replace(/\s+/g, '');
    }

    /**
     * @function LevelRenderer.Tool.Color.prototype.normalize
     * @description é¢è²è§èåã
     * @param {string} color - é¢è²ã
     * @returns {string} è§èååçé¢è²
     */
    normalize(color) {
        // é¢è²å
        if (this._nameColors[color]) {
            color = this._nameColors[color];
        }
        // å»æç©ºæ ¼
        color = this.trim(color);
        // hsvä¸hsbç­ä»·
        color = color.replace(/hsv/i, 'hsb');
        // rgbè½¬ä¸ºrrggbb
        if (/^#[\da-f]{3}$/i.test(color)) {
            color = parseInt(color.slice(1), 16);
            var r = (color & 0xf00) << 8;
            var g = (color & 0xf0) << 4;
            var b = color & 0xf;

            color = '#' + ((1 << 24) + (r << 4) + r + (g << 4) + g + (b << 4) + b).toString(16).slice(1);
        }
        // æèä½¿ç¨ä»¥ä¸æ­£åæ¿æ¢ï¼ä¸è¿ chrome ä¸æ§è½ç¸å¯¹å·®ç¹
        // color = color.replace(/^#([\da-f])([\da-f])([\da-f])$/i, '#$1$1$2$2$3$3');
        return color;
    }

    /**
     * @function LevelRenderer.Tool.Color.prototype.lift
     * @description é¢è²å æ·±æåæ·¡ï¼å½level>0å æ·±ï¼å½level<0åæ·¡ã
     * @param {string} color - é¢è²ã
     * @param {number} level - åéç¨åº¦ï¼åå¼åºé´[-1,1]ã
     * @returns {string} å æ·±æåæ·¡åé¢è²å¼
     */
    lift(color, level) {
        if (!this.isCalculableColor(color)) {
            return color;
        }
        var direct = level > 0 ? 1 : -1;
        if (typeof level === 'undefined') {
            level = 0;
        }
        level = Math.abs(level) > 1 ? 1 : Math.abs(level);
        color = this.toRGB(color);
        var data = this.getData(color);
        for (var i = 0; i < 3; i++) {
            if (direct === 1) {
                data[i] = data[i] * (1 - level) | 0;
            } else {
                data[i] = ((255 - data[i]) * level + data[i]) | 0;
            }
        }
        return 'rgb(' + data.join(',') + ')';
    }

    /**
     * @function LevelRenderer.Tool.Color.prototype.reverse
     * @description é¢è²ç¿»è½¬ã[255-r,255-g,255-b,1-a]
     * @param {string} color - é¢è²ã
     * @returns {string} ç¿»è½¬é¢è²
     */
    reverse(color) {
        if (!this.isCalculableColor(color)) {
            return color;
        }
        var data = this.getData(this.toRGBA(color));
        data = this.map(data,
            function (c) {
                return 255 - c;
            }
        );
        return this.toColor(data, 'rgb');
    }

    /**
     * @function LevelRenderer.Tool.Color.prototype.mix
     * @description ç®åä¸¤ç§é¢è²æ··å
     * @param {string} color1 - ç¬¬ä¸ç§é¢è²ã
     * @param {string} color2 - ç¬¬äºç§é¢è²ã
     * @param {number} weight - æ··åæé[0-1]ã
     * @returns {string} ç»æè²ãrgb(r,g,b)ærgba(r,g,b,a)
     */
    mix(color1, color2, weight) {
        if (!this.isCalculableColor(color1) || !this.isCalculableColor(color2)) {
            return color1;
        }

        if (typeof weight === 'undefined') {
            weight = 0.5;
        }
        weight = 1 - this.adjust(weight, [0, 1]);

        var w = weight * 2 - 1;
        var data1 = this.getData(this.toRGBA(color1));
        var data2 = this.getData(this.toRGBA(color2));

        var d = data1[3] - data2[3];

        var weight1 = (((w * d === -1) ? w : (w + d) / (1 + w * d)) + 1) / 2;
        var weight2 = 1 - weight1;

        var data = [];

        for (var i = 0; i < 3; i++) {
            data[i] = data1[i] * weight1 + data2[i] * weight2;
        }

        var alpha = data1[3] * weight + data2[3] * (1 - weight);
        alpha = Math.max(0, Math.min(1, alpha));

        if (data1[3] === 1 && data2[3] === 1) {// ä¸èèéæåº¦
            return this.toColor(data, 'rgb');
        }
        data[3] = alpha;
        return this.toColor(data, 'rgba');
    }

    /**
     * @function LevelRenderer.Tool.Color.prototype.random
     * @description éæºé¢è²
     * @returns {string}  é¢è²å¼ï¼#rrggbbæ ¼å¼
     */
    random() {
        return '#' + Math.random().toString(16).slice(2, 8);
    }

    /**
     * @function LevelRenderer.Tool.Color.prototype.getData
     * @description è·åé¢è²å¼æ°ç»ï¼è¿åå¼èå´ã
     * RGB èå´[0-255]
     * HSL/HSV/HSB èå´[0-1]
     * Aéæåº¦èå´[0-1]
     * æ¯ææ ¼å¼ï¼
     * #rgb
     * #rrggbb
     * rgb(r,g,b)
     * rgb(r%,g%,b%)
     * rgba(r,g,b,a)
     * hsb(h,s,b) // hsvä¸hsbç­ä»·
     * hsb(h%,s%,b%)
     * hsba(h,s,b,a)
     * hsl(h,s,l)
     * hsl(h%,s%,l%)
     * hsla(h,s,l,a)
     * @param {string} color - é¢è²ã
     * @returns {Array.<number>} é¢è²å¼æ°ç»ænull
     */
    getData(color) {
        color = this.normalize(color);
        var r = color.match(this.colorRegExp);
        if (r === null) {
            throw new Error('The color format error'); // é¢è²æ ¼å¼éè¯¯
        }
        var d;
        var a;
        var data = [];
        var rgb;

        if (r[2]) {
            // #rrggbb
            d = r[2].replace('#', '').split('');
            rgb = [d[0] + d[1], d[2] + d[3], d[4] + d[5]];
            data = this.map(rgb,
                function (c) {
                    return Color.prototype.adjust.call(this, parseInt(c, 16), [0, 255]);
                }
            );

        } else if (r[4]) {
            // rgb rgba
            var rgba = (r[4]).split(',');
            a = rgba[3];
            rgb = rgba.slice(0, 3);
            data = this.map(
                rgb,
                function (c) {
                    c = Math.floor(
                        c.indexOf('%') > 0 ? parseInt(c, 0) * 2.55 : c
                    );
                    return Color.prototype.adjust.call(this, c, [0, 255]);
                }
            );

            if (typeof a !== 'undefined') {
                data.push(this.adjust(parseFloat(a), [0, 1]));
            }
        } else if (r[5] || r[6]) {
            // hsb hsba hsl hsla
            var hsxa = (r[5] || r[6]).split(',');
            var h = parseInt(hsxa[0], 0) / 360;
            var s = hsxa[1];
            var x = hsxa[2];
            a = hsxa[3];
            data = this.map([s, x],
                function (c) {
                    return Color.prototype.adjust.call(this, parseFloat(c) / 100, [0, 1]);
                }
            );
            data.unshift(h);
            if (typeof a !== 'undefined') {
                data.push(this.adjust(parseFloat(a), [0, 1]));
            }
        }
        return data;
    }

    /**
     * @function LevelRenderer.Tool.Color.prototype.alpha
     * @description è®¾ç½®é¢è²éæåº¦
     * @param {string} color - é¢è²ã
     * @param {number} a - éæåº¦,åºé´[0,1]ã
     * @returns {string} rgbaé¢è²å¼
     */
    alpha(color, a) {
        if (!this.isCalculableColor(color)) {
            return color;
        }
        if (a === null) {
            a = 1;
        }
        var data = this.getData(this.toRGBA(color));
        data[3] = this.adjust(Number(a).toFixed(4), [0, 1]);

        return this.toColor(data, 'rgba');
    }

    /**
     * @function LevelRenderer.Tool.Color.prototype.map
     * @description æ°ç»æ å°
     * @param {Array} array - æ°ç»ã
     * @param {function} fun - å½æ°ã
     * @returns {string} æ°ç»æ å°ç»æ
     */
    map(array, fun) {
        if (typeof fun !== 'function') {
            throw new TypeError();
        }
        var len = array ? array.length : 0;
        for (var i = 0; i < len; i++) {
            array[i] = fun(array[i]);
        }
        return array;
    }

    /**
     * @function LevelRenderer.Tool.Color.prototype.adjust
     * @description è°æ´å¼åºé´
     * @param {Array.<number>} value - æ°ç»ã
     * @param {Array.<number>} region - åºé´ã
     * @returns {number} è°æ´åçå¼
     */
    adjust(value, region) {
        // < to <= & > to >=
        // modify by linzhifeng 2014-05-25 because -0 == 0
        if (value <= region[0]) {
            value = region[0];
        } else if (value >= region[1]) {
            value = region[1];
        }
        return value;
    }

    /**
     * @function LevelRenderer.Tool.Color.prototype.isCalculableColor
     * @description å¤æ­æ¯å¦æ¯å¯è®¡ç®çé¢è²
     * @param {string} color - é¢è²ã
     * @returns {boolean} æ¯å¦æ¯å¯è®¡ç®çé¢è²
     */
    isCalculableColor(color) {
        return color instanceof Array || typeof color === 'string';
    }

    /**
     * @function LevelRenderer.Tool.Color.prototype._HSV_2_RGBãåè§{@link http://www.easyrgb.com/index.php?X=MATH}
     */
    _HSV_2_RGB(data) {
        var H = data[0];
        var S = data[1];
        var V = data[2];
        // HSV from 0 to 1
        var R;
        var G;
        var B;
        if (S === 0) {
            R = V * 255;
            G = V * 255;
            B = V * 255;
        } else {
            var h = H * 6;
            if (h === 6) {
                h = 0;
            }
            var i = h | 0;
            var v1 = V * (1 - S);
            var v2 = V * (1 - S * (h - i));
            var v3 = V * (1 - S * (1 - (h - i)));
            var r = 0;
            var g = 0;
            var b = 0;

            if (i === 0) {
                r = V;
                g = v3;
                b = v1;
            } else if (i === 1) {
                r = v2;
                g = V;
                b = v1;
            } else if (i === 2) {
                r = v1;
                g = V;
                b = v3;
            } else if (i === 3) {
                r = v1;
                g = v2;
                b = V;
            } else if (i === 4) {
                r = v3;
                g = v1;
                b = V;
            } else {
                r = V;
                g = v1;
                b = v2;
            }

            // RGB results from 0 to 255
            R = r * 255;
            G = g * 255;
            B = b * 255;
        }
        return [R, G, B];
    }

    /**
     * @function LevelRenderer.Tool.Color.prototype._HSL_2_RGBãåè§{@link http://www.easyrgb.com/index.php?X=MATH}
     */
    _HSL_2_RGB(data) {
        var H = data[0];
        var S = data[1];
        var L = data[2];
        // HSL from 0 to 1
        var R;
        var G;
        var B;
        if (S === 0) {
            R = L * 255;
            G = L * 255;
            B = L * 255;
        } else {
            var v2;
            if (L < 0.5) {
                v2 = L * (1 + S);
            } else {
                v2 = (L + S) - (S * L);
            }

            var v1 = 2 * L - v2;

            R = 255 * this._HUE_2_RGB(v1, v2, H + (1 / 3));
            G = 255 * this._HUE_2_RGB(v1, v2, H);
            B = 255 * this._HUE_2_RGB(v1, v2, H - (1 / 3));
        }
        return [R, G, B];
    }

    /**
     * @function LevelRenderer.Tool.Color.prototype._HUE_2_RGBãåè§{@link http://www.easyrgb.com/index.php?X=MATH}
     */
    _HUE_2_RGB(v1, v2, vH) {
        if (vH < 0) {
            vH += 1;
        }
        if (vH > 1) {
            vH -= 1;
        }
        if ((6 * vH) < 1) {
            return (v1 + (v2 - v1) * 6 * vH);
        }
        if ((2 * vH) < 1) {
            return (v2);
        }
        if ((3 * vH) < 2) {
            return (v1 + (v2 - v1) * ((2 / 3) - vH) * 6);
        }
        return v1;
    }

    /**
     * @function LevelRenderer.Tool.Color.prototype._RGB_2_HSBãåè§{@link http://www.easyrgb.com/index.php?X=MATH}
     */
    _RGB_2_HSB(data) {
        // RGB from 0 to 255
        var R = (data[0] / 255);
        var G = (data[1] / 255);
        var B = (data[2] / 255);

        var vMin = Math.min(R, G, B); // Min. value of RGB
        var vMax = Math.max(R, G, B); // Max. value of RGB
        var delta = vMax - vMin; // Delta RGB value
        var V = vMax;
        var H;
        var S;

        // HSV results from 0 to 1
        if (delta === 0) {
            H = 0;
            S = 0;
        } else {
            S = delta / vMax;

            var deltaR = (((vMax - R) / 6) + (delta / 2)) / delta;
            var deltaG = (((vMax - G) / 6) + (delta / 2)) / delta;
            var deltaB = (((vMax - B) / 6) + (delta / 2)) / delta;

            if (R === vMax) {
                H = deltaB - deltaG;
            } else if (G === vMax) {
                H = (1 / 3) + deltaR - deltaB;
            } else if (B === vMax) {
                H = (2 / 3) + deltaG - deltaR;
            }

            if (H < 0) {
                H += 1;
            }
            if (H > 1) {
                H -= 1;
            }
        }
        H = H * 360;
        S = S * 100;
        V = V * 100;
        return [H, S, V];
    }

    /**
     * @function LevelRenderer.Tool.Color.prototype._RGB_2_HSLãåè§{@link http://www.easyrgb.com/index.php?X=MATH}
     */
    _RGB_2_HSL(data) {

        // RGB from 0 to 255
        var R = (data[0] / 255);
        var G = (data[1] / 255);
        var B = (data[2] / 255);

        var vMin = Math.min(R, G, B); // Min. value of RGB
        var vMax = Math.max(R, G, B); // Max. value of RGB
        var delta = vMax - vMin; // Delta RGB value

        var L = (vMax + vMin) / 2;
        var H;
        var S;
        // HSL results from 0 to 1
        if (delta === 0) {
            H = 0;
            S = 0;
        } else {
            if (L < 0.5) {
                S = delta / (vMax + vMin);
            } else {
                S = delta / (2 - vMax - vMin);
            }

            var deltaR = (((vMax - R) / 6) + (delta / 2)) / delta;
            var deltaG = (((vMax - G) / 6) + (delta / 2)) / delta;
            var deltaB = (((vMax - B) / 6) + (delta / 2)) / delta;

            if (R === vMax) {
                H = deltaB - deltaG;
            } else if (G === vMax) {
                H = (1 / 3) + deltaR - deltaB;
            } else if (B === vMax) {
                H = (2 / 3) + deltaG - deltaR;
            }

            if (H < 0) {
                H += 1;
            }

            if (H > 1) {
                H -= 1;
            }
        }

        H = H * 360;
        S = S * 100;
        L = L * 100;

        return [H, S, L];
    }

}

;// CONCATENATED MODULE: ./src/common/util/ColorsPickerUtil.js


var ColorRender = new Color();
// let "http://www.qzu.zj.cn": "#bd10e0"
// 					"www.qzct.net": "#7ed321" = new LevelRenderer.Tool.Color();

/**
 * @name ColorsPickerUtil
 * @namespace
 * @category BaseTypes Util
 * @classdesc è²å¸¦éæ©å¨å·¥å·ç±»  ç¨äº1ãåå»ºcanvaså¯¹è±¡ï¼2ãä»å ç§é¢è²ä¸­è·åä¸å®æ°éçæ¸åè²
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.ColorsPickerUtil.createCanvas();
 *
 *   // å¼ç¨çåæ³
 *   const result = SuperMap.ColorsPickerUtil.createCanvas();
 *
 * </script>
 *
 * // ES6 Import
 * import { ColorsPickerUtil } from '{npm}';
 *
 * const result = ColorsPickerUtil.createCanvas();
 * ```
 */
class ColorsPickerUtil  {
    /**
     * @function ColorsPickerUtil.createCanvas
     * @description åå»ºDOM canvas
     * @param {number} height - canvas é«åº¦ã
     * @param {number} width - canvas å®½åº¦ã
     */

    static createCanvas (height, width){
        var canvas = document.createElement("canvas");
        canvas.height = height;
        canvas.width = width;

        return canvas.getContext("2d");
    }

    /**
     * @function ColorsPickerUtil.getLinearGradient
     * @description çº¿æ§æ¸åã
     * @param {number} x0 - æ¸åèµ·ç¹ x åæ ã
     * @param {number} y0 - æ¸åèµ·ç¹ y åæ ã
     * @param {number} x1 - æ¸åç»ç¹ x åæ ã
     * @param {number} y1 - æ¸åç»ç¹ y åæ ã
     * @param {Array} colorList é¢è²åè¡¨ã
     * @returns {CanvasGradient} Cavans æ¸åé¢è²ã
     */

    static getLinearGradient (x0, y0, x1, y1, colorList){
        if (!this._ctx) {
            this._ctx = this.getContext();
        }
        var gradient = this._ctx.createLinearGradient(x0, y0, x1, y1);
        var leng = colorList.length;
        var add = 1/(leng -1);
        var offset = 0;
        for (var i = 0; i < leng; i++) {
            gradient.addColorStop(offset, colorList[i]);
            offset += add;
        }
        gradient.__nonRecursion = true;
        return gradient;
    }

    /**
     * @function ColorsPickerUtil.getContext
     * @description è·å Cavans ä¸ä¸æã
     * @returns {Object} Cavans ä¸ä¸æã
     */

    static getContext () {
        if (!this._ctx) {
            this._ctx = document.createElement('canvas').getContext('2d');
        }
        return this._ctx;
    }

    /**
     * @function ColorsPickerUtil.getStepColors
     * @description è·åä¸¤ç§é¢è²ä¹é´æ¸åé¢è²æ°ç»ã
     * @param {string} start - èµ·å§é¢è²ã
     * @param {string} end - ç»æé¢è²ã
     * @param {number} step - æ¸åçº§æ°ã
     * @returns {Array} é¢è²æ°ç»ã
     */

    static getStepColors (start, end, step){
        start = ColorRender.toRGBA(start);
        end = ColorRender.toRGBA(end);
        start = ColorRender.getData(start);
        end = ColorRender.getData(end);

        var colors = [];
        var stepR = (end[0] - start[0]) / step;
        var stepG = (end[1] - start[1]) / step;
        var stepB = (end[2] - start[2]) / step;
        var stepA = (end[3] - start[3]) / step;
        // çæé¢è²éå
        // fix by linfeng é¢è²å ç§¯
        for (var i = 0, r = start[0], g = start[1], b = start[2], a = start[3]; i < step; i++) {
            colors[i] = ColorRender.toColor([
                ColorRender.adjust(Math.floor(r), [ 0, 255 ]),
                ColorRender.adjust(Math.floor(g), [ 0, 255 ]),
                ColorRender.adjust(Math.floor(b), [ 0, 255 ]),
                a.toFixed(4) - 0
            ],'hex');
            r += stepR;
            g += stepG;
            b += stepB;
            a += stepA;
        }
        r = end[0];
        g = end[1];
        b = end[2];
        a = end[3];
        colors[i] = ColorRender.toColor([r, g, b, a], 'hex');
        return colors;
    }

    /**
     * @function ColorsPickerUtil.getGradientColors
     * @description è·åæå®çº§æ°çæ¸åé¢è²æ°ç»ã
     * @param {Array.<string>} colors - é¢è²ç»ã
     * @param {number} total - é¢è²æ»æ°ã
     * @param {string} themeType - ä¸é¢ç±»åã
     * @returns {Array.<string>} é¢è²æ°ç»ã
     */

    static getGradientColors (colors, total, themeType){
        var ret = [], step;
        var i, n, len = colors.length;
        if (total === undefined) {
            return;
        }
        if(len >= total){
            if(themeType === 'RANGE'){
                for(i = 0; i<total; i++){
                    ret.push(colors[i]);
                }
            }else {
                //1/2åååè²
                for(i = 0; i<total; i++){
                    let ii = Math.floor(i/2);
                    if(i%2 === 0){
                        ret.push(colors[ii]);
                    }else {
                        let index = colors.length -1 - ii;
                        ret.push(colors[index]);
                    }
                }
            }
        } else {
            step = Math.ceil(total/(len-1));
            for (i = 0, n = len - 1; i < n; i++) {
                var steps = this.getStepColors(colors[i], colors[i + 1], step);
                if (i < n - 1) {
                    steps.pop();
                }
                ret = ret.concat(steps);
            }
            //å é¤å¤ä½åç´ 
            var nouse = ret.length - total;
            for(var j = 0, index = 0; j< nouse; j++){
                ret.splice(index+2,1);
            }
        }
        return ret;
    }
}

;// CONCATENATED MODULE: ./src/common/util/ArrayStatistic.js
/**
 * @name ArrayStatistic
 * @namespace
 * @category BaseTypes Util
 * @classdesc å¤çæ°ç»ã
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.ArrayStatistic.newInstance();
 *
 *   // å¼ç¨çåæ³
 *   const result = SuperMap.ArrayStatistic.newInstance();
 *
 * </script>
 *
 * // ES6 Import
 * import { ArrayStatistic } from '{npm}';
 *
 * const result = ArrayStatistic.newInstance();
 * ```
 */
 class ArrayStatistic {

    // geostatsInstance: null,

    /**
     * @function ArrayStatistic.newInstance
     * @description åå§åæä»¶å®ä¾ã
     */
    static newInstance() {
        // if(!this.geostatsInstance) {
        //         //     this.geostatsInstance = new geostats();
        //         // }
        // window.dataList = [];
        if(!this.geostatsInstance) {

            this.geostatsInstance = new window.geostats();
          
        }
        return this.geostatsInstance;
    }

    /**
     * @function ArrayStatistic.getInstance
     * @description è®¾ç½®éè¦è¢«å¤ççæ°ç»ã
     * @param {Array} array - æ°ç»ã
     */
    static getInstance(array) {
        let instance = this.newInstance();
        instance.setSerie(array);
        return instance;
    }

    /**
     * @function ArrayStatistic.getArrayStatistic
     * @description è·åæ°ç»ç»è®¡çå¼ã
     * @param {Array.<number>} array - éè¦ç»è®¡çæ°ç»ã
     * @param {string} type - ç»è®¡æ¹æ³ã
     */
    static getArrayStatistic(array, type){
        if(!array.length) {
            return 0;
        }
        if(type === "Sum" || type === "æ±å"){
            return this.getSum(array);
        } else if(type === "Maximum" || type === "æå¤§å¼"){
            return this.getMax(array);
        } else if(type === "Minimum" || type === "æå°å¼"){
            return this.getMin(array);
        } else if(type === "Average" || type === "å¹³åå¼"){
            return this.getMean(array);
        } else if(type === "Median" || type === "ä¸­ä½æ°"){
            return this.getMedian(array);
        } else if(type === "times" || type === "è®¡æ°"){
            return this.getTimes(array);
        }
    }

    /**
     * @function ArrayStatistic.getArraySegments
     * @description è·åæ°ç»åæ®µåçæ°å¼ã
     * @param {Array.<number>} array - éè¦åæ®µçæ°ç»ã
     * @param {string} type - åæ®µæ¹æ³ã
     * @param {number} segNum - åæ®µä¸ªæ°ã
     */
    static getArraySegments(array, type, segNum) {
        if(type === "offset") {
            return this.getEqInterval(array, segNum);
        } else if(type === "jenks") {
            return this.getJenks(array, segNum);
        } else if(type === "square") {
            // æ°æ®é½å¿é¡» >= 0
            let minValue = this.getMin(array);
            if(minValue >= 0){
                return this.getSqrtInterval(array, segNum);
            }else {
                //console.log('æ°æ®é½å¿é¡» >= 0');
                // Util.showMessage(Language.hasNegValue + Language.noSupportRange, 'ERROR');
                return false;
            }

        } else if(type === "logarithm") {
            // æ°æ®é½å¿é¡» > 0
            let minValue = this.getMin(array);
            if(minValue > 0){
                return this.getGeometricProgression(array, segNum);
            }else {
                //console.log('æ°æ®é½å¿é¡» > 0');
                // Util.showMessage(Language.hasZeroNegValue + Language.noSupportRange, 'ERROR');
                return false;
            }
        }
    }

    /**
     * @function ArrayStatistic.getSum
     * @description æ±åã
     * @param {Array.<number>} array éè¦æ±åçåæ°ã
     * @returns {number} è¿åæ±åç»æã
     */
    static getSum(array){
        return this.getInstance(array).sum();
    }

    /**
     * @function ArrayStatistic.getMax
     * @description æå¤§å¼ã
     * @param {Array.<number>} array éè¦æ±æå¤§å¼çåæ°ã
     * @returns {number} è¿åæå¤§å¼ã
     */
    static getMax(array){
        return this.getInstance(array).max();
    }

    /**
     * @function ArrayStatistic.getMin
     * @description æå°å¼ã
     * @param {Array.<number>} array éè¦æ±æå°å¼çåæ°ã
     * @returns {number} è¿åæå°å¼ã
     */
    static getMin(array){
        return this.getInstance(array).min();
    }

    /**
     * @function ArrayStatistic.getMean
     * @description æ±å¹³åæ°ã
     * @param {Array.<number>} array éè¦æ±å¹³åæ°çåæ°ã
     * @returns {number} è¿åå¹³åæ°ã
     */
    static getMean(array){
        return this.getInstance(array).mean();
    }

    /**
     * @function ArrayStatistic.getMedian
     * @description æ±ä¸­ä½æ°ã
     * @param {Array.<number>} array éè¦æ±ä¸­ä½æ°çåæ°ã
     * @returns {number} è¿åä¸­ä½æ°ã
     */
    static getMedian(array) {
        return this.getInstance(array).median();
    }

    /**
     * @function ArrayStatistic.getTimes
     * @description è®¡æ°ã
     * @param {Array.<number>} array éè¦è®¡æ°çåæ°ã
     * @returns {number} è¿åè®¡æ°ç»æã
     */
    static getTimes(array) {
        return array.length;
    }

    /**
     * @function ArrayStatistic.getEqInterval
     * @description ç­è·åæ®µæ³ã
     * @param {Array} array éè¦è¿è¡ç­è·åæ®µçæ°ç»ã
     * @param {number} segNum åæ®µä¸ªæ°ã
     */
    static getEqInterval(array, segNum) {
        return this.getInstance(array).getClassEqInterval(segNum);
    }
    
    /**
     * @function ArrayStatistic.getJenks
     * @description èªç¶æ­è£æ³ã
     * @param {Array} array éè¦è¿è¡èªç¶æ­è£çåæ°ã
     * @param {number} segNum åæ®µä¸ªæ°ã
     */
    static getJenks(array, segNum) {
        return this.getInstance(array).getClassJenks(segNum);
    }

    /**
     * @function ArrayStatistic.getSqrtInterval
     * @description å¹³æ¹æ ¹åæ®µæ³ã
     * @param {Array} array éè¦è¿è¡å¹³æ¹æ ¹åæ®µçåæ°ã
     * @param {number} segNum åæ®µä¸ªæ°ã
     */
    static getSqrtInterval(array, segNum) {
        array = array.map(function(value) {
            return Math.sqrt(value);
        });
        let breaks = this.getInstance(array).getClassEqInterval(segNum);
        return (
            breaks.map(function(value) {
                return value * value;
            })
        ) 
    }

    /**
     * @function ArrayStatistic.getGeometricProgression
     * @description å¯¹æ°åæ®µæ³ã
     * @param {Array} array éè¦è¿è¡å¯¹æ°åæ®µçåæ°ã
     * @param {number} segNum åæ®µä¸ªæ°ã
     */
    static getGeometricProgression(array, segNum) {
        return this.getInstance(array).getClassGeometricProgression(segNum);
    }

}
;// CONCATENATED MODULE: ./src/common/util/MapCalculateUtil.js


/**
 * @function getMeterPerMapUnit
 * @description åä½æ¢ç®ï¼æç±³|åº¦|åç±³|è±å¯¸|è±å°ºæ¢æç±³ã
 * @category BaseTypes Util
 * @param {string} mapUnit å°å¾åä½ã
 * @returns {number} è¿åå°å¾çè·ç¦»åä½ã
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.getMeterPerMapUnit(mapUnit);
 *
 * </script>
 *
 * // ES6 Import
 * import { getMeterPerMapUnit } from '{npm}';
 *
 * const result = getMeterPerMapUnit(mapUnit);
 * ```
 */
var getMeterPerMapUnit = function(mapUnit) {
    var earchRadiusInMeters = 6378137;
    var meterPerMapUnit;
    if (mapUnit === Unit.METER) {
        meterPerMapUnit = 1;
    } else if (mapUnit === Unit.DEGREE) {
        // æ¯åº¦è¡¨ç¤ºå¤å°ç±³ã
        meterPerMapUnit = (Math.PI * 2 * earchRadiusInMeters) / 360;
    } else if (mapUnit === Unit.KILOMETER) {
        meterPerMapUnit = 1.0e-3;
    } else if (mapUnit === Unit.INCH) {
        meterPerMapUnit = 1 / 2.5399999918e-2;
    } else if (mapUnit === Unit.FOOT) {
        meterPerMapUnit = 0.3048;
    } else {
        return meterPerMapUnit;
    }
    return meterPerMapUnit;
};

/**
 * @function getWrapNum
 * @description è·åè¯¥åæ ç³»çç»çº¬åº¦èå´çç»åº¦æçº¬åº¦ã
 * @category BaseTypes Util
 * @param {number} x ç»åº¦æçº¬åº¦ã
 * @param {boolean} includeMax æ¯å¦è·åç»åº¦æçº¬åº¦çæå¤§å¼ã
 * @param {boolean} includeMin æ¯å¦è·åç»åº¦æçº¬åº¦çæå°å¼ã
 * @param {number} range åæ ç³»çç»çº¬åº¦èå´ã
 * @returns {number} è¿åç»åº¦æçº¬åº¦çå¼ã
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.getWrapNum(x, includeMax, includeMin, range);
 *
 * </script>
 *
 * // ES6 Import
 * import { getWrapNum } from '{npm}';
 *
 * const result = getWrapNum(x, includeMax, includeMin, range);
 * ```
 */
function getWrapNum(x, includeMax = true, includeMin = true, range = [-180, 180]) {
    var max = range[1],
        min = range[0],
        d = max - min;
    if (x === max && includeMax) {
        return x;
    }
    if (x === min && includeMin) {
        return x;
    }
    var tmp = (((x - min) % d) + d) % d;
    if (tmp === 0 && includeMax) {
        return max;
    }
    return ((((x - min) % d) + d) % d) + min;
}

/**
 * @function conversionDegree
 * @description è½¬æ¢ç»çº¬åº¦ã
 * @category BaseTypes Util
 * @param {number} degrees ç»åº¦æçº¬åº¦ã
 * @returns {string} è¿ååº¦åç§ã
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.conversionDegree(degrees);
 *
 * </script>
 *
 * // ES6 Import
 * import { conversionDegree } from '{npm}';
 *
 * const result = conversionDegree(degrees);
 * ```
 */
function conversionDegree(degrees) {
    const degree = parseInt(degrees);
    let fraction = parseInt((degrees - degree) * 60);
    let second = parseInt(((degrees - degree) * 60 - fraction) * 60);
    fraction = parseInt(fraction / 10) === 0 ? `0${fraction}` : fraction;
    second = parseInt(second / 10) === 0 ? `0${second}` : second;
    return `${degree}Â°${fraction}'${second}`;
}

/**
  * @function scalesToResolutions
  * @description éè¿æ¯ä¾å°ºæ°ç»è®¡ç®åè¾¨çæ°ç»ï¼æ²¡æä¼ å¥æ¯ä¾å°ºæ°ç»æ¶éè¿å°å¾èå´ä¸å°å¾æå¤§çº§å«è¿è¡è®¡ç®ã
  * @version 11.0.1
  * @param {Array} scales - æ¯ä¾å°ºæ°ç»ã
  * @param {Object} bounds - å°å¾èå´ã
  * @param {number} dpi - å±å¹åè¾¨çã
  * @param {string} mapUnit - å°å¾åä½ã
  * @param {number} [level=22] - å°å¾æå¤§çº§å«ã
  * @returns {number} åè¾¨çã
  * @usage
  * ```
  * // æµè§å¨
  * <script type="text/javascript" src="{cdn}"></script>
  * <script>
  *   const result = {namespace}.scalesToResolutions(scales, bounds, dpi, mapUnit);
  *
  * </script>
  *
  * // ES6 Import
  * import { scalesToResolutions } from '{npm}';
  *
  * const result = scalesToResolutions(scales, bounds, dpi, mapUnit);
  * ```
 */
 function scalesToResolutions(scales, bounds, dpi, mapUnit, level = 22) {
  var resolutions = [];
  if (scales && scales.length > 0) {
    for (let i = 0; i < scales.length; i++) {
      resolutions.push(scaleToResolution(scales[i], dpi, mapUnit));
    }
  } else {
    const maxReolution = Math.abs(bounds.left - bounds.right) / 256;
    for (let i = 0; i < level; i++) {
      resolutions.push(maxReolution / Math.pow(2, i));
    }
  }
  return resolutions.sort(function (a, b) {
    return b - a;
  });
}
/**
  * @function getZoomByResolution
  * @description éè¿åè¾¨çè·åå°å¾çº§å«ã
  * @version 11.0.1
  * @param {number} resolution - åè¾¨çã
  * @param {Array} resolutions - åè¾¨çæ°ç»ã
  * @returns {number} å°å¾çº§å«ã
  * @usage
  * ```
  * // æµè§å¨
  * <script type="text/javascript" src="{cdn}"></script>
  * <script>
  *   const result = {namespace}.getZoomByResolution(resolution, resolutions);
  *
  * </script>
  *
  * // ES6 Import
  * import { getZoomByResolution } from '{npm}';
  *
  * const result = getZoomByResolution(resolution, resolutions);
  * ```
 */
function getZoomByResolution(resolution, resolutions) {
  let zoom = 0;
  let minDistance;
  for (let i = 0; i < resolutions.length; i++) {
    if (i === 0) {
      minDistance = Math.abs(resolution - resolutions[i]);
    }
    if (minDistance > Math.abs(resolution - resolutions[i])) {
      minDistance = Math.abs(resolution - resolutions[i]);
      zoom = i;
    }
  }
  return zoom;
}

/**
  * @function scaleToResolution
  * @description éè¿æ¯ä¾å°ºè®¡ç®åè¾¨çã
  * @version 11.0.1
  * @param {number} scale - æ¯ä¾å°ºã
  * @param {number} dpi - å±å¹åè¾¨çã
  * @param {string} mapUnit - å°å¾åä½ã
  * @returns {number} åè¾¨çã
  * @usage
  * ```
  * // æµè§å¨
  * <script type="text/javascript" src="{cdn}"></script>
  * <script>
  *   const result = {namespace}.scaleToResolution(scale, dpi, mapUnit);
  *
  * </script>
  *
  * // ES6 Import
  * import { scaleToResolution } from '{npm}';
  *
  * const result = scaleToResolution(scale, dpi, mapUnit);
  * ```
 */
function scaleToResolution(scale, dpi, mapUnit) {
  const inchPerMeter = 1 / 0.0254;
  const meterPerMapUnitValue = getMeterPerMapUnit(mapUnit);
  const resolution = 1 / (scale * dpi * inchPerMeter * meterPerMapUnitValue);
  return resolution;
}

;// CONCATENATED MODULE: ./src/common/util/index.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/









// EXTERNAL MODULE: ./node_modules/lodash.topairs/index.js
var lodash_topairs = __webpack_require__(52);
var lodash_topairs_default = /*#__PURE__*/__webpack_require__.n(lodash_topairs);
;// CONCATENATED MODULE: ./src/common/style/CartoCSS.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class CartoCSS
 * @deprecatedclass SuperMap.CartoCSS
 * @classdesc CartoCSS è§£æç±»ï¼å¶ä¸»è¦åè½ä¸ºå° CartoCSS å­ç¬¦ä¸²è§£æä¸º CartoCSS ç shader å±æ§é£æ ¼å¯¹è±¡ã
 * @category BaseTypes Style
 * @param {string} cartoStr -  æ ·å¼è¡¨å­ç¬¦ä¸²
 * @example
 * var cartocss = "@provinceLineColor:#ddd;
 *                 #China_Provinces_L___China400{
 *                      line-dasharray:10,10;
 *                      line-color:@provinceLineColor;
 *                      line-width:1;
 *                 }";
 * new CartoCSS(cartocss);
 * @usage
 */
/*eslint no-useless-escape: "off"*/
class CartoCSS {

    constructor(cartoStr) {
        this.env = null;

        /**
         * @member CartoCSS.prototype.parser
         * @description è§£æå¨
         */
        this.parser = null;

        /**
         * @member CartoCSS.prototype.ruleSet
         * @description CartoCSS è§åå¯¹è±¡
         */
        this.ruleSet = null;

        /**
         * @member CartoCSS.prototype.cartoStr
         * @description CartoCSS æ ·å¼è¡¨å­ç¬¦ä¸²
         */
        this.cartoStr = "";

        /**
         * @member CartoCSS.prototype.shaders
         * @description Carto çè²å¨é
         */
        this.shaders = null;

        if (typeof cartoStr === "string") {
            this.cartoStr = cartoStr;
            this.env = {
                frames: [],
                errors: [],
                error: function (obj) {
                    this.errors.push(obj);
                }
            };
            this.parser = this.getParser(this.env);
            this.parse(cartoStr);
            this.shaders = this.toShaders();
        }
    }

    /**
     * @function CartoCSS.prototype.getParser
     * @description è·å CartoCSS è§£æå¨
     */
    getParser(env) {
        var input,       // LeSS input string
            i,           // current index in `input`
            j,           // current chunk
            temp,        // temporarily holds a chunk's state, for backtracking
            memo,        // temporarily holds `i`, when backtracking
            furthest,    // furthest index the parser has gone to
            chunks,      // chunkified input
            current,     // index of current chunk, in `input`
            parser;

        var that = this;

        // This function is called after all files
        // have been imported through `@import`.
        var finish = function () {//NOSONAR
            //æææä»¶å¯¼å¥å®æä¹åè°ç¨
        };

        function save() {
            temp = chunks[j];
            memo = i;
            current = i;
        }

        function restore() {
            chunks[j] = temp;
            i = memo;
            current = i;
        }

        function sync() {
            if (i > current) {
                chunks[j] = chunks[j].slice(i - current);
                current = i;
            }
        }

        //
        // Parse from a token, regexp or string, and move forward if match
        //
        function _match(tok) {
            var match, length, c, endIndex;

            // Non-terminal
            if (tok instanceof Function) {
                return tok.call(parser.parsers);
                // Terminal
                // Either match a single character in the input,
                // or match a regexp in the current chunk (chunk[j]).
            } else if (typeof(tok) === 'string') {
                match = input.charAt(i) === tok ? tok : null;
                length = 1;
                sync();
            } else {
                sync();

                match = tok.exec(chunks[j]);
                if (match) {
                    length = match[0].length;
                } else {
                    return null;
                }
            }

            // The match is confirmed, add the match length to `i`,
            // and consume any extra white-space characters (' ' || '\n')
            // which come after that. The reason for this is that LeSS's
            // grammar is mostly white-space insensitive.
            if (match) {
                var mem = i += length;
                endIndex = i + chunks[j].length - length;

                while (i < endIndex) {
                    c = input.charCodeAt(i);
                    if (!(c === 32 || c === 10 || c === 9)) {
                        break;
                    }
                    i++;
                }
                chunks[j] = chunks[j].slice(length + (i - mem));
                current = i;

                if (chunks[j].length === 0 && j < chunks.length - 1) {
                    j++;
                }

                if (typeof(match) === 'string') {
                    return match;
                } else {
                    return match.length === 1 ? match[0] : match;
                }
            }
        }

        // Same as _match(), but don't change the state of the parser,
        // just return the match.
        function peek(tok) {
            if (typeof(tok) === 'string') {
                return input.charAt(i) === tok;
            } else {
                return !!tok.test(chunks[j]);
            }
        }

        // Make an error object from a passed set of properties.
        // Accepted properties:
        // - `message`: Text of the error message.
        // - `filename`: Filename where the error occurred.
        // - `index`: Char. index where the error occurred.
        function makeError(err) {
            var einput;

            var defautls = {
                index: furthest,
                filename: env.filename,
                message: 'Parse error.',
                line: 0,
                column: -1
            };
            for (var prop in defautls) {
                if (err[prop] === 0) {
                    err[prop] = defautls[prop];
                }
            }

            if (err.filename && that.env.inputs && that.env.inputs[err.filename]) {
                einput = that.env.inputs[err.filename];
            } else {
                einput = input;
            }

            err.line = (einput.slice(0, err.index).match(/\n/g) || '').length + 1;
            for (var n = err.index; n >= 0 && einput.charAt(n) !== '\n'; n--) {
                err.column++;
            }
            return new Error([err.filename, err.line, err.column, err.message].join(";"));
        }

        this.env = env = env || {};
        this.env.filename = this.env.filename || null;
        this.env.inputs = this.env.inputs || {};

        // The Parser
        parser = {

            // Parse an input string into an abstract syntax tree.
            // Throws an error on parse errors.
            parse: function (str) {
                var root, error = null;

                i = j = current = furthest = 0;
                chunks = [];
                input = str.replace(/\r\n/g, '\n');
                if (env.filename) {
                    that.env.inputs[env.filename] = input;
                }

                // Split the input into chunks.
                chunks = (function (chunks) {
                    var j = 0,
                        skip = /(?:@\{[\w-]+\}|[^"'`\{\}\/\(\)\\])+/g,
                        comment = /\/\*(?:[^*]|\*+[^\/*])*\*+\/|\/\/.*/g,
                        string = /"((?:[^"\\\r\n]|\\.)*)"|'((?:[^'\\\r\n]|\\.)*)'|`((?:[^`]|\\.)*)`/g,
                        level = 0,
                        match,
                        chunk = chunks[0],
                        inParam;

                    for (var i = 0, c, cc; i < input.length;) {
                        skip.lastIndex = i;
                        if (match = skip.exec(input)) {
                            if (match.index === i) {
                                i += match[0].length;
                                chunk.push(match[0]);
                            }
                        }
                        c = input.charAt(i);
                        comment.lastIndex = string.lastIndex = i;

                        if (match = string.exec(input)) {
                            if (match.index === i) {
                                i += match[0].length;
                                chunk.push(match[0]);
                                continue;
                            }
                        }

                        if (!inParam && c === '/') {
                            cc = input.charAt(i + 1);
                            if (cc === '/' || cc === '*') {
                                if (match = comment.exec(input)) {
                                    if (match.index === i) {
                                        i += match[0].length;
                                        chunk.push(match[0]);
                                        continue;
                                    }
                                }
                            }
                        }

                        switch (c) {
                            case '{'://NOSONAR
                                if (!inParam) {
                                    level++;
                                    chunk.push(c);
                                    break;
                                }
                            case '}'://NOSONAR
                                if (!inParam) {
                                    level--;
                                    chunk.push(c);
                                    chunks[++j] = chunk = [];
                                    break;
                                }
                            case '('://NOSONAR
                                if (!inParam) {
                                    inParam = true;
                                    chunk.push(c);
                                    break;
                                }
                            case ')'://NOSONAR
                                if (inParam) {
                                    inParam = false;
                                    chunk.push(c);
                                    break;
                                }
                            default:
                                chunk.push(c);
                                break;
                        }

                        i++;
                    }
                    if (level !== 0) {
                        error = {
                            index: i - 1,
                            type: 'Parse',
                            message: (level > 0) ? "missing closing `}`" : "missing opening `{`"
                        };
                    }

                    return chunks.map(function (c) {
                        return c.join('');
                    });
                })([[]]);

                if (error) {
                    throw makeError(error);
                }

                // Sort rules by specificity: this function expects selectors to be
                // split already.
                //
                // Written to be used as a .sort(Function);
                // argument.
                //
                // [1, 0, 0, 467] > [0, 0, 1, 520]
                var specificitySort = function (a, b) {
                    var as = a.specificity;
                    var bs = b.specificity;

                    if (as[0] != bs[0]) {return bs[0] - as[0];}
                    if (as[1] != bs[1]) {return bs[1] - as[1];}
                    if (as[2] != bs[2]) {return bs[2] - as[2];}
                    return bs[3] - as[3];
                };

                // Start with the primary rule.
                // The whole syntax tree is held under a Ruleset node,
                // with the `root` property set to true, so no `{}` are
                // output.
                root = new CartoCSS.Tree.Ruleset([], _match(this.parsers.primary));
                root.root = true;

                // Get an array of Ruleset objects, flattened
                // and sorted according to specificitySort
                root.toList = (function () {
                    return function (env) {
                        env.error = function (e) {
                            if (!env.errors) {env.errors = new Error('');}
                            if (env.errors.message) {
                                env.errors.message += '\n' + makeError(e).message;
                            } else {
                                env.errors.message = makeError(e).message;
                            }
                        };
                        env.frames = env.frames || [];


                        // call populates Invalid-caused errors
                        var definitions = this.flatten([], [], env);
                        definitions.sort(specificitySort);
                        return definitions;
                    };
                })();

                return root;
            },

            // Here in, the parsing rules/functions
            //
            // The basic structure of the syntax tree generated is as follows:
            //
            //   Ruleset ->  Rule -> Value -> Expression -> Entity
            //
            //  In general, most rules will try to parse a token with the `_match()` function, and if the return
            //  value is truly, will return a new node, of the relevant type. Sometimes, we need to check
            //  first, before parsing, that's when we use `peek()`.
            parsers: {
                // The `primary` rule is the *entry* and *exit* point of the parser.
                // The rules here can appear at any level of the parse tree.
                //
                // The recursive nature of the grammar is an interplay between the `block`
                // rule, which represents `{ ... }`, the `ruleset` rule, and this `primary` rule,
                // as represented by this simplified grammar:
                //
                //     primary  â  (ruleset | rule)+
                //     ruleset  â  selector+ block
                //     block    â  '{' primary '}'
                //
                // Only at one point is the primary rule not called from the
                // block rule: at the root level.
                primary: function () {
                    var node, root = [];

                    while ((node = _match(this.rule) || _match(this.ruleset) ||
                        _match(this.comment)) ||
                    _match(/^[\s\n]+/) || (node = _match(this.invalid))) {
                        if (node) {root.push(node);}
                    }
                    return root;
                },

                invalid: function () {
                    var chunk = _match(/^[^;\n]*[;\n]/);

                    // To fail gracefully, match everything until a semicolon or linebreak.
                    if (chunk) {
                        return new CartoCSS.Tree.Invalid(chunk, memo);
                    }
                },

                // We create a Comment node for CSS comments `/* */`,
                // but keep the LeSS comments `//` silent, by just skipping
                // over them.
                comment: function () {
                    var comment;

                    if (input.charAt(i) !== '/') {return;}

                    if (input.charAt(i + 1) === '/') {
                        return new CartoCSS.Tree.Comment(_match(/^\/\/.*/), true);
                    } else if (comment = _match(/^\/\*(?:[^*]|\*+[^\/*])*\*+\/\n?/)) {
                        return new CartoCSS.Tree.Comment(comment);
                    }
                },

                // Entities are tokens which can be found inside an Expression
                entities: {

                    // A string, which supports escaping " and ' "milky way" 'he\'s the one!'
                    quoted: function () {
                        if (input.charAt(i) !== '"' && input.charAt(i) !== "'") {return;}
                        var str = _match(/^"((?:[^"\\\r\n]|\\.)*)"|'((?:[^'\\\r\n]|\\.)*)'/);
                        if (str) {
                            return new CartoCSS.Tree.Quoted(str[1] || str[2]);
                        }
                    },

                    // A reference to a Mapnik field, like [NAME]
                    // Behind the scenes, this has the same representation, but Carto
                    // needs to be careful to warn when unsupported operations are used.
                    field: function () {
                        var l = '[', r = ']';
                        if (!_match(l)) {return;}
                        var field_name = _match(/(^[^\]]+)/);
                        if (!_match(r)) {return;}
                        if (field_name) {return new CartoCSS.Tree.Field(field_name[1]);}
                    },

                    // This is a comparison operator
                    comparison: function () {
                        var str = _match(/^=~|=|!=|<=|>=|<|>/);
                        if (str) {
                            return str;
                        }
                    },

                    // A catch-all word, such as: hard-light
                    // These can start with either a letter or a dash (-),
                    // and then contain numbers, underscores, and letters.
                    keyword: function () {
                        var k = _match(/^[A-Za-z\u4e00-\u9fa5-]+[A-Za-z-0-9\u4e00-\u9fa5_]*/);
                        if (k) {
                            return new CartoCSS.Tree.Keyword(k);
                        }
                    },

                    // A function call like rgb(255, 0, 255)
                    // The arguments are parsed with the `entities.arguments` parser.
                    call: function () {
                        var name, args;

                        if (!(name = /^([\w\-]+|%)\(/.exec(chunks[j]))) {return;}

                        name = name[1];

                        if (name === 'url') {
                            // url() is handled by the url parser instead
                            return null;
                        } else {
                            i += name.length;
                        }

                        var l = '(', r = ')';
                        _match(l); // Parse the '(' and consume whitespace.

                        args = _match(this.entities['arguments']);

                        if (!_match(r)) {return;}

                        if (name) {
                            return new CartoCSS.Tree.Call(name, args, i);
                        }
                    },
                    // Arguments are comma-separated expressions
                    'arguments': function () {
                        var args = [], arg;

                        while (arg = _match(this.expression)) {
                            args.push(arg);
                            var q = ',';
                            if (!_match(q)) {
                                break;
                            }
                        }

                        return args;
                    },
                    literal: function () {
                        return _match(this.entities.dimension) ||
                            _match(this.entities.keywordcolor) ||
                            _match(this.entities.hexcolor) ||
                            _match(this.entities.quoted);
                    },

                    // Parse url() tokens
                    //
                    // We use a specific rule for urls, because they don't really behave like
                    // standard function calls. The difference is that the argument doesn't have
                    // to be enclosed within a string, so it can't be parsed as an Expression.
                    url: function () {
                        var value;

                        if (input.charAt(i) !== 'u' || !_match(/^url\(/)) {return;}
                        value = _match(this.entities.quoted) || _match(this.entities.variable) ||
                            _match(/^[\-\w%@_match\/.&=:;#+?~]+/) || '';
                        var r = ')';
                        if (!_match(r)) {
                            return new CartoCSS.Tree.Invalid(value, memo, 'Missing closing ) in URL.');
                        } else {
                            return new CartoCSS.Tree.URL((typeof value.value !== 'undefined' ||
                                value instanceof CartoCSS.Tree.Variable) ?
                                value : new CartoCSS.Tree.Quoted(value));
                        }
                    },

                    // A Variable entity, such as `@fink`, in
                    //
                    //     width: @fink + 2px
                    //
                    // We use a different parser for variable definitions,
                    // see `parsers.variable`.
                    variable: function () {
                        var name, index = i;

                        if (input.charAt(i) === '@' && (name = _match(/^@[\w-]+/))) {
                            return new CartoCSS.Tree.Variable(name, index, env.filename);
                        }
                    },

                    hexcolor: function () {
                        var rgb;
                        if (input.charAt(i) === '#' && (rgb = _match(/^#([a-fA-F0-9]{6}|[a-fA-F0-9]{3})/))) {
                            return new CartoCSS.Tree.Color(rgb[1]);
                        }
                    },

                    keywordcolor: function () {
                        var rgb = chunks[j].match(/^[a-z]+/);
                        if (rgb && rgb[0] in CartoCSS.Tree.Reference.data.colors) {
                            return new CartoCSS.Tree.Color(CartoCSS.Tree.Reference.data.colors[_match(/^[a-z]+/)]);
                        }
                    },

                    // A Dimension, that is, a number and a unit. The only
                    // unit that has an effect is %
                    dimension: function () {
                        var c = input.charCodeAt(i);
                        if ((c > 57 || c < 45) || c === 47) {return;}
                        var value = _match(/^(-?\d*\.?\d+(?:[eE][-+]?\d+)?)(\%|\w+)?/);
                        if (value) {
                            return new CartoCSS.Tree.Dimension(value[1], value[2], memo);
                        }
                    }
                },

                // The variable part of a variable definition.
                // Used in the `rule` parser. Like @fink:
                variable: function () {
                    var name;

                    if (input.charAt(i) === '@' && (name = _match(/^(@[\w-]+)\s*:/))) {
                        return name[1];
                    }
                },

                // Entities are the smallest recognized token,
                // and can be found inside a rule's value.
                entity: function () {
                    var property1 = _match(this.entities.call) || _match(this.entities.literal);
                    var property2 = _match(this.entities.field) || _match(this.entities.variable);
                    var property3 = _match(this.entities.url) || _match(this.entities.keyword);
                    return property1 || property2 || property3;
                },

                // A Rule terminator. Note that we use `peek()` to check for '}',
                // because the `block` rule will be expecting it, but we still need to make sure
                // it's there, if ';' was ommitted.
                end: function () {
                    var q = ';';
                    return _match(q) || peek('}');
                },

                // Elements are the building blocks for Selectors. They consist of
                // an element name, such as a tag a class, or `*`.
                //å¢å å¯¹ä¸­æçæ¯æï¼[\u4e00-\u9fa5]
                element: function () {
                    var e = _match(/^(?:[.#][\w\u4e00-\u9fa5\-]+|\*|Map)/);
                    if (e) {return new CartoCSS.Tree.Element(e);}
                },

                // Attachments allow adding multiple lines, polygons etc. to an
                // object. There can only be one attachment per selector.
                attachment: function () {
                    var s = _match(/^::([\w\-]+(?:\/[\w\-]+)*)/);
                    if (s) {return s[1];}
                },

                // Selectors are made out of one or more Elements, see above.
                selector: function () {
                    var a, attachment,
                        e, elements = [],
                        f, filters = new CartoCSS.Tree.Filterset(),
                        z, zooms = [],
                        segments = 0, conditions = 0;

                    while (
                        (e = _match(this.element)) ||
                        (z = _match(this.zoom)) ||
                        (f = _match(this.filter)) ||
                        (a = _match(this.attachment))
                        ) {
                        segments++;
                        if (e) {
                            elements.push(e);
                        } else if (z) {
                            zooms.push(z);
                            conditions++;
                        } else if (f) {
                            var err = filters.add(f);
                            if (err) {
                                throw makeError({
                                    message: err,
                                    index: i - 1
                                });
                            }
                            conditions++;
                        } else if (attachment) {
                            throw makeError({
                                message: 'Encountered second attachment name.',
                                index: i - 1
                            });
                        } else {
                            attachment = a;
                        }

                        var c = input.charAt(i);
                        if (c === '{' || c === '}' || c === ';' || c === ',') {
                            break;
                        }
                    }

                    if (segments) {
                        return new CartoCSS.Tree.Selector(filters, zooms, elements, attachment, conditions, memo);
                    }
                },

                filter: function () {
                    save();
                    var key, op, val, l = '[', r = ']';
                    if (!_match(l)) {return;}
                    if (key = _match(/^[a-zA-Z0-9\-_]+/) ||
                            _match(this.entities.quoted) ||
                            _match(this.entities.variable) ||
                            _match(this.entities.keyword) ||
                            _match(this.entities.field)) {
                        if (key instanceof CartoCSS.Tree.Quoted) {
                            key = new CartoCSS.Tree.Field(key.toString());
                        }
                        if ((op = _match(this.entities.comparison)) &&
                            (val = _match(this.entities.quoted) ||
                                _match(this.entities.variable) ||
                                _match(this.entities.dimension) ||
                                _match(this.entities.keyword) ||
                                _match(this.entities.field))) {
                            if (!_match(r)) {
                                throw makeError({
                                    message: 'Missing closing ] of filter.',
                                    index: memo - 1
                                });
                            }
                            if (!key.is) {key = new CartoCSS.Tree.Field(key);}
                            return new CartoCSS.Tree.Filter(key, op, val, memo, env.filename);
                        }
                    }
                },

                zoom: function () {
                    save();
                    var op, val, r = ']';
                    if (_match(/^\[\s*zoom/g) &&
                        (op = _match(this.entities.comparison)) &&
                        (val = _match(this.entities.variable) || _match(this.entities.dimension)) && _match(r)) {
                        return new CartoCSS.Tree.Zoom(op, val, memo);
                    } else {
                        // backtrack
                        restore();
                    }
                },

                // The `block` rule is used by `ruleset`
                // It's a wrapper around the `primary` rule, with added `{}`.
                block: function () {
                    var content, l = '{', r = '}';

                    if (_match(l) && (content = _match(this.primary)) && _match(r)) {
                        return content;
                    }
                },

                // div, .class, body > p {...}
                ruleset: function () {
                    var selectors = [], s, rules, q = ',';
                    save();

                    while (s = _match(this.selector)) {
                        selectors.push(s);
                        while (_match(this.comment)) {//NOSONAR
                        }
                        if (!_match(q)) {
                            break;
                        }
                        while (_match(this.comment)) {//NOSONAR
                        }
                    }
                    if (s) {
                        while (_match(this.comment)) {//NOSONAR
                        }
                    }

                    if (selectors.length > 0 && (rules = _match(this.block))) {
                        if (selectors.length === 1 &&
                            selectors[0].elements.length &&
                            selectors[0].elements[0].value === 'Map') {
                            var rs = new CartoCSS.Tree.Ruleset(selectors, rules);
                            rs.isMap = true;
                            return rs;
                        }
                        return new CartoCSS.Tree.Ruleset(selectors, rules);
                    } else {
                        // Backtrack
                        restore();
                    }
                },

                rule: function () {
                    var name, value, c = input.charAt(i);
                    save();

                    if (c === '.' || c === '#') {
                        return;
                    }

                    if (name = _match(this.variable) || _match(this.property)) {
                        value = _match(this.value);

                        if (value && _match(this.end)) {
                            return new CartoCSS.Tree.Rule(name, value, memo, env.filename);
                        } else {
                            furthest = i;
                            restore();
                        }
                    }
                },

                font: function () {
                    var value = [], expression = [], e, q = ',';

                    while (e = _match(this.entity)) {
                        expression.push(e);
                    }

                    value.push(new CartoCSS.Tree.Expression(expression));

                    if (_match(q)) {
                        while (e = _match(this.expression)) {
                            value.push(e);
                            if (!_match(q)) {
                                break;
                            }
                        }
                    }
                    return new CartoCSS.Tree.Value(value);
                },

                // A Value is a comma-delimited list of Expressions
                // In a Rule, a Value represents everything after the `:`,
                // and before the `;`.
                value: function () {
                    var e, expressions = [], q = ',';

                    while (e = _match(this.expression)) {
                        expressions.push(e);
                        if (!_match(q)) {
                            break;
                        }
                    }

                    if (expressions.length > 1) {
                        return new CartoCSS.Tree.Value(expressions.map(function (e) {
                            return e.value[0];
                        }));
                    } else if (expressions.length === 1) {
                        return new CartoCSS.Tree.Value(expressions);
                    }
                },
                // A sub-expression, contained by parenthensis
                sub: function () {
                    var e, l = '(', r = ")";
                    if (_match(l) && (e = _match(this.expression)) && _match(r)) {
                        return e;
                    }
                },
                // This is a misnomer because it actually handles multiplication
                // and division.
                multiplication: function () {
                    var m, a, op, operation, q = '/';
                    if (m = _match(this.operand)) {
                        while ((op = (_match(q) || _match('*') || _match('%'))) && (a = _match(this.operand))) {
                            operation = new CartoCSS.Tree.Operation(op, [operation || m, a], memo);
                        }
                        return operation || m;
                    }
                },
                addition: function () {
                    var m, a, op, operation, plus = '+';
                    if (m = _match(this.multiplication)) {
                        while ((op = _match(/^[-+]\s+/) || (input.charAt(i - 1) != ' ' && (_match(plus) || _match('-')))) &&
                        (a = _match(this.multiplication))) {
                            operation = new CartoCSS.Tree.Operation(op, [operation || m, a], memo);
                        }
                        return operation || m;
                    }
                },

                // An operand is anything that can be part of an operation,
                // such as a Color, or a Variable
                operand: function () {
                    return _match(this.sub) || _match(this.entity);
                },

                // Expressions either represent mathematical operations,
                // or white-space delimited Entities.  @var * 2
                expression: function () {
                    var e, entities = [];

                    while (e = _match(this.addition) || _match(this.entity)) {
                        entities.push(e);
                    }

                    if (entities.length > 0) {
                        return new CartoCSS.Tree.Expression(entities);
                    }
                },
                property: function () {
                    var name = _match(/^(([a-z][-a-z_0-9]*\/)?\*?-?[-a-z_0-9]+)\s*:/);
                    if (name) {return name[1];}
                }
            }
        };
        return parser;
    }


    /**
     * @function CartoCSS.prototype.parse
     * @description å©ç¨CartoCSSè§£æå¨éé¢çparseæ¹æ³ï¼å°CartoCSSæ ·å¼è¡¨å­ç¬¦ä¸²è½¬åä¸ºCartoCSSè§åé
     * @returns {Object} CartoCSSè§åé
     */
    parse(str) {
        var parser = this.parser;
        var ruleSet = this.ruleSet = parser.parse(str);
        return ruleSet;
    }


    /**
     * @function CartoCSS.prototype.toShaders
     * @description å°CartoCSSè§åéè½¬åä¸ºçè²å¨
     * @returns {Array} CartoCSSçè²å¨é
     */
    toShaders() {
        if (this.ruleSet) {
            var ruleset = this.ruleSet;
            if (ruleset) {
                var defs = ruleset.toList(this.env);
                defs.reverse();

                var shaders = {};
                var keys = [];
                this._toShaders(shaders,keys,defs);

                var ordered_shaders = [];

                var done = {};
                for (var i = 0, len0 = defs.length; i < len0; ++i) {
                    var def = defs[i];
                    var k = def.attachment;
                    var shader = shaders[keys[i]];
                    var shaderArray = [];
                    if (!done[k]) {
                        var j = 0;
                        for (var prop in shader) {
                            if (prop !== 'zoom' && prop !== 'frames' && prop !== "attachment" && prop != "elements") {
                                //å¯¹layer-indexä½ç¹æ®å¤çä»¥å®ç°å¾å±çæ§å¶
                                if (prop === "layer-index") {
                                    /*var getLayerIndex = Function("attributes", "zoom", "var _value = null;" + shader[prop].join('\n') + "; return _value; ");*/
                                    var getLayerIndex = function (attributes, zoom) {//NOSONAR
                                        var _value = null;
                                        shader[prop].join('\n');
                                        return _value;
                                    };
                                    var layerIndex = getLayerIndex();
                                    Object.defineProperty(shaderArray, "layerIndex", {
                                        configurable: true,
                                        enumerable: false,
                                        value: layerIndex
                                    });
                                } else {
                                    shaderArray[j++] = function (ops, shaderArray) {//NOSONAR
                                        if (!Array.isArray(ops)) {
                                            return ops;
                                        }
                                        var body = ops.join('\n');
                                        var myKeyword = 'attributes["FEATUREID"]&&attributes["FEATUREID"]';
                                        var index = body.indexOf(myKeyword);
                                        if (index >= 0) {
                                            //å¯¹featureIDä½ä¸äºç¹æ®å¤çï¼ä»¥å°featureIDæååºæ¥
                                            if (!shaderArray.featureFilter) {
                                                var featureFilterStart = index + myKeyword.length;
                                                var featureFilterEnd = body.indexOf(")", featureFilterStart + 1);
                                                var featureFilterStr = "featureId&&(featureId" + body.substring(featureFilterStart, featureFilterEnd) + ")";
                                                /*var featureFilter = Function("featureId", "if(" + featureFilterStr + "){return true;}return false;");*/
                                                var featureFilter = function (featureId) {
                                                    if (featureFilterStr) {
                                                        return true;
                                                    }
                                                    return false;
                                                }
                                                Object.defineProperty(shaderArray, "featureFilter", {
                                                    configurable: true,
                                                    enumerable: false,
                                                    value: featureFilter
                                                });
                                            }
                                            return {
                                                "property": prop,
                                                "getValue": Function("attributes", "zoom", "seftFilter", "var _value = null; var isExcute=typeof seftFilter=='function'?sefgFilter():seftFilter;if(isExcute){" + body + ";} return _value; ")//NOSONAR
                                            };
                                        } else {
                                            return {
                                                "property": prop,
                                                "getValue": Function("attributes", "zoom", "var _value = null;" + body + "; return _value; ")//NOSONAR
                                            };
                                        }
                                    }(shader[prop], shaderArray);
                                }
                            }
                        }
                        Object.defineProperty(shaderArray, "attachment", {
                            configurable: true,
                            enumerable: false,
                            value: k
                        });
                        Object.defineProperty(shaderArray, "elements", {
                            configurable: true,
                            enumerable: false,
                            value: def.elements
                        });
                        ordered_shaders.push(shaderArray);
                        done[keys[i]] = true;
                    }
                    Object.defineProperty(shaderArray, "zoom", {
                        configurable: true,
                        enumerable: false,
                        value: def.zoom
                    });
                    //shader.frames.push(def.frame_offset);
                }
                return ordered_shaders;
            }
        }
        return null;
    }

    _toShaders(shaders, keys,defs) {
        for (let i = 0, len0 = defs.length; i < len0; ++i) {
            let def = defs[i];
            let element_str = [];
            for (let j = 0, len1 = def.elements.length; j < len1; j++) {
                element_str.push(def.elements[j]);
            }
            let filters = def.filters.filters;
            let filterStr = [];
            for (let attr in filters) {
                filterStr.push(filters[attr].id);
            }
            let key = element_str.join("/") + "::" + def.attachment + "_" + filterStr.join("_");
            keys.push(key);
            let shader = shaders[key] = (shaders[key] || {});
            //shader.frames = [];
            shader.zoom = CartoCSS.Tree.Zoom.all;
            let props = def.toJS(this.env);
            for (let v in props) {
                (shader[v] = (shader[v] || [])).push(props[v].join('\n'))
            }
        }
    }
    /**
     * @function CartoCSS.prototype.getShaders
     * @description è·åCartoCSSçè²å¨
     * @returns {Array} çè²å¨é
     * @example
     *   //shadersçç»æå¤§æ¦å¦ä¸ï¼
     *   var shaders=[
     *   {
     *       attachment:"one",
     *       elements:[],
     *       zoom:23,
     *       length:2,
     *       0:{property:"line-color",value:function(attribute,zoom){var _value=null;if(zoom){_value="#123456"}return _vlaue;}},
     *       1:{preoperty:"line-width",value:function(attribute,zoom){var _value=null;if(zoom){_value=3}return _vlaue;}}
     *   },
     *   {
     *       attachment:"two",
     *       elements:[],
     *       zoom:23,
     *       length:2,
     *       0:{property:"polygon-color",value:function(attribute,zoom){var _value=null;if(zoom){_value="#123456"}return _vlaue;}},
     *       1:{property:"line-width",value:function(attribute,zoom){var _value=null;if(zoom){_value=3}return _vlaue;}}
     *   }
     *   ];
     */
    getShaders() {
        return this.shaders;
    }

    /**
     * @function CartoCSS.prototype.destroy
     * @description CartoCSSè§£æå¯¹è±¡çææå½æ°ï¼ç¨äºéæ¯CartoCSSè§£æå¯¹è±¡
     */
    destroy() {
        this.cartoStr = null;
        this.env = null;
        this.ruleSet = null;
        this.parser = null;
        this.shaders = null;
    }

}

var _mapnik_reference_latest = {
    "version": "2.1.1",
    "style": {
        "filter-mode": {
            "type": [
                "all",
                "first"
            ],
            "doc": "Control the processing behavior of Rule filters within a Style. If 'all' is used then all Rules are processed sequentially independent of whether any previous filters matched. If 'first' is used then it means processing ends after the first match (a positive filter evaluation) and no further Rules in the Style are processed ('first' is usually the default for CSS implementations on top of Mapnik to simplify translation from CSS to Mapnik XML)",
            "default-value": "all",
            "default-meaning": "All Rules in a Style are processed whether they have filters or not and whether or not the filter conditions evaluate to true."
        },
        "image-filters": {
            "css": "image-filters",
            "default-value": "none",
            "default-meaning": "no filters",
            "type": "functions",
            "functions": [
                ["agg-stack-blur", 2],
                ["emboss", 0],
                ["blur", 0],
                ["gray", 0],
                ["sobel", 0],
                ["edge-detect", 0],
                ["x-gradient", 0],
                ["y-gradient", 0],
                ["invert", 0],
                ["sharpen", 0]
            ],
            "doc": "A list of image filters."
        },
        "comp-op": {
            "css": "comp-op",
            "default-value": "src-over",
            "default-meaning": "add the current layer on top of other layers",
            "doc": "Composite operation. This defines how this layer should behave relative to layers atop or below it.",
            "type": ["clear",
                "src",
                "dst",
                "src-over",
                "dst-over",
                "src-in",
                "dst-in",
                "src-out",
                "dst-out",
                "src-atop",
                "dst-atop",
                "xor",
                "plus",
                "minus",
                "multiply",
                "screen",
                "overlay",
                "darken",
                "lighten",
                "color-dodge",
                "color-burn",
                "hard-light",
                "soft-light",
                "difference",
                "exclusion",
                "contrast",
                "invert",
                "invert-rgb",
                "grain-merge",
                "grain-extract",
                "hue",
                "saturation",
                "color",
                "value"
            ]
        },
        "opacity": {
            "css": "opacity",
            "type": "float",
            "doc": "An alpha value for the style (which means an alpha applied to all features in separate buffer and then composited back to main buffer)",
            "default-value": 1,
            "default-meaning": "no separate buffer will be used and no alpha will be applied to the style after rendering"
        }
    },
    "layer": {
        "name": {
            "default-value": "",
            "type": "string",
            "required": true,
            "default-meaning": "No layer name has been provided",
            "doc": "The name of a layer. Can be anything you wish and is not strictly validated, but ideally unique  in the map"
        },
        "srs": {
            "default-value": "",
            "type": "string",
            "default-meaning": "No srs value is provided and the value will be inherited from the Map's srs",
            "doc": "The spatial reference system definition for the layer, aka the projection. Can either be a proj4 literal string like '+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs' or, if the proper proj4 epsg/nad/etc identifier files are installed, a string that uses an id like: '+init=epsg:4326'"
        },
        "status": {
            "default-value": true,
            "type": "boolean",
            "default-meaning": "This layer will be marked as active and available for processing",
            "doc": "A property that can be set to false to disable this layer from being processed"
        },
        "minzoom": {
            "default-value": "0",
            "type": "float",
            "default-meaning": "The layer will be visible at the minimum possible scale",
            "doc": "The minimum scale denominator that this layer will be visible at. A layer's visibility is determined by whether its status is true and if the Map scale >= minzoom - 1e-6 and scale < maxzoom + 1e-6"
        },
        "maxzoom": {
            "default-value": "1.79769e+308",
            "type": "float",
            "default-meaning": "The layer will be visible at the maximum possible scale",
            "doc": "The maximum scale denominator that this layer will be visible at. The default is the numeric limit of the C++ double type, which may vary slightly by system, but is likely a massive number like 1.79769e+308 and ensures that this layer will always be visible unless the value is reduced. A layer's visibility is determined by whether its status is true and if the Map scale >= minzoom - 1e-6 and scale < maxzoom + 1e-6"
        },
        "queryable": {
            "default-value": false,
            "type": "boolean",
            "default-meaning": "The layer will not be available for the direct querying of data values",
            "doc": "This property was added for GetFeatureInfo/WMS compatibility and is rarely used. It is off by default meaning that in a WMS context the layer will not be able to be queried unless the property is explicitly set to true"
        },
        "clear-label-cache": {
            "default-value": false,
            "type": "boolean",
            "default-meaning": "The renderer's collision detector cache (used for avoiding duplicate labels and overlapping markers) will not be cleared immediately before processing this layer",
            "doc": "This property, by default off, can be enabled to allow a user to clear the collision detector cache before a given layer is processed. This may be desirable to ensure that a given layers data shows up on the map even if it normally would not because of collisions with previously rendered labels or markers"
        },
        "group-by": {
            "default-value": "",
            "type": "string",
            "default-meaning": "No special layer grouping will be used during rendering",
            "doc": "https://github.com/mapnik/mapnik/wiki/Grouped-rendering"
        },
        "buffer-size": {
            "default-value": "0",
            "type": "float",
            "default-meaning": "No buffer will be used",
            "doc": "Extra tolerance around the Layer extent (in pixels) used to when querying and (potentially) clipping the layer data during rendering"
        },
        "maximum-extent": {
            "default-value": "none",
            "type": "bbox",
            "default-meaning": "No clipping extent will be used",
            "doc": "An extent to be used to limit the bounds used to query this specific layer data during rendering. Should be minx, miny, maxx, maxy in the coordinates of the Layer."
        }
    },
    "symbolizers": {
        "*": {
            "image-filters": {
                "css": "image-filters",
                "default-value": "none",
                "default-meaning": "no filters",
                "type": "functions",
                "functions": [
                    ["agg-stack-blur", 2],
                    ["emboss", 0],
                    ["blur", 0],
                    ["gray", 0],
                    ["sobel", 0],
                    ["edge-detect", 0],
                    ["x-gradient", 0],
                    ["y-gradient", 0],
                    ["invert", 0],
                    ["sharpen", 0]
                ],
                "doc": "A list of image filters."
            },
            "comp-op": {
                "css": "comp-op",
                "default-value": "src-over",
                "default-meaning": "add the current layer on top of other layers",
                "doc": "Composite operation. This defines how this layer should behave relative to layers atop or below it.",
                "type": ["clear",
                    "src",
                    "dst",
                    "src-over",
                    "dst-over",
                    "src-in",
                    "dst-in",
                    "src-out",
                    "dst-out",
                    "src-atop",
                    "dst-atop",
                    "xor",
                    "plus",
                    "minus",
                    "multiply",
                    "screen",
                    "overlay",
                    "darken",
                    "lighten",
                    "color-dodge",
                    "color-burn",
                    "hard-light",
                    "soft-light",
                    "difference",
                    "exclusion",
                    "contrast",
                    "invert",
                    "invert-rgb",
                    "grain-merge",
                    "grain-extract",
                    "hue",
                    "saturation",
                    "color",
                    "value"
                ]
            },
            "opacity": {
                "css": "opacity",
                "type": "float",
                "doc": "An alpha value for the style (which means an alpha applied to all features in separate buffer and then composited back to main buffer)",
                "default-value": 1,
                "default-meaning": "no separate buffer will be used and no alpha will be applied to the style after rendering"
            }
        },
        "map": {
            "background-color": {
                "css": "background-color",
                "default-value": "none",
                "default-meaning": "transparent",
                "type": "color",
                "doc": "Map Background color"
            },
            "background-image": {
                "css": "background-image",
                "type": "uri",
                "default-value": "",
                "default-meaning": "transparent",
                "doc": "An image that is repeated below all features on a map as a background.",
                "description": "Map Background image"
            },
            "srs": {
                "css": "srs",
                "type": "string",
                "default-value": "+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs",
                "default-meaning": "The proj4 literal of EPSG:4326 is assumed to be the Map's spatial reference and all data from layers within this map will be plotted using this coordinate system. If any layers do not declare an srs value then they will be assumed to be in the same srs as the Map and not transformations will be needed to plot them in the Map's coordinate space",
                "doc": "Map spatial reference (proj4 string)"
            },
            "buffer-size": {
                "css": "buffer-size",
                "default-value": "0",
                "type": "float",
                "default-meaning": "No buffer will be used",
                "doc": "Extra tolerance around the map (in pixels) used to ensure labels crossing tile boundaries are equally rendered in each tile (e.g. cut in each tile). Not intended to be used in combination with \"avoid-edges\"."
            },
            "maximum-extent": {
                "css": "",
                "default-value": "none",
                "type": "bbox",
                "default-meaning": "No clipping extent will be used",
                "doc": "An extent to be used to limit the bounds used to query all layers during rendering. Should be minx, miny, maxx, maxy in the coordinates of the Map."
            },
            "base": {
                "css": "base",
                "default-value": "",
                "default-meaning": "This base path defaults to an empty string meaning that any relative paths to files referenced in styles or layers will be interpreted relative to the application process.",
                "type": "string",
                "doc": "Any relative paths used to reference files will be understood as relative to this directory path if the map is loaded from an in memory object rather than from the filesystem. If the map is loaded from the filesystem and this option is not provided it will be set to the directory of the stylesheet."
            },
            "paths-from-xml": {
                "css": "",
                "default-value": true,
                "default-meaning": "Paths read from XML will be interpreted from the location of the XML",
                "type": "boolean",
                "doc": "value to control whether paths in the XML will be interpreted from the location of the XML or from the working directory of the program that calls load_map()"
            },
            "minimum-version": {
                "css": "",
                "default-value": "none",
                "default-meaning": "Mapnik version will not be detected and no error will be thrown about compatibility",
                "type": "string",
                "doc": "The minumum Mapnik version (e.g. 0.7.2) needed to use certain functionality in the stylesheet"
            },
            "font-directory": {
                "css": "font-directory",
                "type": "uri",
                "default-value": "none",
                "default-meaning": "No map-specific fonts will be registered",
                "doc": "Path to a directory which holds fonts which should be registered when the Map is loaded (in addition to any fonts that may be automatically registered)."
            }
        },
        "polygon": {
            "fill": {
                "css": "polygon-fill",
                "type": "color",
                "default-value": "rgba(128,128,128,1)",
                "default-meaning": "gray and fully opaque (alpha = 1), same as rgb(128,128,128)",
                "doc": "Fill color to assign to a polygon"
            },
            "fill-opacity": {
                "css": "polygon-opacity",
                "type": "float",
                "doc": "The opacity of the polygon",
                "default-value": 1,
                "default-meaning": "opaque"
            },
            "gamma": {
                "css": "polygon-gamma",
                "type": "float",
                "default-value": 1,
                "default-meaning": "fully antialiased",
                "range": "0-1",
                "doc": "Level of antialiasing of polygon edges"
            },
            "gamma-method": {
                "css": "polygon-gamma-method",
                "type": [
                    "power",
                    "linear",
                    "none",
                    "threshold",
                    "multiply"
                ],
                "default-value": "power",
                "default-meaning": "pow(x,gamma) is used to calculate pixel gamma, which produces slightly smoother line and polygon antialiasing than the 'linear' method, while other methods are usually only used to disable AA",
                "doc": "An Antigrain Geometry specific rendering hint to control the quality of antialiasing. Under the hood in Mapnik this method is used in combination with the 'gamma' value (which defaults to 1). The methods are in the AGG source at https://github.com/mapnik/mapnik/blob/master/deps/agg/include/agg_gamma_functions.h"
            },
            "clip": {
                "css": "polygon-clip",
                "type": "boolean",
                "default-value": true,
                "default-meaning": "geometry will be clipped to map bounds before rendering",
                "doc": "geometries are clipped to map bounds by default for best rendering performance. In some cases users may wish to disable this to avoid rendering artifacts."
            },
            "smooth": {
                "css": "polygon-smooth",
                "type": "float",
                "default-value": 0,
                "default-meaning": "no smoothing",
                "range": "0-1",
                "doc": "Smooths out geometry angles. 0 is no smoothing, 1 is fully smoothed. Values greater than 1 will produce wild, looping geometries."
            },
            "geometry-transform": {
                "css": "polygon-geometry-transform",
                "type": "functions",
                "default-value": "none",
                "default-meaning": "geometry will not be transformed",
                "doc": "Allows transformation functions to be applied to the geometry.",
                "functions": [
                    ["matrix", 6],
                    ["translate", 2],
                    ["scale", 2],
                    ["rotate", 3],
                    ["skewX", 1],
                    ["skewY", 1]
                ]
            },
            "comp-op": {
                "css": "polygon-comp-op",
                "default-value": "src-over",
                "default-meaning": "add the current symbolizer on top of other symbolizer",
                "doc": "Composite operation. This defines how this symbolizer should behave relative to symbolizers atop or below it.",
                "type": ["clear",
                    "src",
                    "dst",
                    "src-over",
                    "dst-over",
                    "src-in",
                    "dst-in",
                    "src-out",
                    "dst-out",
                    "src-atop",
                    "dst-atop",
                    "xor",
                    "plus",
                    "minus",
                    "multiply",
                    "screen",
                    "overlay",
                    "darken",
                    "lighten",
                    "color-dodge",
                    "color-burn",
                    "hard-light",
                    "soft-light",
                    "difference",
                    "exclusion",
                    "contrast",
                    "invert",
                    "invert-rgb",
                    "grain-merge",
                    "grain-extract",
                    "hue",
                    "saturation",
                    "color",
                    "value"
                ]
            }
        },
        "line": {
            "stroke": {
                "css": "line-color",
                "default-value": "rgba(0,0,0,1)",
                "type": "color",
                "default-meaning": "black and fully opaque (alpha = 1), same as rgb(0,0,0)",
                "doc": "The color of a drawn line"
            },
            "stroke-width": {
                "css": "line-width",
                "default-value": 1,
                "type": "float",
                "doc": "The width of a line in pixels"
            },
            "stroke-opacity": {
                "css": "line-opacity",
                "default-value": 1,
                "type": "float",
                "default-meaning": "opaque",
                "doc": "The opacity of a line"
            },
            "stroke-linejoin": {
                "css": "line-join",
                "default-value": "miter",
                "type": [
                    "miter",
                    "round",
                    "bevel"
                ],
                "doc": "The behavior of lines when joining"
            },
            "stroke-linecap": {
                "css": "line-cap",
                "default-value": "butt",
                "type": [
                    "butt",
                    "round",
                    "square"
                ],
                "doc": "The display of line endings"
            },
            "stroke-gamma": {
                "css": "line-gamma",
                "type": "float",
                "default-value": 1,
                "default-meaning": "fully antialiased",
                "range": "0-1",
                "doc": "Level of antialiasing of stroke line"
            },
            "stroke-gamma-method": {
                "css": "line-gamma-method",
                "type": [
                    "power",
                    "linear",
                    "none",
                    "threshold",
                    "multiply"
                ],
                "default-value": "power",
                "default-meaning": "pow(x,gamma) is used to calculate pixel gamma, which produces slightly smoother line and polygon antialiasing than the 'linear' method, while other methods are usually only used to disable AA",
                "doc": "An Antigrain Geometry specific rendering hint to control the quality of antialiasing. Under the hood in Mapnik this method is used in combination with the 'gamma' value (which defaults to 1). The methods are in the AGG source at https://github.com/mapnik/mapnik/blob/master/deps/agg/include/agg_gamma_functions.h"
            },
            "stroke-dasharray": {
                "css": "line-dasharray",
                "type": "numbers",
                "doc": "A pair of length values [a,b], where (a) is the dash length and (b) is the gap length respectively. More than two values are supported for more complex patterns.",
                "default-value": "none",
                "default-meaning": "solid line"
            },
            "stroke-dashoffset": {
                "css": "line-dash-offset",
                "type": "numbers",
                "doc": "valid parameter but not currently used in renderers (only exists for experimental svg support in Mapnik which is not yet enabled)",
                "default-value": "none",
                "default-meaning": "solid line"
            },
            "stroke-miterlimit": {
                "css": "line-miterlimit",
                "type": "float",
                "doc": "The limit on the ratio of the miter length to the stroke-width. Used to automatically convert miter joins to bevel joins for sharp angles to avoid the miter extending beyond the thickness of the stroking path. Normally will not need to be set, but a larger value can sometimes help avoid jaggy artifacts.",
                "default-value": 4.0,
                "default-meaning": "Will auto-convert miters to bevel line joins when theta is less than 29 degrees as per the SVG spec: 'miterLength / stroke-width = 1 / sin ( theta / 2 )'"
            },
            "clip": {
                "css": "line-clip",
                "type": "boolean",
                "default-value": true,
                "default-meaning": "geometry will be clipped to map bounds before rendering",
                "doc": "geometries are clipped to map bounds by default for best rendering performance. In some cases users may wish to disable this to avoid rendering artifacts."
            },
            "smooth": {
                "css": "line-smooth",
                "type": "float",
                "default-value": 0,
                "default-meaning": "no smoothing",
                "range": "0-1",
                "doc": "Smooths out geometry angles. 0 is no smoothing, 1 is fully smoothed. Values greater than 1 will produce wild, looping geometries."
            },
            "offset": {
                "css": "line-offset",
                "type": "float",
                "default-value": 0,
                "default-meaning": "no offset",
                "doc": "Offsets a line a number of pixels parallel to its actual path. Postive values move the line left, negative values move it right (relative to the directionality of the line)."
            },
            "rasterizer": {
                "css": "line-rasterizer",
                "type": [
                    "full",
                    "fast"
                ],
                "default-value": "full",
                "doc": "Exposes an alternate AGG rendering method that sacrifices some accuracy for speed."
            },
            "geometry-transform": {
                "css": "line-geometry-transform",
                "type": "functions",
                "default-value": "none",
                "default-meaning": "geometry will not be transformed",
                "doc": "Allows transformation functions to be applied to the geometry.",
                "functions": [
                    ["matrix", 6],
                    ["translate", 2],
                    ["scale", 2],
                    ["rotate", 3],
                    ["skewX", 1],
                    ["skewY", 1]
                ]
            },
            "comp-op": {
                "css": "line-comp-op",
                "default-value": "src-over",
                "default-meaning": "add the current symbolizer on top of other symbolizer",
                "doc": "Composite operation. This defines how this symbolizer should behave relative to symbolizers atop or below it.",
                "type": ["clear",
                    "src",
                    "dst",
                    "src-over",
                    "dst-over",
                    "src-in",
                    "dst-in",
                    "src-out",
                    "dst-out",
                    "src-atop",
                    "dst-atop",
                    "xor",
                    "plus",
                    "minus",
                    "multiply",
                    "screen",
                    "overlay",
                    "darken",
                    "lighten",
                    "color-dodge",
                    "color-burn",
                    "hard-light",
                    "soft-light",
                    "difference",
                    "exclusion",
                    "contrast",
                    "invert",
                    "invert-rgb",
                    "grain-merge",
                    "grain-extract",
                    "hue",
                    "saturation",
                    "color",
                    "value"
                ]
            }
        },
        "markers": {
            "file": {
                "css": "marker-file",
                "doc": "An SVG file that this marker shows at each placement. If no file is given, the marker will show an ellipse.",
                "default-value": "",
                "default-meaning": "An ellipse or circle, if width equals height",
                "type": "uri"
            },
            "opacity": {
                "css": "marker-opacity",
                "doc": "The overall opacity of the marker, if set, overrides both the opacity of both the fill and stroke",
                "default-value": 1,
                "default-meaning": "The stroke-opacity and fill-opacity will be used",
                "type": "float"
            },
            "fill-opacity": {
                "css": "marker-fill-opacity",
                "doc": "The fill opacity of the marker",
                "default-value": 1,
                "default-meaning": "opaque",
                "type": "float"
            },
            "stroke": {
                "css": "marker-line-color",
                "doc": "The color of the stroke around a marker shape.",
                "default-value": "black",
                "type": "color"
            },
            "stroke-width": {
                "css": "marker-line-width",
                "doc": "The width of the stroke around a marker shape, in pixels. This is positioned on the boundary, so high values can cover the area itself.",
                "type": "float"
            },
            "stroke-opacity": {
                "css": "marker-line-opacity",
                "default-value": 1,
                "default-meaning": "opaque",
                "doc": "The opacity of a line",
                "type": "float"
            },
            "placement": {
                "css": "marker-placement",
                "type": [
                    "point",
                    "line",
                    "interior"
                ],
                "default-value": "point",
                "default-meaning": "Place markers at the center point (centroid) of the geometry",
                "doc": "Attempt to place markers on a point, in the center of a polygon, or if markers-placement:line, then multiple times along a line. 'interior' placement can be used to ensure that points placed on polygons are forced to be inside the polygon interior"
            },
            "multi-policy": {
                "css": "marker-multi-policy",
                "type": [
                    "each",
                    "whole",
                    "largest"
                ],
                "default-value": "each",
                "default-meaning": "If a feature contains multiple geometries and the placement type is either point or interior then a marker will be rendered for each",
                "doc": "A special setting to allow the user to control rendering behavior for 'multi-geometries' (when a feature contains multiple geometries). This setting does not apply to markers placed along lines. The 'each' policy is default and means all geometries will get a marker. The 'whole' policy means that the aggregate centroid between all geometries will be used. The 'largest' policy means that only the largest (by bounding box areas) feature will get a rendered marker (this is how text labeling behaves by default)."
            },
            "marker-type": {
                "css": "marker-type",
                "type": [
                    "arrow",
                    "ellipse"
                ],
                "default-value": "ellipse",
                "doc": "The default marker-type. If a SVG file is not given as the marker-file parameter, the renderer provides either an arrow or an ellipse (a circle if height is equal to width)"
            },
            "width": {
                "css": "marker-width",
                "default-value": 10,
                "doc": "The width of the marker, if using one of the default types.",
                "type": "expression"
            },
            "height": {
                "css": "marker-height",
                "default-value": 10,
                "doc": "The height of the marker, if using one of the default types.",
                "type": "expression"
            },
            "fill": {
                "css": "marker-fill",
                "default-value": "blue",
                "doc": "The color of the area of the marker.",
                "type": "color"
            },
            "allow-overlap": {
                "css": "marker-allow-overlap",
                "type": "boolean",
                "default-value": false,
                "doc": "Control whether overlapping markers are shown or hidden.",
                "default-meaning": "Do not allow makers to overlap with each other - overlapping markers will not be shown."
            },
            "ignore-placement": {
                "css": "marker-ignore-placement",
                "type": "boolean",
                "default-value": false,
                "default-meaning": "do not store the bbox of this geometry in the collision detector cache",
                "doc": "value to control whether the placement of the feature will prevent the placement of other features"
            },
            "spacing": {
                "css": "marker-spacing",
                "doc": "Space between repeated labels",
                "default-value": 100,
                "type": "float"
            },
            "max-error": {
                "css": "marker-max-error",
                "type": "float",
                "default-value": 0.2,
                "doc": "The maximum difference between actual marker placement and the marker-spacing parameter. Setting a high value can allow the renderer to try to resolve placement conflicts with other symbolizers."
            },
            "transform": {
                "css": "marker-transform",
                "type": "functions",
                "functions": [
                    ["matrix", 6],
                    ["translate", 2],
                    ["scale", 2],
                    ["rotate", 3],
                    ["skewX", 1],
                    ["skewY", 1]
                ],
                "default-value": "",
                "default-meaning": "No transformation",
                "doc": "SVG transformation definition"
            },
            "clip": {
                "css": "marker-clip",
                "type": "boolean",
                "default-value": true,
                "default-meaning": "geometry will be clipped to map bounds before rendering",
                "doc": "geometries are clipped to map bounds by default for best rendering performance. In some cases users may wish to disable this to avoid rendering artifacts."
            },
            "smooth": {
                "css": "marker-smooth",
                "type": "float",
                "default-value": 0,
                "default-meaning": "no smoothing",
                "range": "0-1",
                "doc": "Smooths out geometry angles. 0 is no smoothing, 1 is fully smoothed. Values greater than 1 will produce wild, looping geometries."
            },
            "geometry-transform": {
                "css": "marker-geometry-transform",
                "type": "functions",
                "default-value": "none",
                "default-meaning": "geometry will not be transformed",
                "doc": "Allows transformation functions to be applied to the geometry.",
                "functions": [
                    ["matrix", 6],
                    ["translate", 2],
                    ["scale", 2],
                    ["rotate", 3],
                    ["skewX", 1],
                    ["skewY", 1]
                ]
            },
            "comp-op": {
                "css": "marker-comp-op",
                "default-value": "src-over",
                "default-meaning": "add the current symbolizer on top of other symbolizer",
                "doc": "Composite operation. This defines how this symbolizer should behave relative to symbolizers atop or below it.",
                "type": ["clear",
                    "src",
                    "dst",
                    "src-over",
                    "dst-over",
                    "src-in",
                    "dst-in",
                    "src-out",
                    "dst-out",
                    "src-atop",
                    "dst-atop",
                    "xor",
                    "plus",
                    "minus",
                    "multiply",
                    "screen",
                    "overlay",
                    "darken",
                    "lighten",
                    "color-dodge",
                    "color-burn",
                    "hard-light",
                    "soft-light",
                    "difference",
                    "exclusion",
                    "contrast",
                    "invert",
                    "invert-rgb",
                    "grain-merge",
                    "grain-extract",
                    "hue",
                    "saturation",
                    "color",
                    "value"
                ]
            }
        },
        "shield": {
            "name": {
                "css": "shield-name",
                "type": "expression",
                "serialization": "content",
                "doc": "Value to use for a shield\"s text label. Data columns are specified using brackets like [column_name]"
            },
            "file": {
                "css": "shield-file",
                "required": true,
                "type": "uri",
                "default-value": "none",
                "doc": "Image file to render behind the shield text"
            },
            "face-name": {
                "css": "shield-face-name",
                "type": "string",
                "validate": "font",
                "doc": "Font name and style to use for the shield text",
                "default-value": "",
                "required": true
            },
            "unlock-image": {
                "css": "shield-unlock-image",
                "type": "boolean",
                "doc": "This parameter should be set to true if you are trying to position text beside rather than on top of the shield image",
                "default-value": false,
                "default-meaning": "text alignment relative to the shield image uses the center of the image as the anchor for text positioning."
            },
            "size": {
                "css": "shield-size",
                "type": "float",
                "doc": "The size of the shield text in pixels"
            },
            "fill": {
                "css": "shield-fill",
                "type": "color",
                "doc": "The color of the shield text"
            },
            "placement": {
                "css": "shield-placement",
                "type": [
                    "point",
                    "line",
                    "vertex",
                    "interior"
                ],
                "default-value": "point",
                "doc": "How this shield should be placed. Point placement attempts to place it on top of points, line places along lines multiple times per feature, vertex places on the vertexes of polygons, and interior attempts to place inside of polygons."
            },
            "avoid-edges": {
                "css": "shield-avoid-edges",
                "doc": "Tell positioning algorithm to avoid labeling near intersection edges.",
                "type": "boolean",
                "default-value": false
            },
            "allow-overlap": {
                "css": "shield-allow-overlap",
                "type": "boolean",
                "default-value": false,
                "doc": "Control whether overlapping shields are shown or hidden.",
                "default-meaning": "Do not allow shields to overlap with other map elements already placed."
            },
            "minimum-distance": {
                "css": "shield-min-distance",
                "type": "float",
                "default-value": 0,
                "doc": "Minimum distance to the next shield symbol, not necessarily the same shield."
            },
            "spacing": {
                "css": "shield-spacing",
                "type": "float",
                "default-value": 0,
                "doc": "The spacing between repeated occurrences of the same shield on a line"
            },
            "minimum-padding": {
                "css": "shield-min-padding",
                "default-value": 0,
                "doc": "Determines the minimum amount of padding that a shield gets relative to other shields",
                "type": "float"
            },
            "wrap-width": {
                "css": "shield-wrap-width",
                "type": "unsigned",
                "default-value": 0,
                "doc": "Length of a chunk of text in characters before wrapping text"
            },
            "wrap-before": {
                "css": "shield-wrap-before",
                "type": "boolean",
                "default-value": false,
                "doc": "Wrap text before wrap-width is reached. If false, wrapped lines will be a bit longer than wrap-width."
            },
            "wrap-character": {
                "css": "shield-wrap-character",
                "type": "string",
                "default-value": " ",
                "doc": "Use this character instead of a space to wrap long names."
            },
            "halo-fill": {
                "css": "shield-halo-fill",
                "type": "color",
                "default-value": "#FFFFFF",
                "default-meaning": "white",
                "doc": "Specifies the color of the halo around the text."
            },
            "halo-radius": {
                "css": "shield-halo-radius",
                "doc": "Specify the radius of the halo in pixels",
                "default-value": 0,
                "default-meaning": "no halo",
                "type": "float"
            },
            "character-spacing": {
                "css": "shield-character-spacing",
                "type": "unsigned",
                "default-value": 0,
                "doc": "Horizontal spacing between characters (in pixels). Currently works for point placement only, not line placement."
            },
            "line-spacing": {
                "css": "shield-line-spacing",
                "doc": "Vertical spacing between lines of multiline labels (in pixels)",
                "type": "unsigned"
            },
            "dx": {
                "css": "shield-text-dx",
                "type": "float",
                "doc": "Displace text within shield by fixed amount, in pixels, +/- along the X axis.  A positive value will shift the text right",
                "default-value": 0
            },
            "dy": {
                "css": "shield-text-dy",
                "type": "float",
                "doc": "Displace text within shield by fixed amount, in pixels, +/- along the Y axis.  A positive value will shift the text down",
                "default-value": 0
            },
            "shield-dx": {
                "css": "shield-dx",
                "type": "float",
                "doc": "Displace shield by fixed amount, in pixels, +/- along the X axis.  A positive value will shift the text right",
                "default-value": 0
            },
            "shield-dy": {
                "css": "shield-dy",
                "type": "float",
                "doc": "Displace shield by fixed amount, in pixels, +/- along the Y axis.  A positive value will shift the text down",
                "default-value": 0
            },
            "opacity": {
                "css": "shield-opacity",
                "type": "float",
                "doc": "(Default 1.0) - opacity of the image used for the shield",
                "default-value": 1
            },
            "text-opacity": {
                "css": "shield-text-opacity",
                "type": "float",
                "doc": "(Default 1.0) - opacity of the text placed on top of the shield",
                "default-value": 1
            },
            "horizontal-alignment": {
                "css": "shield-horizontal-alignment",
                "type": [
                    "left",
                    "middle",
                    "right",
                    "auto"
                ],
                "doc": "The shield's horizontal alignment from its centerpoint",
                "default-value": "auto"
            },
            "vertical-alignment": {
                "css": "shield-vertical-alignment",
                "type": [
                    "top",
                    "middle",
                    "bottom",
                    "auto"
                ],
                "doc": "The shield's vertical alignment from its centerpoint",
                "default-value": "middle"
            },
            "text-transform": {
                "css": "shield-text-transform",
                "type": [
                    "none",
                    "uppercase",
                    "lowercase",
                    "capitalize"
                ],
                "doc": "Transform the case of the characters",
                "default-value": "none"
            },
            "justify-alignment": {
                "css": "shield-justify-alignment",
                "type": [
                    "left",
                    "center",
                    "right",
                    "auto"
                ],
                "doc": "Define how text in a shield's label is justified",
                "default-value": "auto"
            },
            "clip": {
                "css": "shield-clip",
                "type": "boolean",
                "default-value": true,
                "default-meaning": "geometry will be clipped to map bounds before rendering",
                "doc": "geometries are clipped to map bounds by default for best rendering performance. In some cases users may wish to disable this to avoid rendering artifacts."
            },
            "comp-op": {
                "css": "shield-comp-op",
                "default-value": "src-over",
                "default-meaning": "add the current symbolizer on top of other symbolizer",
                "doc": "Composite operation. This defines how this symbolizer should behave relative to symbolizers atop or below it.",
                "type": ["clear",
                    "src",
                    "dst",
                    "src-over",
                    "dst-over",
                    "src-in",
                    "dst-in",
                    "src-out",
                    "dst-out",
                    "src-atop",
                    "dst-atop",
                    "xor",
                    "plus",
                    "minus",
                    "multiply",
                    "screen",
                    "overlay",
                    "darken",
                    "lighten",
                    "color-dodge",
                    "color-burn",
                    "hard-light",
                    "soft-light",
                    "difference",
                    "exclusion",
                    "contrast",
                    "invert",
                    "invert-rgb",
                    "grain-merge",
                    "grain-extract",
                    "hue",
                    "saturation",
                    "color",
                    "value"
                ]
            }
        },
        "line-pattern": {
            "file": {
                "css": "line-pattern-file",
                "type": "uri",
                "default-value": "none",
                "required": true,
                "doc": "An image file to be repeated and warped along a line"
            },
            "clip": {
                "css": "line-pattern-clip",
                "type": "boolean",
                "default-value": true,
                "default-meaning": "geometry will be clipped to map bounds before rendering",
                "doc": "geometries are clipped to map bounds by default for best rendering performance. In some cases users may wish to disable this to avoid rendering artifacts."
            },
            "smooth": {
                "css": "line-pattern-smooth",
                "type": "float",
                "default-value": 0,
                "default-meaning": "no smoothing",
                "range": "0-1",
                "doc": "Smooths out geometry angles. 0 is no smoothing, 1 is fully smoothed. Values greater than 1 will produce wild, looping geometries."
            },
            "geometry-transform": {
                "css": "line-pattern-geometry-transform",
                "type": "functions",
                "default-value": "none",
                "default-meaning": "geometry will not be transformed",
                "doc": "Allows transformation functions to be applied to the geometry.",
                "functions": [
                    ["matrix", 6],
                    ["translate", 2],
                    ["scale", 2],
                    ["rotate", 3],
                    ["skewX", 1],
                    ["skewY", 1]
                ]
            },
            "comp-op": {
                "css": "line-pattern-comp-op",
                "default-value": "src-over",
                "default-meaning": "add the current symbolizer on top of other symbolizer",
                "doc": "Composite operation. This defines how this symbolizer should behave relative to symbolizers atop or below it.",
                "type": ["clear",
                    "src",
                    "dst",
                    "src-over",
                    "dst-over",
                    "src-in",
                    "dst-in",
                    "src-out",
                    "dst-out",
                    "src-atop",
                    "dst-atop",
                    "xor",
                    "plus",
                    "minus",
                    "multiply",
                    "screen",
                    "overlay",
                    "darken",
                    "lighten",
                    "color-dodge",
                    "color-burn",
                    "hard-light",
                    "soft-light",
                    "difference",
                    "exclusion",
                    "contrast",
                    "invert",
                    "invert-rgb",
                    "grain-merge",
                    "grain-extract",
                    "hue",
                    "saturation",
                    "color",
                    "value"
                ]
            }
        },
        "polygon-pattern": {
            "file": {
                "css": "polygon-pattern-file",
                "type": "uri",
                "default-value": "none",
                "required": true,
                "doc": "Image to use as a repeated pattern fill within a polygon"
            },
            "alignment": {
                "css": "polygon-pattern-alignment",
                "type": [
                    "local",
                    "global"
                ],
                "default-value": "local",
                "doc": "Specify whether to align pattern fills to the layer or to the map."
            },
            "gamma": {
                "css": "polygon-pattern-gamma",
                "type": "float",
                "default-value": 1,
                "default-meaning": "fully antialiased",
                "range": "0-1",
                "doc": "Level of antialiasing of polygon pattern edges"
            },
            "opacity": {
                "css": "polygon-pattern-opacity",
                "type": "float",
                "doc": "(Default 1.0) - Apply an opacity level to the image used for the pattern",
                "default-value": 1,
                "default-meaning": "The image is rendered without modifications"
            },
            "clip": {
                "css": "polygon-pattern-clip",
                "type": "boolean",
                "default-value": true,
                "default-meaning": "geometry will be clipped to map bounds before rendering",
                "doc": "geometries are clipped to map bounds by default for best rendering performance. In some cases users may wish to disable this to avoid rendering artifacts."
            },
            "smooth": {
                "css": "polygon-pattern-smooth",
                "type": "float",
                "default-value": 0,
                "default-meaning": "no smoothing",
                "range": "0-1",
                "doc": "Smooths out geometry angles. 0 is no smoothing, 1 is fully smoothed. Values greater than 1 will produce wild, looping geometries."
            },
            "geometry-transform": {
                "css": "polygon-pattern-geometry-transform",
                "type": "functions",
                "default-value": "none",
                "default-meaning": "geometry will not be transformed",
                "doc": "Allows transformation functions to be applied to the geometry.",
                "functions": [
                    ["matrix", 6],
                    ["translate", 2],
                    ["scale", 2],
                    ["rotate", 3],
                    ["skewX", 1],
                    ["skewY", 1]
                ]
            },
            "comp-op": {
                "css": "polygon-pattern-comp-op",
                "default-value": "src-over",
                "default-meaning": "add the current symbolizer on top of other symbolizer",
                "doc": "Composite operation. This defines how this symbolizer should behave relative to symbolizers atop or below it.",
                "type": ["clear",
                    "src",
                    "dst",
                    "src-over",
                    "dst-over",
                    "src-in",
                    "dst-in",
                    "src-out",
                    "dst-out",
                    "src-atop",
                    "dst-atop",
                    "xor",
                    "plus",
                    "minus",
                    "multiply",
                    "screen",
                    "overlay",
                    "darken",
                    "lighten",
                    "color-dodge",
                    "color-burn",
                    "hard-light",
                    "soft-light",
                    "difference",
                    "exclusion",
                    "contrast",
                    "invert",
                    "invert-rgb",
                    "grain-merge",
                    "grain-extract",
                    "hue",
                    "saturation",
                    "color",
                    "value"
                ]
            }
        },
        "raster": {
            "opacity": {
                "css": "raster-opacity",
                "default-value": 1,
                "default-meaning": "opaque",
                "type": "float",
                "doc": "The opacity of the raster symbolizer on top of other symbolizers."
            },
            "filter-factor": {
                "css": "raster-filter-factor",
                "default-value": -1,
                "default-meaning": "Allow the datasource to choose appropriate downscaling.",
                "type": "float",
                "doc": "This is used by the Raster or Gdal datasources to pre-downscale images using overviews. Higher numbers can sometimes cause much better scaled image output, at the cost of speed."
            },
            "scaling": {
                "css": "raster-scaling",
                "type": [
                    "near",
                    "fast",
                    "bilinear",
                    "bilinear8",
                    "bicubic",
                    "spline16",
                    "spline36",
                    "hanning",
                    "hamming",
                    "hermite",
                    "kaiser",
                    "quadric",
                    "catrom",
                    "gaussian",
                    "bessel",
                    "mitchell",
                    "sinc",
                    "lanczos",
                    "blackman"
                ],
                "default-value": "near",
                "doc": "The scaling algorithm used to making different resolution versions of this raster layer. Bilinear is a good compromise between speed and accuracy, while lanczos gives the highest quality."
            },
            "mesh-size": {
                "css": "raster-mesh-size",
                "default-value": 16,
                "default-meaning": "Reprojection mesh will be 1/16 of the resolution of the source image",
                "type": "unsigned",
                "doc": "A reduced resolution mesh is used for raster reprojection, and the total image size is divided by the mesh-size to determine the quality of that mesh. Values for mesh-size larger than the default will result in faster reprojection but might lead to distortion."
            },
            "comp-op": {
                "css": "raster-comp-op",
                "default-value": "src-over",
                "default-meaning": "add the current symbolizer on top of other symbolizer",
                "doc": "Composite operation. This defines how this symbolizer should behave relative to symbolizers atop or below it.",
                "type": ["clear",
                    "src",
                    "dst",
                    "src-over",
                    "dst-over",
                    "src-in",
                    "dst-in",
                    "src-out",
                    "dst-out",
                    "src-atop",
                    "dst-atop",
                    "xor",
                    "plus",
                    "minus",
                    "multiply",
                    "screen",
                    "overlay",
                    "darken",
                    "lighten",
                    "color-dodge",
                    "color-burn",
                    "hard-light",
                    "soft-light",
                    "difference",
                    "exclusion",
                    "contrast",
                    "invert",
                    "invert-rgb",
                    "grain-merge",
                    "grain-extract",
                    "hue",
                    "saturation",
                    "color",
                    "value"
                ]
            }
        },
        "point": {
            "file": {
                "css": "point-file",
                "type": "uri",
                "required": false,
                "default-value": "none",
                "doc": "Image file to represent a point"
            },
            "allow-overlap": {
                "css": "point-allow-overlap",
                "type": "boolean",
                "default-value": false,
                "doc": "Control whether overlapping points are shown or hidden.",
                "default-meaning": "Do not allow points to overlap with each other - overlapping markers will not be shown."
            },
            "ignore-placement": {
                "css": "point-ignore-placement",
                "type": "boolean",
                "default-value": false,
                "default-meaning": "do not store the bbox of this geometry in the collision detector cache",
                "doc": "value to control whether the placement of the feature will prevent the placement of other features"
            },
            "opacity": {
                "css": "point-opacity",
                "type": "float",
                "default-value": 1.0,
                "default-meaning": "Fully opaque",
                "doc": "A value from 0 to 1 to control the opacity of the point"
            },
            "placement": {
                "css": "point-placement",
                "type": [
                    "centroid",
                    "interior"
                ],
                "doc": "How this point should be placed. Centroid calculates the geometric center of a polygon, which can be outside of it, while interior always places inside of a polygon.",
                "default-value": "centroid"
            },
            "transform": {
                "css": "point-transform",
                "type": "functions",
                "functions": [
                    ["matrix", 6],
                    ["translate", 2],
                    ["scale", 2],
                    ["rotate", 3],
                    ["skewX", 1],
                    ["skewY", 1]
                ],
                "default-value": "",
                "default-meaning": "No transformation",
                "doc": "SVG transformation definition"
            },
            "comp-op": {
                "css": "point-comp-op",
                "default-value": "src-over",
                "default-meaning": "add the current symbolizer on top of other symbolizer",
                "doc": "Composite operation. This defines how this symbolizer should behave relative to symbolizers atop or below it.",
                "type": ["clear",
                    "src",
                    "dst",
                    "src-over",
                    "dst-over",
                    "src-in",
                    "dst-in",
                    "src-out",
                    "dst-out",
                    "src-atop",
                    "dst-atop",
                    "xor",
                    "plus",
                    "minus",
                    "multiply",
                    "screen",
                    "overlay",
                    "darken",
                    "lighten",
                    "color-dodge",
                    "color-burn",
                    "hard-light",
                    "soft-light",
                    "difference",
                    "exclusion",
                    "contrast",
                    "invert",
                    "invert-rgb",
                    "grain-merge",
                    "grain-extract",
                    "hue",
                    "saturation",
                    "color",
                    "value"
                ]
            }
        },
        "text": {
            "name": {
                "css": "text-name",
                "type": "expression",
                "required": true,
                "default-value": "",
                "serialization": "content",
                "doc": "Value to use for a text label. Data columns are specified using brackets like [column_name]"
            },
            "face-name": {
                "css": "text-face-name",
                "type": "string",
                "validate": "font",
                "doc": "Font name and style to render a label in",
                "required": true
            },
            "size": {
                "css": "text-size",
                "type": "float",
                "default-value": 10,
                "doc": "Text size in pixels"
            },
            "text-ratio": {
                "css": "text-ratio",
                "doc": "Define the amount of text (of the total) present on successive lines when wrapping occurs",
                "default-value": 0,
                "type": "unsigned"
            },
            "wrap-width": {
                "css": "text-wrap-width",
                "doc": "Length of a chunk of text in characters before wrapping text",
                "default-value": 0,
                "type": "unsigned"
            },
            "wrap-before": {
                "css": "text-wrap-before",
                "type": "boolean",
                "default-value": false,
                "doc": "Wrap text before wrap-width is reached. If false, wrapped lines will be a bit longer than wrap-width."
            },
            "wrap-character": {
                "css": "text-wrap-character",
                "type": "string",
                "default-value": " ",
                "doc": "Use this character instead of a space to wrap long text."
            },
            "spacing": {
                "css": "text-spacing",
                "type": "unsigned",
                "doc": "Distance between repeated text labels on a line (aka. label-spacing)"
            },
            "character-spacing": {
                "css": "text-character-spacing",
                "type": "float",
                "default-value": 0,
                "doc": "Horizontal spacing adjustment between characters in pixels"
            },
            "line-spacing": {
                "css": "text-line-spacing",
                "default-value": 0,
                "type": "unsigned",
                "doc": "Vertical spacing adjustment between lines in pixels"
            },
            "label-position-tolerance": {
                "css": "text-label-position-tolerance",
                "default-value": 0,
                "type": "unsigned",
                "doc": "Allows the label to be displaced from its ideal position by a number of pixels (only works with placement:line)"
            },
            "max-char-angle-delta": {
                "css": "text-max-char-angle-delta",
                "type": "float",
                "default-value": "22.5",
                "doc": "The maximum angle change, in degrees, allowed between adjacent characters in a label. This value internally is converted to radians to the default is 22.5*math.pi/180.0. The higher the value the fewer labels will be placed around around sharp corners."
            },
            "fill": {
                "css": "text-fill",
                "doc": "Specifies the color for the text",
                "default-value": "#000000",
                "type": "color"
            },
            "opacity": {
                "css": "text-opacity",
                "doc": "A number from 0 to 1 specifying the opacity for the text",
                "default-value": 1.0,
                "default-meaning": "Fully opaque",
                "type": "float"
            },
            "halo-fill": {
                "css": "text-halo-fill",
                "type": "color",
                "default-value": "#FFFFFF",
                "default-meaning": "white",
                "doc": "Specifies the color of the halo around the text."
            },
            "halo-radius": {
                "css": "text-halo-radius",
                "doc": "Specify the radius of the halo in pixels",
                "default-value": 0,
                "default-meaning": "no halo",
                "type": "float"
            },
            "dx": {
                "css": "text-dx",
                "type": "float",
                "doc": "Displace text by fixed amount, in pixels, +/- along the X axis.  A positive value will shift the text right",
                "default-value": 0
            },
            "dy": {
                "css": "text-dy",
                "type": "float",
                "doc": "Displace text by fixed amount, in pixels, +/- along the Y axis.  A positive value will shift the text down",
                "default-value": 0
            },
            "vertical-alignment": {
                "css": "text-vertical-alignment",
                "type": [
                    "top",
                    "middle",
                    "bottom",
                    "auto"
                ],
                "doc": "Position of label relative to point position.",
                "default-value": "auto",
                "default-meaning": "Default affected by value of dy; \"bottom\" for dy>0, \"top\" for dy<0."
            },
            "avoid-edges": {
                "css": "text-avoid-edges",
                "doc": "Tell positioning algorithm to avoid labeling near intersection edges.",
                "default-value": false,
                "type": "boolean"
            },
            "minimum-distance": {
                "css": "text-min-distance",
                "doc": "Minimum permitted distance to the next text symbolizer.",
                "type": "float"
            },
            "minimum-padding": {
                "css": "text-min-padding",
                "doc": "Determines the minimum amount of padding that a text symbolizer gets relative to other text",
                "type": "float"
            },
            "minimum-path-length": {
                "css": "text-min-path-length",
                "type": "float",
                "default-value": 0,
                "default-meaning": "place labels on all paths",
                "doc": "Place labels only on paths longer than this value."
            },
            "allow-overlap": {
                "css": "text-allow-overlap",
                "type": "boolean",
                "default-value": false,
                "doc": "Control whether overlapping text is shown or hidden.",
                "default-meaning": "Do not allow text to overlap with other text - overlapping markers will not be shown."
            },
            "orientation": {
                "css": "text-orientation",
                "type": "expression",
                "doc": "Rotate the text."
            },
            "placement": {
                "css": "text-placement",
                "type": [
                    "point",
                    "line",
                    "vertex",
                    "interior"
                ],
                "default-value": "point",
                "doc": "Control the style of placement of a point versus the geometry it is attached to."
            },
            "placement-type": {
                "css": "text-placement-type",
                "doc": "Re-position and/or re-size text to avoid overlaps. \"simple\" for basic algorithm (using text-placements string,) \"dummy\" to turn this feature off.",
                "type": [
                    "dummy",
                    "simple"
                ],
                "default-value": "dummy"
            },
            "placements": {
                "css": "text-placements",
                "type": "string",
                "default-value": "",
                "doc": "If \"placement-type\" is set to \"simple\", use this \"POSITIONS,[SIZES]\" string. An example is `text-placements: \"E,NE,SE,W,NW,SW\";` "
            },
            "text-transform": {
                "css": "text-transform",
                "type": [
                    "none",
                    "uppercase",
                    "lowercase",
                    "capitalize"
                ],
                "doc": "Transform the case of the characters",
                "default-value": "none"
            },
            "horizontal-alignment": {
                "css": "text-horizontal-alignment",
                "type": [
                    "left",
                    "middle",
                    "right",
                    "auto"
                ],
                "doc": "The text's horizontal alignment from its centerpoint",
                "default-value": "auto"
            },
            "justify-alignment": {
                "css": "text-align",
                "type": [
                    "left",
                    "right",
                    "center",
                    "auto"
                ],
                "doc": "Define how text is justified",
                "default-value": "auto",
                "default-meaning": "Auto alignment means that text will be centered by default except when using the `placement-type` parameter - in that case either right or left justification will be used automatically depending on where the text could be fit given the `text-placements` directives"
            },
            "clip": {
                "css": "text-clip",
                "type": "boolean",
                "default-value": true,
                "default-meaning": "geometry will be clipped to map bounds before rendering",
                "doc": "geometries are clipped to map bounds by default for best rendering performance. In some cases users may wish to disable this to avoid rendering artifacts."
            },
            "comp-op": {
                "css": "text-comp-op",
                "default-value": "src-over",
                "default-meaning": "add the current symbolizer on top of other symbolizer",
                "doc": "Composite operation. This defines how this symbolizer should behave relative to symbolizers atop or below it.",
                "type": ["clear",
                    "src",
                    "dst",
                    "src-over",
                    "dst-over",
                    "src-in",
                    "dst-in",
                    "src-out",
                    "dst-out",
                    "src-atop",
                    "dst-atop",
                    "xor",
                    "plus",
                    "minus",
                    "multiply",
                    "screen",
                    "overlay",
                    "darken",
                    "lighten",
                    "color-dodge",
                    "color-burn",
                    "hard-light",
                    "soft-light",
                    "difference",
                    "exclusion",
                    "contrast",
                    "invert",
                    "invert-rgb",
                    "grain-merge",
                    "grain-extract",
                    "hue",
                    "saturation",
                    "color",
                    "value"
                ]
            }
        },
        "building": {
            "fill": {
                "css": "building-fill",
                "default-value": "#FFFFFF",
                "doc": "The color of the buildings walls.",
                "type": "color"
            },
            "fill-opacity": {
                "css": "building-fill-opacity",
                "type": "float",
                "doc": "The opacity of the building as a whole, including all walls.",
                "default-value": 1
            },
            "height": {
                "css": "building-height",
                "doc": "The height of the building in pixels.",
                "type": "expression",
                "default-value": "0"
            }
        }
    },
    "colors": {
        "aliceblue": [240, 248, 255],
        "antiquewhite": [250, 235, 215],
        "aqua": [0, 255, 255],
        "aquamarine": [127, 255, 212],
        "azure": [240, 255, 255],
        "beige": [245, 245, 220],
        "bisque": [255, 228, 196],
        "black": [0, 0, 0],
        "blanchedalmond": [255, 235, 205],
        "blue": [0, 0, 255],
        "blueviolet": [138, 43, 226],
        "brown": [165, 42, 42],
        "burlywood": [222, 184, 135],
        "cadetblue": [95, 158, 160],
        "chartreuse": [127, 255, 0],
        "chocolate": [210, 105, 30],
        "coral": [255, 127, 80],
        "cornflowerblue": [100, 149, 237],
        "cornsilk": [255, 248, 220],
        "crimson": [220, 20, 60],
        "cyan": [0, 255, 255],
        "darkblue": [0, 0, 139],
        "darkcyan": [0, 139, 139],
        "darkgoldenrod": [184, 134, 11],
        "darkgray": [169, 169, 169],
        "darkgreen": [0, 100, 0],
        "darkgrey": [169, 169, 169],
        "darkkhaki": [189, 183, 107],
        "darkmagenta": [139, 0, 139],
        "darkolivegreen": [85, 107, 47],
        "darkorange": [255, 140, 0],
        "darkorchid": [153, 50, 204],
        "darkred": [139, 0, 0],
        "darksalmon": [233, 150, 122],
        "darkseagreen": [143, 188, 143],
        "darkslateblue": [72, 61, 139],
        "darkslategrey": [47, 79, 79],
        "darkturquoise": [0, 206, 209],
        "darkviolet": [148, 0, 211],
        "deeppink": [255, 20, 147],
        "deepskyblue": [0, 191, 255],
        "dimgray": [105, 105, 105],
        "dimgrey": [105, 105, 105],
        "dodgerblue": [30, 144, 255],
        "firebrick": [178, 34, 34],
        "floralwhite": [255, 250, 240],
        "forestgreen": [34, 139, 34],
        "fuchsia": [255, 0, 255],
        "gainsboro": [220, 220, 220],
        "ghostwhite": [248, 248, 255],
        "gold": [255, 215, 0],
        "goldenrod": [218, 165, 32],
        "gray": [128, 128, 128],
        "grey": [128, 128, 128],
        "green": [0, 128, 0],
        "greenyellow": [173, 255, 47],
        "honeydew": [240, 255, 240],
        "hotpink": [255, 105, 180],
        "indianred": [205, 92, 92],
        "indigo": [75, 0, 130],
        "ivory": [255, 255, 240],
        "khaki": [240, 230, 140],
        "lavender": [230, 230, 250],
        "lavenderblush": [255, 240, 245],
        "lawngreen": [124, 252, 0],
        "lemonchiffon": [255, 250, 205],
        "lightblue": [173, 216, 230],
        "lightcoral": [240, 128, 128],
        "lightcyan": [224, 255, 255],
        "lightgoldenrodyellow": [250, 250, 210],
        "lightgray": [211, 211, 211],
        "lightgreen": [144, 238, 144],
        "lightgrey": [211, 211, 211],
        "lightpink": [255, 182, 193],
        "lightsalmon": [255, 160, 122],
        "lightseagreen": [32, 178, 170],
        "lightskyblue": [135, 206, 250],
        "lightslategray": [119, 136, 153],
        "lightslategrey": [119, 136, 153],
        "lightsteelblue": [176, 196, 222],
        "lightyellow": [255, 255, 224],
        "lime": [0, 255, 0],
        "limegreen": [50, 205, 50],
        "linen": [250, 240, 230],
        "magenta": [255, 0, 255],
        "maroon": [128, 0, 0],
        "mediumaquamarine": [102, 205, 170],
        "mediumblue": [0, 0, 205],
        "mediumorchid": [186, 85, 211],
        "mediumpurple": [147, 112, 219],
        "mediumseagreen": [60, 179, 113],
        "mediumslateblue": [123, 104, 238],
        "mediumspringgreen": [0, 250, 154],
        "mediumturquoise": [72, 209, 204],
        "mediumvioletred": [199, 21, 133],
        "midnightblue": [25, 25, 112],
        "mintcream": [245, 255, 250],
        "mistyrose": [255, 228, 225],
        "moccasin": [255, 228, 181],
        "navajowhite": [255, 222, 173],
        "navy": [0, 0, 128],
        "oldlace": [253, 245, 230],
        "olive": [128, 128, 0],
        "olivedrab": [107, 142, 35],
        "orange": [255, 165, 0],
        "orangered": [255, 69, 0],
        "orchid": [218, 112, 214],
        "palegoldenrod": [238, 232, 170],
        "palegreen": [152, 251, 152],
        "paleturquoise": [175, 238, 238],
        "palevioletred": [219, 112, 147],
        "papayawhip": [255, 239, 213],
        "peachpuff": [255, 218, 185],
        "peru": [205, 133, 63],
        "pink": [255, 192, 203],
        "plum": [221, 160, 221],
        "powderblue": [176, 224, 230],
        "purple": [128, 0, 128],
        "red": [255, 0, 0],
        "rosybrown": [188, 143, 143],
        "royalblue": [65, 105, 225],
        "saddlebrown": [139, 69, 19],
        "salmon": [250, 128, 114],
        "sandybrown": [244, 164, 96],
        "seagreen": [46, 139, 87],
        "seashell": [255, 245, 238],
        "sienna": [160, 82, 45],
        "silver": [192, 192, 192],
        "skyblue": [135, 206, 235],
        "slateblue": [106, 90, 205],
        "slategray": [112, 128, 144],
        "slategrey": [112, 128, 144],
        "snow": [255, 250, 250],
        "springgreen": [0, 255, 127],
        "steelblue": [70, 130, 180],
        "tan": [210, 180, 140],
        "teal": [0, 128, 128],
        "thistle": [216, 191, 216],
        "tomato": [255, 99, 71],
        "turquoise": [64, 224, 208],
        "violet": [238, 130, 238],
        "wheat": [245, 222, 179],
        "white": [255, 255, 255],
        "whitesmoke": [245, 245, 245],
        "yellow": [255, 255, 0],
        "yellowgreen": [154, 205, 50],
        "transparent": [0, 0, 0, 0]
    },
    "filter": {
        "value": [
            "true",
            "false",
            "null",
            "point",
            "linestring",
            "polygon",
            "collection"
        ]
    }
};

CartoCSS['mapnik_reference'] = {
    version: {
        latest: _mapnik_reference_latest,
        '2.1.1': _mapnik_reference_latest
    }
};

CartoCSS.Tree = {};
CartoCSS.Tree.operate = function(op, a, b) {
    switch (op) {
        case '+': return a + b;
        case '-': return a - b;
        case '*': return a * b;
        case '%': return a % b;
        case '/': return a / b;
    }
};
CartoCSS.Tree.functions = {
    rgb: function (r, g, b) {
        return this.rgba(r, g, b, 1.0);
    },
    rgba: function (r, g, b, a) {
        var me = this;
        var rgb = [r, g, b].map(function (c) {
            return me.number(c);
        });
        a = me.number(a);
        if (rgb.some(isNaN) || isNaN(a)) {return null;}
        return new CartoCSS.Tree.Color(rgb, a);
    },
    // Only require val
    stop: function (val) {
        var color, mode;
        if (arguments.length > 1) {color = arguments[1];}
        if (arguments.length > 2) {mode = arguments[2];}

        return {
            is: 'tag',
            val: val,
            color: color,
            mode: mode,
            toString(env) {
                return '\n\t<stop value="' + val.ev(env) + '"' +
                    (color ? ' color="' + color.ev(env) + '" ' : '') +
                    (mode ? ' mode="' + mode.ev(env) + '" ' : '') +
                    '/>';
            }
        };
    },
    hsl: function (h, s, l) {
        return this.hsla(h, s, l, 1.0);
    },
    hsla: function (h, s, l, a) {
        h = (this.number(h) % 360) / 360;
        s = this.number(s);
        l = this.number(l);
        a = this.number(a);
        if ([h, s, l, a].some(isNaN)) {return null;}

        var m2 = l <= 0.5 ? l * (s + 1) : l + s - l * s,
            m1 = l * 2 - m2;

        return this.rgba(hue(h + 1 / 3) * 255,
            hue(h) * 255,
            hue(h - 1 / 3) * 255,
            a);

        function hue(h) {
            h = h < 0 ? h + 1 : (h > 1 ? h - 1 : h);
            if (h * 6 < 1) {return m1 + (m2 - m1) * h * 6;} else if (h * 2 < 1) {return m2;} else if (h * 3 < 2) {return m1 + (m2 - m1) * (2 / 3 - h) * 6;} else {return m1;}
        }
    },
    hue: function (color) {
        if (!('toHSL' in color)) {return null;}
        return new CartoCSS.Tree.Dimension(Math.round(color.toHSL().h));
    },
    saturation: function (color) {
        if (!('toHSL' in color)) {return null;}
        return new CartoCSS.Tree.Dimension(Math.round(color.toHSL().s * 100), '%');
    },
    lightness: function (color) {
        if (!('toHSL' in color)) {return null;}
        return new CartoCSS.Tree.Dimension(Math.round(color.toHSL().l * 100), '%');
    },
    alpha: function (color) {
        if (!('toHSL' in color)) {return null;}
        return new CartoCSS.Tree.Dimension(color.toHSL().a);
    },
    saturate: function (color, amount) {
        if (!('toHSL' in color)) {return null;}
        var hsl = color.toHSL();

        hsl.s += amount.value / 100;
        hsl.s = this.clamp(hsl.s);
        return this.hsla_simple(hsl);
    },
    desaturate: function (color, amount) {
        if (!('toHSL' in color)) {return null;}
        var hsl = color.toHSL();

        hsl.s -= amount.value / 100;
        hsl.s = this.clamp(hsl.s);
        return this.hsla_simple(hsl);
    },
    lighten: function (color, amount) {
        if (!('toHSL' in color)) {return null;}
        var hsl = color.toHSL();

        hsl.l += amount.value / 100;
        hsl.l = this.clamp(hsl.l);
        return this.hsla_simple(hsl);
    },
    darken: function (color, amount) {
        if (!('toHSL' in color)) {return null;}
        var hsl = color.toHSL();

        hsl.l -= amount.value / 100;
        hsl.l = this.clamp(hsl.l);
        return this.hsla_simple(hsl);
    },
    fadein: function (color, amount) {
        if (!('toHSL' in color)) {return null;}
        var hsl = color.toHSL();

        hsl.a += amount.value / 100;
        hsl.a = this.clamp(hsl.a);
        return this.hsla_simple(hsl);
    },
    fadeout: function (color, amount) {
        if (!('toHSL' in color)) {return null;}
        var hsl = color.toHSL();

        hsl.a -= amount.value / 100;
        hsl.a = this.clamp(hsl.a);
        return this.hsla_simple(hsl);
    },
    spin: function (color, amount) {
        if (!('toHSL' in color)) {return null;}
        var hsl = color.toHSL();
        var hue = (hsl.h + amount.value) % 360;

        hsl.h = hue < 0 ? 360 + hue : hue;

        return this.hsla_simple(hsl);
    },
    replace: function (entity, a, b) {
        if (entity.is === 'field') {
            return entity.toString + '.replace(' + a.toString() + ', ' + b.toString() + ')';
        } else {
            return entity.replace(a, b);
        }
    },
    //
    // Copyright (c) 2006-2009 Hampton Catlin, Nathan Weizenbaum, and Chris Eppstein
    // http://sass-lang.com
    //
    mix: function (color1, color2, weight) {
        var p = weight.value / 100.0;
        var w = p * 2 - 1;
        var a = color1.toHSL().a - color2.toHSL().a;

        var w1 = (((w * a == -1) ? w : (w + a) / (1 + w * a)) + 1) / 2.0;
        var w2 = 1 - w1;

        var rgb = [color1.rgb[0] * w1 + color2.rgb[0] * w2,
            color1.rgb[1] * w1 + color2.rgb[1] * w2,
            color1.rgb[2] * w1 + color2.rgb[2] * w2];

        var alpha = color1.alpha * p + color2.alpha * (1 - p);

        return new CartoCSS.Tree.Color(rgb, alpha);
    },
    greyscale: function (color) {
        return this.desaturate(color, new CartoCSS.Tree.Dimension(100));
    },
    '%': function (quoted /* arg, arg, ...*/) {
        var args = Array.prototype.slice.call(arguments, 1),
            str = quoted.value;

        for (var i = 0; i < args.length; i++) {
            str = str.replace(/%s/, args[i].value)
                .replace(/%[da]/, args[i].toString());
        }
        str = str.replace(/%%/g, '%');
        return new CartoCSS.Tree.Quoted(str);
    },

    hsla_simple: function (h) {
        return this.hsla(h.h, h.s, h.l, h.a);
    },

    number: function (n) {
        if (n instanceof CartoCSS.Tree.Dimension) {
            return parseFloat(n.unit === '%' ? n.value / 100 : n.value);
        } else if (typeof(n) === 'number') {
            return n;
        } else {
            return NaN;
        }
    },

    clamp: function (val) {
        return Math.min(1, Math.max(0, val));
    }
};

CartoCSS.Tree.Call = class Call {

    constructor(name, args, index) {
        this.is = 'call';
        this.name = name;
        this.args = args;
        this.index = index;
    }

    // When evuating a function call,
    // we either find the function in `tree.functions` [1],
    // in which case we call it, passing the  evaluated arguments,
    // or we simply print it out as it appeared originally [2].
    // The *functions.js* file contains the built-in functions.
    // The reason why we evaluate the arguments, is in the case where
    // we try to pass a variable to a function, like: `saturate(@color)`.
    // The function should receive the value, not the variable.
    'ev'(env) {
        var args = this.args.map(function (a) {
            return a.ev(env);
        });

        for (var i = 0; i < args.length; i++) {
            if (args[i].is === 'undefined') {
                return {
                    is: 'undefined',
                    value: 'undefined'
                };
            }
        }

        if (this.name in CartoCSS.Tree.functions) {
            if (CartoCSS.Tree.functions[this.name].length <= args.length) {
                var val = CartoCSS.Tree.functions[this.name].apply(CartoCSS.Tree.functions, args);
                if (val === null) {
                    env.error({
                        message: 'incorrect arguments given to ' + this.name + '()',
                        index: this.index,
                        type: 'runtime',
                        filename: this.filename
                    });
                    return {is: 'undefined', value: 'undefined'};
                }
                return val;
            } else {
                env.error({
                    message: 'incorrect number of arguments for ' + this.name +
                    '(). ' + CartoCSS.Tree.functions[this.name].length + ' expected.',
                    index: this.index,
                    type: 'runtime',
                    filename: this.filename
                });
                return {
                    is: 'undefined',
                    value: 'undefined'
                };
            }
        } else {
            var fn = CartoCSS.Tree.Reference.mapnikFunctions[this.name];
            if (fn === undefined) {
                var functions = lodash_topairs_default()(CartoCSS.Tree.Reference.mapnikFunctions);
                // cheap closest, needs improvement.
                var name = this.name;
                var mean = functions.map(function (f) {
                    return [f[0], CartoCSS.Tree.Reference.editDistance(name, f[0]), f[1]];
                }).sort(function (a, b) {
                    return a[1] - b[1];
                });
                env.error({
                    message: 'unknown function ' + this.name + '(), did you mean ' +
                    mean[0][0] + '(' + mean[0][2] + ')',
                    index: this.index,
                    type: 'runtime',
                    filename: this.filename
                });
                return {
                    is: 'undefined',
                    value: 'undefined'
                };
            }
            if (fn !== args.length &&
                // support variable-arg functions like `colorize-alpha`
                fn !== -1) {
                env.error({
                    message: 'function ' + this.name + '() takes ' +
                    fn + ' arguments and was given ' + args.length,
                    index: this.index,
                    type: 'runtime',
                    filename: this.filename
                });
                return {
                    is: 'undefined',
                    value: 'undefined'
                };
            } else {
                // Save the evaluated versions of arguments
                this.args = args;
                return this;
            }
        }
    }

    toString(env, format) {
        if (this.args.length) {
            return this.name + '(' + this.args.join(',') + ')';
        } else {
            return this.name;
        }
    }
};

CartoCSS.Tree.Color = class Color {

    constructor(rgb, a) {
        this.is = 'color';
        // The end goal here, is to parse the arguments
        // into an integer triplet, such as `128, 255, 0`
        //
        // This facilitates operations and conversions.
        if (Array.isArray(rgb)) {
            this.rgb = rgb.slice(0, 3);
        } else if (rgb.length == 6) {
            this.rgb = rgb.match(/.{2}/g).map(function (c) {
                return parseInt(c, 16);
            });
        } else {
            this.rgb = rgb.split('').map(function (c) {
                return parseInt(c + c, 16);
            });
        }

        if (typeof(a) === 'number') {
            this.alpha = a;
        } else if (rgb.length === 4) {
            this.alpha = rgb[3];
        } else {
            this.alpha = 1;
        }
    }

    'ev'() {
        return this;
    }

    // If we have some transparency, the only way to represent it
    // is via `rgba`. Otherwise, we use the hex representation,
    // which has better compatibility with older browsers.
    // Values are capped between `0` and `255`, rounded and zero-padded.
    toString() {
        /* if (this.alpha < 1.0) {*/
        return 'rgba(' + this.rgb.map(function (c) {
            return Math.round(c);
        }).concat(this.alpha).join(', ') + ')';
        /*} else {
         return '#' + this.rgb.map(function(i) {
         i = Math.round(i);
         i = (i > 255 ? 255 : (i < 0 ? 0 : i)).toString(16);
         return i.length === 1 ? '0' + i : i;
         }).join('');
         }*/
    }

    // Operations have to be done per-channel, if not,
    // channels will spill onto each other. Once we have
    // our result, in the form of an integer triplet,
    // we create a new Color node to hold the result.
    operate(env, op, other) {
        var result = [];

        if (!(other instanceof CartoCSS.Tree.Color)) {
            other = other.toColor();
        }

        for (var c = 0; c < 3; c++) {
            result[c] = CartoCSS.Tree.operate(op, this.rgb[c], other.rgb[c]);
        }
        return new CartoCSS.Tree.Color(result);
    }

    toHSL() {
        var r = this.rgb[0] / 255,
            g = this.rgb[1] / 255,
            b = this.rgb[2] / 255,
            a = this.alpha;

        var max = Math.max(r, g, b), min = Math.min(r, g, b);
        var h, s, l = (max + min) / 2, d = max - min;

        if (max === min) {
            h = s = 0;
        } else {
            s = l > 0.5 ? d / (2 - max - min) : d / (max + min);

            switch (max) {
                case r:
                    h = (g - b) / d + (g < b ? 6 : 0);
                    break;
                case g:
                    h = (b - r) / d + 2;
                    break;
                case b:
                    h = (r - g) / d + 4;
                    break;
                default:
                    break;
            }
            h /= 6;
        }
        return {h: h * 360, s: s, l: l, a: a};
    }
};

CartoCSS.Tree.Comment = class Comment {
    constructor(value, silent) {
        this.value = value;
        this.silent = !!silent;
    }

    toString(env) {
        return '<!--' + this.value + '-->';
    }

    'ev'() {
        return this;
    }
};

CartoCSS.Tree.Definition = class Definition {
    constructor(selector, rules) {
        this.elements = selector.elements;
        //assert.ok(selector.filters instanceof CartoCSS.Tree.Filterset);
        this.rules = rules;
        this.ruleIndex = {};
        for (var i = 0; i < this.rules.length; i++) {
            if ('zoom' in this.rules[i]) {this.rules[i] = this.rules[i].clone();}
            this.rules[i].zoom = selector.zoom;
            this.ruleIndex[this.rules[i].updateID()] = true;
        }
        this.filters = selector.filters;
        this.zoom = selector.zoom;
        this.attachment = selector.attachment || '__default__';
        this.specificity = selector.specificity();
    }

    toString() {
        var str = this.filters.toString();
        for (var i = 0; i < this.rules.length; i++) {
            str += '\n    ' + this.rules[i];
        }
        return str;
    }

    toJS(env) {
        var shaderAttrs = {};

        // merge conditions from filters with zoom condition of the
        // definition
        var zoom = this.zoom;
        //var frame_offset = this.frame_offset;
        var _if = this.filters.toJS(env);
        var filters = [zoom];
        if (_if) {filters.push(_if);}
        //if(frame_offset) filters.push('ctx["frame-offset"] === ' + frame_offset);
        _if = filters.join(" && ");

        function eachRule(rule) {
            if (rule instanceof CartoCSS.Tree.Rule) {
                shaderAttrs[rule.name] = shaderAttrs[rule.name] || [];
                if (_if) {
                    shaderAttrs[rule.name].push(
                        "if(" + _if + "){" + rule.value.toJS(env) + "}"
                    );
                } else {
                    shaderAttrs[rule.name].push(rule.value.toJS(env));
                }
            } else {
                if (rule instanceof CartoCSS.Tree.Ruleset) {
                    var sh = rule.toJS(env);
                    for (var v in sh) {
                        shaderAttrs[v] = shaderAttrs[v] || [];
                        for (var attr in sh[v]) {
                            shaderAttrs[v].push(sh[v][attr]);
                        }
                    }
                }
            }
        }
        for (var id in this.rules) {
            eachRule(this.rules[id]);
        }
        return shaderAttrs;
    }
};

CartoCSS.Tree.Dimension = class Dimension {


    constructor(value, unit, index) {
        this.is = 'float';
        this.physical_units = ['m', 'cm', 'in', 'mm', 'pt', 'pc'];
        this.screen_units = ['px', '%'];
        this.all_units = ['m', 'cm', 'in', 'mm', 'pt', 'pc', 'px', '%'];
        this.densities = {
            m: 0.0254,
            mm: 25.4,
            cm: 2.54,
            pt: 72,
            pc: 6
        };
        this.value = parseFloat(value);
        this.unit = unit || null;
        this.index = index;
    }

    ev(env) {
        if (this.unit && this.all_units.indexOf(this.unit)<0) {
            env.error({
                message: "Invalid unit: '" + this.unit + "'",
                index: this.index
            });
            return {is: 'undefined', value: 'undefined'};
        }

        // normalize units which are not px or %
        if (this.unit && this.physical_units.indexOf(this.unit)>=0) {
            if (!env.ppi) {
                env.error({
                    message: "ppi is not set, so metric units can't be used",
                    index: this.index
                });
                return {is: 'undefined', value: 'undefined'};
            }
            // convert all units to inch
            // convert inch to px using ppi
            this.value = (this.value / this.densities[this.unit]) * env.ppi;
            this.unit = 'px';
        }

        return this;
    }

    toColor() {
        return new CartoCSS.Tree.Color([this.value, this.value, this.value]);
    }

    round() {
        this.value = Math.round(this.value);
        return this;
    }

    toString() {
        return this.value.toString();
    }

    operate(env, op, other) {
        if (this.unit === '%' && other.unit !== '%') {
            env.error({
                message: 'If two operands differ, the first must not be %',
                index: this.index
            });
            return {
                is: 'undefined',
                value: 'undefined'
            };
        }

        if (this.unit !== '%' && other.unit === '%') {
            if (op === '*' || op === '/' || op === '%') {
                env.error({
                    message: 'Percent values can only be added or subtracted from other values',
                    index: this.index
                });
                return {
                    is: 'undefined',
                    value: 'undefined'
                };
            }

            return new CartoCSS.Tree.Dimension(CartoCSS.Tree.operate(op,
                this.value, this.value * other.value * 0.01),
                this.unit);
        }

        //here the operands are either the same (% or undefined or px), or one is undefined and the other is px
        return new CartoCSS.Tree.Dimension(CartoCSS.Tree.operate(op, this.value, other.value),
            this.unit || other.unit);
    }
};

CartoCSS.Tree.Element = class Element {
    constructor(value) {
        this.value = value.trim();
        if (this.value[0] === '#') {
            this.type = 'id';
            this.clean = this.value.replace(/^#/, '');
        }
        if (this.value[0] === '.') {
            this.type = 'class';
            this.clean = this.value.replace(/^\./, '');
        }
        if (this.value.indexOf('*') !== -1) {
            this.type = 'wildcard';
        }
    }

    specificity() {
        return [
            (this.type === 'id') ? 1 : 0, // a
            (this.type === 'class') ? 1 : 0  // b
        ];
    }

    toString() {
        return this.value;
    }
};

CartoCSS.Tree.Expression = class Expression {


    constructor(value) {
        this.is = 'expression';
        this.value = value;
    }

    ev(env) {
        if (this.value.length > 1) {
            return new CartoCSS.Tree.Expression(this.value.map(function (e) {
                return e.ev(env);
            }));
        } else {
            return this.value[0].ev(env);
        }
    }

    toString(env) {
        return this.value.map(function (e) {
            return e.toString(env);
        }).join(' ');
    }
};

CartoCSS.Tree.Field = class Field {

    constructor(content) {
        this.is = 'field';
        this.value = content || '';
    }

    toString() {
        return '["' + this.value.toUpperCase() + '"]';
    }

    'ev'() {
        return this;
    }
};

CartoCSS.Tree.Filter = class Filter {

    constructor(key, op, val, index, filename) {
        this.ops = {
            '<': [' &lt; ', 'numeric'],
            '>': [' &gt; ', 'numeric'],
            '=': [' = ', 'both'],
            '!=': [' != ', 'both'],
            '<=': [' &lt;= ', 'numeric'],
            '>=': [' &gt;= ', 'numeric'],
            '=~': ['.match(', 'string', ')']
        };

        this.key = key;
        this.op = op;
        this.val = val;
        this.index = index;
        this.filename = filename;

        this.id = this.key + this.op + this.val;
    }

    ev(env) {
        this.key = this.key.ev(env);
        this.val = this.val.ev(env);
        return this;
    }

    toString() {
        return '[' + this.id + ']';
    }
};

CartoCSS.Tree.Filterset = class Filterset {
    constructor() {
        this.filters = {};
    }

    toJS(env) {
        function eachFilter(filter) {
            var op = filter.op;
            if (op === "=") {
                op = "==";
            }
            var val = filter.val;
            if (filter._val !== undefined) {
                val = filter._val.toString(true);
            }

            //å¯¹scaleè¿è¡ç¹æ®å¤çï¼å°å¼è½¬æ¢ææ°å¼
            if (filter.key && filter.key.value === 'scale') {
                val = +val;
            } else if (typeof val === 'string' || typeof val === 'object') {
                val = "'" + val + "'";
            }
            var attrs = "attributes";
            return attrs + "&&" + attrs + filter.key + "&&" + attrs + filter.key + " " + op + val;
        }
        var results = [];
        for (var id in this.filters) {
            results.push(eachFilter(this.filters[id]));
        }
        return results.join(' && ');
    }

    toString() {
        var arr = [];
        for (var id in this.filters) {arr.push(this.filters[id].id);}
        return arr.sort().join('\t');
    }

    ev(env) {
        for (var i in this.filters) {
            this.filters[i].ev(env);
        }
        return this;
    }

    clone() {
        var clone = new CartoCSS.Tree.Filterset();
        for (var id in this.filters) {
            clone.filters[id] = this.filters[id];
        }
        return clone;
    }

    cloneWith(other) {
        var additions = [];
        for (var id in other.filters) {
            var status = this.addable(other.filters[id]);
            // status is true, false or null. if it's null we don't fail this
            // clone nor do we add the filter.
            if (status === false) {
                return false;
            }
            if (status === true) {
                // Adding the filter will override another value.
                additions.push(other.filters[id]);
            }
        }

        // Adding the other filters doesn't make this filterset invalid, but it
        // doesn't add anything to it either.
        if (!additions.length) {
            return null;
        }

        // We can successfully add all filters. Now clone the filterset and add the
        // new rules.
        var clone = new CartoCSS.Tree.Filterset();

        // We can add the rules that are already present without going through the
        // add function as a Filterset is always in it's simplest canonical form.
        for (id in this.filters) {
            clone.filters[id] = this.filters[id];
        }

        // Only add new filters that actually change the filter.
        while (id = additions.shift()) {
            clone.add(id);
        }

        return clone;
    }

    addable(filter) {
        var key = filter.key.toString(),
            value = filter.val.toString();

        if (value.match(/^[0-9]+(\.[0-9]*)?_match/)) {value = parseFloat(value);}

        switch (filter.op) {
            case '=':
                // if there is already foo= and we're adding foo=
                if (this.filters[key + '='] !== undefined) {
                    if (this.filters[key + '='].val.toString() != value) {
                        return false;
                    } else {
                        return null;
                    }
                }
                if (this.filters[key + '!=' + value] !== undefined) {return false;}
                if (this.filters[key + '>'] !== undefined && this.filters[key + '>'].val >= value) {return false;}
                if (this.filters[key + '<'] !== undefined && this.filters[key + '<'].val <= value) {return false;}
                if (this.filters[key + '>='] !== undefined && this.filters[key + '>='].val > value) {return false;}
                if (this.filters[key + '<='] !== undefined && this.filters[key + '<='].val < value) {return false;}
                return true;

            case '=~':
                return true;

            case '!=':
                if (this.filters[key + '='] !== undefined) {return (this.filters[key + '='].val === value) ? false : null;}
                if (this.filters[key + '!=' + value] !== undefined) {return null;}
                if (this.filters[key + '>'] !== undefined && this.filters[key + '>'].val >= value) {return null;}
                if (this.filters[key + '<'] !== undefined && this.filters[key + '<'].val <= value) {return null;}
                if (this.filters[key + '>='] !== undefined && this.filters[key + '>='].val > value) {return null;}
                if (this.filters[key + '<='] !== undefined && this.filters[key + '<='].val < value) {return null;}
                return true;

            case '>':
                if (key + '=' in this.filters) {
                    if (this.filters[key + '='].val <= value) {
                        return false;
                    } else {
                        return null;
                    }
                }
                if (this.filters[key + '<'] !== undefined && this.filters[key + '<'].val <= value) {return false;}
                if (this.filters[key + '<='] !== undefined && this.filters[key + '<='].val <= value) {return false;}
                if (this.filters[key + '>'] !== undefined && this.filters[key + '>'].val >= value) {return null;}
                if (this.filters[key + '>='] !== undefined && this.filters[key + '>='].val > value) {return null;}
                return true;

            case '>=':
                if (this.filters[key + '='] !== undefined) {return (this.filters[key + '='].val < value) ? false : null;}
                if (this.filters[key + '<'] !== undefined && this.filters[key + '<'].val <= value) {return false;}
                if (this.filters[key + '<='] !== undefined && this.filters[key + '<='].val < value) {return false;}
                if (this.filters[key + '>'] !== undefined && this.filters[key + '>'].val >= value) {return null;}
                if (this.filters[key + '>='] !== undefined && this.filters[key + '>='].val >= value) {return null;}
                return true;

            case '<':
                if (this.filters[key + '='] !== undefined) {return (this.filters[key + '='].val >= value) ? false : null;}
                if (this.filters[key + '>'] !== undefined && this.filters[key + '>'].val >= value) {return false;}
                if (this.filters[key + '>='] !== undefined && this.filters[key + '>='].val >= value) {return false;}
                if (this.filters[key + '<'] !== undefined && this.filters[key + '<'].val <= value) {return null;}
                if (this.filters[key + '<='] !== undefined && this.filters[key + '<='].val < value) {return null;}
                return true;

            case '<=':
                if (this.filters[key + '='] !== undefined) {return (this.filters[key + '='].val > value) ? false : null;}
                if (this.filters[key + '>'] !== undefined && this.filters[key + '>'].val >= value) {return false;}
                if (this.filters[key + '>='] !== undefined && this.filters[key + '>='].val > value) {return false;}
                if (this.filters[key + '<'] !== undefined && this.filters[key + '<'].val <= value) {return null;}
                if (this.filters[key + '<='] !== undefined && this.filters[key + '<='].val <= value) {return null;}
                return true;

            default:
                break;
        }
    }

    conflict(filter) {
        var key = filter.key.toString(),
            value = filter.val.toString();

        if (!isNaN(parseFloat(value))) {value = parseFloat(value);}

        // if (a=b) && (a=c)
        // if (a=b) && (a!=b)
        // or (a!=b) && (a=b)
        if ((filter.op === '=' && this.filters[key + '='] !== undefined &&
                value != this.filters[key + '='].val.toString()) ||
            (filter.op === '!=' && this.filters[key + '='] !== undefined &&
                value == this.filters[key + '='].val.toString()) ||
            (filter.op === '=' && this.filters[key + '!='] !== undefined &&
                value === this.filters[key + '!='].val.toString())) {
            return filter.toString() + ' added to ' + this.toString() + ' produces an invalid filter';
        }

        return false;
    }

    add(filter, env) {
        var key = filter.key.toString(),
            op = filter.op,
            conflict = this.conflict(filter),
            numval;
        if (conflict) {return conflict;}

        if (op === '=') {
            for (var i in this.filters) {
                if (this.filters[i].key === key) {delete this.filters[i];}
            }
            this.filters[key + '='] = filter;
        } else if (op === '!=') {
            this.filters[key + '!=' + filter.val] = filter;
        } else if (op === '=~') {
            this.filters[key + '=~' + filter.val] = filter;
        } else if (op === '>') {
            // If there are other filters that are also >
            // but are less than this one, they don't matter, so
            // remove them.
            for (var j in this.filters) {
                if (this.filters[j].key === key && this.filters[j].val <= filter.val) {
                    delete this.filters[j];
                }
            }
            this.filters[key + '>'] = filter;
        } else if (op === '>=') {
            for (var k in this.filters) {
                numval = (+this.filters[k].val.toString());
                if (this.filters[k].key === key && numval < filter.val) {
                    delete this.filters[k];
                }
            }
            if (this.filters[key + '!=' + filter.val] !== undefined) {
                delete this.filters[key + '!=' + filter.val];
                filter.op = '>';
                this.filters[key + '>'] = filter;
            } else {
                this.filters[key + '>='] = filter;
            }
        } else if (op === '<') {
            for (var l in this.filters) {
                numval = (+this.filters[l].val.toString());
                if (this.filters[l].key === key && numval >= filter.val) {
                    delete this.filters[l];
                }
            }
            this.filters[key + '<'] = filter;
        } else if (op === '<=') {
            for (var m in this.filters) {
                numval = (+this.filters[m].val.toString());
                if (this.filters[m].key === key && numval > filter.val) {
                    delete this.filters[m];
                }
            }
            if (this.filters[key + '!=' + filter.val] !== undefined) {
                delete this.filters[key + '!=' + filter.val];
                filter.op = '<';
                this.filters[key + '<'] = filter;
            } else {
                this.filters[key + '<='] = filter;
            }
        }
    }
};

CartoCSS.Tree.Fontset = class Fontset {
    constructor(env, fonts) {
        this.fonts = fonts;
        this.name = 'fontset-' + env.effects.length;
    }
};
CartoCSS.Tree.Invalid = class Invalid {

    constructor(chunk, index, message) {
        this.is = 'invalid';
        this.chunk = chunk;
        this.index = index;
        this.type = 'syntax';
        this.message = message || "Invalid code: " + this.chunk;
    }

    ev(env) {
        env.error({
            chunk: this.chunk,
            index: this.index,
            type: 'syntax',
            message: this.message || "Invalid code: " + this.chunk
        });
        return {
            is: 'undefined'
        };
    }
};

CartoCSS.Tree.Keyword = class Keyword {
    ev() {
        return this;
    }

    constructor(value) {
        this.value = value;
        var special = {
            'transparent': 'color',
            'true': 'boolean',
            'false': 'boolean'
        };
        this.is = special[value] ? special[value] : 'keyword';
    }

    toString() {
        return this.value;
    }
};

/*Layer:class Invalid ),*/

CartoCSS.Tree.Literal = class Literal {
    constructor(content) {
        this.value = content || '';
        this.is = 'field';
    }

    toString() {
        return this.value;
    }

    'ev'() {
        return this;
    }
};

CartoCSS.Tree.Operation = class Operation {

    constructor(op, operands, index) {
        this.is = 'operation';
        this.op = op.trim();
        this.operands = operands;
        this.index = index;
    }

    ev(env) {
        var a = this.operands[0].ev(env),
            b = this.operands[1].ev(env),
            temp;

        if (a.is === 'undefined' || b.is === 'undefined') {
            return {
                is: 'undefined',
                value: 'undefined'
            };
        }

        if (a instanceof CartoCSS.Tree.Dimension && b instanceof CartoCSS.Tree.Color) {
            if (this.op === '*' || this.op === '+') {
                temp = b;
                b = a;
                a = temp;
            } else {
                env.error({
                    name: "OperationError",
                    message: "Can't substract or divide a color from a number",
                    index: this.index
                });
            }
        }

        // Only concatenate plain strings, because this is easily
        // pre-processed
        if (a instanceof CartoCSS.Tree.Quoted && b instanceof CartoCSS.Tree.Quoted && this.op !== '+') {
            env.error({
                message: "Can't subtract, divide, or multiply strings.",
                index: this.index,
                type: 'runtime',
                filename: this.filename
            });
            return {
                is: 'undefined',
                value: 'undefined'
            };
        }

        // Fields, literals, dimensions, and quoted strings can be combined.
        if (a instanceof CartoCSS.Tree.Field || b instanceof CartoCSS.Tree.Field ||
            a instanceof CartoCSS.Tree.Literal || b instanceof CartoCSS.Tree.Literal) {
            if (a.is === 'color' || b.is === 'color') {
                env.error({
                    message: "Can't subtract, divide, or multiply colors in expressions.",
                    index: this.index,
                    type: 'runtime',
                    filename: this.filename
                });
                return {
                    is: 'undefined',
                    value: 'undefined'
                };
            } else {
                return new CartoCSS.Tree.Literal(a.ev(env).toString(true) + this.op + b.ev(env).toString(true));
            }
        }

        if (a.operate === undefined) {
            env.error({
                message: 'Cannot do math with type ' + a.is + '.',
                index: this.index,
                type: 'runtime',
                filename: this.filename
            });
            return {
                is: 'undefined',
                value: 'undefined'
            };
        }

        return a.operate(env, this.op, b);
    }
};

CartoCSS.Tree.Quoted = class Quoted {

    constructor(content) {
        this.is = 'string';
        this.value = content || '';
    }

    toString(quotes) {
        var escapedValue = this.value
            .replace(/&/g, '&amp;')
        var xmlvalue = escapedValue
            .replace(/\'/g, '\\\'')
            .replace(/\"/g, '&quot;')
            .replace(/</g, '&lt;')
            .replace(/\>/g, '&gt;');
        return (quotes === true) ? "'" + xmlvalue + "'" : escapedValue;
    }

    ev() {
        return this;
    }

    operate(env, op, other) {
        return new CartoCSS.Tree.Quoted(CartoCSS.Tree.operate(op, this.toString(), other.toString(this.contains_field)));
    }
};

CartoCSS.Tree.Reference = {
    _validateValue: {
        'font': function (env, value) {
            if (env.validation_data && env.validation_data.fonts) {
                return env.validation_data.fonts.indexOf(value) != -1;
            } else {
                return true;
            }
        }
    },
    setData: function (data) {
        this.data = data;
        this.selector_cache = generateSelectorCache(data);
        this.mapnikFunctions = generateMapnikFunctions(data);
        this.required_cache = generateRequiredProperties(data);

        function generateSelectorCache(data) {
            var index = {};
            for (var i in data.symbolizers) {
                for (var j in data.symbolizers[i]) {
                    if (data.symbolizers[i][j].hasOwnProperty('css')) {
                        index[data.symbolizers[i][j].css] = [data.symbolizers[i][j], i, j];
                    }
                }
            }
            return index;
        }

        function generateMapnikFunctions(data) {
            var functions = {};
            for (var i in data.symbolizers) {
                for (var j in data.symbolizers[i]) {
                    if (data.symbolizers[i][j].type === 'functions') {
                        for (var k = 0; k < data.symbolizers[i][j].functions.length; k++) {
                            var fn = data.symbolizers[i][j].functions[k];
                            functions[fn[0]] = fn[1];
                        }
                    }
                }
            }
            return functions;
        }

        function generateRequiredProperties(data) {
            var cache = {};
            for (var symbolizer_name in data.symbolizers) {
                cache[symbolizer_name] = [];
                for (var j in data.symbolizers[symbolizer_name]) {
                    if (data.symbolizers[symbolizer_name][j].required) {
                        cache[symbolizer_name].push(data.symbolizers[symbolizer_name][j].css);
                    }
                }
            }
            return cache;
        }
    },
    setVersion: function (version) {
        if (CartoCSS.mapnik_reference.version.hasOwnProperty(version)) {
            this.setData(CartoCSS.mapnik_reference.version[version]);
            return true;
        }
        return false;
    },
    selectorData: function (selector, i) {
        if (this.selector_cache && this.selector_cache[selector]) {return this.selector_cache[selector][i];}
    },
    validSelector: function (selector) {
        return !!this.selector_cache[selector];
    },
    selectorName: function (selector) {
        return this.selectorData(selector, 2);
    },
    selector: function (selector) {
        return this.selectorData(selector, 0);
    },
    symbolizer: function (selector) {
        return this.selectorData(selector, 1);
    },
    requiredProperties: function (symbolizer_name, rules) {
        var req = this.required_cache[symbolizer_name];
        for (var i in req) {
            if (!(req[i] in rules)) {
                return 'Property ' + req[i] + ' required for defining ' +
                    symbolizer_name + ' styles.';
            }
        }
    },
    isFont: function (selector) {
        return this.selector(selector).validate === 'font';
    },
    editDistance: function (a, b) {
        if (a.length === 0) {return b.length;}
        if (b.length === 0) {return a.length;}
        var matrix = [];
        for (var i = 0; i <= b.length; i++) {
            matrix[i] = [i];
        }
        for (var j = 0; j <= a.length; j++) {
            matrix[0][j] = j;
        }
        for (i = 1; i <= b.length; i++) {
            for (j = 1; j <= a.length; j++) {
                if (b.charAt(i - 1) === a.charAt(j - 1)) {
                    matrix[i][j] = matrix[i - 1][j - 1];
                } else {
                    matrix[i][j] = Math.min(matrix[i - 1][j - 1] + 1, // substitution
                        Math.min(matrix[i][j - 1] + 1, // insertion
                            matrix[i - 1][j] + 1)); // deletion
                }
            }
        }
        return matrix[b.length][a.length];
    },
    validValue: function (env, selector, value) {
        function validateFunctions(value, selector) {
            if (value.value[0].is === 'string') {return true;}
            for (var i in value.value) {
                for (var j in value.value[i].value) {
                    if (value.value[i].value[j].is !== 'call') {return false;}
                    var f = find(this.selector(selector).functions, function (x) {//NOSONAR
                        return x[0] === value.value[i].value[j].name;
                    });
                    if (!(f && f[1] === -1)) {
                        // This filter is unknown or given an incorrect number of arguments
                        if (!f || f[1] !== value.value[i].value[j].args.length) {return false;}
                    }
                }
            }
            return true;
        }

        function validateKeyword(value, selector) {
            if (typeof this.selector(selector).type === 'object') {
                return this.selector(selector).type
                    .indexOf(value.value[0].value) !== -1;
            } else {
                // allow unquoted keywords as strings
                return this.selector(selector).type === 'string';
            }
        }

        var i;
        if (!this.selector(selector)) {
            return false;
        } else if (value.value[0].is === 'keyword') {
            return validateKeyword(value, selector);
        } else if (value.value[0].is === 'undefined') {
            // caught earlier in the chain - ignore here so that
            // error is not overridden
            return true;
        } else if (this.selector(selector).type === 'numbers') {
            for (i in value.value) {
                if (value.value[i].is !== 'float') {
                    return false;
                }
            }
            return true;
        } else if (this.selector(selector).type === 'tags') {
            if (!value.value) {return false;}
            if (!value.value[0].value) {
                return value.value[0].is === 'tag';
            }
            for (i = 0; i < value.value[0].value.length; i++) {
                if (value.value[0].value[i].is !== 'tag') {return false;}
            }
            return true;
        } else if (this.selector(selector).type == 'functions') {
            // For backwards compatibility, you can specify a string for `functions`-compatible
            // values, though they will not be validated.
            return validateFunctions(value, selector);
        } else if (this.selector(selector).type === 'expression') {
            return true;
        } else if (this.selector(selector).type === 'unsigned') {
            if (value.value[0].is === 'float') {
                value.value[0].round();
                return true;
            } else {
                return false;
            }
        } else {
            if (this.selector(selector).validate) {
                var valid = false;
                for (i = 0; i < value.value.length; i++) {
                    if (this.selector(selector).type === value.value[i].is &&
                        this._validateValue[this.selector(selector).validate](env, value.value[i].value)) {
                        return true;
                    }
                }
                return valid;
            } else {
                return this.selector(selector).type === value.value[0].is;
            }
        }
    }
};
CartoCSS.Tree.Reference.setVersion("latest");

CartoCSS.Tree.Rule = class Rule {

    constructor(name, value, index, filename) {
        this.is = 'rule';
        var parts = name.split('/');
        this.name = parts.pop();
        this.instance = parts.length ? parts[0] : '__default__';
        this.value = (value instanceof CartoCSS.Tree.Value) ?
            value : new CartoCSS.Tree.Value([value]);
        this.index = index;
        this.symbolizer = CartoCSS.Tree.Reference.symbolizer(this.name);
        this.filename = filename;
        this.variable = (name.charAt(0) === '@');
    }

    clone() {
        var clone = Object.create(CartoCSS.Tree.Rule.prototype);
        clone.name = this.name;
        clone.value = this.value;
        clone.index = this.index;
        clone.instance = this.instance;
        clone.symbolizer = this.symbolizer;
        clone.filename = this.filename;
        clone.variable = this.variable;
        return clone;
    }

    updateID() {
        return this.id = this.zoom + '#' + this.instance + '#' + this.name;
    }

    toString() {
        return '[' + CartoCSS.Tree.Zoom.toString(this.zoom) + '] ' + this.name + ': ' + this.value;
    }
    ev(context) {
        return new CartoCSS.Tree.Rule(this.name,
            this.value.ev(context),
            this.index,
            this.filename);
    }
};

CartoCSS.Tree.Ruleset = class Ruleset {

    constructor(selectors, rules) {
        this.is = 'ruleset';
        this.selectors = selectors;
        this.rules = rules;
        // static cache of find() function
        this._lookups = {};
    }

    ev(env) {
        var i,
            rule,
            ruleset = new CartoCSS.Tree.Ruleset(this.selectors, this.rules.slice(0));
        ruleset.root = this.root;

        // push the current ruleset to the frames stack
        env.frames.unshift(ruleset);

        // Evaluate everything else
        for (i = 0, rule; i < ruleset.rules.length; i++) {
            rule = ruleset.rules[i];
            ruleset.rules[i] = rule.ev ? rule.ev(env) : rule;
        }

        // Pop the stack
        env.frames.shift();

        return ruleset;
    }

    match(args) {
        return !args || args.length === 0;
    }

    variables() {
        if (this._variables) {
            return this._variables;
        } else {
            return this._variables = this.rules.reduce(function (hash, r) {
                if (r instanceof CartoCSS.Tree.Rule && r.variable === true) {
                    hash[r.name] = r;
                }
                return hash;
            }, {});
        }
    }

    variable(name) {
        return this.variables()[name];
    }

    rulesets() {
        if (this._rulesets) {
            return this._rulesets;
        } else {
            return this._rulesets = this.rules.filter(function (r) {
                return (r instanceof CartoCSS.Tree.Ruleset);
            });
        }
    }

    find(selector, self) {
        self = self || this;
        var rules = [], match,
            key = selector.toString();

        if (key in this._lookups) {
            return this._lookups[key];
        }

        this.rulesets().forEach(function (rule) {
            if (rule !== self) {
                for (var j = 0; j < rule.selectors.length; j++) {
                    match = selector.match(rule.selectors[j]);
                    if (match) {
                        if (selector.elements.length > 1) {
                            Array.prototype.push.apply(rules, rule.find(
                                new CartoCSS.Tree.Selector(null, null, selector.elements.slice(1)), self));
                        } else {
                            rules.push(rule);
                        }
                        break;
                    }
                }
            }
        });
        return this._lookups[key] = rules;
    }

    // Zooms can use variables. This replaces CartoCSS.Tree.Zoom objects on selectors
    // with simple bit-arrays that we can compare easily.
    evZooms(env) {
        for (var i = 0; i < this.selectors.length; i++) {
            var zval = CartoCSS.Tree.Zoom.all;
            for (var z = 0; z < this.selectors[i].zoom.length; z++) {
                zval = this.selectors[i].zoom[z].ev(env).zoom;
            }
            this.selectors[i].zoom = zval;
        }
    }

    flatten(result, parents, env) {
        var selectors = [], i, j;
        if (this.selectors.length === 0) {
            env.frames = env.frames.concat(this.rules);
        }
        // evaluate zoom variables on this object.
        this.evZooms(env);
        for (i = 0; i < this.selectors.length; i++) {
            var child = this.selectors[i];

            if (!child.filters) {
                // This is an invalid filterset.
                continue;
            }

            if (parents.length) {
                for (j = 0; j < parents.length; j++) {
                    var parent = parents[j];

                    var mergedFilters = parent.filters.cloneWith(child.filters);
                    if (mergedFilters === null) {
                        // Filters could be added, but they didn't change the
                        // filters. This means that we only have to clone when
                        // the zoom levels or the attachment is different too.
                        if (parent.zoom === child.zoom &&
                            parent.attachment === child.attachment &&
                            parent.elements.join() === child.elements.join()) {
                            selectors.push(parent);
                            continue;
                        } else {
                            mergedFilters = parent.filters;
                        }
                    } else if (!mergedFilters) {
                        // The merged filters are invalid, that means we don't
                        // have to clone.
                        continue;
                    }

                    var clone = Object.create(CartoCSS.Tree.Selector.prototype);
                    clone.filters = mergedFilters;
                    clone.zoom = child.zoom;
                    clone.elements = parent.elements.concat(child.elements);
                    if (parent.attachment && child.attachment) {
                        clone.attachment = parent.attachment + '/' + child.attachment;
                    } else {clone.attachment = child.attachment || parent.attachment;}
                    clone.conditions = parent.conditions + child.conditions;
                    clone.index = child.index;
                    selectors.push(clone);
                }
            } else {
                selectors.push(child);
            }
        }

        var rules = [];
        for (i = 0; i < this.rules.length; i++) {
            var rule = this.rules[i];

            // Recursively flatten any nested rulesets
            if (rule instanceof CartoCSS.Tree.Ruleset) {
                rule.flatten(result, selectors, env);
            } else if (rule instanceof CartoCSS.Tree.Rule) {
                rules.push(rule);
            } else if (rule instanceof CartoCSS.Tree.Invalid) {
                env.error(rule);
            }
        }

        var index = rules.length ? rules[0].index : false;
        for (i = 0; i < selectors.length; i++) {
            // For specificity sort, use the position of the first rule to allow
            // defining attachments that are under current element as a descendant
            // selector.
            if (index !== false) {
                selectors[i].index = index;
            }
            result.push(new CartoCSS.Tree.Definition(selectors[i], rules.slice()));
        }

        return result;
    }
};

CartoCSS.Tree.Selector = class Selector {
    constructor(filters, zoom, elements, attachment, conditions, index) {
        this.elements = elements || [];
        this.attachment = attachment;
        this.filters = filters || {};
        this.zoom = typeof zoom !== 'undefined' ? zoom : CartoCSS.Tree.Zoom.all;
        this.conditions = conditions;
        this.index = index;
    }

    specificity() {
        return this.elements.reduce(function (memo, e) {
            var spec = e.specificity();
            memo[0] += spec[0];
            memo[1] += spec[1];
            return memo;
        }, [0, 0, this.conditions, this.index]);
    }
};

/*style:class Invalid ),*/

CartoCSS.Tree.URL = class URL {

    constructor(val, paths) {
        this.is = 'uri';
        this.value = val;
        this.paths = paths;
    }

    toString() {
        return this.value.toString();
    }

    ev(ctx) {
        return new CartoCSS.Tree.URL(this.value.ev(ctx), this.paths);
    }
};

CartoCSS.Tree.Value = class Value {

    constructor(value) {
        this.is = 'value';
        this.value = value;
    }

    ev(env) {
        if (this.value.length === 1) {
            return this.value[0].ev(env);
        } else {
            return new CartoCSS.Tree.Value(this.value.map(function (v) {
                return v.ev(env);
            }));
        }
    }

    toJS(env) {
        //var v = this.value[0].value[0];
        var val = this.ev(env);
        var v = val.toString();
        if (val.is === "color" || val.is === 'uri' || val.is === 'string' || val.is === 'keyword') {
            v = "'" + v + "'";
        } else if (val.is === 'field') {
            // replace [varuable] by ctx['variable']
            v = v.replace(/\[(.*)\]/g, "attributes['\_match1']")
        } else if (val.value && typeof val.value === "object") {
            v = "[" + v + "]";
        }

        return "_value = " + v + ";";
    }

    toString(env, selector, sep, format) {
        return this.value.map(function (e) {
            return e.toString(env, format);
        }).join(sep || ', ');
    }

    clone() {
        var obj = Object.create(CartoCSS.Tree.Value.prototype);
        if (Array.isArray(obj)) {obj.value = this.value.slice();} else {obj.value = this.value;}
        obj.is = this.is;
        return obj;
    }
};

CartoCSS.Tree.Variable = class Variable {
    constructor(name, index, filename) {
        this.is = 'variable';
        this.name = name;
        this.index = index;
        this.filename = filename;
    }

    toString() {
        return this.name;
    }

    ev(env) {
        if (this._css) {return this._css;}

        var thisframe = env.frames.filter(function (f) {
            return f.name === this.name;
        }.bind(this));
        if (thisframe.length) {
            return thisframe[0].value.ev(env);
        } else {
            env.error({
                message: 'variable ' + this.name + ' is undefined',
                index: this.index,
                type: 'runtime',
                filename: this.filename
            });
            return {
                is: 'undefined',
                value: 'undefined'
            };
        }
    }
};

CartoCSS.Tree.Zoom = class Zoom {
    constructor(op, value, index) {
        this.op = op;
        this.value = value;
        this.index = index;
    }

    setZoom(zoom) {
        this.zoom = zoom;
        return this;
    }

    ev(env) {
        var value = parseInt(this.value.ev(env).toString(), 10);


        if (value > CartoCSS.Tree.Zoom.maxZoom || value < 0) {
            env.error({
                message: 'Only zoom levels between 0 and ' +
                CartoCSS.Tree.Zoom.maxZoom + ' supported.',
                index: this.index
            });
        }

        switch (this.op) {
            case '=':
                this.zoom = "zoom && zoom === " + value;
                return this;
            case '>':
                this.zoom = "zoom && zoom > " + value;
                break;
            case '>=':
                this.zoom = "zoom && zoom >= " + value;
                break;
            case '<':
                this.zoom = "zoom && zoom < " + value;
                break;
            case '<=':
                this.zoom = "zoom && zoom <= " + value;
                break;
            default:
                break;
        }
        /*
         for (var i = 0; i <= CartoCSS.Tree.Zoom.maxZoom; i++) {
         if (i >= start && i <= end) {
         zoom |= (1 << i);
         }
         }
         this.zoom = zoom;
         this.zoom=value+this.op+"zoom";*/
        return this;
    }

    toString() {
        var str = '';
        for (var i = 0; i <= CartoCSS.Tree.Zoom.maxZoom; i++) {
            str += (this.zoom & (1 << i)) ? 'X' : '.';
        }
        return str;
    }
};

// Covers all zoomlevels from 0 to 22
CartoCSS.Tree.Zoom.all = 23;

CartoCSS.Tree.Zoom.maxZoom = 22;

CartoCSS.Tree.Zoom.ranges = {
    0: 1000000000,
    1: 500000000,
    2: 200000000,
    3: 100000000,
    4: 50000000,
    5: 25000000,
    6: 12500000,
    7: 6500000,
    8: 3000000,
    9: 1500000,
    10: 750000,
    11: 400000,
    12: 200000,
    13: 100000,
    14: 50000,
    15: 25000,
    16: 12500,
    17: 5000,
    18: 2500,
    19: 1500,
    20: 750,
    21: 500,
    22: 250,
    23: 100
};

;// CONCATENATED MODULE: ./src/common/style/ThemeStyle.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class ThemeStyle
 * @deprecatedclass SuperMap.ThemeStyle
 * @classdesc å®¢æ·ç«¯ä¸é¢å¾é£æ ¼ç±»ã
 * @category Visualization Theme
 * @param {Object} options - å¯éåæ°ã
 * @param {boolean} [options.fill=true] - æ¯å¦å¡«åï¼ä¸éè¦å¡«ååè®¾ç½®ä¸º falseãå¦æ fill ä¸ stroke åæ¶ä¸º falseï¼å°æ fill ä¸ stroke çé»è®¤å¼æ¸²æå¾å±ã
 * @param {string} [options.fillColor='#000000'] - åå­è¿å¶å¡«åé¢è²ã
 * @param {number} [options.fillOpacity=1] - å¡«åä¸éæåº¦ãåå¼èå´[0, 1]ã
 * @param {boolean} [options.stroke=false] -  æ¯å¦æè¾¹ï¼ä¸éè¦æè¾¹åè®¾ç½®ä¸ºfalseãå¦æ fill ä¸ stroke åæ¶ä¸º falseï¼å°æ fill ä¸ stroke çé»è®¤å¼æ¸²æå¾å±ã
 * @param {string} [options.strokeColor='#000000'] - åå­è¿å¶æè¾¹é¢è²ã
 * @param {number} [options.strokeOpacity=1] - æè¾¹çä¸éæåº¦ãåå¼èå´[0, 1]ã
 * @param {number} [options.strokeWidth=1] - çº¿å®½åº¦/æè¾¹å®½åº¦ã
 * @param {string} [options.strokeLinecap='butt'] - çº¿å¸½æ ·å¼ãstrokeLinecap æä¸ç§ç±»å âbutt", "round", "square"ã
 * @param {string} [options.strokeLineJoin='iter'] - çº¿æ®µè¿æ¥æ ·å¼ãstrokeLineJoin æä¸ç§ç±»å âmiter", "round", "bevel"ã
 * @param {string} [options.strokeDashstyle='solid'] - èçº¿ç±»åãstrokeDashstyle æå«ç§ç±»å âdot",âdash",âdashdot",âlongdash",âlongdashdot",âsolid", "dashed", "dotted"ãsolid è¡¨ç¤ºå®çº¿ã
 * @param {number} [options.pointRadius=6] - ç¹åå¾,åä½ä¸ºåç´ ã
 * @param {number} [options.shadowBlur=0] - é´å½±æ¨¡ç³åº¦ï¼ï¼å¤§äº 0 ææ;ï¼ãæ³¨ï¼è¯·å° shadowColor å±æ§ä¸ shadowBlur å±æ§ä¸èµ·ä½¿ç¨ï¼æ¥åå»ºé´å½±ã
 * @param {string} [options.shadowColor='#000000'] - é´å½±é¢è²ãæ³¨ï¼è¯·å° shadowColor å±æ§ä¸ shadowBlur å±æ§ä¸èµ·ä½¿ç¨ï¼æ¥åå»ºé´å½±ã
 * @param {number} [options.shadowOffsetX=0] - é´å½± X æ¹ååç§»å¼ã
 * @param {number} [options.shadowOffsetY=0] - é´å½± Y æ¹ååç§»å¼ã
 * @param {string} options.label - ä¸é¢è¦ç´ éå ææ¬æ ç­¾åå®¹ã
 * @param {string} [options.fontColor] - éå ææ¬å­ä½é¢è²ã
 * @param {number} [options.fontSize=12] - éå ææ¬å­ä½å¤§å°,åä½æ¯åç´ ã
 * @param {string} [options.fontStyle='normal'] - éå ææ¬å­ä½æ ·å¼ãå¯è®¾å¼ï¼"normal", "italic", "oblique"ã
 * @param {string} [options.fontVariant='normal'] - éå ææ¬å­ä½åä½ãå¯è®¾å¼ï¼"normal", "small-caps"ã
 * @param {string} [options.fontWeight='normal'] - éå ææ¬å­ä½ç²ç»ãå¯è®¾å¼ï¼"normal", "bold", "bolder", "lighter"ã
 * @param {string} [options.fontFamily='arial,sans-serif'] - éå ææ¬å­ä½ç³»åãfontFamily å¼æ¯å­ä½æåç§°æ/åç±»æåç§°çä¸ä¸ªä¼åè¡¨ï¼æ¯ä¸ªå¼éå·åå²ï¼
 *                             æµè§å¨ä¼ä½¿ç¨å®å¯è¯å«çç¬¬ä¸ä¸ªå¯ä»¥ä½¿ç¨å·ä½çå­ä½åç§°ï¼"times"ã"courier"ã"arial"ï¼æå­ä½ç³»ååç§°
 *                              ï¼"serif"ã"sans-serif"ã"cursive"ã"fantasy"ã"monospace"ï¼ã
 * @param {string} [options.labelPosition='top'] - éå ææ¬ä½ç½®, å¯ä»¥æ¯ 'inside', 'left', 'right', 'top', 'bottom'ã
 * @param {string} [options.labelAlign='center'] - éå ææ¬æ°´å¹³å¯¹é½ãå¯ä»¥æ¯ 'left', 'right', 'center'ã
 * @param {string} [options.labelBaseline='middle'] - éå ææ¬åç´å¯¹é½ã å¯ä»¥æ¯ 'top', 'bottom', 'middle' ã
 * @param {number} [options.labelXOffset=0] - éå ææ¬å¨xè½´æ¹åçåç§»éã
 * @param {number} [options.labelYOffset=0] - éå ææ¬å¨yè½´æ¹åçåç§»éã
 * @usage
 */
class ThemeStyle {


    constructor(options) {
        options = options || {};
        /**
         * @member {boolean} [ThemeStyle.prototype.fill=true]
         * @description æ¯å¦å¡«åï¼ä¸éè¦å¡«ååè®¾ç½®ä¸º falseãå¦æ fill ä¸ stroke åæ¶ä¸º falseï¼å°æ fill ä¸ stroke çé»è®¤å¼æ¸²æå¾å±ã
         */
        this.fill = true;
        /**
         * @member {string} [ThemeStyle.prototype.fillColor="#000000"]
         * @description åå­è¿å¶å¡«åé¢è²ã
         */
        this.fillColor = "#000000";
        /**
         *  @member {number} [ThemeStyle.prototype.fillOpacity=1]
         *  @description å¡«åä¸éæåº¦ãåå¼èå´[0, 1]ã
         */
        this.fillOpacity = 1;
        /**
         * @member {boolean} [ThemeStyle.prototype.stroke=false]
         * @description  æ¯å¦æè¾¹ï¼ä¸éè¦æè¾¹åè®¾ç½®ä¸ºfalseãå¦æ fill ä¸ stroke åæ¶ä¸º falseï¼å°æ fill ä¸ stroke çé»è®¤å¼æ¸²æå¾å±ã
         */
        this.stroke = false;
        /**
         * @member {string} [ThemeStyle.prototype.strokeColor="#000000"]
         * @description  åå­è¿å¶æè¾¹é¢è²ã
         */
        this.strokeColor = "#000000";
        /**
         * @member {number} [ThemeStyle.prototype.strokeOpacity=1]
         * @description  æè¾¹çä¸éæåº¦ãåå¼èå´[0, 1]ã
         */
        this.strokeOpacity = 1;
        /**
         * @member {number} [ThemeStyle.prototype.strokeWidth=1]
         * @description  çº¿å®½åº¦/æè¾¹å®½åº¦ã
         */
        this.strokeWidth = 1;
        /**
         * @member {string} [ThemeStyle.prototype.strokeLinecap="butt"]
         * @description  çº¿å¸½æ ·å¼ï¼strokeLinecap æä¸ç§ç±»å âbutt", "round", "square" ã
         */
        this.strokeLinecap = "butt";
        /**
         * @member {string} [ThemeStyle.prototype.strokeLineJoin="miter"]
         * @description  çº¿æ®µè¿æ¥æ ·å¼ï¼strokeLineJoin æä¸ç§ç±»å âmiter", "round", "bevel"ã
         */
        this.strokeLineJoin = "miter";
        /**
         * @member {string} [ThemeStyle.prototype.strokeDashstyle="solid"]
         * @description   èçº¿ç±»åï¼ strokeDashstyle æå«ç§ç±»å âdot",âdash",âdashdot",âlongdash",âlongdashdot",âsolid", "dashed", "dotted";
         * solid è¡¨ç¤ºå®çº¿ã
         */
        this.strokeDashstyle = "solid";
        /**
         * @member {number} [ThemeStyle.prototype.pointRadius=6]
         * @description   ç¹åå¾ãåä½ä¸ºåç´ ã
         */
        this.pointRadius = 6;
        /**
         * @member {number} [ThemeStyle.prototype.shadowBlur=0]
         * @description   é´å½±æ¨¡ç³åº¦ï¼ï¼å¤§äº 0 ææï¼ãæ³¨ï¼è¯·å° shadowColor å±æ§ä¸ shadowBlur å±æ§ä¸èµ·ä½¿ç¨ï¼æ¥åå»ºé´å½±ã
         */
        this.shadowBlur = 0;
        /**
         * @member {string} [ThemeStyle.prototype.shadowColor='#000000']
         * @description  é´å½±é¢è²ãæ³¨ï¼è¯·å° shadowColor å±æ§ä¸ shadowBlur å±æ§ä¸èµ·ä½¿ç¨ï¼æ¥åå»ºé´å½±ã
         */
        this.shadowColor = "#000000";
        /**
         * @member {number} [ThemeStyle.prototype.shadowOffsetX=0]
         * @description é´å½± X æ¹ååç§»å¼ã
         */
        this.shadowOffsetX = 0;
        /**
         * @member {number} ThemeStyle.prototype.shadowOffsetY
         * @description Y æ¹ååç§»å¼ã
         */
        this.shadowOffsetY = 0;
        /**
         * @member {string} [ThemeStyle.prototype.label]
         * @description ä¸é¢è¦ç´ éå ææ¬æ ç­¾åå®¹ã
         */
        this.label = "";
        /**
         * @member {boolean} [ThemeStyle.prototype.labelRect=false]
         * @description æ¯å¦æ¾ç¤ºææ¬æ ç­¾ç©å½¢èæ¯ã
         */
        this.labelRect = false;
        /**
         * @member {string} [ThemeStyle.prototype.fontColor]
         * @description éå ææ¬å­ä½é¢è²ã
         */
        this.fontColor = "";
        /**
         * @member {number} [ThemeStyle.prototype.fontSize=12]
         * @description éå ææ¬å­ä½å¤§å°,åä½æ¯åç´ ã
         */
        this.fontSize = 12;
        /**
         * @member {string} [ThemeStyle.prototype.fontStyle="normal"]
         * @description éå ææ¬å­ä½æ ·å¼ãå¯è®¾å¼ï¼"normal", "italic", "oblique"ã
         */
        this.fontStyle = "normal";
        /**
         * @member {string} [ThemeStyle.prototype.fontVariant="normal"]
         * @description éå ææ¬å­ä½åä½ãå¯è®¾å¼ï¼"normal", "small-caps"ã
         */
        this.fontVariant = "normal";
        /**
         * @member {string} [ThemeStyle.prototype.fontWeight="normal"]
         * @description éå ææ¬å­ä½ç²ç»ãå¯è®¾å¼ï¼"normal", "bold", "bolder", "lighter"ã
         */
        this.fontWeight = "normal";
        /**
         * @member {string} [ThemeStyle.prototype.fontFamily="arial,sans-serif"]
         * @description éå ææ¬å­ä½ç³»åãfontFamily å¼æ¯å­ä½æåç§°æ/åç±»æåç§°çä¸ä¸ªä¼åè¡¨ï¼æ¯ä¸ªå¼éå·åå²ï¼æµè§å¨ä¼ä½¿ç¨å®å¯è¯å«çç¬¬ä¸ä¸ª
         * å¯ä»¥ä½¿ç¨å·ä½çå­ä½åç§°ï¼"times"ã"courier"ã"arial"ï¼æå­ä½ç³»ååç§°ï¼"serif"ã"sans-serif"ã"cursive"ã"fantasy"ã"monospace"ï¼ã
         */
        this.fontFamily = "arial,sans-serif";
        /**
         * @member {string} [ThemeStyle.prototype.labelPosition='top']
         * @description éå ææ¬ä½ç½®, å¯ä»¥æ¯ 'inside', 'left', 'right', 'top', 'bottom'ã
         */
        this.labelPosition = "top";
        /**
         * @member {string} [ThemeStyle.prototype.labelAlign='center']
         * @description éå ææ¬æ°´å¹³å¯¹é½ãå¯ä»¥æ¯ 'left', 'right', 'center'ã
         */
        this.labelAlign = "center";
        /**
         * @member {string} [ThemeStyle.prototype.labelBaseline='middle']
         * @description  éå ææ¬åç´å¯¹é½ã å¯ä»¥æ¯ 'top', 'bottom', 'middle'ã
         */
        this.labelBaseline = "middle";
        /**
         * @member {number} [ThemeStyle.prototype.labelXOffset=0]
         * @description  éå ææ¬å¨ X è½´æ¹åçåç§»éã
         */
        this.labelXOffset = 0;
        /**
         * @member {number} [ThemeStyle.prototype.labelYOffset=0]
         * @description éå ææ¬å¨ Y è½´æ¹åçåç§»éã
         */
        this.labelYOffset = 0;

        Util.extend(this, options);
    }
}


;// CONCATENATED MODULE: ./src/common/style/index.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/






;// CONCATENATED MODULE: ./src/common/overlay/feature/ShapeParameters.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
/**
 * @class  ShapeParameters
 * @aliasclass Feature.ShapeParameters
 * @deprecatedclass SuperMap.Feature.ShapeParameters
 * @category Visualization Theme
 * @classdesc å¾å½¢åæ°åºç±»
 * @usage
 */
class ShapeParameters {
    constructor() {
        /**
         * @member {Array.<number>} [ShapeParameters.prototype.refOriginalPosition=[0,0]]
         * @description å¾å½¢åèåç¹ä½ç½®ï¼å¾å½¢çåèä¸­å¿ä½ç½®ã
         * refOriginalPosition æ¯é¿åº¦ä¸º 2 çæ°ç»ï¼ç¬¬ä¸ä¸ªåç´ è¡¨ç¤º x åæ ï¼ç¬¬äºä¸ªåç´ è¡¨ç¤º y åæ ã
         * refOriginalPosition è¡¨ç¤ºå¾å½¢çåèä¸­å¿ï¼éå¸¸æåµä¸ï¼å¾å½¢æ¯ä½¿ç¨ canvas çåç¹ä½ç½®ä½ä¸ºä½ç½®åèï¼
         * ä½ refOriginalPosition å¯ä»¥æ¹åå¾å½¢çåèä½ç½®ï¼ä¾å¦ï¼ refOriginalPosition = [80, 80],
         * å¾å½¢åç style.x = 20, style.y = 20ï¼é£ä¹åå¨ canvas ä¸­çå®éä½ç½®æ¯ [100, 100]ã
         * å¾å½¢ï¼Shapeï¼ çææä½ç½®ç¸å³å±æ§é½æ¯ä»¥ refOriginalPosition ä¸ºåèä¸­å¿ï¼
         * ä¹å°±æ¯è¯´å¾å½¢çææä½ç½®ä¿¡æ¯å¨ canvas ä¸­é½æ¯ä»¥ refOriginalPosition ä¸ºåèçç¸å¯¹ä½ç½®ï¼åªæ
         * refOriginalPosition çå¼ä¸º [0, 0] æ¶ï¼å¾å½¢çä½ç½®ä¿¡æ¯ææ¯ canvas ç»å¯¹ä½ç½®ã
         * å¾å½¢çä½ç½®ä¿¡æ¯éå¸¸æï¼style.pointListï¼style.xï¼style.yã
         */
        this.refOriginalPosition = [0, 0];

        /**
         * @member {string} ShapeParameters.prototype.refDataID
         * @description å¾å½¢æå³èæ°æ®ç IDï¼<{@link FeatureVector}> ç idï¼ã
         */
        this.refDataID = null;

        /**
         * @member {boolean} ShapeParameters.prototype.isHoverByRefDataID
         * @description æ¯å¦æ ¹æ® refDataID è¿è¡é«äº®ãç¨äºåæ¶é«äº®ææ refDataID ç¸åçå¾å½¢ã
         */
        this.isHoverByRefDataID = false;

        /**
         * @member {string} ShapeParameters.prototype.refDataHoverGroup
         * @description é«äº®å¾å½¢ç»çç»åãæ­¤å±æ§å¨ refDataID ææä¸ isHoverByRefDataID ä¸º true æ¶çæã
         * ä¸æ¦è®¾ç½®æ­¤å±æ§ï¼ä¸å±æ§å¼ææï¼åªæå³èåä¸ä¸ªæ°æ®çå¾å½¢ä¸æ­¤å±æ§ç¸åçå¾å½¢æä¼é«äº®ã
         */
        this.refDataHoverGroup = null;

        /**
         * @member {Object} ShapeParameters.prototype.dataInfo
         * @description å¾å½¢æºå¸¦çéå æ°æ®ã
         */
        this.dataInfo = null;

        /**
         * @member {boolean} ShapeParameters.prototype.clickable
         * @description æ¯å¦å¯ç¹å»ã
         */
        this.clickable = true;

        /**
         * @member {boolean} ShapeParameters.prototype.hoverable
         * @description æ¯å¦å¯ç¹å»ã
         */
        this.hoverable = true;

        /**
         * @member {Object} ShapeParameters.prototype.style
         * @description å¾å½¢æ ·å¼å¯¹è±¡ï¼å¯è®¾æ ·å¼å±æ§å¨å­ç±»ä¸­ç¡®å®ã
         */
        this.style = null;

        /**
         * @member {Object} ShapeParameters.prototype.highlightStyle
         * @description é«äº®æ ·å¼å¯¹è±¡ï¼å¯è®¾æ ·å¼å±æ§ä¸ style çå¯è®¾æ ·å¼å±æ§ç¸åã
         */
        this.highlightStyle = {};

        this.CLASS_NAME = "SuperMap.Feature.ShapeParameters";
    }


    /**
     * @function ShapeParameters.prototype.destroy
     * @description éæ¯å¯¹è±¡ã
     */
    destroy() {
        this.refOriginalPosition = null;
        this.refDataID = null;
        this.isHoverByRefDataID = null;
        this.refDataHoverGroup = null;
        this.dataInfo = null;
        this.clickable = null;
        this.hoverable = null;
        this.style = null;
        this.highlightStyle = null;
    }

}

;// CONCATENATED MODULE: ./src/common/overlay/feature/Point.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class  ShapeParametersPoint
 * @aliasclass Feature.ShapeParameters.Point
 * @deprecatedclass SuperMap.Feature.ShapeParameters.Point
 * @category Visualization Theme
 * @classdesc ç¹åæ°å¯¹è±¡ã
 * @extends {ShapeParameters}
 * @param {number} x - ç¹ x åæ ã
 * @param {number} y - ç¹ y åæ ã
 * @usage
 */

class Point_Point extends ShapeParameters {
    constructor(x, y) {
        super(x, y);
        /**
         * @member {number}  ShapeParametersPoint.prototype.x
         * @description ç¹ x åæ ã
         */
        this.x = !isNaN(x) ? x : 0;

        /**
         * @member {number}  ShapeParametersPoint.prototype.y
         * @description ç¹ y åæ ã
         */
        this.y = !isNaN(y) ? y : 0;

        /**
         * @member {number}  ShapeParametersPoint.prototype.r
         * @description ç¹çåå¾ã
         */
        this.r = 6;


        this.CLASS_NAME = "SuperMap.Feature.ShapeParameters.Point";
    }


    /**
     * @function ShapeParametersPoint.prototype.destroy
     * @description éæ¯å¯¹è±¡ã
     */
    destroy() {
        this.x = null;
        this.y = null;
        this.r = null;

        super.destroy();
    }

}

;// CONCATENATED MODULE: ./src/common/overlay/feature/Line.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class  ShapeParametersLine
 * @aliasclass Feature.ShapeParameters.Line
 * @deprecatedclass SuperMap.Feature.ShapeParameters.Line
 * @category Visualization Theme
 * @classdesc çº¿åæ°å¯¹è±¡ã
 * @extends {ShapeParameters}
 * @param {Array} pointList - çº¿è¦ç´ èç¹æ°ç»ï¼äºç»´æ°ç»ã
 * @usage
 */
class Line_Line extends ShapeParameters {
    constructor(pointList) {
        super(pointList);
        /**
         * @member {Array} ShapeParametersLine.prototype.pointList
         * @description çº¿è¦ç´ èç¹æ°ç»ï¼äºç»´æ°ç»ã
         * æ°ç»å½¢å¦ï¼
         * (start code)
         *  [
         *  [10, 20],         //èç¹
         *  [30, 40],
         *  [25, 30]         //æåä¸ä¸ªèç¹åç¬¬ä¸ä¸ªèç¹ä¸å¿ç¸åï¼ç»å¶æ¶èªå¨å°é­
         *   ]
         * (end)
         */
        this.pointList = pointList;

        this.CLASS_NAME = "SuperMap.Feature.ShapeParameters.Line";

    }

    /**
     * @function ShapeParametersLine.prototype.destroy
     * @description éæ¯å¯¹è±¡ã
     */
    destroy() {
        this.pointList = null;
        super.destroy();
    }

}

;// CONCATENATED MODULE: ./src/common/overlay/feature/Polygon.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class  ShapeParametersPolygon
 * @aliasclass Feature.ShapeParameters.Polygon
 * @deprecatedclass SuperMap.Feature.ShapeParameters.Polygon
 * @category Visualization Theme
 * @classdesc é¢åæ°å¯¹è±¡ã
 * @extends {ShapeParameters}
 * @param {Array} pointList - æ¨ªåæ ã
 * @usage
 */

class Polygon_Polygon extends ShapeParameters {
    constructor(pointList) {
        super(pointList);
        /**
         * @member {Array} ShapeParametersPolygon.prototype.pointList
         * @description é¢è¦ç´ èç¹æ°ç»ï¼äºç»´æ°ç»ã
         * æ°ç»å½¢å¦ï¼
         * (start code)
         *  [
         *  [10, 20],         //èç¹
         *  [30, 40],
         *  [25, 30]         //æåä¸ä¸ªèç¹åç¬¬ä¸ä¸ªèç¹ä¸å¿ç¸åï¼ç»å¶æ¶èªå¨å°é­
         *   ]
         * (end)
         */
        this.pointList = pointList;

        /**
         * @member {Array} ShapeParametersPolygon.prototype.holePolygonPointLists
         * @description å²æ´é¢å¤è¾¹å½¢é¡¶ç¹æ°ç»ï¼ä¸ç»´æ°ç»ï¼
         */
        this.holePolygonPointLists = null;

        this.CLASS_NAME = "SuperMap.Feature.ShapeParameters.Polygon";
    }

    /**
     * @function ShapeParametersPolygon.prototype.destroy
     * @description éæ¯å¯¹è±¡ã
     */
    destroy() {
        this.pointList = null;
        this.holePolygonPointLists = null;
        super.destroy();
    }
}

;// CONCATENATED MODULE: ./src/common/overlay/feature/Rectangle.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class  ShapeParametersRectangle
 * @aliasclass Feature.ShapeParameters.Rectangle
 * @deprecatedclass SuperMap.Feature.ShapeParameters.Rectangle
 * @category Visualization Theme
 * @classdesc ç©å½¢åæ°å¯¹è±¡ã
 * @extends {ShapeParameters}
 * @param {number} x - ç©å½¢ x åæ ã
 * @param {number} y - ç©å½¢ y åæ ã
 * @param {number} width - ç©å½¢ width å®½åº¦ã
 * @param {number} height - ç©å½¢ height é«åº¦ã
 * @usage
 */

class Rectangle_Rectangle extends ShapeParameters {
    constructor(x, y, width, height) {
        super(x, y, width, height);
        /**
         * @member {number} ShapeParametersRectangle.prototype.x
         * @description å·¦ä¸è§ x åæ ã
         */
        this.x = !isNaN(x) ? x : 0;

        /**
         * @member {number} ShapeParametersRectangle.prototype.y
         * @description å·¦ä¸è§ y åæ ã
         */
        this.y = !isNaN(x) ? y : 0;

        /**
         * @member {number} ShapeParametersRectangle.prototype.width
         * @description å®½åº¦ã
         */
        this.width = !isNaN(width) ? width : 0;

        /**
         * @member {number} ShapeParametersRectangle.prototype.height
         * @description é«åº¦ã
         */
        this.height = !isNaN(height) ? height : 0;

        this.CLASS_NAME = "SuperMap.Feature.ShapeParameters.Rectangle";
    }


    /**
     * @function ShapeParametersRectangle.prototype.destroy
     * @description éæ¯å¯¹è±¡ã
     */
    destroy() {
        this.x = null;
        this.y = null;
        this.width = null;
        this.height = null;

        super.destroy();
    }

}

;// CONCATENATED MODULE: ./src/common/overlay/feature/Sector.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class  ShapeParametersSector
 * @aliasclass Feature.ShapeParameters.Sector
 * @deprecatedclass SuperMap.Feature.ShapeParameters.Sector
 * @category Visualization Theme
 * @classdesc æå½¢åæ°å¯¹è±¡ã
 * @extends {ShapeParameters}
 * @param {number} x - åå¿ x åæ ã
 * @param {number} y - åå¿ y åæ ã
 * @param {number} r - å¤ååå¾ã
 * @param {number} startAngle - èµ·å§è§åº¦ãåå¼èå´[0, 360)ã
 * @param {number} endAngle - ç»æè§åº¦ãåå¼èå´(0, 360]ã
 * @param {number} [r0=0] - åååå¾ï¼æå®åå°åºç°åå¼§ï¼åæ¶æè¾¹é¿åº¦ä¸º'r - r0'ãåå¼èå´[0, r)ã
 * @usage
 */

class Sector extends ShapeParameters {
    constructor(x, y, r, startAngle, endAngle, r0, clockWise) {
        super(x, y, r, startAngle, endAngle, r0, clockWise);
        /**
         * @member {number} ShapeParametersSector.prototype.x
         * @description  åå¿ x åæ ã
         */
        this.x = !isNaN(x) ? x : 0;

        /**
         * @member {number} ShapeParametersSector.prototype.Y
         * @description  åå¿ Y åæ ã
         */
        this.y = !isNaN(y) ? y : 0;

        /**
         * @member {number} ShapeParametersSector.prototype.r
         * @description  å¤ååå¾ã
         */
        this.r = !isNaN(r) ? r : 0;

        /**
         * @member {number} ShapeParametersSector.prototype.startAngle
         * @description  èµ·å§è§åº¦ãåå¼èå´[0, 360)ï¼é»è®¤å¼ï¼nullã
         */
        this.startAngle = !isNaN(startAngle) ? startAngle : 0;

        /**
         * @member {number} ShapeParametersSector.prototype.endAngle
         * @description  ç»æè§åº¦ãåå¼èå´(0, 360]ï¼é»è®¤å¼ï¼nullã
         */
        this.endAngle =  !isNaN(endAngle) ? endAngle : 0;

        /**
         * @member {number} [ShapeParametersSector.prototype.r0=0]
         * @description åååå¾ï¼æå®åå°åºç°åå¼§ï¼åæ¶æè¾¹é¿åº¦ä¸º r å r0ãåå¼èå´[0, r)ã
         */
        this.r0 = !isNaN(r0) ? r0 : 0;

        /**
         * @member {number} [ShapeParametersSector.prototype.clockWise=false]
         * @description æ¯å¦æ¯é¡ºæ¶éãé»è®¤å¼ï¼falseã
         */
        this.clockWise = clockWise;

        this.CLASS_NAME = "SuperMap.Feature.ShapeParameters.Sector";
    }

    /**
     * @function ShapeParametersSector.prototype.destroy
     * @description éæ¯å¯¹è±¡ã
     */
    destroy() {
        this.x = null;
        this.y = null;
        this.r = null;
        this.startAngle = null;
        this.endAngle = null;
        this.r0 = null;
        this.clockWise = null;

        super.destroy();
    }

}

;// CONCATENATED MODULE: ./src/common/overlay/feature/Label.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class ShapeParametersLabel
 * @aliasclass Feature.ShapeParameters.Label
 * @deprecatedclass SuperMap.Feature.ShapeParameters.Label
 * @category Visualization Theme
 * @classdesc æ ç­¾åæ°å¯¹è±¡ã
 * @extends {ShapeParameters}
 * @param {number} x - æ¨ªåæ ã
 * @param {number} y - çºµåæ ã
 * @param {string} text - å¾å½¢ä¸­çéå ææ¬ã
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   new {namespace}.Feature.ShapeParameters.Label(x, y, text);
 *
 *   // å¼ç¨çåæ³
 *   new SuperMap.Feature.ShapeParameters.Label(x, y, text);
 *
 * </script>
 * // ES6 Import
 * import { ShapeParametersLabel } from '{npm}';
 * new ShapeParametersLabel(x, y, text);
 *
 * // å¼ç¨çåæ³
 * import { Label } from '{npm}';
 * new Label(x, y, text);
 *
 * ```
 */

class Label extends ShapeParameters {
    constructor(x, y, text) {
        super(x, y, text);
        /**
         * @member {number} ShapeParametersLabel.prototype.x
         * @description æ ç­¾ x åæ ã
         */
        this.x = x;

        /**
         * @member {number} ShapeParametersLabel.prototype.y
         * @description æ ç­¾ y åæ ã
         */
        this.y = y;

        /**
         * @member {number} ShapeParametersLabel.prototype.text
         * @description æ ç­¾çææ¬åå®¹ã
         */
        this.text = text;

        this.CLASS_NAME = "SuperMap.Feature.ShapeParameters.Label";
    }


    /**
     * @function ShapeParametersLabel.prototype.destroy
     * @description éæ¯å¯¹è±¡ã
     */
    destroy() {
        this.x = null;
        this.y = null;
        this.text = null;

        super.destroy();
    }


}

;// CONCATENATED MODULE: ./src/common/overlay/feature/Image.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class ShapeParametersImage
 * @aliasclass Feature.ShapeParameters.Image
 * @deprecatedclass SuperMap.Feature.ShapeParameters.Image
 * @category Visualization Theme
 * @classdesc å¾çåæ°å¯¹è±¡ã
 * @extends {ShapeParameters}
 * @param {number} x - å·¦ä¸è§æ¨ªåæ ã
 * @param {number} y - å·¦ä¸è§çºµåæ ã
 * @param {(string|Object)} image - å¾çå°åæCavanså¯¹è±¡ã
 * @param {number} width - ç»å¶å°ç»å¸ä¸çå®½åº¦ï¼é»è®¤ä¸ºå¾çé«åº¦ã
 * @param {number} height - ç»å¶å°ç»å¸ä¸çé«åº¦ï¼é»è®¤ä¸ºå¾çé«åº¦ã
 * @param {number} sx - ä»å¾çä¸­è£åªçå·¦ä¸è§æ¨ªåæ ã
 * @param {number} sy - ä»å¾çä¸­è£åªçå·¦ä¸è§çºµåæ ã
 * @param {number} sWidth - ä»å¾çä¸­è£åªçå®½åº¦ï¼é»è®¤ä¸ºå¾çé«åº¦ã
 * @param {number} sHeight - ç»å¶å°ç»å¸ä¸çé«åº¦ï¼é»è®¤ä¸ºå¾çé«åº¦ã
 * @usage
 */
class Image_Image extends ShapeParameters {
    constructor(x, y, image, width, height, sx, sy, sWidth, sHeight) {
        super(x, y, image, width, height, sx, sy, sWidth, sHeight);
        /**
         * @member {number} ShapeParametersImage.prototype.x
         * @description å·¦ä¸è§æ¨ªåæ ï¼å¿è®¾åæ°ã
         */
        this.x = x;

        /**
         * @member {number} ShapeParametersImage.prototype.y
         * @description å·¦ä¸è§çºµåæ ï¼å¿è®¾åæ°ã
         */
        this.y = y;

        /**
         * @member {(string|Object)} ShapeParametersImage.prototype.image
         * @description å¾çå°åã
         */
        this.image = image;

        /**
         * @member {number} ShapeParametersImage.prototype.width
         * @description ç»å¶å°ç»å¸ä¸çå®½åº¦ï¼é»è®¤ä¸ºå¾çé«åº¦ã
         */
        this.width = width;

        /**
         * @member {number} ShapeParametersImage.prototype.height
         * @description ç»å¶å°ç»å¸ä¸çé«åº¦ï¼é»è®¤ä¸ºå¾çé«åº¦ã
         */
        this.height = height;

        /**
         * @member {number} ShapeParametersImage.prototype.sx
         * @description ä»å¾çä¸­è£åªçå·¦ä¸è§æ¨ªåæ ã
         */
        this.sx = sx;

        /**
         * @member {number} ShapeParametersImage.prototype.sy
         * @description ä»å¾çä¸­è£åªçå·¦ä¸è§çºµåæ ã
         */
        this.sy = sy;

        /**
         * @member {number} ShapeParametersImage.prototype.sWidth
         * @description ä»å¾çä¸­è£åªçå®½åº¦ï¼é»è®¤ä¸ºå¾çé«åº¦ã
         */
        this.sWidth = sWidth;

        /**
         * @member {number} ShapeParametersImage.prototype.sHeight
         * @description ç»å¶å°ç»å¸ä¸çé«åº¦ï¼é»è®¤ä¸ºå¾çé«åº¦ã
         */
        this.sHeight = sHeight;

        this.CLASS_NAME = "SuperMap.Feature.ShapeParameters.Image";

    }


    /**
     * @function ShapeParametersImage.prototype.destroy
     * @description éæ¯å¯¹è±¡ã
     */
    destroy() {
        this.x = null;
        this.y = null;
        this.image = null;
        this.width = null;
        this.height = null;
        this.sx = null;
        this.sy = null;
        this.sWidth = null;
        this.sHeight = null;
        super.destroy();
    }
}

;// CONCATENATED MODULE: ./src/common/overlay/feature/Circle.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class ShapeParametersCircle
 * @aliasclass Feature.ShapeParameters.Circle
 * @deprecatedclass SuperMap.Feature.ShapeParameters.Circle
 * @classdesc åå½¢åæ°å¯¹è±¡ã
 * @category Visualization Theme
 * @extends {ShapeParameters}
 * @param {number} x - åå¿ x åæ ã
 * @param {number} y - åå¿ y åæ ã
 * @param {number} r - ååå¾ã
 * @usage
 */

class Circle_Circle extends ShapeParameters {
    constructor(x, y, r) {
        super(x, y, r);
        /**
         * @member {number} ShapeParametersCircle.prototype.x
         * @description åå¿ x åæ ã
         */
        this.x = !isNaN(x) ? x : 0;

        /**
         * @member {number} ShapeParametersCircle.prototype.y
         * @description åå¿ y åæ ã
         */
        this.y =  !isNaN(y) ? y : 0;

        /**
         * @member {number} ShapeParametersCircle.prototype.r
         * @description ååå¾ã
         */
        this.r =  !isNaN(r) ? r : 0;

        this.CLASS_NAME = "SuperMap.Feature.ShapeParameters.Circle";

    }


    /**
     * @function ShapeParametersCircle.prototype.destroy
     * @description éæ¯å¯¹è±¡ã
     */
    destroy() {
        this.x = null;
        this.y = null;
        this.r = null;
        super.destroy();
    }

}

;// CONCATENATED MODULE: ./src/common/overlay/levelRenderer/Eventful.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
/**
 * @class  LevelRenderer.Eventful
 * @category Visualization Theme
 * @classdesc äºä»¶ååå¨è¶ç±»ï¼æææ¯æäºä»¶å¤ççç±»åæ¯æ­¤ç±»çå­ç±»ã
 * æ­¤ç±»ä¸å¯å®ä¾åã
 * æ¯æçäºä»¶ï¼
 * Symbolizer properties:
 * onclick - {function} é»è®¤å¼ï¼nullã
 * onmouseover - {function} é»è®¤å¼ï¼nullã
 * onmouseout - {function} é»è®¤å¼ï¼nullã
 * onmousemove - {function} é»è®¤å¼ï¼nullã
 * onmousewheel - {function} é»è®¤å¼ï¼nullã
 * onmousedown - {function} é»è®¤å¼ï¼nullã
 * onmouseup - {function} é»è®¤å¼ï¼nullã
 * ondragstart - {function} é»è®¤å¼ï¼nullã
 * ondragend - {function} é»è®¤å¼ï¼nullã
 * ondragenter - {function} é»è®¤å¼ï¼nullã
 * ondragleave - {function} é»è®¤å¼ï¼nullã
 * ondragover - {function} é»è®¤å¼ï¼nullã
 * ondrop - {function} é»è®¤å¼ï¼nullã
 * @private
 */
class Eventful {
    constructor() {
        /**
         * @member {Object} LevelRenderer.Eventful.prototype._handlers
         * @description äºä»¶å¤çå¯¹è±¡ï¼äºä»¶ååå¨ï¼ã
         */
        this._handlers = {};

        this.CLASS_NAME = "SuperMap.LevelRenderer.Eventful";
    }


    /**
     * @function {Object} LevelRenderer.Eventful.prototype.destroy
     * @description éæ¯å¯¹è±¡ï¼éæ¾èµæºãè°ç¨æ­¤å½æ°åææå±æ§å°è¢«ç½®ä¸º nullã
     */
    destroy() {
        this._handlers = null;
    }


    /**
     * @function LevelRenderer.Eventful.prototype.one
     * @description åæ¬¡è§¦åç»å®ï¼dispatchåéæ¯ã
     * @param {string} event - äºä»¶åã
     * @param {boolean} handler - ååºå½æ°ã
     * @param {Object} context - contextã
     * @returns {LevelRenderer.Eventful} this
     */
    one(event, handler, context) {
        var _h = this._handlers;

        if (!handler || !event) {
            return this;
        }

        if (!_h[event]) {
            _h[event] = [];
        }

        _h[event].push({
            h: handler,
            one: true,
            ctx: context || this
        });

        return this;
    }


    /**
     * @function LevelRenderer.Eventful.prototype.bind
     * @description ç»å®äºä»¶ã
     * @param {string} event - äºä»¶åã
     * @param {boolean} handler - ååºå½æ°ã
     * @param {Object} context - contextã
     * @returns {LevelRenderer.Eventful} this
     */
    bind(event, handler, context) {
        var _h = this._handlers;

        if (!handler || !event) {
            return this;
        }

        if (!_h[event]) {
            _h[event] = [];
        }

        _h[event].push({
            h: handler,
            one: false,
            ctx: context || this
        });

        return this;
    }


    /**
     * @function LevelRenderer.Eventful.prototype.unbind
     * @description è§£ç»äºä»¶ã
     * @param {string} event - äºä»¶åã
     * @param {boolean} handler - ååºå½æ°ã
     * @returns {LevelRenderer.Eventful} this
     */
    unbind(event, handler) {
        var _h = this._handlers;

        if (!event) {
            this._handlers = {};
            return this;
        }

        if (handler) {
            if (_h[event]) {
                var newList = [];
                for (var i = 0, l = _h[event].length; i < l; i++) {
                    if (_h[event][i]['h'] != handler) {
                        newList.push(_h[event][i]);
                    }
                }
                _h[event] = newList;
            }

            if (_h[event] && _h[event].length === 0) {
                delete _h[event];
            }
        } else {
            delete _h[event];
        }

        return this;
    }


    /**
     * @function LevelRenderer.Eventful.prototype.dispatch
     * @description äºä»¶ååã
     * @param {string} type - äºä»¶ç±»åã
     * @returns {LevelRenderer.Eventful} this
     */
    dispatch(type) {
        if (this._handlers[type]) {
            var args = arguments;
            var argLen = args.length;

            if (argLen > 3) {
                args = Array.prototype.slice.call(args, 1);
            }

            var _h = this._handlers[type];
            var len = _h.length;
            for (var i = 0; i < len;) {
                // Optimize advise from backbone
                switch (argLen) {
                    case 1:
                        _h[i]['h'].call(_h[i]['ctx']);
                        break;
                    case 2:
                        _h[i]['h'].call(_h[i]['ctx'], args[1]);
                        break;
                    case 3:
                        _h[i]['h'].call(_h[i]['ctx'], args[1], args[2]);
                        break;
                    default:
                        // have more than 2 given arguments
                        _h[i]['h'].apply(_h[i]['ctx'], args);
                        break;
                }

                if (_h[i]['one']) {
                    _h.splice(i, 1);
                    len--;
                } else {
                    i++;
                }
            }
        }

        return this;
    }


    /**
     * @function LevelRenderer.Eventful.prototype.dispatchWithContext
     * @description å¸¦æcontextçäºä»¶ååï¼æåä¸ä¸ªåæ°æ¯äºä»¶åè°ç contextã
     * @param {string} type - äºä»¶ç±»åã
     * @returns {LevelRenderer.Eventful} this
     */
    dispatchWithContext(type) {
        if (this._handlers[type]) {
            var args = arguments;
            var argLen = args.length;

            if (argLen > 4) {
                args = Array.prototype.slice.call(args, 1, args.length - 1);
            }
            var ctx = args[args.length - 1];

            var _h = this._handlers[type];
            var len = _h.length;
            for (var i = 0; i < len;) {
                // Optimize advise from backbone
                switch (argLen) {
                    case 1:
                        _h[i]['h'].call(ctx);
                        break;
                    case 2:
                        _h[i]['h'].call(ctx, args[1]);
                        break;
                    case 3:
                        _h[i]['h'].call(ctx, args[1], args[2]);
                        break;
                    default:
                        // have more than 2 given arguments
                        _h[i]['h'].apply(ctx, args);
                        break;
                }

                if (_h[i]['one']) {
                    _h.splice(i, 1);
                    len--;
                } else {
                    i++;
                }
            }
        }

        return this;
    }

}

;// CONCATENATED MODULE: ./src/common/overlay/levelRenderer/Vector.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
/**
 * @private
 * @class  LevelRenderer.Tool.Vector
 * @category Visualization Theme
 * @classdesc LevelRenderer äºç»´åéç±»
 *
 */
class levelRenderer_Vector_Vector {
    constructor() {
        this.ArrayCtor = typeof Float32Array === 'undefined'
            ? Array
            : Float32Array;

        this.CLASS_NAME = "SuperMap.LevelRenderer.Tool.Vector";
    }

    /**
     * @function LevelRenderer.Tool.Vector.prototype.create
     * @description åå»ºä¸ä¸ªåéã
     *
     * @param {number} x - xåæ 
     * @param {number} y - Yåæ 
     * @return {Vector2} åéã
     */
    create(x, y) {
        var ArrayCtor = this.ArrayCtor;

        var out = new ArrayCtor(2);
        out[0] = x || 0;
        out[1] = y || 0;

        return out;
    }

    /**
     * @function LevelRenderer.Tool.Vector.prototype.copy
     * @description å¤å¶ä¸ä¸ªåéã
     *
     * @param {Vector2} out - åºç¡åéã
     * @param {Vector2} v - åéã
     * @return {Vector2} åéåéã
     */
    copy(out, v) {
        out[0] = v[0];
        out[1] = v[1];
        return out;
    }

    /**
     * @function LevelRenderer.Tool.Vector.prototype.set
     * @description è®¾ç½®åéçä¸¤ä¸ªé¡¹ã
     *
     * @param {Vector2} out - åºç¡åéã
     * @param {number} a - é¡¹ aã
     * @param {number} b - é¡¹ bã
     * @return {Vector2} ç»æã
     */
    set(out, a, b) {
        out[0] = a;
        out[1] = b;
        return out;
    }

    /**
     * @function LevelRenderer.Tool.Vector.prototype.add
     * @description åéç¸å ã
     *
     * @param {Vector2} out - åºç¡åéã
     * @param {Vector2} v1 - åé v1ã
     * @param {Vector2} v2 - åé v2ã
     * @return {Vector2} ç»æã
     */
    add(out, v1, v2) {
        out[0] = v1[0] + v2[0];
        out[1] = v1[1] + v2[1];
        return out;
    }

    /**
     * @function LevelRenderer.Tool.Vector.prototype.scaleAndAdd
     * @description åéç¼©æ¾åç¸å ã
     * @param {Vector2} out - åºç¡åéã
     * @param {Vector2} v1 - åé v1ã
     * @param {Vector2} v2 - åé v2ï¼ç¼©æ¾åéï¼ã
     * @param {number} a - ç¼©æ¾åæ°ã
     * @return {Vector2} ç»æã
     */
    scaleAndAdd(out, v1, v2, a) {
        out[0] = v1[0] + v2[0] * a;
        out[1] = v1[1] + v2[1] * a;
        return out;
    }

    /**
     * @function LevelRenderer.Tool.Vector.prototype.sub
     * @description åéç¸åã
     * @param {Vector2} out - åºç¡åéã
     * @param {Vector2} v1 - åé v1ã
     * @param {Vector2} v2 - åé v2ã
     * @return {Vector2} ç»æã
     */
    sub(out, v1, v2) {
        out[0] = v1[0] - v2[0];
        out[1] = v1[1] - v2[1];
        return out;
    }

    /**
     * @function LevelRenderer.Tool.Vector.prototype.len
     * @description åéé¿åº¦ã
     * @param {Vector2} v - åéã
     * @return {number} åéé¿åº¦ã
     */
    len(v) {
        return Math.sqrt(this.lenSquare(v));
    }

    /**
     * @function LevelRenderer.Tool.Vector.prototype.lenSquare
     * @description åéé¿åº¦å¹³æ¹ã
     * @param {Vector2} v - åéã
     * @return {number} åéé¿åº¦å¹³æ¹ã
     */
    lenSquare(v) {
        return v[0] * v[0] + v[1] * v[1];
    }

    /**
     * @function LevelRenderer.Tool.Vector.prototype.mul
     * @description åéä¹æ³ã
     * @param {Vector2} out - åºç¡åéã
     * @param {Vector2} v1 - åé v1ã
     * @param {Vector2} v2 - åé v2ã
     * @return {Vector2} ç»æã
     */
    mul(out, v1, v2) {
        out[0] = v1[0] * v2[0];
        out[1] = v1[1] * v2[1];
        return out;
    }

    /**
     * @function LevelRenderer.Tool.Vector.prototype.div
     * @description åéé¤æ³ã
     *
     * @param {Vector2} out - åºç¡åéã
     * @param {Vector2} v1 - åé v1ã
     * @param {Vector2} v2 - åé v2ã
     * @return {Vector2} ç»æã
     */
    div(out, v1, v2) {
        out[0] = v1[0] / v2[0];
        out[1] = v1[1] / v2[1];
        return out;
    }

    /**
     * @function LevelRenderer.Tool.Vector.prototype.dot
     * @description åéç¹ä¹ã
     *
     * @param  {Vector2} v1 - åé v1ã
     * @param  {Vector2} v2 - åé v2ã
     * @return {number} åéç¹ä¹ã
     */
    dot(v1, v2) {
        return v1[0] * v2[0] + v1[1] * v2[1];
    }

    /**
     * @function LevelRenderer.Tool.Vector.prototype.scale
     * @description åéç¼©æ¾ã
     *
     * @param {Vector2} out - åºç¡åéã
     * @param {Vector2} v - åévã
     * @param {number} s -ç¼©æ¾åæ°ã
     * @return {Vector2} ç»æã
     */
    scale(out, v, s) {
        out[0] = v[0] * s;
        out[1] = v[1] * s;
        return out;
    }

    /**
     * @function LevelRenderer.Tool.Vector.prototype.normalize
     * @description åéå½ä¸åã
     *
     * @param {Vector2} out - åºç¡åéã
     * @param {Vector2} v - åé vã
     * @return {Vector2} ç»æã
     */
    normalize(out, v) {
        var d = this.len(v);
        if (d === 0) {
            out[0] = 0;
            out[1] = 0;
        } else {
            out[0] = v[0] / d;
            out[1] = v[1] / d;
        }
        return out;
    }

    /**
     * @function LevelRenderer.Tool.Vector.prototype.distance
     * @description è®¡ç®åéé´è·ç¦»ã
     *
     * @param {Vector2} v1 - åé v1ã
     * @param {Vector2} v2 - åé v2ã
     * @return {number} åéé´è·ç¦»ã
     */
    distance(v1, v2) {
        return Math.sqrt(
            (v1[0] - v2[0]) * (v1[0] - v2[0])
            + (v1[1] - v2[1]) * (v1[1] - v2[1])
        );
    }

    /**
     * @function LevelRenderer.Tool.Vector.prototype.distanceSquare
     * @description åéè·ç¦»å¹³æ¹ã
     *
     * @param {Vector2} v1 - åé v1ã
     * @param {Vector2} v2 - åé v2ã
     * @return {number} åéè·ç¦»å¹³æ¹ã
     */
    distanceSquare(v1, v2) {
        return (v1[0] - v2[0]) * (v1[0] - v2[0])
            + (v1[1] - v2[1]) * (v1[1] - v2[1]);
    }

    /**
     * @function LevelRenderer.Tool.Vector.prototype.negate
     * @description æ±è´åéã
     *
     * @param {Vector2} out - åºç¡åéã
     * @param {Vector2} v - åé vã
     * @return {Vector2} è´åéã
     */
    negate(out, v) {
        out[0] = -v[0];
        out[1] = -v[1];
        return out;
    }

    /**
     * @function LevelRenderer.Tool.Vector.prototype.lerp
     * @description ä¸¤ç¹ä¹é´çº¿æ§æå¼ã
     *
     * @param {Vector2} out - åºç¡åéã
     * @param {Vector2} v1 - åé v1ã
     * @param {Vector2} v2 - åé v2ã
     * @param {number} t
     * @return {Vector2} ç»æã
     */
    lerp(out, v1, v2, t) {
        out[0] = v1[0] + t * (v2[0] - v1[0]);
        out[1] = v1[1] + t * (v2[1] - v1[1]);
        return out;
    }

    /**
     * @function LevelRenderer.Tool.Vector.prototype.applyTransform
     * @description ç©éµå·¦ä¹åéã
     *
     * @param {Vector2} out - åºç¡åéã
     * @param {Vector2} v1 - åé v1ã
     * @param {Vector2} v2 - åé v2ã
     * @return {Vector2} ç»æã
     */
    applyTransform(out, v, m) {
        var x = v[0];
        var y = v[1];
        out[0] = m[0] * x + m[2] * y + m[4];
        out[1] = m[1] * x + m[3] * y + m[5];
        return out;
    }

    /**
     * @function LevelRenderer.Tool.Vector.prototype.min
     * @description æ±ä¸¤ä¸ªåéæå°å¼ã
     * @param {Vector2} out - åºç¡åéã
     * @param {Vector2} v1 - åé v1ã
     * @param {Vector2} v2 - åé v2ã
     * @return {Vector2} ç»æã
     */
    min(out, v1, v2) {
        out[0] = Math.min(v1[0], v2[0]);
        out[1] = Math.min(v1[1], v2[1]);
        return out;
    }

    /**
     * @function LevelRenderer.Tool.Vector.prototype.max
     * @description æ±ä¸¤ä¸ªåéæå¤§å¼ã
     *
     * @param {Vector2} out - åºç¡åéã
     * @param {Vector2} v1 - åé v1ã
     * @param {Vector2} v2 - åé v2ã
     * @return {Vector2} ç»æã
     */
    max(out, v1, v2) {
        out[0] = Math.max(v1[0], v2[0]);
        out[1] = Math.max(v1[1], v2[1]);
        return out;
    }


    /**
     * @function LevelRenderer.Tool.Vector.prototype.length
     * @description åéé¿åº¦ã
     *
     * @param {Vector2} v - åéã
     * @return {number} åéé¿åº¦ã
     */
    length(v) {
        return this.len(v);
    }

    /**
     * @function LevelRenderer.Tool.Vector.prototype.lengthSquare
     * @description åéé¿åº¦å¹³æ¹ã
     *
     * @param {Vector2} v - åéã
     * @return {number} åéé¿åº¦å¹³æ¹ã
     */
    lengthSquare(v) {
        return this.lenSquare(v);
    }

    /**
     * @function LevelRenderer.Tool.Vector.prototype.dist
     * @description è®¡ç®åéé´è·ç¦»ã
     *
     * @param {Vector2} v1 - åé v1ã
     * @param {Vector2} v2 - åé v2ã
     * @return {number} åéé´è·ç¦»ã
     */
    dist(v1, v2) {
        return this.distance(v1, v2);
    }

    /**
     * @function LevelRenderer.Tool.Vector.prototype.distSquare
     * @description åéè·ç¦»å¹³æ¹ã
     *
     * @param {Vector2} v1 - åé v1ã
     * @param {Vector2} v2 - åé v2ã
     * @return {number} åéè·ç¦»å¹³æ¹
     */
    distSquare(v1, v2) {
        return this.distanceSquare(v1, v2);
    }

}

;// CONCATENATED MODULE: ./src/common/overlay/levelRenderer/Curve.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class  LevelRenderer.Tool.Curve
 * @category Visualization Theme
 * @classdesc LevelRenderer å·¥å·-æ²çº¿
 * @private
 */
class Curve_Curve {
    constructor() {
        /**
         * @member {LevelRenderer.Tool.Vector} LevelRenderer.Tool.Curve.prototype.vector
         * @description ç¢éå·¥å·ã
         */
        this.vector = new levelRenderer_Vector_Vector();

        /**
         * @member {number} LevelRenderer.Tool.Curve.prototype.EPSILON
         * @description eã
         */
        this.EPSILON = 1e-4;

        /**
         * @member {number} LevelRenderer.Tool.Curve.prototype.THREE_SQRT
         * @description 3 çå¹³æ¹æ ¹ã
         */
        this.THREE_SQRT = Math.sqrt(3);

        /**
         * @member {number} LevelRenderer.Tool.Curve.prototype.ONE_THIRD
         * @description 1/3ã
         */
        this.ONE_THIRD = 1 / 3;

        this.CLASS_NAME = "SuperMap.LevelRenderer.Tool.Curve";
    }


    /*
     * Method: evalCubicCoeff
     *
     * Parameters:
     * a - {number} å¼ã
     * b - {number} å¼ã
     * c - {number} å¼ã
     * d - {number} å¼ã
     * t - {number} å¼ã
     *
     * Returns:
     * {number}
     */

    /*
     evalCubicCoeff: function(a, b, c, d, t){
     return ((a * t + b) * t + c) * t + d;
     },
     */

    /**
     * @function LevelRenderer.Tool.Curve.prototype.isAroundZero
     * @description å¤æ­ä¸ä¸ªå¼æ¯å¦è¶äº0ï¼å¤æ­åèå¼ï¼1e-4ã
     * @param {number} val - å¼ã
     * @returns {boolean} å¼æ¯å¦è¶äº0ã
     */
    isAroundZero(val) {
        return val > -this.EPSILON && val < this.EPSILON;
    }


    /**
     * @function LevelRenderer.Tool.Curve.prototype.isNotAroundZero
     * @description å¤æ­ä¸ä¸ªå¼æ¯å¦ä¸è¶äº0ï¼å¤æ­åèå¼ï¼1e-4ã
     * @param {number} val - å¼ã
     * @returns {boolean} å¼æ¯å¦ä¸è¶äº0ã
     */
    isNotAroundZero(val) {
        return val > this.EPSILON || val < -this.EPSILON;
    }


    /**
     * @function LevelRenderer.Tool.Curve.prototype.cubicAt
     * @description è®¡ç®ä¸æ¬¡è´å¡å°å¼
     * @param {number} p0 - ç¹p0ã
     * @param {number} p1 - ç¹p1ã
     * @param {number} p2 - ç¹p2ã
     * @param {number} p3 - ç¹p3ã
     * @param {number} t - tå¼ã
     * @returns {number} ä¸æ¬¡è´å¡å°å¼ã
     */
    cubicAt(p0, p1, p2, p3, t) {
        var onet = 1 - t;
        return onet * onet * (onet * p0 + 3 * t * p1)
            + t * t * (t * p3 + 3 * onet * p2);
    }


    /**
     * @function LevelRenderer.Tool.Curve.prototype.cubicDerivativeAt
     * @description è®¡ç®ä¸æ¬¡è´å¡å°å¯¼æ°å¼
     * @param {number} p0 - ç¹p0ã
     * @param {number} p1 - ç¹p1ã
     * @param {number} p2 - ç¹p2ã
     * @param {number} p3 - ç¹p3ã
     * @param {number} t - tå¼ã
     * @returns {number} ä¸æ¬¡è´å¡å°å¯¼æ°å¼ã
     */
    cubicDerivativeAt(p0, p1, p2, p3, t) {
        var onet = 1 - t;
        return 3 * (
            ((p1 - p0) * onet + 2 * (p2 - p1) * t) * onet
            + (p3 - p2) * t * t
        );
    }


    /**
     * @function LevelRenderer.Tool.Curve.prototype.cubicRootAt
     * @description è®¡ç®ä¸æ¬¡è´å¡å°æ¹ç¨æ ¹ï¼ä½¿ç¨çéå¬å¼
     * @param {number} p0 - ç¹p0ã
     * @param {number} p1 - ç¹p1ã
     * @param {number} p2 - ç¹p2ã
     * @param {number} p3 - ç¹p3ã
     * @param {number} val - å¼ã
     * @param {Array.<number>} roots - æææ ¹æ°ç®ã
     * @returns {number} æææ ¹ã
     */
    cubicRootAt(p0, p1, p2, p3, val, roots) {
        // Evaluate roots of cubic functions
        var a = p3 + 3 * (p1 - p2) - p0;
        var b = 3 * (p2 - p1 * 2 + p0);
        var c = 3 * (p1 - p0);
        var d = p0 - val;

        var A = b * b - 3 * a * c;
        var B = b * c - 9 * a * d;
        var C = c * c - 3 * b * d;

        var n = 0;

        if (this.isAroundZero(A) && this.isAroundZero(B)) {
            if (this.isAroundZero(b)) {
                roots[0] = 0;
            } else {
                let t1 = -c / b;  //t1, t2, t3, b is not zero
                if (t1 >= 0 && t1 <= 1) {
                    roots[n++] = t1;
                }
            }
        } else {
            var disc = B * B - 4 * A * C;

            if (this.isAroundZero(disc)) {
                var K = B / A;
                let t1 = -b / a + K;  // t1, a is not zero
                let t2 = -K / 2;  // t2, t3
                if (t1 >= 0 && t1 <= 1) {
                    roots[n++] = t1;
                }
                if (t2 >= 0 && t2 <= 1) {
                    roots[n++] = t2;
                }
            } else if (disc > 0) {
                let discSqrt = Math.sqrt(disc);
                let Y1 = A * b + 1.5 * a * (-B + discSqrt);
                let Y2 = A * b + 1.5 * a * (-B - discSqrt);
                if (Y1 < 0) {
                    Y1 = -Math.pow(-Y1, this.ONE_THIRD);
                } else {
                    Y1 = Math.pow(Y1, this.ONE_THIRD);
                }
                if (Y2 < 0) {
                    Y2 = -Math.pow(-Y2, this.ONE_THIRD);
                } else {
                    Y2 = Math.pow(Y2, this.ONE_THIRD);
                }
                let t1 = (-b - (Y1 + Y2)) / (3 * a);
                if (t1 >= 0 && t1 <= 1) {
                    roots[n++] = t1;
                }
            } else {
                var T = (2 * A * b - 3 * a * B) / (2 * Math.sqrt(A * A * A));
                var theta = Math.acos(T) / 3;
                var ASqrt = Math.sqrt(A);
                var tmp = Math.cos(theta);

                let t1 = (-b - 2 * ASqrt * tmp) / (3 * a);
                let t2 = (-b + ASqrt * (tmp + this.THREE_SQRT * Math.sin(theta))) / (3 * a);
                let t3 = (-b + ASqrt * (tmp - this.THREE_SQRT * Math.sin(theta))) / (3 * a);
                if (t1 >= 0 && t1 <= 1) {
                    roots[n++] = t1;
                }
                if (t2 >= 0 && t2 <= 1) {
                    roots[n++] = t2;
                }
                if (t3 >= 0 && t3 <= 1) {
                    roots[n++] = t3;
                }
            }
        }
        return n;
    }


    /**
     * @function LevelRenderer.Tool.Curve.prototype.cubicRootAt
     * @description è®¡ç®ä¸æ¬¡è´å¡å°æ¹ç¨æéå¼çä½ç½®
     * @param {number} p0 - ç¹p0ã
     * @param {number} p1 - ç¹p1ã
     * @param {number} p2 - ç¹p2ã
     * @param {number} p3 - ç¹p3ã
     * @param {Array.<number>} extrema - å¼ã
     * @returns {number} æææ°ç®ã
     */
    cubicExtrema(p0, p1, p2, p3, extrema) {
        var b = 6 * p2 - 12 * p1 + 6 * p0;
        var a = 9 * p1 + 3 * p3 - 3 * p0 - 9 * p2;
        var c = 3 * p1 - 3 * p0;

        var n = 0;
        if (this.isAroundZero(a)) {
            if (this.isNotAroundZero(b)) {
                let t1 = -c / b;
                if (t1 >= 0 && t1 <= 1) {
                    extrema[n++] = t1;
                }
            }
        } else {
            var disc = b * b - 4 * a * c;
            if (this.isAroundZero(disc)) {
                extrema[0] = -b / (2 * a);
            } else if (disc > 0) {
                let discSqrt = Math.sqrt(disc);
                let t1 = (-b + discSqrt) / (2 * a);
                let t2 = (-b - discSqrt) / (2 * a);
                if (t1 >= 0 && t1 <= 1) {
                    extrema[n++] = t1;
                }
                if (t2 >= 0 && t2 <= 1) {
                    extrema[n++] = t2;
                }
            }
        }
        return n;
    }


    /**
     * @function LevelRenderer.Tool.Curve.prototype.cubicSubdivide
     * @description ç»åä¸æ¬¡è´å¡å°æ²çº¿
     * @param {number} p0 - ç¹p0ã
     * @param {number} p1 - ç¹p1ã
     * @param {number} p2 - ç¹p2ã
     * @param {number} p3 - ç¹p3ã
     * @param {number} t - tå¼ã
     * @param {Array.<number>} out - æå°ç¹ã
     * @returns {number} æå°ç¹ã
     */
    cubicSubdivide(p0, p1, p2, p3, t, out) {
        var p01 = (p1 - p0) * t + p0;
        var p12 = (p2 - p1) * t + p1;
        var p23 = (p3 - p2) * t + p2;

        var p012 = (p12 - p01) * t + p01;
        var p123 = (p23 - p12) * t + p12;

        var p0123 = (p123 - p012) * t + p012;
        // Seg0
        out[0] = p0;
        out[1] = p01;
        out[2] = p012;
        out[3] = p0123;
        // Seg1
        out[4] = p0123;
        out[5] = p123;
        out[6] = p23;
        out[7] = p3;
    }


    /**
     * @function LevelRenderer.Tool.Curve.prototype.cubicProjectPoint
     * @description æå°ç¹å°ä¸æ¬¡è´å¡å°æ²çº¿ä¸ï¼è¿åæå°è·ç¦»ãæå°ç¹æå¯è½ä¼æä¸ä¸ªæèå¤ä¸ªï¼è¿éåªè¿åå¶ä¸­è·ç¦»æç­çä¸ä¸ªã
     * @param {number} x0 - ç¹p0æ¨ªåæ ã
     * @param {number} y0 - ç¹p0çºµåæ ã
     * @param {number} x1 - ç¹p1æ¨ªåæ ã
     * @param {number} y1 - ç¹p1çºµåæ ã
     * @param {number} x2 - ç¹p2æ¨ªåæ ã
     * @param {number} y2 - ç¹p2çºµåæ ã
     * @param {number} x3 - ç¹p3æ¨ªåæ ã
     * @param {number} y3 - ç¹p3çºµåæ ã
     * @param {number} x - ç¹pæ¨ªåæ ã
     * @param {number} y - ç¹pçºµåæ ã
     * @param {Array.<number>} out - æå°ç¹ã
     * @returns {number} æå°ç¹ã
     */
    cubicProjectPoint(x0, y0, x1, y1, x2, y2, x3, y3, x, y, out) {
        // ä¸´æ¶åé
        var _v0 = this.vector.create();
        var _v1 = this.vector.create();
        var _v2 = this.vector.create();
        // var _v3 = vector.create();

        // http://pomax.github.io/bezierinfo/#projections
        var t;
        var interval = 0.005;
        var d = Infinity;

        _v0[0] = x;
        _v0[1] = y;

        // åç²ç¥ä¼°è®¡ä¸ä¸å¯è½çæå°è·ç¦»ç t å¼
        // PENDING
        for (let _t = 0; _t < 1; _t += 0.05) {
            _v1[0] = this.cubicAt(x0, x1, x2, x3, _t);
            _v1[1] = this.cubicAt(y0, y1, y2, y3, _t);
            let d1 = this.vector.distSquare(_v0, _v1);
            if (d1 < d) {
                t = _t;
                d = d1;
            }
        }
        d = Infinity;

        // At most 32 iteration
        for (let i = 0; i < 32; i++) {
            if (interval < this.EPSILON) {
                break;
            }
            let prev = t - interval;
            let next = t + interval;
            // t - interval
            _v1[0] = this.cubicAt(x0, x1, x2, x3, prev);
            _v1[1] = this.cubicAt(y0, y1, y2, y3, prev);

            let d1 = this.vector.distSquare(_v1, _v0);

            if (prev >= 0 && d1 < d) {
                t = prev;
                d = d1;
            } else {
                // t + interval
                _v2[0] = this.cubicAt(x0, x1, x2, x3, next);
                _v2[1] = this.cubicAt(y0, y1, y2, y3, next);
                let d2 = this.vector.distSquare(_v2, _v0);

                if (next <= 1 && d2 < d) {
                    t = next;
                    d = d2;
                } else {
                    interval *= 0.5;
                }
            }
        }
        // t
        if (out) {
            out[0] = this.cubicAt(x0, x1, x2, x3, t);
            out[1] = this.cubicAt(y0, y1, y2, y3, t);
        }
        // console.log(interval, i);
        return Math.sqrt(d);
    }


    /**
     * @function LevelRenderer.Tool.Curve.prototype.quadraticAt
     * @description è®¡ç®äºæ¬¡æ¹è´å¡å°å¼ã
     * @param {number} p0 - ç¹p0ã
     * @param {number} p1 - ç¹p1ã
     * @param {number} p2 - ç¹p2ã
     * @param {number} t - tå¼ã
     * @returns {number} äºæ¬¡æ¹è´å¡å°å¼ã
     */
    quadraticAt(p0, p1, p2, t) {
        var onet = 1 - t;
        return onet * (onet * p0 + 2 * t * p1) + t * t * p2;
    }


    /**
     * @function LevelRenderer.Tool.Curve.prototype.quadraticAt
     * @description è®¡ç®äºæ¬¡æ¹è´å¡å°å¯¼æ°å¼ã
     * @param {number} p0 - ç¹p0ã
     * @param {number} p1 - ç¹p1ã
     * @param {number} p2 - ç¹p2ã
     * @param {number} t - tå¼ã
     * @returns {number} äºæ¬¡æ¹è´å¡å°å¯¼æ°å¼ã
     */
    quadraticDerivativeAt(p0, p1, p2, t) {
        return 2 * ((1 - t) * (p1 - p0) + t * (p2 - p1));
    }


    /**
     * @function LevelRenderer.Tool.Curve.prototype.quadraticRootAt
     * @description è®¡ç®äºæ¬¡æ¹è´å¡å°æ¹ç¨æ ¹
     * @param {number} p0 - ç¹p0ã
     * @param {number} p1 - ç¹p1ã
     * @param {number} p2 - ç¹p2ã
     * @param {number} val - å¼ã
     * @param {Array.<number>} roots - æææ ¹æ°ç®ã
     * @returns {number} æææ ¹æ°ç®ã
     */
    quadraticRootAt(p0, p1, p2, val, roots) {
        var a = p0 - 2 * p1 + p2;
        var b = 2 * (p1 - p0);
        var c = p0 - val;

        var n = 0;
        if (this.isAroundZero(a)) {
            if (this.isNotAroundZero(b)) {
                var t1 = -c / b;
                if (t1 >= 0 && t1 <= 1) {
                    roots[n++] = t1;
                }
            }
        } else {
            var disc = b * b - 4 * a * c;
            if (this.isAroundZero(disc)) {
                let t1 = -b / (2 * a);
                if (t1 >= 0 && t1 <= 1) {
                    roots[n++] = t1;
                }
            } else if (disc > 0) {
                let discSqrt = Math.sqrt(disc);
                let t1 = (-b + discSqrt) / (2 * a);
                let t2 = (-b - discSqrt) / (2 * a);
                if (t1 >= 0 && t1 <= 1) {
                    roots[n++] = t1;
                }
                if (t2 >= 0 && t2 <= 1) {
                    roots[n++] = t2;
                }
            }
        }
        return n;
    }


    /**
     * @function LevelRenderer.Tool.Curve.prototype.quadraticExtremum
     * @description è®¡ç®äºæ¬¡è´å¡å°æ¹ç¨æéå¼
     * @param {number} p0 - ç¹p0ã
     * @param {number} p1 - ç¹p1ã
     * @param {number} p2 - ç¹p2ã
     * @returns {number} äºæ¬¡è´å¡å°æ¹ç¨æéå¼ã
     */
    quadraticExtremum(p0, p1, p2) {
        var divider = p0 + p2 - 2 * p1;
        if (divider === 0) {
            // p1 is center of p0 and p2
            return 0.5;
        } else {
            return (p0 - p1) / divider;
        }
    }


    /**
     * @function LevelRenderer.Tool.Curve.prototype.quadraticProjectPoint
     * @description æå°ç¹å°äºæ¬¡è´å¡å°æ²çº¿ä¸ï¼è¿åæå°è·ç¦»ãæå°ç¹æå¯è½ä¼æä¸ä¸ªæèå¤ä¸ªï¼è¿éåªè¿åå¶ä¸­è·ç¦»æç­çä¸ä¸ªã
     * @param {number} x0 - ç¹p0æ¨ªåæ ã
     * @param {number} y0 - ç¹p0çºµåæ ã
     * @param {number} x1 - ç¹p1æ¨ªåæ ã
     * @param {number} y1 - ç¹p1çºµåæ ã
     * @param {number} x2 - ç¹p2æ¨ªåæ ã
     * @param {number} y2 - ç¹p2çºµåæ ã
     * @param {number} x - ç¹pæ¨ªåæ ã
     * @param {number} y - ç¹pçºµåæ ã
     * @param {Array.<number>} out - æå°ç¹ã
     * @returns {number} æå°è·ç¦»ã
     */
    quadraticProjectPoint(x0, y0, x1, y1, x2, y2, x, y, out) {
        // ä¸´æ¶åé
        var _v0 = this.vector.create();
        var _v1 = this.vector.create();
        var _v2 = this.vector.create();

        // http://pomax.github.io/bezierinfo/#projections
        var t;
        var interval = 0.005;
        var d = Infinity;

        _v0[0] = x;
        _v0[1] = y;

        // åç²ç¥ä¼°è®¡ä¸ä¸å¯è½çæå°è·ç¦»ç t å¼
        // PENDING
        for (let _t = 0; _t < 1; _t += 0.05) {
            _v1[0] = this.quadraticAt(x0, x1, x2, _t);
            _v1[1] = this.quadraticAt(y0, y1, y2, _t);
            let d1 = this.vector.distSquare(_v0, _v1);
            if (d1 < d) {
                t = _t;
                d = d1;
            }
        }
        d = Infinity;

        // At most 32 iteration
        for (let i = 0; i < 32; i++) {
            if (interval < this.EPSILON) {
                break;
            }
            let prev = t - interval;
            let next = t + interval;
            // t - interval
            _v1[0] = this.quadraticAt(x0, x1, x2, prev);
            _v1[1] = this.quadraticAt(y0, y1, y2, prev);

            let d1 = this.vector.distSquare(_v1, _v0);

            if (prev >= 0 && d1 < d) {
                t = prev;
                d = d1;
            } else {
                // t + interval
                _v2[0] = this.quadraticAt(x0, x1, x2, next);
                _v2[1] = this.quadraticAt(y0, y1, y2, next);
                let d2 = this.vector.distSquare(_v2, _v0);
                if (next <= 1 && d2 < d) {
                    t = next;
                    d = d2;
                } else {
                    interval *= 0.5;
                }
            }
        }
        // t
        if (out) {
            out[0] = this.quadraticAt(x0, x1, x2, t);
            out[1] = this.quadraticAt(y0, y1, y2, t);
        }
        // console.log(interval, i);
        return Math.sqrt(d);
    }

}

;// CONCATENATED MODULE: ./src/common/overlay/levelRenderer/Area.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class  LevelRenderer.Tool.Area
 * @category Visualization Theme
 * @classdesc LevelRenderer å·¥å·-å¾å½¢èå´å¤æ­
 * @private
 */
class Area {
    constructor() {
        /**
         * @member {LevelRenderer.Tool.Util}  LevelRenderer.Tool.Areal.prototype.util
         * @description åºç¡å·¥å·å¯¹è±¡ã
         */
        this.util = new Util_Util();

        /**
         * @member {LevelRenderer.Tool.Curve}  LevelRenderer.Tool.Areal.prototype.curve
         * @description æ²çº¿å·¥å·å¯¹è±¡
         */
        this.curve = new Curve_Curve();

        /**
         * @member {Object} LevelRenderer.Tool.Areal.prototype._ctx
         * @description Cavans2D æ¸²æä¸ä¸æ
         */
        this._ctx = null;

        /**
         * @member {Object} LevelRenderer.Tool.Areal.prototype._textWidthCache
         * @description ææ¬å®½åº¦ç¼å­
         */
        this._textWidthCache = {};

        /**
         * @member {Object} LevelRenderer.Tool.Areal.prototype._textHeightCache
         * @description ææ¬é«åº¦ç¼å­
         */
        this._textHeightCache = {};

        /**
         * @member {number} LevelRenderer.Tool.Areal.prototype._textWidthCacheCounter
         * @description ææ¬å®½åº¦ç¼å­æ°é
         */
        this._textWidthCacheCounter = 0;

        /**
         * @member {number} LevelRenderer.Tool.Areal.prototype._textHeightCacheCounter
         * @description ææ¬é«åº¦ç¼å­æ°é
         */
        this._textHeightCacheCounter = 0;

        /**
         * @member {number} LevelRenderer.Tool.Areal.prototype.TEXT_CACHE_MAX
         * @description ææ¬æå¤§ç¼å­æ°é
         */
        this.TEXT_CACHE_MAX = 5000;

        /**
         * @member {number} LevelRenderer.Tool.Areal.prototype.PI2
         * @description 2*PI çå¼
         */
        this.PI2 = Math.PI * 2;

        /**
         * @member {Array.<number>} LevelRenderer.Tool.Areal.prototype.roots
         * @description ä¸´æ¶æ°ç»
         */
        this.roots = [-1, -1, -1];

        /**
         * @member {Array.<number>} LevelRenderer.Tool.Areal.prototype.extrema
         * @description ä¸´æ¶æ°ç»
         */
        this.extrema = [-1, -1];

        this.CLASS_NAME = "SuperMap.LevelRenderer.Tool.Area";
    }

    /**
     * @function LevelRenderer.Tool.Areal.prototype.normalizeRadian
     * @description å¼§åº¦æ ååå½æ°ã
     * @param {number} angle - å¼§åº¦å¼ã
     * @returns {number} æ åååçå¼§åº¦å¼ã
     */
    normalizeRadian(angle) {
        angle %= this.PI2;
        if (angle < 0) {
            angle += this.PI2;
        }
        return angle;
    }

    /**
     * @function LevelRenderer.Tool.Areal.prototype.isInside
     * @description åå«å¤æ­ã
     * @param {Object} shape - å¾å½¢ã
     * @param {number} area - ç®æ åºåã
     * @param {number} x - æ¨ªåæ ã
     * @param {number} y - çºµåæ ã
     * @returns {boolean} å¾å½¢æ¯å¦åå«é¼ æ ä½ç½®ã
     */
    isInside(shape, area, x, y) {
        if (!area || !shape) {
            // æ åæ°æä¸æ¯æç±»å
            return false;
        }
        var zoneType = shape.type;

        this._ctx = this._ctx || this.util.getContext();

        // æªå®ç°æä¸å¯ç¨æ¶åæ°å­¦è¿ç®ï¼ä¸»è¦æ¯lineï¼brokenLineï¼ring
        var _mathReturn = this._mathMethod(shape, area, x, y);
        if (typeof _mathReturn != 'undefined') {
            return _mathReturn;
        }

        if (shape.buildPath && this._ctx.isPointInPath) {
            return this._buildPathMethod(shape, this._ctx, area, x, y);
        }

        // ä¸é¢çæ¹æ³é½è¡ä¸éæ¶
        switch (zoneType) {
            case 'ellipse': // Todoï¼ä¸ç²¾ç¡®
            case 'smicellipse': // Todoï¼ä¸ç²¾ç¡®
                return true;
            // æè½®æ²çº¿  ä¸åç¡®
            case 'trochoid':
                var _r = area.location == 'out'
                    ? area.r1 + area.r2 + area.d
                    : area.r1 - area.r2 + area.d;
                return this.isInsideCircle(area, x, y, _r);
            // ç«ç°çº¿ ä¸åç¡®
            case 'rose' :
                return this.isInsideCircle(area, x, y, area.maxr);
            // è·¯å¾ï¼æ¤­åï¼æ²çº¿ç­-----------------13
            default:
                return false;   // Todoï¼æä¸æ¯æ
        }
    }

    /**
     * @function LevelRenderer.Tool.Areal.prototype._mathMethod
     * @description åå«å¤æ­ãç¨æ°å­¦æ¹æ³å¤æ­ï¼ä¸ä¸ªæ¹æ³ä¸­æå¿«ï¼ä½æ¯æ¯æçshapeå°ã
     * @param {Object} shape - å¾å½¢ã
     * @param {number} area - ç®æ åºåã
     * @param {number} x - æ¨ªåæ ã
     * @param {number} y - çºµåæ ã
     * @returns {boolean} å¾å½¢æ¯å¦åå«é¼ æ ä½ç½®ï¼trueè¡¨ç¤ºåæ å¤å¨å¾å½¢ä¸­ã
     */
    _mathMethod(shape, area, x, y) {
        var zoneType = shape.type;
        // å¨ç©å½¢ååé¨åå¾å½¢éè¦è¿ä¸æ­¥å¤æ­
        switch (zoneType) {
            // è´å¡å°æ²çº¿
            case 'bezier-curve':
                if (typeof(area.cpX2) === 'undefined') {
                    return this.isInsideQuadraticStroke(
                        area.xStart, area.yStart,
                        area.cpX1, area.cpY1,
                        area.xEnd, area.yEnd,
                        area.lineWidth, x, y
                    );
                }
                return this.isInsideCubicStroke(
                    area.xStart, area.yStart,
                    area.cpX1, area.cpY1,
                    area.cpX2, area.cpY2,
                    area.xEnd, area.yEnd,
                    area.lineWidth, x, y
                );
            // çº¿
            case 'line':
                return this.isInsideLine(
                    area.xStart, area.yStart,
                    area.xEnd, area.yEnd,
                    area.lineWidth, x, y
                );
            // æçº¿
            case 'broken-line':
                return this.isInsideBrokenLine(
                    area.pointList, area.lineWidth, x, y
                );
            // æ©å±æçº¿
            case 'smicbroken-line': {
                // SMIC-ä¿®æ¹ - start
                let icX = x;
                let icY = y;
                if (shape.refOriginalPosition) {
                    icX = x - shape.refOriginalPosition[0];
                    icY = y - shape.refOriginalPosition[1];
                }
                return this.isInsideBrokenLine(
                    area.pointList, area.lineWidth, icX, icY
                );
            }
            //åå§ä»£ç ï¼
            //      return isInsideBrokenLine(
            //          area.pointList, area.lineWidth, x, y
            //      );
            // SMIC-ä¿®æ¹ - end
            // åç¯
            case 'ring':
                return this.isInsideRing(
                    area.x, area.y, area.r0, area.r, x, y
                );
            case 'smicring': {
                let areaX = area.x;
                let areaY = area.y;
                if (shape.refOriginalPosition) {
                    areaX = area.x + shape.refOriginalPosition[0];
                    areaY = area.y + shape.refOriginalPosition[1];
                }
                return this.isInsideRing(
                    areaX, areaY, area.r0, area.r, x, y
                );
            }
            // åå½¢
            case 'circle':
                return this.isInsideCircle(
                    area.x, area.y, area.r, x, y
                );
            // æ©å±-ç¹
            case 'smicpoint': {
                // SMIC-ä¿®æ¹ - start
                let icX = x;
                let icY = y;
                if (shape.refOriginalPosition) {
                    icX = x - shape.refOriginalPosition[0];
                    icY = y - shape.refOriginalPosition[1];
                }
                return this.isInsideCircle(
                    area.x, area.y, area.r, icX, icY
                );
            }
            //åå§ä»£ç ï¼
            //  æ 
            // SMIC-ä¿®æ¹ - end
            // æå½¢
            case 'sector': {
                let startAngle = area.startAngle * Math.PI / 180;
                let endAngle = area.endAngle * Math.PI / 180;
                if (!area.clockWise) {
                    startAngle = -startAngle;
                    endAngle = -endAngle;
                }
                return this.isInsideSector(
                    area.x, area.y, area.r0, area.r,
                    startAngle, endAngle,
                    !area.clockWise,
                    x, y
                );
            }
            //åå§ä»£ç ï¼
            //  æ 
            // SMIC-å¢å  - end
            // æå½¢
            case 'smicsector': {
                let startAngle = area.startAngle * Math.PI / 180;
                let endAngle = area.endAngle * Math.PI / 180;
                if (!area.clockWise) {
                    startAngle = -startAngle;
                    endAngle = -endAngle;
                }

                let areaX = area.x;
                let areaY = area.y;
                if (shape.refOriginalPosition) {
                    areaX = area.x + shape.refOriginalPosition[0];
                    areaY = area.y + shape.refOriginalPosition[1];
                }

                return this.isInsideSector(
                    areaX, areaY, area.r0, area.r,
                    startAngle, endAngle,
                    !area.clockWise,
                    x, y
                );
            }
            // å¤è¾¹å½¢
            case 'path':
                return this.isInsidePath(
                    area.pathArray, Math.max(area.lineWidth, 5),
                    area.brushType, x, y
                );
            case 'polygon':
            case 'star':
            case 'smicstar':
            case 'isogon':
            case 'smicisogon':
                return this.isInsidePolygon(area.pointList, x, y);
            // æ©å±å¤è¾¹å½¢
            case 'smicpolygon': {
                // SMIC-ä¿®æ¹ - start
                let icX = x;
                let icY = y;
                if (shape.refOriginalPosition) {
                    icX = x - shape.refOriginalPosition[0];
                    icY = y - shape.refOriginalPosition[1];
                }

                //å²æ´é¢
                if (shape.holePolygonPointLists && shape.holePolygonPointLists.length > 0) {
                    var isOnBase = this.isInsidePolygon(area.pointList, icX, icY);

                    // éåå²æ´å­é¢
                    var holePLS = shape.holePolygonPointLists;
                    var isOnHole = false;
                    for (var i = 0, holePLSen = holePLS.length; i < holePLSen; i++) {
                        var holePL = holePLS[i];
                        var isOnSubHole = this.isInsidePolygon(holePL, icX, icY);
                        if (isOnSubHole === true) {
                            isOnHole = true;
                        }
                    }

                    // æè·å¤æ­
                   return isOnBase === true && isOnHole === false;
                } else {
                    return this.isInsidePolygon(area.pointList, icX, icY);
                }
            }
            // åå§ä»£ç ï¼
            //  æ 
            // SMIC-ä¿®æ¹ - end
            // ææ¬
            case 'text':
                var rect = area.__rect || shape.getRect(area);
                return this.isInsideRect(
                    rect.x, rect.y, rect.width, rect.height, x, y
                );
            // æ©å±ææ¬
            case 'smictext':
                //ç¨ææ¬èæ¯ç©å½¢å¤æ­
                var textBg = shape.getTextBackground(area);
                return this.isInsidePolygon(textBg, x, y);
            //åå§ä»£ç ï¼
            //  æ 
            // SMIC-ä¿®æ¹ - end
            // ç©å½¢
            case 'rectangle':
            case 'image':
                // å¾ç
                return this.isInsideRect(
                    area.x, area.y, area.width, area.height, x, y
                );
            case 'smicimage': {
                let areaX = area.x;
                let areaY = area.y;
                if (shape.refOriginalPosition) {
                    areaX = area.x + shape.refOriginalPosition[0];
                    areaY = area.y + shape.refOriginalPosition[1];
                }
                return this.isInsideRect(
                    areaX, areaY, area.width, area.height, x, y
                );
            }
            //// æ©å±ç©å½¢
            //case 'smicpolygon':
            //    // SMIC-ä¿®æ¹ - start
            //    var icX = x;
            //    var icY = y;
            //    if(shape.refOriginalPosition) {
            //        icX = x - shape.refOriginalPosition[0];
            //        icY = y - shape.refOriginalPosition[1];
            //    }
            //    return this.isInsideRect(
            //        area.x, area.y, area.width, area.height, icX, icY
            //    );
            //åå§ä»£ç ï¼
            //  æ 
            // SMIC-ä¿®æ¹ - end
        }
    }

    /**
     * @function LevelRenderer.Tool.Areal.prototype._buildPathMethod
     * @description åå«å¤æ­ãéè¿buildPathæ¹æ³æ¥å¤æ­ï¼ä¸ä¸ªæ¹æ³ä¸­è¾å¿«ï¼ä½æ¯ä¸æ¯æçº¿æ¡ç±»åç shapeã
     * @param {Object} shape - å¾å½¢ã
     * @param {Object} context - ä¸ä¸æã
     * @param {number} area - ç®æ åºåã
     * @param {number} x - æ¨ªåæ ã
     * @param {number} y - çºµåæ ã
     * @returns {boolean} å¾å½¢æ¯å¦åå«é¼ æ ä½ç½®ï¼trueè¡¨ç¤ºåæ å¤å¨å¾å½¢ä¸­ã
     */
    _buildPathMethod(shape, context, area, x, y) {
        // å¾å½¢ç±»å®ç°è·¯å¾åå»ºäºåç¨ç±»çpath
        context.beginPath();
        shape.buildPath(context, area);
        context.closePath();
        return context.isPointInPath(x, y);
    }

    /**
     * @function LevelRenderer.Tool.Areal.prototype.isOutside
     * @description å¾å½¢æ¯å¦ä¸åå«é¼ æ ä½ç½®ã
     * @param {Object} shape - å¾å½¢ã
     * @param {number} area - ç®æ åºåã
     * @param {number} x - æ¨ªåæ ã
     * @param {number} y - çºµåæ ã
     * @returns {boolean} å¾å½¢æ¯å¦ä¸åå«é¼ æ ä½ç½®, trueè¡¨ç¤ºåæ å¤å¨å¾å½¢å¤ã
     */
    isOutside(shape, area, x, y) {
        return !this.isInside(shape, area, x, y);
    }

    /**
     * @function LevelRenderer.Tool.Areal.prototype.isInsideLine
     * @description çº¿æ®µåå«å¤æ­ã
     * @param {number} x0 - çº¿èµ·å§ç¹æ¨ªåæ ã
     * @param {number} y0 - çº¿èµ·å§ç¹çºµåæ ã
     * @param {number} x1 - çº¿ç»ç¹æ¨ªåæ ã
     * @param {number} y1 - çº¿ç»ç¹çºµåæ ã
     * @param {number} lineWidth - çº¿å®½ã
     * @param {number} x - é¼ æ ä½ç½®æ¨ªåæ ã
     * @param {number} y - é¼ æ ä½ç½®çºµåæ ã
     * @returns {boolean} å¾å½¢æ¯å¦åå«é¼ æ ä½ç½®ï¼trueè¡¨ç¤ºåæ å¤å¨å¾å½¢åã
     */
    isInsideLine(x0, y0, x1, y1, lineWidth, x, y) {
        if (lineWidth === 0) {
            return false;
        }
        var _l = Math.max(lineWidth, 5);
        var _a = 0;
        var _b = 0;
        // Quick reject
        if (
            (y > y0 + _l && y > y1 + _l)
            || (y < y0 - _l && y < y1 - _l)
            || (x > x0 + _l && x > x1 + _l)
            || (x < x0 - _l && x < x1 - _l)
        ) {
            return false;
        }

        if (x0 !== x1) {
            _a = (y0 - y1) / (x0 - x1);
            _b = (x0 * y1 - x1 * y0) / (x0 - x1);
        } else {
            return Math.abs(x - x0) <= _l / 2;
        }
        var tmp = _a * x - y + _b;
        var _s = tmp * tmp / (_a * _a + 1);
        return _s <= _l / 2 * _l / 2;
    }

    /**
     * @function LevelRenderer.Tool.Areal.prototype.isInsideCubicStroke
     * @description ä¸æ¬¡è´å¡å°æ²çº¿æè¾¹åå«å¤æ­ã
     * @param {number} x0 - ç¹1æ¨ªåæ ã
     * @param {number} y0 - ç¹1çºµåæ ã
     * @param {number} x1 - ç¹2æ¨ªåæ ã
     * @param {number} y1 - ç¹2çºµåæ ã
     * @param {number} x2 - ç¹3çºµåæ ã
     * @param {number} y2 - ç¹3çºµåæ ã
     * @param {number} lineWidth - çº¿å®½ã
     * @param {number} x - é¼ æ ä½ç½®æ¨ªåæ ã
     * @param {number} y - é¼ æ ä½ç½®çºµåæ ã
     * @returns {boolean} å¾å½¢æ¯å¦åå«é¼ æ ä½ç½®, trueè¡¨ç¤ºåæ å¤å¨å¾å½¢åã
     */
    isInsideCubicStroke(x0, y0, x1, y1, x2, y2, x3, y3, lineWidth, x, y) {
        if (lineWidth === 0) {
            return false;
        }
        var _l = Math.max(lineWidth, 5);
        // Quick reject
        if (
            (y > y0 + _l && y > y1 + _l && y > y2 + _l && y > y3 + _l)
            || (y < y0 - _l && y < y1 - _l && y < y2 - _l && y < y3 - _l)
            || (x > x0 + _l && x > x1 + _l && x > x2 + _l && x > x3 + _l)
            || (x < x0 - _l && x < x1 - _l && x < x2 - _l && x < x3 - _l)
        ) {
            return false;
        }
        var d = this.curve.cubicProjectPoint(
            x0, y0, x1, y1, x2, y2, x3, y3,
            x, y, null
        );
        return d <= _l / 2;
    }

    /**
     * @function LevelRenderer.Tool.Areal.prototype.isInsideQuadraticStroke
     * @description äºæ¬¡è´å¡å°æ²çº¿æè¾¹åå«å¤æ­ã
     * @param {number} x0 - ç¹1æ¨ªåæ ã
     * @param {number} y0 - ç¹1çºµåæ ã
     * @param {number} x1 - ç¹2æ¨ªåæ ã
     * @param {number} y1 - ç¹2çºµåæ ã
     * @param {number} x2 - ç¹3çºµåæ ã
     * @param {number} y2 - ç¹3çºµåæ ã
     * @param {number} lineWidth - çº¿å®½ã
     * @param {number} x - é¼ æ ä½ç½®æ¨ªåæ ã
     * @param {number} y - é¼ æ ä½ç½®çºµåæ ã
     * @returns {boolean} å¾å½¢æ¯å¦åå«é¼ æ ä½ç½®, trueè¡¨ç¤ºåæ å¤å¨å¾å½¢åã
     */
    isInsideQuadraticStroke(x0, y0, x1, y1, x2, y2, lineWidth, x, y) {
        if (lineWidth === 0) {
            return false;
        }
        var _l = Math.max(lineWidth, 5);
        // Quick reject
        if (
            (y > y0 + _l && y > y1 + _l && y > y2 + _l)
            || (y < y0 - _l && y < y1 - _l && y < y2 - _l)
            || (x > x0 + _l && x > x1 + _l && x > x2 + _l)
            || (x < x0 - _l && x < x1 - _l && x < x2 - _l)
        ) {
            return false;
        }
        var d = this.curve.quadraticProjectPoint(
            x0, y0, x1, y1, x2, y2,
            x, y, null
        );
        return d <= _l / 2;
    }

    /**
     * @function LevelRenderer.Tool.Areal.prototype.isInsideArcStroke
     * @description åå¼§æè¾¹åå«å¤æ­ã
     * @param {number} cx - åå¿æ¨ªåæ ã
     * @param {number} cy - åå¿çºµåæ ã
     * @param {number} r - ååå¾ã
     * @param {number} startAngle - èµ·å§è§åº¦ã
     * @param {number} endAngle - ç»æ­¢è§åº¦ã
     * @param {number} anticlockwise - é¡ºæ¶éè¿æ¯éæ¶éã
     * @param {number} lineWidth - çº¿å®½ã
     * @param {number} x - é¼ æ ä½ç½®æ¨ªåæ ã
     * @param {number} y - é¼ æ ä½ç½®çºµåæ ã
     * @returns {boolean} å¾å½¢æ¯å¦åå«é¼ æ ä½ç½®, trueè¡¨ç¤ºåæ å¤å¨å¾å½¢åã
     */
    isInsideArcStroke(cx, cy, r, startAngle, endAngle, anticlockwise, lineWidth, x, y) {
        var PI2 = this.PI2;

        if (lineWidth === 0) {
            return false;
        }
        var _l = Math.max(lineWidth, 5);

        x -= cx;
        y -= cy;
        var d = Math.sqrt(x * x + y * y);
        if ((d - _l > r) || (d + _l < r)) {
            return false;
        }
        if (Math.abs(startAngle - endAngle) >= PI2) {
            // Is a circle
            return true;
        }
        if (anticlockwise) {
            var tmp = startAngle;
            startAngle = this.normalizeRadian(endAngle);
            endAngle = this.normalizeRadian(tmp);
        } else {
            startAngle = this.normalizeRadian(startAngle);
            endAngle = this.normalizeRadian(endAngle);
        }
        if (startAngle > endAngle) {
            endAngle += PI2;
        }

        var angle = Math.atan2(y, x);
        if (angle < 0) {
            angle += PI2;
        }
        return (angle >= startAngle && angle <= endAngle)
            || (angle + PI2 >= startAngle && angle + PI2 <= endAngle);
    }

    /**
     * @function LevelRenderer.Tool.Areal.prototype.isInsideBrokenLine
     * @description å¾å½¢ BrokenLine æ¯å¦åå«é¼ æ ä½ç½®, trueè¡¨ç¤ºåæ å¤å¨å¾å½¢åã
     * @param {Array} points - æ²çº¿ç¹å¯¹è±¡ã
     * @param {number} lineWidth - çº¿å®½ã
     * @param {number} x - é¼ æ ä½ç½®æ¨ªåæ ã
     * @param {number} y - é¼ æ ä½ç½®çºµåæ ã
     * @returns {boolean} å¾å½¢æ¯å¦åå«é¼ æ ä½ç½®, trueè¡¨ç¤ºåæ å¤å¨å¾å½¢åã
     */
    isInsideBrokenLine(points, lineWidth, x, y) {
        var _lineWidth = Math.max(lineWidth, 10);
        for (var i = 0, l = points.length - 1; i < l; i++) {
            var x0 = points[i][0];
            var y0 = points[i][1];
            var x1 = points[i + 1][0];
            var y1 = points[i + 1][1];

            if (this.isInsideLine(x0, y0, x1, y1, _lineWidth, x, y)) {
                return true;
            }
        }

        return false;
    }

    /**
     * @function LevelRenderer.Tool.Areal.prototype.isInsideRing
     * @description  å¾å½¢ Ring æ¯å¦åå«é¼ æ ä½ç½®, trueè¡¨ç¤ºåæ å¤å¨å¾å½¢åã
     * @returns {boolean} å¾å½¢æ¯å¦åå«é¼ æ ä½ç½®, trueè¡¨ç¤ºåæ å¤å¨å¾å½¢åã
     */
    isInsideRing(cx, cy, r0, r, x, y) {
        var d = (x - cx) * (x - cx) + (y - cy) * (y - cy);
        return (d < r * r) && (d > r0 * r0);
    }

    /**
     * @function LevelRenderer.Tool.Areal.prototype.isInsideRect
     * @description å¾å½¢ Rect æ¯å¦åå«é¼ æ ä½ç½®, trueè¡¨ç¤ºåæ å¤å¨å¾å½¢åã
     * @returns {boolean} å¾å½¢æ¯å¦åå«é¼ æ ä½ç½®, trueè¡¨ç¤ºåæ å¤å¨å¾å½¢åã
     */
    isInsideRect(x0, y0, width, height, x, y) {
        return x >= x0 && x <= (x0 + width) && y >= y0 && y <= (y0 + height);
    }

    /**
     * @function LevelRenderer.Tool.Areal.prototype.isInsideCircle
     * @description å¾å½¢ Circle æ¯å¦åå«é¼ æ ä½ç½®, trueè¡¨ç¤ºåæ å¤å¨å¾å½¢åã
     * @returns {boolean} å¾å½¢æ¯å¦åå«é¼ æ ä½ç½®, trueè¡¨ç¤ºåæ å¤å¨å¾å½¢åã
     */
    isInsideCircle(x0, y0, r, x, y) {
        return (x - x0) * (x - x0) + (y - y0) * (y - y0) < r * r;
    }

    /**
     * @function LevelRenderer.Tool.Areal.prototype.isInsideSector
     * @description å¾å½¢ Sector æ¯å¦åå«é¼ æ ä½ç½®, trueè¡¨ç¤ºåæ å¤å¨å¾å½¢åã
     * @returns {boolean} å¾å½¢æ¯å¦åå«é¼ æ ä½ç½®, trueè¡¨ç¤ºåæ å¤å¨å¾å½¢åã
     */
    isInsideSector(cx, cy, r0, r, startAngle, endAngle, anticlockwise, x, y) {
        return this.isInsideArcStroke(cx, cy, (r0 + r) / 2, startAngle, endAngle, anticlockwise, r - r0, x, y);
    }

    /**
     * @function LevelRenderer.Tool.Areal.prototype.isInsidePolygon
     * @description å¾å½¢ Polygon æ¯å¦åå«é¼ æ ä½ç½®, trueè¡¨ç¤ºåæ å¤å¨å¾å½¢åãä¸ canvas ä¸æ ·éç¨ non-zero winding rule
     * @returns {boolean} å¾å½¢æ¯å¦åå«é¼ æ ä½ç½®, trueè¡¨ç¤ºåæ å¤å¨å¾å½¢åã
     */
    isInsidePolygon(points, x, y) {
        var N = points.length;
        var w = 0;

        for (var i = 0, j = N - 1; i < N; i++) {
            var x0 = points[j][0];
            var y0 = points[j][1];
            var x1 = points[i][0];
            var y1 = points[i][1];
            w += this.windingLine(x0, y0, x1, y1, x, y);
            j = i;
        }
        return w !== 0;
    }


    /**
     * @function LevelRenderer.Tool.Areal.prototype.windingLine
     */
    windingLine(x0, y0, x1, y1, x, y) {
        if ((y > y0 && y > y1) || (y < y0 && y < y1)) {
            return 0;
        }
        if (y1 == y0) {
            return 0;
        }
        var dir = y1 < y0 ? 1 : -1;
        var t = (y - y0) / (y1 - y0);
        var x_ = t * (x1 - x0) + x0;

        return x_ > x ? dir : 0;
    }

    /**
     * @function LevelRenderer.Tool.Areal.prototype.swapExtrema
     */
    swapExtrema() {
        var tmp = this.extrema[0];
        this.extrema[0] = this.extrema[1];
        this.extrema[1] = tmp;
    }

    /**
     * @function LevelRenderer.Tool.Areal.prototype.windingCubic
     */
    windingCubic(x0, y0, x1, y1, x2, y2, x3, y3, x, y) {
        var curve = this.curve;
        var roots = this.roots;
        var extrema = this.extrema;

        // Quick reject
        if (
            (y > y0 && y > y1 && y > y2 && y > y3)
            || (y < y0 && y < y1 && y < y2 && y < y3)
        ) {
            return 0;
        }
        var nRoots = curve.cubicRootAt(y0, y1, y2, y3, y, roots);
        if (nRoots === 0) {
            return 0;
        } else {
            var w = 0;
            var nExtrema = -1;
            var y0_, y1_;
            for (var i = 0; i < nRoots; i++) {
                var t = roots[i];
                var x_ = curve.cubicAt(x0, x1, x2, x3, t);
                if (x_ < x) { // Quick reject
                    continue;
                }
                if (nExtrema < 0) {
                    nExtrema = curve.cubicExtrema(y0, y1, y2, y3, extrema);
                    if (extrema[1] < extrema[0] && nExtrema > 1) {
                        this.swapExtrema();
                    }
                    y0_ = curve.cubicAt(y0, y1, y2, y3, extrema[0]);
                    if (nExtrema > 1) {
                        y1_ = curve.cubicAt(y0, y1, y2, y3, extrema[1]);
                    }
                }
                if (nExtrema == 2) {
                    // åæä¸æ®µåè°å½æ°
                    if (t < extrema[0]) {
                        w += y0_ < y0 ? 1 : -1;
                    } else if (t < extrema[1]) {
                        w += y1_ < y0_ ? 1 : -1;
                    } else {
                        w += y3 < y1_ ? 1 : -1;
                    }
                } else {
                    // åæä¸¤æ®µåè°å½æ°
                    if (t < extrema[0]) {
                        w += y0_ < y0 ? 1 : -1;
                    } else {
                        w += y3 < y0_ ? 1 : -1;
                    }
                }
            }
            return w;
        }
    }

    /**
     * @function LevelRenderer.Tool.Areal.prototype.windingQuadratic
     */
    windingQuadratic(x0, y0, x1, y1, x2, y2, x, y) {
        var curve = this.curve;
        var roots = this.roots;

        // Quick reject
        if (
            (y > y0 && y > y1 && y > y2)
            || (y < y0 && y < y1 && y < y2)
        ) {
            return 0;
        }
        var nRoots = curve.quadraticRootAt(y0, y1, y2, y, roots);
        if (nRoots === 0) {
            return 0;
        } else {
            var t = curve.quadraticExtremum(y0, y1, y2);
            if (t >= 0 && t <= 1) {
                var w = 0;
                var y_ = curve.quadraticAt(y0, y1, y2, t);
                for (let i = 0; i < nRoots; i++) {
                    let x_ = curve.quadraticAt(x0, x1, x2, roots[i]);
                    if (x_ > x) {
                        continue;
                    }
                    if (roots[i] < t) {
                        w += y_ < y0 ? 1 : -1;
                    } else {
                        w += y2 < y_ ? 1 : -1;
                    }
                }
                return w;
            } else {
                let x_ = curve.quadraticAt(x0, x1, x2, roots[0]);
                if (x_ > x) {
                    return 0;
                }
                return y2 < y0 ? 1 : -1;
            }
        }
    }

    /**
     * @function LevelRenderer.Tool.Areal.prototype.windingArc
     * // TODO   Arc æè½¬
     */
    windingArc(cx, cy, r, startAngle, endAngle, anticlockwise, x, y) {
        var roots = this.roots;
        var PI2 = this.PI2;

        y -= cy;
        if (y > r || y < -r) {
            return 0;
        }
        let tmp = Math.sqrt(r * r - y * y);
        roots[0] = -tmp;
        roots[1] = tmp;

        if (Math.abs(startAngle - endAngle) >= PI2) {
            // Is a circle
            startAngle = 0;
            endAngle = PI2;
            var dir = anticlockwise ? 1 : -1;
            if (x >= roots[0] + cx && x <= roots[1] + cx) {
                return dir;
            } else {
                return 0;
            }
        }

        if (anticlockwise) {
            let tmp = startAngle;
            startAngle = this.normalizeRadian(endAngle);
            endAngle = this.normalizeRadian(tmp);
        } else {
            startAngle = this.normalizeRadian(startAngle);
            endAngle = this.normalizeRadian(endAngle);
        }
        if (startAngle > endAngle) {
            endAngle += PI2;
        }

        var w = 0;
        for (let i = 0; i < 2; i++) {
            var x_ = roots[i];
            if (x_ + cx > x) {
                let angle = Math.atan2(y, x_);
                let dir = anticlockwise ? 1 : -1;
                if (angle < 0) {
                    angle = PI2 + angle;
                }
                if (
                    (angle >= startAngle && angle <= endAngle)
                    || (angle + PI2 >= startAngle && angle + PI2 <= endAngle)
                ) {
                    if (angle > Math.PI / 2 && angle < Math.PI * 1.5) {
                        dir = -dir;
                    }
                    w += dir;
                }
            }
        }
        return w;
    }


    /**
     * @function LevelRenderer.Tool.Areal.prototype.isInsidePath
     * @description ä¸ canvas ä¸æ ·éç¨ non-zero winding rule
     */
    isInsidePath(pathArray, lineWidth, brushType, x, y) {
        var w = 0;
        var xi = 0;
        var yi = 0;
        var x0 = 0;
        var y0 = 0;
        var beginSubpath = true;
        var firstCmd = true;

        brushType = brushType || 'fill';

        var hasStroke = brushType === 'stroke' || brushType === 'both';
        var hasFill = brushType === 'fill' || brushType === 'both';

        // var roots = [-1, -1, -1];
        for (var i = 0; i < pathArray.length; i++) {
            var seg = pathArray[i];
            var p = seg.points;
            // Begin a new subpath
            if (beginSubpath || seg.command === 'M') {
                if (i > 0) {
                    // Close previous subpath
                    if (hasFill) {
                        w += this.windingLine(xi, yi, x0, y0, x, y);
                    }
                    if (w !== 0) {
                        return true;
                    }
                }
                x0 = p[p.length - 2];
                y0 = p[p.length - 1];
                beginSubpath = false;
                if (firstCmd && seg.command !== 'A') {
                    // å¦æç¬¬ä¸ä¸ªå½ä»¤ä¸æ¯M, æ¯lineTo, bezierCurveTo
                    // ç­ç»å¶å½ä»¤çè¯ï¼æ¯ä¼ä»è¯¥ç»å¶çèµ·ç¹å¼å§ç®ç
                    // Arc ä¼å¨ä¹åååç¬å¤çæä»¥è¿éå¿½ç¥
                    firstCmd = false;
                    xi = x0;
                    yi = y0;
                }
            }
            switch (seg.command) {
                case 'M':
                    xi = p[0];
                    yi = p[1];
                    break;
                case 'L':
                    if (hasStroke) {
                        if (this.isInsideLine(
                                xi, yi, p[0], p[1], lineWidth, x, y
                            )) {
                            return true;
                        }
                    }
                    if (hasFill) {
                        w += this.windingLine(xi, yi, p[0], p[1], x, y);
                    }
                    xi = p[0];
                    yi = p[1];
                    break;
                case 'C':
                    if (hasStroke) {
                        if (this.isInsideCubicStroke(
                                xi, yi, p[0], p[1], p[2], p[3], p[4], p[5],
                                lineWidth, x, y
                            )) {
                            return true;
                        }
                    }
                    if (hasFill) {
                        w += this.windingCubic(
                            xi, yi, p[0], p[1], p[2], p[3], p[4], p[5], x, y
                        );
                    }
                    xi = p[4];
                    yi = p[5];
                    break;
                case 'Q':
                    if (hasStroke) {
                        if (this.isInsideQuadraticStroke(
                                xi, yi, p[0], p[1], p[2], p[3],
                                lineWidth, x, y
                            )) {
                            return true;
                        }
                    }
                    if (hasFill) {
                        w += this.windingQuadratic(
                            xi, yi, p[0], p[1], p[2], p[3], x, y
                        );
                    }
                    xi = p[2];
                    yi = p[3];
                    break;
                case 'A':
                    // TODO Arc æè½¬
                    // TODO Arc å¤æ­çå¼éæ¯è¾å¤§
                    var cx = p[0];
                    var cy = p[1];
                    var rx = p[2];
                    var ry = p[3];
                    var theta = p[4];
                    var dTheta = p[5];
                    var x1 = Math.cos(theta) * rx + cx;
                    var y1 = Math.sin(theta) * ry + cy;
                    // ä¸æ¯ç´æ¥ä½¿ç¨ arc å½ä»¤
                    if (!firstCmd) {
                        w += this.windingLine(xi, yi, x1, y1);
                    } else {
                        firstCmd = false;
                        // ç¬¬ä¸ä¸ªå½ä»¤èµ·ç¹è¿æªå®ä¹
                        x0 = x1;
                        y0 = y1;
                    }
                    // zr ä½¿ç¨scaleæ¥æ¨¡ææ¤­å, è¿éä¹å¯¹xåä¸å®çç¼©æ¾
                    var _x = (x - cx) * ry / rx + cx;
                    if (hasStroke) {
                        if (this.isInsideArcStroke(
                                cx, cy, ry, theta, theta + dTheta, 1 - p[7],
                                lineWidth, _x, y
                            )) {
                            return true;
                        }
                    }
                    if (hasFill) {
                        w += this.windingArc(
                            cx, cy, ry, theta, theta + dTheta, 1 - p[7],
                            _x, y
                        );
                    }
                    xi = Math.cos(theta + dTheta) * rx + cx;
                    yi = Math.sin(theta + dTheta) * ry + cy;
                    break;
                case 'z':
                    if (hasStroke) {
                        if (this.isInsideLine(
                                xi, yi, x0, y0, lineWidth, x, y
                            )) {
                            return true;
                        }
                    }
                    beginSubpath = true;
                    break;
            }
        }
        if (hasFill) {
            w += this.windingLine(xi, yi, x0, y0, x, y);
        }
        return w !== 0;
    }

    /**
     * @function LevelRenderer.Tool.Areal.prototype.getTextWidth
     * @description æµç®å¤è¡ææ¬å®½åº¦
     */
    getTextWidth(text, textFont) {
        var key = text + ':' + textFont;
        if (this._textWidthCache[key]) {
            return this._textWidthCache[key];
        }
        this._ctx = this._ctx || this.util.getContext();
        this._ctx.save();

        if (textFont) {
            this._ctx.font = textFont;
        }

        text = (text + '').split('\n');
        var width = 0;
        for (var i = 0, l = text.length; i < l; i++) {
            width = Math.max(
                this._ctx.measureText(text[i]).width,
                width
            );
        }
        this._ctx.restore();

        this._textWidthCache[key] = width;
        if (++this._textWidthCacheCounter > this.TEXT_CACHE_MAX) {
            // åå­éæ¾
            this._textWidthCacheCounter = 0;
            this._textWidthCache = {};
        }

        return width;
    }

    /**
     * @function LevelRenderer.Tool.Areal.prototype.getTextHeight
     * @description æµç®å¤è¡ææ¬é«åº¦
     */
    getTextHeight(text, textFont) {
        var key = text + ':' + textFont;
        if (this._textHeightCache[key]) {
            return this._textHeightCache[key];
        }

        this._ctx = this._ctx || this.util.getContext();

        this._ctx.save();
        if (textFont) {
            this._ctx.font = textFont;
        }

        text = (text + '').split('\n');
        // æ¯è¾ç²æ´
        //var height = (this._ctx.measureText('å½').width + 2) * text.length;  //æåä¸æ¯æä¸­æï¼æ¿æ¢æ
        var height = (this._ctx.measureText('ZH').width + 2) * text.length;

        this._ctx.restore();

        this._textHeightCache[key] = height;
        if (++this._textHeightCacheCounter > this.TEXT_CACHE_MAX) {
            // åå­éæ¾
            this._textHeightCacheCounter = 0;
            this._textHeightCache = {};
        }
        return height;
    }
}

;// CONCATENATED MODULE: ./src/common/overlay/levelRenderer/ComputeBoundingBox.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class  LevelRenderer.Tool.ComputeBoundingBox
 * @category Visualization Theme
 * @classdesc LevelRenderer å·¥å·-å¾å½¢ Bounds è®¡ç®
 * @private
 */
class ComputeBoundingBox {
    constructor() {
        if (arguments.length === 3) {
            this.computeBoundingBox(arguments);
        }

        this.CLASS_NAME = "SuperMap.LevelRenderer.Tool.ComputeBoundingBox";
    }

    /**
     * @function LevelRenderer.Tool.ComputeBoundingBox.prototype.computeBoundingBox
     * @description ä»é¡¶ç¹æ°ç»ä¸­è®¡ç®åºæå°åå´çï¼åå¥'min'å'max'ä¸­ã
     * @param {Array.<Object>} points - é¡¶ç¹æ°ç»ã
     * @param {Array.<number>} min - æå°
     * @param {Array.<number>} max - æå¤§
     */
    computeBoundingBox(points, min, max) {
        if (points.length === 0) {
            return;
        }
        var left = points[0][0];
        var right = points[0][0];
        var top = points[0][1];
        var bottom = points[0][1];

        for (var i = 1; i < points.length; i++) {
            var p = points[i];
            if (p[0] < left) {
                left = p[0];
            }
            if (p[0] > right) {
                right = p[0];
            }
            if (p[1] < top) {
                top = p[1];
            }
            if (p[1] > bottom) {
                bottom = p[1];
            }
        }

        min[0] = left;
        min[1] = top;
        max[0] = right;
        max[1] = bottom;
    }

    /**
     * @function LevelRenderer.Tool.ComputeBoundingBox.prototype.cubeBezier
     * @description ä»ä¸é¶è´å¡å°æ²çº¿(p0, p1, p2, p3)ä¸­è®¡ç®åºæå°åå´çï¼åå¥'min'å'max'ä¸­ãåï¼computeCubeBezierBoundingBoxã
     * @param {Array.<number>} p0 - ä¸é¶è´å¡å°æ²çº¿p0ç¹
     * @param {Array.<number>} p1 - ä¸é¶è´å¡å°æ²çº¿p1ç¹
     * @param {Array.<number>} p2 - ä¸é¶è´å¡å°æ²çº¿p2ç¹
     * @param {Array.<number>} p3 - ä¸é¶è´å¡å°æ²çº¿p3ç¹
     * @param {Array.<number>} min - æå°
     * @param {Array.<number>} max - æå¤§
     */
    cubeBezier(p0, p1, p2, p3, min, max) {
        var curve = new Curve_Curve();

        var xDim = [];
        curve.cubicExtrema(p0[0], p1[0], p2[0], p3[0], xDim);
        for (let i = 0; i < xDim.length; i++) {
            xDim[i] = curve.cubicAt(p0[0], p1[0], p2[0], p3[0], xDim[i]);
        }
        var yDim = [];
        curve.cubicExtrema(p0[1], p1[1], p2[1], p3[1], yDim);
        for (let i = 0; i < yDim.length; i++) {
            yDim[i] = curve.cubicAt(p0[1], p1[1], p2[1], p3[1], yDim[i]);
        }

        xDim.push(p0[0], p3[0]);
        yDim.push(p0[1], p3[1]);

        var left = Math.min.apply(null, xDim);
        var right = Math.max.apply(null, xDim);
        var top = Math.min.apply(null, yDim);
        var bottom = Math.max.apply(null, yDim);

        min[0] = left;
        min[1] = top;
        max[0] = right;
        max[1] = bottom;
    }

    /**
     * @function LevelRenderer.Tool.ComputeBoundingBox.prototype.quadraticBezier
     * @description ä»äºé¶è´å¡å°æ²çº¿(p0, p1, p2)ä¸­è®¡ç®åºæå°åå´çï¼åå¥'min'å'max'ä¸­ãåï¼computeQuadraticBezierBoundingBoxã
     * @param {Array.<number>} p0 - äºé¶è´å¡å°æ²çº¿p0ç¹
     * @param {Array.<number>} p1 - äºé¶è´å¡å°æ²çº¿p1ç¹
     * @param {Array.<number>} p2 - äºé¶è´å¡å°æ²çº¿p2ç¹
     * @param {Array.<number>} min - æå°
     * @param {Array.<number>} max - æå¤§
     */
    quadraticBezier(p0, p1, p2, min, max) {
        var curve = new Curve_Curve();

        // Find extremities, where derivative in x dim or y dim is zero
        var t1 = curve.quadraticExtremum(p0[0], p1[0], p2[0]);
        var t2 = curve.quadraticExtremum(p0[1], p1[1], p2[1]);

        t1 = Math.max(Math.min(t1, 1), 0);
        t2 = Math.max(Math.min(t2, 1), 0);

        var ct1 = 1 - t1;
        var ct2 = 1 - t2;

        var x1 = ct1 * ct1 * p0[0]
            + 2 * ct1 * t1 * p1[0]
            + t1 * t1 * p2[0];
        var y1 = ct1 * ct1 * p0[1]
            + 2 * ct1 * t1 * p1[1]
            + t1 * t1 * p2[1];

        var x2 = ct2 * ct2 * p0[0]
            + 2 * ct2 * t2 * p1[0]
            + t2 * t2 * p2[0];
        var y2 = ct2 * ct2 * p0[1]
            + 2 * ct2 * t2 * p1[1]
            + t2 * t2 * p2[1];
        min[0] = Math.min(p0[0], p2[0], x1, x2);
        min[1] = Math.min(p0[1], p2[1], y1, y2);
        max[0] = Math.max(p0[0], p2[0], x1, x2);
        max[1] = Math.max(p0[1], p2[1], y1, y2);
    }

    /**
     * @function LevelRenderer.Tool.ComputeBoundingBox.prototype.arc
     * @description ä»åå¼§ä¸­è®¡ç®åºæå°åå´çï¼åå¥'min'å'max'ä¸­ãåï¼computeArcBoundingBoxã
     * @param {number} x - åå¼§ä¸­å¿ç¹ x
     * @param {number} y - åå¼§ä¸­å¿ç¹ y
     * @param {number} r - åå¼§åå¾
     * @param {number} startAngle - åå¼§å¼å§è§åº¦
     * @param {number} endAngle - åå¼§ç»æè§åº¦
     * @param {number} anticlockwise - æ¯å¦æ¯é¡ºæ¶é
     * @param {number} min - æå°
     * @param {number} max - æå¤§
     */
    arc(x, y, r, startAngle, endAngle, anticlockwise, min, max) {
        var vec2 = new levelRenderer_Vector_Vector();

        var start = vec2.create();
        var end = vec2.create();
        var extremity = vec2.create();

        start[0] = Math.cos(startAngle) * r + x;
        start[1] = Math.sin(startAngle) * r + y;

        end[0] = Math.cos(endAngle) * r + x;
        end[1] = Math.sin(endAngle) * r + y;

        vec2.min(min, start, end);
        vec2.max(max, start, end);

        // Thresh to [0, Math.PI * 2]
        startAngle = startAngle % (Math.PI * 2);
        if (startAngle < 0) {
            startAngle = startAngle + Math.PI * 2;
        }
        endAngle = endAngle % (Math.PI * 2);
        if (endAngle < 0) {
            endAngle = endAngle + Math.PI * 2;
        }

        if (startAngle > endAngle && !anticlockwise) {
            endAngle += Math.PI * 2;
        } else if (startAngle < endAngle && anticlockwise) {
            startAngle += Math.PI * 2;
        }
        if (anticlockwise) {
            var tmp = endAngle;
            endAngle = startAngle;
            startAngle = tmp;
        }

        // var number = 0;
        // var step = (anticlockwise ? -Math.PI : Math.PI) / 2;
        for (var angle = 0; angle < endAngle; angle += Math.PI / 2) {
            if (angle > startAngle) {
                extremity[0] = Math.cos(angle) * r + x;
                extremity[1] = Math.sin(angle) * r + y;

                vec2.min(min, extremity, min);
                vec2.max(max, extremity, max);
            }
        }
    }
}

;// CONCATENATED MODULE: ./src/common/overlay/levelRenderer/Env.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
/**
 * @class  LevelRenderer.Tool.Env
 * @category Visualization Theme
 * @classdesc ç¯å¢è¯å«
 * @private
 */
class Env {
    constructor() {
        // Zepto.js
        // (c) 2010-2013 Thomas Fuchs
        // Zepto.js may be freely distributed under the MIT license.
        this.CLASS_NAME = "SuperMap.LevelRenderer.Tool.Env";
        var me = this;

        function detect(ua) {
            var os = me.os = {};
            var browser = me.browser = {};
            var webkit = ua.match(/Web[kK]it[\/]{0,1}([\d.]+)/);
            var android = ua.match(/(Android);?[\s\/]+([\d.]+)?/);
            var ipad = ua.match(/(iPad).*OS\s([\d_]+)/);
            var ipod = ua.match(/(iPod)(.*OS\s([\d_]+))?/);
            var iphone = !ipad && ua.match(/(iPhone\sOS)\s([\d_]+)/);
            var webos = ua.match(/(webOS|hpwOS)[\s\/]([\d.]+)/);
            var touchpad = webos && ua.match(/TouchPad/);
            var kindle = ua.match(/Kindle\/([\d.]+)/);
            var silk = ua.match(/Silk\/([\d._]+)/);
            var blackberry = ua.match(/(BlackBerry).*Version\/([\d.]+)/);
            var bb10 = ua.match(/(BB10).*Version\/([\d.]+)/);
            var rimtabletos = ua.match(/(RIM\sTablet\sOS)\s([\d.]+)/);
            var playbook = ua.match(/PlayBook/);
            var chrome = ua.match(/Chrome\/([\d.]+)/) || ua.match(/CriOS\/([\d.]+)/);
            var firefox = ua.match(/Firefox\/([\d.]+)/);
            var ie = ua.match(/MSIE ([\d.]+)/);
            var safari = webkit && ua.match(/Mobile\//) && !chrome;
            var webview = ua.match(/(iPhone|iPod|iPad).*AppleWebKit(?!.*Safari)/) && !chrome;

            // Todo: clean this up with a better OS/browser seperation:
            // - discern (more) between multiple browsers on android
            // - decide if kindle fire in silk mode is android or not
            // - Firefox on Android doesn't specify the Android version
            // - possibly devide in os, device and browser hashes

            /*eslint-disable*/
            if (browser.webkit = !!webkit) {
                browser.version = webkit[1];
            }

            if (android) {
                os.android = true;
                os.version = android[2];
            }
            if (iphone && !ipod) {
                os.ios = os.iphone = true;
                os.version = iphone[2].replace(/_/g, '.');
            }
            if (ipad) {
                os.ios = os.ipad = true;
                os.version = ipad[2].replace(/_/g, '.');
            }
            if (ipod) {
                os.ios = os.ipod = true;
                os.version = ipod[3] ? ipod[3].replace(/_/g, '.') : null;
            }
            if (webos) {
                os.webos = true;
                os.version = webos[2];
            }
            if (touchpad) {
                os.touchpad = true;
            }
            if (blackberry) {
                os.blackberry = true;
                os.version = blackberry[2];
            }
            if (bb10) {
                os.bb10 = true;
                os.version = bb10[2];
            }
            if (rimtabletos) {
                os.rimtabletos = true;
                os.version = rimtabletos[2];
            }
            if (playbook) {
                browser.playbook = true;
            }
            if (kindle) {
                os.kindle = true;
                os.version = kindle[1];
            }
            if (silk) {
                browser.silk = true;
                browser.version = silk[1];
            }
            if (!silk && os.android && ua.match(/Kindle Fire/)) {
                browser.silk = true;
            }
            if (chrome) {
                browser.chrome = true;
                browser.version = chrome[1];
            }
            if (firefox) {
                browser.firefox = true;
                browser.version = firefox[1];
            }
            if (ie) {
                browser.ie = true;
                browser.version = ie[1];
            }
            if (safari && (ua.match(/Safari/) || !!os.ios)) {
                browser.safari = true;
            }
            if (webview) {
                browser.webview = true;
            }
            if (ie) {
                browser.ie = true;
                browser.version = ie[1];
            }

            os.tablet = !!(ipad || playbook || (android && !ua.match(/Mobile/)) ||
                (firefox && ua.match(/Tablet/)) || (ie && !ua.match(/Phone/) && ua.match(/Touch/)));
            os.phone = !!(!os.tablet && !os.ipod && (android || iphone || webos || blackberry || bb10 ||
                (chrome && ua.match(/Android/)) || (chrome && ua.match(/CriOS\/([\d.]+)/)) ||
                (firefox && ua.match(/Mobile/)) || (ie && ua.match(/Touch/))));

            return {
                browser: browser,
                os: os,
                // åçcanvasæ¯æ
                canvasSupported: document.createElement('canvas').getContext ? true : false
            };
        }

        return detect(navigator.userAgent);
    }
    destory() {
        return true;
    }
}

;// CONCATENATED MODULE: ./src/common/overlay/levelRenderer/Event.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
/**
 * @class  LevelRenderer.Tool.Event
 * @category Visualization Theme
 * @classdesc LevelRenderer å·¥å·-äºä»¶è¾å©ç±»
 * @private
 */
class Event_Event {
    constructor() {
        /**
         * @member {function} LevelRenderer.Tool.Event.prototype.stop
         * @description åæ­¢åæ³¡åé»æ­¢é»è®¤è¡ä¸º
         */
        this.stop = typeof window.addEventListener === 'function'
            ? function (e) {
                e.preventDefault();
                e.stopPropagation();
                e.cancelBubble = true;
            }
            : function (e) {
                e.returnValue = false;
                e.cancelBubble = true;
            };

        this.CLASS_NAME = "SuperMap.LevelRenderer.Tool.Event";
    }


    /**
     * @function LevelRenderer.Tool.Event.prototype.getX
     * @description æåé¼ æ ï¼ææï¼xåæ ã
     * @param {Event} e - äºä»¶ã
     * @returns {number} é¼ æ ï¼ææï¼xåæ ã
     */
    getX(e) {
        return typeof e.zrenderX != 'undefined' && e.zrenderX
            || typeof e.offsetX != 'undefined' && e.offsetX
            || typeof e.layerX != 'undefined' && e.layerX
            || typeof e.clientX != 'undefined' && e.clientX;
    }


    /**
     * @function LevelRenderer.Tool.Event.prototype.getY
     * @description æåé¼ æ ï¼ææï¼yåæ ã
     * @param {Event} e - äºä»¶ã
     * @returns {number} é¼ æ ï¼ææï¼yåæ ã
     */
    getY(e) {
        return typeof e.zrenderY != 'undefined' && e.zrenderY
            || typeof e.offsetY != 'undefined' && e.offsetY
            || typeof e.layerY != 'undefined' && e.layerY
            || typeof e.clientY != 'undefined' && e.clientY;
    }


    /**
     * @function LevelRenderer.Tool.Event.prototype.getDelta
     * @description æåé¼ æ æ»è½®ååã
     * @param {Event} e - äºä»¶ã
     * @returns {number} æ»è½®ååï¼æ­£å¼è¯´ææ»è½®æ¯åä¸æ»å¨ï¼å¦ææ¯è´å¼è¯´ææ»è½®æ¯åä¸æ»å¨ã
     */
    getDelta(e) {
        return typeof e.zrenderDelta != 'undefined' && e.zrenderDelta
            || typeof e.wheelDelta != 'undefined' && e.wheelDelta
            || typeof e.detail != 'undefined' && -e.detail;
    }
}

;// CONCATENATED MODULE: ./src/common/overlay/levelRenderer/Http.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
/**
 * @private
 * @class  LevelRenderer.Tool.Http
 * @category Visualization Theme
 * @classdesc LevelRenderer å·¥å·-Http
 */
class Http {
    constructor() {
        this.CLASS_NAME = "SuperMap.LevelRenderer.Tool.Http"
    }

    /**
     * @function LevelRenderer.Tool.Http.prototype.get
     * @description getè¯·æ±ã
     * @param {(string|IHTTPGetOption)} url - è¯·æ±url
     * @param {function} onsuccess - è¯·æ±æåå½æ°
     * @param {function} onerror - è¯·æ±å¤±è´¥å½æ°
     * @param {Object} opts - é¢å¤åæ°
     * @returns {number} coså¼
     */
    get(url, onsuccess, onerror) {
        if (typeof(url) === 'object') {
            var obj = url;
            url = obj.url;
            onsuccess = obj.onsuccess;
            onerror = obj.onerror;

        }
        var xhr = window.XMLHttpRequest
            ? new XMLHttpRequest()
            : new window.ActiveXObject('Microsoft.XMLHTTP');
        xhr.open('GET', url, true);
        xhr.onreadystatechange = function () {
            if (xhr.readyState == 4) {
                if (xhr.status >= 200 && xhr.status < 300 || xhr.status === 304) {
                    onsuccess && onsuccess(xhr.responseText);
                } else {
                    onerror && onerror();
                }
                xhr.onreadystatechange = new Function();
                xhr = null;
            }
        };

        xhr.send(null);
    }

}

;// CONCATENATED MODULE: ./src/common/overlay/levelRenderer/Config.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
class Config {

}
/**
 * @enum EVENT
 * @description äºä»¶
 * @type {Object}
 * @private 
 */
Config.EVENT = {
    //çªå£å¤§å°åå
    RESIZE: 'resize',

    //é¼ æ æé®è¢«ï¼ææï¼æä¸ï¼äºä»¶å¯¹è±¡æ¯ï¼ç®æ å¾å½¢åç´ æç©º
    CLICK: 'click',

    //åå»äºä»¶
    DBLCLICK: 'dblclick',

    //é¼ æ æ»è½®ååï¼äºä»¶å¯¹è±¡æ¯ï¼ç®æ å¾å½¢åç´ æç©º
    MOUSEWHEEL: 'mousewheel',

    //é¼ æ ï¼ææï¼è¢«ç§»å¨ï¼äºä»¶å¯¹è±¡æ¯ï¼ç®æ å¾å½¢åç´ æç©º
    MOUSEMOVE: 'mousemove',

    //é¼ æ ç§»å°æå¾å½¢åç´ ä¹ä¸ï¼äºä»¶å¯¹è±¡æ¯ï¼ç®æ å¾å½¢åç´ 
    MOUSEOVER: 'mouseover',

    //é¼ æ ä»æå¾å½¢åç´ ç§»å¼ï¼äºä»¶å¯¹è±¡æ¯ï¼ç®æ å¾å½¢åç´ 
    MOUSEOUT: 'mouseout',

    //é¼ æ æé®ï¼ææï¼è¢«æä¸ï¼äºä»¶å¯¹è±¡æ¯ï¼ç®æ å¾å½¢åç´ æç©º
    MOUSEDOWN: 'mousedown',

    //é¼ æ æé®ï¼ææï¼è¢«æ¾å¼ï¼äºä»¶å¯¹è±¡æ¯ï¼ç®æ å¾å½¢åç´ æç©º
    MOUSEUP: 'mouseup',

    //å¨å±ç¦»å¼ï¼MOUSEOUTè§¦åæ¯è¾é¢ç¹ï¼ä¸æ¬¡ç¦»å¼ä¼åç»å®
    GLOBALOUT: 'globalout',

    // ä¸æ¬¡æååç´ ææ½çè¡ä¸ºäºä»¶è¿ç¨æ¯ï¼
    // dragstart > dragenter > dragover [> dragleave] > drop > dragend

    //å¼å§ææ½æ¶è§¦åï¼äºä»¶å¯¹è±¡æ¯ï¼è¢«ææ½å¾å½¢åç´ 
    DRAGSTART: 'dragstart',

    //ææ½å®æ¯æ¶è§¦åï¼å¨dropä¹åè§¦åï¼ï¼äºä»¶å¯¹è±¡æ¯ï¼è¢«ææ½å¾å½¢åç´ 
    DRAGEND: 'dragend',

    //ææ½å¾å½¢åç´ è¿å¥ç®æ å¾å½¢åç´ æ¶è§¦åï¼äºä»¶å¯¹è±¡æ¯ï¼ç®æ å¾å½¢åç´ 
    DRAGENTER: 'dragenter',

    //ææ½å¾å½¢åç´ å¨ç®æ å¾å½¢åç´ ä¸ç§»å¨æ¶è§¦åï¼äºä»¶å¯¹è±¡æ¯ï¼ç®æ å¾å½¢åç´ 
    DRAGOVER: 'dragover',

    //ææ½å¾å½¢åç´ ç¦»å¼ç®æ å¾å½¢åç´ æ¶è§¦åï¼äºä»¶å¯¹è±¡æ¯ï¼ç®æ å¾å½¢åç´ 
    DRAGLEAVE: 'dragleave',

    //ææ½å¾å½¢åç´ æ¾å¨ç®æ å¾å½¢åç´ åæ¶è§¦åï¼äºä»¶å¯¹è±¡æ¯ï¼ç®æ å¾å½¢åç´ 
    DROP: 'drop',

    //touch end - start < delay is click
    touchClickDelay: 300
};

/**
 * @enum catchBrushException
 * @description æ¯å¦å¼å¸¸æè·
 * @type {boolean}
 * @private 
 */
Config.catchBrushException = false;

/**
 * @enum debugMode
 * @description debug æ¥å¿éé¡¹ï¼catchBrushException ä¸º true ä¸ææã
 * 0 : ä¸çædebugæ°æ®ï¼åå¸ç¨
 * 1 : å¼å¸¸æåºï¼è°è¯ç¨
 * 2 : æ§å¶å°è¾åºï¼è°è¯ç¨
 * @type {boolean}
 * @private 
 */
Config.debugMode = 0;
;// CONCATENATED MODULE: ./src/common/overlay/levelRenderer/Log.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @private
 * @class  LevelRenderer.Tool.Log
 * @category Visualization Theme
 * @classdesc LevelRenderer å·¥å·-æ¥å¿
 */
class Log {
    constructor() {

        this.CLASS_NAME = "SuperMap.LevelRenderer.Tool.Log";
        return function () {
            if (+Config.debugMode === 0) {
                return;
            } else if (+Config.debugMode === 1) {
                for (let k in arguments) {
                    throw new Error(arguments[k]);
                }
            } else if (+Config.debugMode > 1) {
                for (let k in arguments) {
                    console.log(arguments[k]);
                }
            }
        };

        /* for debug
         return function(mes) {
         document.getElementById('wrong-message').innerHTML =
         mes + ' ' + (new Date() - 0)
         + '<br/>'
         + document.getElementById('wrong-message').innerHTML;
         };
         */
    }

    destory() {
        return true;
    }
}

;// CONCATENATED MODULE: ./src/common/overlay/levelRenderer/Math.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
/**
 * @private
 * @class  LevelRenderer.Tool.Math
 * @category Visualization Theme
 * @classdesc LevelRenderer å·¥å·-æ°å­¦è¾å©ç±»
 */
class MathTool {

    constructor() {

        /**
         * @member {number} LevelRenderer.Tool.Math._radians
         * @description è§åº¦ä¸å¼§åº¦è½¬ååæ°
         */
        this._radians = window.Math.PI / 180;

        this.CLASS_NAME = "SuperMap.LevelRenderer.Tool.Math";
    }

    /**
     * @function LevelRenderer.Tool.Math.prototype.sin
     * @description æ­£å¼¦å½æ°ã
     * @param {number} angle - å¼§åº¦ï¼è§åº¦ï¼åæ°ã
     * @param {boolean} [isDegrees=false] - angleåæ°æ¯å¦ä¸ºè§åº¦è®¡ç®ï¼angleä¸ºä»¥å¼§åº¦è®¡éçè§åº¦ã
     * @returns {number} sin å¼ã
     */
    sin(angle, isDegrees) {
        return window.Math.sin(isDegrees ? angle * this._radians : angle);
    }

    /**
     * @function LevelRenderer.Tool.Math.prototype.cos
     * @description ä½å¼¦å½æ°ã
     * @param {number} angle - å¼§åº¦ï¼è§åº¦ï¼åæ°ã
     * @param {boolean} [isDegrees=false] - angleåæ°æ¯å¦ä¸ºè§åº¦è®¡ç®ï¼angleä¸ºä»¥å¼§åº¦è®¡éçè§åº¦ã
     * @returns {number} cos å¼ã
     */
    cos(angle, isDegrees) {
        return window.Math.cos(isDegrees ? angle * this._radians : angle);
    }

    /**
     * @function LevelRenderer.Tool.Math.prototype.degreeToRadian
     * @description è§åº¦è½¬å¼§åº¦ã
     * @param {number} angle - å¼§åº¦ï¼è§åº¦ï¼åæ°ã
     * @param {boolean} [isDegrees=false] - angleåæ°æ¯å¦ä¸ºè§åº¦è®¡ç®ï¼angleä¸ºä»¥å¼§åº¦è®¡éçè§åº¦ã
     * @returns {number} å¼§åº¦å¼ã
     */
    degreeToRadian(angle) {
        return angle * this._radians;
    }

    /**
     * @function LevelRenderer.Tool.Math.prototype.radianToDegree
     * @description å¼§åº¦è½¬è§åº¦ã
     * @param {number} angle - å¼§åº¦ï¼è§åº¦ï¼åæ°ã
     * @param {boolean} [isDegrees=false] - angleåæ°æ¯å¦ä¸ºè§åº¦è®¡ç®ï¼angleä¸ºä»¥å¼§åº¦è®¡éçè§åº¦ã
     * @returns {number} è§åº¦ã
     */

    radianToDegree(angle) {
        return angle / this._radians;
    }

}

;// CONCATENATED MODULE: ./src/common/overlay/levelRenderer/Matrix.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
/**
 * @private
 * @class  LevelRenderer.Tool.Matrix
 * @category Visualization Theme
 * @classdesc LevelRenderer å·¥å·-3x2ç©éµæä½ç±»
 */
class Matrix {

    constructor() {
        /**
         * @member {Object} LevelRenderer.Tool.Matrix.prototype.ArrayCtor
         * @description æ°ç»ç±»åæ§å¶
         */
        this.ArrayCtor = typeof Float32Array === 'undefined'
            ? Array
            : Float32Array;

        this.CLASS_NAME = "SuperMap.LevelRenderer.Tool.Matrix";
    }


    /**
     * @function LevelRenderer.Tool.Matrix.prototype.create
     * @description åå»ºä¸ä¸ªåä½ç©éµã
     * @returns {(Float32Array|Array.<number>)} åä½ç©éµã
     */
    create() {
        var ArrayCtor = this.ArrayCtor;

        var out = new ArrayCtor(6);
        this.identity(out);

        return out;
    }

    /**
     * @function LevelRenderer.Tool.Matrix.prototype.identity
     * @description è®¾ç½®ç©éµä¸ºåä½ç©éµã
     * @param {(Float32Array|Array.<number>)} out - åä½ç©éµã
     * @returns {(Float32Array|Array.<number>)} åä½ç©éµã
     */
    identity(out) {
        out[0] = 1;
        out[1] = 0;
        out[2] = 0;
        out[3] = 1;
        out[4] = 0;
        out[5] = 0;
        return out;
    }


    /**
     * @function LevelRenderer.Tool.Matrix.prototype.copy
     * @description å¤å¶ç©éµã
     * @param {(Float32Array|Array.<number>)} out - åä½ç©éµã
     * @returns {(Float32Array|Array.<number>)} åéç©éµã
     */
    copy(out, m) {
        out[0] = m[0];
        out[1] = m[1];
        out[2] = m[2];
        out[3] = m[3];
        out[4] = m[4];
        out[5] = m[5];
        return out;
    }

    /**
     * @function LevelRenderer.Tool.Matrix.prototype.mul
     * @description ç©éµç¸ä¹ã
     * @param {(Float32Array|Array.<number>)} out - åä½ç©éµã
     * @param {(Float32Array|Array.<number>)} m1 - ç©éµm1ã
     * @param {(Float32Array|Array.<number>)} m2- ç©éµm2ã
     * @returns {(Float32Array|Array.<number>)} ç»æç©éµã
     */
    mul(out, m1, m2) {
        out[0] = m1[0] * m2[0] + m1[2] * m2[1];
        out[1] = m1[1] * m2[0] + m1[3] * m2[1];
        out[2] = m1[0] * m2[2] + m1[2] * m2[3];
        out[3] = m1[1] * m2[2] + m1[3] * m2[3];
        out[4] = m1[0] * m2[4] + m1[2] * m2[5] + m1[4];
        out[5] = m1[1] * m2[4] + m1[3] * m2[5] + m1[5];
        return out;
    }

    /**
     * @function LevelRenderer.Tool.Matrix.prototype.mul
     * @description å¹³ç§»åæ¢ã
     * @param {(Float32Array|Array.<number>)} out - åä½ç©éµã
     * @param {(Float32Array|Array.<number>)} a - ç©éµã
     * @param {(Float32Array|Array.<number>)} v- å¹³ç§»åæ°ã
     * @returns {(Float32Array|Array.<number>)} ç»æç©éµã
     */
    translate(out, a, v) {
        out[0] = a[0];
        out[1] = a[1];
        out[2] = a[2];
        out[3] = a[3];
        out[4] = a[4] + v[0];
        out[5] = a[5] + v[1];
        return out;
    }

    /**
     * @function LevelRenderer.Tool.Matrix.prototype.rotate
     * @description å¹³ç§»åæ¢ã
     * @param {(Float32Array|Array.<number>)} out - åä½ç©éµã
     * @param {(Float32Array|Array.<number>)} a - ç©éµã
     * @param {(Float32Array|Array.<number>)} rad - æè½¬åæ°ã
     * @returns {(Float32Array|Array.<number>)} ç»æç©éµã
     */
    rotate(out, a, rad) {
        var aa = a[0];
        var ac = a[2];
        var atx = a[4];
        var ab = a[1];
        var ad = a[3];
        var aty = a[5];
        var st = Math.sin(rad);
        var ct = Math.cos(rad);

        out[0] = aa * ct + ab * st;
        out[1] = -aa * st + ab * ct;
        out[2] = ac * ct + ad * st;
        out[3] = -ac * st + ct * ad;
        out[4] = ct * atx + st * aty;
        out[5] = ct * aty - st * atx;
        return out;
    }

    /**
     * @function LevelRenderer.Tool.Matrix.prototype.scale
     * @description ç¼©æ¾åæ¢ã
     * @param {(Float32Array|Array.<number>)} out - åä½ç©éµã
     * @param {(Float32Array|Array.<number>)} a - ç©éµã
     * @param {(Float32Array|Array.<number>)} v - ç¼©æ¾åæ°ã
     * @returns {(Float32Array|Array.<number>)} ç»æç©éµã
     */
    scale(out, a, v) {
        var vx = v[0];
        var vy = v[1];
        out[0] = a[0] * vx;
        out[1] = a[1] * vy;
        out[2] = a[2] * vx;
        out[3] = a[3] * vy;
        out[4] = a[4] * vx;
        out[5] = a[5] * vy;
        return out;
    }

    /**
     * @function LevelRenderer.Tool.Matrix.prototype.invert
     * @description æ±éç©éµã
     * @param {(Float32Array|Array.<number>)} out - åä½ç©éµã
     * @param {(Float32Array|Array.<number>)} a - ç©éµã
     * @returns {(Float32Array|Array.<number>)} ç»æç©éµã
     */
    invert(out, a) {
        var aa = a[0];
        var ac = a[2];
        var atx = a[4];
        var ab = a[1];
        var ad = a[3];
        var aty = a[5];

        var det = aa * ad - ab * ac;
        if (!det) {
            return null;
        }
        det = 1.0 / det;

        out[0] = ad * det;
        out[1] = -ab * det;
        out[2] = -ac * det;
        out[3] = aa * det;
        out[4] = (ac * aty - ad * atx) * det;
        out[5] = (ab * atx - aa * aty) * det;
        return out;
    }

    /**
     * @function LevelRenderer.Tool.Matrix.prototype.mulVector
     * @description ç©éµå·¦ä¹åéã
     * @param {(Float32Array|Array.<number>)} out - åä½ç©éµã
     * @param {(Float32Array|Array.<number>)} a - ç©éµã
     * @param {(Float32Array|Array.<number>)} v - ç¼©æ¾åæ°ã
     * @returns {(Float32Array|Array.<number>)} ç»æç©éµã
     */
    mulVector(out, a, v) {
        var aa = a[0];
        var ac = a[2];
        var atx = a[4];
        var ab = a[1];
        var ad = a[3];
        var aty = a[5];

        out[0] = v[0] * aa + v[1] * ac + atx;
        out[1] = v[0] * ab + v[1] * ad + aty;

        return out;
    }

}

;// CONCATENATED MODULE: ./src/common/overlay/levelRenderer/SUtil.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/













class SUtil_SUtil {
    /**
     * @function LevelRenderer.SUtil.SUtil_smoothBezier
     * @description è´å¡å°å¹³æ»æ²çº¿ã
     * @private
     * @param {Array} points - çº¿æ®µé¡¶ç¹æ°ç»ã
     * @param {number} smooth - å¹³æ»ç­çº§, 0-1ã
     * @param {boolean} isLoop - isLoopã
     * @param {Array} constraint - å°è®¡ç®åºæ¥çæ§å¶ç¹çº¦æå¨ä¸ä¸ªåå´çåï¼æ¯å¦ [[0, 0], [100, 100]], è¿ä¸ªåå´çä¼ä¸æ´ä¸ªæçº¿çåå´çåä¸ä¸ªå¹¶éç¨æ¥çº¦ææ§å¶ç¹ã
     * @param {Array.<number>} [originalPosition=[0, 0]] - åèåç¹ã
     * @return {Array} çæçå¹³æ»èç¹æ°ç»ã
     */
    static SUtil_smoothBezier(points, smooth, isLoop, constraint, originalPosition) {
        if (!originalPosition || originalPosition.length !== 2) {
            originalPosition = [0, 0];
        }
        var __OP = originalPosition;

        var cps = [];

        var v = [];
        var v1 = [];
        var v2 = [];

        var hasConstraint = !!constraint;
        var min, max;
        if (hasConstraint) {
            min = [Infinity, Infinity];
            max = [-Infinity, -Infinity];
            let len = points.length;
            for (let i = 0; i < len; i++) {
                SUtil_SUtil.Util_vector.min(min, min, [points[i][0] + __OP[0], points[i][1] + __OP[1]]);
                SUtil_SUtil.Util_vector.max(max, max, [points[i][0] + __OP[0], points[i][1] + __OP[1]]);
            }
            // ä¸æå®çåå´çåå¹¶é
            SUtil_SUtil.Util_vector.min(min, min, constraint[0]);
            SUtil_SUtil.Util_vector.max(max, max, constraint[1]);
        }

        let len = points.length;
        for (let i = 0; i < len; i++) {
            let point = [points[i][0] + __OP[0], points[i][1] + __OP[1]];
            let prevPoint;
            let nextPoint;

            if (isLoop) {
                prevPoint = [points[i ? i - 1 : len - 1][0] + __OP[0], points[i ? i - 1 : len - 1][1] + __OP[1]];
                nextPoint = [points[(i + 1) % len][0] + __OP[0], points[(i + 1) % len][1] + __OP[1]];
            } else {
                if (i === 0 || i === len - 1) {
                    cps.push([points[i][0] + __OP[0], points[i][1] + __OP[1]]);
                    continue;
                } else {
                    prevPoint = [points[i - 1][0] + __OP[0], points[i - 1][1] + __OP[1]];
                    nextPoint = [points[i + 1][0] + __OP[0], points[i + 1][1] + __OP[1]];
                }
            }

            SUtil_SUtil.Util_vector.sub(v, nextPoint, prevPoint);

            // use degree to scale the handle length
            SUtil_SUtil.Util_vector.scale(v, v, smooth);

            let d0 = SUtil_SUtil.Util_vector.distance(point, prevPoint);
            let d1 = SUtil_SUtil.Util_vector.distance(point, nextPoint);
            let sum = d0 + d1;
            if (sum !== 0) {
                d0 /= sum;
                d1 /= sum;
            }

            SUtil_SUtil.Util_vector.scale(v1, v, -d0);
            SUtil_SUtil.Util_vector.scale(v2, v, d1);
            let cp0 = SUtil_SUtil.Util_vector.add([], point, v1);
            let cp1 = SUtil_SUtil.Util_vector.add([], point, v2);
            if (hasConstraint) {
                SUtil_SUtil.Util_vector.max(cp0, cp0, min);
                SUtil_SUtil.Util_vector.min(cp0, cp0, max);
                SUtil_SUtil.Util_vector.max(cp1, cp1, min);
                SUtil_SUtil.Util_vector.min(cp1, cp1, max);
            }
            cps.push(cp0);
            cps.push(cp1);
        }

        if (isLoop) {
            cps.push(cps.shift());
        }

        return cps;
    }

    /**
     * @function LevelRenderer.SUtil.SUtil_smoothSpline
     * @description æå¼æçº¿ã
     * @private
     * @param {Array} points - çº¿æ®µé¡¶ç¹æ°ç»ã
     * @param {boolean} isLoop - isLoopã
     * @param {Array} constraint - å°è®¡ç®åºæ¥çæ§å¶ç¹çº¦æå¨ä¸ä¸ªåå´çåï¼æ¯å¦ [[0, 0], [100, 100]], è¿ä¸ªåå´çä¼ä¸æ´ä¸ªæçº¿çåå´çåä¸ä¸ªå¹¶éç¨æ¥çº¦ææ§å¶ç¹ã
     * @param {Array.<number>} originalPosition - åèåç¹ãé»è®¤å¼ï¼[0, 0]ã
     * @return {Array} çæçå¹³æ»èç¹æ°ç»ã
     */
    static SUtil_smoothSpline(points, isLoop, constraint, originalPosition) {
        if (!originalPosition || originalPosition.length !== 2) {
            originalPosition = [0, 0];
        }
        var __OP = originalPosition;

        var len = points.length;
        var ret = [];

        var distance = 0;
        for (let i = 1; i < len; i++) {
            distance += SUtil_SUtil.Util_vector.distance([points[i - 1][0] + __OP[0], points[i - 1][1] + __OP[1]], [points[i][0] + __OP[0], points[i][1] + __OP[1]]);
        }

        var segs = distance / 5;
        segs = segs < len ? len : segs;
        for (let i = 0; i < segs; i++) {
            let pos = i / (segs - 1) * (isLoop ? len : len - 1);
            let idx = Math.floor(pos);

            let w = pos - idx;

            let p0;
            let p1 = [points[idx % len][0] + __OP[0], points[idx % len][1] + __OP[1]];
            let p2;
            let p3;
            if (!isLoop) {
                p0 = [points[idx === 0 ? idx : idx - 1][0] + __OP[0], points[idx === 0 ? idx : idx - 1][1] + __OP[1]];
                p2 = [points[idx > len - 2 ? len - 1 : idx + 1][0] + __OP[0], points[idx > len - 2 ? len - 1 : idx + 1][1] + __OP[1]];
                p3 = [points[idx > len - 3 ? len - 1 : idx + 2][0] + __OP[0], points[idx > len - 3 ? len - 1 : idx + 2][1] + __OP[1]];
            } else {

                p0 = [points[(idx - 1 + len) % len][0] + __OP[0], points[(idx - 1 + len) % len][1] + __OP[1]];
                p2 = [points[(idx + 1) % len][0] + __OP[0], points[(idx + 1) % len][1] + __OP[1]];
                p3 = [points[(idx + 2) % len][0] + __OP[0], points[(idx + 2) % len][1] + __OP[1]];
            }

            let w2 = w * w;
            let w3 = w * w2;

            ret.push([
                interpolate(p0[0], p1[0], p2[0], p3[0], w, w2, w3),
                interpolate(p0[1], p1[1], p2[1], p3[1], w, w2, w3)
            ]);
        }
        return ret;

        // inner Function
        function interpolate(p0, p1, p2, p3, t, t2, t3) {
            var v0 = (p2 - p0) * 0.5;
            var v1 = (p3 - p1) * 0.5;
            return (2 * (p1 - p2) + v0 + v1) * t3
                + (-3 * (p1 - p2) - 2 * v0 - v1) * t2
                + v0 * t + p1;
        }
    }

    /**
     * @function LevelRenderer.SUtil.SUtil_dashedLineTo
     * @description èçº¿ lineToã
     */
    static SUtil_dashedLineTo(ctx, x1, y1, x2, y2, dashLength, customDashPattern) {
        // http://msdn.microsoft.com/en-us/library/ie/dn265063(v=vs.85).aspx
        var dashPattern = [5, 5];
        dashLength = typeof dashLength != 'number'
            ? 5
            : dashLength;

        if (ctx.setLineDash) {
            dashPattern[0] = dashLength;
            dashPattern[1] = dashLength;

            if (customDashPattern && (customDashPattern instanceof Array)) {
                ctx.setLineDash(customDashPattern);
            } else {
                ctx.setLineDash(dashPattern);
            }
            // ctx.setLineDash(dashPattern);

            ctx.moveTo(x1, y1);
            ctx.lineTo(x2, y2);
            return;
        }

        var dx = x2 - x1;
        var dy = y2 - y1;
        var numDashes = Math.floor(
            Math.sqrt(dx * dx + dy * dy) / dashLength
        );
        dx = dx / numDashes;
        dy = dy / numDashes;
        var flag = true;
        for (var i = 0; i < numDashes; ++i) {
            if (flag) {
                ctx.moveTo(x1, y1);
            } else {
                ctx.lineTo(x1, y1);
            }
            flag = !flag;
            x1 += dx;
            y1 += dy;
        }
        ctx.lineTo(x2, y2);
    }
}
// æææå·¥å·å¯¹è±¡æ¾å°å¨å±éæåéä¸ï¼ä»¥ä¾¿ç´æ¥è°ç¨å·¥å·æ¹æ³ï¼
// é¿åä½¿ç¨å·¥å·æ¶é¢ç¹çåå»ºå·¥å·å¯¹è±¡å¸¦æ¥çæ§è½æ¶èã
SUtil_SUtil.Util_area = new Area();
SUtil_SUtil.Util_color = new Color();
SUtil_SUtil.Util_computeBoundingBox = new ComputeBoundingBox();
SUtil_SUtil.Util_curve = new Curve_Curve();
SUtil_SUtil.Util_env = new Env();
SUtil_SUtil.Util_event = new Event_Event();
SUtil_SUtil.Util_http = new Http();
SUtil_SUtil.Util_log = new Log();
SUtil_SUtil.Util_math = new MathTool();
SUtil_SUtil.Util_matrix = new Matrix();
SUtil_SUtil.Util = new Util_Util();
SUtil_SUtil.Util_vector = new levelRenderer_Vector_Vector();

;// CONCATENATED MODULE: ./src/common/overlay/levelRenderer/Transformable.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @private
 * @class  LevelRenderer.Transformable
 * @category Visualization Theme
 * @classdesc å¯åæ¢è¶ç±»ï¼æææ¯æ Canvas Transform åæ¢æä½çç±»åæ¯æ­¤ç±»çå­ç±»ãæ­¤ç±»ä¸å¯å®ä¾åã
 */
class Transformable {
    constructor() {
        /**
         * @member {Array.<number>} LevelRenderer.Transformable.prototype.position
         * @description å¹³ç§»ï¼ é»è®¤å¼ï¼[0, 0]ã
         */
        this.position = [0, 0];

        /**
         * @member {Array.<number>} LevelRenderer.Transformable.prototype.rotation
         * @description æè½¬ï¼å¯ä»¥éè¿æ°ç»äºä¸é¡¹æå®æè½¬çåç¹ï¼ é»è®¤å¼ï¼[0, 0, 0]ã
         */
        this.rotation = [0, 0, 0];

        /**
         * @member {Array.<number>} LevelRenderer.Transformable.prototype.scale
         * @description ç¼©æ¾ï¼å¯ä»¥éè¿æ°ç»ä¸åé¡¹æå®ç¼©æ¾çåç¹ï¼ é»è®¤å¼ï¼[1, 1, 0, 0]ã
         */
        this.scale = [1, 1, 0, 0];

        /**
         * @member {boolean} LevelRenderer.Transformable.prototype.needLocalTransform
         * @description æ¯å¦åæ¢ãé»è®¤å¼ï¼falseã
         */
        this.needLocalTransform = false;

        /**
         * @member {boolean} LevelRenderer.Transformable.prototype.needTransform
         * @description æ¯å¦æåæ åæ¢ãé»è®¤å¼ï¼falseã
         */
        this.needTransform = false;

        this.CLASS_NAME = "SuperMap.LevelRenderer.Transformable";
        /**
         * @function LevelRenderer.Transformable.prototype.lookAt
         * @description è®¾ç½®å¾å½¢çæåã
         */
        this.lookAt = (function () {
            var v = SUtil_SUtil.Util_vector.create();
            // {Array.<Number>|Float32Array} target
            return function (target) {
                if (!this.transform) {
                    this.transform = SUtil_SUtil.Util_matrix.create();
                }
                var m = this.transform;
                SUtil_SUtil.Util_vector.sub(v, target, this.position);
                if (isAroundZero(v[0]) && isAroundZero(v[1])) {
                    return;
                }
                SUtil_SUtil.Util_vector.normalize(v, v);
                // Y Axis
                // TODO Scale origin ?
                m[2] = v[0] * this.scale[1];
                m[3] = v[1] * this.scale[1];
                // X Axis
                m[0] = v[1] * this.scale[0];
                m[1] = -v[0] * this.scale[0];
                // Position
                m[4] = this.position[0];
                m[5] = this.position[1];

                this.decomposeTransform();

                function isAroundZero(val) {
                    var EPSILON = 5e-5;
                    return val > -EPSILON && val < EPSILON;
                }
            };
        })();
    }

    /**
     * @function LevelRenderer.Transformable.prototype.destroy
     * @description éæ¯å¯¹è±¡ï¼éæ¾èµæºãè°ç¨æ­¤å½æ°åææå±æ§å°è¢«ç½®ä¸º nullã
     */
    destroy() {
        this.position = null;
        this.rotation = null;
        this.scale = null;
        this.needLocalTransform = null;
        this.needTransform = null;
    }


    /**
     * @function LevelRenderer.Transformable.prototype.updateNeedTransform
     * @description æ´æ° needLocalTransform
     */
    updateNeedTransform() {
        this.needLocalTransform = isNotAroundZero(this.rotation[0])
            || isNotAroundZero(this.position[0])
            || isNotAroundZero(this.position[1])
            || isNotAroundZero(this.scale[0] - 1)
            || isNotAroundZero(this.scale[1] - 1);

        function isNotAroundZero(val) {
            var EPSILON = 5e-5;
            return val > EPSILON || val < -EPSILON;
        }
    }


    /**
     * @function LevelRenderer.Transformable.prototype.updateTransform
     * @description å¤æ­æ¯å¦éè¦æåæ åæ¢ï¼æ´æ° needTransform å±æ§ãå¦ææåæ åæ¢, åä» position, rotation, scale ä»¥åç¶èç¹ç transform è®¡ç®åºèªèº«ç transform ç©éµ
     */
    updateTransform() {
        this.updateNeedTransform();

        if (this.parent) {
            this.needTransform = this.needLocalTransform || this.parent.needTransform;
        } else {
            this.needTransform = this.needLocalTransform;
        }

        if (!this.needTransform) {
            return;
        }

        var origin = [0, 0];

        var m = this.transform || SUtil_SUtil.Util_matrix.create();
        SUtil_SUtil.Util_matrix.identity(m);

        if (this.needLocalTransform) {
            if (
                isNotAroundZero(this.scale[0])
                || isNotAroundZero(this.scale[1])
            ) {
                origin[0] = -this.scale[2] || 0;
                origin[1] = -this.scale[3] || 0;
                let haveOrigin = isNotAroundZero(origin[0])
                    || isNotAroundZero(origin[1]);
                if (haveOrigin) {
                    SUtil_SUtil.Util_matrix.translate(
                        m, m, origin
                    );
                }
                SUtil_SUtil.Util_matrix.scale(m, m, this.scale);
                if (haveOrigin) {
                    origin[0] = -origin[0];
                    origin[1] = -origin[1];
                    SUtil_SUtil.Util_matrix.translate(
                        m, m, origin
                    );
                }
            }

            if (this.rotation instanceof Array) {
                if (this.rotation[0] !== 0) {
                    origin[0] = -this.rotation[1] || 0;
                    origin[1] = -this.rotation[2] || 0;
                    let haveOrigin = isNotAroundZero(origin[0])
                        || isNotAroundZero(origin[1]);
                    if (haveOrigin) {
                        SUtil_SUtil.Util_matrix.translate(
                            m, m, origin
                        );
                    }
                    SUtil_SUtil.Util_matrix.rotate(m, m, this.rotation[0]);
                    if (haveOrigin) {
                        origin[0] = -origin[0];
                        origin[1] = -origin[1];
                        SUtil_SUtil.Util_matrix.translate(
                            m, m, origin
                        );
                    }
                }
            } else {
                if (+this.rotation !== 0) {
                    SUtil_SUtil.Util_matrix.rotate(m, m, this.rotation);
                }
            }

            if (
                isNotAroundZero(this.position[0]) || isNotAroundZero(this.position[1])
            ) {
                SUtil_SUtil.Util_matrix.translate(m, m, this.position);
            }
        }

        // ä¿å­è¿ä¸ªåæ¢ç©éµ
        this.transform = m;

        // åºç¨ç¶èç¹åæ¢
        if (this.parent && this.parent.needTransform) {
            if (this.needLocalTransform) {
                SUtil_SUtil.Util_matrix.mul(this.transform, this.parent.transform, this.transform);
            } else {
                SUtil_SUtil.Util_matrix.copy(this.transform, this.parent.transform);
            }
        }

        function isNotAroundZero(val) {
            var EPSILON = 5e-5;
            return val > EPSILON || val < -EPSILON;
        }
    }


    /**
     * @function LevelRenderer.Transformable.prototype.setTransform
     * @description å°èªå·±ç transform åºç¨å° context ä¸ã
     *
     * @param {Context2D} ctx - Context2D ä¸ä¸æã
     */
    setTransform(ctx) {
        if (this.needTransform) {
            var m = this.transform;
            ctx.transform(
                m[0], m[1],
                m[2], m[3],
                m[4], m[5]
            );
        }
    }



    /**
     * @function LevelRenderer.Transformable.prototype.decomposeTransform
     * @description åè§£`transform`ç©éµå°`position`, `rotation`, `scale` ã
     */
    decomposeTransform() {
        if (!this.transform) {
            return;
        }
        var m = this.transform;
        var sx = m[0] * m[0] + m[1] * m[1];
        var position = this.position;
        var scale = this.scale;
        var rotation = this.rotation;
        if (isNotAroundZero(sx - 1)) {
            sx = Math.sqrt(sx);
        }
        var sy = m[2] * m[2] + m[3] * m[3];
        if (isNotAroundZero(sy - 1)) {
            sy = Math.sqrt(sy);
        }
        position[0] = m[4];
        position[1] = m[5];
        scale[0] = sx;
        scale[1] = sy;
        scale[2] = scale[3] = 0;
        rotation[0] = Math.atan2(-m[1] / sy, m[0] / sx);
        rotation[1] = rotation[2] = 0;

        function isNotAroundZero(val) {
            var EPSILON = 5e-5;
            return val > EPSILON || val < -EPSILON;
        }
    }

}

;// CONCATENATED MODULE: ./src/common/overlay/levelRenderer/Shape.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/






/**
 * @private
 * @class  LevelRenderer.Shape
 * @category Visualization Theme
 * @classdesc å¾å½¢ï¼shapeï¼åºç±»ã
 * @extends LevelRenderer.Eventful
 * @extends LevelRenderer.Transformable
 * @param {Array} options - shape çéç½®ï¼optionsï¼é¡¹ï¼å¯ä»¥æ¯ shape çèªæå±æ§ï¼ä¹å¯ä»¥æ¯èªå®ä¹çå±æ§ã
 */
class Shape_Shape extends mixinExt(Eventful, Transformable) {
    constructor(options) {
        super(options);

        options = options || {};
        /**
         * @member {string} LevelRenderer.Shape.prototype.id
         * @description å¯ä¸æ è¯ã
         */
        this.id = null;

        /**
         * @member {Object} LevelRenderer.Shape.prototype.style
         * @description åºç¡ç»å¶æ ·å¼ã
         * @param {string} style.brushType - ç»ç¬ç±»åãå¯è®¾å¼ï¼"fill", "stroke", "both"ãé»è®¤å¼ï¼"fill"ã
         * @param {string} style.color - å¡«åé¢è²ãé»è®¤å¼ï¼"#000000'"ã
         * @param {string} style.strokeColor - æè¾¹é¢è²ãé»è®¤å¼ï¼"#000000'"ã
         * @param {string} style.lineCape - çº¿å¸½æ ·å¼ãå¯è®¾å¼ï¼"butt", "round", "square"ãé»è®¤å¼ï¼"butt"ã
         * @param {number} style.lineWidth - æè¾¹å®½åº¦ãé»è®¤å¼ï¼1ã
         * @param {number} style.opacity - ç»å¶éæåº¦ãé»è®¤å¼ï¼1ã
         * @param {number} style.shadowBlur - é´å½±æ¨¡ç³åº¦ï¼å¤§äº0ææãé»è®¤å¼ï¼0ã
         * @param {number} style.shadowColor - é´å½±é¢è²ãé»è®¤å¼ï¼"#000000'"ã
         * @param {number} style.shadowOffsetX - é´å½±æ¨ªååç§»ãé»è®¤å¼ï¼0ã
         * @param {number} style.shadowOffsetY -  é´å½±çºµååç§»ãé»è®¤å¼ï¼0ã
         * @param {string} style.text -  å¾å½¢ä¸­çéå ææ¬ãé»è®¤å¼ï¼""ã
         * @param {string} style.textColor -  ææ¬é¢è²ãé»è®¤å¼ï¼"#000000'"ã
         * @param {string} style.textFont -  éå ææ¬æ ·å¼ãç¤ºä¾:'bold 18px verdana'ã
         * @param {string} style.textPosition -  éå ææ¬ä½ç½®ãå¯è®¾å¼ï¼"inside", "left", "right", top", "bottom", "end"ãé»è®¤å¼ï¼"end"ã
         * @param {string} style.textAlign -  éå ææ¬æ°´å¹³å¯¹é½ãå¯è®¾å¼ï¼"start", "end", "left", "right", "center"ãé»è®¤æ ¹æ® textPosition èªå¨è®¾ç½®ã
         * @param {string} style.textBaseline - éå ææ¬åç´å¯¹é½ãå¯è®¾å¼ï¼"top", "bottom", "middle", "alphabetic", "hanging", "ideographic"ãé»è®¤æ ¹æ® textPosition èªå¨è®¾ç½®ã
         *
         */
        this.style = {};

        /**
         * @member {Object} LevelRenderer.Shape.prototype.style.__rect
         * @description åå´å¾å½¢çæå°ç©å½¢çå­ã
         *
         * @param {number} x - å·¦ä¸è§é¡¶ç¹xè½´åæ ã
         * @param {number} y - å·¦ä¸è§é¡¶ç¹yè½´åæ ã
         * @param {number} width - åå´çç©å½¢å®½åº¦ã
         * @param {number} height - åå´çç©å½¢é«åº¦ã
         */

        /**
         * @member {Object} LevelRenderer.Shape.prototype.highlightStyle
         * @description é«äº®æ ·å¼ã
         *
         * @param {string} highlightStyle.brushType - ç»ç¬ç±»åãå¯è®¾å¼ï¼"fill", "stroke", "both"ãé»è®¤å¼ï¼"fill"ã
         * @param {string} highlightStyle.color -  å¡«åé¢è²ãé»è®¤å¼ï¼"#000000'"ã
         * @param {string} highlightStyle.strokeColor - æè¾¹é¢è²ãé»è®¤å¼ï¼"#000000'"ã
         * @param {string} highlightStyle.lineCape - çº¿å¸½æ ·å¼ãå¯è®¾å¼ï¼"butt", "round", "square"ãé»è®¤å¼ï¼"butt"ã
         * @param {number} highlightStyle.lineWidth - æè¾¹å®½åº¦ãé»è®¤å¼ï¼1ã
         * @param {number} highlightStyle.opacity -  ç»å¶éæåº¦ãé»è®¤å¼ï¼1ã
         * @param {number} highlightStyle.shadowBlur - é´å½±æ¨¡ç³åº¦ï¼å¤§äº0ææãé»è®¤å¼ï¼0ã
         * @param {number} highlightStyle.shadowColor - é´å½±é¢è²ãé»è®¤å¼ï¼"#000000'"ã
         * @param {number} highlightStyle.shadowOffsetX - é´å½±æ¨ªååç§»ãé»è®¤å¼ï¼0ã
         * @param {number} highlightStyle.shadowOffsetY - é´å½±çºµååç§»ãé»è®¤å¼ï¼0ã
         * @param {string} highlightStyle.text - å¾å½¢ä¸­çéå ææ¬ãé»è®¤å¼ï¼""ã
         * @param {string} highlightStyle.textColor - ææ¬é¢è²ãé»è®¤å¼ï¼"#000000'"ã
         * @param {string} highlightStyle.textFont - éå ææ¬æ ·å¼ãç¤ºä¾:'bold 18px verdana'ã
         * @param {string} highlightStyle.textPosition - éå ææ¬ä½ç½®ãå¯è®¾å¼ï¼"inside", "left", "right", top", "bottom", "end"ãé»è®¤å¼ï¼"end"ã
         * @param {string} highlightStyle.textAlign -  éå ææ¬æ°´å¹³å¯¹é½ãå¯è®¾å¼ï¼"start", "end", "left", "right", "center"ãé»è®¤æ ¹æ® textPosition èªå¨è®¾ç½®ã
         * @param {string} highlightStyle.textBaseline - éå ææ¬åç´å¯¹é½ãå¯è®¾å¼ï¼"top", "bottom", "middle", "alphabetic", "hanging", "ideographic"ãé»è®¤æ ¹æ® textPosition èªå¨è®¾ç½®ã
         */
        this.highlightStyle = null;

        /**
         * @member {Object} LevelRenderer.Shape.prototype.parent
         * @description ç¶èç¹ï¼åªè¯»å±æ§ã<LevelRenderer.Group>
         */
        this.parent = null;

        /**
         * @member {boolean} LevelRenderer.Shape.prototype.__dirty
         * @description {boolean}
         */
        this.__dirty = true;

        /**
         * @member {Array} LevelRenderer.Shape.prototype.__clipShapes
         * @description {Array}
         *
         */
        this.__clipShapes = [];

        /**
         * @member {boolean} LevelRenderer.Shape.prototype.invisible
         * @description å¾å½¢æ¯å¦å¯è§ï¼ä¸º true æ¶ä¸ç»å¶å¾å½¢ï¼ä½æ¯ä»è½è§¦åé¼ æ äºä»¶ãé»è®¤å¼ï¼falseã
         */
        this.invisible = false;

        /**
         * @member {boolean} LevelRenderer.Shape.prototype.ignore
         * @description å¾å½¢æ¯å¦å¿½ç¥ï¼ä¸º true æ¶å¿½ç¥å¾å½¢çç»å¶ä»¥åäºä»¶è§¦åãé»è®¤å¼ï¼falseã
         */
        this.ignore = false;

        /**
         * @member {boolean} LevelRenderer.Shape.prototype.zlevel
         * @description z å± levelï¼å³å®ç»ç»å¨åªå± canvas ä¸­ãé»è®¤å¼ï¼0ã
         */
        this.zlevel = 0;

        /**
         * @member {boolean} LevelRenderer.Shape.prototype.draggable
         * @description æ¯å¦å¯ææ½ãé»è®¤å¼ï¼falseã
         */
        this.draggable = false;

        /**
         * @member {boolean} LevelRenderer.Shape.prototype.clickable
         * @description æ¯å¦å¯ç¹å»ãé»è®¤å¼ï¼falseã
         */
        this.clickable = false;

        /**
         * @member {boolean} LevelRenderer.Shape.prototype.hoverable
         * @description æ¯å¦å¯ä»¥ hoverãé»è®¤å¼ï¼trueã
         */
        this.hoverable = true;

        /**
         * @member {number} LevelRenderer.Shape.prototype.z
         * @description zå¼ï¼è·zlevelä¸æ ·å½±åshapeç»å¶çååé¡ºåºï¼zå¼å¤§çshapeä¼è¦çå¨zå¼å°çä¸é¢ï¼ä½æ¯å¹¶ä¸ä¼åå»ºæ°çcanvasï¼æä»¥ä¼åçº§ä½äºzlevelï¼èä¸é¢ç¹æ¹å¨çå¼éæ¯zlevelå°å¾å¤ãé»è®¤å¼ï¼0ã
         */
        this.z = 0;

        //å°çæ©å±
        /**
         * @member {Array.<number>} LevelRenderer.Shape.prototype.refOriginalPosition
         * @description å¾å½¢åèåç¹ä½ç½®ï¼å¾å½¢çåèä¸­å¿ä½ç½®ã
         * refOriginalPosition æ¯é¿åº¦ä¸º 2 çæ°ç»ï¼ç¬¬ä¸ä¸ªåç´ è¡¨ç¤º x åæ ï¼ç¬¬äºä¸ªåç´ è¡¨ç¤º y åæ ã
         *
         * refOriginalPosition è¡¨ç¤ºå¾å½¢çåèä¸­å¿ï¼éå¸¸æåµä¸ï¼å¾å½¢æ¯ä½¿ç¨ canvas çåç¹ä½ç½®ä½ä¸ºä½ç½®åèï¼
         * ä½ refOriginalPosition å¯ä»¥æ¹åå¾å½¢çåèä½ç½®ï¼ä¾å¦ï¼ refOriginalPosition = [80, 80],
         * å¾å½¢åç style.x = 20, style.y = 20ï¼é£ä¹åå¨ canvas ä¸­çå®éä½ç½®æ¯ [100, 100]ã
         *
         * å¾å½¢ï¼Shapeï¼ çææä½ç½®ç¸å³å±æ§é½æ¯ä»¥ refOriginalPosition ä¸ºåèä¸­å¿ï¼
         * ä¹å°±æ¯è¯´å¾å½¢çææä½ç½®ä¿¡æ¯å¨ canvas ä¸­é½æ¯ä»¥ refOriginalPosition ä¸ºåèçç¸å¯¹ä½ç½®ï¼åªæ
         * refOriginalPosition çå¼ä¸º [0, 0] æ¶ï¼å½¢çä½ç½®ä¿¡æ¯ææ¯ canvas ç»å¯¹ä½ç½®ã
         *
         * å¾å½¢çä½ç½®ä¿¡æ¯éå¸¸æï¼style.pointListï¼style.xï¼style.yã
         *
         * refOriginalPositionãé»è®¤å¼æ¯ï¼ [0, 0]ã
         */
        this.refOriginalPosition = [0, 0];

        /**
         * @member {string} LevelRenderer.Shape.prototype.refDataID
         * @description å¾å½¢æå³èæ°æ®ç IDã
         *
         */
        this.refDataID = null;

        /**
         * @member {boolean} LevelRenderer.Shape.prototype.isHoverByRefDataID
         * @description æ¯å¦æ ¹æ® refDataID è¿è¡é«äº®ãç¨äºåæ¶é«äº®ææ refDataID ç¸åçå¾å½¢ã
         *
         */
        this.isHoverByRefDataID = false;

        /**
         *  @member {string} LevelRenderer.Shape.prototype.refDataHoverGroup
         *  @description é«äº®å¾å½¢ç»çç»åãæ­¤å±æ§å¨ refDataID ææä¸ isHoverByRefDataID ä¸º true æ¶çæã
         * ä¸æ¦è®¾ç½®æ­¤å±æ§ï¼ä¸å±æ§å¼ææï¼åªæå³èåä¸ä¸ªæ°æ®çå¾å½¢ä¸æ­¤å±æ§ç¸åçå¾å½¢æä¼é«äº®ã
         *
         */
        this.refDataHoverGroup = null;

        /**
         * @member {Object} LevelRenderer.Shape.prototype.dataInfo
         * @description å¾å½¢çæ°æ®ä¿¡æ¯ã
         *
         */
        this.dataInfo = null;
        Util.extend(this, options);
        this.id = this.id  || Util.createUniqueID("smShape_");
        this.CLASS_NAME = "SuperMap.LevelRenderer.Shape";
        /**
         * @function LevelRenderer.Shape.prototype.getTansform
         * @description åæ¢é¼ æ ä½ç½®å° shape çå±é¨åæ ç©ºé´
         *
         */
        this.getTansform = (function () {
            var invTransform = [];

            return function (x, y) {
                var originPos = [x, y];
                // å¯¹é¼ æ çåæ ä¹åç¸åçåæ¢
                if (this.needTransform && this.transform) {
                    SUtil_SUtil.Util_matrix.invert(invTransform, this.transform);

                    SUtil_SUtil.Util_matrix.mulVector(originPos, invTransform, [x, y, 1]);

                    if (x == originPos[0] && y == originPos[1]) {
                        // é¿åå¤é¨ä¿®æ¹å¯¼è´ç needTransform ä¸åç¡®
                        this.updateNeedTransform();
                    }
                }
                return originPos;
            };
        })();

    }


    /**
     * @function LevelRenderer.Shape.prototype.destroy
     * @description éæ¯å¯¹è±¡ï¼éæ¾èµæºãè°ç¨æ­¤å½æ°åææå±æ§å°è¢«ç½®ä¸º nullã
     */
    destroy() {
        this.id = null;
        this.style = null;
        this.highlightStyle = null;
        this.parent = null;
        this.__dirty = null;
        this.__clipShapes = null;
        this.invisible = null;
        this.ignore = null;
        this.zlevel = null;
        this.draggable = null;
        this.clickable = null;
        this.hoverable = null;
        this.z = null;

        this.refOriginalPosition = null;
        this.refDataID = null;
        this.refDataHoverGroup = null;
        this.isHoverByRefDataID = null;
        this.dataInfo = null;
        super.destroy();
    }


    /**
     * @function LevelRenderer.Shape.prototype.brush
     * @description ç»å¶å¾å½¢ã
     *
     * @param {CanvasRenderingContext2D} ctx - Context2D ä¸ä¸æã
     * @param {boolean} isHighlight - æ¯å¦ä½¿ç¨é«äº®å±æ§ã
     * @param {function} updateCallback - éè¦å¼æ­¥å è½½èµæºç shape å¯ä»¥éè¿è¿ä¸ª callback(e),è®©painteræ´æ°è§å¾ï¼base.brush æ²¡ç¨ï¼éè¦çè¯éè½½ brushã
     */
    brush(ctx, isHighlight) {

        var style = this.beforeBrush(ctx, isHighlight);

        ctx.beginPath();
        this.buildPath(ctx, style);

        switch (style.brushType) {
            /* jshint ignore:start */
            case 'both':
                this.setCtxGlobalAlpha(ctx, "fill", style);
                ctx.fill();
                if (style.lineWidth > 0) {
                    this.setCtxGlobalAlpha(ctx, "stroke", style);
                    ctx.stroke();
                }
                this.setCtxGlobalAlpha(ctx, "reset", style);
                break;
            case 'stroke':
                this.setCtxGlobalAlpha(ctx, "stroke", style);
                style.lineWidth > 0 && ctx.stroke();
                this.setCtxGlobalAlpha(ctx, "reset", style);
                break;
            /* jshint ignore:end */
            default:
                this.setCtxGlobalAlpha(ctx, "fill", style);
                ctx.fill();
                this.setCtxGlobalAlpha(ctx, "reset", style);
                break;
        }

        this.drawText(ctx, style, this.style);

        this.afterBrush(ctx);
    }


    /**
     * @function LevelRenderer.Shape.prototype.beforeBrush
     * @description å·ä½ç»å¶æä½åçä¸äºå¬å±æä½ã
     *
     * @param {CanvasRenderingContext2D} ctx - Context2D ä¸ä¸æã
     * @param {boolean} isHighlight - æ¯å¦ä½¿ç¨é«äº®å±æ§ã
     * @return {Object} å¤çåçæ ·å¼ã
     */
    beforeBrush(ctx, isHighlight) {
        var style = this.style;

        if (this.brushTypeOnly) {
            style.brushType = this.brushTypeOnly;
        }

        if (isHighlight) {
            // æ ¹æ®styleæ©å±é»è®¤é«äº®æ ·å¼
            style = this.getHighlightStyle(
                style,
                this.highlightStyle || {},
                this.brushTypeOnly
            );
        }

        if (this.brushTypeOnly == 'stroke') {
            style.strokeColor = style.strokeColor || style.color;
        }

        ctx.save();

        this.doClip(ctx);

        this.setContext(ctx, style);

        // è®¾ç½®transform
        this.setTransform(ctx);

        return style;
    }


    /**
     * @function LevelRenderer.Shape.prototype.afterBrush
     * @description ç»å¶åçå¤çã
     *
     * @param {CanvasRenderingContext2D} ctx - Context2D ä¸ä¸æã
     *
     */
    afterBrush(ctx) {
        ctx.restore();
    }


    /**
     * @function LevelRenderer.Shape.prototype.setContext
     * @description è®¾ç½® fillStyle, strokeStyle, shadow ç­éç¨ç»å¶æ ·å¼ã
     *
     * @param {CanvasRenderingContext2D} ctx - Context2D ä¸ä¸æã
     * @param {Object} style - æ ·å¼ã
     *
     */
    setContext(ctx, style) {
        var STYLE_CTX_MAP = [
            ['color', 'fillStyle'],
            ['strokeColor', 'strokeStyle'],
            ['opacity', 'globalAlpha'],
            ['lineCap', 'lineCap'],
            ['lineJoin', 'lineJoin'],
            ['miterLimit', 'miterLimit'],
            ['lineWidth', 'lineWidth'],
            ['shadowBlur', 'shadowBlur'],
            ['shadowColor', 'shadowColor'],
            ['shadowOffsetX', 'shadowOffsetX'],
            ['shadowOffsetY', 'shadowOffsetY']
        ];

        for (var i = 0, len = STYLE_CTX_MAP.length; i < len; i++) {
            var styleProp = STYLE_CTX_MAP[i][0];
            var styleValue = style[styleProp];
            var ctxProp = STYLE_CTX_MAP[i][1];

            if (typeof styleValue != 'undefined') {
                ctx[ctxProp] = styleValue;
            }
        }
    }


    /**
     * @function LevelRenderer.Shape.prototype.doClip
     *
     */
    doClip(ctx) {
        var clipShapeInvTransform = SUtil_SUtil.Util_matrix.create();

        if (this.__clipShapes) {
            for (var i = 0; i < this.__clipShapes.length; i++) {
                var clipShape = this.__clipShapes[i];
                if (clipShape.needTransform) {
                    let m = clipShape.transform;
                    SUtil_SUtil.Util_matrix.invert(clipShapeInvTransform, m);
                    ctx.transform(
                        m[0], m[1],
                        m[2], m[3],
                        m[4], m[5]
                    );
                }
                ctx.beginPath();
                clipShape.buildPath(ctx, clipShape.style);
                ctx.clip();
                // Transform back
                if (clipShape.needTransform) {
                    let m = clipShapeInvTransform;
                    ctx.transform(
                        m[0], m[1],
                        m[2], m[3],
                        m[4], m[5]
                    );
                }
            }
        }
    }


    /**
     * @function LevelRenderer.Shape.prototype.getHighlightStyle
     * @description æ ¹æ®é»è®¤æ ·å¼æ©å±é«äº®æ ·å¼
     *
     * @param {Object} style - æ ·å¼ã
     * @param {Object} highlightStyle - é«äº®æ ·å¼ã
     * @param {string} brushTypeOnly - brushTypeOnlyã
     *
     */
    getHighlightStyle(style, highlightStyle, brushTypeOnly) {
        var newStyle = {};
        for (let k in style) {
            newStyle[k] = style[k];
        }

        var highlightColor = SUtil_SUtil.Util_color.getHighlightColor();
        // æ ¹æ®highlightStyleæ©å±
        if (style.brushType != 'stroke') {
            // å¸¦å¡«ååç¨é«äº®è²å ç²è¾¹çº¿
            newStyle.strokeColor = highlightColor;
            // SMIC-æ¹æ³ä¿®æ¹ - start
            newStyle.lineWidth = (style.lineWidth || 1);
            // åå§ä»£ç 
            //      newStyle.lineWidth = (style.lineWidth || 1)
            //          + this.getHighlightZoom();
            // ä¿®æ¹ä»£ç 1
            // if(!style.lineType || style.lineType === "solid"){
            //     newStyle.lineWidth = (style.lineWidth || 1)
            //         + this.getHighlightZoom();
            // }
            // else{
            //     newStyle.lineWidth = (style.lineWidth || 1);
            // }
            // SMIC-æ¹æ³ä¿®æ¹ - end
            newStyle.brushType = 'both';
        } else {
            if (brushTypeOnly != 'stroke') {
                // æè¾¹åçåç¨åè²å å·¥é«äº®
                newStyle.strokeColor = highlightColor;
                // SMIC-æ¹æ³ä¿®æ¹ - start
                newStyle.lineWidth = (style.lineWidth || 1);
                // åå§ä»£ç 
                //      newStyle.lineWidth = (style.lineWidth || 1)
                //          + this.getHighlightZoom();
                // ä¿®æ¹ä»£ç 1
                // if(!style.lineType || style.lineType === "solid"){
                //     newStyle.lineWidth = (style.lineWidth || 1)
                //         + this.getHighlightZoom();
                // }
                // else{
                //     newStyle.lineWidth = (style.lineWidth || 1);
                // }
                // SMIC-æ¹æ³ä¿®æ¹ - end
            } else {
                // çº¿åçåç¨åè²å å·¥é«äº®
                newStyle.strokeColor = highlightStyle.strokeColor
                    || SUtil_SUtil.Util_color.mix(
                        style.strokeColor,
                        SUtil_SUtil.Util_color.toRGB(highlightColor)
                    );
            }
        }

        // å¯èªå®ä¹è¦çé»è®¤å¼
        for (let k in highlightStyle) {
            if (typeof highlightStyle[k] != 'undefined') {
                newStyle[k] = highlightStyle[k];
            }
        }

        return newStyle;
    }


    /**
     * @function LevelRenderer.Shape.prototype.getHighlightZoom
     * @description é«äº®æ¾å¤§ææåæ°ï¼å½åç»ä¸è®¾ç½®ä¸º6ï¼å¦æéè¦å·®å¼è®¾ç½®ï¼éè¿ this.type å¤æ­å®ä¾ç±»å
     *
     */
    getHighlightZoom() {
        return this.type != 'text' ? 6 : 2;
    }


    /**
     * @function LevelRenderer.Shape.prototype.drift
     * @description ç§»å¨ä½ç½®
     *
     * @param {Object} dx - æ¨ªåæ ååã
     * @param {Object} dy - çºµåæ ååã
     *
     */
    drift(dx, dy) {
        this.position[0] += dx;
        this.position[1] += dy;
    }




    /**
     * @function LevelRenderer.Shape.prototype.buildPath
     * @description æå»ºç»å¶çPathãå­ç±»å¿é¡»éæ°å®ç°æ­¤æ¹æ³ã
     *
     * @param {CanvasRenderingContext2D} ctx - Context2D ä¸ä¸æã
     * @param {Object} style - æ ·å¼ã
     */
    buildPath(ctx, style) { // eslint-disable-line no-unused-vars
        SUtil_SUtil.Util_log('buildPath not implemented in ' + this.type);
    }


    /**
     * @function LevelRenderer.Shape.prototype.getRect
     * @description è®¡ç®è¿ååå´çç©å½¢ãå­ç±»å¿é¡»éæ°å®ç°æ­¤æ¹æ³ã
     *
     * @param {Object} style - æ ·å¼ã
     */
    getRect(style) { // eslint-disable-line no-unused-vars
        SUtil_SUtil.Util_log('getRect not implemented in ' + this.type);
    }


    /**
     * @function LevelRenderer.Shape.prototype.isCover
     * @description å¤æ­é¼ æ ä½ç½®æ¯å¦å¨å¾å½¢åã
     *
     * @param {number} x - xã
     * @param {number} y - yã
     */
    isCover(x, y) {
        var originPos = this.getTansform(x, y);
        x = originPos[0];
        y = originPos[1];

        // å¿«éé¢å¤å¹¶ä¿çå¤æ­ç©å½¢
        var rect = this.style.__rect;
        if (!rect) {
            rect = this.style.__rect = this.getRect(this.style);
        }

        if (x >= rect.x
            && x <= (rect.x + rect.width)
            && y >= rect.y
            && y <= (rect.y + rect.height)
        ) {
            // ç©å½¢å
            return SUtil_SUtil.Util_area.isInside(this, this.style, x, y);
        }

        return false;
    }


    /**
     * @function LevelRenderer.Shape.prototype.drawText
     * @description ç»å¶éå ææ¬ã
     *
     * @param {CanvasRenderingContext2D} ctx - Context2D ä¸ä¸æã
     * @param {string} style - æ ·å¼ã
     * @param {string} normalStyle - normalStyle é»è®¤æ ·å¼ï¼ç¨äºå®ä½æå­æ¾ç¤ºã
     */
    drawText(ctx, style, normalStyle) {
        if (typeof(style.text) == 'undefined' || style.text === false) {
            return;
        }
        // å­ä½é¢è²ç­ç¥
        var textColor = style.textColor || style.color || style.strokeColor;
        ctx.fillStyle = textColor;

        // ææ¬ä¸å¾å½¢é´ç©ºç½é´é
        var dd = 10;
        var al;         // ææ¬æ°´å¹³å¯¹é½
        var bl;         // ææ¬åç´å¯¹é½
        var tx;         // ææ¬æ¨ªåæ 
        var ty;         // ææ¬çºµåæ 

        var textPosition = style.textPosition       // ç¨æ·å®ä¹
            || this.textPosition     // shapeé»è®¤
            || 'top';                // å¨å±é»è®¤

        // Smic æ¹æ³ä¿®æ¹ -start
        var __OP = [];
        if (!this.refOriginalPosition || this.refOriginalPosition.length !== 2) {
            __OP = [0, 0];
        } else {
            __OP = this.refOriginalPosition;
        }
        //åä»£ç ï¼
        // Smic æ¹æ³ä¿®æ¹ -end

        switch (textPosition) {
            case 'inside':
            case 'top':
            case 'bottom':
            case 'left':
            case 'right':
                if (this.getRect) {
                    var rect = (normalStyle || style).__rect
                        || this.getRect(normalStyle || style);

                    switch (textPosition) {
                        case 'inside':
                            tx = rect.x + rect.width / 2;
                            ty = rect.y + rect.height / 2;
                            al = 'center';
                            bl = 'middle';
                            if (style.brushType != 'stroke'
                                && textColor == style.color
                            ) {
                                ctx.fillStyle = '#fff';
                            }
                            break;
                        case 'left':
                            tx = rect.x - dd;
                            ty = rect.y + rect.height / 2;
                            al = 'end';
                            bl = 'middle';
                            break;
                        case 'right':
                            tx = rect.x + rect.width + dd;
                            ty = rect.y + rect.height / 2;
                            al = 'start';
                            bl = 'middle';
                            break;
                        case 'top':
                            tx = rect.x + rect.width / 2;
                            ty = rect.y - dd;
                            al = 'center';
                            bl = 'bottom';
                            break;
                        case 'bottom':
                            tx = rect.x + rect.width / 2;
                            ty = rect.y + rect.height + dd;
                            al = 'center';
                            bl = 'top';
                            break;
                    }
                }
                break;
            case 'start':
            case 'end':
                var xStart = 0;
                var xEnd = 0;
                var yStart = 0;
                var yEnd = 0;
                if (typeof style.pointList != 'undefined') {
                    var pointList = style.pointList;
                    if (pointList.length < 2) {
                        // å°äº2ä¸ªç¹å°±ä¸ç»äº~
                        return;
                    }
                    var length = pointList.length;
                    switch (textPosition) {
                        // Smic æ¹æ³ä¿®æ¹ -start
                        case 'start':
                            xStart = pointList[0][0] + __OP[0];
                            xEnd = pointList[1][0] + __OP[0];
                            yStart = pointList[0][1] + __OP[1];
                            yEnd = pointList[1][1] + __OP[1];
                            break;
                        case 'end':
                            xStart = pointList[length - 2][0] + __OP[0];
                            xEnd = pointList[length - 1][0] + __OP[0];
                            yStart = pointList[length - 2][1] + __OP[1];
                            yEnd = pointList[length - 1][1] + __OP[1];
                            break;
                        //åä»£ç ï¼
                        /*
                         case 'start':
                         xStart = pointList[0][0];
                         xEnd = pointList[1][0];
                         yStart = pointList[0][1];
                         yEnd = pointList[1][1];
                         break;
                         case 'end':
                         xStart = pointList[length - 2][0];
                         xEnd = pointList[length - 1][0];
                         yStart = pointList[length - 2][1];
                         yEnd = pointList[length - 1][1];
                         break;
                         */
                        // Smic æ¹æ³ä¿®æ¹ -end
                    }
                } else {
                    // Smic æ¹æ³ä¿®æ¹ -start
                    xStart = (style.xStart + __OP[0]) || 0;
                    xEnd = (style.xEnd + __OP[0]) || 0;
                    yStart = (style.yStart + __OP[1]) || 0;
                    yEnd = (style.yEnd + __OP[1]) || 0;
                    //åä»£ç ï¼
                    /*
                     xStart = style.xStart || 0;
                     xEnd = style.xEnd || 0;
                     yStart = style.yStart || 0;
                     yEnd = style.yEnd || 0;
                     */
                    // Smic æ¹æ³ä¿®æ¹ -end
                }

                switch (textPosition) {
                    case 'start':
                        al = xStart < xEnd ? 'end' : 'start';
                        bl = yStart < yEnd ? 'bottom' : 'top';
                        tx = xStart;
                        ty = yStart;
                        break;
                    case 'end':
                        al = xStart < xEnd ? 'start' : 'end';
                        bl = yStart < yEnd ? 'top' : 'bottom';
                        tx = xEnd;
                        ty = yEnd;
                        break;
                }
                dd -= 4;
                if (xStart && xEnd && xStart != xEnd) {
                    tx -= (al == 'end' ? dd : -dd);
                } else {
                    al = 'center';
                }

                if (yStart != yEnd) {
                    ty -= (bl == 'bottom' ? dd : -dd);
                } else {
                    bl = 'middle';
                }
                break;
            case 'specific':
                tx = style.textX || 0;
                ty = style.textY || 0;
                al = 'start';
                bl = 'middle';
                break;
        }

        // Smic æ¹æ³ä¿®æ¹ -start
        if (style.labelXOffset && !isNaN(style.labelXOffset)) {
            tx += style.labelXOffset;
        }
        if (style.labelYOffset && !isNaN(style.labelYOffset)) {
            ty += style.labelYOffset;
        }
        //åä»£ç ï¼
        // Smic æ¹æ³ä¿®æ¹ -end

        if (tx != null && ty != null) {
            Shape_Shape._fillText(
                ctx,
                style.text,
                tx, ty,
                style.textFont,
                style.textAlign || al,
                style.textBaseline || bl
            );
        }
    }


    /**
     * @function LevelRenderer.Shape.prototype.modSelf
     * @description å¾å½¢åçæ¹å
     */
    modSelf() {
        this.__dirty = true;
        if (this.style) {
            this.style.__rect = null;
        }
        if (this.highlightStyle) {
            this.highlightStyle.__rect = null;
        }
    }


    /**
     * @function LevelRenderer.Shape.prototype.isSilent
     * @description å¾å½¢æ¯å¦ä¼è§¦åäºä»¶ï¼éè¿ bind ç»å®çäºä»¶
     */
    isSilent() {
        return !(
            this.hoverable || this.draggable || this.clickable
            || this.onmousemove || this.onmouseover || this.onmouseout
            || this.onmousedown || this.onmouseup || this.onclick
            || this.ondragenter || this.ondragover || this.ondragleave
            || this.ondrop
        );
    }


    /**
     * @function LevelRenderer.Shape.prototype.setCtxGlobalAlpha
     * @description è®¾ç½® Cavans ä¸ä¸æå¨å±éæåº¦
     *
     * @param {Object} _ctx - Cavans ä¸ä¸æ
     * @param {string} type - one of 'stroke', 'fill', or 'reset'
     * @param {Object} style - Symbolizer hash
     */
    setCtxGlobalAlpha(_ctx, type, style) {
        if (type === "fill") {
            _ctx.globalAlpha = typeof(style["fillOpacity"]) === "undefined" ? (typeof(style["opacity"]) === "undefined" ? 1 : style['opacity']) : style['fillOpacity'];
        } else if (type === "stroke") {
            _ctx.globalAlpha = typeof(style["strokeOpacity"]) === "undefined" ? (typeof(style["opacity"]) === "undefined" ? 1 : style['opacity']) : style['strokeOpacity'];
        } else {
            _ctx.globalAlpha = typeof(style["opacity"]) === "undefined" ? 1 : style['opacity'];
        }
    }

    /**
     * @function LevelRenderer.Shape.prototype._fillText
     * @description å¡«åææ¬
     */
    static _fillText(ctx, text, x, y, textFont, textAlign, textBaseline) {
        if (textFont) {
            ctx.font = textFont;
        }
        ctx.textAlign = textAlign;
        ctx.textBaseline = textBaseline;
        var rect = Shape_Shape._getTextRect(
            text, x, y, textFont, textAlign, textBaseline
        );

        text = (text + '').split('\n');

        var lineHeight = SUtil_SUtil.Util_area.getTextHeight('ZH', textFont);

        switch (textBaseline) {
            case 'top':
                y = rect.y;
                break;
            case 'bottom':
                y = rect.y + lineHeight;
                break;
            default:
                y = rect.y + lineHeight / 2;
        }

        for (var i = 0, l = text.length; i < l; i++) {
            ctx.fillText(text[i], x, y);
            y += lineHeight;
        }
    }

    /**
     * @function LevelRenderer.Shape._getTextRect
     * @description è¿åç©å½¢åºåï¼ç¨äºå±é¨å·æ°åæå­å®ä½
     *
     * @param {string} text - textã
     * @param {number} x - xã
     * @param {number} y - yã
     * @param {string} textFont -  textFontã
     * @param {string} textAlign - textAlignã
     * @param {string} textBaseline - textBaselineã
     * @return {Object} ç©å½¢åºåã
     */
    static _getTextRect(text, x, y, textFont, textAlign, textBaseline) {
        var width = SUtil_SUtil.Util_area.getTextWidth(text, textFont);
        var lineHeight = SUtil_SUtil.Util_area.getTextHeight('ZH', textFont);

        text = (text + '').split('\n');

        switch (textAlign) {
            case 'end':
            case 'right':
                x -= width;
                break;
            case 'center':
                x -= (width / 2);
                break;
        }

        switch (textBaseline) {
            case 'top':
                break;
            case 'bottom':
                y -= lineHeight * text.length;
                break;
            default:
                y -= lineHeight * text.length / 2;
        }

        return {
            x: x,
            y: y,
            width: width,
            height: lineHeight * text.length
        };
    }

}

;// CONCATENATED MODULE: ./src/common/overlay/levelRenderer/SmicPoint.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @private
 * @class  LevelRenderer.Shape.SmicPoint
 * @category Visualization Theme
 * @classdesc ç¹ã
 * @extends LevelRenderer.Shape
 * @example
 *   var shape = new LevelRenderer.Shape.SmicPoint({
 *       style: {
 *           x: 100,
 *           y: 100,
 *           r: 40,
 *           brushType: 'both',
 *           color: 'blue',
 *           strokeColor: 'red',
 *           lineWidth: 3,
 *           text: 'point'
 *       }
 *   });
 *   levelRenderer.addShape(shape);
 * @param {Array} options - shape çéç½®ï¼optionsï¼é¡¹ï¼å¯ä»¥æ¯ shape çèªæå±æ§ï¼ä¹å¯ä»¥æ¯èªå®ä¹çå±æ§ã
 *
 */
class SmicPoint extends Shape_Shape {
    constructor(options) {
        super(options);
        /**
         * @member {string} LevelRenderer.Shape.SmicPoint.prototype.type
         * @description å¾å½¢ç±»åã
         */
        this.type = 'smicpoint';
        if (!this.refOriginalPosition || this.refOriginalPosition.length !== 2) {
            this.refOriginalPosition = [0, 0];
        }

        this.CLASS_NAME = "SuperMap.LevelRenderer.Shape.SmicPoint";
    }


    /**
     * @function cdestroy
     * @description éæ¯å¯¹è±¡ï¼éæ¾èµæºãè°ç¨æ­¤å½æ°åææå±æ§å°è¢«ç½®ä¸º nullã
     */
    destroy() {
        this.type = null;
        super.destroy();
    }


    /**
     * @function LevelRenderer.Shape.SmicPoint.prototype.buildPath
     * @description åå»ºç¹è§¦ã
     *
     * @param {CanvasRenderingContext2D} ctx - Context2D ä¸ä¸æã
     * @param {Object} style - styleã
     *
     */
    buildPath(ctx, style) {
        if (!this.refOriginalPosition || this.refOriginalPosition.length !== 2) {
            this.refOriginalPosition = [0, 0];
        }
        var __OP = this.refOriginalPosition;

        ctx.arc(style.x + __OP[0], style.y + __OP[1], style.r, 0, Math.PI * 2, true);
        return;
    }


    /**
     * @function LevelRenderer.Shape.SmicPoint.prototype.getRect
     * @description è®¡ç®è¿åç¹çåå´çç©å½¢ãè¯¥åå´çæ¯ç´æ¥ä»åä¸ªæ§å¶ç¹è®¡ç®ï¼å¹¶éæå°åå´çã
     *
     * @param {Object} style - style
     * @return {Object} è¾¹æ¡å¯¹è±¡ãåå«å±æ§ï¼xï¼yï¼widthï¼heightã
     */
    getRect(style) {
        if (!this.refOriginalPosition || this.refOriginalPosition.length !== 2) {
            this.refOriginalPosition = [0, 0];
        }
        var __OP = this.refOriginalPosition;

        if (style.__rect) {
            return style.__rect;
        }

        var lineWidth;
        if (style.brushType == 'stroke' || style.brushType == 'fill') {
            lineWidth = style.lineWidth || 1;
        } else {
            lineWidth = 0;
        }
        style.__rect = {
            x: Math.round((style.x + __OP[0]) - style.r - lineWidth / 2),
            y: Math.round((style.y + __OP[1]) - style.r - lineWidth / 2),
            width: style.r * 2 + lineWidth,
            height: style.r * 2 + lineWidth
        };

        return style.__rect;
    }

}

;// CONCATENATED MODULE: ./src/common/overlay/levelRenderer/SmicText.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @private
 * @class  LevelRenderer.Shape.SmicText
 * @category Visualization Theme
 * @extends {LevelRenderer.Shape}
 * @example
 *   var shape = new LevelRenderer.Shape.SmicText({
 *         style: {
 *             text: 'Label',
 *             x: 100,
 *             y: 100,
 *             textFont: '14px Arial'
 *         }
 *     });
 *   levelRenderer.addShape(shape);
 * @param {Array} options - shape çéç½®ï¼optionsï¼é¡¹ï¼å¯ä»¥æ¯ shape çèªæå±æ§ï¼ä¹å¯ä»¥æ¯èªå®ä¹çå±æ§ã
 */
class SmicText extends Shape_Shape {
    constructor(options) {
        super(options);
        /**
         * @member {string} LevelRenderer.Shape.SmicText.prototype.type
         * @description å¾å½¢ç±»å.
         */
        this.type = 'smictext';
        if (!this.refOriginalPosition || this.refOriginalPosition.length !== 2) {
            this.refOriginalPosition = [0, 0];
        }
        this.CLASS_NAME = "SuperMap.LevelRenderer.Shape.SmicText";
    }


    /**
     * @function LevelRenderer.Shape.SmicText.prototype.destroy
     * @description éæ¯å¯¹è±¡ï¼éæ¾èµæºãè°ç¨æ­¤å½æ°åææå±æ§å°è¢«ç½®ä¸º nullã
     */
    destroy() {
        this.type = null;

        super.destroy();
    }


    /**
     * @function LevelRenderer.Shape.SmicText.prototype.brush
     * @description ç¬è§¦ã
     *
     * @param {CanvasRenderingContext2D} ctx - Context2D ä¸ä¸æã
     * @param {boolean} isHighlight - æ¯å¦ä½¿ç¨é«äº®å±æ§ã
     *
     */
    brush(ctx, isHighlight) {
        if (!this.refOriginalPosition || this.refOriginalPosition.length !== 2) {
            this.refOriginalPosition = [0, 0];
        }
        var __OP = this.refOriginalPosition;

        var style = this.style;
        if (isHighlight) {
            // æ ¹æ®styleæ©å±é»è®¤é«äº®æ ·å¼
            style = this.getHighlightStyle(
                style, this.highlightStyle || {}
            );
        }

        if (typeof(style.text) == 'undefined' || style.text === false) {
            return;
        }

        ctx.save();
        this.doClip(ctx);

        this.setContext(ctx, style);

        // è®¾ç½®transform
        this.setTransform(ctx);

        if (style.textFont) {
            ctx.font = style.textFont;
        }
        ctx.textAlign = style.textAlign || 'start';
        ctx.textBaseline = style.textBaseline || 'middle';

        var text = (style.text + '').split('\n');
        var lineHeight = SUtil_SUtil.Util_area.getTextHeight('ZH', style.textFont);
        var rect = this.getRectNoRotation(style);
        // var x = style.x;
        var x = style.x + __OP[0];
        var y;
        if (style.textBaseline == 'top') {
            y = rect.y;
        } else if (style.textBaseline == 'bottom') {
            y = rect.y + lineHeight;
        } else {
            y = rect.y + lineHeight / 2;
        }
        var ox = style.x + __OP[0];
        var oy = style.y + __OP[1];

        //ææ¬ç»å¶
        for (var i = 0, l = text.length; i < l; i++) {
            //æ¯å¦æ¸²æç©å½¢èæ¯åé¢è²
            if (style.labelRect) {
                //+4,-2æ¯ä¸ºäºè®©æå­è·è¾¹æ¡å·¦å³è¾¹ç¼æç¹é´é
                ctx.fillRect(rect.x - 2, rect.y, rect.width + 4, rect.height);
                ctx.fillStyle = style.strokeColor;
                ctx.strokeRect(rect.x - 2, rect.y, rect.width + 4, rect.height);
                ctx.fillStyle = style.textColor;
            }

            switch (style.brushType) {
                case 'stroke':
                    this.setCtxGlobalAlpha(ctx, "stroke", style);
                    if (style.textRotation && style.textRotation !== 0) {
                        ctx.save();
                        ctx.translate(ox, oy);
                        ctx.rotate(style.textRotation * Math.PI / 180);
                        if (style.textBaseline == 'top') {
                            if (style.maxWidth) {
                                ctx.strokeText(text[i], 0, lineHeight * i, style.maxWidth);
                            } else {
                                ctx.strokeText(text[i], 0, lineHeight * i);
                            }
                        } else if (style.textBaseline == 'bottom') {
                            if (style.maxWidth) {
                                ctx.strokeText(text[i], 0, lineHeight * (i + 1) - rect.height, style.maxWidth);
                            } else {
                                ctx.strokeText(text[i], 0, lineHeight * (i + 1) - rect.height);
                            }
                        } else {
                            if (style.maxWidth) {
                                ctx.strokeText(text[i], 0, lineHeight * (i + 1) - rect.height / 2 - lineHeight / 2, style.maxWidth);
                            } else {
                                ctx.strokeText(text[i], 0, lineHeight * (i + 1) - rect.height / 2 - lineHeight / 2);
                            }
                        }
                        ctx.restore();
                    } else {
                        if (style.maxWidth) {
                            ctx.strokeText(text[i], x, y, style.maxWidth);
                        } else {
                            ctx.strokeText(text[i], x, y);
                        }
                    }
                    this.setCtxGlobalAlpha(ctx, "reset", style);
                    break;
                case 'both':
                    if (style.textRotation && style.textRotation !== 0) {
                        ctx.save();
                        ctx.translate(ox, oy);
                        ctx.rotate(style.textRotation * Math.PI / 180);
                        if (style.textBaseline == 'top') {
                            if (style.maxWidth) {
                                this.setCtxGlobalAlpha(ctx, "fill", style);
                                ctx.fillText(text[i], 0, lineHeight * i, style.maxWidth);
                                this.setCtxGlobalAlpha(ctx, "reset", style);

                                this.setCtxGlobalAlpha(ctx, "stroke", style);
                                ctx.strokeText(text[i], 0, lineHeight * i, style.maxWidth);
                                this.setCtxGlobalAlpha(ctx, "reset", style);
                            } else {
                                this.setCtxGlobalAlpha(ctx, "fill", style);
                                ctx.fillText(text[i], 0, lineHeight * i);
                                this.setCtxGlobalAlpha(ctx, "reset", style);

                                this.setCtxGlobalAlpha(ctx, "stroke", style);
                                ctx.strokeText(text[i], 0, lineHeight * i);
                                this.setCtxGlobalAlpha(ctx, "reset", style);
                            }
                        } else if (style.textBaseline == 'bottom') {
                            if (style.maxWidth) {
                                this.setCtxGlobalAlpha(ctx, "fill", style);
                                ctx.fillText(text[i], 0, lineHeight * (i + 1) - rect.height, style.maxWidth);
                                this.setCtxGlobalAlpha(ctx, "reset", style);

                                this.setCtxGlobalAlpha(ctx, "stroke", style);
                                ctx.strokeText(text[i], 0, lineHeight * (i + 1) - rect.height, style.maxWidth);
                                this.setCtxGlobalAlpha(ctx, "reset", style);
                            } else {
                                this.setCtxGlobalAlpha(ctx, "fill", style);
                                ctx.fillText(text[i], 0, lineHeight * (i + 1) - rect.height);
                                this.setCtxGlobalAlpha(ctx, "reset", style);

                                this.setCtxGlobalAlpha(ctx, "stroke", style);
                                ctx.strokeText(text[i], 0, lineHeight * (i + 1) - rect.height);
                                this.setCtxGlobalAlpha(ctx, "reset", style);
                            }
                        } else {
                            if (style.maxWidth) {
                                this.setCtxGlobalAlpha(ctx, "fill", style);
                                ctx.fillText(text[i], 0, lineHeight * (i + 1) - rect.height / 2 - lineHeight / 2, style.maxWidth);
                                this.setCtxGlobalAlpha(ctx, "reset", style);

                                this.setCtxGlobalAlpha(ctx, "stroke", style);
                                ctx.strokeText(text[i], 0, lineHeight * (i + 1) - rect.height / 2 - lineHeight / 2, style.maxWidth);
                                this.setCtxGlobalAlpha(ctx, "reset", style);
                            } else {
                                this.setCtxGlobalAlpha(ctx, "fill", style);
                                ctx.fillText(text[i], 0, lineHeight * (i + 1) - rect.height / 2 - lineHeight / 2);
                                this.setCtxGlobalAlpha(ctx, "reset", style);

                                this.setCtxGlobalAlpha(ctx, "stroke", style);
                                ctx.strokeText(text[i], 0, lineHeight * (i + 1) - rect.height / 2 - lineHeight / 2);
                                this.setCtxGlobalAlpha(ctx, "reset", style);
                            }
                        }
                        ctx.restore();
                    } else {
                        if (style.maxWidth) {
                            this.setCtxGlobalAlpha(ctx, "fill", style);
                            ctx.fillText(text[i], x, y, style.maxWidth);
                            this.setCtxGlobalAlpha(ctx, "reset", style);

                            this.setCtxGlobalAlpha(ctx, "stroke", style);
                            ctx.strokeText(text[i], x, y, style.maxWidth);
                            this.setCtxGlobalAlpha(ctx, "reset", style);
                        } else {
                            this.setCtxGlobalAlpha(ctx, "fill", style);
                            ctx.fillText(text[i], x, y);
                            this.setCtxGlobalAlpha(ctx, "reset", style);

                            this.setCtxGlobalAlpha(ctx, "stroke", style);
                            ctx.strokeText(text[i], x, y);
                            this.setCtxGlobalAlpha(ctx, "reset", style);
                        }
                    }
                    break;
                default:
                    //fill or others
                    this.setCtxGlobalAlpha(ctx, "fill", style);
                    if (style.textRotation && style.textRotation !== 0) {
                        ctx.save();
                        ctx.translate(ox, oy);
                        ctx.rotate(style.textRotation * Math.PI / 180);
                        if (style.textBaseline == 'top') {
                            if (style.maxWidth) {
                                ctx.fillText(text[i], 0, lineHeight * i, style.maxWidth);
                            } else {
                                ctx.fillText(text[i], 0, lineHeight * i);
                            }
                        } else if (style.textBaseline == 'bottom') {
                            if (style.maxWidth) {
                                ctx.fillText(text[i], 0, lineHeight * (i + 1) - rect.height, style.maxWidth);
                            } else {
                                ctx.fillText(text[i], 0, lineHeight * (i + 1) - rect.height);
                            }
                        } else {
                            if (style.maxWidth) {
                                ctx.fillText(text[i], 0, lineHeight * (i + 1) - rect.height / 2 - lineHeight / 2, style.maxWidth);
                            } else {
                                ctx.fillText(text[i], 0, lineHeight * (i + 1) - rect.height / 2 - lineHeight / 2);
                            }
                        }
                        ctx.restore();
                    } else {
                        if (style.maxWidth) {
                            ctx.fillText(text[i], x, y, style.maxWidth);
                        } else {
                            ctx.fillText(text[i], x, y);
                        }
                    }
                    this.setCtxGlobalAlpha(ctx, "reset", style);
            }
            y += lineHeight;
        }

        ctx.restore();
        return;
    }


    /**
     * @function LevelRenderer.Shape.SmicText.prototype.getRect
     * @description è¿åæå­åå´çç©å½¢
     */
    getRect(style) {
        if (style.__rect) {
            return style.__rect;
        }

        var left, top, right, bottom
        var tbg = this.getTextBackground(style, true);
        for (var i = 0, len = tbg.length; i < len; i++) {
            var poi = tbg[i];

            //ç¨ç¬¬ä¸ä¸ªç¹åå§å
            if (i == 0) {
                left = poi[0];
                right = poi[0];
                top = poi[1];
                bottom = poi[1];
            } else {
                if (poi[0] < left) {
                    left = poi[0]
                }
                if (poi[0] > right) {
                    right = poi[0]
                }
                if (poi[1] < top) {
                    top = poi[1]
                }
                if (poi[1] > bottom) {
                    bottom = poi[1]
                }
            }
        }

        style.__rect = {
            x: left,
            y: top,
            width: right - left,
            height: bottom - top
        };

        return style.__rect;
    }


    /**
     * @function LevelRenderer.Shape.SmicText.prototype.getRectNoRotation
     * @description è¿åå¿½ç¥æè½¬åmaxWidthæ¶æå­åå´çç©å½¢
     */
    getRectNoRotation(style) {

        if (!this.refOriginalPosition || this.refOriginalPosition.length !== 2) {
            this.refOriginalPosition = [0, 0];
        }
        var __OP = this.refOriginalPosition;

        var lineHeight = SUtil_SUtil.Util_area.getTextHeight('ZH', style.textFont);

        var width = SUtil_SUtil.Util_area.getTextWidth(style.text, style.textFont);
        var height = SUtil_SUtil.Util_area.getTextHeight(style.text, style.textFont);

        //å¤çæå­ä½ç½®ï¼æ³¨ï¼ææ¬çç»å¶æ¯ç±æ­¤ rect å³å®
        var textX = style.x + __OP[0];                 // é»è®¤start == left
        if (style.textAlign == 'end' || style.textAlign == 'right') {
            textX -= width;
        } else if (style.textAlign == 'center') {
            textX -= (width / 2);
        }

        var textY;
        if (style.textBaseline == 'top') {
            // textY = style.y;
            textY = style.y + __OP[1];
        } else if (style.textBaseline == 'bottom') {
            textY = (style.y + __OP[1]) - height;
        } else {
            // middle
            textY = (style.y + __OP[1]) - height / 2;
        }

        var isWidthChangeByMaxWidth = false;
        var widthBeforeChangeByMaxWidth;

        //å¤ç maxWidth
        if (style.maxWidth) {
            var maxWidth = parseInt(style.maxWidth);
            if (maxWidth < width) {
                widthBeforeChangeByMaxWidth = width;
                isWidthChangeByMaxWidth = true;
                width = maxWidth;
            }

            textX = style.x + __OP[0];
            if (style.textAlign == 'end' || style.textAlign == 'right') {
                textX -= width;
            } else if (style.textAlign == 'center') {
                textX -= (width / 2);
            }
        }

        //å¤çæä½å­
        if (style.textFont) {
            var textFont = style.textFont;
            var textFontStr = textFont.toLowerCase()
            if (textFontStr.indexOf("italic") > -1) {
                if (isWidthChangeByMaxWidth === true) {
                    width += (lineHeight / 3) * (width / widthBeforeChangeByMaxWidth);
                } else {
                    width += lineHeight / 3;
                }
            }
        }

        var rect = {
            x: textX,
            y: textY,
            width: width,
            height: height
        };

        return rect;
    }


    /**
     * @function LevelRenderer.Shape.SmicText.prototype.getTextBackground
     * @description è·åææ¬èæ¯æ¡èå´
     *
     * @param {Object} style - æ ·å¼ã
     * @param {boolean} redo - æ¯å¦å¼ºå¶éæ°è®¡ç® textBackgroundã
     */
    getTextBackground(style, redo) {
        if (!this.refOriginalPosition || this.refOriginalPosition.length !== 2) {
            this.refOriginalPosition = [0, 0];
        }
        var __OP = this.refOriginalPosition;

        if ((!redo) && style.__textBackground) {
            return style.__textBackground;
        }

        //ä¸æè½¬æ¶ç©å½¢æ¡
        var rect = this.getRectNoRotation(style);

        //æè½¬ä¸­å¿ç¹
        var ox = style.x + __OP[0];
        var oy = style.y + __OP[1];

        //èæ¯æ¡
        var background = [];

        if (style.textRotation && style.textRotation !== 0) {
            let textRotation = style.textRotation;
            let ltPoi = this.getRotatedLocation(rect.x, rect.y, ox, oy, textRotation);
            let rtPoi = this.getRotatedLocation(rect.x + rect.width, rect.y, ox, oy, textRotation);
            let rbPoi = this.getRotatedLocation(rect.x + rect.width, rect.y + rect.height, ox, oy, textRotation);
            let lbPoi = this.getRotatedLocation(rect.x, rect.y + rect.height, ox, oy, textRotation);

            background.push(ltPoi);
            background.push(rtPoi);
            background.push(rbPoi);
            background.push(lbPoi);
        } else {
            let ltPoi = [rect.x, rect.y];
            let rtPoi = [rect.x + rect.width, rect.y];
            let rbPoi = [rect.x + rect.width, rect.y + rect.height];
            let lbPoi = [rect.x, rect.y + rect.height];

            background.push(ltPoi);
            background.push(rtPoi);
            background.push(rbPoi);
            background.push(lbPoi);
        }

        style.__textBackground = background;

        return style.__textBackground;
    }


    /**
     * @function LevelRenderer.Shape.SmicText.prototype.getRotatedLocation
     * @description è·åä¸ä¸ªç¹ç»æè½¬ä¸­å¿é¡ºæ¶éæè½¬åçä½ç½®ãï¼æ­¤æ¹æ³ç¨äºå±å¹åæ ï¼
     *
     * @param {number} x - æè½¬ç¹æ¨ªåæ ã
     * @param {number} y - æè½¬ç¹çºµåæ ã
     * @param {number} rx - æè½¬ä¸­å¿ç¹æ¨ªåæ ã
     * @param {number} ry - æè½¬ä¸­å¿ç¹çºµåæ ã
     * @param {number} angle - æè½¬è§åº¦ï¼åº¦ï¼ã
     * @return {Array.<number>} æè½¬åçåæ ä½ç½®ï¼é¿åº¦ä¸º 2 çä¸ç»´æ°ç»ï¼æ°ç»ç¬¬ä¸ä¸ªåç´ è¡¨ç¤º x åæ ï¼ç¬¬äºä¸ªåç´ è¡¨ç¤º y åæ ã
     */
    getRotatedLocation(x, y, rx, ry, angle) {
        var loc = new Array(), x0, y0;

        y = -y;
        ry = -ry;
        angle = -angle;//é¡ºæ¶éæè½¬
        x0 = (x - rx) * Math.cos((angle / 180) * Math.PI) - (y - ry) * Math.sin((angle / 180) * Math.PI) + rx;
        y0 = (x - rx) * Math.sin((angle / 180) * Math.PI) + (y - ry) * Math.cos((angle / 180) * Math.PI) + ry;

        loc[0] = x0;
        loc[1] = -y0;
        return loc;
    }

}

;// CONCATENATED MODULE: ./src/common/overlay/levelRenderer/SmicCircle.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @private
 * @class  LevelRenderer.Shape.SmicCircle
 * @category Visualization Theme
 * @classdesc åå½¢
 * @extends LevelRenderer.Shape
 * @example
 *   var shape = new LevelRenderer.Shape.SmicCircle({
 *         style: {
 *             x: 100,
 *             y: 100,
 *             r: 60,
 *             brushType: "both",
 *             color: "blue",
 *             strokeColor: "red",
 *             lineWidth: 3,
 *             text: "Circle"
 *         }
 *   });
 *   levelRenderer.addShape(shape);
 * @param {Array} options - shape çéç½®ï¼optionsï¼é¡¹ï¼å¯ä»¥æ¯ shape çèªæå±æ§ï¼ä¹å¯ä»¥æ¯èªå®ä¹çå±æ§ã
 *
 */
class SmicCircle extends Shape_Shape {
    constructor(options) {
        super(options);
        /**
         * @member {string} LevelRenderer.Shape.SmicCircle.prototype.type
         * @description å¾å½¢ç±»åã
         */
        this.type = 'smiccircle';

        if (!this.refOriginalPosition || this.refOriginalPosition.length !== 2) {
            this.refOriginalPosition = [0, 0];
        }
        this.CLASS_NAME = "SuperMap.LevelRenderer.Shape.SmicCircle";
    }


    /**
     * @function LevelRenderer.Shape.SmicCircle.prototype.destroy
     * @description éæ¯å¯¹è±¡ï¼éæ¾èµæºãè°ç¨æ­¤å½æ°åææå±æ§å°è¢«ç½®ä¸º nullã
     */
    destroy() {
        this.type = null;
        super.destroy();
    }


    /**
     * @function LevelRenderer.Shape.SmicCircle.prototype.buildPath
     * @description åå»ºå¾å½¢è·¯å¾ã
     *
     * @param {CanvasRenderingContext2D} ctx - Context2D ä¸ä¸æã
     * @param {Object} style - styleã
     *
     */
    buildPath(ctx, style) {
        if (!this.refOriginalPosition || this.refOriginalPosition.length !== 2) {
            this.refOriginalPosition = [0, 0];
        }
        var __OP = this.refOriginalPosition;

        var x = style.x + __OP[0];   // åå¿x
        var y = style.y + __OP[1];   // åå¿y

        ctx.moveTo(x + style.r, y);
        ctx.arc(x, y, style.r, 0, Math.PI * 2, true);

        return true;
    }


    /**
     * @function LevelRenderer.Shape.SmicCircle.prototype.getRect
     * @description è¿ååå½¢åå´çç©å½¢
     *
     * @param {Object} style - style
     * @return {Object} è¾¹æ¡å¯¹è±¡ãåå«å±æ§ï¼xï¼yï¼widthï¼heightã
     *
     */
    getRect(style) {
        if (style.__rect) {
            return style.__rect;
        }

        if (!this.refOriginalPosition || this.refOriginalPosition.length !== 2) {
            this.refOriginalPosition = [0, 0];
        }
        var __OP = this.refOriginalPosition;

        var x = style.x + __OP[0];   // åå¿x
        var y = style.y + __OP[1];   // åå¿y
        var r = style.r;             // år

        var lineWidth;
        if (style.brushType == 'stroke' || style.brushType == 'fill') {
            lineWidth = style.lineWidth || 1;
        } else {
            lineWidth = 0;
        }
        style.__rect = {
            x: Math.round(x - r - lineWidth / 2),
            y: Math.round(y - r - lineWidth / 2),
            width: r * 2 + lineWidth,
            height: r * 2 + lineWidth
        };

        return style.__rect;
    }
}

;// CONCATENATED MODULE: ./src/common/overlay/levelRenderer/SmicPolygon.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @private
 * @class  LevelRenderer.Shape.SmicPolygon
 * @category Visualization Theme
 * @classdesc å¤è¾¹å½¢ã
 * @extends LevelRenderer.Shape
 * @example
 *   var shape = new LevelRenderer.Shape.SmicPolygon({
 *         style: {
 *             // 100x100 çæ­£æ¹å½¢
 *             pointList: [[0, 0], [100, 0], [100, 100], [0, 100]],
 *             color: 'blue'
 *         }
 *   });
 *   levelRenderer.addShape(shape);
 * @param {Array} options - shape çéç½®ï¼optionsï¼é¡¹ï¼å¯ä»¥æ¯ shape çèªæå±æ§ï¼ä¹å¯ä»¥æ¯èªå®ä¹çå±æ§ã
 */
class SmicPolygon extends Shape_Shape {
    constructor(options) {
        super(options);
        /**
         * @member {string} LevelRenderer.Shape.SmicPolygon.prototype.type
         * @description å¾å½¢ç±»å.
         */
        this.type = 'smicpolygon';

        /**
         * @member {Array} LevelRenderer.Shape.SmicPolygon.prototype._holePolygonPointList
         * @description å²æ´é¢å¤è¾¹å½¢é¡¶ç¹æ°ç»ï¼ä¸ç»´æ°ç»ï¼
         *
         */
        this.holePolygonPointLists = null;

        if (!this.refOriginalPosition || this.refOriginalPosition.length !== 2) {
            this.refOriginalPosition = [0, 0];
        }
        this.CLASS_NAME = "SuperMap.LevelRenderer.Shape.SmicPolygon";
    }


    /**
     * @function LevelRenderer.Shape.SmicPolygon.prototype.destroy
     * @description éæ¯å¯¹è±¡ï¼éæ¾èµæºãè°ç¨æ­¤å½æ°åææå±æ§å°è¢«ç½®ä¸º nullã
     */
    destroy() {
        this.type = null;
        this.holePolygonPointLists = null;
        super.destroy();
    }


    /**
     * @function LevelRenderer.Shape.SmicPolygon.prototype.brush
     * @description ç¬è§¦ã
     *
     * @param {CanvasRenderingContext2D} ctx - Context2D ä¸ä¸æã
     * @param {boolean} isHighlight - æ¯å¦ä½¿ç¨é«äº®å±æ§ã
     *
     */
    brush(ctx, isHighlight) {
        if (!this.refOriginalPosition || this.refOriginalPosition.length !== 2) {
            this.refOriginalPosition = [0, 0];
        }

        var style = this.style;
        if (isHighlight) {
            // æ ¹æ®styleæ©å±é»è®¤é«äº®æ ·å¼
            style = this.getHighlightStyle(
                style,
                this.highlightStyle || {}
            );
        }

        ctx.save();
        this.setContext(ctx, style);

        // è®¾ç½® transform
        this.setTransform(ctx);

        // å fill åstroke
        var hasPath = false;
        if (style.brushType == 'fill' || style.brushType == 'both' || typeof style.brushType == 'undefined') {    // é»è®¤ä¸ºfill
            ctx.beginPath();
            if (style.lineType == 'dashed'
                || style.lineType == 'dotted'
                || style.lineType == 'dot'
                || style.lineType == 'dash'
                || style.lineType == 'dashdot'
                || style.lineType == 'longdash'
                || style.lineType == 'longdashdot'
            ) {
                // ç¹æ®å¤çï¼èçº¿å´ä¸æpathï¼å®çº¿åbuildä¸æ¬¡
                this.buildPath(ctx, {
                        lineType: 'solid',
                        lineWidth: style.lineWidth,
                        pointList: style.pointList
                    }
                );
            } else {
                this.buildPath(ctx, style);
                hasPath = true; // è¿ä¸ªpathè½ç¨
            }
            ctx.closePath();
            this.setCtxGlobalAlpha(ctx, "fill", style);
            ctx.fill();
            this.setCtxGlobalAlpha(ctx, "reset", style);
        }

        if (style.lineWidth > 0 && (style.brushType == 'stroke' || style.brushType == 'both')) {
            if (!hasPath) {
                ctx.beginPath();
                this.buildPath(ctx, style);
            }
            this.setCtxGlobalAlpha(ctx, "stroke", style);
            ctx.stroke();
            this.setCtxGlobalAlpha(ctx, "reset", style);
        }

        this.drawText(ctx, style, this.style);

        //å²æ´
        var hpStyle = Util.cloneObject(style);

        if (hpStyle.pointList) {
            if (this.holePolygonPointLists && this.holePolygonPointLists.length > 0) {
                var holePLS = this.holePolygonPointLists;
                var holePLSen = holePLS.length;
                for (var i = 0; i < holePLSen; i++) {
                    var holePL = holePLS[i];
                    //å²æ´é¢
                    hpStyle.pointList = holePL;

                    ctx.globalCompositeOperation = "destination-out";
                    // å fill åstroke
                    hasPath = false;
                    if (hpStyle.brushType == 'fill' || hpStyle.brushType == 'both' || typeof hpStyle.brushType == 'undefined') {    // é»è®¤ä¸ºfill
                        ctx.beginPath();
                        if (hpStyle.lineType == 'dashed'
                            || hpStyle.lineType == 'dotted'
                            || hpStyle.lineType == 'dot'
                            || hpStyle.lineType == 'dash'
                            || hpStyle.lineType == 'dashdot'
                            || hpStyle.lineType == 'longdash'
                            || hpStyle.lineType == 'longdashdot'
                        ) {
                            // ç¹æ®å¤çï¼èçº¿å´ä¸æpathï¼å®çº¿åbuildä¸æ¬¡
                            this.buildPath(ctx, {
                                    lineType: 'solid',
                                    lineWidth: hpStyle.lineWidth,
                                    pointList: hpStyle.pointList
                                }
                            );
                        } else {
                            this.buildPath(ctx, hpStyle);
                            hasPath = true; // è¿ä¸ªpathè½ç¨
                        }
                        ctx.closePath();
                        this.setCtxGlobalAlpha(ctx, "fill", hpStyle);
                        ctx.fill();
                        this.setCtxGlobalAlpha(ctx, "reset", hpStyle);
                    }

                    if (hpStyle.lineWidth > 0 && (hpStyle.brushType == 'stroke' || hpStyle.brushType == 'both')) {
                        if (!hasPath) {
                            ctx.beginPath();
                            this.buildPath(ctx, hpStyle);
                        }
                        //å¦ææè¾¹ï¼ååå¤ globalCompositeOperation é»è®¤å¼åæè¾¹ã
                        ctx.globalCompositeOperation = "source-over";
                        this.setCtxGlobalAlpha(ctx, "stroke", hpStyle);
                        ctx.stroke();
                        this.setCtxGlobalAlpha(ctx, "reset", hpStyle);
                    } else {
                        ctx.globalCompositeOperation = "source-over";
                    }
                }
            }

        }
        ctx.restore();
        return;
    }


    /**
     * @function LevelRenderer.Shape.SmicPolygon.prototype.buildPath
     * @description åå»ºå¤è¾¹å½¢è·¯å¾ã
     *
     * @param {CanvasRenderingContext2D} ctx - Context2D ä¸ä¸æã
     * @param {Object} style - styleã
     *
     */
    buildPath(ctx, style) {
        if (style.showShadow) {
            ctx.shadowBlur = style.shadowBlur;
            ctx.shadowColor = style.shadowColor;
            ctx.shadowOffsetX = style.shadowOffsetX;
            ctx.shadowOffsetY = style.shadowOffsetY;
        }
        if (!this.refOriginalPosition || this.refOriginalPosition.length !== 2) {
            this.refOriginalPosition = [0, 0];
        }
        var __OP = this.refOriginalPosition;

        // è½ç¶è½éç¨ brokenLineï¼ä½åºå±å¾å½¢åºäºæ§è½èèï¼éå¤ä»£ç åå°è°ç¨å§
        var pointList = style.pointList;

        if (pointList.length < 2) {
            // å°äº2ä¸ªç¹å°±ä¸ç»äº~
            return;
        }

        if (style.smooth && style.smooth !== 'spline') {
            var controlPoints = SUtil_SUtil.SUtil_smoothBezier(pointList, style.smooth, true, style.smoothConstraint, __OP);

            ctx.moveTo(pointList[0][0] + __OP[0], pointList[0][1] + __OP[1]);
            var cp1;
            var cp2;
            var p;
            var len = pointList.length;
            for (var i = 0; i < len; i++) {
                cp1 = controlPoints[i * 2];
                cp2 = controlPoints[i * 2 + 1];
                p = [pointList[(i + 1) % len][0] + __OP[0], pointList[(i + 1) % len][1] + __OP[1]];
                ctx.bezierCurveTo(
                    cp1[0], cp1[1], cp2[0], cp2[1], p[0], p[1]
                );
            }
        } else {
            if (style.smooth === 'spline') {
                pointList = SUtil_SUtil.SUtil_smoothSpline(pointList, true, null, __OP);
            }

            if (!style.lineType || style.lineType == 'solid') {
                // é»è®¤ä¸ºå®çº¿
                ctx.moveTo(pointList[0][0] + __OP[0], pointList[0][1] + __OP[1]);
                for (let i = 1; i < pointList.length; i++) {
                    ctx.lineTo(pointList[i][0] + __OP[0], pointList[i][1] + __OP[1]);
                }
                ctx.lineTo(pointList[0][0] + __OP[0], pointList[0][1] + __OP[1]);
            } else if (style.lineType === 'dashed'
                || style.lineType === 'dotted'
                || style.lineType === 'dot'
                || style.lineType === 'dash'
                || style.lineType === 'longdash'
            ) {
                // SMIC-æ¹æ³ä¿®æ¹ - start
                let dashLengthForStyle = style._dashLength || (style.lineWidth || 1) * (style.lineType == 'dashed' ? 5 : 1);
                style._dashLength = dashLengthForStyle;

                let dashLength = (style.lineWidth || 1);
                let pattern1 = dashLength;
                let pattern2 = dashLength;

                //dashed
                if (style.lineType === 'dashed') {
                    pattern1 *= 5;
                    pattern2 *= 5;
                    if (style.lineCap && style.lineCap !== "butt") {
                        pattern1 -= dashLength;
                        pattern2 += dashLength;
                    }
                }

                //dotted
                if (style.lineType === 'dotted') {
                    if (style.lineCap && style.lineCap !== "butt") {
                        pattern1 = 1;
                        pattern2 += dashLength;
                    }
                }

                //dot
                if (style.lineType === 'dot') {
                    pattern2 *= 4;
                    if (style.lineCap && style.lineCap !== "butt") {
                        pattern1 = 1;
                        pattern2 += dashLength;
                    }
                }

                //dash
                if (style.lineType === 'dash') {
                    pattern1 *= 4;
                    pattern2 *= 4;
                    if (style.lineCap && style.lineCap !== "butt") {
                        pattern1 -= dashLength;
                        pattern2 += dashLength;
                    }
                }

                //longdash
                if (style.lineType === 'longdash') {
                    pattern1 *= 8;
                    pattern2 *= 4;
                    if (style.lineCap && style.lineCap !== "butt") {
                        pattern1 -= dashLength;
                        pattern2 += dashLength;
                    }
                }


                ctx.moveTo(pointList[0][0] + __OP[0], pointList[0][1] + __OP[1]);
                for (let i = 1; i < pointList.length; i++) {
                    SUtil_SUtil.SUtil_dashedLineTo(
                        ctx,
                        pointList[i - 1][0] + __OP[0],
                        pointList[i - 1][1] + __OP[1],
                        pointList[i][0] + __OP[0],
                        pointList[i][1] + __OP[1],
                        dashLength,
                        [pattern1, pattern2]
                    );
                }
                SUtil_SUtil.SUtil_dashedLineTo(
                    ctx,
                    pointList[pointList.length - 1][0] + __OP[0],
                    pointList[pointList.length - 1][1] + __OP[1],
                    pointList[0][0] + __OP[0],
                    pointList[0][1] + __OP[1],
                    dashLength,
                    [pattern1, pattern2]
                );
            } else if (style.lineType === 'dashdot'
                || style.lineType === 'longdashdot'
            ) {
                let dashLengthForStyle = style._dashLength || (style.lineWidth || 1) * (style.lineType == 'dashed' ? 5 : 1);
                style._dashLength = dashLengthForStyle;

                let dashLength = (style.lineWidth || 1);
                let pattern1 = dashLength;
                let pattern2 = dashLength;
                let pattern3 = dashLength;
                let pattern4 = dashLength;

                //dashdot
                if (style.lineType === 'dashdot') {
                    pattern1 *= 4;
                    pattern2 *= 4;
                    pattern4 *= 4;
                    if (style.lineCap && style.lineCap !== "butt") {
                        pattern1 -= dashLength;
                        pattern2 += dashLength;
                        pattern3 = 1;
                        pattern4 += dashLength;
                    }
                }

                //longdashdot
                if (style.lineType === 'longdashdot') {
                    pattern1 *= 8;
                    pattern2 *= 4;
                    pattern4 *= 4;
                    if (style.lineCap && style.lineCap !== "butt") {
                        pattern1 -= dashLength;
                        pattern2 += dashLength;
                        pattern3 = 1;
                        pattern4 += dashLength;
                    }
                }


                ctx.moveTo(pointList[0][0] + __OP[0], pointList[0][1] + __OP[1]);
                for (let i = 1; i < pointList.length; i++) {
                    SUtil_SUtil.SUtil_dashedLineTo(
                        ctx,
                        pointList[i - 1][0] + __OP[0],
                        pointList[i - 1][1] + __OP[1],
                        pointList[i][0] + __OP[0],
                        pointList[i][1] + __OP[1],
                        dashLength,
                        [pattern1, pattern2, pattern3, pattern4]
                    );
                }
                SUtil_SUtil.SUtil_dashedLineTo(
                    ctx,
                    pointList[pointList.length - 1][0] + __OP[0],
                    pointList[pointList.length - 1][1] + __OP[1],
                    pointList[0][0] + __OP[0],
                    pointList[0][1] + __OP[1],
                    dashLength,
                    [pattern1, pattern2, pattern3, pattern4]
                );
            }

        }
        return;
    }


    /**
     * @function LevelRenderer.Shape.SmicPolygon.prototype.getRect
     * @description è®¡ç®è¿åå¤è¾¹å½¢åå´çç©éµãè¯¥åå´çæ¯ç´æ¥ä»åä¸ªæ§å¶ç¹è®¡ç®ï¼å¹¶éæå°åå´çã
     *
     * @param {Object} style - style
     * @return {Object} è¾¹æ¡å¯¹è±¡ãåå«å±æ§ï¼xï¼yï¼widthï¼heightã
     *
     */
    getRect(style, refOriginalPosition) {
        var __OP;
        if (!refOriginalPosition) {
            if (!this.refOriginalPosition || this.refOriginalPosition.length !== 2) {
                this.refOriginalPosition = [0, 0];
            }
            __OP = this.refOriginalPosition;
        } else {
            __OP = refOriginalPosition;
        }

        if (style.__rect) {
            return style.__rect;
        }

        var minX = Number.MAX_VALUE;
        var maxX = Number.MIN_VALUE;
        var minY = Number.MAX_VALUE;
        var maxY = Number.MIN_VALUE;

        var pointList = style.pointList;
        for (var i = 0, l = pointList.length; i < l; i++) {
            if (pointList[i][0] + __OP[0] < minX) {
                minX = pointList[i][0] + __OP[0];
            }
            if (pointList[i][0] + __OP[0] > maxX) {
                maxX = pointList[i][0] + __OP[0];
            }
            if (pointList[i][1] + __OP[1] < minY) {
                minY = pointList[i][1] + __OP[1];
            }
            if (pointList[i][1] + __OP[1] > maxY) {
                maxY = pointList[i][1] + __OP[1];
            }
        }

        var lineWidth;
        if (style.brushType == 'stroke' || style.brushType == 'fill') {
            lineWidth = style.lineWidth || 1;
        } else {
            lineWidth = 0;
        }

        style.__rect = {
            x: Math.round(minX - lineWidth / 2),
            y: Math.round(minY - lineWidth / 2),
            width: maxX - minX + lineWidth,
            height: maxY - minY + lineWidth
        };
        return style.__rect;
    }

}

;// CONCATENATED MODULE: ./src/common/overlay/levelRenderer/SmicBrokenLine.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @private
 * @class  LevelRenderer.Shape.SmicBrokenLine
 * @category Visualization Theme
 * @classdesc æçº¿(ic)ã
 * @extends LevelRenderer.Shape
 * @example
 *   var shape = new LevelRenderer.Shape.SmicBrokenLine({
 *         style: {
 *             pointList: [[0, 0], [100, 100], [100, 0]],
 *             smooth: 'bezier',
 *             strokeColor: 'purple'
 *         }
 *   });
 *   levelRenderer.addShape(shape);
 * @param {Array} options - shape çéç½®ï¼optionsï¼é¡¹ï¼å¯ä»¥æ¯ shape çèªæå±æ§ï¼ä¹å¯ä»¥æ¯èªå®ä¹çå±æ§ã
 *
 */
class SmicBrokenLine extends Shape_Shape {
    constructor(options) {
        super(options);
        /**
         * @member {string}  LevelRenderer.Shape.SmicBrokenLine.prototype.brushTypeOnly
         * @description çº¿æ¡åªè½æè¾¹ã
         */
        this.brushTypeOnly = 'stroke';

        /**
         * @member {string} LevelRenderer.Shape.SmicBrokenLine.prototype.textPosition
         * @description ææ¬ä½ç½®ã
         */
        this.textPosition = 'end';

        /**
         * @member {string} LevelRenderer.Shape.SmicBrokenLine.prototype.type
         * @description å¾å½¢ç±»å.
         */
        this.type = 'smicbroken-line';
        if (!this.refOriginalPosition || this.refOriginalPosition.length !== 2) {
            this.refOriginalPosition = [0, 0];
        }

        this.CLASS_NAME = "SuperMap.LevelRenderer.Shape.SmicBrokenLine";
    }


    /**
     * @function LevelRenderer.Shape.SmicBrokenLine.prototype.destroy
     * @description éæ¯å¯¹è±¡ï¼éæ¾èµæºãè°ç¨æ­¤å½æ°åææå±æ§å°è¢«ç½®ä¸º nullã
     */
    destroy() {
        this.brushTypeOnly = null;
        this.textPosition = null;
        this.type = null;

        super.destroy();
    }


    /**
     * @function LevelRenderer.Shape.SmicBrokenLine.prototype.buildPath
     * @description åå»ºæçº¿è·¯å¾ã
     *
     * @param {CanvasRenderingContext2D} ctx - Context2D ä¸ä¸æã
     * @param {Object} style - styleã
     *
     */
    buildPath(ctx, style) {
        if (!this.refOriginalPosition || this.refOriginalPosition.length !== 2) {
            this.refOriginalPosition = [0, 0];
        }

        var __OP = this.refOriginalPosition;

        var pointList = style.pointList;
        if (pointList.length < 2) {
            // å°äº2ä¸ªç¹å°±ä¸ç»äº~
            return;
        }

        var len = Math.min(style.pointList.length, Math.round(style.pointListLength || style.pointList.length));

        if (style.smooth && style.smooth !== 'spline') {
            var controlPoints = SUtil_SUtil.SUtil_smoothBezier(pointList, style.smooth, false, style.smoothConstraint, __OP);

            ctx.moveTo(pointList[0][0] + __OP[0], pointList[0][1] + __OP[1]);
            var cp1;
            var cp2;
            var p;
            for (let i = 0; i < len - 1; i++) {
                cp1 = controlPoints[i * 2];
                cp2 = controlPoints[i * 2 + 1];
                p = [pointList[i + 1][0] + __OP[0], pointList[i + 1][1] + __OP[1]];
                ctx.bezierCurveTo(
                    cp1[0], cp1[1], cp2[0], cp2[1], p[0], p[1]
                );
            }
        } else {
            if (style.smooth === 'spline') {
                pointList = SUtil_SUtil.SUtil_smoothSpline(pointList, null, null, __OP);
                len = pointList.length;
            }
            if (!style.lineType || style.lineType === 'solid') {
                // é»è®¤ä¸ºå®çº¿
                ctx.moveTo(pointList[0][0] + __OP[0], pointList[0][1] + __OP[1]);
                for (let i = 1; i < len; i++) {
                    ctx.lineTo(pointList[i][0] + __OP[0], pointList[i][1] + __OP[1]);
                }
            } else if (style.lineType === 'dashed'
                || style.lineType === 'dotted'
                || style.lineType === 'dot'
                || style.lineType === 'dash'
                || style.lineType === 'longdash'
            ) {
                let dashLength = (style.lineWidth || 1);
                let pattern1 = dashLength;
                let pattern2 = dashLength;

                //dashed
                if (style.lineType === 'dashed') {
                    pattern1 *= 5;
                    pattern2 *= 5;
                    if (style.lineCap && style.lineCap !== "butt") {
                        pattern1 -= dashLength;
                        pattern2 += dashLength;
                    }
                }

                //dotted
                if (style.lineType === 'dotted') {
                    if (style.lineCap && style.lineCap !== "butt") {
                        pattern1 = 1;
                        pattern2 += dashLength;
                    }
                }

                //dot
                if (style.lineType === 'dot') {
                    pattern2 *= 4;
                    if (style.lineCap && style.lineCap !== "butt") {
                        pattern1 = 1;
                        pattern2 += dashLength;
                    }
                }

                //dash
                if (style.lineType === 'dash') {
                    pattern1 *= 4;
                    pattern2 *= 4;
                    if (style.lineCap && style.lineCap !== "butt") {
                        pattern1 -= dashLength;
                        pattern2 += dashLength;
                    }
                }

                //longdash
                if (style.lineType === 'longdash') {
                    pattern1 *= 8;
                    pattern2 *= 4;
                    if (style.lineCap && style.lineCap !== "butt") {
                        pattern1 -= dashLength;
                        pattern2 += dashLength;
                    }
                }

                ctx.moveTo(pointList[0][0] + __OP[0], pointList[0][1] + __OP[1]);
                for (var i = 1; i < len; i++) {
                    SUtil_SUtil.SUtil_dashedLineTo(
                        ctx,
                        pointList[i - 1][0] + __OP[0], pointList[i - 1][1] + __OP[1],
                        pointList[i][0] + __OP[0], pointList[i][1] + __OP[1],
                        dashLength,
                        [pattern1, pattern2]
                    );
                }
            } else if (style.lineType === 'dashdot'
                || style.lineType === 'longdashdot'
            ) {
                let dashLength = (style.lineWidth || 1);
                let pattern1 = dashLength;
                let pattern2 = dashLength;
                let pattern3 = dashLength;
                let pattern4 = dashLength;

                //dashdot
                if (style.lineType === 'dashdot') {
                    pattern1 *= 4;
                    pattern2 *= 4;
                    pattern4 *= 4;
                    if (style.lineCap && style.lineCap !== "butt") {
                        pattern1 -= dashLength;
                        pattern2 += dashLength;
                        pattern3 = 1;
                        pattern4 += dashLength;
                    }
                }

                //longdashdot
                if (style.lineType === 'longdashdot') {
                    pattern1 *= 8;
                    pattern2 *= 4;
                    pattern4 *= 4;
                    if (style.lineCap && style.lineCap !== "butt") {
                        pattern1 -= dashLength;
                        pattern2 += dashLength;
                        pattern3 = 1;
                        pattern4 += dashLength;
                    }
                }

                dashLength = (style.lineWidth || 1)
                    * (style.lineType === 'dashed' ? 5 : 1);
                ctx.moveTo(pointList[0][0] + __OP[0], pointList[0][1] + __OP[1]);
                for (let i = 1; i < len; i++) {
                    SUtil_SUtil.SUtil_dashedLineTo(
                        ctx,
                        pointList[i - 1][0] + __OP[0], pointList[i - 1][1] + __OP[1],
                        pointList[i][0] + __OP[0], pointList[i][1] + __OP[1],
                        dashLength,
                        [pattern1, pattern2, pattern3, pattern4]
                    );
                }
            }

        }
        return;
    }


    /**
     * @function LevelRenderer.Shape.SmicBrokenLine.prototype.getRect
     * @description è®¡ç®è¿åæçº¿åå´çç©å½¢ãè¯¥åå´çæ¯ç´æ¥ä»åä¸ªæ§å¶ç¹è®¡ç®ï¼å¹¶éæå°åå´çã
     *
     * @param {Object} style - style
     * @return {Object} è¾¹æ¡å¯¹è±¡ãåå«å±æ§ï¼xï¼yï¼widthï¼heightã
     */
    getRect(style) {
        if (!this.refOriginalPosition || this.refOriginalPosition.length !== 2) {
            this.refOriginalPosition = [0, 0];
        }
        var __OP = this.refOriginalPosition;
        return SmicPolygon.prototype.getRect.apply(this, [style, __OP]);
    }

}

;// CONCATENATED MODULE: ./src/common/overlay/levelRenderer/SmicImage.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @private
 * @class  LevelRenderer.Shape.SmicImage
 * @category Visualization Theme
 * @classdesc å¾çç»å¶ã
 * @extends LevelRenderer.Shape
 * @example
 *   var shape = new LevelRenderer.Shape.SmicImage({
 *         style: {
 *             image: 'test.jpg',
 *             x: 100,
 *             y: 100
 *         }
 *   });
 *   levelRenderer.addShape(shape);
 * @param {Array} options - shape çéç½®ï¼optionsï¼é¡¹ï¼å¯ä»¥æ¯ shape çèªæå±æ§ï¼ä¹å¯ä»¥æ¯èªå®ä¹çå±æ§ã
 *
 */
class SmicImage extends Shape_Shape {
    constructor(options) {
        super(options);
        /**
         * @member {string} LevelRenderer.Shape.SmicImage.prototype.type
         * @description  å¾å½¢ç±»åã
         */
        this.type = 'smicimage';

        /**
         * @member {string} LevelRenderer.Shape.SmicImage.prototype._imageCache
         * @description å¾çç¼å­ã
         */
        this._imageCache = {};
        if (!this.refOriginalPosition || this.refOriginalPosition.length !== 2) {
            this.refOriginalPosition = [0, 0];
        }
        this.CLASS_NAME = "SuperMap.LevelRenderer.Shape.SmicImage";
    }


    /**
     * @function LevelRenderer.Shape.SmicImage.prototype.destroy
     * @description éæ¯å¯¹è±¡ï¼éæ¾èµæºãè°ç¨æ­¤å½æ°åææå±æ§å°è¢«ç½®ä¸º nullã
     */
    destroy() {
        this.type = null;
        this._imageCache = null;
        super.destroy();
    }


    /**
     * @function LevelRenderer.Shape.SmicImage.prototype.buildPath
     * @description åå»ºå¾çã
     *
     * @param {CanvasRenderingContext2D} ctx - Context2D ä¸ä¸æã
     * @param {Object} style - styleã
     *
     */
    brush(ctx, isHighlight, refresh) {
        if (!this.refOriginalPosition || this.refOriginalPosition.length !== 2) {
            this.refOriginalPosition = [0, 0];
        }
        var __OP = this.refOriginalPosition;

        var style = this.style || {};

        if (isHighlight) {
            // æ ¹æ®styleæ©å±é»è®¤é«äº®æ ·å¼
            style = this.getHighlightStyle(
                style, this.highlightStyle || {}
            );
        }

        var image = style.image;
        var me = this;

        if (typeof(image) === 'string') {
            var src = image;
            if (this._imageCache[src]) {
                image = this._imageCache[src];
            } else {
                image = new Image();
                image.onload = function () {
                    image.onload = null;
                    clearTimeout(SmicImage._refreshTimeout);
                    SmicImage._needsRefresh.push(me);
                    // é²æ­¢å ä¸ºç¼å­ç­æ¶é´åè§¦åå¤æ¬¡onloadäºä»¶
                    SmicImage._refreshTimeout = setTimeout(function () {
                        refresh && refresh(SmicImage._needsRefresh);
                        // æ¸ç©º needsRefresh
                        SmicImage._needsRefresh = [];
                    }, 10);
                };

                image.src = src;
                this._imageCache[src] = image;
            }
        }
        if (image) {
            // å¾çå·²ç»å è½½å®æ
            if (image.nodeName.toUpperCase() == 'IMG') {
                if (window.ActiveXObject) {
                    if (image.readyState != 'complete') {
                        return;
                    }
                } else {
                    if (!image.complete) {
                        return;
                    }
                }
            }
            // Else is canvas
            var width = style.width || image.width;
            var height = style.height || image.height;
            var x = style.x + __OP[0];
            var y = style.y + __OP[1];

            // å¾çå è½½å¤±è´¥
            if (!image.width || !image.height) {
                return;
            }

            ctx.save();

            this.doClip(ctx);

            this.setContext(ctx, style);

            // è®¾ç½®transform
            this.setTransform(ctx);

            if (style.sWidth && style.sHeight) {
                let sx = (style.sx + __OP[0]) || 0;
                let sy = (style.sy + __OP[1]) || 0;
                ctx.drawImage(
                    image,
                    sx, sy, style.sWidth, style.sHeight,
                    x, y, width, height
                );
            } else if (style.sx && style.sy) {
                let sx = style.sx + __OP[0];
                let sy = style.sy + __OP[1];
                var sWidth = width - sx;
                var sHeight = height - sy;
                ctx.drawImage(
                    image,
                    sx, sy, sWidth, sHeight,
                    x, y, width, height
                );
            } else {
                ctx.drawImage(image, x, y, width, height);
            }
            // å¦ææ²¡è®¾ç½®å®½åé«çè¯èªå¨æ ¹æ®å¾çå®½é«è®¾ç½®
            if (!style.width) {
                style.width = width;
            }
            if (!style.height) {
                style.height = height;
            }
            if (!this.style.width) {
                this.style.width = width;
            }
            if (!this.style.height) {
                this.style.height = height;
            }

            this.drawText(ctx, style, this.style);

            ctx.restore();
        }
    }


    /**
     * @function LevelRenderer.Shape.SmicImage.prototype.getRect
     * @description è®¡ç®è¿åå¾ççåå´çç©å½¢ã
     *
     * @param {Object} style - style
     * @return {Object} è¾¹æ¡å¯¹è±¡ãåå«å±æ§ï¼xï¼yï¼widthï¼heightã
     */
    getRect(style) {
        if (!this.refOriginalPosition || this.refOriginalPosition.length !== 2) {
            this.refOriginalPosition = [0, 0];
        }
        var __OP = this.refOriginalPosition;

        return {
            x: style.x + __OP[0],
            y: style.y + __OP[1],
            width: style.width,
            height: style.height
        };
    }


    /**
     * @function LevelRenderer.Shape.SmicImage.prototype.clearCache
     * @description æ¸é¤å¾çç¼å­ã
     *
     * @param {Object} style - style
     * @return {Object} è¾¹æ¡å¯¹è±¡ãåå«å±æ§ï¼xï¼yï¼widthï¼heightã
     *
     */
    clearCache() {
        this._imageCache = {};
    }

}
SmicImage._needsRefresh = [];
SmicImage._refreshTimeout = null;

;// CONCATENATED MODULE: ./src/common/overlay/levelRenderer/SmicRectangle.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @private
 * @class  LevelRenderer.Shape.SmicRectangle
 * @category Visualization Theme
 * @classdesc ç©å½¢ã
 * @extends LevelRenderer.Shape
 * @example
 *   var shape = new LevelRenderer.Shape.SmicRectangle({
 *         style: {
 *             x: 0,
 *             y: 0,
 *             width: 100,
 *             height: 100,
 *             radius: 20
 *         }
 *     });
 *   levelRenderer.addShape(shape);
 * @param {Array} options - shape çéç½®ï¼optionsï¼é¡¹ï¼å¯ä»¥æ¯ shape çèªæå±æ§ï¼ä¹å¯ä»¥æ¯èªå®ä¹çå±æ§ã
 */
class SmicRectangle extends Shape_Shape {
    constructor(options) {
        super(options);
        /**
         * @member {string} LevelRenderer.Shape.SmicRectangle.prototype.type
         * @description å¾å½¢ç±»å.
         */
        this.type = 'smicrectangle';
        if (!this.refOriginalPosition || this.refOriginalPosition.length !== 2) {
            this.refOriginalPosition = [0, 0];
        }
        this.CLASS_NAME = "SuperMap.LevelRenderer.Shape.SmicRectangle";
    }


    /**
     * @function LevelRenderer.Shape.SmicRectangle.prototype.destroy
     * @description éæ¯å¯¹è±¡ï¼éæ¾èµæºãè°ç¨æ­¤å½æ°åææå±æ§å°è¢«ç½®ä¸º nullã
     */
    destroy() {
        this.type = null;
        super.destroy();
    }


    /**
     * APIMethod: _buildRadiusPath
     * åå»ºç©å½¢çåè§è·¯å¾ã
     *
     * Parameters:
     * ctx - {CanvasRenderingContext2D} Context2D ä¸ä¸æã
     * style - {Object} styleã
     *
     */
    _buildRadiusPath(ctx, style) {
        if (!this.refOriginalPosition || this.refOriginalPosition.length !== 2) {
            this.refOriginalPosition = [0, 0];
        }
        var __OP = this.refOriginalPosition;

        // å·¦ä¸ãå³ä¸ãå³ä¸ãå·¦ä¸è§çåå¾ä¾æ¬¡ä¸ºr1ãr2ãr3ãr4
        // rç¼©åä¸º1         ç¸å½äº [1, 1, 1, 1]
        // rç¼©åä¸º[1]       ç¸å½äº [1, 1, 1, 1]
        // rç¼©åä¸º[1, 2]    ç¸å½äº [1, 2, 1, 2]
        // rç¼©åä¸º[1, 2, 3] ç¸å½äº [1, 2, 3, 2]
        var x = style.x + __OP[0];
        var y = style.y + __OP[1];
        var width = style.width;
        var height = style.height;
        var r = style.radius;
        var r1;
        var r2;
        var r3;
        var r4;

        if (typeof r === 'number') {
            r1 = r2 = r3 = r4 = r;
        } else if (r instanceof Array) {
            if (r.length === 1) {
                r1 = r2 = r3 = r4 = r[0];
            } else if (r.length === 2) {
                r1 = r3 = r[0];
                r2 = r4 = r[1];
            } else if (r.length === 3) {
                r1 = r[0];
                r2 = r4 = r[1];
                r3 = r[2];
            } else {
                r1 = r[0];
                r2 = r[1];
                r3 = r[2];
                r4 = r[3];
            }
        } else {
            r1 = r2 = r3 = r4 = 0;
        }

        var total;
        if (r1 + r2 > width) {
            total = r1 + r2;
            r1 *= width / total;
            r2 *= width / total;
        }
        if (r3 + r4 > width) {
            total = r3 + r4;
            r3 *= width / total;
            r4 *= width / total;
        }
        if (r2 + r3 > height) {
            total = r2 + r3;
            r2 *= height / total;
            r3 *= height / total;
        }
        if (r1 + r4 > height) {
            total = r1 + r4;
            r1 *= height / total;
            r4 *= height / total;
        }
        ctx.moveTo(x + r1, y);
        ctx.lineTo(x + width - r2, y);
        r2 !== 0 && ctx.quadraticCurveTo(
            x + width, y, x + width, y + r2
        );
        ctx.lineTo(x + width, y + height - r3);
        r3 !== 0 && ctx.quadraticCurveTo(
            x + width, y + height, x + width - r3, y + height
        );
        ctx.lineTo(x + r4, y + height);
        r4 !== 0 && ctx.quadraticCurveTo(
            x, y + height, x, y + height - r4
        );
        ctx.lineTo(x, y + r1);
        r1 !== 0 && ctx.quadraticCurveTo(x, y, x + r1, y);
    }


    /**
     * @function LevelRenderer.Shape.SmicRectangle.prototype.buildPath
     * @description åå»ºç©å½¢è·¯å¾ã
     *
     * @param {CanvasRenderingContext2D} ctx - Context2D ä¸ä¸æã
     * @param {Object} style - styleã
     *
     */
    buildPath(ctx, style) {
        if (!this.refOriginalPosition || this.refOriginalPosition.length !== 2) {
            this.refOriginalPosition = [0, 0];
        }
        var __OP = this.refOriginalPosition;

        if (!style.radius) {
            ctx.moveTo(style.x + __OP[0], style.y + __OP[1]);
            ctx.lineTo((style.x + __OP[0]) + style.width, (style.y + __OP[1]));
            ctx.lineTo((style.x + __OP[0]) + style.width, (style.y + __OP[1]) + style.height);
            ctx.lineTo((style.x + __OP[0]), (style.y + __OP[1]) + style.height);
            ctx.lineTo(style.x + __OP[0], style.y + __OP[1]);
            // ctx.rect(style.x, style.y, style.width, style.height);
        } else {
            this._buildRadiusPath(ctx, style);
        }
        ctx.closePath();
        return;
    }


    /**
     * @function LevelRenderer.Shape.SmicRectangle.prototype.getRect
     * @description è®¡ç®è¿åç©å½¢åå´çç©éµãè¯¥åå´çæ¯ç´æ¥ä»åä¸ªæ§å¶ç¹è®¡ç®ï¼å¹¶éæå°åå´çã
     *
     * @param {Object} style - style
     * @return {Object} è¾¹æ¡å¯¹è±¡ãåå«å±æ§ï¼xï¼yï¼widthï¼heightã
     */
    getRect(style) {
        if (!this.refOriginalPosition || this.refOriginalPosition.length !== 2) {
            this.refOriginalPosition = [0, 0];
        }
        var __OP = this.refOriginalPosition;

        if (style.__rect) {
            return style.__rect;
        }

        var lineWidth;
        if (style.brushType == 'stroke' || style.brushType == 'fill') {
            lineWidth = style.lineWidth || 1;
        } else {
            lineWidth = 0;
        }
        style.__rect = {
            x: Math.round((style.x + __OP[0]) - lineWidth / 2),
            y: Math.round((style.y + __OP[1]) - lineWidth / 2),
            width: style.width + lineWidth,
            height: style.height + lineWidth
        };

        return style.__rect;
    }

}

;// CONCATENATED MODULE: ./src/common/overlay/levelRenderer/SmicSector.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @private
 * @class  LevelRenderer.Shape.SmicSector
 * @category Visualization Theme
 * @classdesc æå½¢ã
 * @extends LevelRenderer.Shape
 * @example
 *   var shape = new LevelRenderer.Shape.SmicSector({
 *         style: {
 *             x: 100,
 *             y: 100,
 *             r: 60,
 *             r0: 30,
 *             startAngle: 0,
 *             endEngle: 180
 *         }
 *   });
 *   levelRenderer.addShape(shape);
 * @param {Array} options - shape çéç½®ï¼optionsï¼é¡¹ï¼å¯ä»¥æ¯ shape çèªæå±æ§ï¼ä¹å¯ä»¥æ¯èªå®ä¹çå±æ§ã
 *
 */
class SmicSector extends Shape_Shape {
    constructor(options) {
        super(options);
        /**
         * @member {string} LevelRenderer.Shape.SmicSector.protptype.type
         * @description å¾å½¢ç±»åã
         */
        this.type = 'smicsector';
        if (!this.refOriginalPosition || this.refOriginalPosition.length !== 2) {
            this.refOriginalPosition = [0, 0];
        }
        this.CLASS_NAME = "SuperMap.LevelRenderer.Shape.SmicSector";
    }

    /**
     * @function LevelRenderer.Shape.SmicSector.prototype.destroy
     * @description éæ¯å¯¹è±¡ï¼éæ¾èµæºãè°ç¨æ­¤å½æ°åææå±æ§å°è¢«ç½®ä¸º nullã
     */
    destroy() {
        this.type = null;
        super.destroy();
    }

    /**
     * @function LevelRenderer.Shape.SmicSector.prototype.buildPath
     * @description åå»ºæå½¢è·¯å¾ã
     *
     * @param {CanvasRenderingContext2D} ctx - Context2D ä¸ä¸æã
     * @param {Object} style - styleã
     *
     */
    buildPath(ctx, style) {
        if (!this.refOriginalPosition || this.refOriginalPosition.length !== 2) {
            this.refOriginalPosition = [0, 0];
        }
        var __OP = this.refOriginalPosition;

        var x = style.x + __OP[0];   // åå¿x
        var y = style.y + __OP[1];   // åå¿y
        var r0 = style.r0 || 0;     // å½¢ååå¾[0,r)
        var r = style.r;            // æå½¢å¤åå¾(0,r]
        var startAngle = style.startAngle;          // èµ·å§è§åº¦[0,360)
        var endAngle = style.endAngle;              // ç»æè§åº¦(0,360]
        var clockWise = style.clockWise || false;

        startAngle = SUtil_SUtil.Util_math.degreeToRadian(startAngle);
        endAngle = SUtil_SUtil.Util_math.degreeToRadian(endAngle);

        if (!clockWise) {
            // æå½¢é»è®¤æ¯éæ¶éæ¹åï¼Yè½´åä¸
            // è¿ä¸ªè·arcçæ åä¸ä¸æ ·ï¼ä¸ºäºå¼å®¹echarts
            startAngle = -startAngle;
            endAngle = -endAngle;
        }

        var unitX = SUtil_SUtil.Util_math.cos(startAngle);
        var unitY = SUtil_SUtil.Util_math.sin(startAngle);
        ctx.moveTo(
            unitX * r0 + x,
            unitY * r0 + y
        );

        ctx.lineTo(
            unitX * r + x,
            unitY * r + y
        );

        ctx.arc(x, y, r, startAngle, endAngle, !clockWise);

        ctx.lineTo(
            SUtil_SUtil.Util_math.cos(endAngle) * r0 + x,
            SUtil_SUtil.Util_math.sin(endAngle) * r0 + y
        );

        if (r0 !== 0) {
            ctx.arc(x, y, r0, endAngle, startAngle, clockWise);
        }

        ctx.closePath();

        return;
    }

    /**
     * @function LevelRenderer.Shape.SmicSector.prototype.getRect
     * @description è¿åæå½¢åå´çç©å½¢
     *
     * @param {Object} style - style
     * @return {Object} è¾¹æ¡å¯¹è±¡ãåå«å±æ§ï¼xï¼yï¼widthï¼heightã
     *
     */
    getRect(style) {
        if (style.__rect) {
            return style.__rect;
        }

        if (!this.refOriginalPosition || this.refOriginalPosition.length !== 2) {
            this.refOriginalPosition = [0, 0];
        }
        var __OP = this.refOriginalPosition;

        var min0 = SUtil_SUtil.Util_vector.create();
        var min1 = SUtil_SUtil.Util_vector.create();
        var max0 = SUtil_SUtil.Util_vector.create();
        var max1 = SUtil_SUtil.Util_vector.create();

        var x = style.x + __OP[0];   // åå¿x
        var y = style.y + __OP[1];   // åå¿y
        var r0 = style.r0 || 0;     // å½¢ååå¾[0,r)
        var r = style.r;            // æå½¢å¤åå¾(0,r]
        var startAngle = SUtil_SUtil.Util_math.degreeToRadian(style.startAngle);
        var endAngle = SUtil_SUtil.Util_math.degreeToRadian(style.endAngle);
        var clockWise = style.clockWise;

        if (!clockWise) {
            startAngle = -startAngle;
            endAngle = -endAngle;
        }

        if (r0 > 1) {
            SUtil_SUtil.Util_computeBoundingBox.arc(
                x, y, r0, startAngle, endAngle, !clockWise, min0, max0
            );
        } else {
            min0[0] = max0[0] = x;
            min0[1] = max0[1] = y;
        }
        SUtil_SUtil.Util_computeBoundingBox.arc(
            x, y, r, startAngle, endAngle, !clockWise, min1, max1
        );

        SUtil_SUtil.Util_vector.min(min0, min0, min1);
        SUtil_SUtil.Util_vector.max(max0, max0, max1);
        style.__rect = {
            x: min0[0],
            y: min0[1],
            width: max0[0] - min0[0],
            height: max0[1] - min0[1]
        };
        return style.__rect;
    }

}

;// CONCATENATED MODULE: ./src/common/overlay/feature/ShapeFactory.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


















/**
 * @class  FeatureShapeFactory
 * @aliasclass Feature.ShapeFactory
 * @deprecatedclass SuperMap.Feature.ShapeFactory
 * @category Visualization Theme
 * @classdesc å¾å½¢å·¥åç±»ã
 * ç®åæ¯æåå»ºçå¾å½¢æï¼<br>
 * ç¨äºç»è®¡ä¸é¢å¾ï¼<br>
 * ç¹ - åæ°å¯¹è±¡ <{@link ShapeParametersPoint}> <br>
 * çº¿ - åæ°å¯¹è±¡ <{@link ShapeParametersLine}> <br>
 * é¢ - åæ°å¯¹è±¡ <{@link ShapeParametersPolygon}> <br>
 * ç©å½¢ - åæ°å¯¹è±¡ <{@link ShapeParametersPolygon}> <br>
 * æå½¢ - åæ°å¯¹è±¡ <{@link ShapeParametersSector}> <br>
 * æ ç­¾ - åæ°å¯¹è±¡ <{@link ShapeParametersLabel}> <br>
 * å¾ç - åæ°å¯¹è±¡ <{@link ShapeParametersImage}> <br>
 * ç¨äºç¬¦å·ä¸é¢å¾ï¼<br>
 * åå½¢ -  åæ°å¯¹è±¡ï¼<{@link ShapeParametersCircle}>
 * @param {Object} [shapeParameters] - å¾å½¢åæ°å¯¹è±¡ï¼<{@link ShapeParameters}> å­ç±»å¯¹è±¡ã
 * @usage
 */
class ShapeFactory {
    constructor(shapeParameters) {
        /**
         * @member {Object} FeatureShapeFactory.prototype.shapeParameters
         * @description  å¾å½¢åæ°å¯¹è±¡ï¼<{@link ShapeParameters}> å­ç±»å¯¹è±¡ãå¿è®¾åæ°ï¼é»è®¤å¼ nullã
         */
        this.shapeParameters = shapeParameters;

        this.CLASS_NAME = "SuperMap.Feature.ShapeFactory";
    }


    /**
     * @function  FeatureShapeFactory.prototype.destroy
     * @description éæ¯å¾å½¢å·¥åç±»å¯¹è±¡ã
     */
    destroy() {
        this.shapeParameters = null;
    }


    /**
     * @function  FeatureShapeFactory.prototype.createShape
     * @description åå»ºä¸ä¸ªå¾å½¢ãå·ä½å¾å½¢ç± shapeParameters å³å®ã
     * @param {Object} shapeParameters - å¾å½¢åæ°å¯¹è±¡ï¼<{@link ShapeParameters}> å­ç±»å¯¹è±¡ã
     * æ­¤åæ°å¯éï¼å¦æä½¿ç¨æ­¤åæ°ï¼ä¸ä¸º nullï¼ï¼shapeParameters å±æ§å¼å°è¢«ä¿®æ¹ä¸ºåæ°çå¼ï¼ç¶ååä½¿ç¨ shapeParameters å±æ§å¼åå»ºå¾å½¢ï¼
     * å¦æä¸ä½¿ç¨æ­¤åæ°ï¼createShape æ¹æ³å°ç´æ¥ä½¿ç¨ shapeParameters å±æ§åå»ºå¾å½¢ã
     * @returns {Object} å¾å½¢å¯¹è±¡ï¼æ null - å¾å½¢åå»ºå¤±è´¥ï¼ã
     */
    createShape(shapeParameters) {
        if (shapeParameters) {
            this.shapeParameters = shapeParameters;
        }

        if (!this.shapeParameters) {
            return null;
        }

        var sps = this.shapeParameters;


        if (sps instanceof Point_Point) {        // ç¹
            //è®¾ç½®style
            let style = new Object();
            style["x"] = sps.x;
            style["y"] = sps.y;
            style["r"] = sps.r;

            style = Util.copyAttributesWithClip(style, sps.style, ['x', 'y']);

            //åå»ºå¾å½¢
            let shape = new SmicPoint();
            shape.style = ShapeFactory.transformStyle(style);
            shape.highlightStyle = ShapeFactory.transformStyle(sps.highlightStyle);
            Util.copyAttributesWithClip(shape, sps, ['x', 'y', 'style', 'highlightStyle']);

            return shape;
        } else if (sps instanceof Line_Line) {        // çº¿
            //æ£æ¥åæ° pointList æ¯å¦å­å¨
            if (!sps.pointList) {
                return null;
            }

            // è®¾ç½®style
            let style = new Object();
            style["pointList"] = sps.pointList;
            style = Util.copyAttributesWithClip(style, sps.style, ['pointList']);

            // åå»ºå¾å½¢
            let shape = new SmicBrokenLine();
            shape.style = ShapeFactory.transformStyle(style);
            shape.highlightStyle = ShapeFactory.transformStyle(sps.highlightStyle);
            Util.copyAttributesWithClip(shape, sps, ['pointList', 'style', 'highlightStyle']);

            return shape;
        } else if (sps instanceof Polygon_Polygon) {        // é¢
            //æ£æ¥åæ° pointList æ¯å¦å­å¨
            if (!sps.pointList) {
                return null;
            }

            //è®¾ç½®style
            let style = new Object();
            style["pointList"] = sps.pointList;
            style = Util.copyAttributesWithClip(style, sps.style, ['pointList']);

            //åå»ºå¾å½¢
            let shape = new SmicPolygon();
            shape.style = ShapeFactory.transformStyle(style);
            shape.highlightStyle = ShapeFactory.transformStyle(sps.highlightStyle);
            Util.copyAttributesWithClip(shape, sps, ['pointList', 'style', "highlightStyle"]);

            return shape;
        } else if (sps instanceof Rectangle_Rectangle) {        // ç©å½¢
            //æ£æ¥åæ° pointList æ¯å¦å­å¨
            if (!sps.x && !sps.y & !sps.width & !sps.height) {
                return null;
            }

            //è®¾ç½®style
            let style = new Object();
            style["x"] = sps.x;
            style["y"] = sps.y;
            style["width"] = sps.width;
            style["height"] = sps.height;

            style = Util.copyAttributesWithClip(style, sps.style, ['x', 'y', 'width', 'height']);

            //åå»ºå¾å½¢
            let shape = new SmicRectangle();
            shape.style = ShapeFactory.transformStyle(style);
            shape.highlightStyle = ShapeFactory.transformStyle(sps.highlightStyle);
            Util.copyAttributesWithClip(shape, sps, ['x', 'y', 'width', 'height', 'style', 'highlightStyle']);

            return shape;
        } else if (sps instanceof Sector) {        // æå½¢
            //è®¾ç½®style
            let style = new Object();
            style["x"] = sps.x;
            style["y"] = sps.y;
            style["r"] = sps.r;
            style["startAngle"] = sps.startAngle;
            style["endAngle"] = sps.endAngle;
            if (sps["r0"]) {
                style["r0"] = sps.r0
            }

            if (sps["clockWise"]) {
                style["clockWise"] = sps.clockWise
            }


            style = Util.copyAttributesWithClip(style, sps.style, ['x', 'y', 'r', 'startAngle', 'endAngle', 'r0', 'endAngle']);

            //åå»ºå¾å½¢
            let shape = new SmicSector();
            shape.style = ShapeFactory.transformStyle(style);
            shape.highlightStyle = ShapeFactory.transformStyle(sps.highlightStyle);
            Util.copyAttributesWithClip(shape, sps, ['x', 'y', 'r', 'startAngle', 'endAngle', 'r0', 'endAngle', 'style', 'highlightStyle']);

            return shape;
        } else if (sps instanceof Label) {        // æ ç­¾
            //è®¾ç½®style
            let style = new Object();
            style["x"] = sps.x;
            style["y"] = sps.y;
            style["text"] = sps.text;

            style = Util.copyAttributesWithClip(style, sps.style, ['x', 'y', 'text']);

            //åå»ºå¾å½¢
            let shape = new SmicText();
            shape.style = ShapeFactory.transformStyle(style);
            shape.highlightStyle = ShapeFactory.transformStyle(sps.highlightStyle);
            Util.copyAttributesWithClip(shape, sps, ['x', 'y', 'text', 'style', 'highlightStyle']);

            return shape;
        } else if (sps instanceof Image_Image) {        // å¾ç
            //è®¾ç½®style
            let style = new Object();
            style["x"] = sps.x;
            style["y"] = sps.y;
            if (sps["image"]) {
                style["image"] = sps.image;
            }
            if (sps["width"]) {
                style["width"] = sps.width;
            }
            if (sps["height"]) {
                style["height"] = sps.height;
            }
            if (sps["sx"]) {
                style["sx"] = sps.sx;
            }
            if (sps["sy"]) {
                style["sy"] = sps.sy;
            }
            if (sps["sWidth"]) {
                style["sWidth"] = sps.sWidth
            }
            if (sps["sHeight"]) {
                style["sHeight"] = sps.sHeight
            }

            style = Util.copyAttributesWithClip(style, sps.style, ['x', 'y', 'image', 'width', 'height', 'sx', 'sy', 'sWidth', 'sHeight']);

            //åå»ºå¾å½¢
            let shape = new SmicImage();
            shape.style = ShapeFactory.transformStyle(style);
            shape.highlightStyle = ShapeFactory.transformStyle(sps.highlightStyle);
            Util.copyAttributesWithClip(shape, sps, ['x', 'y', 'image', 'width', 'height', 'style', 'highlightStyle']);

            return shape;
        } else if (sps instanceof Circle_Circle) {       //åå½¢ ç¨äºç¬¦å·ä¸é¢å¾
            //è®¾ç½®stytle
            let style = new Object();
            style["x"] = sps.x;
            style["r"] = sps.r;
            style["y"] = sps.y;

            style = Util.copyAttributesWithClip(style, sps.style, ['x', 'y', 'r']);

            //åå»ºå¾å½¢
            let shape = new SmicCircle();
            shape.style = ShapeFactory.transformStyle(style);
            shape.highlightStyle = ShapeFactory.transformStyle(sps.highlightStyle);
            Util.copyAttributesWithClip(shape, sps, ['x', 'y', 'r', 'style', 'highlightStyle', 'lineWidth', 'text', 'textPosition']);

            return shape;
        }

        return null
    }


    /**
     * @function  FeatureShapeFactory.prototype.transformStyle
     * @description å°ç¨æ· feature.style (ç±» Svg style æ å) çæ ·å¼ï¼è½¬æ¢ä¸º levelRenderer çæ ·å¼æ åï¼ç±» CSS-Canvas æ ·å¼ï¼
     * @param {Object} style - ç¨æ· styleã
     * @returns {Object} ç¬¦å levelRenderer ç styleã
     */
    static transformStyle(style) {
        var newStyle = {};

        //å­ä½ ["font-style", "font-variant", "font-weight", "font-size / line-height", "font-family"];
        var fontStr = ["normal", "normal", "normal", "12", "arial,sans-serif"];

        //ç»ç¬ç±»å ["fill", "stroke"];
        var brushType = [true, false];

        for (var ss in style) {
            switch (ss) {
                case "fill":
                    brushType[0] = style[ss];
                    break;
                case "fillColor":
                    newStyle["color"] = style[ss];
                    break;
                case "stroke":
                    brushType[1] = style[ss];
                    break;
                case "strokeWidth":
                    newStyle["lineWidth"] = style[ss];
                    break;
                case "strokeLinecap":
                    newStyle["lineCap"] = style[ss];
                    break;
                case "strokeLineJoin":
                    newStyle["lineJoin"] = style[ss];
                    break;
                case "strokeDashstyle":
                    newStyle["lineType"] = style[ss];
                    break;
                case "pointRadius":
                    newStyle["r"] = style[ss];
                    break;
                case "label":
                    newStyle["text"] = style[ss];
                    break;
                case "labelRect":
                    newStyle["labelRect"] = style[ss];
                    break;
                case "fontColor":
                    newStyle["textColor"] = style[ss];
                    break;
                case "fontStyle":
                    fontStr[0] = style[ss];
                    break;
                case "fontVariant":
                    fontStr[1] = style[ss];
                    break;
                case "fontWeight":
                    fontStr[2] = style[ss];
                    break;
                case "fontSize":
                    var unit = "";
                    if (style[ss] && style[ss].toString().indexOf("px") < 0) {
                        unit = "px";
                    }
                    fontStr[3] = style[ss] + unit;
                    break;
                case "fontFamily":
                    fontStr[4] = style[ss];
                    break;
                case "fontOpacity":
                    newStyle["opacity"] = style[ss];
                    break;
                case "labelPosition":
                    newStyle["textPosition"] = style[ss];
                    break;
                case "labelAlign":
                    newStyle["textAlign"] = style[ss];
                    break;
                case "labelBaseline":
                    newStyle["textBaseline"] = style[ss];
                    break;
                case "labelRotation":
                    newStyle["textRotation"] = style[ss];
                    break;

                default:
                    newStyle[ss] = style[ss];
                    break;
            }
        }

        //æ¼æ¥å­ä½å­ç¬¦ä¸²
        newStyle["textFont"] = fontStr.join(" ");

        //ç»ç¬ç±»å
        if (brushType[0] === true && brushType[1] === false) {
            newStyle["brushType"] = "fill";
        } else if (brushType[0] === false && brushType[1] === true) {
            newStyle["brushType"] = "stroke";
        } else if (brushType[0] === true && brushType[1] === true) {
            newStyle["brushType"] = "both";
        } else {
            newStyle["brushType"] = "fill";
        }

        //é»è®¤çº¿å®½ 1
        if (newStyle["lineWidth"] == null) {
            newStyle["lineWidth"] = 1;
        }

        return newStyle;
    }

    /**
     * @function  FeatureShapeFactory.prototype.Background
     * @description åå»ºä¸ä¸ªç©å½¢èæ¯æ¡å¾å½¢å¯¹è±¡ã
     * @param {FeatureShapeFactory} shapeFactory - å¾å½¢å·¥åå¯¹è±¡ã
     * @param {Array.<number>} box - æ¡åºåï¼é¿åº¦ä¸º 4 çä¸ç»´æ°ç»ï¼åç´ åæ ï¼[left, bottom, right, top]ã
     * @param {Object} setting - å¾è¡¨éç½®åæ°ãæ¬å½æ°ä¸­å¾å½¢éç½®å¯¹è±¡ setting å¯è®¾å±æ§ï¼
     * @param {Object} setting.backgroundStyle - èæ¯æ ·å¼ï¼æ­¤æ ·å¼å¯¹è±¡å¯¹è±¡å¯è®¾å±æ§ï¼<ShapeParametersRectangle#style>ã
     * @param {Array.<number>} [setting.backgroundRadius=[0,0,0,0]] - èæ¯æ¡ç©å½¢åè§åå¾ï¼å¯ä»¥ç¨æ°ç»åå«æå®åä¸ªè§çåè§åå¾ï¼è®¾ï¼å·¦ä¸ãå³ä¸ãå³ä¸ãå·¦ä¸è§çåå¾ä¾æ¬¡ä¸º r1ãr2ãr3ãr4ï¼å backgroundRadius ä¸º [r1ãr2ãr3ãr4 ]ã
     * @returns {Object} èæ¯æ¡å¾å½¢ï¼ä¸ä¸ªå¯è§åå¾å½¢ï¼ç©å½¢ï¼å¯¹è±¡ã
     */
    static Background(shapeFactory, box, setting) {
        var sets = setting ? setting : {};

        // èæ¯æ¡å¾å½¢åæ°å¯¹è±¡
        var bgSP = new Rectangle_Rectangle(box[0], box[3], Math.abs(box[2] - box[0]), Math.abs(box[3] - box[1]));

        // é»è®¤æ ·å¼
        bgSP.style = {
            fillColor: "#f3f3f3"
        };

        // è®¾ç½®ç¨æ· style
        if (sets.backgroundStyle) {
            Util.copyAttributesWithClip(bgSP.style, sets.backgroundStyle);
        }

        // è®¾ç½®èæ¯æ¡åè§åæ°
        if (sets.backgroundRadius) {
            bgSP.style["radius"] = sets.backgroundRadius;
        }

        // ç¦æ­¢èæ¯æ¡ååºäºä»¶
        bgSP.clickable = false;
        bgSP.hoverable = false;

        return shapeFactory.createShape(bgSP);
    }

    /**
     * @function  FeatureShapeFactory.prototype.GraphAxis
     * @description åå»ºä¸ä¸ªç»è®¡å¾è¡¨åæ è½´å¾å½¢å¯¹è±¡ç»ã
     * @param {FeatureShapeFactory} shapeFactory - å¾å½¢å·¥åå¯¹è±¡ã
     * @param {Array.<number>} dataViewBox - ç»è®¡å¾è¡¨æ¨¡åçæ°æ®è§å¾æ¡ï¼é¿åº¦ä¸º 4 çä¸ç»´æ°ç»ï¼åç´ åæ ï¼[left, bottom, right, top]ã
     * @param {Object} setting - å¾è¡¨éç½®åæ°ã
     * @param {Object} setting.axisStyle - åæ è½´æ ·å¼ï¼æ­¤æ ·å¼å¯¹è±¡å¯¹è±¡å¯è®¾å±æ§ï¼<ShapeParametersLine#style>ã
     * @param {boolean} [setting.axisUseArrow=false] - åæ è½´æ¯å¦ä½¿ç¨ç®­å¤´ã
     * @param {number} [setting.axisYTick=0] - y è½´å»åº¦æ°éï¼0è¡¨ç¤ºä¸ä½¿ç¨ç®­å¤´ã
     * @param {Array.<string>} setting.axisYLabels - y è½´ä¸çæ ç­¾ç»åå®¹ï¼æ ç­¾é¡ºåºæ²¿çæ°æ®è§å¾æ¡å·¦é¢æ¡è¾¹èªä¸èä¸ï¼ç­è·æå¸ãä¾å¦ï¼["1000", "750", "500", "250", "0"]ã
     * @param {Object} setting.axisYLabelsStyle - y è½´ä¸çæ ç­¾ç»æ ·å¼ï¼æ­¤æ ·å¼å¯¹è±¡å¯¹è±¡å¯è®¾å±æ§ï¼<ShapeParametersLabel#style>ã
     * @param {Array.<number>} [setting.axisYLabelsOffset=[0,0]] - y è½´ä¸çæ ç­¾ç»åç§»éãé¿åº¦ä¸º 2 çæ°ç»ï¼æ°ç»ç¬¬ä¸é¡¹è¡¨ç¤º y è½´æ ç­¾ç»æ¨ªåä¸çåç§»éï¼åå·¦ä¸ºæ­£ï¼é»è®¤å¼ï¼0ï¼æ°ç»ç¬¬äºé¡¹è¡¨ç¤º y è½´æ ç­¾ç»çºµåä¸çåç§»éï¼åä¸ä¸ºæ­£ï¼é»è®¤å¼ï¼0ã
     * @param {Array.<string>} setting.axisXLabels - x è½´ä¸çæ ç­¾ç»åå®¹ï¼æ ç­¾é¡ºåºæ²¿çæ°æ®è§å¾æ¡ä¸é¢æ¡è¾¹èªå·¦åå³æå¸ï¼ä¾å¦ï¼["92å¹´", "95å¹´", "99å¹´"]ã
     * æ ç­¾æå¸è§åï¼å½æ ç­¾æ°éä¸ xShapeInfo ä¸­çå±æ§ xPositions æ°éç¸åï¼å³æ ç­¾ä¸ªæ°ä¸æ°æ®ä¸ªæ°ç¸ç­æ¶ï¼, æç§ xPositions æä¾çä½ç½®å¨æ°´å¹³æ¹åä¸æå¸æ ç­¾ï¼å¦åæ²¿æ°æ®è§å¾æ¡ä¸é¢æ¡è¾¹ç­è·æå¸æ ç­¾ã
     * @param {Object} setting.axisXLabelsStyle - x è½´ä¸çæ ç­¾ç»æ ·å¼ï¼æ­¤æ ·å¼å¯¹è±¡å¯¹è±¡å¯è®¾å±æ§ï¼<ShapeParametersLabel#style>ã
     * @param {Array.<number>} [setting.axisXLabelsOffset=[0,0]] - x è½´ä¸çæ ç­¾ç»åç§»éãé¿åº¦ä¸º 2 çæ°ç»ï¼æ°ç»ç¬¬ä¸é¡¹è¡¨ç¤º x è½´æ ç­¾ç»æ¨ªåä¸çåç§»éï¼åå·¦ä¸ºæ­£ï¼é»è®¤å¼ï¼0ï¼æ°ç»ç¬¬äºé¡¹è¡¨ç¤º x è½´æ ç­¾ç»çºµåä¸çåç§»éï¼åä¸ä¸ºæ­£ï¼é»è®¤å¼ï¼0ã
     * @param {boolean} setting.useXReferenceLine - æ¯å¦ä½¿ç¨æ°´å¹³åèçº¿ï¼å¦æä¸º trueï¼å¨ axisYTick å¤§äº 0 æ¶ææï¼æ°´å¹³åèçº¿æ¯ y è½´å»åº¦å¨æ°æ®è§å¾æ¡éçå»¶ä¼¸ã
     * @param {Object} setting.xReferenceLineStyle - æ°´å¹³åèçº¿æ ·å¼ï¼æ­¤æ ·å¼å¯¹è±¡å¯¹è±¡å¯è®¾å±æ§ï¼<ShapeParametersLine#style>ã
     * @param {number} [setting.axis3DParameter=0] - 3D åæ è½´åæ°ï¼æ­¤å±æ§å¼å¨å¤§äºç­äº 15 æ¶ææã
     * @param {Object} xShapeInfo - X æ¹åä¸çå¾å½¢ä¿¡æ¯å¯¹è±¡ï¼åå«ä¸¤ä¸ªå±æ§ã
     * @param {Array.<number>} xShapeInfo.xPositions - å¾å½¢å¨ x è½´æ¹åä¸çåç´ åæ å¼ï¼æ¯ä¸ä¸ªä¸ç»´æ°ç»ï¼å¦æå¾å½¢å¨ x æ¹åä¸æä¸å®å®½åº¦ï¼éå¸¸åå¾å½¢å¨ x æ¹åä¸çä¸­å¿ç¹ä¸ºå¾å½¢å¨ x æ¹åä¸çåæ å¼ã
     * @param {number} xShapeInfo.width - å¾å½¢çå®½åº¦ï¼ç¹å«æ³¨æï¼ç¹çå®½åº¦å§ç»ä¸º 0ï¼èä¸æ¯å¶ç´å¾ï¼ã
     * @returns {Array.<Object>} ç»è®¡å¾è¡¨åæ è½´å¾å½¢å¯¹è±¡æ°ç»ã
     */
    static GraphAxis(shapeFactory, dataViewBox, setting, xShapeInfo) {
        var dvb = dataViewBox;
        var sets = setting ? setting : {};

        // åèçº¿å¾å½¢å¯¹è±¡ç»
        var refLines = [];
        //åæ è½´ç®­å¤´å¯¹è±¡ç»
        var arrows = [];
        // æ¯å¦ä½¿ç¨åæ°´å¹³èçº¿ï¼é»è®¤ä¸ä½¿ç¨
        var isAddRefLine = sets.useXReferenceLine ? sets.useXReferenceLine : false;
        // y è½´ä¸çå»åº¦
        var axisytick = (sets.axisYTick && !isNaN(sets.axisYTick)) ? sets.axisYTick : 0;
        // åæ è½´èç¹æ°ç»
        var pois = [];
        //z è½´ç®­å¤´æ°ç»
        var zArrowPois = [];
        // x,y è½´ä¸»å¹²èç¹æ°ç»
        var xMainPois = [];
        if (axisytick == 0) {
            xMainPois.push([dvb[0], dvb[3] - 5]);
            xMainPois.push([dvb[0], dvb[1]]);

            // 3D åæ è½´  ç¬¬ä¸è±¡éå¹³åçº¿
            if (sets.axis3DParameter && !isNaN(sets.axis3DParameter) && sets.axis3DParameter >= 15) {
                let axis3DParameter = parseInt(sets.axis3DParameter);
                let axis3DPoi = [dvb[0] - axis3DParameter, dvb[1] + axis3DParameter];

                // æ·»å  3D è½´èç¹
                if (sets.axisUseArrow) {      // æ·»å  3D è½´ç®­å¤´èç¹åæ 
                    //ç®­å¤´åæ 
                    zArrowPois.push([axis3DPoi[0] + 1.5, axis3DPoi[1] - 7.5]);
                    zArrowPois.push([axis3DPoi[0] - 1, axis3DPoi[1] + 1]);
                    zArrowPois.push([axis3DPoi[0] + 7.5, axis3DPoi[1] - 1.5]);
                    //3Dè½´
                    xMainPois.push([axis3DPoi[0], axis3DPoi[1]]);
                } else {
                    xMainPois.push([axis3DPoi[0], axis3DPoi[1]]);
                }

                xMainPois.push([dvb[0], dvb[1]]);
            }
            xMainPois.push([dvb[2] + 5, dvb[1]]);
        } else {
            // åä½å»åº¦é¿åº¦
            var unitTick = Math.abs(dvb[1] - dvb[3]) / axisytick;
            // å»åº¦ y åæ 
            var thckY = dvb[3];

            xMainPois.push([dvb[0], thckY - 5]);

            for (var i = 0; i < axisytick; i++) {
                xMainPois.push([dvb[0], thckY]);
                xMainPois.push([dvb[0] - 5, thckY]);
                xMainPois.push([dvb[0], thckY]);

                // åèçº¿
                if (isAddRefLine) {
                    // åèçº¿åæ°å¯¹è±¡
                    var refLineSP = new Line_Line([
                        [dvb[0], thckY],
                        [dvb[2], thckY]
                    ]);
                    // åèçº¿é»è®¤æ ·å¼å¯¹è±¡
                    refLineSP.style = {
                        strokeColor: "#cfcfcf",
                        strokeLinecap: "butt",
                        strokeLineJoin: "round",
                        strokeWidth: 1
                    };
                    // ç¦æ­¢äºä»¶
                    refLineSP.clickable = false;
                    refLineSP.hoverable = false;
                    // ç¨æ·style
                    if (sets.xReferenceLineStyle) {
                        Util.copyAttributesWithClip(refLineSP.style, sets.xReferenceLineStyle);
                    }
                    // çæåèçº¿å¾å½¢å¯¹è±¡
                    refLines.push(shapeFactory.createShape(refLineSP))
                }

                // y å»åº¦å¢é
                thckY += unitTick;
            }

            xMainPois.push([dvb[0], dvb[1]]);

            // 3D åæ è½´  ç¬¬ä¸è±¡éå¹³åçº¿
            if (sets.axis3DParameter && !isNaN(sets.axis3DParameter) && sets.axis3DParameter >= 15) {
                let axis3DParameter = parseInt(sets.axis3DParameter);
                let axis3DPoi = [dvb[0] - axis3DParameter, dvb[1] + axis3DParameter];

                /*
                 // ç®­å¤´è®¡ç®è¿ç¨
                 var axis3DPoiRef = [axis3DPoi[0] + 7, axis3DPoi[1] - 7];  // 7 æ¯ 10 ä¸ºæè¾¹ cosï¼45åº¦ï¼æ¶é»è¾¹çå¼
                 var axis3DPoiLT = [axis3DPoiRef[0] - 4, axis3DPoiRef[1] - 4];
                 var axis3DPoiRB = [axis3DPoiRef[0] + 4, axis3DPoiRef[1] + 4];
                 if(sets.axisUseArrow){
                 xMainPois.push([axis3DPoi[0], axis3DPoi[1]]);
                 xMainPois.push([axis3DPoiLT[0], axis3DPoiLT[1]]);
                 xMainPois.push([axis3DPoi[0], axis3DPoi[1]]);
                 xMainPois.push([axis3DPoiRB[0], axis3DPoiRB[1]]);
                 xMainPois.push([axis3DPoi[0], axis3DPoi[1]]);
                 }
                 else{
                 xMainPois.push([axis3DPoi[0], axis3DPoi[1]]);
                 }
                 */

                // æ·»å  3D è½´èç¹
                if (sets.axisUseArrow) {      // æ·»å  3D è½´åç®­å¤´åæ 
                    //ç®­å¤´åæ 
                    zArrowPois.push([axis3DPoi[0] + 1.5, axis3DPoi[1] - 7.5]);
                    zArrowPois.push([axis3DPoi[0] - 1, axis3DPoi[1] + 1]);
                    zArrowPois.push([axis3DPoi[0] + 7.5, axis3DPoi[1] - 1.5]);
                    //3Dè½´
                    xMainPois.push([axis3DPoi[0], axis3DPoi[1]]);
                } else {
                    xMainPois.push([axis3DPoi[0], axis3DPoi[1]]);
                }

                xMainPois.push([dvb[0], dvb[1]]);
            }

            xMainPois.push([dvb[2] + 5, dvb[1]]);
        }
        // åæ è½´ç®­å¤´
        if (sets.axisUseArrow) {
            // x è½´ç®­å¤´èç¹æ°ç»
            var xArrowPois = [
                [dvb[2] + 5, dvb[1] + 4],
                [dvb[2] + 13, dvb[1]],
                [dvb[2] + 5, dvb[1] - 4]
            ];

            // y è½´ç®­å¤´èç¹æ°ç»
            var yArrowPois = [
                [dvb[0] - 4, dvb[3] - 5],
                [dvb[0], dvb[3] - 13],
                [dvb[0] + 4, dvb[3] - 5]
            ];

            //xè½´ç®­å¤´
            var xSP = new Polygon_Polygon(xArrowPois);
            xSP.style = {fillColor: "#008acd"};
            Util.copyAttributesWithClip(xSP.style, sets.axisStyle);
            arrows.push(shapeFactory.createShape(xSP));

            //yè½´ç®­å¤´
            var ySP = new Polygon_Polygon(yArrowPois);
            ySP.style = {fillColor: "#008acd"};
            Util.copyAttributesWithClip(ySP.style, sets.axisStyle);
            arrows.push(shapeFactory.createShape(ySP));

            // zè½´ç®­å¤´ åæ è½´ç®­å¤´æ¯å¦è¦ä½¿ç¨
            if (sets.axis3DParameter && !isNaN(sets.axis3DParameter) && sets.axis3DParameter >= 15) {
                var zSP = new Polygon_Polygon(zArrowPois);
                zSP.style = {fillColor: "#008acd"};
                Util.copyAttributesWithClip(zSP.style, sets.axisStyle);
                arrows.push(shapeFactory.createShape(zSP));
            }

        }
        //ä¸å¸¦ç®­å¤´çåæ è½´
        pois = xMainPois;

        // åæ è½´åæ°å¯¹è±¡
        var axisSP = new Line_Line(pois);
        // åæ è½´é»è®¤style
        axisSP.style = {
            strokeLinecap: "butt",
            strokeLineJoin: "round",
            strokeColor: "#008acd",
            strokeWidth: 1
        };
        // ç¨æ· style
        if (sets.axisStyle) {
            Util.copyAttributesWithClip(axisSP.style, sets.axisStyle);
        }
        // ç¦æ­¢äºä»¶
        axisSP.clickable = false;
        axisSP.hoverable = false;
        // åå»ºåæ è½´å¾å½¢å¯¹è±¡
        var axisMain = [shapeFactory.createShape(axisSP)];

        // Y è½´æ ç­¾
        var yLabels = [];
        if (sets.axisYLabels && sets.axisYLabels.length && sets.axisYLabels.length > 0) {
            var axisYLabels = sets.axisYLabels;
            let len = axisYLabels.length;

            // æ ç­¾åç§»é
            var ylOffset = [0, 0];
            if (sets.axisYLabelsOffset && sets.axisYLabelsOffset.length) {
                ylOffset = sets.axisYLabelsOffset;
            }

            if (len == 1) {
                // æ ç­¾åæ°å¯¹è±¡
                let labelYSP = new Label(dvb[0] - 5 + ylOffset[0], dvb[3] + ylOffset[1], axisYLabels[0]);
                labelYSP.style = {
                    labelAlign: "right"
                };
                // ç¨æ· style
                if (sets.axisYLabelsStyle) {
                    Util.copyAttributesWithClip(labelYSP.style, sets.axisYLabelsStyle);
                }
                // ç¦æ­¢äºä»¶
                labelYSP.clickable = false;
                labelYSP.hoverable = false;
                // å¶ä½æ ç­¾
                yLabels.push(shapeFactory.createShape(labelYSP));
            } else {
                var labelY = dvb[3];
                // y è½´æ ç­¾åä½è·ç¦»
                var yUnit = Math.abs(dvb[1] - dvb[3]) / (len - 1);

                for (var j = 0; j < len; j++) {
                    // æ ç­¾åæ°å¯¹è±¡
                    let labelYSP = new Label(dvb[0] - 5 + ylOffset[0], labelY + ylOffset[1], axisYLabels[j]);
                    labelYSP.style = {
                        labelAlign: "right"
                    };
                    // ç¨æ· style
                    if (sets.axisYLabelsStyle) {
                        Util.copyAttributesWithClip(labelYSP.style, sets.axisYLabelsStyle);
                    }
                    // ç¦æ­¢äºä»¶
                    labelYSP.clickable = false;
                    labelYSP.hoverable = false;
                    // å¶ä½æ ç­¾
                    yLabels.push(shapeFactory.createShape(labelYSP));
                    // y è½´æ ç­¾ y æ¹åå¢é
                    labelY += yUnit;
                }
            }
        }

        // X è½´æ ç­¾
        var xLabels = [];
        if (sets.axisXLabels && sets.axisXLabels.length && sets.axisXLabels.length > 0) {
            let axisXLabels = sets.axisXLabels;
            let len = axisXLabels.length;

            // æ ç­¾åç§»é
            let xlOffset = [0, 0];
            if (sets.axisXLabelsOffset && sets.axisXLabelsOffset.length) {
                xlOffset = sets.axisXLabelsOffset;
            }

            // æ ç­¾ä¸ªæ°ä¸æ°æ®å­æ®µä¸ªæ°ç¸ç­ç­æ¶ï¼æ ç­¾å¨ x è½´ååæå
            if (xShapeInfo && xShapeInfo.xPositions && xShapeInfo.xPositions.length && xShapeInfo.xPositions.length == len) {
                let xsCenter = xShapeInfo.xPositions;
                for (let K = 0; K < len; K++) {
                    // æ ç­¾åæ°å¯¹è±¡
                    let labelXSP = new Label(xsCenter[K] + xlOffset[0], dvb[1] + xlOffset[1], axisXLabels[K]);
                    // é»è®¤ style
                    labelXSP.style = {
                        labelAlign: "center",
                        labelBaseline: "top"
                    };
                    // ç¨æ· style
                    if (sets.axisXLabelsStyle) {
                        Util.copyAttributesWithClip(labelXSP.style, sets.axisXLabelsStyle);
                    }
                    // ç¦æ­¢äºä»¶
                    labelXSP.clickable = false;
                    labelXSP.hoverable = false;
                    // åå»ºæ ç­¾å¯¹è±¡
                    xLabels.push(shapeFactory.createShape(labelXSP));
                }
            } else {
                if (len == 1) {
                    // æ ç­¾åæ°å¯¹è±¡
                    let labelXSP = new Label(dvb[0] - 5 + xlOffset[0], dvb[1] + xlOffset[0], axisXLabels[0]);
                    // é»è®¤ style
                    labelXSP.style = {
                        labelAlign: "center",
                        labelBaseline: "top"
                    };
                    // ç¨æ· style
                    if (sets.axisXLabelsStyle) {
                        Util.copyAttributesWithClip(labelXSP.style, sets.axisXLabelsStyle);
                    }
                    // ç¦æ­¢äºä»¶
                    labelXSP.clickable = false;
                    labelXSP.hoverable = false;
                    // åå»ºæ ç­¾å¯¹è±¡
                    xLabels.push(shapeFactory.createShape(labelXSP));
                } else {
                    let labelX = dvb[0];
                    // x è½´æ ç­¾åä½è·ç¦»
                    let xUnit = Math.abs(dvb[2] - dvb[0]) / (len - 1);

                    for (let m = 0; m < len; m++) {
                        // æ ç­¾åæ°å¯¹è±¡
                        let labelXSP = new Label(labelX + xlOffset[0], dvb[1] + xlOffset[1], axisXLabels[m]);
                        // é»è®¤ style
                        labelXSP.style = {
                            labelAlign: "center",
                            labelBaseline: "top"
                        };
                        // ç¨æ· style
                        if (sets.axisXLabelsStyle) {
                            Util.copyAttributesWithClip(labelXSP.style, sets.axisXLabelsStyle);
                        }
                        // ç¦æ­¢äºä»¶
                        labelXSP.clickable = false;
                        labelXSP.hoverable = false;
                        // åå»ºæ ç­¾å¯¹è±¡
                        xLabels.push(shapeFactory.createShape(labelXSP));
                        // x è½´æ ç­¾ x æ¹åå¢é
                        labelX += xUnit;
                    }
                }
            }
        }

        // ç»è£å¹¶è¿åææåæ è½´çå¾å½¢
        return ((refLines.concat(axisMain)).concat(yLabels)).concat(xLabels).concat(arrows);
    }

    /**
     * @function  FeatureShapeFactory.prototype.ShapeStyleTool
     * @description ä¸ä¸ªå¾å½¢ style å¤çå·¥å·ãæ­¤å·¥å·å°æå®çé»è®¤ styleï¼éç¨ styleï¼æ styleGroup åå¾ç style åææ°æ®å¼ value èå´åå¾ç style è¿è¡åå¹¶ï¼å¾å°å¾å½¢æç»ç styleã
     * @param {Object} defaultStyle - é»è®¤styleï¼æ­¤æ ·å¼å¯¹è±¡å¯è®¾å±æ§æ ¹æ®å¾å½¢ç±»ååè <{@link ShapeParameters}> å­ç±»å¯¹è±¡ç style å±æ§ã
     * @param {Object} style - å¾å½¢å¯¹è±¡åºç¡ styleï¼æ­¤åæ°æ§å¶å¾å½¢çåºç¡æ ·å¼ï¼å¯è®¾å±æ§æ ¹æ®å¾å½¢ç±»ååè <{@link ShapeParameters}> å­ç±»å¯¹è±¡ç style å±æ§ãä¼åçº§ä½äº styleGroupï¼styleByCodomainã
     * @param {Array.<Object>} styleGroup - ä¸ä¸ª style æ°ç»ï¼ä¼åçº§ä½äº styleByCodomainï¼é«äº styleãæ­¤æ°ç»æ¯ä¸ªåç´ æ¯æ ·å¼å¯¹è±¡ï¼
     * å¶å¯è®¾å±æ§æ ¹æ®å¾å½¢ç±»ååè <{@link ShapeParameters}> å­ç±»å¯¹è±¡ç style å±æ§ãéè¿ index åæ°ä» styleGroup ä¸­å styleã
     * @param {Array.<Object>} styleByCodomain - ææ°æ®ï¼åæ° valueï¼æå¨å¼åèå´æ§å¶æ°æ®çå¯è§åå¯¹è±¡æ ·å¼ã
     * (start code)
     * // styleByCodomain çæ¯ä¸ªåç´ æ¯ä¸ªåå«å¼åä¿¡æ¯åä¸å¼åå¯¹åºæ ·å¼ä¿¡æ¯çå¯¹è±¡ï¼è¯¥å¯¹è±¡ï¼å¿é¡»ï¼æä¸ä¸ªå±æ§ï¼
     * // start: å¼åå¼ä¸éï¼åå«ï¼;
     * // end: å¼åå¼ä¸éï¼ä¸åå«ï¼;
     * // style: æ°æ®å¯è§åå¾å½¢ç styleï¼å¶å¯è®¾å±æ§æ ¹æ®å¾å½¢ç±»ååè <ShapeParameters> å­ç±»å¯¹è±¡ç style å±æ§ãã
     * // dataStyleByCodomain æ°ç»å½¢å¦ï¼
     * [
     *   {
 *     start:0,
 *     end:250,
 *     style:{
 *          fillColor:"#00CD00"
 *      }
 *  },
     *   {
 *     start:250,
 *     end:500,
 *     style:{
 *          fillColor:"#00EE00"
 *      }
 *  },
     *   {
 *     start:500,
 *     end:750,
 *     style:{
 *          fillColor:"#00FF7F"
 *      }
 *  },
     *   {
 *     start:750,
 *     end:1500,
 *     style:{
 *          fillColor:"#00FF00"
 *      }
 *  }
     * ]
     * (end)
     * @param {number} index - styleGroup çç´¢å¼å¼ï¼ç¨äºååº styleGroup æå®ç styleã
     * @param {number} value - æ°æ®å¼ï¼ç¨äºååº styleByCodomain æå®ç styleã
     * @returns {Object} åå¹¶åçæ ·å¼ ï¼styleï¼ å¯¹è±¡ã
     */
    static ShapeStyleTool(defaultStyle, style, styleGroup, styleByCodomain, index, value) {
        // ç¨ defaultStyle åå§å style å¯¹è±¡
        var finalStyle = defaultStyle ? defaultStyle : {};

        // åºç¡ style
        if (style) {
            Util.copyAttributesWithClip(finalStyle, style);
        }

        // æç´¢å¼èµ style
        if (styleGroup && styleGroup.length && typeof(index) !== "undefined" && !isNaN(index) && index >= 0) {
            if (styleGroup[index]) {
                Util.copyAttributesWithClip(finalStyle, styleGroup[index]);
            }
        }

        // æå¼åèµ style
        if (styleByCodomain && styleByCodomain.length && typeof(value) !== "undefined") {
            var dsc = styleByCodomain;
            var dscLen = dsc.length;
            var v = parseFloat(value);
            for (var i = 0; i < dscLen; i++) {
                if (dsc[i].start <= v && v < dsc[i].end) {
                    Util.copyAttributesWithClip(finalStyle, dsc[i].style);
                    break;
                }
            }
        }

        return finalStyle;
    }

}

;// CONCATENATED MODULE: ./src/common/overlay/feature/Theme.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class  FeatureTheme
 * @aliasclass Feature.Theme
 * @deprecatedclass SuperMap.Feature.Theme
 * @category Visualization Theme
 * @classdesc ä¸é¢è¦ç´ åºç±»ã
 * @param {Object} data - ç¨æ·æ°æ®ï¼ç¨äºçæå¯è§å shapeã
 * @param {SuperMap.Layer.Theme} layer - æ­¤ä¸é¢è¦ç´ æå¨å¾å±ã
 * @usage
 */
class Theme_Theme {
    constructor(data, layer) {

        if (!data) {
            return;
        }
        // layer å¿é¡»å·²ç»æ·»å å°å°å¾, ä¸å·²åå§åæ¸²æå¨
        if (!layer || !layer.map || !layer.renderer) {
            return;
        }

        /**
         * @member {string} FeatureTheme.prototype.id
         * @description ä¸é¢è¦ç´ å¯ä¸æ è¯ã
         */
        this.id = Util.createUniqueID(this.CLASS_NAME + "_");

        /**
         * @member {LonLat} FeatureTheme.prototype.lonlat
         * @description ä¸é¢è¦ç´ å°çåèä½ç½®ãå­ç±»ä¸­å¿é¡»æ ¹æ®ç¨æ·æ°æ®ï¼æå°çä½ç½®åæ°ï¼å¯¹å¶èµå¼ã
         */
        this.lonlat = null;

        /**
         * @member {Array.<number>} FeatureTheme.prototype.location
         * @description ä¸é¢è¦ç´ åç´ åèä½ç½®ãéå¸¸ç±å°çåèä½ç½®å³å®ãé¿åº¦ä¸º 2 çæ°ç»ï¼ç¬¬ä¸ä¸ªåç´ è¡¨ç¤º x åæ ï¼ç¬¬äºä¸ªåç´ è¡¨ç¤º y åæ ã
         */
        this.location = [];

        /**
         * @readonly
         * @member {Object} FeatureTheme.prototype.data
         * @description ç¨æ·æ°æ®ï¼ç¨äºçæå¯è§å shapeï¼å¯å¨å­ç±»ä¸­è§å®æ°æ®æ ¼å¼æç±»åï¼å¦ï¼<{@link FeatureVector}>ã
         */
        this.data = data;

        /**
         * @readonly
         * @member {Array.<Object>} FeatureTheme.prototype.shapes
         * @description æææ­¤ä¸é¢è¦ç´ çå¯è§åå¾å½¢å¯¹è±¡æ°ç»ï¼æ°ç»é¡ºåºæ§å¶æ¸²æã
         */
        this.shapes = [];

        /**
         * @readonly
         * @member {SuperMap.Layer.Theme} FeatureTheme.prototype.layer
         * @description æ­¤ä¸é¢è¦ç´ æå¨ä¸é¢å¾å±ã
         */
        this.layer = layer;

        this.CLASS_NAME = "SuperMap.Feature.Theme";

    }


    /**
     * @function FeatureTheme.prototype.destroy
     * @description éæ¯ä¸é¢è¦ç´ ã
     */
    destroy() {
        this.data = null;
        this.id = null;
        this.lonlat = null;
        this.location = null;
        this.shapes = null;
        this.layer = null;
    }


    /**
     * @function FeatureTheme.prototype.getLocalXY
     * @description å°çåæ è½¬ä¸ºåç´ åæ ã
     * @param {GeometryPoint|GeometryGeoText|LonLat} coordinate - å°çåæ ç¹ã
     * @returns {Array.<number>} é¿åº¦ä¸º 2 çæ°ç»ï¼ç¬¬ä¸ä¸ªåç´ è¡¨ç¤º x åæ ï¼ç¬¬äºä¸ªåç´ è¡¨ç¤º y åæ ã
     */
    getLocalXY(coordinate) {
        var resolution = this.layer.map.getResolution();
        var extent = this.layer.map.getExtent();

        if (coordinate instanceof Point || coordinate instanceof GeoText) {
            let x = (coordinate.x / resolution + (-extent.left / resolution));
            let y = ((extent.top / resolution) - coordinate.y / resolution);
            return [x, y];
        } else if (coordinate instanceof LonLat) {
            let x = (coordinate.lon / resolution + (-extent.left / resolution));
            let y = ((extent.top / resolution) - coordinate.lat / resolution);
            return [x, y];
        } else {
            return null;
        }
    }

}

;// CONCATENATED MODULE: ./src/common/overlay/Graph.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class FeatureThemeGraph
 * @aliasclass Feature.Theme.Graph
 * @deprecatedclass SuperMap.Feature.Theme.Graph
 * @category Visualization Theme
 * @classdesc ç»è®¡ä¸é¢è¦ç´ åºç±»ã
 * æ­¤ç±»å®ä¹äºç»è®¡ä¸é¢è¦ç´ åºç¡æ¨¡åï¼å·ä½çå¾è¡¨æ¨¡åéè¿ç»§æ¿æ­¤ç±»ï¼å¨å­ç±»ä¸­å®ç° assembleShapes æ¹æ³ã
 * ç»è®¡ä¸é¢è¦ç´ æ¨¡åéç¨äºå¯è§åå¾å½¢å¤§å°èªéåºç­ç¥ï¼ç¨è¾å°çåæ°æ§å¶çå¾è¡¨è¯¸å¤å¾å½¢ï¼å¾è¡¨éç½®å¯¹è±¡ <FeatureThemeGraph.setting> çåºç¡å±æ§åªæ 7 ä¸ªï¼
 * å®ä»¬æ§å¶çå¾è¡¨ç»æãå¼åèå´ãæ°æ®å°æ°ä½ç­åºç¡å¾è¡¨å½¢æãææå¾è¡¨çå¾å½¢å¿é¡»å¨å¾è¡¨ç»æéèªéåºå¤§å°ã
 * æ­¤ç±»ä¸å¯å®ä¾åï¼æ­¤ç±»çå¯å®ä¾åå­ç±»å¿é¡»å®ç° assembleShapes() æ¹æ³ã
 * @extends FeatureTheme
 * @param {FeatureVector} data - ç¨æ·æ°æ®ã
 * @param {SuperMap.Layer.Theme} layer - æ­¤ä¸é¢è¦ç´ æå¨å¾å±ã
 * @param {Array.<string>} fields - data ä¸­çåä¸æ­¤å¾è¡¨çæçå­æ®µåç§°ã
 * @param {Object} setting - å¾è¡¨éç½®å¯¹è±¡ã
 * @param {LonLat} [lonlat] - ä¸é¢è¦ç´ å°çä½ç½®ãé»è®¤ä¸º data æä»£çå°çè¦ç´  Bounds ä¸­å¿ã
 * @usage
 */
class Graph extends Theme_Theme {


    constructor(data, layer, fields, setting, lonlat, options) {
        super(data, layer, fields, setting, lonlat, options);

        /**
         * @member {FeatureShapeFactory} FeatureThemeGraph.prototype.shapeFactory
         * @description åç½®çå¾å½¢å·¥åå¯¹è±¡ï¼è°ç¨å¶ createShape æ¹æ³åå»ºå¾å½¢ã
         */
        this.shapeFactory = new ShapeFactory();

        /**
         * @member {Object} FeatureThemeGraph.prototype.shapeParameters
         * @description å½åå¾å½¢åæ°å¯¹è±¡ï¼<{@link ShapeParameters}> çå­ç±»å¯¹è±¡ã
         */
        this.shapeParameters = null;

        /**
         * @member {boolean} [FeatureThemeGraph.prototype.RelativeCoordinate]
         * @description å¾å½¢æ¯å¦å·²ç»è®¡ç®äºç¸å¯¹åæ ã
         */
        this.RelativeCoordinate = false;

        /**
         * @member {Object} FeatureThemeGraph.prototype.setting
         * @description å¾è¡¨éç½®å¯¹è±¡ï¼è¯¥å¯¹è±¡æ§å¶çå¾è¡¨çå¯è§åæ¾ç¤ºã
         * @param {number} width - ä¸é¢è¦ç´ ï¼å¾è¡¨ï¼å®½åº¦ã
         * @param {number} height - ä¸é¢è¦ç´ ï¼å¾è¡¨ï¼é«åº¦ã
         * @param {Array.<number>} codomain - å¼åï¼é¿åº¦ä¸º 2 çä¸ç»´æ°ç»ï¼ç¬¬ä¸ä¸ªåç´ è¡¨ç¤ºå¼åä¸éï¼ç¬¬äºä¸ªåç´ è¡¨ç¤ºå¼åä¸éã
         * @param {number} [XOffset] - ä¸é¢è¦ç´ ï¼å¾è¡¨ï¼å¨ X æ¹åä¸çåç§»å¼ï¼åä½åç´ ã
         * @param {number} [YOffset] - ä¸é¢è¦ç´ ï¼å¾è¡¨ï¼å¨ Y æ¹åä¸çåç§»å¼ï¼åä½åç´ ã
         * @param {Array.<number>} [dataViewBoxParameter] - æ°æ®è§å¾æ¡ dataViewBox åæ°ï¼å®æ¯æå¾è¡¨æ¡ chartBox
         *                                                    ï¼ç±å¾è¡¨ä½ç½®ãå¾è¡¨å®½åº¦ãå¾è¡¨é«åº¦ææçå¾è¡¨èå´æ¡ï¼å¨å·¦ãä¸ï¼å³ï¼ä¸åä¸ªæ¹åä¸çååè·å¼ã
         * @param {number} [decimalNumber] - æ°æ®å¼æ°ç» dataValues åç´ å¼å°æ°ä½æ°ï¼æ°æ®çå°æ°ä½å¤çåæ°ï¼åå¼èå´ï¼[0, 16]ã
         *                                       å¦æä¸è®¾ç½®æ­¤åæ°ï¼å¨åæ°æ®å¼æ¶ä¸å¯¹æ°æ®åå°æ°ä½å¤çã
         *
         */
        this.setting = null;

        /**
         * @readonly
         * @member {Array.<number>} FeatureThemeGraph.prototype.origonPoint
         * @description ä¸é¢è¦ç´ ï¼å¾è¡¨ï¼åç¹ï¼å¾è¡¨å·¦ä¸è§ç¹åç´ åæ ï¼æ¯é¿åº¦ä¸º 2 çä¸ç»´æ°ç»ï¼ç¬¬ä¸ä¸ªåç´ è¡¨ç¤º x åæ ï¼ç¬¬äºä¸ªåç´ è¡¨ç¤º y åæ ã
         */
        this.origonPoint = null;

        /**
         * @readonly
         * @member {Array.<number>} FeatureThemeGraph.prototype.chartBox
         * @description ä¸é¢è¦ç´ ï¼å¾è¡¨ï¼åºåï¼å³å¾è¡¨æ¡ï¼é¿åº¦ä¸º 4 çä¸ç»´æ°ç»ï¼æ°ç»ç 4 ä¸ªåç´ ä¾æ¬¡è¡¨ç¤ºå¾è¡¨æ¡å·¦ç«¯ x åæ å¼ã
         *              ä¸ç«¯ yåæ å¼ã å³ç«¯ xåæ å¼ã ä¸ç«¯ y åæ å¼ï¼[left, bottom, right, top]ã
         */
        this.chartBox = null;

        /**
         * @readonly
         * @member {Bounds} FeatureThemeGraph.prototype.chartBounds
         * @description å¾è¡¨ Bounds éç lonlatãXOffsetãYOffset æ´æ°ï¼æ³¨æ chartBounds æ¯å¾è¡¨åç´ èå´ï¼ä¸æ¯å°çèå´ã
         */
        this.chartBounds = null;

        /**
         * @readonly
         * @member {number} FeatureThemeGraph.prototype.width
         * @description ä¸é¢è¦ç´ ï¼å¾è¡¨ï¼å®½åº¦ ã
         */
        this.width = null;

        /**
         * @readonly
         * @member {number} FeatureThemeGraph.prototype.height
         * @description ä¸é¢è¦ç´ ï¼å¾è¡¨ï¼é«åº¦ ã
         */
        this.height = null;

        /**
         * @readonly
         * @member {number} FeatureThemeGraph.prototype.XOffset
         * @description ä¸é¢è¦ç´ ï¼å¾è¡¨ï¼å¨ X æ¹åä¸çåç§»å¼ï¼åä½åç´ ã
         */
        this.XOffset = 0;

        /**
         * @readonly
         * @member {number} FeatureThemeGraph.prototype.YOffset
         * @description ä¸é¢è¦ç´ ï¼å¾è¡¨ï¼å¨ Y æ¹åä¸çåç§»å¼ï¼åä½åç´ ã
         */
        this.YOffset = 0;

        /**
         * @readonly
         * @member {Array.<number>} FeatureThemeGraph.prototype.DVBParameter
         * @description æ°æ®è§å¾æ¡åæ°ï¼é¿åº¦ä¸º 4 çä¸ç»´æ°ç»ï¼æ°ç»åç´ å¼ >= 0ï¼ï¼[leftOffset, bottomOffset, rightOffset, topOffset]ï¼chartBox ååè·å¼ã
         *               æ­¤å±æ§ç¨äºæå®æ°æ®è§å¾æ¡ dataViewBox çèå´ã
         */
        this.DVBParameter = null;

        /**
         * @readonly
         * @member {Array.<number>} FeatureThemeGraph.prototype.dataViewBox
         * @description æ°æ®è§å¾æ¡ï¼é¿åº¦ä¸º 4 çä¸ç»´æ°ç»ï¼[left, bottom, right, top]ã
         *              dataViewBox æ¯ç»è®¡ä¸é¢è¦ç´ ææ ¸å¿çåå®¹ï¼å®è´è´£è§£éæ°æ®å¨ä¸ä¸ªåç´ åºåéçæ°æ®å¯è§åå«ä¹ï¼
         *              è¿ç§å«ä¹ç¨å¯è§åå¾å½¢è¡¨è¾¾åºæ¥ï¼è¿äºè¡¨ç¤ºæ°æ®çå¾å½¢åä¸äºè¾å©å¾å½¢ç»åå¨ä¸èµ·ææç»è®¡ä¸é¢å¾è¡¨ã
         */
        this.dataViewBox = null;

        /**
         * @readonly
         * @member {Array.<number>} FeatureThemeGraph.prototype.DVBCodomain
         * @description æ°æ®è§å¾æ¡çååè®¸å±ç¤ºçæ°æ®å¼åï¼é¿åº¦ä¸º 2 çä¸ç»´æ°ç»ï¼ç¬¬ä¸ä¸ªåç´ è¡¨ç¤ºå¼åä¸éï¼ç¬¬äºä¸ªåç´ è¡¨ç¤ºå¼åä¸éã
         *              dataViewBox ä¸­åè®¸çæ°æ®èå´ï¼å¯¹æ°æ®æº¢åºå¼åèå´æåµçå¤çéè¦å¨ assembleShapes ä¸­è¿è¡ã
         */
        this.DVBCodomain = null;

        /**
         * @readonly
         * @member {Array.<number>} FeatureThemeGraph.prototype.DVBCenterPoint
         * @description æ°æ®è§å¾æ¡ä¸­å¿ç¹ï¼é¿åº¦ä¸º 2 çä¸ç»´æ°ç»ï¼ç¬¬ä¸ä¸ªåç´ è¡¨ç¤º x åæ ï¼ç¬¬äºä¸ªåç´ è¡¨ç¤º y åæ ã
         */
        this.DVBCenterPoint = null;

        /**
         * @readonly
         * @member {string} FeatureThemeGraph.prototype.DVBUnitValue
         * @description åä½å¼ãå¨ assembleShapes() ä¸­åå§åå¶å·ä½æä¹ï¼ä¾å¦ï¼é¥¼å¾ç DVBUnitValue å¯ä»¥å®ä¹ä¸º"360/æ°æ®æ»å"ï¼
         *              æçº¿å¾ç DVBUnitValue å¯ä»¥å®ä¹ä¸º "DVBCodomain/DVBHeight"ã
         */
        this.DVBUnitValue = null;

        /**
         * @readonly
         * @member {Array.<number>} FeatureThemeGraph.prototype.DVBOrigonPoint
         * @description æ°æ®è§å¾æ¡åç¹ï¼æ°æ®è§å¾æ¡å·¦ä¸è§ç¹ï¼é¿åº¦ä¸º 2 çä¸ç»´æ°ç»ï¼ç¬¬ä¸ä¸ªåç´ è¡¨ç¤º x åæ ï¼ç¬¬äºä¸ªåç´ è¡¨ç¤º y åæ ã
         */
        this.DVBOrigonPoint = null;

        /**
         * @readonly
         * @member {number} FeatureThemeGraph.prototype.DVBWidth
         * @description æ°æ®è§å¾æ¡å®½åº¦ã
         */
        this.DVBWidth = null;

        /**
         * @readonly
         * @member {number} FeatureThemeGraph.prototype.DVBHeight
         * @description æ°æ®è§å¾æ¡é«åº¦ã
         */
        this.DVBHeight = null;

        /**
         * @readonly
         * @member {Array.<number>} FeatureThemeGraph.prototype.origonPointOffset
         * @description æ°æ®è§å¾æ¡åç¹ç¸å¯¹äºå¾è¡¨æ¡çåç¹åç§»éï¼é¿åº¦ä¸º 2 çä¸ç»´æ°ç»ï¼ç¬¬ä¸ä¸ªåç´ è¡¨ç¤º x åç§»éï¼ç¬¬äºä¸ªåç´ è¡¨ç¤º y åç§»éã
         */
        this.origonPointOffset = null;

        /**
         * @readonly
         * @member {Array.<string>} FeatureThemeGraph.prototype.fields
         * @description æ°æ®{FeatureVector}å±æ§å­æ®µã
         */
        this.fields = fields || [];

        /**
         * @readonly
         * @member {Array.<number>} FeatureThemeGraph.prototype.dataValues
         * @description å¾è¡¨å±ç¤ºçæ°æ®å¼ï¼éè¿ fields ä»æ°æ® feature å±æ§ä¸­è·å¾ã
         */
        this.dataValues = null;
        // å¾è¡¨ä½ç½®
        if (lonlat) {
            this.lonlat = lonlat;
        } else {
            // é»è®¤ä½¿ç¨ bounds ä¸­å¿
            this.lonlat = this.data.geometry.getBounds().getCenterLonLat();
        }

        // éç½®é¡¹æ£æµä¸èµå¼
        if (setting && setting.width && setting.height && setting.codomain) {
            this.setting = setting;
        }
        this.CLASS_NAME = "SuperMap.Feature.Theme.Graph";

    }

    /**
     * @function FeatureThemeGraph.prototype.destroy
     * @description éæ¯ä¸é¢è¦ç´ ã
     */
    destroy() {
        this.shapeFactory = null;
        this.shapeParameters = null;
        this.width = null;
        this.height = null;
        this.origonPoint = null;
        this.chartBox = null;
        this.dataViewBox = null;
        this.chartBounds = null;
        this.DVBParameter = null;
        this.DVBOrigonPoint = null;
        this.DVBCenterPoint = null;
        this.DVBWidth = null;
        this.DVBHeight = null;
        this.DVBCodomain = null;
        this.DVBUnitValue = null;
        this.origonPointOffset = null;
        this.XOffset = null;
        this.YOffset = null;
        this.fields = null;
        this.dataValues = null;
        this.setting = null;
        super.destroy();
    }


    /**
     * @function FeatureThemeGraph.prototype.initBaseParameter
     * @description åå§åä¸é¢è¦ç´ ï¼å¾è¡¨ï¼åºç¡åæ°ãå¨è°ç¨æ­¤æ¹æ³åï¼æ­¤ç±»çå¾è¡¨æ¨¡åç¸å³å±æ§é½æ¯ä¸å¯ç¨ç ï¼æ­¤æ¹æ³å¨ assembleShapes å½æ°ä¸­è°ç¨ã
     *              è°ç¨æ­¤å½æ°å³ç³»å° setting å¯¹è±¡çä»¥ä¸å±æ§ã
     * @param {number} width - ä¸é¢è¦ç´ ï¼å¾è¡¨ï¼å®½åº¦ã
     * @param {number} height - ä¸é¢è¦ç´ ï¼å¾è¡¨ï¼é«åº¦ã
     * @param {Array.<number>} codomain - å¼åï¼é¿åº¦ä¸º 2 çä¸ç»´æ°ç»ï¼ç¬¬ä¸ä¸ªåç´ è¡¨ç¤ºå¼åä¸éï¼ç¬¬äºä¸ªåç´ è¡¨ç¤ºå¼åä¸éã
     * @param {number} [XOffset] - ä¸é¢è¦ç´ ï¼å¾è¡¨ï¼å¨ X æ¹åä¸çåç§»å¼ï¼åä½åç´ ã
     * @param {number} [YOffset] - ä¸é¢è¦ç´ ï¼å¾è¡¨ï¼å¨ Y æ¹åä¸çåç§»å¼ï¼åä½åç´ ã
     * @param {Array.<number>} [dataViewBoxParameter] - æ°æ®è§å¾æ¡ dataViewBox åæ°ï¼å®æ¯æå¾è¡¨æ¡ chartBoxã
     *                                     ï¼ç±å¾è¡¨ä½ç½®ãå¾è¡¨å®½åº¦ãå¾è¡¨é«åº¦ææçå¾è¡¨èå´æ¡ï¼å¨å·¦ãä¸ï¼å³ï¼ä¸åä¸ªæ¹åä¸çååè·å¼ã
     * @param {number} [decimalNumber] - æ°æ®å¼æ°ç» dataValues åç´ å¼å°æ°ä½æ°ï¼æ°æ®çå°æ°ä½å¤çåæ°ï¼åå¼èå´ï¼[0, 16]ãå¦æä¸è®¾ç½®æ­¤åæ°ï¼å¨åæ°æ®å¼æ¶ä¸å¯¹æ°æ®åå°æ°ä½å¤çã
     * @returns {boolean} åå§ååæ°æ¯å¦æåã
     */
    initBaseParameter() {
        // åæ°åå§åæ¯å¦æå
        var isSuccess = true;

        // setting å±æ§æ¯å¦å·²æåèµå¼
        if (!this.setting) {
            return false;
        }
        var sets = this.setting;
        // æ£æµ setting çå¿è®¾åæ°
        if (!(sets.width && sets.height && sets.codomain)) {
            return false;
        }

        // æ°æ®
        var decimalNumber = (typeof(sets.decimalNumber) !== "undefined" && !isNaN(sets.decimalNumber)) ? sets.decimalNumber : -1;
        var dataEffective = Theme_Theme.getDataValues(this.data, this.fields, decimalNumber);
        this.dataValues = dataEffective ? dataEffective : [];

        // åºç¡åæ°  width, height, codomain
        this.width = parseFloat(sets.width);
        this.height = parseFloat(sets.height);
        this.DVBCodomain = sets.codomain;

        // å¾è¡¨åç§»
        // if(sets.XOffset) {this.XOffset = sets.XOffset};
        // if(sets.YOffset) {this.YOffset = sets.YOffset};
        this.XOffset = sets.XOffset ? sets.XOffset : 0;
        this.YOffset = sets.YOffset ? sets.YOffset : 0;

        // å¶ä»é»è®¤å¼
        this.origonPoint = [];
        this.chartBox = [];
        this.dataViewBox = [];

        this.DVBParameter = sets.dataViewBoxParameter ? sets.dataViewBoxParameter : [0, 0, 0, 0];

        this.DVBOrigonPoint = [];
        this.DVBCenterPoint = [];
        this.origonPointOffset = [];

        // å¾è¡¨ä½ç½®
        this.resetLocation();

        // ä¸é¢è¦ç´ å®½åº¦ w
        var w = this.width;
        // ä¸é¢è¦ç´ é«åº¦ h
        var h = this.height;
        // ä¸é¢è¦ç´ åç´ ä½ç½® loc
        var loc = this.location;

        // ä¸é¢è¦ç´ åç´ ä½ç½® loc
        this.origonPoint = [loc[0] - w / 2, loc[1] - h / 2];
        // ä¸é¢è¦ç´ åç¹ï¼å·¦ä¸è§ï¼
        var op = this.origonPoint;

        // å¾è¡¨æ¡ï¼[left, bottom, right, top]ï¼
        this.chartBox = [op[0], op[1] + h, op[0] + w, op[1]];
        // å¾è¡¨æ¡
        var cb = this.chartBox;

        // æ°æ®è§å¾æ¡åæ°ï¼å®æ¯å¾è¡¨æ¡åæ¹åå¯¹åºçååè·
        var dbbP = this.DVBParameter;
        // æ°æ®è§å¾æ¡ ï¼[left, bottom, right, top]ï¼
        this.dataViewBox = [cb[0] + dbbP[0], cb[1] - dbbP[1], cb[2] - dbbP[2], cb[3] + dbbP[3]];
        // æ°æ®è§å¾æ¡
        var dvb = this.dataViewBox;
        //æ£æ¥æ°æ®è§å¾æ¡æ¯å¦åæ³
        if (dvb[0] >= dvb[2] || dvb[1] <= dvb[3]) {
            return false;
        }

        // æ°æ®è§å¾æ¡åç¹
        this.DVBOrigonPoint = [dvb[0], dvb[3]];
        // æ°æ®è§å¾æ¡å®½åº¦
        this.DVBWidth = Math.abs(dvb[2] - dvb[0]);
        // æ°æ®è§å¾æ¡é«åº¦
        this.DVBHeight = Math.abs(dvb[1] - dvb[3]);
        // æ°æ®è§å¾æ¡ä¸­å¿ç¹
        this.DVBCenterPoint = [this.DVBOrigonPoint[0] + this.DVBWidth / 2, this.DVBOrigonPoint[1] + this.DVBHeight / 2]

        // æ°æ®è§å¾æ¡åç¹ä¸å¾è¡¨æ¡çåç¹åç§»é
        this.origonPointOffset = [this.DVBOrigonPoint[0] - op[0], this.DVBOrigonPoint[1] - op[1]];

        return isSuccess;
    }

    /**
     * @function FeatureThemeGraph.prototype.resetLocation
     * @description æ ¹æ®å°çä½ç½® lonlat éç½®ä¸é¢è¦ç´ ï¼å¾è¡¨ï¼ä½ç½®ã
     * @param {LonLat} lonlat - ä¸é¢è¦ç´ æ°çåç´ ä¸­å¿ä½ç½®ã
     * @returns {Array.<number>} æ°ä¸é¢è¦ç´ åç´ åèä½ç½®ãé¿åº¦ä¸º 2 çæ°ç»ï¼ç¬¬ä¸ä¸ªåç´ è¡¨ç¤º x åæ ï¼ç¬¬äºä¸ªåç´ è¡¨ç¤º y åæ ã
     */
    resetLocation(lonlat) {
        if (lonlat) {
            this.lonlat = lonlat;
        }

        // è·åå°çä½ç½®å¯¹åºçåç´ åæ  newLocalLX
        var newLocalLX = this.getLocalXY(this.lonlat);
        // å¤çåç§»é XOffset, YOffset
        newLocalLX[0] += this.XOffset;
        newLocalLX[1] += this.YOffset;
        // å°å¾å½¢ä½ç½®èµäº  location å±æ§ï¼æ³¨æ location å±æ§è¡¨ç¤ºçæ¯ä¸é¢è¦ç´ ä¸­å¿ä½ç½®ï¼
        this.location = newLocalLX;

        // æ´æ°å¾è¡¨åç´  Bounds
        var w = this.width;
        var h = this.height;
        var loc = this.location;
        this.chartBounds = new Bounds(loc[0] - w / 2, loc[1] + h / 2, loc[0] + w / 2, loc[1] - h / 2);

        //éæ°è®¡ç®å½åæ¸åè²
        this.resetLinearGradient();

        return loc;
    }

    /**
     * @function FeatureThemeGraph.prototype.resetLinearGradient
     * @description resetLocation ä¸­è°ç¨ å¾è¡¨çç¸å¯¹åæ å­å¨çæ¶åï¼éæ°è®¡ç®æ¸åçé¢è²ï¼ç®åç¨äºäºç»´æ±ç¶å¾æ¸åè² æä»¥å­ç±»å®ç°æ­¤æ¹æ³ï¼ã
     */
    resetLinearGradient() {
        //å­ç±»å®ç°æ­¤æ¹æ³
    }

    /**
     * @function FeatureThemeGraph.prototype.shapesConvertToRelativeCoordinate
     * @description å°ï¼ææå¾è¡¨ï¼å¾å½¢çèç¹è½¬ä¸ºç¸å¯¹åæ è¡¨ç¤ºï¼æ­¤å½æ°å¿é¡»ä¸åªè½å¨ assembleShapes() ç»ææ¶è°ç¨ã
     */
    shapesConvertToRelativeCoordinate() {
        var shapes = this.shapes;
        var shapeROP = this.location;
        for (var i = 0, len = shapes.length; i < len; i++) {
            shapes[i].refOriginalPosition = shapeROP;

            var style = shapes[i].style;

            for (var sty in style) {
                switch (sty) {
                    case "pointList":
                        var pl = style[sty];
                        for (var j = 0, len2 = pl.length; j < len2; j++) {
                            pl[j][0] -= shapeROP[0];
                            pl[j][1] -= shapeROP[1];
                        }
                        break;
                    case "x":
                        style[sty] -= shapeROP[0];
                        break;
                    case "y":
                        style[sty] -= shapeROP[1];
                        break;
                    default:
                        break;
                }
            }
        }
        this.RelativeCoordinate = true;
    }


    /**
     * @function FeatureThemeGraph.prototype.assembleShapes
     * @description å¾å½¢è£éå½æ°ãæ½è±¡æ¹æ³ï¼å¯è§åå­ç±»å¿é¡»å®ç°æ­¤æ¹æ³ã<br>
     *              éåæ­¤æ¹æ³çæ­¥éª¤ï¼<br>
     *              1. å¾è¡¨çæäºç¹æ®éç½®é¡¹ï¼settingï¼å¤çï¼ä¾å¦å¤æ°å¾è¡¨æ¨¡åéè¦éæ°æå® dataViewBoxParameter çé»è®¤å¼ã<br>
     *              2. è°ç¨ initBaseParameter() æ¹æ³åå§åæ¨¡åå±æ§å¼ï¼æ­¤æ­¥éª¤å¿é¡»æ§è¡ï¼åªæå½ initBaseParameter è¿å true æ¶æå¯ä»¥åè®¸è¿è¡åç»­æ­¥éª¤ã<br>
     *              3. è®¡ç®å¾å½¢åæ°ï¼å¶ä½å¾å½¢ï¼å¾å½¢ç»åãå¨ç»è£å¾è¡¨è¿ç¨ä¸­ï¼åºè¯¥ç¹å«æ³¨ææ°æ®è§å¾æ¡åä½å¼çå®ä¹ãæ°æ®å¼æº¢åºå¼åèå´çå¤çåå¾å½¢å¤§å°èªéåºã<br>
     *              4. è°ç¨ shapesConvertToRelativeCoordinate() æ¹æ³ï¼å°å¾å½¢çåæ å¼è½¬ä¸ºç¸å¯¹åæ ï¼æ­¤æ­¥éª¤å¿é¡»æ§è¡ã
     * @example
     *  //å­ç±»å®ç° assembleShapes() æ¥å£çæ­¥éª¤ç¤ºä¾ï¼
     *  assembleShapes: function(){
     *    // ç¬¬ä¸æ­¥ï¼å¾è¡¨çæäºç¹æ®éç½®é¡¹ï¼settingï¼å¤çï¼ä¾å¦å¤æ°å¾è¡¨æ¨¡åéè¦éæ°æå® dataViewBoxParameter çé»è®¤å¼ãæ­¤æ­¥éª¤æ¯éå¿é¡»è¿ç¨ã
     *
     *    // å¾è¡¨éç½®å¯¹è±¡
     *    var sets = this.setting;
     *    // é»è®¤æ°æ®è§å¾æ¡ï¼è¿éå±ç¤ºå¨ä½¿ç¨åæ è½´åä¸ä½¿ç¨åæ è½´æåµä¸å¯¹æ°æ®è§å¾æ¡åæ°èµäºä¸åçé»è®¤å¼
     *    if(!sets.dataViewBoxParameter){
     *          if(typeof(sets.useAxis) === "undefined" || sets.useAxis){
     *              sets.dataViewBoxParameter = [45, 15, 15, 15];
     *          }
     *          else{
     *                  sets.dataViewBoxParameter = [5, 5, 5, 5];
     *          }
     *    }
     *
     *    // ç¬¬äºæ­¥ï¼åå§åå¾è¡¨æ¨¡ååºæ¬åæ°ï¼åªæå¨å¾è¡¨æ¨¡ååºæ¬åæ°åå§åæåæ¶æå¯æ¨¡åç¸å³å±æ§ï¼å¦ this.dataViewBoxã this.DVBCodomainç­ãæ­¤æ­¥éª¤æ¯å¿é¡»è¿ç¨ã
     *    if(!this.initBaseParameter()) return;
     *
     *    // ç¬¬ä¸æ­¥ï¼ç¨å¾å½¢ç»è£å¾è¡¨ï¼å¨ç»è£å¾è¡¨è¿ç¨ä¸­ï¼åºè¯¥ç¹å«æ³¨ææ°æ®è§å¾æ¡åä½å¼çå®ä¹ãæ°æ®å¼æº¢åºå¼åèå´çå¤çåå¾å½¢å¤§å°èªéåºã
     *    // å®ä¹å¾è¡¨æ°æ®è§å¾æ¡ä¸­åä½å¼çå«ä¹ï¼ä¸é¢è¡ä»£ç è¡¨ç¤ºå°æ°æ®è§å¾æ¡åä½å¼å®ä¹ä¸ºæ°æ®è§å¾æ¡é«åº¦ä¸æ¯åç´ ä»£è¡¨çæ°æ®å¼
     *    this.DVBUnitValue =  (this.codomain[1] - this.codomain[0])/this.DVBHeight;
     *    var uv = this.DVBUnitValue;
     *
     *    // å¾å½¢åæ°è®¡ç®ä»£ç ......
     *
     *    // å³äºå¾å½¢è£éï¼å®éä¸å°±æ¯å©ç¨å¾å½¢å·¥ç¨å¯¹è±¡ this.shapeFactory ç createShape() æ¹æ³éè¿å¾å½¢åæ°å¯¹è±¡åå»ºå¯è§åçå¾å½¢å¯¹è±¡ï¼å¹¶æè¿äºå¾å½¢å¯¹è±¡æåºæ·»å å°æ¨¡åçå¾å½¢åºï¼his.shapesï¼ä¸­ãä¸é¢çä»£ç æ¼ç¤ºåå»ºä¸ä¸ªé¢å¾å½¢åæ°å¯¹è±¡ï¼å¹¶åè®¸éè¿å¾å½¢éç½®å¯¹è±¡è®¾ç½®å¾å½¢ç style å highlightStyleï¼
     *    var barParams = new ShapeParametersPolygon(poiLists);
     *    barParams.style = sets.barStyle? sets.barStyle:{fillColor: "lightblue"};
     *    barParams.highlightStyle = sets.barHoverStyle? sets.barHoverStyle:{fillColor: "blue"};
     *    // å¾å½¢æºå¸¦æ°æ®IDä¿¡æ¯
     *    barParams.refDataID = this.data.id;
     *    // åå»ºå¾å½¢å¹¶æ·»å å°å¾è¡¨å¾å½¢æ°ç»ä¸­
     *    this.shapes.push(this.shapeFactory.createShape(barParams));
     *
     *    // ç¬¬åæ­¥ï¼è°ç¨ shapesConvertToRelativeCoordinate() æ¹æ³ï¼å°å¾å½¢åºï¼his.shapesï¼ä¸­çå¾å½¢è½¬ä¸ºç±ç¸å¯¹åæ è¡¨ç¤ºçå¾å½¢ï¼å®¢æ·ç«¯ç»è®¡ä¸é¢å¾æ¨¡åä»ç»æä¸è¦æ±å¯è§åå¾å½¢ä½¿ç¨ç¸å¯¹åæ ï¼assembleShapes() å½æ°å¿é¡»å¨å¾å½¢è£éå®æåè°ç¨ shapesConvertToRelativeCoordinate() å½æ°ãæ­¤æ­¥éª¤æ¯å¿é¡»è¿ç¨ã
     *    this.shapesConvertToRelativeCoordinate();
     * },
     */
    assembleShapes() {
        //å­ç±»å¿é¡»å®ç°æ­¤æ¹æ³
    }

    /**
     * @function FeatureThemeGraph.prototype.getLocalXY
     * @description å°çåæ è½¬ä¸ºåç´ åæ ã
     * @param {LonLat} lonlat - å¸¦è½¬æ¢çå°çåæ ã
     * @returns å±å¹åç´ åæ ã
     */
    getLocalXY(lonlat) {
        return this.layer.getLocalXY(lonlat);
    }

}

/**
 * @function FeatureTheme.getDataValues
 * @description æ ¹æ®å­æ®µåæ°ç»è·åæå®æ°æ®ï¼featureï¼çå±æ§å¼æ°ç»ãå±æ§å¼ç±»åå¿é¡»ä¸º Numberã
 * @param {FeatureVector} data - æ°æ®ã
 * @param {Array.<string>} [fields] - å­æ®µåæ°ç»ã
 * @param {number} [decimalNumber] - å°æ°ä½å¤çåæ°ï¼å¯¹è·åå°çå±æ§æ°æ®å¼è¿è¡å°æ°ä½å¤çã
 * @returns {Array.<string>} å­æ®µåæ°ç»å¯¹åºçå±æ§æ°æ®å¼æ°ç»ã
 */
Theme_Theme.getDataValues = function (data, fields, decimalNumber) {
    if (!data.attributes) {
        return false;
    }

    var fieldsValue = [];

    var attrs = data.attributes;
    for (var i = 0; i < fields.length; i++) {
        for (var field in attrs) {
            if (field !== fields[i]) {
                continue
            }
            // æ°å­è½¬æ¢å¤æ­
            try {
                if (!isNaN(decimalNumber) && decimalNumber >= 0) {
                    fieldsValue.push(parseFloat(attrs[field].toString()).toFixed(decimalNumber));
                } else {
                    fieldsValue.push(parseFloat(attrs[field].toString()));
                }
            } catch (e) {
                throw new Error("not a number")
            }
        }
    }

    if (fieldsValue.length === fields.length) {
        return fieldsValue;
    } else {
        return false;
    }
};

;// CONCATENATED MODULE: ./src/common/overlay/Bar.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/








/**
 * @class FeatureThemeBar
 * @aliasclass Feature.Theme.Bar
 * @deprecatedclass SuperMap.Feature.Theme.Bar
 * @classdesc æ±ç¶å¾ ã
 * @category Visualization Theme
 * @example
 * // barStyleByCodomainåæ°ç¨æ³å¦ä¸ï¼
 * // barStyleByCodomain çæ¯ä¸ªåç´ æ¯ä¸ªåå«å¼åä¿¡æ¯åä¸å¼åå¯¹åºæ ·å¼ä¿¡æ¯çå¯¹è±¡ï¼è¯¥å¯¹è±¡ï¼å¿é¡»ï¼æä¸ä¸ªå±æ§ï¼
 * // start: å¼åå¼ä¸éï¼åå«ï¼;
 * // end: å¼åå¼ä¸éï¼ä¸åå«ï¼;
 * // style: æ°æ®å¯è§åå¾å½¢ç styleï¼è¿ä¸ªæ ·å¼å¯¹è±¡çå¯è®¾å±æ§ï¼ <ShapeParametersPolygon.style> ã
 * // barStyleByCodomain æ°ç»å½¢å¦ï¼
 * [
 *   {
 *     start:0,
 *     end:250,
 *     style:{
 *          fillColor:"#00CD00"
 *      }
 *  },
 *   {
 *     start:250,
 *     end:500,
 *     style:{
 *          fillColor:"#00EE00"
 *      }
 *  },
 *   {
 *     start:500,
 *     end:750,
 *     style:{
 *          fillColor:"#00FF7F"
 *      }
 *  },
 *   {
 *     start:750,
 *     end:1500,
 *     style:{
 *          fillColor:"#00FF00"
 *      }
 *  }
 * ]
 * @extends FeatureThemeGraph
 * @param {FeatureVector} data - ç¨æ·æ°æ®ã
 * @param {SuperMap.Layer.Graph} layer - æ­¤ä¸é¢è¦ç´ æå¨å¾å±ã
 * @param {Array.<string>} fields - data å±æ§ä¸­çåä¸æ­¤å¾è¡¨çæçå±æ§å­æ®µåç§°ã
 * @param {FeatureThemeBar.setting} setting - å¾è¡¨éç½®å¯¹è±¡ã
 * @param {LonLat} [lonlat] - ä¸é¢è¦ç´ å°çä½ç½®ãé»è®¤ä¸º data æä»£çå°çè¦ç´  Bounds ä¸­å¿ã
 * @usage
 * @private
 */
class Bar extends Graph {

    constructor(data, layer, fields, setting, lonlat) {
        super(data, layer, fields, setting, lonlat);
        this.CLASS_NAME = "SuperMap.Feature.Theme.Bar";
    }

    /**
     * @function FeatureThemeBar.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function FeatureThemeBar.prototype.assembleShapes
     * @description å¾è¡¨å¾å½¢è£éå½æ°ã
     */
    assembleShapes() {
        //é»è®¤æ¸åé¢è²æ°ç»
        var deafaultColors = [["#00FF00", "#00CD00"], ["#00CCFF", "#5E87A2"], ["#00FF66", "#669985"], ["#CCFF00", "#94A25E"], ["#FF9900", "#A2945E"]];

        //é»è®¤é´å½±
        var deafaultShawdow = {
            showShadow: true,
            shadowBlur: 8,
            shadowColor: "rgba(100,100,100,0.8)",
            shadowOffsetX: 2,
            shadowOffsetY: 2
        };

        // å¾è¡¨éç½®å¯¹è±¡
        var sets = this.setting;

        if (!sets.barLinearGradient) {
            sets.barLinearGradient = deafaultColors;
        }

        // é»è®¤æ°æ®è§å¾æ¡
        if (!sets.dataViewBoxParameter) {
            if (typeof(sets.useAxis) === "undefined" || sets.useAxis) {
                sets.dataViewBoxParameter = [45, 15, 15, 15];
            } else {
                sets.dataViewBoxParameter = [5, 5, 5, 5];
            }
        }

        // éè¦æ­¥éª¤ï¼åå§ååæ°
        if (!this.initBaseParameter()) {
            return;
        }
        // å¼å
        var codomain = this.DVBCodomain;
        // éè¦æ­¥éª¤ï¼å®ä¹å¾è¡¨ BaFeatureThemeBarr æ°æ®è§å¾æ¡ä¸­åä½å¼çå«ä¹
        this.DVBUnitValue = (codomain[1] - codomain[0]) / this.DVBHeight;

        // æ°æ®è§å¾å
        var dvb = this.dataViewBox;
        // ç¨æ·æ°æ®å¼
        var fv = this.dataValues;
        if (fv.length < 1) {
            return;
        }       // æ²¡ææ°æ®

        // æ°æ®æº¢åºå¼åèå´å¤ç
        for (let i = 0, fvLen = fv.length; i < fvLen; i++) {
            if (fv[i] < codomain[0] || fv[i] > codomain[1]) {
                return;
            }
        }

        // è·å x è½´ä¸çå¾å½¢ä¿¡æ¯
        var xShapeInfo = this.calculateXShapeInfo();
        if (!xShapeInfo) {
            return;
        }
        // æ¯ä¸ªæ±æ¡ x ä½ç½®
        var xsLoc = xShapeInfo.xPositions;
        // æ±æ¡å®½åº¦
        var xsWdith = xShapeInfo.width;

        // èæ¯æ¡ï¼é»è®¤å¯ç¨
        if (typeof(sets.useBackground) === "undefined" || sets.useBackground) {
            // å°èæ¯æ¡å¾å½¢æ·»å å°æ¨¡åç shapes æ°ç»ï¼æ³¨ææ·»å é¡ºåºï¼åæ·»å çå¾å½¢å¨åæ·»å çå¾å½¢ä¹ä¸ã
            this.shapes.push(ShapeFactory.Background(this.shapeFactory, this.chartBox, sets));
        }

        // åæ è½´, é»è®¤å¯ç¨
        if (typeof(sets.useAxis) === "undefined" || sets.useAxis) {
            // æ·»å åæ è½´å¾å½¢æ°ç»
            this.shapes = this.shapes.concat(ShapeFactory.GraphAxis(this.shapeFactory, dvb, sets, xShapeInfo));
        }

        for (var i = 0; i < fv.length; i++) {
            // è®¡ç®æ±æ¡ top è¾¹ç y è½´åæ å¼
            var yPx = dvb[1] - (fv[i] - codomain[0]) / this.DVBUnitValue;

            // æ±æ¡èç¹æ°ç»
            var poiLists = [
                [xsLoc[i] - xsWdith / 2, dvb[1] - 1],
                [xsLoc[i] + xsWdith / 2, dvb[1] - 1],
                [xsLoc[i] + xsWdith / 2, yPx],
                [xsLoc[i] - xsWdith / 2, yPx]
            ];

            // æ±æ¡åæ°å¯¹è±¡ï¼ä¸ä¸ªé¢åæ°å¯¹è±¡ï¼
            var barParams = new Polygon_Polygon(poiLists);

            // æ±æ¡ é´å½± style
            if (typeof(sets.showShadow) === "undefined" || sets.showShadow) {
                if (sets.barShadowStyle) {
                    var sss = sets.barShadowStyle;
                    if (sss.shadowBlur) {
                        deafaultShawdow.shadowBlur = sss.shadowBlur;
                    }
                    if (sss.shadowColor) {
                        deafaultShawdow.shadowColor = sss.shadowColor;
                    }
                    if (sss.shadowOffsetX) {
                        deafaultShawdow.shadowOffsetX = sss.shadowOffsetX;
                    }
                    if (sss.shadowOffsetY) {
                        deafaultShawdow.shadowOffsetY = sss.shadowOffsetY;
                    }
                }
                barParams.style = {};
                Util.copyAttributesWithClip(barParams.style, deafaultShawdow);
            }

            // å¾å½¢æºå¸¦çæ°æ®ä¿¡æ¯
            barParams.refDataID = this.data.id;
            barParams.dataInfo = {
                field: this.fields[i],
                value: fv[i]
            };

            // æ±æ¡ hover click
            if (typeof(sets.barHoverAble) !== "undefined") {
                barParams.hoverable = sets.barHoverAble;
            }
            if (typeof(sets.barClickAble) !== "undefined") {
                barParams.clickable = sets.barClickAble;
            }

            // åå»ºæ±æ¡å¹¶æ·»å å°å¾è¡¨å¾å½¢æ°ç»ä¸­
            this.shapes.push(this.shapeFactory.createShape(barParams));
        }

        // éè¦æ­¥éª¤ï¼å°å¾å½¢è½¬ä¸ºç±ç¸å¯¹åæ è¡¨ç¤ºçå¾å½¢ï¼ä»¥ä¾¿å¨å°å¾å¹³ç§»ç¼©æ¾è¿ç¨ä¸­å¿«ééç»å¾å½¢
        // ï¼ç»è®¡ä¸é¢å¾æ¨¡åä»ç»æä¸è¦æ±ä½¿ç¨ç¸å¯¹åæ ï¼assembleShapes() å½æ°å¿é¡»å¨å¾å½¢è£éå®æåè°ç¨ shapesConvertToRelativeCoordinate() å½æ°ï¼
        this.shapesConvertToRelativeCoordinate();
    }

    /**
     * @function FeatureThemeBar.prototype.calculateXShapeInfo
     * @description è®¡ç® X è½´æ¹åä¸çå¾å½¢ä¿¡æ¯ï¼æ­¤ä¿¡æ¯æ¯ä¸ä¸ªå¯¹è±¡ï¼åå«ä¸¤ä¸ªå±æ§ï¼
     *              å±æ§ xPositions æ¯ä¸ä¸ªä¸ç»´æ°ç»ï¼è¯¥æ°ç»åç´ è¡¨ç¤ºå¾å½¢å¨ x è½´æ¹åä¸çåç´ åæ å¼ï¼
     *              å¦æå¾å½¢å¨ x æ¹åä¸æä¸å®å®½åº¦ï¼éå¸¸åå¾å½¢å¨ x æ¹åä¸çä¸­å¿ç¹ä¸ºå¾å½¢å¨ x æ¹åä¸çåæ å¼ã
     *              width è¡¨ç¤ºå¾å½¢çå®½åº¦ï¼ç¹å«æ³¨æï¼ç¹çå®½åº¦å§ç»ä¸º 0ï¼èä¸æ¯å¶ç´å¾ï¼ã
     *              æ¬å½æ°ä¸­å¾å½¢éç½®å¯¹è±¡ setting å¯è®¾å±æ§ï¼
     *              xShapeBlank - {Array.<number>} æ°´å¹³æ¹åä¸çå¾å½¢ç©ºç½é´éåæ°ã
     *              é¿åº¦ä¸º 3 çæ°ç»ï¼ç¬¬ä¸åç´ è¡¨ç¤ºç¬¬ä¸ä¸ªå¾å½¢å·¦ç«¯ä¸æ°æ®è§å¾æ¡å·¦ç«¯çç©ºç½é´è·ï¼ç¬¬äºä¸ªåç´ è¡¨ç¤ºå¾å½¢é´ç©ºç½é´è·ï¼
     *              ç¬¬ä¸ä¸ªåç´ è¡¨ç¤ºæåä¸ä¸ªå¾å½¢å³ç«¯ä¸æ°æ®è§å¾æ¡å³ç«¯ç«¯çç©ºç½é´è· ã
     * @returns {Object} å¦æè®¡ç®å¤±è´¥ï¼è¿å nullï¼å¦æè®¡ç®æåï¼è¿å X è½´æ¹åä¸çå¾å½¢ä¿¡æ¯ï¼æ­¤ä¿¡æ¯æ¯ä¸ä¸ªå¯¹è±¡ï¼åå«ä»¥ä¸ä¸¤ä¸ªå±æ§ï¼
     *         xPositions - {Array.<number>} è¡¨ç¤ºå¾å½¢å¨ x è½´æ¹åä¸çåç´ åæ å¼ï¼å¦æå¾å½¢å¨ x æ¹åä¸æä¸å®å®½åº¦ï¼éå¸¸åå¾å½¢å¨ x æ¹åä¸çä¸­å¿ç¹ä¸ºå¾å½¢å¨ x æ¹åä¸çåæ å¼ã
     *         width - {number} è¡¨ç¤ºå¾å½¢çå®½åº¦ï¼ç¹å«æ³¨æï¼ç¹çå®½åº¦å§ç»ä¸º 0ï¼èä¸æ¯å¶ç´å¾ï¼ã
     *
     */
    calculateXShapeInfo() {
        var dvb = this.dataViewBox;     // æ°æ®è§å¾æ¡
        var sets = this.setting;     // å¾è¡¨éç½®å¯¹è±¡
        var fvc = this.dataValues.length;      // æ°ç»å¼ä¸ªæ°

        if (fvc < 1) {
            return null;
        }

        var xBlank;        // x è½´ç©ºç½é´éåæ°
        var xShapePositions = [];         // x è½´ä¸å¾å½¢çä½ç½®
        var xShapeWidth = 0;          // x è½´ä¸å¾å½¢å®½åº¦(èªéåº)
        var dvbWidth = this.DVBWidth;            // æ°æ®è§å¾æ¡å®½åº¦

        //  x è½´ç©ºç½é´éåæ°å¤ç
        if (sets.xShapeBlank && sets.xShapeBlank.length && sets.xShapeBlank.length == 3) {
            xBlank = sets.xShapeBlank;
            var xsLen = dvbWidth - (xBlank[0] + xBlank[2] + (fvc - 1) * xBlank[1]);
            if (xsLen <= fvc) {
                return null;
            }
            xShapeWidth = xsLen / fvc
        } else {
            // é»è®¤ä½¿ç¨ç­è·ç¦»ç©ºç½é´éï¼ç©ºç½é´éä¸ºå¾å½¢å®½åº¦
            xShapeWidth = dvbWidth / (2 * fvc + 1);
            xBlank = [xShapeWidth, xShapeWidth, xShapeWidth];
        }

        // å¾å½¢ x è½´ä¸çä½ç½®è®¡ç®
        var xOffset = 0
        for (var i = 0; i < fvc; i++) {
            if (i == 0) {
                xOffset = xBlank[0] + xShapeWidth / 2;
            } else {
                xOffset += (xShapeWidth + xBlank[1]);
            }

            xShapePositions.push(dvb[0] + xOffset);
        }

        return {
            "xPositions": xShapePositions,
            "width": xShapeWidth
        };
    }

    /**
     * @function FeatureThemeBar.prototype.resetLinearGradient
     * @description å¾è¡¨çç¸å¯¹åæ å­å¨çæ¶åï¼éæ°è®¡ç®æ¸åçé¢è²(ç®åç¨äºäºç»´æ±ç¶å¾ æä»¥å­ç±»å®ç°æ­¤æ¹æ³)ã
     */
    resetLinearGradient() {
        if (this.RelativeCoordinate) {
            var shpelength = this.shapes.length;
            var barLinearGradient = this.setting.barLinearGradient;
            var index = -1;
            for (var i = 0; i < shpelength; i++) {
                var shape = this.shapes[i];
                if (shape.CLASS_NAME === "SuperMap.LevelRenderer.Shape.SmicPolygon") {
                    var style = shape.style;
                    //è®¡ç®åºå½åçç»å¯¹ x y
                    var x1 = this.location[0] + style.pointList[0][0];
                    var x2 = this.location[0] + style.pointList[1][0];

                    //æ¸åé¢è²
                    index++;
                    //ä»¥é²å®ä¹çé¢è²æ°ç»ä¸å¤ç¨
                    if (index >= barLinearGradient.length) {
                        index = index % barLinearGradient.length;
                    }
                    var color1 = barLinearGradient[index][0];
                    var color2 = barLinearGradient[index][1];

                    //é¢è²
                    var zcolor = new Color();
                    var linearGradient = zcolor.getLinearGradient(x1, 0, x2, 0,
                        [[0, color1], [1, color2]]);

                    //èµå¼
                    shape.style.color = linearGradient;
                }
            }
        }
    }

}

;// CONCATENATED MODULE: ./src/common/overlay/Bar3D.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class FeatureThemeBar3D
 * @aliasclass Feature.Theme.Bar3D
 * @deprecatedclass SuperMap.Feature.Theme.Bar3D
 * @classdesc ä¸ç»´æ±ç¶å¾ ã
 * @category Visualization Theme
 * @extends FeatureThemeGraph
 * @param {FeatureVector} data - ç¨æ·æ°æ®ã
 * @param {SuperMap.Layer.Graph} layer - æ­¤ä¸é¢è¦ç´ æå¨å¾å±ã
 * @param {Array.<string>} fields - data ä¸­çåä¸æ­¤å¾è¡¨çæçå­æ®µåç§°ã
 * @param {FeatureThemeBar3D.setting} setting - å¾è¡¨éç½®å¯¹è±¡ã
 * @param {LonLat} [lonlat] - ä¸é¢è¦ç´ å°çä½ç½®ï¼é»è®¤ä¸º data æä»£çå°çè¦ç´  Bounds ä¸­å¿ã
 *

 *
 * @example
 * // barFaceStyleByCodomain ç¨æ³ç¤ºä¾å¦ä¸ï¼
 * // barFaceStyleByCodomain çæ¯ä¸ªåç´ æ¯ä¸ªåå«å¼åä¿¡æ¯åä¸å¼åå¯¹åºæ ·å¼ä¿¡æ¯çå¯¹è±¡ï¼è¯¥å¯¹è±¡ï¼å¿é¡»ï¼æä¸ä¸ªå±æ§ï¼
 * // start: å¼åå¼ä¸éï¼åå«ï¼;
 * // end: å¼åå¼ä¸éï¼ä¸åå«ï¼;
 * // style: æ°æ®å¯è§åå¾å½¢ç styleï¼è¿ä¸ªæ ·å¼å¯¹è±¡çå¯è®¾å±æ§ï¼ <ShapeParametersPolygon.style> ã
 * // barFaceStyleByCodomain æ°ç»å½¢å¦ï¼
 * [
 *   {
 *     start:0,
 *     end:250,
 *     style:{
 *          fillColor:"#00CD00"
 *      }
 *  },
 *   {
 *     start:250,
 *     end:500,
 *     style:{
 *          fillColor:"#00EE00"
 *      }
 *  },
 *   {
 *     start:500,
 *     end:750,
 *     style:{
 *          fillColor:"#00FF7F"
 *      }
 *  },
 *   {
 *     start:750,
 *     end:1500,
 *     style:{
 *          fillColor:"#00FF00"
 *      }
 *  }
 * ]
 *
 * @example
 * // barSideStyleByCodomain ç¨æ³ç¤ºä¾å¦ä¸ï¼
 * // barSideStyleByCodomain çæ¯ä¸ªåç´ æ¯ä¸ªåå«å¼åä¿¡æ¯åä¸å¼åå¯¹åºæ ·å¼ä¿¡æ¯çå¯¹è±¡ï¼è¯¥å¯¹è±¡ï¼å¿é¡»ï¼æä¸ä¸ªå±æ§ï¼
 * // start: å¼åå¼ä¸éï¼åå«ï¼;
 * // end: å¼åå¼ä¸éï¼ä¸åå«ï¼;
 * // style: æ°æ®å¯è§åå¾å½¢ç styleï¼è¿ä¸ªæ ·å¼å¯¹è±¡çå¯è®¾å±æ§ï¼ <ShapeParametersPolygon.style> ã
 * // barSideStyleByCodomain æ°ç»å½¢å¦ï¼
 * [
 *   {
 *     start:0,
 *     end:250,
 *     style:{
 *          fillColor:"#00CD00"
 *      }
 *  },
 *   {
 *     start:250,
 *     end:500,
 *     style:{
 *          fillColor:"#00EE00"
 *      }
 *  },
 *   {
 *     start:500,
 *     end:750,
 *     style:{
 *          fillColor:"#00FF7F"
 *      }
 *  },
 *   {
 *     start:750,
 *     end:1500,
 *     style:{
 *          fillColor:"#00FF00"
 *      }
 *  }
 * ]
 *
 * @example
 * // barTopStyleByCodomain ç¨æ³ç¤ºä¾å¦ä¸ï¼
 * // barTopStyleByCodomain çæ¯ä¸ªåç´ æ¯ä¸ªåå«å¼åä¿¡æ¯åä¸å¼åå¯¹åºæ ·å¼ä¿¡æ¯çå¯¹è±¡ï¼è¯¥å¯¹è±¡ï¼å¿é¡»ï¼æä¸ä¸ªå±æ§ï¼
 * // start: å¼åå¼ä¸éï¼åå«ï¼;
 * // end: å¼åå¼ä¸éï¼ä¸åå«ï¼;
 * // style: æ°æ®å¯è§åå¾å½¢ç styleï¼è¿ä¸ªæ ·å¼å¯¹è±¡çå¯è®¾å±æ§ï¼<ShapeParametersPolygon.style> ã
 * // barTopStyleByCodomain æ°ç»å½¢å¦ï¼
 * [
 *   {
 *     start:0,
 *     end:250,
 *     style:{
 *          fillColor:"#00CD00"
 *      }
 *  },
 *   {
 *     start:250,
 *     end:500,
 *     style:{
 *          fillColor:"#00EE00"
 *      }
 *  },
 *   {
 *     start:500,
 *     end:750,
 *     style:{
 *          fillColor:"#00FF7F"
 *      }
 *  },
 *   {
 *     start:750,
 *     end:1500,
 *     style:{
 *          fillColor:"#00FF00"
 *      }
 *  }
 * ]
 * @usage
 * @private
 */

class Bar3D extends Graph {

    constructor(data, layer, fields, setting, lonlat) {
        super(data, layer, fields, setting, lonlat);
        this.CLASS_NAME = "SuperMap.Feature.Theme.Bar3D";
    }

    /**
     * @function FeatureThemeBar3D.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function FeatureThemeBar3D.prototype.assembleShapes
     * @description å¾å½¢è£éå®ç°ï¼æ©å±æ¥å£ï¼ã
     */
    assembleShapes() {
        // å¾è¡¨éç½®å¯¹è±¡
        var sets = this.setting;

        // é»è®¤æ°æ®è§å¾æ¡
        if (!sets.dataViewBoxParameter) {
            if (typeof(sets.useAxis) === "undefined" || sets.useAxis) {
                sets.dataViewBoxParameter = [45, 25, 20, 20];
            } else {
                sets.dataViewBoxParameter = [5, 5, 5, 5];
            }
        }

        // 3d æ±å¾çåæ è½´é»è®¤ä½¿ç¨åæ è½´ç®­å¤´
        sets.axisUseArrow = (typeof(sets.axisUseArrow) !== "undefined") ? sets.axisUseArrow : true;
        sets.axisXLabelsOffset = (typeof(sets.axisXLabelsOffset) !== "undefined") ? sets.axisXLabelsOffset : [-10, 10];

        // éè¦æ­¥éª¤ï¼åå§ååæ°
        if (!this.initBaseParameter()) {
            return;
        }

        // å¼å
        var codomain = this.DVBCodomain;
        // éè¦æ­¥éª¤ï¼å®ä¹å¾è¡¨ FeatureThemeBar æ°æ®è§å¾æ¡ä¸­åä½å¼çå«ä¹
        this.DVBUnitValue = (codomain[1] - codomain[0]) / this.DVBHeight;
        // æ°æ®è§å¾å
        var dvb = this.dataViewBox;
        // ç¨æ·æ°æ®å¼
        var fv = this.dataValues;
        if (fv.length < 1) {
            return;
        }       // æ²¡ææ°æ®

        // æ°æ®æº¢åºå¼åèå´å¤ç
        for (let i = 0, fvLen = fv.length; i < fvLen; i++) {
            if (fv[i] < codomain[0] || fv[i] > codomain[1]) {
                return;
            }
        }

        // è·å x è½´ä¸çå¾å½¢ä¿¡æ¯
        var xShapeInfo = this.calculateXShapeInfo();
        if (!xShapeInfo) {
            return;
        }
        // æ¯ä¸ªæ±æ¡ x ä½ç½®
        var xsLoc = xShapeInfo.xPositions;
        // æ±æ¡å®½åº¦
        var xsWdith = xShapeInfo.width;

        // åæ è½´, é»è®¤å¯ç¨
        if (typeof(sets.useBackground) === "undefined" || sets.useBackground) {
            this.shapes.push(ShapeFactory.Background(this.shapeFactory, this.chartBox, sets));
        }

        // åæ è½´
        if (!sets.axis3DParameter || isNaN(sets.axis3DParameter) || sets.axis3DParameter < 15) {
            sets.axis3DParameter = 20;
        }
        if (typeof(sets.useAxis) === "undefined" || sets.useAxis) {
            this.shapes = this.shapes.concat(ShapeFactory.GraphAxis(this.shapeFactory, dvb, sets, xShapeInfo));
        }

        // 3d åç§»é, é»è®¤å¼ 10;
        var offset3d = (sets.bar3DParameter && !isNaN(sets.bar3DParameter)) ? sets.bar3DParameter : 10;

        for (let i = 0; i < fv.length; i++) {
            // æ  3d åç§»éæ¶çæ±é¢é¡¶é¨ y åæ 
            var yPx = dvb[1] - (fv[i] - codomain[0]) / this.DVBUnitValue;
            // æ  3d åç§»éæ¶çæ±é¢çå·¦ãå³ç«¯ x åæ 
            var iPoiL = xsLoc[i] - xsWdith / 2;
            var iPoiR = xsLoc[i] + xsWdith / 2;

            // 3d æ±é¡¶é¢èç¹
            var bar3DTopPois = [
                [iPoiL, yPx],
                [iPoiR, yPx],
                [iPoiR - offset3d, yPx + offset3d],
                [iPoiL - offset3d, yPx + offset3d]
            ];

            // 3d æ±ä¾§é¢èç¹
            var bar3DSidePois = [
                [iPoiR, yPx],
                [iPoiR - offset3d, yPx + offset3d],
                [iPoiR - offset3d, dvb[1] + offset3d],
                [iPoiR, dvb[1]]
            ];

            // 3d æ±æ­£é¢èç¹
            var bar3DFacePois = [
                [iPoiL - offset3d, dvb[1] + offset3d],
                [iPoiR - offset3d, dvb[1] + offset3d],
                [iPoiR - offset3d, yPx + offset3d],
                [iPoiL - offset3d, yPx + offset3d]
            ];
            if (offset3d <= 0) {  // offset3d <= 0 æ¶æ­£é¢ä¸åç§»
                bar3DFacePois = [
                    [iPoiL, dvb[1]],
                    [iPoiR, dvb[1]],
                    [iPoiR, yPx],
                    [iPoiL, yPx]
                ];
            }

            // æ°å»º 3d æ±é¢é¡¶é¢ãä¾§é¢ãæ­£é¢å¾å½¢åæ°å¯¹è±¡
            var polyTopSP = new Polygon_Polygon(bar3DTopPois);
            var polySideSP = new Polygon_Polygon(bar3DSidePois);
            var polyFaceSP = new Polygon_Polygon(bar3DFacePois);


            // ä¾§é¢ãæ­£é¢å¾å½¢ style é»è®¤å¼
            sets.barSideStyle = sets.barSideStyle ? sets.barSideStyle : sets.barFaceStyle;
            sets.barSideStyleByFields = sets.barSideStyleByFields ? sets.barSideStyleByFields : sets.barFaceStyleByFields;
            sets.barSideStyleByCodomain = sets.barSideStyleByCodomain ? sets.barSideStyleByCodomain : sets.barFaceStyleByCodomain;
            sets.barTopStyle = sets.barTopStyle ? sets.barTopStyle : sets.barFaceStyle;
            sets.barTopStyleByFields = sets.barTopStyleByFields ? sets.barTopStyleByFields : sets.barFaceStyleByFields;
            sets.barTopStyleByCodomain = sets.barTopStyleByCodomain ? sets.barTopStyleByCodomain : sets.barFaceStyleByCodomain;
            // é¡¶é¢ãä¾§é¢ãæ­£é¢å¾å½¢ style
            polyFaceSP.style = ShapeFactory.ShapeStyleTool({
                    stroke: true,
                    strokeColor: "#ffffff",
                    fillColor: "#ee9900"
                },
                sets.barFaceStyle, sets.barFaceStyleByFields, sets.barFaceStyleByCodomain, i, fv[i]);
            polySideSP.style = ShapeFactory.ShapeStyleTool({
                    stroke: true,
                    strokeColor: "#ffffff",
                    fillColor: "#ee9900"
                },
                sets.barSideStyle, sets.barSideStyleByFields, sets.barSideStyleByCodomain, i, fv[i]);
            polyTopSP.style = ShapeFactory.ShapeStyleTool({
                    stroke: true,
                    strokeColor: "#ffffff",
                    fillColor: "#ee9900"
                },
                sets.barTopStyle, sets.barTopStyleByFields, sets.barTopStyleByCodomain, i, fv[i]);

            // 3d æ±æ¡é«äº®æ ·å¼
            sets.barSideHoverStyle = sets.barSideHoverStyle ? sets.barSideHoverStyle : sets.barFaceHoverStyle;
            sets.barTopHoverStyle = sets.barTopHoverStyle ? sets.barTopHoverStyle : sets.barFaceHoverStyle;
            polyFaceSP.highlightStyle = ShapeFactory.ShapeStyleTool({stroke: true}, sets.barFaceHoverStyle);
            polySideSP.highlightStyle = ShapeFactory.ShapeStyleTool({stroke: true}, sets.barSideHoverStyle);
            polyTopSP.highlightStyle = ShapeFactory.ShapeStyleTool({stroke: true}, sets.barTopHoverStyle);

            // å¾å½¢æºå¸¦çæ°æ® id ä¿¡æ¯ & é«äº®æ¨¡å¼
            polyTopSP.refDataID = polySideSP.refDataID = polyFaceSP.refDataID = this.data.id;
            // hover æ¨¡å¼ï¼ç»åï¼
            polyTopSP.isHoverByRefDataID = polySideSP.isHoverByRefDataID = polyFaceSP.isHoverByRefDataID = true;
            // é«äº®ç»(å½é¼ æ  hover å°ç»åä»»ä½ä¸ä¸ªå¾å½¢ï¼æ´ä¸ªç»çå¾å½¢é½ä¼é«äº®ãrefDataHoverGroup å¨ isHoverByRefDataID ä¸º true æ¶ææ)
            polyTopSP.refDataHoverGroup = polySideSP.refDataHoverGroup = polyFaceSP.refDataHoverGroup = Util.createUniqueID("lr_shg");
            // å¾å½¢æºå¸¦çæ°æ®ä¿¡æ¯
            polyTopSP.dataInfo = polySideSP.dataInfo = polyFaceSP.dataInfo = {
                field: this.fields[i],
                value: fv[i]
            };

            // 3d æ±æ¡é¡¶é¢ãä¾§é¢ãæ­£é¢å¾å½¢ hover click è®¾ç½®
            if (typeof(sets.barHoverAble) !== "undefined") {
                polyTopSP.hoverable = polySideSP.hoverable = polyFaceSP.hoverable = sets.barHoverAble;
            }
            if (typeof(sets.barClickAble) !== "undefined") {
                polyTopSP.clickable = polySideSP.clickable = polyFaceSP.clickable = sets.barClickAble;
            }

            // åå»º3d æ±æ¡çé¡¶é¢ãä¾§é¢ãæ­£é¢å¾å½¢å¹¶æ·»å å°å¾è¡¨çå¾å½¢åè¡¨æ°ç»
            this.shapes.push(this.shapeFactory.createShape(polySideSP));
            this.shapes.push(this.shapeFactory.createShape(polyTopSP));
            this.shapes.push(this.shapeFactory.createShape(polyFaceSP));
        }

        // éè¦æ­¥éª¤ï¼å°å¾å½¢è½¬ä¸ºç±ç¸å¯¹åæ è¡¨ç¤ºçå¾å½¢ï¼ä»¥ä¾¿å¨å°å¾å¹³ç§»ç¼©æ¾è¿ç¨ä¸­å¿«ééç»å¾å½¢
        // ï¼ç»è®¡ä¸é¢å¾æ¨¡åä»ç»æä¸è¦æ±ä½¿ç¨ç¸å¯¹åæ ï¼assembleShapes() å½æ°å¿é¡»å¨å¾å½¢è£éå®æåè°ç¨ shapesConvertToRelativeCoordinate() å½æ°ï¼
        this.shapesConvertToRelativeCoordinate();
    }

    /**
     * @function FeatureThemeBar3D.prototype.calculateXShapeInfo
     * @description è®¡ç® X è½´æ¹åä¸çå¾å½¢ä¿¡æ¯ï¼æ­¤ä¿¡æ¯æ¯ä¸ä¸ªå¯¹è±¡ï¼åå«ä¸¤ä¸ªå±æ§ï¼
     *              å±æ§ xPositions æ¯ä¸ä¸ªä¸ç»´æ°ç»ï¼è¯¥æ°ç»åç´ è¡¨ç¤ºå¾å½¢å¨ x è½´æ¹åä¸çåç´ åæ å¼ï¼
     *              å¦æå¾å½¢å¨ x æ¹åä¸æä¸å®å®½åº¦ï¼éå¸¸åå¾å½¢å¨ x æ¹åä¸çä¸­å¿ç¹ä¸ºå¾å½¢å¨ x æ¹åä¸çåæ å¼ã
     *              width è¡¨ç¤ºå¾å½¢çå®½åº¦ï¼ç¹å«æ³¨æï¼ç¹çå®½åº¦å§ç»ä¸º 0ï¼èä¸æ¯å¶ç´å¾ï¼ã
     *              æ¬å½æ°ä¸­å¾å½¢éç½®å¯¹è±¡ setting å¯è®¾å±æ§:
     *              xShapeBlank - {Array.<number>} æ°´å¹³æ¹åä¸çå¾å½¢ç©ºç½é´éåæ°ã
     *              é¿åº¦ä¸º 3 çæ°ç»ï¼ç¬¬ä¸åç´ è¡¨ç¤ºç¬¬ä¸ä¸ªå¾å½¢å·¦ç«¯ä¸æ°æ®è§å¾æ¡å·¦ç«¯çç©ºç½é´è·ï¼ç¬¬äºä¸ªåç´ è¡¨ç¤ºå¾å½¢é´ç©ºç½é´è·ï¼
     *              ç¬¬ä¸ä¸ªåç´ è¡¨ç¤ºæåä¸ä¸ªå¾å½¢å³ç«¯ä¸æ°æ®è§å¾æ¡å³ç«¯ç«¯çç©ºç½é´è· ã
     * @returns {Object} å¦æè®¡ç®å¤±è´¥ï¼è¿å nullï¼å¦æè®¡ç®æåï¼è¿å X è½´æ¹åä¸çå¾å½¢ä¿¡æ¯ï¼æ­¤ä¿¡æ¯æ¯ä¸ä¸ªå¯¹è±¡ï¼åå«ä»¥ä¸ä¸¤ä¸ªå±æ§:
     *                  xPositions - {Array.<number>} è¡¨ç¤ºå¾å½¢å¨ x è½´æ¹åä¸çåç´ åæ å¼ï¼å¦æå¾å½¢å¨ x æ¹åä¸æä¸å®å®½åº¦ï¼éå¸¸åå¾å½¢å¨ x æ¹åä¸çä¸­å¿ç¹ä¸ºå¾å½¢å¨ x æ¹åä¸çåæ å¼ã
     *                  width - {number} è¡¨ç¤ºå¾å½¢çå®½åº¦ï¼ç¹å«æ³¨æï¼ç¹çå®½åº¦å§ç»ä¸º 0ï¼èä¸æ¯å¶ç´å¾ï¼ã
     */
    calculateXShapeInfo() {
        var dvb = this.dataViewBox;     // æ°æ®è§å¾æ¡
        var sets = this.setting;     // å¾è¡¨éç½®å¯¹è±¡
        var fvc = this.dataValues.length;      // æ°ç»å¼ä¸ªæ°

        if (fvc < 1) {
            return null;
        }

        var xBlank;        // x è½´ç©ºç½é´éåæ°
        var xShapePositions = [];         // x è½´ä¸å¾å½¢çä½ç½®
        var xShapeWidth = 0;          // x è½´ä¸å¾å½¢å®½åº¦(èªéåº)
        var dvbWidth = this.DVBWidth;            // æ°æ®è§å¾æ¡å®½åº¦

        //  x è½´ç©ºç½é´éåæ°å¤ç
        if (sets.xShapeBlank && sets.xShapeBlank.length && sets.xShapeBlank.length == 3) {
            xBlank = sets.xShapeBlank;
            var xsLen = dvbWidth - (xBlank[0] + xBlank[2] + (fvc - 1) * xBlank[1])
            if (xsLen <= fvc) {
                return null;
            }
            xShapeWidth = xsLen / fvc
        } else {
            // é»è®¤ä½¿ç¨ç­è·ç¦»ç©ºç½é´éï¼ç©ºç½é´éä¸ºå¾å½¢å®½åº¦
            xShapeWidth = dvbWidth / (2 * fvc + 1);
            xBlank = [xShapeWidth, xShapeWidth, xShapeWidth];
        }

        // å¾å½¢ x è½´ä¸çä½ç½®è®¡ç®
        var xOffset = 0
        for (var i = 0; i < fvc; i++) {
            if (i == 0) {
                xOffset = xBlank[0] + xShapeWidth / 2;
            } else {
                xOffset += (xShapeWidth + xBlank[1]);
            }

            xShapePositions.push(dvb[0] + xOffset);
        }

        return {
            "xPositions": xShapePositions,
            "width": xShapeWidth
        };
    }
}

;// CONCATENATED MODULE: ./src/common/overlay/RankSymbol.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class FeatureThemeRankSymbol
 * @aliasclass Feature.Theme.RankSymbol
 * @deprecatedclass SuperMap.Feature.Theme.RankSymbol
 * @category Visualization Theme
 * @classdesc ç¬¦å·ä¸é¢è¦ç´ åºç±»ãæ­¤ç±»å®ä¹äºç¬¦å·ä¸é¢è¦ç´ åºç¡æ¨¡åï¼å·ä½çå¾è¡¨æ¨¡åéè¿ç»§æ¿æ­¤ç±»ï¼å¨å­ç±»ä¸­å®ç° assembleShapes æ¹æ³ã
 * ç¬¦å·ä¸é¢è¦ç´ æ¨¡åéç¨äºå¯è§åå¾å½¢å¤§å°èªéåºç­ç¥ï¼ç¨è¾å°çåæ°æ§å¶çå¾è¡¨è¯¸å¤å¾å½¢ï¼å¾è¡¨éç½®å¯¹è±¡ <FeatureThemeRankSymbol.setting> çåºç¡å±æ§åªæ 5 ä¸ªï¼
 * å®ä»¬æ§å¶çå¾è¡¨ç»æãå¼åèå´ãæ°æ®å°æ°ä½ç­åºç¡å¾è¡¨å½¢æãææå¾è¡¨çå¾å½¢å¿é¡»å¨å¾è¡¨ç»æéèªéåºå¤§å°ã
 * æ­¤ç±»ä¸å¯å®ä¾åï¼æ­¤ç±»çå¯å®ä¾åå­ç±»å¿é¡»å®ç° assembleShapes() æ¹æ³ã
 * @param {FeatureVector} data - ç¨æ·æ°æ®ã
 * @param {SuperMap.Layer.RankSymbol} layer - æ­¤ä¸é¢è¦ç´ æå¨å¾å±ã
 * @param {Array.<string>} fields - data ä¸­çåä¸æ­¤å¾è¡¨çæçå­æ®µåç§°ã
 * @param {LonLat} [lonlat] - ä¸é¢è¦ç´ å°çä½ç½®ãé»è®¤ä¸º data æä»£çå°çè¦ç´  Bounds ä¸­å¿ã
 * @param {Object} setting - å¾è¡¨éç½®å¯¹è±¡ãé¤äºä»¥ä¸ 5 ä¸ªåºç¡å±æ§ï¼æ­¤å¯¹è±¡çå¯è®¾å±æ§å¨ä¸åå­ç±»ä¸­æè¾å¤§å·®å¼ï¼ä¸åå­ç±»ä¸­å¯¹åä¸å±æ§çè§£éä¹å¯è½ä¸åï¼è¯·å¨æ­¤ç±»çå­ç±»ä¸­æ¥ç setting å¯¹è±¡çå¯è®¾å±æ§åå±æ§å«ä¹ã
 * @param {Array.<number>} setting.codomain - å¼åï¼é¿åº¦ä¸º 2 çä¸ç»´æ°ç»ï¼ç¬¬ä¸ä¸ªåç´ è¡¨ç¤ºå¼åä¸éï¼ç¬¬äºä¸ªåç´ è¡¨ç¤ºå¼åä¸éã
 * @param {number} [setting.XOffset] - ä¸é¢è¦ç´ ï¼å¾è¡¨ï¼å¨ X æ¹åä¸çåç§»å¼ï¼åä½åç´ ã
 * @param {number} [setting.YOffset] - ä¸é¢è¦ç´ ï¼å¾è¡¨ï¼å¨ Y æ¹åä¸çåç§»å¼ï¼åä½åç´ ã
 * @param {Array.<number>} [setting.dataViewBoxParameter] - æ°æ®è§å¾æ¡ dataViewBox åæ°ï¼å®æ¯æå¾è¡¨æ¡ chartBox ï¼ç±å¾è¡¨ä½ç½®ãå¾è¡¨å®½åº¦ãå¾è¡¨é«åº¦ææçå¾è¡¨èå´æ¡ï¼å¨å·¦ãä¸ï¼å³ï¼ä¸åä¸ªæ¹åä¸çååè·å¼ã
 * @param {number} [setting.decimalNumber] - æ°æ®å¼æ°ç» dataValues åç´ å¼å°æ°ä½æ°ï¼æ°æ®çå°æ°ä½å¤çåæ°ï¼åå¼èå´ï¼[0, 16]ãå¦æä¸è®¾ç½®æ­¤åæ°ï¼å¨åæ°æ®å¼æ¶ä¸å¯¹æ°æ®åå°æ°ä½å¤çã
 * @extends FeatureThemeGraph
 * @usage
 */
class RankSymbol extends Graph {

    constructor(data, layer, fields, setting, lonlat, options) {
        super(data, layer, fields, setting, lonlat, options);
        /**
         * @member {Object} FeatureThemeRankSymbol.prototype.setting
         * @description ç¬¦å·éç½®å¯¹è±¡ï¼è¯¥å¯¹è±¡æ§å¶çå¾è¡¨çå¯è§åæ¾ç¤ºã
         */
        this.setting = null;
        // éç½®é¡¹æ£æµä¸èµå¼
        if (setting && setting.codomain) {
            this.setting = setting;
            this.DVBCodomain = this.setting.codomain;
        }
        this.CLASS_NAME = "SuperMap.Feature.Theme.RankSymbol";
    }

    /**
     * @function FeatureThemeRankSymbol.prototype.destroy
     * @description éæ¯ä¸é¢è¦ç´ ã
     */
    destroy() {
        this.setting = null;
        super.destroy();
    }


    /**
     * @function FeatureThemeRankSymbol.prototype.initBaseParameter
     * @description åå§åä¸é¢è¦ç´ ï¼å¾å½¢ï¼åºç¡åæ°ã
     * å¨è°ç¨æ­¤æ¹æ³åï¼æ­¤ç±»çå¾è¡¨æ¨¡åç¸å³å±æ§é½æ¯ä¸å¯ç¨ç ï¼æ­¤æ¹æ³å¨ assembleShapes å½æ°ä¸­è°ç¨ã
     * è°ç¨æ­¤å½æ°å³ç³»å° setting å¯¹è±¡çä»¥ä¸å±æ§ã
     * @param {Array.<number>} codomain - å¼åï¼é¿åº¦ä¸º 2 çä¸ç»´æ°ç»ï¼ç¬¬ä¸ä¸ªåç´ è¡¨ç¤ºå¼åä¸éï¼ç¬¬äºä¸ªåç´ è¡¨ç¤ºå¼åä¸éã
     * @param {number} [XOffset] - ä¸é¢è¦ç´ ï¼å¾å½¢ï¼å¨ X æ¹åä¸çåç§»å¼ï¼åä½åç´ ã
     * @param {number} [YOffset] - ä¸é¢è¦ç´ ï¼å¾å½¢ï¼å¨ Y æ¹åä¸çåç§»å¼ï¼åä½åç´ ã
     * @param {Array.<number>} [dataViewBoxParameter] - æ°æ®è§å¾æ¡ dataViewBox åæ°ï¼å®æ¯æå¾å½¢æ¡ chartBox ï¼ç±å¾è¡¨ä½ç½®ãå¾è¡¨å®½åº¦ãå¾è¡¨é«åº¦ææçå¾è¡¨èå´æ¡ï¼å¨å·¦ãä¸ï¼å³ï¼ä¸åä¸ªæ¹åä¸çååè·å¼ã
     * @param {number} [decimalNumber] - æ°æ®å¼æ°ç» dataValues åç´ å¼å°æ°ä½æ°ï¼æ°æ®çå°æ°ä½å¤çåæ°ï¼åå¼èå´ï¼[0, 16]ãå¦æä¸è®¾ç½®æ­¤åæ°ï¼å¨åæ°æ®å¼æ¶ä¸å¯¹æ°æ®åå°æ°ä½å¤çã
     * @returns {boolean} åå§ååæ°æ¯å¦æåã
     */
    initBaseParameter() {
        // åæ°åå§åæ¯å¦æå
        var isSuccess = true;

        // setting å±æ§æ¯å¦å·²æåèµå¼
        if (!this.setting) {
            return false;
        }
        var sets = this.setting;

        // å¾è¡¨åç§»
        if (sets.XOffset) {
            this.XOffset = sets.XOffset;
        }
        if (sets.YOffset) {
            this.YOffset = sets.YOffset;
        }
        this.XOffset = sets.XOffset ? sets.XOffset : 0;
        this.YOffset = sets.YOffset ? sets.YOffset : 0;

        // å¶ä»é»è®¤å¼
        this.origonPoint = [];
        this.chartBox = [];
        this.dataViewBox = [];

        this.DVBParameter = sets.dataViewBoxParameter ? sets.dataViewBoxParameter : [0, 0, 0, 0];

        this.DVBOrigonPoint = [];
        this.DVBCenterPoint = [];
        this.origonPointOffset = [];

        // å¾è¡¨ä½ç½®
        this.resetLocation();

        // ä¸é¢è¦ç´ å®½åº¦ w
        var w = this.width;
        // ä¸é¢è¦ç´ é«åº¦ h
        var h = this.height;
        // ä¸é¢è¦ç´ åç´ ä½ç½® loc
        var loc = this.location;

        // ä¸é¢è¦ç´ åç´ ä½ç½® loc
        this.origonPoint = [loc[0] - w / 2, loc[1] - h / 2];
        // ä¸é¢è¦ç´ åç¹ï¼å·¦ä¸è§ï¼
        var op = this.origonPoint;

        // å¾è¡¨æ¡ï¼[left, bottom, right, top]ï¼
        this.chartBox = [op[0], op[1] + h, op[0] + w, op[1]];
        // å¾è¡¨æ¡
        var cb = this.chartBox;

        // æ°æ®è§å¾æ¡åæ°ï¼å®æ¯å¾è¡¨æ¡åæ¹åå¯¹åºçååè·
        var dbbP = this.DVBParameter;
        // æ°æ®è§å¾æ¡ ï¼[left, bottom, right, top]ï¼
        this.dataViewBox = [cb[0] + dbbP[0], cb[1] - dbbP[1], cb[2] - dbbP[2], cb[3] + dbbP[3]];
        // æ°æ®è§å¾æ¡
        var dvb = this.dataViewBox;
        //æ£æ¥æ°æ®è§å¾æ¡æ¯å¦åæ³
        if (dvb[0] >= dvb[2] || dvb[1] <= dvb[3]) {
            return false;
        }

        // æ°æ®è§å¾æ¡åç¹
        this.DVBOrigonPoint = [dvb[0], dvb[3]];
        // æ°æ®è§å¾æ¡å®½åº¦
        this.DVBWidth = Math.abs(dvb[2] - dvb[0]);
        // æ°æ®è§å¾æ¡é«åº¦
        this.DVBHeight = Math.abs(dvb[1] - dvb[3]);
        // æ°æ®è§å¾æ¡ä¸­å¿ç¹
        this.DVBCenterPoint = [this.DVBOrigonPoint[0] + this.DVBWidth / 2, this.DVBOrigonPoint[1] + this.DVBHeight / 2];

        // æ°æ®è§å¾æ¡åç¹ä¸å¾è¡¨æ¡çåç¹åç§»é
        this.origonPointOffset = [this.DVBOrigonPoint[0] - op[0], this.DVBOrigonPoint[1] - op[1]];

        return isSuccess;
    }
}

;// CONCATENATED MODULE: ./src/common/overlay/Circle.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class FeatureThemeCircle
 * @aliasclass Feature.Theme.Circle
 * @deprecatedclass SuperMap.Feature.Theme.Circle
 * @classdesc åç±»ã
 * @category Visualization Theme
 * @extends FeatureThemeRankSymbol
 * @param {FeatureVector} data - ç¨æ·æ°æ®ã
 * @param {SuperMap.Layer.RankSymbol} layer - æ­¤ä¸é¢è¦ç´ æå¨å¾å±ã
 * @param {Array.<string>} fields - data ä¸­çåä¸æ­¤å¾è¡¨çæçå­æ®µåç§°ã
 * @param {FeatureThemeCircle.setting} setting - å¾è¡¨éç½®å¯¹è±¡ã
 * @param {LonLat} [lonlat] - ä¸é¢è¦ç´ å°çä½ç½®ï¼é»è®¤ä¸º data æä»£çå°çè¦ç´  Bounds ä¸­å¿ã
 * @usage
 * @private
 */
class Circle extends RankSymbol {

    constructor(data, layer, fields, setting, lonlat) {
        super(data, layer, fields, setting, lonlat);
        this.CLASS_NAME = "SuperMap.Feature.Theme.Circle";
    }

    /**
     * @function FeatureThemeCircle.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function FeatureThemeCircle.prototype.assembleShapes
     * @description è£éå¾å½¢ï¼æ©å±æ¥å£ï¼ã
     */
    assembleShapes() {
        //é»è®¤å¡«åé¢è²
        var defaultFillColor = "#ff9277";

        // setting å±æ§æ¯å¦å·²æåèµå¼
        if (!this.setting) {
            return false;
        }
        var sets = this.setting;
        // æ£æµ setting çå¿è®¾åæ°
        if (!(sets.codomain)) {
            return false;
        }

        // æ°æ®
        var decimalNumber = (typeof(sets.decimalNumber) !== "undefined" && !isNaN(sets.decimalNumber)) ? sets.decimalNumber : -1;
        var dataEffective = Theme_Theme.getDataValues(this.data, this.fields, decimalNumber);
        this.dataValues = dataEffective ? dataEffective : [];

        // æ°æ®å¼æ°ç»
        var fv = this.dataValues;
        //if(fv.length != 1) return;       // æ²¡ææ°æ® æèæ°æ®ä¸å¯ä¸
        //if(fv[0] < 0) return;            //æ°æ®ä¸ºè´å¼

        //ç¨æ·åºè¯¥å®ä¹æå¤§ æå°åå¾  é»è®¤æå¤§åå¾MaxR:100 æå°åå¾MinR:0;
        if (!sets.maxR) {
            sets.maxR = 100;
        }
        if (!sets.minR) {
            sets.minR = 0;
        }

        // å¼åèå´
        var codomain = this.DVBCodomain;

        // éè¦æ­¥éª¤ï¼å®ä¹Circleæ°æ®è§å¾æ¡ä¸­åä½å¼çå«ä¹ï¼åä½å¼ï¼1æä»£è¡¨çé¿åº¦
        // ç¨æ·å®ä¹äºå¼åèå´
        if (codomain && codomain[1] - codomain[0] > 0) {
            this.DVBUnitValue = sets.maxR / (codomain[1] - codomain[0]);
        } else {
            //this.DVBUnitValue = sets.maxR / maxValue;
            this.DVBUnitValue = sets.maxR;
        }

        var uv = this.DVBUnitValue;
        //ååå¾
        var r = fv[0] * uv + sets.minR;
        this.width = 2 * r;
        this.height = 2 * r;

        // éè¦æ­¥éª¤ï¼åå§ååæ°
        if (!this.initBaseParameter()) {
            return;
        }

        //åå¦ç¨æ·è®¾ç½®äºå¼åèå´ æ²¡æå¨å¼åèå´ç´æ¥è¿å
        if (codomain) {
            if (fv[0] < codomain[0] || fv[0] > codomain[1]) {
                return;
            }
        }

        var dvbCenter = this.DVBCenterPoint;        // æ°æ®è§å¾æ¡ä¸­å¿ä½ä¸ºåå¿

        //åå½¢å¯¹è±¡åæ°
        var circleSP = new Circle_Circle(dvbCenter[0], dvbCenter[1], r);

        //circleSP.sytle åå§å
        circleSP.style = ShapeFactory.ShapeStyleTool(null, sets.circleStyle, null, null, 0);
        //å¾å½¢çå¡«åé¢è²
        if (typeof (sets.fillColor) !== "undefined") {
            //ç¨æ·èªå®ä¹
            circleSP.style.fillColor = sets.fillColor;
        } else {
            //å½åé»è®¤
            circleSP.style.fillColor = defaultFillColor;
        }
        //åå½¢ Hoveræ ·å¼
        circleSP.highlightStyle = ShapeFactory.ShapeStyleTool(null, sets.circleHoverStyle);
        //åå½¢ Hover ä¸ click è®¾ç½®
        if (typeof(sets.circleHoverAble) !== "undefined") {
            circleSP.hoverable = sets.circleHoverAble;
        }
        if (typeof(sets.circleClickAble) !== "undefined") {
            circleSP.clickable = sets.circleClickAble;
        }

        //å¾å½¢æºå¸¦çæ°æ®ä¿¡æ¯
        circleSP.refDataID = this.data.id;
        circleSP.dataInfo = {
            field: this.fields[0],
            r: r,
            value: fv[0]
        };

        // åå»ºæå½¢å¹¶ææ­¤æå½¢æ·»å å°å¾è¡¨å¾å½¢æ°ç»
        this.shapes.push(this.shapeFactory.createShape(circleSP));

        // éè¦æ­¥éª¤ï¼å°å¾å½¢è½¬ä¸ºç±ç¸å¯¹åæ è¡¨ç¤ºçå¾å½¢ï¼ä»¥ä¾¿å¨å°å¾å¹³ç§»ç¼©æ¾è¿ç¨ä¸­å¿«ééç»å¾å½¢
        // ï¼ç»è®¡ä¸é¢å¾æ¨¡åä»ç»æä¸è¦æ±ä½¿ç¨ç¸å¯¹åæ ï¼assembleShapes() å½æ°å¿é¡»å¨å¾å½¢è£éå®æåè°ç¨ shapesConvertToRelativeCoordinate() å½æ°ï¼
        this.shapesConvertToRelativeCoordinate();
    }

}

;// CONCATENATED MODULE: ./src/common/overlay/Line.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class FeatureThemeLine
 * @aliasclass Feature.Theme.Line
 * @deprecatedclass SuperMap.Feature.Theme.Line
 * @classdesc æçº¿å¾ã
 * @category Visualization Theme
 * @example
 * // pointStyleByCodomain åæ°ç¨æ³ç¤ºä¾
 * // pointStyleByCodomain çæ¯ä¸ªåç´ æ¯ä¸ªåå«å¼åä¿¡æ¯åä¸å¼åå¯¹åºæ ·å¼ä¿¡æ¯çå¯¹è±¡ï¼è¯¥å¯¹è±¡ï¼å¿é¡»ï¼æä¸ä¸ªå±æ§ï¼
 * // start: å¼åå¼ä¸éï¼åå«ï¼;
 * // end: å¼åå¼ä¸éï¼ä¸åå«ï¼;
 * // style: æ°æ®å¯è§åå¾å½¢ç styleï¼è¿ä¸ªæ ·å¼å¯¹è±¡çå¯è®¾å±æ§ï¼ <Point.style> ã
 * // pointStyleByCodomain æ°ç»å½¢å¦ï¼
 * [
 *   {
 *     start:0,
 *     end:250,
 *     style:{
 *          fillColor:"#00CD00"
 *      }
 *  },
 *   {
 *     start:250,
 *     end:500,
 *     style:{
 *          fillColor:"#00EE00"
 *      }
 *  },
 *   {
 *     start:500,
 *     end:750,
 *     style:{
 *          fillColor:"#00FF7F"
 *      }
 *  },
 *   {
 *     start:750,
 *     end:1500,
 *     style:{
 *          fillColor:"#00FF00"
 *      }
 *  }
 * ]
 *
 * @extends FeatureThemeGraph
 * @param {FeatureVector} data - ç¨æ·æ°æ®ã
 * @param {SuperMap.Layer.Graph} layer - æ­¤ä¸é¢è¦ç´ æå¨å¾å±ã
 * @param {Array.<string>} fields - data ä¸­çåä¸æ­¤å¾è¡¨çæçå­æ®µåç§°ã
 * @param {FeatureThemeLine.setting} setting - å¾è¡¨éç½®å¯¹è±¡ã
 * @param {LonLat} [lonlat] - ä¸é¢è¦ç´ å°çä½ç½®ãé»è®¤ä¸º data æä»£çå°çè¦ç´  Bounds ä¸­å¿ã
 * @usage
 * @private
 */
class Line extends Graph {

    constructor(data, layer, fields, setting, lonlat, options) {
        super(data, layer, fields, setting, lonlat, options);
        this.CLASS_NAME = "SuperMap.Feature.Theme.Line";
    }

    /**
     * @function FeatureThemeLine.prototype.destroy
     * @override
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function FeatureThemeLine.prototype.assembleShapes
     * @description è£éå¾å½¢ï¼æ©å±æ¥å£ï¼ã
     */
    assembleShapes() {
        // å¾è¡¨éç½®å¯¹è±¡
        var sets = this.setting;

        // é»è®¤æ°æ®è§å¾æ¡
        if (!sets.dataViewBoxParameter) {
            if (typeof(sets.useAxis) === "undefined" || sets.useAxis) {
                sets.dataViewBoxParameter = [45, 15, 15, 15];
            } else {
                sets.dataViewBoxParameter = [5, 5, 5, 5];
            }
        }

        // éè¦æ­¥éª¤ï¼åå§ååæ°
        if (!this.initBaseParameter()) {
            return;
        }

        var dvb = this.dataViewBox;

        // å¼å
        var codomain = this.DVBCodomain;
        // éè¦æ­¥éª¤ï¼å®ä¹å¾è¡¨ FeatureThemeBar æ°æ®è§å¾æ¡ä¸­åä½å¼çå«ä¹
        this.DVBUnitValue = (codomain[1] - codomain[0]) / this.DVBHeight;
        var uv = this.DVBUnitValue;
        // æ°æ®å¼æ°ç»
        var fv = this.dataValues;
        if (fv.length < 1) {
            return;
        }       // æ²¡ææ°æ®

        // è·å x è½´ä¸çå¾å½¢ä¿¡æ¯
        var xShapeInfo = this.calculateXShapeInfo();
        if (!xShapeInfo) {
            return;
        }
        // æçº¿æ¯ä¸ªèç¹ç x ä½ç½®
        var xsLoc = xShapeInfo.xPositions;

        // èæ¯æ¡ï¼é»è®¤å¯ç¨
        if (typeof(sets.useBackground) === "undefined" || sets.useBackground) {
            // å°èæ¯æ¡å¾å½¢æ·»å å°æ¨¡åç shapes æ°ç»ï¼æ³¨ææ·»å é¡ºåºï¼åæ·»å çå¾å½¢å¨åæ·»å çå¾å½¢ä¹ä¸ã
            this.shapes.push(ShapeFactory.Background(this.shapeFactory, this.chartBox, sets));
        }

        // æçº¿å¾å¿é¡»ä½¿ç¨åæ è½´
        this.shapes = this.shapes.concat(ShapeFactory.GraphAxis(this.shapeFactory, dvb, sets, xShapeInfo));

        // var isDataEffective = true;

        var xPx;        // æçº¿èç¹ x åæ 
        var yPx;        // æçº¿èç¹ y åæ 
        var poiLists = [];        // æçº¿èç¹æ°ç»

        var shapePois = [];     // æçº¿èç¹å¾å½¢æ°ç»
        for (var i = 0, len = fv.length; i < len; i++) {
            // æ°æ®æº¢åºå¼åæ£æ¥
            if (fv[i] < codomain[0] || fv[i] > codomain[1]) {
                // isDataEffective = false;
                return null;
            }

            xPx = xsLoc[i];
            yPx = dvb[1] - (fv[i] - codomain[0]) / uv;

            // æçº¿èç¹åæ°å¯¹è±¡
            var poiSP = new Point_Point(xPx, yPx);
            // æçº¿èç¹ style
            poiSP.style = ShapeFactory.ShapeStyleTool({fillColor: "#ee9900"}, sets.pointStyle, sets.pointStyleByFields, sets.pointStyleByCodomain, i, fv[i]);
            // æçº¿èç¹ hover æ ·å¼
            poiSP.highlightStyle = ShapeFactory.ShapeStyleTool(null, sets.pointHoverStyle);

            // æçº¿èç¹ hover click
            if (typeof(sets.pointHoverAble) !== "undefined") {
                poiSP.hoverable = sets.pointHoverAble;
            }
            if (typeof(sets.pointClickAble) !== "undefined") {
                poiSP.clickable = sets.pointClickAble;
            }

            // å¾å½¢æºå¸¦çæ°æ®ä¿¡æ¯
            poiSP.refDataID = this.data.id;
            poiSP.dataInfo = {
                field: this.fields[i],
                value: fv[i]
            };

            // åå»ºå¾å½¢å¹¶ææ­¤å¾å½¢æ·»å å°æçº¿èç¹å¾å½¢æ°ç»
            shapePois.push(this.shapeFactory.createShape(poiSP));

            // æ·»å æçº¿èç¹å°æçº¿èç¹æ°ç»
            var poi = [xPx, yPx];
            poiLists.push(poi);
        }

        // æçº¿åæ°å¯¹è±¡
        var lineSP = new Line_Line(poiLists);
        lineSP.style = ShapeFactory.ShapeStyleTool({strokeColor: "#ee9900"}, sets.lineStyle);
        // ç¦æ­¢äºä»¶ååº
        lineSP.clickable = false;
        lineSP.hoverable = false;
        var shapeLine = this.shapeFactory.createShape(lineSP);
        this.shapes.push(shapeLine);

        // æ·»å èç¹å°å¾è¡¨å¾å½¢æ°ç»
        this.shapes = this.shapes.concat(shapePois);

        // // æ°æ®èå´æ£æµæªéè¿ï¼æ¸ç©ºå¾å½¢
        // if (isDataEffective === false) {
        //     this.shapes = [];
        // }

        // éè¦æ­¥éª¤ï¼å°å¾å½¢è½¬ä¸ºç±ç¸å¯¹åæ è¡¨ç¤ºçå¾å½¢ï¼ä»¥ä¾¿å¨å°å¾å¹³ç§»ç¼©æ¾è¿ç¨ä¸­å¿«ééç»å¾å½¢
        // ï¼ç»è®¡ä¸é¢å¾æ¨¡åä»ç»æä¸è¦æ±ä½¿ç¨ç¸å¯¹åæ ï¼assembleShapes() å½æ°å¿é¡»å¨å¾å½¢è£éå®æåè°ç¨ shapesConvertToRelativeCoordinate() å½æ°ï¼
        this.shapesConvertToRelativeCoordinate();
    }

    /**
     * @function FeatureThemeLine.prototype.calculateXShapeInfo
     * @description è®¡ç® X è½´æ¹åä¸çå¾å½¢ä¿¡æ¯ï¼æ­¤ä¿¡æ¯æ¯ä¸ä¸ªå¯¹è±¡ï¼åå«ä¸¤ä¸ªå±æ§ï¼
     *              å±æ§ xPositions æ¯ä¸ä¸ªä¸ç»´æ°ç»ï¼è¯¥æ°ç»åç´ è¡¨ç¤ºå¾å½¢å¨ x è½´æ¹åä¸çåç´ åæ å¼ï¼
     *              å¦æå¾å½¢å¨ x æ¹åä¸æä¸å®å®½åº¦ï¼éå¸¸åå¾å½¢å¨ x æ¹åä¸çä¸­å¿ç¹ä¸ºå¾å½¢å¨ x æ¹åä¸çåæ å¼ã
     *              width è¡¨ç¤ºå¾å½¢çå®½åº¦ï¼ç¹å«æ³¨æï¼ç¹çå®½åº¦å§ç»ä¸º 0ï¼èä¸æ¯å¶ç´å¾ï¼ã
     *              æ¬å½æ°ä¸­å¾å½¢éç½®å¯¹è±¡ setting å¯è®¾å±æ§ï¼<br>
     *              xShapeBlank - {Array.<number>} æ°´å¹³æ¹åä¸çå¾å½¢ç©ºç½é´éåæ°ã
     *              é¿åº¦ä¸º 2 çæ°ç»ï¼ç¬¬ä¸åç´ è¡¨ç¤ºç¬¬æçº¿å·¦ç«¯ç¹ä¸æ°æ®è§å¾æ¡å·¦ç«¯çç©ºç½é´è·ï¼ç¬¬äºä¸ªåç´ è¡¨ç¤ºæçº¿å³ç«¯ç¹å³ç«¯ä¸æ°æ®è§å¾æ¡å³ç«¯ç«¯çç©ºç½é´è· ã
     * @returns {Object} å¦æè®¡ç®å¤±è´¥ï¼è¿å nullï¼å¦æè®¡ç®æåï¼è¿å X è½´æ¹åä¸çå¾å½¢ä¿¡æ¯ï¼æ­¤ä¿¡æ¯æ¯ä¸ä¸ªå¯¹è±¡ï¼åå«ä»¥ä¸ä¸¤ä¸ªå±æ§ï¼<br>
     *         xPositions - {Array.<number>} è¡¨ç¤ºå¾å½¢å¨ x è½´æ¹åä¸çåç´ åæ å¼ï¼å¦æå¾å½¢å¨ x æ¹åä¸æä¸å®å®½åº¦ï¼éå¸¸åå¾å½¢å¨ x æ¹åä¸çä¸­å¿ç¹ä¸ºå¾å½¢å¨ x æ¹åä¸çåæ å¼ã<br>
     *         width - {number} è¡¨ç¤ºå¾å½¢çå®½åº¦ï¼ç¹å«æ³¨æï¼ç¹çå®½åº¦å§ç»ä¸º 0ï¼èä¸æ¯å¶ç´å¾ï¼ã
     */
    calculateXShapeInfo() {
        var dvb = this.dataViewBox;     // æ°æ®è§å¾æ¡
        var sets = this.setting;     // å¾è¡¨éç½®å¯¹è±¡
        var fvc = this.dataValues.length;      // æ°ç»å¼ä¸ªæ°

        if (fvc < 1) {
            return null;
        }

        var xBlank;        // x è½´ç©ºç½é´éåæ°
        var xShapePositions = [];         // x è½´ä¸å¾å½¢çä½ç½®
        var xShapeWidth = 0;          // x è½´ä¸å¾å½¢å®½åº¦(èªéåº)
        var dvbWidth = this.DVBWidth;            // æ°æ®è§å¾æ¡å®½åº¦
        var unitOffset = 0;               // åä½åç§»é

        //  x è½´ç©ºç½é´éåæ°å¤ç
        if (sets.xShapeBlank && sets.xShapeBlank.length && sets.xShapeBlank.length == 2) {
            xBlank = sets.xShapeBlank;
            var xsLen = dvbWidth - (xBlank[0] + xBlank[1]);
            if (xsLen <= fvc) {
                return null;
            }
            unitOffset = xsLen / (fvc - 1);
        } else {
            // é»è®¤ä½¿ç¨ç­è·ç¦»ç©ºç½é´éï¼ç©ºç½é´éä¸ºå¾å½¢å®½åº¦
            unitOffset = dvbWidth / (fvc + 1);
            xBlank = [unitOffset, unitOffset, unitOffset];
        }

        // å¾å½¢ x è½´ä¸çä½ç½®è®¡ç®
        var xOffset = 0
        for (var i = 0; i < fvc; i++) {
            if (i == 0) {
                xOffset = xBlank[0];
            } else {
                xOffset += unitOffset;
            }

            xShapePositions.push(dvb[0] + xOffset);
        }

        return {
            "xPositions": xShapePositions,
            "width": xShapeWidth
        };
    }

}

;// CONCATENATED MODULE: ./src/common/overlay/Pie.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class FeatureThemePie
 * @aliasclass Feature.Theme.Pie
 * @deprecatedclass SuperMap.Feature.Theme.Pie
 * @classdesc é¥¼å¾ã
 * @category Visualization Theme
 * @param {FeatureVector} data - ç¨æ·æ°æ®ã
 * @param {SuperMap.Layer.Graph} layer - æ­¤ä¸é¢è¦ç´ æå¨å¾å±ã
 * @param {Array.<string>} fields - data ä¸­çåä¸æ­¤å¾è¡¨çæçå­æ®µåç§°ã
 * @param {FeatureThemePoint.setting} setting - å¾è¡¨éç½®å¯¹è±¡ã
 * @param {LonLat} [lonlat] - ä¸é¢è¦ç´ å°çä½ç½®ãé»è®¤ä¸º data æä»£çå°çè¦ç´  Bounds ä¸­å¿ã
 * @extends FeatureThemeGraph
 * @example
 * // sectorStyleByCodomain çæ¯ä¸ªåç´ æ¯ä¸ªåå«å¼åä¿¡æ¯åä¸å¼åå¯¹åºæ ·å¼ä¿¡æ¯çå¯¹è±¡ï¼è¯¥å¯¹è±¡ï¼å¿é¡»ï¼æä¸ä¸ªå±æ§ï¼
 * // start: å¼åå¼ä¸éï¼åå«ï¼;
 * // end: å¼åå¼ä¸éï¼ä¸åå«ï¼;
 * // style: æ°æ®å¯è§åå¾å½¢ç styleï¼è¿ä¸ªæ ·å¼å¯¹è±¡çå¯è®¾å±æ§ï¼ <ShapeParametersSector.style> ã
 * // sectorStyleByCodomain æ°ç»å½¢å¦ï¼
 * [
 *   {
 *     start:0,
 *     end:250,
 *     style:{
 *          fillColor:"#00CD00"
 *      }
 *  },
 *   {
 *     start:250,
 *     end:500,
 *     style:{
 *          fillColor:"#00EE00"
 *      }
 *  },
 *   {
 *     start:500,
 *     end:750,
 *     style:{
 *          fillColor:"#00FF7F"
 *      }
 *  },
 *   {
 *     start:750,
 *     end:1500,
 *     style:{
 *          fillColor:"#00FF00"
 *      }
 *  }
 * ]
 * @usage
 * @private
 */
class Pie extends Graph {

    constructor(data, layer, fields, setting, lonlat) {
        super(data, layer, fields, setting, lonlat);
        this.CLASS_NAME = "SuperMap.Feature.Theme.Pie";
    }

    /**
     * @function FeatureThemePie.prototype.destroy
     * @description éæ¯æ­¤ä¸é¢è¦ç´ ãè°ç¨ destroy åæ­¤å¯¹è±¡æä»¥å±æ§ç½®ä¸º nullã
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function FeatureThemePie.prototype.assembleShapes
     * @description è£éå¾å½¢ï¼æ©å±æ¥å£ï¼ã
     */
    assembleShapes() {
        // å¾è¡¨éç½®å¯¹è±¡
        var sets = this.setting;

        // ä¸ä¸ªé»è®¤ style ç»
        var defaultStyleGroup = [
            {fillColor: "#ff9277"}, {fillColor: "#dddd00"}, {fillColor: "#ffc877"}, {fillColor: "#bbe3ff"}, {fillColor: "#d5ffbb"},
            {fillColor: "#bbbbff"}, {fillColor: "#ddb000"}, {fillColor: "#b0dd00"}, {fillColor: "#e2bbff"}, {fillColor: "#ffbbe3"},
            {fillColor: "#ff7777"}, {fillColor: "#ff9900"}, {fillColor: "#83dd00"}, {fillColor: "#77e3ff"}, {fillColor: "#778fff"},
            {fillColor: "#c877ff"}, {fillColor: "#ff77ab"}, {fillColor: "#ff6600"}, {fillColor: "#aa8800"}, {fillColor: "#77c7ff"},
            {fillColor: "#ad77ff"}, {fillColor: "#ff77ff"}, {fillColor: "#dd0083"}, {fillColor: "#777700"}, {fillColor: "#00aa00"},
            {fillColor: "#0088aa"}, {fillColor: "#8400dd"}, {fillColor: "#aa0088"}, {fillColor: "#dd0000"}, {fillColor: "#772e00"}
        ];

        // éè¦æ­¥éª¤ï¼åå§ååæ°
        if (!this.initBaseParameter()) {
            return;
        }

        // èæ¯æ¡ï¼é»è®¤ä¸å¯ç¨
        if (sets.useBackground) {
            this.shapes.push(ShapeFactory.Background(this.shapeFactory, this.chartBox, sets));
        }

        // æ°æ®å¼æ°ç»
        var fv = this.dataValues;
        if (fv.length < 1) {
            return;
        }       // æ²¡ææ°æ®

        // å¼åèå´
        var codomain = this.DVBCodomain;
        // å¼åèå´æ£æµ
        for (let i = 0; i < fv.length; i++) {
            if (fv[i] < codomain[0] || fv[i] > codomain[1]) {
                return;
            }
        }

        // å¼çç»å¯¹å¼æ»å
        var valueSum = 0;
        for (let i = 0; i < fv.length; i++) {
            valueSum += Math.abs(fv[i]);
        }

        // éè¦æ­¥éª¤ï¼å®ä¹å¾è¡¨ FeatureThemePie æ°æ®è§å¾æ¡ä¸­åä½å¼çå«ä¹ï¼åä½å¼ï¼æ¯åº¦ä»£è¡¨çæ°å¼
        this.DVBUnitValue = 360 / valueSum;
        var uv = this.DVBUnitValue;

        var dvbCenter = this.DVBCenterPoint;        // æ°æ®è§å¾æ¡ä¸­å¿ä½ä¸ºæå¿

        var startAngle = 0;         // æå½¢èµ·å§è¾¹è§åº¦
        var endAngle = 0;          // æå½¢ç»æ­¢è¾¹è§åº¦
        var startAngleTmp = startAngle;           // æå½¢ä¸´æ¶èµ·å§è¾¹è§åº¦
        // æå½¢ï¼èªéåºï¼åå¾
        var r = this.DVBHeight < this.DVBWidth ? this.DVBHeight / 2 : this.DVBWidth / 2;

        for (var i = 0; i < fv.length; i++) {
            var fvi = Math.abs(fv[i]);
            //è®¡ç®ç»æ­¢è§
            if (i === 0) {
                endAngle = startAngle + fvi * uv;
            } else if (i === fvi.length - 1) {
                endAngle = startAngleTmp;
            } else {
                endAngle = startAngle + fvi * uv;
            }
            //ç«æ­£è¯¯å·®è®¡ç®
            if ((endAngle - startAngle) >= 360) {
                endAngle = 359.9999999;
            }

            // æå½¢åæ°å¯¹è±¡
            var sectorSP = new Sector(dvbCenter[0], dvbCenter[1], r, startAngle, endAngle);
            // æå½¢æ ·å¼
            if (typeof(sets.sectorStyleByFields) === "undefined") {
                // ä½¿ç¨é»è®¤ style ç»
                var colorIndex = i % defaultStyleGroup.length;
                sectorSP.style = ShapeFactory.ShapeStyleTool(null, sets.sectorStyle, defaultStyleGroup, null, colorIndex);
            } else {
                sectorSP.style = ShapeFactory.ShapeStyleTool(null, sets.sectorStyle, sets.sectorStyleByFields, sets.sectorStyleByCodomain, i, fv[i]);
            }

            // æå½¢ hover æ ·å¼
            sectorSP.highlightStyle = ShapeFactory.ShapeStyleTool(null, sets.sectorHoverStyle);
            // æå½¢ hover ä¸ click è®¾ç½®
            if (typeof(sets.sectorHoverAble) !== "undefined") {
                sectorSP.hoverable = sets.sectorHoverAble;
            }
            if (typeof(sets.sectorClickAble) !== "undefined") {
                sectorSP.clickable = sets.sectorClickAble;
            }
            // å¾å½¢æºå¸¦çæ°æ®ä¿¡æ¯
            sectorSP.refDataID = this.data.id;
            sectorSP.dataInfo = {
                field: this.fields[i],
                value: fv[i]
            };

            // åå»ºæå½¢å¹¶ææ­¤æå½¢æ·»å å°å¾è¡¨å¾å½¢æ°ç»
            this.shapes.push(this.shapeFactory.createShape(sectorSP));

            // æä¸ä¸æ¬¡çç»æè§åº¦ä½ä¸ºä¸ä¸æ¬¡çèµ·å§è§åº¦
            startAngle = endAngle;
        }

        // éè¦æ­¥éª¤ï¼å°å¾å½¢è½¬ä¸ºç±ç¸å¯¹åæ è¡¨ç¤ºçå¾å½¢ï¼ä»¥ä¾¿å¨å°å¾å¹³ç§»ç¼©æ¾è¿ç¨ä¸­å¿«ééç»å¾å½¢
        // ï¼ç»è®¡ä¸é¢å¾æ¨¡åä»ç»æä¸è¦æ±ä½¿ç¨ç¸å¯¹åæ ï¼assembleShapes() å½æ°å¿é¡»å¨å¾å½¢è£éå®æåè°ç¨ shapesConvertToRelativeCoordinate() å½æ°ï¼
        this.shapesConvertToRelativeCoordinate();
    }

}

;// CONCATENATED MODULE: ./src/common/overlay/Point.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class FeatureThemePoint
 * @aliasclass Feature.Theme.Point
 * @deprecatedclass SuperMap.Feature.Theme.Point
 * @classdesc ç¹ç¶å¾ã
 * @category Visualization Theme
 * @param {FeatureVector} data - ç¨æ·æ°æ®ã
 * @param {SuperMap.Layer.Graph} layer - æ­¤ä¸é¢è¦ç´ æå¨å¾å±ã
 * @param {Array.<string>} fields - data ä¸­çåä¸æ­¤å¾è¡¨çæçå­æ®µåç§°ã
 * @param {FeatureThemePoint.setting} setting - å¾è¡¨éç½®å¯¹è±¡ã
 * @param {LonLat} [lonlat] - ä¸é¢è¦ç´ å°çä½ç½®ãé»è®¤ä¸º data æä»£çå°çè¦ç´  Bounds ä¸­å¿ã
 * @example
 * // pointStyleByCodomain çæ¯ä¸ªåç´ æ¯ä¸ªåå«å¼åä¿¡æ¯åä¸å¼åå¯¹åºæ ·å¼ä¿¡æ¯çå¯¹è±¡ï¼è¯¥å¯¹è±¡ï¼å¿é¡»ï¼æä¸ä¸ªå±æ§ï¼
 * // start: å¼åå¼ä¸éï¼åå«ï¼;
 * // end: å¼åå¼ä¸éï¼ä¸åå«ï¼;
 * // style: æ°æ®å¯è§åå¾å½¢ç styleï¼è¿ä¸ªæ ·å¼å¯¹è±¡çå¯è®¾å±æ§ï¼ <Point.style> ã
 * // pointStyleByCodomain æ°ç»å½¢å¦ï¼
 * [
 *   {
 *     start:0,
 *     end:250,
 *     style:{
 *          fillColor:"#00CD00"
 *      }
 *  },
 *   {
 *     start:250,
 *     end:500,
 *     style:{
 *          fillColor:"#00EE00"
 *      }
 *  },
 *   {
 *     start:500,
 *     end:750,
 *     style:{
 *          fillColor:"#00FF7F"
 *      }
 *  },
 *   {
 *     start:750,
 *     end:1500,
 *     style:{
 *          fillColor:"#00FF00"
 *      }
 *  }
 * ]
 * @extends FeatureThemeGraph
 * @usage
 * @private
 */
class overlay_Point_Point extends Graph {

    constructor(data, layer, fields, setting, lonlat, options) {
        super(data, layer, fields, setting, lonlat, options);
        this.CLASS_NAME = "SuperMap.Feature.Theme.Point";
    }

    /**
     * @function FeatureThemePoint.prototype.destroy
     * @description éæ¯æ­¤ä¸é¢è¦ç´ ãè°ç¨ destroy åæ­¤å¯¹è±¡æä»¥å±æ§ç½®ä¸º nullã
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function FeatureThemePoint.prototype.Point.assembleShapes
     * @description è£éå¾å½¢ï¼æ©å±æ¥å£ï¼ã
     */
    assembleShapes() {
        // å¾è¡¨éç½®å¯¹è±¡
        var sets = this.setting;

        // é»è®¤æ°æ®è§å¾æ¡
        if (!sets.dataViewBoxParameter) {
            if (typeof(sets.useAxis) === "undefined" || sets.useAxis) {
                sets.dataViewBoxParameter = [45, 15, 15, 15];
            } else {
                sets.dataViewBoxParameter = [5, 5, 5, 5];
            }
        }

        // éè¦æ­¥éª¤ï¼åå§ååæ°
        if (!this.initBaseParameter()) {
            return;
        }

        var dvb = this.dataViewBox;

        // å¼å
        var codomain = this.DVBCodomain;
        // éè¦æ­¥éª¤ï¼å®ä¹å¾è¡¨ FeatureThemeBar æ°æ®è§å¾æ¡ä¸­åä½å¼çå«ä¹
        this.DVBUnitValue = (codomain[1] - codomain[0]) / this.DVBHeight;
        var uv = this.DVBUnitValue;
        var fv = this.dataValues;

        // è·å x è½´ä¸çå¾å½¢ä¿¡æ¯
        var xShapeInfo = this.calculateXShapeInfo();
        if (!xShapeInfo) {
            return;
        }
        // æçº¿æ¯ä¸ªèç¹ç x ä½ç½®
        var xsLoc = xShapeInfo.xPositions;

        // èæ¯æ¡ï¼é»è®¤å¯ç¨
        if (typeof(sets.useBackground) === "undefined" || sets.useBackground) {
            // å°èæ¯æ¡å¾å½¢æ·»å å°æ¨¡åç shapes æ°ç»ï¼æ³¨ææ·»å é¡ºåºï¼åæ·»å çå¾å½¢å¨åæ·»å çå¾å½¢ä¹ä¸ã
            this.shapes.push(ShapeFactory.Background(this.shapeFactory, this.chartBox, sets));
        }

        // ç¹ç¶å¾å¿é¡»ä½¿ç¨åæ è½´
        this.shapes = this.shapes.concat(ShapeFactory.GraphAxis(this.shapeFactory, dvb, sets, xShapeInfo));

        var xPx;        // å¾å½¢ç¹ x åæ 
        var yPx;        // å¾å½¢ç¹ y åæ 
        for (var i = 0, len = fv.length; i < len; i++) {
            // æ°æ®æº¢åºå¼åæ£æ¥
            if (fv[i] < codomain[0] || fv[i] > codomain[1]) {
                //isDataEffective = false;
                return null;
            }

            xPx = xsLoc[i];
            yPx = dvb[1] - (fv[i] - codomain[0]) / uv;

            // å¾å½¢ç¹åæ°å¯¹è±¡
            var poiSP = new Point_Point(xPx, yPx);
            // å¾å½¢ç¹ style
            poiSP.style = ShapeFactory.ShapeStyleTool({fillColor: "#ee9900"}, sets.pointStyle, sets.pointStyleByFields, sets.pointStyleByCodomain, i, fv[i]);
            // å¾å½¢ç¹ hover æ ·å¼
            poiSP.highlightStyle = ShapeFactory.ShapeStyleTool(null, sets.pointHoverStyle);

            // å¾å½¢ç¹ hover click
            if (typeof(sets.pointHoverAble) !== "undefined") {
                poiSP.hoverable = sets.pointHoverAble;
            }
            if (typeof(sets.pointClickAble) !== "undefined") {
                poiSP.clickable = sets.pointClickAble;
            }

            // å¾å½¢æºå¸¦çæ°æ®ä¿¡æ¯
            poiSP.refDataID = this.data.id;
            poiSP.dataInfo = {
                field: this.fields[i],
                value: fv[i]
            };

            // åå»ºå¾å½¢ç¹å¹¶ææ­¤å¾å½¢æ·»å å°å¾è¡¨å¾å½¢æ°ç»
            this.shapes.push(this.shapeFactory.createShape(poiSP));
        }

        // æ°æ®èå´æ£æµæªéè¿ï¼æ¸ç©ºå¾å½¢
        // if (isDataEffective === false) {
        //     this.shapes = [];
        // }

        // éè¦æ­¥éª¤ï¼å°å¾å½¢è½¬ä¸ºç±ç¸å¯¹åæ è¡¨ç¤ºçå¾å½¢ï¼ä»¥ä¾¿å¨å°å¾å¹³ç§»ç¼©æ¾è¿ç¨ä¸­å¿«ééç»å¾å½¢
        // ï¼ç»è®¡ä¸é¢å¾æ¨¡åä»ç»æä¸è¦æ±ä½¿ç¨ç¸å¯¹åæ ï¼assembleShapes() å½æ°å¿é¡»å¨å¾å½¢è£éå®æåè°ç¨ shapesConvertToRelativeCoordinate() å½æ°ï¼
        this.shapesConvertToRelativeCoordinate();
    }

    /**
     * @function FeatureThemePoint.prototype.calculateXShapeInfo
     * @description è®¡ç® X è½´æ¹åä¸çå¾å½¢ä¿¡æ¯ï¼æ­¤ä¿¡æ¯æ¯ä¸ä¸ªå¯¹è±¡ï¼åå«ä¸¤ä¸ªå±æ§ï¼
     *              å±æ§ xPositions æ¯ä¸ä¸ªä¸ç»´æ°ç»ï¼è¯¥æ°ç»åç´ è¡¨ç¤ºå¾å½¢å¨ x è½´æ¹åä¸çåç´ åæ å¼ï¼
     *              å¦æå¾å½¢å¨ x æ¹åä¸æä¸å®å®½åº¦ï¼éå¸¸åå¾å½¢å¨ x æ¹åä¸çä¸­å¿ç¹ä¸ºå¾å½¢å¨ x æ¹åä¸çåæ å¼ã
     *              width è¡¨ç¤ºå¾å½¢çå®½åº¦ï¼ç¹å«æ³¨æï¼ç¹çå®½åº¦å§ç»ä¸º 0ï¼èä¸æ¯å¶ç´å¾ï¼ã
     *              æ¬å½æ°ä¸­å¾å½¢éç½®å¯¹è±¡ setting å¯è®¾å±æ§ï¼<br>
     *              xShapeBlank - {Array.<number>} æ°´å¹³æ¹åä¸çå¾å½¢ç©ºç½é´éåæ°ã
     *              é¿åº¦ä¸º 2 çæ°ç»ï¼ç¬¬ä¸åç´ è¡¨ç¤ºç¬¬æçº¿å·¦ç«¯ç¹ä¸æ°æ®è§å¾æ¡å·¦ç«¯çç©ºç½é´è·ï¼ç¬¬äºä¸ªåç´ è¡¨ç¤ºæçº¿å³ç«¯ç¹å³ç«¯ä¸æ°æ®è§å¾æ¡å³ç«¯ç«¯çç©ºç½é´è· ã
     * @returns {Object} å¦æè®¡ç®å¤±è´¥ï¼è¿å nullï¼å¦æè®¡ç®æåï¼è¿å X è½´æ¹åä¸çå¾å½¢ä¿¡æ¯ï¼æ­¤ä¿¡æ¯æ¯ä¸ä¸ªå¯¹è±¡ï¼åå«ä»¥ä¸ä¸¤ä¸ªå±æ§ï¼<br>
     *         xPositions - {Array.<number>} è¡¨ç¤ºå¾å½¢å¨ x è½´æ¹åä¸çåç´ åæ å¼ï¼å¦æå¾å½¢å¨ x æ¹åä¸æä¸å®å®½åº¦ï¼éå¸¸åå¾å½¢å¨ x æ¹åä¸çä¸­å¿ç¹ä¸ºå¾å½¢å¨ x æ¹åä¸çåæ å¼ã
     *         width - {number}è¡¨ç¤ºå¾å½¢çå®½åº¦ï¼ç¹å«æ³¨æï¼ç¹çå®½åº¦å§ç»ä¸º 0ï¼èä¸æ¯å¶ç´å¾ï¼ã
     */
    calculateXShapeInfo() {
        var dvb = this.dataViewBox;     // æ°æ®è§å¾æ¡
        var sets = this.setting;     // å¾è¡¨éç½®å¯¹è±¡
        var fvc = this.dataValues.length;      // æ°ç»å¼ä¸ªæ°

        if (fvc < 1) {
            return null;
        }

        var xBlank;        // x è½´ç©ºç½é´éåæ°
        var xShapePositions = [];         // x è½´ä¸å¾å½¢çä½ç½®
        var xShapeWidth = 0;          // x è½´ä¸å¾å½¢å®½åº¦(èªéåº)
        var dvbWidth = this.DVBWidth;            // æ°æ®è§å¾æ¡å®½åº¦
        var unitOffset = 0;               // åä½åç§»é

        //  x è½´ç©ºç½é´éåæ°å¤ç
        if (sets.xShapeBlank && sets.xShapeBlank.length && sets.xShapeBlank.length == 2) {
            xBlank = sets.xShapeBlank;
            var xsLen = dvbWidth - (xBlank[0] + xBlank[1]);
            if (xsLen <= fvc) {
                return null;
            }
            unitOffset = xsLen / (fvc - 1);
        } else {
            // é»è®¤ä½¿ç¨ç­è·ç¦»ç©ºç½é´éï¼ç©ºç½é´éä¸ºå¾å½¢å®½åº¦
            unitOffset = dvbWidth / (fvc + 1);
            xBlank = [unitOffset, unitOffset, unitOffset];
        }

        // å¾å½¢ x è½´ä¸çä½ç½®è®¡ç®
        var xOffset = 0
        for (var i = 0; i < fvc; i++) {
            if (i == 0) {
                xOffset = xBlank[0];
            } else {
                xOffset += unitOffset;
            }

            xShapePositions.push(dvb[0] + xOffset);
        }

        return {
            "xPositions": xShapePositions,
            "width": xShapeWidth
        };
    }

}

;// CONCATENATED MODULE: ./src/common/overlay/Ring.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class FeatureThemeRing
 * @aliasclass Feature.Theme.Ring
 * @deprecatedclass SuperMap.Feature.Theme.Ring
 * @classdesc ç¯ç¶å¾ã
 * @category Visualization Theme
 * @description åºäºè·¯ç±å¯¹è±¡è®¡ç®æå®ç¹ M å¼æä½çåæ°ç±»ãéè¿è¯¥ç±»æä¾åæ°ä¿¡æ¯ã

 * @param {FeatureVector} data - ç¨æ·æ°æ®ã
 * @param {SuperMap.Layer.Graph} layer - æ­¤ä¸é¢è¦ç´ æå¨å¾å±ã
 * @param {Array.<string>} fields - data ä¸­çåä¸æ­¤å¾è¡¨çæçå­æ®µåç§°ã
 * @param {FeatureThemeRing.setting} setting - å¾è¡¨éç½®å¯¹è±¡ã
 * @param {LonLat} [lonlat] - ä¸é¢è¦ç´ å°çä½ç½®ãé»è®¤ä¸º data æä»£çå°çè¦ç´  Bounds ä¸­å¿ã
 * @example
 * // sectorStyleByCodomain çæ¯ä¸ªåç´ æ¯ä¸ªåå«å¼åä¿¡æ¯åä¸å¼åå¯¹åºæ ·å¼ä¿¡æ¯çå¯¹è±¡ï¼è¯¥å¯¹è±¡ï¼å¿é¡»ï¼æä¸ä¸ªå±æ§ï¼
 * // start: å¼åå¼ä¸éï¼åå«ï¼;
 * // end: å¼åå¼ä¸éï¼ä¸åå«ï¼;
 * // style: æ°æ®å¯è§åå¾å½¢ç styleï¼è¿ä¸ªæ ·å¼å¯¹è±¡çå¯è®¾å±æ§ï¼ <ShapeParametersSector.style> ã
 * // sectorStyleByCodomain æ°ç»å½¢å¦ï¼
 * [
 *   {
 *     start:0,
 *     end:250,
 *     style:{
 *          fillColor:"#00CD00"
 *      }
 *  },
 *   {
 *     start:250,
 *     end:500,
 *     style:{
 *          fillColor:"#00EE00"
 *      }
 *  },
 *   {
 *     start:500,
 *     end:750,
 *     style:{
 *          fillColor:"#00FF7F"
 *      }
 *  },
 *   {
 *     start:750,
 *     end:1500,
 *     style:{
 *          fillColor:"#00FF00"
 *      }
 *  }
 * ]
 * @param {Object} [sectorHoverStyle=true] - ç¯ç¶å¾æå½¢ hover ç¶ææ¶çæ ·å¼ï¼sectorHoverAble ä¸º true æ¶ææã
 * @param {boolean} [sectorHoverAble=true] - æ¯å¦åè®¸ç¯ç¶å¾æå½¢ä½¿ç¨ hover ç¶æãåæ¶è®¾ç½® sectorHoverAble å sectorClickAble ä¸º falseï¼å¯ä»¥ç´æ¥å±è½ç¯ç¶å¾æå½¢å¯¹ä¸é¢å¾å±äºä»¶çååºã
 * @param {boolean} [sectorClickAble=true] - æ¯å¦åè®¸ç¯ç¶å¾æå½¢è¢«ç¹å»ãåæ¶è®¾ç½® sectorHoverAble å sectorClickAble ä¸º falseï¼å¯ä»¥ç´æ¥å±è½ç¯ç¶å¾æå½¢å¯¹ä¸é¢å¾å±äºä»¶çååºã
 *
 * @extends FeatureThemeGraph
 * @usage
 * @private
 */
class Ring extends Graph {

    constructor(data, layer, fields, setting, lonlat) {
        super(data, layer, fields, setting, lonlat);
        this.CLASS_NAME = "SuperMap.Feature.Theme.Ring";
    }

    /**
     * @function FeatureThemeRing.prototype.destroy
     * @description éæ¯æ­¤ä¸é¢è¦ç´ ãè°ç¨ destroy åæ­¤å¯¹è±¡æä»¥å±æ§ç½®ä¸º nullã
     */
    destroy() {
        super.destroy();
    }

    /**
     * @function FeatureThemeRing.prototype.assembleShapes
     * @description è£éå¾å½¢ï¼æ©å±æ¥å£ï¼ã
     */
    assembleShapes() {
        // éè¦æ­¥éª¤ï¼åå§ååæ°
        if (!this.initBaseParameter()) {
            return;
        }

        // ä¸ä¸ªé»è®¤ style ç»
        var defaultStyleGroup = [
            {fillColor: "#ff9277"}, {fillColor: "#dddd00"}, {fillColor: "#ffc877"}, {fillColor: "#bbe3ff"}, {fillColor: "#d5ffbb"},
            {fillColor: "#bbbbff"}, {fillColor: "#ddb000"}, {fillColor: "#b0dd00"}, {fillColor: "#e2bbff"}, {fillColor: "#ffbbe3"},
            {fillColor: "#ff7777"}, {fillColor: "#ff9900"}, {fillColor: "#83dd00"}, {fillColor: "#77e3ff"}, {fillColor: "#778fff"},
            {fillColor: "#c877ff"}, {fillColor: "#ff77ab"}, {fillColor: "#ff6600"}, {fillColor: "#aa8800"}, {fillColor: "#77c7ff"},
            {fillColor: "#ad77ff"}, {fillColor: "#ff77ff"}, {fillColor: "#dd0083"}, {fillColor: "#777700"}, {fillColor: "#00aa00"},
            {fillColor: "#0088aa"}, {fillColor: "#8400dd"}, {fillColor: "#aa0088"}, {fillColor: "#dd0000"}, {fillColor: "#772e00"}
        ];

        // å¾è¡¨éç½®å¯¹è±¡
        var sets = this.setting;

        // èæ¯æ¡ï¼é»è®¤ä¸å¯ç¨
        if (sets.useBackground) {
            this.shapes.push(ShapeFactory.Background(this.shapeFactory, this.chartBox, sets));
        }

        // æ°æ®å¼æ°ç»
        var fv = this.dataValues;
        if (fv.length < 1) {
            return;
        }       // æ²¡ææ°æ®

        // å¼åèå´
        var codomain = this.DVBCodomain;
        // å¼åèå´æ£æµ
        for (let i = 0; i < fv.length; i++) {
            if (fv[i] < codomain[0] || fv[i] > codomain[1]) {
                return;
            }
        }

        // å¼çç»å¯¹å¼æ»å
        var valueSum = 0;
        for (let i = 0; i < fv.length; i++) {
            valueSum += Math.abs(fv[i]);
        }

        // éè¦æ­¥éª¤ï¼å®ä¹å¾è¡¨ FeatureThemeRing æ°æ®è§å¾æ¡ä¸­åä½å¼çå«ä¹ï¼åä½å¼ï¼æ¯åº¦ä»£è¡¨çæ°å¼
        this.DVBUnitValue = 360 / valueSum;
        var uv = this.DVBUnitValue;

        var dvbCenter = this.DVBCenterPoint;        // æ°æ®è§å¾æ¡ä¸­å¿ä½ä¸ºæå¿

        var startAngle = 0;         // æå½¢èµ·å§è¾¹è§åº¦
        var endAngle = 0;          // æå½¢ç»æ­¢è¾¹è§åº¦
        var startAngleTmp = startAngle;           // æå½¢ä¸´æ¶èµ·å§è¾¹è§åº¦
        // æå½¢å¤ç¯ï¼èªéåºï¼åå¾
        var r = this.DVBHeight < this.DVBWidth ? this.DVBHeight / 2 : this.DVBWidth / 2;

        // æå½¢åç¯ï¼èªéåºï¼åå¾
        var isInRange = sets.innerRingRadius >= 0 && sets.innerRingRadius < r;
        var r0 = (
            typeof(sets.innerRingRadius) !== "undefined"
            && !isNaN(sets.innerRingRadius)
            && isInRange
        ) ? sets.innerRingRadius : 0;

        for (var i = 0; i < fv.length; i++) {
            var fvi = Math.abs(fv[i]);

            // è®¡ç®ç»æè§åº¦
            if (i === 0) {
                endAngle = startAngle + fvi * uv;
            } else if (i === fvi.length - 1) {
                endAngle = startAngleTmp;
            } else {
                endAngle = startAngle + fvi * uv;
            }

            // æå½¢åæ°å¯¹è±¡
            var sectorSP = new Sector(dvbCenter[0], dvbCenter[1], r, startAngle, endAngle, r0);
            // æå½¢æ ·å¼
            if (typeof(sets.sectorStyleByFields) === "undefined") {
                // ä½¿ç¨é»è®¤ style ç»
                var colorIndex = i % defaultStyleGroup.length;
                sectorSP.style = ShapeFactory.ShapeStyleTool(null, sets.sectorStyle, defaultStyleGroup, null, colorIndex);
            } else {
                sectorSP.style = ShapeFactory.ShapeStyleTool(null, sets.sectorStyle, sets.sectorStyleByFields, sets.sectorStyleByCodomain, i, fv[i]);
            }
            // æå½¢ hover æ ·å¼
            sectorSP.highlightStyle = ShapeFactory.ShapeStyleTool(null, sets.sectorHoverStyle);
            // æå½¢ hover ä¸ click è®¾ç½®
            if (typeof(sets.sectorHoverAble) !== "undefined") {
                sectorSP.hoverable = sets.sectorHoverAble;
            }
            if (typeof(sets.sectorClickAble) !== "undefined") {
                sectorSP.clickable = sets.sectorClickAble;
            }
            // å¾å½¢æºå¸¦çæ°æ®ä¿¡æ¯
            sectorSP.refDataID = this.data.id;
            sectorSP.dataInfo = {
                field: this.fields[i],
                value: fv[i]
            };

            // åå»ºæå½¢å¹¶ææ­¤æå½¢æ·»å å°å¾è¡¨å¾å½¢æ°ç»
            this.shapes.push(this.shapeFactory.createShape(sectorSP));

            // æä¸ä¸æ¬¡çç»æè§åº¦ä½ä¸ºä¸ä¸æ¬¡çèµ·å§è§åº¦
            startAngle = endAngle;
        }

        // éè¦æ­¥éª¤ï¼å°å¾å½¢è½¬ä¸ºç±ç¸å¯¹åæ è¡¨ç¤ºçå¾å½¢ï¼ä»¥ä¾¿å¨å°å¾å¹³ç§»ç¼©æ¾è¿ç¨ä¸­å¿«ééç»å¾å½¢
        // ï¼ç»è®¡ä¸é¢å¾æ¨¡åä»ç»æä¸è¦æ±ä½¿ç¨ç¸å¯¹åæ ï¼assembleShapes() å½æ°å¿é¡»å¨å¾å½¢è£éå®æåè°ç¨ shapesConvertToRelativeCoordinate() å½æ°ï¼
        this.shapesConvertToRelativeCoordinate();
    }

}

;// CONCATENATED MODULE: ./src/common/overlay/ThemeVector.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/






















/**
 * @class FeatureThemeVector
 * @aliasclass Feature.Theme.ThemeVector
 * @deprecatedclass SuperMap.Feature.Theme.ThemeVector
 * @classdesc ç¢éä¸é¢è¦ç´ ç±»ã
 * @category Visualization Theme
 * @extends FeatureTheme
 * @param {FeatureVector} data - ç¨æ·æ°æ®ï¼çç±»åä¸ºç¢éæ°æ® featureã
 * @param {SuperMap.Layer} layer - æ­¤ä¸é¢è¦ç´ æå¨å¾å±ã
 * @param {Object} style - æ ·å¼ã
 * @param {Object} options - åå»ºä¸é¢è¦ç´ æ¶çå¯éåæ°ã
 * @param {number} [options.nodesClipPixel=2] - èç¹æ½ç¨åç´ è·ç¦», åä½ï¼åç´ ã
 * @param {boolean} [options.isHoverAble=true] - å¾å½¢æ¯å¦å¯ hoverã
 * @param {boolean} [options.isMultiHover=true] - æ¯å¦ä½¿ç¨å¤å¾å½¢é«äº®ï¼isHoverAble ä¸º true æ¶çæã
 * @param {boolean} [options.isClickAble=true] - å¾å½¢æ¯å¦å¯ç¹å»ã
 * @param {Object} [options.highlightStyle] - é«äº®æ ·å¼ã
 * @usage
 */
class ThemeVector extends Theme_Theme {

    constructor(data, layer, style, options, shapeOptions) {
        super(data, layer);
        //æ°æ®ç geometry å±æ§å¿é¡»å­å¨ä¸ç±»åæ¯ Geometry æå¶å­ç±»çç±»å
        if (!data.geometry) {
            return;
        }
        if (!(data.geometry instanceof Geometry)) {
            return;
        }

        /**
         * @member {Bounds} [FeatureThemeVector.prototype.dataBounds]
         * @description ç¨æ·æ°æ®çï¼feature.geometryï¼å°çèå´ã
         */
        this.dataBounds = data.geometry.getBounds();

        /**
         * @member {number} [FeatureThemeVector.prototype.nodesClipPixel=2]
         * @description èç¹æ½ç¨åç´ è·ç¦»ã
         */
        this.nodesClipPixel = 2;

        /**
         * @member {boolean} [FeatureThemeVector.prototype.isHoverAble=true]
         * @description å¾å½¢æ¯å¦å¯ hoverã
         */
        this.isHoverAble = true;

        /**
         * @member {boolean} [FeatureThemeVector.prototype.isMultiHover=true]
         * @description æ¯å¦ä½¿ç¨å¤å¾å½¢é«äº®ï¼isHoverAble ä¸º true æ¶çæã
         */
        this.isMultiHover = true;

        /**
         * @member {boolean} [FeatureThemeVector.prototype.isClickAble=true]
         * @description å¾å½¢æ¯å¦å¯ç¹å»ã
         */
        this.isClickAble = true;

        /**
         * @member {Object} [FeatureThemeVector.prototype.highlightStyle]
         * @description é«äº®æ ·å¼ã
         */
        this.highlightStyle = null;

        /**
         * @member {Object} [FeatureThemeVector.prototype.shapeOptions]
         * @description æ·»å å°æ¸²æå¨åä¿®æ¹ shape çä¸äºå±æ§ï¼éç¹æ®æåµéå¸¸ä¸åè®¸è¿ä¹åã
         */
        this.shapeOptions = {};

        /**
         * @member {Object} [FeatureThemeVector.prototype.style]
         * @description å¯è§åå¾å½¢ç styleãå¨å­ç±»ä¸­è§å®å¶å¯¹è±¡ç»æåé»è®¤å±æ§å¼ã
         */
        this.style = style || {};


        this.CLASS_NAME = "SuperMap.Feature.Theme.Vector";
        this.style = style ? style : {};
        if (options) {
            Util.copyAttributesWithClip(this, options, ["shapeOptions", "dataBounds"])
        }
        if (shapeOptions) {
            Util.copyAttributesWithClip(this.shapeOptions, shapeOptions);
        }

        //è®¾ç½®åºç¡åæ° dataBoundsãlonlatãlocation
        var geometry = data.geometry;
        this.lonlat = this.dataBounds.getCenterLonLat();
        this.location = this.getLocalXY(this.lonlat);

        //å°å°çè¦ç´ è½¬ä¸ºä¸é¢è¦ç´ 
        if (geometry instanceof LinearRing) {
            this.lineToTF(geometry);
        } else if (geometry instanceof LineString) {
            this.lineToTF(geometry);
        } else if (geometry instanceof Curve) {
            //ç¬ç«å ä½ä½
        } else if (geometry instanceof MultiPoint) {
            this.multiPointToTF(geometry);
        } else if (geometry instanceof MultiLineString) {

            this.multiLineStringToTF(geometry);
        } else if (geometry instanceof MultiPolygon) {
            this.multiPolygonToTF(geometry);
        } else if (geometry instanceof Polygon) {
            this.polygonToTF(geometry);
        } else if (geometry instanceof Collection) {
            //ç¬ç«å ä½ä½
        } else if (geometry instanceof Point) {
            this.pointToTF(geometry);
        } else if (geometry instanceof Rectangle) {
            this.rectangleToTF(geometry);
        } else if (geometry instanceof GeoText) {
            this.geoTextToTF(geometry);
        }

    }

    /**
     * @function FeatureThemeVector.prototype.destroy
     * @override
     */
    destroy() {
        this.style = null;
        this.dataBounds = null;
        this.nodesClipPixel = null;
        this.isHoverAble = null;
        this.isMultiHover = null;
        this.isClickAble = null;
        this.highlightStyle = null;
        this.shapeOptions = null;
        super.destroy();
    }


    /**
     * @function FeatureThemeVector.prototype.lineToTF
     * @description è½¬æ¢çº¿åçº¿ç¯è¦ç´ ã
     * @param {Geometry} geometry - ç¨æ·æ°æ®å ä½å°çä¿¡æ¯ï¼è¿éå¿é¡»æ¯ GeometryLineString æ GeometryLineRingã
     */
    lineToTF(geometry) {
        var components = geometry.components;

        //èç¹åç´ åæ 
        var localLX = [];
        //åèä½ç½®ï¼åèä¸­å¿ä¸º
        var refLocal = [];
        var location = this.location;
        var pointList = [];

        //èç¹æ½ç¨è·ç¦»
        var nCPx = this.nodesClipPixel;

        for (var i = 0; i < components.length; i++) {
            var components_i = components[i];
            refLocal = [];
            localLX = this.getLocalXY(components_i);

            refLocal[0] = localLX[0] - location[0];
            refLocal[1] = localLX[1] - location[1];

            //æ½ç¨ - 2 px
            if (pointList.length > 0) {
                var lastLocalXY = pointList[pointList.length - 1];
                if ((Math.abs(lastLocalXY[0] - refLocal[0]) <= nCPx) && (Math.abs(lastLocalXY[1] - refLocal[1]) <= nCPx)) {
                    continue;
                }
            }

            //ä½¿ç¨åèç¹
            pointList.push(refLocal);
        }

        if (pointList.length < 2) {
            return null;
        }

        //èµ style
        var style = new Object();
        style = Util.copyAttributesWithClip(style, this.style, ['pointList']);
        style.pointList = pointList;

        //åå»ºå¾å½¢
        var shape = new SmicBrokenLine({
            style: style,
            clickable: this.isClickAble,
            hoverable: this.isHoverAble
        });

        //è®¾ç½®é«äº®æ ·å¼
        if (this.highlightStyle) {
            shape.highlightStyle = this.highlightStyle;
        }

        //è®¾ç½®åèä¸­å¿ï¼æå®å¾å½¢ä½ç½®
        shape.refOriginalPosition = this.location;

        //å¨å­æ°æ® id å±æ§ï¼ç¨äºäºä»¶
        shape.refDataID = this.data.id;

        //å¨å­æ°æ® id å±æ§ï¼ç¨äºäºä»¶-å¤å¾å½¢åæ¶é«äº®
        shape.isHoverByRefDataID = this.isMultiHover;

        //æ·»å å°æ¸²æå¨åä¿®æ¹ shape çä¸äºå±æ§ï¼éç¹æ®æåµéå¸¸ä¸åè®¸è¿ä¹å
        if (this.shapeOptions) {
            Util.copyAttributesWithClip(shape, this.shapeOptions);
        }

        this.shapes.push(shape);
    }


    /**
     * @function FeatureThemeVector.prototype.multiPointToTF
     * @description è½¬å¤ç¹è¦ç´ ã
     * @param {Geometry} geometry - ç¨æ·æ°æ®å ä½å°çä¿¡æ¯ï¼è¿éå¿é¡»æ¯ MultiPointã
     */
    multiPointToTF(geometry) {
        /*   //-- ä¸æ½ç¨
         var components = geometry.components;

         for(var i = 0; i < components.length; i++){
         var components_i = components[i];
         this.pointToTF(components_i);
         }
         */

        var components = geometry.components;

        //èç¹åç´ åæ 
        var localLX = [];
        //åèä½ç½®ï¼åèä¸­å¿ä¸º
        var refLocal = [];
        var location = this.location;
        var pointList = [];

        //èç¹æ½ç¨è·ç¦»
        var nCPx = this.nodesClipPixel;

        for (var i = 0; i < components.length; i++) {
            var components_i = components[i];
            refLocal = [];
            localLX = this.getLocalXY(components_i);

            refLocal[0] = localLX[0] - location[0];
            refLocal[1] = localLX[1] - location[1];

            //æ½ç¨
            if (pointList.length > 0) {
                var lastLocalXY = pointList[pointList.length - 1];
                if ((Math.abs(lastLocalXY[0] - refLocal[0]) <= nCPx) && (Math.abs(lastLocalXY[1] - refLocal[1]) <= nCPx)) {
                    continue;
                }
            }

            //ä½¿ç¨åèç¹
            pointList.push(refLocal);

            //èµ style
            var style = new Object();
            style.r = 6; //é²æ­¢æ¼è®¾æ­¤åæ°ï¼é»è®¤ 6 åç´ 
            style = Util.copyAttributesWithClip(style, this.style);
            style.x = refLocal[0];
            style.y = refLocal[1];

            //åå»ºå¾å½¢
            var shape = new SmicPoint({
                style: style,
                clickable: this.isClickAble,
                hoverable: this.isHoverAble
            });

            //è®¾ç½®é«äº®æ ·å¼
            if (this.highlightStyle) {
                shape.highlightStyle = this.highlightStyle;
            }

            //è®¾ç½®åèä¸­å¿ï¼æå®å¾å½¢ä½ç½®
            shape.refOriginalPosition = location;

            //å¨å­æ°æ® id å±æ§ï¼ç¨äºäºä»¶
            shape.refDataID = this.data.id;

            //å¨å­æ°æ® id å±æ§ï¼ç¨äºäºä»¶-å¤å¾å½¢åæ¶é«äº®
            shape.isHoverByRefDataID = this.isMultiHover;

            //ä¿®æ¹ä¸äº shape å¯éå±æ§ï¼éå¸¸ä¸éè¦è¿ä¹å
            if (this.shapeOptions) {
                Util.copyAttributesWithClip(shape, this.shapeOptions);
            }

            this.shapes.push(shape);
        }
    }


    /**
     * @function FeatureThemeVector.prototype.multiLineStringToTF
     * @description è½¬æ¢å¤çº¿è¦ç´ ã
     * @param {Geometry} geometry - ç¨æ·æ°æ®å ä½å°çä¿¡æ¯ï¼è¿éå¿é¡»æ¯ MultiLineStringã
     */
    multiLineStringToTF(geometry) {
        var components = geometry.components;

        for (var i = 0; i < components.length; i++) {
            var components_i = components[i];
            this.lineToTF(components_i);
        }
    }


    /**
     * @function FeatureThemeVector.prototype.multiPolygonToTF
     * @description è½¬æ¢å¤é¢è¦ç´ ã
     * @param {Geometry} geometry - ç¨æ·æ°æ®å ä½å°çä¿¡æ¯ï¼è¿éå¿é¡»æ¯ MultiPolygonã
     */
    multiPolygonToTF(geometry) {
        var components = geometry.components;

        for (var i = 0; i < components.length; i++) {
            var components_i = components[i];
            this.polygonToTF(components_i);
        }
    }


    /**
     * @function FeatureThemeVector.prototype.pointToTF
     * @description è½¬æ¢ç¹è¦ç´ ã
     * @param {Geometry} geometry - ç¨æ·æ°æ®å ä½å°çä¿¡æ¯ï¼è¿éå¿é¡»æ¯ Pointã
     */
    pointToTF(geometry) {
        //åèä½ç½®ï¼åèä¸­å¿ä¸º
        var location = this.location;
        //geometry åç´ åæ 
        var localLX = this.getLocalXY(geometry);

        //èµ style
        var style = new Object();
        style.r = 6; //é²æ­¢æ¼è®¾æ­¤åæ°ï¼é»è®¤ 6 åç´ 
        style = Util.copyAttributesWithClip(style, this.style);
        style.x = localLX[0] - location[0];
        style.y = localLX[1] - location[1];

        //åå»ºå¾å½¢
        var shape = new SmicPoint({
            style: style,
            clickable: this.isClickAble,
            hoverable: this.isHoverAble
        });

        //è®¾ç½®é«äº®æ ·å¼
        if (this.highlightStyle) {
            shape.highlightStyle = this.highlightStyle;
        }

        //è®¾ç½®åèä¸­å¿ï¼æå®å¾å½¢ä½ç½®
        shape.refOriginalPosition = location;

        //å¨å­æ°æ® id å±æ§ï¼ç¨äºäºä»¶
        shape.refDataID = this.data.id;

        //å¨å­æ°æ® id å±æ§ï¼ç¨äºäºä»¶-å¤å¾å½¢åæ¶é«äº®
        shape.isHoverByRefDataID = this.isMultiHover;

        //ä¿®æ¹ä¸äº shape å¯éå±æ§ï¼éå¸¸ä¸éè¦è¿ä¹å
        if (this.shapeOptions) {
            Util.copyAttributesWithClip(shape, this.shapeOptions);
        }

        this.shapes.push(shape);
    }


    /**
     * @function FeatureThemeVector.prototype.polygonToThemeFeature
     * @description è½¬æ¢é¢è¦ç´ ã
     * @param {Geometry} geometry - ç¨æ·æ°æ®å ä½å°çä¿¡æ¯ï¼è¿éå¿é¡»æ¯ Polygonã
     */
    polygonToTF(geometry) {
        var components = geometry.components;


        //èç¹åç´ åæ 
        var localLX = [];
        //åèä½ç½®ï¼åèä¸­å¿ä¸º
        var refLocal = [];
        var location = this.location;
        var pointList = [];
        //å²æ´
        var holePolygonPointList = [];
        var holePolygonPointLists = [];

        //èç¹æ½ç¨è·ç¦»
        var nCPx = this.nodesClipPixel;

        for (var i = 0; i < components.length; i++) {
            var components_i = components[i].components;


            if (i === 0) {
                // ç¬¬ä¸ä¸ª component æ­£å¸¸ç»å¶
                pointList = [];

                for (var j = 0; j < components_i.length; j++) {
                    refLocal = [];
                    localLX = this.getLocalXY(components_i[j]);

                    refLocal[0] = localLX[0] - location[0];
                    refLocal[1] = localLX[1] - location[1];

                    //æ½ç¨ - 2 px
                    if (pointList.length > 0) {
                        var lastLocalXY = pointList[pointList.length - 1];
                        if ((Math.abs(lastLocalXY[0] - refLocal[0]) <= nCPx) && (Math.abs(lastLocalXY[1] - refLocal[1]) <= nCPx)) {
                            continue;
                        }
                    }

                    //ä½¿ç¨åèç¹
                    pointList.push(refLocal);
                }
            } else {
                // å¶å® component ä½ä¸ºå²æ´
                holePolygonPointList = [];

                for (var k = 0; k < components_i.length; k++) {
                    refLocal = [];
                    localLX = this.getLocalXY(components_i[k]);

                    refLocal[0] = localLX[0] - location[0];
                    refLocal[1] = localLX[1] - location[1];

                    //æ½ç¨ - 2 px
                    if (holePolygonPointList.length > 0) {
                        var lastXY = holePolygonPointList[holePolygonPointList.length - 1];
                        if ((Math.abs(lastXY[0] - refLocal[0]) <= nCPx) && (Math.abs(lastXY[1] - refLocal[1]) <= nCPx)) {
                            continue;
                        }
                    }

                    //ä½¿ç¨åèç¹
                    holePolygonPointList.push(refLocal);
                }
            }

            if (holePolygonPointList.length < 2) {
                continue;
            }

            holePolygonPointLists.push(holePolygonPointList);
        }

        if (pointList.length < 2) {
            return;
        }

        //èµ style
        var style = {};
        style = Util.copyAttributesWithClip(style, this.style, ['pointList']);
        style.pointList = pointList;

        //åå»ºå¾å½¢
        var shape = new SmicPolygon({
            style: style,
            clickable: this.isClickAble,
            hoverable: this.isHoverAble
        });

        //è®¾ç½®é«äº®æ ·å¼
        if (this.highlightStyle) {
            shape.highlightStyle = this.highlightStyle;
        }

        //è®¾ç½®åèä¸­å¿ï¼æå®å¾å½¢ä½ç½®
        shape.refOriginalPosition = this.location;

        //å¨å­æ°æ® id å±æ§ï¼ç¨äºäºä»¶
        shape.refDataID = this.data.id;

        //å¨å­æ°æ® id å±æ§ï¼ç¨äºäºä»¶-å¤å¾å½¢åæ¶é«äº®
        shape.isHoverByRefDataID = this.isMultiHover;

        //å²æ´é¢
        if (holePolygonPointLists.length > 0) {
            shape.holePolygonPointLists = holePolygonPointLists;
        }

        //ä¿®æ¹ä¸äº shape å¯éå±æ§ï¼éå¸¸ä¸éè¦è¿ä¹å
        if (this.shapeOptions) {
            Util.copyAttributesWithClip(shape, this.shapeOptions);
        }

        this.shapes.push(shape);
    }


    /**
     * @function FeatureThemeVector.prototype.rectangleToTF
     * @description è½¬æ¢ç©å½¢è¦ç´ ã
     * @param {Geometry} geometry - ç¨æ·æ°æ®å ä½å°çä¿¡æ¯ï¼è¿éå¿é¡»æ¯ Rectangleã
     */
    rectangleToTF(geometry) {
        //åèä½ç½®ï¼åèä¸­å¿ä¸º
        var location = this.location;
        var ll = new LonLat(geometry.x, geometry.y);

        //å°å¾åè¾¨ç
        var res = this.layer.map.getResolution();

        //geometry åç´ åæ 
        var localLX = this.getLocalXY(ll);

        //èµ style
        var style = new Object();
        style.r = 6; //é²æ­¢æ¼è®¾æ­¤åæ°ï¼é»è®¤ 6 åç´ 
        style = Util.copyAttributesWithClip(style, this.style);
        style.x = localLX[0] - location[0];
        // Rectangle ä½¿ç¨å·¦ä¸è§å®ä½ï¼ SmicRectangle ä½¿ç¨å·¦ä¸è§å®ä½ï¼éè¦è½¬æ¢
        style.y = (localLX[1] - location[1]) - 2 * geometry.width / res;
        style.width = geometry.width / res;
        style.height = geometry.height / res;

        //åå»ºå¾å½¢
        var shape = new SmicRectangle({
            style: style,
            clickable: this.isClickAble,
            hoverable: this.isHoverAble
        });

        //è®¾ç½®é«äº®æ ·å¼
        if (this.highlightStyle) {
            shape.highlightStyle = this.highlightStyle;
        }

        //è®¾ç½®åèä¸­å¿ï¼æå®å¾å½¢ä½ç½®
        shape.refOriginalPosition = location;

        //å¨å­æ°æ® id å±æ§ï¼ç¨äºäºä»¶
        shape.refDataID = this.data.id;

        //å¨å­æ°æ® id å±æ§ï¼ç¨äºäºä»¶-å¤å¾å½¢åæ¶é«äº®
        shape.isHoverByRefDataID = this.isMultiHover;

        //ä¿®æ¹ä¸äº shape å¯éå±æ§ï¼éå¸¸ä¸éè¦è¿ä¹å
        if (this.shapeOptions) {
            Util.copyAttributesWithClip(shape, this.shapeOptions);
        }

        this.shapes.push(shape);
    }


    /**
     * @function FeatureThemeVector.prototype.geoTextToTF
     * @description è½¬æ¢ææ¬è¦ç´ ã
     * @param {Geometry} geometry - ç¨æ·æ°æ®å ä½å°çä¿¡æ¯ï¼è¿éå¿é¡»æ¯ GeoTextã
     */
    geoTextToTF(geometry) {
        //åèä½ç½®ï¼åèä¸­å¿ä¸º
        var location = this.location;
        //geometry åç´ åæ 
        var localLX = this.getLocalXY(geometry);

        //èµ style
        var style = new Object();
        style.r = 6; //é²æ­¢æ¼è®¾æ­¤åæ°ï¼é»è®¤ 6 åç´ 
        style = Util.copyAttributesWithClip(style, this.style, ["x", "y", "text"]);
        style.x = localLX[0] - location[0];
        style.y = localLX[1] - location[1];
        style.text = geometry.text;

        //åå»ºå¾å½¢
        var shape = new SmicText({
            style: style,
            clickable: this.isClickAble,
            hoverable: this.isHoverAble
        });

        //è®¾ç½®é«äº®æ ·å¼
        if (this.highlightStyle) {
            shape.highlightStyle = this.highlightStyle;
        }

        //è®¾ç½®åèä¸­å¿ï¼æå®å¾å½¢ä½ç½®
        shape.refOriginalPosition = location;

        //å¨å­æ°æ® id å±æ§ï¼ç¨äºäºä»¶
        shape.refDataID = this.data.id;

        //å¨å­æ°æ® id å±æ§ï¼ç¨äºäºä»¶-å¤å¾å½¢åæ¶é«äº®
        shape.isHoverByRefDataID = this.isMultiHover;

        //ä¿®æ¹ä¸äº shape å¯éå±æ§ï¼éå¸¸ä¸éè¦è¿ä¹å
        if (this.shapeOptions) {
            Util.copyAttributesWithClip(shape, this.shapeOptions);
        }

        this.shapes.push(shape);
    }


    /**
     * @function FeatureThemeVector.prototype.updateAndAddShapes
     * @description ä¿®æ¹ä½ç½®ï¼éå¯¹å°å¾å¹³ç§»æä½ï¼å°å¾æ¼«æ¸¸æä½åè°ç¨æ­¤å½æ°ã
     */
    updateAndAddShapes() {
        var newLocalLX = this.getLocalXY(this.lonlat);
        this.location = newLocalLX;

        var render = this.layer.renderer;
        for (var i = 0, len = this.shapes.length; i < len; i++) {
            var shape = this.shapes[i];
            //è®¾ç½®åèä¸­å¿ï¼æå®å¾å½¢ä½ç½®
            shape.refOriginalPosition = newLocalLX;
            render.addShape(shape);
        }
    }


    /**
     * @function FeatureThemeVector.prototype.getShapesCount
     * @description è·å¾ä¸é¢è¦ç´ ä¸­å¯è§åå¾å½¢çæ°éã
     * @returns {number} å¯è§åå¾å½¢çæ°éã
     */
    getShapesCount() {
        return this.shapes.length;
    }


    /**
     * @function FeatureThemeVector.prototype.getLocalXY
     * @description å°çåæ è½¬ä¸ºåç´ åæ ã
     * @param {LonLat} lonlat - ä¸é¢è¦ç´ å°çä½ç½®ã
     */
    getLocalXY(lonlat) {
        return this.layer.getLocalXY(lonlat);
    }

}

;// CONCATENATED MODULE: ./src/common/overlay/feature/index.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/

































;// CONCATENATED MODULE: ./src/common/overlay/levelRenderer/Group.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class  LevelRenderer.Group
 * @category Visualization Theme
 * @private
 * @classdesc Group æ¯ä¸ä¸ªå®¹å¨ï¼å¯ä»¥æå¥å­èç¹ï¼Group çåæ¢ä¹ä¼è¢«åºç¨å°å­èç¹ä¸ã
 * @extends {LevelRenderer.Transformable}
 * (code)
 *     var g = new LevelRenderer.Group();
 *     var Circle = new LevelRenderer.Shape.Circle();
 *     g.position[0] = 100;
 *     g.position[1] = 100;
 *     g.addChild(new Circle({
 *         style: {
 *             x: 100,
 *             y: 100,
 *             r: 20,
 *             brushType: 'fill'
 *         }
 *     }));
 *     LR.addGroup(g);
 * (end)
 * @param {Array} options - Group çéç½®ï¼optionsï¼é¡¹ï¼å¯ä»¥æ¯ Group çèªæå±æ§ï¼ä¹å¯ä»¥æ¯èªå®ä¹çå±æ§ã
 */

class Group extends mixinExt(Eventful, Transformable) {
    constructor(options) {
        super(options)
        options = options || {};
        /**
         * @member {string} LevelRenderer.Group.prototype.id
         * @description Group çå¯ä¸æ è¯ã
         */
        this.id = null;

        /**
         * @readonly
         * @member {string} [LevelRenderer.Group.prototype.type='group']
         * @description ç±»åã
         */
        this.type = 'group';

        //http://www.w3.org/TR/2dcontext/#clipping-region
        /**
         * @member {string} LevelRenderer.Group.prototype.clipShape
         * @description ç¨äºè£åªçå¾å½¢(shape)ï¼ææ Group åçå¾å½¢å¨ç»å¶æ¶é½ä¼è¢«è¿ä¸ªå¾å½¢è£åªï¼è¯¥å¾å½¢ä¼ç»§æ¿ Group çåæ¢ã
         */
        this.clipShape = null;

        /**
         * @member {Array} LevelRenderer.Group.prototype._children
         * @description _childrenã
         */
        this._children = [];

        /**
         * @member {Array} LevelRenderer.Group.prototype._storage
         * @description _storageã
         */
        this._storage = null;

        /**
         * @member {boolean} [LevelRenderer.Group.prototype.__dirty=true]
         * @description __dirtyã
         */
        this.__dirty = true;

        /**
         * @member {boolean} [LevelRenderer.Group.prototype.ignore=false]
         * @description æ¯å¦å¿½ç¥è¯¥ Group åå¶ææå­èç¹ã
         */
        this.ignore = false;
        Util.extend(this, options);
        this.id = this.id || Util.createUniqueID("smShapeGroup_");
        this.CLASS_NAME = "SuperMap.LevelRenderer.Group";
    }


    /**
     * @function LevelRenderer.Group.prototype.destroy
     * @description éæ¯å¯¹è±¡ï¼éæ¾èµæºãè°ç¨æ­¤å½æ°åææå±æ§å°è¢«ç½®ä¸º nullã
     */
    destroy() {
        this.id = null;
        this.type = null;
        this.clipShape = null;
        this._children = null;
        this._storage = null;
        this.__dirty = null;
        this.ignore = null;

        super.destroy();
    }


    /**
     * @function LevelRenderer.Group.prototype.children
     * @description å¤å¶å¹¶è¿åä¸ä»½æ°çåå«ææå¿å­èç¹çæ°ç»ã
     * @returns {Array.<LevelRenderer.Shape>} å¾å½¢æ°ç»ã
     */
    children() {
        return this._children.slice();
    }


    /**
     * @function LevelRenderer.Group.prototype.childAt
     * @description è·åæå® index çå¿å­èç¹
     * @param {number} idx - èç¹ç´¢å¼ã
     * @returns {LevelRenderer.Shape} å¾å½¢ã
     */
    childAt(idx) {
        return this._children[idx];
    }


    /**
     * @function LevelRenderer.Group.prototype.addChild
     * @description æ·»å å­èç¹ï¼å¯ä»¥æ¯ Shape æè Groupã
     * @param {(LevelRenderer.Shape|LevelRenderer.Group)} child - èç¹å¾å½¢ã
     */
    // TODO Type Check
    addChild(child) {
        if (child == this) {
            return;
        }

        if (child.parent == this) {
            return;
        }
        if (child.parent) {
            child.parent.removeChild(child);
        }

        this._children.push(child);
        child.parent = this;

        if (this._storage && this._storage !== child._storage) {

            this._storage.addToMap(child);

            if (child instanceof Group) {
                child.addChildrenToStorage(this._storage);
            }
        }
    }


    /**
     * @function LevelRenderer.Group.prototype.removeChild
     * @description ç§»é¤å­èç¹ã
     * @param {LevelRenderer.Shape} child - éè¦ç§»é¤çå­èç¹å¾å½¢ã
     */
    removeChild(child) {
        var idx = Util.indexOf(this._children, child);

        this._children.splice(idx, 1);
        child.parent = null;

        if (this._storage) {

            this._storage.delFromMap(child.id);

            if (child instanceof Group) {
                child.delChildrenFromStorage(this._storage);
            }
        }
    }


    /**
     * @function LevelRenderer.Group.prototype.eachChild
     * @description éåææå­èç¹ã
     * @param {function} cb - åè°å½æ°ã
     * @param {Object} context - ä¸ä¸æã
     */
    eachChild(cb, context) {
        var haveContext = !!context;
        for (var i = 0; i < this._children.length; i++) {
            var child = this._children[i];
            if (haveContext) {
                cb.call(context, child);
            } else {
                cb(child);
            }
        }
    }


    /**
     * @function LevelRenderer.Group.prototype.traverse
     * @description æ·±åº¦ä¼åéåææå­å­èç¹ã
     * @param {function} cb - åè°å½æ°ã
     * @param {Object} context - ä¸ä¸æã
     */
    traverse(cb, context) {
        var haveContext = !!context;
        for (var i = 0; i < this._children.length; i++) {
            var child = this._children[i];
            if (haveContext) {
                cb.call(context, child);
            } else {
                cb(child);
            }

            if (child.type === 'group') {
                child.traverse(cb, context);
            }
        }
    }


    /**
     * @function LevelRenderer.Group.prototype.addChildrenToStorage
     * @description æå­å¾å½¢æ·»å å°ä»åºã
     * @param {LevelRenderer.Storage} storage - å¾å½¢ä»åºã
     */
    addChildrenToStorage(storage) {
        for (var i = 0; i < this._children.length; i++) {
            var child = this._children[i];
            storage.addToMap(child);
            if (child.type === 'group') {
                child.addChildrenToStorage(storage);
            }
        }
    }


    /**
     * @function LevelRenderer.Group.prototype.delChildrenFromStorage
     * @description ä»ä»åºæå­å¾å½¢å é¤ã
     * @param {LevelRenderer.Storage} storage - å¾å½¢ä»åºã
     */
    delChildrenFromStorage(storage) {
        for (var i = 0; i < this._children.length; i++) {
            var child = this._children[i];
            storage.delFromMap(child.id);
            if (child.type === 'group') {
                child.delChildrenFromStorage(storage);
            }
        }
    }


    /**
     * @function LevelRenderer.Group.prototype.modSelf
     * @description æ¯å¦ä¿®æ¹ã
     */
    modSelf() {
        this.__dirty = true;
    }

}

;// CONCATENATED MODULE: ./src/common/overlay/levelRenderer/Storage.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @private
 * @class  LevelRenderer.Storage
 * @category Visualization Theme
 * @classdesc åå®¹ï¼å¾åï¼ä»åº (M) ã
 */
class Storage {
    constructor() {
        /**
         * @member {Object} LevelRenderer.Storage.prototype._elements
         * @description ææå¸¸è§å½¢ç¶ï¼id ç´¢å¼ç mapã
         */
        this._elements = {};

        /**
         * @member {Array} LevelRenderer.Storage.prototype._hoverElements
         * @description é«äº®å±å½¢ç¶ï¼ä¸ç¨³å®ï¼å¨æå¢å ï¼æ°ç»ä½ç½®ä¹æ¯ z è½´æ¹åï¼é åæ¾ç¤ºå¨ä¸æ¹ã
         *
         */
        this._hoverElements = [];

        /**
         * @member {Array} LevelRenderer.Storage.prototype._roots
         * @description _rootsã
         *
         */
        this._roots = [];

        /**
         * @member {Array} LevelRenderer.Storage.prototype._shapeList
         * @description _shapeListã
         *
         */
        this._shapeList = [];

        /**
         * @member {number} LevelRenderer.Storage.prototype._shapeListOffset
         * @description _shapeListOffsetãé»è®¤å¼ï¼0ã
         *
         */
        this._shapeListOffset = 0;

        this.CLASS_NAME = "SuperMap.LevelRenderer.Storage";
    }

    /**
     * @function LevelRenderer.Storage.prototype.destroy
     * @description éæ¯å¯¹è±¡ï¼éæ¾èµæºãè°ç¨æ­¤å½æ°åææå±æ§å°è¢«ç½®ä¸º nullã
     */
    destroy() {
        this.dispose();
        this._shapeList = null;
        this._shapeListOffset = null;
    }

    /**
     * @function LevelRenderer.Storage.prototype.iterShape
     * @description éåè¿­ä»£å¨ã
     *
     * @param {function} fun - è¿­ä»£åè°å½æ°ï¼return trueç»æ­¢è¿­ä»£ã
     * @param {Object} option - è¿­ä»£åæ°ï¼ç¼ºçä¸ºä»éåºéåæ®éå±å¾å½¢ã
     * @param {boolean} [hover=true] - æ¯å¦æ¯é«äº®å±å¾å½¢ã
     * @param {string} [normal='down'] - æ¯å¦æ¯æ®éå±å¾å½¢ï¼è¿­ä»£æ¶æ¯å¦æå®åzè½´é¡ºåºãå¯è®¾å¼ï¼'down' ï¼'up'ã
     * @param {boolean} [update=false] - æ¯å¦å¨è¿­ä»£åæ´æ°å½¢ç¶åè¡¨ã
     * @return {LevelRenderer.Storage} thisã
     */
    iterShape(fun, option) {
        if (!option) {
            var defaultIterateOption = {
                hover: false,
                normal: 'down',
                update: false
            };
            option = defaultIterateOption;
        }

        if (option.hover) {
            // é«äº®å±æ°æ®éå
            for (var i = 0, l = this._hoverElements.length; i < l; i++) {
                var el = this._hoverElements[i];
                el.updateTransform();
                if (fun(el)) {
                    return this;
                }
            }
        }

        if (option.update) {
            this.updateShapeList();
        }

        // éå: 'down' | 'up'
        switch (option.normal) {
            case 'down':
            {
                // éåºéåï¼é«å±ä¼å
                let l = this._shapeList.length;
                while (l--) {
                    if (fun(this._shapeList[l])) {
                        return this;
                    }
                }
                break;
            }
            // case 'up':
            default:
            {
                // ååºéåï¼åºå±ä¼å
                for (let i = 0, l = this._shapeList.length; i < l; i++) {
                    if (fun(this._shapeList[i])) {
                        return this;
                    }
                }
                break;
            }
        }

        return this;
    }

    /**
     * @function LevelRenderer.Storage.prototype.getHoverShapes
     * @param {boolean} [update=false] - æ¯å¦å¨è¿ååæ´æ°å¾å½¢çåæ¢ã
     * @return {Array.<LevelRenderer.Shape>} å¾å½¢æ°ç»ã
     */
    getHoverShapes(update) {
        // hoverConnect
        var hoverElements = [], len = this._hoverElements.length;
        for (let i = 0; i < len; i++) {
            hoverElements.push(this._hoverElements[i]);
            var target = this._hoverElements[i].hoverConnect;
            if (target) {
                var shape;
                target = target instanceof Array ? target : [target];
                for (var j = 0, k = target.length; j < k; j++) {
                    shape = target[j].id ? target[j] : this.get(target[j]);
                    if (shape) {
                        hoverElements.push(shape);
                    }
                }
            }
        }
        hoverElements.sort(Storage.shapeCompareFunc);
        if (update) {
            for (let i = 0, l = hoverElements.length; i < l; i++) {
                hoverElements[i].updateTransform();
            }
        }
        return hoverElements;
    }

    /**
     * @function LevelRenderer.Storage.prototype.getShapeList
     * @description è¿åææå¾å½¢çç»å¶éåã
     *
     * @param {boolean} [update=false] - æ¯å¦å¨è¿ååæ´æ°è¯¥æ°ç»ã  è¯¦è§ï¼<LevelRenderer.Shape> updateShapeListã
     * @return {LevelRenderer.Shape} å¾å½¢ã
     */
    getShapeList(update) {
        if (update) {
            this.updateShapeList();
        }
        return this._shapeList;
    }

    /**
     * @function LevelRenderer.Storage.prototype.updateShapeList
     * @description æ´æ°å¾å½¢çç»å¶éåãæ¯æ¬¡ç»å¶åé½ä¼è°ç¨ï¼è¯¥æ¹æ³ä¼åæ·±åº¦ä¼åéåæ´ä¸ªæ ï¼æ´æ°ææGroupåShapeçåæ¢å¹¶ä¸æææå¯è§çShapeä¿å­å°æ°ç»ä¸­ï¼æåæ ¹æ®ç»å¶çä¼åçº§ï¼zlevel > z > æå¥é¡ºåºï¼æåºå¾å°ç»å¶éåã
     */
    updateShapeList() {
        this._shapeListOffset = 0;
        var rootsLen = this._roots.length;
        for (let i = 0; i < rootsLen; i++) {
            let root = this._roots[i];
            this._updateAndAddShape(root);
        }
        this._shapeList.length = this._shapeListOffset;

        var shapeListLen = this._shapeList.length;
        for (let i = 0; i < shapeListLen; i++) {
            this._shapeList[i].__renderidx = i;
        }

        this._shapeList.sort(Storage.shapeCompareFunc);
    }

    /**
     * @function LevelRenderer.Storage.prototype._updateAndAddShape
     * @description æ´æ°å¹¶æ·»å å¾å½¢ã
     *
     */
    _updateAndAddShape(el, clipShapes) {
        if (el.ignore) {
            return;
        }

        el.updateTransform();

        if (el.type == 'group') {

            if (el.clipShape) {
                // clipShape çåæ¢æ¯åºäº group çåæ¢
                el.clipShape.parent = el;
                el.clipShape.updateTransform();

                // PENDING æçå½±å
                if (clipShapes) {
                    clipShapes = clipShapes.slice();
                    clipShapes.push(el.clipShape);
                } else {
                    clipShapes = [el.clipShape];
                }
            }

            for (var i = 0; i < el._children.length; i++) {
                var child = el._children[i];

                // Force to mark as dirty if group is dirty
                child.__dirty = el.__dirty || child.__dirty;

                this._updateAndAddShape(child, clipShapes);
            }

            // Mark group clean here
            el.__dirty = false;

        } else {
            el.__clipShapes = clipShapes;

            this._shapeList[this._shapeListOffset++] = el;
        }
    }

    /**
     * @function LevelRenderer.Storage.prototype.mod
     * @description ä¿®æ¹å¾å½¢(Shape)æèç»(Group)ã
     *
     * @param {string} elId - å¯ä¸æ è¯ã
     * @param {Object} params - åæ°ã
     * @return {LevelRenderer.Storage} thisã
     */
    mod(elId, params) {
        var el = this._elements[elId];
        if (el) {

            el.modSelf();

            if (params) {
                // å¦æç¬¬äºä¸ªåæ°ç´æ¥ä½¿ç¨ shape
                // parent, _storage, __startClip ä¸ä¸ªå±æ§ä¼æå¾ªç¯å¼ç¨
                // ä¸»è¦ä¸ºäºå 1.x çæ¬å¼å®¹ï¼2.x çæ¬ä¸å»ºè®®ä½¿ç¨ç¬¬äºä¸ªåæ°
                if (params.parent || params._storage || params.__startClip) {
                    var target = {};
                    for (var name in params) {
                        if (
                            name == 'parent'
                            || name == '_storage'
                            || name == '__startClip'
                        ) {
                            continue;
                        }
                        if (params.hasOwnProperty(name)) {
                            target[name] = params[name];
                        }
                    }
                    new Util_Util().merge(el, target, true);
                } else {
                    new Util_Util().merge(el, params, true);
                }
            }
        }

        return this;
    }

    /**
     * @function LevelRenderer.Storage.prototype.drift
     * @description ç§»å¨æå®çå¾å½¢(Shape)çä½ç½®ã
     * @param {string} shapeId - å¯ä¸æ è¯ã
     * @param {number} dx
     * @param {number} dy
     * @return {LevelRenderer.Storage} thisã
     */
    drift(shapeId, dx, dy) {
        var shape = this._elements[shapeId];
        if (shape) {
            shape.needTransform = true;
            if (shape.draggable === 'horizontal') {
                dy = 0;
            } else if (shape.draggable === 'vertical') {
                dx = 0;
            }
            if (!shape.ondrift // ondrift
                // æonbrushå¹¶ä¸è°ç¨æ§è¡è¿åfalseæundefinedåç»§ç»­
                || (shape.ondrift && !shape.ondrift(dx, dy))
            ) {
                shape.drift(dx, dy);
            }
        }

        return this;
    }

    /**
     * @function LevelRenderer.Storage.prototype.addHover
     * @description æ·»å é«äº®å±æ°æ®ã
     * @param {LevelRenderer.Shape} shape - å¾å½¢ã
     * @return {LevelRenderer.Storage} thisã
     */
    addHover(shape) {
        shape.updateNeedTransform();
        this._hoverElements.push(shape);
        return this;
    }

    /**
     * @function LevelRenderer.Storage.prototype.delHover
     * @description æ¸ç©ºé«äº®å±æ°æ®ã
     * @return {LevelRenderer.Storage} thisã
     */
    delHover() {
        this._hoverElements = [];
        return this;
    }

    /**
     * @function LevelRenderer.Storage.prototype.hasHoverShape
     * @description æ¯å¦æå¾å½¢å¨é«äº®å±éã
     * @return {boolean} æ¯å¦æå¾å½¢å¨é«äº®å±éã
     */
    hasHoverShape() {
        return this._hoverElements.length > 0;
    }

    /**
     * @function LevelRenderer.Storage.prototype.addRoot
     * @description æ·»å å¾å½¢(Shape)æèç»(Group)å°æ ¹èç¹ã
     *
     * @param {(LevelRenderer.Shape/LevelRenderer.Group)} el - å¾å½¢ã
     *
     */
    addRoot(el) {
        if (el instanceof Group) {
            el.addChildrenToStorage(this);
        }

        this.addToMap(el);
        this._roots.push(el);
    }

    /**
     * @function LevelRenderer.Storage.prototype.delRoot
     * @description å é¤æå®çå¾å½¢(Shape)æèç»(Group)ã
     *
     * @param {Array.<string>} elId - å é¤å¾å½¢(Shape)æèç»(Group)ç id æ°ç»ãå¦æä¸ºç©ºæ¸ç©ºæ´ä¸ªStorageã
     *
     */
    delRoot(elId) {
        if (typeof(elId) == 'undefined') {
            // ä¸æå®elIdæ¸ç©º
            for (var i = 0; i < this._roots.length; i++) {
                var root = this._roots[i];

                if (root instanceof Group) {
                    root.delChildrenFromStorage(this);
                }
            }

            this._elements = {};
            this._hoverElements = [];
            this._roots = [];

            return;
        }

        if (elId instanceof Array) {
            var elIdLen = elId.length;
            for (let i = 0; i < elIdLen; i++) {
                this.delRoot(elId[i]);
            }
            return;
        }

        var el;
        if (typeof(elId) == 'string') {
            el = this._elements[elId];
        } else {
            el = elId;
        }

        var idx = new Util_Util().indexOf(this._roots, el);
        if (idx >= 0) {
            this.delFromMap(el.id);
            this._roots.splice(idx, 1);
            if (el instanceof Group) {
                el.delChildrenFromStorage(this);
            }
        }
    }

    /**
     * @function LevelRenderer.Storage.prototype.addToMap
     * @description æ·»å å¾å½¢å° mapã
     *
     * @param {LevelRenderer.Shape} el - å¾å½¢ã
     * @return {LevelRenderer.Storage} thisã
     */
    addToMap(el) {
        if (el instanceof Group) {
            el._storage = this;
        }
        el.modSelf();

        this._elements[el.id] = el;

        return this;
    }

    /**
     * @function LevelRenderer.Storage.prototype.get
     * @description è·åæå®å¾å½¢ã
     *
     * @param {string} elId - å¾å½¢ idã
     * @return {LevelRenderer.Shape} å¾å½¢ã
     */
    get(elId) {
        return this._elements[elId];
    }

    /**
     * @function LevelRenderer.Storage.prototype.delFromMap
     * @description ä» map ä¸­å é¤æå®å¾å½¢ã
     *
     * @param {string} elId - å¾å½¢idã
     * @return {LevelRenderer.Storage} thisã
     */
    delFromMap(elId) {
        var el = this._elements[elId];
        if (el) {
            delete this._elements[elId];

            if (el instanceof Group) {
                el._storage = null;
            }
        }

        return this;
    }

    /**
     * @function LevelRenderer.Storage.prototype.dispose
     * @description æ¸ç©ºå¹¶ä¸éæ¾ Storageã
     */
    dispose() {
        this._elements = null;
        // this._renderList = null;
        this._roots = null;
        this._hoverElements = null;
    }

    static shapeCompareFunc(a, b) {
        if (a.zlevel == b.zlevel) {
            if (a.z == b.z) {
                return a.__renderidx - b.__renderidx;
            }
            return a.z - b.z;
        }
        return a.zlevel - b.zlevel;
    }

}

;// CONCATENATED MODULE: ./src/common/overlay/levelRenderer/Painter.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/







/**
 * @private
 * @class  LevelRenderer.Painter
 * @category Visualization Theme
 * @classdesc Painter ç»å¾æ¨¡åã
 * @param {HTMLElement} root - ç»å¾åºåï¼DIVï¼ã
 * @param {LevelRenderer.Storage} storage - Storage å®ä¾ã
 */
class Painter {
    constructor(root, storage) {
        /**
         * @member {HTMLElement} LevelRenderer.Painter.prototype.root
         * @description  ç»å¾å®¹å¨ã
         *
         */
        this.root = root;

        /**
         * @member {Array} LevelRenderer.Painter.prototype.storage
         * @description å¾å½¢ä»åºã
         *
         */
        this.storage = storage;

        /**
         * @member {HTMLElement} LevelRenderer.Painter.prototype._domRoot
         * @description å®¹å¨æ ¹ dom å¯¹è±¡ã
         *
         */
        this._domRoot = null;

        /**
         * @member {Object} LevelRenderer.Painter.prototype._layers
         * @description ç»å¶å±å¯¹è±¡ã
         *
         */
        this._layers = {};

        /**
         * @member {Array} LevelRenderer.Painter.prototype._zlevelList
         * @description  å±åè¡¨ã
         *
         */
        this._zlevelList = [];

        /**
         * @member {Object} LevelRenderer.Painter.prototype._layerConfig
         * @description ç»å¶å±éç½®å¯¹è±¡ã
         *
         */
        this._layerConfig = {};

        /**
         * @member {Object} LevelRenderer.Painter.prototype._bgDom
         * @description èæ¯å± Canvas ï¼Domï¼ã
         *
         */
        this._bgDom = null;

        /**
         * @member {function} LevelRenderer.Painter.prototype.shapeToImage
         * @description å½¢ç¶è½¬å¾åå½æ°ã
         *
         */
        this.shapeToImage = null;
        // retina å±å¹ä¼å
        Painter.devicePixelRatio = Math.max((window.devicePixelRatio || 1), 1);

        this.CLASS_NAME = "SuperMap.LevelRenderer.Painter";
        this.root.innerHTML = '';
        this._width = this._getWidth(); // å®½ï¼ç¼å­è®°å½
        this._height = this._getHeight(); // é«ï¼ç¼å­è®°å½

        var domRoot = document.createElement('div');
        this._domRoot = domRoot;

        // domRoot.onselectstart = returnFalse; // é¿åé¡µé¢éä¸­çå°´å°¬
        domRoot.style.position = 'relative';
        domRoot.style.overflow = 'hidden';
        domRoot.style.width = this._width + 'px';
        domRoot.style.height = this._height + 'px';
        this.root.appendChild(domRoot);

        this.shapeToImage = this._createShapeToImageProcessor();

        // åå»ºåå±canvas
        // èæ¯
        //this._bgDom = Painter.createDom('bg', 'div', this);
        this._bgDom = Painter.createDom(Util.createUniqueID("SuperMap.Theme_background_"), 'div', this);
        domRoot.appendChild(this._bgDom);
        this._bgDom.onselectstart = returnFalse;
        this._bgDom.style['-webkit-user-select'] = 'none';
        this._bgDom.style['user-select'] = 'none';
        this._bgDom.style['-webkit-touch-callout'] = 'none';

        // é«äº®
        //var hoverLayer = new PaintLayer('_hoverLayer_', this);
        var hoverLayer = new PaintLayer(Util.createUniqueID("_highLightLayer_"), this);
        this._layers['hover'] = hoverLayer;
        domRoot.appendChild(hoverLayer.dom);
        hoverLayer.initContext();

        hoverLayer.dom.onselectstart = returnFalse;
        hoverLayer.dom.style['-webkit-user-select'] = 'none';
        hoverLayer.dom.style['user-select'] = 'none';
        hoverLayer.dom.style['-webkit-touch-callout'] = 'none';

        var me = this;
        this.updatePainter = function (shapeList, callback) {
            me.refreshShapes(shapeList, callback);
        };

        // è¿åfalseçæ¹æ³ï¼ç¨äºé¿åé¡µé¢è¢«éä¸­
        function returnFalse() {
            return false;
        }

        /* eslint-disable */
        // ä»ä¹é½ä¸å¹²çç©ºæ¹æ³
        function doNothing() {  //NOSONAR
        }
        /* eslint-enable */
    }


    /**
     * @function LevelRenderer.Painter.prototype.destroy
     * @description éæ¯å¯¹è±¡ï¼éæ¾èµæºãè°ç¨æ­¤å½æ°åææå±æ§å°è¢«ç½®ä¸º nullã
     */
    destroy() {
        this.dispose();
        this._zlevelList = null;
        this._layerConfig = null;
        this._bgDom = null;
        this.shapeToImage = null;
    }


    /**
     * @function LevelRenderer.Painter.prototype.render
     * @description æ¸²æãé¦æ¬¡ç»å¾ï¼åå»ºåç§ dom å contextã
     *
     * @param {function} callback - ç»ç»ç»æåçåè°å½æ°ã
     * @return {LevelRenderer.Painter} thisã
     */
    render(callback) {
        // TODO
        this.refresh(callback, true);

        return this;
    }


    /**
     * @function LevelRenderer.Painter.prototype.refresh
     * @description å·æ°ã
     *
     * @param {function} callback - å·æ°ç»æåçåè°å½æ°ã
     * @param {boolean} paintAll - å¼ºå¶ç»å¶ææ shapeã
     * @return {LevelRenderer.Painter} thisã
     */
    refresh(callback, paintAll) {
        var list = this.storage.getShapeList(true);
        this._paintList(list, paintAll);

        if (typeof callback == 'function') {
            callback();
        }

        return this;
    }


    /**
     * Method: _paintList
     * æåè¡¨ç»å¶å¾å½¢ã
     */
    _paintList(list, paintAll) {
        if (typeof(paintAll) == 'undefined') {
            paintAll = false;
        }

        this._updateLayerStatus(list);

        var currentLayer;
        var currentZLevel;
        var ctx;

        for (var id in this._layers) {
            if (id !== 'hover') {
                this._layers[id].unusedCount++;
                this._layers[id].updateTransform();
            }
        }

        var invTransform = [];

        for (var i = 0, l = list.length; i < l; i++) {
            var shape = list[i];

            if (currentZLevel !== shape.zlevel) {
                if (currentLayer && currentLayer.needTransform) {
                    ctx.restore();
                }

                currentLayer = this.getLayer(shape.zlevel);
                ctx = currentLayer.ctx;
                currentZLevel = shape.zlevel;

                // Reset the count
                currentLayer.unusedCount = 0;

                if (currentLayer.dirty || paintAll) {
                    currentLayer.clear();
                }

                if (currentLayer.needTransform) {
                    ctx.save();
                    currentLayer.setTransform(ctx);
                }
            }

            // Start group clipping
            if (ctx && shape.__startClip) {
                var clipShape = shape.__startClip;
                ctx.save();
                // Set transform
                if (clipShape.needTransform) {
                    let m = clipShape.transform;
                    SUtil_SUtil.Util_matrix.invert(invTransform, m);
                    ctx.transform(
                        m[0], m[1],
                        m[2], m[3],
                        m[4], m[5]
                    );
                }

                ctx.beginPath();
                clipShape.buildPath(ctx, clipShape.style);
                ctx.clip();

                // Transform back
                if (clipShape.needTransform) {
                    let m = invTransform;
                    ctx.transform(
                        m[0], m[1],
                        m[2], m[3],
                        m[4], m[5]
                    );
                }
            }

            if (((currentLayer && currentLayer.dirty) || paintAll) && !shape.invisible) {
                if (
                    !shape.onbrush
                    || (shape.onbrush && !shape.onbrush(ctx, false))
                ) {
                    if (Config.catchBrushException) {
                        try {
                            shape.brush(ctx, false, this.updatePainter);
                        } catch (error) {
                            SUtil_SUtil.Util_log(
                                error,
                                'brush error of ' + shape.type,
                                shape
                            );
                        }
                    } else {
                        shape.brush(ctx, false, this.updatePainter);
                    }
                }
            }

            // Stop group clipping
            if (ctx && shape.__stopClip) {
                ctx.restore();
            }

            shape.__dirty = false;
        }

        if (ctx && currentLayer && currentLayer.needTransform) {
            ctx.restore();
        }

        for (let id in this._layers) {
            if (id !== 'hover') {
                var layer = this._layers[id];
                layer.dirty = false;
                // å é¤è¿æçå±
                // PENDING
                // if (layer.unusedCount >= 500) {
                //     this.delLayer(id);
                // }
                if (layer.unusedCount == 1) {
                    layer.clear();
                }
            }
        }

    }


    /**
     * @function LevelRenderer.Painter.prototype.getLayer
     * @description è·å zlevel æå¨å±ï¼å¦æä¸å­å¨åä¼åå»ºä¸ä¸ªæ°çå±ã
     *
     * @param {number} zlevel - zlevelã
     * @return {LevelRenderer.Painter} thisã
     */
    getLayer(zlevel) {
        // Change draw layer
        var currentLayer = this._layers[zlevel];
        if (!currentLayer) {
            var len = this._zlevelList.length;
            var prevLayer = null;
            var i = -1;
            if (len > 0 && zlevel > this._zlevelList[0]) {
                for (i = 0; i < len - 1; i++) {
                    if (
                        this._zlevelList[i] < zlevel
                        && this._zlevelList[i + 1] > zlevel
                    ) {
                        break;
                    }
                }
                prevLayer = this._layers[this._zlevelList[i]];
            }
            this._zlevelList.splice(i + 1, 0, zlevel);

            // Create a new layer
            //currentLayer = new PaintLayer(zlevel, this);
            currentLayer = new PaintLayer(Util.createUniqueID("_levelLayer_" + zlevel), this);
            var prevDom = prevLayer ? prevLayer.dom : this._bgDom;
            if (prevDom.nextSibling) {
                prevDom.parentNode.insertBefore(
                    currentLayer.dom,
                    prevDom.nextSibling
                );
            } else {
                prevDom.parentNode.appendChild(
                    currentLayer.dom
                );
            }
            currentLayer.initContext();

            this._layers[zlevel] = currentLayer;

            if (this._layerConfig[zlevel]) {
                new Util_Util().merge(currentLayer, this._layerConfig[zlevel], true);
            }

            currentLayer.updateTransform();
        }

        return currentLayer;
    }


    /**
     * @function LevelRenderer.Painter.prototype.getLayers
     * @description è·åææå·²åå»ºçå±ã
     * @return {Array.<Painter.Layer>} å·²åå»ºçå±
     */
    getLayers() {
        return this._layers;
    }


    /**
     * Method: _updateLayerStatus
     * æ´æ°ç»å¶å±ç¶æã
     */
    _updateLayerStatus(list) {
        var layers = this._layers;

        var elCounts = {};
        for (let z in layers) {
            if (z !== 'hover') {
                elCounts[z] = layers[z].elCount;
                layers[z].elCount = 0;
            }
        }

        for (let i = 0; i < list.length; i++) {
            var shape = list[i];
            var zlevel = shape.zlevel;
            var layer = layers[zlevel];
            if (layer) {
                layer.elCount++;
                // å·²ç»è¢«æ è®°ä¸ºéè¦å·æ°
                if (layer.dirty) {
                    continue;
                }
                layer.dirty = shape.__dirty;
            }
        }

        // å±ä¸­çåç´ æ°éæåçåå
        for (let z in layers) {
            if (z !== 'hover') {
                if (elCounts[z] !== layers[z].elCount) {
                    layers[z].dirty = true;
                }
            }
        }
    }


    /**
     * @function LevelRenderer.Painter.prototype.refreshShapes
     * @description æ´æ°çå¾å½¢åç´ åè¡¨ã
     *
     * @param {number} shapeList - éè¦æ´æ°çå¾å½¢åç´ åè¡¨ã
     * @param {number} callback - è§å¾æ´æ°ååè°å½æ°ã
     * @return {LevelRenderer.Painter} thisã
     */
    refreshShapes(shapeList, callback) {
        for (var i = 0, l = shapeList.length; i < l; i++) {
            var shape = shapeList[i];
            this.storage.mod(shape.id);
        }

        this.refresh(callback);
        return this;
    }


    /**
     * @function LevelRenderer.Painter.prototype.clear
     * @description æ¸é¤ hover å±å¤ææåå®¹ã
     * @return {LevelRenderer.Painter} thisã
     */
    clear() {
        for (var k in this._layers) {
            if (k == 'hover') {
                continue;
            }
            this._layers[k].clear();
        }

        return this;
    }


    /**
     * @function LevelRenderer.Painter.prototype.modLayer
     * @description ä¿®æ¹æå® zlevel çç»å¶åæ°ã
     *
     * @param {string} zlevel - zlevelã
     * @param {Object} config - éç½®å¯¹è±¡ã
     * @param {string} [config.clearColor=0] - æ¯æ¬¡æ¸ç©ºç»å¸çé¢è²ã
     * @param {boolean} [config.motionBlur=false] - æ¯å¦å¼å¯å¨ææ¨¡ç³ã
     * @param {number} [config.lastFrameAlpha=0.7] - å¨å¼å¯å¨ææ¨¡ç³çæ¶åä½¿ç¨ï¼ä¸ä¸ä¸å¸§æ··åçalphaå¼ï¼å¼è¶å¤§å°¾è¿¹è¶ææ¾ãé»è®¤å¼ï¼0.7ã
     * @param {Array.<number>} config.position - å±çå¹³ç§»ã
     * @param {Array.<number>} config.rotation - å±çæè½¬ã
     * @param {Array.<number>} config.scale - å±çç¼©æ¾ã
     * @param {boolean} config.zoomable - å±æ¯å¦æ¯æé¼ æ ç¼©æ¾æä½ãé»è®¤å¼ï¼falseã
     * @param {boolean} config.panable - å±æ¯å¦æ¯æé¼ æ å¹³ç§»æä½ãé»è®¤å¼ï¼falseã
     *
     */
    modLayer(zlevel, config) {
        if (config) {
            if (!this._layerConfig[zlevel]) {
                this._layerConfig[zlevel] = config;
            } else {
                new Util_Util().merge(this._layerConfig[zlevel], config, true);
            }

            var layer = this._layers[zlevel];

            if (layer) {
                new Util_Util().merge(layer, this._layerConfig[zlevel], true);
            }
        }
    }


    /**
     * @function LevelRenderer.Painter.prototype.delLayer
     * @description å é¤æå®å±ã
     *
     * @param {string} zlevel - å±æå¨ç zlevelã
     */
    delLayer(zlevel) {
        var layer = this._layers[zlevel];
        if (!layer) {
            return;
        }
        // Save config
        this.modLayer(zlevel, {
            position: layer.position,
            rotation: layer.rotation,
            scale: layer.scale
        });
        layer.dom.parentNode.removeChild(layer.dom);
        delete this._layers[zlevel];

        this._zlevelList.splice(new Util_Util().indexOf(this._zlevelList, zlevel), 1);
    }


    /**
     * @function LevelRenderer.Painter.prototype.refreshHover
     * @description å·æ° hover å±ã
     * @return {LevelRenderer.Painter} thisã
     */
    refreshHover() {
        this.clearHover();
        var list = this.storage.getHoverShapes(true);
        for (var i = 0, l = list.length; i < l; i++) {
            this._brushHover(list[i]);
        }
        this.storage.delHover();

        return this;
    }


    /**
     * @function LevelRenderer.Painter.prototype.clearHover
     * @description æ¸é¤ hover å±ææåå®¹ã
     * @return {LevelRenderer.Painter} thisã
     */
    clearHover() {
        var hover = this._layers.hover;
        hover && hover.clear();

        return this;
    }


    /**
     * @function LevelRenderer.Painter.prototype.resize
     * @description åºåå¤§å°åååéç»ã
     * @return {LevelRenderer.Painter} thisã
     */
    resize() {
        var domRoot = this._domRoot;
        domRoot.style.display = 'none';

        var width = this._getWidth();
        var height = this._getHeight();

        domRoot.style.display = '';

        // ä¼åæ²¡æå®éæ¹åçresize
        if (this._width != width || height != this._height) {
            this._width = width;
            this._height = height;

            domRoot.style.width = width + 'px';
            domRoot.style.height = height + 'px';

            for (var id in this._layers) {

                this._layers[id].resize(width, height);
            }

            this.refresh(null, true);
        }

        return this;
    }


    /**
     * @function LevelRenderer.Painter.prototype.clearLayer
     * @description æ¸é¤æå®çä¸ä¸ªå±ã
     * @param {number} zLevel - å±ã
     */
    clearLayer(zLevel) {
        var layer = this._layers[zLevel];
        if (layer) {
            layer.clear();
        }
    }


    /**
     * @function LevelRenderer.Painter.prototype.dispose
     * @description éæ¾ã
     *
     */
    dispose() {
        this.root.innerHTML = '';

        this.root = null;
        this.storage = null;
        this._domRoot = null;
        this._layers = null;
    }


    /**
     * @function LevelRenderer.Painter.prototype.getDomHover
     * @description è·å Hover å±ç Domã
     */
    getDomHover() {
        return this._layers.hover.dom;
    }


    /**
     * @function LevelRenderer.Painter.prototype.toDataURL
     * @description å¾åå¯¼åºã
     * @param {string} type - å¾çç±»åã
     * @param {string} backgroundColor - èæ¯è²ãé»è®¤å¼ï¼'#fff'ã
     * @param {Object} args
     * @return {string} å¾ççBase64 urlã
     */
    toDataURL(type, backgroundColor, args) {
        //var imageDom = Painter.createDom('image', 'canvas', this);
        var imageDom = Painter.createDom(Util.createUniqueID("SuperMap.Theme.image_"), 'canvas', this);
        this._bgDom.appendChild(imageDom);
        var ctx = imageDom.getContext('2d');
        Painter.devicePixelRatio != 1
        && ctx.scale(Painter.devicePixelRatio, Painter.devicePixelRatio);

        ctx.fillStyle = backgroundColor || '#fff';
        ctx.rect(
            0, 0,
            this._width * Painter.devicePixelRatio,
            this._height * Painter.devicePixelRatio
        );
        ctx.fill();

        var self = this;
        // ååºéåï¼shapeä¸çzlevelæå®ç»ç»å¾å±çzè½´å±å 

        this.storage.iterShape(
            function (shape) {
                if (!shape.invisible) {
                    if (!shape.onbrush // æ²¡æonbrush
                        // æonbrushå¹¶ä¸è°ç¨æ§è¡è¿åfalseæundefinedåç»§ç»­ç²å·
                        || (shape.onbrush && !shape.onbrush(ctx, false))
                    ) {
                        if (Config.catchBrushException) {
                            try {
                                shape.brush(ctx, false, self.updatePainter);
                            } catch (error) {
                                SUtil_SUtil.Util_log(
                                    error,
                                    'brush error of ' + shape.type,
                                    shape
                                );
                            }
                        } else {
                            shape.brush(ctx, false, self.updatePainter);
                        }
                    }
                }
            },
            {normal: 'up', update: true}
        );
        var image = imageDom.toDataURL(type, args);
        ctx = null;
        this._bgDom.removeChild(imageDom);
        return image;
    }


    /**
     * @function LevelRenderer.Painter.prototype.getWidth
     * @description  è·åç»å¾åºåå®½åº¦ã
     * @return {number} ç»å¾åºåå®½åº¦ã
     */
    getWidth() {
        return this._width;
    }


    /**
     * @function LevelRenderer.Painter.prototype.getHeight
     * @description è·åç»å¾åºåé«åº¦ã
     * @return {number} ç»å¾åºåé«åº¦ã
     */
    getHeight() {
        return this._height;
    }


    /**
     * Method: _getWidth
     *
     */
    _getWidth() {
        var root = this.root;
        var stl = root.currentStyle
            || document.defaultView.getComputedStyle(root);

        return ((root.clientWidth || parseInt(stl.width, 10))
            - parseInt(stl.paddingLeft, 10) // è¯·åè°æè¿æ¯è¾ç²æ´
            - parseInt(stl.paddingRight, 10)).toFixed(0) - 0;
    }


    /**
     * Method: _getHeight
     *
     */
    _getHeight() {
        var root = this.root;
        var stl = root.currentStyle
            || document.defaultView.getComputedStyle(root);

        return ((root.clientHeight || parseInt(stl.height, 10))
            - parseInt(stl.paddingTop, 10) // è¯·åè°æè¿æ¯è¾ç²æ´
            - parseInt(stl.paddingBottom, 10)).toFixed(0) - 0;
    }


    /**
     * Method: _brushHover
     *
     */
    _brushHover(shape) {
        var ctx = this._layers.hover.ctx;

        if (!shape.onbrush // æ²¡æonbrush
            // æonbrushå¹¶ä¸è°ç¨æ§è¡è¿åfalseæundefinedåç»§ç»­ç²å·
            || (shape.onbrush && !shape.onbrush(ctx, true))
        ) {
            var layer = this.getLayer(shape.zlevel);
            if (layer.needTransform) {
                ctx.save();
                layer.setTransform(ctx);
            }
            // Retina ä¼å
            if (Config.catchBrushException) {
                try {
                    shape.brush(ctx, true, this.updatePainter);
                } catch (error) {
                    SUtil_SUtil.Util_log(
                        error, 'hoverBrush error of ' + shape.type, shape
                    );
                }
            } else {
                shape.brush(ctx, true, this.updatePainter);
            }
            if (layer.needTransform) {
                ctx.restore();
            }
        }

    }


    /**
     * Method: _shapeToImage
     *
     */
    _shapeToImage(id, shape, width, height, devicePixelRatio) {
        var canvas = document.createElement('canvas');
        var ctx = canvas.getContext('2d');
        var _devicePixelRatio = devicePixelRatio || window.devicePixelRatio || 1;

        canvas.style.width = width + 'px';
        canvas.style.height = height + 'px';
        canvas.setAttribute('width', width * _devicePixelRatio);
        canvas.setAttribute('height', height * _devicePixelRatio);

        ctx.clearRect(0, 0, width * _devicePixelRatio, height * _devicePixelRatio);

        var shapeTransform = {
            position: shape.position,
            rotation: shape.rotation,
            scale: shape.scale
        };
        shape.position = [0, 0, 0];
        shape.rotation = 0;
        shape.scale = [1, 1];
        if (shape) {
            shape.brush(ctx, false);
        }

        var imgShape = new SmicImage({
            id: id,
            style: {
                x: 0,
                y: 0,
                image: canvas
            }
        });

        if (shapeTransform.position != null) {
            imgShape.position = shape.position = shapeTransform.position;
        }

        if (shapeTransform.rotation != null) {
            imgShape.rotation = shape.rotation = shapeTransform.rotation;
        }

        if (shapeTransform.scale != null) {
            imgShape.scale = shape.scale = shapeTransform.scale;
        }

        return imgShape;
    }


    /**
     * Method: _createShapeToImageProcessor
     *
     */
    _createShapeToImageProcessor() {
        var me = this;

        return function (id, e, width, height) {
            return me._shapeToImage(
                id, e, width, height, Painter.devicePixelRatio
            );
        };
    }


    // SMIC-æ¹æ³æ©å± - start
    /**
     * @function LevelRenderer.Painter.prototype.updateHoverLayer
     * @description æ´æ°è®¾ç½®æ¾ç¤ºé«äº®å¾å±ã
     * @param {Array} shapes - å¾å½¢æ°ç»ã
     */
    updateHoverLayer(shapes) {
        if (!(shapes instanceof Array)) {
            return this;
        }

        //æ¸é¤é«äº®
        this.clearHover();
        this.storage.delHover();

        for (var i = 0; i < shapes.length; i++) {
            this.storage.addHover(shapes[i]);
            this._brushHover(shapes[i]);
        }
    }


    /**
     * @function LevelRenderer.Painter.prototype.createDom
     * @description åå»º Domã
     *
     * @param {string} id - Dom id
     * @param {string} type - Dom type
     * @param {LevelRenderer.Painter} painter - Painter å®ä¾ã
     * @return {Object} Dom
     */
    static createDom(id, type, painter) {
        var newDom = document.createElement(type);
        var width = painter._width;
        var height = painter._height;

        // æ²¡appendå¢ï¼è¯·åè°æè¿æ ·åï¼æ¸æ°~
        newDom.style.position = 'absolute';
        newDom.style.left = 0;
        newDom.style.top = 0;
        newDom.style.width = width + 'px';
        newDom.style.height = height + 'px';
        newDom.setAttribute('width', width * Painter.devicePixelRatio);
        newDom.setAttribute('height', height * Painter.devicePixelRatio);

        // idä¸ä½ä¸ºç´¢å¼ç¨ï¼é¿åå¯è½é æçéåï¼å®ä¹ä¸ºç§æå±æ§
        //newDom.setAttribute('data-zr-dom-id', id);
        newDom.setAttribute('id', id);
        return newDom;
    }
}

/**
 * @private
 * @class Painter.Layer
 * @classdesc ç»å¶å±ç±»ã
 * @extends LevelRenderer.Transformable
 */
class PaintLayer extends Transformable {

    /**
     * @function Painter.Layer.constructor
     * @description æé å½æ°ã
     *
     * @param {string} id - idã
     * @param {LevelRenderer.Painter} painter - Painter å®ä¾ã
     *
     */
    constructor(id, painter) {
        super(id, painter);
        /**
         * @member {Object} Painter.Layer.prototype.dom
         * @description  domã
         */
        this.dom = null;

        /**
         * @member {Object} Painter.Layer.prototype.domBack
         * @description domBackã
         */
        this.domBack = null;

        /**
         * @member {Object} Painter.Layer.prototype.ctxBack
         * @description ctxBackã
         */
        this.ctxBack = null;

        /**
         * @member {LevelRenderer.Painter} Painter.Layer.prototype.painter
         * @description painterã
         */
        this.painter = painter;

        /**
         * @member {number} Painter.Layer.prototype.unusedCount
         * @description unusedCountã
         */
        this.unusedCount = 0;

        /**
         * @member {Object} Painter.Layer.prototype.config
         * @description  configã
         */
        this.config = null;

        /**
         * @member {boolean} Painter.Layer.prototype.dirty
         * @description dirtyã
         */
        this.dirty = true;

        /**
         * @member {number} Painter.Layer.prototype.elCount
         * @description elCountã
         */
        this.elCount = 0;

        // Configs
        /**
         * @member {string} Painter.Layer.prototype.clearColor
         * @description æ¯æ¬¡æ¸ç©ºç»å¸çé¢è²ãé»è®¤å¼ï¼0ï¼
         */
        this.clearColor = 0;

        /**
         * @member {boolean} Painter.Layer.prototype.motionBlur
         * @description æ¯å¦å¼å¯å¨ææ¨¡ç³ãé»è®¤å¼ï¼falseï¼
         */
        this.motionBlur = false;

        /**
         * @member {number} Painter.Layer.prototype.lastFrameAlpha
         * @description å¨å¼å¯å¨ææ¨¡ç³çæ¶åä½¿ç¨ï¼ä¸ä¸ä¸å¸§æ··åçalphaå¼ï¼å¼è¶å¤§å°¾è¿¹è¶ææ¾
         */
        this.lastFrameAlpha = 0.7;

        /**
         * @member {boolean} Painter.Layer.prototype.zoomable
         * @description å±æ¯å¦æ¯æé¼ æ å¹³ç§»æä½ãé»è®¤å¼ï¼falseï¼
         */
        this.zoomable = false;

        /**
         * @member {boolean} Painter.Layer.prototype.panable
         * @description å±æ¯å¦æ¯æé¼ æ ç¼©æ¾æä½ãé»è®¤å¼ï¼falseï¼
         */
        this.panable = false;

        /**
         * @member {number} Painter.Layer.prototype.maxZoom
         * @description maxZoomãé»è®¤å¼ï¼Infinityã
         */
        this.maxZoom = Infinity;

        /**
         * @member {number} Painter.Layer.prototype.minZoom
         * @description minZoomãé»è®¤å¼ï¼0ã
         */
        this.minZoom = 0;

        /**
         * @member {number} Painter.Layer.prototype.ctx
         * @description Canvas ä¸ä¸æã
         */
        this.ctx = null;
        this.dom = Painter.createDom(Util.createUniqueID("SuperMap.Theme" + id), 'canvas', painter);
        this.dom.onselectstart = returnFalse; // é¿åé¡µé¢éä¸­çå°´å°¬
        this.dom.style['-webkit-user-select'] = 'none';
        this.dom.style['user-select'] = 'none';
        this.dom.style['-webkit-touch-callout'] = 'none';
        // Function
        // è¿åfalseçæ¹æ³ï¼ç¨äºé¿åé¡µé¢è¢«éä¸­
        function returnFalse() {
            return false;
        }
        this.CLASS_NAME = "SuperMap.LevelRenderer.Painter.Layer";
    }

    /**
     * @function Painter.Layer.prototype.destroy
     * @description éæ¯å¯¹è±¡ï¼éæ¾èµæºãè°ç¨æ­¤å½æ°åææå±æ§å°è¢«ç½®ä¸º nullã
     */
    destroy() {
        this.dom = null;
        this.domBack = null;
        this.ctxBack = null;
        this.painter = null;
        this.unusedCount = null;
        this.config = null;
        this.dirty = null;
        this.elCount = null;
        this.clearColor = null;
        this.motionBlur = null;
        this.lastFrameAlpha = null;
        this.zoomable = null;
        this.panable = null;
        this.maxZoom = null;
        this.minZoom = null;
        this.ctx = null;

        Transformable.destroy.apply(this, arguments);
    }

    /**
     * @function Painter.Layer.prototype.initContext
     * @description åå§å Canvan 2D ä¸ä¸æã
     */
    initContext() {
        this.ctx = this.dom.getContext('2d');
        if (Painter.devicePixelRatio != 1) {
            this.ctx.scale(Painter.devicePixelRatio, Painter.devicePixelRatio);
        }
    }

    /**
     * @function Painter.Layer.prototype.createBackBuffer
     * @description  åå»ºå¤ä»½ç¼å²ã
     */
    createBackBuffer() {
        this.domBack = Painter.createDom(Util.createUniqueID("SuperMap.Theme.back-" + this.id), 'canvas', this.painter);
        this.ctxBack = this.domBack.getContext('2d');

        if (Painter.devicePixelRatio != 1) {
            this.ctxBack.scale(Painter.devicePixelRatio, Painter.devicePixelRatio);
        }
    }

    /**
     * @function Painter.Layer.prototype.resize
     * @description æ¹åå¤§å°ã
     *
     * @param {number} width - å®½ã
     * @param {number} height - é«ã
     */
    resize(width, height) {
        this.dom.style.width = width + 'px';
        this.dom.style.height = height + 'px';

        this.dom.setAttribute('width', width * Painter.devicePixelRatio);
        this.dom.setAttribute('height', height * Painter.devicePixelRatio);

        if (Painter.devicePixelRatio != 1) {
            this.ctx.scale(Painter.devicePixelRatio, Painter.devicePixelRatio);
        }

        if (this.domBack) {
            this.domBack.setAttribute('width', width * Painter.devicePixelRatio);
            this.domBack.setAttribute('height', height * Painter.devicePixelRatio);

            if (Painter.devicePixelRatio != 1) {
                this.ctxBack.scale(Painter.devicePixelRatio, Painter.devicePixelRatio);
            }
        }
    }

    /**
     * @function Painter.Layer.prototype.clear
     * @description æ¸ç©ºè¯¥å±ç»å¸ã
     */
    clear() {
        var dom = this.dom;
        var ctx = this.ctx;
        var width = dom.width;
        var height = dom.height;

        var haveClearColor = this.clearColor;
        var haveMotionBLur = this.motionBlur;
        var lastFrameAlpha = this.lastFrameAlpha;

        if (haveMotionBLur) {
            if (!this.domBack) {
                this.createBackBuffer();
            }

            this.ctxBack.globalCompositeOperation = 'copy';
            this.ctxBack.drawImage(
                dom, 0, 0,
                width / Painter.devicePixelRatio,
                height / Painter.devicePixelRatio
            );
        }

        if (haveClearColor) {
            ctx.save();
            ctx.fillStyle = this.config.clearColor;
            ctx.fillRect(
                0, 0,
                width / Painter.devicePixelRatio,
                height / Painter.devicePixelRatio
            );
            ctx.restore();
        } else {
            ctx.clearRect(
                0, 0,
                width / Painter.devicePixelRatio,
                height / Painter.devicePixelRatio
            );
        }

        if (haveMotionBLur) {
            var domBack = this.domBack;
            ctx.save();
            ctx.globalAlpha = lastFrameAlpha;
            ctx.drawImage(
                domBack, 0, 0,
                width / Painter.devicePixelRatio,
                height / Painter.devicePixelRatio
            );
            ctx.restore();
        }
    }

}

;// CONCATENATED MODULE: ./src/common/overlay/levelRenderer/Handler.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @private
 * @class  LevelRenderer.Handler
 * @category Visualization Theme
 * @classdesc Handleræ§å¶æ¨¡åã
 * @extends {LevelRenderer.Eventful}
 * @param {HTMLElement} root - ç»å¾åºåã
 * @param {LevelRenderer.Storage} storage - Storage å®ä¾ã
 * @param {LevelRenderer.Painter} painter - Painter å®ä¾ã
 */
class Handler extends Eventful {
    constructor(root, storage, painter) {
        super(root, storage, painter);
        /**
         * @member {HTMLElement} LevelRenderer.Handler.prototype.root
         * @description ç»å¾åºå
         */
        this.root = root;
        /**
         * @member {LevelRenderer.Storage} LevelRenderer.Handler.prototype.storage
         * @description Storage å®ä¾
         */
        this.storage = storage;
        /**
         * @member {LevelRenderer.Painter} LevelRenderer.Handler.prototype.Painter
         * @description Painter å®ä¾
         */
        this.painter = painter;
        /**
         * @member {number} [LevelRenderer.Handler.prototype._lastX=0]
         * @description ä¸ä¸æ¬¡é¼ æ ä½ç½®xåæ å¼
         */
        this._lastX = 0;
        /**
         * @member {number} [LevelRenderer.Handler.prototype._lastY=0]
         * @description ä¸ä¸æ¬¡é¼ æ ä½ç½®yåæ å¼
         */
        this._lastY = 0;
        /**
         * @member {number} [LevelRenderer.Handler.prototype._mouseX=0]
         * @description å½åé¼ æ ä½ç½®xåæ å¼
         */
        this._mouseX = 0;
        /**
         * @member {number} [LevelRenderer.Handler.prototype._mouseY=0]
         * @description å½åé¼ æ ä½ç½®yåæ å¼
         */
        this._mouseY = 0;
        /**
         * @member {function} LevelRenderer.Handler.prototype._findHover
         * @description æ¥æ¾ Hover å¾å½¢
         */
        this._findHover = null;
        /**
         * @member {Object} LevelRenderer.Handler.prototype._domHover
         * @description é«äº® DOM
         */
        this._domHover = null;

        // åç§äºä»¶æ è¯çç§æåé
        // this._hasfound = false;              // æ¯å¦æ¾å° hover å¾å½¢åç´ 
        // this._lastHover = null;              // æåä¸ä¸ª hover å¾å½¢åç´ 
        // this._mouseDownTarget = null;
        // this._draggingTarget = null;         // å½åè¢«ææ½çå¾å½¢åç´ 
        // this._isMouseDown = false;
        // this._isDragging = false;
        // this._lastMouseDownMoment;
        // this._lastTouchMoment;
        // this._lastDownButton;

        this._findHover = bind3Arg(findHover, this);
        this._domHover = painter.getDomHover();

        this.CLASS_NAME = "SuperMap.LevelRenderer.Handler";
        var domHandlers = {
            /**
             * Method: resize
             * çªå£å¤§å°æ¹åååºå½æ°ã
             *
             * Parameters:
             * event - {Event} eventã
             *
             */
            resize: function (event) {
                event = event || window.event;
                this._lastHover = null;
                this._isMouseDown = 0;

                // ååSuperMap.LevelRenderer.Config.EVENT.RESIZEäºä»¶ï¼global
                this.dispatch(Config.EVENT.RESIZE, event);
            },

            /**
             * Method: click
             * ç¹å»ååºå½æ°ã
             *
             * Parameters:
             * event - {Event} eventã
             *
             */
            click: function (event) {
                event = this._zrenderEventFixed(event);

                // ååSuperMap.LevelRenderer.Config.EVENT.CLICKäºä»¶
                var _lastHover = this._lastHover;
                if ((_lastHover && _lastHover.clickable)
                    || !_lastHover
                ) {

                    // å¤æ­æ²¡æåçææ½æè§¦åclickäºä»¶
                    if (this._clickThreshold < 10) {
                        this._dispatchAgency(_lastHover, Config.EVENT.CLICK, event);
                    }
                }

                this._mousemoveHandler(event);
            },

            /**
             * Method: dblclick
             * åå»ååºå½æ°ã
             *
             * Parameters:
             * event - {Event} eventã
             *
             */
            dblclick: function (event) {
                event = event || window.event;
                event = this._zrenderEventFixed(event);

                // ååSuperMap.LevelRenderer.Config.EVENT.DBLCLICKäºä»¶
                var _lastHover = this._lastHover;
                if ((_lastHover && _lastHover.clickable)
                    || !_lastHover
                ) {

                    // å¤æ­æ²¡æåçææ½æè§¦ådblclickäºä»¶
                    if (this._clickThreshold < 5) {
                        this._dispatchAgency(_lastHover, Config.EVENT.DBLCLICK, event);
                    }
                }

                this._mousemoveHandler(event);
            },

            /**
             * Method: mousewheel
             * é¼ æ æ»è½®ååºå½æ°ã
             *
             * Parameters:
             * event - {Event} eventã
             *
             */
            mousewheel: function (event) {
                event = this._zrenderEventFixed(event);

                // http://www.sitepoint.com/html5-javascript-mouse-wheel/
                // https://developer.mozilla.org/en-US/docs/DOM/DOM_event_reference/mousewheel
                var delta = event.wheelDelta // Webkit
                    || -event.detail; // Firefox
                var scale = delta > 0 ? 1.1 : 1 / 1.1;

                var layers = this.painter.getLayers();

                var needsRefresh = false;
                for (var z in layers) {
                    if (z !== 'hover') {
                        var layer = layers[z];
                        var pos = layer.position;
                        if (layer.zoomable) {
                            layer.__zoom = layer.__zoom || 1;
                            var newZoom = layer.__zoom;
                            newZoom *= scale;
                            newZoom = Math.max(
                                Math.min(layer.maxZoom, newZoom),
                                layer.minZoom
                            );
                            scale = newZoom / layer.__zoom;
                            layer.__zoom = newZoom;
                            // Keep the mouse center when scaling
                            pos[0] -= (this._mouseX - pos[0]) * (scale - 1);
                            pos[1] -= (this._mouseY - pos[1]) * (scale - 1);
                            layer.scale[0] *= scale;
                            layer.scale[1] *= scale;
                            layer.dirty = true;
                            needsRefresh = true;
                        }
                    }
                }
                if (needsRefresh) {
                    this.painter.refresh();
                }

                // ååSuperMap.LevelRenderer.Config.EVENT.MOUSEWHEELäºä»¶
                this._dispatchAgency(this._lastHover, Config.EVENT.MOUSEWHEEL, event);
                this._mousemoveHandler(event);
            },

            /**
             * Method: mousemove
             * é¼ æ ï¼ææï¼ç§»å¨ååºå½æ°ã
             *
             * Parameters:
             * event - {Event} eventã
             *
             */
            mousemove: function (event) {
                // ææ½ä¸è§¦åclickäºä»¶
                this._clickThreshold++;

                event = this._zrenderEventFixed(event);
                this._lastX = this._mouseX;
                this._lastY = this._mouseY;
                this._mouseX = SUtil_SUtil.Util_event.getX(event);
                this._mouseY = SUtil_SUtil.Util_event.getY(event);
                var dx = this._mouseX - this._lastX;
                var dy = this._mouseY - this._lastY;

                // å¯è½åºç°SuperMap.LevelRenderer.Config.EVENT.DRAGSTARTäºä»¶
                // é¿åææç¹å»è¯¯è®¤ä¸ºææ½
                // if (this._mouseX - this._lastX > 1 || this._mouseY - this._lastY > 1) {
                this._processDragStart(event);
                // }
                this._hasfound = 0;
                this._event = event;

                this._iterateAndFindHover();

                // æ¾å°çå¨è¿­ä»£å½æ°éåäºå¤çï¼æ²¡æ¾å°å¾å¨è¿­ä»£å®åå¤ç
                if (!this._hasfound) {
                    // è¿æ»¤é¦æ¬¡ææ½äº§ççmouseoutådragLeave
                    if (!this._draggingTarget
                        || (this._lastHover && this._lastHover != this._draggingTarget)
                    ) {
                        // å¯è½åºç°SuperMap.LevelRenderer.Config.EVENT.MOUSEOUTäºä»¶
                        this._processOutShape(event);

                        // å¯è½åºç°SuperMap.LevelRenderer.Config.EVENT.DRAGLEAVEäºä»¶
                        this._processDragLeave(event);
                    }

                    this._lastHover = null;
                    this.storage.delHover();
                    this.painter.clearHover();
                }

                // set cursor for root element
                var cursor = '';

                // å¦æå­å¨ææ½ä¸­åç´ ï¼è¢«ææ½çå¾å½¢åç´ æåaddHover
                if (this._draggingTarget) {
                    this.storage.drift(this._draggingTarget.id, dx, dy);
                    this._draggingTarget.modSelf();
                    this.storage.addHover(this._draggingTarget);
                } else if (this._isMouseDown) {
                    // Layer dragging
                    var layers = this.painter.getLayers();

                    var needsRefresh = false;
                    for (var z in layers) {
                        if (z !== 'hover') {
                            var layer = layers[z];
                            if (layer.panable) {
                                // PENDING
                                cursor = 'move';
                                // Keep the mouse center when scaling
                                layer.position[0] += dx;
                                layer.position[1] += dy;
                                needsRefresh = true;
                                layer.dirty = true;
                            }
                        }
                    }
                    if (needsRefresh) {
                        this.painter.refresh();
                    }
                }

                if (this._draggingTarget || (this._hasfound && this._lastHover.draggable)) {
                    cursor = 'move';
                } else if (this._hasfound && this._lastHover.clickable) {
                    cursor = 'pointer';
                }
                this.root.style.cursor = cursor;

                // ååSuperMap.LevelRenderer.Config.EVENT.MOUSEMOVEäºä»¶
                this._dispatchAgency(this._lastHover, Config.EVENT.MOUSEMOVE, event);

                if (this._draggingTarget || this._hasfound || this.storage.hasHoverShape()) {
                    this.painter.refreshHover();
                }
            },

            /**
             * Method: mouseout
             * é¼ æ ï¼ææï¼ç¦»å¼ååºå½æ°ã
             *
             * Parameters:
             * event - {Event} eventã
             *
             */
            mouseout: function (event) {
                event = this._zrenderEventFixed(event);

                var element = event.toElement || event.relatedTarget;
                if (element != this.root) {
                    while (element && element.nodeType != 9) {
                        // å¿½ç¥åå«å¨rootä¸­çdomå¼èµ·çmouseOut
                        if (element == this.root) {
                            this._mousemoveHandler(event);
                            return;
                        }

                        element = element.parentNode;
                    }
                }

                event.zrenderX = this._lastX;
                event.zrenderY = this._lastY;
                this.root.style.cursor = '';
                this._isMouseDown = 0;

                this._processOutShape(event);
                this._processDrop(event);
                this._processDragEnd(event);

                this.painter.refreshHover();

                this.dispatch(Config.EVENT.GLOBALOUT, event);
            },

            /**
             * Method: mousedown
             * é¼ æ ï¼ææï¼æä¸ååºå½æ°ã
             *
             * Parameters:
             * event - {Event} eventã
             *
             */
            mousedown: function (event) {
                // éç½® clickThreshold
                this._clickThreshold = 0;

                if (this._lastDownButton == 2) {
                    this._lastDownButton = event.button;
                    this._mouseDownTarget = null;
                    // ä»ä½ä¸ºå³é­å³é®èåä½¿ç¨
                    return;
                }

                this._lastMouseDownMoment = new Date();
                event = this._zrenderEventFixed(event);
                this._isMouseDown = 1;

                // ååSuperMap.LevelRenderer.Config.EVENT.MOUSEDOWNäºä»¶
                this._mouseDownTarget = this._lastHover;
                this._dispatchAgency(this._lastHover, Config.EVENT.MOUSEDOWN, event);
                this._lastDownButton = event.button;
            },

            /**
             * Method: mouseup
             * é¼ æ ï¼ææï¼æ¬èµ·ååºå½æ°ã
             *
             * Parameters:
             * event - {Event} eventã
             *
             */
            mouseup: function (event) {
                event = this._zrenderEventFixed(event);
                this.root.style.cursor = '';
                this._isMouseDown = 0;
                this._mouseDownTarget = null;

                // ååSuperMap.LevelRenderer.Config.EVENT.MOUSEUPäºä»¶
                this._dispatchAgency(this._lastHover, Config.EVENT.MOUSEUP, event);
                this._processDrop(event);
                this._processDragEnd(event);
            },

            /**
             * Method: touchstart
             * Touch å¼å§ååºå½æ°ã
             *
             * Parameters:
             * event - {Event} eventã
             *
             */
            touchstart: function (event) {
                // SUtil.Util_event.stop(event);// é»æ­¢æµè§å¨é»è®¤äºä»¶ï¼éè¦
                event = this._zrenderEventFixed(event, true);
                this._lastTouchMoment = new Date();

                // å¹³æ¿è¡¥åä¸æ¬¡findHover
                this._mobildFindFixed(event);
                this._mousedownHandler(event);
            },

            /**
             * Method: touchmove
             * Touch ç§»å¨ååºå½æ°ã
             *
             * Parameters:
             * event - {Event} eventã
             *
             */
            touchmove: function (event) {
                event = this._zrenderEventFixed(event, true);
                this._mousemoveHandler(event);
                if (this._isDragging) {
                    SUtil_SUtil.Util_event.stop(event);// é»æ­¢æµè§å¨é»è®¤äºä»¶ï¼éè¦
                }
            },

            /**
             * Method: touchend
             * Touch ç»æååºå½æ°ã
             *
             * Parameters:
             * event - {Event} eventã
             *
             */
            touchend: function (event) {
                // SUtil.Util_event.stop(event);// é»æ­¢æµè§å¨é»è®¤äºä»¶ï¼éè¦
                event = this._zrenderEventFixed(event, true);
                this._mouseupHandler(event);

                var now = new Date();
                if (now - this._lastTouchMoment < Config.EVENT.touchClickDelay) {
                    this._mobildFindFixed(event);
                    this._clickHandler(event);
                    if (now - this._lastClickMoment < Config.EVENT.touchClickDelay / 2) {
                        this._dblclickHandler(event);
                        if (this._lastHover && this._lastHover.clickable) {
                            SUtil_SUtil.Util_event.stop(event);// é»æ­¢æµè§å¨é»è®¤äºä»¶ï¼éè¦
                        }
                    }
                    this._lastClickMoment = now;
                }
                this.painter.clearHover();
            }
        };

        initDomHandler(this);

        // åå§åï¼äºä»¶ç»å®ï¼æ¯æçææäºä»¶é½ç±å¦ä¸åçäºä»¶è®¡ç®å¾æ¥
        if (window.addEventListener) {
            window.addEventListener('resize', this._resizeHandler);

            if (SUtil_SUtil.Util_env.os.tablet || SUtil_SUtil.Util_env.os.phone) {
                // mobileæ¯æ
                root.addEventListener('touchstart', this._touchstartHandler);
                root.addEventListener('touchmove', this._touchmoveHandler);
                root.addEventListener('touchend', this._touchendHandler);
            } else {
                // mobileçclick/move/up/downèªå·±æ¨¡æ
                root.addEventListener('click', this._clickHandler);
                root.addEventListener('dblclick', this._dblclickHandler);
                root.addEventListener('mousewheel', this._mousewheelHandler);
                root.addEventListener('mousemove', this._mousemoveHandler);
                root.addEventListener('mousedown', this._mousedownHandler);
                root.addEventListener('mouseup', this._mouseupHandler);
            }
            root.addEventListener('DOMMouseScroll', this._mousewheelHandler);
            root.addEventListener('mouseout', this._mouseoutHandler);
        } else {
            window.attachEvent('onresize', this._resizeHandler);

            root.attachEvent('onclick', this._clickHandler);
            //root.attachEvent('ondblclick ', this._dblclickHandler);
            root.ondblclick = this._dblclickHandler;
            root.attachEvent('onmousewheel', this._mousewheelHandler);
            root.attachEvent('onmousemove', this._mousemoveHandler);
            root.attachEvent('onmouseout', this._mouseoutHandler);
            root.attachEvent('onmousedown', this._mousedownHandler);
            root.attachEvent('onmouseup', this._mouseupHandler);
        }

        // è¾å©å½æ° start
        /**
         * Method: bind1Arg
         * bind ä¸ä¸ªåæ°ç functionã
         *
         * Parameters:
         * handler - {function} è¦ bind ç functionã
         * context - {Object} è¿è¡æ¶ this ç¯å¢ã
         *
         * Returns:
         * {function}
         */
        function bind1Arg(handler, context) {
            return function (e) {
                return handler.call(context, e);
            };
        }

        /*
         // bind ä¸¤ä¸ªåæ°ç function
         function bind2Arg(handler, context) {
         return function (arg1, arg2) {
         return handler.call(context, arg1, arg2);
         };
         }
         */

        // bind ä¸ä¸ªåæ°ç function
        function bind3Arg(handler, context) {
            return function (arg1, arg2, arg3) {
                return handler.call(context, arg1, arg2, arg3);
            };
        }

        /**
         * Method: initDomHandler
         * ä¸ºæ§å¶ç±»å®ä¾åå§å dom äºä»¶å¤çå½æ°ã
         *
         * Parameters:
         * instance - {<LevelRenderer.Handler>} æ§å¶ç±»å®ä¾ ã
         *
         * Returns:
         * {function}
         */
        function initDomHandler(instance) {
            var domHandlerNames = [
                'resize', 'click', 'dblclick',
                'mousewheel', 'mousemove', 'mouseout', 'mouseup', 'mousedown',
                'touchstart', 'touchend', 'touchmove'
            ];

            var len = domHandlerNames.length;
            while (len--) {
                var name = domHandlerNames[len];
                instance['_' + name + 'Handler'] = bind1Arg(domHandlers[name], instance);
            }
        }

        /**
         * Method: findHover
         * è¿­ä»£å½æ°ï¼æ¥æ¾ hover å°çå¾å½¢åç´ å¹¶å³æ¶åäºäºä»¶ååã
         *
         * Parameters:
         * shape - {Object} å¾å½¢ã
         * x - {number} é¼ æ  xã
         * y - {number} é¼ æ  yã
         *
         * Returns:
         * {boolean} æ¯å¦æ¾å°å¾å½¢ã
         *
         */
        function findHover(shape, x, y) {
            var me = this;
            if (
                (me._draggingTarget && me._draggingTarget.id == shape.id) // è¿­ä»£å°å½åææ½çå¾å½¢ä¸
                || shape.isSilent() // æé±æ²¹çè·¯è¿ï¼å¥é½ä¸ååºçshape~
            ) {
                return false;
            }

            var event = me._event;
            if (shape.isCover(x, y)) {
                if (shape.hoverable) {
                    // SMIC-ä¿®æ¹ - start
                    if (shape.isHoverByRefDataID && shape.isHoverByRefDataID === true) {
                        if (shape.refDataID) {
                            var fid = shape.refDataID;
                            //me.painter.clearHover();
                            //me.storage.delHover();

                            var hoverGroup = null;
                            if (shape.refDataHoverGroup) {
                                hoverGroup = shape.refDataHoverGroup;
                            }

                            //æ¥æ¾åä¸ä¸ªç¨æ·æ°æ® feature çææå¾å½¢
                            var shapeList = me.storage._shapeList;
                            for (var i = 0, len = shapeList.length; i < len; i++) {
                                var si = shapeList[i];
                                if (si.refDataID && fid === si.refDataID) {
                                    if (hoverGroup) {
                                        if (si.refDataHoverGroup && hoverGroup === si.refDataHoverGroup) {
                                            me.storage.addHover(si);
                                        }
                                    } else {
                                        me.storage.addHover(si);
                                    }
                                }
                            }
                        }
                    } else {
                        me.storage.addHover(shape);
                    }
                    //åå§ä»£ç ï¼
                    //  me.storage.addHover(shape);
                    // SMIC-ä¿®æ¹ - end
                }
                // æ¥æ¾æ¯å¦å¨ clipShape ä¸­
                var p = shape.parent;
                while (p) {
                    if (p.clipShape && !p.clipShape.isCover(me._mouseX, me._mouseY)) {
                        // å·²ç»è¢«ç¥å clip æäº
                        return false;
                    }
                    p = p.parent;
                }

                if (me._lastHover != shape) {
                    me._processOutShape(event);

                    // å¯è½åºç°SuperMap.LevelRenderer.Config.EVENT.DRAGLEAVEäºä»¶
                    me._processDragLeave(event);

                    me._lastHover = shape;

                    // å¯è½åºç°SuperMap.LevelRenderer.Config.EVENT.DRAGENTERäºä»¶
                    me._processDragEnter(event);
                }

                me._processOverShape(event);

                // å¯è½åºç°SuperMap.LevelRenderer.Config.EVENT.DRAGOVER
                me._processDragOver(event);

                me._hasfound = 1;

                return true;    // æ¾å°åä¸­æ­è¿­ä»£æ¥æ¾
            }

            return false;
        }

        // è¾å©å½æ° end
    }

    /**
     * @function LevelRenderer.Handler.prototype.destroy
     * @description éæ¯å¯¹è±¡ï¼éæ¾èµæºãè°ç¨æ­¤å½æ°åææå±æ§å°è¢«ç½®ä¸ºnullã
     */
    destroy() {
        this.dispose();
        this._lastX = null;
        this._lastY = null;
        this._mouseX = null;
        this._mouseY = null;
        this._findHover = null;

        Eventful.prototype.destroy.apply(this, arguments);
    }


    /**
     * @function LevelRenderer.Handler.prototype.on
     * @description èªå®ä¹äºä»¶ç»å®ã
     * @param {string} eventName - äºä»¶åç§°ï¼resizeãhoverãdragç­ã
     * @param {function} handler - ååºå½æ°ã
     * @returns {LevelRenderer.Handler} thisã
     */
    on(eventName, handler) {
        this.bind(eventName, handler);
        return this;
    }

    /**
     * @function LevelRenderer.Handler.prototype.un
     * @description èªå®ä¹äºä»¶è§£é¤ç»å®ã
     * @param {string} eventName - äºä»¶åç§°ï¼resizeãhoverãdragç­ã
     * @param {function} handler - ååºå½æ°ã
     * @returns {LevelRenderer.Handler} thisã
     */
    un(eventName, handler) {
        this.unbind(eventName, handler);
        return this;
    }

    /**
     * @function LevelRenderer.Handler.prototype.trigger
     * @description äºä»¶è§¦åã
     * @param {string} eventName - äºä»¶åç§°ï¼resizeãhoverãdragç­ã
     * @param {event} eventArgs - domäºä»¶å¯¹è±¡ã
     */
    trigger(eventName, eventArgs) {
        var EVENT = Config.EVENT;
        switch (eventName) {
            case EVENT.RESIZE:
            case EVENT.CLICK:
            case EVENT.DBLCLICK:
            case EVENT.MOUSEWHEEL:
            case EVENT.MOUSEMOVE:
            case EVENT.MOUSEDOWN:
            case EVENT.MOUSEUP:
            case EVENT.MOUSEOUT:
                this['_' + eventName + 'Handler'](eventArgs);
                break;
        }
    }

    /**
     * @function LevelRenderer.Handler.prototype.dispose
     * @description éæ¾ï¼è§£ç»ææäºä»¶ã
     */
    dispose() {
        var root = this.root;

        if (window.removeEventListener) {
            window.removeEventListener('resize', this._resizeHandler);

            if (SUtil_SUtil.Util_env.os.tablet || SUtil_SUtil.Util_env.os.phone) {
                // mobileæ¯æ
                root.removeEventListener('touchstart', this._touchstartHandler);
                root.removeEventListener('touchmove', this._touchmoveHandler);
                root.removeEventListener('touchend', this._touchendHandler);
            } else {
                // mobileçclickèªå·±æ¨¡æ
                root.removeEventListener('click', this._clickHandler);
                root.removeEventListener('dblclick', this._dblclickHandler);
                root.removeEventListener('mousewheel', this._mousewheelHandler);
                root.removeEventListener('mousemove', this._mousemoveHandler);
                root.removeEventListener('mousedown', this._mousedownHandler);
                root.removeEventListener('mouseup', this._mouseupHandler);
            }
            root.removeEventListener('DOMMouseScroll', this._mousewheelHandler);
            root.removeEventListener('mouseout', this._mouseoutHandler);
        } else {
            window.detachEvent('onresize', this._resizeHandler);

            root.detachEvent('onclick', this._clickHandler);
            root.detachEvent('dblclick', this._dblclickHandler);
            root.detachEvent('onmousewheel', this._mousewheelHandler);
            root.detachEvent('onmousemove', this._mousemoveHandler);
            root.detachEvent('onmouseout', this._mouseoutHandler);
            root.detachEvent('onmousedown', this._mousedownHandler);
            root.detachEvent('onmouseup', this._mouseupHandler);
        }

        this.root = null;
        this._domHover = null;
        this.storage = null;
        this.painter = null;

        this.un();
    }


    /**
     * Method: _processDragStart
     * ææ½å¼å§ã
     *
     * Parameters:
     * event - {Object} äºä»¶å¯¹è±¡ã
     *
     */
    _processDragStart(event) {
        var _lastHover = this._lastHover;

        if (this._isMouseDown
            && _lastHover
            && _lastHover.draggable
            && !this._draggingTarget
            && this._mouseDownTarget == _lastHover
        ) {
            // ææ½ç¹å»çææ¶é¿éé¨ï¼æäºåºæ¯éè¦éä½ææ½ææåº¦
            if (_lastHover.dragEnableTime &&
                new Date() - this._lastMouseDownMoment < _lastHover.dragEnableTime
            ) {
                return;
            }

            var _draggingTarget = _lastHover;
            this._draggingTarget = _draggingTarget;
            this._isDragging = 1;

            _draggingTarget.invisible = true;
            this.storage.mod(_draggingTarget.id);

            // åå Config.EVENT.DRAGSTARTäºä»¶
            this._dispatchAgency(
                _draggingTarget,
                Config.EVENT.DRAGSTART,
                event
            );
            this.painter.refresh();
        }
    }


    /**
     * Method: _processDragEnter
     * ææ½è¿å¥ç®æ åç´ ã
     *
     * Parameters:
     * event - {Object} äºä»¶å¯¹è±¡ã
     *
     */
    _processDragEnter(event) {
        if (this._draggingTarget) {
            // ååSuperMap.LevelRenderer.Config.EVENT.DRAGENTERäºä»¶
            this._dispatchAgency(
                this._lastHover,
                Config.EVENT.DRAGENTER,
                event,
                this._draggingTarget
            );
        }
    }


    /**
     * Method: _processDragOver
     * ææ½å¨ç®æ åç´ ä¸ç§»å¨ã
     *
     * Parameters:
     * event - {Object} äºä»¶å¯¹è±¡ã
     *
     */
    _processDragOver(event) {
        if (this._draggingTarget) {
            // ååSuperMap.LevelRenderer.Config.EVENT.DRAGOVERäºä»¶
            this._dispatchAgency(
                this._lastHover,
                Config.EVENT.DRAGOVER,
                event,
                this._draggingTarget
            );
        }
    }


    /**
     * Method: _processDragLeave
     * ææ½ç¦»å¼ç®æ åç´ ã
     *
     * Parameters:
     * event - {Object} äºä»¶å¯¹è±¡ã
     *
     */
    _processDragLeave(event) {
        if (this._draggingTarget) {
            // ååSuperMap.LevelRenderer.Config.EVENT.DRAGLEAVEäºä»¶
            this._dispatchAgency(
                this._lastHover,
                Config.EVENT.DRAGLEAVE,
                event,
                this._draggingTarget
            );
        }
    }


    /**
     * Method: _processDrop
     * ææ½å¨ç®æ åç´ ä¸å®æã
     *
     * Parameters:
     * event - {Object} äºä»¶å¯¹è±¡ã
     *
     */
    _processDrop(event) {
        if (this._draggingTarget) {
            this._draggingTarget.invisible = false;
            this.storage.mod(this._draggingTarget.id);
            this.painter.refresh();

            // ååSuperMap.LevelRenderer.Config.EVENT.DROPäºä»¶
            this._dispatchAgency(
                this._lastHover,
                Config.EVENT.DROP,
                event,
                this._draggingTarget
            );
        }
    }


    /**
     * Method: _processDragEnd
     * ææ½ç»æã
     *
     * Parameters:
     * event - {Object} äºä»¶å¯¹è±¡ã
     *
     */
    _processDragEnd(event) {
        if (this._draggingTarget) {
            // ååSuperMap.LevelRenderer.Config.EVENT.DRAGENDäºä»¶
            this._dispatchAgency(
                this._draggingTarget,
                Config.EVENT.DRAGEND,
                event
            );

            this._lastHover = null;
        }

        this._isDragging = 0;
        this._draggingTarget = null;
    }


    /**
     * Method: _processOverShape
     * é¼ æ å¨æä¸ªå¾å½¢åç´ ä¸ç§»å¨ã
     *
     * Parameters:
     * event - {Object} äºä»¶å¯¹è±¡ã
     *
     */
    _processOverShape(event) {
        // ååSuperMap.LevelRenderer.Config.EVENT.MOUSEOVERäºä»¶
        this._dispatchAgency(this._lastHover, Config.EVENT.MOUSEOVER, event);
    }


    /**
     * Method: _processOutShape
     * é¼ æ ç¦»å¼æä¸ªå¾å½¢åç´ ã
     *
     * Parameters:
     * event - {Object} äºä»¶å¯¹è±¡ã
     *
     */
    _processOutShape(event) {
        // ååSuperMap.LevelRenderer.Config.EVENT.MOUSEOUTäºä»¶
        this._dispatchAgency(this._lastHover, Config.EVENT.MOUSEOUT, event);
    }


    /**
     * Method: _dispatchAgency
     * é¼ æ ç¦»å¼æä¸ªå¾å½¢åç´ ã
     *
     * Parameters:
     * targetShape - {Object} ç®æ å¾å½¢åç´ ã
     * eventName - {Object} äºä»¶åç§°ã
     * event - {Object} äºä»¶å¯¹è±¡ã
     * draggedShape - {Object} ææ½äºä»¶ç¹æï¼å½åè¢«ææ½å¾å½¢åç´ ã
     *
     */
    _dispatchAgency(targetShape, eventName, event, draggedShape) {
        var eventHandler = 'on' + eventName;
        var eventPacket = {
            type: eventName,
            event: event,
            target: targetShape,
            cancelBubble: false
        };

        var el = targetShape;

        if (draggedShape) {
            eventPacket.dragged = draggedShape;
        }

        while (el) {
            el[eventHandler]
            && (eventPacket.cancelBubble = el[eventHandler](eventPacket));
            el.dispatch(eventName, eventPacket);

            el = el.parent;

            if (eventPacket.cancelBubble) {
                break;
            }
        }

        if (targetShape) {
            // åæ³¡å°é¡¶çº§ zrender å¯¹è±¡
            if (!eventPacket.cancelBubble) {
                this.dispatch(eventName, eventPacket);
            }
        } else if (!draggedShape) {
            // æ hoverç®æ ï¼æ ææ½å¯¹è±¡ï¼åçäºä»¶åå
            this.dispatch(eventName, {
                type: eventName,
                event: event
            });
        }
    }


    /**
     * Method: _iterateAndFindHover
     * è¿­ä»£å¯»æ¾ hover shapeã
     *
     */
    _iterateAndFindHover() {
        var invTransform = SUtil_SUtil.Util_matrix.create();

        var list = this.storage.getShapeList();
        var currentZLevel;
        var currentLayer;
        var tmp = [0, 0];
        for (var i = list.length - 1; i >= 0; i--) {
            var shape = list[i];

            if (currentZLevel !== shape.zlevel) {
                currentLayer = this.painter.getLayer(shape.zlevel, currentLayer);
                tmp[0] = this._mouseX;
                tmp[1] = this._mouseY;

                if (currentLayer.needTransform) {
                    SUtil_SUtil.Util_matrix.invert(invTransform, currentLayer.transform);
                    SUtil_SUtil.Util_vector.applyTransform(tmp, tmp, invTransform);
                }
            }

            if (this._findHover(shape, tmp[0], tmp[1])) {
                break;
            }
        }
    }


    /**
     * Method: _mobildFindFixed
     * touch ææå°éè§ï¼ååå°è¯ï¼è®©touchä¸çç¹å»æ´å¥½è§¦åäºä»¶ã
     *
     * Parameters:
     * event - {Object} äºä»¶å¯¹è±¡ã
     *
     */
    _mobildFindFixed(event) {
        // touchæå°éè§çå°è¯åç§»ééç½®
        var MOBILE_TOUCH_OFFSETS = [
            {x: 10},
            {x: -20},
            {x: 10, y: 10},
            {y: -20}
        ];

        this._lastHover = null;
        this._mouseX = event.zrenderX;
        this._mouseY = event.zrenderY;

        this._event = event;

        this._iterateAndFindHover();

        for (var i = 0; !this._lastHover && i < MOBILE_TOUCH_OFFSETS.length; i++) {
            var offset = MOBILE_TOUCH_OFFSETS[i];
            offset.x && (this._mouseX += offset.x);
            offset.y && (this._mouseX += offset.y);

            this._iterateAndFindHover();
        }

        if (this._lastHover) {
            event.zrenderX = this._mouseX;
            event.zrenderY = this._mouseY;
        }
    }


    /**
     * Method: _zrenderEventFixed
     * å¦æå­å¨ç¬¬ä¸æ¹åµå¥çä¸äºdomè§¦åçäºä»¶ï¼ætouchäºä»¶ï¼éè¦è½¬æ¢ä¸ä¸äºä»¶åæ  ã
     *
     * Parameters:
     * event - {Object} äºä»¶ã
     * isTouch - {boolean} æ¯å¦è§¦æ¸ã
     *
     */
    _zrenderEventFixed(event, isTouch) {
        if (event.zrenderFixed) {
            return event;
        }

        if (!isTouch) {
            event = event || window.event;
            // è¿å¥å¯¹è±¡ä¼å~
            var target = event.toElement
                || event.relatedTarget
                || event.srcElement
                || event.target;

            if (target && target != this._domHover) {
                event.zrenderX = (typeof event.offsetX != 'undefined'
                    ? event.offsetX
                    : event.layerX)
                    + target.offsetLeft;
                event.zrenderY = (typeof event.offsetY != 'undefined'
                    ? event.offsetY
                    : event.layerY)
                    + target.offsetTop;
            }
        } else {
            var touch = event.type != 'touchend'
                ? event.targetTouches[0]
                : event.changedTouches[0];
            if (touch) {
                var rBounding = this.root.getBoundingClientRect();
                // touchäºä»¶åæ æ¯å¨å±ç~
                event.zrenderX = touch.clientX - rBounding.left;
                event.zrenderY = touch.clientY - rBounding.top;
            }
        }

        event.zrenderFixed = 1;
        return event;
    }


    // SMIC-æ¹æ³æ©å± - start

    /**
     * @function LevelRenderer.Handler.prototype.getLastHoverOne
     * @description è·ååä¸ªé«äº®å¾å½¢
     */
    getLastHoverOne() {
        if (this._lastHover) {
            return this._lastHover;
        }
        return null;
    }

    // SMIC-æ¹æ³æ©å± - end

}

;// CONCATENATED MODULE: ./src/common/overlay/levelRenderer/Easing.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
/**
 * @class  LevelRenderer.Animation.easing
 * @category Visualization Theme
 * @classdesc ç¼å¨
 * @private
 */
// ç¼å¨ä»£ç æ¥èª https://github.com/sole/tween.js/blob/master/src/Tween.js
// http://sole.github.io/tween.js/examples/03_graphs.html
class Easing {
    constructor() {
        this.CLASS_NAME = "SuperMap.LevelRenderer.Animation.easing";
    }


    /**
     * @function LevelRenderer.Animation.easing.destroy
     * @description éæ¯å¯¹è±¡ï¼éæ¾èµæºãè°ç¨æ­¤å½æ°åææå±æ§å°è¢«ç½®ä¸º nullã
     */
    destroy() {

    }


    /**
     * @function LevelRenderer.Animation.easing.Linear
     * @description çº¿æ§ç¼å¨
     * @param {number} k - åæ°
     * @return {number} è¾å¥å¼
     */
    Linear(k) {
        return k;
    }


    /**
     * @function LevelRenderer.Animation.easing.QuadraticIn
     * @description äºæ¬¡æ¹çç¼å¨ï¼t^2ï¼
     * @param {number} k - åæ°
     * @return {number} äºæ¬¡æ¹çç¼å¨çå¼
     */
    QuadraticIn(k) {
        return k * k;
    }

    /**
     * @function LevelRenderer.Animation.easing.QuadraticOut
     * @description è¿åæäºæ¬¡æ¹ç¼å¨éåºçå¼
     * @param {number} k - åæ°
     * @return {number} æäºæ¬¡æ¹ç¼å¨éåºçå¼
     */
    QuadraticOut(k) {
        return k * (2 - k);
    }

    /**
     * @function LevelRenderer.Animation.easing.QuadraticInOut
     * @description è¿åæäºæ¬¡æ¹ç¼å¨è¿å¥åéåºçå¼
     * @param {number} k - åæ°
     * @return {number} æäºæ¬¡æ¹ç¼å¨è¿å¥åéåºçå¼
     */
    QuadraticInOut(k) {
        if ((k *= 2) < 1) {
            return 0.5 * k * k;
        }
        return -0.5 * (--k * (k - 2) - 1);
    }


    /**
     * @function LevelRenderer.Animation.easing.CubicIn
     * @description ä¸æ¬¡æ¹çç¼å¨ï¼t^3ï¼
     * @param {number} k - åæ°
     * @return {number} æä¸æ¬¡æ¹ç¼å¨çå¼
     */
    CubicIn(k) {
        return k * k * k;
    }

    /**
     * @function LevelRenderer.Animation.easing.CubicOut
     * @description è¿åæä¸æ¬¡æ¹ç¼å¨éåºçå¼
     * @param {number} k - åæ°
     * @return {number} æä¸æ¬¡æ¹ç¼å¨éåºçå¼
     */
    CubicOut(k) {
        return --k * k * k + 1;
    }

    /**
     * @function LevelRenderer.Animation.easing.CubicInOut
     * @description è¿åæä¸æ¬¡æ¹ç¼å¨è¿å¥éåºçå¼
     * @param {number} k - åæ°
     * @return {number} æä¸æ¬¡æ¹ç¼å¨è¿å¥éåºçå¼
     */
    CubicInOut(k) {
        if ((k *= 2) < 1) {
            return 0.5 * k * k * k;
        }
        return 0.5 * ((k -= 2) * k * k + 2);
    }


    /**
     * @function LevelRenderer.Animation.easing.QuarticIn
     * @description  è¿åæåæ¬¡æ¹ç¼å¨è¿å¥çå¼
     * @param {number} k - åæ°
     * @return {number}  æåæ¬¡æ¹ç¼å¨è¿å¥çå¼
     */
    QuarticIn(k) {
        return k * k * k * k;
    }

    /**
     * @function LevelRenderer.Animation.easing.QuarticOut
     * @description  è¿åæåæ¬¡æ¹ç¼å¨éåºçå¼
     * @param {number} k - åæ°
     * @return {number}  æåæ¬¡æ¹ç¼å¨éåºçå¼
     */
    QuarticOut(k) {
        return 1 - (--k * k * k * k);
    }

    /**
     * @function LevelRenderer.Animation.easing.QuarticInOut
     * @description  è¿åæåæ¬¡æ¹ç¼å¨è¿å¥éåºçå¼
     * @param {number} k - åæ°
     * @return {number}  æåæ¬¡æ¹ç¼å¨è¿å¥éåºçå¼
     */
    QuarticInOut(k) {
        if ((k *= 2) < 1) {
            return 0.5 * k * k * k * k;
        }
        return -0.5 * ((k -= 2) * k * k * k - 2);
    }


    // äºæ¬¡æ¹çç¼å¨ï¼t^5ï¼
    /**
     * @function LevelRenderer.Animation.easing.QuinticIn
     * @description  è¿åæäºæ¬¡æ¹ç¼å¨çå¼
     * @param {number} k - åæ°
     * @return {number}  æäºæ¬¡æ¹ç¼å¨çå¼
     */
    QuinticIn(k) {
        return k * k * k * k * k;
    }

    /**
     * @function LevelRenderer.Animation.easing.QuinticOut
     * @description  è¿åæäºæ¬¡æ¹ç¼å¨éåºçå¼
     * @param {number} k - åæ°
     * @return {number}  æäºæ¬¡æ¹ç¼å¨éåºçå¼
     */
    QuinticOut(k) {
        return --k * k * k * k * k + 1;
    }

    /**
     * @function LevelRenderer.Animation.easing.QuinticInOut
     * @description è¿åæäºæ¬¡æ¹ç¼å¨è¿å¥éåºçå¼
     * @param {number} k - åæ°
     * @return {number} æäºæ¬¡æ¹ç¼å¨è¿å¥éåºçå¼
     */
    QuinticInOut(k) {
        if ((k *= 2) < 1) {
            return 0.5 * k * k * k * k * k;
        }
        return 0.5 * ((k -= 2) * k * k * k * k + 2);
    }


    // æ­£å¼¦æ²çº¿çç¼å¨ï¼sin(t)ï¼
    /**
     * @function LevelRenderer.Animation.easing.SinusoidalIn
     * @description è¿åææ­£å¼¦æ²çº¿çç¼å¨è¿å¥çå¼
     * @param {number} k - åæ°
     * @return {number} ææ­£å¼¦æ²çº¿çç¼å¨è¿å¥çå¼
     */
    SinusoidalIn(k) {
        return 1 - Math.cos(k * Math.PI / 2);
    }

    /**
     * @function LevelRenderer.Animation.easing.SinusoidalOut
     * @description è¿åææ­£å¼¦æ²çº¿çç¼å¨éåºçå¼
     * @param {number} k - åæ°
     * @return {number} ææ­£å¼¦æ²çº¿çç¼å¨éåºçå¼
     */
    SinusoidalOut(k) {
        return Math.sin(k * Math.PI / 2);
    }

    /**
     * @function LevelRenderer.Animation.easing.SinusoidalInOut
     * @description è¿åææ­£å¼¦æ²çº¿çç¼å¨è¿å¥éåºçå¼
     * @param {number} k - åæ°
     * @return {number} ææ­£å¼¦æ²çº¿çç¼å¨è¿å¥éåºçå¼
     */
    SinusoidalInOut(k) {
        return 0.5 * (1 - Math.cos(Math.PI * k));
    }


    // ææ°æ²çº¿çç¼å¨ï¼2^tï¼
    /**
     * @function LevelRenderer.Animation.easing.ExponentialIn
     * @description è¿åæææ°æ²çº¿çç¼å¨è¿å¥çå¼
     * @param {number} k - åæ°
     * @return {number} æææ°æ²çº¿çç¼å¨è¿å¥çå¼
     */
    ExponentialIn(k) {
        return k === 0 ? 0 : Math.pow(1024, k - 1);
    }

    /**
     * @function LevelRenderer.Animation.easing.ExponentialOut
     * @description è¿åæææ°æ²çº¿çç¼å¨éåºçå¼
     * @param {number} k - åæ°
     * @return {number} æææ°æ²çº¿çç¼å¨éåºçå¼
     */
    ExponentialOut(k) {
        return k === 1 ? 1 : 1 - Math.pow(2, -10 * k);
    }

    /**
     * @function LevelRenderer.Animation.easing.ExponentialInOut
     * @description è¿åæææ°æ²çº¿çç¼å¨è¿å¥éåºçå¼
     * @param {number} k - åæ°
     * @return {number} æææ°æ²çº¿çç¼å¨è¿å¥éåºçå¼
     */
    ExponentialInOut(k) {
        if (k === 0) {
            return 0;
        }
        if (k === 1) {
            return 1;
        }
        if ((k *= 2) < 1) {
            return 0.5 * Math.pow(1024, k - 1);
        }
        return 0.5 * (-Math.pow(2, -10 * (k - 1)) + 2);
    }


    // åå½¢æ²çº¿çç¼å¨ï¼sqrt(1-t^2)ï¼
    /**
     * @function LevelRenderer.Animation.easing.CircularIn
     * @description è¿åæåå½¢æ²çº¿çç¼å¨è¿å¥çå¼
     * @param {number} k - åæ°
     * @return {number} æåå½¢æ²çº¿çç¼å¨è¿å¥çå¼
     */
    CircularIn(k) {
        return 1 - Math.sqrt(1 - k * k);
    }

    /**
     * @function LevelRenderer.Animation.easing.CircularOut
     * @description è¿åæåå½¢æ²çº¿çç¼å¨éåºçå¼
     * @param {number} k - åæ°
     * @return {number} æåå½¢æ²çº¿çç¼å¨éåºçå¼
     */
    CircularOut(k) {
        return Math.sqrt(1 - (--k * k));
    }

    /**
     * @function LevelRenderer.Animation.easing.CircularInOut
     * @description è¿åæåå½¢æ²çº¿çç¼å¨è¿å¥éåºçå¼
     * @param {number} k - åæ°
     * @return {number} æåå½¢æ²çº¿çç¼å¨è¿å¥éåºçå¼
     */
    CircularInOut(k) {
        if ((k *= 2) < 1) {
            return -0.5 * (Math.sqrt(1 - k * k) - 1);
        }
        return 0.5 * (Math.sqrt(1 - (k -= 2) * k) + 1);
    }


    // åå»ºç±»ä¼¼äºå¼¹ç°§å¨åæ­¢åæ¥åæ¯è¡çå¨ç»
    /**
     * @function LevelRenderer.Animation.easing.ElasticIn
     * @description è¿åæç±»ä¼¼äºå¼¹ç°§å¨åæ­¢åæ¥åæ¯è¡çå¨ç»çç¼å¨è¿å¥çå¼
     * @param {number} k - åæ°
     * @return {number} æç±»ä¼¼äºå¼¹ç°§å¨åæ­¢åæ¥åæ¯è¡çå¨ç»çç¼å¨è¿å¥çå¼
     */
    ElasticIn(k) {
        var s;
        var a = 0.1;
        var p = 0.4;
        if (k === 0) {
            return 0;
        }
        if (k === 1) {
            return 1;
        }
        if (a < 1) {
            a = 1;
            s = p / 4;
        } else {
            s = p * Math.asin(1 / a) / (2 * Math.PI);
        }
        return -(a * Math.pow(2, 10 * (k -= 1)) *
            Math.sin((k - s) * (2 * Math.PI) / p));
    }

    /**
     * @function LevelRenderer.Animation.easing.ElasticOut
     * @description è¿åæç±»ä¼¼äºå¼¹ç°§å¨åæ­¢åæ¥åæ¯è¡çå¨ç»çç¼å¨éåºçå¼
     * @param {number} k - åæ°
     * @return {number} æç±»ä¼¼äºå¼¹ç°§å¨åæ­¢åæ¥åæ¯è¡çå¨ç»çç¼å¨éåºçå¼
     */
    ElasticOut(k) {
        var s;
        var a = 0.1;
        var p = 0.4;
        if (k === 0) {
            return 0;
        }
        if (k === 1) {
            return 1;
        }
        if (a < 1) {
            a = 1;
            s = p / 4;
        } else {
            s = p * Math.asin(1 / a) / (2 * Math.PI);
        }
        return (a * Math.pow(2, -10 * k) *
            Math.sin((k - s) * (2 * Math.PI) / p) + 1);
    }

    /**
     * @function LevelRenderer.Animation.easing.ElasticInOut
     * @description è¿åæç±»ä¼¼äºå¼¹ç°§å¨åæ­¢åæ¥åæ¯è¡çå¨ç»çç¼å¨è¿å¥éåºçå¼
     * @param {number} k - åæ°
     * @return {number} æç±»ä¼¼äºå¼¹ç°§å¨åæ­¢åæ¥åæ¯è¡çå¨ç»çç¼å¨è¿å¥éåºçå¼
     */
    ElasticInOut(k) {
        var s;
        var a = 0.1;
        var p = 0.4;
        if (k === 0) {
            return 0;
        }
        if (k === 1) {
            return 1;
        }
        if (a < 1) {
            a = 1;
            s = p / 4;
        } else {
            s = p * Math.asin(1 / a) / (2 * Math.PI);
        }
        if ((k *= 2) < 1) {
            return -0.5 * (a * Math.pow(2, 10 * (k -= 1))
                * Math.sin((k - s) * (2 * Math.PI) / p));
        }
        return a * Math.pow(2, -10 * (k -= 1))
            * Math.sin((k - s) * (2 * Math.PI) / p) * 0.5 + 1;

    }


    // å¨æä¸å¨ç»å¼å§æ²¿æç¤ºçè·¯å¾è¿è¡å¨ç»å¤çåç¨ç¨æ¶åè¯¥å¨ç»çç§»å¨
    /**
     * @function LevelRenderer.Animation.easing.BackIn
     * @description è¿åæå¨æä¸å¨ç»å¼å§æ²¿æç¤ºçè·¯å¾è¿è¡å¨ç»å¤çåç¨ç¨æ¶åè¯¥å¨ç»çç§»å¨çç¼å¨è¿å¥çå¼
     * @param {number} k - åæ°
     * @return {number} æå¨æä¸å¨ç»å¼å§æ²¿æç¤ºçè·¯å¾è¿è¡å¨ç»å¤çåç¨ç¨æ¶åè¯¥å¨ç»çç§»å¨çç¼å¨è¿å¥çå¼
     */
    BackIn(k) {
        var s = 1.70158;
        return k * k * ((s + 1) * k - s);
    }

    /**
     * @function LevelRenderer.Animation.easing.BackOut
     * @description è¿åæå¨æä¸å¨ç»å¼å§æ²¿æç¤ºçè·¯å¾è¿è¡å¨ç»å¤çåç¨ç¨æ¶åè¯¥å¨ç»çç§»å¨çç¼å¨éåºçå¼
     * @param {number} k - åæ°
     * @return {number} æå¨æä¸å¨ç»å¼å§æ²¿æç¤ºçè·¯å¾è¿è¡å¨ç»å¤çåç¨ç¨æ¶åè¯¥å¨ç»çç§»å¨çç¼å¨éåºçå¼
     */
    BackOut(k) {
        var s = 1.70158;
        return --k * k * ((s + 1) * k + s) + 1;
    }

    /**
     * @function LevelRenderer.Animation.easing.BackInOut
     * @description è¿åæå¨æä¸å¨ç»å¼å§æ²¿æç¤ºçè·¯å¾è¿è¡å¨ç»å¤çåç¨ç¨æ¶åè¯¥å¨ç»çç§»å¨çç¼å¨è¿å¥éåºçå¼
     * @param {number} k - åæ°
     * @return {number} æå¨æä¸å¨ç»å¼å§æ²¿æç¤ºçè·¯å¾è¿è¡å¨ç»å¤çåç¨ç¨æ¶åè¯¥å¨ç»çç§»å¨çç¼å¨è¿å¥éåºçå¼
     */
    BackInOut(k) {
        var s = 1.70158 * 1.525;
        if ((k *= 2) < 1) {
            return 0.5 * (k * k * ((s + 1) * k - s));
        }
        return 0.5 * ((k -= 2) * k * ((s + 1) * k + s) + 2);
    }


    // åå»ºå¼¹è·³ææ
    /**
     * @function LevelRenderer.Animation.easing.BounceIn
     * @description è¿åæå¼¹è·³ææçç¼å¨è¿å¥çå¼
     * @param {number} k - åæ°
     * @return {number} æå¼¹è·³ææçç¼å¨è¿å¥çå¼
     */
    BounceIn(k) {
        return 1 - this.BounceOut(1 - k);
    }

    /**
     * @function LevelRenderer.Animation.easing.BounceOut
     * @description è¿åæå¼¹è·³ææçç¼å¨éåºçå¼
     * @param {number} k - åæ°
     * @return {number} æå¼¹è·³ææçç¼å¨éåºçå¼
     */
    BounceOut(k) {
        if (k < (1 / 2.75)) {
            return 7.5625 * k * k;
        } else if (k < (2 / 2.75)) {
            return 7.5625 * (k -= (1.5 / 2.75)) * k + 0.75;
        } else if (k < (2.5 / 2.75)) {
            return 7.5625 * (k -= (2.25 / 2.75)) * k + 0.9375;
        } else {
            return 7.5625 * (k -= (2.625 / 2.75)) * k + 0.984375;
        }
    }

    /**
     * @function LevelRenderer.Animation.easing.BounceInOut
     * @description è¿åæå¼¹è·³ææçç¼å¨è¿å¥éåºçå¼
     * @param {number} k - åæ°
     * @return {number} æå¼¹è·³ææçç¼å¨è¿å¥éåºçå¼
     */
    BounceInOut(k) {
        if (k < 0.5) {
            return this.BounceIn(k * 2) * 0.5;
        }
        return this.BounceOut(k * 2 - 1) * 0.5 + 0.5;
    }

}

;// CONCATENATED MODULE: ./src/common/overlay/levelRenderer/Clip.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class  LevelRenderer.Animation.Clip
 * @category Visualization Theme
 * @classdesc å¨ç»çæ®µ
 * @param {Object} options - åæ°ã
 * @param {Object} options.target - å¨ç»å¯¹è±¡ï¼å¯ä»¥æ¯æ°ç»ï¼å¦ææ¯æ°ç»çè¯ä¼æ¹éåå onframe ç­äºä»¶ã
 * @param {number} [options.life=1000] - å¨ç»æ¶é¿ã
 * @param {number} [options.delay=0] - å¨ç»å»¶è¿æ¶é´ã
 * @param {boolean} [options.loop=true] - æ¯å¦å¾ªç¯ã
 * @param {number} [options.gap=0] - å¾ªç¯çé´éæ¶é´ã
 * @param {Object} options.onframe -  å¸§ã
 * @param {boolean} options.easing - æ¯å¦æ¶é¤ã
 * @param {boolean} options.ondestroy - æ¯å¦éæ¯ã
 * @param {boolean} options.onrestart - æ¯å¦éæ­ã
 * @private
 */
class Clip {
    constructor(options) {
        this._targetPool = options.target || {};
        if (!(this._targetPool instanceof Array)) {
            this._targetPool = [this._targetPool];
        }

        // çå½å¨æ
        this._life = options.life || 1000;
        // å»¶æ¶
        this._delay = options.delay || 0;
        // å¼å§æ¶é´
        this._startTime = new Date().getTime() + this._delay;// åä½æ¯«ç§

        // ç»ææ¶é´
        this._endTime = this._startTime + this._life * 1000;

        // æ¯å¦å¾ªç¯
        this.loop = typeof options.loop == 'undefined'
            ? false : options.loop;

        this.gap = options.gap || 0;

        this.easing = options.easing || 'Linear';

        this.onframe = options.onframe;
        this.ondestroy = options.ondestroy;
        this.onrestart = options.onrestart;
        this.CLASS_NAME = "SuperMap.LevelRenderer.Animation.Clip";
    }

    /**
     * @function LevelRenderer.Animation.Clip.prototype.destroy
     * @description éæ¯å¯¹è±¡ï¼éæ¾èµæºãè°ç¨æ­¤å½æ°åææå±æ§å°è¢«ç½®ä¸º nullã
     */
    destroy() {

    }

    step(time) {
        var easing = new Easing();
        var percent = (time - this._startTime) / this._life;

        // è¿æ²¡å¼å§
        if (percent < 0) {
            return;
        }

        percent = Math.min(percent, 1);

        var easingFunc = typeof this.easing == 'string'
            ? easing[this.easing]
            : this.easing;
        var schedule = typeof easingFunc === 'function'
            ? easingFunc(percent)
            : percent;

        this.fire('frame', schedule);

        // ç»æ
        if (percent == 1) {
            if (this.loop) {
                this.restart();
                // éæ°å¼å§å¨æ
                // æåºèä¸æ¯ç´æ¥è°ç¨äºä»¶ç´å° stage.update ååç»ä¸è°ç¨è¿äºäºä»¶
                return 'restart';

            }

            // å¨ç»å®æå°è¿ä¸ªæ§å¶å¨æ è¯ä¸ºå¾å é¤
            // å¨Animation.updateä¸­è¿è¡æ¹éå é¤
            this._needsRemove = true;
            return 'destroy';
        }

        return null;
    }

    restart() {
        var time = new Date().getTime();
        var remainder = (time - this._startTime) % this._life;
        this._startTime = new Date().getTime() - remainder + this.gap;
    }

    fire(eventType, arg) {
        for (var i = 0, len = this._targetPool.length; i < len; i++) {
            if (this['on' + eventType]) {
                this['on' + eventType](this._targetPool[i], arg);
            }
        }
    }

}

;// CONCATENATED MODULE: ./src/common/overlay/levelRenderer/Animation.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/






/**
 * @class LevelRenderer.Animation
 * @classdesc å¨ç»ä¸»ç±», è°åº¦åç®¡çææå¨ç»æ§å¶å¨
 * @category Visualization Theme
 * @extends {LevelRenderer.Eventful}
 * @param {Object} options - å¨ç»åæ°ã
 * @param {Object} options.onframe - onframeã
 * @param {Object} options.stage - stageã
 * @example ä¾å¦ï¼
 * (start code)
 *     var animation = new LevelRenderer.Animation();
 *     var obj = {
 *         x: 100,
 *         y: 100
 *     };
 *     animation.animate(node.position)
 *         .when(1000, {
 *             x: 500,
 *             y: 500
 *         })
 *         .when(2000, {
 *             x: 100,
 *             y: 100
 *         })
 *         .start('spline');
 * (end)
 * @private
 */
class Animation extends Eventful {
    constructor(options) {
        super(options);

        options = options || {};
        /**
         * @member {Object} LevelRenderer.Animation.prototype.stage
         * @description stageã
         */
        this.stage = {};

        /**
         * @member {Object} LevelRenderer.Animation.prototype.onframe
         * @description onframeã
         */
        this.onframe = function () {
        };

        /**
         * @member {Array} LevelRenderer.Animation.prototype._clips
         * @description _clipsã
         */
        this._clips = [];

        /**
         * @member {boolean} LevelRenderer.Animation.prototype._running
         * @description _runningã
         */
        this._running = false;

        /**
         * @member {number} LevelRenderer.Animation.prototype._time
         * @description _timeã
         */
        this._time = 0;

        Util.extend(this, options);

        this.CLASS_NAME = "SuperMap.LevelRenderer.Animation";

    }


    /**
     * @function LevelRenderer.Animation.prototype.add
     * @description æ·»å å¨ç»çæ®µã
     * @param {LevelRenderer.Animation.Clip} clip - å¨ç»çæ®µã
     */
    add(clip) {
        this._clips.push(clip);
    }


    /**
     * @function LevelRenderer.Animation.prototype.remove
     * @description å é¤å¨ç»çæ®µã
     * @param {LevelRenderer.Animation.Clip} clip - å¨ç»çæ®µã
     */
    remove(clip) {
        var idx = new Util_Util().indexOf(this._clips, clip);
        if (idx >= 0) {
            this._clips.splice(idx, 1);
        }
    }


    /**
     * @function LevelRenderer.Animation.prototype.update
     * @description æ´æ°å¨ç»çæ®µã
     */
    _update() {
        var time = new Date().getTime();
        var delta = time - this._time;
        var clips = this._clips;
        var len = clips.length;

        var deferredEvents = [];
        var deferredClips = [];
        for (let i = 0; i < len; i++) {
            var clip = clips[i];
            var e = clip.step(time);
            // Throw out the events need to be called after
            // stage.update, like destroy
            if (e) {
                deferredEvents.push(e);
                deferredClips.push(clip);
            }
        }
        if (this.stage.update) {
            this.stage.update();
        }

        // Remove the finished clip
        for (let i = 0; i < len;) {
            if (clips[i]._needsRemove) {
                clips[i] = clips[len - 1];
                clips.pop();
                len--;
            } else {
                i++;
            }
        }

        len = deferredEvents.length;
        for (let i = 0; i < len; i++) {
            deferredClips[i].fire(deferredEvents[i]);
        }

        this._time = time;

        this.onframe(delta);

        this.dispatch('frame', delta);
    }


    /**
     * @function LevelRenderer.Animation.prototype.start
     * @description å¼å§è¿è¡å¨ç»ã
     */
    start() {
        var requestAnimationFrame = window.requestAnimationFrame
            || window.msRequestAnimationFrame
            || window.mozRequestAnimationFrame
            || window.webkitRequestAnimationFrame
            || function (func) {
                setTimeout(func, 16);
            };

        var self = this;

        this._running = true;

        function step() {
            if (self._running) {
                self._update();
                requestAnimationFrame(step);
            }
        }

        this._time = new Date().getTime();
        requestAnimationFrame(step);
    }


    /**
     * @function LevelRenderer.Animation.prototype.stop
     * @description åæ­¢è¿è¡å¨ç»ã
     */
    stop() {
        this._running = false;
    }


    /**
     * @function LevelRenderer.Animation.prototype.clear
     * @description æ¸é¤ææå¨ç»çæ®µã
     */
    clear() {
        this._clips = [];
    }


    /**
     * @function LevelRenderer.Animation.prototype.animate
     * @description å¯¹ä¸ä¸ªç®æ åå»ºä¸ä¸ªanimatorå¯¹è±¡ï¼å¯ä»¥æå®ç®æ ä¸­çå±æ§ä½¿ç¨å¨ç»ã
     * @param {Object} target - ç®æ å¯¹è±¡ã
     * @param {Object} options - å¨ç»åæ°éé¡¹ã
     * @param {boolean} [options.loop=false] - æ¯å¦å¾ªç¯æ­æ¾å¨ç»ã
     * @param {function} [options.getter] - å¦ææå®getterå½æ°ï¼ä¼éè¿getterå½æ°åå±æ§å¼ã
     * @param {function} [options.setter] - å¦ææå®setterå½æ°ï¼ä¼éè¿setterå½æ°è®¾ç½®å±æ§å¼ã
     * @returns {LevelRenderer.Animation.Animator} Animatorã
     */
    animate(target, options) {
        options = options || {};
        var deferred = new Animator(
            target,
            options.loop,
            options.getter,
            options.setter
        );
        deferred.animation = this;
        return deferred;
    }

    static _interpolateNumber(p0, p1, percent) {
        return (p1 - p0) * percent + p0;
    }

    static _interpolateArray(p0, p1, percent, out, arrDim) {
        var len = p0.length;
        if (arrDim == 1) {
            for (let i = 0; i < len; i++) {
                out[i] = Animation._interpolateNumber(p0[i], p1[i], percent);
            }
        } else {
            var len2 = p0[0].length;
            for (let i = 0; i < len; i++) {
                for (let j = 0; j < len2; j++) {
                    out[i][j] = Animation._interpolateNumber(
                        p0[i][j], p1[i][j], percent
                    );
                }
            }
        }
    }

    static _isArrayLike(data) {
        switch (typeof data) {
            case 'undefined':
            case 'string':
                return false;
        }

        return typeof data.length !== 'undefined';
    }

    static _catmullRomInterpolateArray(p0, p1, p2, p3, t, t2, t3, out, arrDim) {
        var len = p0.length;
        if (arrDim == 1) {
            for (let i = 0; i < len; i++) {
                out[i] = Animation._catmullRomInterpolate(
                    p0[i], p1[i], p2[i], p3[i], t, t2, t3
                );
            }
        } else {
            var len2 = p0[0].length;
            for (let i = 0; i < len; i++) {
                for (var j = 0; j < len2; j++) {
                    out[i][j] = Animation._catmullRomInterpolate(
                        p0[i][j], p1[i][j], p2[i][j], p3[i][j],
                        t, t2, t3
                    );
                }
            }
        }
    }

    static _catmullRomInterpolate(p0, p1, p2, p3, t, t2, t3) {
        var v0 = (p2 - p0) * 0.5;
        var v1 = (p3 - p1) * 0.5;
        return (2 * (p1 - p2) + v0 + v1) * t3
            + (-3 * (p1 - p2) - 2 * v0 - v1) * t2
            + v0 * t + p1;
    }

    static _cloneValue(value) {
        var arraySlice = Array.prototype.slice;

        if (Animation._isArrayLike(value)) {
            var len = value.length;
            if (Animation._isArrayLike(value[0])) {
                var ret = [];
                for (var i = 0; i < len; i++) {
                    ret.push(arraySlice.call(value[i]));
                }
                return ret;
            } else {
                return arraySlice.call(value);
            }
        } else {
            return value;
        }
    }

    static rgba2String(rgba) {
        rgba[0] = Math.floor(rgba[0]);
        rgba[1] = Math.floor(rgba[1]);
        rgba[2] = Math.floor(rgba[2]);

        return 'rgba(' + rgba.join(',') + ')';
    }
}

/**
 * @class LevelRenderer.Animation.Animator
 */
class Animator {

    /**
     * @function LevelRenderer.Animation.Animator.prototype.animate
     * @description æé å½æ°
     * @param {Object} target - ç®æ å¯¹è±¡ã
     * @param {Object} options - å¨ç»åæ°éé¡¹ã
     * @param {boolean} [loop=false] - æ¯å¦å¾ªç¯æ­æ¾å¨ç»ã
     * @param {function} [getterl] - å¦ææå®getterå½æ°ï¼ä¼éè¿getterå½æ°åå±æ§å¼ã
     * @param {function} [setter] - å¦ææå®setterå½æ°ï¼ä¼éè¿setterå½æ°è®¾ç½®å±æ§å¼ã
     */
    constructor(target, loop, getter, setter) {
        /**
         * @member {Object} LevelRenderer.Animation.Animator.prototype._tracks
         * @description _tracksã
         */
        this._tracks = {};

        /**
         * @member {Object} LevelRenderer.Animation.Animator.prototype._target
         * @description _targetã
         */
        this._target = target;

        /**
         * @member {boolean} LevelRenderer.Animation.Animator.prototype._loop
         * @description _loopã
         */
        this._loop = loop || false;

        /**
         * @member {function} LevelRenderer.Animation.Animator.prototype._getter
         * @description _getterã
         */
        this._getter = getter || _defaultGetter;

        /**
         * @member {function} LevelRenderer.Animation.Animator.prototype._setter
         * @description _setterã
         */
        this._setter = setter || _defaultSetter;

        /**
         * @member {number} LevelRenderer.Animation.Animator.prototype._clipCount
         * @description _clipCountã
         */
        this._clipCount = 0;

        /**
         * @member {number} LevelRenderer.Animation.Animator.prototype._delay
         * @description _delayã
         */
        this._delay = 0;

        /**
         * @member {Array} LevelRenderer.Animation.Animator.prototype._doneList
         * @description _doneListã
         */
        this._doneList = [];

        /**
         * @member {Array} LevelRenderer.Animation.Animator.prototype._onframeList
         * @description _onframeListã
         */
        this._onframeList = [];

        /**
         * @member {Array} LevelRenderer.Animation.Animator.prototype._clipList
         * @description _clipListã
         */
        this._clipList = [];
        this.CLASS_NAME = "SuperMap.LevelRenderer.Animation.Animator";
        //Function
        function _defaultGetter(target, key) {
            return target[key];
        }

        function _defaultSetter(target, key, value) {
            target[key] = value;
        }
    }


    /**
     * @function LevelRenderer.Animation.Animator.prototype.when
     * @description è®¾ç½®å¨ç»å³é®å¸§
     * @param {number} time - å³é®å¸§æ¶é´ï¼åä½æ¯ms
     * @param {Object} props - å³é®å¸§çå±æ§å¼ï¼key-valueè¡¨ç¤º
     * @returns {LevelRenderer.Animation.Animator} Animator
     */
    when(time /* ms */, props) {
        for (var propName in props) {
            if (!this._tracks[propName]) {
                this._tracks[propName] = [];
                // If time is 0
                //  Then props is given initialize value
                // Else
                //  Initialize value from current prop value
                if (time !== 0) {
                    this._tracks[propName].push({
                        time: 0,
                        value: Animation._cloneValue(
                            this._getter(this._target, propName)
                        )
                    });
                }
            }
            this._tracks[propName].push({
                time: parseInt(time, 10),
                value: props[propName]
            });
        }
        return this;
    }


    /**
     * @function LevelRenderer.Animation.Animator.prototype.during
     * @description æ·»å å¨ç»æ¯ä¸å¸§çåè°å½æ°
     * @param {RequestCallback} callback - åè°å½æ°
     * @returns {LevelRenderer.Animation.Animator} Animator
     */
    during(callback) {
        this._onframeList.push(callback);
        return this;
    }


    /**
     * @function LevelRenderer.Animation.Animator.prototype.start
     * @description å¼å§æ§è¡å¨ç»
     * @param {(string|function)} easing - å¨ç»ç¼å¨å½æ°ãè¯¦è§ï¼<{@link LevelRenderer.Animation.easing}>ã
     * @returns {LevelRenderer.Animation.Animator} Animator
     */
    start(easing) {
        var self = this;
        var setter = this._setter;
        var getter = this._getter;
        var onFrameListLen = self._onframeList.length;
        var useSpline = easing === 'spline';

        var ondestroy = function () {
            self._clipCount--;
            if (self._clipCount === 0) {
                // Clear all tracks
                self._tracks = {};

                var len = self._doneList.length;
                for (var i = 0; i < len; i++) {
                    self._doneList[i].call(self);
                }
            }
        };

        var createTrackClip = function (keyframes, propName) {
            var trackLen = keyframes.length;
            if (!trackLen) {
                return;
            }
            // Guess data type
            var firstVal = keyframes[0].value;
            var isValueArray = Animation._isArrayLike(firstVal);
            var isValueColor = false;

            // For vertices morphing
            var arrDim = (
                isValueArray
                && Animation._isArrayLike(firstVal[0])
            )
                ? 2 : 1;
            // Sort keyframe as ascending
            keyframes.sort(function (a, b) {
                return a.time - b.time;
            });
            var trackMaxTime = keyframes[trackLen - 1].time;
            // Percents of each keyframe
            var kfPercents = [];
            // Value of each keyframe
            var kfValues = [];
            for (let i = 0; i < trackLen; i++) {
                kfPercents.push(keyframes[i].time / trackMaxTime);
                // Assume value is a color when it is a string
                var value = keyframes[i].value;
                if (typeof(value) == 'string') {
                    value = SUtil_SUtil.Util_color.toArray(value);
                    if (value.length === 0) {    // Invalid color
                        value[0] = value[1] = value[2] = 0;
                        value[3] = 1;
                    }
                    isValueColor = true;
                }
                kfValues.push(value);
            }

            // Cache the key of last frame to speed up when
            // animation playback is sequency
            var cacheKey = 0;
            var cachePercent = 0;
            var start;
            var i;
            var w;
            var p0;
            var p1;
            var p2;
            var p3;


            if (isValueColor) {
                var rgba = [0, 0, 0, 0];
            }

            var onframe = function (target, percent) {
                // Find the range keyframes
                // kf1-----kf2---------current--------kf3
                // find kf2 and kf3 and do interpolation
                if (percent < cachePercent) {
                    // Start from next key
                    start = Math.min(cacheKey + 1, trackLen - 1);
                    for (i = start; i >= 0; i--) {
                        if (kfPercents[i] <= percent) {
                            break;
                        }
                    }
                    i = Math.min(i, trackLen - 2);
                } else {
                    for (i = cacheKey; i < trackLen; i++) {
                        if (kfPercents[i] > percent) {
                            break;
                        }
                    }
                    i = Math.min(i - 1, trackLen - 2);
                }
                cacheKey = i;
                cachePercent = percent;

                var range = (kfPercents[i + 1] - kfPercents[i]);
                if (range === 0) {
                    return;
                } else {
                    w = (percent - kfPercents[i]) / range;
                }
                if (useSpline) {
                    p1 = kfValues[i];
                    p0 = kfValues[i === 0 ? i : i - 1];
                    p2 = kfValues[i > trackLen - 2 ? trackLen - 1 : i + 1];
                    p3 = kfValues[i > trackLen - 3 ? trackLen - 1 : i + 2];
                    if (isValueArray) {
                        Animation._catmullRomInterpolateArray(
                            p0, p1, p2, p3, w, w * w, w * w * w,
                            getter(target, propName),
                            arrDim
                        );
                    } else {
                        let value;
                        if (isValueColor) {
                            // value = LevelRenderer.Animation._catmullRomInterpolateArray(
                            //     p0, p1, p2, p3, w, w * w, w * w * w,
                            //     rgba, 1
                            // );
                            value = Animation.rgba2String(rgba);
                        } else {
                            value = Animation._catmullRomInterpolate(
                                p0, p1, p2, p3, w, w * w, w * w * w
                            );
                        }
                        setter(
                            target,
                            propName,
                            value
                        );
                    }
                } else {
                    if (isValueArray) {
                        Animation._interpolateArray(
                            kfValues[i], kfValues[i + 1], w,
                            getter(target, propName),
                            arrDim
                        );
                    } else {
                        let value;
                        if (isValueColor) {
                            Animation._interpolateArray(
                                kfValues[i], kfValues[i + 1], w,
                                rgba, 1
                            );
                            value = Animation.rgba2String(rgba);
                        } else {
                            value = Animation._interpolateNumber(kfValues[i], kfValues[i + 1], w);
                        }
                        setter(
                            target,
                            propName,
                            value
                        );
                    }
                }

                for (i = 0; i < onFrameListLen; i++) {
                    self._onframeList[i](target, percent);
                }
            };

            var clip = new Clip({
                target: self._target,
                life: trackMaxTime,
                loop: self._loop,
                delay: self._delay,
                onframe: onframe,
                ondestroy: ondestroy
            });

            if (easing && easing !== 'spline') {
                clip.easing = easing;
            }
            self._clipList.push(clip);
            self._clipCount++;
            self.animation.add(clip);
        };

        for (var propName in this._tracks) {
            createTrackClip(this._tracks[propName], propName);
        }
        return this;
    }


    /**
     * @function LevelRenderer.Animation.Animator.prototype.stop
     * @description åæ­¢å¨ç»
     */
    stop() {
        for (var i = 0; i < this._clipList.length; i++) {
            var clip = this._clipList[i];
            this.animation.remove(clip);
        }
        this._clipList = [];
    }


    /**
     * @function LevelRenderer.Animation.Animator.prototype.delay
     * @description è®¾ç½®å¨ç»å»¶è¿å¼å§çæ¶é´
     * @param {number} time - æ¶é´ï¼åä½ms
     * @returns {LevelRenderer.Animation.Animator} Animator
     */
    delay(time) {
        this._delay = time;
        return this;
    }


    /**
     * @function LevelRenderer.Animation.Animator.prototype.done
     * @description æ·»å å¨ç»ç»æçåè°
     * @param {function} cb - Function
     * @returns {LevelRenderer.Animation.Animator} Animator
     */
    done(cb) {
        if (cb) {
            this._doneList.push(cb);
        }
        return this;
    }

}



;// CONCATENATED MODULE: ./src/common/overlay/levelRenderer/Render.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/

 
 
 
 
 
 
 

 /**
 * @private
 * @class LevelRenderer.Render
 * @category Visualization Theme
 * @classdesc Render æ¥å£ç±»ï¼å¯¹å¤å¯ç¨çæææ¥å£é½å¨è¿éãåé¨ä½¿ç¨é get æ¥å£ç»ä¸è¿å this å¯¹è±¡ï¼æ¯æé¾å¼è°ç¨ã
 * @param {string} id - å¯ä¸æ è¯ã
 * @param {HTMLElement} dom - Dom å¯¹è±¡ã
 */

class Render {
    constructor(id, dom) {
        /**
         * @member {string} LevelRenderer.Render.prototype.id
         * @description å¯ä¸æ è¯ã
         */
        this.id = id;

        /**
         * @member {LevelRenderer.Storage} LevelRenderer.Render.prototype.storage
         * @description å¾å½¢ä»åºå¯¹è±¡ã
         */
        this.storage = new Storage();

        /**
         * @member {LevelRenderer.Painter} LevelRenderer.Render.prototype.painter
         * @description ç»å¶å¨å¯¹è±¡ã
         *
         */
        this.painter = new Painter(dom, this.storage);

        /**
         * @member {LevelRenderer.Handler} LevelRenderer.Render.prototype.handler
         * @description äºä»¶å¤çå¯¹è±¡ã
         *
         */
        this.handler = new Handler(dom, this.storage, this.painter);

        /**
         * @member {Array} LevelRenderer.Render.prototype.animatingElements
         * @description å¨ç»æ§å¶æ°ç»ã
         *
         */
        this.animatingElements = [];

        /**
         * @member {LevelRenderer.animation.Animation} LevelRenderer.Render.prototype.animation
         * @description å¨ç»å¯¹è±¡ã
         *
         */
        this.animation = new Animation({
            stage: {
                update: Render.getFrameCallback(this)
            }
        });

        /**
         * @member {boolean} LevelRenderer.Render.prototype._needsRefreshNextFrame
         * @description æ¯å¦éè¦å·æ°ä¸ä¸å¸§ã
         *
         */
        this._needsRefreshNextFrame = false;
        this.animation.start();
        this.CLASS_NAME = "SuperMap.LevelRenderer.Render";

    }

    /**
     * @function LevelRenderer.Render.prototype.destory
     * @description éæ¯å¯¹è±¡ï¼éæ¾èµæºãè°ç¨æ­¤å½æ°åææå±æ§å°è¢«ç½®ä¸º nullã
     */
    destroy() {
        this.id = null;
        this.storage = null;
        this.painter = null;
        this.handler = null;
        this.animatingElements = null;
        this.animation = null;
        this._needsRefreshNextFrame = null;
    }

    /**
     * @function LevelRenderer.Render.prototype.getId
     * @description è·åå®ä¾å¯ä¸æ è¯ã
     * @return {string} å®ä¾å¯ä¸æ è¯ã
     */
    getId() {
        return this.id;
    }

    /**
     * @function LevelRenderer.Render.prototype.addShape
     * @description æ·»å å¾å½¢å½¢ç¶å°æ ¹èç¹ã
     *
     * @param {LevelRenderer.Shape} shape - å¾å½¢å¯¹è±¡ï¼å¯ç¨å±æ§å¨éï¼è¯¦è§å shapeã
     * @return {LevelRenderer.Render} thisã
     */
    addShape(shape) {
        this.storage.addRoot(shape);
        return this;
    }

    /**
     * @function LevelRenderer.Render.prototype.addGroup
     * @description æ·»å ç»å°æ ¹èç¹ã
     *
     * (code)
     * //æ·»å ç»å°æ ¹èç¹ä¾å­
     * var render = new LevelRenderer.Render("Render",document.getElementById('lRendertest'));
     * render.clear();
     * var g = new LevelRenderer.Group();
     * g.addChild(new LevelRenderer.Shape.Circle({
     *     style: {
     *         x: 100,
     *         y: 100,
     *         r: 20,
     *         brushType: 'fill'
     *     }
     * }));
     * render.addGroup(g);
     * render.render();
     * (end)
     *
     * @param {LevelRenderer.Group} group - ç»å¯¹è±¡ã
     * @return {LevelRenderer.Render} thisã
     */
    addGroup(group) {
        this.storage.addRoot(group);
        return this;
    }

    /**
     * @function LevelRenderer.Render.prototype.delShape
     * @description ä»æ ¹èç¹å é¤å¾å½¢å½¢ç¶ã
     *
     * @param {string} shapeId - å¾å½¢å¯¹è±¡å¯ä¸æ è¯ã
     * @return {LevelRenderer.Render} thisã
     */
    delShape(shapeId) {
        this.storage.delRoot(shapeId);
        return this;
    }

    /**
     * @function LevelRenderer.Render.prototype.delGroup
     * @description ä»æ ¹èç¹å é¤ç»ã
     *
     * @param {string} groupId - ç»å¯¹è±¡å¯ä¸æ è¯ã
     * @return {LevelRenderer.Render} thisã
     */
    delGroup(groupId) {
        this.storage.delRoot(groupId);
        return this;
    }

    /**
     * @function LevelRenderer.Render.prototype.modShape
     * @description ä¿®æ¹å¾å½¢å½¢ç¶ã
     *
     * @param {string} shapeId - å¾å½¢å¯¹è±¡å¯ä¸æ è¯ã
     * @param {LevelRenderer.Shape} shape - å¾å½¢å¯¹è±¡ã
     * @return {LevelRenderer.Render} thisã
     */
    modShape(shapeId, shape) {
        this.storage.mod(shapeId, shape);
        return this;
    }

    /**
     * @function LevelRenderer.Render.prototype.modGroup
     * @description ä¿®æ¹ç»ã
     *
     * @param {string} groupId - ç»å¯¹è±¡å¯ä¸æ è¯ã
     * @param {LevelRenderer.Group} group - ç»å¯¹è±¡ã
     * @return {LevelRenderer.Render} thisã
     */
    modGroup(groupId, group) {
        this.storage.mod(groupId, group);
        return this;
    }

    /**
     * @function LevelRenderer.Render.prototype.modLayer
     * @description ä¿®æ¹æå® zlevel çç»å¶éç½®é¡¹ã
     *
     * @param {string} zLevel - ç»å¯¹è±¡å¯ä¸æ è¯ã
     * @param {Object} config - éç½®å¯¹è±¡ã
     * @param {string} clearColor - æ¯æ¬¡æ¸ç©ºç»å¸çé¢è²ãé»è®¤å¼ï¼0ã
     * @param {noolean} motionBlur - æ¯å¦å¼å¯å¨ææ¨¡ç³ãé»è®¤å¼ï¼falseã
     * @param {number}  lastFrameAlpha - å¨å¼å¯å¨ææ¨¡ç³çæ¶åä½¿ç¨ï¼ä¸ä¸ä¸å¸§æ··åçalphaå¼ï¼å¼è¶å¤§å°¾è¿¹è¶ææ¾ãé»è®¤å¼ï¼0.7ã
     * @param {Array.<number>} position - å±çå¹³ç§»ã
     * @param {Array.<number>} rotation - å±çæè½¬ã
     * @param {Array.<number>} scale - å±çç¼©æ¾ã
     * @param {boolean} zoomable - å±æ¯å¦æ¯æé¼ æ ç¼©æ¾æä½ãé»è®¤å¼ï¼falseã
     * @param {boolean} panable - å±æ¯å¦æ¯æé¼ æ å¹³ç§»æä½ãé»è®¤å¼ï¼falseã
     * @return {LevelRenderer.Render} thisã
     */
    modLayer(zLevel, config) {
        this.painter.modLayer(zLevel, config);
        return this;
    }

    /**
     * @function LevelRenderer.Render.prototype.addHoverShape
     * @description æ·»å é¢å¤é«äº®å±æ¾ç¤ºï¼ä»æä¾æ·»å æ¹æ³ï¼æ¯æ¬¡å·æ°åé«äº®å±å¾å½¢åè¢«æ¸ç©ºã
     *
     * @param {LevelRenderer.Shape} shape - å¾å½¢å¯¹è±¡ã
     * @return {LevelRenderer.Render} thisã
     */
    addHoverShape(shape) {
        this.storage.addHover(shape);
        return this;
    }

    /**
     * @function LevelRenderer.Render.prototype.render
     * @description æ¸²æã
     *
     * @callback {function} callback - æ¸²æç»æååè°å½æ°ã
     * @return {LevelRenderer.Render} thisã
     */
    render(callback) {
        this.painter.render(callback);
        this._needsRefreshNextFrame = false;
        return this;
    }

    /**
     * @function LevelRenderer.Render.prototype.refresh
     * @description è§å¾æ´æ°ã
     *
     * @callback {function} callback - è§å¾æ´æ°ååè°å½æ°ã
     * @return {LevelRenderer.Render} thisã
     */
    refresh(callback) {
        this.painter.refresh(callback);
        this._needsRefreshNextFrame = false;
        return this;
    }

    /**
     * @function LevelRenderer.Render.prototype.refreshNextFrame
     * @description æ è®°è§å¾å¨æµè§å¨ä¸ä¸å¸§éè¦ç»å¶ã
     * @return {LevelRenderer.Render} thisã
     */
    refreshNextFrame() {
        this._needsRefreshNextFrame = true;
        return this;
    }

    /**
     * @function LevelRenderer.Render.prototype.refreshHover
     * @description ç»å¶ï¼è§å¾æ´æ°ï¼é«äº®å±ã
     * @callback {function} callback - è§å¾æ´æ°ååè°å½æ°ã
     * @return {LevelRenderer.Render} thisã
     */
    refreshHover(callback) {
        this.painter.refreshHover(callback);
        return this;
    }

    /**
     * @function LevelRenderer.Render.prototype.refreshShapes
     * @description è§å¾æ´æ°ã
     *
     * @param {Array.<LevelRenderer.Shape>} shapeList - éè¦æ´æ°çå¾å½¢åè¡¨ã
     * @callback {function} callback - è§å¾æ´æ°ååè°å½æ°ã
     * @return {LevelRenderer.Render} thisã
     */
    refreshShapes(shapeList, callback) {
        this.painter.refreshShapes(shapeList, callback);
        return this;
    }

    /**
     * @function LevelRenderer.Render.prototype.resize
     * @description è°æ´è§å¾å¤§å°ã
     * @return {LevelRenderer.Render} thisã
     */
    resize() {
        this.painter.resize();
        return this;
    }

    /**
     * @function LevelRenderer.Render.prototype.animate
     * @description å¨ç»ã
     *
     * @example
     *     zr.animate(circle.id, 'style', false)
     *         .when(1000, {x: 10} )
     *         .done(function(){ // Animation done })
     *         .start()
     *
     *
     * @param {Array.<(LevelRenderer.Shape/LevelRenderer.Group)>} el - å¨ç»å¯¹è±¡ã
     * @param {string} path - éè¦æ·»å å¨ç»çå±æ§è·åè·¯å¾ï¼å¯ä»¥éè¿ a.b.c æ¥è·åæ·±å±çå±æ§ãè¥ä¼ å¥å¯¹è±¡ä¸º<LevelRenderer.Group>,pathéä¸ºç©ºå­ç¬¦ä¸²ã
     * @param {function} loop - å¨ç»æ¯å¦å¾ªç¯ã
     * @return {LevelRenderer.animation.Animator} Animatorã
     */
    animate(el, path, loop) {
        if (typeof(el) === 'string') {
            el = this.storage.get(el);
        }
        if (el) {
            var target;
            if (path) {
                var pathSplitted = path.split('.');
                var prop = el;
                for (var i = 0, l = pathSplitted.length; i < l; i++) {
                    if (!prop) {
                        continue;
                    }
                    prop = prop[pathSplitted[i]];
                }
                if (prop) {
                    target = prop;
                }
            } else {
                target = el;
            }

            if (!target) {
                SUtil_SUtil.Util_log(
                    'Property "'
                    + path
                    + '" is not existed in element '
                    + el.id
                );
                return;
            }

            var animatingElements = this.animatingElements;
            if (typeof el.__aniCount === 'undefined') {
                // æ­£å¨è¿è¡çå¨ç»è®°æ°
                el.__aniCount = 0;
            }
            if (el.__aniCount === 0) {
                animatingElements.push(el);
            }
            el.__aniCount++;

            return this.animation.animate(target, {loop: loop})
                .done(function () {
                    el.__aniCount--;
                    if (el.__aniCount === 0) {
                        // ä»animatingElementséç§»é¤
                        var idx = new Util_Util().indexOf(animatingElements, el);
                        animatingElements.splice(idx, 1);
                    }
                });
        } else {
            SUtil_SUtil.Util_log('Element not existed');
        }
    }

    /**
     * @function LevelRenderer.Render.prototype.clearAnimation
     * @description åæ­¢ææå¨ç»ã
     *
     */
    clearAnimation() {
        this.animation.clear();
    }

    /**
     * @function LevelRenderer.Render.prototype.getWidth
     * @description è·åè§å¾å®½åº¦ã
     * @return {number} è§å¾å®½åº¦ã
     */
    getWidth() {
        return this.painter.getWidth();
    }

    /**
     * @function LevelRenderer.Render.prototype.getHeight
     * @description è·åè§å¾é«åº¦ã
     * @return {number} è§å¾é«åº¦ã
     */
    getHeight() {
        return this.painter.getHeight();
    }

    /**
     * @function LevelRenderer.Render.prototype.toDataURL
     * @description å¾åå¯¼åºã
     *
     * @param {string} type - ç±»åã
     * @param {string} backgroundColor - èæ¯è²ï¼é»è®¤å¼ï¼"#FFFFFF"ã
     * @param {string} args - åæ°ã
     * @return {string} å¾çç Base64 urlã
     */
    toDataURL(type, backgroundColor, args) {
        return this.painter.toDataURL(type, backgroundColor, args);
    }

    /**
     * @function LevelRenderer.Render.prototype.shapeToImage
     * @description å°å¸¸è§ shape è½¬æ image shapeã
     *
     * @param {LevelRenderer.Shape} e - å¾å½¢ã
     * @param {number} width - å®½åº¦ã
     * @param {number} height - é«åº¦ã
     * @return {Object} image shapeã
     */
    shapeToImage(e, width, height) {
        var id = Util.createUniqueID("SuperMap.LevelRenderer.ToImage_");
        return this.painter.shapeToImage(id, e, width, height);
    }

    /**
     * @function LevelRenderer.Render.prototype.on
     * @description äºä»¶ç»å®ã
     *
     * @param {string} eventName - äºä»¶åç§°ã
     * @param {function} eventHandler - ååºå½æ°ã
     * @return {LevelRenderer.Render} thisã
     */
    on(eventName, eventHandler) {
        this.handler.on(eventName, eventHandler);
        return this;
    }

    /**
     * @function LevelRenderer.Render.prototype.un
     * @description äºä»¶è§£ç»å®ï¼åæ°ä¸ºç©ºåè§£ç»ææèªå®ä¹äºä»¶ã
     *
     * @param {string} eventName - äºä»¶åç§°ã
     * @param {function} eventHandler - ååºå½æ°ã
     * @return {LevelRenderer.Render} thisã
     */
    un(eventName, eventHandler) {
        this.handler.un(eventName, eventHandler);
        return this;
    }

    /**
     * @function LevelRenderer.Render.prototype.trigger
     * @description  äºä»¶è§¦åã
     *
     * @param {string} eventName - äºä»¶åç§°ï¼resizeï¼hoverï¼dragï¼etcã
     * @param {event} event - event domäºä»¶å¯¹è±¡ã
     * @return {LevelRenderer.Render} thisã
     */
    trigger(eventName, event) {
        this.handler.trigger(eventName, event);
        this.handler.dispatch(eventName, event);
        return this;
    }

    /**
     * @function LevelRenderer.Render.prototype.clear
     * @description æ¸é¤å½å Render ä¸ææç±»å¾çæ°æ®åæ¾ç¤ºï¼clear å MVC åå·²ç»å®äºä»¶åè¿å­å¨å¨ï¼Render å¯ç¨ã
     * @return {LevelRenderer.Render} thisã
     */
    clear() {
        this.storage.delRoot();
        this.painter.clear();
        return this;
    }

    /**
     * @function LevelRenderer.Render.prototype.dispose
     * @description éæ¾å½å Render å®ä¾ï¼å é¤åæ¬ domï¼æ°æ®ãæ¾ç¤ºåäºä»¶ç»å®ï¼ï¼disposeå Render ä¸å¯ç¨ã
     */
    dispose() {
        this.animation.stop();

        this.clear();
        this.storage.dispose();
        this.painter.dispose();
        this.handler.dispose();

        this.animation = null;
        this.animatingElements = null;
        this.storage = null;
        this.painter = null;
        this.handler = null;

        // éæ¾ååè¯å¨å±å é¤å¯¹èªå·±çç´¢å¼ï¼æ²¡æ³å°å¥å¥½æ¹æ³
        // zrender.delInstance(this.id);

    }

    // SMIC-æ¹æ³æ©å± - start
    /**
     * @function LevelRenderer.Render.prototype.updateHoverShapes
     * @description æ´æ°è®¾ç½®æ¾ç¤ºé«äº®å¾å±ã
     *
     * @param {Array.<LevelRenderer.Shape>} shapes - å¾å½¢æ°ç»ã
     * @return {LevelRenderer.Render} thisã
     */
    updateHoverShapes(shapes) {
        this.painter.updateHoverLayer(shapes);
        return this;
    }

    /**
     * @function LevelRenderer.Render.prototype.getAllShapes
     * @description è·åææå¾å½¢ã
     * @return {Array.<LevelRenderer.Shape>} å¾å½¢æ°ç»ã
     */
    getAllShapes() {
        return this.storage._shapeList;
    }

    /**
     * @function LevelRenderer.Render.prototype.clearAll
     * @description æ¸é¤é«äº®åå¾å½¢å¾å±ã
     * @return {LevelRenderer.Render} thisã
     */
    clearAll() {
        this.clear();
        this.painter.clearHover();
        return this;
    }

    /**
     * @function LevelRenderer.Render.prototype.getHoverOne
     * @description è·ååä¸ªé«äº®å¾å½¢ï¼å½åé¼ æ å¯¹åºã
     * @return {LevelRenderer.Shape} é«äº®å¾å½¢ã
     */
    getHoverOne() {
        return this.handler.getLastHoverOne();
    }

    static getFrameCallback(renderInstance) {
        return function () {
            var animatingElements = renderInstance.animatingElements;

            //animatingElements instanceof Array ä¸´æ¶è§£å³ destory æ¥é
            if (animatingElements instanceof Array) {
                for (var i = 0, l = animatingElements.length; i < l; i++) {
                    renderInstance.storage.mod(animatingElements[i].id);
                }

                if (animatingElements.length || renderInstance._needsRefreshNextFrame) {
                    renderInstance.refresh();
                }
            }
        };
    }

    // SMIC-æ¹æ³æ©å± - end


}

;// CONCATENATED MODULE: ./src/common/overlay/levelRenderer/LevelRenderer.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class  LevelRenderer
 * @deprecatedclass SuperMap.LevelRenderer
 * @category Visualization Theme
 * @classdesc LevelRenderer æ¸²æå¨
 * @example
 * //å¨æ¸²æå¨ä¸å ä¸å¾å½¢
 * var levelRenderer = new LevelRenderer();
 * var zr = levelRenderer.init(document.getElementById('lRendertest'));
 * zr.clear();
 * zr.addShape(new LevelRenderer.Shape.Circle({
 *     style:{
 *         x : 100,
 *         y : 100,
 *         r : 50,
 *         brushType: 'fill'
 *     }
 * }));
 * zr.render();
 * @private
 */
class LevelRenderer {
    constructor() {
        /**
         * @member {Object} LevelRenderer.prototype._instances
         * @description LevelRenderer å®ä¾ map ç´¢å¼
         */
        LevelRenderer._instances = {};

        // å·¥å·
        LevelRenderer.Tool = {};

        /**
         * @member {string} LevelRenderer.prototype.version
         * @description çæ¬ãzRenderï¼Baiduï¼ççæ¬å·
         *              è®°å½å½å LevelRenderer æ¯å¨ zRender çé£ä¸ªçæ¬ä¸æå»ºèæ¥ã
         *              å¨æ¯æ¬¡å®æ´è¯å¤åå®æ½ç± zRenderï¼Baiduï¼åçº§å¸¦æ¥ç LevelRenderer åçº§åä¿®æ¹ã
         */
        this.version = '2.0.4';

        this.CLASS_NAME = "SuperMap.LevelRenderer";

    }

    /**
     * @function LevelRenderer.prototype.destroy
     * @description éæ¯å¯¹è±¡ï¼éæ¾èµæºãè°ç¨æ­¤å½æ°åææå±æ§å°è¢«ç½®ä¸ºnullã
     */
    destroy() {
        this.dispose();
        this.version = null;
    }

    /**
     * @function LevelRenderer.prototype.init
     * @description åå»º LevelRenderer å®ä¾ã
     * @param {HTMLElement} dom - ç»å¾å®¹å¨ã
     * @returns {LevelRenderer} LevelRenderer å®ä¾ã
     */
    init(dom) {
        var zr = new Render(Util.createUniqueID("LRenderer_"), dom);
        LevelRenderer._instances[zr.id] = zr;
        return zr;
    }

    /**
     * @function LevelRenderer.prototype.dispose
     * @description LevelRenderer å®ä¾éæ¯ã
     *              å¯ä»¥éè¿ zrender.dispose(zr) éæ¯æå® LevelRenderer.Render å®ä¾ã
     *              ä¹å¯ä»¥éè¿ zr.dispose() ç´æ¥éæ¯
     * @param {LevelRenderer.Render} zr - ZRenderå¯¹è±¡ï¼ä¸ä¼ æ­¤åæ°åéæ¯å¨é¨ã
     * @returns {LevelRenderer} thisã
     */
    dispose(zr) {
        if (zr) {
            zr.dispose();
            this.delInstance(zr.id);
        } else {
            for (var key in LevelRenderer._instances) {
                LevelRenderer._instances[key].dispose();
            }
            LevelRenderer._instances = {};
        }

        return this;
    }

    /**
     * @function LevelRenderer.prototype.getInstance
     * @description è·å LevelRenderer.Render å®ä¾ã
     * @param {string} id - ZRenderå¯¹è±¡ç´¢å¼ã
     * @returns {LevelRenderer.Render} LevelRenderer.Render å®ä¾ã
     */
    getInstance(id) {
        return LevelRenderer._instances[id];
    }

    /**
     * @function LevelRenderer.prototype.delInstance
     * @description å é¤ zrender å®ä¾ï¼LevelRenderer.Render å®ä¾ dispose æ¶ä¼è°ç¨ï¼å é¤å getInstance åè¿å undefined
     * @param {string} id - ZRenderå¯¹è±¡ç´¢å¼ã
     * @param {string} id - LevelRenderer.Render å¯¹è±¡ç´¢å¼ã
     * @returns {LevelRenderer} thisã
     */
    delInstance(id) {
        delete LevelRenderer._instances[id];
        return this;
    }

}

;// CONCATENATED MODULE: ./src/common/overlay/levelRenderer/SmicEllipse.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @private
 * @class  LevelRenderer.Shape.SmicEllipse
 * @category Visualization Theme
 * @classdesc æ¤­åã
 * @extends LevelRenderer.Shape
 * @example
 *   var shape = new LevelRenderer.Shape.SmicEllipse({
 *       style: {
 *           x: 100,
 *           y: 100,
 *           a: 40,
 *           b: 20,
 *           brushType: 'both',
 *           color: 'blue',
 *           strokeColor: 'red',
 *           lineWidth: 3,
 *           text: 'SmicEllipse'
 *       }
 *   });
 *   levelRenderer.addShape(shape);
 * @param {Array} options - shape çéç½®ï¼optionsï¼é¡¹ï¼å¯ä»¥æ¯ shape çèªæå±æ§ï¼ä¹å¯ä»¥æ¯èªå®ä¹çå±æ§ã
 *
 */
class SmicEllipse extends (/* unused pure expression or super */ null && (Shape)) {
    constructor(options) {
        super(options);

        /**
         * @member {string} LevelRenderer.Shape.SmicEllipse.prototype.type
         * @description å¾å½¢ç±»åã
         */
        this.type = 'smicellipse';

        if (!this.refOriginalPosition || this.refOriginalPosition.length !== 2) {
            this.refOriginalPosition = [0, 0];
        }

        this.CLASS_NAME = "SuperMap.LevelRenderer.Shape.SmicEllipse";
    }


    /**
     * @function LevelRenderer.Shape.SmicEllipse.prototype.destroy
     * @description éæ¯å¯¹è±¡ï¼éæ¾èµæºãè°ç¨æ­¤å½æ°åææå±æ§å°è¢«ç½®ä¸º nullã
     */
    destroy() {
        this.type = null;
        super.destroy();
    }


    /**
     * @function LevelRenderer.Shape.SmicEllipse.prototype.buildPath
     * @description æå»ºæ¤­åç Pathã
     *
     * @param {CanvasRenderingContext2D} ctx - Context2D ä¸ä¸æã
     * @param {Object} style - styleã
     *
     */
    buildPath(ctx, style) {
        if (!this.refOriginalPosition || this.refOriginalPosition.length !== 2) {
            this.refOriginalPosition = [0, 0];
        }
        var __OP = this.refOriginalPosition;

        var k = 0.5522848;
        var x = style.x + __OP[0];
        var y = style.y + __OP[1];
        var a = style.a;
        var b = style.b;
        var ox = a * k; // æ°´å¹³æ§å¶ç¹åç§»é
        var oy = b * k; // åç´æ§å¶ç¹åç§»é
        // ä»æ¤­åçå·¦ç«¯ç¹å¼å§é¡ºæ¶éç»å¶åæ¡ä¸æ¬¡è´å¡å°æ²çº¿
        ctx.moveTo(x - a, y);
        ctx.bezierCurveTo(x - a, y - oy, x - ox, y - b, x, y - b);
        ctx.bezierCurveTo(x + ox, y - b, x + a, y - oy, x + a, y);
        ctx.bezierCurveTo(x + a, y + oy, x + ox, y + b, x, y + b);
        ctx.bezierCurveTo(x - ox, y + b, x - a, y + oy, x - a, y);
        ctx.closePath();
    }


    /**
     * @function LevelRenderer.Shape.SmicEllipse.prototype.getRect
     * @description è®¡ç®è¿åæ¤­ååå´çç©å½¢
     *
     * @param {Object} style - style
     * @return {Object} è¾¹æ¡å¯¹è±¡ãåå«å±æ§ï¼xï¼yï¼widthï¼heightã
     *
     */
    getRect(style) {
        if (style.__rect) {
            return style.__rect;
        }

        if (!this.refOriginalPosition || this.refOriginalPosition.length !== 2) {
            this.refOriginalPosition = [0, 0];
        }
        var __OP = this.refOriginalPosition;

        var lineWidth;
        if (style.brushType == 'stroke' || style.brushType == 'fill') {
            lineWidth = style.lineWidth || 1;
        } else {
            lineWidth = 0;
        }
        style.__rect = {
            x: Math.round((style.x + __OP[0]) - style.a - lineWidth / 2),
            y: Math.round((style.x + __OP[1]) - style.b - lineWidth / 2),
            width: style.a * 2 + lineWidth,
            height: style.b * 2 + lineWidth
        };

        return style.__rect;
    }

}

;// CONCATENATED MODULE: ./src/common/overlay/levelRenderer/SmicIsogon.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @private
 * @class  LevelRenderer.Shape.SmicIsogon
 * @category Visualization Theme
 * @classdesc æ­£å¤è¾¹å½¢ã
 * @extends LevelRenderer.Shape
 * @param {Array} options - shape çéç½®ï¼optionsï¼é¡¹ï¼å¯ä»¥æ¯ shape çèªæå±æ§ï¼ä¹å¯ä»¥æ¯èªå®ä¹çå±æ§ã
 */
class SmicIsogon extends (/* unused pure expression or super */ null && (Shape)) {
    constructor(options) {
        super(options);
        /**
         * @member {string} LevelRenderer.Shape.SmicIsogon.prototype.type
         * @description å¾å½¢ç±»åã
         */
        this.type = 'smicisogon';
        if (!this.refOriginalPosition || this.refOriginalPosition.length !== 2) {
            this.refOriginalPosition = [0, 0];
        }
        this.CLASS_NAME = "SuperMap.LevelRenderer.Shape.SmicIsogon";
    }


    /**
     * @function LevelRenderer.Shape.SmicIsogon.prototype.destroy
     * @description éæ¯å¯¹è±¡ï¼éæ¾èµæºãè°ç¨æ­¤å½æ°åææå±æ§å°è¢«ç½®ä¸º nullã
     */
    destroy() {
        this.type = null;
        super.destroy();
    }


    /**
     * @function LevelRenderer.Shape.SmicIsogon.prototype.buildPath
     * @description åå»ºnè§æï¼n>=3ï¼è·¯å¾ã
     *
     * @param {CanvasRenderingContext2D} ctx - Context2D ä¸ä¸æã
     * @param {Object} style - styleã
     *
     */
    buildPath(ctx, style) {
        if (!this.refOriginalPosition || this.refOriginalPosition.length !== 2) {
            this.refOriginalPosition = [0, 0];
        }
        var __OP = this.refOriginalPosition;

        var sin = SUtil.Util_math.sin;
        var cos = SUtil.Util_math.cos;
        var PI = Math.PI;

        var n = style.n;
        if (!n || n < 2) {
            return;
        }

        var x = style.x + __OP[0];
        var y = style.y + __OP[1];
        var r = style.r;

        var dStep = 2 * PI / n;
        var deg = -PI / 2;
        var xStart = x + r * cos(deg);
        var yStart = y + r * sin(deg);
        deg += dStep;

        // è®°å½è¾¹çç¹ï¼ç¨äºå¤æ­insight
        var pointList = style.pointList = [];
        pointList.push([xStart, yStart]);
        for (let i = 0, end = n - 1; i < end; i++) {
            pointList.push([x + r * cos(deg), y + r * sin(deg)]);
            deg += dStep;
        }
        pointList.push([xStart, yStart]);

        // ç»å¶
        ctx.moveTo(pointList[0][0], pointList[0][1]);
        for (let i = 0; i < pointList.length; i++) {
            ctx.lineTo(pointList[i][0], pointList[i][1]);
        }
        ctx.closePath();

        return;
    }


    /**
     * @function LevelRenderer.Shape.SmicIsogon.prototype.getRect
     * @description è®¡ç®è¿åæ­£å¤è¾¹å½¢çåå´çç©å½¢ã
     *
     * @param {Object} style - style
     * @return {Object} è¾¹æ¡å¯¹è±¡ãåå«å±æ§ï¼xï¼yï¼widthï¼heightã
     */
    getRect(style) {
        if (style.__rect) {
            return style.__rect;
        }

        if (!this.refOriginalPosition || this.refOriginalPosition.length !== 2) {
            this.refOriginalPosition = [0, 0];
        }
        var __OP = this.refOriginalPosition;

        var lineWidth;
        if (style.brushType == 'stroke' || style.brushType == 'fill') {
            lineWidth = style.lineWidth || 1;
        } else {
            lineWidth = 0;
        }
        style.__rect = {
            x: Math.round((style.x + __OP[0]) - style.r - lineWidth / 2),
            y: Math.round((style.y + __OP[1]) - style.r - lineWidth / 2),
            width: style.r * 2 + lineWidth,
            height: style.r * 2 + lineWidth
        };

        return style.__rect;
    }

}

;// CONCATENATED MODULE: ./src/common/overlay/levelRenderer/SmicRing.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @private
 * @class  LevelRenderer.Shape.SmicRing
 * @category Visualization Theme
 * @classdesc åç¯ã
 * @extends LevelRenderer.Shape
 * @example
 *   var shape = new LevelRenderer.Shape.SmicRing({
 *         style: {
 *             x: 100,
 *             y: 100,
 *             r0: 30,
 *             r: 50
 *         }
 *     });
 *   levelRenderer.addShape(shape);
 * @param {Array} options - shape çéç½®ï¼optionsï¼é¡¹ï¼å¯ä»¥æ¯ shape çèªæå±æ§ï¼ä¹å¯ä»¥æ¯èªå®ä¹çå±æ§ã
 */
class SmicRing extends (/* unused pure expression or super */ null && (Shape)) {
    constructor(options) {
        super(options);
        /**
         * @member {string} LevelRenderer.Shape.SmicRing.prototype.type
         * @description å¾å½¢ç±»åã
         */
        this.type = 'smicring';
        if (!this.refOriginalPosition || this.refOriginalPosition.length !== 2) {
            this.refOriginalPosition = [0, 0];
        }
        this.CLASS_NAME = "SuperMap.LevelRenderer.Shape.SmicRing";

    }


    /**
     * @function LevelRenderer.Shape.SmicRing.prototype.destroy
     * @description éæ¯å¯¹è±¡ï¼éæ¾èµæºãè°ç¨æ­¤å½æ°åææå±æ§å°è¢«ç½®ä¸º nullã
     */
    destroy() {
        this.type = null;
        super.destroy();
    }


    /**
     * @function LevelRenderer.Shape.SmicRing.prototype.buildPath
     * @description åå»ºåç¯è·¯å¾ã
     *
     * @param {CanvasRenderingContext2D} ctx - Context2D ä¸ä¸æã
     * @param {Object} style - styleã
     *
     */
    buildPath(ctx, style) {
        if (!this.refOriginalPosition || this.refOriginalPosition.length !== 2) {
            this.refOriginalPosition = [0, 0];
        }
        var __OP = this.refOriginalPosition;

        // éé¶ç¯ç»å¡«åä¼å
        ctx.arc(style.x + __OP[0], style.y + __OP[1], style.r, 0, Math.PI * 2, false);
        ctx.moveTo((style.x + __OP[0]) + style.r0, style.y + __OP[1]);
        ctx.arc(style.x + __OP[0], style.y + __OP[1], style.r0, 0, Math.PI * 2, true);
        return;
    }


    /**
     * @function LevelRenderer.Shape.SmicRing.prototype.getRect
     * @description è®¡ç®è¿ååç¯åå´çç©éµ
     *
     * @param {Object} style - style
     * @return {Object} è¾¹æ¡å¯¹è±¡ãåå«å±æ§ï¼xï¼yï¼widthï¼heightã
     */
    getRect(style) {
        if (style.__rect) {
            return style.__rect;
        }

        if (!this.refOriginalPosition || this.refOriginalPosition.length !== 2) {
            this.refOriginalPosition = [0, 0];
        }
        var __OP = this.refOriginalPosition;

        var lineWidth;
        if (style.brushType == 'stroke' || style.brushType == 'fill') {
            lineWidth = style.lineWidth || 1;
        } else {
            lineWidth = 0;
        }
        style.__rect = {
            x: Math.round((style.x + __OP[0]) - style.r - lineWidth / 2),
            y: Math.round((style.y + __OP[1]) - style.r - lineWidth / 2),
            width: style.r * 2 + lineWidth,
            height: style.r * 2 + lineWidth
        };

        return style.__rect;
    }

}

;// CONCATENATED MODULE: ./src/common/overlay/levelRenderer/SmicStar.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @private
 * @class  LevelRenderer.Shape.SmicStar
 * @category Visualization Theme
 * @classdesc n è§æï¼n>3ï¼ã
 * @extends LevelRenderer.Shape
 * @example
 *   var shape = new LevelRenderer.Shape.SmicStar({
 *         style: {
 *             x: 200,
 *             y: 100,
 *             r: 150,
 *             n: 5,
 *             text: 'äºè§æ'
 *         }
 *   });
 *   levelRenderer.addShape(shape);
 * @param {Array} options - shape çéç½®ï¼optionsï¼é¡¹ï¼å¯ä»¥æ¯ shape çèªæå±æ§ï¼ä¹å¯ä»¥æ¯èªå®ä¹çå±æ§ã
 *
 */
class SmicStar extends (/* unused pure expression or super */ null && (Shape)) {
    constructor(options) {
        super(options);
        /**
         * @member {string} LevelRenderer.Shape.SmicStar.prototype.type
         * @description å¾å½¢ç±»åã
         */
        this.type = 'smicstar';

        if (!this.refOriginalPosition || this.refOriginalPosition.length !== 2) {
            this.refOriginalPosition = [0, 0];
        }

        this.CLASS_NAME = "SuperMap.LevelRenderer.Shape.SmicStar";
    }

    /**
     * @function LevelRenderer.Shape.SmicStar.prototype.destroy
     * @description éæ¯å¯¹è±¡ï¼éæ¾èµæºãè°ç¨æ­¤å½æ°åææå±æ§å°è¢«ç½®ä¸º nullã
     */
    destroy() {
        this.type = null;
        super.destroy();
    }

    /**
     * @function LevelRenderer.Shape.SmicStar.prototype.buildPath
     * @description åå»ºn  è§æï¼n>3ï¼è·¯å¾ã
     *
     * @param {CanvasRenderingContext2D} ctx - Context2D ä¸ä¸æã
     * @param {Object} style - styleã
     *
     */
    buildPath(ctx, style) {
        if (!this.refOriginalPosition || this.refOriginalPosition.length !== 2) {
            this.refOriginalPosition = [0, 0];
        }
        var __OP = this.refOriginalPosition;

        var n = style.n;
        if (!n || n < 2) {
            return;
        }

        var sin = SUtil.Util_math.sin;
        var cos = SUtil.Util_math.cos;
        var PI = Math.PI;

        var x = style.x + __OP[0];
        var y = style.y + __OP[1];
        var r = style.r;
        var r0 = style.r0;

        // å¦ææªæå®åé¨é¡¶ç¹å¤æ¥ååå¾ï¼åèªå¨è®¡ç®
        if (r0 == null) {
            r0 = n > 4
                // ç¸éçå¤é¨é¡¶ç¹çè¿çº¿çäº¤ç¹ï¼
                // è¢«åä¸ºåé¨äº¤ç¹ï¼ä»¥æ­¤è®¡ç®r0
                ? r * cos(2 * PI / n) / cos(PI / n)
                // äºä¸åè§æçç¹æ®å¤ç
                : r / 3;
        }

        var dStep = PI / n;
        var deg = -PI / 2;
        var xStart = x + r * cos(deg);
        var yStart = y + r * sin(deg);
        deg += dStep;

        // è®°å½è¾¹çç¹ï¼ç¨äºå¤æ­inside
        var pointList = style.pointList = [];
        pointList.push([xStart, yStart]);
        for (var i = 0, end = n * 2 - 1, ri; i < end; i++) {
            ri = i % 2 === 0 ? r0 : r;
            pointList.push([x + ri * cos(deg), y + ri * sin(deg)]);
            deg += dStep;
        }
        pointList.push([xStart, yStart]);

        // ç»å¶
        ctx.moveTo(pointList[0][0], pointList[0][1]);
        for (let i = 0; i < pointList.length; i++) {
            ctx.lineTo(pointList[i][0], pointList[i][1]);
        }

        ctx.closePath();

        return;
    }

    /**
     * @function LevelRenderer.Shape.SmicStar.prototype.getRect
     * @description è¿å n è§æåå´çç©å½¢ã
     *
     * @param {Object} style - style
     * @return {Object} è¾¹æ¡å¯¹è±¡ãåå«å±æ§ï¼xï¼yï¼widthï¼heightã
     */
    getRect(style) {
        if (style.__rect) {
            return style.__rect;
        }

        if (!this.refOriginalPosition || this.refOriginalPosition.length !== 2) {
            this.refOriginalPosition = [0, 0];
        }
        var __OP = this.refOriginalPosition;

        var lineWidth;
        if (style.brushType == 'stroke' || style.brushType == 'fill') {
            lineWidth = style.lineWidth || 1;
        } else {
            lineWidth = 0;
        }
        style.__rect = {
            x: Math.round((style.x + __OP[0]) - style.r - lineWidth / 2),
            y: Math.round((style.y + __OP[1]) - style.r - lineWidth / 2),
            width: style.r * 2 + lineWidth,
            height: style.r * 2 + lineWidth
        };

        return style.__rect;
    }

}

;// CONCATENATED MODULE: ./src/common/overlay/levelRenderer/index.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/













































































;// CONCATENATED MODULE: ./src/common/overlay/index.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


























;// CONCATENATED MODULE: ./src/common/components/CommonTypes.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
/**
 * @description è¯¥æä»¶ç¨äºå­å¨ä¸äºå¬ç¨å¸¸é
 * @private
 */
const CommonTypes_FileTypes = {
    EXCEL: "EXCEL",
    CSV: "CSV",
    ISERVER: "ISERVER",
    GEOJSON: "GEOJSON",
    JSON: 'JSON'
};
const CommonTypes_FileConfig = {
    fileMaxSize: 10 * 1024 * 1024
};

;// CONCATENATED MODULE: ./src/common/components/openfile/FileModel.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class FileModel
 * @deprecatedclass SuperMap.FileModel
 * @description æä»¶æ°æ®ç»ä»¶æ°æ®æ¨¡åï¼ç¨äºå­å¨ä¸äºæä»¶æ°æ®æç¶æï¼todo ç»æå¾å®å
 * @category Components OpenFile
 * @private
 */
class FileModel {
    constructor(options) {
        this.FileTypes = FileTypes;
        this.FileConfig = FileConfig;
        this.loadFileObject = options && options.loadFileObject ? options.loadFileObject : [];
    }

    /**
     * @function FileModel.prototype.set
     * @description è®¾ç½®å±æ§å¼
     * @param {string} key - å±æ§åç§°
     * @param {string|Object} value - å±æ§å¼
     */
    set(key, value) {
        this[key] = value;
    }

    /**
     * @function FileModel.prototype.get
     * @description è·åæ°æ®å¼
     * @param {string} key - å±æ§åç§°
     * @returns {string|Object} value - è¿åå±æ§å¼
     */
    get(key) {
        return this[key];
    }

}

;// CONCATENATED MODULE: ./src/common/components/messagebox/MessageBox.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/

/**
 * @class MessageBox
 * @aliasclass Components.MessageBox
 * @deprecatedclass SuperMap.Components.MessageBox
 * @version 9.1.1
 * @classdesc ç»ä»¶ä¿¡æ¯æç¤ºæ¡ã
 * @category Components Common
 * @usage
 */
class MessageBox {

    constructor() {
        this._initView();
    }

    _initView() {
        //åçjså½¢å¼
        const messageBoxContainer = document.createElement("div");
        messageBoxContainer.hidden = true;
        messageBoxContainer.setAttribute("class", "component-messageboxcontainer component-border-bottom-orange");

        //å¾æ 
        const iconContainer = document.createElement("div");
        iconContainer.setAttribute("class", "icon");
        this.icon = document.createElement("span");
        this.icon.setAttribute("class", "supermapol-icons-message-warning");
        iconContainer.appendChild(this.icon);
        messageBoxContainer.appendChild(iconContainer);

        //åå®¹ï¼
        const messageBox = document.createElement("div");
        messageBox.setAttribute("class", "component-messagebox");
        messageBox.innerHTML = "";
        messageBoxContainer.appendChild(messageBox);
        this.messageBox = messageBox;

        //å³é­æé®
        const cancelContainer = document.createElement("div");
        cancelContainer.setAttribute("class", "component-messagebox__cancelbtncontainer");
        const cancelBtn = document.createElement("button");
        cancelBtn.setAttribute("class", "component-messagebox__cancelBtn");
        cancelBtn.innerHTML = "x";
        cancelBtn.onclick = this.closeView.bind(this);
        cancelContainer.appendChild(cancelBtn);
        messageBoxContainer.appendChild(cancelContainer);

        this.messageBoxContainer = messageBoxContainer;
        document.body.appendChild(this.messageBoxContainer);
    }

    /**
     * @function MessageBox.prototype.closeView
     * @description å³é­æç¤ºæ¡ã
     */
    closeView() {
        this.messageBoxContainer.hidden = true;
    }

    /**
     * @function MessageBox.prototype.showView
     * @description æ¾ç¤ºæç¤ºæ¡ã
     * @param {string} message - æç¤ºæ¡æ¾ç¤ºåå®¹ã
     * @param {string}[type="warring"] æç¤ºæ¡ç±»åï¼å¦ "warring", "failure", "success"ã
     */
    showView(message, type = 'warring') {
        //è®¾ç½®æç¤ºæ¡çæ ·å¼ï¼
        if (type === "success") {
            this.icon.setAttribute("class", "supermapol-icons-message-success");
            this.messageBoxContainer.setAttribute("class", "component-messageboxcontainer component-border-bottom-green");

        } else if (type === "failure") {
            this.icon.setAttribute("class", "supermapol-icons-message-failure");
            this.messageBoxContainer.setAttribute("class", "component-messageboxcontainer component-border-bottom-red");
        } else if (type === "warring") {
            this.icon.setAttribute("class", "supermapol-icons-message-warning");
            this.messageBoxContainer.setAttribute("class", "component-messageboxcontainer component-border-bottom-orange");
        }
        this.messageBox.innerHTML = message;
        this.messageBoxContainer.hidden = false;
    }
}

;// CONCATENATED MODULE: external "function(){try{return echarts}catch(e){return {}}}()"
const external_function_try_return_echarts_catch_e_return_namespaceObject = function(){try{return echarts}catch(e){return {}}}();
var external_function_try_return_echarts_catch_e_return_default = /*#__PURE__*/__webpack_require__.n(external_function_try_return_echarts_catch_e_return_namespaceObject);
;// CONCATENATED MODULE: ./src/common/lang/locales/en-US.js
ï»¿
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
/**
 * Namespace: SuperMap.Lang["en"]
 * Dictionary for English.  Keys for entries are used in calls to
 *     <SuperMap.Lang.translate>.  Entry bodies are normal strings or
 *     strings formatted for use with <SuperMap.String.format> calls.
 */
let en = {
    'title_dataFlowService': 'Data Flow Service',
    'title_distributedAnalysis': 'Distributed Analysis',
    'title_clientComputing': 'Client Computing',
    'title_dataServiceQuery': 'Data Service Query',
    'title_searchCity':'Search city',
    'title_searchLayer':' Search layer',

    'text_input_value_inputDataFlowUrl': 'Please enter the data stream service address such as: ws://{serviceRoot}/{dataFlowName}/dataflow/subscribe',
    'text_displayFeaturesInfo': 'Display feature information',
    'text_subscribe': 'subscribe',
    'text_cancelSubscribe': 'unsubscribe',

    'text_densityAnalysis': 'Density Analysis',
    'text_CalculateTheValuePerUnitArea': 'Calculate the value per unit area within the neighborhood shape',
    'text_option_selectDataset':'Please select a dataset',
    'text_label_dataset': 'Dataset',
    'text_option_simplePointDensityAnalysis': 'Simple point density analysis',
    'text_option_nuclearDensityAnalysis': 'Nuclear density analysis',
    'text_label_analyticalMethod': 'Analytical method',
    'text_option_quadrilateral': 'Quadrilateral',
    'text_option_hexagon': 'hexagon',
    'text_label_meshType': 'Mesh type',
    'text_option_notSet': 'Not set',
    'text_label_weightField': 'Weight field',
    'text_label_gridSizeInMeters': 'Grid size',
    'text_label_searchRadius': 'Search radius',
    'text_label_queryRange': 'Scope of analysis',
    'text_label_areaUnit': 'Area unit',
    'text_option_equidistantSegmentation': 'Equidistant segmentation',
    'text_option_logarithm': 'Logarithm',
    'text_option_equalCountingSegment': 'Equal counting segment',
    'text_option_squareRootSegmentation': 'Square root segmentation',
    'text_label_thematicMapSegmentationMode': 'Thematic map segmentation mode',
    'text_label_thematicMapSegmentationParameters': 'Thematic map segmentation parameters',
    'text_option_greenOrangePurpleGradient': 'Green orange purple gradient',
    'text_option_greenOrangeRedGradient': 'Green orange red gradient',
    'text_option_rainbowGradient': 'Rainbow gradient',
    'text_option_spectralGradient': 'Spectral gradient',
    'text_option_terrainGradient': 'Terrain gradient',
    'text_label_thematicMapColorGradientMode': 'Thematic map color gradient mode',
    'text_label_resultLayerName': 'Result layer name',
    'text_chooseFile': 'Open File',
    'text_isoline': 'Isoline',
    'text_extractDiscreteValue': 'Extract discrete value generation curve',
    'text_buffer': 'Buffer',
    'text_specifyTheDistance': 'Specify the distance to create the surrounding area',
    'text_label_analysisLayer': 'Analysis layer',
    'text_label_extractField': 'Extract field',
    'text_label_extractedValue': 'Extracted value',
    'text_label_distanceAttenuation': 'Distance attenuation',
    'text_label_gridSize': 'gridSize',
    'text_label_bufferRadius': 'Buffer radius',
    'text_label_defaultkilometers': 'Default 10 kilometers',
    'text_label_kilometer': 'kilometer',
    'text_label_unit': 'unit',
    'text_retainOriginal': 'Retain original object field',
    'text_mergeBuffer': 'Merge buffer',
    'text_label_color': 'Color',
    'text_label_buffer': '[Buffer]',
    'text_label_isolines': '[Isolines]',
    'text_label_queryRangeTips': 'The default is the full range of input data. Example: -74.050, 40.650, -73.850, 40.850',
    'text_label_queryModel': 'Query mode',
    'text_label_IDArrayOfFeatures': 'ID array of features',
    'text_label_maxFeatures': 'The maximum number of features that can be returned',
    'text_label_bufferDistance': 'Buffer distance',
    'text_label_queryRange1': 'Query range',
    'text_label_spatialQueryMode': 'Spatial query mode',
    'text_label_featureFilter': 'Feature filter',
    'text_label_geometricObject': 'Geometric object',
    'text_label_queryMode': 'Query mode',
    'text_label_searchTips': 'Search for city locations or layer features',
    'text_label_chooseSearchLayers': 'Select a query layer',
    'text_loadSearchCriteria': 'Load search criteria',
    'text_saveSearchCriteria': 'Save search criteria',

    "btn_analyze": "Analyze",
    "btn_analyzing": "Analyzing",
    "btn_emptyTheAnalysisLayer": "Empty the analysis layer",
    "btn_cancelAnalysis": "Cancel",
    "btn_query": "Query",
    "btn_querying": "Querying",
    "btn_emptyTheRresultLayer": "Clear all result layers",

    'msg_dataReturnedIsEmpty.': 'The request is successful and the data returned by the query is empty.',
    'msg_dataFlowServiceHasBeenSubscribed': 'The data stream service has been subscribed to.',
    'msg_inputDataFlowUrlFirst': 'Please enter the data stream service address first.',
    'msg_datasetOrMethodUnsupport': 'This dataset does not support this analysis type. Please reselect the dataset.',
    'msg_selectDataset': 'Please select a data set!',
    'msg_setTheWeightField': 'Please set the weight field!',
    'msg_theFieldNotSupportAnalysis': 'The field you currently select does not support analysis!',
    'msg_resultIsEmpty': 'The result of the analysis is empty!',
    'msg_openFileFail': 'Failed to open file!',
    'msg_fileTypeUnsupported': 'File format is not supported!',
    'msg_fileSizeExceeded': 'File size exceeded! The file size should not exceed 10M!',
    'msg_dataInWrongGeoJSONFormat': 'Wrong data format! Non standard GEOJSON format data!',
    'msg_dataInWrongFormat': 'Wrong data format! Non standard EXCEL, CSV or GEOJSON format data!',
    'msg_searchKeywords': "Search keywords cannot be empty. Please enter your search criteria.",
    'msg_searchGeocodeField':"Did not match the address matching service data!",
    'msg_cityGeocodeField':"The address matching service of the current city is not configured.",
    'msg_getFeatureField':"No related vector features found!",
    'msg_dataflowservicesubscribed':'The data stream service has been subscribed to.',
    'msg_subscribesucceeded':'The data stream service subscription was successful.',
    'msg_crsunsupport':'Does not support the coordinate system of the current map',
    'msg_tilematrixsetunsupport':'Incoming TileMatrixSet is not supported',
    'msg_jsonResolveFiled': 'JSON format parsing failureï¼',
    'msg_requestContentFiled': 'Failed to request data through iportal!',
    'msg_getdatafailed': 'Failed to get data!'

};



;// CONCATENATED MODULE: ./src/common/lang/locales/zh-CN.js
ï»¿/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/

/**
 * Namespace: SuperMap.Lang["zh-CN"]
 * Dictionary for Simplified Chinese.  Keys for entries are used in calls to
 *     <SuperMap.Lang.translate>.  Entry bodies are normal strings or
 *     strings formatted for use with <SuperMap.String.format> calls.
 */
let zh = {
    'title_dataFlowService': 'æ°æ®æµæå¡',
    'title_distributedAnalysis': 'åå¸å¼åæ',
    'title_clientComputing': 'å®¢æ·ç«¯è®¡ç®',
    'title_dataServiceQuery': 'æ°æ®æå¡æ¥è¯¢',
    'title_searchCity':'æç´¢åå¸',
    'title_searchLayer':'æç´¢å¾å±',

    'text_input_value_inputDataFlowUrl': 'è¯·è¾å¥æ°æ®æµæå¡å°åå¦:ws://{serviceRoot}/{dataFlowName}/dataflow/subscribe',
    'text_displayFeaturesInfo': 'æ¾ç¤ºè¦ç´ ä¿¡æ¯',
    'text_subscribe': 'è®¢é',
    'text_cancelSubscribe': 'åæ¶è®¢é',
    
    'text_densityAnalysis': 'å¯åº¦åæ',
    'text_CalculateTheValuePerUnitArea': 'è®¡ç®ç¹æå®é»åå½¢ç¶åçæ¯åä½é¢ç§¯éå¼',
    'text_option_selectDataset':'è¯·éæ©æ°æ®é',
    'text_label_dataset': 'æ°æ®é',
    'text_option_simplePointDensityAnalysis': 'ç®åç¹å¯åº¦åæ',
    'text_option_nuclearDensityAnalysis': 'æ ¸å¯åº¦åæ',
    'text_label_analyticalMethod': 'åææ¹æ³',
    'text_option_quadrilateral': 'åè¾¹å½¢',
    'text_option_hexagon': 'å­è¾¹å½¢',
    'text_label_meshType': 'ç½æ ¼é¢ç±»å',
    'text_option_notSet': 'æªè®¾ç½®',
    'text_label_weightField': 'æéå­æ®µ',
    'text_label_gridSizeInMeters': 'ç½æ ¼å¤§å°',
    'text_label_searchRadius': 'æç´¢åå¾',
    'text_label_queryRange': 'åæèå´',
    'text_label_areaUnit': 'é¢ç§¯åä½',
    'text_option_equidistantSegmentation': 'ç­è·ç¦»åæ®µ',
    'text_option_logarithm': 'å¯¹æ°',
    'text_option_equalCountingSegment': 'ç­è®¡æ°åæ®µ',
    'text_option_squareRootSegmentation': 'å¹³æ¹æ ¹åæ®µ',
    'text_label_thematicMapSegmentationMode': 'ä¸é¢å¾åæ®µæ¨¡å¼',
    'text_label_thematicMapSegmentationParameters': 'ä¸é¢å¾åæ®µåæ°',
    'text_option_greenOrangePurpleGradient': 'ç»¿æ©ç´«æ¸å',
    'text_option_greenOrangeRedGradient': 'ç»¿æ©çº¢æ¸å',
    'text_option_rainbowGradient': 'å½©è¹æ¸å',
    'text_option_spectralGradient': 'åè°±æ¸å',
    'text_option_terrainGradient': 'å°å½¢æ¸å',
    'text_label_thematicMapColorGradientMode': 'ä¸é¢å¾é¢è²æ¸åæ¨¡å¼',
    'text_label_resultLayerName': 'ç»æå¾å±åç§°',
    'text_chooseFile': 'éæ©æä»¶',
    'text_isoline': 'ç­å¼çº¿',
    'text_extractDiscreteValue': 'æåç¦»æ£å¼çææ²çº¿',
    'text_buffer': 'ç¼å²åº',
    'text_specifyTheDistance': 'æå®è·ç¦»åå»ºå¨è¾¹åºå',
    'text_label_analysisLayer': 'åæå¾å±',
    'text_label_extractField': 'æåå­æ®µ',
    'text_label_extractedValue': 'æåå¼',
    'text_label_distanceAttenuation': 'è·ç¦»è¡°å',
    'text_label_gridSize': 'æ æ ¼å¤§å°',
    'text_label_bufferRadius': 'ç¼å²åå¾',
    'text_label_defaultkilometers': 'é»è®¤10åç±³',
    'text_option_kilometer': 'åç±³',
    'text_label_unit': 'åä½',
    'text_retainOriginal': 'ä¿çåå¯¹è±¡å­æ®µå±æ§',
    'text_mergeBuffer': 'åå¹¶ç¼å²åº',
    'text_label_color': 'é¢è²',
    'text_label_buffer': '[ç¼å²åº]',
    'text_label_isolines': '[ç­å¼çº¿]',
    'text_label_queryRangeTips': 'é»è®¤ä¸ºè¾å¥æ°æ®çå¨å¹èå´ãèä¾ï¼-74.050,40.650,-73.850,40.850',
    'text_label_IDArrayOfFeatures': 'è¦ç´  ID æ°ç»',
    'text_label_maxFeatures': 'æå¤å¯è¿åçè¦ç´ æ°é',
    'text_label_bufferDistance': 'ç¼å²åºè·ç¦»',
    'text_label_queryRange1': 'æ¥è¯¢èå´',
    'text_label_spatialQueryMode': 'ç©ºé´æ¥è¯¢æ¨¡å¼',
    'text_label_featureFilter': 'è¦ç´ è¿æ»¤å¨',
    'text_label_geometricObject': 'å ä½å¯¹è±¡',
    'text_label_queryMode': 'æ¥è¯¢æ¨¡å¼',
    'text_label_searchTips': 'æç´¢åå¸å°ç¹æå¾å±è¦ç´ ',
    'text_label_chooseSearchLayers': 'éæ©æ¥è¯¢å¾å±',
    'text_loadSearchCriteria': 'å è½½æç´¢æ¡ä»¶',
    'text_saveSearchCriteria': 'ä¿å­æç´¢æ¡ä»¶',


    "btn_analyze": "åæ",
    "btn_analyzing": "åæä¸­",
    "btn_emptyTheAnalysisLayer": "æ¸ç©ºåæå¾å±",
    "btn_cancelAnalysis": "åæ¶",
    "btn_query": "æ¥è¯¢",
    "btn_querying": "æ¥è¯¢ä¸­",
    "btn_emptyTheRresultLayer": "æ¸é¤ææç»æå¾å±",
    

    'msg_dataFlowServiceHasBeenSubscribed': 'å·²è®¢éè¯¥æ°æ®æµæå¡ã',
    'msg_inputDataFlowUrlFirst': 'è¯·åè¾å¥æ°æ®æµæå¡å°åã',
    'msg_datasetOrMethodUnsupport': 'è¯¥æ°æ®éä¸æ¯ææ¬åæç±»åï¼è¯·éæ°éæ©æ°æ®é',
    'msg_selectDataset': 'è¯·éæ©æ°æ®éï¼',
    'msg_setTheWeightField': 'è¯·è®¾ç½®æéå­æ®µï¼',
    'msg_theFieldNotSupportAnalysis': 'æ¨å½åéæ©çå­æ®µä¸æ¯æåæï¼',
    'msg_resultIsEmpty': 'åæçç»æä¸ºç©ºï¼',
    'msg_dataReturnedIsEmpty': 'è¯·æ±æåï¼æ¥è¯¢è¿åçæ°æ®ä¸ºç©ºã',
    'msg_openFileFail': 'æå¼æä»¶å¤±è´¥ï¼',
    'msg_fileTypeUnsupported': 'ä¸æ¯æè¯¥æä»¶æ ¼å¼ï¼',
    'msg_fileSizeExceeded': 'æä»¶å¤§å°è¶éï¼æä»¶å¤§å°ä¸å¾è¶è¿ 10Mï¼',
    'msg_dataInWrongGeoJSONFormat': 'æ°æ®æ ¼å¼éè¯¯ï¼éæ åç GEOJSON æ ¼å¼æ°æ®ï¼',
    'msg_dataInWrongFormat': 'æ°æ®æ ¼å¼éè¯¯ï¼éæ åç EXCEL, CSV æ GEOJSON æ ¼å¼æ°æ®ï¼',
    'msg_searchKeywords': "æç´¢å³é®å­ä¸è½ä¸ºç©ºï¼è¯·è¾å¥æç´¢æ¡ä»¶ã",
    'msg_searchGeocodeField':"æªå¹éå°å°åå¹éæå¡æ°æ®ï¼",
    'msg_cityGeocodeField':"æªéç½®å½ååå¸çå°åå¹éæå¡ã",
    'msg_getFeatureField':"æªæ¥æ¾å°ç¸å³ç¢éè¦ç´ ï¼",
    'msg_dataflowservicesubscribed':'å·²è®¢éè¯¥æ°æ®æµæå¡ã',
    'msg_subscribesucceeded':'æ°æ®æµæå¡è®¢éæåã',
    'msg_crsunsupport':'ä¸æ¯æå½åå°å¾çåæ ç³»',
    'msg_tilematrixsetunsupport':'ä¸æ¯æä¼ å¥çTileMatrixSet',
    'msg_jsonResolveFiled': 'jsonæ ¼å¼è§£æå¤±è´¥ï¼',
    'msg_requestContentFiled': 'éè¿iportalè¯·æ±æ°æ®å¤±è´¥ï¼',
    'msg_getdatafailed': 'è·åæ°æ®å¤±è´¥ï¼'
};



;// CONCATENATED MODULE: ./src/common/lang/Lang.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
 
 
/**
 * @name Lang
 * @namespace
 * @category BaseTypes Internationalization
 * @description å½éåçå½åç©ºé´ï¼åå«å¤ç§è¯­è¨åæ¹æ³åºæ¥è®¾ç½®åè·åå½åçè¯­è¨ã
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.Lang.getCode();
 *
 *   // å¼ç¨çåæ³
 *   const result = SuperMap.Lang.getCode();
 *
 * </script>
 *
 * // ES6 Import
 * import { Lang } from '{npm}';
 * 
 * const result = Lang.getCode();
 *
 * ```
 */
let Lang = {
   'en-US': en,
   "zh-CN": zh,
    /**
     * @member {string} Lang.code
     * @description å½åæä½¿ç¨çè¯­è¨ç±»åã
     */
    code: null,

    /**
     * @member {string} [Lang.defaultCode='en-US']
     * @description é»è®¤ä½¿ç¨çè¯­è¨ç±»åã
     */
    defaultCode: "en-US",

    /**
     * @function Lang.getCode
     * @description è·åå½åçè¯­è¨ä»£ç ã
     * @returns {string} å½åçè¯­è¨ä»£ç ã
     */
    getCode: function () {
        if (!Lang.code) {
            Lang.setCode();
        }
        return Lang.code;
    },

    /**
     * @function Lang.setCode
     * @description è®¾ç½®è¯­è¨ä»£ç ã
     * @param {string} code - æ­¤åæ°éµå¾ªIETFè§èã
     */
    setCode: function () {
        var lang = this.getLanguageFromCookie();
        if (lang) {
            Lang.code = lang;
            return;
        }
        lang = Lang.defaultCode;
        if (navigator.appName === 'Netscape') {
            lang = navigator.language;
        } else {
            lang = navigator.browserLanguage;
        }
        if (lang.indexOf('zh') === 0) {
            lang = 'zh-CN';
        }
        if (lang.indexOf('en') === 0) {
            lang = 'en-US';
        }

        Lang.code = lang;
    },
    /**
     * @function Lang.getLanguageFromCookie
     * @description ä» cookie ä¸­è·åè¯­è¨ç±»åã
     */
    getLanguageFromCookie() {
        var name = 'language=';
        var ca = document.cookie.split(';');
        for (var i = 0; i < ca.length; i++) {
            var c = ca[i];
            while (c.charAt(0) === ' ') {
                c = c.substring(1)
            }
            if (c.indexOf(name) !== -1) {
                return c.substring(name.length, c.length)
            }
        }
        return "";
    },

    /**
     * @function Lang.i18n
     * @description ä»å½åè¯­è¨å­ç¬¦ä¸²çå­å¸æ¥æ¾ keyã
     * @param {string} key - å­å¸ä¸­ i18n å­ç¬¦ä¸²å¼çå³é®å­ã
     * @returns {string} å½éåçå­ç¬¦ä¸²ã
     */
    i18n: function (key) {
        var dictionary = Lang[Lang.getCode()];
        var message = dictionary && dictionary[key];
        if (!message) {
            // Message not found, fall back to message key
            message = key;
        }
        return message;
    }

};




;// CONCATENATED MODULE: external "function(){try{return XLSX}catch(e){return {}}}()"
const external_function_try_return_XLSX_catch_e_return_namespaceObject = function(){try{return XLSX}catch(e){return {}}}();
;// CONCATENATED MODULE: ./src/common/components/util/FileReaderUtil.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @name FileReaderUtil
 * @namespace
 * @category Components OpenFile
 * @description ç»ä»¶è¯»åæä»¶å·¥å·ç±»ã
 * @version 9.1.1
 * @type {{rABS: (boolean|*), rABF: (boolean|*), rAT: (boolean|*), readFile: (function(*, *=, *=, *=, *=)), readTextFile: (function(*, *=, *=, *=)), readXLSXFile: (function(*, *=, *=, *=)), processDataToGeoJson: (function(string, Object): GeoJSONObject), processExcelDataToGeoJson: (function(Object): GeoJSONObject), isXField: (function(*)), isYField: (function(*)), string2Csv: (function(*, *=))}}
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.Components.FileReaderUtil.isXField(data);
 *
 *   // å¼ç¨çåæ³
 *   const result = SuperMap.Components.FileReaderUtil.isXField(data);
 *
 * </script>
 *
 * // ES6 Import
 * import { FileReaderUtil } from '{npm}';
 *
 * const result = FileReaderUtil.isXField(data);
 * ```
 */
let FileReaderUtil = {
    rABS: typeof FileReader !== 'undefined' && FileReader.prototype && FileReader.prototype.readAsBinaryString,
    rABF: typeof FileReader !== 'undefined' && FileReader.prototype && FileReader.prototype.readAsArrayBuffer,
    rAT: typeof FileReader !== 'undefined' && FileReader.prototype && FileReader.prototype.readAsText,
    /**
     * @function FileReaderUtil.prototype.readFile
     * @description è¯»åæä»¶
     * @param {string} fileType - å½åè¯»åçæä»¶ç±»å
     *
     * @param {Object} file - è¯»ååæ¥çæä»¶åå®¹å¯¹è±¡
     * @param {function} success - è¯»åæä»¶æååè°å½æ°
     * @param {function} failed - è¯»åæä»¶å¤±è´¥åè°å½æ°
     * @param {Object} context - åè°éå®åå¯¹è±¡
     */
    readFile(fileType, file, success, failed, context) {
        if (CommonTypes_FileTypes.JSON === fileType || CommonTypes_FileTypes.GEOJSON === fileType) {
            this.readTextFile(file, success, failed, context)
        } else if (CommonTypes_FileTypes.EXCEL === fileType || CommonTypes_FileTypes.CSV === fileType) {
            this.readXLSXFile(file, success, failed, context)
        }
    },

    /**
     * @description è¯»åææ¬æä»¶
     * @param {Object} file æä»¶åå®¹å¯¹è±¡
     * @param {function} success è¯»åæä»¶æååè°å½æ°
     * @param {function} failed è¯»åæä»¶å¤±è´¥åè°å½æ°
     * @param {Object} context - åè°éå®åå¯¹è±¡
     */
    readTextFile(file, success, failed, context) {
        let reader = new FileReader();
        reader.onloadend = function (evt) {
            success && success.call(context, evt.target.result);
        };
        reader.onerror = function (error) {
            failed && failed.call(context, error)
        };
        this.rAT ? reader.readAsText(file.file, 'utf-8') : reader.readAsBinaryString(file.file);
    },

    /**
     * @description è¯»åexcelæcsvæä»¶
     * @param {Object} file æä»¶åå®¹å¯¹è±¡
     * @param {function} success è¯»åæä»¶æååè°å½æ°
     * @param {function} failed è¯»åæä»¶å¤±è´¥åè°å½æ°
     * @param {Object} context - åè°éå®åå¯¹è±¡
     */
    readXLSXFile(file, success, failed, context) {
        let reader = new FileReader();
        reader.onloadend = function (evt) {
            let xLSXData = new Uint8Array(evt.target.result);
            let workbook = external_function_try_return_XLSX_catch_e_return_namespaceObject.read(xLSXData, {type: "array"});
            try {
                if (workbook && workbook.SheetNames && workbook.SheetNames.length > 0) {
                    //ææ¶åªè¯»åç¬¬ä¸ä¸ªsheetsçåå®¹
                    let sheetName = workbook.SheetNames[0];
                    let xLSXCSVString = external_function_try_return_XLSX_catch_e_return_namespaceObject.utils.sheet_to_csv(workbook.Sheets[sheetName]);
                    success && success.call(context, xLSXCSVString);
                }
            } catch (error) {
                failed && failed.call(context, error);
            }
        };
        reader.onerror = function (error) {
            failed && failed.call(context, error)
        };
        this.rABF && reader.readAsArrayBuffer(file.file);
    },

    /**
     * @function FileReaderUtil.prototype.processDataToGeoJson
     * @description å°è¯»ååæ¥å¾æ°æ®ç»ä¸å¤çä¸º GeoJSON æ ¼å¼
     * @param {string} type - æä»¶ç±»å
     * @param {Object} data - è¯»åè¿åçæ°æ®å¯¹è±¡
     * @param {function} success - æ°æ®å¤çæåçåè°
     * @param {function} failed - æ°æ®å¤çå¤±è´¥çåè°
     * @param {Object} context - åè°éå®åå¯¹è±¡
     * @returns {GeoJSONObject} è¿åæ å GeoJSON è§èæ ¼å¼æ°æ®
     * @private
     */
    processDataToGeoJson(type, data, success, failed, context) {
        let geojson = null;
        if (type === "EXCEL" || type === "CSV") {
            geojson = this.processExcelDataToGeoJson(data);
            success && success.call(context, geojson);
        } else if (type === 'JSON' || type === 'GEOJSON') {
            let result = data;
            //geojsonãjsonæªç¥ï¼éè¿ç±»å®¹æ¥å¤æ­
            if ((typeof result) === "string") {
                result = JSON.parse(result);
            }
            if (result.type === 'ISERVER') {
                geojson = result.data.recordsets[0].features;
            } else if (result.type === 'FeatureCollection') {
                //geojson
                geojson = result;
            } else {
                //ä¸æ¯ææ°æ®
                failed && failed.call(context, Lang.i18n('msg_dataInWrongGeoJSONFormat'));
            }
            success && success.call(context, geojson);
        } else {
            failed && failed.call(context, Lang.i18n('msg_dataInWrongFormat'));
        }
    },
    /**
     * @function FileReaderUtil.prototype.processExcelDataToGeoJson
     * @description è¡¨æ ¼æä»¶æ°æ®å¤ç
     * @param {Object} data - è¯»åçè¡¨æ ¼æä»¶æ°æ®
     * @returns {GeoJSONObject} è¿åæ å GeoJSON è§èæ ¼å¼æ°æ®
     * @private
     */
    processExcelDataToGeoJson(data) {
        //å¤çä¸ºå¯¹è±¡æ ¼å¼è½¬å
        let dataContent = this.string2Csv(data);
        let fieldCaptions = dataContent.colTitles;

        //ä½ç½®å±æ§å¤ç
        let xfieldIndex = -1,
            yfieldIndex = -1;
        for (let i = 0, len = fieldCaptions.length; i < len; i++) {
            if (this.isXField(fieldCaptions[i])) {
                xfieldIndex = i;
            }
            if (this.isYField(fieldCaptions[i])) {
                yfieldIndex = i;
            }
        }
        // feature æå»ºåææ¯æåæ ç³» 4326/3857
        let features = [];
        for (let i = 0, len = dataContent.rows.length; i < len; i++) {
            let row = dataContent.rows[i];
            //if (featureFrom === "LonLat") {
            let x = Number(row[xfieldIndex]),
                y = Number(row[yfieldIndex]);

            //å±æ§ä¿¡æ¯
            let attributes = {};
            for (let index in dataContent.colTitles) {
                let key = dataContent.colTitles[index];
                attributes[key] = dataContent.rows[i][index];
            }

            //ç®åcsv åªæ¯æå¤çç¹ï¼æä»¥åçæç¹ç±»åç geojson
            let feature = {
                "type": "Feature",
                "geometry": {
                    "type": "Point",
                    "coordinates": [x, y]
                },
                "properties": attributes
            };
            features.push(feature);
        }
        return features;
    },
    /**
     * @description å¤æ­æ¯å¦å°çXåæ 
     * @param {string} data å­æ®µå
     */
    isXField(data) {
        var lowerdata = data.toLowerCase();
        return (lowerdata === "x" || lowerdata === "smx" ||
            lowerdata === "jd" || lowerdata === "ç»åº¦" || lowerdata === "ä¸ç»" || lowerdata === "longitude" ||
            lowerdata === "lot" || lowerdata === "lon" || lowerdata === "lng" || lowerdata === "xåæ ");
    },

    /**
     * @description å¤æ­æ¯å¦å°çYåæ 
     * @param {string} data å­æ®µå
     */
    isYField(data) {
        var lowerdata = data.toLowerCase();
        return (lowerdata === "y" || lowerdata === "smy" ||
            lowerdata === "wd" || lowerdata === "çº¬åº¦" || lowerdata === "åçº¬" ||
            lowerdata === "latitude" || lowerdata === "lat" || lowerdata === "yåæ ");
    },
    /**
     * @description å­ç¬¦ä¸²è½¬ä¸ºdataEditor æ¯æçcsvæ ¼å¼æ°æ®
     * @param {string} string å¾è½¬åçå­ç¬¦ä¸²
     * @param {boolean} withoutTitle æ¯å¦éè¦åæ é¢
     */
    string2Csv(string, withoutTitle) {
        // let rows = string.split('\r\n');
        let rows = string.split('\n');
        let result = {};
        if (!withoutTitle) {
            result["colTitles"] = rows[0].split(',');
        } else {
            result["colTitles"] = [];
        }
        result['rows'] = [];
        for (let i = (withoutTitle) ? 0 : 1; i < rows.length; i++) {
            rows[i] && result['rows'].push(rows[i].split(','));
        }
        return result;
    }

};



;// CONCATENATED MODULE: ./src/common/components/chart/ChartModel.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/











/**
 * @class ChartModel
 * @classdesc å¾è¡¨ç»ä»¶æ°æ®æ¨¡å
 * @private
 * @param {Object} datasets - æ°æ®æ¥æºã
 * @category Components Chart
 * @fires ChartModel#getdatafailed
 */

class ChartModel {
    constructor(datasets) {
        this.datasets = datasets;
        this.EVENT_TYPES = ['getdatafailed'];
        this.events = new Events(this, null, this.EVENT_TYPES);
    }
    /**
     * @private
     * @function ChartModel.prototype.getDatasetInfo
     * @description è·å¾æ°æ®éæ°æ®ã
     * @param {string} datasetUrl - æ°æ®éèµæºå°åã
     */
    getDatasetInfo(success) {
        let datasetUrl = this.datasets.url;
        let me = this;
        FetchRequest.get(datasetUrl)
            .then(function (response) {
                return response.json();
            })
            .then(function (results) {
                if (results.datasetInfo) {
                    let datasetInfo = results.datasetInfo;
                    me.datasetsInfo = {
                        dataSourceName: datasetInfo.dataSourceName,
                        datasetName: datasetInfo.name,
                        mapName: results.name
                    };
                    success({
                        result: me.datasetsInfo
                    });
                }
            })
            .catch(function (error) {
                console.log(error);
                me._fireFailedEvent(error);
            });
    }

    /**
     * @private
     * @function ChartModel.prototype.getDataFeatures
     * @description è¯·æ±æ°æ®éçæ°æ®ä¿¡æ¯
     * @param {Object} results - æ°æ®éä¿¡æ¯ã
     * @param {function} success - æååè°å½æ°ã
     */
    getDataFeatures(results, success) {
        let datasetsInfo = results.result;
        let getFeatureParam, getFeatureBySQLParams, getFeatureBySQLService;
        let params = {
            name: datasetsInfo.datasetName + '@' + datasetsInfo.dataSourceName
        };
        Object.assign(params, this.datasets.queryInfo);
        getFeatureParam = new FilterParameter(params);
        getFeatureBySQLParams = new GetFeaturesBySQLParameters({
            queryParameter: getFeatureParam,
            datasetNames: [datasetsInfo.dataSourceName + ':' + datasetsInfo.datasetName],
            fromIndex: 0,
            toIndex: 100000
        });
        getFeatureBySQLService = new GetFeaturesBySQLService(datasetsInfo.dataUrl, {
            eventListeners: {
                processCompleted: success,
                processFailed: function () {}
            }
        });
        getFeatureBySQLService.processAsync(getFeatureBySQLParams);
    }

    /**
     * @private
     * @function ChartModel.prototype.getLayerFeatures
     * @description è¯·æ±å¾å±è¦ç´ çæ°æ®ä¿¡æ¯
     * @param {Object} results - æ°æ®éä¿¡æ¯ã
     * @param {Callbacks} success - æååè°å½æ°ã
     */
    getLayerFeatures(results, success) {
        let datasetsInfo = results.result;
        let queryParam, queryBySQLParams, queryBySQLService;
        let params = {
            name: datasetsInfo.mapName
        };
        Object.assign(params, this.datasets.queryInfo);
        queryParam = new FilterParameter(params);
        queryBySQLParams = new QueryBySQLParameters({
            queryParams: [queryParam],
            expectCount: 100000
        });
        queryBySQLService = new QueryBySQLService(datasetsInfo.dataUrl, {
            eventListeners: {
                processCompleted: success,
                processFailed: function () {}
            }
        });
        queryBySQLService.processAsync(queryBySQLParams);
    }

    /**
     * @private
     * @function ChartModel.prototype.getDataInfoByIptl
     * @description ç¨dataIdè·åiportalçæ°æ®ã
     * @param {Callbacks} success - æååè°å½æ°ã
     *
     */
    getDataInfoByIptl(success) {
        // successæ¯chartçåè°
        this.getServiceInfo(this.datasets.url, success);
    }

    /**
     * @private
     * @function ChartModel.prototype.getServiceInfo
     * @description ç¨iportalè·ådataItemServicesã
     * @param {string} url
     * @param {Callbacks} success - æååè°å½æ°ã
     * */
    getServiceInfo(url, success) {
        let me = this;
        FetchRequest.get(url, null, {
            withCredentials: this.datasets.withCredentials
        })
            .then((response) => {
                return response.json();
            })
            .then((data) => {
                if (data.succeed === false) {
                    //è¯·æ±å¤±è´¥
                    me._fireFailedEvent(data);
                    return;
                }
                // æ¯å¦ærestæå¡
                if (data.dataItemServices && data.dataItemServices.length > 0) {
                    let dataItemServices = data.dataItemServices,
                        resultData;

                    dataItemServices.forEach((item) => {
                        // å¦æærestdataå¹¶ä¸åå¸æåï¼å°±è¯·æ±restdataæå¡
                        // å¦æærestmapå¹¶ä¸åå¸æåï¼å°±è¯·æ±restmapæå¡
                        // å¶ä»æåµå°±è¯·æ±iportal/content.json
                        if (item.serviceType === 'RESTDATA' && item.serviceStatus === 'PUBLISHED') {
                            resultData = item;
                        } else if (item.serviceType === 'RESTMAP' && item.serviceStatus === 'PUBLISHED') {
                            resultData = item;
                        } else {
                            me.getDatafromContent(url, success);
                            return;
                        }
                    });
                    // å¦æææå¡ï¼è·åæ°æ®æºåæ°æ®é, ç¶åè¯·æ±restæå¡
                    resultData && me.getDatafromRest(resultData.serviceType, resultData.address, success);
                } else {
                    me.getDatafromContent(url, success);
                    return;
                }
            })
            .catch((error) => {
                console.log(error);
                me._fireFailedEvent(error);
            });
    }
    /**
     * @private
     * @function ChartModel.prototype.getDatafromURL
     * @description ç¨iportalè·åæ°æ®ãï¼éè¿åºå®çurlæ¥è¯·æ±ï¼ä½æ¯ä¸è½è¯·æ±å·¥ä½ç©ºé´çæ°æ®ï¼
     * @param {string} url
     * @param {Callbacks} success - æååè°å½æ°ã
     */
    getDatafromContent(url, success) {
        // æååè°ä¼ å¥çresults
        let results = {
                result: {}
            },
            me = this;
        url += '/content.json?pageSize=9999999&currentPage=1';
        // è·åå¾å±æ°æ®
        FetchRequest.get(url, null, {
            withCredentials: this.datasets.withCredentials
        })
            .then((response) => {
                return response.json();
            })
            .then((data) => {
                if (data.succeed === false) {
                    //è¯·æ±å¤±è´¥
                    me._fireFailedEvent(data);
                    return;
                }
                if (data.type) {
                    if (data.type === 'JSON' || data.type === 'GEOJSON') {
                        // å°å­ç¬¦ä¸²è½¬æ¢æjson
                        data.content = JSON.parse(data.content.trim());
                        // å¦ææ¯jsonæä»¶ data.content = {type:'fco', features},æ ¼å¼ä¸åºå®
                        if (!data.content.features) {
                            //jsonæ ¼å¼è§£æå¤±è´¥
                            console.log(Lang.i18n('msg_jsonResolveFiled'));
                            return;
                        }
                        let features = this._formatGeoJSON(data.content);
                        results.result.features = {
                            type: data.content.type,
                            features
                        };
                    } else if (data.type === 'EXCEL' || data.type === 'CSV') {
                        let features = this._excelData2Feature(data.content);
                        results.result.features = {
                            type: 'FeatureCollection',
                            features
                        };
                    }
                    success(results, 'content');
                }
            }, this)
            .catch((error) => {
                console.log(error);
                me._fireFailedEvent(error);
            });
    }

    /**
     * @private
     * @function ChartModel.prototype._getDataSource
     * @description è·åæ°æ®æºååæ°æ®éåã
     * @param {string} serviceType æå¡ç±»å
     * @param {string} address å°å
     * @param {Callbacks} success - æååè°å½æ°ã
     * @return {Array.<string>} ["æ°æ®æºå:æ°æ®éå"]
     * @return {string} å¾å±å
     */
    getDatafromRest(serviceType, address, success) {
        let me = this,
            withCredentials = this.datasets.withCredentials;
        if (serviceType === 'RESTDATA') {
            let url = `${address}/data/datasources`,
                sourceName,
                datasetName;
            // è¯·æ±è·åæ°æ®æºå
            FetchRequest.get(url, null, {
                withCredentials
            })
                .then((response) => {
                    return response.json();
                })
                .then((data) => {
                    sourceName = data.datasourceNames[0];
                    url = `${address}/data/datasources/${sourceName}/datasets`;
                    // è¯·æ±è·åæ°æ®éå
                    FetchRequest.get(url, null, {
                        withCredentials
                    })
                        .then((response) => {
                            return response.json();
                        })
                        .then((data) => {
                            datasetName = data.datasetNames[0];
                            // è¯·æ±restdataæå¡
                            me.getDatafromRestData(`${address}/data`, [sourceName + ':' + datasetName], success);
                            return [sourceName + ':' + datasetName];
                        })
                        .catch(function (error) {
                            me._fireFailedEvent(error);
                        });
                })
                .catch(function (error) {
                    me._fireFailedEvent(error);
                });
        } else {
            // å¦ææ¯å°å¾æå¡
            let url = `${address}/maps`,
                mapName,
                layerName,
                path;
            // è¯·æ±è·åå°å¾å
            FetchRequest.get(url, null, {
                withCredentials
            })
                .then((response) => {
                    return response.json();
                })
                .then((data) => {
                    mapName = data[0].name;
                    path = data[0].path;
                    url = url = `${address}/maps/${mapName}/layers`;
                    // è¯·æ±è·åå¾å±å
                    FetchRequest.get(url, null, {
                        withCredentials
                    })
                        .then((response) => {
                            return response.json();
                        })
                        .then((data) => {
                            layerName = data[0].subLayers.layers[0].caption;
                            // è¯·æ±restmapæå¡
                            me.getDatafromRestMap(layerName, path, success);
                            return layerName;
                        })
                        .catch(function (error) {
                            me._fireFailedEvent(error);
                        });
                })
                .catch(function (error) {
                    me._fireFailedEvent(error);
                });
        }
    }

    /**
     * @private
     * @function ChartModel.prototype.getDatafromRestData
     * @description è¯·æ±restdataæå¡
     * @param {string} url
     * @param {Array<string>} dataSource [æ°æ®æºå:æ°æ®éå]
     * @param {Callbacks} success - æååè°å½æ°ã
     */
    getDatafromRestData(url, dataSource, success) {
        let me = this;
        this.datasets.queryInfo.attributeFilter = this.datasets.queryInfo.attributeFilter || 'SmID>0';
        this._getFeatureBySQL(
            url,
            dataSource,
            this.datasets.queryInfo,
            (results) => {
                // æ­¤æ¶çfeatureså·²ç»å¤çægeojsonäº
                success(results, 'RESTDATA');
            },
            (error) => {
                console.log(error);
                me._fireFailedEvent(error);
            }
        );
    }

    /**
     * @private
     * @function ChartModel.prototype.getDatafromRestMap
     * @description è¯·æ±restmapæå¡
     * @param {string} dataSource layerName
     * @param {string} path - mapæå¡å°åã
     * @param {Callbacks} success - æååè°å½æ°ã
     */
    getDatafromRestMap(dataSource, path, success) {
        let me = this;
        this.datasets.queryInfo.attributeFilter = this.datasets.queryInfo.attributeFilter || 'smid=1';
        this._queryFeatureBySQL(
            path,
            dataSource,
            this.datasets.queryInfo,
            null,
            null,
            (results) => {
                // let features = result.result.recordsets[0].features;
                success(results, 'RESTMAP');
            },
            (error) => {
                console.log(error);
                me._fireFailedEvent(error);
            }
        );
    }

    /**
     * @private
     * @function ChartModel.prototype._getFeatureBySQL
     * @description éè¿ sql æ¹å¼æ¥è¯¢æ°æ®ã
     */
    _getFeatureBySQL(url, datasetNames, queryInfo, processCompleted, processFaild) {
        let getFeatureParam, getFeatureBySQLService, getFeatureBySQLParams;
        let params = {
            name: datasetNames.join().replace(':', '@')
        };
        Object.assign(params, queryInfo);
        getFeatureParam = new FilterParameter(params);
        getFeatureBySQLParams = new GetFeaturesBySQLParameters({
            queryParameter: getFeatureParam,
            datasetNames: datasetNames,
            fromIndex: 0,
            toIndex: 100000,
            returnContent: true
        });
        let options = {
            eventListeners: {
                processCompleted: (getFeaturesEventArgs) => {
                    processCompleted && processCompleted(getFeaturesEventArgs);
                },
                processFailed: (e) => {
                    processFaild && processFaild(e);
                }
            }
        };
        getFeatureBySQLService = new GetFeaturesBySQLService(url, options);
        getFeatureBySQLService.processAsync(getFeatureBySQLParams);
    }

    /**
     * @private
     * @function ChartModel.prototype._queryFeatureBySQL
     * @description éè¿ sql æ¹å¼æ¥è¯¢æ°æ®ã
     */
    _queryFeatureBySQL(
        url,
        layerName,
        queryInfo,
        fields,
        epsgCode,
        processCompleted,
        processFaild,
        startRecord,
        recordLength,
        onlyAttribute
    ) {
        var queryParam, queryBySQLParams;
        var filterParams = {
            name: layerName
        };
        Object.assign(filterParams, queryInfo);
        queryParam = new FilterParameter(filterParams);
        if (fields) {
            queryParam.fields = fields;
        }
        var params = {
            queryParams: [queryParam]
        };
        if (onlyAttribute) {
            params.queryOption = QueryOption.ATTRIBUTE;
        }
        startRecord && (params.startRecord = startRecord);
        recordLength && (params.expectCount = recordLength);
        if (epsgCode) {
            params.prjCoordSys = {
                epsgCode: epsgCode
            };
        }
        queryBySQLParams = new QueryBySQLParameters(params);
        this._queryBySQL(url, queryBySQLParams, (data) => {
            data.type === 'processCompleted' ? processCompleted(data) : processFaild(data);
        });
    }
    /**
     * @function ChartModel.prototype._queryBySQL
     * @description  SQL æ¥è¯¢æå¡ã
     * @param {QueryBySQLParameters} params - SQL æ¥è¯¢ç¸å³åæ°ç±»ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - ç»æç±»åã
     */
    _queryBySQL(url, params, callback, resultFormat) {
        var me = this;
        var queryBySQLService = new QueryBySQLService(url, {
            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            },
            format: me._processFormat(resultFormat)
        });

        queryBySQLService.processAsync(params);
    }
    /**
     * @function ChartModel.prototype._processFormat
     * @description å°æ°æ®è½¬æ¢ægeojsonã
     * @param {Object} resultFormat - è¿åç»æéã
     * @return {Object} [resultFormat=DataFormat.GEOJSON] - ç»æç±»åã
     */
    _processFormat(resultFormat) {
        return resultFormat ? resultFormat : DataFormat.GEOJSON;
    }

    /**
     * @private
     * @function ChartModel.prototype._formatGeoJSON
     * @description æ ¼å¼ GeoJSONã
     * @param {GeoJSON} data - GeoJSON æ°æ®ã
     */
    _formatGeoJSON(data) {
        let features = data.features;
        features.forEach((row, index) => {
            row.properties['index'] = index;
        });
        return features;
    }

    /**
     * @private
     * @description å° csv å xls æä»¶åå®¹è½¬æ¢æ geojson
     * @function ChartModel.prototype._excelData2Feature
     * @param content  æä»¶åå®¹
     * @param layerInfo  å¾å±ä¿¡æ¯
     * @returns {Array}  featureçæ°ç»éå
     */
    _excelData2Feature(dataContent) {
        let fieldCaptions = dataContent.colTitles;
        //ä½ç½®å±æ§å¤ç
        let xfieldIndex = -1,
            yfieldIndex = -1;
        for (let i = 0, len = fieldCaptions.length; i < len; i++) {
            if (FileReaderUtil.isXField(fieldCaptions[i])) {
                xfieldIndex = i;
            }
            if (FileReaderUtil.isYField(fieldCaptions[i])) {
                yfieldIndex = i;
            }
        }

        // feature æå»ºåææ¯æåæ ç³» 4326/3857
        let features = [];

        for (let i = 0, len = dataContent.rows.length; i < len; i++) {
            let row = dataContent.rows[i];

            let x = Number(row[xfieldIndex]),
                y = Number(row[yfieldIndex]);
            //å±æ§ä¿¡æ¯
            let attributes = {};
            for (let index in dataContent.colTitles) {
                let key = dataContent.colTitles[index];
                attributes[key] = dataContent.rows[i][index];
            }
            attributes['index'] = i + '';
            //ç®åcsv åªæ¯æå¤çç¹ï¼æä»¥åçæç¹ç±»åç geojson
            let feature = {
                type: 'Feature',
                geometry: {
                    type: 'Point',
                    coordinates: [x, y]
                },
                properties: attributes
            };
            features.push(feature);
        }
        return features;
    }
    /**
     * @private
     * @description è¯·æ±æ°æ®å¤±è´¥çäºä»¶
     * @function ChartModel.prototype._fireFailedEvent
     * @param {Object} error  éè¯¯ä¿¡æ¯
     */
    _fireFailedEvent(error) {
        let errorData = error
            ? {
                  error,
                  message: Lang.i18n('msg_getdatafailed')
              }
            : {
                  message: Lang.i18n('msg_getdatafailed')
              };
        /**
         * @event ChartModel#getdatafailed
         * @description çå¬å°è·åæ°æ®å¤±è´¥äºä»¶åè§¦å
         * @property {Object} error  - äºä»¶å¯¹è±¡ã
         */
        this.events.triggerEvent('getdatafailed', errorData);
    }
}

;// CONCATENATED MODULE: ./src/common/components/chart/ChartViewModel.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class ChartViewModel
 * @aliasclass Components.ChartViewModel
 * @deprecatedclass SuperMap.Components.ChartViewModel
 * @classdesc å¾è¡¨ç»ä»¶åè½ç±»
 * @category Components Chart
 * @version 10.0.0
 * @param {Object} options - å¯éåæ°ã
 * @param {string} options.type - å¾è¡¨ç±»åã
 * @param {ChartView.Datasets} options.datasets - æ°æ®æ¥æºã
 * @param {Array.<Object>} options.chartOptions - å¾è¡¨å¯ééç½®ã
 * @param {Array.<Object>} options.chartOptions.xAxis - Xè½´å¯éåæ°ã
 * @param {string} options.chartOptions.xAxis.field - Xè½´å­æ®µåã
 * @param {string} options.chartOptions.xAxis.name - Xè½´åç§°ã
 * @param {Array.<Object>} options.chartOptions.yAxis - Yè½´å¯éåæ°ã
 * @param {string} options.chartOptions.yAxis.field - Yè½´å­æ®µåã
 * @param {string} options.chartOptions.yAxis.name - Yè½´åç§°ã
 * @fires ChartViewModel#getdatafailed
 * @usage
 */

class ChartViewModel {

    constructor(options) {
        this.datasets = options.datasets;
        this.xField = [];
        this.yField = [];
        this.grid = {
            top: "50px",
            bottom: "50px",
            left: "50px",
            right: "60px"
        };
        this.chartType = options.type || "bar";
        this._initXYField(options.chartOptions);
        this.EVENT_TYPES = ["getdatafailed"];
        this.events = new Events(this, null, this.EVENT_TYPES);
    }

    /**
     * @function ChartViewModel.prototype._initXYField
     * @description åå§åXYå­æ®µã
     * @private
     * @param {Object} chartOptions - optionséçå¾è¡¨åæ°ã
     */
    _initXYField(chartOptions) {
        let me = this;
        if (chartOptions && chartOptions.length > 0) {
            chartOptions.forEach(function (option) {
                if (option.xAxis) {
                    me.xField.push({
                        field: option.xAxis.field,
                        name: option.xAxis.name
                    });
                }
                if (option.yAxis) {
                    me.yField.push({
                        field: option.yAxis.field,
                        name: option.yAxis.name
                    });
                }
            });
        }
    }
    /**
     * @function ChartViewModel.prototype.getDatasetInfo
     * @description è·å¾æ°æ®éæ°æ®ã
     * @param {function} success - æååè°å½æ°ã
     */
    getDatasetInfo(success) {
        this.createChart = success;
        if (this.datasets && this._checkUrl(this.datasets.url)) {
            this.chartModel = new ChartModel(this.datasets);
            if(this.datasets.type === 'iServer'){
                this.chartModel.getDatasetInfo(this._getDatasetInfoSuccess.bind(this));
            }else if(this.datasets.type === 'iPortal'){
                this.chartModel.getDataInfoByIptl(this._getDataInfoSuccess.bind(this));
            }
            /**
             * @event ChartViewModel#getdatafailed
             * @description çå¬å°è·åæ°æ®å¤±è´¥äºä»¶åè§¦åã
             * @property {Object} error  - äºä»¶å¯¹è±¡ã
             */
            this.chartModel.events.on({"getdatafailed":  (error) => {
                this.events.triggerEvent("getdatafailed", error)
            }});
        }
    }

    /**
     * @function ChartViewModel.prototype._getDatasetInfoSuccess
     * @description æååè°å½æ°ã
     * @private
     * @param {Object} results - æ°æ®éä¿¡æ¯ã
     */
    _getDatasetInfoSuccess(results) {
        let datasetUrl = this.datasets.url;
        //å¤æ­æå¡ä¸ºå°å¾æå¡ æè æ°æ®æå¡
        let restIndex = datasetUrl.indexOf("rest");
        if (restIndex > 0) {
            let index = datasetUrl.indexOf("/", restIndex + 5);
            let type = datasetUrl.substring(restIndex + 5, index);
            let dataUrl = datasetUrl.substring(0, restIndex + 4) + "/data";

            if (type === "maps") {
                let mapIndex = datasetUrl.indexOf("/", index + 1);
                let mapName = datasetUrl.substring(index + 1, mapIndex);
                dataUrl = datasetUrl.substring(0, restIndex + 4) + "/maps/" + mapName;
                results.result.dataUrl = dataUrl;
                this._getLayerFeatures(results);
            } else if (type === "data") {
                results.result.dataUrl = dataUrl;
                this._getDataFeatures(results);
            }
        }
    }

    /**
     * @function ChartViewModel.prototype._getDataInfoSuccess
     * @description è¯·æ±iportalæ°æ®æåä¹åçåè°ã
     * @private
     */
    _getDataInfoSuccess(results, type) {
        let me = this;
        if(type === 'RESTMAP'){
            me._getChartDatasFromLayer(results);
        }else{
            me._getChartDatas(results);
        }
    }

    /**
     * @function ChartViewModel.prototype._getDataFeatures
     * @description è¯·æ±æ°æ®éçæ°æ®ä¿¡æ¯
     * @private
     * @param {Object} results - æ°æ®éä¿¡æ¯
     */
    _getDataFeatures(results) {
        this.chartModel.getDataFeatures(results, this._getChartDatas.bind(this));
    }

    /**
     * @function ChartViewModel.prototype._getLayerFeatures
     * @description è¯·æ±å¾å±çæ°æ®ä¿¡æ¯ã
     * @private
     * @param {Object} results - æ°æ®éä¿¡æ¯ã
     */
    _getLayerFeatures(results) {
        this.chartModel.getLayerFeatures(results, this._getChartDatasFromLayer.bind(this));
    }

    /**
     * @function ChartViewModel.prototype._getChartDatas
     * @description å°è¯·æ±åæ¥çæ°æ®è½¬æ¢ä¸ºå¾è¡¨æéçæ°æ®æ ¼å¼ã
     * @private
     * @param {Object} results - æ°æ®è¦ç´ ä¿¡æ¯ã
     */
    _getChartDatas(results) {
        if (results) {
            // æ°æ®æ¥èªrestdata---results.result.features
            this.features = results.result.features;
            let features = this.features.features;
            let data = {};
            if (features.length) {
                let feature = features[0];
                let attrFields = [],
                    itemTypes = [];
                for (let attr in feature.properties) {
                    attrFields.push(attr);
                    itemTypes.push(this._getDataType(feature.properties[attr]));
                }
                data = {
                    features,
                    fieldCaptions: attrFields,
                    fieldTypes: itemTypes,
                    fieldValues: []
                }
                for (let m in itemTypes) {
                    let fieldValue = [];

                    for (let j in features) {
                        let feature = features[j];
                        let caption = data.fieldCaptions[m];
                        let value = feature.properties[caption];
                        fieldValue.push(value);
                    }
                    data.fieldValues.push(fieldValue);
                }
                this.createChart(data);
            }
        }
    }
    /**
     * @function ChartViewModel.prototype._getChartDatasFromLayer
     * @description å°è¯·æ±åæ¥çæ°æ®è½¬æ¢ä¸ºå¾è¡¨æéçæ°æ®æ ¼å¼ã
     * @private
     * @param {Object} results - å¾å±æ°æ®è¦ç´ ä¿¡æ¯ã
     */
    _getChartDatasFromLayer(results) {
        if (results.result.recordsets) {
            let recordsets = results.result.recordsets[0];
            let features = recordsets.features.features;
            this.features = recordsets.features;
            let data = {};
            if (features.length) {
                data = {
                    features: recordsets.features,
                    fieldCaptions: recordsets.fieldCaptions,
                    fieldTypes: recordsets.fieldTypes,
                    fieldValues: []
                }
                for (let m in data.fieldCaptions) {
                    let fieldValue = [];

                    for (let j in features) {
                        let feature = features[j];
                        let caption = data.fieldCaptions[m];
                        let value = feature.properties[caption];
                        fieldValue.push(value);
                    }
                    data.fieldValues.push(fieldValue);
                }
                this.createChart(data);
            }
        }
    }

    /**
     * @function ChartViewModel.prototype._createChartOptions
     * @description åå»ºå¾è¡¨æéåæ°ã
     * @private
     * @param {Object} data - å¾è¡¨æ°æ®ã
     */
    _createChartOptions(data) {
        this.calculatedData = this._createChartDatas(data);
        return this.updateChartOptions(this.chartType);
    }

    /**
     * @function ChartViewModel.prototype.changeType
     * @description æ¹åå¾è¡¨ç±»åã
     * @param {string} type - å¾è¡¨ç±»åã
     */
    changeType(type) {
        if (type !== this.chartType) {
            this.chartType = type;
            return this.updateChartOptions(this.chartType);
        }
    }

    /**
     * @function ChartViewModel.prototype.updateData
     * @description æ¹åå¾è¡¨ç±»åã
     * @param {ChartView.Datasets} datasets - æ°æ®æ¥æºã
     * @param {function} success æååè°å½æ°ã
     */
    updateData(datasets, chartOption, success) {
        this.updateChart = success;
        this.xField = [];
        this.yField = [];
        this._initXYField(chartOption);
        // typeçè®¾ç½®é»è®¤å¼
        datasets.type = datasets.type || 'iServer';
        // withCredentialsçè®¾ç½®é»è®¤å¼
        datasets.withCredentials = datasets.withCredentials || false;
        this.datasets = datasets;
        this.getDatasetInfo(this._updateDataSuccess.bind(this));
    }

    /**
     * @function ChartViewModel.prototype._updateDataSuccess
     * @description æ¹åå¾è¡¨ç±»åã
     * @private
     * @param {Object} data - å¾è¡¨æ°æ®ã
     */
    _updateDataSuccess(data) {
        let options = this._createChartOptions(data);
        this.updateChart(options);
    }

    /**
     * @function ChartViewModel.prototype.updateChartOptions
     * @description æ´æ°å¾è¡¨æéåæ°ã
     * @param {string} type - å¾è¡¨ç±»åã
     * @param {Object} style - å¾è¡¨æ ·å¼ã
     */
    updateChartOptions(type, style) {
        if (this.calculatedData) {
            let grid = this.grid;
            let series = this._createChartSeries(this.calculatedData, type);
            let datas = [];
            for (let i in this.calculatedData.XData) {
                datas.push({
                    value: this.calculatedData.XData[i].fieldsData
                });
            }
            let xAxis = {
                type: "category",
                name: this.xField[0].name || "X",
                data: datas,
                nameTextStyle: {
                    color: '#fff',
                    fontSize: 14
                },
                splitLine: {
                    show: false
                },
                axisLine: {
                    lineStyle: {
                        color: '#eee'
                    }
                }
            }
            let yAxis = {
                type: "value",
                name: this.yFieldName || "Y",
                data: {},
                nameTextStyle: {
                    color: '#fff',
                    fontSize: 14
                },
                splitLine: {
                    show: false
                },
                axisLine: {
                    lineStyle: {
                        color: '#eee'
                    }
                }
            }
            let tooltip = {
                formatter: '{b0}: {c0}'
            };
            let backgroundColor = '#404a59';
            if (style) {
                if (style.grid) {
                    grid = style.grid;
                }
                if (style.tooltip) {
                    tooltip = style.tooltip;
                }
                if (style.backgroundColor) {
                    backgroundColor = style.backgroundColor;
                }
            }
            return {
                backgroundColor: backgroundColor,
                grid: grid,
                series: series,
                xAxis: xAxis,
                yAxis: yAxis,
                tooltip: tooltip
            }
        }
    }

    /**
     * @function ChartViewModel.prototype._createChartDatas
     * @description æå»ºå¾è¡¨æ°æ®ã
     * @private
     * @param {Object} data - æºæ°æ®ã
     */
    _createChartDatas(data) {
        let fieldIndex = 0, yfieldIndexs = [];
        let fieldCaptions = data.fieldCaptions;
        let me = this;
        //X
        fieldCaptions.forEach(function (field, index) {
            if (me.xField[0] && field === me.xField[0].field) {
                fieldIndex = index;
            }
        });
        //Y
        this.yFieldName = "";
        this.yField.forEach(function (value, index) {
            if (index !== 0) {
                me.yFieldName = me.yFieldName + ",";
            }
            me.yFieldName = me.yFieldName + value.name;
            fieldCaptions.forEach(function (field, index) {
                if (field === value.field) {
                    yfieldIndexs.push(index);
                }
            });
        })
        let datas = this._getAttrData(data, fieldIndex);
        let yDatas = [];
        if (yfieldIndexs.length > 0) {
            yfieldIndexs.forEach(function (yfieldIndex) {
                let yData = [];
                for (let i in data.fieldValues[yfieldIndex]) {
                    yData.push({
                        value: data.fieldValues[yfieldIndex][i]
                    });
                }
                yDatas.push(yData);
            });
        } else {                     //æªæå®Yå­æ®µæ¶ï¼yè½´è®¡æ°
            let YData = [],
                XData = [],
                len = datas.length;

            //è®¡ç®Xè½´ï¼Yè½´æ°æ®ï¼å¹¶å»é
            for (let i = 0; i < len; i++) {
                let isSame = false;
                for (let j = 0, leng = XData.length; j < leng; j++) {
                    if (datas[i].fieldsData === XData[j].fieldsData) {
                        YData[j].value++;
                        XData[j].recordIndexs.push(i);
                        isSame = true;
                        break;
                    }
                }
                if (!isSame) {
                    if (datas[i].fieldsData) {
                        XData.push({ fieldsData: datas[i].fieldsData, recordIndexs: [i] });
                        YData.push({ value: 1 });
                    }
                }
            }
            datas = XData;
            yDatas = [YData];
        }
        return {
            XData: datas,
            YData: yDatas
        }
    }

    /**
     * @function ChartViewModel.prototype._getAttrData
     * @description éä¸­å­æ®µæ°æ®ã
     * @private
     * @param {Object} datacontent - å¾è¡¨æ°æ®ã
     * @param {number} index - å­æ®µç´¢å¼ã
     */
    _getAttrData(datacontent, index) {
        if (index === 0) {
            this.xField = [{
                field: datacontent.fieldCaptions[index],
                name: datacontent.fieldCaptions[index]
            }];
        }
        let fieldsDatas = [];
        for (let i = 0, len = datacontent.fieldValues[index].length; i < len; i++) {
            let value = datacontent.fieldValues[index][i];
            fieldsDatas.push({
                recordIndexs: i,
                fieldsData: value
            });
        }
        return fieldsDatas;
    }

    /**
     * @function ChartViewModel.prototype._createChartSeries
     * @description å¾è¡¨æ°æ®ã
     * @private
     * @param {Object} calculatedData - å¾è¡¨æ°æ®ã
     * @param {string} chartType - å¾è¡¨ç±»åã
     */
    _createChartSeries(calculatedData, chartType) {
        let series = [];
        let yDatas = calculatedData.YData;
        yDatas.forEach(function (yData) {
            let value = 0;
            let serieData = [];
            for (let data of yData) {
                value = data.value;
                serieData.push({
                    value: value
                });
            }
            let serie = {
                type: chartType,
                data: serieData,
                name: "y"
            };

            series.push(serie);
        });
        return series;
    }

    /**
     * @function ChartViewModel.prototype._isDate
     * @description å¤æ­æ¯å¦ä¸ºæ¥æã
     * @private
     * @param {string} data - å­ç¬¦ä¸²ã
     */
    _isDate(data) {
        let reg = /((^((1[8-9]\d{2})|([2-9]\d{3}))([-\/\._])(10|12|0?[13578])([-\/\._])(3[01]|[12][0-9]|0?[1-9])$)|(^((1[8-9]\d{2})|([2-9]\d{3}))([-\/\._])(11|0?[469])([-\/\._])(30|[12][0-9]|0?[1-9])$)|(^((1[8-9]\d{2})|([2-9]\d{3}))([-\/\._])(0?2)([-\/\._])(2[0-8]|1[0-9]|0?[1-9])$)|(^([2468][048]00)([-\/\._])(0?2)([-\/\._])(29)$)|(^([3579][26]00)([-\/\._])(0?2)([-\/\._])(29)$)|(^([1][89][0][48])([-\/\._])(0?2)([-\/\._])(29)$)|(^([2-9][0-9][0][48])([-\/\._])(0?2)([-\/\._])(29)$)|(^([1][89][2468][048])([-\/\._])(0?2)([-\/\._])(29)$)|(^([2-9][0-9][2468][048])([-\/\._])(0?2)([-\/\._])(29)$)|(^([1][89][13579][26])([-\/\._])(0?2)([-\/\._])(29)$)|(^([2-9][0-9][13579][26])([-\/\._])(0?2)([-\/\._])(29)$))/ig;
        return reg.test(data);
    }

    /**
     * @function ChartViewModel.prototype._isNumber
     * @description å¤æ­æ¯å¦ä¸ºæ°å¼ã
     * @private
     * @param {string} data - å­ç¬¦ä¸²ã
     */
    _isNumber(data) {
        let mdata = Number(data);
        if (mdata === 0) {
            return true;
        }
        return !isNaN(mdata);
    }

    /**
     * @function ChartViewModel.prototype._getDataType
     * @description å¤æ­æ°æ®çç±»åã
     * @private
     * @param {string} data - å­ç¬¦ä¸²ã
     */
    _getDataType(data) {
        if (data !== null && data !== undefined && data !== '') {
            if (this._isDate(data)) {
                return "DATE";
            }
            if (this._isNumber(data)) {
                return "NUMBER";
            }
        }
        return "STRING";
    }

    /**
     * @function ChartViewModel.prototype._checkUrl
     * @description æ£æ¥urlæ¯å¦ç¬¦åè¦æ±ã
     * @private
     * @param {string} urlã
     */
    _checkUrl(url) {
        let match;
        if (url === '' || !this._isMatchUrl(url)) {
            match = false;
        } else if (/^http[s]?:\/\/localhost/.test(url) || /^http[s]?:\/\/127.0.0.1/.test(url)) {
            //ä¸æ¯å®éåå
            match = false;
        } else {
            match = true;
        }
        return match;
    }

    /**
     * @function ChartViewModel.prototype._isMatchUrl
     * @description å¤æ­è¾å¥çå°åæ¯å¦ç¬¦åå°åæ ¼å¼ã
     * @private
     * @param {string} str - urlã
     */
    _isMatchUrl(str) {
        var reg = new RegExp('(https?|http|file|ftp)://[-A-Za-z0-9+&@#/%?=~_|!:,.;]+[-A-Za-z0-9+&@#/%=~_|]');
        return reg.test(str);
    }

    /**
     * @function ChartViewModel.prototype.getStyle
     * @description è·åå¾è¡¨æ ·å¼ã
     */
    getStyle() {
        let style = {
            grid: this.grid,
            tooltip: this.tooltip,
            backgroundColor: this.backgroundColor
        }
        return style;
    }

    /**
     * @function ChartViewModel.prototype.getFeatures
     * @description è·åå°å¾æå¡ï¼æ°æ®æå¡è¯·æ±è¿åçæ°æ®ã
     */
    getFeatures() {
        return this.features;
    }

    /**
     * @function ChartViewModel.prototype.setStyle
     * @description è®¾ç½®å¾è¡¨æ ·å¼ã
     * @param {Object} style - å¾è¡¨æ ·å¼
     */
    setStyle(style) {
        return this.updateChartOptions(this.chartType, style);
    }
}

;// CONCATENATED MODULE: ./src/common/components/chart/ChartView.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class ChartView
 * @aliasclass Components.Chart
 * @deprecatedclass SuperMap.Components.Chart
 * @classdesc å¾è¡¨ç»ä»¶
 * @version 9.1.2
 * @param {string} domID - å¾è¡¨domåç´ IDã
 * @param {Object} options - å¯éåæ°ã
 * @param {string} options.type - å¾è¡¨ç±»åã
 * @param {ChartView.Datasets} options.datasets - æ°æ®æ¥æº
 * @param {Array.<Object>} options.chartOptions - å¾è¡¨å¯éåæ°ã
 * @param {Array.<Object>} options.chartOptions.xAxis - å¾è¡¨Xè½´ã
 * @param {string} options.chartOptions.xAxis.field - å¾è¡¨Xè½´å­æ®µåã
 * @param {string} options.chartOptions.xAxis.name - å¾è¡¨Xè½´åç§°ã
 * @param {Array.<Object>} options.chartOptions.yAxis - å¾è¡¨Yè½´ã
 * @param {string} options.chartOptions.yAxis.field - å¾è¡¨Yè½´å­æ®µåã
 * @param {string} options.chartOptions.yAxis.name - å¾è¡¨Yè½´åç§°ã
 * @category Components Chart
 * @usage
 */
/**
 * @typedef {Object} ChartView.Datasets  - æ°æ®æ¥æº
 * @property {string} [type = 'iServer'] - æå¡ç±»å iServer, iPortalã
 * @property {string} url - æå¡å°åã
 * @property {boolean} [withCredentials = false] - è®¾ç½®è¯·æ±æ¯å¦å¸¦cookie
 * @property {FilterParameter} queryInfo - æ¥è¯¢æ¡ä»¶
 */
class ChartView {

    constructor(domID, options) {
        this.domID = domID;
        this.chartType = options.type || "bar";
        // è®¾ç½®options.datasets.typeçé»è®¤å¼æ¯iServer
        options.datasets.type = options.datasets.type || 'iServer';
        // è®¾ç½®withCredentialsçé»è®¤å¼ä¸ºfalse
        options.datasets.withCredentials = options.datasets.withCredentials || false;
        this.viewModel = new ChartViewModel(options);
        //æ·»å æ§ä»¶ã
        this._fillDataToView();
    }

    /**
     * @function ChartView.prototype.onAdd
     * @description åå»ºå¾è¡¨ä¹åæååè°
     * @param {function} addChart - åè°å½æ°ã
     */
    onAdd(addChart) {
        this.addChart = addChart;
    }

    /**
     * @function ChartView.prototype._fillDataToView
     * @description å¡«åæ°æ®å° viewã
     * @private
     */
    _fillDataToView() {
        let messageboxs = new MessageBox();
        //iclient ç»å®createChartäºä»¶æååè°
        this.viewModel.getDatasetInfo(this._createChart.bind(this));
        this.viewModel.events.on({
            "getdatafailed": (error) => {
                messageboxs.showView(error.message);
            }
        });
    }

    /**
     * @function ChartView.prototype.getStyle
     * @description è·åå¾è¡¨æ ·å¼ã
     */
    getStyle() {
        return this.viewModel.getStyle()
    }

    /**
     * @function ChartView.prototype.getFeatures
     * @description è·åå°å¾æå¡ï¼æ°æ®æå¡è¯·æ±è¿åçæ°æ®ã
     */
    getFeatures() {
        return this.viewModel.getFeatures();
    }

    /**
     * @function ChartView.prototype.setStyle
     * @description è®¾ç½®å¾è¡¨æ ·å¼ã
     * @param {Object} style - å¾è¡¨æ ·å¼ï¼åèEcharts-optionsæ ·å¼è®¾ç½®ã
     */
    setStyle(style) {
        let newOptions = this.viewModel.setStyle(style);
        this._updateChart(newOptions);
    }

    /**
     * @function ChartView.prototype.changeType
     * @description æ¹åå¾è¡¨ç±»åã
     * @param {string} type - å¾è¡¨ç±»åã
     */
    changeType(type) {
        if (this.chartType !== type) {
            this.chartType = type;
            let newOptions = this.viewModel.changeType(type);
            this._updateChart(newOptions);
        }
    }

    /**
     * @function ChartView.prototype.updateData
     * @description æ´æ°å¾è¡¨æ°æ®ã
     * @param {ChartView.Datasets} datasets - æ°æ®æ¥æºã
     * @param {Object} chartOption - X,Yè½´ä¿¡æ¯ã
     */
    updateData(datasets, chartOption) {
        let me = this;
        this.viewModel.updateData(datasets, chartOption, function (options) {
            me._updateChart(options);
            if (me.addChart) {
                me.addChart();
            }
        });
    }

    /**
     * @function ChartView.prototype._createChart
     * @description åå»ºå¾è¡¨ã
     * @private
     * @param {Object} data - å¾è¡¨æ°æ®ã
     */
    _createChart(data) {
        this.echart = external_function_try_return_echarts_catch_e_return_default().init(
            document.getElementById(this.domID),
            null, {
                renderer: "canvas"
            }
        )
        let options = this.viewModel._createChartOptions(data);
        this.echart.setOption(options);
        if (this.addChart) {
            this.addChart();
        }
    }

    /**
     * @function ChartView.prototype._updateChart
     * @description æ´æ°å¾è¡¨ã
     * @private
     * @param {Object} options - å¾è¡¨åæ°ã
     */
    _updateChart(options) {
        if (this.echart) {
            this.echart.clear();
            this.echart.setOption(options);
        }
    }
}

;// CONCATENATED MODULE: ./src/common/components/templates/TemplateBase.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/

/**
 * @class TemplateBase
 * @aliasclass Components.TemplateBase
 * @deprecatedclass SuperMap.Components.TemplateBase
 * @classdesc ç»ä»¶å¬ç¨ç»ä»¶ç¶ç±»ï¼ç¨äºçº¦æç»ä¸å°è£çå¬ç¨ç»ä»¶ç»æã
 * @version 9.1.1
 * @param {Object} options - ç»ä»¶éç½®åæ°ã
 * @param {string} options.id - ç»ä»¶ dom åç´  idã
 * @category Components Common
 * @usage
 */
class TemplateBase {
    constructor(options) {
        options = options ? options : {};
        /**
         * @member {string} [TemplateBase.prototype.id=null]
         * @description  ç»ä»¶ dom åç´  idã
         */
        this.id = options.id ? options.id : null;

        /**
         * @member {HTMLElement} [TemplateBase.prototype.rootContainer=null]
         * @description  ç»ä»¶ dom åç´ å¯¹è±¡ã
         */
        this.rootContainer = null;
    }

    /**
     * @function TemplateBase.prototype.getElement
     * @description è·åå½åç»ä»¶åç´ å¯¹è±¡ã
     * @return {HTMLElement} ç»ä»¶ dom åç´ å¯¹è±¡
     */
    getElement() {
        //todo å¶å®æè§åè¿éç»ç»ä»¶è®¾ç½®ä¸å¤ªåç
        if (this.id) {
            this.rootContainer.id = this.id;
        }

        return this.rootContainer;
    }

    /**
     * @function TemplateBase.prototype._initView
     * @private
     * @description åå§åæ¨¡æ¿ã
     */
    _initView() {
        //å­ç±»å®ç°æ­¤æ¹æ³
    }

    /**
     * @function TemplateBase.prototype.showView
     * @description æ¾ç¤ºç»ä»¶ã
     */
    showView() {
        this.rootContainer.hidden = false;
    }

    /**
     * @function TemplateBase.prototype.closeView
     * @description éèç»ä»¶ã
     */
    closeView() {
        this.rootContainer.hidden = true;
    }
}

;// CONCATENATED MODULE: ./src/common/components/templates/CommonContainer.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class CommonContainer
 * @aliasclass Components.CommonContainer
 * @deprecatedclass SuperMap.Components.CommonContainer
 * @classdesc ç»ä»¶ç»ä¸å¤æ¡ã
 * @version 9.1.1
 * @param {Object} options - ç»ä»¶éç½®åæ°ã
 * @param {string} options.id - ç»ä»¶ dom åç´  idã
 * @param {string} options.title - æ é¢ã
 * @category Components Common
 * @extends {TemplateBase}
 * @usage
 */
class CommonContainer extends TemplateBase {
    constructor(options) {
        super(options);
        let title = options.title ? options.title : "";
        this._initView(title);
    }

    /**
     * @private
     * @override
     */
    _initView(title) {
        const container = document.createElement("div");
        container.setAttribute("class", "component-container");

        //title
        const titleContainer = document.createElement("div");
        titleContainer.setAttribute("class", "component-title");
        const titleContent = document.createElement("div");
        titleContent.innerHTML = title;
        titleContainer.appendChild(titleContent);
        container.appendChild(titleContainer);
        //container
        const componentContent = document.createElement("div");
        componentContent.setAttribute("class", "component-content");
        container.appendChild(componentContent);
        this.content = componentContent;

        this.rootContainer = container;
        return container;
    }

    /**
     * @function CommonContainer.prototype.getContentElement
     * @description è·ååå®¹åç´ å®¹å¨ã
     */
    getContentElement() {
        return this.content;
    }

    /**
     * @function CommonContainer.prototype.appendContent
     * @description å¡«ååå®¹åç´ ã
     */
    appendContent(element) {
        this.content.appendChild(element);
    }
}

;// CONCATENATED MODULE: ./src/common/components/templates/Select.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class Select
 * @aliasclass Components.Select
 * @deprecatedclass SuperMap.Components.Select
 * @classdesc ç»ä»¶ç»ä¸çæå­ä¸ææ¡ã
 * @version 9.1.1
 * @param {Array.<string|Array>} options - ç»ä»¶éç½®åæ°æ°ç»ã
 * @param {string} options.id - ç»ä»¶ dom åç´  idã
 * @param {string} [options.labelName] - label åç§°ã
 * @param {Array.<string>} options.optionsArr - éè¦åå»ºç option æ°æ®æ°ç»ã
 * @param {function} [options.optionsClickCb] - option ç¹å»äºä»¶åè°å½æ°ã
 * @extends {TemplateBase}
 * @category Components Common
 * @usage
 */
class Select extends TemplateBase {
    constructor(options) {
        super(options);
        this._initView(options);
    }

    _initView(options) {
        let selectTool = this._createElement('div', "component-selecttool");

        if (options.labelName) {
            let label = this._createElement('label', 'component-selecttool__lable--describe', selectTool);
            label.innerHTML = options.labelName;
        }

        let chartSelect = this._createElement('div', 'component-selecttool--chart', selectTool);
        chartSelect.setAttribute('tabindex', '1');

        let selectName = this._createElement('div', "component-selecttool__name", chartSelect);
        selectName.title = options.optionsArr[0];
        selectName.innerHTML = options.optionsArr[0];

        let chartTriangleBtn = this._createElement('div', 'component-selecttool__trianglebtn--chart', chartSelect);
        let triangleBtn = this._createElement('div', 'component-triangle-down-img', chartTriangleBtn);
        let selectContent = this._createElement('div', 'component-selecttool__content', chartSelect);
        let scrollarea = this._createElement('div', 'component-selecttool__content--chart', selectContent);
        let scrollareaContent = this._createElement('div', 'component-selecttool__scrollarea__content', scrollarea);
        scrollareaContent.setAttribute('tabindex', '1');
        this.createOptions(scrollareaContent, options.optionsArr);
        this.optionClickEvent(scrollareaContent, selectName, options.optionsClickCb);
        // ä¸ææ¡æ¾ç¤º & éèäºä»¶
        this._selectClickEvent(chartSelect, selectContent, triangleBtn);
        this.rootContainer = selectTool;
    }

    /**
     * @function Select.prototype.createOptions
     * @description åå»ºæå±ä¸ææ¡éé¡¹ã
     */
    createOptions(container, optionsArr) {
        for (let i in optionsArr) {
            let option = this._createElement('div', 'component-selecttool__option', container);
            option.title = optionsArr[i];
            option.innerHTML = optionsArr[i];
        }
    }

    /**
     * @function Select.prototype._selectClickEvent
     * @description select ç¹å»æ¾ç¤º&éèäºä»¶ã
     * @private
     */
    _selectClickEvent(eventElement, contentElement, triangleBtn) {
        eventElement.onclick = function (e) {
            if (contentElement.style.display === "block") {
                contentElement.style.display = "none";
                triangleBtn.className = "component-triangle-down-img";
            } else {
                contentElement.style.display = "block";
                triangleBtn.className = "triangle-up-img";
            }
            e.preventDefault();
            e.stopPropagation();
        };
        eventElement.onmousedown = function (evt) {
            //console.log('dropdownbox onmousedown '+evt.target.className);
            if (evt.target !== this) {
                this.focus();
                evt.preventDefault();
                evt.stopPropagation()
            }
        };
        eventElement.onblur = function () {

            contentElement.style.display = "none";
            triangleBtn.className = "component-triangle-down-img";
        }
    }

    /**
     * @function Select.prototype._createElement
     * @description éç¨åå»ºåç´ ã
     * @private
     */
    _createElement(tagName, className, parentEle) {
        let ele = document.createElement(tagName || 'div');
        className && (ele.className = className);
        parentEle && parentEle.appendChild(ele);
        return ele;
    }

    /**
     * @function Select.prototype.optionClickEvent
     * @description ä¸ææ¡ç option çç¹å»äºä»¶ã
     */
    optionClickEvent(optionEleArr, selectNameEle, optionsClickCb) {
        for (let i = 0; i < optionEleArr.children.length; i++) {
            let childEle = optionEleArr.children[i];
            childEle.onclick = function () {
                selectNameEle.innerHTML = childEle.innerHTML;
                selectNameEle.title = childEle.title;
                if (childEle.getAttribute('data-value')) {
                    selectNameEle.setAttribute('data-value', childEle.getAttribute('data-value'))
                }
                optionsClickCb && optionsClickCb(childEle);
            }
        }
    }
}

;// CONCATENATED MODULE: ./src/common/components/templates/DropDownBox.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class DropDownBox
 * @aliasclass Components.DropDownBox
 * @deprecatedclass SuperMap.Components.DropDownBox
 * @classdesc ç»ä»¶ç»ä¸çå¾çä¸ææ¡ã
 * @version 9.1.1
 * @param {Array.<Object>} options - ç»ä»¶éç½®åæ°æ°ç»ã
 * @param {string} options.id - ç»ä»¶ dom åç´  idã
 * @param {string} options.title - ä¸ææ¡ titleã
 * @param {string} options.remark - ä¸ææ¡è§£éæ è®°ææ¬ã
 * @param {string} [options.dataValue] - ä¸ææ¡ attribute åä¸º data-value çå¼ ã
 * @param {string} [options.icon] - ä¸ææ¡å¾æ ã
 * @param {string} [options.icon.className] - ä¸ææ¡å¾æ ç±»åã
 * @param {string} [options.icon.background] - ä¸ææ¡å¾æ èæ¯ urlã
 * @category Components Common
 * @extends {TemplateBase}
 * @usage
 */
class DropDownBox extends TemplateBase {
    constructor(optionsArr) {
        super(optionsArr);
        this._initView(optionsArr);
    }

    /**
     * @function DropDownBox.prototype._initView
     * @description åå§åä¸ææ¡ã
     * @private
     * @override
     */
    _initView(optionsArr) {
        let dropDownContainer = document.createElement('div');
        dropDownContainer.className = 'component-dropdownbox--container';
        let dropDownBox = document.createElement('div');
        dropDownBox.setAttribute('tabindex', '1');
        dropDownBox.className = "component-dropdownbox";
        dropDownContainer.appendChild(dropDownBox);

        let dropDownTopContainer = document.createElement('div');
        dropDownBox.appendChild(dropDownTopContainer);

        this._createDropDownOption(optionsArr[0], dropDownTopContainer);

        let triangleBtnContainer = document.createElement('div');
        triangleBtnContainer.className = 'component-dropdownbox__triangle-btn';
        dropDownBox.appendChild(triangleBtnContainer);

        let triangleBtn = document.createElement('div');
        triangleBtn.className = 'component-triangle-down-img';
        triangleBtnContainer.appendChild(triangleBtn);

        let createDropDownBoxParam = {
            "parentEle": dropDownBox,
            "dropDownContent": ['component-dropdownbox__content component-dropdownbox__content--chart', 'dropDownContent'],
            "scrollareaContent": 'component-selecttool__scrollarea__content',
            "optionsArr": optionsArr,
            "triangleBtn": triangleBtn,
            "dropDownTopContainer": dropDownTopContainer
        };
        this._createDropDownBox(createDropDownBoxParam);

        this.rootContainer = dropDownContainer;

    }

    /**
     * @function DropDownBox.prototype._createDropDownBox
     * @description åå»ºä¸ææ¡ã
     * @private
     */
    _createDropDownBox(createDropDownBoxParam) {
        let dropDownBox = createDropDownBoxParam.parentEle;
        let dropDownTopContainer = createDropDownBoxParam.dropDownTopContainer;
        let dropDownContent = document.createElement('div');
        dropDownContent.className = createDropDownBoxParam.dropDownContent[0];
        dropDownBox.appendChild(dropDownContent);

        let scrollareaContent = document.createElement('div');
        scrollareaContent.className = createDropDownBoxParam.scrollareaContent;
        dropDownContent.appendChild(scrollareaContent);

        let optionsArr = createDropDownBoxParam.optionsArr;
        for (let i = 0; i < optionsArr.length; i++) {
            this._createDropDownOption(optionsArr[i], scrollareaContent)
        }
        // ä¸ææ¡æ¾ç¤º & éèäºä»¶
        let triangleBtn = createDropDownBoxParam.triangleBtn;
        this._dropDownClickEvent(dropDownBox, dropDownContent, triangleBtn);

        this._eleOnblur(dropDownBox, dropDownContent, triangleBtn);

        // ä¸ææ¡ options ç¹å»äºä»¶
        let scrollareaOptions = scrollareaContent.children;
        for (let i = 0; i < scrollareaOptions.length; i++) {
            scrollareaOptions[i].onclick = function () {
                dropDownTopContainer.innerHTML = scrollareaOptions[i].outerHTML;
                //evt.stopPropagation();
            }
        }
    }

    /**
     * @function DropDownBox.prototype._createDropDownOption
     * @description åå»ºä¸ææ¡å­åç´ ã
     * @private
     */
    _createDropDownOption(data, parentElement) {
        let ele = document.createElement('div');
        ele.className = 'component-dropdownbox__item';
        let dataItem = data;
        if (dataItem['dataValue']) {
            ele.setAttribute('data-value', dataItem['dataValue']);
        }
        parentElement.appendChild(ele);

        let imgContainer = document.createElement('div');
        imgContainer.className = 'component-dropdownbox__item__img';
        ele.appendChild(imgContainer);

        let img = document.createElement('div');
        if (dataItem.icon.className) {
            img.className = dataItem.icon.className;
        }
        if (dataItem.icon.background) {
            img.style.background = dataItem.icon.background;
        }
        imgContainer.appendChild(img);

        let title = document.createElement('div');
        title.className = 'component-dropdownbox__item__title';
        title.title = dataItem.title;
        title.innerHTML = dataItem.title;
        ele.appendChild(title);

        let remark = document.createElement('div');
        remark.className = 'component-dropdownbox__item__remark';
        remark.title = dataItem.remark;
        remark.innerHTML = dataItem.remark;
        ele.appendChild(remark);
    }

    /**
     * @function DropDownBox.prototype._dropDownClickEvent
     * @description ä¸ææ¡ç¹å»äºä»¶ã
     * @private
     */
    _dropDownClickEvent(eventElement, contentElement, triangleBtn) {
        eventElement.onclick = function (e) {
            if (contentElement.style.display === "block") {
                contentElement.style.display = "none";
                triangleBtn.className = "component-triangle-down-img";
            } else {
                contentElement.style.display = "block";
                triangleBtn.className = "triangle-up-img";
            }
            e.preventDefault();
            e.stopPropagation()
        };
        eventElement.onmousedown = function (evt) {
            //console.log('dropdownbox onmousedown '+evt.target.className);
            if (evt.target !== this) {
                this.focus();
                evt.preventDefault();
                evt.stopPropagation()
            }
        }
    }

    /**
     * @function DropDownBox.prototype._eleOnblur
     * @description ä¸ææ¡å¤±ç¦äºä»¶ã
     * @private
     */
    _eleOnblur(eventElement, contentElement, triangleBtn) {
        eventElement.onblur = function () {
            contentElement.style.display = "none";
            triangleBtn.className = "component-triangle-down-img";
        }
    }

    /**
     * @function DropDownBox.prototype._createElement
     * @description éç¨åå»ºåç´ ã
     * @private
     */
    _createElement(tagName, className, parentEle) {
        let ele = document.createElement(tagName || 'div');
        className && (ele.className = className);
        parentEle && parentEle.appendChild(ele);
        return ele;
    }

}


;// CONCATENATED MODULE: ./src/common/components/templates/PopContainer.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class PopContainer
 * @aliasclass Components.PopContainer
 * @deprecatedclass SuperMap.Components.PopContainer
 * @classdesc å¼¹æ¡ç»ä»¶ã
 * @version 9.1.1
 * @param {Object} options - ç»ä»¶éç½®åæ°ã
 * @param {string} options.id - ç»ä»¶ dom åç´  idã
 * @param {string} options.title - å¼¹æ¡ç»ä»¶åç§°ã
 * @extends {TemplateBase}
 * @category Components Common
 * @usage
 */
class PopContainer extends TemplateBase {
    constructor(options) {
        options = options ? options : {};
        super(options);
        options.title = options.title ? options.title : "";
        this._initView(options.title);
    }

    /**
     * @private
     * @override
     */
    _initView(titile) {
        const container = document.createElement("div");
        container.setAttribute("class", "component-popcontainer");

        //header
        const header = document.createElement("div");
        header.setAttribute("class", "component-popcontainer__header");
        const title = document.createElement("label");
        title.setAttribute("class", "component-popcontainer__header__title");
        title.innerHTML = titile;
        header.appendChild(title);

        const closeBtn = document.createElement("span");
        closeBtn.setAttribute("class", "supermapol-icons-clear component-popcontainer__header__close");
        closeBtn.onclick = this.closeView.bind(this);
        container.appendChild(closeBtn);
        container.appendChild(header);

        //content
        const content = document.createElement("div");
        content.setAttribute("class", "component-popcontainer__content");
        this.content = content;

        container.appendChild(content);

        this.rootContainer = container;

    }

    /**
     * @function PopContainer.prototype.appendContent
     * @description è¿½å åå®¹ã
     * @param {HTMLElement} dom - åå®¹åç´ ã
     */
    appendContent(dom) {
        this.content.appendChild(dom);
    }

}

;// CONCATENATED MODULE: ./src/common/components/templates/AttributesPopContainer.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class AttributesPopContainer
 * @aliasclass Components.AttributesPopContainer
 * @deprecatedclass SuperMap.Components.AttributesPopContainer
 * @classdesc å±æ§å¼¹æ¡ç»ä»¶
 * @version 9.1.1
 * @param {Object} options - ç»ä»¶éç½®åæ°ã
 * @param {string} options.id - ç»ä»¶ dom åç´  idã
 * @param {Object} options.title - å±æ§å¼¹æ¡ç»ä»¶åç§°ã
 * @param {Object} options.attributes - ç»ä»¶éè¦æ¾ç¤ºçå±æ§åå®¹ã
 * @extends {PopContainer}
 * @category Components Common
 * @usage
 */
class AttributesPopContainer extends PopContainer {
    constructor(options) {
        //é»è®¤ä¸ºå±æ§ï¼
        options.title = options.title ? options.title : "å±æ§";

        super(options);
        this.rootContainer.firstChild.hidden = true;
        options.attributes = options.attributes ? options.attributes : [];
        this._createAttributesTable(options.attributes);
    }

    _createAttributesTable(attributes) {
        const table = document.createElement("table");
        table.setAttribute("class", "component-popcontainer__content__table");

        const tbody = document.createElement("tbody");

        let single = true;
        for (let name in attributes) {
            const tr = document.createElement("tr");
            if (single) {
                tr.setAttribute("class", "component-popcontainer__content__td--color");
            }
            const title = document.createElement("td");
            const titleSpan = document.createElement("Span");
            titleSpan.innerHTML = name;
            title.appendChild(titleSpan);
            const value = document.createElement("td");
            value.innerHTML = attributes[name];

            tr.appendChild(title);
            tr.appendChild(value);
            tbody.appendChild(tr);
            single = !single;
        }
        table.appendChild(tbody);

        this.appendContent(table);
    }
}

;// CONCATENATED MODULE: ./src/common/components/templates/IndexTabsPageContainer.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class IndexTabsPageContainer
 * @aliasclass Components.IndexTabsPageContainer
 * @deprecatedclass SuperMap.Components.IndexTabsPageContainer
 * @classdesc æ ç­¾ç´¢å¼ç»ä»¶ã
 * @version 9.1.1
 * @param {Object} options - ç»ä»¶éç½®åæ°ã
 * @param {string} options.id - ç»ä»¶ dom åç´  idã
 * @category Components Common
 * @extends {TemplateBase}
 * @usage
 */
class IndexTabsPageContainer extends TemplateBase {
    constructor(options) {
        super(options);
        this._initView();
    }

    /**
     * @private
     * @override
     */
    _initView() {
        const container = document.createElement("div");
        container.setAttribute("class", "component-tabpage");

        const header = document.createElement("ul");
        this.header = header;

        const content = document.createElement("div");
        content.setAttribute("class", "component-tabpage__content");
        this.content = content;

        container.appendChild(header);
        container.appendChild(content);
        this.rootContainer = container;

    }

    /**
     * @function IndexTabsPageContainer.prototype.setTabs
     * @description è®¾ç½®æ ç­¾åç´ ã
     * @param {Array.<HTMLElement>} tabs
     */
    setTabs(tabs) {
        this.removeAllTabs();
        this.appendTabs(tabs);
    }

    /**
     * @function IndexTabsPageContainer.prototype.appendTabs
     * @description è¿½å æ ç­¾åç´ ã
     * @param {Array.<HTMLElement>} tabs
     */
    appendTabs(tabs) {
        for (let i = 0; i < tabs.length; i++) {
            let title = document.createElement("span");
            title.index = i;
            title.appendChild(document.createTextNode(tabs[i].title));
            //ç»å®æ ç­¾åæ¢å¯¹åºé¡µé¢ï¼
            title.onclick = this._changeTabsPage.bind(this);
            let content = tabs[i].content;
            content.index = i;
            content.hidden = true;

            this.header.appendChild(title);
            this.content.appendChild(content);
        }
        //todo ç¡®è®¤æ¯å¦ä¸¤ä¸ªå­åç´ ç index ç¸äºå¯¹åº
        //é»è®¤æ¾ç¤ºç¬¬ä¸ä¸ªæ ç­¾å¯¹è±¡
        this.header.firstChild.setAttribute("class", "on");
        this.content.firstChild.hidden = false;
    }

    /**
     * @function IndexTabsPageContainer.prototype.removeTab
     * @description å é¤æä¸ªæ ç­¾é¡µé¢ã
     * @param {number} index - æ ç­¾ç´¢å¼å·ã
     */
    removeTab(index) {
        this.header.removeChild(this.header.children[index]);
        this.content.removeChild(this.content.children[index]);
    }

    /**
     * @function IndexTabsPageContainer.prototype.removeAllTabs
     * @description å é¤æææ ç­¾ã
     */
    removeAllTabs() {
        for (let i = this.header.children.length; i > 0; i--) {
            this.header.removeChild(this.header.children[i]);
            this.content.removeChild(this.content.children[i]);
        }
    }

    _changeTabsPage(e) {
        const index = e.target.index;
        for (let i = 0; i < this.header.children.length; i++) {
            this.header.children[i].setAttribute("class", "");
            this.content.children[i].hidden = true;
            if (i === index) {
                this.header.children[i].setAttribute("class", "on");
                this.content.children[i].hidden = false;
            }
        }
    }

}

;// CONCATENATED MODULE: ./src/common/components/templates/CityTabsPage.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class CityTabsPage
 * @aliasclass Components.CityTabsPage
 * @deprecatedclass SuperMap.Components.CityTabsPage
 * @classdesc åå¸å°åå¹éç»ä»¶æ¨¡æ¿
 * @version 9.1.1
 * @param {Object} options - ç»ä»¶éç½®åæ°ã
 * @param {string} options.id - ç»ä»¶ dom åç´  idã
 * @param {Object|Array.<string>} options.config - åå¸åç§°éç½®åè¡¨ï¼æ¯æä¸¤ç§æ ¼å¼ï¼{key1:{A:[],B:[]}, key2:{C:[],D:[]}} æ
 *                               ["æé½å¸","åäº¬å¸"]ï¼ç¨æ·å¯æ ¹æ®èªå·±çé¡¹ç®éæ±è¿è¡éç½®
 * @extends {IndexTabsPageContainer}
 * @category Components Common
 * @usage
 */
class CityTabsPage extends IndexTabsPageContainer {
    constructor(options) {
        super(options);
        //å»æé»è®¤çè¾¹æ¡é´å½±æ ·å¼ï¼
        this.rootContainer.classList.add("component-citytabpage--noneBoxShadow");
        this.config = options.config;
        //headerï¼è¥ configä¸ºåå¸åç§°æ°ç»ï¼åç´æ¥å è½½åå®¹
        if (Util.isArray(this.config)) {
            this.header.hidden = true;
            this._createCityItem("åå¸", this.config);
            this.content.style.border = "none";
        } else {
            this._createTabs();
            this.header.onclick = (e) => {
                //å³é­ææåç´  æ¯å¦ææ´ç®åçåæ³ï¼
                for (let i = 0; i < this.header.children.length; i++) {
                    this.header.children[i].setAttribute("class", "");
                }
                //æå¼ç¹å»åå®¹åç´ 
                e.target.setAttribute("class", "on");
                this._createCityContent(e.target.innerHTML);
            };
        }

    }

    /**
     * @function CityTabsPage.prototype._createTabs
     * @description åå»º Tabs
     * @private
     */
    _createTabs() {
        //header
        if (Util.isArray(this.config)) {
            for (let i = 0; i < this.config.length; i++) {
                let innerHTML = "";
                for (const key in this.config[i]) {
                    innerHTML += key;
                }
                let li = document.createElement("li");
                li.innerHTML = innerHTML;
                this.header.appendChild(li);
            }
        } else {
            for (const key in this.config) {
                let li = document.createElement("li");
                li.innerHTML = key;
                this.header.appendChild(li);
            }
        }
        this.header.firstChild.setAttribute("class", "on");
        this._createCityContent(this.header.firstChild.innerHTML);
    }

    /**
     * @function CityTabsPage.prototype._createCityContent
     * @description åå»ºåè¡¨å®¹å¨
     * @private
     */
    _createCityContent(keyName) {
        //æ¸é¤åç´ ï¼
        for (let i = this.content.children.length; i > 0; i--) {
            this.content.removeChild(this.content.children[i - 1]);
        }
        //åå»ºå¯¹åºåç´ 
        const cities = this.config[keyName];
        for (let key in cities) {
            this._createCityItem(key, cities[key]);
        }
    }

    /**
     * @function CityTabsPage.prototype._createCityContent
     * @description åå»ºåè¡¨å®¹å¨
     * @private
     */
    _createCityItem(key, cities) {
        const city = document.createElement("div");

        const cityClass = document.createElement("div");
        cityClass.setAttribute("class", "component-citytabpag__py-key");
        cityClass.innerHTML = key;
        city.appendChild(cityClass);

        const cityContent = document.createElement("div");
        cityContent.setAttribute("class", "component-citytabpag__content");

        for (let i = 0; i < cities.length; i++) {
            let span = document.createElement("span");
            span.innerHTML = cities[i];
            cityContent.appendChild(span);
        }
        //HOT åç´ é¿åº¦åç¬å¾®è°ï¼
        if (key === "HOT") {
            cityContent.style.width = "428px";
        }
        city.appendChild(cityContent);
        this.content.appendChild(city);
    }

}

;// CONCATENATED MODULE: ./src/common/components/templates/NavTabsPage.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class NavTabsPage
 * @aliasclass Components.NavTabsPage
 * @deprecatedclass SuperMap.Components.NavTabsPage
 * @classdesc æ ç­¾é¡µé¢ç»ä»¶ã
 * @version 9.1.1
 * @param {Object} options - ç»ä»¶éç½®åæ°ã
 * @param {string} options.id - ç»ä»¶ dom åç´  idã
 * @param {Array.<Object>} [options.tabs=[]] - æ ç­¾å¯¹è±¡æ°ç»ï¼å½¢å¦ï¼[{title: "",content: HTMLElement}]ï¼åå§æ¶ï¼ä¼ å¥ååå»ºé¡µé¢ã
 * @extends {TemplateBase}
 * @category Components Common
 * @usage
 */
//  todo æèæåçæ§ä»¶åºè¯¥ä»¥åªç§æ¹å¼ä½¿ç¨
class NavTabsPage extends TemplateBase {
    constructor(options) {
        super(options);
        this.navTabsTitle = null;
        this.navTabsContent = null;
        options.tabs = options.tabs ? options.tabs : [];
        this._initView(options.tabs);
    }

    /**
     * @override
     * @private
     */
    _initView(tabs) {
        const navTabsPage = document.createElement("div");
        navTabsPage.setAttribute("class", "component-navtabspage");

        //å³é­æé®
        const closeBtn = document.createElement("span");
        closeBtn.setAttribute("class", "supermapol-icons-close");
        closeBtn.onclick = this.closeView.bind(this);
        navTabsPage.appendChild(closeBtn);

        //æ ç­¾
        const navTabsTitle = document.createElement("div");
        this.navTabsTitle = navTabsTitle;
        navTabsTitle.setAttribute("class", "component-navtabspage__title");
        navTabsPage.appendChild(navTabsTitle);

        //åå®¹
        const navTabsContent = document.createElement("div");
        this.navTabsContent = navTabsContent;
        navTabsContent.setAttribute("class", "component-navtabspage__content");
        navTabsPage.appendChild(navTabsContent);

        //è¥ tabs åå§ä¼ å¥å¼ï¼å
        if (tabs.length > 0) {
            this.appendTabs(tabs);
        }

        this.rootContainer = navTabsPage;
    }

    /**
     * @function NavTabsPage.prototype.setTabs
     * @description è®¾ç½®æ ç­¾ã
     * @param {Array.<Object>} tabs - æ ç­¾å¯¹è±¡æ°ç»ï¼å½¢å¦ï¼[{title: "",content: {}}]ã
     */
    setTabs(tabs) {
        this.removeAllTabs();
        this.appendTabs(tabs);
    }

    /**
     * @function NavTabsPage.prototype.appendTabs
     * @description æ·»å æ ç­¾é¡µé¢ã
     * @param {Array.<Object>} tabs - æ ç­¾å¯¹è±¡æ°ç»ï¼å½¢å¦ï¼[{title: "",content: {}}]ã
     */
    appendTabs(tabs) {
        for (let i = 0; i < tabs.length; i++) {
            let title = document.createElement("span");
            title.index = i;
            title.appendChild(document.createTextNode(tabs[i].title));
            //ç»å®æ ç­¾åæ¢å¯¹åºé¡µé¢ï¼
            title.onclick = this._changeTabsPage.bind(this);
            let content = tabs[i].content;
            content.index = i;
            content.hidden = true;

            this.navTabsTitle.appendChild(title);
            this.navTabsContent.appendChild(content);
        }
        //todo ç¡®è®¤æ¯å¦ä¸¤ä¸ªå­åç´ ç index ç¸äºå¯¹åº
        //é»è®¤æ¾ç¤ºç¬¬ä¸ä¸ªæ ç­¾å¯¹è±¡
        this.navTabsTitle.firstChild.setAttribute("class", "component-navtabspage__tabs--select");
        this.navTabsContent.firstChild.hidden = false;
    }

    /**
     * @function NavTabsPage.prototype.removeTab
     * @description å é¤æä¸ªæ ç­¾é¡µé¢ã
     * @param {number} index - æ ç­¾ç´¢å¼å·ã
     */
    removeTab(index) {
        this.navTabsTitle.removeChild(this.navTabsTitle.children[index]);
        this.navTabsContent.removeChild(this.navTabsContent.children[index]);
    }

    /**
     * @function NavTabsPage.prototype.removeAllTabs
     * @description å é¤æææ ç­¾ã
     */
    removeAllTabs() {
        for (let i = this.navTabsTitle.children.length; i > 0; i--) {
            this.navTabsTitle.removeChild(this.navTabsTitle.children[i]);
            this.navTabsContent.removeChild(this.navTabsContent.children[i]);
        }
    }

    _changeTabsPage(e) {
        const index = e.target.index;
        for (let i = 0; i < this.navTabsTitle.children.length; i++) {
            this.navTabsTitle.children[i].setAttribute("class", "");
            this.navTabsContent.children[i].hidden = true;
            if (i === index) {
                this.navTabsTitle.children[i].setAttribute("class", "component-navtabspage__tabs--select");
                this.navTabsContent.children[i].hidden = false;
            }
        }
    }

}

;// CONCATENATED MODULE: ./src/common/components/templates/PaginationContainer.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class PaginationContainer
 * @aliasclass Components.PaginationContainer
 * @deprecatedclass SuperMap.Components.PaginationContainer
 * @classdesc åé¡µç»ä»¶æ¨¡æ¿ã
 * @version 9.1.1
 * @param {Object} options - ç»ä»¶éç½®åæ°ã
 * @param {string} options.id - ç»ä»¶ dom åç´  idã
 * @param {HTMLElement} options.contents - é¡µé¢å¡«åç DOM åç´ å¯¹è±¡ã
 * @param {number} options.pageCounts - é¡µæ°ã
 * @extends {TemplateBase}
 * @category Components Common
 * @usage
 */
class PaginationContainer extends TemplateBase {
    constructor(options) {
        options = options ? options : {};
        super(options);
        this.currentPage = 0;
        this.pageNumberLis = [];
        this.currentPageNumberLis = [];
        this.linkageEvent = null;

        options.contents = options.contents ? options.contents : null;
        options.pageCounts = options.pageCounts ? options.pageCounts : 0;
        this._initView(options.contents, options.pageCounts);
    }

    /**
     * @function PaginationContainer.prototype.setLinkageEvent
     * @description è®¾ç½®é¡µé¢èå¨æ¹æ³ã
     * @param {function} linkageEvent - èå¨æ¹æ³ï¼å®ç°æå®åè½ã
     */
    setLinkageEvent(linkageEvent) {
        this.linkageEvent = linkageEvent;
    }

    /**
     * @private
     * @override
     */
    _initView(contents, pageCounts) {
        const container = document.createElement("div");
        container.setAttribute("class", "component-pagination");

        //content
        const content = document.createElement("div");
        content.setAttribute("class", "component-pagination__content");
        container.appendChild(content);
        this.content = content;

        //link
        const link = document.createElement("ul");
        link.setAttribute("class", "component-pagination__link");
        link.onclick = this._changePageEvent.bind(this);
        container.appendChild(link);
        this._createLink(link);
        this.link = link;
        //å¡«ååå®¹ï¼
        if (contents) {
            this.setContent(contents);
        }
        if (pageCounts !== 0) {
            this.setPageLink(pageCounts);
        }
        this.rootContainer = container;
    }

    /**---------ä»¥ä¸æ¯é¡µé¢ç¸å³æä½ **/
    /**
     * @function PaginationContainer.prototype.setContent
     * @description è®¾ç½®é¡µé¢åå®¹ã
     * @param {HTMLElement} element - é¡µé¢åå®¹åç´ ã
     */
    setContent(element) {
        this.clearContent();
        this.appendContent(element);
    }

    /**
     * @function PaginationContainer.prototype.appendContent
     * @description è¿½å åå®¹ã
     * @param {HTMLElement} element - é¡µé¢åå®¹åç´ ã
     */
    appendContent(element) {
        this.content.appendChild(element);
    }

    /**
     * @function PaginationContainer.prototype.clearContent
     * @description æ¸ç©ºåå®¹åç´ ã
     */
    clearContent() {
        for (let i = this.content.children.length - 1; i >= 0; i--) {
            this.content.removeChild(this.content.children[i]);
        }
    }

    /** -----ä»¥ä¸æ¯é¡µç ç¸å³çæä½ï¼**/
    /**
     * @function PaginationContainer.prototype.setPageLink
     * @description è®¾ç½®é¡µç æ°ã
     * @param {number} pageNumber - é¡µç æ°ã
     */
    setPageLink(pageNumber) {
        //æ¸ç©ºå½åé¡µç 
        this.pageNumberLis = [];
        this.currentPageNumberLis = [];
        this.clearPageLink();

        //åå»ºé¡µç 
        this._createPageLi(pageNumber);
        //æ·»å é¡µç å°é¡µç åè¡¨
        this._appendPageLink();
    }

    /**
     * @description åå»ºé¡µç ã
     * @param pageNumber
     * @private
     */
    _createPageLi(pageNumber) {
        for (let i = 0; i < pageNumber; i++) {
            const pageLi = document.createElement("li");
            pageLi.innerHTML = i + 1;
            /*const liContent = document.createElement("span");
            liContent.innerHTML = i + 1;*/
            // pageLi.appendChild(liContent);
            this.pageNumberLis.push(pageLi);
        }
        this.pageNumberLis[0].setAttribute("class", "active");
        this.currentPage = 1;
        if (pageNumber < 5) {
            this.currentPageNumberLis = this.pageNumberLis;
        } else {
            for (let i = 0; i < 5; i++) {
                this.currentPageNumberLis.push(this.pageNumberLis[i]);
            }
        }
    }

    /**
     * @description æ·»å é¡µç å°é¡µç åè¡¨ã
     * @private
     */
    _appendPageLink() {
        //todo å¦ä½æå¥ä¸­é´
        for (let i = 0; i < this.currentPageNumberLis.length; i++) {
            this.link.insertBefore(this.currentPageNumberLis[i], this.link.childNodes[this.link.children.length - 2]);
        }

        for (let i = 0; i < this.currentPageNumberLis.length; i++) {
            //æ¸ç©º active ç¶æ
            this.currentPageNumberLis[i].setAttribute("class", "");
            //ç»å½åéä¸­ç li èµå¼  active ç¶æ
            if (Number(this.currentPageNumberLis[i].innerHTML) === this.currentPage) {
                this.currentPageNumberLis[i].setAttribute("class", "active");
            }
        }

        //æ ¹æ® currentPage æ¹åæé®ç¶æ
        this._changeDisableState();

        if (this.linkageEvent) {
            this.linkageEvent(this.currentPage);
        }

    }

    /**
     * @function PaginationContainer.prototype.clearPageLink
     * @description æ¸é¤é¡µç åè¡¨ã
     */
    clearPageLink() {
        for (let i = this.link.children.length - 3; i > 1; i--) {
            this.link.removeChild(this.link.children[i]);
        }
    }

    /**
     * @description åå»ºé¡µç æé®ã
     * @param ul
     * @private
     */
    _createLink(ul) {
        for (let i = 0; i < 4; i++) {
            const li = document.createElement("li");
            li.setAttribute("class", "disable");
            const liContent = document.createElement("span");
            li.appendChild(liContent);
            if (i === 0) {
                liContent.id = "first";
                liContent.setAttribute("class", "supermapol-icons-first");
            } else if (i === 1) {
                liContent.id = "prev";
                liContent.setAttribute("class", "supermapol-icons-prev");
            } else if (i === 2) {
                liContent.id = "next";
                liContent.setAttribute("class", "supermapol-icons-next");
            } else if (i === 3) {
                liContent.id = "last";
                liContent.setAttribute("class", "supermapol-icons-last");
            }

            ul.appendChild(li);
        }
    }

    /**
     * @description ç¹å»é¡µç äºä»¶ã
     * @param e
     * @private
     */
    _changePageEvent(e) {
        //todo
        const trigger = e.target;
        //è¥åè¡¨ç¦ç¨ï¼ç¹å»æ æ
        if (trigger.parentElement.classList[0] === "disable") {
            return;
        }
        let targetLi;
        if (trigger.id) {
            targetLi = trigger.id;
        } else if (Number(trigger.innerHTML)) {
            targetLi = Number(trigger.innerHTML);
        } else {
            return;
        }

        //é¡µç é¢å¤çï¼
        this._prePageNum(targetLi);


        //æ ¹æ® currentPageNumberLis åå»ºé¡µç åè¡¨
        this.clearPageLink();
        this._appendPageLink();
    }

    /**
     * @description æ ¹æ® currentPage æ¹åæé®ç¶æã
     * @private
     */
    _changeDisableState() {
        this.link.children[0].setAttribute("class", "");
        this.link.children[1].setAttribute("class", "");
        this.link.children[this.link.children.length - 1].setAttribute("class", "");
        this.link.children[this.link.children.length - 2].setAttribute("class", "");

        if (this.currentPage === 1) {
            this.link.children[0].setAttribute("class", "disable");
            this.link.children[1].setAttribute("class", "disable");
        }
        if (this.currentPage === this.pageNumberLis.length) {
            this.link.children[this.link.children.length - 1].setAttribute("class", "disable");
            this.link.children[this.link.children.length - 2].setAttribute("class", "disable");
        }

    }

    /**
     * @description æ ¹æ®ç¹å»é¡µç åè¡¨äºä»¶åå¤éå±ç°çé¡µç åè¡¨ã
     * @param {string|number} targetLi - è¢«ç¹å»çåè¡¨å¯¹è±¡ id æ è¢«ç¹å»çé¡µç å¼ã
     * @private
     */
    _prePageNum(targetLi) {
        const currentPageNumberLis = [];
        if (targetLi === "first") {
            this.currentPage = 1;
        } else if (targetLi === "last") {
            this.currentPage = this.pageNumberLis.length;
        } else if (targetLi === "prev") {
            this.currentPage = this.currentPage - 1;

        } else if (targetLi === "next") {
            this.currentPage = this.currentPage + 1;
        } else {
            this.currentPage = targetLi;
        }

        if (this.pageNumberLis.length <= 5) {
            for (let i = 0; i < this.pageNumberLis.length; i++) {
                currentPageNumberLis.push(this.pageNumberLis[i]);
            }
        } else {
            //å½åç¹å»åä¸ï¼é½ååäº
            if (this.currentPage <= 3) {
                for (let i = 0; i < 5; i++) {
                    currentPageNumberLis.push(this.pageNumberLis[i]);
                }
            } else if (this.currentPage >= this.pageNumberLis.length - 3) {
                //ç¹å»åä¸ï¼é½åå5
                for (let i = this.pageNumberLis.length - 5; i < this.pageNumberLis.length; i++) {
                    currentPageNumberLis.push(this.pageNumberLis[i]);
                }
            } else {
                //å¶ä»ï¼åä¸­é´ï¼
                for (let i = this.currentPage - 3; i <= this.currentPage + 1; i++) {
                    currentPageNumberLis.push(this.pageNumberLis[i]);
                }
            }

        }
        if (currentPageNumberLis.length > 0) {
            this.currentPageNumberLis = currentPageNumberLis;
        }
    }

}

;// CONCATENATED MODULE: ./src/common/components/util/Util.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @name ComponentsUtil
 * @namespace
 * @category BaseTypes Util
 * @description è·åæä»¶ç±»åå·¥å·ç±»ã
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.ComponentsUtil.getFileType(fileName);
 *
 * </script>
 * // ES6 Import
 * import { ComponentsUtil } from '{npm}';
 *
 * const result = ComponentsUtil.getFileType(fileName);
 * ```
 */
let ComponentsUtil = {
    /**
     * @function ComponentsUtil.getFileType
     * @description è·åä¸ä¼ æä»¶ç±»åã
     * @param {string} fileName - æä»¶åç§°ã
     */
    getFileType(fileName) {
        let regCSV = /^.*\.(?:csv)$/i;
        let regExcel = /^.*\.(?:xls|xlsx)$/i; //æä»¶åå¯ä»¥å¸¦ç©ºæ ¼
        let regGeojson = /^.*\.(?:geojson|json)$/i;
        if (regExcel.test(fileName)) { //æ ¡éªä¸éè¿
            return CommonTypes_FileTypes.EXCEL;
        } else if (regCSV.test(fileName)) {
            return CommonTypes_FileTypes.CSV;
        } else if (regGeojson.test(fileName)) {
            return CommonTypes_FileTypes.GEOJSON;
        }
        return null;
    }

};

;// CONCATENATED MODULE: ./src/common/components/util/index.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





;// CONCATENATED MODULE: ./src/common/components/index.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
//æ°æ®

//ç»ä»¶

//æç¤ºæ¡ç»ä»¶

//å¾è¡¨ç»ä»¶


//å¬ç¨æ¨¡æ¿ï¼











//å·¥å·ç±»





















;// CONCATENATED MODULE: ./src/common/lang/index.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/








;// CONCATENATED MODULE: ./src/common/index.common.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



































;// CONCATENATED MODULE: ./src/common/index.all.js








;// CONCATENATED MODULE: ./src/common/namespace.js
/* CopyrightÂ© 2000 - 2021 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
/* CopyrightÂ© 2000 - 2021 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/







// Lang
SuperMap.Lang = Lang;
SuperMap.i18n = SuperMap.Lang.i18n;
// CommonUtil
SuperMap.Util = { ...SuperMap.Util, ...Util };
SuperMap.Browser = Browser;
SuperMap.INCHES_PER_UNIT = INCHES_PER_UNIT;
SuperMap.METERS_PER_INCH = METERS_PER_INCH;
SuperMap.DOTS_PER_INCH = DOTS_PER_INCH;
SuperMap.IS_GECKO = IS_GECKO;

// FetchRequest
SuperMap.setCORS = setCORS;
SuperMap.isCORS = isCORS;
SuperMap.setRequestTimeout = setRequestTimeout;
SuperMap.getRequestTimeout = getRequestTimeout;
SuperMap.FetchRequest = FetchRequest;

// commontypes
SuperMap.inherit = inheritExt;
SuperMap.mixin = mixinExt;
SuperMap.String = StringExt;
SuperMap.Number = NumberExt;
SuperMap.Function = FunctionExt;
SuperMap.Array = ArrayExt;
SuperMap.Date = DateExt;
SuperMap.Event = Event;
SuperMap.Bounds = Bounds;
SuperMap.Credential = Credential;
SuperMap.Events = Events;
SuperMap.Feature = Feature;
SuperMap.Geometry = Geometry;
SuperMap.Pixel = Pixel;
SuperMap.Size = Size;
SuperMap.Feature.Vector = Vector;
SuperMap.Geometry.Collection = Collection;
SuperMap.Geometry.Curve = Curve;
SuperMap.Geometry.GeoText = GeoText;
SuperMap.Geometry.LinearRing = LinearRing;
SuperMap.Geometry.LineString = LineString;
SuperMap.Geometry.MultiLineString = MultiLineString;
SuperMap.Geometry.MultiPoint = MultiPoint;
SuperMap.Geometry.MultiPolygon = MultiPolygon;
SuperMap.Geometry.Point = Point;
SuperMap.Geometry.Polygon = Polygon;
SuperMap.Geometry.Rectangle = Rectangle;
// Components
SuperMap.Components.Chart = ChartView;
SuperMap.Components.ChartViewModel = ChartViewModel;
SuperMap.Components.MessageBox = MessageBox;
SuperMap.Components.AttributesPopContainer = AttributesPopContainer;
SuperMap.Components.CityTabsPage = CityTabsPage;
SuperMap.Components.CommonContainer = CommonContainer;
SuperMap.Components.DropDownBox = DropDownBox;
SuperMap.Components.IndexTabsPageContainer = IndexTabsPageContainer;
SuperMap.Components.NavTabsPage = NavTabsPage;
SuperMap.Components.PaginationContainer = PaginationContainer;
SuperMap.Components.PopContainer = PopContainer;
SuperMap.Components.Select = Select;
SuperMap.Components.TemplateBase = TemplateBase;
SuperMap.Components.FileReaderUtil = FileReaderUtil;
// control
SuperMap.TimeControlBase = TimeControlBase;
SuperMap.TimeFlowControl = TimeFlowControl;
// Format
SuperMap.Format = SuperMap.Format || Format;
SuperMap.Format.GeoJSON = GeoJSON;
SuperMap.Format.JSON = JSONFormat;
SuperMap.Format.WKT = WKT;
// iManager
SuperMap.iManager = IManager;
SuperMap.iManagerCreateNodeParam = IManagerCreateNodeParam;
SuperMap.iManagerServiceBase = IManagerServiceBase;
// iPortal
SuperMap.iPortal = IPortal;
SuperMap.iPortalAddDataParam = IPortalAddDataParam;
SuperMap.iPortalAddResourceParam = IPortalAddResourceParam;
SuperMap.iPortalDataConnectionInfoParam = IPortalDataConnectionInfoParam;
SuperMap.iPortalDataMetaInfoParam = IPortalDataMetaInfoParam;
SuperMap.iPortalDataStoreInfoParam = IPortalDataStoreInfoParam;
SuperMap.iPortalQueryParam = IPortalQueryParam;
SuperMap.iPortalQueryResult = IPortalQueryResult;
SuperMap.iPortalRegisterServiceParam = IPortalRegisterServiceParam;
SuperMap.iPortalResource = IPortalResource;
SuperMap.iPortalServiceBase = IPortalServiceBase;
SuperMap.iPortalShareEntity = IPortalShareEntity;
SuperMap.iPortalShareParam = IPortalShareParam;
SuperMap.iPortalUser = IPortalUser;
// iServer
SuperMap.AddressMatchService = AddressMatchService_AddressMatchService;
SuperMap.AggregationParameter = AggregationParameter;
SuperMap.AreaSolarRadiationParameters = AreaSolarRadiationParameters;
SuperMap.AreaSolarRadiationService = AreaSolarRadiationService;
SuperMap.BucketAggParameter = BucketAggParameter;
SuperMap.BufferAnalystParameters = BufferAnalystParameters;
SuperMap.BufferAnalystService = BufferAnalystService;
SuperMap.BufferDistance = BufferDistance;
SuperMap.BuffersAnalystJobsParameter = BuffersAnalystJobsParameter;
SuperMap.BuffersAnalystJobsService = BuffersAnalystJobsService;
SuperMap.BufferSetting = BufferSetting;
SuperMap.BurstPipelineAnalystParameters = BurstPipelineAnalystParameters;
SuperMap.BurstPipelineAnalystService = BurstPipelineAnalystService;
SuperMap.ChartFeatureInfoSpecsService = ChartFeatureInfoSpecsService;
SuperMap.ChartQueryFilterParameter = ChartQueryFilterParameter;
SuperMap.ChartQueryParameters = ChartQueryParameters;
SuperMap.ChartQueryService = ChartQueryService;
SuperMap.ClipParameter = ClipParameter;
SuperMap.ColorDictionary = ColorDictionary;
SuperMap.CommonServiceBase = CommonServiceBase;
SuperMap.ComputeWeightMatrixParameters = ComputeWeightMatrixParameters;
SuperMap.ComputeWeightMatrixService = ComputeWeightMatrixService;
SuperMap.CreateDatasetParameters = CreateDatasetParameters;
SuperMap.DataFlowService = DataFlowService_DataFlowService;
SuperMap.DataReturnOption = DataReturnOption;
SuperMap.DatasetBufferAnalystParameters = DatasetBufferAnalystParameters;
SuperMap.DatasetInfo = DatasetInfo;
SuperMap.DatasetOverlayAnalystParameters = DatasetOverlayAnalystParameters;
SuperMap.DatasetService = DatasetService_DatasetService;
SuperMap.DatasetSurfaceAnalystParameters = DatasetSurfaceAnalystParameters;
SuperMap.DatasetThiessenAnalystParameters = DatasetThiessenAnalystParameters;
SuperMap.DatasourceConnectionInfo = DatasourceConnectionInfo;
SuperMap.DatasourceService = DatasourceService_DatasourceService;
SuperMap.DensityAnalystService = DensityAnalystService;
SuperMap.DensityKernelAnalystParameters = DensityKernelAnalystParameters;
SuperMap.EditFeaturesParameters = EditFeaturesParameters;
SuperMap.EditFeaturesService = EditFeaturesService;
SuperMap.FacilityAnalyst3DParameters = FacilityAnalyst3DParameters;
SuperMap.FacilityAnalystSinks3DParameters = FacilityAnalystSinks3DParameters;
SuperMap.FacilityAnalystSinks3DService = FacilityAnalystSinks3DService;
SuperMap.FacilityAnalystSources3DParameters = FacilityAnalystSources3DParameters;
SuperMap.FacilityAnalystSources3DService = FacilityAnalystSources3DService;
SuperMap.FacilityAnalystStreamParameters = FacilityAnalystStreamParameters;
SuperMap.FacilityAnalystStreamService = FacilityAnalystStreamService;
SuperMap.FacilityAnalystTracedown3DParameters = FacilityAnalystTracedown3DParameters;
SuperMap.FacilityAnalystTracedown3DService = FacilityAnalystTracedown3DService;
SuperMap.FacilityAnalystTraceup3DParameters = FacilityAnalystTraceup3DParameters;
SuperMap.FacilityAnalystTraceup3DService = FacilityAnalystTraceup3DService;
SuperMap.FacilityAnalystUpstream3DParameters = FacilityAnalystUpstream3DParameters;
SuperMap.FacilityAnalystUpstream3DService = FacilityAnalystUpstream3DService;
SuperMap.FieldParameters = FieldParameters;
SuperMap.FieldsFilter = FieldsFilter;
SuperMap.FieldStatisticService = FieldStatisticService;
SuperMap.FieldStatisticsParameters = FieldStatisticsParameters;
SuperMap.FilterParameter = FilterParameter;
SuperMap.FindClosestFacilitiesParameters = FindClosestFacilitiesParameters;
SuperMap.FindClosestFacilitiesService = FindClosestFacilitiesService;
SuperMap.FindLocationParameters = FindLocationParameters;
SuperMap.FindLocationService = FindLocationService;
SuperMap.FindMTSPPathsParameters = FindMTSPPathsParameters;
SuperMap.FindMTSPPathsService = FindMTSPPathsService;
SuperMap.FindPathParameters = FindPathParameters;
SuperMap.FindPathService = FindPathService;
SuperMap.FindServiceAreasParameters = FindServiceAreasParameters;
SuperMap.FindServiceAreasService = FindServiceAreasService;
SuperMap.FindTSPPathsParameters = FindTSPPathsParameters;
SuperMap.FindTSPPathsService = FindTSPPathsService;
SuperMap.GenerateSpatialDataParameters = GenerateSpatialDataParameters;
SuperMap.GenerateSpatialDataService = GenerateSpatialDataService;
SuperMap.GeoCodingParameter = GeoCodingParameter;
SuperMap.GeoDecodingParameter = GeoDecodingParameter;
SuperMap.GeoHashGridAggParameter = GeoHashGridAggParameter;
SuperMap.GeometryBatchAnalystService = GeometryBatchAnalystService;
SuperMap.GeometryBufferAnalystParameters = GeometryBufferAnalystParameters;
SuperMap.GeometryOverlayAnalystParameters = GeometryOverlayAnalystParameters;
SuperMap.GeometrySurfaceAnalystParameters = GeometrySurfaceAnalystParameters;
SuperMap.GeometryThiessenAnalystParameters = GeometryThiessenAnalystParameters;
SuperMap.GeoprocessingService = GeoprocessingService_GeoprocessingService;
SuperMap.GeoRelationAnalystParameters = GeoRelationAnalystParameters;
SuperMap.GeoRelationAnalystService = GeoRelationAnalystService;
SuperMap.GetFeaturesByBoundsParameters = GetFeaturesByBoundsParameters;
SuperMap.GetFeaturesByBoundsService = GetFeaturesByBoundsService;
SuperMap.GetFeaturesByBufferParameters = GetFeaturesByBufferParameters;
SuperMap.GetFeaturesByBufferService = GetFeaturesByBufferService;
SuperMap.GetFeaturesByGeometryParameters = GetFeaturesByGeometryParameters;
SuperMap.GetFeaturesByGeometryService = GetFeaturesByGeometryService;
SuperMap.GetFeaturesByIDsParameters = GetFeaturesByIDsParameters;
SuperMap.GetFeaturesByIDsService = GetFeaturesByIDsService;
SuperMap.GetFeaturesBySQLParameters = GetFeaturesBySQLParameters;
SuperMap.GetFeaturesBySQLService = GetFeaturesBySQLService;
SuperMap.GetFeaturesParametersBase = GetFeaturesParametersBase;
SuperMap.GetFeaturesServiceBase = GetFeaturesServiceBase;
SuperMap.GetFieldsService = GetFieldsService;
SuperMap.GetGridCellInfosParameters = GetGridCellInfosParameters;
SuperMap.GetGridCellInfosService = GetGridCellInfosService;
SuperMap.GetLayersInfoService = GetLayersInfoService;
SuperMap.Grid = Grid;
SuperMap.HillshadeParameter = HillshadeParameter;
SuperMap.Image = UGCImage;
SuperMap.ImageCollectionService = ImageCollectionService_ImageCollectionService;
SuperMap.ImageGFAspect = ImageGFAspect;
SuperMap.ImageGFHillShade = ImageGFHillShade;
SuperMap.ImageGFOrtho = ImageGFOrtho;
SuperMap.ImageGFSlope = ImageGFSlope;
SuperMap.ImageRenderingRule = ImageRenderingRule;
SuperMap.ImageSearchParameter = ImageSearchParameter;
SuperMap.ImageService = ImageService_ImageService;
SuperMap.ImageStretchOption = ImageStretchOption;
SuperMap.InterpolationAnalystParameters = InterpolationAnalystParameters;
SuperMap.InterpolationAnalystService = InterpolationAnalystService;
SuperMap.InterpolationDensityAnalystParameters = InterpolationDensityAnalystParameters;
SuperMap.InterpolationIDWAnalystParameters = InterpolationIDWAnalystParameters;
SuperMap.InterpolationKrigingAnalystParameters = InterpolationKrigingAnalystParameters;
SuperMap.InterpolationRBFAnalystParameters = InterpolationRBFAnalystParameters;
SuperMap.JoinItem = JoinItem;
SuperMap.KernelDensityJobParameter = KernelDensityJobParameter;
SuperMap.KernelDensityJobsService = KernelDensityJobsService;
SuperMap.LabelImageCell = LabelImageCell;
SuperMap.LabelMatrixCell = LabelMatrixCell;
SuperMap.LabelMixedTextStyle = LabelMixedTextStyle;
SuperMap.LabelSymbolCell = LabelSymbolCell;
SuperMap.LabelThemeCell = LabelThemeCell;
SuperMap.LayerStatus = LayerStatus;
SuperMap.LinkItem = LinkItem;
SuperMap.MappingParameters = MappingParameters;
SuperMap.MapService = MapService_MapService;
SuperMap.MathExpressionAnalysisParameters = MathExpressionAnalysisParameters;
SuperMap.MathExpressionAnalysisService = MathExpressionAnalysisService;
SuperMap.MeasureParameters = MeasureParameters;
SuperMap.MeasureService = MeasureService_MeasureService;
SuperMap.MetricsAggParameter = MetricsAggParameter;
SuperMap.NDVIParameter = NDVIParameter;
SuperMap.NetworkAnalystServiceBase = NetworkAnalystServiceBase;
SuperMap.OutputSetting = OutputSetting;
SuperMap.OverlapDisplayedOptions = OverlapDisplayedOptions;
SuperMap.OverlayAnalystParameters = OverlayAnalystParameters;
SuperMap.OverlayAnalystService = OverlayAnalystService;
SuperMap.OverlayGeoJobParameter = OverlayGeoJobParameter;
SuperMap.OverlayGeoJobsService = OverlayGeoJobsService;
SuperMap.PointWithMeasure = PointWithMeasure;
SuperMap.ProcessingServiceBase = ProcessingServiceBase;
SuperMap.QueryByBoundsParameters = QueryByBoundsParameters;
SuperMap.QueryByBoundsService = QueryByBoundsService;
SuperMap.QueryByDistanceParameters = QueryByDistanceParameters;
SuperMap.QueryByDistanceService = QueryByDistanceService;
SuperMap.QueryByGeometryParameters = QueryByGeometryParameters;
SuperMap.QueryByGeometryService = QueryByGeometryService;
SuperMap.QueryBySQLParameters = QueryBySQLParameters;
SuperMap.QueryBySQLService = QueryBySQLService;
SuperMap.QueryParameters = QueryParameters;
SuperMap.QueryService = QueryService;
SuperMap.RasterFunctionParameter = RasterFunctionParameter;
SuperMap.Route = Route;
SuperMap.RouteCalculateMeasureParameters = RouteCalculateMeasureParameters;
SuperMap.RouteCalculateMeasureService = RouteCalculateMeasureService;
SuperMap.RouteLocatorParameters = RouteLocatorParameters;
SuperMap.RouteLocatorService = RouteLocatorService;
SuperMap.ServerColor = ServerColor;
SuperMap.ServerFeature = ServerFeature;
SuperMap.ServerGeometry = ServerGeometry;
SuperMap.ServerStyle = ServerStyle;
SuperMap.ServerTextStyle = ServerTextStyle;
SuperMap.ServerTheme = ServerTheme;
SuperMap.SetDatasourceParameters = SetDatasourceParameters;
SuperMap.SetLayerInfoParameters = SetLayerInfoParameters;
SuperMap.SetLayerInfoService = SetLayerInfoService;
SuperMap.SetLayersInfoParameters = SetLayersInfoParameters;
SuperMap.SetLayersInfoService = SetLayersInfoService;
SuperMap.SetLayerStatusParameters = SetLayerStatusParameters;
SuperMap.SetLayerStatusService = SetLayerStatusService;
SuperMap.SingleObjectQueryJobsParameter = SingleObjectQueryJobsParameter;
SuperMap.SingleObjectQueryJobsService = SingleObjectQueryJobsService;
SuperMap.Sortby = Sortby;
SuperMap.SpatialAnalystBase = SpatialAnalystBase;
SuperMap.StopQueryParameters = StopQueryParameters;
SuperMap.StopQueryService = StopQueryService;
SuperMap.SummaryAttributesJobsParameter = SummaryAttributesJobsParameter;
SuperMap.SummaryAttributesJobsService = SummaryAttributesJobsService;
SuperMap.SummaryMeshJobParameter = SummaryMeshJobParameter;
SuperMap.SummaryMeshJobsService = SummaryMeshJobsService;
SuperMap.SummaryRegionJobParameter = SummaryRegionJobParameter;
SuperMap.SummaryRegionJobsService = SummaryRegionJobsService;
SuperMap.SupplyCenter = SupplyCenter;
SuperMap.SurfaceAnalystParameters = SurfaceAnalystParameters;
SuperMap.SurfaceAnalystParametersSetting = SurfaceAnalystParametersSetting;
SuperMap.SurfaceAnalystService = SurfaceAnalystService;
SuperMap.TerrainCurvatureCalculationParameters = TerrainCurvatureCalculationParameters;
SuperMap.TerrainCurvatureCalculationService = TerrainCurvatureCalculationService;
SuperMap.Theme = Theme;
SuperMap.ThemeDotDensity = ThemeDotDensity;
SuperMap.ThemeFlow = ThemeFlow;
SuperMap.ThemeGraduatedSymbol = ThemeGraduatedSymbol;
SuperMap.ThemeGraduatedSymbolStyle = ThemeGraduatedSymbolStyle;
SuperMap.ThemeGraph = ThemeGraph;
SuperMap.ThemeGraphAxes = ThemeGraphAxes;
SuperMap.ThemeGraphItem = ThemeGraphItem;
SuperMap.ThemeGraphSize = ThemeGraphSize;
SuperMap.ThemeGraphText = ThemeGraphText;
SuperMap.ThemeGridRange = ThemeGridRange;
SuperMap.ThemeGridRangeItem = ThemeGridRangeItem;
SuperMap.ThemeGridUnique = ThemeGridUnique;
SuperMap.ThemeGridUniqueItem = ThemeGridUniqueItem;
SuperMap.ThemeLabel = ThemeLabel;
SuperMap.ThemeLabelAlongLine = ThemeLabelAlongLine;
SuperMap.ThemeLabelBackground = ThemeLabelBackground;
SuperMap.ThemeLabelItem = ThemeLabelItem;
SuperMap.ThemeLabelText = ThemeLabelText;
SuperMap.ThemeLabelUniqueItem = ThemeLabelUniqueItem;
SuperMap.ThemeMemoryData = ThemeMemoryData;
SuperMap.ThemeOffset = ThemeOffset;
SuperMap.ThemeParameters = ThemeParameters;
SuperMap.ThemeRange = ThemeRange;
SuperMap.ThemeRangeItem = ThemeRangeItem;
SuperMap.ThemeService = ThemeService_ThemeService;
SuperMap.ThemeUnique = ThemeUnique;
SuperMap.ThemeUniqueItem = ThemeUniqueItem;
SuperMap.ThiessenAnalystParameters = ThiessenAnalystParameters;
SuperMap.ThiessenAnalystService = ThiessenAnalystService;
SuperMap.TilesetsService = TilesetsService;
SuperMap.TopologyValidatorJobsParameter = TopologyValidatorJobsParameter;
SuperMap.TopologyValidatorJobsService = TopologyValidatorJobsService;
SuperMap.TransferLine = TransferLine;
SuperMap.TransferPathParameters = TransferPathParameters;
SuperMap.TransferPathService = TransferPathService;
SuperMap.TransferSolutionParameters = TransferSolutionParameters;
SuperMap.TransferSolutionService = TransferSolutionService;
SuperMap.TransportationAnalystParameter = TransportationAnalystParameter;
SuperMap.TransportationAnalystResultSetting = TransportationAnalystResultSetting;
SuperMap.UGCLayer = UGCLayer;
SuperMap.UGCMapLayer = UGCMapLayer;
SuperMap.UGCSubLayer = UGCSubLayer;
SuperMap.UpdateDatasetParameters = UpdateDatasetParameters;
SuperMap.UpdateEdgeWeightParameters = UpdateEdgeWeightParameters;
SuperMap.UpdateEdgeWeightService = UpdateEdgeWeightService;
SuperMap.UpdateTurnNodeWeightParameters = UpdateTurnNodeWeightParameters;
SuperMap.UpdateTurnNodeWeightService = UpdateTurnNodeWeightService;
SuperMap.Vector = Vector_Vector;
SuperMap.VectorClipJobsParameter = VectorClipJobsParameter;
SuperMap.VectorClipJobsService = VectorClipJobsService;
SuperMap.WebPrintingJobContent = WebPrintingJobContent;
SuperMap.WebPrintingJobCustomItems = WebPrintingJobCustomItems;
SuperMap.WebPrintingJobExportOptions = WebPrintingJobExportOptions;
SuperMap.WebPrintingJobImage = WebPrintingJobImage;
SuperMap.WebPrintingJobLayers = WebPrintingJobLayers;
SuperMap.WebPrintingJobLayoutOptions = WebPrintingJobLayoutOptions;
SuperMap.WebPrintingJobLegendOptions = WebPrintingJobLegendOptions;
SuperMap.WebPrintingJobLittleMapOptions = WebPrintingJobLittleMapOptions;
SuperMap.WebPrintingJobNorthArrowOptions = WebPrintingJobNorthArrowOptions;
SuperMap.WebPrintingJobParameters = WebPrintingJobParameters;
SuperMap.WebPrintingJobScaleBarOptions = WebPrintingJobScaleBarOptions;
SuperMap.WebPrintingService = WebPrintingService;
//Online
SuperMap.Online = Online;
SuperMap.OnlineData = OnlineData;
SuperMap.OnlineQueryDatasParameter = OnlineQueryDatasParameter;
SuperMap.ServiceStatus = ServiceStatus;
// åå«onlineä¸­çDataItemTypeæ°æ®ç±»å
SuperMap.DataItemType = DataItemType;
SuperMap.DataItemOrderBy = DataItemOrderBy;
SuperMap.FilterField = FilterField;
SuperMap.OnlineServiceBase = OnlineServiceBase;
// overlay
SuperMap.Feature = SuperMap.Feature || {};
SuperMap.Feature.Theme = Theme_Theme;
SuperMap.Feature.Theme.Bar = Bar;
SuperMap.Feature.Theme.Bar3D = Bar3D;
SuperMap.Feature.Theme.Circle = Circle;
SuperMap.Feature.Theme.Graph = Graph;
SuperMap.Feature.Theme.Line = Line;
SuperMap.Feature.Theme.Pie = Pie;
SuperMap.Feature.Theme.Point = overlay_Point_Point;
SuperMap.Feature.Theme.RankSymbol = RankSymbol;
SuperMap.Feature.Theme.Ring = Ring;
SuperMap.Feature.Theme.ThemeVector = ThemeVector;
SuperMap.Feature.ShapeParameters = ShapeParameters;
SuperMap.Feature.ShapeParameters.Circle = Circle_Circle;
SuperMap.Feature.ShapeParameters.Image = Image_Image;
SuperMap.Feature.ShapeParameters.Label = Label;
SuperMap.Feature.ShapeParameters.Line = Line_Line;
SuperMap.Feature.ShapeParameters.Point = Point_Point;
SuperMap.Feature.ShapeParameters.Polygon = Polygon_Polygon;
SuperMap.Feature.ShapeParameters.Rectangle = Rectangle_Rectangle;
SuperMap.Feature.ShapeParameters.Sector = Sector;
SuperMap.Feature.ShapeFactory = ShapeFactory;
// LevelRenderer
SuperMap.LevelRenderer = LevelRenderer;

// security
SuperMap.KeyServiceParameter = KeyServiceParameter;
SuperMap.SecurityManager = SecurityManager;
SuperMap.ServerInfo = ServerInfo;
SuperMap.TokenServiceParameter = TokenServiceParameter;
// style
SuperMap.ThemeStyle = ThemeStyle;
SuperMap.CartoCSS = CartoCSS;
// thirdparty
// SuperMap.BinaryClassification = BinaryClassification;
// SuperMap.LandcoverClassification = LandcoverClassification;
// SuperMap.ObjectDetection = ObjectDetection;
// SuperMap.WebMachineLearning = WebMachineLearning;
SuperMap.ElasticSearch = ElasticSearch;
// util
SuperMap.ArrayStatistic = ArrayStatistic;
SuperMap.ColorsPickerUtil = ColorsPickerUtil;

// REST
SuperMap.DataFormat = DataFormat;
SuperMap.ServerType = ServerType;
SuperMap.GeometryType = GeometryType;
SuperMap.QueryOption = QueryOption;
SuperMap.JoinType = JoinType;
SuperMap.SpatialQueryMode = SpatialQueryMode;
SuperMap.SpatialRelationType = SpatialRelationType;
SuperMap.MeasureMode = MeasureMode;
SuperMap.Unit = Unit;
SuperMap.BufferRadiusUnit = BufferRadiusUnit;
SuperMap.EngineType = EngineType;
SuperMap.ThemeGraphTextFormat = ThemeGraphTextFormat;
SuperMap.ThemeGraphType = ThemeGraphType;
SuperMap.GraphAxesTextDisplayMode = GraphAxesTextDisplayMode;
SuperMap.GraduatedMode = GraduatedMode;
SuperMap.RangeMode = RangeMode;
SuperMap.ThemeType = ThemeType;
SuperMap.ColorGradientType = ColorGradientType;
SuperMap.TextAlignment = TextAlignment;
SuperMap.FillGradientMode = FillGradientMode;
SuperMap.AlongLineDirection = AlongLineDirection;
SuperMap.LabelBackShape = LabelBackShape;
SuperMap.LabelOverLengthMode = LabelOverLengthMode;
SuperMap.DirectionType = DirectionType;
SuperMap.OverlayOperationType = OverlayOperationType;
SuperMap.OutputType = OutputType;
SuperMap.SideType = SideType;
SuperMap.SupplyCenterType = SupplyCenterType;
SuperMap.TurnType = TurnType;
SuperMap.BufferEndType = BufferEndType;
SuperMap.SmoothMethod = SmoothMethod;
SuperMap.SurfaceAnalystMethod = SurfaceAnalystMethod;
SuperMap.DataReturnMode = DataReturnMode;
SuperMap.EditType = EditType;
SuperMap.TransferTactic = TransferTactic;
SuperMap.TransferPreference = TransferPreference;
SuperMap.GridType = GridType;
SuperMap.ColorSpaceType = ColorSpaceType;
SuperMap.LayerType = LayerType;
SuperMap.UGCLayerType = UGCLayerType;
SuperMap.StatisticMode = StatisticMode;
SuperMap.PixelFormat = PixelFormat;
SuperMap.SearchMode = SearchMode;
SuperMap.InterpolationAlgorithmType = InterpolationAlgorithmType;
SuperMap.VariogramMode = VariogramMode;
SuperMap.Exponent = Exponent;
SuperMap.ClientType = ClientType;
SuperMap.ChartType = ChartType;
SuperMap.ClipAnalystMode = ClipAnalystMode;
SuperMap.AnalystAreaUnit = AnalystAreaUnit;
SuperMap.AnalystSizeUnit = AnalystSizeUnit;
SuperMap.StatisticAnalystMode = StatisticAnalystMode;
SuperMap.SummaryType = SummaryType;
SuperMap.TopologyValidatorRule = TopologyValidatorRule;
SuperMap.BucketAggType = BucketAggType;
SuperMap.MetricsAggType = MetricsAggType;
SuperMap.GetFeatureMode = GetFeatureMode;
SuperMap.RasterFunctionType = RasterFunctionType;
SuperMap.ResourceType = ResourceType;
SuperMap.OrderBy = OrderBy;
SuperMap.OrderType = OrderType;
SuperMap.SearchType = SearchType;
SuperMap.AggregationTypes = AggregationTypes;
SuperMap.PermissionType = PermissionType;
SuperMap.EntityType = EntityType;
SuperMap.WebExportFormatType = WebExportFormatType;
SuperMap.WebScaleOrientationType = WebScaleOrientationType;
SuperMap.WebScaleType = WebScaleType;
SuperMap.WebScaleUnit = WebScaleUnit;


;// CONCATENATED MODULE: external "ol.Observable"
const external_ol_Observable_namespaceObject = ol.Observable;
var external_ol_Observable_default = /*#__PURE__*/__webpack_require__.n(external_ol_Observable_namespaceObject);
;// CONCATENATED MODULE: ./src/openlayers/services/ServiceBase.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class ServiceBase
 * @category iServer Core
 * @classdesc ol.supermap çæå¡åºç±»ã
 * @param {string} url - æå¡å°åã
 * @param {Object} options - åæ°ã
 * @param {string} [options.proxy] - æå¡ä»£çå°åã
 * @param {boolean} [options.withCredentials=false] - è¯·æ±æ¯å¦æºå¸¦ cookieã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @extends {ol.Observable}
 * @usage
 */
class ServiceBase extends (external_ol_Observable_default()) {
    constructor(url, options) {
        super(url, options);
        this.options = options || {};
        this.url = url;
        this.dispatchEvent({type: 'initialized', value: this});
    }
}

;// CONCATENATED MODULE: ./src/openlayers/services/MapService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class MapService
 * @category  iServer Map
 * @classdesc å°å¾ä¿¡æ¯æå¡ç±»ã
 * @extends {ServiceBase}
 * @param {string} url - æå¡å°åã
 * @param {Object} options - åæ°ã
 * @param {string} [options.proxy] - æå¡ä»£çå°åã
 * @param {boolean} [options.withCredentials=false] - è¯·æ±æ¯å¦æºå¸¦ cookieã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @example
 *   new MapService(url).getMapInfo(function(result){
 *           //doSomething
 *      })
 * @usage
 */
class MapService extends ServiceBase {
  constructor(url, options) {
    super(url, options);
  }

  /**
   * @function MapService.prototype.getMapInfo
   * @description å°å¾ä¿¡æ¯æ¥è¯¢æå¡ã
   * @param {RequestCallback} callback - åè°å½æ°ã
   * @returns {MapService} è·åæå¡ä¿¡æ¯ã
   */
  getMapInfo(callback) {
    var me = this;
    var getMapStatusService = new MapService_MapService(me.url, {
      proxy: me.options.proxy,
      withCredentials: me.options.withCredentials,
      crossOrigin: me.options.crossOrigin,
      headers: me.options.headers,
      eventListeners: {
        scope: me,
        processCompleted: callback,
        processFailed: callback
      },
      projection: me.options.projection
    });
    getMapStatusService.processAsync();
  }

  /**
   * @function  MapService.prototype.getWkt
   * @description è·åWKTã
   * @param {RequestCallback} callback - åè°å½æ°ã
   */
  getWkt(callback) {
    var me = this;
    var getMapStatusService = new MapService_MapService(`${me.url}/prjCoordSys.wkt`, {
      proxy: me.options.proxy,
      withCredentials: me.options.withCredentials,
      withoutFormatSuffix: true,
      crossOrigin: me.options.crossOrigin,
      headers: me.options.headers,
      eventListeners: {
        scope: me,
        processCompleted: callback,
        processFailed: callback
      },
      projection: me.options.projection
    });
    getMapStatusService.processAsync();
  }

  /**
   * @function MapService.prototype.getTilesets
   * @description åçåè¡¨ä¿¡æ¯æ¥è¯¢æå¡ã
   * @param {RequestCallback} callback - åè°å½æ°ã
   * @returns {MapService} è·åæå¡ä¿¡æ¯ã
   */
  getTilesets(callback) {
    var me = this;
    var tilesetsService = new TilesetsService(me.url, {
      proxy: me.options.proxy,
      withCredentials: me.options.withCredentials,
      crossOrigin: me.options.crossOrigin,
      headers: me.options.headers,
      eventListeners: {
        scope: me,
        processCompleted: callback,
        processFailed: callback
      }
    });
    tilesetsService.processAsync();
  }
}

;// CONCATENATED MODULE: external "ol.control.Control"
const external_ol_control_Control_namespaceObject = ol.control.Control;
var external_ol_control_Control_default = /*#__PURE__*/__webpack_require__.n(external_ol_control_Control_namespaceObject);
;// CONCATENATED MODULE: ./src/openlayers/control/ChangeTileVersion.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class ChangeTileVersion
 * @aliasclass control.ChangeTileVersion
 * @category  Control
 * @classdesc çæ¬åæ¢æ§ä»¶ï¼ç®åä»æ¯æ IE10 åä»¥ä¸ï¼ææ¶ä¸æ¯æèªå®ä¹ä½ç½®ã
 * @extends {ol.control.Control}
 * @param {Object} options -åæ°ã
 * @param {string} [options.title='switch tile version'] - æç¤ºä¿¡æ¯ã
 * @param {string} [options.tooltip='top'] - æç¤ºæ¾ç¤ºä½ç½® top | right | bottom | leftã
 * @param {boolean} [options.collapsed=true] - æ¯å¦æå ã
 * @param {string} [options.lastText='-'] - ä¸ä¸ä¸ªçæ¬çæé®å¸å±ã
 * @param {string} [options.nextText='+'] - ä¸ä¸ä¸ªçæ¬çæé®å¸å±ã
 * @param {string} [options.ico='V'] - æ§ä»¶æ¾ç¤ºçlogoã
 * @param {string} [options.orientation='horizontal'] - æ¹å horizontal|verticalã
 * @param {boolean} [options.switch=true] - æ¯å¦æ¾ç¤ºä¸/ä¸ä¸ä¸ªçæ¬åæ¢æ§ä»¶ã
 * @example
 * var control = new ChangeTileVersion({
 *           layer: baseLayer,
 *           orientation: "horizontal"
 *      });
 *      map.addControl(control)
 * @usage
 */
class ChangeTileVersion extends (external_ol_control_Control_default()) {
    constructor(options) {
        options = options || {};
        //é¼ æ æ»è¿æ¶æç¤º
        if (!options.title) {
            options.title = 'switch tile version';
        }
        //tooltipæç¤ºæ¾ç¤ºä½ç½® top | right | bottom | left
        if (!options.tooltip) {
            options.tooltip = 'top';
        }
        //æ¯å¦æå 
        if (!options.collapsed) {
            options.collapsed = true;
        }
        //ä¸ä¸ä¸ªçæ¬çæé®å¸å±
        if (!options.lastText) {
            options.lastText = '-';
        }
        //ä¸ä¸ä¸ªçæ¬çæé®å¸å±
        if (!options.nextText) {
            options.nextText = '+';
        }
        //æ§ä»¶æ¾ç¤ºçlogo
        if (!options.ico) {
            options.ico = 'V';
        }
        //æ¹åhorizontal|vertical
        if (options.orientation !== 'vertical') {
            options.orientation = 'horizontal';
        }
        //æ¯å¦æ¾ç¤ºä¸/ä¸ä¸ä¸ªçæ¬åæ¢æ§ä»¶
        if (!options.switch) {
            options.switch = true;
        }
        super(options);
        this.options = options;
        this.element = options.element = initLayout.call(this);

        if (options.layer) {
            this.setLayer(options.layer);
        }

        /**
         * @function ChangeTileVersion.prototype.initLayout
         * @description åå§åã
         */
        function initLayout() {
            var className = 'ol-control-ctv';
            this._container = createElement(
                'div',
                className + ' ' + className + '-' + options.orientation + ' ol-unselectable ol-control'
            );
            //æ­£å¸¸æåµä¸æ¾ç¤ºbtn
            this._sliderBtn = createElement('button', className + '-toggle', this._container);
            this._sliderBtn.setAttribute('title', options.title);
            this._sliderBtn.innerHTML = options.ico;

            //æ»åæå¨æ¶å¼æ¾ç¤ºåºå
            this._sliderValue = createElement('p', className + '-value', this._container);
            this._sliderValue.innerHTML = options.ico;
            this._sliderValue.setAttribute('title', options.title);

            var sliderClassName = 'ol-ctv-slider';
            this._sliderContent = createElement('div', sliderClassName + '-main' + '  tooltip', this._container);

            //tooltipæç¤ºæ¡
            if (options.orientation === 'vertical' && options.tooltip === 'top') {
                options.tooltip = 'right';
            }
            this.tooltip = createElement(
                'span',
                'tooltip-text' + '  ' + 'tooltip-' + options.tooltip,
                this._sliderContent
            );
            this.tooltip.innerHTML = options.ico;

            //å æ§ä»¶
            if (options.switch) {
                this._next = createElement(
                    'a',
                    sliderClassName + '-incdec' + ' ' + sliderClassName + '-next',
                    this._sliderContent
                );
                this._next.innerHTML = options.nextText;
                addDomEvent(this._next, 'click', this.nextTilesVersion, this);
                this._container.classList.add(className + '-incdec');
            }

            //æ»å
            this._sliderContainer = createElement('div', sliderClassName + '-container', this._sliderContent);
            this.slider = createElement('input', sliderClassName, this._sliderContainer);

            this.min = this.min == null || isNaN(this.min) ? 0 : parseInt(this.min);
            this.slider.setAttribute('title', options.title);
            this.slider.setAttribute('id', 'slider');
            this.slider.setAttribute('type', 'range');
            this.slider.setAttribute('min', this.min);
            this.slider.setAttribute('max', 0);
            this.slider.setAttribute('step', 1);
            this.slider.setAttribute('value', 0);

            // //å¤æ­æµè§å¨æ¯å¦æ¯æRangeæ»å¨æ¡
            // if (this.slider.type == "text") {
            //     console.error("æ±æ­ï¼æ¨çæµè§å¨ä¸æ¯æHTML5 rangeæ»å¨æ¡ï¼è¯·ä½¿ç¨é«çæ¬æµè§å¨");
            // }
            this.firstLoad = true;
            if ('oninput' in this.slider || 'onchange' in this.slider) {
                addDomEvent(this.slider, 'change', tilesVersion, this);
            } else {
                this.slider.onpropertychange = tilesVersion;
            }

            //åæ§ä»¶
            if (options.switch) {
                this._last = createElement(
                    'a',
                    sliderClassName + '-incdec' + ' ' + sliderClassName + '-last',
                    this._sliderContent
                );
                this._last.innerHTML = options.lastText;
                addDomEvent(this._last, 'click', this.lastTilesVersion, this);
            }

            // if (window.matchMedia("screen and (-webkit-min-device-pixel-ratio:0)").matches && options.orientation == 'vertical') {
            if (options.orientation == 'vertical') {
                this.slider.style.width = 170 + 'px';
                this._sliderContainer.style.height = 170 + 'px';
            } else {
                this._sliderContainer.style.width = 150 + 'px';
            }
            addDomEvent(
                this._container,
                'click',
                function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                },
                this
            );

            if (options.collapsed) {
                addDomEvent(this._container, 'mouseenter', expand, this);
                addDomEvent(this._container, 'mouseleave', collapse, this);
                addDomEvent(this._sliderBtn, 'click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                });
                addDomEvent(this._sliderBtn, 'click', expand, this);
                addDomEvent(this._sliderBtn, 'focus', expand, this);
            } else {
                expand();
            }
            return this._container;
        }

        /**
         * @function ChangeTileVersion.prototype.createElement
         * @description æ°å»ºåç´ ã
         * @param {string} tagName - æ ç­¾åã
         * @param {string} className - ç±»åã
         * @param {Object} container - å®¹å¨ã
         * @returns {object|HTMLElement} åç´ 
         */
        function createElement(tagName, className, container) {
            var el = document.createElement(tagName);
            el.className = className || '';

            if (container) {
                container.appendChild(el);
            }
            return el;
        }

        /**
         * @function ChangeTileVersion.prototype.addDomEvent
         * @description ä¸ºåç´ æ·»å äºä»¶ã
         * @param {Object} obj - äºä»¶å¯¹è±¡éã
         * @param {string} type - äºä»¶ç±»åã
         * @param {Object} fn -å®¹å¨ã
         * @param {Object} context -å½åç¯å¢ã
         * @returns {function} æ·»å çäºä»¶
         */
        function addDomEvent(obj, type, fn, context) {
            var handler = function(e) {
                if (fn) {
                    return fn.call(context || obj, e || window.event);
                }
            };
            var originalHandler = handler;
            if ('addEventListener' in obj) {
                if (type === 'mousewheel') {
                    obj.addEventListener('onwheel' in obj ? 'wheel' : 'mousewheel', handler, false);
                } else if (type === 'mouseenter' || type === 'mouseleave') {
                    handler = function(e) {
                        e = e || window.event;
                        if (isExternalTarget(obj, e)) {
                            originalHandler(e);
                        }
                    };
                    obj.addEventListener(type === 'mouseenter' ? 'mouseover' : 'mouseout', handler, false);
                } else {
                    obj.addEventListener(type, handler, false);
                }
            } else if ('attachEvent' in obj) {
                obj.attachEvent('on' + type, handler);
            }
            return this;
        }

        function isExternalTarget(el, e) {
            var related = e.relatedTarget;
            if (!related) {
                return true;
            }
            try {
                while (related && related !== el) {
                    related = related.parentNode;
                }
            } catch (err) {
                return false;
            }
            return related !== el;
        }

        function expand() {
            this._container.classList.add('ol-control-ctv-expanded');
        }

        function collapse() {
            this._container.classList.remove('ol-control-ctv-expanded');
        }

        function tilesVersion() {
            var version = this.getVersion();
            this.tilesVersion(version);
        }
    }

    /**
     * @function ChangeTileVersion.prototype.setContent
     * @description è®¾ç½®çæ¬ç¸å³ä¿¡æ¯ã
     * @param {Object} version - çæ¬ä¿¡æ¯ã
     */
    setContent(version) {
        var content = version || {};
        this.setVersionName(content.desc).setToolTip(content.desc);
    }

    /**
     * @function ChangeTileVersion.prototype.setVersionName
     * @description è®¾ç½®çæ¬å·
     * @param {string} content -çæ¬åå®¹ã
     */
    setVersionName(content) {
        var value = content;
        if (!content) {
            value = this.getValue();
        }
        this._sliderValue.innerHTML = value;
        return this;
    }

    /**
     * @function ChangeTileVersion.prototype.setToolTip
     * @description è®¾ç½®æç¤ºä¿¡æ¯ã
     * @param {string} tooltip - æç¤ºä¿¡æ¯ã
     * @returns {ChangeTileVersion} ChangeTileVersionçå®ä¾å¯¹è±¡ã
     */
    setToolTip(tooltip) {
        this.tooltip.innerHTML = tooltip;
        return this;
    }

    /**
     * @function ChangeTileVersion.prototype.updateLength
     * @description æ´æ°è¿åº¦æ¡é¿åº¦ã
     * @param {number} length - è¿åº¦æ¡é¿åº¦ã
     */
    updateLength(length) {
        if (length > 0) {
            this.length = length;
            this.max = this.length - 1;
            this.slider.setAttribute('max', this.max);
        }
    }

    /**
     * @function ChangeTileVersion.prototype.setLayer
     * @description ç»å®å¾å±ã
     * @param {Object} layer - å¾å±ã
     */
    setLayer(layer) {
        if (layer) {
            this.options.layer = layer;
        }
        var me = this;
        var tileLayer = me.options.layer;
        tileLayer.on('tilesetsinfoloaded', function(evt) {
            var tileVersions = evt.value && evt.value.tileVersions;
            me.update(tileVersions);
        });
        tileLayer.on('tileversionschanged', function(evt) {
            var tileVersions = evt.value && evt.value.tileVersion;
            me.setContent(tileVersions);
        });
        me.getTileSetsInfo();
    }

    /**
     * @function ChangeTileVersion.prototype.update
     * @description æ´æ°ç¼å­åçéåè¿åº¦æ¡é¿åº¦ã
     * @param {Object} tileVersions - å¾æ´æ°çåççæ¬ã
     */
    update(tileVersions) {
        this.tileVersions = tileVersions ||[];
        this.updateLength(this.tileVersions.length);
    }

    /**
     * @function ChangeTileVersion.prototype.getTileSetsInfo
     * @description è¯·æ±è·ååçéä¿¡æ¯ã
     */
    getTileSetsInfo() {
        var me = this;
        if (me.options.layer) {
            new MapService(me.options.layer._url).getTilesets(function getTilesInfoSucceed(info) {
                me.options.layer.setTileSetsInfo(info.result);
            });
        }
    }

    /**
     * @function ChangeTileVersion.prototype.removeLayer
     * @description ç§»é¤ç»å®çå°å¾å¾å±ã
     */
    removeLayer() {
        this.options.layer = null;
    }

    /**
     * @function ChangeTileVersion.prototype.nextTilesVersion
     * @description ä¸ä¸ä¸ªçæ¬ï¼ç¬¬ä¸æ¬¡ä¸è¿è¡å åï¼æ¯æ çæ¬çç¶æã
     * @returns {ChangeTileVersion} ChangeTileVersionçå®ä¾å¯¹è±¡ã
     */
    nextTilesVersion() {
        if (this.firstLoad) {
            this.options.layer.nextTilesVersion();
            this.firstLoad = !!0;
            return this;
        }
        if (parseInt(this.slider.value) > this.max - 1) {
            return this;
        }
        this.slider.value = parseInt(this.slider.value) + 1;
        this.options.layer.nextTilesVersion();
        return this;
    }

    /**
     * @function ChangeTileVersion.prototype.lastTilesVersion
     * @description è·åä¸ä¸ä¸ªçæ¬ä¿¡æ¯ã
     * @returns {ChangeTileVersion} ChangeTileVersionçå®ä¾å¯¹è±¡ã
     */
    lastTilesVersion() {
        if (parseInt(this.slider.value) < this.min + 1) {
            return this;
        }
        this.slider.value = parseInt(this.slider.value) - 1;
        this.options.layer.lastTilesVersion();
        return this;
    }

    /**
     * @function ChangeTileVersion.prototype.tilesVersion
     * @description æ ¹æ®æå®çæ¬å·è¯·æ±çæ¬ã
     * @param {Object} version - çæ¬ä¿¡æ¯ã
     */
    tilesVersion(version) {
        var layer = this.options.layer,
            tileVersions = this.tileVersions;
        var len = tileVersions.length;
        for (var i = 0; i < len; i++) {
            if (tileVersions[i].name == version) {
                layer.updateCurrentTileSetsIndex(i);
                layer.changeTilesVersion();
                break;
            }
        }
    }

    /**
     * @function ChangeTileVersion.prototype.getValue
     * @description è·åè¿åº¦æ¡çå¼ãæ³¨ï¼(è¿åº¦æ¡çå¼å¹¶ä¸æ¯çæ¬å·)ã
     */
    getValue() {
        return this.slider.value;
    }

    /**
     * @function ChangeTileVersion.prototype.getVersion
     * @description è·åå½åè¿åº¦æ¡å¼å¯¹åºççæ¬å·ã
     */
    getVersion() {
        var version = this.tileVersions[this.getValue()];
        return version && version.name;
    }
}

;// CONCATENATED MODULE: external "ol.control.ScaleLine"
const external_ol_control_ScaleLine_namespaceObject = ol.control.ScaleLine;
var external_ol_control_ScaleLine_default = /*#__PURE__*/__webpack_require__.n(external_ol_control_ScaleLine_namespaceObject);
;// CONCATENATED MODULE: external "ol.proj"
const external_ol_proj_namespaceObject = ol.proj;
;// CONCATENATED MODULE: external "ol.AssertionError"
const external_ol_AssertionError_namespaceObject = ol.AssertionError;
var external_ol_AssertionError_default = /*#__PURE__*/__webpack_require__.n(external_ol_AssertionError_namespaceObject);
;// CONCATENATED MODULE: ./src/openlayers/control/ScaleLine.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class ScaleLine
 * @aliasclass control.ScaleLine
 * @category  Control
 * @version 9.1.2
 * @classdesc æ¯ä¾å°ºæ§ä»¶ã
 * <div style="padding: 20px;border: 1px solid #eee;border-left-width: 5px;border-radius: 3px;border-left-color: #ce4844;">
 *      <p style="color: #ce4844">Notice</p>
 *      <p style="font-size: 13px">è¯¥åè½ç»§æ¿ {@link ol.control.ScaleLine },ä¸ {@link ol.control.ScaleLine } åè½å®å¨ç¸åãä»ä¸ºä¿®å¤ `openlayers` v4.6.5 çæ¬ä¸­ WGS84 ç­å°çåæ ç³»æ¯ä¾å°ºæ°å¼éè¯¯çé®é¢ã
 * </div>
 * @extends {ol.control.ScaleLine}
 * @param {Object} options -åæ°ã
 * @param {string} [options.className='ol-scale-line'] - CSS Class name.ã
 * @param {number} [options.minWidth=64] - æå°åç´ å®½åº¦ã
 * @param {(HTMLElement|string) } [options.target] - æå®æ¯ä¾å°ºæ§ä»¶ç®æ å®¹å¨ã
 * @param {(ol.control.ScaleLine.Units|string)} [options.units='metric'] - ä¸ä¸ä¸ªçæ¬çæé®å¸å±ã
 * @example
 * var control = new ScaleLine();
 * map.addControl(control)
 * @usage
 */
class ScaleLine extends (external_ol_control_ScaleLine_default()) {
    constructor(options) {
        options = options || {};
        //éå¨superä¹åå®ä¹renderï¼çæ­£çè°ç¨æ¯å¨åå§åå®æå
        options.render = function (mapEvent) {
            var frameState = mapEvent.frameState;
            if (!frameState) {
                this.viewState_ = null; //NOSONAR
            } else {
                this.viewState_ = frameState.viewState; //NOSONAR
            }
            this.updateElementRepair(); //NOSONAR
        };
        super(options); //NOSONAR
    }

    updateElementRepair() {
        const viewState = this.viewState_ || this.o || this.Om;

        if (!viewState) {
            this.renderedVisible_ = this.renderedVisible_ || this.j || this.yn;
            if (this.renderedVisible_) {
                this.element_ = this.element_ || this.c;
                this.element.style.display = 'none';
                this.renderedVisible_ = false;
            }
            return;
        }

        const center = viewState.center;
        const projection = viewState.projection;
        const units = this.getUnits();
        const pointResolutionUnits = units == "degrees" ?
            "degrees" :
            "m";
        let pointResolution =
        external_ol_proj_namespaceObject.getPointResolution(projection, viewState.resolution, center, pointResolutionUnits);
        this.minWidth_ = this.minWidth_ || this.v || this.Em;
        let nominalCount = this.minWidth_ * pointResolution;
        let suffix = '';
        if (units == "degrees") {
            const metersPerDegree = external_ol_proj_namespaceObject.METERS_PER_UNIT.degrees;
            nominalCount *= metersPerDegree;
            if (nominalCount < metersPerDegree / 60) {
                suffix = '\u2033'; // seconds
                pointResolution *= 3600;
            } else if (nominalCount < metersPerDegree) {
                suffix = '\u2032'; // minutes
                pointResolution *= 60;
            } else {
                suffix = '\u00b0'; // degrees
            }
        } else if (units == "imperial") {
            if (nominalCount < 0.9144) {
                suffix = 'in';
                pointResolution /= 0.0254;
            } else if (nominalCount < 1609.344) {
                suffix = 'ft';
                pointResolution /= 0.3048;
            } else {
                suffix = 'mi';
                pointResolution /= 1609.344;
            }
        } else if (units == "nautical") {
            pointResolution /= 1852;
            suffix = 'nm';
        } else if (units == "metric") {
            if (nominalCount < 0.001) {
                suffix = 'Î¼m';
                pointResolution *= 1000000;
            } else if (nominalCount < 1) {
                suffix = 'mm';
                pointResolution *= 1000;
            } else if (nominalCount < 1000) {
                suffix = 'm';
            } else {
                suffix = 'km';
                pointResolution /= 1000;
            }
        } else if (units == "us") {
            if (nominalCount < 0.9144) {
                suffix = 'in';
                pointResolution *= 39.37;
            } else if (nominalCount < 1609.344) {
                suffix = 'ft';
                pointResolution /= 0.30480061;
            } else {
                suffix = 'mi';
                pointResolution /= 1609.3472;
            }
        } else {
            throw new (external_ol_AssertionError_default())(33); // Invalid units
        }
        var DIGITS = [1, 2, 5];
        let i = 3 * Math.floor(
            Math.log(this.minWidth_ * pointResolution) / Math.log(10));
        let count, width, decimalCount;
        while (true) { //eslint-disable-line no-constant-condition
            decimalCount = Math.floor(i / 3);
            const decimal = Math.pow(10, decimalCount);
            count = DIGITS[((i % 3) + 3) % 3] * decimal;
            width = Math.round(count / pointResolution);
            if (isNaN(width)) {
                this.element.style.display = 'none';
                this.renderedVisible_ = false;
                return;
            } else if (width >= this.minWidth_) {
                break;
            }
            ++i;
        }
        this.renderedHTML_ = this.renderedHTML_ || this.D || this.am;
        this.innerElement_ = this.innerElement_ || this.l || this.Tm;
        this.renderedWidth_ = this.renderedWidth_ || this.B || this.Am;
        this.renderedVisible_ = this.renderedVisible_ || this.j || this.yn;
        this.element_ = this.element_ || this.c;
        let html= count.toFixed(decimalCount < 0 ? -decimalCount : 0) + ' ' + suffix;
        if (this.renderedHTML_ != html) {
            this.innerElement_.innerHTML = html;
            this.renderedHTML_ = html;
        }

        if (this.renderedWidth_ != width) {
            this.innerElement_.style.width = width + 'px';
            this.renderedWidth_ = width;
        }

        if (!this.renderedVisible_) {
            this.element.style.display = '';
            this.renderedVisible_ = true;
        }

    }
}

;// CONCATENATED MODULE: ./src/common/control/img/Logo.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
var LogoBase64 = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAF4AAAAdCAYAAAAjHtusAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA4ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDozYWZlOGIwMi01MWE3LTRiZjYtYWVkYS05MGQ2ZTQ4YjZiMmUiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6ODg0NkFBQUE3RjEzMTFFNzhFRjJFQkY4RjcxQjc1NjIiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6ODg0NkFBQTk3RjEzMTFFNzhFRjJFQkY4RjcxQjc1NjIiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKE1hY2ludG9zaCkiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4MWI3NzdhNC1lZmEyLTQ1MzUtOGQzNi03MmRjNDkyODMzN2UiIHN0UmVmOmRvY3VtZW50SUQ9ImFkb2JlOmRvY2lkOnBob3Rvc2hvcDpjYTYzODVjMi1jNDQ1LTExN2EtYTc0ZC1lM2I5MzJlMGE4Y2QiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5q1HM0AAAF/ElEQVR42tSabYhUVRjHZ7W01C1uaCRW4F3oi9SXCUnwQ9gsGUFvOEtQH1bLu5VS9sbYh5KicjYt29qiGQwVg2xWWKgocob91AvC+CWsoJqB3qHMSdTMpZyeU/+Df07n3pk7997Z6cBv99z7nHvOvf/z/pxJNZvNVI/jCKXmv6EquAmVkxPSlvtp2GItr0/96fFQForChJAWDiVYTkMYMu4XBFcYjLOwWS3sNwmn8NGzZ0h4Flv/zwIdchAnh/slCGmmKUNIBzYPaXOUr0vPuEjD71JAPh7l61embzinhV3V8nnCGmGT8LwlzSL8/yUh4Tfjo9T/CgnCIYNKycA2Qq21AcHU/VHE80Idoo3Qs0W6p0UtUnkZvEMDeVcCyqxEafF7hL8Qf0oYsIj+lfC9cH1CwhchWAGCtZO+AooQOkdC1Km1VtCb63StW73uFSzgKFUkNwBbmZGGmqowhvg8ZNpH9oXChcIcYRdeNomgxLkaH+S1SGubAxyIpFv+Zp+0DYjrAS00j/dem2VGEl6FJ4Qa4quEu8j2hTCJ+GJhe4JjfQMf6JCYPPbysMPxBlp0BUKOogEF9Rg9/heNvNKYfM0KsZUZaYxX4STGrzJa+zbhPeFH2DcK10KItcI+pI0rVElwXl1ULaKnIJhDw0oRQpTQc1zcbwRU8ATy4DR6yMlTzwkqMziEWHvubJ4Nk4ZtHdnqwvwY17xq3Z4FjrG+z2Kdrdf2ZSGD+xlLPh6t1R0jP9fI22ZzKI92yvQl7EbmBxI4S7Y+vIAOL87QZqsc5uNnssxZIcfYjXT9snCR7jjobidp+FkxA2v+Cq1QervMDmp4P7Xs3YZtE9kOC3P/By6JGaETl8ElwueYTNTDq4UDsKnd7YfCNbT239LF1udS72xYJt1UWxNfN4IIP4bWuTpEja01JtMFZFsm/AHbtHBlDE6yasA4moYTrUbvdBTXHqUrAH4uSadbyzF+vbBM2IsNkS3MNa5305JxqfA02T4TnkX8XOH1mPw8ruVejpxbI9hZD2Cz1U7LdrrUvjP/WfZinNZhr6V27hP+FPZh9aLvLxVO4DllX0G2OcKnlO/DCblxaz6uXBtmi+8mBaP3/SP8IuEIiTRoPPQm2TaEmEyXo0JU+F0YiPFD0hhOsiE/vqeEVwyTgF8L51OilcIZ2I4Ll5NttvAJPfukUeB2sk0ZPSbKIUUJpCII7+DasWy08uhNNazT0wGHI7mAtB7KqMKm38HhDdAUibTVKGicbB8YAqrJ9DRsp43JdB4qUof1HQrPE6XTQWu3Ce/inVzjXhXpMiTwUYugNVQ+p80jrUsV5EH0POKeuXO9QjhFq5GryNYvfEMCDhsftYVsB9ETtG0V9ZjfhCURhbcJFpfwVZ9jvhxsLHwTYtp2svlWQw3vXL8UnqHVSIG8l8ex+tHhBXgjddgqHEZ8ufAA2aaEnYgrF/KrPXrEmMUqZ9THLW06xhoBaVueQpkug+ewOUphE3Qv2Q5gGamXYa+QbVq4O+DQ5FHyZqrjxNt7UHh9uuRa0F7HjCF8o9PCTOGnscM7g2u1Hl9C9oeEnxC/1ajZg8JLiM9Hj9GHJseMShwL2DO0G5yEWn3Zh1QUods5CPkIoqlwAZxhXMsb6HrcEPBxchhdJ6wj29vCW4hfLOzo8J3rltYX50nXQAATSf/K4DEaGlTLvplsk/QCpoD60EQ7gLYZc8H9wq+I3yncEOEcNhuz6HWf3XEiwU/4Y8YEqVp2P10rt+8REvBGw026i4aDcbL9jF8r8Blmf4fCOzhViiscskygXRdehf3CO4hfigmTBXyQrl8TFtD1IzQX3CbcQrY3hPcRv4z8OmHPXwchVNln2MmE7BX6VwIFi/he6uxvb6JM3m0fdqvx/ATidxg2JeC7VDErAw5NzGfvwRJVheEIQ8Mg/pdwIM+UOmi9Q8ivCsrIy0tF+wVbEcLrd3Pb2XisEb4Tdlhsi4WP4RBbaLGrHfC3PrvMIezy9rTpGm5lz9LOMG15xvFxD/j5gjzjjDbMOzk+9zzt3v5bgAEAibzFeFHVgYkAAAAASUVORK5CYII=";
;// CONCATENATED MODULE: ./src/openlayers/control/Logo.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class Logo
 * @aliasclass control.Logo
 * @category  Control
 * @classdesc Logoæ§ä»¶ãé»è®¤ä¸æ¾ç¤ºï¼éæå¨æ·»å æ§ä»¶ã
 * @extends {ol.control.Control}
 * @example
 * var control = new Logo();
 * map.addControl(control);
 * @param {Object} options - åæ°ã
 * @param {string} [options.imageUrl] - logo å¾çå°åã
 * @param {number} [options.width] - logo å¾çå®½ã
 * @param {number} [options.height] - logo å¾çé«ã
 * @param {string} [options.link='https://iclient.supermap.io'] - è·³è½¬é¾æ¥ã
 * @param {string} [options.alt='SuperMap iClient'] - logo å¾çå¤±ææ¶æ¾ç¤ºææ¬ã
 * @usage
 */
class Logo extends (external_ol_control_Control_default()) {

    constructor(options) {
        options = options || {};
        options.imageUrl = options.imageUrl || null;
        options.width = options.width || null;
        options.height = options.height || null;
        options.link = options.link || "https://iclient.supermap.io";
        options.alt = options.alt || "SuperMap iClient";
        super(options);
        this.options = options;
        this.element = options.element = initLayerout.call(this);

        /**
         * @function Logo.prototype.initLayerout
         * @description åå§åå¾å±ä¿¡æ¯ã
         */
        function initLayerout() {
            var className = 'ol-control-logo ol-unselectable ol-control';
            var div = document.createElement("div");
            div.className = className;

            setDivStyle.call(this, div);

            var imgSrc = LogoBase64;
            if (this.options.imageUrl) {
                imgSrc = this.options.imageUrl;
            }
            var alt = this.options.alt;
            var link = this.options.link;

            var imageWidth = "94px";
            var imageHeight = "29px";
            var styleSize = "width:" + imageWidth + ";height:" + imageHeight + ";";
            if (this.options.imageUrl) {
                imageWidth = this.options.width;
                imageHeight = this.options.height;
                styleSize = "width:" + imageWidth + ";height:" + imageHeight + ";";
                if (!imageWidth || !imageHeight) {
                    styleSize = "";
                }
            }


            div.innerHTML = "<a href='" + link + "' target='_blank' style='border: none;display: block;'>" +
                "<img src=" + imgSrc + " alt='" + alt + "'  style='border: none;" + styleSize + "white-space: nowrap;margin-bottom: 2px'></a>";
            return div;
        }

        /**
         * @function Logo.prototype.setDivStyle
         * @description è®¾ç½®å¯¹è±¡ styleã
         * @param {HTMLElement} div - å¾è®¾ç½®ç divã
         */
        function setDivStyle(div) {
            var attributionsElem = document.getElementsByClassName('ol-attribution');
            attributionsElem = attributionsElem && attributionsElem[0];
            var attrHeight = attributionsElem && attributionsElem.clientHeight || 29;
            div.style.bottom = (parseInt(attrHeight) + 6) + "px";
            div.style.right = "4px";
            div.style.marginTop = 0;
            div.style.marginLeft = 0;
            div.style.marginBottom = 0;
            div.style.marginRight = 0;
            var logoStyle = document.createElement('style');
            logoStyle.type = 'text/css';
            logoStyle.innerHTML = '.ol-control-logo,.ol-control-logo:hover {' +
                'background-color: rgba(255,255,255,0);' +
                '}';
            document.getElementsByTagName('head')[0].appendChild(logoStyle);
        }

    }
}



;// CONCATENATED MODULE: ./src/openlayers/control/index.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



;// CONCATENATED MODULE: ./src/openlayers/overlay/vectortile/StyleMap.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
/**
 * @constant  pointMap
 * @description ç¹å¾ã
 * @private
 */
var pointMap = {
    "point-file": "pointFile",
    "point-fill": "fillStyle",
    "point-radius": "pointRadius",
    "point-halo-radius": "pointHaloRadius",
    "point-halo-color": "pointHaloColor",
    "point-dx": "offsetX",
    "point-dy": "offsetY",
    "point-opacity": "globalAlpha",
    "point-comp-op": "globalCompositeOperation"
};

/**
 * @constant lineMap
 * @description çº¿å¾ã
 * @private
 */
var lineMap = {
    "line-color": "strokeStyle",
    "line-width": "lineWidth",
    "line-cap": "lineCap",
    "line-join": "lineJoin",
    "line-miterlimit": "miterLimit",
    "line-dash-offset": "lineDashOffset",
    /*expand*/
    "line-opacity": "strokeOpacity",
    "line-dasharray": "lineDasharray",
    "line-offset": "offset",
    "line-comp-op": "globalCompositeOperation"
};

/**
 * @constant polygonMap
 * @description é¢å¾ã
 * @private
 */
var polygonMap = {
    /*åæ¬LINEçé¨åï¼ç¨ä»¥è®¾ç½®é¢çå¤å´è¾¹ç*/
    "line-color": "strokeStyle",
    "line-width": "lineWidth",
    "line-cap": "lineCap",
    "line-join": "lineJoin",
    "line-miterlimit": "miterLimit",
    "line-dash-offset": "lineDashOffset",
    /*expand*/
    "line-opacity": "strokeOpacity",
    "line-dasharray": "lineDasharray",

    /*ä»¥ä¸ä¸ºé¢çç¹æ§*/
    "polygon-fill": "fillStyle",
    "polygon-dx": "offsetX",
    "polygon-dy": "offsetY",
    "polygon-opacity": "fillOpacity",
    "polygon-comp-op": "globalCompositeOperation"
};

/**
 * @enum StyleMap {Object}
 * @description å°å¾æ ·å¼ã
 * @category BaseTypes Constant
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const result = {namespace}.StyleMap.CartoStyleMap;
 *
 * </script>
 * // ES6 Import
 * import { StyleMap } from '{npm}';
 *
 * const result = StyleMap.CartoStyleMap;
 * ```
 */
var StyleMap = {
    /** CartoCSS ä¸­ç style å±æ§åä¸ Canvas ç style å±æ§åçå¯¹åºè¡¨ */
    CartoStyleMap: {
        "TEXT": {
            //åä¸¤ä¸ªå±æ§å¼ç»æfont
            "text-size": "fontSize",
            "text-face-name": "fontFamily",

            "text-align": "textAlign",
            "text-vertical-alignment": "textBaseline",
            "text-horizontal-alignment": "textAlign",
            /*expand*/
            'text-bold': 'bold',
            'text-weight': 'fontWeight',
            "text-name": "textName",
            "text-halo-radius": "haloRadius",
            "text-halo-color": "backColor",
            "text-fill": "foreColor",
            "text-opacity": "globalAlpha",
            "text-dx": "offsetX",
            "text-dy": "offsetY",
            "text-comp-op": "globalCompositeOperation"
        },
        /*expand*/
        "POINT": pointMap,
        "MULTIPOINT": pointMap,
        "LINE": lineMap,
        "LINESTRING": lineMap,
        "MULTILINESTRING": lineMap,
        "REGION": polygonMap,
        "POLYGON": polygonMap,
        "MULTIPOLYGON": polygonMap
    },
    /** æå¡ç«¯ä¼ è¿æ¥ç style å±æ§åä¸ Canvas ç style å±æ§åçå¯¹åºè¡¨ã */
    ServerStyleMap: {
        fillBackOpaque: {
            canvasStyle: "",
            type: "bool",
            defaultValue: true
        },
        lineWidth: {
            canvasStyle: "lineWidth",
            type: "number",
            unit: "mm",
            defaultValue: 0.1
        },
        fillBackColor: {
            canvasStyle: "",
            type: "color",
            defaultValue: "rgba(0,0,0,0)"
        },
        markerWidth: {
            canvasStyle: "",
            type: "number",
            unit: "mm",
            defaultValue: ""
        },
        markerAngle: {
            canvasStyle: "",
            type: "number",
            unit: "degree",
            defaultValue: ""
        },
        fillForeColor: {
            canvasStyle: "fillStyle",
            type: "color",
            defaultValue: "rgba(0,0,0,0)"
        },
        foreColor: {
            canvasStyle: "fillStyle",
            type: "color",
            defaultValue: "rgba(0,0,0,0)"
        },
        markerSize: {
            canvasStyle: "markerSize",
            type: "number",
            unit: "mm",
            defaultValue: 2.4
        },
        fillGradientOffsetRatioX: {
            canvasStyle: "",
            type: "number",
            defaultValue: 0
        },
        fillGradientOffsetRatioY: {
            canvasStyle: "",
            type: "number",
            defaultValue: 0
        },
        lineColor: {
            canvasStyle: "strokeStyle",
            type: "color",
            defaultValue: "rgba(0,0,0,0)"
        },
        fillOpaqueRate: {
            canvasStyle: "",
            type: "number",
            defaultValue: 100
        },
        markerHeight: {
            canvasStyle: "",
            type: "number",
            unit: "mm",
            defaultValue: 0
        },
        fillGradientMode: {
            canvasStyle: "",
            type: "string",
            defaultValue: "NONE"
        },
        fillSymbolID: {
            canvasStyle: "",
            type: "number",
            defaultValue: 0
        },
        fillGradientAngle: {
            canvasStyle: "",
            type: "number",
            unit: "degree",
            defaultValue: 0
        },
        markerSymbolID: {
            canvasStyle: "",
            type: "number",
            defaultValue: 0
        },
        lineSymbolID: {
            canvasStyle: "",
            type: "number",
            defaultValue: 0
        }
    },
    /** Canvas ä¸­ç globalCompositeOperation å±æ§å¼ä¸ CartoCSS ä¸­ç CompOp å±æ§å¼å¯¹ç§è¡¨ã */
    CartoCompOpMap: {
        "clear": "",
        "src": "",
        "dst": "",
        "src-over": "source-over",
        "dst-over": "destination-over",
        "src-in": "source-in",
        "dst-in": "destination-in",
        "src-out": "source-out",
        "dst-out": "destination-out",
        "src-atop": "source-atop",
        "dst-atop": "destination-atop",
        "xor": "xor",
        "plus": "lighter",
        "minus": "",
        "multiply": "",
        "screen": "",
        "overlay": "",
        "darken": "",
        "lighten": "lighter",
        "color-dodge": "",
        "color-burn": "",
        "hard-light": "",
        "soft-light": "",
        "difference": "",
        "exclusion": "",
        "contrast": "",
        "invert": "",
        "invert-rgb": "",
        "grain-merge": "",
        "grain-extract": "",
        "hue": "",
        "saturation": "",
        "color": "",
        "value": ""
    }
};

;// CONCATENATED MODULE: ./src/openlayers/overlay/vectortile/DeafultCanvasStyle.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
/**
 * @constant pointStyle
 * @description ç¹å±æ§åçå¯¹åºè¡¨ã
 * @private
 */
var pointStyle = {
    pointFile: "",

    /*expand*/
    pointRadius: 3,
    pointHaloRadius: 1,
    pointHaloColor: "#c33",
    offsetX: 0,
    offsetY: 0,
    fillStyle: "#fc0",

    globalAlpha: 1,
    globalCompositeOperation: "source-over",
    imageSmoothingEnabled: true
};

/**
 * @constant lineStyle
 * @description çº¿å±æ§åçå¯¹åºè¡¨ã
 * @private
 */
var lineStyle = {
    strokeStyle: "rgba(0,0,0,0)",
    lineWidth: 1,
    lineCap: "butt",
    lineJoin: "round",
    miterLimit: 10,
    lineDashOffset: 0,
    /*expand*/
    lineDasharray: [],
    strokeOpacity: 1,
    offset: 0,

    globalAlpha: 1,
    globalCompositeOperation: "source-over",
    imageSmoothingEnabled: true
};

/**
 * @constant polygonStyle
 * @description é¢å±æ§åçå¯¹åºè¡¨ã
 * @private
 */
var polygonStyle = {
    /*åå«LINEçé¨å*/
    strokeStyle: "rgba(0,0,0,0)",
    lineWidth: 1,
    lineCap: "butt",
    lineJoin: "round",
    miterLimit: 10,
    lineDashOffset: 0,
    /*expand*/
    lineOpacity: 1,
    fillOpacity: 1,
    lineDasharray: [],

    fillStyle: "rgba(0,0,0,0)",
    polygonOpacity: 1,

    /*expand*/
    offsetX: 0,
    offsetY: 0,

    globalAlpha: 1,
    globalCompositeOperation: "source-over",
    imageSmoothingEnabled: true
};

/**
 * @constant DeafultCanvasStyle
 * @description é»è®¤ç»å¸å±æ§åçå¯¹åºè¡¨ã
 * @private
 */
var DeafultCanvasStyle = {
    /**
     * @constant DeafultCanvasStyle.prototype.TEXT
     * @description é»è®¤ææ¬æ ·å¼ã
     */
    "TEXT": {
        font: "10px sans-serif",
        textAlign: "middle",
        textBaseline: "center",
        direction: "ltr",
        /*expand*/
        bold: false,
        haloRadius: 0,
        backColor: "rgba(255,255,255,1)",
        foreColor: "rgba(0,0,0,1)",
        // foreColor: "rgba(0,0,0,0)",
        offsetX: 0,
        offsetY: 0,
        textHeight: 0,

        globalAlpha: 1,
        globalCompositeOperation: "source-over",
        imageSmoothingEnabled: true
    },
    "POINT": pointStyle,
    "MULTIPOINT": pointStyle,
    "LINE": lineStyle,
    "LINESTRING": lineStyle,
    "MULTILINESTRING": lineStyle,
    "REGION": polygonStyle,
    "POLYGON": polygonStyle,
    "MULTIPOLYGON": polygonStyle,
    "SHADOW": {
        shadowBlur: 0,
        shadowColor: "rgba(0,0,0,0)",
        shadowOffsetX: 0,
        shadowOffsetY: 0
    },
    "GLOBAL": {
        globalAlpha: 1,
        globalCompositeOperation: "source-over",
        imageSmoothingEnabled: true
    }
};

;// CONCATENATED MODULE: external "ol.util"
const external_ol_util_namespaceObject = ol.util;
;// CONCATENATED MODULE: external "ol.geom.Geometry"
const external_ol_geom_Geometry_namespaceObject = ol.geom.Geometry;
var external_ol_geom_Geometry_default = /*#__PURE__*/__webpack_require__.n(external_ol_geom_Geometry_namespaceObject);
;// CONCATENATED MODULE: external "ol.render"
const external_ol_render_namespaceObject = ol.render;
;// CONCATENATED MODULE: external "ol.source.Vector"
const external_ol_source_Vector_namespaceObject = ol.source.Vector;
var external_ol_source_Vector_default = /*#__PURE__*/__webpack_require__.n(external_ol_source_Vector_namespaceObject);
;// CONCATENATED MODULE: external "ol.layer.Vector"
const external_ol_layer_Vector_namespaceObject = ol.layer.Vector;
var external_ol_layer_Vector_default = /*#__PURE__*/__webpack_require__.n(external_ol_layer_Vector_namespaceObject);
;// CONCATENATED MODULE: external "ol.style"
const external_ol_style_namespaceObject = ol.style;
;// CONCATENATED MODULE: external "ol.Feature"
const external_ol_Feature_namespaceObject = ol.Feature;
var external_ol_Feature_default = /*#__PURE__*/__webpack_require__.n(external_ol_Feature_namespaceObject);
;// CONCATENATED MODULE: external "ol.proj.Projection"
const external_ol_proj_Projection_namespaceObject = ol.proj.Projection;
var external_ol_proj_Projection_default = /*#__PURE__*/__webpack_require__.n(external_ol_proj_Projection_namespaceObject);
;// CONCATENATED MODULE: ./src/openlayers/core/Util.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
 
 
 
 
 
 
 
 
 
 
 
 

 /**
  * @name Util
  * @namespace
  * @category BaseTypes Util
  * @classdesc å·¥å·ç±»ã
  * @usage
  * ```
  * // æµè§å¨
  * <script type="text/javascript" src="{cdn}"></script>
  * <script>
  *   const result = {namespace}.Util.getOlVersion();
  *
  * </script>
  *
  * // ES6 Import
  * import { Util } from '{npm}';
  *
  * const result = Util.getOlVersion();
  * ```
  */
 const core_Util_Util = {
   getOlVersion() {
     if (external_ol_util_namespaceObject && external_ol_util_namespaceObject.VERSION) {
       return external_ol_util_namespaceObject.VERSION.split('.')[0];
     }
     if (window && window.ol) {
       if (window.ol.util) {
         return '6';
       }
       if (window.ol.WebGLMap) {
         return '5';
       }
     }
     return '4';
   },

   /**
    * @function Util.toGeoJSON
    * @description å°ä¼ å¥å¯¹è±¡è½¬ä¸º GeoJSON æ ¼å¼ã
    * @param {Object} smObj - å¾è½¬åæ°ã
    */
   toGeoJSON(smObj) {
     if (!smObj) {
       return null;
     }
     return new GeoJSON().toGeoJSON(smObj);
   },

   /**
    * @function Util.toSuperMapGeometry
    * @description å° GeoJSON å¯¹è±¡è½¬ä¸º SuperMap å ä½å¾å½¢ã
    * @param {GeoJSONObject} geoJSON - GeoJSON å¯¹è±¡ã
    */
   toSuperMapGeometry(geoJSON) {
     if (!geoJSON || !geoJSON.type) {
       return null;
     }
     const result = new GeoJSON().read(geoJSON, 'FeatureCollection');
     return result[0].geometry;
   },

   /**
    * @function Util.resolutionToScale
    * @description éè¿åè¾¨çè®¡ç®æ¯ä¾å°ºã
    * @param {number} resolution - åè¾¨çã
    * @param {number} dpi - å±å¹åè¾¨çã
    * @param {string} mapUnit - å°å¾åä½ã
    * @returns {number} æ¯ä¾å°ºã
    */
   resolutionToScale(resolution, dpi, mapUnit) {
     const inchPerMeter = 1 / 0.0254;
     // å°çåå¾ã
     const meterPerMapUnit = getMeterPerMapUnit(mapUnit);
     const scale = 1 / (resolution * dpi * inchPerMeter * meterPerMapUnit);
     return scale;
   },

   /**
    * @function Util.toSuperMapBounds
    * @description è½¬ä¸º SuperMapBounds æ ¼å¼ã
    * @param {Array.<number>} bounds - bounds æ°ç»ã
    * @returns {Bounds} è¿å SuperMap ç Bounds å¯¹è±¡ã
    */
   toSuperMapBounds(bounds) {
     return new Bounds(bounds[0], bounds[1], bounds[2], bounds[3]);
   },

   /**
    * @function Util.toProcessingParam
    * @description å° Region èç¹æ°ç»è½¬ä¸º Processing æå¡éè¦çåæåæ°ã
    * @param {Array} points - Region åä¸ªèç¹æ°ç»ã
    * @returns processing æå¡è£åªãæ¥è¯¢åæçåæåæ°ã
    */
   toProcessingParam(points) {
     if (points.length < 1) {
       return '';
     }
     const geometryParam = {};
     const results = [];
     for (let i = 0; i < points.length; i++) {
       const point = { x: points[i][0], y: points[i][1] };
       results.push(point);
     }
     results.push(results[0]);
     geometryParam.type = 'REGION';
     geometryParam.points = results;

     return geometryParam;
   },

   /**
    * @function Util.scaleToResolution
    * @description éè¿æ¯ä¾å°ºè®¡ç®åè¾¨çã
    * @param {number} scale - æ¯ä¾å°ºã
    * @param {number} dpi - å±å¹åè¾¨çã
    * @param {string} mapUnit - å°å¾åä½ã
    * @returns {number} åè¾¨çã
    */
   scaleToResolution(scale, dpi, mapUnit) {
     const inchPerMeter = 1 / 0.0254;
     const meterPerMapUnitValue = getMeterPerMapUnit(mapUnit);
     const resolution = 1 / (scale * dpi * inchPerMeter * meterPerMapUnitValue);
     return resolution;
   },

   /**
    * @private
    * @function Util.getMeterPerMapUnit
    * @description è·åæ¯å°å¾åä½å¤å°ç±³ã
    * @param {string} mapUnit - å°å¾åä½ã
    * @returns {number} è¿åæ¯å°å¾åä½å¤å°ç±³ã
    */
   getMeterPerMapUnit: getMeterPerMapUnit,

   /**
    * @function Util.isArray
    * @description å¤æ­æ¯å¦ä¸ºæ°ç»æ ¼å¼ã
    * @param {Object} obj - å¾å¤æ­å¯¹è±¡ã
    * @returns {boolean} æ¯å¦æ¯æ°ç»ã
    */
   isArray,

   /**
    * @function Util.Csv2GeoJSON
    * @description å° csv æ ¼å¼è½¬ä¸º GeoJSONã
    * @param {Object} csv - csv å¯¹è±¡ã
    * @param {Object} options - è½¬æ¢åæ°ã
    */
   Csv2GeoJSON(csv, options) {
     const defaultOptions = {
       titles: ['lon', 'lat'],
       latitudeTitle: 'lat',
       longitudeTitle: 'lon',
       fieldSeparator: ',',
       lineSeparator: '\n',
       deleteDoubleQuotes: true,
       firstLineTitles: false
     };
     options = options || defaultOptions;
     const _propertiesNames = [];
     if (typeof csv === 'string') {
       let titulos = options.titles;
       if (options.firstLineTitles) {
         csv = csv.split(options.lineSeparator);
         if (csv.length < 2) {
           return;
         }
         titulos = csv[0];
         csv.splice(0, 1);
         csv = csv.join(options.lineSeparator);
         titulos = titulos.trim().split(options.fieldSeparator);
         for (let i = 0; i < titulos.length; i++) {
           titulos[i] = _deleteDoubleQuotes(titulos[i]);
         }
         options.titles = titulos;
       }
       for (let i = 0; i < titulos.length; i++) {
         let prop = titulos[i]
           .toLowerCase()
           .replace(/[^\w ]+/g, '')
           .replace(/ +/g, '_');
         if (prop === '' || prop === '_') {
           prop = `prop-${i}`;
         }
         _propertiesNames[i] = prop;
       }
       csv = _csv2json(csv);
     }
     return csv;

     function _deleteDoubleQuotes(cadena) {
       if (options.deleteDoubleQuotes) {
         cadena = cadena.trim().replace(/^"/, '').replace(/"$/, '');
       }
       return cadena;
     }

     function _csv2json(csv) {
       const json = {};
       json['type'] = 'FeatureCollection';
       json['features'] = [];
       const titulos = options.titles;
       csv = csv.split(options.lineSeparator);
       for (let num_linea = 0; num_linea < csv.length; num_linea++) {
         const campos = csv[num_linea].trim().split(options.fieldSeparator),
           lng = parseFloat(campos[titulos.indexOf(options.longitudeTitle)]),
           lat = parseFloat(campos[titulos.indexOf(options.latitudeTitle)]);

         const isInRange = lng < 180 && lng > -180 && lat < 90 && lat > -90;
         if (!(campos.length === titulos.length && isInRange)) {
           continue;
         }

         const feature = {};
         feature['type'] = 'Feature';
         feature['geometry'] = {};
         feature['properties'] = {};
         feature['geometry']['type'] = 'Point';
         feature['geometry']['coordinates'] = [lng, lat];
         for (let i = 0; i < titulos.length; i++) {
           if (titulos[i] !== options.latitudeTitle && titulos[i] !== options.longitudeTitle) {
             feature['properties'][_propertiesNames[i]] = _deleteDoubleQuotes(campos[i]);
           }
         }
         json['features'].push(feature);
       }
       return json;
     }
   },

   /**
    * @function Util.createCanvasContext2D
    * @description åå»º 2D ç»å¸ã
    * @param {number} opt_width - ç»å¸å®½åº¦ã
    * @param {number} opt_height - ç»å¸é«åº¦ã
    */
   createCanvasContext2D(opt_width, opt_height) {
     const canvas = document.createElement('CANVAS');
     if (opt_width) {
       canvas.width = opt_width;
     }
     if (opt_height) {
       canvas.height = opt_height;
     }
     return canvas.getContext('2d');
   },
   /**
    * @function Util.supportWebGL2
    * @description æ¯å¦æ¯æ webgl2ã
    */
   supportWebGL2() {
     const canvas = document.createElement('canvas');
     return Boolean(canvas && canvas.getContext('webgl2'));
   },

   /**
    * @function Util.isString
    * @description æ¯å¦ä¸ºå­ç¬¦ä¸²
    * @param {string} str - éè¦å¤æ­çåå®¹
    * @returns {boolean}
    */
   isString,
   /**
    * @function Util.isObject
    * @description æ¯å¦ä¸ºå¯¹è±¡
    * @param {any} obj - éè¦å¤æ­çåå®¹
    * @returns {boolean}
    */
   isObject(obj) {
     return Object.prototype.toString.call(obj) === '[object Object]';
   },

   /**
    * @function Util.trim
    * @description å­ç¬¦ä¸²è£åªä¸¤è¾¹çç©ºæ ¼
    * @param {string} str - éè¦è£åªçå­ç¬¦ä¸²
    * @returns {boolean}
    */
   trim(str = '') {
     return str.replace(/(^\s*)|(\s*$)/g, '');
   },
   /**
    * @function Util.newGuid
    * @description éæºçæid
    * @param {string} attr - å ä½æ°å­çid
    * @returns {string}
    */
   newGuid(attr) {
     let len = attr || 32;
     let guid = '';
     for (let i = 1; i < len; i++) {
       let n = Math.floor(Math.random() * 16.0).toString(16);
       guid += n;
     }
     return guid;
   },
   /**
    * @function Util.isNumber
    * @description æ£æµæ°æ®æ¯å¦ä¸ºnumber
    * @param {string} value - å¼ï¼æªç¥æ°æ®ç±»å
    * @returns {boolean}
    */
   isNumber(value) {
     if (value === '') {
       return false;
     }
     let mdata = Number(value);
     if (mdata === 0) {
       return true;
     }
     return !isNaN(mdata);
   },


   /**
    * @function Util.isMatchAdministrativeName
    * @param {string} featureName åå§æ°æ®ä¸­çå°å
    * @param {string} fieldName éè¦å¹éçå°å
    * @returns {boolean} æ¯å¦å¹é
    */
   isMatchAdministrativeName,

   /**
    * @function Util.getHighestMatchAdministration
    * @param {string} featureName åå§å¹éçè¦ç´ æ°ç»
    * @param {string} fieldName è¦å¹éçå°å
    * @returns {boolean} æ¯å¦å¹é
    */
   getHighestMatchAdministration(features, fieldName) {
     let filterFeatures = features.filter((item) => {
       return isMatchAdministrativeName(item.properties.Name, fieldName);
     });

     let maxMatchPercent = 0,
       maxMatchFeature = null;
     filterFeatures.forEach((feature) => {
       let count = 0;
       Array.from(new Set(feature.properties.Name.split(''))).forEach((char) => {
         if (fieldName.includes(char)) {
           count++;
         }
       });
       if (count > maxMatchPercent) {
         maxMatchPercent = count;
         maxMatchFeature = feature;
       }
     });
     return maxMatchFeature;
   },

   /**
    * @function Util.setMask
    * @description ä¸ºå¾å±è®¾ç½®æ©èã
    * @version 10.1.0
    * @param {ol.layer.Layer|Array.<ol.layer.Layer>} layers å¾å±
    * @param {ol.geom.Geometry|ol.Feature} polygon æ©èç¢éè¦ç´ ï¼æ¯æé¢ç±»åçè¦ç´ ã
    */
   setMask(layers, polygon) {
     if (!polygon) {
       return;
     }
     const geo = polygon instanceof (external_ol_Feature_default()) ? polygon.getGeometry() : polygon;
     if (!(geo instanceof (external_ol_geom_Geometry_default())) && ['MultiPolygon', 'Polygon'].indexOf(polygon.getType()) < 0) {
       return;
     }
     const feature = polygon instanceof (external_ol_Feature_default()) ? polygon : new (external_ol_Feature_default())(polygon);
     const style = new external_ol_style_namespaceObject.Style({
       fill: new external_ol_style_namespaceObject.Fill({
         color: 'black'
       })
     });

     const clipLayer = new (external_ol_layer_Vector_default())({
       source: new (external_ol_source_Vector_default())({
         features: [feature],
         wrapX: false
       })
     });

     const clipRender = function (e) {
       const vectorContext = (0,external_ol_render_namespaceObject.getVectorContext)(e);
       e.context.globalCompositeOperation = 'destination-in';
       clipLayer.getSource().forEachFeature(function (feature) {
         vectorContext.drawFeature(feature, style);
         e.context.globalCompositeOperation = 'source-over';
       });
     };
     const todoLayers = Array.isArray(layers) ? layers : [layers];
     unsetMask(todoLayers);
     todoLayers.forEach((layer) => {
       layer.classNameBak_ = layer.className_;
       layer.className_ = `ol_mask_layer_${layer.ol_uid}`;
       layer.clipRender = clipRender;
       layer.extentBak_ = layer.getExtent();
       layer.setExtent(clipLayer.getSource().getExtent());
       layer.on('postrender', clipRender);
       layer.changed();
     });
   },
   /**
    * @function Util.unsetMask
    * @description åæ¶å¾å±æ©èã
    * @version 10.1.0
    * @param {ol.layer.Layer|Array.<ol.layer.Layer>} layers å¾å±
    */
   unsetMask,
   getZoomByResolution(scale, scales) {
    return getZoomByResolution(scale, scales);
   },
   scalesToResolutions(scales, bounds, dpi, unit, mapobj, level) {
    return scalesToResolutions(scales, bounds, dpi, unit, mapobj, level);
   },
   getProjection(prjCoordSys, extent) {
    let projection = (0,external_ol_proj_namespaceObject.get)(`EPSG:${prjCoordSys.epsgCode}`);
    if (prjCoordSys.type == 'PCS_NON_EARTH') {
      projection = new (external_ol_proj_Projection_default())({
        extent,
        units: 'm',
        code: '0'
      });
    }
    if (!projection) {
      console.error(`The projection of EPSG:${prjCoordSys.epsgCode} is missing, please register the projection of EPSG:${prjCoordSys.epsgCode} first, refer to the documentation: https://iclient.supermap.io/web/introduction/leafletDevelop.html#multiProjection`);
    }
    return projection;
  }
 }

function isString(str) {
  return typeof str === 'string' && str.constructor === String;
}
function isArray(obj) {
  return Object.prototype.toString.call(obj) === '[object Array]';
}
 function unsetMask(layers) {
   const todoLayers = Array.isArray(layers) ? layers : [layers];
   for (let index = 0; index < todoLayers.length; index++) {
     const layer = todoLayers[index];
     if (!layer.clipRender) {
       continue;
     }
     layer.un('postrender', layer.clipRender);
     layer.className_ = layer.classNameBak_;
     layer.setExtent(layer.extentBak);
     delete layer.classNameBak_;
     delete layer.clipRender;
     delete layer.extentBak_;
     layer.changed();
   }
 }

 function isMatchAdministrativeName(featureName, fieldName) {
   if (isString(fieldName)) {
     let shortName = featureName.substr(0, 2);
     // å¼ å®¶å£å¸åå¼ å®¶çå¸ ç¹æ®å¤ç
     if (shortName === 'å¼ å®¶') {
       shortName = featureName.substr(0, 3);
     }
     return !!fieldName.match(new RegExp(shortName));
   }
   return false;
 }

;// CONCATENATED MODULE: external "function(){try{return canvg}catch(e){return {}}}()"
const external_function_try_return_canvg_catch_e_return_namespaceObject = function(){try{return canvg}catch(e){return {}}}();
var external_function_try_return_canvg_catch_e_return_default = /*#__PURE__*/__webpack_require__.n(external_function_try_return_canvg_catch_e_return_namespaceObject);
;// CONCATENATED MODULE: external "ol.style.Style"
const external_ol_style_Style_namespaceObject = ol.style.Style;
var external_ol_style_Style_default = /*#__PURE__*/__webpack_require__.n(external_ol_style_Style_namespaceObject);
;// CONCATENATED MODULE: external "ol.style.Icon"
const external_ol_style_Icon_namespaceObject = ol.style.Icon;
var external_ol_style_Icon_default = /*#__PURE__*/__webpack_require__.n(external_ol_style_Icon_namespaceObject);
;// CONCATENATED MODULE: external "ol.style.Circle"
const external_ol_style_Circle_namespaceObject = ol.style.Circle;
var external_ol_style_Circle_default = /*#__PURE__*/__webpack_require__.n(external_ol_style_Circle_namespaceObject);
;// CONCATENATED MODULE: external "ol.style.Fill"
const external_ol_style_Fill_namespaceObject = ol.style.Fill;
var external_ol_style_Fill_default = /*#__PURE__*/__webpack_require__.n(external_ol_style_Fill_namespaceObject);
;// CONCATENATED MODULE: external "ol.style.Stroke"
const external_ol_style_Stroke_namespaceObject = ol.style.Stroke;
var external_ol_style_Stroke_default = /*#__PURE__*/__webpack_require__.n(external_ol_style_Stroke_namespaceObject);
;// CONCATENATED MODULE: external "ol.style.Text"
const external_ol_style_Text_namespaceObject = ol.style.Text;
var external_ol_style_Text_default = /*#__PURE__*/__webpack_require__.n(external_ol_style_Text_namespaceObject);
;// CONCATENATED MODULE: ./src/openlayers/core/StyleUtils.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/













var padding = 8, doublePadding = padding * 2;
const ZERO = 0.0000001;

/**
 * @class StyleUtils
 * @classdesc æ ·å¼å·¥å·ç±»ã
 * @private
 */
class StyleUtils {

  /**
   * @function StyleUtils.getValidStyleFromLayerInfo
   * @description éè¿å¾å±ä¿¡æ¯è·åææçæ ·å¼ã
   * @param {Object} layerInfo - å¾å±ä¿¡æ¯ã
   * @param {ol.Feature} feature - è¦ç´ ã
   * @param {string} url - å¾å±æ°æ®å°åã
   * @returns {ol.style.Style} è¿åå¾å±æ ·å¼ã
   */
  static getValidStyleFromLayerInfo(layerInfo, feature, url) {
    var type = feature.getGeometry().getType().toUpperCase(),
      shader = layerInfo.layerStyle,
      style = this.getDefaultStyle(type);
    if ((type === "POINT" || type === 'MULTIPOINT') && !feature.getProperties().textStyle && layerInfo.type !== 'LABEL' && !feature.getProperties().TEXT_FEATURE_CONTENT) {
      if (shader) {
        var symbolParameters = {
          "transparent": true,
          "resourceType": "SYMBOLMARKER",
          "picWidth": Math.ceil(shader.markerSize * DOTS_PER_INCH * INCHES_PER_UNIT.mm) || 13,
          "picHeight": Math.ceil(shader.markerSize * DOTS_PER_INCH * INCHES_PER_UNIT.mm) || 13,
          "style": JSON.stringify(shader)
        };
        var imageUrl = Util.urlAppend(url + "/symbol.png", Util.getParameterString(symbolParameters));
        style.pointFile = imageUrl;
        return new (external_ol_style_Style_default())({
          image: new (external_ol_style_Icon_default())({
            src: style.pointFile
          })
        });
      }
      return this.toOLPointStyle(style);
    } else if ((type === "POINT" || type === 'MULTIPOINT') && (feature.getProperties().textStyle || layerInfo.type === 'LABEL' || feature.getProperties().TEXT_STYLE_INFO)) {
      style = this.getDefaultStyle('TEXT');
      if (feature.getProperties().textStyle) {
        shader = feature.getProperties().textStyle;
      }
      if (feature.getProperties().TEXT_STYLE_INFO) {
        shader = JSON.parse(feature.getProperties().TEXT_STYLE_INFO).textStyle;
      }
      if (shader && shader !== "{}") {
        var fontStr = "";
        //è®¾ç½®ææ¬æ¯å¦å¾æ
        style.fontStyle = shader.italic ? "italic" : "normal";
        //è®¾ç½®ææ¬æ¯å¦ä½¿ç¨ç²ä½
        style.fontWeight = shader.bold ? shader.fontWeight : "normal";
        //è®¾ç½®ææ¬çå°ºå¯¸ï¼å¯¹åºfontHeightå±æ§ï¼åè¡é«ï¼è¡é«iserverä¸æ¯æï¼é»è®¤5åç´ 
        //åºå®å¤§å°çæ¶ååä½æ¯æ¯«ç±³
        var text_h = shader.fontHeight * DOTS_PER_INCH * INCHES_PER_UNIT.mm * 0.85;    //æ¯«ç±³è½¬åç´ ,æå¡ç«¯çå­ä½è²ä¼¼è¦ç¨å¾®å°ä¸ç¹
        style.fontSize = text_h + "px";

        //è®¾ç½®ææ¬å­ä½ç±»å
        //å¨æ¡é¢å­ä½é±å @æ¶ä¸ºäºè§£å³å¯¹èé£ç§å½¢å¼ï¼ä½æ¯å¨canvasä¸æ¯æï¼å¹¶ä¸æ·»å äº@ä¼å¯¼è´
        //å­ä½å¤§å°è¢«åºå®ï¼è¿ééè¦å»æ
        if (shader.fontName.indexOf("@")) {
          fontStr = shader.fontName.replace(/@/g, "");
        } else {
          fontStr = shader.fontName
        }
        style.fontFamily = fontStr;
        style.textHeight = text_h;

        //è®¾ç½®å¯¹é½æ¹å¼
        var alignStr = shader.align.replace(/TOP|MIDDLE|BASELINE|BOTTOM/, "");
        style.textAlign = alignStr.toLowerCase();
        var baselineStr = shader.align.replace(/LEFT|RIGHT|CENTER/, "");
        if (baselineStr === "BASELINE") {
          baselineStr = "alphabetic";
        }
        style.textBaseline = baselineStr.toLowerCase();

        /*//é¦åå¤å®æ¯å¦éè¦ç»å¶é´å½±ï¼å¦æéè¦ç»å¶ï¼é´å½±åºè¯¥å¨æä¸é¢
         if(shader.shadow)
         {

         //æ¡é¢éé¢çé´å½±æ²¡æåæ¨¡ç³å¤çï¼è¿éç»ä¸è®¾ç½®ä¸º0,
         style.shadowBlur=0;
         //åæ¡é¢ç»ä¸ï¼å¾å³ä¸è§åç§»é´å½±ï¼é»è®¤3åç´ 
         style.shadowOffsetX=3;
         style.shadowOffsetY=3;
         //é¢è²åä¸ä¸ªç°è²ï¼è°æåéæ
         style.shadowColor="rgba(50,50,50,0.5)";
         }else{
         style.shadowOffsetX=0;
         style.shadowOffsetY=0;
         }*/
        style.haloRadius = shader.outline ? shader.outlineWidth : 0;
        style.backColor = "rgba(" + shader.backColor.red + "," + shader.backColor.green + "," + shader.backColor.blue + ",1)";
        style.foreColor = "rgba(" + shader.foreColor.red + "," + shader.foreColor.green + "," + shader.foreColor.blue + ",1)";
        style.rotation = shader.rotation;
      }
      var text;
      if (feature.getProperties().textStyle && feature.getProperties().texts) {
        text = feature.getProperties().texts[0];
      }
      if (layerInfo.type === 'LABEL') {
        var textField = layerInfo.textField;
        if (textField && textField.indexOf('.')) {
          var arr = textField.split('.');
          textField = arr && arr.length > 0 && arr[arr.length - 1];
        }
        text = feature.getProperties().attributes ? feature.getProperties().attributes[textField] : feature.getProperties()[textField];
      }
      if (feature.getProperties().TEXT_FEATURE_CONTENT) {
        text = feature.getProperties().TEXT_FEATURE_CONTENT;
      }
      if (!text) {
        return this.toOLPointStyle(this.getDefaultStyle('POINT'));
      }
      return this.toOLTextStyle(style, text);
    } else if (shader) {
      //ç®ååªå®ç°æ¡é¢ç³»ç»é»è®¤çå ç§symbolIDï¼éç³»ç»é»è®¤çé¢ç¨é¢è²å¡«åæ¿ä»£ï¼çº¿åç¨å®çº¿æ¥æ¿ä»£
      var fillSymbolID = shader["fillSymbolID"] > 7 ? 0 : shader["fillSymbolID"];
      var lineSymbolID = shader["lineSymbolID"] > 5 ? 0 : shader["lineSymbolID"];
      for (var attr in shader) {
        var obj = StyleMap.ServerStyleMap[attr];
        var canvasStyle = obj.canvasStyle;
        if (canvasStyle && canvasStyle != "") {
          var value;
          switch (obj.type) {
            case "number":
              value = shader[attr];
              if (obj.unit) {
                //å°åä½è½¬æ¢ä¸ºåç´ åä½
                value = value * DOTS_PER_INCH * INCHES_PER_UNIT[obj.unit] * 2.5;
              }
              style[canvasStyle] = value;
              break;
            case "color":
              var color = shader[attr];
              var backColor = shader["fillBackColor"];
              var alpha = 1;
              if (canvasStyle === "fillStyle") {
                if (fillSymbolID === 0 || fillSymbolID === 1) {
                  //å½fillSymbolIDä¸º0æ¶ï¼ç¨é¢è²å¡«åï¼ä¸º1æ¯æ å¡«åï¼å³ä¸ºéæå¡«åï¼alphaééä¸º0
                  alpha = 1 - fillSymbolID;
                  value = "rgba(" + color.red + "," + color.green + "," + color.blue + "," + alpha + ")";
                } else {
                  //å½fillSymbolIDä¸º2~7æ¶ï¼ç¨ççº¹çå¡«å,ä½è¦æç§åæ¯è²ä¿®æ¹å¶é¢è²
                  try {
                    var tempCvs = document.createElement("canvas");
                    tempCvs.height = 8;
                    tempCvs.width = 8;
                    var tempCtx = tempCvs.getContext("2d");
                    var image = new Image();
                    if (this.layer && this.layer.fillImages) {
                      tempCtx.drawImage(this.layer.fillImages["System " + fillSymbolID], 0, 0);
                    }
                    var imageData = tempCtx.getImageData(0, 0, tempCvs.width, tempCvs.height);
                    var pix = imageData.data;
                    for (var i = 0, len = pix.length; i < len; i += 4) {
                      var r = pix[i], g = pix[i + 1], b = pix[i + 2];
                      //å°ç¬¦å·å¾çä¸­çç°è²æèé»è²çé¨åæ¿æ¢ä¸ºåæ¯è²ï¼å¶ä½ä¸ºåæ¯è²
                      if (r < 225 && g < 225 && b < 225) {
                        pix[i] = color.red;
                        pix[i + 1] = color.green;
                        pix[i + 2] = color.blue;
                      } else if (backColor) {
                        pix[i] = backColor.red;
                        pix[i + 1] = backColor.green;
                        pix[i + 2] = backColor.blue;
                      }
                    }
                    tempCtx.putImageData(imageData, 0, 0);
                    image.src = tempCvs.toDataURL();

                    if (this.context) {
                      value = this.context.createPattern(image, "repeat");
                    }
                  } catch (e) {
                    throw Error(e.message);
                  }
                }
              } else if (canvasStyle === "strokeStyle") {
                if (lineSymbolID === 0 || lineSymbolID === 5) {
                  //å¯¹äºlineSymbolIDä¸º0æ¶ï¼çº¿ä¸ºå®çº¿ï¼ä¸ºlineSymbolIDä¸º5æ¶ï¼ä¸ºæ çº¿æ¨¡å¼ï¼å³çº¿ä¸ºéæï¼å³alphaééä¸º0
                  alpha = lineSymbolID === 0 ? 1 : 0;
                } else {
                  //ä»¥ä¸å ç§linePatternåå«æ¨¡æäºæ¡é¢çSymbolIDä¸º1~4å ç§ç¬¦å·çlinePattern
                  var linePattern = [1, 0];
                  switch (lineSymbolID) {
                    case 1:
                      linePattern = [9.7, 3.7];
                      break;
                    case 2:
                      linePattern = [3.7, 3.7];
                      break;
                    case 3:
                      linePattern = [9.7, 3.7, 2.3, 3.7];
                      break;
                    case 4:
                      linePattern = [9.7, 3.7, 2.3, 3.7, 2.3, 3.7];
                      break;
                    default:
                      break
                  }
                  style.lineDasharray = linePattern;
                }
                value = "rgba(" + color.red + "," + color.green + "," + color.blue + "," + alpha + ")";
              }
              style[canvasStyle] = value;
              break;
            default:
              break;

          }
        }
      }
    }
    if (type === 'LINESTRING' || type === 'MULTILINESTRING') {
      return this.toOLLineStyle(style);
    }
    if (type === 'POLYGON' || type === 'MULTIPOLYGON') {
      return this.toOLPolygonStyle(style);
    }
  }

  /**
   * @function StyleUtils.getStyleFromCarto
   * @description ä» Carto ä¸­è·åææçæ ·å¼ã
   * @param {number} zoom -ç¼©æ¾çº§å«ã
   * @param {number} scale - æ¯ä¾å°ºã
   * @param {Array.<Object>} shader - æ¸²æå¨å¯¹è±¡æ°ç»ã
   * @param {Object} feature - è¦ç´ ã
   * @param {string} fromServer - æå¡æºã
   * @param {string} url - å°åã
   */
  static getStyleFromCarto(zoom, scale, shader, feature, fromServer, url) {
    var type = feature.getGeometry().getType().toUpperCase(),
      attributes = {},
      style = this.getDefaultStyle(type);
    attributes.FEATUREID = feature.getProperties().id;
    attributes.SCALE = scale;
    var cartoStyleType = feature.getProperties().type === "TEXT" ? "TEXT" : type;
    var cartoStyleMap = StyleMap.CartoStyleMap[cartoStyleType];
    var fontSize, fontName;
    if (shader) {
      for (var i = 0, len = shader.length; i < len; i++) {
        var _shader = shader[i];
        var prop = cartoStyleMap[_shader.property];
        var value = _shader.getValue(attributes, zoom, true);
        if ((value !== null) && prop) {
          if (prop === "fontSize") {
            if (fromServer) {
              value *= 0.8;
            }
            //ææ åé¢ä¸ºè¡é´è·ï¼é»è®¤ä¸º0.5åè¡é´è·
            fontSize = value + "px";
            style.fontSize = fontSize;
          } else if (prop === "fontName") {
            fontName = value;
            style.fontName = fontName;
          } else {
            if (prop === "globalCompositeOperation") {
              value = StyleMap.CartoCompOpMap[value];
              if (!value) {
                continue;
              }
            } else if (fromServer && prop === 'pointFile') {
              value = url + '/tileFeature/symbols/' + value.replace(/(___)/gi, '@');
              value = value.replace(/(__0__0__)/gi, '__8__8__');
            }
            if (prop === 'lineWidth' && value < 1) {
              value = Math.ceil(value);
            }
            style[prop] = value;
          }
        }
      }
    }
    if (feature.getProperties().type === 'TEXT') {
      var text;
      if (feature.getProperties().texts) {
        text = feature.getProperties().texts[0];
      }
      if (text == null && style.textName) {
        var textName = style.textName.substring(1, style.textName.length - 1);
        text = feature.getProperties().attributes ? feature.getProperties().attributes[textName] : feature.getProperties()[textName];
        if (text != null) {
          var texts = feature.getProperties().texts || [];
          texts.push(text);
          feature.setProperties({ texts: texts });
        }
      }
      return this.toOLTextStyle(style, text)
    }
    if (type === 'POINT' || type === 'MULTIPOINT') {
      return this.toOLPointStyle(style);
    }
    if (type === 'LINESTRING' || type === 'MULTILINESTRING') {
      return this.toOLLineStyle(style);
    }
    if (type === 'POLYGON' || type === 'MULTIPOLYGON') {
      return this.toOLPolygonStyle(style);
    }
  }

  /**
   * @function StyleUtils.toOLPointStyle
   * @description ç¹æ ·å¼ã
   * @param {Object} style - æ ·å¼åæ°ã
   * @returns {ol.style.Style} è·åç¹æ ·å¼ã
   */
  static toOLPointStyle(style) {
    if (style.pointFile !== '') {
      return new (external_ol_style_Style_default())({
        image: new (external_ol_style_Icon_default())({
          src: style.pointFile
        })
      });
    }
    return new (external_ol_style_Style_default())({
      image: new (external_ol_style_Circle_default())({
        radius: style.pointRadius,
        fill: new (external_ol_style_Fill_default())({
          color: style.fillStyle
        }),
        stroke: new (external_ol_style_Stroke_default())({
          color: style.pointHaloColor,
          width: style.pointHaloRadius
        })
      })
    });
  }

  /**
   * @function StyleUtils.toOLLineStyle
   * @description çº¿æ ·å¼ã
   * @param {Object} style - æ ·å¼åæ°ã
   * @returns {ol.style.Style} è·åçº¿çæ ·å¼ã
   */
  static toOLLineStyle(style) {
    return new (external_ol_style_Style_default())({
      stroke: new (external_ol_style_Stroke_default())({
        color: style.strokeStyle,
        width: style.lineWidth,
        lineCap: style.lineCap,
        lineDash: style.lineDasharray,
        lineDashOffset: style.lineDashOffset,
        lineJoin: style.lineJoin,
        miterLimit: style.miterLimit
      })
    });
  }

  /**
   * @function StyleUtils.toOLPolygonStyle
   * @description é¢æ ·å¼ã
   * @param {Object} style - æ ·å¼åæ°ã
   * @returns {ol.style.Style} è·åé¢çæ ·å¼ã
   */
  static toOLPolygonStyle(style) {
    var fill = new (external_ol_style_Fill_default())({
      color: style.fillStyle
    });
    var stroke = new (external_ol_style_Stroke_default())({
      color: style.strokeStyle,
      width: style.lineWidth,
      lineCap: style.lineCap,
      lineDash: style.lineDasharray,
      lineDashOffset: style.lineDashOffset,
      lineJoin: style.lineJoin,
      miterLimit: style.miterLimit
    });
    return new (external_ol_style_Style_default())({
      fill: fill,
      stroke: stroke
    });
  }

  /**
   * @function StyleUtils.toOLTextStyle
   * @description ææ¬æ ·å¼ã
   * @param {Object} style - æ ·å¼å¯¹è±¡ã
   * @param {string} text - ææ¬åæ°ã
   * @returns {ol.style.Style} è·åçææ¬æ ·å¼ã
   */
  static toOLTextStyle(style, text) {
    return new (external_ol_style_Style_default())({
      text: new (external_ol_style_Text_default())({
        font: (style.fontStyle || '') + ' ' + (style.fontWeight || '') + ' ' + (style.fontSize || '') + ' ' + style.fontFamily,
        text: text,
        textAlign: style.textAlign,
        textBaseline: style.textBaseline,
        fill: new (external_ol_style_Fill_default())({
          color: style.foreColor
        }),
        stroke: new (external_ol_style_Stroke_default())({
          color: style.backColor
        }),
        offsetX: style.offsetX,
        offsetY: style.offsetY
      })
    })
  }

  /**
   * @function StyleUtils.dashStyle
   * @description ç¬¦å·æ ·å¼ã
   * @param {Object} style - æ ·å¼åæ°ã
   * @param {number} widthFactor - å®½åº¦ç³»æ°ã
   */
  static dashStyle(style, widthFactor) {
    if (!style) {
      return [];
    }
    var w = style.strokeWidth * widthFactor;
    var str = style.strokeDashstyle || style.lineDash;
    switch (str) {
      case 'solid':
        return [0];
      case 'dot':
        return [1, 4 * w];
      case 'dash':
        return [4 * w, 4 * w];
      case 'dashdot':
        return [4 * w, 4 * w, 1, 4 * w];
      case 'longdash':
        return [8 * w, 4 * w];
      case 'longdashdot':
        return [8 * w, 4 * w, 1, 4 * w];
      default:
        if (!str) {
          return [];
        }
        if (Util.isArray(str)) {
          return str;
        }
        str = StringExt.trim(str).replace(/\s+/g, ",");
        return str.replace(/\[|\]/gi, "").split(",");
    }
  }

  /**
   * @function StyleUtils.getStyleFromiPortalMarker
   * @description ä» iPortal æ è®°è·åæ ·å¼ã
   * @param {Object} icon - å¾æ åæ°ã
   */
  static getStyleFromiPortalMarker(icon) {
    if (icon.indexOf("./") == 0) {
      return null;
    }
    //å¼å®¹iportalç¤ºä¾çé®é¢
    if (icon.indexOf("http://support.supermap.com.cn:8092/static/portal") == 0) {
      icon = icon.replace("http://support.supermap.com.cn:8092/static/portal", "http://support.supermap.com.cn:8092/apps/viewer/static");
    }
    return new (external_ol_style_Style_default())({
      image: new (external_ol_style_Icon_default())({
        src: icon,
        opacity: 1,
        size: [48, 43],
        anchor: [0.5, 1]
      })
    });
  }

  /**
   * @function StyleUtils.getStyleFromiPortalStyle
   * @description ä» iPortal æ è®°è·åæ ·å¼ã
   * @param {Object} iPortalStyle - iportal æ ·å¼ã
   * @param {string} type - æ ·å¼ç±»åã
   * @param {Object} fStyle - è¦ç´ æ ·å¼ã
   */
  static getStyleFromiPortalStyle(iPortalStyle, type, fStyle) {
    var featureStyle = fStyle ? JSON.parse(fStyle) : null;
    var me = this;
    if (type === 'Point' || type === 'MultiPoint') {
      var pointStyle = featureStyle || iPortalStyle.pointStyle;
      if (pointStyle.externalGraphic) {
        if (pointStyle.externalGraphic.indexOf("./") == 0) {
          return null;
        }
        //å¼å®¹iportalç¤ºä¾çé®é¢
        if (pointStyle.externalGraphic.indexOf("http://support.supermap.com.cn:8092/static/portal") == 0) {
          pointStyle.externalGraphic = pointStyle.externalGraphic.replace("http://support.supermap.com.cn:8092/static/portal", "http://support.supermap.com.cn:8092/apps/viewer/static");
        }
        return new (external_ol_style_Style_default())({
          image: new (external_ol_style_Icon_default())({
            src: pointStyle.externalGraphic,
            opacity: pointStyle.graphicOpacity,
            size: [pointStyle.graphicWidth, pointStyle.graphicHeight]
            //anchor: [-pointStyle.graphicXOffset / pointStyle.graphicWidth, -pointStyle.graphicYOffset / pointStyle.graphicHeight]
          })
        });
      }
      return new (external_ol_style_Style_default())({
        image: new (external_ol_style_Circle_default())({
          fill: new (external_ol_style_Fill_default())({
            color: me.hexToRgba(pointStyle.fillColor, pointStyle.fillOpacity)
          }),
          stroke: new (external_ol_style_Stroke_default())({
            color: me.hexToRgba(pointStyle.strokeColor, pointStyle.strokeOpacity),
            lineCap: pointStyle.strokeLineCap,
            lineDash: this.dashStyle(pointStyle, 1),
            width: pointStyle.strokeWidth
          }),
          radius: pointStyle.pointRadius
        })
      });
    }
    if (type === 'LineString' || type === 'MultiLineString' || type === 'Box') {
      var lineStyle = featureStyle || iPortalStyle.lineStyle;
      return new (external_ol_style_Style_default())({
        stroke: new (external_ol_style_Stroke_default())({
          color: me.hexToRgba(lineStyle.strokeColor, lineStyle.strokeOpacity),
          lineCap: lineStyle.strokeLineCap,
          lineDash: this.dashStyle(lineStyle, 1),
          width: lineStyle.strokeWidth
        })
      });
    }
    if (type === 'Polygon' || type === 'MultiPolygon') {
      var polygonStyle = featureStyle || iPortalStyle.polygonStyle;
      return new (external_ol_style_Style_default())({
        fill: new (external_ol_style_Fill_default())({
          color: me.hexToRgba(polygonStyle.fillColor, polygonStyle.fillOpacity)
        }),
        stroke: new (external_ol_style_Stroke_default())({
          color: me.hexToRgba(polygonStyle.strokeColor, polygonStyle.strokeOpacity),
          lineCap: polygonStyle.strokeLineCap,
          lineDash: this.dashStyle(polygonStyle, 1),
          width: polygonStyle.strokeWidth
        })
      });
    }
  }

  /**
   * @function StyleUtils.hexToRgba
   * @description åå­è¿å¶è½¬ RGBA æ ¼å¼ã
   * @param {Object} hex - åå­è¿å¶æ ¼å¼åæ°ã
   * @param {number} opacity -Alpha åæ°ã
   * @returns {string} çæç RGBA æ ¼å¼ã
   */
  static hexToRgba(hex, opacity) {
    var color = [], rgba = [];
    hex = hex.replace(/#/, "");
    if (hex.length == 3) {
      var tmp = [];
      for (let i = 0; i < 3; i++) {
        tmp.push(hex.charAt(i) + hex.charAt(i));
      }
      hex = tmp.join("");
    }
    for (let i = 0; i < 6; i += 2) {
      color[i] = "0x" + hex.substr(i, 2);
      rgba.push(parseInt(Number(color[i])));
    }
    rgba.push(opacity);
    return "rgba(" + rgba.join(",") + ")";
  }

  /**
   * @function StyleUtils.getDefaultStyle
   * @description è·åé»è®¤é£æ ¼
   * @param {string} type - ç±»ååæ°ã
   * @returns {string}
   */
  static getDefaultStyle(type) {
    var style = {};
    var canvasStyle = DeafultCanvasStyle[type];
    for (var prop in canvasStyle) {
      var val = canvasStyle[prop];
      style[prop] = val;
    }
    return style;
  }

  /**
   * @function StyleUtils.getDefaultStyle
   * @description å°æ ·å¼å¯¹è±¡è½¬æ¢æopenlayerè¦æ±çol.style
   * @param {string} style - æ ·å¼å¯¹è±¡
   * @param {string} type - featureçç±»å
   * @returns {ol.style.Style}
   */
  static toOpenLayersStyle(style, type) {
    style = style || this.getDefaultStyle();
    let olStyle = new (external_ol_style_Style_default())();
    let newImage, newFill, newStroke;
    let {
      fillColor,
      fillOpacity,
      strokeColor,
      strokeWidth,
      strokeOpacity,
      radius,
      lineCap,
      src,
      scale,
      offsetX,
      offsetY,
      //size,
      //imgSize,
      anchor
    } = style;
    let fillColorArray = this.hexToRgb(fillColor);
    if (fillColorArray) {
      fillColorArray.push(fillOpacity);
    }

    let strokeColorArray = this.hexToRgb(strokeColor);
    if (strokeColorArray) {
      strokeColorArray.push(strokeOpacity);
    }
    if (type === "POINT") {
      if (src) {
        if (/.+(\.svg$)/.test(src)) {
          if (!this.svgDiv) {
            this.svgDiv = document.createElement('div');
            document.body.appendChild(this.svgDiv);
          }
          this.getCanvasFromSVG(src, this.svgDiv, (canvas) => {
            newImage = new (external_ol_style_Icon_default())({
              img: canvas,
              scale: radius / canvas.width,
              imgSize: [canvas.width, canvas.height],
              anchor: [0.5, 0.5]
            })
          })
        } else {
          newImage = new (external_ol_style_Icon_default())({
            src: src,
            scale: scale,
            anchor: anchor
          });
        }
      } else {
        newImage = new (external_ol_style_Circle_default())({
          radius,
          fill: new (external_ol_style_Fill_default())({
            color: fillColorArray
          }),
          stroke: new (external_ol_style_Stroke_default())({
            width: strokeWidth || ZERO,
            color: strokeColorArray
          }),
          displacement: this.getCircleDisplacement(radius, offsetX, offsetY)
        });
      }
      olStyle.setImage(newImage);
    } else if (type === "LINE" || type === "LINESTRING" || type === 'MULTILINESTRING' || type === 'LINEARRING') {
      newStroke = new (external_ol_style_Stroke_default())({
        width: strokeWidth || ZERO,
        color: strokeColorArray,
        lineCap: lineCap || 'round',
        lineDash: this.dashStyle(style, 1)
      });
      olStyle.setStroke(newStroke);
    } else if (type === 'POLYGON' ||
      type === 'MULTIPOLYGON' || type === 'REGION') {
      newFill = new (external_ol_style_Fill_default())({
        color: fillColorArray
      });
      newStroke = new (external_ol_style_Stroke_default())({
        width: strokeWidth || ZERO,
        color: strokeColorArray,
        lineCap: lineCap || 'round',
        lineDash: this.dashStyle(style, 1)
      });
      olStyle.setFill(newFill);
      olStyle.setStroke(newStroke);
    } else {
      let result = this.getCanvas(style);
      newImage = new (external_ol_style_Icon_default())({
        img: result.canvas,
        imgSize: [result.width, result.height],
        scale: 1,
        anchor: [0.5, 0.5]
      });
      olStyle.setImage(newImage);
    }
    return olStyle;
  }

  /**
   * @function StyleUtils.getIconAnchor
   * @description è·åå¾æ çéç¹
   * @param {number} offsetX - Xæ¹ååç§»åæ°
   * @param {number} offsetY - Yæ¹ååç§»åæ°
   * @returns {Array.<number>}
   */
  static getIconAnchor(offsetX=0.5, offsetY=0.5) {
    return [offsetX, offsetY];
  }
  /**
   * @function StyleUtils.getCircleDisplacement
   * @description è·åååçåç§»
   * @param {number} radius - åååå¾
   * @param {number} offsetX - Xæ¹ååç§»åæ°
   * @param {number} offsetY - Yæ¹ååç§»åæ°
   * @returns {Array.<number>}
   */
  static getCircleDisplacement(radius, offsetX=0, offsetY=0) {
      const dispX = radius*offsetX, dispY = radius*offsetY;
      return [dispX, -dispY];
  }
  /**
   * @function StyleUtils.getTextOffset
   * @description è·åå­ä½å¾æ çåç§»å¼
   * @param {string} fontSize - å­ä½å¤§å°ï¼å¦12px
   * @param {number} offsetX - Xæ¹ååç§»åæ°
   * @param {number} offsetY - Yæ¹ååç§»åæ°
   * @returns {Object}
   */
  static getTextOffset(fontSize, offsetX=0, offsetY=0) {
    const radius = fontSize.substr(0, fontSize.length - 2) / 2;
    return {
          x: radius*offsetX,
          y: radius*offsetY
    };
  }

  /**
   * è·åæå­æ æ³¨å¯¹åºçcanvas
   * @param style
   * @returns {{canvas: *, width: number, height: number}}
   */
  static getCanvas(style) {
    let canvas;
    if (style.canvas) {
      if (document.querySelector("#" + style.canvas)) {
        canvas = document.getElemntById(style.canvas);
      } else {
        canvas = this.createCanvas(style);
      }
    } else {
      //ä¸å­å¨canvasï¼å½åfeature
      canvas = this.createCanvas(style);
      style.canvas = canvas.id;
    }
    canvas.style.display = "none";
    var ctx = canvas.getContext("2d");
    //è¡é«
    let lineHeight = Number(style.font.replace(/[^0-9]/ig, ""));
    let textArray = style.text.split('\r\n');
    let lenght = textArray.length;
    //å¨æ¹åcanvaså¤§å°ååç»å¶ãå¦åä¼è¢«æ¸é¤
    ctx.font = style.font;
    let size = this.drawRect(ctx, style, textArray, lineHeight, canvas);
    this.positionY = padding;
    if (lenght > 1) {
      textArray.forEach(function (text, i) {
        if (i !== 0) {
          this.positionY = this.positionY + lineHeight;
        }
        this.canvasTextAutoLine(text, style, ctx, lineHeight, size.width);
      }, this);
    } else {
      this.canvasTextAutoLine(textArray[0], style, ctx, lineHeight, size.width);
    }
    return {
      canvas: canvas,
      width: size.width,
      height: size.height
    };
  }
  /**
   * åå»ºå½åfeatureå¯¹åºçcanvas
   * @param {Object} style
   * @returns {HTMLElement}
   */
  static createCanvas(style) {
    let div = document.createElement('div');
    document.body.appendChild(div);
    let canvas = document.createElement('canvas');
    canvas.id = style.canvas ? style.canvas : 'textCanvas' + core_Util_Util.newGuid(8);
    div.appendChild(canvas);
    return canvas;
  }
  /**
   * ç»å¶ç©å½¢è¾¹æ¡èæ¯
   * @param ctx
   * @param style
   * @param textArray
   * @param lineHeight
   * @param canvas
   * @returns {{width: number, height: number}}
   */
  static drawRect(ctx, style, textArray, lineHeight, canvas) {
    let backgroundFill = style.backgroundFill, maxWidth = style.maxWidth - doublePadding;
    let width, height = 0, lineCount = 0, lineWidths = [];
    //100çå®½åº¦ï¼å»æå·¦å³ä¸¤è¾¹3padding
    textArray.forEach(function (arrText) {
      let line = '', isOverMax;
      lineCount++;
      for (var n = 0; n < arrText.length; n++) {
        let textLine = line + arrText[n];
        let metrics = ctx.measureText(textLine);
        let textWidth = metrics.width;
        if ((textWidth > maxWidth && n > 0) || arrText[n] === '\n') {
          line = arrText[n];
          lineCount++;
          //ææ¢è¡ï¼è®°å½å½åæ¢è¡çwidth
          isOverMax = true;
        } else {
          line = textLine;
          width = textWidth;
        }
      }
      if (isOverMax) {
        lineWidths.push(maxWidth);
      } else {
        lineWidths.push(width);
      }
    }, this);
    width = this.getCanvasWidth(lineWidths, maxWidth);
    height = lineCount * lineHeight;
    height += doublePadding;
    canvas.width = width;
    canvas.height = height;
    ctx.fillStyle = backgroundFill;
    ctx.fillRect(0, 0, width, height);
    return {
      width: width,
      height: height
    }
  }
  /**
   * è·åèªéåºçå®½åº¦ï¼å¦ææ²¡æè¶è¿æå¤§å®½åº¦ï¼å°±ç¨æå­çå®½åº¦ï¼
   * @param lineWidths
   * @param maxWidth
   * @returns {number}
   */
  static getCanvasWidth(lineWidths, maxWidth) {
    let width = 0;
    for (let i = 0; i < lineWidths.length; i++) {
      let lineW = lineWidths[i];
      if (lineW >= maxWidth) {
        //æä»»ä½ä¸è¡è¶è¿æå¤§é«åº¦ï¼å°±ç¨æå¤§é«åº¦
        return maxWidth + doublePadding;
      } else if (lineW > width) {
        //èªå·±æ¢è¡ï¼å°±è¦æ¯è¾æ¯è¡çæå¤§å®½åº¦
        width = lineW;
      }
    }
    return width + doublePadding;
  }
  /**
   * ç»å¶æå­ï¼è§£å³æ¢è¡é®é¢
   * @param text
   * @param style
   * @param ctx
   * @param lineHeight
   */
  static canvasTextAutoLine(text, style, ctx, lineHeight, canvasWidth) {
    // å­ç¬¦åéä¸ºæ°ç»
    ctx.font = style.font;
    let textAlign = style.textAlign;
    let x = this.getPositionX(textAlign, canvasWidth);
    let arrText = text.split('');
    let line = '', fillColor = style.fillColor;
    //æ¯ä¸è¡éå¶çé«åº¦
    let maxWidth = style.maxWidth - doublePadding;
    for (var n = 0; n < arrText.length; n++) {
      let testLine = line + arrText[n];
      let metrics = ctx.measureText(testLine);
      let testWidth = metrics.width;
      if ((testWidth > maxWidth && n > 0) || arrText[n] === '\n') {
        ctx.fillStyle = fillColor;
        ctx.textAlign = textAlign;
        ctx.textBaseline = "top";
        ctx.fillText(line, x, this.positionY);
        line = arrText[n];
        this.positionY += lineHeight;
      } else {
        line = testLine;
      }
    }
    ctx.fillStyle = fillColor;
    ctx.textAlign = textAlign;
    ctx.textBaseline = "top";
    ctx.fillText(line, x, this.positionY);
  }
  /**
   * å¾å°ç»å¶çèµ·ç¹ä½ç½®ï¼æ ¹æ®alignä¸åï¼ä½ç½®ä¹ä¸å
   * @param textAlign
   * @returns {number}
   */
  static getPositionX(textAlign, canvasWidth) {
    let x;
    let width = canvasWidth - doublePadding; //åå»padding
    switch (textAlign) {
      case 'center':
        x = width / 2;
        break;
      case 'right':
        x = width;
        break;
      default:
        x = 8;
        break;
    }
    return x;
  }

  /**
   * @function StyleUtils.hexToRgb
   * @description å°16è¿å¶çé¢è²ï¼è½¬æ¢ærgbæ ¼å¼
   * @param {string} hexColor 16è¿å¶é¢è²
   * @returns {string} rgbæ ¼å¼çé¢è²
   */
  static hexToRgb(hexColor) {
    if (!hexColor) {
      return;
    }
    var s = hexColor.replace('#', '').split('');
    var rgb = [s[0] + s[1], s[2] + s[3], s[4] + s[5]];
    rgb = rgb.map(function (hex) {
      return parseInt(hex, 16);
    });
    return rgb;
  }

  /**
   * @function StyleUtils.formatRGB
   * @description å°é¢è²æ°ç»è½¬æ¢ææ åçrgbé¢è²æ ¼å¼
   * @param {Array} colorArray - é¢è²æ°ç»
   * @returns {string} 'rgb(0,0,0)'æè 'rgba(0,0,0,0)'
   */
  static formatRGB(colorArray) {
    let rgb;
    if (colorArray.length === 3) {
      rgb = 'rgb(';
      colorArray.forEach(function (color, index) {
        index === 2 ? rgb += color : rgb += color + ',';
      });
    } else {
      rgb = 'rgba(';
      colorArray.forEach(function (color, index) {
        index === 3 ? rgb += color : rgb += color + ',';
      });
    }
    rgb += ")"
    return rgb;
  }

  /**
   * @function StyleUtils.getCanvasFromSVG
   * @description å°SVGè½¬æ¢æCanvas
   * @param {string} svgUrl - é¢è²æ°ç»
   * @param {Object} divDom - divçdomå¯¹è±¡
   * @param {function} callBack - è½¬æ¢æåæ§è¡çåè°å½æ°
   */
  static getCanvasFromSVG(svgUrl, divDom, callBack) {
    //ä¸ä¸ªå¾å±å¯¹åºä¸ä¸ªcanvas
    let canvgs = window.canvg ? window.canvg : (external_function_try_return_canvg_catch_e_return_default());
    let canvas = document.createElement('canvas');
    canvas.id = 'dataviz-canvas-' + core_Util_Util.newGuid(8);
    canvas.style.display = "none";
    divDom.appendChild(canvas);
    try {
      canvgs(canvas.id, svgUrl, {
        ignoreMouse: true,
        ignoreAnimation: true,
        renderCallback: function () {
          if (canvas.width > 300 || canvas.height > 300) {
            // Util.showMessage(DataViz.Language.sizeIsWrong,'WARNING');
            return;
          }
          callBack(canvas);
        },
        forceRedraw: function () {
          return false
        }
      });
    } catch (e) {
      return;
    }
  }

  /**
   * @function StyleUtils.getMarkerDefaultStyle è·åé»è®¤æ æ³¨å¾å±featureçæ ·å¼
   * @param {string} featureType featureçç±»å
   * @param {string} server å½åå°å¾åç¼
   * @returns {Object} styleå¯¹è±¡
   */
  static getMarkerDefaultStyle(featureType, server) {
    let style;
    switch (featureType) {
      case 'POINT':
        style = {
          src: `${server}apps/dataviz/static/imgs/markers/mark_red.png`,
          scale: 1,
          anchor: [0.5, 1]
        };
        break;
      case 'LINE':
      case 'LINESTRING':
      case 'MULTILINESTRING':
        style = {
          strokeColor: '#3498db',
          strokeOpacity: 1,
          strokeWidth: 5,
          lineCap: 'round',
          lineDash: 'solid'
        };
        break;
      case 'REGION':
      case 'POLYGON':
      case 'MULTIPOLYGON':
        style = {
          fillColor: '#1abd9c',
          fillOpacity: 1,
          strokeColor: '#3498db',
          strokeOpacity: 1,
          strokeWidth: 3,
          lineCap: 'round',
          lineDash: 'solid'
        };
        break;
    }
    return style;
  }

  /**
   * @function StyleUtils.getOpenlayerStyle è·åä¸é¢å¾å¯¹åºçopenlayersæ ¼å¼çstyle
   * @param {string} styleParams æ ·å¼åæ°
   * @param {string} featureType featureç±»å
   * @param {boolean} isRank æ¯å¦ä¸ºç­çº§ç¬¦å·
   * @returns {Object} styleå¯¹è±¡
   */
  static getOpenlayersStyle(styleParams, featureType, isRank) {
    let style;
    if (styleParams.type === "BASIC_POINT") {
      style = this.toOpenLayersStyle(styleParams, featureType);
    } else if (styleParams.type === "SYMBOL_POINT") {
      style = this.getSymbolStyle(styleParams, isRank);
    } else if (styleParams.type === "SVG_POINT") {
      style = this.getSVGStyle(styleParams);
    } else if (styleParams.type === 'IMAGE_POINT') {
      style = this.getImageStyle(styleParams);
    }
    return style;
  }

  /**
   * @function StyleUtils.getSymbolStyle è·åç¬¦å·æ ·å¼
   * @param {Object} parameters - æ ·å¼åæ°
   * @returns {Object} styleå¯¹è±¡
   */
  static getSymbolStyle(parameters, isRank) {
    let text = '';
    if (parameters.unicode) {
      text = String.fromCharCode(parseInt(parameters.unicode.replace(/^&#x/, ''), 16));
    }
    // å¡«åè² + éæåº¦
    let fillColor = StyleUtils.hexToRgb(parameters.fillColor);
    fillColor.push(parameters.fillOpacity);
    // è¾¹æ¡åè² + éæåº¦
    let strokeColor = StyleUtils.hexToRgb(parameters.strokeColor);
    strokeColor.push(parameters.strokeOpacity);

    let fontSize = isRank ? 2 * parameters.radius + "px" : parameters.fontSize;

    const {offsetX, offsetY, rotation=0} = parameters;
    const offset = StyleUtils.getTextOffset(fontSize, offsetX, offsetY);
    return new (external_ol_style_Style_default())({
        text: new (external_ol_style_Text_default())({
            text: text,
            font: fontSize + " supermapol-icons",
            placement: 'point',
            textAlign: 'center',
            fill: new (external_ol_style_Fill_default())({
              color: fillColor
            }),
            backgroundFill: new (external_ol_style_Fill_default())({
              color: [0, 0, 0, 0]
            }),
            stroke: new (external_ol_style_Stroke_default())({
              width: parameters.strokeWidth || 0.000001,
              color: strokeColor
            }),
            offsetX: offset.x,
            offsetY: offset.y,
            rotation
        })
    });
  }
  /**
   * @function StyleUtils.getSVGStyle è·åsvgçæ ·å¼
   * @param {Object} styleParams - æ ·å¼åæ°
   * @returns {Object} styleå¯¹è±¡
   */
  static getSVGStyle(styleParams) {
    let style, that = this;
    if (!that.svgDiv) {
      that.svgDiv = document.createElement('div');
      document.body.appendChild(that.svgDiv);
    }
    const { url, radius, offsetX, offsetY, fillOpacity, rotation } = styleParams;
    let anchor = this.getIconAnchor(offsetX, offsetY);
    StyleUtils.getCanvasFromSVG(url, that.svgDiv, function (canvas) {
      style = new (external_ol_style_Style_default())({
        image: new (external_ol_style_Icon_default())({
          img: that.setColorToCanvas(canvas, styleParams),
          scale: 2 * radius / canvas.width,
          imgSize: [canvas.width, canvas.height],
          anchor: anchor || [0.5, 0.5],
          opacity: fillOpacity,
          anchorOrigin: 'bottom-right',
          rotation
        })
      });
    });
    return style;
  }

  /**
   * @function StyleUtils.setColorToCanvas å°é¢è²ï¼éæåº¦ç­æ ·å¼è®¾ç½®å°canvasä¸
   * @param {Object} canvas - æ¸²æçcanvaså¯¹è±¡
   * @param {Object} parameters - æ ·å¼åæ°
   * @returns {Object} styleå¯¹è±¡
   */
  static setColorToCanvas(canvas, parameters) {
    let context = canvas.getContext('2d');
    let fillColor = StyleUtils.hexToRgb(parameters.fillColor);
    fillColor && fillColor.push(parameters.fillOpacity);
    let strokeColor = StyleUtils.hexToRgb(parameters.strokeColor);
    strokeColor && strokeColor.push(parameters.strokeOpacity);
    context.fillStyle = StyleUtils.formatRGB(fillColor);
    context.fill();
    context.strokeStyle = StyleUtils.formatRGB(strokeColor);
    context.lineWidth = parameters.strokeWidth;
    context.stroke();
    return canvas;
  }
  /**
   * @function StyleUtils.getImageStyle è·åå¾çæ ·å¼
   * @param {Object} styleParams - æ ·å¼åæ°
   * @returns {Object} styleå¯¹è±¡
   */
  static getImageStyle(styleParams) {
      let size = styleParams.imageInfo.size,
        scale = 2 * styleParams.radius / size.w;
      let imageInfo = styleParams.imageInfo;
      let imgDom = imageInfo.img;
      if (!imgDom || !imgDom.src) {
        imgDom = new Image();
        //è¦ç»è£æå®æ´çurl
        imgDom.src = imageInfo.url;
      }
      const { offsetX, offsetY, rotation } = styleParams;
      let anchor = this.getIconAnchor(offsetX, offsetY);
      return new (external_ol_style_Style_default())({
        image: new (external_ol_style_Icon_default())({
          img: imgDom,
          scale,
          imgSize: [size.w, size.h],
          anchor: anchor || [0.5, 0.5],
          anchorOrigin: 'bottom-right',
          rotation
        })
      });
  }
  /**
   * @function StyleUtils.getRoadPath è·åéè·¯æ ·å¼
   * @param {Object} style - æ ·å¼åæ°
   * @param {Object} outlineStyle - è½®å»æ ·å¼åæ°
   * @returns {Object} styleå¯¹è±¡
   */
  static getRoadPath(style, outlineStyle) {
    const { strokeWidth=ZERO, lineCap, strokeColor, strokeOpacity } = style;
    // éè·¯çº¿é½æ¯solid
    let strokeColorArray = this.hexToRgb(strokeColor);
    strokeColorArray && strokeColorArray.push(strokeOpacity);
    var stroke = new (external_ol_style_Style_default())({
        stroke: new (external_ol_style_Stroke_default())({
            width: strokeWidth || ZERO,
            color: strokeColorArray,
            lineCap: lineCap || 'round',
            lineDash: [0]
        })
    });

    const { strokeColor: outlineColor } = outlineStyle;
    let outlineColorArray = this.hexToRgb(outlineColor);
    // opacityä½¿ç¨styleçéæåº¦ãä¿æä¸¤æ ¹çº¿éæåº¦ä¸è´
    outlineColorArray && outlineColorArray.push(strokeOpacity);
    let outlineWidth = strokeWidth === 0 ? ZERO : strokeWidth + 2; //å¤é¨å®½åº¦=åé¨æ ·å¼å®½åº¦ + 2
    var outlineStroke = new (external_ol_style_Style_default())({
        stroke: new (external_ol_style_Stroke_default())({
            width: outlineWidth, //å¤é¨å®½åº¦=åé¨æ ·å¼å®½åº¦ + 2
            color: outlineColorArray,
            lineCap: lineCap || 'round',
            lineDash: [0]
        })
    });
    return [outlineStroke, stroke];
  }
  /**
   * @function StyleUtils.getPathway è·åéè·¯æ ·å¼
   * @param {Object} style - æ ·å¼åæ°
   * @param {Object} outlineStyle - è½®å»æ ·å¼åæ°
   * @returns {Object} styleå¯¹è±¡
   */
  static getPathway(style, outlineStyle) {
      let { strokeWidth=ZERO, strokeColor, strokeOpacity } = style;
      // éè·¯çº¿é½æ¯solid, lineCapé½æ¯ç´è§
      const lineDash = (w => [w, w + strokeWidth * 2])(4 * strokeWidth), lineCap= 'square';
      let strokeColorArray = this.hexToRgb(strokeColor);
      strokeColorArray && strokeColorArray.push(strokeOpacity);
      var stroke = new (external_ol_style_Style_default())({
          stroke: new (external_ol_style_Stroke_default())({
              width: strokeWidth*0.5 || ZERO,
              color: strokeColorArray,
              lineCap,
              lineDash
          })
      });

    const { strokeColor: outlineColor } = outlineStyle;
    let outlineColorArray = this.hexToRgb(outlineColor);
    // opacityä½¿ç¨styleçéæåº¦ãä¿æä¸¤æ ¹çº¿éæåº¦ä¸è´
    outlineColorArray && outlineColorArray.push(strokeOpacity);
    var outlineStroke = new (external_ol_style_Style_default())({
        stroke: new (external_ol_style_Stroke_default())({
          width: strokeWidth || ZERO,
            color: outlineColorArray,
            lineCap
        })
    });
    return [outlineStroke, stroke];
  }
}

;// CONCATENATED MODULE: external "ol.Map"
const external_ol_Map_namespaceObject = ol.Map;
var external_ol_Map_default = /*#__PURE__*/__webpack_require__.n(external_ol_Map_namespaceObject);
;// CONCATENATED MODULE: external "ol.layer.Group"
const external_ol_layer_Group_namespaceObject = ol.layer.Group;
var external_ol_layer_Group_default = /*#__PURE__*/__webpack_require__.n(external_ol_layer_Group_namespaceObject);
;// CONCATENATED MODULE: ./src/openlayers/core/MapExtend.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @function MapExtend
 * @description æ©å± OpenLayers çä¸äºåå§æ¹æ³ã
 * @private
 */
var MapExtend = function () {
    const fun = function (layer, coordinate, resolution, callback, pixel, e) {
        if (layer instanceof (external_ol_layer_Group_default())) {
            layer.getLayers().forEach(function (subLayer) {
                fun(subLayer, coordinate, resolution, callback, pixel, e)
            });
        } else {
            //å½åé«æçç¹å¾å±æ»¡è¶³ç­éæ¡ä»¶/å¹¶ä¸å¯è§æ¶ï¼å¯è¢«éä¸­ï¼
            if (layer.getSource()._forEachFeatureAtCoordinate) {
                layer.getSource()._forEachFeatureAtCoordinate(coordinate, resolution, (feature) => {
                    callback(feature, layer)
                }, pixel, e);
            }
        }
    }
    ;(external_ol_Map_default()).prototype.forEachFeatureAtPixelDefault = (external_ol_Map_default()).prototype.forEachFeatureAtPixel;

    ;(external_ol_Map_default()).prototype.forEachFeatureAtPixel = (external_ol_Map_default()).prototype.Tc = function (pixel, callback, opt_options, e) {

        //å¦ææ»¡è¶³é«æçå¾å±éåè¦æ±ä¼åè¿åé«æçå¾å±éä¸­ç»æ
        const layerFilter = (opt_options && opt_options.layerFilter) ? opt_options.layerFilter : () => {
            return true;
        };

        const layers = this.getLayers().getArray();
        const resolution = this.getView().getResolution();
        const coordinate = this.getCoordinateFromPixel(pixel);

        for (let i = 0; i < layers.length; i++) {
            const layer = layers[i];
            if (layer.getVisible() && layerFilter.call(null, layer)) {
                fun(layer, coordinate, resolution, callback, pixel, e)
            }

        }
        return this.forEachFeatureAtPixelDefault(pixel, callback, opt_options);
    }
}();
;// CONCATENATED MODULE: ./src/openlayers/core/index.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




;// CONCATENATED MODULE: external "ol.source.TileImage"
const external_ol_source_TileImage_namespaceObject = ol.source.TileImage;
var external_ol_source_TileImage_default = /*#__PURE__*/__webpack_require__.n(external_ol_source_TileImage_namespaceObject);
;// CONCATENATED MODULE: external "ol.asserts"
const external_ol_asserts_namespaceObject = ol.asserts;
;// CONCATENATED MODULE: external "ol.tilegrid.TileGrid"
const external_ol_tilegrid_TileGrid_namespaceObject = ol.tilegrid.TileGrid;
var external_ol_tilegrid_TileGrid_default = /*#__PURE__*/__webpack_require__.n(external_ol_tilegrid_TileGrid_namespaceObject);
;// CONCATENATED MODULE: ./src/openlayers/mapping/BaiduMap.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class BaiduMap
 * @browsernamespace ol.source
 * @category  ThirdPartyMap
 * @classdesc ç¾åº¦å°å¾å¾å±æºã
 * @param {Object} opt_options - åæ°ã
 * @param {string} [opt_options.url='http://online1.map.bdimg.com/onlinelabel/?qt=tile&x={x}&y={y}&z={z}&styles={styles}&udt=20170408'] - æå¡å°åã
 * @param {string} [opt_options.tileProxy] - ä»£çå°åã
 * @param {boolean} [hidpi = false] - æ¯å¦ä½¿ç¨é«åè¾¨çå°å¾ã
 * @extends {ol.source.TileImage}
 * @usage
 */
class BaiduMap extends (external_ol_source_TileImage_default()) {
    constructor(opt_options) {
        var options = opt_options || {};
        var attributions =
            options.attributions ||
            "Map Data Â© 2018 Baidu - GS(2016)2089å· - Data Â© é¿å°ä¸æ¹ with <span>Â© <a href='https://iclient.supermap.io' target='_blank'>SuperMap iClient</a></span>";
        var tileGrid = BaiduMap.defaultTileGrid();
        var crossOrigin = options.crossOrigin !== undefined ? options.crossOrigin : 'anonymous';

        var url =
            options.url !== undefined
                ? options.url
                : 'http://online1.map.bdimg.com/onlinelabel/?qt=tile&x={x}&y={y}&z={z}&styles={styles}&udt=20170408';
        var hidpi =
            options.hidpi || (window.devicePixelRatio || window.screen.deviceXDPI / window.screen.logicalXDPI) > 1;
        url = url.replace('{styles}', hidpi ? 'ph' : 'pl');
        super({
            attributions: attributions,
            cacheSize: options.cacheSize,
            crossOrigin: crossOrigin,
            opaque: options.opaque !== undefined ? options.opaque : true,
            maxZoom: options.maxZoom !== undefined ? options.maxZoom : 19,
            reprojectionErrorThreshold: options.reprojectionErrorThreshold,
            tileLoadFunction: options.tileLoadFunction,
            projection: 'EPSG:3857',
            wrapX: options.wrapX,
            tilePixelRatio: hidpi ? 2 : 1,
            tileGrid: tileGrid,
            tileUrlFunction: tileUrlFunction
        });

        if (options.tileProxy) {
            this.tileProxy = options.tileProxy;
        }
        var me = this;

        // eslint-disable-next-line no-unused-vars
        function tileUrlFunction(tileCoord, pixelRatio, projection) {
            var tempUrl = url
                .replace('{z}', tileCoord[0].toString())
                .replace('{x}', tileCoord[1].toString())
                .replace('{y}', function() {
                    console.log(core_Util_Util.getOlVersion());
                    var y = ['4', '5'].indexOf(core_Util_Util.getOlVersion()) > -1 ? tileCoord[2] : -tileCoord[2] - 1;
                    return y.toString();
                })
                .replace('{-y}', function() {
                    var z = tileCoord[0];
                    var range = tileGrid.getFullTileRange(z);
                    external_ol_asserts_namespaceObject.assert(range, 55); // The {-y} placeholder requires a tile grid with extent
                    var y = range.getHeight() + tileCoord[2];
                    return y.toString();
                });

            //æ¯æä»£ç
            if (me.tileProxy) {
                tempUrl = me.tileProxy + encodeURIComponent(tempUrl);
            }
            return tempUrl;
        }
    }

    // TODO ç¡®è®¤è¿ä¸ªæ¹æ³æ¯å¦è¦å¼åºå»
    /**
     * @function BaiduMap.defaultTileGrid
     * @description è·åé»è®¤ç¦çæ ¼ç½ã
     * @returns {ol.tilegrid.TileGrid} è¿åç¦çæ ¼ç½å¯¹è±¡ã
     */
    static defaultTileGrid() {
        var tileGird = new (external_ol_tilegrid_TileGrid_default())({
            extent: [-33554432, -33554432, 33554432, 33554432],
            resolutions: [
                131072 * 2,
                131072,
                65536,
                32768,
                16284,
                8192,
                4096,
                2048,
                1024,
                512,
                256,
                128,
                64,
                32,
                16,
                8,
                4,
                2,
                1,
                0.5
            ],
            origin: [0, 0],
            minZoom: 3
        });
        return tileGird;
    }
}

;// CONCATENATED MODULE: external "ol.source.Image"
const external_ol_source_Image_namespaceObject = ol.source.Image;
var external_ol_source_Image_default = /*#__PURE__*/__webpack_require__.n(external_ol_source_Image_namespaceObject);
;// CONCATENATED MODULE: external "ol.Image"
const external_ol_Image_namespaceObject = ol.Image;
var external_ol_Image_default = /*#__PURE__*/__webpack_require__.n(external_ol_Image_namespaceObject);
;// CONCATENATED MODULE: external "ol.format.GeoJSON"
const external_ol_format_GeoJSON_namespaceObject = ol.format.GeoJSON;
var external_ol_format_GeoJSON_default = /*#__PURE__*/__webpack_require__.n(external_ol_format_GeoJSON_namespaceObject);
;// CONCATENATED MODULE: external "ol.extent"
const external_ol_extent_namespaceObject = ol.extent;
;// CONCATENATED MODULE: ./src/openlayers/mapping/ImageSuperMapRest.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/











/**
 * @class ImageSuperMapRest
 * @browsernamespace ol.source
 * @category iServer Map Tile
 * @classdesc SuperMap iServer Image å¾å±æºã
 * @param {Object} options - åæ°ã
 * @param {string} options.url - å°å¾æå¡å°å,ä¾å¦: http://{ip}:{port}/iserver/services/map-world/rest/maps/Worldã
 * @param {ServerType} [options.serverType=SuperMap.ServerType.ISERVER] - æå¡ç±»å ISERVER|IPORTAL|ONLINEã
 * @param {boolean} [options.redirect=false] - æ¯å¦éå®åã
 * @param {boolean} [options.transparent=true] - ç¦çæ¯å¦éæã
 * @param {boolean} [options.antialias=false] - æ¯å¦åèµ°æ ·å°å¾ã
 * @param {boolean} [options.cacheEnabled=true] - æ¯å¦ä½¿ç¨æå¡ç«¯çç¼å­ï¼true è¡¨ç¤ºä½¿ç¨æå¡ç«¯çç¼å­ã
 * @param {Object} [options.prjCoordSys] - è¯·æ±çå°å¾çåæ åèç³»ç»ãå½æ­¤åæ°è®¾ç½®çåæ ç³»ç»ä¸åäºå°å¾çåæåæ ç³»ç»æ¶ï¼ ç³»ç»ä¼è¿è¡å¨ææå½±ï¼å¹¶è¿åå¨ææå½±åçå°å¾ç¦çãä¾å¦ï¼{"epsgCode":3857}ã
 * @param {string} [options.layersID] - è·åè¿è¡åççå°å¾å¾å± IDï¼å³æå®è¿è¡å°å¾åççå¾å±ï¼å¯ä»¥æ¯ä¸´æ¶å¾å±éï¼ä¹å¯ä»¥æ¯å½åå°å¾ä¸­å¾å±çç»åã
 * @param {boolean} [options.clipRegionEnabled = false] - æ¯å¦å°å¾åªæ¾ç¤ºè¯¥åºåè¦ççé¨åãtrue è¡¨ç¤ºå°å¾åªæ¾ç¤ºè¯¥åºåè¦ççé¨åã
 * @param {ol.geom.Geometry} [options.clipRegion] - å°å¾æ¾ç¤ºè£åªçåºåãæ¯ä¸ä¸ªé¢å¯¹è±¡ï¼å½ clipRegionEnabled = true æ¶ææï¼å³å°å¾åªæ¾ç¤ºè¯¥åºåè¦ççé¨åã
 * @param {boolean} [options.overlapDisplayed=false] - å°å¾å¯¹è±¡å¨åä¸èå´åæ¶ï¼æ¯å¦éå æ¾ç¤ºãå¦æä¸º trueï¼ååä¸èå´åçå¯¹è±¡ä¼ç´æ¥åçï¼å¦æä¸º false åéè¿ overlapDisplayedOptions æ§å¶å¯¹è±¡ä¸åçæ¾ç¤ºã
 * @param {OverlapDisplayedOptions} [options.overlapDisplayedOptions] - é¿åå°å¾å¯¹è±¡åçæ¾ç¤ºçè¿æ»¤éé¡¹ï¼å½ overlapDisplayed ä¸º false æ¶ææï¼ç¨æ¥å¢å¼ºå¯¹å°å¾å¯¹è±¡åçæ¶çå¤çã
 * @param {boolean} [options.markerAngleFixed=false] - æå®ç¹ç¶ç¬¦å·çè§åº¦æ¯å¦åºå®ã
 * @param {boolean} [options.textAngleFixed=false] - ææ¬è§åº¦æ¯å¦åºå®ã
 * @param {boolean} [options.textOrientationFixed=false] - ææ¬æåæ¯å¦åºå®ã
 * @param {boolean} [options.paintBackground=false] - æ¯å¦ç»å¶å°å¾èæ¯ã
 * @param {boolean} [options.maxVisibleTextSize] - ææ¬çæå¤§å¯è§å°ºå¯¸ï¼åä½ä¸ºåç´ ã
 * @param {boolean} [options.maxVisibleVertex] - æå¤§å ä½å¯¹è±¡å¯è§èç¹æ°ã å¦æå ä½å¯¹è±¡çèç¹æ°è¶è¿æå®çä¸ªæ°ï¼åè¶è¿çé£é¨åèç¹ä¸æ¾ç¤ºã
 * @param {boolean} [options.minVisibleTextSize] - ææ¬çæå°å¯è§å°ºå¯¸ï¼åä½ä¸ºåç´ ã
 * @param {string} [options.tileversion] - åççæ¬åç§°ï¼_cache ä¸º true æ¶ææã
 * @param {string} [options.tileProxy] - ä»£çå°åã
 * @param {NDVIParameter|HillshadeParameter} [options.rasterfunction] - æ æ ¼åæåæ°ã
 * @param {string} [options.format = 'png'] - ç¦çè¡¨è¿°ç±»åï¼æ¯æ "png" ã"webp"ã"bmp" ã"jpg"ã "gif" ç­å¾çç±»åã
 * @param {Function} [options.imageLoadFunction] - å è½½å¾ççæ¹æ³ãé»è®¤ä¸ºfunction(imageTile, src) {imageTile.getImage().src = src;};
 * @param {string} [options.ratio=1.5] - 	è¯·æ±å¾çå¤§å°æ¯ä¾. 1 è¡¨ç¤ºè¯·æ±å¾çå¤§å°åå°å¾è§çªèå´ä¸è´, 2 è¡¨ç¤ºè¯·æ±å¾çå¤§å°æ¯å°å¾è§çªèå´ç2åï¼ä»¥æ­¤ç±»æ¨ã
 * @extends {ol.source.Image}
 * @usage
 */
 class ImageSuperMapRest extends (external_ol_source_Image_default()) {
  constructor(options) {
    super({
      attributions: options.attributions,
      imageSmoothing: options.imageSmoothing,
      projection: options.projection,
      resolutions: options.resolutions
    });
    if (options.url === undefined) {
      return;
    }
    this.imageLoadFunction_ =
      options.imageLoadFunction !== undefined ? options.imageLoadFunction : external_ol_source_Image_namespaceObject.defaultImageLoadFunction;
    this._image = null;
    this.renderedRevision_ = 0;
    this._crossOrigin = options.crossOrigin !== undefined ? options.crossOrigin : null;
    this._url = options.url;
    this.ratio_ = options.ratio !== undefined ? options.ratio : 1.5;

    options.attributions =
      options.attributions ||
      "Map Data <span>Â© <a href='http://support.supermap.com.cn/product/iServer.aspx' target='_blank'>SuperMap iServer</a></span> with <a href='https://iclient.supermap.io/'>Â© SuperMap iClient</a>";

    options.format = options.format ? options.format : 'png';
    this._layerUrl = Util.urlPathAppend(options.url, 'image.' + options.format);
    //ä¸ºurlæ·»å å®å¨è®¤è¯ä¿¡æ¯çæ®µ
    this._layerUrl = SecurityManager.appendCredential(this._layerUrl);

    const params = {};
    //åçæ¯å¦éæ
    const transparent = options.transparent !== undefined ? options.transparent : true;
    params['transparent'] = transparent;

    //æ¯å¦ä½¿ç¨ç¼å­åï¼é»è®¤ä¸ºtrue
    const cacheEnabled = options.cacheEnabled !== undefined ? options.cacheEnabled : true;
    params['cacheEnabled'] = cacheEnabled;

    //å¦æælayersIDï¼åæ¯å¨ä½¿ç¨ä¸é¢å¾
    if (options.layersID !== undefined) {
      params['layersID'] = options.layersID;
    }
    //æ¯å¦éå®å,é»è®¤ä¸ºfalse
    let redirect = false;
    if (options.redirect !== undefined) {
      redirect = options.redirect;
    }
    params['redirect'] = redirect;

    if (options.prjCoordSys) {
      params['prjCoordSys'] = JSON.stringify(options.prjCoordSys);
    }
    if (options.clipRegionEnabled && options.clipRegion instanceof (external_ol_geom_Geometry_default())) {
      options.clipRegion = core_Util_Util.toSuperMapGeometry(new (external_ol_format_GeoJSON_default())().writeGeometryObject(options.clipRegion));
      options.clipRegion = Util.toJSON(ServerGeometry.fromGeometry(options.clipRegion));
      params['clipRegionEnabled'] = options.clipRegionEnabled;
      params['clipRegion'] = JSON.stringify(options.clipRegion);
    }
    if (!!options.overlapDisplayed && options.overlapDisplayedOptions) {
      // options.overlapDisplayedOptions = options.overlapDisplayedOptions;
      params['overlapDisplayed'] = options.overlapDisplayed;
      params['overlapDisplayedOptions'] = options.overlapDisplayedOptions.toString();
    }
    if (cacheEnabled === true && options.tileversion) {
      params['tileversion'] = options.tileversion;
    }
    if (options.rasterfunction) {
      params['rasterfunction'] = JSON.stringify(options.rasterfunction);
    }
    //æ¯å¦åèµ°æ ·å°å¾,é»è®¤ä¸ºfalse
    if (options.antialias !== undefined) {
      params['antialias'] = options.antialias;
    }
    if (options.markerAngleFixed !== undefined) {
      params['markerAngleFixed'] = options.markerAngleFixed;
    }
    if (options.textAngleFixed !== undefined) {
      params['textAngleFixed'] = options.textAngleFixed;
    }
    if (options.textOrientationFixed !== undefined) {
      params['textOrientationFixed'] = options.textOrientationFixed;
    }
    if (options.paintBackground !== undefined) {
      params['paintBackground'] = options.paintBackground;
    }
    if (!isNaN(options.maxVisibleTextSize)) {
      params['maxVisibleTextSize'] = +options.maxVisibleTextSize;
    }
    if (!isNaN(options.minVisibleTextSize)) {
      params['maxVisibleTextSize'] = +options.minVisibleTextSize;
    }
    if (!isNaN(options.maxVisibleVertex)) {
      params['maxVisibleVertex'] = Math.round(+options.maxVisibleVertex);
    }

    this._layerUrl = Util.urlAppend(encodeURI(this._layerUrl), Util.getParameterString(params));

    //å­å¨ä¸ä¸ªcacheEnabled
    this.cacheEnabled = cacheEnabled;

    if (options.tileProxy) {
      this.tileProxy = options.tileProxy;
    }
  }
  getImageInternal(extent, resolution, pixelRatio) {
    resolution = this.findNearestResolution(resolution);
    const imageResolution = resolution / pixelRatio;
    const center = (0,external_ol_extent_namespaceObject.getCenter)(extent);
    const viewWidth = Math.ceil((0,external_ol_extent_namespaceObject.getWidth)(extent) / imageResolution);
    const viewHeight = Math.ceil((0,external_ol_extent_namespaceObject.getHeight)(extent) / imageResolution);
    const viewExtent = (0,external_ol_extent_namespaceObject.getForViewAndSize)(center, imageResolution, 0, [viewWidth, viewHeight]);
    const requestWidth = Math.ceil((this.ratio_ * (0,external_ol_extent_namespaceObject.getWidth)(extent)) / imageResolution);
    const requestHeight = Math.ceil((this.ratio_ * (0,external_ol_extent_namespaceObject.getHeight)(extent)) / imageResolution);
    const requestExtent = (0,external_ol_extent_namespaceObject.getForViewAndSize)(center, imageResolution, 0, [requestWidth, requestHeight]);
    const image = this._image;
    if (
      image &&
      this.renderedRevision_ === this.getRevision() &&
      image.getResolution() === resolution &&
      image.getPixelRatio() === pixelRatio &&
      (0,external_ol_extent_namespaceObject.containsExtent)(image.getExtent(), viewExtent)
    ) {
      return image;
    }
    const imageSize = [
      Math.round((0,external_ol_extent_namespaceObject.getWidth)(requestExtent) / imageResolution),
      Math.round((0,external_ol_extent_namespaceObject.getHeight)(requestExtent) / imageResolution)
    ];
    const imageUrl = this._getRequestUrl(requestExtent, imageSize);
    this._image = new (external_ol_Image_default())(
      requestExtent,
      resolution,
      pixelRatio,
      imageUrl,
      this._crossOrigin,
      this.imageLoadFunction_
    );
    this.renderedRevision_ = this.getRevision();
    this._image.addEventListener('change', this.handleImageChange.bind(this));
    return this._image;
  }
  _getRequestUrl(extent, imageSize) {
    const params = {
      width: imageSize[0],
      height: imageSize[1],
      viewBounds: { leftBottom: { x: extent[0], y: extent[1] }, rightTop: { x: extent[2], y: extent[3] } }
    };
    //ä¸å¯ç¨ç¼å­æ¶å¯ç¨æ¶é´æ³
    if (!this.cacheEnabled) {
      params['_t'] = new Date().getTime();
    }
    let imageUrl = Util.urlAppend(this._layerUrl, Util.getParameterString(params));
    //æ¯æä»£ç
    if (this.tileProxy) {
      imageUrl = this.tileProxy + encodeURIComponent(imageUrl);
    }
    return imageUrl;
  }
  /**
   * @function ImageSuperMapRest.optionsFromMapJSON
   * @param {string} url - å°åã
   * @param {Object} mapJSONObj - å°å¾ JSONã
   * @description è·åå°å¾ JSON ä¿¡æ¯ã
   */
  static optionsFromMapJSON(url, mapJSONObj) {
    var extent = [mapJSONObj.bounds.left, mapJSONObj.bounds.bottom, mapJSONObj.bounds.right, mapJSONObj.bounds.top];
    var resolutions = getResolutions();

    function getResolutions() {
      var level = 28;
      var dpi = 96;
      var width = extent[2] - extent[0];
      var height = extent[3] - extent[1];
      var tileSize = width >= height ? width : height;
      var maxReolution;
      if (tileSize === width) {
        maxReolution = tileSize / mapJSONObj.viewer.width;
      } else {
        maxReolution = tileSize / mapJSONObj.viewer.height;
      }
      var resolutions = [];
      var unit = Unit.METER;
      if (mapJSONObj.coordUnit === Unit.DEGREE) {
        unit = Unit.DEGREE;
      }
      if (mapJSONObj.visibleScales.length > 0) {
        for (let i = 0; i < mapJSONObj.visibleScales.length; i++) {
          resolutions.push(core_Util_Util.scaleToResolution(mapJSONObj.visibleScales[i], dpi, unit));
        }
      } else {
        for (let i = 0; i < level; i++) {
          resolutions.push(maxReolution / Math.pow(2, i));
        }
      }

      function sortNumber(a, b) {
        return b - a;
      }

      return resolutions.sort(sortNumber);
    }
    return { url,resolutions };
  }
}

;// CONCATENATED MODULE: external "ol.source.XYZ"
const external_ol_source_XYZ_namespaceObject = ol.source.XYZ;
var external_ol_source_XYZ_default = /*#__PURE__*/__webpack_require__.n(external_ol_source_XYZ_namespaceObject);
;// CONCATENATED MODULE: ./src/openlayers/mapping/SuperMapCloud.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class SuperMapCloud
 * @browsernamespace ol.source
 * @category  ThirdPartyMap
 * @classdesc è¶å¾äºå°å¾å¾å±æºã
 * @param {Object} opt_options - åæ°ã
 * @param {string} [opt_options.url='http://t2.dituhui.com/FileService/image?map={mapName}&type={type}&x={x}&y={y}&z={z}'] - æå¡å°åã
 * @param {string} [opt_options.tileProxy] - ä»£çå°åã
 * @extends {ol.source.XYZ}
 * @usage
 */
class SuperMapCloud extends (external_ol_source_XYZ_default()) {

    constructor(opt_options) {
        var options = opt_options || {};

        var attributions = options.attributions || "Map Data Â©2014 SuperMap - GS(2014)6070å·-dataÂ©Navinfo with <span>Â© <a href='https://iclient.supermap.io' target='_blank'>SuperMap iClient</a></span>"
        var mapName = options.mapName || 'quanguo';
        var mapType = options.mapType || 'web';
        var url = options.url || 'http://t2.dituhui.com/FileService/image?map={mapName}&type={type}&x={x}&y={y}&z={z}';
        url = url.replace('{mapName}', mapName).replace('{type}', mapType);

        var superOptions = {
            attributions: attributions,
            cacheSize: options.cacheSize,
            crossOrigin: options.crossOrigin,
            opaque: options.opaque === undefined ? true : options.opaque,
            maxZoom: options.maxZoom || 18,
            reprojectionErrorThreshold: options.reprojectionErrorThreshold,
            url: url,
            wrapX: options.wrapX
        };
        //éè¦ä»£çæ¶èµ°èªå®ä¹ tileLoadFunctionï¼å¦åèµ°é»è®¤çtileLoadFunction
        if (options.tileProxy) {
            superOptions.tileLoadFunction = tileLoadFunction;
        }
        super(superOptions);

        if (options.tileProxy) {
            this.tileProxy = options.tileProxy;
        }
        //éè¦ä»£çæ¶ï¼èµ°ä»¥ä¸ä»£ç 
        var me = this;
        function tileLoadFunction(imageTile, src) {
            //æ¯æä»£ç
            imageTile.getImage().src = me.tileProxy + encodeURIComponent(src);
        }
    }
}

;// CONCATENATED MODULE: external "ol.source.WMTS"
const external_ol_source_WMTS_namespaceObject = ol.source.WMTS;
var external_ol_source_WMTS_default = /*#__PURE__*/__webpack_require__.n(external_ol_source_WMTS_namespaceObject);
;// CONCATENATED MODULE: external "ol.tilegrid.WMTS"
const external_ol_tilegrid_WMTS_namespaceObject = ol.tilegrid.WMTS;
var external_ol_tilegrid_WMTS_default = /*#__PURE__*/__webpack_require__.n(external_ol_tilegrid_WMTS_namespaceObject);
;// CONCATENATED MODULE: ./src/openlayers/mapping/Tianditu.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class Tianditu
 * @browsernamespace ol.source
 * @category  ThirdPartyMap
 * @classdesc å¤©å°å¾å¾å±æºã
 * @param {Object} opt_options - åæ°ã
 * @param {string} [opt_options.url='http://t{0-7}.tianditu.gov.cn/{layer}_{proj}/wmts?'] - æå¡å°åã
 * @param {string} opt_options.key - å¤©å°å¾æå¡å¯é¥ãè¯¦è§{@link http://lbs.tianditu.gov.cn/server/MapService.html}
 * @param {string} [opt_options.layerType='vec'] - å¾å±ç±»åã(vec:ç¢éå¾å±ï¼img:å½±åå¾å±ï¼ter:å°å½¢å¾å±)
 * @param {string} [opt_options.attributions] - çææè¿°ä¿¡æ¯ã
 * @param {number} [opt_options.cacheSize = 2048] - ç¼å²å¤§å°ã
 * @param {function} [opt_options.tileLoadFunction] - åçå è½½å®æåæ§è¡å½æ°ã
 * @param {string} [opt_options.style] - å¾å±é£æ ¼ã
 * @param {string} [opt_options.format='tiles'] - æ ¼å¼ã
 * @param {boolean} [opt_options.isLabel] - æ¯å¦æ¯æ æ³¨å¾å±ã
 * @param {boolean} [opt_options.opaque=true] - æ¯å¦éæã
 * @param {string} [opt_options.tileProxy] - ä»£çå°åã
 * @extends {ol.source.WMTS}
 * @usage
 */
class Tianditu extends (external_ol_source_WMTS_default()) {
  constructor(opt_options) {
    var layerLabelMap = {
      "vec": "cva",
      "ter": "cta",
      "img": "cia"
    }
    var layerZoomMap = {
      "vec": 18,
      "ter": 14,
      "img": 18
    }
    var options = opt_options || {};
    var attributions = options.attributions || "Map Data <a href='http://www.tianditu.gov.cn' target='_blank'><img style='background-color:transparent;bottom:2px;opacity:1;' " +
      "src='http://api.tianditu.gov.cn/img/map/logo.png' width='53px' height='22px' opacity='0'></a> with " +
      "<span>Â© <a href='https://iclient.supermap.io' target='_blank'>SuperMap iClient</a></span>"
    options.layerType = options.layerType || "vec";
    options.layerType = options.isLabel ? layerLabelMap[options.layerType] : options.layerType;
    options.matrixSet = (options.projection === 'EPSG:4326' || options.projection === 'EPSG:4490') ? "c" : "w";
    if (!options.url && !options.urls) {
      options.url = "http://t{0-7}.tianditu.gov.cn/{layer}_{proj}/wmts?"
    }
    if (options.key) {
      options.url = `${options.url}tk=${options.key}`;
    }
    options.url = options.url.replace("{layer}", options.layerType).replace("{proj}", options.matrixSet);
    var tileGrid = options.tileGrid || Tianditu.getTileGrid(options.projection || 'EPSG:3857');

    var crossOrigin = options.crossOrigin !== undefined ? options.crossOrigin : 'anonymous';

    var superOptions = {
      version: options.version || '1.0.0',
      format: options.format || 'tiles',
      dimensions: options.dimensions || {},
      layer: options.layerType,
      matrixSet: options.matrixSet,
      tileGrid: tileGrid,
      style: options.style || 'default',
      attributions: attributions,
      cacheSize: options.cacheSize,
      crossOrigin: crossOrigin,
      opaque: options.opaque === undefined ? true : options.opaque,
      maxZoom: layerZoomMap[options.layerType],
      reprojectionErrorThreshold: options.reprojectionErrorThreshold,
      url: options.url,
      urls: options.urls,
      projection: options.projection || 'EPSG:3857',
      wrapX: options.wrapX
    };
    //éè¦ä»£çæ¶èµ°èªå®ä¹ tileLoadFunctionï¼å¦åèµ°é»è®¤çtileLoadFunction
    if (options.tileProxy) {
      superOptions.tileLoadFunction = tileLoadFunction;
    }
    super(superOptions);

    if (options.tileProxy) {
      this.tileProxy = options.tileProxy;
    }
    //éè¦ä»£çæ¶ï¼èµ°ä»¥ä¸ä»£ç 
    var me = this;

    function tileLoadFunction(imageTile, src) {
      //æ¯æä»£ç
      imageTile.getImage().src = me.tileProxy + encodeURIComponent(src);
    }
  }

  /**
   * @function Tianditu.getTileGrid
   * @description è·åç¦çç½æ ¼ã
   * @param {string} projection - æå½±åèå¯¹è±¡ã
   * @returns {ol.tilegrid.WMTS} è¿åç¦çç½æ ¼å¯¹è±¡
   */
  static getTileGrid(projection) {
    if (projection === "EPSG:4326" || projection === "EPSG:4490") {
      return Tianditu.default4326TileGrid();
    }
    return Tianditu.default3857TileGrid();
  }

  /**
   * @function Tianditu.default4326TileGrid
   * @description è·åé»è®¤ 4326 ç½æ ¼ç¦çã
   * @returns {ol.tilegrid.WMTS} è¿åé»è®¤ 4326 ç½æ ¼ç¦çå¯¹è±¡ã
   */
  static default4326TileGrid() {
    var tdt_WGS84_resolutions = [];
    var matrixIds = [];
    for (var i = 1; i < 19; i++) {
      tdt_WGS84_resolutions.push(0.703125 * 2 / (Math.pow(2, i)));
      matrixIds.push(i);
    }
    var tileGird = new (external_ol_tilegrid_WMTS_default())({
      extent: [-180, -90, 180, 90],
      resolutions: tdt_WGS84_resolutions,
      origin: [-180, 90],
      matrixIds: matrixIds,
      minZoom: 1
    });
    return tileGird;
  }

  /**
   * @function Tianditu.default3857TileGrid
   * @description è·åé»è®¤ 3857 ç½æ ¼ç¦çã
   * @returns {ol.tilegrid.WMTS} è¿åé»è®¤ 3857 ç½æ ¼ç¦çå¯¹è±¡ã
   */
  static default3857TileGrid() {
    var tdt_Mercator_resolutions = [];
    var matrixIds = [];
    for (var i = 1; i < 19; i++) {
      tdt_Mercator_resolutions.push(78271.5169640203125 * 2 / (Math.pow(2, i)));
      matrixIds.push(i);
    }
    var tileGird = new (external_ol_tilegrid_WMTS_default())({
      extent: [-20037508.3427892, -20037508.3427892, 20037508.3427892, 20037508.3427892],
      resolutions: tdt_Mercator_resolutions,
      matrixIds: matrixIds,
      origin: [-20037508.3427892, 20037508.3427892],
      minZoom: 1
    });
    return tileGird;
  }
}

;// CONCATENATED MODULE: external "ol.size"
const external_ol_size_namespaceObject = ol.size;
;// CONCATENATED MODULE: external "ol.tilegrid"
const external_ol_tilegrid_namespaceObject = ol.tilegrid;
;// CONCATENATED MODULE: ./src/openlayers/mapping/TileSuperMapRest.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/












/**
 * @class TileSuperMapRest
 * @browsernamespace ol.source
 * @category iServer Map Tile
 * @classdesc SuperMap iServer TileImage å¾å±æºã
 * @param {Object} options - åæ°ã
 * @param {string} options.url - æå¡å°å,ä¾å¦: http://{ip}:{port}/iserver/services/map-world/rest/maps/Worldã
 * @param {ol.tilegrid.TileGrid} [options.tileGrid] - ç¦çç½æ ¼å¯¹è±¡ãå½ä¸æå®æ¶ï¼ä¼éè¿ options.extent ææå½±èå´çæã
 * @param {boolean} [options.redirect = false] - æ¯å¦éå®åã
 * @param {boolean} [options.transparent = true] - ç¦çæ¯å¦éæã
 * @param {boolean} [options.cacheEnabled = true] - æ¯å¦ä½¿ç¨æå¡ç«¯çç¼å­ã
 * @param {Object} [options.prjCoordSys] - è¯·æ±çå°å¾çåæ åèç³»ç»ãå½æ­¤åæ°è®¾ç½®çåæ ç³»ç»ä¸åäºå°å¾çåæåæ ç³»ç»æ¶ï¼ ç³»ç»ä¼è¿è¡å¨ææå½±ï¼å¹¶è¿åå¨ææå½±åçå°å¾ç¦çãä¾å¦ï¼{"epsgCode":3857}ã
 * @param {string} [options.layersID] - è·åè¿è¡åççå°å¾å¾å± IDï¼å³æå®è¿è¡å°å¾åççå¾å±ï¼å¯ä»¥æ¯ä¸´æ¶å¾å±éï¼ä¹å¯ä»¥æ¯å½åå°å¾ä¸­å¾å±çç»åã
 * @param {boolean} [options.clipRegionEnabled = false] - æ¯å¦åªå°å¾åªæ¾ç¤ºè¯¥åºåè¦ççé¨åãtrue è¡¨ç¤ºå°å¾åªæ¾ç¤ºè¯¥åºåè¦ççé¨åã
 * @param {ol.geom.Geometry} [options.clipRegion] - å°å¾æ¾ç¤ºè£åªçåºåãæ¯ä¸ä¸ªé¢å¯¹è±¡ï¼å½ clipRegionEnabled = true æ¶ææï¼å³å°å¾åªæ¾ç¤ºè¯¥åºåè¦ççé¨åã
 * @param {boolean} [options.overlapDisplayed = false] - å°å¾å¯¹è±¡å¨åä¸èå´åæ¶ï¼æ¯å¦éå æ¾ç¤ºãå¦æä¸º trueï¼ååä¸èå´åçå¯¹è±¡ä¼ç´æ¥åçï¼å¦æä¸º false åéè¿ overlapDisplayedOptions æ§å¶å¯¹è±¡ä¸åçæ¾ç¤ºã
 * @param {OverlapDisplayedOptions} [options.overlapDisplayedOptions] - é¿åå°å¾å¯¹è±¡åçæ¾ç¤ºçè¿æ»¤éé¡¹ï¼å½ overlapDisplayed ä¸º false æ¶ææï¼ç¨æ¥å¢å¼ºå¯¹å°å¾å¯¹è±¡åçæ¶çå¤çã
 * @param {string} [options.tileversion] - åççæ¬åç§°ï¼_cache ä¸º true æ¶ææã
 * @param {string} [options.tileProxy] - æå¡ä»£çå°åã
 * @param {string} [options.format = 'png'] - ç¦çè¡¨è¿°ç±»åï¼æ¯æ "png" ã"webp"ã"bmp" ã"jpg"ã "gif" ç­å¾çç±»åã
 * @param {(NDVIParameter|HillshadeParameter)} [options.rasterfunction] - æ æ ¼åæåæ°ã
 * @extends {ol.source.TileImage}
 * @usage
 */
class TileSuperMapRest extends (external_ol_source_TileImage_default()) {
    constructor(options) {
        options = options || {};
        options.attributions =
            options.attributions ||
            "Map Data <span>Â© <a href='http://support.supermap.com.cn/product/iServer.aspx' target='_blank'>SuperMap iServer</a></span> with <span>Â© <a href='https://iclient.supermap.io' target='_blank'>SuperMap iClient</a></span>";

        options.format = options.format ? options.format : 'png';

        super({ 
            attributions: options.attributions,
            cacheSize: options.cacheSize,
            crossOrigin: options.crossOrigin,
            logo: core_Util_Util.getOlVersion() === '4' ? options.logo : null,
            opaque: options.opaque,
            projection: options.projection,
            reprojectionErrorThreshold: options.reprojectionErrorThreshold,
            state: options.state,
            tileClass: options.tileClass,
            tileGrid: options.tileGrid,
            tileLoadFunction: options.tileLoadFunction,
            tilePixelRatio: options.tilePixelRatio,
            tileUrlFunction: tileUrlFunction,
            wrapX: options.wrapX !== undefined ? options.wrapX : false,
            cacheEnabled: options.cacheEnabled,
            layersID: options.layersID
        });
        if (options.tileProxy) {
            this.tileProxy = options.tileProxy;
        }
        this.options = options;
        this._url = options.url;
        //å½ååçå¨åçéä¸­çindex
        this.tileSetsIndex = -1;
        this.tempIndex = -1;
        this.dpi = this.options.dpi || 96;
        var me = this;
        var layerUrl = Util.urlPathAppend(options.url, 'tileImage.' + options.format);

        /**
         * @function  TileSuperMapRest.prototype.getAllRequestParams
         * @description è·åå¨é¨è¯·æ±åæ°ã
         */
        function getAllRequestParams() {
            var me = this,
                params = {};

            params['redirect'] = options.redirect !== undefined ? options.redirect : false;
            //åçæ¯å¦éæ
            params['transparent'] = options.transparent !== undefined ? options.transparent : true;
            params['cacheEnabled'] = !(options.cacheEnabled === false);
            //å­å¨ä¸ä¸ªcacheEnabledåæ°
            me.cacheEnabled = params['cacheEnabled'];
            params['_cache'] = params['cacheEnabled'];

            //è®¾ç½®åçåç¹
            if (this.origin) {
                params['origin'] = JSON.stringify({
                    x: this.origin[0],
                    y: this.origin[1]
                });
            }

            if (options.prjCoordSys) {
                params['prjCoordSys'] = JSON.stringify(options.prjCoordSys);
            }

            if (options.layersID) {
                params['layersID'] = options.layersID.toString();
            }

            if (options.clipRegion instanceof (external_ol_geom_Geometry_default())) {
                options.clipRegionEnabled = true;
                options.clipRegion = core_Util_Util.toSuperMapGeometry(new (external_ol_format_GeoJSON_default())().writeGeometryObject(options.clipRegion));
                options.clipRegion = Util.toJSON(ServerGeometry.fromGeometry(options.clipRegion));
                params['clipRegionEnabled'] = options.clipRegionEnabled;
                params['clipRegion'] = JSON.stringify(options.clipRegion);
            }

            if (!options.overlapDisplayed) {
                params['overlapDisplayed'] = false;
                if (options.overlapDisplayedOptions) {
                    params['overlapDisplayedOptions'] = me.overlapDisplayedOptions.toString();
                }
            } else {
                params['overlapDisplayed'] = true;
            }

            if (params.cacheEnabled && options.tileversion) {
                params['tileversion'] = options.tileversion.toString();
            }
            if (options.rasterfunction) {
                params['rasterfunction'] = JSON.stringify(options.rasterfunction);
            }

            return params;
        }

        /**
         * @function  TileSuperMapRest.prototype.getFullRequestUrl
         * @description è·åå®æ´çè¯·æ±å°åã
         */
        function getFullRequestUrl() {
            if (this._paramsChanged) {
                this._layerUrl = createLayerUrl.call(this);
                this._paramsChanged = false;
            }
            return this._layerUrl || createLayerUrl.call(this);
        }

        /**
         * @function  TileSuperMapRest.prototype.createLayerUrl
         * @description è·åæ°å»ºå¾å±å°åã
         */
        function createLayerUrl() {
            this.requestParams = this.requestParams || getAllRequestParams.call(this);
            this._layerUrl = Util.urlAppend(layerUrl, Util.getParameterString(this.requestParams));
            //ä¸ºurlæ·»å å®å¨è®¤è¯ä¿¡æ¯çæ®µ
            this._layerUrl = SecurityManager.appendCredential(this._layerUrl);
            return this._layerUrl;
        }

        function tileUrlFunction(tileCoord, pixelRatio, projection) {
            if (!me.tileGrid) {
                if (options.extent) {
                    me.tileGrid = TileSuperMapRest.createTileGrid(options.extent);
                    if (me.resolutions) {
                        me.tileGrid.resolutions = me.resolutions;
                    }
                } else {
                    if (projection.getCode() === 'EPSG:3857') {
                        me.tileGrid = TileSuperMapRest.createTileGrid([
                            -20037508.3427892,
                            -20037508.3427892,
                            20037508.3427892,
                            20037508.3427892
                        ]);
                        me.extent = [-20037508.3427892, -20037508.3427892, 20037508.3427892, 20037508.3427892];
                    }
                    if (projection.getCode() === 'EPSG:4326') {
                        me.tileGrid = TileSuperMapRest.createTileGrid([-180, -90, 180, 90]);
                        me.extent = [-180, -90, 180, 90];
                    }
                }
            }
            me.origin = me.tileGrid.getOrigin(0);
            var z = tileCoord[0];
            var x = tileCoord[1];
            var y = ['4', '5'].indexOf(core_Util_Util.getOlVersion()) > -1 ? -tileCoord[2] - 1 : tileCoord[2];
            var resolution = me.tileGrid.getResolution(z);
            var dpi = me.dpi || 96;
            var unit = projection.getUnits() || Unit.DEGREE;
            // OGC WKT è§£æåºåä½æ¯ degree
            if (unit === 'degrees' || unit === 'degree') {
                unit = Unit.DEGREE;
            }
            //éè¿wktæ¹å¼èªå®ä¹åæ ç³»çæ¶åï¼æ¯meter
            if (unit === 'm' || unit === 'meter') {
                unit = Unit.METER;
            }
            var scale = core_Util_Util.resolutionToScale(resolution, dpi, unit);
            var tileSize = external_ol_size_namespaceObject.toSize(me.tileGrid.getTileSize(z, me.tmpSize));
            var layerUrl = getFullRequestUrl.call(me);
            var url =
                layerUrl +
                encodeURI(
                    '&x=' + x + '&y=' + y + '&width=' + tileSize[0] + '&height=' + tileSize[1] + '&scale=' + scale
                );
            //æ¯æä»£ç
            if (me.tileProxy) {
                url = me.tileProxy + encodeURIComponent(url);
            }
            if (!me.cacheEnabled) {
                url += '&_t=' + new Date().getTime();
            }
            return url;
        }
    }

    /**
     * @function  TileSuperMapRest.prototype.setTileSetsInfo
     * @description è®¾ç½®ç¦çéä¿¡æ¯ã
     * @param {Object} tileSets - ç¦çéåã
     */
    setTileSetsInfo(tileSets) {
        this.tileSets = tileSets;
        if (core_Util_Util.isArray(this.tileSets)) {
            this.tileSets = tileSets[0];
        }
        if (!this.tileSets) {
            return;
        }
        this.dispatchEvent({
            type: 'tilesetsinfoloaded',
            value: {
                tileVersions: this.tileSets.tileVersions
            }
        });
        this.changeTilesVersion();
    }

    /**
     * @function  TileSuperMapRest.prototype.lastTilesVersion
     * @description è¯·æ±ä¸ä¸ä¸ªçæ¬åçï¼å¹¶éæ°ç»å¶ã
     */
    lastTilesVersion() {
        this.tempIndex = this.tileSetsIndex - 1;
        this.changeTilesVersion();
    }

    /**
     * @function  TileSuperMapRest.prototype.nextTilesVersion
     * @description è¯·æ±ä¸ä¸ä¸ªçæ¬åçï¼å¹¶éæ°ç»å¶ã
     */
    nextTilesVersion() {
        this.tempIndex = this.tileSetsIndex + 1;
        this.changeTilesVersion();
    }

    /**
     * @function  TileSuperMapRest.prototype.changeTilesVersion
     * @description åæ¢å°æä¸çæ¬çåçï¼å¹¶éç»ãéè¿ this.tempIndex ä¿å­éè¦åæ¢ççæ¬ç´¢å¼ã
     */
    changeTilesVersion() {
        var me = this;
        //åççæ¬éä¿¡æ¯æ¯å¦å­å¨
        if (me.tileSets == null) {
            return;
        }
        if (me.tempIndex === me.tileSetsIndex || this.tempIndex < 0) {
            return;
        }
        //æ£æµindexæ¯å¦å¯ç¨
        var tileVersions = me.tileSets.tileVersions;
        if (tileVersions && me.tempIndex < tileVersions.length && me.tempIndex >= 0) {
            var name = tileVersions[me.tempIndex].name;
            var result = me.mergeTileVersionParam(name);
            if (result) {
                me.tileSetsIndex = me.tempIndex;
                me.dispatchEvent({
                    type: 'tileversionschanged',
                    value: {
                        tileVersion: tileVersions[me.tempIndex]
                    }
                });
            }
        }
    }

    /**
     * @function  TileSuperMapRest.prototype.updateCurrentTileSetsIndex
     * @description æ´æ°å½ååçéç´¢å¼ï¼ç®åä¸»è¦æä¾ç»æ§ä»¶ä½¿ç¨ã
     * @param {number} index - ç´¢å¼å·ã
     */
    updateCurrentTileSetsIndex(index) {
        this.tempIndex = index;
    }

    /**
     * @function  TileSuperMapRest.prototype.mergeTileVersionParam
     * @description æ´æ¹ URL è¯·æ±åæ°ä¸­çåççæ¬å·ï¼å¹¶éç»ã
     * @param {Object} version - çæ¬ä¿¡æ¯ã
     * @returns {boolean} æ¯å¦æåã
     */
    mergeTileVersionParam(version) {
        if (version) {
            this.requestParams['tileversion'] = version;
            this._paramsChanged = true;
            this.refresh();
            return true;
        }
        return false;
    }

    /**
     * @function  TileSuperMapRest.optionsFromMapJSON
     * @description ä» MapJSON ä¸­è·ååæ°å¯¹è±¡ã
     * @param {string} url - æå¡å°åã
     * @param {Object} mapJSONObj - å°å¾ JSON å¯¹è±¡ã
     */
    static optionsFromMapJSON(url, mapJSONObj) {
        var options = {};
        options.url = url;
        options.crossOrigin = 'anonymous';
        var extent = [mapJSONObj.bounds.left, mapJSONObj.bounds.bottom, mapJSONObj.bounds.right, mapJSONObj.bounds.top];
        const { visibleScales, bounds, dpi, coordUnit } = mapJSONObj;
        var resolutions = core_Util_Util.scalesToResolutions(visibleScales, bounds, dpi, coordUnit);
        options.tileGrid = new (external_ol_tilegrid_TileGrid_default())({
            extent: extent,
            resolutions: resolutions
        });
        return options;
    }

    /**
     * @function  TileSuperMapRest.createTileGrid
     * @description åå»ºåçç½æ ¼ã
     * @param {number} extent - é¿åº¦ã
     * @param {number} maxZoom - æå¤§çæ¾å¤§çº§å«ã
     * @param {number} minZoom - æå°çæ¾å¤§çº§å«ã
     * @param {number} tileSize - ç¦ççå°ºå¯¸ã
     * @param {number} origin - åç¹ã
     * */
    static createTileGrid(extent, maxZoom, minZoom, tileSize, origin) {
        var tilegrid = external_ol_tilegrid_namespaceObject.createXYZ({
            extent: extent,
            maxZoom: maxZoom,
            minZoom: minZoom,
            tileSize: tileSize
        });
        return new (external_ol_tilegrid_TileGrid_default())({
            extent: extent,
            minZoom: minZoom,
            origin: origin,
            resolutions: tilegrid.getResolutions(),
            tileSize: tilegrid.getTileSize()
        });
    }
}

;// CONCATENATED MODULE: ./node_modules/proj4/lib/global.js
/* harmony default export */ function global(defs) {
  defs('EPSG:4326', "+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees");
  defs('EPSG:4269', "+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees");
  defs('EPSG:3857', "+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs");

  defs.WGS84 = defs['EPSG:4326'];
  defs['EPSG:3785'] = defs['EPSG:3857']; // maintain backward compat, official code is 3857
  defs.GOOGLE = defs['EPSG:3857'];
  defs['EPSG:900913'] = defs['EPSG:3857'];
  defs['EPSG:102113'] = defs['EPSG:3857'];
}

;// CONCATENATED MODULE: ./node_modules/proj4/lib/constants/values.js
var PJD_3PARAM = 1;
var PJD_7PARAM = 2;
var PJD_GRIDSHIFT = 3;
var PJD_WGS84 = 4; // WGS84 or equivalent
var PJD_NODATUM = 5; // WGS84 or equivalent
var SRS_WGS84_SEMIMAJOR = 6378137.0;  // only used in grid shift transforms
var SRS_WGS84_SEMIMINOR = 6356752.314;  // only used in grid shift transforms
var SRS_WGS84_ESQUARED = 0.0066943799901413165; // only used in grid shift transforms
var SEC_TO_RAD = 4.84813681109535993589914102357e-6;
var HALF_PI = Math.PI/2;
// ellipoid pj_set_ell.c
var SIXTH = 0.1666666666666666667;
/* 1/6 */
var RA4 = 0.04722222222222222222;
/* 17/360 */
var RA6 = 0.02215608465608465608;
var EPSLN = 1.0e-10;
// you'd think you could use Number.EPSILON above but that makes
// Mollweide get into an infinate loop.

var D2R = 0.01745329251994329577;
var R2D = 57.29577951308232088;
var FORTPI = Math.PI/4;
var TWO_PI = Math.PI * 2;
// SPI is slightly greater than Math.PI, so values that exceed the -180..180
// degree range by a tiny amount don't get wrapped. This prevents points that
// have drifted from their original location along the 180th meridian (due to
// floating point error) from changing their sign.
var SPI = 3.14159265359;

;// CONCATENATED MODULE: ./node_modules/proj4/lib/constants/PrimeMeridian.js
var PrimeMeridian_exports = {};


PrimeMeridian_exports.greenwich = 0.0; //"0dE",
PrimeMeridian_exports.lisbon = -9.131906111111; //"9d07'54.862\"W",
PrimeMeridian_exports.paris = 2.337229166667; //"2d20'14.025\"E",
PrimeMeridian_exports.bogota = -74.080916666667; //"74d04'51.3\"W",
PrimeMeridian_exports.madrid = -3.687938888889; //"3d41'16.58\"W",
PrimeMeridian_exports.rome = 12.452333333333; //"12d27'8.4\"E",
PrimeMeridian_exports.bern = 7.439583333333; //"7d26'22.5\"E",
PrimeMeridian_exports.jakarta = 106.807719444444; //"106d48'27.79\"E",
PrimeMeridian_exports.ferro = -17.666666666667; //"17d40'W",
PrimeMeridian_exports.brussels = 4.367975; //"4d22'4.71\"E",
PrimeMeridian_exports.stockholm = 18.058277777778; //"18d3'29.8\"E",
PrimeMeridian_exports.athens = 23.7163375; //"23d42'58.815\"E",
PrimeMeridian_exports.oslo = 10.722916666667; //"10d43'22.5\"E"

;// CONCATENATED MODULE: ./node_modules/proj4/lib/constants/units.js
/* harmony default export */ const units = ({
  ft: {to_meter: 0.3048},
  'us-ft': {to_meter: 1200 / 3937}
});

;// CONCATENATED MODULE: ./node_modules/proj4/lib/match.js
var ignoredChar = /[\s_\-\/\(\)]/g;
function match(obj, key) {
  if (obj[key]) {
    return obj[key];
  }
  var keys = Object.keys(obj);
  var lkey = key.toLowerCase().replace(ignoredChar, '');
  var i = -1;
  var testkey, processedKey;
  while (++i < keys.length) {
    testkey = keys[i];
    processedKey = testkey.toLowerCase().replace(ignoredChar, '');
    if (processedKey === lkey) {
      return obj[testkey];
    }
  }
}

;// CONCATENATED MODULE: ./node_modules/proj4/lib/projString.js





/* harmony default export */ function projString(defData) {
  var self = {};
  var paramObj = defData.split('+').map(function(v) {
    return v.trim();
  }).filter(function(a) {
    return a;
  }).reduce(function(p, a) {
    var split = a.split('=');
    split.push(true);
    p[split[0].toLowerCase()] = split[1];
    return p;
  }, {});
  var paramName, paramVal, paramOutname;
  var params = {
    proj: 'projName',
    datum: 'datumCode',
    rf: function(v) {
      self.rf = parseFloat(v);
    },
    lat_0: function(v) {
      self.lat0 = v * D2R;
    },
    lat_1: function(v) {
      self.lat1 = v * D2R;
    },
    lat_2: function(v) {
      self.lat2 = v * D2R;
    },
    lat_ts: function(v) {
      self.lat_ts = v * D2R;
    },
    lon_0: function(v) {
      self.long0 = v * D2R;
    },
    lon_1: function(v) {
      self.long1 = v * D2R;
    },
    lon_2: function(v) {
      self.long2 = v * D2R;
    },
    alpha: function(v) {
      self.alpha = parseFloat(v) * D2R;
    },
    gamma: function(v) {
      self.rectified_grid_angle = parseFloat(v);
    },
    lonc: function(v) {
      self.longc = v * D2R;
    },
    x_0: function(v) {
      self.x0 = parseFloat(v);
    },
    y_0: function(v) {
      self.y0 = parseFloat(v);
    },
    k_0: function(v) {
      self.k0 = parseFloat(v);
    },
    k: function(v) {
      self.k0 = parseFloat(v);
    },
    a: function(v) {
      self.a = parseFloat(v);
    },
    b: function(v) {
      self.b = parseFloat(v);
    },
    r_a: function() {
      self.R_A = true;
    },
    zone: function(v) {
      self.zone = parseInt(v, 10);
    },
    south: function() {
      self.utmSouth = true;
    },
    towgs84: function(v) {
      self.datum_params = v.split(",").map(function(a) {
        return parseFloat(a);
      });
    },
    to_meter: function(v) {
      self.to_meter = parseFloat(v);
    },
    units: function(v) {
      self.units = v;
      var unit = match(units, v);
      if (unit) {
        self.to_meter = unit.to_meter;
      }
    },
    from_greenwich: function(v) {
      self.from_greenwich = v * D2R;
    },
    pm: function(v) {
      var pm = match(PrimeMeridian_exports, v);
      self.from_greenwich = (pm ? pm : parseFloat(v)) * D2R;
    },
    nadgrids: function(v) {
      if (v === '@null') {
        self.datumCode = 'none';
      }
      else {
        self.nadgrids = v;
      }
    },
    axis: function(v) {
      var legalAxis = "ewnsud";
      if (v.length === 3 && legalAxis.indexOf(v.substr(0, 1)) !== -1 && legalAxis.indexOf(v.substr(1, 1)) !== -1 && legalAxis.indexOf(v.substr(2, 1)) !== -1) {
        self.axis = v;
      }
    },
    approx: function() {
      self.approx = true;
    }
  };
  for (paramName in paramObj) {
    paramVal = paramObj[paramName];
    if (paramName in params) {
      paramOutname = params[paramName];
      if (typeof paramOutname === 'function') {
        paramOutname(paramVal);
      }
      else {
        self[paramOutname] = paramVal;
      }
    }
    else {
      self[paramName] = paramVal;
    }
  }
  if(typeof self.datumCode === 'string' && self.datumCode !== "WGS84"){
    self.datumCode = self.datumCode.toLowerCase();
  }
  return self;
}

;// CONCATENATED MODULE: ./node_modules/wkt-parser/parser.js
/* harmony default export */ const parser = (parseString);

var NEUTRAL = 1;
var KEYWORD = 2;
var NUMBER = 3;
var QUOTED = 4;
var AFTERQUOTE = 5;
var ENDED = -1;
var whitespace = /\s/;
var latin = /[A-Za-z]/;
var keyword = /[A-Za-z84_]/;
var endThings = /[,\]]/;
var digets = /[\d\.E\-\+]/;
// const ignoredChar = /[\s_\-\/\(\)]/g;
function Parser(text) {
  if (typeof text !== 'string') {
    throw new Error('not a string');
  }
  this.text = text.trim();
  this.level = 0;
  this.place = 0;
  this.root = null;
  this.stack = [];
  this.currentObject = null;
  this.state = NEUTRAL;
}
Parser.prototype.readCharicter = function() {
  var char = this.text[this.place++];
  if (this.state !== QUOTED) {
    while (whitespace.test(char)) {
      if (this.place >= this.text.length) {
        return;
      }
      char = this.text[this.place++];
    }
  }
  switch (this.state) {
    case NEUTRAL:
      return this.neutral(char);
    case KEYWORD:
      return this.keyword(char)
    case QUOTED:
      return this.quoted(char);
    case AFTERQUOTE:
      return this.afterquote(char);
    case NUMBER:
      return this.number(char);
    case ENDED:
      return;
  }
};
Parser.prototype.afterquote = function(char) {
  if (char === '"') {
    this.word += '"';
    this.state = QUOTED;
    return;
  }
  if (endThings.test(char)) {
    this.word = this.word.trim();
    this.afterItem(char);
    return;
  }
  throw new Error('havn\'t handled "' +char + '" in afterquote yet, index ' + this.place);
};
Parser.prototype.afterItem = function(char) {
  if (char === ',') {
    if (this.word !== null) {
      this.currentObject.push(this.word);
    }
    this.word = null;
    this.state = NEUTRAL;
    return;
  }
  if (char === ']') {
    this.level--;
    if (this.word !== null) {
      this.currentObject.push(this.word);
      this.word = null;
    }
    this.state = NEUTRAL;
    this.currentObject = this.stack.pop();
    if (!this.currentObject) {
      this.state = ENDED;
    }

    return;
  }
};
Parser.prototype.number = function(char) {
  if (digets.test(char)) {
    this.word += char;
    return;
  }
  if (endThings.test(char)) {
    this.word = parseFloat(this.word);
    this.afterItem(char);
    return;
  }
  throw new Error('havn\'t handled "' +char + '" in number yet, index ' + this.place);
};
Parser.prototype.quoted = function(char) {
  if (char === '"') {
    this.state = AFTERQUOTE;
    return;
  }
  this.word += char;
  return;
};
Parser.prototype.keyword = function(char) {
  if (keyword.test(char)) {
    this.word += char;
    return;
  }
  if (char === '[') {
    var newObjects = [];
    newObjects.push(this.word);
    this.level++;
    if (this.root === null) {
      this.root = newObjects;
    } else {
      this.currentObject.push(newObjects);
    }
    this.stack.push(this.currentObject);
    this.currentObject = newObjects;
    this.state = NEUTRAL;
    return;
  }
  if (endThings.test(char)) {
    this.afterItem(char);
    return;
  }
  throw new Error('havn\'t handled "' +char + '" in keyword yet, index ' + this.place);
};
Parser.prototype.neutral = function(char) {
  if (latin.test(char)) {
    this.word = char;
    this.state = KEYWORD;
    return;
  }
  if (char === '"') {
    this.word = '';
    this.state = QUOTED;
    return;
  }
  if (digets.test(char)) {
    this.word = char;
    this.state = NUMBER;
    return;
  }
  if (endThings.test(char)) {
    this.afterItem(char);
    return;
  }
  throw new Error('havn\'t handled "' +char + '" in neutral yet, index ' + this.place);
};
Parser.prototype.output = function() {
  while (this.place < this.text.length) {
    this.readCharicter();
  }
  if (this.state === ENDED) {
    return this.root;
  }
  throw new Error('unable to parse string "' +this.text + '". State is ' + this.state);
};

function parseString(txt) {
  var parser = new Parser(txt);
  return parser.output();
}

;// CONCATENATED MODULE: ./node_modules/wkt-parser/process.js


function mapit(obj, key, value) {
  if (Array.isArray(key)) {
    value.unshift(key);
    key = null;
  }
  var thing = key ? {} : obj;

  var out = value.reduce(function(newObj, item) {
    sExpr(item, newObj);
    return newObj
  }, thing);
  if (key) {
    obj[key] = out;
  }
}

function sExpr(v, obj) {
  if (!Array.isArray(v)) {
    obj[v] = true;
    return;
  }
  var key = v.shift();
  if (key === 'PARAMETER') {
    key = v.shift();
  }
  if (v.length === 1) {
    if (Array.isArray(v[0])) {
      obj[key] = {};
      sExpr(v[0], obj[key]);
      return;
    }
    obj[key] = v[0];
    return;
  }
  if (!v.length) {
    obj[key] = true;
    return;
  }
  if (key === 'TOWGS84') {
    obj[key] = v;
    return;
  }
  if (key === 'AXIS') {
    if (!(key in obj)) {
      obj[key] = [];
    }
    obj[key].push(v);
    return;
  }
  if (!Array.isArray(key)) {
    obj[key] = {};
  }

  var i;
  switch (key) {
    case 'UNIT':
    case 'PRIMEM':
    case 'VERT_DATUM':
      obj[key] = {
        name: v[0].toLowerCase(),
        convert: v[1]
      };
      if (v.length === 3) {
        sExpr(v[2], obj[key]);
      }
      return;
    case 'SPHEROID':
    case 'ELLIPSOID':
      obj[key] = {
        name: v[0],
        a: v[1],
        rf: v[2]
      };
      if (v.length === 4) {
        sExpr(v[3], obj[key]);
      }
      return;
    case 'PROJECTEDCRS':
    case 'PROJCRS':
    case 'GEOGCS':
    case 'GEOCCS':
    case 'PROJCS':
    case 'LOCAL_CS':
    case 'GEODCRS':
    case 'GEODETICCRS':
    case 'GEODETICDATUM':
    case 'EDATUM':
    case 'ENGINEERINGDATUM':
    case 'VERT_CS':
    case 'VERTCRS':
    case 'VERTICALCRS':
    case 'COMPD_CS':
    case 'COMPOUNDCRS':
    case 'ENGINEERINGCRS':
    case 'ENGCRS':
    case 'FITTED_CS':
    case 'LOCAL_DATUM':
    case 'DATUM':
      v[0] = ['name', v[0]];
      mapit(obj, key, v);
      return;
    default:
      i = -1;
      while (++i < v.length) {
        if (!Array.isArray(v[i])) {
          return sExpr(v, obj[key]);
        }
      }
      return mapit(obj, key, v);
  }
}

;// CONCATENATED MODULE: ./node_modules/wkt-parser/index.js
var wkt_parser_D2R = 0.01745329251994329577;





function rename(obj, params) {
  var outName = params[0];
  var inName = params[1];
  if (!(outName in obj) && (inName in obj)) {
    obj[outName] = obj[inName];
    if (params.length === 3) {
      obj[outName] = params[2](obj[outName]);
    }
  }
}

function d2r(input) {
  return input * wkt_parser_D2R;
}

function cleanWKT(wkt) {
  if (wkt.type === 'GEOGCS') {
    wkt.projName = 'longlat';
  } else if (wkt.type === 'LOCAL_CS') {
    wkt.projName = 'identity';
    wkt.local = true;
  } else {
    if (typeof wkt.PROJECTION === 'object') {
      wkt.projName = Object.keys(wkt.PROJECTION)[0];
    } else {
      wkt.projName = wkt.PROJECTION;
    }
  }
  if (wkt.AXIS) {
    var axisOrder = '';
    for (var i = 0, ii = wkt.AXIS.length; i < ii; ++i) {
      var axis = [wkt.AXIS[i][0].toLowerCase(), wkt.AXIS[i][1].toLowerCase()];
      if (axis[0].indexOf('north') !== -1 || ((axis[0] === 'y' || axis[0] === 'lat') && axis[1] === 'north')) {
        axisOrder += 'n';
      } else if (axis[0].indexOf('south') !== -1 || ((axis[0] === 'y' || axis[0] === 'lat') && axis[1] === 'south')) {
        axisOrder += 's';
      } else if (axis[0].indexOf('east') !== -1 || ((axis[0] === 'x' || axis[0] === 'lon') && axis[1] === 'east')) {
        axisOrder += 'e';
      } else if (axis[0].indexOf('west') !== -1 || ((axis[0] === 'x' || axis[0] === 'lon') && axis[1] === 'west')) {
        axisOrder += 'w';
      }
    }
    if (axisOrder.length === 2) {
      axisOrder += 'u';
    }
    if (axisOrder.length === 3) {
      wkt.axis = axisOrder;
    }
  }
  if (wkt.UNIT) {
    wkt.units = wkt.UNIT.name.toLowerCase();
    if (wkt.units === 'metre') {
      wkt.units = 'meter';
    }
    if (wkt.UNIT.convert) {
      if (wkt.type === 'GEOGCS') {
        if (wkt.DATUM && wkt.DATUM.SPHEROID) {
          wkt.to_meter = wkt.UNIT.convert*wkt.DATUM.SPHEROID.a;
        }
      } else {
        wkt.to_meter = wkt.UNIT.convert;
      }
    }
  }
  var geogcs = wkt.GEOGCS;
  if (wkt.type === 'GEOGCS') {
    geogcs = wkt;
  }
  if (geogcs) {
    //if(wkt.GEOGCS.PRIMEM&&wkt.GEOGCS.PRIMEM.convert){
    //  wkt.from_greenwich=wkt.GEOGCS.PRIMEM.convert*D2R;
    //}
    if (geogcs.DATUM) {
      wkt.datumCode = geogcs.DATUM.name.toLowerCase();
    } else {
      wkt.datumCode = geogcs.name.toLowerCase();
    }
    if (wkt.datumCode.slice(0, 2) === 'd_') {
      wkt.datumCode = wkt.datumCode.slice(2);
    }
    if (wkt.datumCode === 'new_zealand_geodetic_datum_1949' || wkt.datumCode === 'new_zealand_1949') {
      wkt.datumCode = 'nzgd49';
    }
    if (wkt.datumCode === 'wgs_1984' || wkt.datumCode === 'world_geodetic_system_1984') {
      if (wkt.PROJECTION === 'Mercator_Auxiliary_Sphere') {
        wkt.sphere = true;
      }
      wkt.datumCode = 'wgs84';
    }
    if (wkt.datumCode.slice(-6) === '_ferro') {
      wkt.datumCode = wkt.datumCode.slice(0, - 6);
    }
    if (wkt.datumCode.slice(-8) === '_jakarta') {
      wkt.datumCode = wkt.datumCode.slice(0, - 8);
    }
    if (~wkt.datumCode.indexOf('belge')) {
      wkt.datumCode = 'rnb72';
    }
    if (geogcs.DATUM && geogcs.DATUM.SPHEROID) {
      wkt.ellps = geogcs.DATUM.SPHEROID.name.replace('_19', '').replace(/[Cc]larke\_18/, 'clrk');
      if (wkt.ellps.toLowerCase().slice(0, 13) === 'international') {
        wkt.ellps = 'intl';
      }

      wkt.a = geogcs.DATUM.SPHEROID.a;
      wkt.rf = parseFloat(geogcs.DATUM.SPHEROID.rf, 10);
    }

    if (geogcs.DATUM && geogcs.DATUM.TOWGS84) {
      wkt.datum_params = geogcs.DATUM.TOWGS84;
    }
    if (~wkt.datumCode.indexOf('osgb_1936')) {
      wkt.datumCode = 'osgb36';
    }
    if (~wkt.datumCode.indexOf('osni_1952')) {
      wkt.datumCode = 'osni52';
    }
    if (~wkt.datumCode.indexOf('tm65')
      || ~wkt.datumCode.indexOf('geodetic_datum_of_1965')) {
      wkt.datumCode = 'ire65';
    }
    if (wkt.datumCode === 'ch1903+') {
      wkt.datumCode = 'ch1903';
    }
    if (~wkt.datumCode.indexOf('israel')) {
      wkt.datumCode = 'isr93';
    }
  }
  if (wkt.b && !isFinite(wkt.b)) {
    wkt.b = wkt.a;
  }

  function toMeter(input) {
    var ratio = wkt.to_meter || 1;
    return input * ratio;
  }
  var renamer = function(a) {
    return rename(wkt, a);
  };
  var list = [
    ['standard_parallel_1', 'Standard_Parallel_1'],
    ['standard_parallel_1', 'Latitude of 1st standard parallel'],
    ['standard_parallel_2', 'Standard_Parallel_2'],
    ['standard_parallel_2', 'Latitude of 2nd standard parallel'],
    ['false_easting', 'False_Easting'],
    ['false_easting', 'False easting'],
    ['false-easting', 'Easting at false origin'],
    ['false_northing', 'False_Northing'],
    ['false_northing', 'False northing'],
    ['false_northing', 'Northing at false origin'],
    ['central_meridian', 'Central_Meridian'],
    ['central_meridian', 'Longitude of natural origin'],
    ['central_meridian', 'Longitude of false origin'],
    ['latitude_of_origin', 'Latitude_Of_Origin'],
    ['latitude_of_origin', 'Central_Parallel'],
    ['latitude_of_origin', 'Latitude of natural origin'],
    ['latitude_of_origin', 'Latitude of false origin'],
    ['scale_factor', 'Scale_Factor'],
    ['k0', 'scale_factor'],
    ['latitude_of_center', 'Latitude_Of_Center'],
    ['latitude_of_center', 'Latitude_of_center'],
    ['lat0', 'latitude_of_center', d2r],
    ['longitude_of_center', 'Longitude_Of_Center'],
    ['longitude_of_center', 'Longitude_of_center'],
    ['longc', 'longitude_of_center', d2r],
    ['x0', 'false_easting', toMeter],
    ['y0', 'false_northing', toMeter],
    ['long0', 'central_meridian', d2r],
    ['lat0', 'latitude_of_origin', d2r],
    ['lat0', 'standard_parallel_1', d2r],
    ['lat1', 'standard_parallel_1', d2r],
    ['lat2', 'standard_parallel_2', d2r],
    ['azimuth', 'Azimuth'],
    ['alpha', 'azimuth', d2r],
    ['srsCode', 'name']
  ];
  list.forEach(renamer);
  if (!wkt.long0 && wkt.longc && (wkt.projName === 'Albers_Conic_Equal_Area' || wkt.projName === 'Lambert_Azimuthal_Equal_Area')) {
    wkt.long0 = wkt.longc;
  }
  if (!wkt.lat_ts && wkt.lat1 && (wkt.projName === 'Stereographic_South_Pole' || wkt.projName === 'Polar Stereographic (variant B)')) {
    wkt.lat0 = d2r(wkt.lat1 > 0 ? 90 : -90);
    wkt.lat_ts = wkt.lat1;
  }
}
/* harmony default export */ function wkt_parser(wkt) {
  var lisp = parser(wkt);
  var type = lisp.shift();
  var name = lisp.shift();
  lisp.unshift(['name', name]);
  lisp.unshift(['type', type]);
  var obj = {};
  sExpr(lisp, obj);
  cleanWKT(obj);
  return obj;
}

;// CONCATENATED MODULE: ./node_modules/proj4/lib/defs.js




function defs(name) {
  /*global console*/
  var that = this;
  if (arguments.length === 2) {
    var def = arguments[1];
    if (typeof def === 'string') {
      if (def.charAt(0) === '+') {
        defs[name] = projString(arguments[1]);
      }
      else {
        defs[name] = wkt_parser(arguments[1]);
      }
    } else {
      defs[name] = def;
    }
  }
  else if (arguments.length === 1) {
    if (Array.isArray(name)) {
      return name.map(function(v) {
        if (Array.isArray(v)) {
          defs.apply(that, v);
        }
        else {
          defs(v);
        }
      });
    }
    else if (typeof name === 'string') {
      if (name in defs) {
        return defs[name];
      }
    }
    else if ('EPSG' in name) {
      defs['EPSG:' + name.EPSG] = name;
    }
    else if ('ESRI' in name) {
      defs['ESRI:' + name.ESRI] = name;
    }
    else if ('IAU2000' in name) {
      defs['IAU2000:' + name.IAU2000] = name;
    }
    else {
      console.log(name);
    }
    return;
  }


}
global(defs);
/* harmony default export */ const lib_defs = (defs);

;// CONCATENATED MODULE: ./node_modules/proj4/lib/parseCode.js




function testObj(code){
  return typeof code === 'string';
}
function testDef(code){
  return code in lib_defs;
}
var codeWords = ['PROJECTEDCRS', 'PROJCRS', 'GEOGCS','GEOCCS','PROJCS','LOCAL_CS', 'GEODCRS', 'GEODETICCRS', 'GEODETICDATUM', 'ENGCRS', 'ENGINEERINGCRS'];
function testWKT(code){
  return codeWords.some(function (word) {
    return code.indexOf(word) > -1;
  });
}
var codes = ['3857', '900913', '3785', '102113'];
function checkMercator(item) {
  var auth = match(item, 'authority');
  if (!auth) {
    return;
  }
  var code = match(auth, 'epsg');
  return code && codes.indexOf(code) > -1;
}
function checkProjStr(item) {
  var ext = match(item, 'extension');
  if (!ext) {
    return;
  }
  return match(ext, 'proj4');
}
function testProj(code){
  return code[0] === '+';
}
function parse(code){
  if (testObj(code)) {
    //check to see if this is a WKT string
    if (testDef(code)) {
      return lib_defs[code];
    }
    if (testWKT(code)) {
      var out = wkt_parser(code);
      // test of spetial case, due to this being a very common and often malformed
      if (checkMercator(out)) {
        return lib_defs["EPSG:3857"];
      }
      var maybeProjStr = checkProjStr(out);
      if (maybeProjStr) {
        return projString(maybeProjStr);
      }
      return out;
    }
    if (testProj(code)) {
      return projString(code);
    }
  }else{
    return code;
  }
}

/* harmony default export */ const parseCode = (parse);

;// CONCATENATED MODULE: ./node_modules/proj4/lib/extend.js
/* harmony default export */ function extend(destination, source) {
  destination = destination || {};
  var value, property;
  if (!source) {
    return destination;
  }
  for (property in source) {
    value = source[property];
    if (value !== undefined) {
      destination[property] = value;
    }
  }
  return destination;
}

;// CONCATENATED MODULE: ./node_modules/proj4/lib/common/msfnz.js
/* harmony default export */ function msfnz(eccent, sinphi, cosphi) {
  var con = eccent * sinphi;
  return cosphi / (Math.sqrt(1 - con * con));
}
;// CONCATENATED MODULE: ./node_modules/proj4/lib/common/sign.js
/* harmony default export */ function sign(x) {
  return x<0 ? -1 : 1;
}
;// CONCATENATED MODULE: ./node_modules/proj4/lib/common/adjust_lon.js




/* harmony default export */ function adjust_lon(x) {
  return (Math.abs(x) <= SPI) ? x : (x - (sign(x) * TWO_PI));
}

;// CONCATENATED MODULE: ./node_modules/proj4/lib/common/tsfnz.js


/* harmony default export */ function tsfnz(eccent, phi, sinphi) {
  var con = eccent * sinphi;
  var com = 0.5 * eccent;
  con = Math.pow(((1 - con) / (1 + con)), com);
  return (Math.tan(0.5 * (HALF_PI - phi)) / con);
}

;// CONCATENATED MODULE: ./node_modules/proj4/lib/common/phi2z.js


/* harmony default export */ function phi2z(eccent, ts) {
  var eccnth = 0.5 * eccent;
  var con, dphi;
  var phi = HALF_PI - 2 * Math.atan(ts);
  for (var i = 0; i <= 15; i++) {
    con = eccent * Math.sin(phi);
    dphi = HALF_PI - 2 * Math.atan(ts * (Math.pow(((1 - con) / (1 + con)), eccnth))) - phi;
    phi += dphi;
    if (Math.abs(dphi) <= 0.0000000001) {
      return phi;
    }
  }
  //console.log("phi2z has NoConvergence");
  return -9999;
}

;// CONCATENATED MODULE: ./node_modules/proj4/lib/projections/merc.js






function init() {
  var con = this.b / this.a;
  this.es = 1 - con * con;
  if(!('x0' in this)){
    this.x0 = 0;
  }
  if(!('y0' in this)){
    this.y0 = 0;
  }
  this.e = Math.sqrt(this.es);
  if (this.lat_ts) {
    if (this.sphere) {
      this.k0 = Math.cos(this.lat_ts);
    }
    else {
      this.k0 = msfnz(this.e, Math.sin(this.lat_ts), Math.cos(this.lat_ts));
    }
  }
  else {
    if (!this.k0) {
      if (this.k) {
        this.k0 = this.k;
      }
      else {
        this.k0 = 1;
      }
    }
  }
}

/* Mercator forward equations--mapping lat,long to x,y
  --------------------------------------------------*/

function forward(p) {
  var lon = p.x;
  var lat = p.y;
  // convert to radians
  if (lat * R2D > 90 && lat * R2D < -90 && lon * R2D > 180 && lon * R2D < -180) {
    return null;
  }

  var x, y;
  if (Math.abs(Math.abs(lat) - HALF_PI) <= EPSLN) {
    return null;
  }
  else {
    if (this.sphere) {
      x = this.x0 + this.a * this.k0 * adjust_lon(lon - this.long0);
      y = this.y0 + this.a * this.k0 * Math.log(Math.tan(FORTPI + 0.5 * lat));
    }
    else {
      var sinphi = Math.sin(lat);
      var ts = tsfnz(this.e, lat, sinphi);
      x = this.x0 + this.a * this.k0 * adjust_lon(lon - this.long0);
      y = this.y0 - this.a * this.k0 * Math.log(ts);
    }
    p.x = x;
    p.y = y;
    return p;
  }
}

/* Mercator inverse equations--mapping x,y to lat/long
  --------------------------------------------------*/
function inverse(p) {

  var x = p.x - this.x0;
  var y = p.y - this.y0;
  var lon, lat;

  if (this.sphere) {
    lat = HALF_PI - 2 * Math.atan(Math.exp(-y / (this.a * this.k0)));
  }
  else {
    var ts = Math.exp(-y / (this.a * this.k0));
    lat = phi2z(this.e, ts);
    if (lat === -9999) {
      return null;
    }
  }
  lon = adjust_lon(this.long0 + x / (this.a * this.k0));

  p.x = lon;
  p.y = lat;
  return p;
}

var names = ["Mercator", "Popular Visualisation Pseudo Mercator", "Mercator_1SP", "Mercator_Auxiliary_Sphere", "merc"];
/* harmony default export */ const merc = ({
  init: init,
  forward: forward,
  inverse: inverse,
  names: names
});

;// CONCATENATED MODULE: ./node_modules/proj4/lib/projections/longlat.js
function longlat_init() {
  //no-op for longlat
}

function identity(pt) {
  return pt;
}


var longlat_names = ["longlat", "identity"];
/* harmony default export */ const longlat = ({
  init: longlat_init,
  forward: identity,
  inverse: identity,
  names: longlat_names
});

;// CONCATENATED MODULE: ./node_modules/proj4/lib/projections.js


var projs = [merc, longlat];
var projections_names = {};
var projStore = [];

function add(proj, i) {
  var len = projStore.length;
  if (!proj.names) {
    console.log(i);
    return true;
  }
  projStore[len] = proj;
  proj.names.forEach(function(n) {
    projections_names[n.toLowerCase()] = len;
  });
  return this;
}



function get(name) {
  if (!name) {
    return false;
  }
  var n = name.toLowerCase();
  if (typeof projections_names[n] !== 'undefined' && projStore[projections_names[n]]) {
    return projStore[projections_names[n]];
  }
}

function start() {
  projs.forEach(add);
}
/* harmony default export */ const projections = ({
  start: start,
  add: add,
  get: get
});

;// CONCATENATED MODULE: ./node_modules/proj4/lib/constants/Ellipsoid.js
var Ellipsoid_exports = {};

Ellipsoid_exports.MERIT = {
  a: 6378137.0,
  rf: 298.257,
  ellipseName: "MERIT 1983"
};

Ellipsoid_exports.SGS85 = {
  a: 6378136.0,
  rf: 298.257,
  ellipseName: "Soviet Geodetic System 85"
};

Ellipsoid_exports.GRS80 = {
  a: 6378137.0,
  rf: 298.257222101,
  ellipseName: "GRS 1980(IUGG, 1980)"
};

Ellipsoid_exports.IAU76 = {
  a: 6378140.0,
  rf: 298.257,
  ellipseName: "IAU 1976"
};

Ellipsoid_exports.airy = {
  a: 6377563.396,
  b: 6356256.910,
  ellipseName: "Airy 1830"
};

Ellipsoid_exports.APL4 = {
  a: 6378137,
  rf: 298.25,
  ellipseName: "Appl. Physics. 1965"
};

Ellipsoid_exports.NWL9D = {
  a: 6378145.0,
  rf: 298.25,
  ellipseName: "Naval Weapons Lab., 1965"
};

Ellipsoid_exports.mod_airy = {
  a: 6377340.189,
  b: 6356034.446,
  ellipseName: "Modified Airy"
};

Ellipsoid_exports.andrae = {
  a: 6377104.43,
  rf: 300.0,
  ellipseName: "Andrae 1876 (Den., Iclnd.)"
};

Ellipsoid_exports.aust_SA = {
  a: 6378160.0,
  rf: 298.25,
  ellipseName: "Australian Natl & S. Amer. 1969"
};

Ellipsoid_exports.GRS67 = {
  a: 6378160.0,
  rf: 298.2471674270,
  ellipseName: "GRS 67(IUGG 1967)"
};

Ellipsoid_exports.bessel = {
  a: 6377397.155,
  rf: 299.1528128,
  ellipseName: "Bessel 1841"
};

Ellipsoid_exports.bess_nam = {
  a: 6377483.865,
  rf: 299.1528128,
  ellipseName: "Bessel 1841 (Namibia)"
};

Ellipsoid_exports.clrk66 = {
  a: 6378206.4,
  b: 6356583.8,
  ellipseName: "Clarke 1866"
};

Ellipsoid_exports.clrk80 = {
  a: 6378249.145,
  rf: 293.4663,
  ellipseName: "Clarke 1880 mod."
};

Ellipsoid_exports.clrk58 = {
  a: 6378293.645208759,
  rf: 294.2606763692654,
  ellipseName: "Clarke 1858"
};

Ellipsoid_exports.CPM = {
  a: 6375738.7,
  rf: 334.29,
  ellipseName: "Comm. des Poids et Mesures 1799"
};

Ellipsoid_exports.delmbr = {
  a: 6376428.0,
  rf: 311.5,
  ellipseName: "Delambre 1810 (Belgium)"
};

Ellipsoid_exports.engelis = {
  a: 6378136.05,
  rf: 298.2566,
  ellipseName: "Engelis 1985"
};

Ellipsoid_exports.evrst30 = {
  a: 6377276.345,
  rf: 300.8017,
  ellipseName: "Everest 1830"
};

Ellipsoid_exports.evrst48 = {
  a: 6377304.063,
  rf: 300.8017,
  ellipseName: "Everest 1948"
};

Ellipsoid_exports.evrst56 = {
  a: 6377301.243,
  rf: 300.8017,
  ellipseName: "Everest 1956"
};

Ellipsoid_exports.evrst69 = {
  a: 6377295.664,
  rf: 300.8017,
  ellipseName: "Everest 1969"
};

Ellipsoid_exports.evrstSS = {
  a: 6377298.556,
  rf: 300.8017,
  ellipseName: "Everest (Sabah & Sarawak)"
};

Ellipsoid_exports.fschr60 = {
  a: 6378166.0,
  rf: 298.3,
  ellipseName: "Fischer (Mercury Datum) 1960"
};

Ellipsoid_exports.fschr60m = {
  a: 6378155.0,
  rf: 298.3,
  ellipseName: "Fischer 1960"
};

Ellipsoid_exports.fschr68 = {
  a: 6378150.0,
  rf: 298.3,
  ellipseName: "Fischer 1968"
};

Ellipsoid_exports.helmert = {
  a: 6378200.0,
  rf: 298.3,
  ellipseName: "Helmert 1906"
};

Ellipsoid_exports.hough = {
  a: 6378270.0,
  rf: 297.0,
  ellipseName: "Hough"
};

Ellipsoid_exports.intl = {
  a: 6378388.0,
  rf: 297.0,
  ellipseName: "International 1909 (Hayford)"
};

Ellipsoid_exports.kaula = {
  a: 6378163.0,
  rf: 298.24,
  ellipseName: "Kaula 1961"
};

Ellipsoid_exports.lerch = {
  a: 6378139.0,
  rf: 298.257,
  ellipseName: "Lerch 1979"
};

Ellipsoid_exports.mprts = {
  a: 6397300.0,
  rf: 191.0,
  ellipseName: "Maupertius 1738"
};

Ellipsoid_exports.new_intl = {
  a: 6378157.5,
  b: 6356772.2,
  ellipseName: "New International 1967"
};

Ellipsoid_exports.plessis = {
  a: 6376523.0,
  rf: 6355863.0,
  ellipseName: "Plessis 1817 (France)"
};

Ellipsoid_exports.krass = {
  a: 6378245.0,
  rf: 298.3,
  ellipseName: "Krassovsky, 1942"
};

Ellipsoid_exports.SEasia = {
  a: 6378155.0,
  b: 6356773.3205,
  ellipseName: "Southeast Asia"
};

Ellipsoid_exports.walbeck = {
  a: 6376896.0,
  b: 6355834.8467,
  ellipseName: "Walbeck"
};

Ellipsoid_exports.WGS60 = {
  a: 6378165.0,
  rf: 298.3,
  ellipseName: "WGS 60"
};

Ellipsoid_exports.WGS66 = {
  a: 6378145.0,
  rf: 298.25,
  ellipseName: "WGS 66"
};

Ellipsoid_exports.WGS7 = {
  a: 6378135.0,
  rf: 298.26,
  ellipseName: "WGS 72"
};

var WGS84 = Ellipsoid_exports.WGS84 = {
  a: 6378137.0,
  rf: 298.257223563,
  ellipseName: "WGS 84"
};

Ellipsoid_exports.sphere = {
  a: 6370997.0,
  b: 6370997.0,
  ellipseName: "Normal Sphere (r=6370997)"
};

;// CONCATENATED MODULE: ./node_modules/proj4/lib/deriveConstants.js




function eccentricity(a, b, rf, R_A) {
  var a2 = a * a; // used in geocentric
  var b2 = b * b; // used in geocentric
  var es = (a2 - b2) / a2; // e ^ 2
  var e = 0;
  if (R_A) {
    a *= 1 - es * (SIXTH + es * (RA4 + es * RA6));
    a2 = a * a;
    es = 0;
  } else {
    e = Math.sqrt(es); // eccentricity
  }
  var ep2 = (a2 - b2) / b2; // used in geocentric
  return {
    es: es,
    e: e,
    ep2: ep2
  };
}
function sphere(a, b, rf, ellps, sphere) {
  if (!a) { // do we have an ellipsoid?
    var ellipse = match(Ellipsoid_exports, ellps);
    if (!ellipse) {
      ellipse = WGS84;
    }
    a = ellipse.a;
    b = ellipse.b;
    rf = ellipse.rf;
  }

  if (rf && !b) {
    b = (1.0 - 1.0 / rf) * a;
  }
  if (rf === 0 || Math.abs(a - b) < EPSLN) {
    sphere = true;
    b = a;
  }
  return {
    a: a,
    b: b,
    rf: rf,
    sphere: sphere
  };
}

;// CONCATENATED MODULE: ./node_modules/proj4/lib/constants/Datum.js
var Datum_exports = {};

Datum_exports.wgs84 = {
  towgs84: "0,0,0",
  ellipse: "WGS84",
  datumName: "WGS84"
};

Datum_exports.ch1903 = {
  towgs84: "674.374,15.056,405.346",
  ellipse: "bessel",
  datumName: "swiss"
};

Datum_exports.ggrs87 = {
  towgs84: "-199.87,74.79,246.62",
  ellipse: "GRS80",
  datumName: "Greek_Geodetic_Reference_System_1987"
};

Datum_exports.nad83 = {
  towgs84: "0,0,0",
  ellipse: "GRS80",
  datumName: "North_American_Datum_1983"
};

Datum_exports.nad27 = {
  nadgrids: "@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",
  ellipse: "clrk66",
  datumName: "North_American_Datum_1927"
};

Datum_exports.potsdam = {
  towgs84: "598.1,73.7,418.2,0.202,0.045,-2.455,6.7",
  ellipse: "bessel",
  datumName: "Potsdam Rauenberg 1950 DHDN"
};

Datum_exports.carthage = {
  towgs84: "-263.0,6.0,431.0",
  ellipse: "clark80",
  datumName: "Carthage 1934 Tunisia"
};

Datum_exports.hermannskogel = {
  towgs84: "577.326,90.129,463.919,5.137,1.474,5.297,2.4232",
  ellipse: "bessel",
  datumName: "Hermannskogel"
};

Datum_exports.osni52 = {
  towgs84: "482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",
  ellipse: "airy",
  datumName: "Irish National"
};

Datum_exports.ire65 = {
  towgs84: "482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",
  ellipse: "mod_airy",
  datumName: "Ireland 1965"
};

Datum_exports.rassadiran = {
  towgs84: "-133.63,-157.5,-158.62",
  ellipse: "intl",
  datumName: "Rassadiran"
};

Datum_exports.nzgd49 = {
  towgs84: "59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",
  ellipse: "intl",
  datumName: "New Zealand Geodetic Datum 1949"
};

Datum_exports.osgb36 = {
  towgs84: "446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",
  ellipse: "airy",
  datumName: "Airy 1830"
};

Datum_exports.s_jtsk = {
  towgs84: "589,76,480",
  ellipse: 'bessel',
  datumName: 'S-JTSK (Ferro)'
};

Datum_exports.beduaram = {
  towgs84: '-106,-87,188',
  ellipse: 'clrk80',
  datumName: 'Beduaram'
};

Datum_exports.gunung_segara = {
  towgs84: '-403,684,41',
  ellipse: 'bessel',
  datumName: 'Gunung Segara Jakarta'
};

Datum_exports.rnb72 = {
  towgs84: "106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",
  ellipse: "intl",
  datumName: "Reseau National Belge 1972"
};

;// CONCATENATED MODULE: ./node_modules/proj4/lib/datum.js


function datum(datumCode, datum_params, a, b, es, ep2, nadgrids) {
  var out = {};

  if (datumCode === undefined || datumCode === 'none') {
    out.datum_type = PJD_NODATUM;
  } else {
    out.datum_type = PJD_WGS84;
  }

  if (datum_params) {
    out.datum_params = datum_params.map(parseFloat);
    if (out.datum_params[0] !== 0 || out.datum_params[1] !== 0 || out.datum_params[2] !== 0) {
      out.datum_type = PJD_3PARAM;
    }
    if (out.datum_params.length > 3) {
      if (out.datum_params[3] !== 0 || out.datum_params[4] !== 0 || out.datum_params[5] !== 0 || out.datum_params[6] !== 0) {
        out.datum_type = PJD_7PARAM;
        out.datum_params[3] *= SEC_TO_RAD;
        out.datum_params[4] *= SEC_TO_RAD;
        out.datum_params[5] *= SEC_TO_RAD;
        out.datum_params[6] = (out.datum_params[6] / 1000000.0) + 1.0;
      }
    }
  }

  if (nadgrids) {
    out.datum_type = PJD_GRIDSHIFT;
    out.grids = nadgrids;
  }
  out.a = a; //datum object also uses these values
  out.b = b;
  out.es = es;
  out.ep2 = ep2;
  return out;
}

/* harmony default export */ const lib_datum = (datum);

;// CONCATENATED MODULE: ./node_modules/proj4/lib/nadgrid.js
/**
 * Resources for details of NTv2 file formats:
 * - https://web.archive.org/web/20140127204822if_/http://www.mgs.gov.on.ca:80/stdprodconsume/groups/content/@mgs/@iandit/documents/resourcelist/stel02_047447.pdf
 * - http://mimaka.com/help/gs/html/004_NTV2%20Data%20Format.htm
 */

var loadedNadgrids = {};

/**
 * Load a binary NTv2 file (.gsb) to a key that can be used in a proj string like +nadgrids=<key>. Pass the NTv2 file
 * as an ArrayBuffer.
 */
function nadgrid(key, data) {
  var view = new DataView(data);
  var isLittleEndian = detectLittleEndian(view);
  var header = readHeader(view, isLittleEndian);
  if (header.nSubgrids > 1) {
    console.log('Only single NTv2 subgrids are currently supported, subsequent sub grids are ignored');
  }
  var subgrids = readSubgrids(view, header, isLittleEndian);
  var nadgrid = {header: header, subgrids: subgrids};
  loadedNadgrids[key] = nadgrid;
  return nadgrid;
}

/**
 * Given a proj4 value for nadgrids, return an array of loaded grids
 */
function getNadgrids(nadgrids) {
  // Format details: http://proj.maptools.org/gen_parms.html
  if (nadgrids === undefined) { return null; }
  var grids = nadgrids.split(',');
  return grids.map(parseNadgridString);
}

function parseNadgridString(value) {
  if (value.length === 0) {
    return null;
  }
  var optional = value[0] === '@';
  if (optional) {
    value = value.slice(1);
  }
  if (value === 'null') {
    return {name: 'null', mandatory: !optional, grid: null, isNull: true};
  }
  return {
    name: value,
    mandatory: !optional,
    grid: loadedNadgrids[value] || null,
    isNull: false
  };
}

function secondsToRadians(seconds) {
  return (seconds / 3600) * Math.PI / 180;
}

function detectLittleEndian(view) {
  var nFields = view.getInt32(8, false);
  if (nFields === 11) {
    return false;
  }
  nFields = view.getInt32(8, true);
  if (nFields !== 11) {
    console.warn('Failed to detect nadgrid endian-ness, defaulting to little-endian');
  }
  return true;
}

function readHeader(view, isLittleEndian) {
  return {
    nFields: view.getInt32(8, isLittleEndian),
    nSubgridFields: view.getInt32(24, isLittleEndian),
    nSubgrids: view.getInt32(40, isLittleEndian),
    shiftType: decodeString(view, 56, 56 + 8).trim(),
    fromSemiMajorAxis: view.getFloat64(120, isLittleEndian),
    fromSemiMinorAxis: view.getFloat64(136, isLittleEndian),
    toSemiMajorAxis: view.getFloat64(152, isLittleEndian),
    toSemiMinorAxis: view.getFloat64(168, isLittleEndian),
  };
}

function decodeString(view, start, end) {
  return String.fromCharCode.apply(null, new Uint8Array(view.buffer.slice(start, end)));
}

function readSubgrids(view, header, isLittleEndian) {
  var gridOffset = 176;
  var grids = [];
  for (var i = 0; i < header.nSubgrids; i++) {
    var subHeader = readGridHeader(view, gridOffset, isLittleEndian);
    var nodes = readGridNodes(view, gridOffset, subHeader, isLittleEndian);
    var lngColumnCount = Math.round(
      1 + (subHeader.upperLongitude - subHeader.lowerLongitude) / subHeader.longitudeInterval);
    var latColumnCount = Math.round(
      1 + (subHeader.upperLatitude - subHeader.lowerLatitude) / subHeader.latitudeInterval);
    // Proj4 operates on radians whereas the coordinates are in seconds in the grid
    grids.push({
      ll: [secondsToRadians(subHeader.lowerLongitude), secondsToRadians(subHeader.lowerLatitude)],
      del: [secondsToRadians(subHeader.longitudeInterval), secondsToRadians(subHeader.latitudeInterval)],
      lim: [lngColumnCount, latColumnCount],
      count: subHeader.gridNodeCount,
      cvs: mapNodes(nodes)
    });
  }
  return grids;
}

function mapNodes(nodes) {
  return nodes.map(function (r) {return [secondsToRadians(r.longitudeShift), secondsToRadians(r.latitudeShift)];});
}

function readGridHeader(view, offset, isLittleEndian) {
  return {
    name: decodeString(view, offset + 8, offset + 16).trim(),
    parent: decodeString(view, offset + 24, offset + 24 + 8).trim(),
    lowerLatitude: view.getFloat64(offset + 72, isLittleEndian),
    upperLatitude: view.getFloat64(offset + 88, isLittleEndian),
    lowerLongitude: view.getFloat64(offset + 104, isLittleEndian),
    upperLongitude: view.getFloat64(offset + 120, isLittleEndian),
    latitudeInterval: view.getFloat64(offset + 136, isLittleEndian),
    longitudeInterval: view.getFloat64(offset + 152, isLittleEndian),
    gridNodeCount: view.getInt32(offset + 168, isLittleEndian)
  };
}

function readGridNodes(view, offset, gridHeader, isLittleEndian) {
  var nodesOffset = offset + 176;
  var gridRecordLength = 16;
  var gridShiftRecords = [];
  for (var i = 0; i < gridHeader.gridNodeCount; i++) {
    var record = {
      latitudeShift: view.getFloat32(nodesOffset + i * gridRecordLength, isLittleEndian),
      longitudeShift: view.getFloat32(nodesOffset + i * gridRecordLength + 4, isLittleEndian),
      latitudeAccuracy: view.getFloat32(nodesOffset + i * gridRecordLength + 8, isLittleEndian),
      longitudeAccuracy: view.getFloat32(nodesOffset + i * gridRecordLength + 12, isLittleEndian),
    };
    gridShiftRecords.push(record);
  }
  return gridShiftRecords;
}

;// CONCATENATED MODULE: ./node_modules/proj4/lib/Proj.js









function Projection(srsCode,callback) {
  if (!(this instanceof Projection)) {
    return new Projection(srsCode);
  }
  callback = callback || function(error){
    if(error){
      throw error;
    }
  };
  var json = parseCode(srsCode);
  if(typeof json !== 'object'){
    callback(srsCode);
    return;
  }
  var ourProj = Projection.projections.get(json.projName);
  if(!ourProj){
    callback(srsCode);
    return;
  }
  if (json.datumCode && json.datumCode !== 'none') {
    var datumDef = match(Datum_exports, json.datumCode);
    if (datumDef) {
      json.datum_params = json.datum_params || (datumDef.towgs84 ? datumDef.towgs84.split(',') : null);
      json.ellps = datumDef.ellipse;
      json.datumName = datumDef.datumName ? datumDef.datumName : json.datumCode;
    }
  }
  json.k0 = json.k0 || 1.0;
  json.axis = json.axis || 'enu';
  json.ellps = json.ellps || 'wgs84';
  json.lat1 = json.lat1 || json.lat0; // Lambert_Conformal_Conic_1SP, for example, needs this

  var sphere_ = sphere(json.a, json.b, json.rf, json.ellps, json.sphere);
  var ecc = eccentricity(sphere_.a, sphere_.b, sphere_.rf, json.R_A);
  var nadgrids = getNadgrids(json.nadgrids);
  var datumObj = json.datum || lib_datum(json.datumCode, json.datum_params, sphere_.a, sphere_.b, ecc.es, ecc.ep2,
    nadgrids);

  extend(this, json); // transfer everything over from the projection because we don't know what we'll need
  extend(this, ourProj); // transfer all the methods from the projection

  // copy the 4 things over we calculated in deriveConstants.sphere
  this.a = sphere_.a;
  this.b = sphere_.b;
  this.rf = sphere_.rf;
  this.sphere = sphere_.sphere;

  // copy the 3 things we calculated in deriveConstants.eccentricity
  this.es = ecc.es;
  this.e = ecc.e;
  this.ep2 = ecc.ep2;

  // add in the datum object
  this.datum = datumObj;

  // init the projection
  this.init();

  // legecy callback from back in the day when it went to spatialreference.org
  callback(null, this);

}
Projection.projections = projections;
Projection.projections.start();
/* harmony default export */ const Proj = (Projection);

;// CONCATENATED MODULE: ./node_modules/proj4/lib/datumUtils.js


function compareDatums(source, dest) {
  if (source.datum_type !== dest.datum_type) {
    return false; // false, datums are not equal
  } else if (source.a !== dest.a || Math.abs(source.es - dest.es) > 0.000000000050) {
    // the tolerance for es is to ensure that GRS80 and WGS84
    // are considered identical
    return false;
  } else if (source.datum_type === PJD_3PARAM) {
    return (source.datum_params[0] === dest.datum_params[0] && source.datum_params[1] === dest.datum_params[1] && source.datum_params[2] === dest.datum_params[2]);
  } else if (source.datum_type === PJD_7PARAM) {
    return (source.datum_params[0] === dest.datum_params[0] && source.datum_params[1] === dest.datum_params[1] && source.datum_params[2] === dest.datum_params[2] && source.datum_params[3] === dest.datum_params[3] && source.datum_params[4] === dest.datum_params[4] && source.datum_params[5] === dest.datum_params[5] && source.datum_params[6] === dest.datum_params[6]);
  } else {
    return true; // datums are equal
  }
} // cs_compare_datums()

/*
 * The function Convert_Geodetic_To_Geocentric converts geodetic coordinates
 * (latitude, longitude, and height) to geocentric coordinates (X, Y, Z),
 * according to the current ellipsoid parameters.
 *
 *    Latitude  : Geodetic latitude in radians                     (input)
 *    Longitude : Geodetic longitude in radians                    (input)
 *    Height    : Geodetic height, in meters                       (input)
 *    X         : Calculated Geocentric X coordinate, in meters    (output)
 *    Y         : Calculated Geocentric Y coordinate, in meters    (output)
 *    Z         : Calculated Geocentric Z coordinate, in meters    (output)
 *
 */
function geodeticToGeocentric(p, es, a) {
  var Longitude = p.x;
  var Latitude = p.y;
  var Height = p.z ? p.z : 0; //Z value not always supplied

  var Rn; /*  Earth radius at location  */
  var Sin_Lat; /*  Math.sin(Latitude)  */
  var Sin2_Lat; /*  Square of Math.sin(Latitude)  */
  var Cos_Lat; /*  Math.cos(Latitude)  */

  /*
   ** Don't blow up if Latitude is just a little out of the value
   ** range as it may just be a rounding issue.  Also removed longitude
   ** test, it should be wrapped by Math.cos() and Math.sin().  NFW for PROJ.4, Sep/2001.
   */
  if (Latitude < -HALF_PI && Latitude > -1.001 * HALF_PI) {
    Latitude = -HALF_PI;
  } else if (Latitude > HALF_PI && Latitude < 1.001 * HALF_PI) {
    Latitude = HALF_PI;
  } else if (Latitude < -HALF_PI) {
    /* Latitude out of range */
    //..reportError('geocent:lat out of range:' + Latitude);
    return { x: -Infinity, y: -Infinity, z: p.z };
  } else if (Latitude > HALF_PI) {
    /* Latitude out of range */
    return { x: Infinity, y: Infinity, z: p.z };
  }

  if (Longitude > Math.PI) {
    Longitude -= (2 * Math.PI);
  }
  Sin_Lat = Math.sin(Latitude);
  Cos_Lat = Math.cos(Latitude);
  Sin2_Lat = Sin_Lat * Sin_Lat;
  Rn = a / (Math.sqrt(1.0e0 - es * Sin2_Lat));
  return {
    x: (Rn + Height) * Cos_Lat * Math.cos(Longitude),
    y: (Rn + Height) * Cos_Lat * Math.sin(Longitude),
    z: ((Rn * (1 - es)) + Height) * Sin_Lat
  };
} // cs_geodetic_to_geocentric()

function geocentricToGeodetic(p, es, a, b) {
  /* local defintions and variables */
  /* end-criterium of loop, accuracy of sin(Latitude) */
  var genau = 1e-12;
  var genau2 = (genau * genau);
  var maxiter = 30;

  var P; /* distance between semi-minor axis and location */
  var RR; /* distance between center and location */
  var CT; /* sin of geocentric latitude */
  var ST; /* cos of geocentric latitude */
  var RX;
  var RK;
  var RN; /* Earth radius at location */
  var CPHI0; /* cos of start or old geodetic latitude in iterations */
  var SPHI0; /* sin of start or old geodetic latitude in iterations */
  var CPHI; /* cos of searched geodetic latitude */
  var SPHI; /* sin of searched geodetic latitude */
  var SDPHI; /* end-criterium: addition-theorem of sin(Latitude(iter)-Latitude(iter-1)) */
  var iter; /* # of continous iteration, max. 30 is always enough (s.a.) */

  var X = p.x;
  var Y = p.y;
  var Z = p.z ? p.z : 0.0; //Z value not always supplied
  var Longitude;
  var Latitude;
  var Height;

  P = Math.sqrt(X * X + Y * Y);
  RR = Math.sqrt(X * X + Y * Y + Z * Z);

  /*      special cases for latitude and longitude */
  if (P / a < genau) {

    /*  special case, if P=0. (X=0., Y=0.) */
    Longitude = 0.0;

    /*  if (X,Y,Z)=(0.,0.,0.) then Height becomes semi-minor axis
     *  of ellipsoid (=center of mass), Latitude becomes PI/2 */
    if (RR / a < genau) {
      Latitude = HALF_PI;
      Height = -b;
      return {
        x: p.x,
        y: p.y,
        z: p.z
      };
    }
  } else {
    /*  ellipsoidal (geodetic) longitude
     *  interval: -PI < Longitude <= +PI */
    Longitude = Math.atan2(Y, X);
  }

  /* --------------------------------------------------------------
   * Following iterative algorithm was developped by
   * "Institut for Erdmessung", University of Hannover, July 1988.
   * Internet: www.ife.uni-hannover.de
   * Iterative computation of CPHI,SPHI and Height.
   * Iteration of CPHI and SPHI to 10**-12 radian resp.
   * 2*10**-7 arcsec.
   * --------------------------------------------------------------
   */
  CT = Z / RR;
  ST = P / RR;
  RX = 1.0 / Math.sqrt(1.0 - es * (2.0 - es) * ST * ST);
  CPHI0 = ST * (1.0 - es) * RX;
  SPHI0 = CT * RX;
  iter = 0;

  /* loop to find sin(Latitude) resp. Latitude
   * until |sin(Latitude(iter)-Latitude(iter-1))| < genau */
  do {
    iter++;
    RN = a / Math.sqrt(1.0 - es * SPHI0 * SPHI0);

    /*  ellipsoidal (geodetic) height */
    Height = P * CPHI0 + Z * SPHI0 - RN * (1.0 - es * SPHI0 * SPHI0);

    RK = es * RN / (RN + Height);
    RX = 1.0 / Math.sqrt(1.0 - RK * (2.0 - RK) * ST * ST);
    CPHI = ST * (1.0 - RK) * RX;
    SPHI = CT * RX;
    SDPHI = SPHI * CPHI0 - CPHI * SPHI0;
    CPHI0 = CPHI;
    SPHI0 = SPHI;
  }
  while (SDPHI * SDPHI > genau2 && iter < maxiter);

  /*      ellipsoidal (geodetic) latitude */
  Latitude = Math.atan(SPHI / Math.abs(CPHI));
  return {
    x: Longitude,
    y: Latitude,
    z: Height
  };
} // cs_geocentric_to_geodetic()

/****************************************************************/
// pj_geocentic_to_wgs84( p )
//  p = point to transform in geocentric coordinates (x,y,z)


/** point object, nothing fancy, just allows values to be
    passed back and forth by reference rather than by value.
    Other point classes may be used as long as they have
    x and y properties, which will get modified in the transform method.
*/
function geocentricToWgs84(p, datum_type, datum_params) {

  if (datum_type === PJD_3PARAM) {
    // if( x[io] === HUGE_VAL )
    //    continue;
    return {
      x: p.x + datum_params[0],
      y: p.y + datum_params[1],
      z: p.z + datum_params[2],
    };
  } else if (datum_type === PJD_7PARAM) {
    var Dx_BF = datum_params[0];
    var Dy_BF = datum_params[1];
    var Dz_BF = datum_params[2];
    var Rx_BF = datum_params[3];
    var Ry_BF = datum_params[4];
    var Rz_BF = datum_params[5];
    var M_BF = datum_params[6];
    // if( x[io] === HUGE_VAL )
    //    continue;
    return {
      x: M_BF * (p.x - Rz_BF * p.y + Ry_BF * p.z) + Dx_BF,
      y: M_BF * (Rz_BF * p.x + p.y - Rx_BF * p.z) + Dy_BF,
      z: M_BF * (-Ry_BF * p.x + Rx_BF * p.y + p.z) + Dz_BF
    };
  }
} // cs_geocentric_to_wgs84

/****************************************************************/
// pj_geocentic_from_wgs84()
//  coordinate system definition,
//  point to transform in geocentric coordinates (x,y,z)
function geocentricFromWgs84(p, datum_type, datum_params) {

  if (datum_type === PJD_3PARAM) {
    //if( x[io] === HUGE_VAL )
    //    continue;
    return {
      x: p.x - datum_params[0],
      y: p.y - datum_params[1],
      z: p.z - datum_params[2],
    };

  } else if (datum_type === PJD_7PARAM) {
    var Dx_BF = datum_params[0];
    var Dy_BF = datum_params[1];
    var Dz_BF = datum_params[2];
    var Rx_BF = datum_params[3];
    var Ry_BF = datum_params[4];
    var Rz_BF = datum_params[5];
    var M_BF = datum_params[6];
    var x_tmp = (p.x - Dx_BF) / M_BF;
    var y_tmp = (p.y - Dy_BF) / M_BF;
    var z_tmp = (p.z - Dz_BF) / M_BF;
    //if( x[io] === HUGE_VAL )
    //    continue;

    return {
      x: x_tmp + Rz_BF * y_tmp - Ry_BF * z_tmp,
      y: -Rz_BF * x_tmp + y_tmp + Rx_BF * z_tmp,
      z: Ry_BF * x_tmp - Rx_BF * y_tmp + z_tmp
    };
  } //cs_geocentric_from_wgs84()
}

;// CONCATENATED MODULE: ./node_modules/proj4/lib/datum_transform.js




function checkParams(type) {
  return (type === PJD_3PARAM || type === PJD_7PARAM);
}

/* harmony default export */ function datum_transform(source, dest, point) {
  // Short cut if the datums are identical.
  if (compareDatums(source, dest)) {
    return point; // in this case, zero is sucess,
    // whereas cs_compare_datums returns 1 to indicate TRUE
    // confusing, should fix this
  }

  // Explicitly skip datum transform by setting 'datum=none' as parameter for either source or dest
  if (source.datum_type === PJD_NODATUM || dest.datum_type === PJD_NODATUM) {
    return point;
  }

  // If this datum requires grid shifts, then apply it to geodetic coordinates.
  var source_a = source.a;
  var source_es = source.es;
  if (source.datum_type === PJD_GRIDSHIFT) {
    var gridShiftCode = applyGridShift(source, false, point);
    if (gridShiftCode !== 0) {
      return undefined;
    }
    source_a = SRS_WGS84_SEMIMAJOR;
    source_es = SRS_WGS84_ESQUARED;
  }

  var dest_a = dest.a;
  var dest_b = dest.b;
  var dest_es = dest.es;
  if (dest.datum_type === PJD_GRIDSHIFT) {
    dest_a = SRS_WGS84_SEMIMAJOR;
    dest_b = SRS_WGS84_SEMIMINOR;
    dest_es = SRS_WGS84_ESQUARED;
  }

  // Do we need to go through geocentric coordinates?
  if (source_es === dest_es && source_a === dest_a && !checkParams(source.datum_type) &&  !checkParams(dest.datum_type)) {
    return point;
  }

  // Convert to geocentric coordinates.
  point = geodeticToGeocentric(point, source_es, source_a);
  // Convert between datums
  if (checkParams(source.datum_type)) {
    point = geocentricToWgs84(point, source.datum_type, source.datum_params);
  }
  if (checkParams(dest.datum_type)) {
    point = geocentricFromWgs84(point, dest.datum_type, dest.datum_params);
  }
  point = geocentricToGeodetic(point, dest_es, dest_a, dest_b);

  if (dest.datum_type === PJD_GRIDSHIFT) {
    var destGridShiftResult = applyGridShift(dest, true, point);
    if (destGridShiftResult !== 0) {
      return undefined;
    }
  }

  return point;
}

function applyGridShift(source, inverse, point) {
  if (source.grids === null || source.grids.length === 0) {
    console.log('Grid shift grids not found');
    return -1;
  }
  var input = {x: -point.x, y: point.y};
  var output = {x: Number.NaN, y: Number.NaN};
  var onlyMandatoryGrids = false;
  var attemptedGrids = [];
  for (var i = 0; i < source.grids.length; i++) {
    var grid = source.grids[i];
    attemptedGrids.push(grid.name);
    if (grid.isNull) {
      output = input;
      break;
    }
    onlyMandatoryGrids = grid.mandatory;
    if (grid.grid === null) {
      if (grid.mandatory) {
        console.log("Unable to find mandatory grid '" + grid.name + "'");
        return -1;
      }
      continue;
    }
    var subgrid = grid.grid.subgrids[0];
    // skip tables that don't match our point at all
    var epsilon = (Math.abs(subgrid.del[1]) + Math.abs(subgrid.del[0])) / 10000.0;
    var minX = subgrid.ll[0] - epsilon;
    var minY = subgrid.ll[1] - epsilon;
    var maxX = subgrid.ll[0] + (subgrid.lim[0] - 1) * subgrid.del[0] + epsilon;
    var maxY = subgrid.ll[1] + (subgrid.lim[1] - 1) * subgrid.del[1] + epsilon;
    if (minY > input.y || minX > input.x || maxY < input.y || maxX < input.x ) {
      continue;
    }
    output = applySubgridShift(input, inverse, subgrid);
    if (!isNaN(output.x)) {
      break;
    }
  }
  if (isNaN(output.x)) {
    console.log("Failed to find a grid shift table for location '"+
      -input.x * R2D + " " + input.y * R2D + " tried: '" + attemptedGrids + "'");
    return -1;
  }
  point.x = -output.x;
  point.y = output.y;
  return 0;
}

function applySubgridShift(pin, inverse, ct) {
  var val = {x: Number.NaN, y: Number.NaN};
  if (isNaN(pin.x)) { return val; }
  var tb = {x: pin.x, y: pin.y};
  tb.x -= ct.ll[0];
  tb.y -= ct.ll[1];
  tb.x = adjust_lon(tb.x - Math.PI) + Math.PI;
  var t = nadInterpolate(tb, ct);
  if (inverse) {
    if (isNaN(t.x)) {
      return val;
    }
    t.x = tb.x - t.x;
    t.y = tb.y - t.y;
    var i = 9, tol = 1e-12;
    var dif, del;
    do {
      del = nadInterpolate(t, ct);
      if (isNaN(del.x)) {
        console.log("Inverse grid shift iteration failed, presumably at grid edge.  Using first approximation.");
        break;
      }
      dif = {x: tb.x - (del.x + t.x), y: tb.y - (del.y + t.y)};
      t.x += dif.x;
      t.y += dif.y;
    } while (i-- && Math.abs(dif.x) > tol && Math.abs(dif.y) > tol);
    if (i < 0) {
      console.log("Inverse grid shift iterator failed to converge.");
      return val;
    }
    val.x = adjust_lon(t.x + ct.ll[0]);
    val.y = t.y + ct.ll[1];
  } else {
    if (!isNaN(t.x)) {
      val.x = pin.x + t.x;
      val.y = pin.y + t.y;
    }
  }
  return val;
}

function nadInterpolate(pin, ct) {
  var t = {x: pin.x / ct.del[0], y: pin.y / ct.del[1]};
  var indx = {x: Math.floor(t.x), y: Math.floor(t.y)};
  var frct = {x: t.x - 1.0 * indx.x, y: t.y - 1.0 * indx.y};
  var val= {x: Number.NaN, y: Number.NaN};
  var inx;
  if (indx.x < 0 || indx.x >= ct.lim[0]) {
    return val;
  }
  if (indx.y < 0 || indx.y >= ct.lim[1]) {
    return val;
  }
  inx = (indx.y * ct.lim[0]) + indx.x;
  var f00 = {x: ct.cvs[inx][0], y: ct.cvs[inx][1]};
  inx++;
  var f10= {x: ct.cvs[inx][0], y: ct.cvs[inx][1]};
  inx += ct.lim[0];
  var f11 = {x: ct.cvs[inx][0], y: ct.cvs[inx][1]};
  inx--;
  var f01 = {x: ct.cvs[inx][0], y: ct.cvs[inx][1]};
  var m11 = frct.x * frct.y, m10 = frct.x * (1.0 - frct.y),
    m00 = (1.0 - frct.x) * (1.0 - frct.y), m01 = (1.0 - frct.x) * frct.y;
  val.x = (m00 * f00.x + m10 * f10.x + m01 * f01.x + m11 * f11.x);
  val.y = (m00 * f00.y + m10 * f10.y + m01 * f01.y + m11 * f11.y);
  return val;
}

;// CONCATENATED MODULE: ./node_modules/proj4/lib/adjust_axis.js
/* harmony default export */ function adjust_axis(crs, denorm, point) {
  var xin = point.x,
    yin = point.y,
    zin = point.z || 0.0;
  var v, t, i;
  var out = {};
  for (i = 0; i < 3; i++) {
    if (denorm && i === 2 && point.z === undefined) {
      continue;
    }
    if (i === 0) {
      v = xin;
      if ("ew".indexOf(crs.axis[i]) !== -1) {
        t = 'x';
      } else {
        t = 'y';
      }

    }
    else if (i === 1) {
      v = yin;
      if ("ns".indexOf(crs.axis[i]) !== -1) {
        t = 'y';
      } else {
        t = 'x';
      }
    }
    else {
      v = zin;
      t = 'z';
    }
    switch (crs.axis[i]) {
    case 'e':
      out[t] = v;
      break;
    case 'w':
      out[t] = -v;
      break;
    case 'n':
      out[t] = v;
      break;
    case 's':
      out[t] = -v;
      break;
    case 'u':
      if (point[t] !== undefined) {
        out.z = v;
      }
      break;
    case 'd':
      if (point[t] !== undefined) {
        out.z = -v;
      }
      break;
    default:
      //console.log("ERROR: unknow axis ("+crs.axis[i]+") - check definition of "+crs.projName);
      return null;
    }
  }
  return out;
}

;// CONCATENATED MODULE: ./node_modules/proj4/lib/common/toPoint.js
/* harmony default export */ function toPoint(array){
  var out = {
    x: array[0],
    y: array[1]
  };
  if (array.length>2) {
    out.z = array[2];
  }
  if (array.length>3) {
    out.m = array[3];
  }
  return out;
}
;// CONCATENATED MODULE: ./node_modules/proj4/lib/checkSanity.js
/* harmony default export */ function checkSanity(point) {
  checkCoord(point.x);
  checkCoord(point.y);
}
function checkCoord(num) {
  if (typeof Number.isFinite === 'function') {
    if (Number.isFinite(num)) {
      return;
    }
    throw new TypeError('coordinates must be finite numbers');
  }
  if (typeof num !== 'number' || num !== num || !isFinite(num)) {
    throw new TypeError('coordinates must be finite numbers');
  }
}

;// CONCATENATED MODULE: ./node_modules/proj4/lib/transform.js







function checkNotWGS(source, dest) {
  return ((source.datum.datum_type === PJD_3PARAM || source.datum.datum_type === PJD_7PARAM) && dest.datumCode !== 'WGS84') || ((dest.datum.datum_type === PJD_3PARAM || dest.datum.datum_type === PJD_7PARAM) && source.datumCode !== 'WGS84');
}

function transform(source, dest, point, enforceAxis) {
  var wgs84;
  if (Array.isArray(point)) {
    point = toPoint(point);
  }
  checkSanity(point);
  // Workaround for datum shifts towgs84, if either source or destination projection is not wgs84
  if (source.datum && dest.datum && checkNotWGS(source, dest)) {
    wgs84 = new Proj('WGS84');
    point = transform(source, wgs84, point, enforceAxis);
    source = wgs84;
  }
  // DGR, 2010/11/12
  if (enforceAxis && source.axis !== 'enu') {
    point = adjust_axis(source, false, point);
  }
  // Transform source points to long/lat, if they aren't already.
  if (source.projName === 'longlat') {
    point = {
      x: point.x * D2R,
      y: point.y * D2R,
      z: point.z || 0
    };
  } else {
    if (source.to_meter) {
      point = {
        x: point.x * source.to_meter,
        y: point.y * source.to_meter,
        z: point.z || 0
      };
    }
    point = source.inverse(point); // Convert Cartesian to longlat
    if (!point) {
      return;
    }
  }
  // Adjust for the prime meridian if necessary
  if (source.from_greenwich) {
    point.x += source.from_greenwich;
  }

  // Convert datums if needed, and if possible.
  point = datum_transform(source.datum, dest.datum, point);
  if (!point) {
    return;
  }

  // Adjust for the prime meridian if necessary
  if (dest.from_greenwich) {
    point = {
      x: point.x - dest.from_greenwich,
      y: point.y,
      z: point.z || 0
    };
  }

  if (dest.projName === 'longlat') {
    // convert radians to decimal degrees
    point = {
      x: point.x * R2D,
      y: point.y * R2D,
      z: point.z || 0
    };
  } else { // else project
    point = dest.forward(point);
    if (dest.to_meter) {
      point = {
        x: point.x / dest.to_meter,
        y: point.y / dest.to_meter,
        z: point.z || 0
      };
    }
  }

  // DGR, 2010/11/12
  if (enforceAxis && dest.axis !== 'enu') {
    return adjust_axis(dest, true, point);
  }

  return point;
}

;// CONCATENATED MODULE: ./node_modules/proj4/lib/core.js


var wgs84 = Proj('WGS84');

function transformer(from, to, coords, enforceAxis) {
  var transformedArray, out, keys;
  if (Array.isArray(coords)) {
    transformedArray = transform(from, to, coords, enforceAxis) || {x: NaN, y: NaN};
    if (coords.length > 2) {
      if ((typeof from.name !== 'undefined' && from.name === 'geocent') || (typeof to.name !== 'undefined' && to.name === 'geocent')) {
        if (typeof transformedArray.z === 'number') {
          return [transformedArray.x, transformedArray.y, transformedArray.z].concat(coords.splice(3));
        } else {
          return [transformedArray.x, transformedArray.y, coords[2]].concat(coords.splice(3));
        }
      } else {
        return [transformedArray.x, transformedArray.y].concat(coords.splice(2));
      }
    } else {
      return [transformedArray.x, transformedArray.y];
    }
  } else {
    out = transform(from, to, coords, enforceAxis);
    keys = Object.keys(coords);
    if (keys.length === 2) {
      return out;
    }
    keys.forEach(function (key) {
      if ((typeof from.name !== 'undefined' && from.name === 'geocent') || (typeof to.name !== 'undefined' && to.name === 'geocent')) {
        if (key === 'x' || key === 'y' || key === 'z') {
          return;
        }
      } else {
        if (key === 'x' || key === 'y') {
          return;
        }
      }
      out[key] = coords[key];
    });
    return out;
  }
}

function checkProj(item) {
  if (item instanceof Proj) {
    return item;
  }
  if (item.oProj) {
    return item.oProj;
  }
  return Proj(item);
}

function proj4(fromProj, toProj, coord) {
  fromProj = checkProj(fromProj);
  var single = false;
  var obj;
  if (typeof toProj === 'undefined') {
    toProj = fromProj;
    fromProj = wgs84;
    single = true;
  } else if (typeof toProj.x !== 'undefined' || Array.isArray(toProj)) {
    coord = toProj;
    toProj = fromProj;
    fromProj = wgs84;
    single = true;
  }
  toProj = checkProj(toProj);
  if (coord) {
    return transformer(fromProj, toProj, coord);
  } else {
    obj = {
      forward: function (coords, enforceAxis) {
        return transformer(fromProj, toProj, coords, enforceAxis);
      },
      inverse: function (coords, enforceAxis) {
        return transformer(toProj, fromProj, coords, enforceAxis);
      }
    };
    if (single) {
      obj.oProj = toProj;
    }
    return obj;
  }
}
/* harmony default export */ const core = (proj4);
;// CONCATENATED MODULE: ./node_modules/mgrs/mgrs.js



/**
 * UTM zones are grouped, and assigned to one of a group of 6
 * sets.
 *
 * {int} @private
 */
var NUM_100K_SETS = 6;

/**
 * The column letters (for easting) of the lower left value, per
 * set.
 *
 * {string} @private
 */
var SET_ORIGIN_COLUMN_LETTERS = 'AJSAJS';

/**
 * The row letters (for northing) of the lower left value, per
 * set.
 *
 * {string} @private
 */
var SET_ORIGIN_ROW_LETTERS = 'AFAFAF';

var A = 65; // A
var I = 73; // I
var O = 79; // O
var V = 86; // V
var Z = 90; // Z
/* harmony default export */ const mgrs = ({
  forward: mgrs_forward,
  inverse: mgrs_inverse,
  toPoint: mgrs_toPoint
});
/**
 * Conversion of lat/lon to MGRS.
 *
 * @param {object} ll Object literal with lat and lon properties on a
 *     WGS84 ellipsoid.
 * @param {int} accuracy Accuracy in digits (5 for 1 m, 4 for 10 m, 3 for
 *      100 m, 2 for 1000 m or 1 for 10000 m). Optional, default is 5.
 * @return {string} the MGRS string for the given location and accuracy.
 */
function mgrs_forward(ll, accuracy) {
  accuracy = accuracy || 5; // default accuracy 1m
  return encode(LLtoUTM({
    lat: ll[1],
    lon: ll[0]
  }), accuracy);
};

/**
 * Conversion of MGRS to lat/lon.
 *
 * @param {string} mgrs MGRS string.
 * @return {array} An array with left (longitude), bottom (latitude), right
 *     (longitude) and top (latitude) values in WGS84, representing the
 *     bounding box for the provided MGRS reference.
 */
function mgrs_inverse(mgrs) {
  var bbox = UTMtoLL(decode(mgrs.toUpperCase()));
  if (bbox.lat && bbox.lon) {
    return [bbox.lon, bbox.lat, bbox.lon, bbox.lat];
  }
  return [bbox.left, bbox.bottom, bbox.right, bbox.top];
};

function mgrs_toPoint(mgrs) {
  var bbox = UTMtoLL(decode(mgrs.toUpperCase()));
  if (bbox.lat && bbox.lon) {
    return [bbox.lon, bbox.lat];
  }
  return [(bbox.left + bbox.right) / 2, (bbox.top + bbox.bottom) / 2];
};
/**
 * Conversion from degrees to radians.
 *
 * @private
 * @param {number} deg the angle in degrees.
 * @return {number} the angle in radians.
 */
function degToRad(deg) {
  return (deg * (Math.PI / 180.0));
}

/**
 * Conversion from radians to degrees.
 *
 * @private
 * @param {number} rad the angle in radians.
 * @return {number} the angle in degrees.
 */
function radToDeg(rad) {
  return (180.0 * (rad / Math.PI));
}

/**
 * Converts a set of Longitude and Latitude co-ordinates to UTM
 * using the WGS84 ellipsoid.
 *
 * @private
 * @param {object} ll Object literal with lat and lon properties
 *     representing the WGS84 coordinate to be converted.
 * @return {object} Object literal containing the UTM value with easting,
 *     northing, zoneNumber and zoneLetter properties, and an optional
 *     accuracy property in digits. Returns null if the conversion failed.
 */
function LLtoUTM(ll) {
  var Lat = ll.lat;
  var Long = ll.lon;
  var a = 6378137.0; //ellip.radius;
  var eccSquared = 0.00669438; //ellip.eccsq;
  var k0 = 0.9996;
  var LongOrigin;
  var eccPrimeSquared;
  var N, T, C, A, M;
  var LatRad = degToRad(Lat);
  var LongRad = degToRad(Long);
  var LongOriginRad;
  var ZoneNumber;
  // (int)
  ZoneNumber = Math.floor((Long + 180) / 6) + 1;

  //Make sure the longitude 180.00 is in Zone 60
  if (Long === 180) {
    ZoneNumber = 60;
  }

  // Special zone for Norway
  if (Lat >= 56.0 && Lat < 64.0 && Long >= 3.0 && Long < 12.0) {
    ZoneNumber = 32;
  }

  // Special zones for Svalbard
  if (Lat >= 72.0 && Lat < 84.0) {
    if (Long >= 0.0 && Long < 9.0) {
      ZoneNumber = 31;
    }
    else if (Long >= 9.0 && Long < 21.0) {
      ZoneNumber = 33;
    }
    else if (Long >= 21.0 && Long < 33.0) {
      ZoneNumber = 35;
    }
    else if (Long >= 33.0 && Long < 42.0) {
      ZoneNumber = 37;
    }
  }

  LongOrigin = (ZoneNumber - 1) * 6 - 180 + 3; //+3 puts origin
  // in middle of
  // zone
  LongOriginRad = degToRad(LongOrigin);

  eccPrimeSquared = (eccSquared) / (1 - eccSquared);

  N = a / Math.sqrt(1 - eccSquared * Math.sin(LatRad) * Math.sin(LatRad));
  T = Math.tan(LatRad) * Math.tan(LatRad);
  C = eccPrimeSquared * Math.cos(LatRad) * Math.cos(LatRad);
  A = Math.cos(LatRad) * (LongRad - LongOriginRad);

  M = a * ((1 - eccSquared / 4 - 3 * eccSquared * eccSquared / 64 - 5 * eccSquared * eccSquared * eccSquared / 256) * LatRad - (3 * eccSquared / 8 + 3 * eccSquared * eccSquared / 32 + 45 * eccSquared * eccSquared * eccSquared / 1024) * Math.sin(2 * LatRad) + (15 * eccSquared * eccSquared / 256 + 45 * eccSquared * eccSquared * eccSquared / 1024) * Math.sin(4 * LatRad) - (35 * eccSquared * eccSquared * eccSquared / 3072) * Math.sin(6 * LatRad));

  var UTMEasting = (k0 * N * (A + (1 - T + C) * A * A * A / 6.0 + (5 - 18 * T + T * T + 72 * C - 58 * eccPrimeSquared) * A * A * A * A * A / 120.0) + 500000.0);

  var UTMNorthing = (k0 * (M + N * Math.tan(LatRad) * (A * A / 2 + (5 - T + 9 * C + 4 * C * C) * A * A * A * A / 24.0 + (61 - 58 * T + T * T + 600 * C - 330 * eccPrimeSquared) * A * A * A * A * A * A / 720.0)));
  if (Lat < 0.0) {
    UTMNorthing += 10000000.0; //10000000 meter offset for
    // southern hemisphere
  }

  return {
    northing: Math.round(UTMNorthing),
    easting: Math.round(UTMEasting),
    zoneNumber: ZoneNumber,
    zoneLetter: getLetterDesignator(Lat)
  };
}

/**
 * Converts UTM coords to lat/long, using the WGS84 ellipsoid. This is a convenience
 * class where the Zone can be specified as a single string eg."60N" which
 * is then broken down into the ZoneNumber and ZoneLetter.
 *
 * @private
 * @param {object} utm An object literal with northing, easting, zoneNumber
 *     and zoneLetter properties. If an optional accuracy property is
 *     provided (in meters), a bounding box will be returned instead of
 *     latitude and longitude.
 * @return {object} An object literal containing either lat and lon values
 *     (if no accuracy was provided), or top, right, bottom and left values
 *     for the bounding box calculated according to the provided accuracy.
 *     Returns null if the conversion failed.
 */
function UTMtoLL(utm) {

  var UTMNorthing = utm.northing;
  var UTMEasting = utm.easting;
  var zoneLetter = utm.zoneLetter;
  var zoneNumber = utm.zoneNumber;
  // check the ZoneNummber is valid
  if (zoneNumber < 0 || zoneNumber > 60) {
    return null;
  }

  var k0 = 0.9996;
  var a = 6378137.0; //ellip.radius;
  var eccSquared = 0.00669438; //ellip.eccsq;
  var eccPrimeSquared;
  var e1 = (1 - Math.sqrt(1 - eccSquared)) / (1 + Math.sqrt(1 - eccSquared));
  var N1, T1, C1, R1, D, M;
  var LongOrigin;
  var mu, phi1Rad;

  // remove 500,000 meter offset for longitude
  var x = UTMEasting - 500000.0;
  var y = UTMNorthing;

  // We must know somehow if we are in the Northern or Southern
  // hemisphere, this is the only time we use the letter So even
  // if the Zone letter isn't exactly correct it should indicate
  // the hemisphere correctly
  if (zoneLetter < 'N') {
    y -= 10000000.0; // remove 10,000,000 meter offset used
    // for southern hemisphere
  }

  // There are 60 zones with zone 1 being at West -180 to -174
  LongOrigin = (zoneNumber - 1) * 6 - 180 + 3; // +3 puts origin
  // in middle of
  // zone

  eccPrimeSquared = (eccSquared) / (1 - eccSquared);

  M = y / k0;
  mu = M / (a * (1 - eccSquared / 4 - 3 * eccSquared * eccSquared / 64 - 5 * eccSquared * eccSquared * eccSquared / 256));

  phi1Rad = mu + (3 * e1 / 2 - 27 * e1 * e1 * e1 / 32) * Math.sin(2 * mu) + (21 * e1 * e1 / 16 - 55 * e1 * e1 * e1 * e1 / 32) * Math.sin(4 * mu) + (151 * e1 * e1 * e1 / 96) * Math.sin(6 * mu);
  // double phi1 = ProjMath.radToDeg(phi1Rad);

  N1 = a / Math.sqrt(1 - eccSquared * Math.sin(phi1Rad) * Math.sin(phi1Rad));
  T1 = Math.tan(phi1Rad) * Math.tan(phi1Rad);
  C1 = eccPrimeSquared * Math.cos(phi1Rad) * Math.cos(phi1Rad);
  R1 = a * (1 - eccSquared) / Math.pow(1 - eccSquared * Math.sin(phi1Rad) * Math.sin(phi1Rad), 1.5);
  D = x / (N1 * k0);

  var lat = phi1Rad - (N1 * Math.tan(phi1Rad) / R1) * (D * D / 2 - (5 + 3 * T1 + 10 * C1 - 4 * C1 * C1 - 9 * eccPrimeSquared) * D * D * D * D / 24 + (61 + 90 * T1 + 298 * C1 + 45 * T1 * T1 - 252 * eccPrimeSquared - 3 * C1 * C1) * D * D * D * D * D * D / 720);
  lat = radToDeg(lat);

  var lon = (D - (1 + 2 * T1 + C1) * D * D * D / 6 + (5 - 2 * C1 + 28 * T1 - 3 * C1 * C1 + 8 * eccPrimeSquared + 24 * T1 * T1) * D * D * D * D * D / 120) / Math.cos(phi1Rad);
  lon = LongOrigin + radToDeg(lon);

  var result;
  if (utm.accuracy) {
    var topRight = UTMtoLL({
      northing: utm.northing + utm.accuracy,
      easting: utm.easting + utm.accuracy,
      zoneLetter: utm.zoneLetter,
      zoneNumber: utm.zoneNumber
    });
    result = {
      top: topRight.lat,
      right: topRight.lon,
      bottom: lat,
      left: lon
    };
  }
  else {
    result = {
      lat: lat,
      lon: lon
    };
  }
  return result;
}

/**
 * Calculates the MGRS letter designator for the given latitude.
 *
 * @private
 * @param {number} lat The latitude in WGS84 to get the letter designator
 *     for.
 * @return {char} The letter designator.
 */
function getLetterDesignator(lat) {
  //This is here as an error flag to show that the Latitude is
  //outside MGRS limits
  var LetterDesignator = 'Z';

  if ((84 >= lat) && (lat >= 72)) {
    LetterDesignator = 'X';
  }
  else if ((72 > lat) && (lat >= 64)) {
    LetterDesignator = 'W';
  }
  else if ((64 > lat) && (lat >= 56)) {
    LetterDesignator = 'V';
  }
  else if ((56 > lat) && (lat >= 48)) {
    LetterDesignator = 'U';
  }
  else if ((48 > lat) && (lat >= 40)) {
    LetterDesignator = 'T';
  }
  else if ((40 > lat) && (lat >= 32)) {
    LetterDesignator = 'S';
  }
  else if ((32 > lat) && (lat >= 24)) {
    LetterDesignator = 'R';
  }
  else if ((24 > lat) && (lat >= 16)) {
    LetterDesignator = 'Q';
  }
  else if ((16 > lat) && (lat >= 8)) {
    LetterDesignator = 'P';
  }
  else if ((8 > lat) && (lat >= 0)) {
    LetterDesignator = 'N';
  }
  else if ((0 > lat) && (lat >= -8)) {
    LetterDesignator = 'M';
  }
  else if ((-8 > lat) && (lat >= -16)) {
    LetterDesignator = 'L';
  }
  else if ((-16 > lat) && (lat >= -24)) {
    LetterDesignator = 'K';
  }
  else if ((-24 > lat) && (lat >= -32)) {
    LetterDesignator = 'J';
  }
  else if ((-32 > lat) && (lat >= -40)) {
    LetterDesignator = 'H';
  }
  else if ((-40 > lat) && (lat >= -48)) {
    LetterDesignator = 'G';
  }
  else if ((-48 > lat) && (lat >= -56)) {
    LetterDesignator = 'F';
  }
  else if ((-56 > lat) && (lat >= -64)) {
    LetterDesignator = 'E';
  }
  else if ((-64 > lat) && (lat >= -72)) {
    LetterDesignator = 'D';
  }
  else if ((-72 > lat) && (lat >= -80)) {
    LetterDesignator = 'C';
  }
  return LetterDesignator;
}

/**
 * Encodes a UTM location as MGRS string.
 *
 * @private
 * @param {object} utm An object literal with easting, northing,
 *     zoneLetter, zoneNumber
 * @param {number} accuracy Accuracy in digits (1-5).
 * @return {string} MGRS string for the given UTM location.
 */
function encode(utm, accuracy) {
  // prepend with leading zeroes
  var seasting = "00000" + utm.easting,
    snorthing = "00000" + utm.northing;

  return utm.zoneNumber + utm.zoneLetter + get100kID(utm.easting, utm.northing, utm.zoneNumber) + seasting.substr(seasting.length - 5, accuracy) + snorthing.substr(snorthing.length - 5, accuracy);
}

/**
 * Get the two letter 100k designator for a given UTM easting,
 * northing and zone number value.
 *
 * @private
 * @param {number} easting
 * @param {number} northing
 * @param {number} zoneNumber
 * @return the two letter 100k designator for the given UTM location.
 */
function get100kID(easting, northing, zoneNumber) {
  var setParm = get100kSetForZone(zoneNumber);
  var setColumn = Math.floor(easting / 100000);
  var setRow = Math.floor(northing / 100000) % 20;
  return getLetter100kID(setColumn, setRow, setParm);
}

/**
 * Given a UTM zone number, figure out the MGRS 100K set it is in.
 *
 * @private
 * @param {number} i An UTM zone number.
 * @return {number} the 100k set the UTM zone is in.
 */
function get100kSetForZone(i) {
  var setParm = i % NUM_100K_SETS;
  if (setParm === 0) {
    setParm = NUM_100K_SETS;
  }

  return setParm;
}

/**
 * Get the two-letter MGRS 100k designator given information
 * translated from the UTM northing, easting and zone number.
 *
 * @private
 * @param {number} column the column index as it relates to the MGRS
 *        100k set spreadsheet, created from the UTM easting.
 *        Values are 1-8.
 * @param {number} row the row index as it relates to the MGRS 100k set
 *        spreadsheet, created from the UTM northing value. Values
 *        are from 0-19.
 * @param {number} parm the set block, as it relates to the MGRS 100k set
 *        spreadsheet, created from the UTM zone. Values are from
 *        1-60.
 * @return two letter MGRS 100k code.
 */
function getLetter100kID(column, row, parm) {
  // colOrigin and rowOrigin are the letters at the origin of the set
  var index = parm - 1;
  var colOrigin = SET_ORIGIN_COLUMN_LETTERS.charCodeAt(index);
  var rowOrigin = SET_ORIGIN_ROW_LETTERS.charCodeAt(index);

  // colInt and rowInt are the letters to build to return
  var colInt = colOrigin + column - 1;
  var rowInt = rowOrigin + row;
  var rollover = false;

  if (colInt > Z) {
    colInt = colInt - Z + A - 1;
    rollover = true;
  }

  if (colInt === I || (colOrigin < I && colInt > I) || ((colInt > I || colOrigin < I) && rollover)) {
    colInt++;
  }

  if (colInt === O || (colOrigin < O && colInt > O) || ((colInt > O || colOrigin < O) && rollover)) {
    colInt++;

    if (colInt === I) {
      colInt++;
    }
  }

  if (colInt > Z) {
    colInt = colInt - Z + A - 1;
  }

  if (rowInt > V) {
    rowInt = rowInt - V + A - 1;
    rollover = true;
  }
  else {
    rollover = false;
  }

  if (((rowInt === I) || ((rowOrigin < I) && (rowInt > I))) || (((rowInt > I) || (rowOrigin < I)) && rollover)) {
    rowInt++;
  }

  if (((rowInt === O) || ((rowOrigin < O) && (rowInt > O))) || (((rowInt > O) || (rowOrigin < O)) && rollover)) {
    rowInt++;

    if (rowInt === I) {
      rowInt++;
    }
  }

  if (rowInt > V) {
    rowInt = rowInt - V + A - 1;
  }

  var twoLetter = String.fromCharCode(colInt) + String.fromCharCode(rowInt);
  return twoLetter;
}

/**
 * Decode the UTM parameters from a MGRS string.
 *
 * @private
 * @param {string} mgrsString an UPPERCASE coordinate string is expected.
 * @return {object} An object literal with easting, northing, zoneLetter,
 *     zoneNumber and accuracy (in meters) properties.
 */
function decode(mgrsString) {

  if (mgrsString && mgrsString.length === 0) {
    throw ("MGRSPoint coverting from nothing");
  }

  var length = mgrsString.length;

  var hunK = null;
  var sb = "";
  var testChar;
  var i = 0;

  // get Zone number
  while (!(/[A-Z]/).test(testChar = mgrsString.charAt(i))) {
    if (i >= 2) {
      throw ("MGRSPoint bad conversion from: " + mgrsString);
    }
    sb += testChar;
    i++;
  }

  var zoneNumber = parseInt(sb, 10);

  if (i === 0 || i + 3 > length) {
    // A good MGRS string has to be 4-5 digits long,
    // ##AAA/#AAA at least.
    throw ("MGRSPoint bad conversion from: " + mgrsString);
  }

  var zoneLetter = mgrsString.charAt(i++);

  // Should we check the zone letter here? Why not.
  if (zoneLetter <= 'A' || zoneLetter === 'B' || zoneLetter === 'Y' || zoneLetter >= 'Z' || zoneLetter === 'I' || zoneLetter === 'O') {
    throw ("MGRSPoint zone letter " + zoneLetter + " not handled: " + mgrsString);
  }

  hunK = mgrsString.substring(i, i += 2);

  var set = get100kSetForZone(zoneNumber);

  var east100k = getEastingFromChar(hunK.charAt(0), set);
  var north100k = getNorthingFromChar(hunK.charAt(1), set);

  // We have a bug where the northing may be 2000000 too low.
  // How
  // do we know when to roll over?

  while (north100k < getMinNorthing(zoneLetter)) {
    north100k += 2000000;
  }

  // calculate the char index for easting/northing separator
  var remainder = length - i;

  if (remainder % 2 !== 0) {
    throw ("MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters" + mgrsString);
  }

  var sep = remainder / 2;

  var sepEasting = 0.0;
  var sepNorthing = 0.0;
  var accuracyBonus, sepEastingString, sepNorthingString, easting, northing;
  if (sep > 0) {
    accuracyBonus = 100000.0 / Math.pow(10, sep);
    sepEastingString = mgrsString.substring(i, i + sep);
    sepEasting = parseFloat(sepEastingString) * accuracyBonus;
    sepNorthingString = mgrsString.substring(i + sep);
    sepNorthing = parseFloat(sepNorthingString) * accuracyBonus;
  }

  easting = sepEasting + east100k;
  northing = sepNorthing + north100k;

  return {
    easting: easting,
    northing: northing,
    zoneLetter: zoneLetter,
    zoneNumber: zoneNumber,
    accuracy: accuracyBonus
  };
}

/**
 * Given the first letter from a two-letter MGRS 100k zone, and given the
 * MGRS table set for the zone number, figure out the easting value that
 * should be added to the other, secondary easting value.
 *
 * @private
 * @param {char} e The first letter from a two-letter MGRS 100Â´k zone.
 * @param {number} set The MGRS table set for the zone number.
 * @return {number} The easting value for the given letter and set.
 */
function getEastingFromChar(e, set) {
  // colOrigin is the letter at the origin of the set for the
  // column
  var curCol = SET_ORIGIN_COLUMN_LETTERS.charCodeAt(set - 1);
  var eastingValue = 100000.0;
  var rewindMarker = false;

  while (curCol !== e.charCodeAt(0)) {
    curCol++;
    if (curCol === I) {
      curCol++;
    }
    if (curCol === O) {
      curCol++;
    }
    if (curCol > Z) {
      if (rewindMarker) {
        throw ("Bad character: " + e);
      }
      curCol = A;
      rewindMarker = true;
    }
    eastingValue += 100000.0;
  }

  return eastingValue;
}

/**
 * Given the second letter from a two-letter MGRS 100k zone, and given the
 * MGRS table set for the zone number, figure out the northing value that
 * should be added to the other, secondary northing value. You have to
 * remember that Northings are determined from the equator, and the vertical
 * cycle of letters mean a 2000000 additional northing meters. This happens
 * approx. every 18 degrees of latitude. This method does *NOT* count any
 * additional northings. You have to figure out how many 2000000 meters need
 * to be added for the zone letter of the MGRS coordinate.
 *
 * @private
 * @param {char} n Second letter of the MGRS 100k zone
 * @param {number} set The MGRS table set number, which is dependent on the
 *     UTM zone number.
 * @return {number} The northing value for the given letter and set.
 */
function getNorthingFromChar(n, set) {

  if (n > 'V') {
    throw ("MGRSPoint given invalid Northing " + n);
  }

  // rowOrigin is the letter at the origin of the set for the
  // column
  var curRow = SET_ORIGIN_ROW_LETTERS.charCodeAt(set - 1);
  var northingValue = 0.0;
  var rewindMarker = false;

  while (curRow !== n.charCodeAt(0)) {
    curRow++;
    if (curRow === I) {
      curRow++;
    }
    if (curRow === O) {
      curRow++;
    }
    // fixing a bug making whole application hang in this loop
    // when 'n' is a wrong character
    if (curRow > V) {
      if (rewindMarker) { // making sure that this loop ends
        throw ("Bad character: " + n);
      }
      curRow = A;
      rewindMarker = true;
    }
    northingValue += 100000.0;
  }

  return northingValue;
}

/**
 * The function getMinNorthing returns the minimum northing value of a MGRS
 * zone.
 *
 * Ported from Geotrans' c Lattitude_Band_Value structure table.
 *
 * @private
 * @param {char} zoneLetter The MGRS zone to get the min northing for.
 * @return {number}
 */
function getMinNorthing(zoneLetter) {
  var northing;
  switch (zoneLetter) {
  case 'C':
    northing = 1100000.0;
    break;
  case 'D':
    northing = 2000000.0;
    break;
  case 'E':
    northing = 2800000.0;
    break;
  case 'F':
    northing = 3700000.0;
    break;
  case 'G':
    northing = 4600000.0;
    break;
  case 'H':
    northing = 5500000.0;
    break;
  case 'J':
    northing = 6400000.0;
    break;
  case 'K':
    northing = 7300000.0;
    break;
  case 'L':
    northing = 8200000.0;
    break;
  case 'M':
    northing = 9100000.0;
    break;
  case 'N':
    northing = 0.0;
    break;
  case 'P':
    northing = 800000.0;
    break;
  case 'Q':
    northing = 1700000.0;
    break;
  case 'R':
    northing = 2600000.0;
    break;
  case 'S':
    northing = 3500000.0;
    break;
  case 'T':
    northing = 4400000.0;
    break;
  case 'U':
    northing = 5300000.0;
    break;
  case 'V':
    northing = 6200000.0;
    break;
  case 'W':
    northing = 7000000.0;
    break;
  case 'X':
    northing = 7900000.0;
    break;
  default:
    northing = -1.0;
  }
  if (northing >= 0.0) {
    return northing;
  }
  else {
    throw ("Invalid zone letter: " + zoneLetter);
  }

}

;// CONCATENATED MODULE: ./node_modules/proj4/lib/Point.js


function lib_Point_Point(x, y, z) {
  if (!(this instanceof lib_Point_Point)) {
    return new lib_Point_Point(x, y, z);
  }
  if (Array.isArray(x)) {
    this.x = x[0];
    this.y = x[1];
    this.z = x[2] || 0.0;
  } else if(typeof x === 'object') {
    this.x = x.x;
    this.y = x.y;
    this.z = x.z || 0.0;
  } else if (typeof x === 'string' && typeof y === 'undefined') {
    var coords = x.split(',');
    this.x = parseFloat(coords[0], 10);
    this.y = parseFloat(coords[1], 10);
    this.z = parseFloat(coords[2], 10) || 0.0;
  } else {
    this.x = x;
    this.y = y;
    this.z = z || 0.0;
  }
  console.warn('proj4.Point will be removed in version 3, use proj4.toPoint');
}

lib_Point_Point.fromMGRS = function(mgrsStr) {
  return new lib_Point_Point(mgrs_toPoint(mgrsStr));
};
lib_Point_Point.prototype.toMGRS = function(accuracy) {
  return mgrs_forward([this.x, this.y], accuracy);
};
/* harmony default export */ const lib_Point = (lib_Point_Point);

;// CONCATENATED MODULE: ./node_modules/proj4/lib/common/pj_enfn.js
var C00 = 1;
var C02 = 0.25;
var C04 = 0.046875;
var C06 = 0.01953125;
var C08 = 0.01068115234375;
var C22 = 0.75;
var C44 = 0.46875;
var C46 = 0.01302083333333333333;
var C48 = 0.00712076822916666666;
var C66 = 0.36458333333333333333;
var C68 = 0.00569661458333333333;
var C88 = 0.3076171875;

/* harmony default export */ function pj_enfn(es) {
  var en = [];
  en[0] = C00 - es * (C02 + es * (C04 + es * (C06 + es * C08)));
  en[1] = es * (C22 - es * (C04 + es * (C06 + es * C08)));
  var t = es * es;
  en[2] = t * (C44 - es * (C46 + es * C48));
  t *= es;
  en[3] = t * (C66 - es * C68);
  en[4] = t * es * C88;
  return en;
}
;// CONCATENATED MODULE: ./node_modules/proj4/lib/common/pj_mlfn.js
/* harmony default export */ function pj_mlfn(phi, sphi, cphi, en) {
  cphi *= sphi;
  sphi *= sphi;
  return (en[0] * phi - cphi * (en[1] + sphi * (en[2] + sphi * (en[3] + sphi * en[4]))));
}
;// CONCATENATED MODULE: ./node_modules/proj4/lib/common/pj_inv_mlfn.js



var MAX_ITER = 20;

/* harmony default export */ function pj_inv_mlfn(arg, es, en) {
  var k = 1 / (1 - es);
  var phi = arg;
  for (var i = MAX_ITER; i; --i) { /* rarely goes over 2 iterations */
    var s = Math.sin(phi);
    var t = 1 - es * s * s;
    //t = this.pj_mlfn(phi, s, Math.cos(phi), en) - arg;
    //phi -= t * (t * Math.sqrt(t)) * k;
    t = (pj_mlfn(phi, s, Math.cos(phi), en) - arg) * (t * Math.sqrt(t)) * k;
    phi -= t;
    if (Math.abs(t) < EPSLN) {
      return phi;
    }
  }
  //..reportError("cass:pj_inv_mlfn: Convergence error");
  return phi;
}

;// CONCATENATED MODULE: ./node_modules/proj4/lib/projections/tmerc.js
// Heavily based on this tmerc projection implementation
// https://github.com/mbloch/mapshaper-proj/blob/master/src/projections/tmerc.js









function tmerc_init() {
  this.x0 = this.x0 !== undefined ? this.x0 : 0;
  this.y0 = this.y0 !== undefined ? this.y0 : 0;
  this.long0 = this.long0 !== undefined ? this.long0 : 0;
  this.lat0 = this.lat0 !== undefined ? this.lat0 : 0;

  if (this.es) {
    this.en = pj_enfn(this.es);
    this.ml0 = pj_mlfn(this.lat0, Math.sin(this.lat0), Math.cos(this.lat0), this.en);
  }
}

/**
    Transverse Mercator Forward  - long/lat to x/y
    long/lat in radians
  */
function tmerc_forward(p) {
  var lon = p.x;
  var lat = p.y;

  var delta_lon = adjust_lon(lon - this.long0);
  var con;
  var x, y;
  var sin_phi = Math.sin(lat);
  var cos_phi = Math.cos(lat);

  if (!this.es) {
    var b = cos_phi * Math.sin(delta_lon);

    if ((Math.abs(Math.abs(b) - 1)) < EPSLN) {
      return (93);
    }
    else {
      x = 0.5 * this.a * this.k0 * Math.log((1 + b) / (1 - b)) + this.x0;
      y = cos_phi * Math.cos(delta_lon) / Math.sqrt(1 - Math.pow(b, 2));
      b = Math.abs(y);

      if (b >= 1) {
        if ((b - 1) > EPSLN) {
          return (93);
        }
        else {
          y = 0;
        }
      }
      else {
        y = Math.acos(y);
      }

      if (lat < 0) {
        y = -y;
      }

      y = this.a * this.k0 * (y - this.lat0) + this.y0;
    }
  }
  else {
    var al = cos_phi * delta_lon;
    var als = Math.pow(al, 2);
    var c = this.ep2 * Math.pow(cos_phi, 2);
    var cs = Math.pow(c, 2);
    var tq = Math.abs(cos_phi) > EPSLN ? Math.tan(lat) : 0;
    var t = Math.pow(tq, 2);
    var ts = Math.pow(t, 2);
    con = 1 - this.es * Math.pow(sin_phi, 2);
    al = al / Math.sqrt(con);
    var ml = pj_mlfn(lat, sin_phi, cos_phi, this.en);

    x = this.a * (this.k0 * al * (1 +
      als / 6 * (1 - t + c +
      als / 20 * (5 - 18 * t + ts + 14 * c - 58 * t * c +
      als / 42 * (61 + 179 * ts - ts * t - 479 * t))))) +
      this.x0;

    y = this.a * (this.k0 * (ml - this.ml0 +
      sin_phi * delta_lon * al / 2 * (1 +
      als / 12 * (5 - t + 9 * c + 4 * cs +
      als / 30 * (61 + ts - 58 * t + 270 * c - 330 * t * c +
      als / 56 * (1385 + 543 * ts - ts * t - 3111 * t)))))) +
      this.y0;
  }

  p.x = x;
  p.y = y;

  return p;
}

/**
    Transverse Mercator Inverse  -  x/y to long/lat
  */
function tmerc_inverse(p) {
  var con, phi;
  var lat, lon;
  var x = (p.x - this.x0) * (1 / this.a);
  var y = (p.y - this.y0) * (1 / this.a);

  if (!this.es) {
    var f = Math.exp(x / this.k0);
    var g = 0.5 * (f - 1 / f);
    var temp = this.lat0 + y / this.k0;
    var h = Math.cos(temp);
    con = Math.sqrt((1 - Math.pow(h, 2)) / (1 + Math.pow(g, 2)));
    lat = Math.asin(con);

    if (y < 0) {
      lat = -lat;
    }

    if ((g === 0) && (h === 0)) {
      lon = 0;
    }
    else {
      lon = adjust_lon(Math.atan2(g, h) + this.long0);
    }
  }
  else { // ellipsoidal form
    con = this.ml0 + y / this.k0;
    phi = pj_inv_mlfn(con, this.es, this.en);

    if (Math.abs(phi) < HALF_PI) {
      var sin_phi = Math.sin(phi);
      var cos_phi = Math.cos(phi);
      var tan_phi = Math.abs(cos_phi) > EPSLN ? Math.tan(phi) : 0;
      var c = this.ep2 * Math.pow(cos_phi, 2);
      var cs = Math.pow(c, 2);
      var t = Math.pow(tan_phi, 2);
      var ts = Math.pow(t, 2);
      con = 1 - this.es * Math.pow(sin_phi, 2);
      var d = x * Math.sqrt(con) / this.k0;
      var ds = Math.pow(d, 2);
      con = con * tan_phi;

      lat = phi - (con * ds / (1 - this.es)) * 0.5 * (1 -
        ds / 12 * (5 + 3 * t - 9 * c * t + c - 4 * cs -
        ds / 30 * (61 + 90 * t - 252 * c * t + 45 * ts + 46 * c -
        ds / 56 * (1385 + 3633 * t + 4095 * ts + 1574 * ts * t))));

      lon = adjust_lon(this.long0 + (d * (1 -
        ds / 6 * (1 + 2 * t + c -
        ds / 20 * (5 + 28 * t + 24 * ts + 8 * c * t + 6 * c -
        ds / 42 * (61 + 662 * t + 1320 * ts + 720 * ts * t)))) / cos_phi));
    }
    else {
      lat = HALF_PI * sign(y);
      lon = 0;
    }
  }

  p.x = lon;
  p.y = lat;

  return p;
}

var tmerc_names = ["Fast_Transverse_Mercator", "Fast Transverse Mercator"];
/* harmony default export */ const tmerc = ({
  init: tmerc_init,
  forward: tmerc_forward,
  inverse: tmerc_inverse,
  names: tmerc_names
});

;// CONCATENATED MODULE: ./node_modules/proj4/lib/common/sinh.js
/* harmony default export */ function sinh(x) {
  var r = Math.exp(x);
  r = (r - 1 / r) / 2;
  return r;
}
;// CONCATENATED MODULE: ./node_modules/proj4/lib/common/hypot.js
/* harmony default export */ function hypot(x, y) {
  x = Math.abs(x);
  y = Math.abs(y);
  var a = Math.max(x, y);
  var b = Math.min(x, y) / (a ? a : 1);

  return a * Math.sqrt(1 + Math.pow(b, 2));
}

;// CONCATENATED MODULE: ./node_modules/proj4/lib/common/log1py.js
/* harmony default export */ function log1py(x) {
  var y = 1 + x;
  var z = y - 1;

  return z === 0 ? x : x * Math.log(y) / z;
}

;// CONCATENATED MODULE: ./node_modules/proj4/lib/common/asinhy.js



/* harmony default export */ function asinhy(x) {
  var y = Math.abs(x);
  y = log1py(y * (1 + y / (hypot(1, y) + 1)));

  return x < 0 ? -y : y;
}

;// CONCATENATED MODULE: ./node_modules/proj4/lib/common/gatg.js
/* harmony default export */ function gatg(pp, B) {
  var cos_2B = 2 * Math.cos(2 * B);
  var i = pp.length - 1;
  var h1 = pp[i];
  var h2 = 0;
  var h;

  while (--i >= 0) {
    h = -h2 + cos_2B * h1 + pp[i];
    h2 = h1;
    h1 = h;
  }

  return (B + h * Math.sin(2 * B));
}

;// CONCATENATED MODULE: ./node_modules/proj4/lib/common/clens.js
/* harmony default export */ function clens(pp, arg_r) {
  var r = 2 * Math.cos(arg_r);
  var i = pp.length - 1;
  var hr1 = pp[i];
  var hr2 = 0;
  var hr;

  while (--i >= 0) {
    hr = -hr2 + r * hr1 + pp[i];
    hr2 = hr1;
    hr1 = hr;
  }

  return Math.sin(arg_r) * hr;
}

;// CONCATENATED MODULE: ./node_modules/proj4/lib/common/cosh.js
/* harmony default export */ function cosh(x) {
  var r = Math.exp(x);
  r = (r + 1 / r) / 2;
  return r;
}
;// CONCATENATED MODULE: ./node_modules/proj4/lib/common/clens_cmplx.js



/* harmony default export */ function clens_cmplx(pp, arg_r, arg_i) {
  var sin_arg_r = Math.sin(arg_r);
  var cos_arg_r = Math.cos(arg_r);
  var sinh_arg_i = sinh(arg_i);
  var cosh_arg_i = cosh(arg_i);
  var r = 2 * cos_arg_r * cosh_arg_i;
  var i = -2 * sin_arg_r * sinh_arg_i;
  var j = pp.length - 1;
  var hr = pp[j];
  var hi1 = 0;
  var hr1 = 0;
  var hi = 0;
  var hr2;
  var hi2;

  while (--j >= 0) {
    hr2 = hr1;
    hi2 = hi1;
    hr1 = hr;
    hi1 = hi;
    hr = -hr2 + r * hr1 - i * hi1 + pp[j];
    hi = -hi2 + i * hr1 + r * hi1;
  }

  r = sin_arg_r * cosh_arg_i;
  i = cos_arg_r * sinh_arg_i;

  return [r * hr - i * hi, r * hi + i * hr];
}

;// CONCATENATED MODULE: ./node_modules/proj4/lib/projections/etmerc.js
// Heavily based on this etmerc projection implementation
// https://github.com/mbloch/mapshaper-proj/blob/master/src/projections/etmerc.js










function etmerc_init() {
  if (!this.approx && (isNaN(this.es) || this.es <= 0)) {
    throw new Error('Incorrect elliptical usage. Try using the +approx option in the proj string, or PROJECTION["Fast_Transverse_Mercator"] in the WKT.');
  }
  if (this.approx) {
    // When '+approx' is set, use tmerc instead
    tmerc.init.apply(this);
    this.forward = tmerc.forward;
    this.inverse = tmerc.inverse;
  }

  this.x0 = this.x0 !== undefined ? this.x0 : 0;
  this.y0 = this.y0 !== undefined ? this.y0 : 0;
  this.long0 = this.long0 !== undefined ? this.long0 : 0;
  this.lat0 = this.lat0 !== undefined ? this.lat0 : 0;

  this.cgb = [];
  this.cbg = [];
  this.utg = [];
  this.gtu = [];

  var f = this.es / (1 + Math.sqrt(1 - this.es));
  var n = f / (2 - f);
  var np = n;

  this.cgb[0] = n * (2 + n * (-2 / 3 + n * (-2 + n * (116 / 45 + n * (26 / 45 + n * (-2854 / 675 ))))));
  this.cbg[0] = n * (-2 + n * ( 2 / 3 + n * ( 4 / 3 + n * (-82 / 45 + n * (32 / 45 + n * (4642 / 4725))))));

  np = np * n;
  this.cgb[1] = np * (7 / 3 + n * (-8 / 5 + n * (-227 / 45 + n * (2704 / 315 + n * (2323 / 945)))));
  this.cbg[1] = np * (5 / 3 + n * (-16 / 15 + n * ( -13 / 9 + n * (904 / 315 + n * (-1522 / 945)))));

  np = np * n;
  this.cgb[2] = np * (56 / 15 + n * (-136 / 35 + n * (-1262 / 105 + n * (73814 / 2835))));
  this.cbg[2] = np * (-26 / 15 + n * (34 / 21 + n * (8 / 5 + n * (-12686 / 2835))));

  np = np * n;
  this.cgb[3] = np * (4279 / 630 + n * (-332 / 35 + n * (-399572 / 14175)));
  this.cbg[3] = np * (1237 / 630 + n * (-12 / 5 + n * ( -24832 / 14175)));

  np = np * n;
  this.cgb[4] = np * (4174 / 315 + n * (-144838 / 6237));
  this.cbg[4] = np * (-734 / 315 + n * (109598 / 31185));

  np = np * n;
  this.cgb[5] = np * (601676 / 22275);
  this.cbg[5] = np * (444337 / 155925);

  np = Math.pow(n, 2);
  this.Qn = this.k0 / (1 + n) * (1 + np * (1 / 4 + np * (1 / 64 + np / 256)));

  this.utg[0] = n * (-0.5 + n * ( 2 / 3 + n * (-37 / 96 + n * ( 1 / 360 + n * (81 / 512 + n * (-96199 / 604800))))));
  this.gtu[0] = n * (0.5 + n * (-2 / 3 + n * (5 / 16 + n * (41 / 180 + n * (-127 / 288 + n * (7891 / 37800))))));

  this.utg[1] = np * (-1 / 48 + n * (-1 / 15 + n * (437 / 1440 + n * (-46 / 105 + n * (1118711 / 3870720)))));
  this.gtu[1] = np * (13 / 48 + n * (-3 / 5 + n * (557 / 1440 + n * (281 / 630 + n * (-1983433 / 1935360)))));

  np = np * n;
  this.utg[2] = np * (-17 / 480 + n * (37 / 840 + n * (209 / 4480 + n * (-5569 / 90720 ))));
  this.gtu[2] = np * (61 / 240 + n * (-103 / 140 + n * (15061 / 26880 + n * (167603 / 181440))));

  np = np * n;
  this.utg[3] = np * (-4397 / 161280 + n * (11 / 504 + n * (830251 / 7257600)));
  this.gtu[3] = np * (49561 / 161280 + n * (-179 / 168 + n * (6601661 / 7257600)));

  np = np * n;
  this.utg[4] = np * (-4583 / 161280 + n * (108847 / 3991680));
  this.gtu[4] = np * (34729 / 80640 + n * (-3418889 / 1995840));

  np = np * n;
  this.utg[5] = np * (-20648693 / 638668800);
  this.gtu[5] = np * (212378941 / 319334400);

  var Z = gatg(this.cbg, this.lat0);
  this.Zb = -this.Qn * (Z + clens(this.gtu, 2 * Z));
}

function etmerc_forward(p) {
  var Ce = adjust_lon(p.x - this.long0);
  var Cn = p.y;

  Cn = gatg(this.cbg, Cn);
  var sin_Cn = Math.sin(Cn);
  var cos_Cn = Math.cos(Cn);
  var sin_Ce = Math.sin(Ce);
  var cos_Ce = Math.cos(Ce);

  Cn = Math.atan2(sin_Cn, cos_Ce * cos_Cn);
  Ce = Math.atan2(sin_Ce * cos_Cn, hypot(sin_Cn, cos_Cn * cos_Ce));
  Ce = asinhy(Math.tan(Ce));

  var tmp = clens_cmplx(this.gtu, 2 * Cn, 2 * Ce);

  Cn = Cn + tmp[0];
  Ce = Ce + tmp[1];

  var x;
  var y;

  if (Math.abs(Ce) <= 2.623395162778) {
    x = this.a * (this.Qn * Ce) + this.x0;
    y = this.a * (this.Qn * Cn + this.Zb) + this.y0;
  }
  else {
    x = Infinity;
    y = Infinity;
  }

  p.x = x;
  p.y = y;

  return p;
}

function etmerc_inverse(p) {
  var Ce = (p.x - this.x0) * (1 / this.a);
  var Cn = (p.y - this.y0) * (1 / this.a);

  Cn = (Cn - this.Zb) / this.Qn;
  Ce = Ce / this.Qn;

  var lon;
  var lat;

  if (Math.abs(Ce) <= 2.623395162778) {
    var tmp = clens_cmplx(this.utg, 2 * Cn, 2 * Ce);

    Cn = Cn + tmp[0];
    Ce = Ce + tmp[1];
    Ce = Math.atan(sinh(Ce));

    var sin_Cn = Math.sin(Cn);
    var cos_Cn = Math.cos(Cn);
    var sin_Ce = Math.sin(Ce);
    var cos_Ce = Math.cos(Ce);

    Cn = Math.atan2(sin_Cn * cos_Ce, hypot(sin_Ce, cos_Ce * cos_Cn));
    Ce = Math.atan2(sin_Ce, cos_Ce * cos_Cn);

    lon = adjust_lon(Ce + this.long0);
    lat = gatg(this.cgb, Cn);
  }
  else {
    lon = Infinity;
    lat = Infinity;
  }

  p.x = lon;
  p.y = lat;

  return p;
}

var etmerc_names = ["Extended_Transverse_Mercator", "Extended Transverse Mercator", "etmerc", "Transverse_Mercator", "Transverse Mercator", "tmerc"];
/* harmony default export */ const etmerc = ({
  init: etmerc_init,
  forward: etmerc_forward,
  inverse: etmerc_inverse,
  names: etmerc_names
});

;// CONCATENATED MODULE: ./node_modules/proj4/lib/common/adjust_zone.js


/* harmony default export */ function adjust_zone(zone, lon) {
  if (zone === undefined) {
    zone = Math.floor((adjust_lon(lon) + Math.PI) * 30 / Math.PI) + 1;

    if (zone < 0) {
      return 0;
    } else if (zone > 60) {
      return 60;
    }
  }
  return zone;
}

;// CONCATENATED MODULE: ./node_modules/proj4/lib/projections/utm.js


var dependsOn = 'etmerc';



function utm_init() {
  var zone = adjust_zone(this.zone, this.long0);
  if (zone === undefined) {
    throw new Error('unknown utm zone');
  }
  this.lat0 = 0;
  this.long0 =  ((6 * Math.abs(zone)) - 183) * D2R;
  this.x0 = 500000;
  this.y0 = this.utmSouth ? 10000000 : 0;
  this.k0 = 0.9996;

  etmerc.init.apply(this);
  this.forward = etmerc.forward;
  this.inverse = etmerc.inverse;
}

var utm_names = ["Universal Transverse Mercator System", "utm"];
/* harmony default export */ const utm = ({
  init: utm_init,
  names: utm_names,
  dependsOn: dependsOn
});

;// CONCATENATED MODULE: ./node_modules/proj4/lib/common/srat.js
/* harmony default export */ function srat(esinp, exp) {
  return (Math.pow((1 - esinp) / (1 + esinp), exp));
}
;// CONCATENATED MODULE: ./node_modules/proj4/lib/projections/gauss.js

var gauss_MAX_ITER = 20;


function gauss_init() {
  var sphi = Math.sin(this.lat0);
  var cphi = Math.cos(this.lat0);
  cphi *= cphi;
  this.rc = Math.sqrt(1 - this.es) / (1 - this.es * sphi * sphi);
  this.C = Math.sqrt(1 + this.es * cphi * cphi / (1 - this.es));
  this.phic0 = Math.asin(sphi / this.C);
  this.ratexp = 0.5 * this.C * this.e;
  this.K = Math.tan(0.5 * this.phic0 + FORTPI) / (Math.pow(Math.tan(0.5 * this.lat0 + FORTPI), this.C) * srat(this.e * sphi, this.ratexp));
}

function gauss_forward(p) {
  var lon = p.x;
  var lat = p.y;

  p.y = 2 * Math.atan(this.K * Math.pow(Math.tan(0.5 * lat + FORTPI), this.C) * srat(this.e * Math.sin(lat), this.ratexp)) - HALF_PI;
  p.x = this.C * lon;
  return p;
}

function gauss_inverse(p) {
  var DEL_TOL = 1e-14;
  var lon = p.x / this.C;
  var lat = p.y;
  var num = Math.pow(Math.tan(0.5 * lat + FORTPI) / this.K, 1 / this.C);
  for (var i = gauss_MAX_ITER; i > 0; --i) {
    lat = 2 * Math.atan(num * srat(this.e * Math.sin(p.y), - 0.5 * this.e)) - HALF_PI;
    if (Math.abs(lat - p.y) < DEL_TOL) {
      break;
    }
    p.y = lat;
  }
  /* convergence failed */
  if (!i) {
    return null;
  }
  p.x = lon;
  p.y = lat;
  return p;
}

var gauss_names = ["gauss"];
/* harmony default export */ const gauss = ({
  init: gauss_init,
  forward: gauss_forward,
  inverse: gauss_inverse,
  names: gauss_names
});

;// CONCATENATED MODULE: ./node_modules/proj4/lib/projections/sterea.js



function sterea_init() {
  gauss.init.apply(this);
  if (!this.rc) {
    return;
  }
  this.sinc0 = Math.sin(this.phic0);
  this.cosc0 = Math.cos(this.phic0);
  this.R2 = 2 * this.rc;
  if (!this.title) {
    this.title = "Oblique Stereographic Alternative";
  }
}

function sterea_forward(p) {
  var sinc, cosc, cosl, k;
  p.x = adjust_lon(p.x - this.long0);
  gauss.forward.apply(this, [p]);
  sinc = Math.sin(p.y);
  cosc = Math.cos(p.y);
  cosl = Math.cos(p.x);
  k = this.k0 * this.R2 / (1 + this.sinc0 * sinc + this.cosc0 * cosc * cosl);
  p.x = k * cosc * Math.sin(p.x);
  p.y = k * (this.cosc0 * sinc - this.sinc0 * cosc * cosl);
  p.x = this.a * p.x + this.x0;
  p.y = this.a * p.y + this.y0;
  return p;
}

function sterea_inverse(p) {
  var sinc, cosc, lon, lat, rho;
  p.x = (p.x - this.x0) / this.a;
  p.y = (p.y - this.y0) / this.a;

  p.x /= this.k0;
  p.y /= this.k0;
  if ((rho = Math.sqrt(p.x * p.x + p.y * p.y))) {
    var c = 2 * Math.atan2(rho, this.R2);
    sinc = Math.sin(c);
    cosc = Math.cos(c);
    lat = Math.asin(cosc * this.sinc0 + p.y * sinc * this.cosc0 / rho);
    lon = Math.atan2(p.x * sinc, rho * this.cosc0 * cosc - p.y * this.sinc0 * sinc);
  }
  else {
    lat = this.phic0;
    lon = 0;
  }

  p.x = lon;
  p.y = lat;
  gauss.inverse.apply(this, [p]);
  p.x = adjust_lon(p.x + this.long0);
  return p;
}

var sterea_names = ["Stereographic_North_Pole", "Oblique_Stereographic", "Polar_Stereographic", "sterea","Oblique Stereographic Alternative","Double_Stereographic"];
/* harmony default export */ const sterea = ({
  init: sterea_init,
  forward: sterea_forward,
  inverse: sterea_inverse,
  names: sterea_names
});

;// CONCATENATED MODULE: ./node_modules/proj4/lib/projections/stere.js








function ssfn_(phit, sinphi, eccen) {
  sinphi *= eccen;
  return (Math.tan(0.5 * (HALF_PI + phit)) * Math.pow((1 - sinphi) / (1 + sinphi), 0.5 * eccen));
}

function stere_init() {
  this.coslat0 = Math.cos(this.lat0);
  this.sinlat0 = Math.sin(this.lat0);
  if (this.sphere) {
    if (this.k0 === 1 && !isNaN(this.lat_ts) && Math.abs(this.coslat0) <= EPSLN) {
      this.k0 = 0.5 * (1 + sign(this.lat0) * Math.sin(this.lat_ts));
    }
  }
  else {
    if (Math.abs(this.coslat0) <= EPSLN) {
      if (this.lat0 > 0) {
        //North pole
        //trace('stere:north pole');
        this.con = 1;
      }
      else {
        //South pole
        //trace('stere:south pole');
        this.con = -1;
      }
    }
    this.cons = Math.sqrt(Math.pow(1 + this.e, 1 + this.e) * Math.pow(1 - this.e, 1 - this.e));
    if (this.k0 === 1 && !isNaN(this.lat_ts) && Math.abs(this.coslat0) <= EPSLN) {
      this.k0 = 0.5 * this.cons * msfnz(this.e, Math.sin(this.lat_ts), Math.cos(this.lat_ts)) / tsfnz(this.e, this.con * this.lat_ts, this.con * Math.sin(this.lat_ts));
    }
    this.ms1 = msfnz(this.e, this.sinlat0, this.coslat0);
    this.X0 = 2 * Math.atan(this.ssfn_(this.lat0, this.sinlat0, this.e)) - HALF_PI;
    this.cosX0 = Math.cos(this.X0);
    this.sinX0 = Math.sin(this.X0);
  }
}

// Stereographic forward equations--mapping lat,long to x,y
function stere_forward(p) {
  var lon = p.x;
  var lat = p.y;
  var sinlat = Math.sin(lat);
  var coslat = Math.cos(lat);
  var A, X, sinX, cosX, ts, rh;
  var dlon = adjust_lon(lon - this.long0);

  if (Math.abs(Math.abs(lon - this.long0) - Math.PI) <= EPSLN && Math.abs(lat + this.lat0) <= EPSLN) {
    //case of the origine point
    //trace('stere:this is the origin point');
    p.x = NaN;
    p.y = NaN;
    return p;
  }
  if (this.sphere) {
    //trace('stere:sphere case');
    A = 2 * this.k0 / (1 + this.sinlat0 * sinlat + this.coslat0 * coslat * Math.cos(dlon));
    p.x = this.a * A * coslat * Math.sin(dlon) + this.x0;
    p.y = this.a * A * (this.coslat0 * sinlat - this.sinlat0 * coslat * Math.cos(dlon)) + this.y0;
    return p;
  }
  else {
    X = 2 * Math.atan(this.ssfn_(lat, sinlat, this.e)) - HALF_PI;
    cosX = Math.cos(X);
    sinX = Math.sin(X);
    if (Math.abs(this.coslat0) <= EPSLN) {
      ts = tsfnz(this.e, lat * this.con, this.con * sinlat);
      rh = 2 * this.a * this.k0 * ts / this.cons;
      p.x = this.x0 + rh * Math.sin(lon - this.long0);
      p.y = this.y0 - this.con * rh * Math.cos(lon - this.long0);
      //trace(p.toString());
      return p;
    }
    else if (Math.abs(this.sinlat0) < EPSLN) {
      //Eq
      //trace('stere:equateur');
      A = 2 * this.a * this.k0 / (1 + cosX * Math.cos(dlon));
      p.y = A * sinX;
    }
    else {
      //other case
      //trace('stere:normal case');
      A = 2 * this.a * this.k0 * this.ms1 / (this.cosX0 * (1 + this.sinX0 * sinX + this.cosX0 * cosX * Math.cos(dlon)));
      p.y = A * (this.cosX0 * sinX - this.sinX0 * cosX * Math.cos(dlon)) + this.y0;
    }
    p.x = A * cosX * Math.sin(dlon) + this.x0;
  }
  //trace(p.toString());
  return p;
}

//* Stereographic inverse equations--mapping x,y to lat/long
function stere_inverse(p) {
  p.x -= this.x0;
  p.y -= this.y0;
  var lon, lat, ts, ce, Chi;
  var rh = Math.sqrt(p.x * p.x + p.y * p.y);
  if (this.sphere) {
    var c = 2 * Math.atan(rh / (2 * this.a * this.k0));
    lon = this.long0;
    lat = this.lat0;
    if (rh <= EPSLN) {
      p.x = lon;
      p.y = lat;
      return p;
    }
    lat = Math.asin(Math.cos(c) * this.sinlat0 + p.y * Math.sin(c) * this.coslat0 / rh);
    if (Math.abs(this.coslat0) < EPSLN) {
      if (this.lat0 > 0) {
        lon = adjust_lon(this.long0 + Math.atan2(p.x, - 1 * p.y));
      }
      else {
        lon = adjust_lon(this.long0 + Math.atan2(p.x, p.y));
      }
    }
    else {
      lon = adjust_lon(this.long0 + Math.atan2(p.x * Math.sin(c), rh * this.coslat0 * Math.cos(c) - p.y * this.sinlat0 * Math.sin(c)));
    }
    p.x = lon;
    p.y = lat;
    return p;
  }
  else {
    if (Math.abs(this.coslat0) <= EPSLN) {
      if (rh <= EPSLN) {
        lat = this.lat0;
        lon = this.long0;
        p.x = lon;
        p.y = lat;
        //trace(p.toString());
        return p;
      }
      p.x *= this.con;
      p.y *= this.con;
      ts = rh * this.cons / (2 * this.a * this.k0);
      lat = this.con * phi2z(this.e, ts);
      lon = this.con * adjust_lon(this.con * this.long0 + Math.atan2(p.x, - 1 * p.y));
    }
    else {
      ce = 2 * Math.atan(rh * this.cosX0 / (2 * this.a * this.k0 * this.ms1));
      lon = this.long0;
      if (rh <= EPSLN) {
        Chi = this.X0;
      }
      else {
        Chi = Math.asin(Math.cos(ce) * this.sinX0 + p.y * Math.sin(ce) * this.cosX0 / rh);
        lon = adjust_lon(this.long0 + Math.atan2(p.x * Math.sin(ce), rh * this.cosX0 * Math.cos(ce) - p.y * this.sinX0 * Math.sin(ce)));
      }
      lat = -1 * phi2z(this.e, Math.tan(0.5 * (HALF_PI + Chi)));
    }
  }
  p.x = lon;
  p.y = lat;

  //trace(p.toString());
  return p;

}

var stere_names = ["stere", "Stereographic_South_Pole", "Polar Stereographic (variant B)"];
/* harmony default export */ const stere = ({
  init: stere_init,
  forward: stere_forward,
  inverse: stere_inverse,
  names: stere_names,
  ssfn_: ssfn_
});

;// CONCATENATED MODULE: ./node_modules/proj4/lib/projections/somerc.js
/*
  references:
    Formules et constantes pour le Calcul pour la
    projection cylindrique conforme Ã  axe oblique et pour la transformation entre
    des systÃ¨mes de rÃ©fÃ©rence.
    http://www.swisstopo.admin.ch/internet/swisstopo/fr/home/topics/survey/sys/refsys/switzerland.parsysrelated1.31216.downloadList.77004.DownloadFile.tmp/swissprojectionfr.pdf
  */

function somerc_init() {
  var phy0 = this.lat0;
  this.lambda0 = this.long0;
  var sinPhy0 = Math.sin(phy0);
  var semiMajorAxis = this.a;
  var invF = this.rf;
  var flattening = 1 / invF;
  var e2 = 2 * flattening - Math.pow(flattening, 2);
  var e = this.e = Math.sqrt(e2);
  this.R = this.k0 * semiMajorAxis * Math.sqrt(1 - e2) / (1 - e2 * Math.pow(sinPhy0, 2));
  this.alpha = Math.sqrt(1 + e2 / (1 - e2) * Math.pow(Math.cos(phy0), 4));
  this.b0 = Math.asin(sinPhy0 / this.alpha);
  var k1 = Math.log(Math.tan(Math.PI / 4 + this.b0 / 2));
  var k2 = Math.log(Math.tan(Math.PI / 4 + phy0 / 2));
  var k3 = Math.log((1 + e * sinPhy0) / (1 - e * sinPhy0));
  this.K = k1 - this.alpha * k2 + this.alpha * e / 2 * k3;
}

function somerc_forward(p) {
  var Sa1 = Math.log(Math.tan(Math.PI / 4 - p.y / 2));
  var Sa2 = this.e / 2 * Math.log((1 + this.e * Math.sin(p.y)) / (1 - this.e * Math.sin(p.y)));
  var S = -this.alpha * (Sa1 + Sa2) + this.K;

  // spheric latitude
  var b = 2 * (Math.atan(Math.exp(S)) - Math.PI / 4);

  // spheric longitude
  var I = this.alpha * (p.x - this.lambda0);

  // psoeudo equatorial rotation
  var rotI = Math.atan(Math.sin(I) / (Math.sin(this.b0) * Math.tan(b) + Math.cos(this.b0) * Math.cos(I)));

  var rotB = Math.asin(Math.cos(this.b0) * Math.sin(b) - Math.sin(this.b0) * Math.cos(b) * Math.cos(I));

  p.y = this.R / 2 * Math.log((1 + Math.sin(rotB)) / (1 - Math.sin(rotB))) + this.y0;
  p.x = this.R * rotI + this.x0;
  return p;
}

function somerc_inverse(p) {
  var Y = p.x - this.x0;
  var X = p.y - this.y0;

  var rotI = Y / this.R;
  var rotB = 2 * (Math.atan(Math.exp(X / this.R)) - Math.PI / 4);

  var b = Math.asin(Math.cos(this.b0) * Math.sin(rotB) + Math.sin(this.b0) * Math.cos(rotB) * Math.cos(rotI));
  var I = Math.atan(Math.sin(rotI) / (Math.cos(this.b0) * Math.cos(rotI) - Math.sin(this.b0) * Math.tan(rotB)));

  var lambda = this.lambda0 + I / this.alpha;

  var S = 0;
  var phy = b;
  var prevPhy = -1000;
  var iteration = 0;
  while (Math.abs(phy - prevPhy) > 0.0000001) {
    if (++iteration > 20) {
      //...reportError("omercFwdInfinity");
      return;
    }
    //S = Math.log(Math.tan(Math.PI / 4 + phy / 2));
    S = 1 / this.alpha * (Math.log(Math.tan(Math.PI / 4 + b / 2)) - this.K) + this.e * Math.log(Math.tan(Math.PI / 4 + Math.asin(this.e * Math.sin(phy)) / 2));
    prevPhy = phy;
    phy = 2 * Math.atan(Math.exp(S)) - Math.PI / 2;
  }

  p.x = lambda;
  p.y = phy;
  return p;
}

var somerc_names = ["somerc"];
/* harmony default export */ const somerc = ({
  init: somerc_init,
  forward: somerc_forward,
  inverse: somerc_inverse,
  names: somerc_names
});

;// CONCATENATED MODULE: ./node_modules/proj4/lib/projections/omerc.js





var TOL = 1e-7;

function isTypeA(P) {
  var typeAProjections = ['Hotine_Oblique_Mercator','Hotine_Oblique_Mercator_Azimuth_Natural_Origin'];
  var projectionName = typeof P.PROJECTION === "object" ? Object.keys(P.PROJECTION)[0] : P.PROJECTION;
  
  return 'no_uoff' in P || 'no_off' in P || typeAProjections.indexOf(projectionName) !== -1;
}


/* Initialize the Oblique Mercator  projection
    ------------------------------------------*/
function omerc_init() {  
  var con, com, cosph0, D, F, H, L, sinph0, p, J, gamma = 0,
    gamma0, lamc = 0, lam1 = 0, lam2 = 0, phi1 = 0, phi2 = 0, alpha_c = 0, AB;
  
  // only Type A uses the no_off or no_uoff property
  // https://github.com/OSGeo/proj.4/issues/104
  this.no_off = isTypeA(this);
  this.no_rot = 'no_rot' in this;
  
  var alp = false;
  if ("alpha" in this) {
    alp = true;
  }

  var gam = false;
  if ("rectified_grid_angle" in this) {
    gam = true;
  }

  if (alp) {
    alpha_c = this.alpha;
  }
  
  if (gam) {
    gamma = (this.rectified_grid_angle * D2R);
  }
  
  if (alp || gam) {
    lamc = this.longc;
  } else {
    lam1 = this.long1;
    phi1 = this.lat1;
    lam2 = this.long2;
    phi2 = this.lat2;
    
    if (Math.abs(phi1 - phi2) <= TOL || (con = Math.abs(phi1)) <= TOL ||
        Math.abs(con - HALF_PI) <= TOL || Math.abs(Math.abs(this.lat0) - HALF_PI) <= TOL ||
        Math.abs(Math.abs(phi2) - HALF_PI) <= TOL) {
      throw new Error();
    }
  }
  
  var one_es = 1.0 - this.es;
  com = Math.sqrt(one_es);
  
  if (Math.abs(this.lat0) > EPSLN) {
    sinph0 = Math.sin(this.lat0);
    cosph0 = Math.cos(this.lat0);
    con = 1 - this.es * sinph0 * sinph0;
    this.B = cosph0 * cosph0;
    this.B = Math.sqrt(1 + this.es * this.B * this.B / one_es);
    this.A = this.B * this.k0 * com / con;
    D = this.B * com / (cosph0 * Math.sqrt(con));
    F = D * D -1;
    
    if (F <= 0) {
      F = 0;
    } else {
      F = Math.sqrt(F);
      if (this.lat0 < 0) {
        F = -F;
      }
    }
    
    this.E = F += D;
    this.E *= Math.pow(tsfnz(this.e, this.lat0, sinph0), this.B);
  } else {
    this.B = 1 / com;
    this.A = this.k0;
    this.E = D = F = 1;
  }
  
  if (alp || gam) {
    if (alp) {
      gamma0 = Math.asin(Math.sin(alpha_c) / D);
      if (!gam) {
        gamma = alpha_c;
      }
    } else {
      gamma0 = gamma;
      alpha_c = Math.asin(D * Math.sin(gamma0));
    }
    this.lam0 = lamc - Math.asin(0.5 * (F - 1 / F) * Math.tan(gamma0)) / this.B;
  } else {
    H = Math.pow(tsfnz(this.e, phi1, Math.sin(phi1)), this.B);
    L = Math.pow(tsfnz(this.e, phi2, Math.sin(phi2)), this.B);
    F = this.E / H;
    p = (L - H) / (L + H);
    J = this.E * this.E;
    J = (J - L * H) / (J + L * H);
    con = lam1 - lam2;
    
    if (con < -Math.pi) {
      lam2 -=TWO_PI;
    } else if (con > Math.pi) {
      lam2 += TWO_PI;
    }
    
    this.lam0 = adjust_lon(0.5 * (lam1 + lam2) - Math.atan(J * Math.tan(0.5 * this.B * (lam1 - lam2)) / p) / this.B);
    gamma0 = Math.atan(2 * Math.sin(this.B * adjust_lon(lam1 - this.lam0)) / (F - 1 / F));
    gamma = alpha_c = Math.asin(D * Math.sin(gamma0));
  }
  
  this.singam = Math.sin(gamma0);
  this.cosgam = Math.cos(gamma0);
  this.sinrot = Math.sin(gamma);
  this.cosrot = Math.cos(gamma);
  
  this.rB = 1 / this.B;
  this.ArB = this.A * this.rB;
  this.BrA = 1 / this.ArB;
  AB = this.A * this.B;
  
  if (this.no_off) {
    this.u_0 = 0;
  } else {
    this.u_0 = Math.abs(this.ArB * Math.atan(Math.sqrt(D * D - 1) / Math.cos(alpha_c)));
    
    if (this.lat0 < 0) {
      this.u_0 = - this.u_0;
    }  
  }
    
  F = 0.5 * gamma0;
  this.v_pole_n = this.ArB * Math.log(Math.tan(FORTPI - F));
  this.v_pole_s = this.ArB * Math.log(Math.tan(FORTPI + F));
}


/* Oblique Mercator forward equations--mapping lat,long to x,y
    ----------------------------------------------------------*/
function omerc_forward(p) {
  var coords = {};
  var S, T, U, V, W, temp, u, v;
  p.x = p.x - this.lam0;
  
  if (Math.abs(Math.abs(p.y) - HALF_PI) > EPSLN) {
    W = this.E / Math.pow(tsfnz(this.e, p.y, Math.sin(p.y)), this.B);
    
    temp = 1 / W;
    S = 0.5 * (W - temp);
    T = 0.5 * (W + temp);
    V = Math.sin(this.B * p.x);
    U = (S * this.singam - V * this.cosgam) / T;
        
    if (Math.abs(Math.abs(U) - 1.0) < EPSLN) {
      throw new Error();
    }
    
    v = 0.5 * this.ArB * Math.log((1 - U)/(1 + U));
    temp = Math.cos(this.B * p.x);
    
    if (Math.abs(temp) < TOL) {
      u = this.A * p.x;
    } else {
      u = this.ArB * Math.atan2((S * this.cosgam + V * this.singam), temp);
    }    
  } else {
    v = p.y > 0 ? this.v_pole_n : this.v_pole_s;
    u = this.ArB * p.y;
  }
     
  if (this.no_rot) {
    coords.x = u;
    coords.y = v;
  } else {
    u -= this.u_0;
    coords.x = v * this.cosrot + u * this.sinrot;
    coords.y = u * this.cosrot - v * this.sinrot;
  }
  
  coords.x = (this.a * coords.x + this.x0);
  coords.y = (this.a * coords.y + this.y0);
  
  return coords;
}

function omerc_inverse(p) {
  var u, v, Qp, Sp, Tp, Vp, Up;
  var coords = {};
  
  p.x = (p.x - this.x0) * (1.0 / this.a);
  p.y = (p.y - this.y0) * (1.0 / this.a);

  if (this.no_rot) {
    v = p.y;
    u = p.x;
  } else {
    v = p.x * this.cosrot - p.y * this.sinrot;
    u = p.y * this.cosrot + p.x * this.sinrot + this.u_0;
  }
  
  Qp = Math.exp(-this.BrA * v);
  Sp = 0.5 * (Qp - 1 / Qp);
  Tp = 0.5 * (Qp + 1 / Qp);
  Vp = Math.sin(this.BrA * u);
  Up = (Vp * this.cosgam + Sp * this.singam) / Tp;
  
  if (Math.abs(Math.abs(Up) - 1) < EPSLN) {
    coords.x = 0;
    coords.y = Up < 0 ? -HALF_PI : HALF_PI;
  } else {
    coords.y = this.E / Math.sqrt((1 + Up) / (1 - Up));
    coords.y = phi2z(this.e, Math.pow(coords.y, 1 / this.B));
    
    if (coords.y === Infinity) {
      throw new Error();
    }
        
    coords.x = -this.rB * Math.atan2((Sp * this.cosgam - Vp * this.singam), Math.cos(this.BrA * u));
  }
  
  coords.x += this.lam0;
  
  return coords;
}

var omerc_names = ["Hotine_Oblique_Mercator", "Hotine Oblique Mercator", "Hotine_Oblique_Mercator_Azimuth_Natural_Origin", "Hotine_Oblique_Mercator_Two_Point_Natural_Origin", "Hotine_Oblique_Mercator_Azimuth_Center", "Oblique_Mercator", "omerc"];
/* harmony default export */ const omerc = ({
  init: omerc_init,
  forward: omerc_forward,
  inverse: omerc_inverse,
  names: omerc_names
});

;// CONCATENATED MODULE: ./node_modules/proj4/lib/projections/lcc.js






function lcc_init() {
  
  //double lat0;                    /* the reference latitude               */
  //double long0;                   /* the reference longitude              */
  //double lat1;                    /* first standard parallel              */
  //double lat2;                    /* second standard parallel             */
  //double r_maj;                   /* major axis                           */
  //double r_min;                   /* minor axis                           */
  //double false_east;              /* x offset in meters                   */
  //double false_north;             /* y offset in meters                   */
  
  //the above value can be set with proj4.defs
  //example: proj4.defs("EPSG:2154","+proj=lcc +lat_1=49 +lat_2=44 +lat_0=46.5 +lon_0=3 +x_0=700000 +y_0=6600000 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs");

  if (!this.lat2) {
    this.lat2 = this.lat1;
  } //if lat2 is not defined
  if (!this.k0) {
    this.k0 = 1;
  }
  this.x0 = this.x0 || 0;
  this.y0 = this.y0 || 0;
  // Standard Parallels cannot be equal and on opposite sides of the equator
  if (Math.abs(this.lat1 + this.lat2) < EPSLN) {
    return;
  }

  var temp = this.b / this.a;
  this.e = Math.sqrt(1 - temp * temp);

  var sin1 = Math.sin(this.lat1);
  var cos1 = Math.cos(this.lat1);
  var ms1 = msfnz(this.e, sin1, cos1);
  var ts1 = tsfnz(this.e, this.lat1, sin1);

  var sin2 = Math.sin(this.lat2);
  var cos2 = Math.cos(this.lat2);
  var ms2 = msfnz(this.e, sin2, cos2);
  var ts2 = tsfnz(this.e, this.lat2, sin2);

  var ts0 = tsfnz(this.e, this.lat0, Math.sin(this.lat0));

  if (Math.abs(this.lat1 - this.lat2) > EPSLN) {
    this.ns = Math.log(ms1 / ms2) / Math.log(ts1 / ts2);
  }
  else {
    this.ns = sin1;
  }
  if (isNaN(this.ns)) {
    this.ns = sin1;
  }
  this.f0 = ms1 / (this.ns * Math.pow(ts1, this.ns));
  this.rh = this.a * this.f0 * Math.pow(ts0, this.ns);
  if (!this.title) {
    this.title = "Lambert Conformal Conic";
  }
}

// Lambert Conformal conic forward equations--mapping lat,long to x,y
// -----------------------------------------------------------------
function lcc_forward(p) {

  var lon = p.x;
  var lat = p.y;

  // singular cases :
  if (Math.abs(2 * Math.abs(lat) - Math.PI) <= EPSLN) {
    lat = sign(lat) * (HALF_PI - 2 * EPSLN);
  }

  var con = Math.abs(Math.abs(lat) - HALF_PI);
  var ts, rh1;
  if (con > EPSLN) {
    ts = tsfnz(this.e, lat, Math.sin(lat));
    rh1 = this.a * this.f0 * Math.pow(ts, this.ns);
  }
  else {
    con = lat * this.ns;
    if (con <= 0) {
      return null;
    }
    rh1 = 0;
  }
  var theta = this.ns * adjust_lon(lon - this.long0);
  p.x = this.k0 * (rh1 * Math.sin(theta)) + this.x0;
  p.y = this.k0 * (this.rh - rh1 * Math.cos(theta)) + this.y0;

  return p;
}

// Lambert Conformal Conic inverse equations--mapping x,y to lat/long
// -----------------------------------------------------------------
function lcc_inverse(p) {

  var rh1, con, ts;
  var lat, lon;
  var x = (p.x - this.x0) / this.k0;
  var y = (this.rh - (p.y - this.y0) / this.k0);
  if (this.ns > 0) {
    rh1 = Math.sqrt(x * x + y * y);
    con = 1;
  }
  else {
    rh1 = -Math.sqrt(x * x + y * y);
    con = -1;
  }
  var theta = 0;
  if (rh1 !== 0) {
    theta = Math.atan2((con * x), (con * y));
  }
  if ((rh1 !== 0) || (this.ns > 0)) {
    con = 1 / this.ns;
    ts = Math.pow((rh1 / (this.a * this.f0)), con);
    lat = phi2z(this.e, ts);
    if (lat === -9999) {
      return null;
    }
  }
  else {
    lat = -HALF_PI;
  }
  lon = adjust_lon(theta / this.ns + this.long0);

  p.x = lon;
  p.y = lat;
  return p;
}

var lcc_names = [
  "Lambert Tangential Conformal Conic Projection",
  "Lambert_Conformal_Conic",
  "Lambert_Conformal_Conic_1SP",
  "Lambert_Conformal_Conic_2SP",
  "lcc",
  "Lambert Conic Conformal (1SP)",
  "Lambert Conic Conformal (2SP)"
];

/* harmony default export */ const lcc = ({
  init: lcc_init,
  forward: lcc_forward,
  inverse: lcc_inverse,
  names: lcc_names
});

;// CONCATENATED MODULE: ./node_modules/proj4/lib/projections/krovak.js


function krovak_init() {
  this.a = 6377397.155;
  this.es = 0.006674372230614;
  this.e = Math.sqrt(this.es);
  if (!this.lat0) {
    this.lat0 = 0.863937979737193;
  }
  if (!this.long0) {
    this.long0 = 0.7417649320975901 - 0.308341501185665;
  }
  /* if scale not set default to 0.9999 */
  if (!this.k0) {
    this.k0 = 0.9999;
  }
  this.s45 = 0.785398163397448; /* 45 */
  this.s90 = 2 * this.s45;
  this.fi0 = this.lat0;
  this.e2 = this.es;
  this.e = Math.sqrt(this.e2);
  this.alfa = Math.sqrt(1 + (this.e2 * Math.pow(Math.cos(this.fi0), 4)) / (1 - this.e2));
  this.uq = 1.04216856380474;
  this.u0 = Math.asin(Math.sin(this.fi0) / this.alfa);
  this.g = Math.pow((1 + this.e * Math.sin(this.fi0)) / (1 - this.e * Math.sin(this.fi0)), this.alfa * this.e / 2);
  this.k = Math.tan(this.u0 / 2 + this.s45) / Math.pow(Math.tan(this.fi0 / 2 + this.s45), this.alfa) * this.g;
  this.k1 = this.k0;
  this.n0 = this.a * Math.sqrt(1 - this.e2) / (1 - this.e2 * Math.pow(Math.sin(this.fi0), 2));
  this.s0 = 1.37008346281555;
  this.n = Math.sin(this.s0);
  this.ro0 = this.k1 * this.n0 / Math.tan(this.s0);
  this.ad = this.s90 - this.uq;
}

/* ellipsoid */
/* calculate xy from lat/lon */
/* Constants, identical to inverse transform function */
function krovak_forward(p) {
  var gfi, u, deltav, s, d, eps, ro;
  var lon = p.x;
  var lat = p.y;
  var delta_lon = adjust_lon(lon - this.long0);
  /* Transformation */
  gfi = Math.pow(((1 + this.e * Math.sin(lat)) / (1 - this.e * Math.sin(lat))), (this.alfa * this.e / 2));
  u = 2 * (Math.atan(this.k * Math.pow(Math.tan(lat / 2 + this.s45), this.alfa) / gfi) - this.s45);
  deltav = -delta_lon * this.alfa;
  s = Math.asin(Math.cos(this.ad) * Math.sin(u) + Math.sin(this.ad) * Math.cos(u) * Math.cos(deltav));
  d = Math.asin(Math.cos(u) * Math.sin(deltav) / Math.cos(s));
  eps = this.n * d;
  ro = this.ro0 * Math.pow(Math.tan(this.s0 / 2 + this.s45), this.n) / Math.pow(Math.tan(s / 2 + this.s45), this.n);
  p.y = ro * Math.cos(eps) / 1;
  p.x = ro * Math.sin(eps) / 1;

  if (!this.czech) {
    p.y *= -1;
    p.x *= -1;
  }
  return (p);
}

/* calculate lat/lon from xy */
function krovak_inverse(p) {
  var u, deltav, s, d, eps, ro, fi1;
  var ok;

  /* Transformation */
  /* revert y, x*/
  var tmp = p.x;
  p.x = p.y;
  p.y = tmp;
  if (!this.czech) {
    p.y *= -1;
    p.x *= -1;
  }
  ro = Math.sqrt(p.x * p.x + p.y * p.y);
  eps = Math.atan2(p.y, p.x);
  d = eps / Math.sin(this.s0);
  s = 2 * (Math.atan(Math.pow(this.ro0 / ro, 1 / this.n) * Math.tan(this.s0 / 2 + this.s45)) - this.s45);
  u = Math.asin(Math.cos(this.ad) * Math.sin(s) - Math.sin(this.ad) * Math.cos(s) * Math.cos(d));
  deltav = Math.asin(Math.cos(s) * Math.sin(d) / Math.cos(u));
  p.x = this.long0 - deltav / this.alfa;
  fi1 = u;
  ok = 0;
  var iter = 0;
  do {
    p.y = 2 * (Math.atan(Math.pow(this.k, - 1 / this.alfa) * Math.pow(Math.tan(u / 2 + this.s45), 1 / this.alfa) * Math.pow((1 + this.e * Math.sin(fi1)) / (1 - this.e * Math.sin(fi1)), this.e / 2)) - this.s45);
    if (Math.abs(fi1 - p.y) < 0.0000000001) {
      ok = 1;
    }
    fi1 = p.y;
    iter += 1;
  } while (ok === 0 && iter < 15);
  if (iter >= 15) {
    return null;
  }

  return (p);
}

var krovak_names = ["Krovak", "krovak"];
/* harmony default export */ const krovak = ({
  init: krovak_init,
  forward: krovak_forward,
  inverse: krovak_inverse,
  names: krovak_names
});

;// CONCATENATED MODULE: ./node_modules/proj4/lib/common/mlfn.js
/* harmony default export */ function mlfn(e0, e1, e2, e3, phi) {
  return (e0 * phi - e1 * Math.sin(2 * phi) + e2 * Math.sin(4 * phi) - e3 * Math.sin(6 * phi));
}
;// CONCATENATED MODULE: ./node_modules/proj4/lib/common/e0fn.js
/* harmony default export */ function e0fn(x) {
  return (1 - 0.25 * x * (1 + x / 16 * (3 + 1.25 * x)));
}
;// CONCATENATED MODULE: ./node_modules/proj4/lib/common/e1fn.js
/* harmony default export */ function e1fn(x) {
  return (0.375 * x * (1 + 0.25 * x * (1 + 0.46875 * x)));
}
;// CONCATENATED MODULE: ./node_modules/proj4/lib/common/e2fn.js
/* harmony default export */ function e2fn(x) {
  return (0.05859375 * x * x * (1 + 0.75 * x));
}
;// CONCATENATED MODULE: ./node_modules/proj4/lib/common/e3fn.js
/* harmony default export */ function e3fn(x) {
  return (x * x * x * (35 / 3072));
}
;// CONCATENATED MODULE: ./node_modules/proj4/lib/common/gN.js
/* harmony default export */ function gN(a, e, sinphi) {
  var temp = e * sinphi;
  return a / Math.sqrt(1 - temp * temp);
}
;// CONCATENATED MODULE: ./node_modules/proj4/lib/common/adjust_lat.js



/* harmony default export */ function adjust_lat(x) {
  return (Math.abs(x) < HALF_PI) ? x : (x - (sign(x) * Math.PI));
}

;// CONCATENATED MODULE: ./node_modules/proj4/lib/common/imlfn.js
/* harmony default export */ function imlfn(ml, e0, e1, e2, e3) {
  var phi;
  var dphi;

  phi = ml / e0;
  for (var i = 0; i < 15; i++) {
    dphi = (ml - (e0 * phi - e1 * Math.sin(2 * phi) + e2 * Math.sin(4 * phi) - e3 * Math.sin(6 * phi))) / (e0 - 2 * e1 * Math.cos(2 * phi) + 4 * e2 * Math.cos(4 * phi) - 6 * e3 * Math.cos(6 * phi));
    phi += dphi;
    if (Math.abs(dphi) <= 0.0000000001) {
      return phi;
    }
  }

  //..reportError("IMLFN-CONV:Latitude failed to converge after 15 iterations");
  return NaN;
}
;// CONCATENATED MODULE: ./node_modules/proj4/lib/projections/cass.js











function cass_init() {
  if (!this.sphere) {
    this.e0 = e0fn(this.es);
    this.e1 = e1fn(this.es);
    this.e2 = e2fn(this.es);
    this.e3 = e3fn(this.es);
    this.ml0 = this.a * mlfn(this.e0, this.e1, this.e2, this.e3, this.lat0);
  }
}

/* Cassini forward equations--mapping lat,long to x,y
  -----------------------------------------------------------------------*/
function cass_forward(p) {

  /* Forward equations
      -----------------*/
  var x, y;
  var lam = p.x;
  var phi = p.y;
  lam = adjust_lon(lam - this.long0);

  if (this.sphere) {
    x = this.a * Math.asin(Math.cos(phi) * Math.sin(lam));
    y = this.a * (Math.atan2(Math.tan(phi), Math.cos(lam)) - this.lat0);
  }
  else {
    //ellipsoid
    var sinphi = Math.sin(phi);
    var cosphi = Math.cos(phi);
    var nl = gN(this.a, this.e, sinphi);
    var tl = Math.tan(phi) * Math.tan(phi);
    var al = lam * Math.cos(phi);
    var asq = al * al;
    var cl = this.es * cosphi * cosphi / (1 - this.es);
    var ml = this.a * mlfn(this.e0, this.e1, this.e2, this.e3, phi);

    x = nl * al * (1 - asq * tl * (1 / 6 - (8 - tl + 8 * cl) * asq / 120));
    y = ml - this.ml0 + nl * sinphi / cosphi * asq * (0.5 + (5 - tl + 6 * cl) * asq / 24);


  }

  p.x = x + this.x0;
  p.y = y + this.y0;
  return p;
}

/* Inverse equations
  -----------------*/
function cass_inverse(p) {
  p.x -= this.x0;
  p.y -= this.y0;
  var x = p.x / this.a;
  var y = p.y / this.a;
  var phi, lam;

  if (this.sphere) {
    var dd = y + this.lat0;
    phi = Math.asin(Math.sin(dd) * Math.cos(x));
    lam = Math.atan2(Math.tan(x), Math.cos(dd));
  }
  else {
    /* ellipsoid */
    var ml1 = this.ml0 / this.a + y;
    var phi1 = imlfn(ml1, this.e0, this.e1, this.e2, this.e3);
    if (Math.abs(Math.abs(phi1) - HALF_PI) <= EPSLN) {
      p.x = this.long0;
      p.y = HALF_PI;
      if (y < 0) {
        p.y *= -1;
      }
      return p;
    }
    var nl1 = gN(this.a, this.e, Math.sin(phi1));

    var rl1 = nl1 * nl1 * nl1 / this.a / this.a * (1 - this.es);
    var tl1 = Math.pow(Math.tan(phi1), 2);
    var dl = x * this.a / nl1;
    var dsq = dl * dl;
    phi = phi1 - nl1 * Math.tan(phi1) / rl1 * dl * dl * (0.5 - (1 + 3 * tl1) * dl * dl / 24);
    lam = dl * (1 - dsq * (tl1 / 3 + (1 + 3 * tl1) * tl1 * dsq / 15)) / Math.cos(phi1);

  }

  p.x = adjust_lon(lam + this.long0);
  p.y = adjust_lat(phi);
  return p;

}

var cass_names = ["Cassini", "Cassini_Soldner", "cass"];
/* harmony default export */ const cass = ({
  init: cass_init,
  forward: cass_forward,
  inverse: cass_inverse,
  names: cass_names
});

;// CONCATENATED MODULE: ./node_modules/proj4/lib/common/qsfnz.js
/* harmony default export */ function qsfnz(eccent, sinphi) {
  var con;
  if (eccent > 1.0e-7) {
    con = eccent * sinphi;
    return ((1 - eccent * eccent) * (sinphi / (1 - con * con) - (0.5 / eccent) * Math.log((1 - con) / (1 + con))));
  }
  else {
    return (2 * sinphi);
  }
}
;// CONCATENATED MODULE: ./node_modules/proj4/lib/projections/laea.js






/*
  reference
    "New Equal-Area Map Projections for Noncircular Regions", John P. Snyder,
    The American Cartographer, Vol 15, No. 4, October 1988, pp. 341-355.
  */

var S_POLE = 1;

var N_POLE = 2;
var EQUIT = 3;
var OBLIQ = 4;

/* Initialize the Lambert Azimuthal Equal Area projection
  ------------------------------------------------------*/
function laea_init() {
  var t = Math.abs(this.lat0);
  if (Math.abs(t - HALF_PI) < EPSLN) {
    this.mode = this.lat0 < 0 ? this.S_POLE : this.N_POLE;
  }
  else if (Math.abs(t) < EPSLN) {
    this.mode = this.EQUIT;
  }
  else {
    this.mode = this.OBLIQ;
  }
  if (this.es > 0) {
    var sinphi;

    this.qp = qsfnz(this.e, 1);
    this.mmf = 0.5 / (1 - this.es);
    this.apa = authset(this.es);
    switch (this.mode) {
    case this.N_POLE:
      this.dd = 1;
      break;
    case this.S_POLE:
      this.dd = 1;
      break;
    case this.EQUIT:
      this.rq = Math.sqrt(0.5 * this.qp);
      this.dd = 1 / this.rq;
      this.xmf = 1;
      this.ymf = 0.5 * this.qp;
      break;
    case this.OBLIQ:
      this.rq = Math.sqrt(0.5 * this.qp);
      sinphi = Math.sin(this.lat0);
      this.sinb1 = qsfnz(this.e, sinphi) / this.qp;
      this.cosb1 = Math.sqrt(1 - this.sinb1 * this.sinb1);
      this.dd = Math.cos(this.lat0) / (Math.sqrt(1 - this.es * sinphi * sinphi) * this.rq * this.cosb1);
      this.ymf = (this.xmf = this.rq) / this.dd;
      this.xmf *= this.dd;
      break;
    }
  }
  else {
    if (this.mode === this.OBLIQ) {
      this.sinph0 = Math.sin(this.lat0);
      this.cosph0 = Math.cos(this.lat0);
    }
  }
}

/* Lambert Azimuthal Equal Area forward equations--mapping lat,long to x,y
  -----------------------------------------------------------------------*/
function laea_forward(p) {

  /* Forward equations
      -----------------*/
  var x, y, coslam, sinlam, sinphi, q, sinb, cosb, b, cosphi;
  var lam = p.x;
  var phi = p.y;

  lam = adjust_lon(lam - this.long0);
  if (this.sphere) {
    sinphi = Math.sin(phi);
    cosphi = Math.cos(phi);
    coslam = Math.cos(lam);
    if (this.mode === this.OBLIQ || this.mode === this.EQUIT) {
      y = (this.mode === this.EQUIT) ? 1 + cosphi * coslam : 1 + this.sinph0 * sinphi + this.cosph0 * cosphi * coslam;
      if (y <= EPSLN) {
        return null;
      }
      y = Math.sqrt(2 / y);
      x = y * cosphi * Math.sin(lam);
      y *= (this.mode === this.EQUIT) ? sinphi : this.cosph0 * sinphi - this.sinph0 * cosphi * coslam;
    }
    else if (this.mode === this.N_POLE || this.mode === this.S_POLE) {
      if (this.mode === this.N_POLE) {
        coslam = -coslam;
      }
      if (Math.abs(phi + this.lat0) < EPSLN) {
        return null;
      }
      y = FORTPI - phi * 0.5;
      y = 2 * ((this.mode === this.S_POLE) ? Math.cos(y) : Math.sin(y));
      x = y * Math.sin(lam);
      y *= coslam;
    }
  }
  else {
    sinb = 0;
    cosb = 0;
    b = 0;
    coslam = Math.cos(lam);
    sinlam = Math.sin(lam);
    sinphi = Math.sin(phi);
    q = qsfnz(this.e, sinphi);
    if (this.mode === this.OBLIQ || this.mode === this.EQUIT) {
      sinb = q / this.qp;
      cosb = Math.sqrt(1 - sinb * sinb);
    }
    switch (this.mode) {
    case this.OBLIQ:
      b = 1 + this.sinb1 * sinb + this.cosb1 * cosb * coslam;
      break;
    case this.EQUIT:
      b = 1 + cosb * coslam;
      break;
    case this.N_POLE:
      b = HALF_PI + phi;
      q = this.qp - q;
      break;
    case this.S_POLE:
      b = phi - HALF_PI;
      q = this.qp + q;
      break;
    }
    if (Math.abs(b) < EPSLN) {
      return null;
    }
    switch (this.mode) {
    case this.OBLIQ:
    case this.EQUIT:
      b = Math.sqrt(2 / b);
      if (this.mode === this.OBLIQ) {
        y = this.ymf * b * (this.cosb1 * sinb - this.sinb1 * cosb * coslam);
      }
      else {
        y = (b = Math.sqrt(2 / (1 + cosb * coslam))) * sinb * this.ymf;
      }
      x = this.xmf * b * cosb * sinlam;
      break;
    case this.N_POLE:
    case this.S_POLE:
      if (q >= 0) {
        x = (b = Math.sqrt(q)) * sinlam;
        y = coslam * ((this.mode === this.S_POLE) ? b : -b);
      }
      else {
        x = y = 0;
      }
      break;
    }
  }

  p.x = this.a * x + this.x0;
  p.y = this.a * y + this.y0;
  return p;
}

/* Inverse equations
  -----------------*/
function laea_inverse(p) {
  p.x -= this.x0;
  p.y -= this.y0;
  var x = p.x / this.a;
  var y = p.y / this.a;
  var lam, phi, cCe, sCe, q, rho, ab;
  if (this.sphere) {
    var cosz = 0,
      rh, sinz = 0;

    rh = Math.sqrt(x * x + y * y);
    phi = rh * 0.5;
    if (phi > 1) {
      return null;
    }
    phi = 2 * Math.asin(phi);
    if (this.mode === this.OBLIQ || this.mode === this.EQUIT) {
      sinz = Math.sin(phi);
      cosz = Math.cos(phi);
    }
    switch (this.mode) {
    case this.EQUIT:
      phi = (Math.abs(rh) <= EPSLN) ? 0 : Math.asin(y * sinz / rh);
      x *= sinz;
      y = cosz * rh;
      break;
    case this.OBLIQ:
      phi = (Math.abs(rh) <= EPSLN) ? this.lat0 : Math.asin(cosz * this.sinph0 + y * sinz * this.cosph0 / rh);
      x *= sinz * this.cosph0;
      y = (cosz - Math.sin(phi) * this.sinph0) * rh;
      break;
    case this.N_POLE:
      y = -y;
      phi = HALF_PI - phi;
      break;
    case this.S_POLE:
      phi -= HALF_PI;
      break;
    }
    lam = (y === 0 && (this.mode === this.EQUIT || this.mode === this.OBLIQ)) ? 0 : Math.atan2(x, y);
  }
  else {
    ab = 0;
    if (this.mode === this.OBLIQ || this.mode === this.EQUIT) {
      x /= this.dd;
      y *= this.dd;
      rho = Math.sqrt(x * x + y * y);
      if (rho < EPSLN) {
        p.x = this.long0;
        p.y = this.lat0;
        return p;
      }
      sCe = 2 * Math.asin(0.5 * rho / this.rq);
      cCe = Math.cos(sCe);
      x *= (sCe = Math.sin(sCe));
      if (this.mode === this.OBLIQ) {
        ab = cCe * this.sinb1 + y * sCe * this.cosb1 / rho;
        q = this.qp * ab;
        y = rho * this.cosb1 * cCe - y * this.sinb1 * sCe;
      }
      else {
        ab = y * sCe / rho;
        q = this.qp * ab;
        y = rho * cCe;
      }
    }
    else if (this.mode === this.N_POLE || this.mode === this.S_POLE) {
      if (this.mode === this.N_POLE) {
        y = -y;
      }
      q = (x * x + y * y);
      if (!q) {
        p.x = this.long0;
        p.y = this.lat0;
        return p;
      }
      ab = 1 - q / this.qp;
      if (this.mode === this.S_POLE) {
        ab = -ab;
      }
    }
    lam = Math.atan2(x, y);
    phi = authlat(Math.asin(ab), this.apa);
  }

  p.x = adjust_lon(this.long0 + lam);
  p.y = phi;
  return p;
}

/* determine latitude from authalic latitude */
var P00 = 0.33333333333333333333;

var P01 = 0.17222222222222222222;
var P02 = 0.10257936507936507936;
var P10 = 0.06388888888888888888;
var P11 = 0.06640211640211640211;
var P20 = 0.01641501294219154443;

function authset(es) {
  var t;
  var APA = [];
  APA[0] = es * P00;
  t = es * es;
  APA[0] += t * P01;
  APA[1] = t * P10;
  t *= es;
  APA[0] += t * P02;
  APA[1] += t * P11;
  APA[2] = t * P20;
  return APA;
}

function authlat(beta, APA) {
  var t = beta + beta;
  return (beta + APA[0] * Math.sin(t) + APA[1] * Math.sin(t + t) + APA[2] * Math.sin(t + t + t));
}

var laea_names = ["Lambert Azimuthal Equal Area", "Lambert_Azimuthal_Equal_Area", "laea"];
/* harmony default export */ const laea = ({
  init: laea_init,
  forward: laea_forward,
  inverse: laea_inverse,
  names: laea_names,
  S_POLE: S_POLE,
  N_POLE: N_POLE,
  EQUIT: EQUIT,
  OBLIQ: OBLIQ
});

;// CONCATENATED MODULE: ./node_modules/proj4/lib/common/asinz.js
/* harmony default export */ function asinz(x) {
  if (Math.abs(x) > 1) {
    x = (x > 1) ? 1 : -1;
  }
  return Math.asin(x);
}
;// CONCATENATED MODULE: ./node_modules/proj4/lib/projections/aea.js






function aea_init() {

  if (Math.abs(this.lat1 + this.lat2) < EPSLN) {
    return;
  }
  this.temp = this.b / this.a;
  this.es = 1 - Math.pow(this.temp, 2);
  this.e3 = Math.sqrt(this.es);

  this.sin_po = Math.sin(this.lat1);
  this.cos_po = Math.cos(this.lat1);
  this.t1 = this.sin_po;
  this.con = this.sin_po;
  this.ms1 = msfnz(this.e3, this.sin_po, this.cos_po);
  this.qs1 = qsfnz(this.e3, this.sin_po, this.cos_po);

  this.sin_po = Math.sin(this.lat2);
  this.cos_po = Math.cos(this.lat2);
  this.t2 = this.sin_po;
  this.ms2 = msfnz(this.e3, this.sin_po, this.cos_po);
  this.qs2 = qsfnz(this.e3, this.sin_po, this.cos_po);

  this.sin_po = Math.sin(this.lat0);
  this.cos_po = Math.cos(this.lat0);
  this.t3 = this.sin_po;
  this.qs0 = qsfnz(this.e3, this.sin_po, this.cos_po);

  if (Math.abs(this.lat1 - this.lat2) > EPSLN) {
    this.ns0 = (this.ms1 * this.ms1 - this.ms2 * this.ms2) / (this.qs2 - this.qs1);
  }
  else {
    this.ns0 = this.con;
  }
  this.c = this.ms1 * this.ms1 + this.ns0 * this.qs1;
  this.rh = this.a * Math.sqrt(this.c - this.ns0 * this.qs0) / this.ns0;
}

/* Albers Conical Equal Area forward equations--mapping lat,long to x,y
  -------------------------------------------------------------------*/
function aea_forward(p) {

  var lon = p.x;
  var lat = p.y;

  this.sin_phi = Math.sin(lat);
  this.cos_phi = Math.cos(lat);

  var qs = qsfnz(this.e3, this.sin_phi, this.cos_phi);
  var rh1 = this.a * Math.sqrt(this.c - this.ns0 * qs) / this.ns0;
  var theta = this.ns0 * adjust_lon(lon - this.long0);
  var x = rh1 * Math.sin(theta) + this.x0;
  var y = this.rh - rh1 * Math.cos(theta) + this.y0;

  p.x = x;
  p.y = y;
  return p;
}

function aea_inverse(p) {
  var rh1, qs, con, theta, lon, lat;

  p.x -= this.x0;
  p.y = this.rh - p.y + this.y0;
  if (this.ns0 >= 0) {
    rh1 = Math.sqrt(p.x * p.x + p.y * p.y);
    con = 1;
  }
  else {
    rh1 = -Math.sqrt(p.x * p.x + p.y * p.y);
    con = -1;
  }
  theta = 0;
  if (rh1 !== 0) {
    theta = Math.atan2(con * p.x, con * p.y);
  }
  con = rh1 * this.ns0 / this.a;
  if (this.sphere) {
    lat = Math.asin((this.c - con * con) / (2 * this.ns0));
  }
  else {
    qs = (this.c - con * con) / this.ns0;
    lat = this.phi1z(this.e3, qs);
  }

  lon = adjust_lon(theta / this.ns0 + this.long0);
  p.x = lon;
  p.y = lat;
  return p;
}

/* Function to compute phi1, the latitude for the inverse of the
   Albers Conical Equal-Area projection.
-------------------------------------------*/
function phi1z(eccent, qs) {
  var sinphi, cosphi, con, com, dphi;
  var phi = asinz(0.5 * qs);
  if (eccent < EPSLN) {
    return phi;
  }

  var eccnts = eccent * eccent;
  for (var i = 1; i <= 25; i++) {
    sinphi = Math.sin(phi);
    cosphi = Math.cos(phi);
    con = eccent * sinphi;
    com = 1 - con * con;
    dphi = 0.5 * com * com / cosphi * (qs / (1 - eccnts) - sinphi / com + 0.5 / eccent * Math.log((1 - con) / (1 + con)));
    phi = phi + dphi;
    if (Math.abs(dphi) <= 1e-7) {
      return phi;
    }
  }
  return null;
}

var aea_names = ["Albers_Conic_Equal_Area", "Albers", "aea"];
/* harmony default export */ const aea = ({
  init: aea_init,
  forward: aea_forward,
  inverse: aea_inverse,
  names: aea_names,
  phi1z: phi1z
});

;// CONCATENATED MODULE: ./node_modules/proj4/lib/projections/gnom.js




/*
  reference:
    Wolfram Mathworld "Gnomonic Projection"
    http://mathworld.wolfram.com/GnomonicProjection.html
    Accessed: 12th November 2009
  */
function gnom_init() {

  /* Place parameters in static storage for common use
      -------------------------------------------------*/
  this.sin_p14 = Math.sin(this.lat0);
  this.cos_p14 = Math.cos(this.lat0);
  // Approximation for projecting points to the horizon (infinity)
  this.infinity_dist = 1000 * this.a;
  this.rc = 1;
}

/* Gnomonic forward equations--mapping lat,long to x,y
    ---------------------------------------------------*/
function gnom_forward(p) {
  var sinphi, cosphi; /* sin and cos value        */
  var dlon; /* delta longitude value      */
  var coslon; /* cos of longitude        */
  var ksp; /* scale factor          */
  var g;
  var x, y;
  var lon = p.x;
  var lat = p.y;
  /* Forward equations
      -----------------*/
  dlon = adjust_lon(lon - this.long0);

  sinphi = Math.sin(lat);
  cosphi = Math.cos(lat);

  coslon = Math.cos(dlon);
  g = this.sin_p14 * sinphi + this.cos_p14 * cosphi * coslon;
  ksp = 1;
  if ((g > 0) || (Math.abs(g) <= EPSLN)) {
    x = this.x0 + this.a * ksp * cosphi * Math.sin(dlon) / g;
    y = this.y0 + this.a * ksp * (this.cos_p14 * sinphi - this.sin_p14 * cosphi * coslon) / g;
  }
  else {

    // Point is in the opposing hemisphere and is unprojectable
    // We still need to return a reasonable point, so we project
    // to infinity, on a bearing
    // equivalent to the northern hemisphere equivalent
    // This is a reasonable approximation for short shapes and lines that
    // straddle the horizon.

    x = this.x0 + this.infinity_dist * cosphi * Math.sin(dlon);
    y = this.y0 + this.infinity_dist * (this.cos_p14 * sinphi - this.sin_p14 * cosphi * coslon);

  }
  p.x = x;
  p.y = y;
  return p;
}

function gnom_inverse(p) {
  var rh; /* Rho */
  var sinc, cosc;
  var c;
  var lon, lat;

  /* Inverse equations
      -----------------*/
  p.x = (p.x - this.x0) / this.a;
  p.y = (p.y - this.y0) / this.a;

  p.x /= this.k0;
  p.y /= this.k0;

  if ((rh = Math.sqrt(p.x * p.x + p.y * p.y))) {
    c = Math.atan2(rh, this.rc);
    sinc = Math.sin(c);
    cosc = Math.cos(c);

    lat = asinz(cosc * this.sin_p14 + (p.y * sinc * this.cos_p14) / rh);
    lon = Math.atan2(p.x * sinc, rh * this.cos_p14 * cosc - p.y * this.sin_p14 * sinc);
    lon = adjust_lon(this.long0 + lon);
  }
  else {
    lat = this.phic0;
    lon = 0;
  }

  p.x = lon;
  p.y = lat;
  return p;
}

var gnom_names = ["gnom"];
/* harmony default export */ const gnom = ({
  init: gnom_init,
  forward: gnom_forward,
  inverse: gnom_inverse,
  names: gnom_names
});

;// CONCATENATED MODULE: ./node_modules/proj4/lib/common/iqsfnz.js


/* harmony default export */ function iqsfnz(eccent, q) {
  var temp = 1 - (1 - eccent * eccent) / (2 * eccent) * Math.log((1 - eccent) / (1 + eccent));
  if (Math.abs(Math.abs(q) - temp) < 1.0E-6) {
    if (q < 0) {
      return (-1 * HALF_PI);
    }
    else {
      return HALF_PI;
    }
  }
  //var phi = 0.5* q/(1-eccent*eccent);
  var phi = Math.asin(0.5 * q);
  var dphi;
  var sin_phi;
  var cos_phi;
  var con;
  for (var i = 0; i < 30; i++) {
    sin_phi = Math.sin(phi);
    cos_phi = Math.cos(phi);
    con = eccent * sin_phi;
    dphi = Math.pow(1 - con * con, 2) / (2 * cos_phi) * (q / (1 - eccent * eccent) - sin_phi / (1 - con * con) + 0.5 / eccent * Math.log((1 - con) / (1 + con)));
    phi += dphi;
    if (Math.abs(dphi) <= 0.0000000001) {
      return phi;
    }
  }

  //console.log("IQSFN-CONV:Latitude failed to converge after 30 iterations");
  return NaN;
}

;// CONCATENATED MODULE: ./node_modules/proj4/lib/projections/cea.js





/*
  reference:
    "Cartographic Projection Procedures for the UNIX Environment-
    A User's Manual" by Gerald I. Evenden,
    USGS Open File Report 90-284and Release 4 Interim Reports (2003)
*/
function cea_init() {
  //no-op
  if (!this.sphere) {
    this.k0 = msfnz(this.e, Math.sin(this.lat_ts), Math.cos(this.lat_ts));
  }
}

/* Cylindrical Equal Area forward equations--mapping lat,long to x,y
    ------------------------------------------------------------*/
function cea_forward(p) {
  var lon = p.x;
  var lat = p.y;
  var x, y;
  /* Forward equations
      -----------------*/
  var dlon = adjust_lon(lon - this.long0);
  if (this.sphere) {
    x = this.x0 + this.a * dlon * Math.cos(this.lat_ts);
    y = this.y0 + this.a * Math.sin(lat) / Math.cos(this.lat_ts);
  }
  else {
    var qs = qsfnz(this.e, Math.sin(lat));
    x = this.x0 + this.a * this.k0 * dlon;
    y = this.y0 + this.a * qs * 0.5 / this.k0;
  }

  p.x = x;
  p.y = y;
  return p;
}

/* Cylindrical Equal Area inverse equations--mapping x,y to lat/long
    ------------------------------------------------------------*/
function cea_inverse(p) {
  p.x -= this.x0;
  p.y -= this.y0;
  var lon, lat;

  if (this.sphere) {
    lon = adjust_lon(this.long0 + (p.x / this.a) / Math.cos(this.lat_ts));
    lat = Math.asin((p.y / this.a) * Math.cos(this.lat_ts));
  }
  else {
    lat = iqsfnz(this.e, 2 * p.y * this.k0 / this.a);
    lon = adjust_lon(this.long0 + p.x / (this.a * this.k0));
  }

  p.x = lon;
  p.y = lat;
  return p;
}

var cea_names = ["cea"];
/* harmony default export */ const cea = ({
  init: cea_init,
  forward: cea_forward,
  inverse: cea_inverse,
  names: cea_names
});

;// CONCATENATED MODULE: ./node_modules/proj4/lib/projections/eqc.js



function eqc_init() {

  this.x0 = this.x0 || 0;
  this.y0 = this.y0 || 0;
  this.lat0 = this.lat0 || 0;
  this.long0 = this.long0 || 0;
  this.lat_ts = this.lat_ts || 0;
  this.title = this.title || "Equidistant Cylindrical (Plate Carre)";

  this.rc = Math.cos(this.lat_ts);
}

// forward equations--mapping lat,long to x,y
// -----------------------------------------------------------------
function eqc_forward(p) {

  var lon = p.x;
  var lat = p.y;

  var dlon = adjust_lon(lon - this.long0);
  var dlat = adjust_lat(lat - this.lat0);
  p.x = this.x0 + (this.a * dlon * this.rc);
  p.y = this.y0 + (this.a * dlat);
  return p;
}

// inverse equations--mapping x,y to lat/long
// -----------------------------------------------------------------
function eqc_inverse(p) {

  var x = p.x;
  var y = p.y;

  p.x = adjust_lon(this.long0 + ((x - this.x0) / (this.a * this.rc)));
  p.y = adjust_lat(this.lat0 + ((y - this.y0) / (this.a)));
  return p;
}

var eqc_names = ["Equirectangular", "Equidistant_Cylindrical", "eqc"];
/* harmony default export */ const eqc = ({
  init: eqc_init,
  forward: eqc_forward,
  inverse: eqc_inverse,
  names: eqc_names
});

;// CONCATENATED MODULE: ./node_modules/proj4/lib/projections/poly.js










var poly_MAX_ITER = 20;

function poly_init() {
  /* Place parameters in static storage for common use
      -------------------------------------------------*/
  this.temp = this.b / this.a;
  this.es = 1 - Math.pow(this.temp, 2); // devait etre dans tmerc.js mais n y est pas donc je commente sinon retour de valeurs nulles
  this.e = Math.sqrt(this.es);
  this.e0 = e0fn(this.es);
  this.e1 = e1fn(this.es);
  this.e2 = e2fn(this.es);
  this.e3 = e3fn(this.es);
  this.ml0 = this.a * mlfn(this.e0, this.e1, this.e2, this.e3, this.lat0); //si que des zeros le calcul ne se fait pas
}

/* Polyconic forward equations--mapping lat,long to x,y
    ---------------------------------------------------*/
function poly_forward(p) {
  var lon = p.x;
  var lat = p.y;
  var x, y, el;
  var dlon = adjust_lon(lon - this.long0);
  el = dlon * Math.sin(lat);
  if (this.sphere) {
    if (Math.abs(lat) <= EPSLN) {
      x = this.a * dlon;
      y = -1 * this.a * this.lat0;
    }
    else {
      x = this.a * Math.sin(el) / Math.tan(lat);
      y = this.a * (adjust_lat(lat - this.lat0) + (1 - Math.cos(el)) / Math.tan(lat));
    }
  }
  else {
    if (Math.abs(lat) <= EPSLN) {
      x = this.a * dlon;
      y = -1 * this.ml0;
    }
    else {
      var nl = gN(this.a, this.e, Math.sin(lat)) / Math.tan(lat);
      x = nl * Math.sin(el);
      y = this.a * mlfn(this.e0, this.e1, this.e2, this.e3, lat) - this.ml0 + nl * (1 - Math.cos(el));
    }

  }
  p.x = x + this.x0;
  p.y = y + this.y0;
  return p;
}

/* Inverse equations
  -----------------*/
function poly_inverse(p) {
  var lon, lat, x, y, i;
  var al, bl;
  var phi, dphi;
  x = p.x - this.x0;
  y = p.y - this.y0;

  if (this.sphere) {
    if (Math.abs(y + this.a * this.lat0) <= EPSLN) {
      lon = adjust_lon(x / this.a + this.long0);
      lat = 0;
    }
    else {
      al = this.lat0 + y / this.a;
      bl = x * x / this.a / this.a + al * al;
      phi = al;
      var tanphi;
      for (i = poly_MAX_ITER; i; --i) {
        tanphi = Math.tan(phi);
        dphi = -1 * (al * (phi * tanphi + 1) - phi - 0.5 * (phi * phi + bl) * tanphi) / ((phi - al) / tanphi - 1);
        phi += dphi;
        if (Math.abs(dphi) <= EPSLN) {
          lat = phi;
          break;
        }
      }
      lon = adjust_lon(this.long0 + (Math.asin(x * Math.tan(phi) / this.a)) / Math.sin(lat));
    }
  }
  else {
    if (Math.abs(y + this.ml0) <= EPSLN) {
      lat = 0;
      lon = adjust_lon(this.long0 + x / this.a);
    }
    else {

      al = (this.ml0 + y) / this.a;
      bl = x * x / this.a / this.a + al * al;
      phi = al;
      var cl, mln, mlnp, ma;
      var con;
      for (i = poly_MAX_ITER; i; --i) {
        con = this.e * Math.sin(phi);
        cl = Math.sqrt(1 - con * con) * Math.tan(phi);
        mln = this.a * mlfn(this.e0, this.e1, this.e2, this.e3, phi);
        mlnp = this.e0 - 2 * this.e1 * Math.cos(2 * phi) + 4 * this.e2 * Math.cos(4 * phi) - 6 * this.e3 * Math.cos(6 * phi);
        ma = mln / this.a;
        dphi = (al * (cl * ma + 1) - ma - 0.5 * cl * (ma * ma + bl)) / (this.es * Math.sin(2 * phi) * (ma * ma + bl - 2 * al * ma) / (4 * cl) + (al - ma) * (cl * mlnp - 2 / Math.sin(2 * phi)) - mlnp);
        phi -= dphi;
        if (Math.abs(dphi) <= EPSLN) {
          lat = phi;
          break;
        }
      }

      //lat=phi4z(this.e,this.e0,this.e1,this.e2,this.e3,al,bl,0,0);
      cl = Math.sqrt(1 - this.es * Math.pow(Math.sin(lat), 2)) * Math.tan(lat);
      lon = adjust_lon(this.long0 + Math.asin(x * cl / this.a) / Math.sin(lat));
    }
  }

  p.x = lon;
  p.y = lat;
  return p;
}

var poly_names = ["Polyconic", "poly"];
/* harmony default export */ const poly = ({
  init: poly_init,
  forward: poly_forward,
  inverse: poly_inverse,
  names: poly_names
});

;// CONCATENATED MODULE: ./node_modules/proj4/lib/projections/nzmg.js


/*
  reference
    Department of Land and Survey Technical Circular 1973/32
      http://www.linz.govt.nz/docs/miscellaneous/nz-map-definition.pdf
    OSG Technical Report 4.1
      http://www.linz.govt.nz/docs/miscellaneous/nzmg.pdf
  */

/**
 * iterations: Number of iterations to refine inverse transform.
 *     0 -> km accuracy
 *     1 -> m accuracy -- suitable for most mapping applications
 *     2 -> mm accuracy
 */
var iterations = 1;

function nzmg_init() {
  this.A = [];
  this.A[1] = 0.6399175073;
  this.A[2] = -0.1358797613;
  this.A[3] = 0.063294409;
  this.A[4] = -0.02526853;
  this.A[5] = 0.0117879;
  this.A[6] = -0.0055161;
  this.A[7] = 0.0026906;
  this.A[8] = -0.001333;
  this.A[9] = 0.00067;
  this.A[10] = -0.00034;

  this.B_re = [];
  this.B_im = [];
  this.B_re[1] = 0.7557853228;
  this.B_im[1] = 0;
  this.B_re[2] = 0.249204646;
  this.B_im[2] = 0.003371507;
  this.B_re[3] = -0.001541739;
  this.B_im[3] = 0.041058560;
  this.B_re[4] = -0.10162907;
  this.B_im[4] = 0.01727609;
  this.B_re[5] = -0.26623489;
  this.B_im[5] = -0.36249218;
  this.B_re[6] = -0.6870983;
  this.B_im[6] = -1.1651967;

  this.C_re = [];
  this.C_im = [];
  this.C_re[1] = 1.3231270439;
  this.C_im[1] = 0;
  this.C_re[2] = -0.577245789;
  this.C_im[2] = -0.007809598;
  this.C_re[3] = 0.508307513;
  this.C_im[3] = -0.112208952;
  this.C_re[4] = -0.15094762;
  this.C_im[4] = 0.18200602;
  this.C_re[5] = 1.01418179;
  this.C_im[5] = 1.64497696;
  this.C_re[6] = 1.9660549;
  this.C_im[6] = 2.5127645;

  this.D = [];
  this.D[1] = 1.5627014243;
  this.D[2] = 0.5185406398;
  this.D[3] = -0.03333098;
  this.D[4] = -0.1052906;
  this.D[5] = -0.0368594;
  this.D[6] = 0.007317;
  this.D[7] = 0.01220;
  this.D[8] = 0.00394;
  this.D[9] = -0.0013;
}

/**
    New Zealand Map Grid Forward  - long/lat to x/y
    long/lat in radians
  */
function nzmg_forward(p) {
  var n;
  var lon = p.x;
  var lat = p.y;

  var delta_lat = lat - this.lat0;
  var delta_lon = lon - this.long0;

  // 1. Calculate d_phi and d_psi    ...                          // and d_lambda
  // For this algorithm, delta_latitude is in seconds of arc x 10-5, so we need to scale to those units. Longitude is radians.
  var d_phi = delta_lat / SEC_TO_RAD * 1E-5;
  var d_lambda = delta_lon;
  var d_phi_n = 1; // d_phi^0

  var d_psi = 0;
  for (n = 1; n <= 10; n++) {
    d_phi_n = d_phi_n * d_phi;
    d_psi = d_psi + this.A[n] * d_phi_n;
  }

  // 2. Calculate theta
  var th_re = d_psi;
  var th_im = d_lambda;

  // 3. Calculate z
  var th_n_re = 1;
  var th_n_im = 0; // theta^0
  var th_n_re1;
  var th_n_im1;

  var z_re = 0;
  var z_im = 0;
  for (n = 1; n <= 6; n++) {
    th_n_re1 = th_n_re * th_re - th_n_im * th_im;
    th_n_im1 = th_n_im * th_re + th_n_re * th_im;
    th_n_re = th_n_re1;
    th_n_im = th_n_im1;
    z_re = z_re + this.B_re[n] * th_n_re - this.B_im[n] * th_n_im;
    z_im = z_im + this.B_im[n] * th_n_re + this.B_re[n] * th_n_im;
  }

  // 4. Calculate easting and northing
  p.x = (z_im * this.a) + this.x0;
  p.y = (z_re * this.a) + this.y0;

  return p;
}

/**
    New Zealand Map Grid Inverse  -  x/y to long/lat
  */
function nzmg_inverse(p) {
  var n;
  var x = p.x;
  var y = p.y;

  var delta_x = x - this.x0;
  var delta_y = y - this.y0;

  // 1. Calculate z
  var z_re = delta_y / this.a;
  var z_im = delta_x / this.a;

  // 2a. Calculate theta - first approximation gives km accuracy
  var z_n_re = 1;
  var z_n_im = 0; // z^0
  var z_n_re1;
  var z_n_im1;

  var th_re = 0;
  var th_im = 0;
  for (n = 1; n <= 6; n++) {
    z_n_re1 = z_n_re * z_re - z_n_im * z_im;
    z_n_im1 = z_n_im * z_re + z_n_re * z_im;
    z_n_re = z_n_re1;
    z_n_im = z_n_im1;
    th_re = th_re + this.C_re[n] * z_n_re - this.C_im[n] * z_n_im;
    th_im = th_im + this.C_im[n] * z_n_re + this.C_re[n] * z_n_im;
  }

  // 2b. Iterate to refine the accuracy of the calculation
  //        0 iterations gives km accuracy
  //        1 iteration gives m accuracy -- good enough for most mapping applications
  //        2 iterations bives mm accuracy
  for (var i = 0; i < this.iterations; i++) {
    var th_n_re = th_re;
    var th_n_im = th_im;
    var th_n_re1;
    var th_n_im1;

    var num_re = z_re;
    var num_im = z_im;
    for (n = 2; n <= 6; n++) {
      th_n_re1 = th_n_re * th_re - th_n_im * th_im;
      th_n_im1 = th_n_im * th_re + th_n_re * th_im;
      th_n_re = th_n_re1;
      th_n_im = th_n_im1;
      num_re = num_re + (n - 1) * (this.B_re[n] * th_n_re - this.B_im[n] * th_n_im);
      num_im = num_im + (n - 1) * (this.B_im[n] * th_n_re + this.B_re[n] * th_n_im);
    }

    th_n_re = 1;
    th_n_im = 0;
    var den_re = this.B_re[1];
    var den_im = this.B_im[1];
    for (n = 2; n <= 6; n++) {
      th_n_re1 = th_n_re * th_re - th_n_im * th_im;
      th_n_im1 = th_n_im * th_re + th_n_re * th_im;
      th_n_re = th_n_re1;
      th_n_im = th_n_im1;
      den_re = den_re + n * (this.B_re[n] * th_n_re - this.B_im[n] * th_n_im);
      den_im = den_im + n * (this.B_im[n] * th_n_re + this.B_re[n] * th_n_im);
    }

    // Complex division
    var den2 = den_re * den_re + den_im * den_im;
    th_re = (num_re * den_re + num_im * den_im) / den2;
    th_im = (num_im * den_re - num_re * den_im) / den2;
  }

  // 3. Calculate d_phi              ...                                    // and d_lambda
  var d_psi = th_re;
  var d_lambda = th_im;
  var d_psi_n = 1; // d_psi^0

  var d_phi = 0;
  for (n = 1; n <= 9; n++) {
    d_psi_n = d_psi_n * d_psi;
    d_phi = d_phi + this.D[n] * d_psi_n;
  }

  // 4. Calculate latitude and longitude
  // d_phi is calcuated in second of arc * 10^-5, so we need to scale back to radians. d_lambda is in radians.
  var lat = this.lat0 + (d_phi * SEC_TO_RAD * 1E5);
  var lon = this.long0 + d_lambda;

  p.x = lon;
  p.y = lat;

  return p;
}

var nzmg_names = ["New_Zealand_Map_Grid", "nzmg"];
/* harmony default export */ const nzmg = ({
  init: nzmg_init,
  forward: nzmg_forward,
  inverse: nzmg_inverse,
  names: nzmg_names
});

;// CONCATENATED MODULE: ./node_modules/proj4/lib/projections/mill.js


/*
  reference
    "New Equal-Area Map Projections for Noncircular Regions", John P. Snyder,
    The American Cartographer, Vol 15, No. 4, October 1988, pp. 341-355.
  */


/* Initialize the Miller Cylindrical projection
  -------------------------------------------*/
function mill_init() {
  //no-op
}

/* Miller Cylindrical forward equations--mapping lat,long to x,y
    ------------------------------------------------------------*/
function mill_forward(p) {
  var lon = p.x;
  var lat = p.y;
  /* Forward equations
      -----------------*/
  var dlon = adjust_lon(lon - this.long0);
  var x = this.x0 + this.a * dlon;
  var y = this.y0 + this.a * Math.log(Math.tan((Math.PI / 4) + (lat / 2.5))) * 1.25;

  p.x = x;
  p.y = y;
  return p;
}

/* Miller Cylindrical inverse equations--mapping x,y to lat/long
    ------------------------------------------------------------*/
function mill_inverse(p) {
  p.x -= this.x0;
  p.y -= this.y0;

  var lon = adjust_lon(this.long0 + p.x / this.a);
  var lat = 2.5 * (Math.atan(Math.exp(0.8 * p.y / this.a)) - Math.PI / 4);

  p.x = lon;
  p.y = lat;
  return p;
}

var mill_names = ["Miller_Cylindrical", "mill"];
/* harmony default export */ const mill = ({
  init: mill_init,
  forward: mill_forward,
  inverse: mill_inverse,
  names: mill_names
});

;// CONCATENATED MODULE: ./node_modules/proj4/lib/projections/sinu.js



var sinu_MAX_ITER = 20;







function sinu_init() {
  /* Place parameters in static storage for common use
    -------------------------------------------------*/


  if (!this.sphere) {
    this.en = pj_enfn(this.es);
  }
  else {
    this.n = 1;
    this.m = 0;
    this.es = 0;
    this.C_y = Math.sqrt((this.m + 1) / this.n);
    this.C_x = this.C_y / (this.m + 1);
  }

}

/* Sinusoidal forward equations--mapping lat,long to x,y
  -----------------------------------------------------*/
function sinu_forward(p) {
  var x, y;
  var lon = p.x;
  var lat = p.y;
  /* Forward equations
    -----------------*/
  lon = adjust_lon(lon - this.long0);

  if (this.sphere) {
    if (!this.m) {
      lat = this.n !== 1 ? Math.asin(this.n * Math.sin(lat)) : lat;
    }
    else {
      var k = this.n * Math.sin(lat);
      for (var i = sinu_MAX_ITER; i; --i) {
        var V = (this.m * lat + Math.sin(lat) - k) / (this.m + Math.cos(lat));
        lat -= V;
        if (Math.abs(V) < EPSLN) {
          break;
        }
      }
    }
    x = this.a * this.C_x * lon * (this.m + Math.cos(lat));
    y = this.a * this.C_y * lat;

  }
  else {

    var s = Math.sin(lat);
    var c = Math.cos(lat);
    y = this.a * pj_mlfn(lat, s, c, this.en);
    x = this.a * lon * c / Math.sqrt(1 - this.es * s * s);
  }

  p.x = x;
  p.y = y;
  return p;
}

function sinu_inverse(p) {
  var lat, temp, lon, s;

  p.x -= this.x0;
  lon = p.x / this.a;
  p.y -= this.y0;
  lat = p.y / this.a;

  if (this.sphere) {
    lat /= this.C_y;
    lon = lon / (this.C_x * (this.m + Math.cos(lat)));
    if (this.m) {
      lat = asinz((this.m * lat + Math.sin(lat)) / this.n);
    }
    else if (this.n !== 1) {
      lat = asinz(Math.sin(lat) / this.n);
    }
    lon = adjust_lon(lon + this.long0);
    lat = adjust_lat(lat);
  }
  else {
    lat = pj_inv_mlfn(p.y / this.a, this.es, this.en);
    s = Math.abs(lat);
    if (s < HALF_PI) {
      s = Math.sin(lat);
      temp = this.long0 + p.x * Math.sqrt(1 - this.es * s * s) / (this.a * Math.cos(lat));
      //temp = this.long0 + p.x / (this.a * Math.cos(lat));
      lon = adjust_lon(temp);
    }
    else if ((s - EPSLN) < HALF_PI) {
      lon = this.long0;
    }
  }
  p.x = lon;
  p.y = lat;
  return p;
}

var sinu_names = ["Sinusoidal", "sinu"];
/* harmony default export */ const sinu = ({
  init: sinu_init,
  forward: sinu_forward,
  inverse: sinu_inverse,
  names: sinu_names
});

;// CONCATENATED MODULE: ./node_modules/proj4/lib/projections/moll.js

function moll_init() {}

/* Mollweide forward equations--mapping lat,long to x,y
    ----------------------------------------------------*/
function moll_forward(p) {

  /* Forward equations
      -----------------*/
  var lon = p.x;
  var lat = p.y;

  var delta_lon = adjust_lon(lon - this.long0);
  var theta = lat;
  var con = Math.PI * Math.sin(lat);

  /* Iterate using the Newton-Raphson method to find theta
      -----------------------------------------------------*/
  while (true) {
    var delta_theta = -(theta + Math.sin(theta) - con) / (1 + Math.cos(theta));
    theta += delta_theta;
    if (Math.abs(delta_theta) < EPSLN) {
      break;
    }
  }
  theta /= 2;

  /* If the latitude is 90 deg, force the x coordinate to be "0 + false easting"
       this is done here because of precision problems with "cos(theta)"
       --------------------------------------------------------------------------*/
  if (Math.PI / 2 - Math.abs(lat) < EPSLN) {
    delta_lon = 0;
  }
  var x = 0.900316316158 * this.a * delta_lon * Math.cos(theta) + this.x0;
  var y = 1.4142135623731 * this.a * Math.sin(theta) + this.y0;

  p.x = x;
  p.y = y;
  return p;
}

function moll_inverse(p) {
  var theta;
  var arg;

  /* Inverse equations
      -----------------*/
  p.x -= this.x0;
  p.y -= this.y0;
  arg = p.y / (1.4142135623731 * this.a);

  /* Because of division by zero problems, 'arg' can not be 1.  Therefore
       a number very close to one is used instead.
       -------------------------------------------------------------------*/
  if (Math.abs(arg) > 0.999999999999) {
    arg = 0.999999999999;
  }
  theta = Math.asin(arg);
  var lon = adjust_lon(this.long0 + (p.x / (0.900316316158 * this.a * Math.cos(theta))));
  if (lon < (-Math.PI)) {
    lon = -Math.PI;
  }
  if (lon > Math.PI) {
    lon = Math.PI;
  }
  arg = (2 * theta + Math.sin(2 * theta)) / Math.PI;
  if (Math.abs(arg) > 1) {
    arg = 1;
  }
  var lat = Math.asin(arg);

  p.x = lon;
  p.y = lat;
  return p;
}

var moll_names = ["Mollweide", "moll"];
/* harmony default export */ const moll = ({
  init: moll_init,
  forward: moll_forward,
  inverse: moll_inverse,
  names: moll_names
});

;// CONCATENATED MODULE: ./node_modules/proj4/lib/projections/eqdc.js











function eqdc_init() {

  /* Place parameters in static storage for common use
      -------------------------------------------------*/
  // Standard Parallels cannot be equal and on opposite sides of the equator
  if (Math.abs(this.lat1 + this.lat2) < EPSLN) {
    return;
  }
  this.lat2 = this.lat2 || this.lat1;
  this.temp = this.b / this.a;
  this.es = 1 - Math.pow(this.temp, 2);
  this.e = Math.sqrt(this.es);
  this.e0 = e0fn(this.es);
  this.e1 = e1fn(this.es);
  this.e2 = e2fn(this.es);
  this.e3 = e3fn(this.es);

  this.sinphi = Math.sin(this.lat1);
  this.cosphi = Math.cos(this.lat1);

  this.ms1 = msfnz(this.e, this.sinphi, this.cosphi);
  this.ml1 = mlfn(this.e0, this.e1, this.e2, this.e3, this.lat1);

  if (Math.abs(this.lat1 - this.lat2) < EPSLN) {
    this.ns = this.sinphi;
  }
  else {
    this.sinphi = Math.sin(this.lat2);
    this.cosphi = Math.cos(this.lat2);
    this.ms2 = msfnz(this.e, this.sinphi, this.cosphi);
    this.ml2 = mlfn(this.e0, this.e1, this.e2, this.e3, this.lat2);
    this.ns = (this.ms1 - this.ms2) / (this.ml2 - this.ml1);
  }
  this.g = this.ml1 + this.ms1 / this.ns;
  this.ml0 = mlfn(this.e0, this.e1, this.e2, this.e3, this.lat0);
  this.rh = this.a * (this.g - this.ml0);
}

/* Equidistant Conic forward equations--mapping lat,long to x,y
  -----------------------------------------------------------*/
function eqdc_forward(p) {
  var lon = p.x;
  var lat = p.y;
  var rh1;

  /* Forward equations
      -----------------*/
  if (this.sphere) {
    rh1 = this.a * (this.g - lat);
  }
  else {
    var ml = mlfn(this.e0, this.e1, this.e2, this.e3, lat);
    rh1 = this.a * (this.g - ml);
  }
  var theta = this.ns * adjust_lon(lon - this.long0);
  var x = this.x0 + rh1 * Math.sin(theta);
  var y = this.y0 + this.rh - rh1 * Math.cos(theta);
  p.x = x;
  p.y = y;
  return p;
}

/* Inverse equations
  -----------------*/
function eqdc_inverse(p) {
  p.x -= this.x0;
  p.y = this.rh - p.y + this.y0;
  var con, rh1, lat, lon;
  if (this.ns >= 0) {
    rh1 = Math.sqrt(p.x * p.x + p.y * p.y);
    con = 1;
  }
  else {
    rh1 = -Math.sqrt(p.x * p.x + p.y * p.y);
    con = -1;
  }
  var theta = 0;
  if (rh1 !== 0) {
    theta = Math.atan2(con * p.x, con * p.y);
  }

  if (this.sphere) {
    lon = adjust_lon(this.long0 + theta / this.ns);
    lat = adjust_lat(this.g - rh1 / this.a);
    p.x = lon;
    p.y = lat;
    return p;
  }
  else {
    var ml = this.g - rh1 / this.a;
    lat = imlfn(ml, this.e0, this.e1, this.e2, this.e3);
    lon = adjust_lon(this.long0 + theta / this.ns);
    p.x = lon;
    p.y = lat;
    return p;
  }

}

var eqdc_names = ["Equidistant_Conic", "eqdc"];
/* harmony default export */ const eqdc = ({
  init: eqdc_init,
  forward: eqdc_forward,
  inverse: eqdc_inverse,
  names: eqdc_names
});

;// CONCATENATED MODULE: ./node_modules/proj4/lib/projections/vandg.js






/* Initialize the Van Der Grinten projection
  ----------------------------------------*/
function vandg_init() {
  //this.R = 6370997; //Radius of earth
  this.R = this.a;
}

function vandg_forward(p) {

  var lon = p.x;
  var lat = p.y;

  /* Forward equations
    -----------------*/
  var dlon = adjust_lon(lon - this.long0);
  var x, y;

  if (Math.abs(lat) <= EPSLN) {
    x = this.x0 + this.R * dlon;
    y = this.y0;
  }
  var theta = asinz(2 * Math.abs(lat / Math.PI));
  if ((Math.abs(dlon) <= EPSLN) || (Math.abs(Math.abs(lat) - HALF_PI) <= EPSLN)) {
    x = this.x0;
    if (lat >= 0) {
      y = this.y0 + Math.PI * this.R * Math.tan(0.5 * theta);
    }
    else {
      y = this.y0 + Math.PI * this.R * -Math.tan(0.5 * theta);
    }
    //  return(OK);
  }
  var al = 0.5 * Math.abs((Math.PI / dlon) - (dlon / Math.PI));
  var asq = al * al;
  var sinth = Math.sin(theta);
  var costh = Math.cos(theta);

  var g = costh / (sinth + costh - 1);
  var gsq = g * g;
  var m = g * (2 / sinth - 1);
  var msq = m * m;
  var con = Math.PI * this.R * (al * (g - msq) + Math.sqrt(asq * (g - msq) * (g - msq) - (msq + asq) * (gsq - msq))) / (msq + asq);
  if (dlon < 0) {
    con = -con;
  }
  x = this.x0 + con;
  //con = Math.abs(con / (Math.PI * this.R));
  var q = asq + g;
  con = Math.PI * this.R * (m * q - al * Math.sqrt((msq + asq) * (asq + 1) - q * q)) / (msq + asq);
  if (lat >= 0) {
    //y = this.y0 + Math.PI * this.R * Math.sqrt(1 - con * con - 2 * al * con);
    y = this.y0 + con;
  }
  else {
    //y = this.y0 - Math.PI * this.R * Math.sqrt(1 - con * con - 2 * al * con);
    y = this.y0 - con;
  }
  p.x = x;
  p.y = y;
  return p;
}

/* Van Der Grinten inverse equations--mapping x,y to lat/long
  ---------------------------------------------------------*/
function vandg_inverse(p) {
  var lon, lat;
  var xx, yy, xys, c1, c2, c3;
  var a1;
  var m1;
  var con;
  var th1;
  var d;

  /* inverse equations
    -----------------*/
  p.x -= this.x0;
  p.y -= this.y0;
  con = Math.PI * this.R;
  xx = p.x / con;
  yy = p.y / con;
  xys = xx * xx + yy * yy;
  c1 = -Math.abs(yy) * (1 + xys);
  c2 = c1 - 2 * yy * yy + xx * xx;
  c3 = -2 * c1 + 1 + 2 * yy * yy + xys * xys;
  d = yy * yy / c3 + (2 * c2 * c2 * c2 / c3 / c3 / c3 - 9 * c1 * c2 / c3 / c3) / 27;
  a1 = (c1 - c2 * c2 / 3 / c3) / c3;
  m1 = 2 * Math.sqrt(-a1 / 3);
  con = ((3 * d) / a1) / m1;
  if (Math.abs(con) > 1) {
    if (con >= 0) {
      con = 1;
    }
    else {
      con = -1;
    }
  }
  th1 = Math.acos(con) / 3;
  if (p.y >= 0) {
    lat = (-m1 * Math.cos(th1 + Math.PI / 3) - c2 / 3 / c3) * Math.PI;
  }
  else {
    lat = -(-m1 * Math.cos(th1 + Math.PI / 3) - c2 / 3 / c3) * Math.PI;
  }

  if (Math.abs(xx) < EPSLN) {
    lon = this.long0;
  }
  else {
    lon = adjust_lon(this.long0 + Math.PI * (xys - 1 + Math.sqrt(1 + 2 * (xx * xx - yy * yy) + xys * xys)) / 2 / xx);
  }

  p.x = lon;
  p.y = lat;
  return p;
}

var vandg_names = ["Van_der_Grinten_I", "VanDerGrinten", "vandg"];
/* harmony default export */ const vandg = ({
  init: vandg_init,
  forward: vandg_forward,
  inverse: vandg_inverse,
  names: vandg_names
});

;// CONCATENATED MODULE: ./node_modules/proj4/lib/projections/aeqd.js














function aeqd_init() {
  this.sin_p12 = Math.sin(this.lat0);
  this.cos_p12 = Math.cos(this.lat0);
}

function aeqd_forward(p) {
  var lon = p.x;
  var lat = p.y;
  var sinphi = Math.sin(p.y);
  var cosphi = Math.cos(p.y);
  var dlon = adjust_lon(lon - this.long0);
  var e0, e1, e2, e3, Mlp, Ml, tanphi, Nl1, Nl, psi, Az, G, H, GH, Hs, c, kp, cos_c, s, s2, s3, s4, s5;
  if (this.sphere) {
    if (Math.abs(this.sin_p12 - 1) <= EPSLN) {
      //North Pole case
      p.x = this.x0 + this.a * (HALF_PI - lat) * Math.sin(dlon);
      p.y = this.y0 - this.a * (HALF_PI - lat) * Math.cos(dlon);
      return p;
    }
    else if (Math.abs(this.sin_p12 + 1) <= EPSLN) {
      //South Pole case
      p.x = this.x0 + this.a * (HALF_PI + lat) * Math.sin(dlon);
      p.y = this.y0 + this.a * (HALF_PI + lat) * Math.cos(dlon);
      return p;
    }
    else {
      //default case
      cos_c = this.sin_p12 * sinphi + this.cos_p12 * cosphi * Math.cos(dlon);
      c = Math.acos(cos_c);
      kp = c ? c / Math.sin(c) : 1;
      p.x = this.x0 + this.a * kp * cosphi * Math.sin(dlon);
      p.y = this.y0 + this.a * kp * (this.cos_p12 * sinphi - this.sin_p12 * cosphi * Math.cos(dlon));
      return p;
    }
  }
  else {
    e0 = e0fn(this.es);
    e1 = e1fn(this.es);
    e2 = e2fn(this.es);
    e3 = e3fn(this.es);
    if (Math.abs(this.sin_p12 - 1) <= EPSLN) {
      //North Pole case
      Mlp = this.a * mlfn(e0, e1, e2, e3, HALF_PI);
      Ml = this.a * mlfn(e0, e1, e2, e3, lat);
      p.x = this.x0 + (Mlp - Ml) * Math.sin(dlon);
      p.y = this.y0 - (Mlp - Ml) * Math.cos(dlon);
      return p;
    }
    else if (Math.abs(this.sin_p12 + 1) <= EPSLN) {
      //South Pole case
      Mlp = this.a * mlfn(e0, e1, e2, e3, HALF_PI);
      Ml = this.a * mlfn(e0, e1, e2, e3, lat);
      p.x = this.x0 + (Mlp + Ml) * Math.sin(dlon);
      p.y = this.y0 + (Mlp + Ml) * Math.cos(dlon);
      return p;
    }
    else {
      //Default case
      tanphi = sinphi / cosphi;
      Nl1 = gN(this.a, this.e, this.sin_p12);
      Nl = gN(this.a, this.e, sinphi);
      psi = Math.atan((1 - this.es) * tanphi + this.es * Nl1 * this.sin_p12 / (Nl * cosphi));
      Az = Math.atan2(Math.sin(dlon), this.cos_p12 * Math.tan(psi) - this.sin_p12 * Math.cos(dlon));
      if (Az === 0) {
        s = Math.asin(this.cos_p12 * Math.sin(psi) - this.sin_p12 * Math.cos(psi));
      }
      else if (Math.abs(Math.abs(Az) - Math.PI) <= EPSLN) {
        s = -Math.asin(this.cos_p12 * Math.sin(psi) - this.sin_p12 * Math.cos(psi));
      }
      else {
        s = Math.asin(Math.sin(dlon) * Math.cos(psi) / Math.sin(Az));
      }
      G = this.e * this.sin_p12 / Math.sqrt(1 - this.es);
      H = this.e * this.cos_p12 * Math.cos(Az) / Math.sqrt(1 - this.es);
      GH = G * H;
      Hs = H * H;
      s2 = s * s;
      s3 = s2 * s;
      s4 = s3 * s;
      s5 = s4 * s;
      c = Nl1 * s * (1 - s2 * Hs * (1 - Hs) / 6 + s3 / 8 * GH * (1 - 2 * Hs) + s4 / 120 * (Hs * (4 - 7 * Hs) - 3 * G * G * (1 - 7 * Hs)) - s5 / 48 * GH);
      p.x = this.x0 + c * Math.sin(Az);
      p.y = this.y0 + c * Math.cos(Az);
      return p;
    }
  }


}

function aeqd_inverse(p) {
  p.x -= this.x0;
  p.y -= this.y0;
  var rh, z, sinz, cosz, lon, lat, con, e0, e1, e2, e3, Mlp, M, N1, psi, Az, cosAz, tmp, A, B, D, Ee, F, sinpsi;
  if (this.sphere) {
    rh = Math.sqrt(p.x * p.x + p.y * p.y);
    if (rh > (2 * HALF_PI * this.a)) {
      return;
    }
    z = rh / this.a;

    sinz = Math.sin(z);
    cosz = Math.cos(z);

    lon = this.long0;
    if (Math.abs(rh) <= EPSLN) {
      lat = this.lat0;
    }
    else {
      lat = asinz(cosz * this.sin_p12 + (p.y * sinz * this.cos_p12) / rh);
      con = Math.abs(this.lat0) - HALF_PI;
      if (Math.abs(con) <= EPSLN) {
        if (this.lat0 >= 0) {
          lon = adjust_lon(this.long0 + Math.atan2(p.x, - p.y));
        }
        else {
          lon = adjust_lon(this.long0 - Math.atan2(-p.x, p.y));
        }
      }
      else {
        /*con = cosz - this.sin_p12 * Math.sin(lat);
        if ((Math.abs(con) < EPSLN) && (Math.abs(p.x) < EPSLN)) {
          //no-op, just keep the lon value as is
        } else {
          var temp = Math.atan2((p.x * sinz * this.cos_p12), (con * rh));
          lon = adjust_lon(this.long0 + Math.atan2((p.x * sinz * this.cos_p12), (con * rh)));
        }*/
        lon = adjust_lon(this.long0 + Math.atan2(p.x * sinz, rh * this.cos_p12 * cosz - p.y * this.sin_p12 * sinz));
      }
    }

    p.x = lon;
    p.y = lat;
    return p;
  }
  else {
    e0 = e0fn(this.es);
    e1 = e1fn(this.es);
    e2 = e2fn(this.es);
    e3 = e3fn(this.es);
    if (Math.abs(this.sin_p12 - 1) <= EPSLN) {
      //North pole case
      Mlp = this.a * mlfn(e0, e1, e2, e3, HALF_PI);
      rh = Math.sqrt(p.x * p.x + p.y * p.y);
      M = Mlp - rh;
      lat = imlfn(M / this.a, e0, e1, e2, e3);
      lon = adjust_lon(this.long0 + Math.atan2(p.x, - 1 * p.y));
      p.x = lon;
      p.y = lat;
      return p;
    }
    else if (Math.abs(this.sin_p12 + 1) <= EPSLN) {
      //South pole case
      Mlp = this.a * mlfn(e0, e1, e2, e3, HALF_PI);
      rh = Math.sqrt(p.x * p.x + p.y * p.y);
      M = rh - Mlp;

      lat = imlfn(M / this.a, e0, e1, e2, e3);
      lon = adjust_lon(this.long0 + Math.atan2(p.x, p.y));
      p.x = lon;
      p.y = lat;
      return p;
    }
    else {
      //default case
      rh = Math.sqrt(p.x * p.x + p.y * p.y);
      Az = Math.atan2(p.x, p.y);
      N1 = gN(this.a, this.e, this.sin_p12);
      cosAz = Math.cos(Az);
      tmp = this.e * this.cos_p12 * cosAz;
      A = -tmp * tmp / (1 - this.es);
      B = 3 * this.es * (1 - A) * this.sin_p12 * this.cos_p12 * cosAz / (1 - this.es);
      D = rh / N1;
      Ee = D - A * (1 + A) * Math.pow(D, 3) / 6 - B * (1 + 3 * A) * Math.pow(D, 4) / 24;
      F = 1 - A * Ee * Ee / 2 - D * Ee * Ee * Ee / 6;
      psi = Math.asin(this.sin_p12 * Math.cos(Ee) + this.cos_p12 * Math.sin(Ee) * cosAz);
      lon = adjust_lon(this.long0 + Math.asin(Math.sin(Az) * Math.sin(Ee) / Math.cos(psi)));
      sinpsi = Math.sin(psi);
      lat = Math.atan2((sinpsi - this.es * F * this.sin_p12) * Math.tan(psi), sinpsi * (1 - this.es));
      p.x = lon;
      p.y = lat;
      return p;
    }
  }

}

var aeqd_names = ["Azimuthal_Equidistant", "aeqd"];
/* harmony default export */ const aeqd = ({
  init: aeqd_init,
  forward: aeqd_forward,
  inverse: aeqd_inverse,
  names: aeqd_names
});

;// CONCATENATED MODULE: ./node_modules/proj4/lib/projections/ortho.js




function ortho_init() {
  //double temp;      /* temporary variable    */

  /* Place parameters in static storage for common use
      -------------------------------------------------*/
  this.sin_p14 = Math.sin(this.lat0);
  this.cos_p14 = Math.cos(this.lat0);
}

/* Orthographic forward equations--mapping lat,long to x,y
    ---------------------------------------------------*/
function ortho_forward(p) {
  var sinphi, cosphi; /* sin and cos value        */
  var dlon; /* delta longitude value      */
  var coslon; /* cos of longitude        */
  var ksp; /* scale factor          */
  var g, x, y;
  var lon = p.x;
  var lat = p.y;
  /* Forward equations
      -----------------*/
  dlon = adjust_lon(lon - this.long0);

  sinphi = Math.sin(lat);
  cosphi = Math.cos(lat);

  coslon = Math.cos(dlon);
  g = this.sin_p14 * sinphi + this.cos_p14 * cosphi * coslon;
  ksp = 1;
  if ((g > 0) || (Math.abs(g) <= EPSLN)) {
    x = this.a * ksp * cosphi * Math.sin(dlon);
    y = this.y0 + this.a * ksp * (this.cos_p14 * sinphi - this.sin_p14 * cosphi * coslon);
  }
  p.x = x;
  p.y = y;
  return p;
}

function ortho_inverse(p) {
  var rh; /* height above ellipsoid      */
  var z; /* angle          */
  var sinz, cosz; /* sin of z and cos of z      */
  var con;
  var lon, lat;
  /* Inverse equations
      -----------------*/
  p.x -= this.x0;
  p.y -= this.y0;
  rh = Math.sqrt(p.x * p.x + p.y * p.y);
  z = asinz(rh / this.a);

  sinz = Math.sin(z);
  cosz = Math.cos(z);

  lon = this.long0;
  if (Math.abs(rh) <= EPSLN) {
    lat = this.lat0;
    p.x = lon;
    p.y = lat;
    return p;
  }
  lat = asinz(cosz * this.sin_p14 + (p.y * sinz * this.cos_p14) / rh);
  con = Math.abs(this.lat0) - HALF_PI;
  if (Math.abs(con) <= EPSLN) {
    if (this.lat0 >= 0) {
      lon = adjust_lon(this.long0 + Math.atan2(p.x, - p.y));
    }
    else {
      lon = adjust_lon(this.long0 - Math.atan2(-p.x, p.y));
    }
    p.x = lon;
    p.y = lat;
    return p;
  }
  lon = adjust_lon(this.long0 + Math.atan2((p.x * sinz), rh * this.cos_p14 * cosz - p.y * this.sin_p14 * sinz));
  p.x = lon;
  p.y = lat;
  return p;
}

var ortho_names = ["ortho"];
/* harmony default export */ const ortho = ({
  init: ortho_init,
  forward: ortho_forward,
  inverse: ortho_inverse,
  names: ortho_names
});

;// CONCATENATED MODULE: ./node_modules/proj4/lib/projections/qsc.js
// QSC projection rewritten from the original PROJ4
// https://github.com/OSGeo/proj.4/blob/master/src/PJ_qsc.c



/* constants */
var FACE_ENUM = {
    FRONT: 1,
    RIGHT: 2,
    BACK: 3,
    LEFT: 4,
    TOP: 5,
    BOTTOM: 6
};

var AREA_ENUM = {
    AREA_0: 1,
    AREA_1: 2,
    AREA_2: 3,
    AREA_3: 4
};

function qsc_init() {

  this.x0 = this.x0 || 0;
  this.y0 = this.y0 || 0;
  this.lat0 = this.lat0 || 0;
  this.long0 = this.long0 || 0;
  this.lat_ts = this.lat_ts || 0;
  this.title = this.title || "Quadrilateralized Spherical Cube";

  /* Determine the cube face from the center of projection. */
  if (this.lat0 >= HALF_PI - FORTPI / 2.0) {
    this.face = FACE_ENUM.TOP;
  } else if (this.lat0 <= -(HALF_PI - FORTPI / 2.0)) {
    this.face = FACE_ENUM.BOTTOM;
  } else if (Math.abs(this.long0) <= FORTPI) {
    this.face = FACE_ENUM.FRONT;
  } else if (Math.abs(this.long0) <= HALF_PI + FORTPI) {
    this.face = this.long0 > 0.0 ? FACE_ENUM.RIGHT : FACE_ENUM.LEFT;
  } else {
    this.face = FACE_ENUM.BACK;
  }

  /* Fill in useful values for the ellipsoid <-> sphere shift
   * described in [LK12]. */
  if (this.es !== 0) {
    this.one_minus_f = 1 - (this.a - this.b) / this.a;
    this.one_minus_f_squared = this.one_minus_f * this.one_minus_f;
  }
}

// QSC forward equations--mapping lat,long to x,y
// -----------------------------------------------------------------
function qsc_forward(p) {
  var xy = {x: 0, y: 0};
  var lat, lon;
  var theta, phi;
  var t, mu;
  /* nu; */
  var area = {value: 0};

  // move lon according to projection's lon
  p.x -= this.long0;

  /* Convert the geodetic latitude to a geocentric latitude.
   * This corresponds to the shift from the ellipsoid to the sphere
   * described in [LK12]. */
  if (this.es !== 0) {//if (P->es != 0) {
    lat = Math.atan(this.one_minus_f_squared * Math.tan(p.y));
  } else {
    lat = p.y;
  }

  /* Convert the input lat, lon into theta, phi as used by QSC.
   * This depends on the cube face and the area on it.
   * For the top and bottom face, we can compute theta and phi
   * directly from phi, lam. For the other faces, we must use
   * unit sphere cartesian coordinates as an intermediate step. */
  lon = p.x; //lon = lp.lam;
  if (this.face === FACE_ENUM.TOP) {
    phi = HALF_PI - lat;
    if (lon >= FORTPI && lon <= HALF_PI + FORTPI) {
      area.value = AREA_ENUM.AREA_0;
      theta = lon - HALF_PI;
    } else if (lon > HALF_PI + FORTPI || lon <= -(HALF_PI + FORTPI)) {
      area.value = AREA_ENUM.AREA_1;
      theta = (lon > 0.0 ? lon - SPI : lon + SPI);
    } else if (lon > -(HALF_PI + FORTPI) && lon <= -FORTPI) {
      area.value = AREA_ENUM.AREA_2;
      theta = lon + HALF_PI;
    } else {
      area.value = AREA_ENUM.AREA_3;
      theta = lon;
    }
  } else if (this.face === FACE_ENUM.BOTTOM) {
    phi = HALF_PI + lat;
    if (lon >= FORTPI && lon <= HALF_PI + FORTPI) {
      area.value = AREA_ENUM.AREA_0;
      theta = -lon + HALF_PI;
    } else if (lon < FORTPI && lon >= -FORTPI) {
      area.value = AREA_ENUM.AREA_1;
      theta = -lon;
    } else if (lon < -FORTPI && lon >= -(HALF_PI + FORTPI)) {
      area.value = AREA_ENUM.AREA_2;
      theta = -lon - HALF_PI;
    } else {
      area.value = AREA_ENUM.AREA_3;
      theta = (lon > 0.0 ? -lon + SPI : -lon - SPI);
    }
  } else {
    var q, r, s;
    var sinlat, coslat;
    var sinlon, coslon;

    if (this.face === FACE_ENUM.RIGHT) {
      lon = qsc_shift_lon_origin(lon, +HALF_PI);
    } else if (this.face === FACE_ENUM.BACK) {
      lon = qsc_shift_lon_origin(lon, +SPI);
    } else if (this.face === FACE_ENUM.LEFT) {
      lon = qsc_shift_lon_origin(lon, -HALF_PI);
    }
    sinlat = Math.sin(lat);
    coslat = Math.cos(lat);
    sinlon = Math.sin(lon);
    coslon = Math.cos(lon);
    q = coslat * coslon;
    r = coslat * sinlon;
    s = sinlat;

    if (this.face === FACE_ENUM.FRONT) {
      phi = Math.acos(q);
      theta = qsc_fwd_equat_face_theta(phi, s, r, area);
    } else if (this.face === FACE_ENUM.RIGHT) {
      phi = Math.acos(r);
      theta = qsc_fwd_equat_face_theta(phi, s, -q, area);
    } else if (this.face === FACE_ENUM.BACK) {
      phi = Math.acos(-q);
      theta = qsc_fwd_equat_face_theta(phi, s, -r, area);
    } else if (this.face === FACE_ENUM.LEFT) {
      phi = Math.acos(-r);
      theta = qsc_fwd_equat_face_theta(phi, s, q, area);
    } else {
      /* Impossible */
      phi = theta = 0;
      area.value = AREA_ENUM.AREA_0;
    }
  }

  /* Compute mu and nu for the area of definition.
   * For mu, see Eq. (3-21) in [OL76], but note the typos:
   * compare with Eq. (3-14). For nu, see Eq. (3-38). */
  mu = Math.atan((12 / SPI) * (theta + Math.acos(Math.sin(theta) * Math.cos(FORTPI)) - HALF_PI));
  t = Math.sqrt((1 - Math.cos(phi)) / (Math.cos(mu) * Math.cos(mu)) / (1 - Math.cos(Math.atan(1 / Math.cos(theta)))));

  /* Apply the result to the real area. */
  if (area.value === AREA_ENUM.AREA_1) {
    mu += HALF_PI;
  } else if (area.value === AREA_ENUM.AREA_2) {
    mu += SPI;
  } else if (area.value === AREA_ENUM.AREA_3) {
    mu += 1.5 * SPI;
  }

  /* Now compute x, y from mu and nu */
  xy.x = t * Math.cos(mu);
  xy.y = t * Math.sin(mu);
  xy.x = xy.x * this.a + this.x0;
  xy.y = xy.y * this.a + this.y0;

  p.x = xy.x;
  p.y = xy.y;
  return p;
}

// QSC inverse equations--mapping x,y to lat/long
// -----------------------------------------------------------------
function qsc_inverse(p) {
  var lp = {lam: 0, phi: 0};
  var mu, nu, cosmu, tannu;
  var tantheta, theta, cosphi, phi;
  var t;
  var area = {value: 0};

  /* de-offset */
  p.x = (p.x - this.x0) / this.a;
  p.y = (p.y - this.y0) / this.a;

  /* Convert the input x, y to the mu and nu angles as used by QSC.
   * This depends on the area of the cube face. */
  nu = Math.atan(Math.sqrt(p.x * p.x + p.y * p.y));
  mu = Math.atan2(p.y, p.x);
  if (p.x >= 0.0 && p.x >= Math.abs(p.y)) {
    area.value = AREA_ENUM.AREA_0;
  } else if (p.y >= 0.0 && p.y >= Math.abs(p.x)) {
    area.value = AREA_ENUM.AREA_1;
    mu -= HALF_PI;
  } else if (p.x < 0.0 && -p.x >= Math.abs(p.y)) {
    area.value = AREA_ENUM.AREA_2;
    mu = (mu < 0.0 ? mu + SPI : mu - SPI);
  } else {
    area.value = AREA_ENUM.AREA_3;
    mu += HALF_PI;
  }

  /* Compute phi and theta for the area of definition.
   * The inverse projection is not described in the original paper, but some
   * good hints can be found here (as of 2011-12-14):
   * http://fits.gsfc.nasa.gov/fitsbits/saf.93/saf.9302
   * (search for "Message-Id: <9302181759.AA25477 at fits.cv.nrao.edu>") */
  t = (SPI / 12) * Math.tan(mu);
  tantheta = Math.sin(t) / (Math.cos(t) - (1 / Math.sqrt(2)));
  theta = Math.atan(tantheta);
  cosmu = Math.cos(mu);
  tannu = Math.tan(nu);
  cosphi = 1 - cosmu * cosmu * tannu * tannu * (1 - Math.cos(Math.atan(1 / Math.cos(theta))));
  if (cosphi < -1) {
    cosphi = -1;
  } else if (cosphi > +1) {
    cosphi = +1;
  }

  /* Apply the result to the real area on the cube face.
   * For the top and bottom face, we can compute phi and lam directly.
   * For the other faces, we must use unit sphere cartesian coordinates
   * as an intermediate step. */
  if (this.face === FACE_ENUM.TOP) {
    phi = Math.acos(cosphi);
    lp.phi = HALF_PI - phi;
    if (area.value === AREA_ENUM.AREA_0) {
      lp.lam = theta + HALF_PI;
    } else if (area.value === AREA_ENUM.AREA_1) {
      lp.lam = (theta < 0.0 ? theta + SPI : theta - SPI);
    } else if (area.value === AREA_ENUM.AREA_2) {
      lp.lam = theta - HALF_PI;
    } else /* area.value == AREA_ENUM.AREA_3 */ {
      lp.lam = theta;
    }
  } else if (this.face === FACE_ENUM.BOTTOM) {
    phi = Math.acos(cosphi);
    lp.phi = phi - HALF_PI;
    if (area.value === AREA_ENUM.AREA_0) {
      lp.lam = -theta + HALF_PI;
    } else if (area.value === AREA_ENUM.AREA_1) {
      lp.lam = -theta;
    } else if (area.value === AREA_ENUM.AREA_2) {
      lp.lam = -theta - HALF_PI;
    } else /* area.value == AREA_ENUM.AREA_3 */ {
      lp.lam = (theta < 0.0 ? -theta - SPI : -theta + SPI);
    }
  } else {
    /* Compute phi and lam via cartesian unit sphere coordinates. */
    var q, r, s;
    q = cosphi;
    t = q * q;
    if (t >= 1) {
      s = 0;
    } else {
      s = Math.sqrt(1 - t) * Math.sin(theta);
    }
    t += s * s;
    if (t >= 1) {
      r = 0;
    } else {
      r = Math.sqrt(1 - t);
    }
    /* Rotate q,r,s into the correct area. */
    if (area.value === AREA_ENUM.AREA_1) {
      t = r;
      r = -s;
      s = t;
    } else if (area.value === AREA_ENUM.AREA_2) {
      r = -r;
      s = -s;
    } else if (area.value === AREA_ENUM.AREA_3) {
      t = r;
      r = s;
      s = -t;
    }
    /* Rotate q,r,s into the correct cube face. */
    if (this.face === FACE_ENUM.RIGHT) {
      t = q;
      q = -r;
      r = t;
    } else if (this.face === FACE_ENUM.BACK) {
      q = -q;
      r = -r;
    } else if (this.face === FACE_ENUM.LEFT) {
      t = q;
      q = r;
      r = -t;
    }
    /* Now compute phi and lam from the unit sphere coordinates. */
    lp.phi = Math.acos(-s) - HALF_PI;
    lp.lam = Math.atan2(r, q);
    if (this.face === FACE_ENUM.RIGHT) {
      lp.lam = qsc_shift_lon_origin(lp.lam, -HALF_PI);
    } else if (this.face === FACE_ENUM.BACK) {
      lp.lam = qsc_shift_lon_origin(lp.lam, -SPI);
    } else if (this.face === FACE_ENUM.LEFT) {
      lp.lam = qsc_shift_lon_origin(lp.lam, +HALF_PI);
    }
  }

  /* Apply the shift from the sphere to the ellipsoid as described
   * in [LK12]. */
  if (this.es !== 0) {
    var invert_sign;
    var tanphi, xa;
    invert_sign = (lp.phi < 0 ? 1 : 0);
    tanphi = Math.tan(lp.phi);
    xa = this.b / Math.sqrt(tanphi * tanphi + this.one_minus_f_squared);
    lp.phi = Math.atan(Math.sqrt(this.a * this.a - xa * xa) / (this.one_minus_f * xa));
    if (invert_sign) {
      lp.phi = -lp.phi;
    }
  }

  lp.lam += this.long0;
  p.x = lp.lam;
  p.y = lp.phi;
  return p;
}

/* Helper function for forward projection: compute the theta angle
 * and determine the area number. */
function qsc_fwd_equat_face_theta(phi, y, x, area) {
  var theta;
  if (phi < EPSLN) {
    area.value = AREA_ENUM.AREA_0;
    theta = 0.0;
  } else {
    theta = Math.atan2(y, x);
    if (Math.abs(theta) <= FORTPI) {
      area.value = AREA_ENUM.AREA_0;
    } else if (theta > FORTPI && theta <= HALF_PI + FORTPI) {
      area.value = AREA_ENUM.AREA_1;
      theta -= HALF_PI;
    } else if (theta > HALF_PI + FORTPI || theta <= -(HALF_PI + FORTPI)) {
      area.value = AREA_ENUM.AREA_2;
      theta = (theta >= 0.0 ? theta - SPI : theta + SPI);
    } else {
      area.value = AREA_ENUM.AREA_3;
      theta += HALF_PI;
    }
  }
  return theta;
}

/* Helper function: shift the longitude. */
function qsc_shift_lon_origin(lon, offset) {
  var slon = lon + offset;
  if (slon < -SPI) {
    slon += TWO_PI;
  } else if (slon > +SPI) {
    slon -= TWO_PI;
  }
  return slon;
}

var qsc_names = ["Quadrilateralized Spherical Cube", "Quadrilateralized_Spherical_Cube", "qsc"];
/* harmony default export */ const qsc = ({
  init: qsc_init,
  forward: qsc_forward,
  inverse: qsc_inverse,
  names: qsc_names
});


;// CONCATENATED MODULE: ./node_modules/proj4/lib/projections/robin.js
// Robinson projection
// Based on https://github.com/OSGeo/proj.4/blob/master/src/PJ_robin.c
// Polynomial coeficients from http://article.gmane.org/gmane.comp.gis.proj-4.devel/6039




var COEFS_X = [
    [1.0000, 2.2199e-17, -7.15515e-05, 3.1103e-06],
    [0.9986, -0.000482243, -2.4897e-05, -1.3309e-06],
    [0.9954, -0.00083103, -4.48605e-05, -9.86701e-07],
    [0.9900, -0.00135364, -5.9661e-05, 3.6777e-06],
    [0.9822, -0.00167442, -4.49547e-06, -5.72411e-06],
    [0.9730, -0.00214868, -9.03571e-05, 1.8736e-08],
    [0.9600, -0.00305085, -9.00761e-05, 1.64917e-06],
    [0.9427, -0.00382792, -6.53386e-05, -2.6154e-06],
    [0.9216, -0.00467746, -0.00010457, 4.81243e-06],
    [0.8962, -0.00536223, -3.23831e-05, -5.43432e-06],
    [0.8679, -0.00609363, -0.000113898, 3.32484e-06],
    [0.8350, -0.00698325, -6.40253e-05, 9.34959e-07],
    [0.7986, -0.00755338, -5.00009e-05, 9.35324e-07],
    [0.7597, -0.00798324, -3.5971e-05, -2.27626e-06],
    [0.7186, -0.00851367, -7.01149e-05, -8.6303e-06],
    [0.6732, -0.00986209, -0.000199569, 1.91974e-05],
    [0.6213, -0.010418, 8.83923e-05, 6.24051e-06],
    [0.5722, -0.00906601, 0.000182, 6.24051e-06],
    [0.5322, -0.00677797, 0.000275608, 6.24051e-06]
];

var COEFS_Y = [
    [-5.20417e-18, 0.0124, 1.21431e-18, -8.45284e-11],
    [0.0620, 0.0124, -1.26793e-09, 4.22642e-10],
    [0.1240, 0.0124, 5.07171e-09, -1.60604e-09],
    [0.1860, 0.0123999, -1.90189e-08, 6.00152e-09],
    [0.2480, 0.0124002, 7.10039e-08, -2.24e-08],
    [0.3100, 0.0123992, -2.64997e-07, 8.35986e-08],
    [0.3720, 0.0124029, 9.88983e-07, -3.11994e-07],
    [0.4340, 0.0123893, -3.69093e-06, -4.35621e-07],
    [0.4958, 0.0123198, -1.02252e-05, -3.45523e-07],
    [0.5571, 0.0121916, -1.54081e-05, -5.82288e-07],
    [0.6176, 0.0119938, -2.41424e-05, -5.25327e-07],
    [0.6769, 0.011713, -3.20223e-05, -5.16405e-07],
    [0.7346, 0.0113541, -3.97684e-05, -6.09052e-07],
    [0.7903, 0.0109107, -4.89042e-05, -1.04739e-06],
    [0.8435, 0.0103431, -6.4615e-05, -1.40374e-09],
    [0.8936, 0.00969686, -6.4636e-05, -8.547e-06],
    [0.9394, 0.00840947, -0.000192841, -4.2106e-06],
    [0.9761, 0.00616527, -0.000256, -4.2106e-06],
    [1.0000, 0.00328947, -0.000319159, -4.2106e-06]
];

var FXC = 0.8487;
var FYC = 1.3523;
var C1 = R2D/5; // rad to 5-degree interval
var RC1 = 1/C1;
var NODES = 18;

var poly3_val = function(coefs, x) {
    return coefs[0] + x * (coefs[1] + x * (coefs[2] + x * coefs[3]));
};

var poly3_der = function(coefs, x) {
    return coefs[1] + x * (2 * coefs[2] + x * 3 * coefs[3]);
};

function newton_rapshon(f_df, start, max_err, iters) {
    var x = start;
    for (; iters; --iters) {
        var upd = f_df(x);
        x -= upd;
        if (Math.abs(upd) < max_err) {
            break;
        }
    }
    return x;
}

function robin_init() {
    this.x0 = this.x0 || 0;
    this.y0 = this.y0 || 0;
    this.long0 = this.long0 || 0;
    this.es = 0;
    this.title = this.title || "Robinson";
}

function robin_forward(ll) {
    var lon = adjust_lon(ll.x - this.long0);

    var dphi = Math.abs(ll.y);
    var i = Math.floor(dphi * C1);
    if (i < 0) {
        i = 0;
    } else if (i >= NODES) {
        i = NODES - 1;
    }
    dphi = R2D * (dphi - RC1 * i);
    var xy = {
        x: poly3_val(COEFS_X[i], dphi) * lon,
        y: poly3_val(COEFS_Y[i], dphi)
    };
    if (ll.y < 0) {
        xy.y = -xy.y;
    }

    xy.x = xy.x * this.a * FXC + this.x0;
    xy.y = xy.y * this.a * FYC + this.y0;
    return xy;
}

function robin_inverse(xy) {
    var ll = {
        x: (xy.x - this.x0) / (this.a * FXC),
        y: Math.abs(xy.y - this.y0) / (this.a * FYC)
    };

    if (ll.y >= 1) { // pathologic case
        ll.x /= COEFS_X[NODES][0];
        ll.y = xy.y < 0 ? -HALF_PI : HALF_PI;
    } else {
        // find table interval
        var i = Math.floor(ll.y * NODES);
        if (i < 0) {
            i = 0;
        } else if (i >= NODES) {
            i = NODES - 1;
        }
        for (;;) {
            if (COEFS_Y[i][0] > ll.y) {
                --i;
            } else if (COEFS_Y[i+1][0] <= ll.y) {
                ++i;
            } else {
                break;
            }
        }
        // linear interpolation in 5 degree interval
        var coefs = COEFS_Y[i];
        var t = 5 * (ll.y - coefs[0]) / (COEFS_Y[i+1][0] - coefs[0]);
        // find t so that poly3_val(coefs, t) = ll.y
        t = newton_rapshon(function(x) {
            return (poly3_val(coefs, x) - ll.y) / poly3_der(coefs, x);
        }, t, EPSLN, 100);

        ll.x /= poly3_val(COEFS_X[i], t);
        ll.y = (5 * i + t) * D2R;
        if (xy.y < 0) {
            ll.y = -ll.y;
        }
    }

    ll.x = adjust_lon(ll.x + this.long0);
    return ll;
}

var robin_names = ["Robinson", "robin"];
/* harmony default export */ const robin = ({
  init: robin_init,
  forward: robin_forward,
  inverse: robin_inverse,
  names: robin_names
});

;// CONCATENATED MODULE: ./node_modules/proj4/lib/projections/geocent.js


function geocent_init() {
    this.name = 'geocent';

}

function geocent_forward(p) {
    var point = geodeticToGeocentric(p, this.es, this.a);
    return point;
}

function geocent_inverse(p) {
    var point = geocentricToGeodetic(p, this.es, this.a, this.b);
    return point;
}

var geocent_names = ["Geocentric", 'geocentric', "geocent", "Geocent"];
/* harmony default export */ const geocent = ({
    init: geocent_init,
    forward: geocent_forward,
    inverse: geocent_inverse,
    names: geocent_names
});
;// CONCATENATED MODULE: ./node_modules/proj4/lib/projections/tpers.js

var mode = {
  N_POLE: 0,
  S_POLE: 1,
  EQUIT: 2,
  OBLIQ: 3
};




var params = {
  h:     { def: 100000, num: true },           // default is Karman line, no default in PROJ.7
  azi:   { def: 0, num: true, degrees: true }, // default is North
  tilt:  { def: 0, num: true, degrees: true }, // default is Nadir
  long0: { def: 0, num: true },                // default is Greenwich, conversion to rad is automatic
  lat0:  { def: 0, num: true }                 // default is Equator, conversion to rad is automatic
};

function tpers_init() {
  Object.keys(params).forEach(function (p) {
    if (typeof this[p] === "undefined") {
      this[p] = params[p].def;
    } else if (params[p].num && isNaN(this[p])) {
      throw new Error("Invalid parameter value, must be numeric " + p + " = " + this[p]);
    } else if (params[p].num) {
      this[p] = parseFloat(this[p]);
    }
    if (params[p].degrees) {
      this[p] = this[p] * D2R;
    }
  }.bind(this));

  if (Math.abs((Math.abs(this.lat0) - HALF_PI)) < EPSLN) {
    this.mode = this.lat0 < 0 ? mode.S_POLE : mode.N_POLE;
  } else if (Math.abs(this.lat0) < EPSLN) {
    this.mode = mode.EQUIT;
  } else {
    this.mode = mode.OBLIQ;
    this.sinph0 = Math.sin(this.lat0);
    this.cosph0 = Math.cos(this.lat0);
  }

  this.pn1 = this.h / this.a;  // Normalize relative to the Earth's radius

  if (this.pn1 <= 0 || this.pn1 > 1e10) {
    throw new Error("Invalid height");
  }
  
  this.p = 1 + this.pn1;
  this.rp = 1 / this.p;
  this.h1 = 1 / this.pn1;
  this.pfact = (this.p + 1) * this.h1;
  this.es = 0;

  var omega = this.tilt;
  var gamma = this.azi;
  this.cg = Math.cos(gamma);
  this.sg = Math.sin(gamma);
  this.cw = Math.cos(omega);
  this.sw = Math.sin(omega);
}

function tpers_forward(p) {
  p.x -= this.long0;
  var sinphi = Math.sin(p.y);
  var cosphi = Math.cos(p.y);
  var coslam = Math.cos(p.x);
  var x, y;
  switch (this.mode) {
    case mode.OBLIQ:
      y = this.sinph0 * sinphi + this.cosph0 * cosphi * coslam;
      break;
    case mode.EQUIT:
      y = cosphi * coslam;
      break;
    case mode.S_POLE:
      y = -sinphi;
      break;
    case mode.N_POLE:
      y = sinphi;
      break;
  }
  y = this.pn1 / (this.p - y);
  x = y * cosphi * Math.sin(p.x);

  switch (this.mode) {
    case mode.OBLIQ:
      y *= this.cosph0 * sinphi - this.sinph0 * cosphi * coslam;
      break;
    case mode.EQUIT:
      y *= sinphi;
      break;
    case mode.N_POLE:
      y *= -(cosphi * coslam);
      break;
    case mode.S_POLE:
      y *= cosphi * coslam;
      break;
  }

  // Tilt 
  var yt, ba;
  yt = y * this.cg + x * this.sg;
  ba = 1 / (yt * this.sw * this.h1 + this.cw);
  x = (x * this.cg - y * this.sg) * this.cw * ba;
  y = yt * ba;

  p.x = x * this.a;
  p.y = y * this.a;
  return p;
}

function tpers_inverse(p) {
  p.x /= this.a;
  p.y /= this.a;
  var r = { x: p.x, y: p.y };

  // Un-Tilt
  var bm, bq, yt;
  yt = 1 / (this.pn1 - p.y * this.sw);
  bm = this.pn1 * p.x * yt;
  bq = this.pn1 * p.y * this.cw * yt;
  p.x = bm * this.cg + bq * this.sg;
  p.y = bq * this.cg - bm * this.sg;

  var rh = hypot(p.x, p.y);
  if (Math.abs(rh) < EPSLN) {
    r.x = 0;
    r.y = p.y;
  } else {
    var cosz, sinz;
    sinz = 1 - rh * rh * this.pfact;
    sinz = (this.p - Math.sqrt(sinz)) / (this.pn1 / rh + rh / this.pn1);
    cosz = Math.sqrt(1 - sinz * sinz);
    switch (this.mode) {
      case mode.OBLIQ:
        r.y = Math.asin(cosz * this.sinph0 + p.y * sinz * this.cosph0 / rh);
        p.y = (cosz - this.sinph0 * Math.sin(r.y)) * rh;
        p.x *= sinz * this.cosph0;
        break;
      case mode.EQUIT:
        r.y = Math.asin(p.y * sinz / rh);
        p.y = cosz * rh;
        p.x *= sinz;
        break;
      case mode.N_POLE:
        r.y = Math.asin(cosz);
        p.y = -p.y;
        break;
      case mode.S_POLE:
        r.y = -Math.asin(cosz);
        break;
    }
    r.x = Math.atan2(p.x, p.y);
  }

  p.x = r.x + this.long0;
  p.y = r.y;
  return p;
}

var tpers_names = ["Tilted_Perspective", "tpers"];
/* harmony default export */ const tpers = ({
  init: tpers_init,
  forward: tpers_forward,
  inverse: tpers_inverse,
  names: tpers_names
});

;// CONCATENATED MODULE: ./node_modules/proj4/lib/projections/geos.js


function geos_init() {
    this.flip_axis = (this.sweep === 'x' ? 1 : 0);
    this.h = Number(this.h);
    this.radius_g_1 = this.h / this.a;

    if (this.radius_g_1 <= 0 || this.radius_g_1 > 1e10) {
        throw new Error();
    }

    this.radius_g = 1.0 + this.radius_g_1;
    this.C = this.radius_g * this.radius_g - 1.0;

    if (this.es !== 0.0) {
        var one_es = 1.0 - this.es;
        var rone_es = 1 / one_es;

        this.radius_p = Math.sqrt(one_es);
        this.radius_p2 = one_es;
        this.radius_p_inv2 = rone_es;

        this.shape = 'ellipse'; // Use as a condition in the forward and inverse functions.
    } else {
        this.radius_p = 1.0;
        this.radius_p2 = 1.0;
        this.radius_p_inv2 = 1.0;

        this.shape = 'sphere';  // Use as a condition in the forward and inverse functions.
    }

    if (!this.title) {
        this.title = "Geostationary Satellite View";
    }
}

function geos_forward(p) {
    var lon = p.x;
    var lat = p.y;
    var tmp, v_x, v_y, v_z;
    lon = lon - this.long0;

    if (this.shape === 'ellipse') {
        lat = Math.atan(this.radius_p2 * Math.tan(lat));
        var r = this.radius_p / hypot(this.radius_p * Math.cos(lat), Math.sin(lat));

        v_x = r * Math.cos(lon) * Math.cos(lat);
        v_y = r * Math.sin(lon) * Math.cos(lat);
        v_z = r * Math.sin(lat);

        if (((this.radius_g - v_x) * v_x - v_y * v_y - v_z * v_z * this.radius_p_inv2) < 0.0) {
            p.x = Number.NaN;
            p.y = Number.NaN;
            return p;
        }

        tmp = this.radius_g - v_x;
        if (this.flip_axis) {
            p.x = this.radius_g_1 * Math.atan(v_y / hypot(v_z, tmp));
            p.y = this.radius_g_1 * Math.atan(v_z / tmp);
        } else {
            p.x = this.radius_g_1 * Math.atan(v_y / tmp);
            p.y = this.radius_g_1 * Math.atan(v_z / hypot(v_y, tmp));
        }
    } else if (this.shape === 'sphere') {
        tmp = Math.cos(lat);
        v_x = Math.cos(lon) * tmp;
        v_y = Math.sin(lon) * tmp;
        v_z = Math.sin(lat);
        tmp = this.radius_g - v_x;

        if (this.flip_axis) {
            p.x = this.radius_g_1 * Math.atan(v_y / hypot(v_z, tmp));
            p.y = this.radius_g_1 * Math.atan(v_z / tmp);
        } else {
            p.x = this.radius_g_1 * Math.atan(v_y / tmp);
            p.y = this.radius_g_1 * Math.atan(v_z / hypot(v_y, tmp));
        }
    }
    p.x = p.x * this.a;
    p.y = p.y * this.a;
    return p;
}

function geos_inverse(p) {
    var v_x = -1.0;
    var v_y = 0.0;
    var v_z = 0.0;
    var a, b, det, k;

    p.x = p.x / this.a;
    p.y = p.y / this.a;

    if (this.shape === 'ellipse') {
        if (this.flip_axis) {
            v_z = Math.tan(p.y / this.radius_g_1);
            v_y = Math.tan(p.x / this.radius_g_1) * hypot(1.0, v_z);
        } else {
            v_y = Math.tan(p.x / this.radius_g_1);
            v_z = Math.tan(p.y / this.radius_g_1) * hypot(1.0, v_y);
        }

        var v_zp = v_z / this.radius_p;
        a = v_y * v_y + v_zp * v_zp + v_x * v_x;
        b = 2 * this.radius_g * v_x;
        det = (b * b) - 4 * a * this.C;

        if (det < 0.0) {
            p.x = Number.NaN;
            p.y = Number.NaN;
            return p;
        }

        k = (-b - Math.sqrt(det)) / (2.0 * a);
        v_x = this.radius_g + k * v_x;
        v_y *= k;
        v_z *= k;

        p.x = Math.atan2(v_y, v_x);
        p.y = Math.atan(v_z * Math.cos(p.x) / v_x);
        p.y = Math.atan(this.radius_p_inv2 * Math.tan(p.y));
    } else if (this.shape === 'sphere') {
        if (this.flip_axis) {
            v_z = Math.tan(p.y / this.radius_g_1);
            v_y = Math.tan(p.x / this.radius_g_1) * Math.sqrt(1.0 + v_z * v_z);
        } else {
            v_y = Math.tan(p.x / this.radius_g_1);
            v_z = Math.tan(p.y / this.radius_g_1) * Math.sqrt(1.0 + v_y * v_y);
        }

        a = v_y * v_y + v_z * v_z + v_x * v_x;
        b = 2 * this.radius_g * v_x;
        det = (b * b) - 4 * a * this.C;
        if (det < 0.0) {
            p.x = Number.NaN;
            p.y = Number.NaN;
            return p;
        }

        k = (-b - Math.sqrt(det)) / (2.0 * a);
        v_x = this.radius_g + k * v_x;
        v_y *= k;
        v_z *= k;

        p.x = Math.atan2(v_y, v_x);
        p.y = Math.atan(v_z * Math.cos(p.x) / v_x);
    }
    p.x = p.x + this.long0;
    return p;
}

var geos_names = ["Geostationary Satellite View", "Geostationary_Satellite", "geos"];
/* harmony default export */ const geos = ({
    init: geos_init,
    forward: geos_forward,
    inverse: geos_inverse,
    names: geos_names,
});


;// CONCATENATED MODULE: ./node_modules/proj4/projs.js





























/* harmony default export */ function proj4_projs(proj4){
  proj4.Proj.projections.add(tmerc);
  proj4.Proj.projections.add(etmerc);
  proj4.Proj.projections.add(utm);
  proj4.Proj.projections.add(sterea);
  proj4.Proj.projections.add(stere);
  proj4.Proj.projections.add(somerc);
  proj4.Proj.projections.add(omerc);
  proj4.Proj.projections.add(lcc);
  proj4.Proj.projections.add(krovak);
  proj4.Proj.projections.add(cass);
  proj4.Proj.projections.add(laea);
  proj4.Proj.projections.add(aea);
  proj4.Proj.projections.add(gnom);
  proj4.Proj.projections.add(cea);
  proj4.Proj.projections.add(eqc);
  proj4.Proj.projections.add(poly);
  proj4.Proj.projections.add(nzmg);
  proj4.Proj.projections.add(mill);
  proj4.Proj.projections.add(sinu);
  proj4.Proj.projections.add(moll);
  proj4.Proj.projections.add(eqdc);
  proj4.Proj.projections.add(vandg);
  proj4.Proj.projections.add(aeqd);
  proj4.Proj.projections.add(ortho);
  proj4.Proj.projections.add(qsc);
  proj4.Proj.projections.add(robin);
  proj4.Proj.projections.add(geocent);
  proj4.Proj.projections.add(tpers);
  proj4.Proj.projections.add(geos);
}
;// CONCATENATED MODULE: ./node_modules/proj4/lib/index.js










core.defaultDatum = 'WGS84'; //default datum
core.Proj = Proj;
core.WGS84 = new core.Proj('WGS84');
core.Point = lib_Point;
core.toPoint = toPoint;
core.defs = lib_defs;
core.nadgrid = nadgrid;
core.transform = transform;
core.mgrs = mgrs;
core.version = '__VERSION__';
proj4_projs(core);
/* harmony default export */ const lib = (core);

;// CONCATENATED MODULE: external "ol.geom.Point"
const external_ol_geom_Point_namespaceObject = ol.geom.Point;
var external_ol_geom_Point_default = /*#__PURE__*/__webpack_require__.n(external_ol_geom_Point_namespaceObject);
;// CONCATENATED MODULE: ./src/openlayers/services/QueryService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/












/**
 * @class QueryService
 * @category  iServer Map QueryResults
 * @classdesc å°å¾æ¥è¯¢æå¡ç±»ã
 *            æä¾ï¼èå´æ¥è¯¢ï¼SQL æ¥è¯¢ï¼å ä½æ¥è¯¢ï¼è·ç¦»æ¥è¯¢ã
 * @extends {ServiceBase}
 * @param {string} url - æå¡å°åã
 * @param {Object} options - åæ°ã
 * @param {string} [options.proxy] - æå¡ä»£çå°åã
 * @param {boolean} [options.withCredentials=false] - è¯·æ±æ¯å¦æºå¸¦ cookieã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @example
 *    new QueryService(url)
 *      .queryByBounds(param,function(result){
 *          //doSomething
 *      })
 * @usage
 */
class QueryService_QueryService extends ServiceBase {

    constructor(url, options) {
        super(url, options);
    }

    /**
     * @function QueryService.prototype.queryByBounds
     * @description bounds æ¥è¯¢å°å¾æå¡ã
     * @param {QueryByBoundsParameters} params - Bounds æ¥è¯¢åæ°ç±»ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åç»æç±»åã
     * @returns {QueryService}
     */
    queryByBounds(params, callback, resultFormat) {
        var me = this;
        var queryService = new QueryByBoundsService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            },
            format: me._processFormat(resultFormat)
        });

        queryService.processAsync(me._processParams(params));
    }

    /**
     * @function QueryService.prototype.queryByDistance
     * @description å°å¾è·ç¦»æ¥è¯¢æå¡ã
     * @param {QueryByDistanceParameters} params - Distance æ¥è¯¢åæ°ç±»ã
     * @param {RequestCallback} callback åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åç»æç±»åã
     */
    queryByDistance(params, callback, resultFormat) {
        var me = this;
        var queryByDistanceService = new QueryByDistanceService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            },
            format: me._processFormat(resultFormat)
        });

        queryByDistanceService.processAsync(me._processParams(params));
    }

    /**
     * @function QueryService.prototype.queryBySQL
     * @description å°å¾ SQL æ¥è¯¢æå¡ã
     * @param {QueryBySQLParameters} params - SQL æ¥è¯¢åæ°ç±»ã
     * @param {RequestCallback} callback åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åç»æç±»åã
     */
    queryBySQL(params, callback, resultFormat) {
        var me = this;
        var queryBySQLService = new QueryBySQLService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            },
            format: me._processFormat(resultFormat)
        });

        queryBySQLService.processAsync(me._processParams(params));
    }

    /**
     * @function QueryService.prototype.queryByGeometry
     * @description å°å¾å ä½æ¥è¯¢æå¡ã
     * @param {QueryByGeometryParameters} params - Geometry æ¥è¯¢åæ°ç±»ã
     * @param {RequestCallback} callback åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åç»æç±»åã
     */
    queryByGeometry(params, callback, resultFormat) {
        var me = this;
        var queryByGeometryService = new QueryByGeometryService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            },
            format: me._processFormat(resultFormat)
        });

        queryByGeometryService.processAsync(me._processParams(params));
    }

    _processParams(params) {
        if (!params) {
            return {};
        }
        params.returnContent = (params.returnContent == null) ? true : params.returnContent;
        if (params.queryParams && !core_Util_Util.isArray(params.queryParams)) {
            params.queryParams = [params.queryParams];
        }
        if (params.bounds) {
            params.bounds = new Bounds(
                params.bounds[0],
                params.bounds[1],
                params.bounds[2],
                params.bounds[3]
            );
        }
        if (params.geometry) {
            if (params.geometry instanceof (external_ol_geom_Point_default())) {
                params.geometry = new Point(params.geometry.getCoordinates()[0], params.geometry.getCoordinates()[1]);
            } else {
                params.geometry = core_Util_Util.toSuperMapGeometry(JSON.parse((new (external_ol_format_GeoJSON_default())()).writeGeometry(params.geometry)));
            }
        }
        return params;
    }

    _processFormat(resultFormat) {
        return (resultFormat) ? resultFormat : DataFormat.GEOJSON;
    }
}

;// CONCATENATED MODULE: ./src/openlayers/services/FeatureService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/












/**
 * @class FeatureService
 * @constructs FeatureService
 * @category  iServer Data Feature
 * @classdesc æ°æ®éç±»ãæä¾ï¼ID æ¥è¯¢ï¼èå´æ¥è¯¢ï¼SQLæ¥è¯¢ï¼å ä½æ¥è¯¢ï¼bounds æ¥è¯¢ï¼ç¼å²åºæ¥è¯¢ï¼å°ç©ç¼è¾ã
 * @example
 *      new FeatureService(url).getFeaturesByIDs(param,function(result){
 *          //doSomething
 *      })
 * @param {string} url - æå¡å°åã
 * @param {Object} options - åæ°ã
 * @param {string} [options.proxy] - æå¡ä»£çå°åã
 * @param {boolean} [options.withCredentials=false] - è¯·æ±æ¯å¦æºå¸¦ cookieã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @extends {ServiceBase}
 * @usage
 */
class FeatureService extends ServiceBase {

    constructor(url, options) {
        super(url, options);
    }

    /**
     * @function FeatureService.prototype.getFeaturesByIDs
     * @description æ°æ®é ID æ¥è¯¢æå¡ã
     * @param {GetFeaturesByIDsParameters} params - IDæ¥è¯¢åæ°ç±»ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åçæ°æ®æ ¼å¼ã
     */
    getFeaturesByIDs(params, callback, resultFormat) {
        var me = this;
        var getFeaturesByIDsService = new GetFeaturesByIDsService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                processCompleted: callback,
                processFailed: callback
            },
            format: me._processFormat(resultFormat)
        });
        getFeaturesByIDsService.processAsync(me._processParams(params));

    }

    /**
     * @function FeatureService.prototype.getFeaturesByBounds
     * @description æ°æ®é Bounds æ¥è¯¢æå¡ã
     * @param {GetFeaturesByBoundsParameters} params - æ°æ®éèå´æ¥è¯¢åæ°ç±»ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åçæ°æ®æ ¼å¼ã
     */
    getFeaturesByBounds(params, callback, resultFormat) {
        var me = this;
        var getFeaturesByBoundsService = new GetFeaturesByBoundsService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                processCompleted: callback,
                processFailed: callback
            },
            format: me._processFormat(resultFormat)
        });
        getFeaturesByBoundsService.processAsync(me._processParams(params));
    }

    /**
     * @function FeatureService.prototype.getFeaturesByBuffer
     * @description æ°æ®é Buffer æ¥è¯¢æå¡ã
     * @param {GetFeaturesByBufferParameters} params - æ°æ®éç¼å²åºæ¥è¯¢åæ°ç±»ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åçæ°æ®æ ¼å¼ã
     */
    getFeaturesByBuffer(params, callback, resultFormat) {
        var me = this;
        var getFeatureService = new GetFeaturesByBufferService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                processCompleted: callback,
                processFailed: callback
            },
            format: me._processFormat(resultFormat)
        });
        getFeatureService.processAsync(me._processParams(params));
    }

    /**
     * @function FeatureService.prototype.getFeaturesBySQL
     * @description æ°æ®é SQL æ¥è¯¢æå¡ã
     * @param {GetFeaturesBySQLParameters} params - æ°æ®é SQL æ¥è¯¢åæ°ç±»ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åçæ°æ®æ ¼å¼ã
     */
    getFeaturesBySQL(params, callback, resultFormat) {
        var me = this;
        var getFeatureBySQLService = new GetFeaturesBySQLService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                processCompleted: callback,
                processFailed: callback
            },
            format: me._processFormat(resultFormat)
        });

        getFeatureBySQLService.processAsync(me._processParams(params));
    }

    /**
     * @function FeatureService.prototype.getFeaturesByGeometry
     * @description æ°æ®éå ä½æ¥è¯¢æå¡ç±»ã
     * @param {GetFeaturesByGeometryParameters} params - æ°æ®éå ä½æ¥è¯¢åæ°ç±»ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åçæ°æ®æ ¼å¼ã
     */
    getFeaturesByGeometry(params, callback, resultFormat) {
        var me = this;
        var getFeaturesByGeometryService = new GetFeaturesByGeometryService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                processCompleted: callback,
                processFailed: callback
            },
            format: me._processFormat(resultFormat)
        });
        getFeaturesByGeometryService.processAsync(me._processParams(params));
    }

    /**
     * @function FeatureService.prototype.editFeatures
     * @description å°ç©ç¼è¾æå¡ã
     * @param {EditFeaturesParameters} params - æ°æ®æå¡ä¸­æ°æ®éæ·»å ãä¿®æ¹ãå é¤åæ°ç±»ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     */
    editFeatures(params, callback) {
        if (!params || !params.dataSourceName || !params.dataSetName) {
            return;
        }
        var me = this,
            url = me.url,
            dataSourceName = params.dataSourceName,
            dataSetName = params.dataSetName;
        url = Util.urlPathAppend(url, "datasources/" + dataSourceName + "/datasets/" + dataSetName);

        var editFeatureService = new EditFeaturesService(url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                processCompleted: callback,
                processFailed: callback
            }
        });
        editFeatureService.processAsync(me._processParams(params));
    }

    _processParams(params) {
        if (!params) {
            return {};
        }
        var me = this;
        params.returnContent = (params.returnContent == null) ? true : params.returnContent;
        params.fromIndex = params.fromIndex ? params.fromIndex : 0;
        params.toIndex = params.toIndex ? params.toIndex : -1;
        if (params.bounds) {
            params.bounds = core_Util_Util.toSuperMapBounds(params.bounds);
        }
        if (params.geometry) {
            params.geometry = core_Util_Util.toSuperMapGeometry(JSON.parse((new (external_ol_format_GeoJSON_default())()).writeGeometry(params.geometry)));
        }
        if (params.editType) {
            params.editType = params.editType.toLowerCase();
        }
        if (params.features) {
            var features = [];
            if (core_Util_Util.isArray(params.features)) {
                params.features.map(function (feature) {
                    features.push(me._createServerFeature(feature));
                    return feature;
                });
            } else {
                features.push(me._createServerFeature(params.features));
            }
            params.features = features;
        }
        return params;
    }

    _createServerFeature(geoFeature) {
        var feature = {},
            fieldNames = [],
            fieldValues = [];
        var properties = geoFeature.getProperties();
        for (var key in properties) {
            if (key === geoFeature.getGeometryName()) {
                continue;
            }
            fieldNames.push(key);
            fieldValues.push(properties[key]);
        }
        feature.fieldNames = fieldNames;
        feature.fieldValues = fieldValues;
        if (geoFeature.getId()) {
            feature.id = geoFeature.getId();
        }
        feature.geometry = core_Util_Util.toSuperMapGeometry((new (external_ol_format_GeoJSON_default())()).writeFeatureObject(geoFeature));
        return feature;
    }

    _processFormat(resultFormat) {
        return (resultFormat) ? resultFormat : DataFormat.GEOJSON;
    }
}

;// CONCATENATED MODULE: ./src/openlayers/mapping/webmap/Util.js







function getFeatureProperties(features) {
  let properties = [];
  if (Util_isArray(features) && features.length) {
    features.forEach((feature) => {
      let property = feature.get('attributes');
      property && properties.push(property);
    });
  }
  return properties;
}

function getFeatureBySQL(url, datasetNames, serviceOptions, processCompleted, processFaild, targetEpsgCode) {
  getFeatureBySQLWithConcurrent(url, datasetNames, processCompleted, processFaild, serviceOptions, targetEpsgCode);
}
function queryFeatureBySQL(
  url,
  layerName,
  attributeFilter,
  fields,
  epsgCode,
  processCompleted,
  processFaild,
  startRecord,
  recordLength,
  onlyAttribute
) {
  const queryParam = new FilterParameter({
    name: layerName,
    attributeFilter: attributeFilter
  });
  if (fields) {
    queryParam.fields = fields;
  }
  const params = {
    queryParams: [queryParam]
  };
  if (onlyAttribute) {
    params.queryOption = QueryOption.ATTRIBUTE;
  }
  startRecord && (params.startRecord = startRecord);
  recordLength && (params.expectCount = recordLength);
  if (epsgCode) {
    params.prjCoordSys = {
      epsgCode: epsgCode
    };
  }
  const queryBySQLParams = new QueryBySQLParameters(params);
  const queryBySQLService = new QueryService_QueryService(url);
  queryBySQLService.queryBySQL(queryBySQLParams, function (data) {
    data.type === 'processCompleted' ? processCompleted(data) : processFaild(data);
  });
}

function getFeatureBySQLWithConcurrent(
  url,
  datasetNames,
  processCompleted,
  processFailed,
  serviceOptions,
  targetEpsgCode
) {
  let queryParameter = new FilterParameter({
    name: datasetNames.join().replace(':', '@')
  });

  let maxFeatures = 100, // æ¯æ¬¡è¯·æ±æ°æ®é
    firstResult, // å­å¨æ¯æ¬¡è¯·æ±çç»æ
    allRequest = []; // å­å¨ååºçè¯·æ±Promise

  // åéè¯·æ±è·åè·åæ»æ°æ®é
  _getReasult(url, queryParameter, datasetNames, 0, 1, 1, serviceOptions, targetEpsgCode)
    .then((result) => {
      firstResult = result;
      let totalCount = result.result.totalCount;

      if (totalCount > 1) {
        // å¼å§å¹¶åè¯·æ±
        for (let i = 1; i < totalCount; ) {
          allRequest.push(
            _getReasult(
              url,
              queryParameter,
              datasetNames,
              i,
              i + maxFeatures,
              maxFeatures,
              serviceOptions,
              targetEpsgCode
            )
          );
          i += maxFeatures;
        }
        // ææè¯·æ±ç»æ
        Promise.all(allRequest)
          .then((results) => {
            // ç»æåå¹¶
            results.forEach((result) => {
              if (result.type === 'processCompleted' && result.result.features && result.result.features.features) {
                result.result.features.features.forEach((feature) => {
                  firstResult.result.features.features.push(feature);
                });
              } else {
                // todo æç¤º é¨åæ°æ®è¯·æ±å¤±è´¥
                firstResult.someRequestFailed = true;
              }
            });
            processCompleted(firstResult);
          })
          .catch((error) => {
            processFailed(error);
          });
      } else {
        processCompleted(result);
      }
    })
    .catch((error) => {
      processFailed(error);
    });
}

function _getFeaturesBySQLParameters(
  queryParameter,
  datasetNames,
  fromIndex,
  toIndex,
  maxFeatures,
  targetEpsgCode
) {
  return new GetFeaturesBySQLParameters({
    queryParameter,
    datasetNames,
    fromIndex,
    toIndex,
    maxFeatures,
    returnContent: true,
    targetEpsgCode
  });
}

function _getReasult(
  url,
  queryParameter,
  datasetNames,
  fromIndex,
  toIndex,
  maxFeatures,
  serviceOptions,
  targetEpsgCode
) {
  return new Promise((resolve, reject) => {
    new FeatureService(url, serviceOptions).getFeaturesBySQL(
      _getFeaturesBySQLParameters(queryParameter, datasetNames, fromIndex, toIndex, maxFeatures, targetEpsgCode),
      (result) => {
        let featuresResult = result.result;
        //[bug] wtä»»å¡ç¼å·: 5223
        if (result.type === 'processCompleted' && featuresResult && featuresResult.features) {
          resolve(result);
        } else {
          reject(result);
        }
      }
    );
  });
}

function Util_isArray(obj) {
  return Object.prototype.toString.call(obj) === '[object Array]';
}

;// CONCATENATED MODULE: ./src/openlayers/services/DataFlowService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class DataFlowService
 * @category  iServer DataFlow
 * @classdesc æ°æ®æµæå¡ã
 * @extends {ServiceBase}
 * @example
 *      new DataFlowService(url).queryChart(param,function(result){
 *          //doSomething
 *      })
 * @param {string} url - æå¡å°åã
 * @param {Object} options - åæ°ã
 * @param {string} [options.proxy] - æå¡ä»£çå°åã
 * @param {boolean} [options.withCredentials=false] - è¯·æ±æ¯å¦æºå¸¦ cookieã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @param {GeoJSONObject} [options.geometry] - æå®å ä½èå´ï¼è¯¥èå´åçè¦ç´ æè½è¢«è®¢éã
 * @param {Object} [options.excludeField] - æé¤å­æ®µã
 * @usage
 */
class DataFlowService extends ServiceBase {

    constructor(url, options) {
        options = options || {};
        if (options.projection) {
            options.prjCoordSys = options.projection;
        }
        super(url, options);
        this.dataFlow = new DataFlowService_DataFlowService(url, options);
        this.dataFlow.events.on({
            "broadcastSocketConnected": this._defaultEvent,
            "broadcastSocketError": this._defaultEvent,
            "broadcastFailed": this._defaultEvent,
            "broadcastSucceeded": this._defaultEvent,
            "subscribeSocketConnected": this._defaultEvent,
            "subscribeSocketError": this._defaultEvent,
            "messageSucceeded": this._defaultEvent,
            "setFilterParamSucceeded": this._defaultEvent,
            scope: this
        });
    }

    /**
     * @function DataFlowService.prototype.initBroadcast
     * @description åå§åå¹¿æ­ã
     * @returns {DataFlowService}
     */
    initBroadcast() {
        this.dataFlow.initBroadcast();
        return this;
    }

    /**
     * @function DataFlowService.prototype.broadcast
     * @description å è½½å¹¿æ­æ°æ®ã
     * @param {JSONObject} obj - JSON æ ¼å¼çè¦ç´ æ°æ®ã
     */
    broadcast(obj) {
        this.dataFlow.broadcast(obj);
    }

    /**
     * @function DataFlowService.prototype.initSubscribe
     * @description åå§åè®¢éæ°æ®ã
     */
    initSubscribe() {
        this.dataFlow.initSubscribe();
        return this;
    }

    /**
     * @function DataFlowService.prototype.setExcludeField
     * @description è®¾ç½®æé¤å­æ®µã
     * @param {Object} excludeField - æé¤å­æ®µã
     */
    setExcludeField(excludeField) {
        this.dataFlow.setExcludeField(excludeField);
        this.options.excludeField = excludeField;
        return this;
    }

    /**
     * @function DataFlowService.prototype.setGeometry
     * @description è®¾ç½®æ·»å çå ä½è¦ç´ æ°æ®ã
     * @param {GeoJSONObject} geometry - æå®å ä½èå´ï¼è¯¥èå´åçè¦ç´ æè½è¢«è®¢éã
     */
    setGeometry(geometry) {
        this.dataFlow.setGeometry(geometry);
        this.options.geometry = geometry;
        return this;
    }

    /**
     * @function DataFlowService.prototype.unSubscribe
     * @description ç»æè®¢éæ°æ®ã
     */
    unSubscribe() {
        this.dataFlow.unSubscribe();
    }

    /**
     * @function DataFlowService.prototype.unBroadcast
     * @description ç»æå è½½å¹¿æ­ã
     */
    unBroadcast() {
        this.dataFlow.unBroadcast();
    }

    _defaultEvent(e) {
        this.dispatchEvent({type: e.eventType || e.type, value: e});
    }
}

;// CONCATENATED MODULE: ./src/openlayers/overlay/DataFlow.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class DataFlow
 * @browsernamespace ol.source
 * @category  iServer DataFlow
 * @classdesc æ°æ®æµå¾å±æºãè®¢éSuperMap iServer æ°æ®æµæå¡,å¹¶å°è®¢éå¾å°çæ°æ®æ ¹æ® `options.idField` èªå¨æ´æ°ãä¸ {@link ol.layer.Vector} ç»åä½¿ç¨å¯ä»¥å®ç°SuperMap iServer æ°æ®æµä¸å¾ãæ ¹æ®`options.idField`èªå¨æ´æ°ã
 * @param {Object} opt_options - åæ°ã
 * @param {string} opt_options.ws - SuperMap iServer æ°æ®æµæå¡å°åï¼ä¾å¦ï¼http://localhost:8090/iserver/services/dataflowTest/dataflowã
 * @param {string} [opt_options.idField = 'id'] - è¦ç´ å±æ§ä¸­è¡¨ç¤ºå¯ä¸æ è¯çå­æ®µã
 * @param {GeoJSONObject} [opt_options.geometry] - æå®å ä½èå´ï¼è¯¥èå´åçè¦ç´ æè½è¢«è®¢éã
 * @param {Object} [opt_options.prjCoordSys] - è¯·æ±çå°å¾çåæ åèç³»ç»ãå½æ­¤åæ°è®¾ç½®çåæ ç³»ç»ä¸åäºå°å¾çåæåæ ç³»ç»æ¶ï¼ç³»ç»ä¼è¿è¡å¨ææå½±ï¼å¹¶è¿åå¨ææå½±åçå°å¾ç¦çãä¾å¦ï¼{"epsgCode":3857}ã
 * @param {Object} [opt_options.excludeField] - æé¤å­æ®µ
 * @extends {ol.source.Vector}
 * @example
 * var source = new DataFlow({
 *   ws: urlDataFlow,
 *   idField:"objectId"
 * });
 * var layer = new ol.layer.Vector({
 *    source: source,
 * });
 * @usage
 */
class DataFlow extends (external_ol_source_Vector_default()) {
    constructor(opt_options) {
        var options = opt_options ? opt_options : {};
        super(options);
        this.idField = options.idField || "id";
        this.dataService = new DataFlowService(options.ws, {
            geometry: options.geometry,
            prjCoordSys: options.prjCoordSys,
            excludeField: options.excludeField
        }).initSubscribe();
        var me = this;
        me.dataService.on("subscribeSocketConnected", function(e) {
            me.dispatchEvent({
                type: "subscribeSucceeded",
                value: e
            });
        });
        me.dataService.on("messageSucceeded", function(msg) {
            me._onMessageSuccessed(msg);
        });
        me.dataService.on("setFilterParamSucceeded", function(msg) {
            me.dispatchEvent({
                type: "setFilterParamSucceeded",
                value: msg
            });
        });
        this.featureCache = {};
    }

    // /**
    //  * @function DataFlow.prototype.setPrjCoordSys
    //  * @description è®¾ç½®åæ åèç³»ã
    //  * @param {Object} prjCoordSys - åèç³»ã
    //  */
    // setPrjCoordSys(prjCoordSys) {
    //     this.dataService.setPrjCoordSys(prjCoordSys);
    //     this.prjCoordSys = prjCoordSys;
    //     return this;
    // }

    /**
     * @function DataFlow.prototype.setExcludeField
     * @description è®¾ç½®å¯ä¸å­æ®µã
     * @param {Object} excludeField - æé¤å­æ®µã
     */
    setExcludeField(excludeField) {
        this.dataService.setExcludeField(excludeField);
        this.excludeField = excludeField;
        return this;
    }

    /**
     * @function DataFlow.prototype.setGeometry
     * @description è®¾ç½®å ä½å¾å½¢ã
     * @param {Object} geometry - è¦ç´ å¾å½¢ã
     */
    setGeometry(geometry) {
        this.dataService.setGeometry(geometry);
        this.geometry = geometry;
        return this;
    }

    _onMessageSuccessed(msg) {
        //this.clear();

        var feature = new (external_ol_format_GeoJSON_default())().readFeature(msg.value.featureResult);

        var geoID = feature.get(this.idField);
        if (geoID !== undefined && this.featureCache[geoID]) {
            this.featureCache[geoID].setGeometry(feature.getGeometry());
            this.featureCache[geoID].setProperties(feature.getProperties());
            this.changed();
        } else {
            this.addFeature(feature);
            this.featureCache[geoID] = feature;
        }
        this.dispatchEvent({
            type: "dataupdated",
            value: {
                source: this,
                data: feature
            }
        });
    }
}

;// CONCATENATED MODULE: ./src/openlayers/overlay/theme/ThemeFeature.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/







/**
 * @class ThemeFeature
 * @category Visualization Theme
 * @classdesc ä¸é¢å¾è¦ç´ ç±»ã
 * @param {Object} geometry - è¦éç®çå ä½å¯¹è±¡ï¼æ¯æ {@link ol.geom.Geometry} å GeometryGeoText æ ç­¾æ°ç»ç±»å geometry = [x,y,text]ã
 * @param {Object} [attributes] - å±æ§ã
 * @usage
 */
class ThemeFeature {

    constructor(geometry, attributes) {
        this.geometry = geometry;
        this.attributes = attributes;
    }

    /**
     * @function ThemeFeature.prototype.toFeature
     * @description è½¬ä¸ºç¢éè¦ç´ ã
     */
    toFeature() {
        var geometry = this.geometry;
        if (geometry instanceof (external_ol_geom_Geometry_default())) {
            //åææ°æ®å±æ§ä¸è¦ç´ åå¹¶
            let featureOption = this.attributes;
            featureOption.geometry = geometry;
            let olFeature = new (external_ol_Feature_default())(featureOption);
            return new GeoJSON().read((new (external_ol_format_GeoJSON_default())()).writeFeature(olFeature), "Feature");

        } else if (geometry.length === 3) {
            geometry = new GeoText(geometry[0], geometry[1], geometry[2]);
            return new Vector(geometry, this.attributes);
        }

    }
}

;// CONCATENATED MODULE: external "ol.source.ImageCanvas"
const external_ol_source_ImageCanvas_namespaceObject = ol.source.ImageCanvas;
var external_ol_source_ImageCanvas_default = /*#__PURE__*/__webpack_require__.n(external_ol_source_ImageCanvas_namespaceObject);
;// CONCATENATED MODULE: ./src/openlayers/overlay/theme/Theme.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/














/**
 * @class Theme
 * @browsernamespace ol.source
 * @category Visualization Theme
 * @classdesc ä¸é¢å¾åºç±»ã
 * @param {string} name - ä¸é¢å¾å¾å±åç§°ã
 * @param {Object} opt_option - åæ°ã
 * @param {ol.Map} opt_option.map - å½å openlayers ç Map å¯¹è±¡ã
 * @param {string} [opt_option.id] - ä¸é¢å¾å± IDãé»è®¤ä½¿ç¨ CommonUtil.createUniqueID("themeLayer_") åå»ºä¸é¢å¾å± IDã
 * @param {number} [opt_option.opacity=1] - å¾å±éæåº¦ã
 * @param {string} [opt_option.logo] - Logoï¼openLayers 5.0.0 åæ´é«çæ¬ä¸åæ¯ææ­¤åæ°ï¼ã
 * @param {ol.proj.Projection} [opt_option.projection] - æå½±ä¿¡æ¯ã
 * @param {number} [opt_option.ratio=1.5] - è§å¾æ¯ï¼1 è¡¨ç¤ºç»å¸æ¯å°å¾è§å£çå¤§å°ï¼2 è¡¨ç¤ºå°å¾è§å£çå®½åº¦åé«åº¦çä¸¤åï¼ä¾æ­¤ç±»æ¨ã å¿é¡»æ¯ 1 ææ´é«ã
 * @param {Array} [opt_option.resolutions] - åè¾¨çæ°ç»ã
 * @param {ol.source.State} [opt_option.state] - èµæºç¶æã
 * @param {(string|Object)} [opt_option.attributions='Map Data <span>Â© <a href='http://support.supermap.com.cn/product/iServer.aspx' target='_blank'>SuperMap iServer</a></span> with <span>Â© <a href='https://iclient.supermap.io' target='_blank'>SuperMap iClient</a></span>'] - çæä¿¡æ¯ã
 * @extends {ol.source.ImageCanvas}
 * @usage
 */
class theme_Theme_Theme extends (external_ol_source_ImageCanvas_default()) {

    constructor(name, opt_options) {
        var options = opt_options ? opt_options : {};
        super({
            attributions: options.attributions || "Map Data <span>Â© <a href='http://support.supermap.com.cn/product/iServer.aspx' target='_blank'>SuperMap iServer</a></span> with <span>Â© <a href='https://iclient.supermap.io' target='_blank'>SuperMap iClient</a></span>",
            canvasFunction: canvasFunctionInternal_,
            logo: core_Util_Util.getOlVersion() === '4' ? options.logo : null,
            projection: options.projection,
            ratio: options.ratio,
            resolutions: options.resolutions,
            state: options.state
        });
        /**
        * @function Theme.prototype.on
        * @description æ·»å ä¸é¢è¦ç´ äºä»¶çå¬ãæ¯æçäºä»¶åæ¬: clickãmousedownãmousemoveãmouseoutãmouseoverãmouseupã
        * @param {string} event - äºä»¶åç§°ã
        * @param {RequestCallback} callback - äºä»¶åè°å½æ°ã
        */
        this.on = this.onInternal;
        this.id = options.id ? options.id : Util.createUniqueID("themeLayer_");

        function canvasFunctionInternal_(extent, resolution, pixelRatio, size, projection) { // eslint-disable-line no-unused-vars
            var mapWidth = size[0] * pixelRatio;
            var mapHeight = size[1] * pixelRatio;
            if (!this.context) {
                this.context = core_Util_Util.createCanvasContext2D(mapWidth, mapHeight);
            }
            if (!this.features) {
                return this.context.canvas;
            }
            this.pixelRatio = pixelRatio;

            var width = this.map.getSize()[0] * pixelRatio;
            var height = this.map.getSize()[1] * pixelRatio;
            this.offset = [(mapWidth - width) / 2 / pixelRatio, (mapHeight - height) / 2 / pixelRatio];
            if (!this.notFirst) {
                this.redrawThematicFeatures(extent);
                this.notFirst = true;
            }
            this.div.id = this.id;
            this.div.className = "themeLayer";
            this.div.style.width = mapWidth + "px";
            this.div.style.height = mapHeight + "px";
            this.map.getViewport().appendChild(this.div);
            this.renderer.resize();
            this.map.getViewport().removeChild(this.div);
            this.themeCanvas = this.renderer.painter.root.getElementsByTagName('canvas')[0];
            this.themeCanvas.width = mapWidth;
            this.themeCanvas.height = mapHeight;
            this.themeCanvas.style.width = mapWidth + "px";
            this.themeCanvas.style.height = mapHeight + "px";
            this.themeCanvas.getContext('2d').clearRect(0, 0, mapWidth, mapHeight);

            var highLightContext = this.renderer.painter._layers.hover.ctx;
            var highlightCanvas = highLightContext.canvas;
            var copyHighLightContext = core_Util_Util.createCanvasContext2D(mapWidth, mapHeight);
            copyHighLightContext.drawImage(highlightCanvas, 0, 0, highlightCanvas.width, highlightCanvas.height, 0, 0, mapWidth, mapHeight);

            this.redrawThematicFeatures(extent);
            var canvas = this.context.canvas;
            this.context.clearRect(0, 0, canvas.width, canvas.height);
            canvas.width = mapWidth;
            canvas.height = mapHeight;
            canvas.style.width = mapWidth + "px";
            canvas.style.height = mapHeight + "px";
            this.context.drawImage(this.themeCanvas, 0, 0);
            this.context.drawImage(copyHighLightContext.canvas, 0, 0);
            return this.context.canvas;
        }

        this.canvasFunctionInternal_ = canvasFunctionInternal_;
        this.EVENT_TYPES = ["loadstart", "loadend", "loadcancel",
            "visibilitychanged", "move", "moveend", "added", "removed",
            "tileloaded", "beforefeaturesadded", "featuresadded", "featuresremoved"];
        this.features = [];
        this.TFEvents = options.TFEvents || [];
        this.map = options.map;
        var size = this.map.getSize();
        this.div = document.createElement('div');
        this.map.getViewport().appendChild(this.div);
        this.div.style.width = size[0] + "px";
        this.div.style.height = size[1] + "px";
        this.setOpacity(options.opacity);
        this.levelRenderer = new LevelRenderer();
        this.movingOffset = [0, 0];
        this.renderer = this.levelRenderer.init(this.div);
        this.map.getViewport().removeChild(this.div);
        this.renderer.clear();
        //å¤çç¨æ·é¢åï¼å¨å¾å±æ·»å å° map åï¼çå¬çäºä»¶
        this.addTFEvents();
    }

    /**
     * @function Theme.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        this.EVENT_TYPES = null;
        this.isBaseLayer = null;
        this.TFEvents = null;
        this.destroyFeatures();
        this.features = null;
        if (this.renderer) {
            this.renderer.dispose();
        }
        this.renderer = null;
        this.levelRenderer = null;
        this.movingOffset = null;
        this.currentMousePosition = null;
    }

    /**
     * @function Theme.prototype.destroyFeatures
     * @description éæ¯è¦ç´ ã
     * @param {Array.<FeatureVector>|FeatureVector} features - å°è¢«éæ¯çè¦ç´ ã
     */
    destroyFeatures(features) {
        var all = (features == undefined);
        if (all) {
            features = this.features;
        }
        if (features) {
            this.removeFeatures(features);
            if (!Array.isArray(features)) {
              features = [features];
            }
            for (var i = features.length - 1; i >= 0; i--) {
                features[i].destroy();
            }
        }
    }

    /**
     * @function Theme.prototype.setOpacity
     * @description è®¾ç½®å¾å±çä¸éæåº¦ï¼åå¼[0-1]ä¹é´ã
     * @param {number} opacity - ä¸éæåº¦ã
     */
    setOpacity(opacity) {
        if (opacity !== this.opacity) {
            this.opacity = opacity;
            var element = this.div;
            Util.modifyDOMElement(element, null, null, null,
                null, null, null, opacity);

            if (this.map !== null) {
                this.dispatchEvent({type: 'changelayer', value: {layer: this, property: "opacity"}});
            }
        }
    }

    /**
     * @function Theme.prototype.addFeatures
     * @param {(Array.<ThemeFeature>|Array.<GeoJSONObject>|Array.<ol.Feature>|ThemeFeature|GeoJSONObject|ol.Feature)} features - å¾æ·»å è¦ç´ ã
     * @description æ½è±¡æ¹æ³ï¼å¯å®ä¾åå­ç±»å¿é¡»å®ç°æ­¤æ¹æ³ãåä¸é¢å¾å¾å±ä¸­æ·»å æ°æ®ï¼
     *              ä¸é¢å¾ä»æ¥æ¶ FeatureVector ç±»åæ°æ®ï¼
     *              feature å°å¨å­äº features å±æ§ä¸­ï¼å¶å­å¨å½¢å¼ä¸ºæ°ç»ã
     */
    addFeatures(features) { // eslint-disable-line no-unused-vars

    }

    /**
     * @function Theme.prototype.removeFeatures
     * @param {(Array.<FeatureVector>|FeatureVector|Function)} features - è¦å é¤ feature çæ°ç»æç¨æ¥è¿æ»¤çåè°å½æ°ã
     * @description ä»ä¸é¢å¾ä¸­å é¤ featureãè¿ä¸ªå½æ°å é¤ææä¼ éè¿æ¥çç¢éè¦ç´ ã
     *              åæ°ä¸­ç features æ°ç»ä¸­çæ¯ä¸é¡¹ï¼å¿é¡»æ¯å·²ç»æ·»å å°å½åå¾å±ä¸­ç featureï¼
     *              å¦ææ æ³ç¡®å® feature æ°ç»ï¼åå¯ä»¥è°ç¨ removeAllFeatures æ¥å é¤ææ featureã
     *              å¦æè¦å é¤ç feature æ°ç»ä¸­çåç´ ç¹å«å¤ï¼æ¨èä½¿ç¨ removeAllFeaturesï¼
     *              å é¤ææ feature ååéæ°æ·»å ãè¿æ ·æçä¼æ´é«ã
     */
    removeFeatures(features) {
      var me = this;
      if (!features) {
          return;
      }
      if (features === me.features) {
          return me.removeAllFeatures();
      }
      if (!Util.isArray(features) && !(typeof features === 'function')) {
          features = [features];
      }

      var featuresFailRemoved = [];

      for (var i = 0; i < me.features.length; i++) {
          var feature = me.features[i];

          //å¦ææä»¬ä¼ å¥çfeatureå¨featuresæ°ç»ä¸­æ²¡æçè¯ï¼åä¸è¿è¡å é¤ï¼
          //å¹¶å°å¶æ¾å¥æªå é¤çæ°ç»ä¸­ã
          if (features && typeof features === 'function') {
            if (features(feature)) {
              me.features.splice(i--, 1);
            }
          } else {
            var findex = Util.indexOf(features, feature);
            if (findex === -1) {
                featuresFailRemoved.push(feature);
            } else {
              me.features.splice(i--, 1);
            }
          }
      }
        var drawFeatures = [];
        for (var hex = 0, len = this.features.length; hex < len; hex++) {
            feature = this.features[hex];
            drawFeatures.push(feature);
        }
        this.features = [];
        this.addFeatures(drawFeatures);
        //ç»å¶ä¸é¢è¦ç´ 
        if (this.renderer) {
            this.redrawThematicFeatures(this.map.getView().calculateExtent());
        }
        var succeed = featuresFailRemoved.length == 0 ? true : false;
        this.dispatchEvent({type: "featuresremoved", value: {features: featuresFailRemoved, succeed: succeed}});
    }

    /**
     * @function Theme.prototype.removeAllFeatures
     * @description æ¸é¤å½åå¾å±ææçç¢éè¦ç´ ã
     */
    removeAllFeatures() {
        if (this.renderer) {
            this.renderer.clear();
        }
        this.features = [];
        this.dispatchEvent({type: 'featuresremoved', value: {features: [], succeed: true}});
    }

    /**
     * @function Theme.prototype.getFeatures
     * @description æ¥çå½åå¾å±ä¸­çæææ°æ®ã
     * @param {Function} [filter] - æ ¹æ®æ¡ä»¶è¿æ»¤è¦ç´ çåè°å½æ°ã
     * @returns {Array.<FeatureVector>} ç¨æ·å å¥å¾å±çæææ°æ®ã
     */
    getFeatures(filter) {
        var len = this.features.length;
        var clonedFeatures = [];
        for (var i = 0; i < len; ++i) {
          if (!filter || (filter && typeof filter === 'function' && filter(this.features[i]))) {
            clonedFeatures.push(this.features[i]);
          }
        }
        return clonedFeatures;
    }

    /**
     * @function Theme.prototype.getFeatureBy
     * @description å¨ä¸é¢å¾çè¦ç´ æ°ç» features éé¢éåæ¯ä¸ä¸ª featureï¼å½ feature[property] === value æ¶ï¼
     *              è¿åæ­¤ featureï¼å¹¶ä¸åªè¿åç¬¬ä¸ä¸ªï¼ã
     * @param {string} property - feature çæä¸ªå±æ§åç§°ã
     * @param {string} value - property æå¯¹åºçå¼ã
     * @returns {FeatureVector} ç¬¬ä¸ä¸ªå¹éå±æ§åå¼çç¢éè¦ç´ ã
     */
    getFeatureBy(property, value) {
        var feature = null;
        for (var id in this.features) {
            if (this.features[id][property] === value) {
                feature = this.features[id];
                //feature = this.features[id].clone();
                break;
            }
        }
        return feature;
    }

    /**
     * @function Theme.prototype.getFeatureById
     * @description éè¿ç»å®ä¸ä¸ª IDï¼è¿åå¯¹åºçç¢éè¦ç´ ã
     * @param {string} featureId - ç¢éè¦ç´ çå±æ§ IDã
     * @returns {FeatureVector} å¯¹åº ID ç featureï¼å¦æä¸å­å¨åè¿å nullã
     */
    getFeatureById(featureId) {
        return this.getFeatureBy('id', featureId);
    }

    /**
     * @function Theme.prototype.getFeaturesByAttribute
     * @description éè¿ç»å®ä¸ä¸ªå±æ§ç key å¼å value å¼ï¼è¿åææå¹éçè¦ç´ æ°ç»ã
     * @param {string} attrName - å±æ§ç keyã
     * @param {string} attrValue - ç¢éè¦ç´ çå±æ§ IDã
     * @returns {Array.<FeatureVector>} ä¸ä¸ªå¹éç feature æ°ç»ã
     */
    getFeaturesByAttribute(attrName, attrValue) {
        var feature,
            foundFeatures = [];
        for (var id in this.features) {
            feature = this.features[id];
            //feature = this.features[id].clone();
            if (feature && feature.attributes) {
                if (feature.attributes[attrName] === attrValue) {
                    foundFeatures.push(feature);
                }
            }
        }
        return foundFeatures;
    }

    /**
     * @function Theme.prototype.redrawThematicFeatures
     * @description æ½è±¡æ¹æ³ï¼å¯å®ä¾åå­ç±»å¿é¡»å®ç°æ­¤æ¹æ³ãéç»ä¸é¢è¦ç´ ã
     * @param {Array} extent - å½åçº§å«ä¸è®¡ç®åºçå°å¾èå´ã
     */
    redrawThematicFeatures(extent) { //eslint-disable-line no-unused-vars
    }

    /**
     * @private
     * @function Theme.prototype.onInternal
     * @description æ·»å ä¸é¢è¦ç´ äºä»¶çå¬ãæ¯æçäºä»¶åæ¬: clickãmousedownãmousemoveãmouseoutãmouseoverãmouseupã
     * @param {string} event - äºä»¶åç§°ã
     * @param {RequestCallback} callback - äºä»¶åè°å½æ°ã
     */
    onInternal(event, callback) {
        var cb = callback;
        if (!this.renderer) {
            var evn = [];
            evn.push(event);
            evn.push(cb);
            this.TFEvents.push(evn);
        } else {
            this.renderer.on(event, cb);
        }
    }

    /**
     * @function Theme.prototype.fire
     * @description æ·»å ä¸é¢è¦ç´ äºä»¶çå¬ã
     * @param {string} type - äºä»¶ç±»åã
     * @param {string} event - äºä»¶åç§°ã
     */
    fire(type, event) {
        if (!this.offset) {
            return;
        }
        event = event.originalEvent;
        var x = this.getX(event);
        var y = this.getY(event);
        var rotation = -this.map.getView().getRotation();
        var center = this.map.getPixelFromCoordinate(this.map.getView().getCenter());
        var scaledP = this.scale([x, y], center, this.pixelRatio);
        var rotatedP = this.rotate(scaledP, rotation, center);
        var resultP = [rotatedP[0] + this.offset[0], rotatedP[1] + this.offset[1]];
        var offsetEvent = document.createEvent('Event');
        offsetEvent.initEvent('pointermove', true, true);
        offsetEvent.offsetX = resultP[0];
        offsetEvent.offsetY = resultP[1];
        offsetEvent.layerX = resultP[0];
        offsetEvent.layerY = resultP[1];
        offsetEvent.clientX = resultP[0];
        offsetEvent.clientY = resultP[1];
        offsetEvent.x = x;
        offsetEvent.y = y;
        if (type === 'click') {
            this.renderer.handler._clickHandler(offsetEvent);
        }
        if (type === 'dblclick') {
            this.renderer.handler._dblclickHandler(offsetEvent);
        }
        if (type === 'onmousewheel') {
            this.renderer.handler._mousewheelHandler(offsetEvent);
        }
        if (type === 'mousemove') {
            this.renderer.handler._mousemoveHandler(offsetEvent);
            this.changed();
        }
        if (type === 'onmouseout') {
            this.renderer.handler._mouseoutHandler(offsetEvent);
        }
        if (type === 'onmousedown') {
            this.renderer.handler._mousedownHandler(offsetEvent);
        }
        if (type === 'onmouseup') {
            this.renderer.handler._mouseupHandler(offsetEvent);
        }

    }

    getX(e) {
        return typeof e.zrenderX != 'undefined' && e.zrenderX
            || typeof e.offsetX != 'undefined' && e.offsetX
            || typeof e.layerX != 'undefined' && e.layerX
            || typeof e.clientX != 'undefined' && e.clientX;
    }

    getY(e) {
        return typeof e.zrenderY != 'undefined' && e.zrenderY
            || typeof e.offsetY != 'undefined' && e.offsetY
            || typeof e.layerY != 'undefined' && e.layerY
            || typeof e.clientY != 'undefined' && e.clientY;
    }

    /**
     * @function Theme.prototype.un
     * @description ç§»é¤ä¸é¢è¦ç´ äºä»¶çå¬ã
     * @param {string} event - äºä»¶åç§°ã
     * @param {RequestCallback} callback - äºä»¶åè°å½æ°ã
     */
    un(event, callback) {
        var cb = callback;
        if (!this.renderer) {
            var tfEs = this.TFEvents;
            var len = tfEs.length;
            var newtfEs = [];
            for (var i = 0; i < len; i++) {
                var tfEs_i = tfEs[i];

                if (!(tfEs_i[0] === event && tfEs_i[1] === cb)) {
                    newtfEs.push(tfEs_i)
                }
            }
            this.TFEvents = newtfEs;
        } else {
            this.renderer.un(event, cb);
        }
    }

    /**
     * @function Theme.prototype.addTFEvents
     * @description å°å¾å±æ·»å å°å°å¾ä¸ä¹åç¨æ·è¦æ±æ·»å çäºä»¶çå¬æ·»å å°å¾å±ã
     * @private
     */
    addTFEvents() {
        var tfEs = this.TFEvents;
        var len = tfEs.length;
        for (var i = 0; i < len; i++) {
            this.renderer.on(tfEs[i][0], tfEs[i][1]);
        }
    }

    /**
     * @function Theme.prototype.getLocalXY
     * @description è·ååæ ç³»ç»ã
     * @param {Object} coordinate - åæ ä½ç½®ã
     * @returns {Array.<number>} åç´ åæ æ°ç»ã
     */
    getLocalXY(coordinate) {
        var pixelP, map = this.map;
        if (coordinate instanceof Point || coordinate instanceof GeoText) {
            pixelP = map.getPixelFromCoordinate([coordinate.x, coordinate.y]);
        }
        if (coordinate instanceof LonLat) {
            pixelP = map.getPixelFromCoordinate([coordinate.lon, coordinate.lat]);
        }
        var rotation = -map.getView().getRotation();
        var center = map.getPixelFromCoordinate(map.getView().getCenter());
        var rotatedP = pixelP;
        if (this.pixelRatio) {
            rotatedP = this.scale(pixelP, center, this.pixelRatio);
        }
        if (pixelP && center) {
            rotatedP = this.rotate(rotatedP, rotation, center);
        }
        if (this.offset && rotatedP) {
            return [rotatedP[0] + this.offset[0], rotatedP[1] + this.offset[1]];
        }
        return rotatedP;
    }

    /**
     * @function Theme.prototype.rotate
     * @description è·åæåç´ åæ ç¹ pixelP ç»ä¸­å¿ center éæ¶éæè½¬ rotation å¼§åº¦åçåç´ ç¹åæ ã
     * @param {number} pixelP - åç´ åæ ç¹ä½ç½®ã
     * @param {number} rotation - æè½¬è§åº¦ã
     * @param {number} center - ä¸­å¿ä½ç½®ã
     * @returns {Array.<number>} æè½¬åçåç´ åæ æ°ç»ã
     */
    rotate(pixelP, rotation, center) {
        var x = Math.cos(rotation) * (pixelP[0] - center[0]) - Math.sin(rotation) * (pixelP[1] - center[1]) + center[0];
        var y = Math.sin(rotation) * (pixelP[0] - center[0]) + Math.cos(rotation) * (pixelP[1] - center[1]) + center[1];
        return [x, y];
    }

    /**
     * @function Theme.prototype.scale
     * @description è·åæåç´ åæ ç¹ pixelP ç¸å¯¹äºä¸­å¿ center è¿è¡ç¼©æ¾ scaleRatio ååçåç´ ç¹åæ ã
     * @param {Object} pixelP - åç´ ç¹ã
     * @param {Object} center - ä¸­å¿ç¹ã
     * @param {number} scaleRatio - ç¼©æ¾åæ°ã
     * @returns {Array.<number>} è¿åæ°ç»å½¢æ¯ä¾
     */
    scale(pixelP, center, scaleRatio) {
        var x = (pixelP[0] - center[0]) * scaleRatio + center[0];
        var y = (pixelP[1] - center[1]) * scaleRatio + center[1];
        return [x, y];
    }

    /**
     * @function Theme.prototype.toiClientFeature
     * @description è½¬ä¸º iClient è¦ç´ ã
     * @param {(Array.<ThemeFeature>|Array.<GeoJSONObject>|Array.<ol.Feature>|ThemeFeature|GeoJSONObject|ol.Feature)} features - å¾è½¬è¦ç´ ã
     * @returns {Array.<FeatureVector>} è½¬æ¢åç iClient è¦ç´ 
     */
    toiClientFeature(features) {
        if (!Util.isArray(features)) {
            features = [features];
        }

        let featuresTemp = [];
        for (let i = 0; i < features.length; i++) {

            if (features[i] instanceof ThemeFeature) {
                // ThemeFeature ç±»å
                featuresTemp.push(features[i].toFeature());
                continue;
            } else if (features[i] instanceof (external_ol_Feature_default())) {
                //ol.Feature æ°æ®ç±»å
                //_toFeature ç»ä¸å¤ç ol.Feature ææ geometry ç±»å
                featuresTemp.push(this._toFeature(features[i]));
                continue;
            } else if (features[i] instanceof Vector) {
                // è¥æ¯ FeatureVector ç´æ¥è¿å
                featuresTemp.push(features[i]);
                continue;
            } else if (features[i].geometry && features[i].geometry.parts) {
                //iServeræå¡å¨è¿åæ°æ®æ ¼å¼
                featuresTemp.push(ServerFeature.fromJson(features[i]).toFeature());
            } else if (["FeatureCollection", "Feature", "Geometry"].indexOf(features[i].type) != -1) {
                //GeoJSON è§èæ°æ®ç±»å
                const format = new GeoJSON();
                featuresTemp = featuresTemp.concat(format.read(features[i]));
            } else {
                throw new Error(`features[${i}]'s type is not be supported.`);
            }

        }
        return featuresTemp;
    }

    /**
     * @function Theme.prototype.toFeature
     * @deprecated
     * @description è½¬ä¸º iClient è¦ç´ ï¼è¯¥æ¹æ³å°è¢«å¼ç¨ï¼ç± {@link Theme#toiClientFeature} ä»£æ¿ã
     * @param {(Array.<ThemeFeature>|Array.<GeoJSONObject>|Array.<ol.Feature>|ThemeFeature|GeoJSONObject|ol.Feature)} features - å¾è½¬è¦ç´ ã
     * @returns {Array.<FeatureVector>} è½¬æ¢åç iClient è¦ç´ 
     */
    toFeature(features) {
        return this.toiClientFeature(features);
    }

    //ç»ä¸å¤ç ol.featureææ geometry ç±»å
    _toFeature(feature) {
        let geoFeature = (new (external_ol_format_GeoJSON_default())()).writeFeature(feature);
        return new GeoJSON().read(geoFeature, "Feature");
    }

}

;// CONCATENATED MODULE: ./src/openlayers/overlay/Graph.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/






/**
 * @class Graph
 * @browsernamespace ol.source
 * @category  Visualization Theme
 * @classdesc ç»è®¡ä¸é¢å¾å¾å±åºç±»ã
 * @param {string} chartsType - å¾è¡¨ç±»å«ã
 * @param {string} name - å¾å±åç§°ã
 * @param {Object} opt_options - åæ°ã
 * @param {ol.Map} opt_options.map - å½å Map å¯¹è±¡ã
 * @param {string} opt_options.chartsType - å¾è¡¨ç±»åãç®åå¯ç¨ï¼"Bar"ï¼"Bar3D"ï¼"Line"ï¼"Point"ï¼"Pie"ï¼"Ring"ã
 * @param {Object} opt_options.chartsSetting - åç±»åå¾è¡¨ç chartsSetting å¯¹è±¡å¯è®¾å±æ§è¯·åèå·ä½å¾è¡¨æ¨¡åç±»çæ³¨éä¸­å¯¹ chartsSetting å¯¹è±¡å¯è®¾å±æ§çæè¿°ãchartsSetting å¯¹è±¡éå¸¸é½å·æä»¥ä¸å ä¸ªåºç¡å¯è®¾å±æ§ã
 * @param {number} opt_options.chartsSetting.width - ä¸é¢è¦ç´ ï¼å¾è¡¨ï¼å®½åº¦ã
 * @param {number} opt_options.chartsSetting.height - ä¸é¢è¦ç´ ï¼å¾è¡¨ï¼é«åº¦ã
 * @param {Array.<number>} opt_options.chartsSetting.codomain - å¼åï¼é¿åº¦ä¸º 2 çä¸ç»´æ°ç»ï¼ç¬¬ä¸ä¸ªåç´ è¡¨ç¤ºå¼åä¸éï¼ç¬¬äºä¸ªåç´ è¡¨ç¤ºå¼åä¸éã
 * @param {number} [opt_options.chartsSetting.XOffset] - ä¸é¢è¦ç´ ï¼å¾è¡¨ï¼å¨ X æ¹åä¸çåç§»å¼ï¼åä½åç´ ã
 * @param {number} [opt_options.chartsSetting.YOffset] - ä¸é¢è¦ç´ ï¼å¾è¡¨ï¼å¨ Y æ¹åä¸çåç§»å¼ï¼åä½åç´ ã
 * @param {Array.<number>} [opt_options.chartsSetting.dataViewBoxParameter] - æ°æ®è§å¾æ¡ dataViewBox åæ°ï¼å®æ¯æå¾è¡¨æ¡ chartBoxï¼ç±å¾è¡¨ä½ç½®ãå¾è¡¨å®½åº¦ãå¾è¡¨é«åº¦ææçå¾è¡¨èå´æ¡ï¼å¨å·¦ãä¸ï¼å³ï¼ä¸åä¸ªæ¹åä¸çååè·å¼ï¼é¿åº¦ä¸º 4 çä¸ç»´æ°ç»ã
 * @param {number} [opt_options.chartsSetting.decimalNumber] - æ°æ®å¼æ°ç» dataValues åç´ å¼å°æ°ä½æ°ï¼æ°æ®çå°æ°ä½å¤çåæ°ï¼åå¼èå´ï¼[0, 16]ãå¦æä¸è®¾ç½®æ­¤åæ°ï¼å¨åæ°æ®å¼æ¶ä¸å¯¹æ°æ®åå°æ°ä½å¤çã
 * @param {string} opt_options.themeFields - æå®åå»ºä¸é¢å¾å­æ®µã
 * @param {string} [opt_options.id] - ä¸é¢å¾å± IDãé»è®¤ä½¿ç¨ CommonUtil.createUniqueID("themeLayer_") åå»ºä¸é¢å¾å± IDã
 * @param {number} [opt_options.opacity = 1] - å¾å±éæåº¦ã
 * @param {string} [opt_options.logo] - Logoï¼openLayers 5.0.0 åæ´é«çæ¬ä¸åæ¯ææ­¤åæ°ï¼ã
 * @param {ol.proj.Projection} [opt_options.projection] - {@link ol.proj.Projection} æå½±ä¿¡æ¯ã
 * @param {number} [opt_options.ratio=1.5] - è§å¾æ¯, 1 è¡¨ç¤ºç»å¸æ¯å°å¾è§å£çå¤§å°ï¼2 è¡¨ç¤ºå°å¾è§å£çå®½åº¦åé«åº¦çä¸¤åï¼ä¾æ­¤ç±»æ¨ãå¿é¡»æ¯ 1 ææ´é«ã
 * @param {Array.<number>} [opt_options.resolutions] - åè¾¨çæ°ç»ã
 * @param {boolean} [opt_options.isOverLay=true] - æ¯å¦è¿è¡åçå¤çï¼å¦æè®¾ä¸º trueï¼å¾è¡¨ç»å¶è¿ç¨ä¸­å°éèå¯¹å·²å¨å¾å±ä¸­ç»å¶çå¾è¡¨äº§çåççå¾è¡¨ã
 * @param {ol.source.State} [opt_options.state] - èµæºç¶æã
 * @param {(string|Object)} [opt_options.attributions='Map Data <span>Â© <a href='http://support.supermap.com.cn/product/iServer.aspx' target='_blank'>SuperMap iServer</a></span> with <span>Â© <a href='https://iclient.supermap.io' target='_blank'>SuperMap iClient</a></span>'] - çæä¿¡æ¯ã
 * @extends {Theme}
 * @usage
 */
class Graph_Graph extends theme_Theme_Theme {

    constructor(name, chartsType, opt_options) {
        super(name, opt_options);
        this.chartsSetting = opt_options.chartsSetting || {};
        this.themeFields = opt_options.themeFields || null;
        this.overlayWeightField = opt_options.overlayWeightField || null;
        this.isOverLay = opt_options.isOverLay === undefined ? true : opt_options.isOverLay;
        this.charts = opt_options.charts || [];
        this.cache = opt_options.cache || {};
        this.chartsType = chartsType;
    }

    /**
     * @function Graph.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        this.chartsType = null;
        this.chartsSetting = null;
        this.themeFields = null;
        this.overlayWeightField = null;
        this.isOverLay = null;
        theme_Theme_Theme.prototype.destroy.apply(this, arguments);
        // charts  cache ä¸ºç¼å­ï¼éè¦å¨ç¶ç±»destoryåç½®ä¸ºnullï¼ç¶ç±»destoryä¸­ææ¹æ³ä¼åå§åç¼å­åæ°ï¼
        this.charts = null;
        this.cache = null;
    }

    /**
     * @function Graph.prototype.setChartsType
     * @description è®¾ç½®å¾è¡¨ç±»åï¼æ­¤å½æ°å¯å¨ææ¹åå¾è¡¨ç±»åãå¨è°ç¨æ­¤å½æ°åè¯·éè¿ chartsSetting ä¸ºæ°ç±»åçå¾è¡¨åç¸å³éç½®ã
     * @param {string} chartsType - å¾è¡¨ç±»åãç®åå¯ç¨ï¼"Bar"ï¼"Bar3D"ï¼"Line"ï¼"Point"ï¼"Pie"ï¼"Ring"ã
     */
    setChartsType(chartsType) {
        this.chartsType = chartsType;
        this.redraw();
    }

    /**
     * @function Graph.prototype.addFeatures
     * @description åä¸é¢å¾å¾å±ä¸­æ·»å æ°æ®ã
     * @param {(ServerFeature|ThemeFeature)} features - å¾æ·»å çè¦ç´ ã
     */
    addFeatures(features) {
        var ret = this.dispatchEvent({
            type: 'beforefeaturesadded',
            value: {
                features: features
            }
        });
        if (ret === false) {
            return;
        }
        //è½¬æ¢ features å½¢å¼
        this.features = this.toiClientFeature(features);
        //ç»å¶ä¸é¢è¦ç´ 
        if (this.renderer) {
            this.changed();
        }
    }

    /**
     * @function Graph.prototype.redrawThematicFeatures
     * @description éç»ææä¸é¢è¦ç´ ã
     *              æ­¤æ¹æ³åå«ç»å¶ä¸é¢è¦ç´ çæææ­¥éª¤ï¼åå«ç¨æ·æ°æ®å°ä¸é¢è¦ç´ çè½¬æ¢ï¼æ½ç¨ï¼ç¼å­ç­æ­¥éª¤ã
     *              å°å¾æ¼«æ¸¸æ¶è°ç¨æ­¤æ¹æ³è¿è¡å¾å±å·æ°ã
     * @param {Object} extent - éç»çèå´ã
     *
     */
    redrawThematicFeatures(extent) {
        //æ¸é¤å½åææå¯è§åç´ 
        this.renderer.clearAll();
        var features = this.features;
        for (var i = 0, len = features.length; i < len; i++) {
            var feature = features[i];
            // è¦ç´ èå´å¤æ­
            var feaBounds = feature.geometry.getBounds();
            //åé¤å½åè§å¾ï¼å°çï¼èå´ä»¥å¤çæ°æ®
            if (extent) {
                var bounds = new Bounds(extent[0], extent[1], extent[2], extent[3]);
                if (!bounds.intersectsBounds(feaBounds)) {
                    continue;
                }
            }
            var cache = this.cache;
            // ç¨ feature id åç¼å­æ è¯
            var cacheField = feature.id;
            // æ°æ®å¯¹åºçå¾è¡¨æ¯å¦å·²ç¼å­ï¼æ²¡ç¼å­åéæ°åå»ºå¾è¡¨
            if (cache[cacheField]) {
                continue;
            }
            cache[cacheField] = cacheField;
            var chart = this.createThematicFeature(feature);
            // åçå¤çæéå¼
            if (chart && this.overlayWeightField) {
                if (feature.attributes[this.overlayWeightField] && !isNaN(feature.attributes[this.overlayWeightField])) {
                    chart["__overlayWeight"] = feature.attributes[this.overlayWeightField];
                }
            }
            if (chart) {
                this.charts.push(chart);
            }
        }
        this.drawCharts();
    }

    /**
     * @function Graph.prototype.createThematicFeature
     * @description åä¸é¢å¾å¾å±ä¸­æ·»å æ°æ®, æ¯æç feature ç±»åä¸ºï¼iServer è¿åç feature JSON å¯¹è±¡ã
     * @param {ServerFeature} feature - å¾æ·»å çè¦ç´ ã
     *
     */
    createThematicFeature(feature) {
        var thematicFeature;
        // æ£æ¥å¾è¡¨åå»ºæ¡ä»¶å¹¶åå»ºå¾å½¢
        if (Theme_Theme[this.chartsType] && this.themeFields && this.chartsSetting) {
            thematicFeature = new Theme_Theme[this.chartsType](feature, this, this.themeFields, this.chartsSetting);
        }
        // thematicFeature æ¯å¦åå»ºæå
        if (!thematicFeature) {
            return false;
        }
        // å¯¹ä¸é¢è¦ç´ æ§è¡å¾å½¢è£è½½
        thematicFeature.assembleShapes();
        return thematicFeature;
    }

    /**
     * @function Graph.prototype.drawCharts
     * @description ç»å¶å¾è¡¨ãåå«åçå¤çã
     *
     */
    drawCharts() {
        // å¤æ­ rendere rå°±ç»ª
        if (!this.renderer) {
            return;
        }
        var charts = this.charts;
        // å¾è¡¨æéå¼å¤ç
        if (this.overlayWeightField) {
            charts.sort(function (cs, ce) {
                if (typeof (cs["__overlayWeight"]) == "undefined" && typeof (ce["__overlayWeight"]) == "undefined") {
                    return 0;
                } else if (typeof (cs["__overlayWeight"]) != "undefined" && typeof (ce["__overlayWeight"]) == "undefined") {
                    return -1;
                } else if (typeof (cs["__overlayWeight"]) == "undefined" && typeof (ce["__overlayWeight"]) != "undefined") {
                    return 1;
                } else if (typeof (cs["__overlayWeight"]) != "undefined" && typeof (ce["__overlayWeight"]) != "undefined") {
                    if (parseFloat(cs["__overlayWeight"]) < parseFloat(ce["__overlayWeight"])) {
                        return 1;
                    } else {
                        return -1;
                    }
                }
                return 0;
            });
        }
        // ä¸è¿è¡é¿è®©
        if (!this.isOverLay) {
            for (var m = 0, len_m = charts.length; m < len_m; m++) {
                var chart_m = charts[m];
                // å¾å½¢åèä½ç½®  (reSetLocation ä¼æ´æ° chartBounds)
                var shapeROP_m = chart_m.resetLocation();
                // æ·»å å¾å½¢
                var shapes_m = chart_m.shapes;
                for (var n = 0, slen_n = shapes_m.length; n < slen_n; n++) {
                    shapes_m[n].refOriginalPosition = shapeROP_m;
                    this.renderer.addShape(shapes_m[n]);
                }
            }
        } else {
            // åçå¤æ­æé chartsBounds éå
            var chartsBounds = [];
            var extent = this.map.getView().calculateExtent();
            var mapBounds = new Bounds(extent[0], extent[1], extent[2], extent[3]);
            // è·åå°å¾åç´  bounds
            var mapPxLT = this.getLocalXY(new LonLat(mapBounds.left, mapBounds.top));
            var mapPxRB = this.getLocalXY(new LonLat(mapBounds.right, mapBounds.bottom));
            var mBounds = new Bounds(mapPxLT[0], mapPxRB[1], mapPxRB[0], mapPxLT[1]);
            // åçå¤ç & æ·»å å¾å½¢
            for (var i = 0, len = charts.length; i < len; i++) {
                var chart = charts[i];
                // å¾å½¢åèä½ç½®  (reSetLocation ä¼æ´æ° chartBounds)
                var shapeROP = chart.resetLocation();
                // å¾è¡¨æ¡
                var cbs = chart.chartBounds;
                var cBounds = [{
                    "x": cbs.left,
                    "y": cbs.top
                }, {
                    "x": cbs.left,
                    "y": cbs.bottom
                }, {
                    "x": cbs.right,
                    "y": cbs.bottom
                }, {
                    "x": cbs.right,
                    "y": cbs.top
                }, {
                    "x": cbs.left,
                    "y": cbs.top
                }];
                // å°å¾èå´å¤ä¸ç»å¶
                if (mBounds) {
                    if (!this.isChartInMap(mBounds, cBounds)) {
                        continue;
                    }
                }
                // æ¯å¦åç
                var isOL = false;
                if (i !== 0) {
                    for (let j = 0; j < chartsBounds.length; j++) {
                        //åçå¤æ­
                        if (this.isQuadrilateralOverLap(cBounds, chartsBounds[j])) {
                            isOL = true;
                            break;
                        }
                    }
                }
                if (isOL) {
                    continue;
                } else {
                    chartsBounds.push(cBounds);
                }
                // æ·»å å¾å½¢
                var shapes = chart.shapes;
                for (let j = 0, slen = shapes.length; j < slen; j++) {
                    shapes[j].refOriginalPosition = shapeROP;
                    this.renderer.addShape(shapes[j]);
                }
            }
        }
        // ç»å¶å¾å½¢
        this.renderer.render();
    }

    /**
     * @function Graph.prototype.getShapesByFeatureID
     * @description  éè¿ FeatureID è·å feature å³èçææå¾å½¢ãå¦æä¸ä¼ å¥æ­¤åæ°ï¼å½æ°å°è¿åææå¾å½¢ã
     * @param {number} featureID - è¦ç´  IDã
     */
    getShapesByFeatureID(featureID) {
        var list = [];
        var shapeList = this.renderer.getAllShapes();
        if (!featureID) {
            return shapeList
        }
        for (var i = 0, len = shapeList.length; i < len; i++) {
            var si = shapeList[i];
            if (si.refDataID && featureID === si.refDataID) {
                list.push(si);
            }
        }
        return list;
    }

    /**
     * @function Graph.prototype.isQuadrilateralOverLap
     * @description  å¤æ­ä¸¤ä¸ªåè¾¹å½¢æ¯å¦æåçã
     * @param {Array.<Object>} quadrilateral - åè¾¹å½¢èç¹æ°ç»ã
     * @param {Array.<Object>} quadrilateral2 - ç¬¬äºä¸ªåè¾¹å½¢èç¹æ°ç»ã
     */
    isQuadrilateralOverLap(quadrilateral, quadrilateral2) {
        var quadLen = quadrilateral.length,
            quad2Len = quadrilateral2.length;
        if (quadLen !== 5 || quad2Len !== 5) {
            return null;
        } //ä¸æ¯åè¾¹å½¢

        var OverLap = false;
        //å¦æä¸¤åè¾¹å½¢äºä¸åå«å¯¹æ¹çèç¹ï¼åä¸¤ä¸ªåè¾¹å½¢ä¸ç¸äº¤
        for (let i = 0; i < quadLen; i++) {
            if (this.isPointInPoly(quadrilateral[i], quadrilateral2)) {
                OverLap = true;
                break;
            }
        }
        for (let i = 0; i < quad2Len; i++) {
            if (this.isPointInPoly(quadrilateral2[i], quadrilateral)) {
                OverLap = true;
                break;
            }
        }
        //å ä¸ä¸¤ç©å½¢åå­ç¸äº¤çæåµ
        for (let i = 0; i < quadLen - 1; i++) {
            if (OverLap) {
                break;
            }
            for (let j = 0; j < quad2Len - 1; j++) {
                var isLineIn = Util.lineIntersection(quadrilateral[i], quadrilateral[i + 1], quadrilateral2[j], quadrilateral2[j + 1]);
                if (isLineIn.CLASS_NAME === "SuperMap.Geometry.Point") {
                    OverLap = true;
                    break;
                }
            }
        }
        return OverLap;
    }

    /**
     * @function Graph.prototype.isPointInPoly
     * @description  å¤æ­ä¸ä¸ªç¹æ¯å¦å¨å¤è¾¹å½¢éé¢ãï¼å°çº¿æ³ï¼ã
     * @param {Object} pt - éè¦å¤å®çç¹å¯¹è±¡ï¼è¯¥å¯¹è±¡å«æå±æ§ xï¼æ¨ªåæ ï¼ï¼å±æ§ yï¼çºµåæ ï¼ã
     * @param {Array.<Object>} poly - å¤è¾¹å½¢èç¹æ°ç»ã
     */
    isPointInPoly(pt, poly) {
        for (var isIn = false, i = -1, l = poly.length, j = l - 1; ++i < l; j = i) {
            ((poly[i].y <= pt.y && pt.y < poly[j].y) || (poly[j].y <= pt.y && pt.y < poly[i].y)) &&
            (pt.x < (poly[j].x - poly[i].x) * (pt.y - poly[i].y) / (poly[j].y - poly[i].y) + poly[i].x) &&
            (isIn = !isIn);
        }
        return isIn;
    }

    /**
     * @function Graph.prototype.isChartInMap
     * @description  å¤æ­å¾è¡¨æ¯å¦å¨å°å¾éã
     * @param {Bounds} mapPxBounds - å°å¾åç´ èå´ã
     * @param {Array.<Object>} chartPxBounds - å¾è¡¨èå´çåè¾¹å½¢èç¹æ°ç»ã
     */
    isChartInMap(mapPxBounds, chartPxBounds) {
        var mb = mapPxBounds;
        var isIn = false;
        for (var i = 0, len = chartPxBounds.length; i < len; i++) {
            var cb = chartPxBounds[i];

            if (cb.x >= mb.left && cb.x <= mb.right && cb.y >= mb.top && cb.y <= mb.bottom) {
                isIn = true;
                break;
            }
        }
        return isIn;
    }

    /**
     * @function Graph.prototype.clearCache
     * @description  æ¸é¤ç¼å­ã
     */
    clearCache() {
        this.cache = {};
        this.charts = [];
    }

    /**
     * @function Graph.prototype.removeFeatures
     * @description  ä»ä¸é¢å¾ä¸­å é¤ featureãè¿ä¸ªå½æ°å é¤ææä¼ éè¿æ¥çç¢éè¦ç´ ãåæ°ä¸­ç features æ°ç»ä¸­çæ¯ä¸é¡¹ï¼å¿é¡»æ¯å·²ç»æ·»å å°å½åå¾å±ä¸­ç featureã
     * @param {Array.<FeatureVector>|FeatureVector|Function} features - è¦å é¤çè¦ç´ ã
     */
    removeFeatures(features) {
        this.clearCache();
        super.removeFeatures(features);
    }

    /**
     * @function Graph.prototype.removeAllFeatures
     * @description  ç§»é¤ææçè¦ç´ 
     */
    removeAllFeatures() {
        this.clearCache();
        super.removeAllFeatures();
    }

    /**
     * @function Graph.prototype.redraw
     * @description  éç»è¯¥å¾å±
     */
    redraw() {
        this.clearCache();
        if (this.renderer) {
            this.redrawThematicFeatures(this.map.getView().calculateExtent());
            return true;
        }
        return false
    }

    /**
     * @function Graph.prototype.clear
     * @description  æ¸é¤çåå®¹åæ¬æ°æ®ï¼featuresï¼ ãä¸é¢è¦ç´ ãç¼å­ã
     */
    clear() {
        if (this.renderer) {
            this.renderer.clearAll();
            this.renderer.refresh();
        }
        this.removeAllFeatures();
        this.clearCache();
    }

    canvasFunctionInternal_(extent, resolution, pixelRatio, size, projection) { // eslint-disable-line no-unused-vars
        return theme_Theme_Theme.prototype.canvasFunctionInternal_.apply(this, arguments);
    }
}

;// CONCATENATED MODULE: external "ol.style.RegularShape"
const external_ol_style_RegularShape_namespaceObject = ol.style.RegularShape;
var external_ol_style_RegularShape_default = /*#__PURE__*/__webpack_require__.n(external_ol_style_RegularShape_namespaceObject);
;// CONCATENATED MODULE: ./src/openlayers/overlay/graphic/CloverShape.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class CloverShape
 * @browsernamespace ol.style
 * @category  Visualization Graphic
 * @classdesc ä¸å¶èè¦ç´ é£æ ¼ã
 * @extends {ol.style.RegularShape}
 * @param {Object} options - ä¸å¶èå½¢è¦ç´ é£æ ¼åæ°ã
 * @param {number} [options.angle=30] - ä¸å¶èæ¯ä¸ªæå¶çåå¿è§ï¼åä½å¼§åº¦ã
 * @param {number} [options.count=3] - æå¶æ°éã
 * @param {ol.style.Fill} [options.fill] - å¡«åæ ·å¼ã
 * @param {number} [options.strokeOpacity] - éæåº¦ã
 * @param {number} [options.fillOpacity] - å¡«åéæåº¦ã
 * @param {number} [options.radius] - åå¾ã
 * @param {ol.style.Stroke} [options.stroke] - è¾¹æ¡æ ·å¼ã
 * @param {string} [options.stroke.color='#3388ff'] - è¾¹æ¡é¢è²ã
 * @param {number} [options.stroke.width=1] - è¾¹æ¡å®½åº¦ã
 * @usage
 */
class CloverShape extends (external_ol_style_RegularShape_default()) {

    constructor(options) {
        if (options.stroke) {
            options.stroke.color = options.stroke.getColor() || "#3388ff";
            options.stroke.width = options.stroke.getWidth() || 1;
        } else {
            options.stroke = new (external_ol_style_Stroke_default())({
                color: "#3388ff",
                width: 1
            })
        }
        if (options.fill) {
            options.fill.color = options.fill.getColor() || "#66ccff";
        } else {
            options.fill = new (external_ol_style_Fill_default())({
                color: "#66ccff"
            })
        }
        super({
            angle: options.angle || 60,
            stroke: options.stroke,
            fill: options.fill,
            radius: options.radius || 10,
            rotation: options.rotation || 0
        });
        this.count_ = options.count || 3;
        this.strokeOpacity = options.strokeOpacity || 1;
        this.fillOpacity = options.fillOpacity || 1;

        this._pixelRatio = window ? window.devicePixelRatio : 1;
        this._canvas = this.getImage(this._pixelRatio);
        this._ctx = this._canvas.getContext('2d');
        this._render();
    }


    _render() {
        //èµ·å§è§åº¦
        var sAngle = 0;
        var eAngle = this.getAngle();
        this.spaceAngle = 360 / this.count_ - this.getAngle();
        if (this.spaceAngle < 0) {
            return;
        }
        this._ctx.setTransform(this._pixelRatio, 0, 0, this._pixelRatio, 0, 0);
        this._ctx.translate(0, 0);
        this._ctx.beginPath();
        for (var i = 0; i < this.count_; i++) {
            this._drawSector(this._ctx, this.getAnchor()[0], this.getAnchor()[1], this.getRadius(), sAngle, eAngle);
            sAngle = eAngle + this.spaceAngle;
            eAngle = sAngle + this.getAngle();
        }
        this._fillStroke();
        this._ctx.closePath();
    }

    /**
     * @function CloverShape.prototype.drawSector
     * @description ç»å¶æå½¢ã
     * @param {CanvasRenderingContext2D} ctx - context å¯¹è±¡
     * @param {number} x - ä¸­å¿ç¹ xã
     * @param {number} y - ä¸­å¿ç¹ yã
     * @param {number} r - ä¸­å¿ç¹ rã
     * @param {number} sAngle - æå¶èµ·å§è§åº¦ã
     * @param {number} eAngle - æå¶ç»æ­¢è§åº¦ã
     */
    _drawSector(ctx, x, y, r, sAngle, eAngle) {
        //è§åº¦è½¬æ¢
        sAngle = sAngle / 180 * Math.PI;
        eAngle = eAngle / 180 * Math.PI;
        ctx.moveTo(x, y);
        ctx.lineTo(x + r * Math.cos(sAngle), y + r * Math.sin(sAngle));
        ctx.arc(x, y, r, sAngle, eAngle);
        ctx.lineTo(x, y);
    }

    _fillStroke() {
        if (this.getFill()) {
            this._ctx.globalAlpha = this.fillOpacity;
            this._ctx.fillStyle = this.getFill().color;
            this._ctx.fill();
        }
        if (this.getStroke() && this.weight !== 0) {
            this._ctx.globalAlpha = this.strokeOpacity;
            this._ctx.lineWidth = this.getStroke().width;
            this._ctx.strokeStyle = this.getStroke().color;
            this._ctx.lineCap = this.getStroke().lineCap;
            this._ctx.lineJoin = this.getStroke().lineJoin;
            this._ctx.stroke();
        }
    }
     /**
     * @function  CloverShape.prototype.getCount
     * @description è·åæå¶æ°éã
     */
    getCount() {
        return this.count_;
    }
    /**
     * @function  CloverShape.prototype.getSpaceAngle
     * @description è·åæå¶é´éè§åº¦ã
     */
    getSpaceAngle() {
        return this.spaceAngle;
    }
}

;// CONCATENATED MODULE: ./src/openlayers/overlay/graphic/HitCloverShape.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/**
 * @class HitCloverShape
 * @browsernamespace ol.style
 * @category  Visualization Graphic
 * @classdesc ä¸å¶èè¦ç´ é«äº®é£æ ¼ã
 * @extends {CloverShape}
 * @param {Object} options - ä¸å¶èå½¢è¦ç´ é£æ ¼åæ°ã
 * @param {number} options.sAngle - æå¶èµ·å§è§åº¦ã
 * @param {number} options.eAngle - æå¶ç»æ­¢è§åº¦ã
 * @param {number} [options.angle = 30] - ä¸å¶èæ¯ä¸ªæå¶çåå¿è§ï¼åä½å¼§åº¦ã
 * @param {ol.style.Fill} [options.fill] - å¡«åæ ·å¼ã
 * @param {ol.style.Stroke} [options.stroke] - è¾¹æ¡æ ·å¼ã
 * @param {number} [options.strokeOpacity] - éæåº¦ã
 * @param {number} [options.fillOpacity] - å¡«åéæåº¦ã
 * @param {number} [options.radius] - åå¾ã
 * @usage
 */
class HitCloverShape extends CloverShape {

    constructor(options) {
        super(options);
        this.sAngle = options.sAngle;
        this.eAngle = options.eAngle;
        this._render();
    }


    _render() {
        // draw the circle on the canvas
        this._ctx.clearRect(0, 0, this.getImage().width, this.getImage().height);
        // reset transform
        this._ctx.setTransform(this._pixelRatio, 0, 0, this._pixelRatio, 0, 0);
        this._ctx.translate(0, 0);
        this._ctx.beginPath();

        this._drawSector(this._ctx, this.getAnchor()[0], this.getAnchor()[1], this.getRadius(), this.sAngle, this.eAngle);
        this._fillStroke();

        this._ctx.closePath();
    }
    /**
     * @function HitCloverShape.prototype.getSAngle
     * @description è·åæå¶èµ·å§è§åº¦ã
     */
    getSAngle() {
        return this.sAngle;
    }
    /**
     * @function HitCloverShape.prototype.getEAngle
     * @description è·åæå¶ç»æ­¢è§åº¦ã
     */
    getEAngle() {
        return this.eAngle;
    }
}

;// CONCATENATED MODULE: external "ol.Object"
const external_ol_Object_namespaceObject = ol.Object;
var external_ol_Object_default = /*#__PURE__*/__webpack_require__.n(external_ol_Object_namespaceObject);
;// CONCATENATED MODULE: ./src/openlayers/overlay/graphic/WebGLRenderer.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/






const emptyFunc = () => false;
const CSS_TRANSFORM = (function () {
    let div = document.createElement('div');
    let props = [
        'transform',
        'WebkitTransform',
        'MozTransform',
        'OTransform',
        'msTransform'
    ];

    for (let i = 0; i < props.length; i++) {
        let prop = props[i];
        if (div.style[prop] !== undefined) {
            return prop;
        }
    }
    return props[0];
})();

/**
 * @private
 * @class GraphicWebGLRenderer
 * @classdesc é«æçç¹å¾å± webgl æ¸²æå¨ã
 * @category Visualization Graphic
 * @extends {ol.Object}
 * @param {ol.source.Graphic} layer - é«æçç¹å¾å±ã
 * @param {Object} options - å¾å±åæ°ã
 * @param {number} options.width - å°å¾å®½åº¦ã
 * @param {number} options.height - å°å¾é«åº¦ã
 * @param {HTMLElement} options.container - æ¾ç½®æ¸²æå¨çç¶åç´ ã
 * @param {Array.<number>} [options.color=[0, 0, 0, 255]] - é¢è²ï¼ç®ååªæ¯æ rgba æ°ç»ã 
 * @param {number} [options.radius=10] - åå¾ã
 * @param {number} [options.opacity=0.8] - ä¸éæåº¦ã
 * @param {Array}  [options.highlightColor] - é«äº®é¢è²ï¼ç®ååªæ¯æ rgba æ°ç»ã
 * @param {number} [options.radiusScale = 1] - ç¹æ¾å¤§åæ°ã
 * @param {number} [options.radiusMinPixels = 0] - åå¾æå°å¼ï¼åç´ ï¼ã
 * @param {number} [options.radiusMaxPixels = Number.MAX_SAFE_INTEGER] - åå¾æå¤§å¼ï¼åç´ ï¼ã
 * @param {number} [options.strokeWidth = 1] - è¾¹æ¡å¤§å°ã
 * @param {boolean} [options.outline = false] - æ¯å¦æ¾ç¤ºè¾¹æ¡ã
 * @param {function} [options.onClick] - ç¹å»äºä»¶ã
 * @param {function} [options.onHover] - æ¬åäºä»¶ã
 */
class GraphicWebGLRenderer extends (external_ol_Object_default()) {
    constructor(layer, options) {
        super();
        this.layer = layer;
        this.map = layer.map;
        let opt = options || {};
        Util.extend(this, opt);

        let pixelRatio = this.pixelRatio = window ? window.devicePixelRatio : 1;

        this.width = this.map.getSize()[0] * pixelRatio;
        this.height = this.map.getSize()[1] * pixelRatio;
        this.center = this.map.getView().getCenter();
        this._initContainer();
        this._registerEvents();
    }

    _registerEvents() {
        let map = this.map;
        let view = map.getView();
        map.on('change:size', this._resizeEvent.bind(this), this);
        view.on('change:resolution', this._moveEndEvent.bind(this), this);
        view.on('change:center', this._moveEvent.bind(this), this);
        view.on('change:rotation', this._moveEndEvent.bind(this), this);
        map.on('moveend', this._moveEndEvent.bind(this), this)
    }

    _resizeEvent() {
        this._resize();
        this._clearAndRedraw();
    }

    _moveEvent() {

        let oldCenterPixel = this.map.getPixelFromCoordinate(this.center);
        let newCenterPixel = this.map.getPixelFromCoordinate(this.map.getView().getCenter());

        let offset = [oldCenterPixel[0] - newCenterPixel[0], oldCenterPixel[1] - newCenterPixel[1]];
        this._canvas.style[CSS_TRANSFORM] = 'translate(' + Math.round(offset[0]) + 'px,' + Math.round(offset[1]) + 'px)';
    }

    _moveEndEvent() {
        this._canvas.style[CSS_TRANSFORM] = 'translate(0,0)';
        this.center = this.map.getView().getCenter();
        this._clearAndRedraw();
    }

    _clearAndRedraw() {
        this._clearBuffer();
        this.layer.changed();
    }

    _resize() {
        const size = this.map.getSize();
        const width = size[0] * this.pixelRatio;
        const height = size[1] * this.pixelRatio;
        this._canvas.width = width;
        this._canvas.height = height;
        this._canvas.style.width = width + 'px';
        this._canvas.style.height = height + 'px';
    }

    _clearBuffer() {
        if (!this.deckGL) {
            return;
        }
        let lm = this.deckGL.layerManager;
        lm && lm.context.gl.clear(lm.context.gl.COLOR_BUFFER_BIT);
        return this;
    }

    /**
     * @private
     * @function  GraphicWebGLRenderer.prototype.getCanvas
     * @description è¿åç»å¸ã
     * @returns {HTMLCanvasElement} canvas å¯¹è±¡ã
     */
    getCanvas() {
        return this._canvas;
    }

    /**
     * @private
     * @function  GraphicWebGLRenderer.prototype.update
     * @description  æ´æ°å¾å±ï¼æ°æ®æèæ ·å¼æ¹ååè°ç¨ã
     */
    update(graphics) {
        if (graphics && graphics.length > -1) {
            this._data = graphics;
        }
        if (!this._renderLayer) {
            return;
        }
        this._renderLayer.setChangeFlags({
            dataChanged: true,
            propsChanged: true,
            viewportChanged: true,
            updateTriggersChanged: true
        });

        this._refreshData();
        let state = this._getLayerState();
        state.data = this._data || [];
        this._renderLayer.setNeedsRedraw(true);
        this._renderLayer.setState(state);
    }

    /**
     * @private
     * @function  GraphicWebGLRenderer.prototype.drawGraphics
     * @description ç»å¶ç¹è¦ç´ ã
     */
    drawGraphics(graphics) {
        this._data = graphics ? graphics : this._data ? this._data : [];
        if (!this._renderLayer) {
            this._createInnerRender();
        }
        this._clearBuffer();
        this._draw();
    }

    _initContainer() {
        this._canvas = this._createCanvas(this.width, this.height);
        this._layerContainer = this.container;
        this._wrapper = document.createElement('div');
        this._wrapper.className = "deck-wrapper";
        this._wrapper.style.position = "absolute";
        this._wrapper.style.top = "0";
        this._wrapper.style.left = "0";
        this._wrapper.appendChild(this._canvas);
        this._layerContainer && this._layerContainer.appendChild(this._wrapper);
    }

    _createCanvas(width, height) {

        let canvas = document.createElement('canvas');
        canvas.oncontextmenu = emptyFunc;
        canvas.width = width;
        canvas.height = height;
        canvas.style.width = width + "px";
        canvas.style.height = height + "px";
        return canvas;
    }

    _createInnerRender() {
        let me = this;
        let state = this._getLayerState();
        let {
            color,
            radius,
            opacity,
            highlightColor,
            radiusScale,
            radiusMinPixels,
            radiusMaxPixels,
            strokeWidth,
            outline
        } = state;
        radius = this._pixelToMeter(radius);
        let innerLayerOptions = {
            id: 'scatter-plot',
            data: [],
            pickable: Boolean(this.onClick) || Boolean(this.onHover),
            autoHighlight: true,
            color: color,
            opacity: opacity,
            radius: radius,
            radiusScale: radiusScale,
            highlightColor: highlightColor,
            radiusMinPixels: radiusMinPixels,
            radiusMaxPixels: radiusMaxPixels,
            strokeWidth: strokeWidth,
            outline: outline,
            getPosition(point) {
                if (!point) {
                    return [0, 0, 0];
                }
                let geometry = point.getGeometry();
                let coordinates = geometry && geometry.getCoordinates();
                coordinates = me._project(coordinates);
                return coordinates && [coordinates[0], coordinates[1], 0];
            },
            getColor(point) {
                let defaultStyle = me._getLayerDefaultStyle();
                let style = point && point.getStyle();
                return style && style.getColor() || defaultStyle.color
            },
            getRadius(point) {
                let defaultStyle = me._getLayerDefaultStyle();
                let style = point && point.getStyle();
                return style && style.getRadius() || defaultStyle.radius
            },
            updateTriggers: {
                getColor: [color],
                getRadius: [radius]
            }
        };
        let _self = this;
        if (this.onClick) {
            innerLayerOptions.onClick = function () {
                _self._canvas.style.cursor = "pointer";
                _self.onClick.apply(_self, arguments)
            };
        }
        if (this.onHover) {
            innerLayerOptions.onHover = function () {
                _self._canvas.style.cursor = "pointer";
                _self.onHover.apply(_self, arguments)
            };
        }
        me._renderLayer = new window.DeckGL.ScatterplotLayer(innerLayerOptions);
    }

    _getLayerDefaultStyle() {
        let {
            color,
            opacity,
            radius,
            radiusScale,
            radiusMinPixels,
            radiusMaxPixels,
            strokeWidth,
            outline
        } = this._getLayerState();
        radius = this._pixelToMeter(radius);
        return {
            color,
            opacity,
            radius,
            radiusScale,
            radiusMinPixels,
            radiusMaxPixels,
            strokeWidth,
            outline
        }

    }

    _getLayerState() {
        let state = this.layer.getLayerState();
        let view = this.map.getView();
        let projection = view.getProjection().getCode();
        let center = external_ol_proj_namespaceObject.transform([state.longitude, state.latitude], projection, 'EPSG:4326')
        state.longitude = center[0];
        state.latitude = center[1];
        state.zoom = state.zoom - 1;
        return state;
    }

    _draw() {
        this._refreshData();
        let state = this._getLayerState();
        state.data = this._data || [];
        let deckOptions = {};

        for (let key in state) {
            deckOptions[key] = state[key];
        }
        this._renderLayer.setNeedsRedraw(true);
        deckOptions.layers = [this._renderLayer];
        deckOptions.canvas = this._canvas;
        if (this.onBeforeRender) {
            deckOptions.onBeforeRender = this.onBeforeRender.bind(this);
        }
        if (this.onAfterRender) {
            deckOptions.onAfterRender = this.onAfterRender.bind(this);
        }
        if (!this.deckGL) {
            this.deckGL = new window.DeckGL.experimental.DeckGLJS(deckOptions);
        } else {
            this.deckGL.setProps(deckOptions);
        }
    }

    _refreshData() {
        let graphics = this._data || [];
        let sGraphics = !core_Util_Util.isArray(graphics) ? [graphics] : [].concat(graphics);
        //this.layer.props.dataä¸è½è¢«éæ°èµå¼ï¼åªè½å¨åæ°ç»ä¸è¿è¡æä½
        if (!this._renderLayer.props.data) {
            this._renderLayer.props.data = [];
        }
        this._renderLayer.props.data.length = 0;
        for (let j = 0; j < sGraphics.length; j++) {
            this._renderLayer.props.data.push(sGraphics[j]);
        }
        this._data = this._renderLayer.props.data;
    }

    _project(coordinates) {
        let view = this.map.getView();
        let projection = view.getProjection().getCode();
        if ("EPSG:4326" === projection) {
            return coordinates;
        }
        return external_ol_proj_namespaceObject.transform(coordinates, projection, 'EPSG:4326');
    }
    _pixelToMeter(pixel) {
        let view = this.map.getView();
        let projection = view.getProjection();

        let unit = projection.getUnits() || 'degrees';
        if (unit === 'degrees') {
            unit = Unit.DEGREE;
        }
        if (unit === 'm') {
            unit = Unit.METER;
        }
        const res = view.getResolution();
        if (unit === Unit.DEGREE) {
            let meterRes= res*(Math.PI * 6378137 / 180);
            return pixel * meterRes;
        }else{
            return pixel * res;
        }
    }

}
;// CONCATENATED MODULE: ./src/openlayers/overlay/graphic/CanvasRenderer.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/







//è·åæåç´ åæ ç¹pixelPç¸å¯¹äºä¸­å¿centerè¿è¡ç¼©æ¾scaleRatioååçåç´ ç¹åæ ã
function scale(pixelP, center, scaleRatio) {
    let x = (pixelP[0] - center[0]) * scaleRatio + center[0];
    let y = (pixelP[1] - center[1]) * scaleRatio + center[1];
    return [x, y];
}

/**
 * @private
 * @class GraphicCanvasRenderer
 * @classdesc é«æçç¹å¾å± canvas æ¸²æå¨ã
 * @category Visualization Graphic
 * @extends {ol.Object}
 * @param {Graphic} layer - é«æçç¹å¾å±ã
 * @param {Object} options - å¾å±åæ°ã
 * @param {number} options.width - å°å¾å®½åº¦ã
 * @param {number} options.height - å°å¾é«åº¦ã
 * @param {HTMLElement} options.container - æ¾ç½®æ¸²æå¨çç¶åç´ ã
 * @param {Array.<number>} [options.colo=[0, 0, 0, 255]] - é¢è²ï¼ç®ååªæ¯ærgbaæ°ç»ãé»è®¤[0, 0, 0, 255],
 * @param {number} [options.radius=10] - åå¾ã
 * @param {number} [options.opacity=0.8] - ä¸éæåº¦ã
 * @param {Array}  [options.highlightColor] - é«äº®é¢è²ï¼ç®ååªæ¯ærgbaæ°ç»ã
 * @param {number} [options.radiusScale] - ç¹æ¾å¤§åæ°ã
 * @param {number} [options.radiusMinPixels] - åå¾æå°å¼ï¼åç´ ï¼ã
 * @param {number} [options.radiusMaxPixels] - åå¾æå¤§å¼ï¼åç´ ï¼ã
 * @param {number} [options.strokeWidth] - è¾¹æ¡å¤§å°ã
 * @param {boolean} [options.outline] - æ¯å¦æ¾ç¤ºè¾¹æ¡ã
 * @param {function} [options.onClick] - ç¹å»äºä»¶ã
 * @param {function} [options.onHover] - æ¬åäºä»¶ã
 */
class GraphicCanvasRenderer extends (external_ol_Object_default()) {
    constructor(layer, options) {
        super();
        this.layer = layer;
        this.map = layer.map;
        let opt = options || {};
        Util.extend(this, opt);
        this.highLightStyle = this.layer.highLightStyle;

        this.mapWidth = this.size[0] / this.pixelRatio;
        this.mapHeight = this.size[1] / this.pixelRatio;
        this.width = this.map.getSize()[0];
        this.height = this.map.getSize()[1];
        this.context = core_Util_Util.createCanvasContext2D(this.mapWidth, this.mapHeight);
        this.context.scale(this.pixelRatio, this.pixelRatio);
        this.canvas = this.context.canvas;
        this.canvas.style.width = this.width + 'px';
        this.canvas.style.height = this.height + 'px';
        this._registerEvents();
    }

    _registerEvents() {
        this.map.on('change:size', this._resizeEvent.bind(this), this);
    }

    _resizeEvent() {
        this._resize();
        this._clearAndRedraw();
    }

    _resize() {
        let size = this.map.getSize();
        let width = size[0];
        let height = size[1];
        let xRatio = width / this.width;
        let yRatio = height / this.height;
        this.width = width;
        this.height = height;
        this.mapWidth = this.mapWidth * xRatio;
        this.mapHeight = this.mapHeight * yRatio;
        this.canvas.width = this.mapWidth;
        this.canvas.height = this.mapHeight;
        this.canvas.style.width = this.width + 'px';
        this.canvas.style.height = this.height + 'px';
    }

    _clearAndRedraw() {
        this._clearBuffer();
        this.layer.changed();
    }

    update() {
        this.layer.changed();
    }

    _clearBuffer() {}

    /**
     * @private
     * @function  GraphicCanvasRenderer.prototype.getCanvas
     * @description è¿åç»å¸ã
     * @returns {HTMLCanvasElement} canvas å¯¹è±¡ã
     */
    getCanvas() {
        return this.canvas;
    }

    /**
     * @private
     * @function  GraphicCanvasRenderer.prototype.drawGraphics
     * @description ç»å¶ç¹è¦ç´ ã
     */
    drawGraphics(graphics) {
        this.graphics_ = graphics || [];
        let mapWidth = this.mapWidth;
        let mapHeight = this.mapHeight;

        let vectorContext = external_ol_render_namespaceObject.toContext(this.context, {
            size: [mapWidth, mapHeight],
            pixelRatio: this.pixelRatio
        });
        let defaultStyle = this.layer._getDefaultStyle();
        let me = this,
            layer = me.layer,
            map = layer.map;
        graphics.map(function (graphic) {
            let style = graphic.getStyle() || defaultStyle;
            if (me.selected === graphic) {
                let defaultHighLightStyle = style;
                if (style instanceof external_ol_style_namespaceObject.Circle) {
                    defaultHighLightStyle = new external_ol_style_namespaceObject.Circle({
                        radius: style.getRadius(),
                        fill: new external_ol_style_namespaceObject.Fill({
                            color: 'rgba(0, 153, 255, 1)'
                        }),
                        stroke: style.getStroke(),
                        snapToPixel: core_Util_Util.getOlVersion() === '4' ? style.getSnapToPixel() : null
                    });
                } else if (style instanceof external_ol_style_namespaceObject.RegularShape) {
                    defaultHighLightStyle = new external_ol_style_namespaceObject.RegularShape({
                        radius: style.getRadius(),
                        radius2: style.getRadius2(),
                        points: style.getPoints(),
                        angle: style.getAngle(),
                        snapToPixel: core_Util_Util.getOlVersion() === '4' ? style.getSnapToPixel() : null,
                        rotation: style.getRotation(),
                        rotateWithView: style.getRotateWithView(),
                        fill: new external_ol_style_namespaceObject.Fill({
                            color: 'rgba(0, 153, 255, 1)'
                        }),
                        stroke: style.getStroke()
                    });
                }
                style = me.highLightStyle || defaultHighLightStyle;
            }
            vectorContext.setStyle(
                new external_ol_style_namespaceObject.Style({
                    image: style
                })
            );
            let geometry = graphic.getGeometry();
            let coordinate = geometry.getCoordinates();
            let center = map.getView().getCenter();
            let mapCenterPx = map.getPixelFromCoordinate(center);
            let resolution = map.getView().getResolution();
            let x = (coordinate[0] - center[0]) / resolution;
            let y = (center[1] - coordinate[1]) / resolution;
            let scaledP = [x + mapCenterPx[0], y + mapCenterPx[1]];
            scaledP = scale(scaledP, mapCenterPx, 1);
            //å¤çæ¾å¤§æç¼©å°çº§å«*/
            let result = [scaledP[0] + me.offset[0], scaledP[1] + me.offset[1]];
            let pixelGeometry = new (external_ol_geom_Point_default())(result);
            vectorContext.drawGeometry(pixelGeometry);
            return graphic;
        });
    }
}

;// CONCATENATED MODULE: ./src/openlayers/overlay/graphic/Graphic.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class OverlayGraphic
 * @browsernamespace ol
 * @aliasclass Graphic
 * @category  Visualization Graphic
 * @classdesc é«æçç¹å¾å±ç¹è¦ç´ ç±»ã
 * @param {ol.geom.Point} geometry - å ä½å¯¹è±¡ã
 * @param {Object} [attributes] - è¦ç´ å±æ§ã
 * @extends {ol.Object}
 * @usage
 */
class Graphic_Graphic extends (external_ol_Object_default()) {

    constructor(geometry, attributes) {
        super();
        if (geometry instanceof (external_ol_geom_Geometry_default())) {
            this.geometry_ = geometry;
        }
        this.attributes = attributes;
        this.setStyle();
    }

    /**
     * @function OverlayGraphic.prototype.clone
     * @description åéå½åè¦ç´ ã
     * @returns {OverlayGraphic} åéåçè¦ç´ ã
     */
    clone() {
        var clone = new Graphic_Graphic();
        clone.setId(this.id);
        clone.setGeometry(this.geometry_);
        clone.setAttributes(this.attributes);
        clone.setStyle(this.style_);
        return clone;
    }

    /**
     * @function OverlayGraphic.prototype.getId
     * @description è·åå½å IDã
     * @returns {string} id
     */
    getId() {
        return this.id;
    }

    /**
     * @function OverlayGraphic.prototype.setId
     * @description è®¾ç½®å½åè¦ç´  IDã
     * @param {string} id - è¦ç´  IDã
     */
    setId(id) {
        this.id = id;
    }

    /**
     * @function OverlayGraphic.prototype.getGeometry
     * @description è·åå½åè¦ç´ å ä½ä¿¡æ¯ã
     * @returns {ol.geom.Point} è¦ç´ å ä½ä¿¡æ¯ã
     */
    getGeometry() {
        return this.geometry_;
    }

    /**
     * @function OverlayGraphic.prototype.setGeometry
     * @description è®¾ç½®å½åè¦ç´ å ä½ä¿¡æ¯ã
     * @param {ol.geom.Point} geometry - è¦ç´ å ä½ä¿¡æ¯ã
     */
    setGeometry(geometry) {
        this.geometry_ = geometry;
    }

    /**
     * @function OverlayGraphic.prototype.setAttributes
     * @description è®¾ç½®è¦ç´ å±æ§ã
     * @param {Object} attributes - å±æ§å¯¹è±¡ã
     */
    setAttributes(attributes) {
        this.attributes = attributes;
    }

    /**
     * @function OverlayGraphic.prototype.getAttributes
     * @description è·åè¦ç´ å±æ§ã
     * @returns {Object} è¦ç´ å±æ§ã
     */
    getAttributes() {
        return this.attributes;
    }

    /**
     * @function OverlayGraphic.prototype.getStyle
     * @description è·åæ ·å¼ã
     * @returns {ol.style.Image} ol.style.Image å­ç±»æ ·å¼å¯¹è±¡ã
     */
    getStyle() {
        return this.style_;
    }

    /**
     * @function OverlayGraphic.prototype.setStyle
     * @description è®¾ç½®æ ·å¼ã
     * @param {ol.style.Image} style - æ ·å¼ï¼ol/style/Image å­ç±»æ ·å¼å¯¹è±¡ã
     */
    setStyle(style) {
        if (!this.style && !style) {
            return;
        }
        this.style_ = style;
        this.styleFunction_ = !style ?
            undefined : Graphic_Graphic.createStyleFunction(new (external_ol_style_Style_default())({
                image: style
            }));
        this.changed();
    }

    /**
     * @function OverlayGraphic.prototype.getStyleFunction
     * @description è·åæ ·å¼å½æ°ã
     * @returns {function} æ ·å¼å½æ°ã
     */
    getStyleFunction() {
        return this.styleFunction_;
    }

    /**
     * @function OverlayGraphic.createStyleFunction
     * @description  æ°å»ºæ ·å¼å½æ°ã
     * @param {Object} obj - å¯¹è±¡åæ°ã
     */
    static createStyleFunction(obj) {
        var styleFunction;
        if (typeof obj === 'function') {
            if (obj.length == 2) {
                styleFunction = function (resolution) {
                    return (obj)(this, resolution);
                };
            } else {
                styleFunction = obj;
            }
        } else {
            var styles;
            if (Array.isArray(obj)) {
                styles = obj;
            } else {
                styles = [obj];
            }
            styleFunction = function () {
                return styles;
            };
        }
        return styleFunction;
    }

    /**
     * @function OverlayGraphic.prototype.destroy
     * @description  æ¸é¤åæ°å¼ã
     */
    destroy() {
        this.id = null;
        this.geometry_ = null;
        this.attributes = null;
        this.style_ = null;
    }
}

;// CONCATENATED MODULE: external "ol.geom.Polygon"
const external_ol_geom_Polygon_namespaceObject = ol.geom.Polygon;
var external_ol_geom_Polygon_default = /*#__PURE__*/__webpack_require__.n(external_ol_geom_Polygon_namespaceObject);
;// CONCATENATED MODULE: external "ol.layer.Image"
const external_ol_layer_Image_namespaceObject = ol.layer.Image;
var external_ol_layer_Image_default = /*#__PURE__*/__webpack_require__.n(external_ol_layer_Image_namespaceObject);
;// CONCATENATED MODULE: ./src/openlayers/overlay/Graphic.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/

















const defaultProps = {
    color: [0, 0, 0, 255],
    opacity: 0.8,
    radius: 10,
    radiusScale: 1,
    radiusMinPixels: 0,
    radiusMaxPixels: Number.MAX_SAFE_INTEGER,
    strokeWidth: 1,
    outline: false
};

const Renderer = ['canvas', 'webgl'];

/**
 * @class Graphic
 * @browsernamespace ol.source
 * @category  Visualization Graphic
 * @classdesc é«æçç¹å¾å±æºã
 * @param {Object} options - åæ°ã
 * @param {ol.Map} options.map - openlayers å°å¾å¯¹è±¡ã
 * @param {OverlayGraphic} options.graphics - é«æçç¹å¾å±ç¹è¦ç´ ã
 * @param {string} [options.render ='canvas']  -  æå®ä½¿ç¨çæ¸²æå¨ãå¯éå¼ï¼"webgl"ï¼"canvas"ï¼webgl æ¸²æç®ååªæ¯ææ£ç¹ï¼ã
 * @param {boolean} [options.isHighLight=true] - äºä»¶ååºæ¯å¦æ¯æè¦ç´ é«äº®ã
 * @param {ol.style.Style} [options.highLightStyle=defaultHighLightStyle] - é«äº®é£æ ¼ã
 * @param {Array.<number>} [options.color=[0, 0, 0, 255]] - è¦ç´ é¢è²ãå½ {@link OverlayGraphic} ç style åæ°ä¼ å¥è®¾ç½®äº fill ç {@link HitCloverShape} æ {@link CloverShape}ï¼æ­¤åæ°æ æã
 * @param {Array.<number>} [options.highlightColor] - webgl æ¸²ææ¶è¦ç´ é«äº®é¢è²ã
 * @param {number} [options.opacity=0.8] - è¦ç´ éæåº¦,ãå½ {@link OverlayGraphic} ç style åæ°ä¼ å¥è®¾ç½®äº fillOpacity æ strokeOpacity ç {@link HitCloverShape} æ {@link CloverShape}ï¼æ­¤åæ°æ æã
 * @param {number} [options.radius=10] - è¦ç´ åå¾ï¼åä½åç´ ãå½ {@link OverlayGraphic} ç style åæ°ä¼ å¥è®¾ç½®äº radius ç {@link HitCloverShape} æ {@link CloverShape}ï¼æ­¤åæ°æ æã
 * @param {number} [options.radiusScale=1] - webgl æ¸²ææ¶çè¦ç´ æ¾å¤§åæ°ã
 * @param {number} [options.radiusMinPixels=0] - webgl æ¸²ææ¶çè¦ç´ åå¾æå°å¼ï¼åç´ ï¼ã
 * @param {number} [options.radiusMaxPixels=Number.MAX_SAFE_INTEGER] - webgl æ¸²ææ¶çè¦ç´ åå¾æå¤§å¼ï¼åç´ ï¼ã
 * @param {number} [options.strokeWidth=1] - è¾¹æ¡å¤§å°ã
 * @param {boolean} [options.outline=false] - æ¯å¦æ¾ç¤ºè¾¹æ¡ã
 * @param {function} [options.onHover] -  å¾å±é¼ æ æ¬åååºäºä»¶ï¼åªæ webgl æ¸²ææ¶æç¨ï¼ã
 * @param {function} [options.onClick] -  å¾å±é¼ æ ç¹å»ååºäºä»¶ï¼webglãcanvas æ¸²ææ¶é½æç¨ï¼ã
 * @extends {ol.source.ImageCanvas}
 * @usage
 */
class Graphic extends (external_ol_source_ImageCanvas_default()) {
    constructor(options) {
        super({
            attributions: options.attributions,
            canvasFunction: canvasFunctionInternal_,
            logo: core_Util_Util.getOlVersion() === '4' ? options.logo : null,
            projection: options.projection,
            ratio: options.ratio,
            resolutions: options.resolutions,
            state: options.state
        });
        this.graphics = [].concat(options.graphics);
        this.map = options.map;
        Util.extend(this, options);
        this.render = options.render || Renderer[0];
        if (!core_Util_Util.supportWebGL2()) {
            this.render = Renderer[0];
        }
        this.highLightStyle = options.highLightStyle;
        //æ¯å¦æ¯æé«äº®ï¼é»è®¤æ¯æ
        this.isHighLight = typeof options.isHighLight === 'undefined' ? true : options.isHighLight;
        this.hitGraphicLayer = null;
        this._forEachFeatureAtCoordinate = _forEachFeatureAtCoordinate;

        const me = this;

        if (options.onClick) {
            me.map.on('click', function(e) {
                if (me.renderer instanceof GraphicWebGLRenderer) {
                    return;
                }
                const features = me.map.getFeaturesAtPixel(e.pixel) || [];
                for (let index = 0; index < features.length; index++) {
                    const graphic = features[index];
                    if (me.graphics.indexOf(graphic) > -1) {
                        options.onClick(graphic, e);
                        if (me.isHighLight) {
                            me._highLight(
                                graphic.getGeometry().getCoordinates(),
                                new (external_ol_style_Style_default())({
                                    image: graphic.getStyle()
                                }).getImage(),
                                graphic,
                                e.pixel
                            );
                        }
                        break;
                    }
                }
            });
        }
        //eslint-disable-next-line no-unused-vars
        function canvasFunctionInternal_(extent, resolution, pixelRatio, size, projection) {
            var mapWidth = size[0] / pixelRatio;
            var mapHeight = size[1] / pixelRatio;
            var width = me.map.getSize()[0];
            var height = me.map.getSize()[1];
            if (!me.renderer) {
                me.renderer = createRenderer(size, pixelRatio);
            }
            me.renderer.mapWidth = mapWidth;
            me.renderer.mapHeight = mapHeight;
            me.renderer.pixelRatio = pixelRatio;
            me.renderer.offset = [(mapWidth - width) / 2, (mapHeight - height) / 2];
            let graphics = this.getGraphicsInExtent(extent);
            me.renderer._clearBuffer();
            me.renderer.selected = this.selected;
            me.renderer.drawGraphics(graphics);
            return me.renderer.getCanvas();
        }

        function createRenderer(size, pixelRatio) {
            let renderer;
            if (me.render === Renderer[0]) {
                renderer = new GraphicCanvasRenderer(me, {
                    size,
                    pixelRatio
                });
            } else {
                let optDefault = Util.extend({}, defaultProps);
                let opt = Util.extend(optDefault, {
                    color: me.color,
                    opacity: me.opacity,
                    radius: me.radius,
                    radiusScale: me.radiusScale,
                    radiusMinPixels: me.radiusMinPixels,
                    radiusMaxPixels: me.radiusMaxPixels,
                    strokeWidth: me.strokeWidth,
                    outline: me.outline,
                    onClick: me.onClick,
                    onHover: me.onHover
                });
                opt = Util.extend(me, opt);
                opt.pixelRatio = pixelRatio;
                opt.container = me.map.getViewport().getElementsByClassName('ol-overlaycontainer')[0];
                opt.onBeforeRender = function() {
                    return false;
                };
                opt.onAfterRender = function() {
                    return false;
                };

                renderer = new GraphicWebGLRenderer(me, opt);
            }
            return renderer;
        }

        /**
         * @private
         * @function Graphic.prototype._forEachFeatureAtCoordinate
         * @description è·åå¨è§å¾ä¸çè¦ç´ ã
         * @param {string} coordinate -åæ ã
         * @param {number} resolution -åè¾¨çã
         * @param {RequestCallback} callback -åè°å½æ°ã
         * @param {ol.Pixel} evtPixel - å½åéä¸­çå±å¹åç´ åæ ã
         */
        function _forEachFeatureAtCoordinate(coordinate, resolution, callback, evtPixel, e) {
            let graphics = me.getGraphicsInExtent();
            // FIX æ æ³é«äº®åç´ 
            me._highLightClose();
            for (let i = graphics.length - 1; i >= 0; i--) {
                let style = graphics[i].getStyle();
                if (!style) {
                    return;
                }
                //å·²ç»è¢«é«äº®çgraphics ä¸è¢«ééä¸­
                if (style instanceof HitCloverShape) {
                    continue;
                }
                let center = graphics[i].getGeometry().getCoordinates();
                let image = new (external_ol_style_Style_default())({
                    image: style
                }).getImage();

                let contain = false;
                //icl-1047  å½åªæä¸ä¸ªå¶ççæ¶åï¼å¤æ­æ¯å¦éä¸­çé»è¾å¤ççæ´åç¡®ä¸ç¹
                if (image instanceof CloverShape && image.getCount() === 1) {
                    const ratation = (image.getRotation() * 180) / Math.PI;
                    const angle = Number.parseFloat(image.getAngle());
                    const r = image.getRadius() * resolution;
                    //if(image.getAngle() )
                    let geo = null;
                    if (angle > 355) {
                        geo = new (external_ol_style_Circle_default())(center, r);
                    } else {
                        const coors = [];
                        coors.push(center);
                        const perAngle = angle / 8;
                        for (let index = 0; index < 8; index++) {
                            const radian = ((ratation + index * perAngle) / 180) * Math.PI;
                            coors.push([center[0] + r * Math.cos(radian), center[1] - r * Math.sin(radian)]);
                        }
                        coors.push(center);
                        geo = new (external_ol_geom_Polygon_default())([coors]);
                    }
                    if (geo.intersectsCoordinate(this.map.getCoordinateFromPixel(evtPixel))) {
                        contain = true;
                    }
                } else {
                    let extent = [];
                    extent[0] = center[0] - image.getAnchor()[0] * resolution;
                    extent[2] = center[0] + image.getAnchor()[0] * resolution;
                    extent[1] = center[1] - image.getAnchor()[1] * resolution;
                    extent[3] = center[1] + image.getAnchor()[1] * resolution;
                    if (external_ol_extent_namespaceObject.containsCoordinate(extent, coordinate)) {
                        contain = true;
                    }
                }

                if (contain === true) {
                    if (callback) {
                        callback(graphics[i], e);
                    }
                    continue;
                }
                // if (me.isHighLight) {
                //   // me._highLightClose();
                // }
            }
            return undefined;
        }
    }

    /**
     * @function Graphic.prototype.setGraphics
     * @description è®¾ç½®ç»å¶çç¹è¦ç´ ï¼ä¼è¦çä¹åçææè¦ç´ ã
     * @param {Array.<OverlayGraphic>}  graphics - ç¹è¦ç´ å¯¹è±¡æ°ç»ã
     */
    setGraphics(graphics) {
        this.graphics = this.graphics || [];
        this.graphics.length = 0;
        let sGraphics = !core_Util_Util.isArray(graphics) ? [graphics] : [].concat(graphics);
        this.graphics = [].concat(sGraphics);
        this.update();
    }

    /**
     * @function Graphic.prototype.addGraphics
     * @description è¿½å ç¹è¦ç´ ï¼ä¸ä¼è¦çä¹åçè¦ç´ ã
     * @param {Array.<OverlayGraphic>}  graphics - ç¹è¦ç´ å¯¹è±¡æ°ç»ã
     */
    addGraphics(graphics) {
        this.graphics = this.graphics || [];
        let sGraphics = !core_Util_Util.isArray(graphics) ? [graphics] : [].concat(graphics);
        this.graphics = this.graphics.concat(sGraphics);
        this.update();
    }

    /**
     * @function Graphic.prototype.getGraphicBy
     * @description å¨ Vector çè¦ç´ æ°ç» graphics éé¢éåæ¯ä¸ä¸ª graphicï¼å½ graphic[property]===value æ¶ï¼è¿åæ­¤ graphicï¼å¹¶ä¸åªè¿åç¬¬ä¸ä¸ªï¼ã
     * @param {string} property - graphic çå±æ§åç§°ã
     * @param {string} value - property æå¯¹åºçå¼ã
     * @returns {OverlayGraphic} ä¸ä¸ªå¹éç graphicã
     */
    getGraphicBy(property, value) {
        let graphic = null;
        for (let index in this.graphics) {
            if (this.graphics[index][property] === value) {
                graphic = this.graphics[index];
                break;
            }
        }
        return graphic;
    }

    /**
     * @function Graphic.prototype.getGraphicById
     * @description éè¿ç»å®ä¸ä¸ª idï¼è¿åå¯¹åºçç¢éè¦ç´ ã
     * @param {string} graphicId - ç¢éè¦ç´ çå±æ§ id
     * @returns {OverlayGraphic} ä¸ä¸ªå¹éç graphicã
     */
    getGraphicById(graphicId) {
        return this.getGraphicBy('id', graphicId);
    }

    /**
     * @function Graphic.prototype.getGraphicsByAttribute
     * @description éè¿ç»å®ä¸ä¸ªå±æ§ç key å¼å value å¼ï¼è¿åææå¹éçè¦ç´ æ°ç»ã
     * @param {string} attrName - graphic çæä¸ªå±æ§åç§°ã
     * @param {string} attrValue - property æå¯¹åºçå¼ã
     * @returns {Array.<OverlayGraphic>} ä¸ä¸ªå¹éç graphic æ°ç»ã
     */
    getGraphicsByAttribute(attrName, attrValue) {
        var graphic,
            foundgraphics = [];
        for (let index in this.graphics) {
            graphic = this.graphics[index];
            if (graphic && graphic.attributes) {
                if (graphic.attributes[attrName] === attrValue) {
                    foundgraphics.push(graphic);
                }
            }
        }
        return foundgraphics;
    }

    /**
     * @function Graphic.prototype.removeGraphics
     * @description å é¤è¦ç´ æ°ç»ï¼é»è®¤å°å é¤ææè¦ç´ ã
     * @param {Array.<OverlayGraphic>} [graphics] - å é¤ç graphics æ°ç»ã
     */
    removeGraphics(graphics = null) {
        //å½ graphics ä¸º null ãä¸ºç©ºæ°ç»ï¼æ === this.graphicsï¼åæ¸é¤ææè¦ç´ 
        if (!graphics || graphics.length === 0 || graphics === this.graphics) {
            this.graphics.length = 0;
            this.update();
            return;
        }

        if (!Util.isArray(graphics)) {
            graphics = [graphics];
        }

        for (let i = graphics.length - 1; i >= 0; i--) {
            let graphic = graphics[i];

            //å¦ææä»¬ä¼ å¥çgrapchicå¨graphicsæ°ç»ä¸­æ²¡æçè¯ï¼åä¸è¿è¡å é¤ï¼
            //å¹¶å°å¶æ¾å¥æªå é¤çæ°ç»ä¸­ã
            let findex = Util.indexOf(this.graphics, graphic);

            if (findex === -1) {
                continue;
            }
            this.graphics.splice(findex, 1);
        }

        //å é¤å®æåéæ°è®¾ç½® setGraphicsï¼ä»¥æ´æ°
        this.update();
    }

    /**
     * @function Graphic.prototype.clear
     * @description éæ¾å¾å±èµæºã
     */
    clear() {
        this.removeGraphics();
    }

    /**
     * @function Graphic.prototype.update
     * @description æ´æ°å¾å±ã
     */
    update() {
        this.renderer.update(this.graphics, this._getDefaultStyle());
    }

    _getDefaultStyle() {
        const target = {};
        if (this.color) {
            target.fill = new (external_ol_style_Fill_default())({
                color: this.toRGBA(this.color)
            });
        }
        if (this.radius) {
            target.radius = this.radius;
        }
        if (this.outline) {
            target.stroke = new (external_ol_style_Fill_default())({
                color: this.toRGBA(this.color),
                width: this.strokeWidth
            });
        }
        return new (external_ol_style_Circle_default())(target);
    }

    toRGBA(colorArray) {
        return `rgba(${colorArray[0]},${colorArray[1]},${colorArray[2]},${(colorArray[3] || 255) / 255})`;
    }

    /**
     * @function Graphic.prototype.setStyle
     * @description è®¾ç½®å¾å±è¦ç´ æ´ä½æ ·å¼ï¼æ¥å£ä»å¨ webgl æ¸²ææ¶æç¨ï¼ã
     * @param {Object} styleOptions - æ ·å¼å¯¹è±¡ã
     * @param {Array.<number>} [styleOptions.color=[0, 0, 0, 255]] - ç¹é¢è²ã
     * @param {number} [styleOptions.radius=10] - ç¹åå¾ã
     * @param {number} [styleOptions.opacity=0.8] - ä¸éæåº¦ã
     * @param {Array}  [styleOptions.highlightColor] - é«äº®é¢è²ï¼ç®ååªæ¯æ rgba æ°ç»ã
     * @param {number} [styleOptions.radiusScale=1] - ç¹æ¾å¤§åæ°ã
     * @param {number} [styleOptions.radiusMinPixels=0] - åå¾æå°å¼(åç´ )ã
     * @param {number} [styleOptions.radiusMaxPixels=Number.MAX_SAFE_INTEGER] - åå¾æå¤§å¼(åç´ )ã
     * @param {number} [styleOptions.strokeWidth=1] - è¾¹æ¡å¤§å°ã
     * @param {boolean} [styleOptions.outline=false] - æ¯å¦æ¾ç¤ºè¾¹æ¡ã
     */
    setStyle(styleOptions) {
        let self = this;
        let styleOpt = {
            color: self.color,
            radius: self.radius,
            opacity: self.opacity,
            highlightColor: self.highlightColor,
            radiusScale: self.radiusScale,
            radiusMinPixels: self.radiusMinPixels,
            radiusMaxPixels: self.radiusMaxPixels,
            strokeWidth: self.strokeWidth,
            outline: self.outline
        };

        Util.extend(self, Util.extend(styleOpt, styleOptions));
        self.update();
    }

    /**
     * @function Graphic.prototype.getLayerState
     * @description è·åå½åå°å¾åå¾å±ç¶æã
     * @returns {Object} å°å¾åå¾å±ç¶æï¼åå«å°å¾ç¶æä¿¡æ¯åæ¬å¾å±ç¸å³ç¶æã
     */
    getLayerState() {
        let map = this.map;
        let width = map.getSize()[0];
        let height = map.getSize()[1];

        let view = map.getView();
        let center = view.getCenter();
        let longitude = center[0];
        let latitude = center[1];

        let zoom = view.getZoom();
        let maxZoom = view.getMaxZoom();
        let rotationRadians = view.getRotation();

        let rotation = (-rotationRadians * 180) / Math.PI;

        let mapViewport = {
            longitude: longitude,
            latitude: latitude,
            zoom: zoom,
            maxZoom: maxZoom,
            pitch: 0,
            bearing: rotation
        };
        let state = {};
        for (let key in mapViewport) {
            state[key] = mapViewport[key];
        }
        state.width = width;
        state.height = height;

        state.color = this.color;
        state.radius = this.radius;
        state.opacity = this.opacity;
        state.highlightColor = this.highlightColor;
        state.radiusScale = this.radiusScale;
        state.radiusMinPixels = this.radiusMinPixels;
        state.radiusMaxPixels = this.radiusMaxPixels;
        state.strokeWidth = this.strokeWidth;
        state.outline = this.outline;
        return state;
    }

    /**
     * @function Graphic.prototype._highLightClose
     * @description å³é­é«äº®è¦ç´ æ¾ç¤ºã
     * @private
     */
    _highLightClose() {
        this.selected = null;
        if (this.hitGraphicLayer) {
            this.map.removeLayer(this.hitGraphicLayer);
            this.hitGraphicLayer = null;
        }
        this.changed();
    }

    /**
     * @function Graphic.prototype._highLight
     * @description é«äº®æ¾ç¤ºéä¸­è¦ç´ ã
     * @param {Array.<number>} center - ä¸­å¿ç¹ã
     * @param {ol.style.Style} image - ç¹æ ·å¼ã
     * @param {OverlayGraphic} selectGraphic - é«æçç¹å¾å±ç¹è¦ç´ ã
     * @param {ol.Pixel} evtPixel - å½åéä¸­çå±å¹åç´ åæ ã
     * @private
     */
    _highLight(center, image, selectGraphic, evtPixel) {
        if (selectGraphic.getStyle() instanceof CloverShape) {
            if (this.hitGraphicLayer) {
                this.map.removeLayer(this.hitGraphicLayer);
                this.hitGraphicLayer = null;
            }
            var pixel = this.map.getPixelFromCoordinate([center[0], center[1]]);
            //ç¹å»ç¹ä¸ä¸­å¿ç¹çè§åº¦
            evtPixel = evtPixel || [0, 0];
            var angle = (Math.atan2(evtPixel[1] - pixel[1], evtPixel[0] - pixel[0]) / Math.PI) * 180;
            angle = angle > 0 ? angle : 360 + angle;
            //ç¡®å®æå¶
            var index = Math.ceil(angle / (image.getAngle() + image.getSpaceAngle()));
            //æå¶çèµ·å§è§åº¦
            var sAngle = (index - 1) * (image.getAngle() + image.getSpaceAngle());
            //æ¸²æåæ°
            var opts = {
                stroke: new (external_ol_style_Stroke_default())({
                    color: '#ff0000',
                    width: 1
                }),
                fill: new (external_ol_style_Fill_default())({
                    color: '#0099ff'
                }),
                radius: image.getRadius(),
                angle: image.getAngle(),
                eAngle: sAngle + image.getAngle(),
                sAngle: sAngle,
                rotation: image.getRotation()
            };
            if (this.highLightStyle && this.highLightStyle instanceof HitCloverShape) {
                opts.stroke = this.highLightStyle.getStroke();
                opts.fill = this.highLightStyle.getFill();
                opts.radius = this.highLightStyle.getRadius();
                opts.angle = this.highLightStyle.getAngle();
            }
            var hitGraphic = new Graphic_Graphic(new (external_ol_geom_Point_default())(center));
            hitGraphic.setStyle(new HitCloverShape(opts));
            this.hitGraphicLayer = new (external_ol_layer_Image_default())({
                source: new Graphic({
                    map: this.map,
                    graphics: [hitGraphic]
                })
            });
            this.map.addLayer(this.hitGraphicLayer);
        } else {
            this.selected = selectGraphic;
            this.changed();
        }
    }

    /**
     * @function Graphic.prototype.getGraphicsInExtent
     * @description å¨æå®èå´ä¸­è·åå ä½è¦ç´ é¢ç§¯ã
     * @param {Object} extent - é¿åº¦èå´ã
     */
    getGraphicsInExtent(extent) {
        var graphics = [];
        if (!extent) {
            this.graphics.forEach(graphic => {
                graphics.push(graphic);
            });
            return graphics;
        }
        this.graphics.forEach(graphic => {
            if (external_ol_extent_namespaceObject.containsExtent(extent, graphic.getGeometry().getExtent())) {
                graphics.push(graphic);
            }
        });
        return graphics;
    }
}

;// CONCATENATED MODULE: ./src/openlayers/overlay/theme/GeoFeature.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/






/**
 * @class GeoFeature
 * @browsernamespace ol.source
 * @category Visualization Theme
 * @classdesc å°çå ä½ä¸é¢è¦ç´ åä¸é¢å¾å±åºç±»ã
 * @param {string} name - å¾å±åç§°ã
 * @param {Object} opt_options - åæ°ã
 * @param {ol.Map} opt_options.map - å½å OpenLayers Map å¯¹è±¡ã
 * @param {string} [opt_options.id] - ä¸é¢å¾å± IDãé»è®¤ä½¿ç¨ CommonUtil.createUniqueID("themeLayer_") åå»ºä¸é¢å¾å± IDã
 * @param {number} [opt_options.opacity=1] - å¾å±éæåº¦ã
 * @param {string} [opt_options.logo] - Logoï¼openLayers 5.0.0 åæ´é«çæ¬ä¸åæ¯ææ­¤åæ°ï¼ã
 * @param {ol.proj.Projection} [opt_options.projection] - æå½±ä¿¡æ¯ã
 * @param {number} [opt_options.ratio=1.5] - è§å¾æ¯ï¼1 è¡¨ç¤ºç»å¸æ¯å°å¾è§å£çå¤§å°ï¼2 è¡¨ç¤ºå°å¾è§å£çå®½åº¦åé«åº¦çä¸¤åï¼ä¾æ­¤ç±»æ¨ã å¿é¡»æ¯ 1 ææ´é«ã
 * @param {Array} [opt_options.resolutions] - åè¾¨çæ°ç»ã
 * @param {ol.source.State} [opt_options.state] - èµæºç¶æã
 * @param {Object} [opt_options.style] - ä¸é¢å¾æ ·å¼ã
 * @param {Object} [opt_options.styleGroups] - åä¸é¢ç±»åæ ·å¼ç»ã
 * @param {boolean} [opt_options.isHoverAble=false] - æ¯å¦å¼å¯ hover äºä»¶ã
 * @param {Object} [opt_options.highlightStyle] - å¼å¯ hover äºä»¶åï¼è§¦åçæ ·å¼é£æ ¼ã
 * @param {(string|Object)} [opt_options.attributions='Map Data <span>Â© <a href='http://support.supermap.com.cn/product/iServer.aspx' target='_blank'>SuperMap iServer</a></span> with <span>Â© <a href='https://iclient.supermap.io' target='_blank'>SuperMap iClient</a></span>'] - çæä¿¡æ¯ã
 * @extends {Theme}
 * @usage
 */

class GeoFeature extends theme_Theme_Theme {

    constructor(name, opt_options) {
        super(name, opt_options);
        this.cache = opt_options.cache || {};
        this.cacheFields = opt_options.cacheFields || [];
        this.style = opt_options.style || {};
        this.maxCacheCount = opt_options.maxCacheCount || 0;
        this.isCustomSetMaxCacheCount = opt_options.isCustomSetMaxCacheCount === undefined ? false : opt_options.isCustomSetMaxCacheCount;
        this.nodesClipPixel = opt_options.nodesClipPixel || 2;
        this.isHoverAble = opt_options.isHoverAble === undefined ? false : opt_options.isHoverAble;
        this.isMultiHover = opt_options.isMultiHover === undefined ? false : opt_options.isMultiHover;
        this.isClickAble = opt_options.isClickAble === undefined ? true : opt_options.isClickAble;
        this.highlightStyle = opt_options.highlightStyle || null;
        this.isAllowFeatureStyle = opt_options.isAllowFeatureStyle === undefined ? false : opt_options.isAllowFeatureStyle;
    }

    /**
     * @function GeoFeature.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        this.maxCacheCount = null;
        this.isCustomSetMaxCacheCount = null;
        this.nodesClipPixel = null;
        this.isHoverAble = null;
        this.isMultiHover = null;
        this.isClickAble = null;
        this.cache = null;
        this.cacheFields = null;
        this.style = null;
        this.highlightStyle = null;
        this.isAllowFeatureStyle = null;
    }

    /**
     * @function GeoFeature.prototype.addFeatures
     * @description æ·»å è¦ç´ ã
     * @param {(Array.<ThemeFeature>|Array.<GeoJSONObject>|Array.<ol.Feature>|ThemeFeature|GeoJSONObject|ol.Feature)} features - è¦ç´ å¯¹è±¡ã
     */
    addFeatures(features) {
        this.dispatchEvent({type: 'beforefeaturesadded', value: {features: features}});
        //è½¬æ¢ features å½¢å¼
        this.features = this.toiClientFeature(features);
        if (!this.isCustomSetMaxCacheCount) {
            this.maxCacheCount = this.features.length * 5;
        }
        //ç»å¶ä¸é¢è¦ç´ 
        if (this.renderer) {
            this.changed();
        }
    }

    /**
     * @function GeoFeature.prototype.removeFeatures
     * @description ä»ä¸é¢å¾ä¸­å é¤ featureãè¿ä¸ªå½æ°å é¤ææä¼ éè¿æ¥çç¢éè¦ç´ ã
     * @param {(Array.<FeatureVector>|FeatureVector|Function)} features - å¾å é¤çè¦ç´ å¯¹è±¡æç¨äºè¿æ»¤çåè°å½æ°ã
     */
    removeFeatures(features) { // eslint-disable-line no-unused-vars
        this.clearCache();
        theme_Theme_Theme.prototype.removeFeatures.call(this, features);
    }

    /**
     * @function GeoFeature.prototype.removeAllFeatures
     * @description æ¸é¤å½åå¾å±ææçç¢éè¦ç´ ã
     */
    removeAllFeatures() {
        this.clearCache();
        theme_Theme_Theme.prototype.removeAllFeatures.apply(this, arguments);
    }

    /**
     * @function GeoFeature.prototype.redrawThematicFeatures
     * @description éç»ææä¸é¢è¦ç´ ã
     * @param {Object} extent - è§å¾èå´æ°æ®ã
     */
    redrawThematicFeatures(extent) {
        //è·åé«äº®ä¸é¢è¦ç´ å¯¹åºçç¨æ· id
        var hoverone = this.renderer.getHoverOne();
        var hoverFid = null;
        if (hoverone && hoverone.refDataID) {
            hoverFid = hoverone.refDataID;
        }
        //æ¸é¤å½åææå¯è§åç´ 
        this.renderer.clearAll();

        var features = this.features;
        var cache = this.cache;
        var cacheFields = this.cacheFields;
        var cmZoom = this.map.getView().getZoom();

        var maxCC = this.maxCacheCount;

        for (var i = 0, len = features.length; i < len; i++) {
            var feature = features[i];
            if (!feature.geometry) {
                continue;
            }
            var feaBounds = feature.geometry.getBounds();

            //åé¤å½åè§å¾ï¼å°çï¼èå´ä»¥å¤çæ°æ®
            if (extent) {
                var bounds = new Bounds(extent[0], extent[1], extent[2], extent[3]);
                if (!bounds.intersectsBounds(feaBounds)) {
                    continue;
                }
            }

            //ç¼å­å­æ®µ
            var fields = feature.id + "_zoom_" + cmZoom.toString();

            var thematicFeature;

            //å¤æ­ä¸é¢è¦ç´ ç¼å­æ¯å¦å­å¨
            if (cache[fields]) {
                cache[fields].updateAndAddShapes();
            } else {
                //å¦æä¸é¢è¦ç´ ç¼å­ä¸å­å¨ï¼åå»ºä¸é¢è¦ç´ 
                thematicFeature = this.createThematicFeature(features[i]);

                //æ£æ¥ thematicFeature æ¯å¦æå¯è§åå¾å½¢
                if (thematicFeature.getShapesCount() < 1) {
                    continue;
                }

                //å å¥ç¼å­
                cache[fields] = thematicFeature;
                cacheFields.push(fields);

                //ç¼å­æ°ééå¶
                if (cacheFields.length > maxCC) {
                    var fieldsTemp = cacheFields[0];
                    cacheFields.splice(0, 1);
                    delete cache[fieldsTemp];
                }
            }

        }
        this.renderer.render();

        //å°å¾æ¼«æ¸¸åï¼éæ°é«äº®å¾å½¢
        if (hoverFid && this.isHoverAble && this.isMultiHover) {
            var hShapes = this.getShapesByFeatureID(hoverFid);
            this.renderer.updateHoverShapes(hShapes);
        }
    }

    /**
     * @function GeoFeature.prototype.createThematicFeature
     * @description åå»ºä¸é¢è¦ç´ ã
     * @param {Object} feature - è¦ç´ å¯¹è±¡ã
     * @returns {Array.<FeatureVector>} è¿åç¢éè¦ç´ 
     */
    createThematicFeature(feature) {
        var style = Util.copyAttributesWithClip(this.style);
        if (feature.style && this.isAllowFeatureStyle === true) {
            style = Util.copyAttributesWithClip(feature.style);
        }
        //åå»ºä¸é¢è¦ç´ æ¶çå¯éåæ°
        var options = {};
        options.nodesClipPixel = this.nodesClipPixel;
        options.isHoverAble = this.isHoverAble;
        options.isMultiHover = this.isMultiHover;
        options.isClickAble = this.isClickAble;
        options.highlightStyle = ShapeFactory.transformStyle(this.highlightStyle);
        //å°æ°æ®è½¬ä¸ºä¸é¢è¦ç´ ï¼Vectorï¼
        var thematicFeature = new ThemeVector(feature, this, ShapeFactory.transformStyle(style), options);
        //ç´æ¥æ·»å å¾å½¢å°æ¸²æå¨
        for (var m = 0; m < thematicFeature.shapes.length; m++) {
            this.renderer.addShape(thematicFeature.shapes[m]);
        }
        return thematicFeature;
    }

    canvasFunctionInternal_(extent, resolution, pixelRatio, size, projection) { // eslint-disable-line no-unused-vars
        return theme_Theme_Theme.prototype.canvasFunctionInternal_.apply(this, arguments);
    }

    /**
     * @function GeoFeature.prototype.clearCache
     * @description æ¸é¤ç¼å­ã
     */
    clearCache() {
        this.cache = {};
        this.cacheFields = [];
    }

    /**
     * @function GeoFeature.prototype.clear
     * @description  æ¸é¤çåå®¹åæ¬æ°æ®ï¼featuresï¼ãä¸é¢è¦ç´ ãç¼å­ã
     */
    clear() {
        this.renderer.clearAll();
        this.renderer.refresh();
        this.removeAllFeatures();
        this.clearCache();
    }

    /**
     * @function GeoFeature.prototype.getCacheCount
     * @description è·åå½åç¼å­æ°éã
     * @returns {number} è¿åå½åç¼å­æ°éã
     */
    getCacheCount() {
        return this.cacheFields.length;
    }

    /**
     * @function GeoFeature.prototype.setMaxCacheCount
     * @param {number} cacheCount - ç¼å­æ»æ°ã
     * @description è®¾ç½®æå¤§ç¼å­æ¡æ°ã
     */
    setMaxCacheCount(cacheCount) {
        if (!isNaN(cacheCount)) {
            this.maxCacheCount = cacheCount;
            this.isCustomSetMaxCacheCount = true;
        }
    }

    /**
     * @function GeoFeature.prototype.getShapesByFeatureID
     * @param {number} featureID - è¦ç´  IDã
     * @description éè¿ FeatureID è·å feature å³èçææå¾å½¢ãå¦æä¸ä¼ å¥æ­¤åæ°ï¼å½æ°å°è¿åææå¾å½¢ã
     * @returns {Array} è¿åå¾å½¢æ°ç»
     */
    getShapesByFeatureID(featureID) {
        var list = [];
        var shapeList = this.renderer.getAllShapes();
        if (!featureID) {
            return shapeList
        }
        for (var i = 0, len = shapeList.length; i < len; i++) {
            var si = shapeList[i];
            if (si.refDataID && featureID === si.refDataID) {
                list.push(si);
            }
        }
        return list;
    }

}

;// CONCATENATED MODULE: ./src/openlayers/overlay/Label.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/









/**
 * @class Label
 * @browsernamespace ol.source
 * @category  Visualization Theme
 * @classdesc æ ç­¾ä¸é¢å¾å¾å±æºã
 * @param {string} name - åç§°ã
 * @param {Object} opt_options - åæ°ã
 * @param {ol.Map} opt_options.map - å½å Map å¯¹è±¡ã
 * @param {string} [opt_options.id] - ä¸é¢å¾å± IDãé»è®¤ä½¿ç¨ CommonUtil.createUniqueID("themeLayer_") åå»ºä¸é¢å¾å± IDã
 * @param {number} [opt_options.opacity=1] - å¾å±éæåº¦ã
 * @param {string|Object} [opt_options.attributions] - çæä¿¡æ¯ã
 * @param {string} [opt_options.logo] - Logoï¼openLayers 5.0.0 åæ´é«çæ¬ä¸åæ¯ææ­¤åæ°ï¼ã
 * @param {ol.proj.Projection} [opt_options.projection] - æå½±ä¿¡æ¯ã
 * @param {number} [opt_options.ratio=1.5] - è§å¾æ¯ï¼1 è¡¨ç¤ºç»å¸æ¯å°å¾è§å£çå¤§å°ï¼2 è¡¨ç¤ºå°å¾è§å£çå®½åº¦åé«åº¦çä¸¤åï¼ä¾æ­¤ç±»æ¨ãå¿é¡»æ¯1ææ´é«ã
 * @param {Array.<number>} [opt_options.resolutions] - åè¾¨çæ°ç»ã
 * @param {ol.source.State} [opt_options.state] - èµæºç¶æã
 * @param {string} [opt_options.themeField] - æå®åå»ºä¸é¢å¾å­æ®µã
 * @param {Object} [opt_options.style] - ä¸é¢å¾æ ·å¼ã
 * @param {Object} [opt_options.styleGroups] - åä¸é¢ç±»åæ ·å¼ç»ã
 * @param {boolean} [opt_options.isHoverAble = false] - æ¯å¦å¼å¯ hover äºä»¶ã
 * @param {Object} [opt_options.highlightStyle] - å¼å¯ hover äºä»¶åï¼è§¦åçæ ·å¼é£æ ¼ã
 * @extends {GeoFeature}
 * @usage
 */
class Label_Label extends GeoFeature {

    constructor(name, opt_options) {
        super(name, opt_options);
        this.isOverLay = opt_options.isOverLay != null ? opt_options.isOverLay : true;
        this.isAvoid = opt_options.isAvoid != null ? opt_options.isAvoid : true;

        this.style = opt_options.style;
        this.themeField = opt_options.themeField;
        this.styleGroups = opt_options.styleGroups;

        this.defaultStyle = {
            //é»è®¤ææ¬æ ·å¼
            fontColor: "#000000",
            fontOpacity: 1,
            fontSize: "12px",
            fontStyle: "normal",
            fontWeight: "normal",
            labelAlign: "cm",
            labelXOffset: 0,
            labelYOffset: 0,
            labelRotation: 0,

            //é»è®¤èæ¯æ¡æ ·å¼
            fill: false,
            fillColor: "#ee9900",
            fillOpacity: 0.4,
            stroke: false,
            strokeColor: "#ee9900",
            strokeOpacity: 1,
            strokeWidth: 1,
            strokeLinecap: "round",
            strokeDashstyle: "solid",

            //å¯¹ç¨æ·éèä½å¿é¡»ä¿ææ­¤å¼çå±æ§
            //cursor: "pointer",
            labelSelect: true,

            //ç¨  _isGeoTextStrategyStyle æ è®°æ­¤styleï¼æºå¸¦æ­¤ç±»styleçè¦ç´ ç¹æGeoTextç­ç¥ä¸­çæ ç­¾è¦ç´ 
            _isGeoTextStrategyStyle: true
        };

        //è·åæ ç­¾åç´  bounds çæ¹å¼ã0 - è¡¨ç¤ºéè¿ææ¬ç±»å®¹åææ¬é£æ ¼è®¡ç®è·ååç´ èå´ï¼ç°å¨æ¯æä¸­æãè±æ; 1 - è¡¨ç¤ºéè¿ç»å¶çææ¬æ ç­¾è·ååç´ èå´ï¼æ¯æåä¸ªè¯­ç§çæå­èå´è·åï¼ä½æ§è½æ¶èè¾å¤§ï¼å°¤å¶æ¯éç¨SVGæ¸²æï¼ãé»è®¤å¼ä¸º0ã
        this.getPxBoundsMode = 0;

        this.labelFeatures = [];
    }

    /**
     * @function Label.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        this.style = null;
        this.themeField = null;
        this.styleGroups = null;
        super.destroy();
    }

    /**
     * @private
     * @function Label.prototype.createThematicFeature
     * @description åå»ºä¸é¢è¦ç´ ã
     * @param {FeatureVector} feature - ç¢éè¦ç´ ã
     * @returns {FeatureThemeVector} ä¸é¢å¾ç¢éè¦ç´ ã
     */
    createThematicFeature(feature) {
        //èµ style
        var style = this.getStyleByData(feature);
        //åå»ºä¸é¢è¦ç´ æ¶çå¯éåæ°
        var options = {};
        options.nodesClipPixel = this.nodesClipPixel;
        options.isHoverAble = this.isHoverAble;
        options.isMultiHover = this.isMultiHover;
        options.isClickAble = this.isClickAble;
        options.highlightStyle = ShapeFactory.transformStyle(this.highlightStyle);
        //å°æ°æ®è½¬ä¸ºä¸é¢è¦ç´ ï¼Vectorï¼
        var thematicFeature = new ThemeVector(feature, this, ShapeFactory.transformStyle(style), options);
        //ç´æ¥æ·»å å¾å½¢å°æ¸²æå¨
        for (var m = 0; m < thematicFeature.shapes.length; m++) {
            this.renderer.addShape(thematicFeature.shapes[m]);
        }
        return thematicFeature;
    }


    /**
     * @function Label.prototype.redrawThematicFeatures
     * @description éç»ææä¸é¢è¦ç´ ã
     *              æ­¤æ¹æ³åå«ç»å¶ä¸é¢è¦ç´ çæææ­¥éª¤ï¼åå«ç¨æ·æ°æ®å°ä¸é¢è¦ç´ çè½¬æ¢ï¼æ½ç¨ï¼ç¼å­ç­æ­¥éª¤ã
     *              å°å¾æ¼«æ¸¸æ¶è°ç¨æ­¤æ¹æ³è¿è¡å¾å±å·æ°ã
     * @param {Array.<number>} bounds - éç»èå´ã
     */
    redrawThematicFeatures(bounds) {
        if (this.features.length > 0 && this.labelFeatures.length === 0) {
            var feats = this.setLabelsStyle(this.features);
            for (var i = 0, len = feats.length; i < len; i++) {
                this.labelFeatures.push(feats[i]);
            }
        }
        this.features = this.getDrawnLabels(this.labelFeatures);
        super.redrawThematicFeatures.call(this, bounds);
    }
    /**
     * @function Label.prototype.removeFeatures
     * @description ä»ä¸é¢å¾ä¸­å é¤ featureãè¿ä¸ªå½æ°å é¤ææä¼ éè¿æ¥çç¢éè¦ç´ ã
     * @param {(Array.<FeatureVector>|FeatureVector|Function)} features - å¾å é¤çè¦ç´ å¯¹è±¡æç¨äºè¿æ»¤çåè°å½æ°ã
     */
    removeFeatures(features) { // eslint-disable-line no-unused-vars
        this.labelFeatures = [];
        super.removeFeatures.call(this, features);
    }

    /**
     * @function Label.prototype.removeAllFeatures
     * @description æ¸é¤å½åå¾å±ææçç¢éè¦ç´ ã
     */
    removeAllFeatures() {
        this.labelFeatures = [];
        super.removeAllFeatures.call(this, arguments);
    }
    /**
     * @function Label.prototype.getDrawnLabels
     * @description è·åç»ï¼åçï¼å¤çåå°è¦ç»å¶å¨å¾å±ä¸çæ ç­¾è¦ç´ ã
     * @param {Array.<FeatureVector>} labelFeatures - æææ ç­¾è¦ç´ çæ°ç»ã
     * @returns {Array.<FeatureVector>}  æç»è¦ç»å¶çæ ç­¾è¦ç´ æ°ç»ã
     */
    getDrawnLabels(labelFeatures) {
        var feas = [], //æç»è¦ç»å¶çæ ç­¾è¦ç´ é
            fea, //æç»è¦ç»å¶çæ ç­¾è¦ç´ 
            fi, //ä¸´æ¶æ ç­¾è¦ç´ ï¼ç¨æ·çç¬¬iä¸ªæ ç­¾
            labelsB = [], //ä¸äº§çåççæ ç­¾è¦ç´ èå´é
            styTmp, //ç¨äºä¸´æ¶å­å¨è¦ç´ styleçåé
            feaSty, //æ ç­¾è¦ç´ æç»çstyle
            // styleTempç¨äºå±è½ææ¬styleä¸­å¸¦æåç§»æ§è´¨styleå±æ§ï¼åç§»å·²ç»å¨è®¡ç®boundsçè¿ç¨ä¸­åä¸äºè¿ç®ï¼
            // æä»¥å¨æç»æç§boundsæ¥ç»å¶æ ç­¾æ¶ï¼éå±è½styleä¸­å¸¦æåç§»æ§è´¨å±æ§ï¼å¦åææ¬çåç§»éå°æ©å¤§ä¸åã
            styleTemp = {
                labelAlign: "cm",
                labelXOffset: 0,
                labelYOffset: 0
            };

        var map = this.map;
        var mapSize = map.getSize();
        mapSize = {
            x: mapSize[0],
            y: mapSize[1]
        };
        var zoom = map.getView().getZoom();
        //å¯¹ç¨æ·çæ¯ä¸ªæ ç­¾è¦ç´ è¿è¡å¤çä¸å¤æ­
        for (var i = 0, len = labelFeatures.length; i < len; i++) {
            fi = labelFeatures[i];
            //æ£æ¥fiçstyleå¨é¿è®©ä¸­æ¯å¦è¢«æ¹åï¼å¦ææ¹åï¼éæ°è®¾ç½®è¦ç´ çstyle
            if (fi.isStyleChange) {
                fi = this.setStyle(fi);
            }

            //æ ç­¾æç»çä¸­å¿ç¹åç´ ä½ç½® ï¼åç§»åï¼
            var loc = this.getLabelPxLocation(fi);

            //è¿æ»¤æå°å¾èå´å¤çæ ç­¾ ï¼åç§»åï¼
            if ((loc.x >= 0 && loc.x <= mapSize.x) && (loc.y >= 0 && loc.y <= mapSize.y)) {
                //æ ¹æ®å½åå°å¾ç¼©æ¾çº§å«è¿æ»¤æ ç­¾
                if (fi.style.minZoomLevel > -1) {
                    if (zoom <= fi.style.minZoomLevel) {
                        continue;
                    }
                }
                if (fi.style.maxZoomLevel > -1) {
                    if (zoom > fi.style.maxZoomLevel) {
                        continue;
                    }
                }

                //è®¡ç®æ ç­¾bounds
                var boundsQuad = null;
                if (fi.isStyleChange) {
                    fi.isStyleChange = null;
                    boundsQuad = this.calculateLabelBounds(fi, loc);
                } else {
                    if (fi.geometry.bsInfo.w && fi.geometry.bsInfo.h) {
                        //ä½¿ç¨calculateLabelBounds2å¯ä»¥æé«boundsçè®¡ç®æçï¼å°¤å¶æ¯å¨getPxBoundsMode = 1æ¶
                        boundsQuad = this.calculateLabelBounds2(fi, loc);
                    } else {
                        boundsQuad = this.calculateLabelBounds(fi, loc);
                    }
                }

                //é¿è®©å¤ç -start
                var mapViewBounds = new Bounds(0, mapSize.y, mapSize.x, 0), //å°å¾åç´ èå´
                    quadlen = boundsQuad.length;

                if (this.isAvoid) {
                    var avoidInfo = this.getAvoidInfo(mapViewBounds, boundsQuad); //é¿è®©ä¿¡æ¯

                    if (avoidInfo) {
                        //æ¨ªåï¼xæ¹åï¼ä¸çé¿è®©
                        if (avoidInfo.aspectW === "left") {
                            fi.style.labelXOffset += avoidInfo.offsetX;

                            for (let j = 0; j < quadlen; j++) {
                                boundsQuad[j].x += avoidInfo.offsetX;
                            }
                        } else if (avoidInfo.aspectW === "right") {
                            fi.style.labelXOffset += (-avoidInfo.offsetX);

                            for (let j = 0; j < quadlen; j++) {
                                boundsQuad[j].x += (-avoidInfo.offsetX);
                            }
                        }

                        //çºµåï¼yæ¹åï¼ä¸çé¿è®©
                        if (avoidInfo.aspectH === "top") {
                            fi.style.labelYOffset += avoidInfo.offsetY;

                            for (let j = 0; j < quadlen; j++) {
                                boundsQuad[j].y += avoidInfo.offsetY;
                            }
                        } else if (avoidInfo.aspectH === "bottom") {
                            fi.style.labelYOffset += (-avoidInfo.offsetY);

                            for (let j = 0; j < quadlen; j++) {
                                boundsQuad[j].y += (-avoidInfo.offsetY);
                            }
                        }

                        //å¦æstyleåçååï¼è®°å½ä¸æ¥
                        fi.isStyleChange = true;
                    }
                }
                //é¿è®©å¤ç -end

                //åçå¤ç -start
                if (this.isOverLay) {
                    //æ¯å¦åç
                    var isOL = false;
                    if (i != 0) {
                        for (let j = 0; j < labelsB.length; j++) {
                            //åçå¤æ­
                            if (this.isQuadrilateralOverLap(boundsQuad, labelsB[j])) {
                                isOL = true;
                                break;
                            }
                        }
                    }

                    if (isOL) {
                        continue;
                    } else {
                        labelsB.push(boundsQuad);
                    }
                }
                //åçå¤ç -end

                //å°æ ç­¾åç´ èå´è½¬ä¸ºå°çèå´
                var geoBs = [];
                for (let j = 0; j < quadlen - 1; j++) {
                    geoBs.push(map.getCoordinateFromPixel([boundsQuad[j].x, boundsQuad[j].y]));
                }

                //å±è½æåç§»æ§è´¨çstyleå±æ§,åç§»éå¨ç®boundsæ¶å·²ç»å å¥è®¡ç®
                var bounds = new Bounds(geoBs[3][0], geoBs[3][1], geoBs[1][0], [geoBs[1][1]]);
                var center = bounds.getCenterLonLat();
                var label = new GeoText(center.lon, center.lat, fi.attributes[this.themeField]);
                label.calculateBounds();
                styTmp = Util.cloneObject(fi.style);
                feaSty = Util.cloneObject(Util.copyAttributes(styTmp, styleTemp));
                fea = new Vector(label, fi.attributes, feaSty);
                //èµäºid
                fea.id = fi.id;
                fea.fid = fi.fid;
                feas.push(fea);
            }
        }

        //è¿åæç»è¦ç»å¶çæ ç­¾è¦ç´ 
        return feas;
    }

    /**
     * @function Label.prototype.getStyleByData
     * @description æ ¹æ®ç¨æ·æ°æ®ï¼featureï¼è®¾ç½®ä¸é¢è¦ç´ ç Styleã
     * @param {FeatureVector} feat - ç¢éè¦ç´ å¯¹è±¡ã
     * @returns {Array.<ThemeStyle>} ä¸é¢è¦ç´ ç Styleã
     */
    getStyleByData(feat) {
        var feature = feat;
        feature.style = Util.copyAttributes(feature.style, this.defaultStyle);
        //å°styleèµç»æ ç­¾
        if (this.style && this.style.fontSize && parseFloat(this.style.fontSize) < 12) {
            this.style.fontSize = "12px";
        }
        feature.style = Util.copyAttributes(feature.style, this.style);

        if (this.themeField && this.styleGroups && feature.attributes) {
            var Sf = this.themeField;
            var attributes = feature.attributes;
            var groups = this.styleGroups;
            var isSfInAttrs = false; //æå®ç groupField æ¯å¦æ¯geotextçå±æ§å­æ®µä¹ä¸
            var attr = null; //å±æ§å¼

            for (var property in attributes) {
                if (Sf === property) {
                    isSfInAttrs = true;
                    attr = attributes[property];
                    break;
                }
            }

            //å¤æ­å±æ§å¼æ¯å¦å±äºstyleGroupsçæä¸ä¸ªèå´ï¼ä»¥ä¾¿å¯¹æ ç­¾åç»
            if (isSfInAttrs) {
                for (var i = 0, len = groups.length; i < len; i++) {
                    if ((attr >= groups[i].start) && (attr < groups[i].end)) {
                        var sty1 = groups[i].style;
                        if (sty1 && sty1.fontSize && parseFloat(sty1.fontSize) < 12) {
                            sty1.fontSize = "12px";
                        }
                        feature.style = Util.copyAttributes(feature.style, sty1);
                    }
                }
            }
            feature.style.label = feature.attributes[this.themeField]
        }


        return feature.style;
    }

    /**
     * @function Label.prototype.setLabelsStyle
     * @description è®¾ç½®æ ç­¾è¦ç´ ç Styleã
     * @param {Array.<FeatureVector>} labelFeatures - éè¦è®¾ç½® Style çæ ç­¾è¦ç´ æ°ç»ã
     * @returns {Array.<FeatureVector>} èµäº Style åçæ ç­¾è¦ç´ æ°ç»ã
     */
    setLabelsStyle(labelFeatures) {
        var fea, labelFeas = [];
        for (var i = 0, len = labelFeatures.length; i < len; i++) {
            var feature = labelFeatures[i];
            if (feature.geometry.CLASS_NAME === "SuperMap.Geometry.GeoText") {
                //è®¾ç½®æ ç­¾çStyle
                if (feature.geometry.bsInfo.w || feature.geometry.bsInfo.h) {
                    feature.geometry.bsInfo.w = null;
                    feature.geometry.bsInfo.h = null;
                    feature.geometry.labelWTmp = null;
                }
                fea = this.setStyle(feature);
                //ä¸ºæ ç­¾è¦ç´ æå®å¾å±
                fea.layer = this.layer;
                labelFeas.push(fea);
            } else {
                return labelFeatures;
            }
        }
        return labelFeas;
    }

    /**
     * @function Label.prototype.setStyle
     * @description è®¾ç½®æ ç­¾è¦ç´ ç Styleã
     * @param {FeatureVector} feat - éè¦èµäº style çè¦ç´ ã
     */
    setStyle(feat) {
        var feature = feat;
        feature.style = Util.copyAttributes(feature.style, this.defaultStyle);
        //å°styleèµç»æ ç­¾
        if (this.style && this.style.fontSize && parseFloat(this.style.fontSize) < 12) {
            this.style.fontSize = "12px";
        }
        feature.style = Util.copyAttributes(feature.style, this.style);

        if (this.groupField && this.styleGroups && feature.attributes) {
            var Sf = this.groupField;
            var attributes = feature.attributes;
            var groups = this.styleGroups;
            var isSfInAttrs = false; //æå®ç groupField æ¯å¦æ¯geotextçå±æ§å­æ®µä¹ä¸
            var attr = null; //å±æ§å¼

            for (var property in attributes) {
                if (Sf === property) {
                    isSfInAttrs = true;
                    attr = attributes[property];
                    break;
                }
            }

            //å¤æ­å±æ§å¼æ¯å¦å±äºstyleGroupsçæä¸ä¸ªèå´ï¼ä»¥ä¾¿å¯¹æ ç­¾åç»
            if (isSfInAttrs) {
                for (var i = 0, len = groups.length; i < len; i++) {
                    if ((attr >= groups[i].start) && (attr < groups[i].end)) {
                        var sty1 = groups[i].style;
                        if (sty1 && sty1.fontSize && parseFloat(sty1.fontSize) < 12) {
                            sty1.fontSize = "12px";
                        }
                        feature.style = Util.copyAttributes(feature.style, sty1);
                    }
                }
            }
        }

        //å°ææ¬åå®¹èµå°æ ç­¾è¦ç´ çstyleä¸
        feature.style.label = feature.geometry.text;

        return feature;
    }

    /**
     * @function Label.prototype.getLabelPxLocation
     * @description è·åæ ç­¾è¦ç´ çåç´ åæ ã
     * @param {FeatureVector} feature - æ ç­¾è¦ç´ ã
     * @returns {Object} æ ç­¾ä½ç½®ï¼ä¾å¦ï¼{"x":1,"y":1}ã
     */
    getLabelPxLocation(feature) {
        var geoText = feature.geometry;
        var styleTmp = feature.style;

        //å°æ ç­¾çå°çä½ç½®è½¬ä¸ºåç´ ä½ç½®
        var locationTmp = geoText.getCentroid();
        var locTmp = this.map.getPixelFromCoordinate([locationTmp.x, locationTmp.y]);
        var loc = new (external_ol_geom_Point_default())([locTmp[0], locTmp[1]]);

        //åç§»å¤ç
        if (styleTmp.labelXOffset || styleTmp.labelYOffset) {
            var xOffset = isNaN(styleTmp.labelXOffset) ? 0 : styleTmp.labelXOffset;
            var yOffset = isNaN(styleTmp.labelYOffset) ? 0 : styleTmp.labelYOffset;
            loc.translate(xOffset, -yOffset);
        }
        return {
            x: loc.getCoordinates()[0],
            y: loc.getCoordinates()[1]
        };
    }


    /**
     * @function Label.prototype.calculateLabelBounds
     * @description è·å¾æ ç­¾è¦ç´ çæç»èå´ã
     * @param {FeatureVector} feature - éè¦è®¡ç®boundsçæ ç­¾è¦ç´ æ°ã
     * @param {Object} loc - æ ç­¾ä½ç½®ï¼ä¾å¦ï¼{"x":1,"y":1}ã
     * @returns {Array.<Object>}  åè¾¹å½¢èç¹æ°ç»ãä¾å¦ï¼[{"x":1,"y":1},{"x":3,"y":1},{"x":6,"y":4},{"x":2,"y":10},{"x":1,"y":1}]ã
     */
    calculateLabelBounds(feature, loc) {
        var geoText = feature.geometry;

        //æ ç­¾èå´ï¼æªæè½¬åï¼
        var labB = null;
        var labelInfo = null;
        //è·åboundsçæ¹å¼
        if (this.getPxBoundsMode == 0) {
            labB = geoText.getLabelPxBoundsByText(loc, feature.style);
        } else if (this.getPxBoundsMode === 1) {
            //canvas
            labelInfo = this.getLabelInfo(feature.geometry.getCentroid(), feature.style);
            labB = geoText.getLabelPxBoundsByLabel(loc, labelInfo.w, labelInfo.h, feature.style);
        } else {
            return null;
        }

        //æè½¬Bounds
        var boundsQuad = [];
        if ((feature.style.labelRotation % 180) == 0) {
            boundsQuad = [{
                    "x": labB.left,
                    "y": labB.top
                },
                {
                    "x": labB.right,
                    "y": labB.top
                },
                {
                    "x": labB.right,
                    "y": labB.bottom
                },
                {
                    "x": labB.left,
                    "y": labB.bottom
                },
                {
                    "x": labB.left,
                    "y": labB.top
                }
            ];
        } else {
            boundsQuad = this.rotationBounds(labB, loc, feature.style.labelRotation);
        }

        //éç½®GeoTextçbounds
        geoText.bounds = new Bounds(boundsQuad[1].x, boundsQuad[3].y, boundsQuad[2].x, boundsQuad[4].y);
        return boundsQuad;
    }

    /**
     * @function Label.prototype.calculateLabelBounds2
     * @description è·å¾æ ç­¾è¦ç´ çæç»èå´çå¦ä¸ç§ç®æ³ï¼éè¿è®°å½ä¸çæ ç­¾å®½é«ï¼ï¼æé«è®¡ç® bounds çæçã
     * @param {FeatureVector} feature - éè¦è®¡ç® bounds çæ ç­¾è¦ç´ æ°ã
     * @param {Object} loc - æ ç­¾ä½ç½®ï¼ä¾å¦ï¼{"x":1,"y":1}ã
     * @returns {Array.<Object>} åè¾¹å½¢èç¹æ°ç»ãä¾å¦ï¼[{"x":1,"y":1},{"x":3,"y":1},{"x":6,"y":4},{"x":2,"y":10},{"x":1,"y":1}]ã
     */
    calculateLabelBounds2(feature, loc) {
        var labB, left, bottom, top, right;
        var labelSize = feature.geometry.bsInfo;
        var style = feature.style;
        var locationPx = Util.cloneObject(loc);

        //å¤çæå­å¯¹é½
        if (style.labelAlign && style.labelAlign !== "cm") {
            switch (style.labelAlign) {
                case "lt":
                    locationPx.x += labelSize.w / 2;
                    locationPx.y += labelSize.h / 2;
                    break;
                case "lm":
                    locationPx.x += labelSize.w / 2;
                    break;
                case "lb":
                    locationPx.x += labelSize.w / 2;
                    locationPx.y -= labelSize.h / 2;
                    break;
                case "ct":
                    locationPx.y += labelSize.h / 2;
                    break;
                case "cb":
                    locationPx.y -= labelSize.h / 2;
                    break;
                case "rt":
                    locationPx.x -= labelSize.w / 2;
                    locationPx.y += labelSize.h / 2;
                    break;
                case "rm":
                    locationPx.x -= labelSize.w / 2;
                    break;
                case "rb":
                    locationPx.x -= labelSize.w / 2;
                    locationPx.y -= labelSize.h / 2;
                    break;
                default:
                    break;
            }
        }

        left = locationPx.x - labelSize.w / 2;
        bottom = locationPx.y + labelSize.h / 2;
        //å¤çæä½å­
        if (style.fontStyle && style.fontStyle === "italic") {
            right = locationPx.x + labelSize.w / 2 + parseInt(parseFloat(style.fontSize) / 2);
        } else {
            right = locationPx.x + labelSize.w / 2;
        }
        top = locationPx.y - labelSize.h / 2;

        labB = new Bounds(left, bottom, right, top);

        //æè½¬Bounds
        var boundsQuad = [];
        if ((style.labelRotation % 180) == 0) {
            boundsQuad = [{
                    "x": labB.left,
                    "y": labB.top
                },
                {
                    "x": labB.right,
                    "y": labB.top
                },
                {
                    "x": labB.right,
                    "y": labB.bottom
                },
                {
                    "x": labB.left,
                    "y": labB.bottom
                },
                {
                    "x": labB.left,
                    "y": labB.top
                }
            ];
        } else {
            boundsQuad = this.rotationBounds(labB, loc, style.labelRotation);
        }

        //éç½®GeoTextçbounds
        feature.geometry.bounds = new Bounds(boundsQuad[1].x, boundsQuad[3].y, boundsQuad[2].x, boundsQuad[4].y);
        return boundsQuad;
    }

    /**
     * @function Label.prototype.getLabelInfo
     * @description æ ¹æ®å½åä½ç½®è·åç»å¶åçæ ç­¾ä¿¡æ¯ï¼åæ¬æ ç­¾çå®½ï¼é«åè¡æ°ç­ã
     * @returns {Object} ç»å¶åçæ ç­¾ä¿¡æ¯ã
     */
    getLabelInfo(location, style) {
        var LABEL_ALIGN = {
                "l": "left",
                "r": "right",
                "t": "top",
                "b": "bottom"
            },
            LABEL_FACTOR = {
                "l": 0,
                "r": -1,
                "t": 0,
                "b": -1
            };

        style = Util.extend({
            fontColor: "#000000",
            labelAlign: "cm"
        }, style);
        var pt = this.getLocalXY(location);
        var labelWidth = 0;

        if (style.labelXOffset || style.labelYOffset) {
            var xOffset = isNaN(style.labelXOffset) ? 0 : style.labelXOffset;
            var yOffset = isNaN(style.labelYOffset) ? 0 : style.labelYOffset;
            pt[0] += xOffset;
            pt[1] -= yOffset;
        }

        var canvas = document.createElement('canvas');
        canvas.globalAlpha = 0;
        canvas.lineWidth = 1;

        var ctx = canvas.getContext("2d");

        ctx.fillStyle = style.fontColor;
        ctx.globalAlpha = style.fontOpacity || 1.0;
        var fontStyle = [style.fontStyle ? style.fontStyle : "normal",
            "normal",
            style.fontWeight ? style.fontWeight : "normal",
            style.fontSize ? style.fontSize : "1em",
            style.fontFamily ? style.fontFamily : "sans-serif"
        ].join(" ");
        var labelRows = style.label.split('\n');
        var numRows = labelRows.length;
        var vfactor, lineHeight, labelWidthTmp;
        if (ctx.fillText) {
            // HTML5
            ctx.font = fontStyle;
            ctx.textAlign = LABEL_ALIGN[style.labelAlign[0]] ||
                "center";
            ctx.textBaseline = LABEL_ALIGN[style.labelAlign[1]] ||
                "middle";
            vfactor = LABEL_FACTOR[style.labelAlign[1]];
            if (vfactor == null) {
                vfactor = -.5;
            }
            lineHeight = ctx.measureText('Mg').height ||
                ctx.measureText('xx').width;
            pt[1] += lineHeight * vfactor * (numRows - 1);
            for (let i = 0; i < numRows; i++) {
                labelWidthTmp = ctx.measureText(labelRows[i]).width;
                if (labelWidth < labelWidthTmp) {
                    labelWidth = labelWidthTmp;
                }
            }
        } else if (ctx.mozDrawText) {
            // Mozilla pre-Gecko1.9.1 (<FF3.1)
            ctx.mozTextStyle = fontStyle;
            vfactor = LABEL_FACTOR[style.labelAlign[1]];
            if (vfactor == null) {
                vfactor = -.5;
            }
            lineHeight = ctx.mozMeasureText('xx');
            pt[1] += lineHeight * (1 + (vfactor * numRows));
            for (let i = 0; i < numRows; i++) {
                labelWidthTmp = ctx.measureText(labelRows[i]).width;
                if (labelWidth < labelWidthTmp) {
                    labelWidth = labelWidthTmp;
                }
            }
        }
        var labelInfo = {}; //æ ç­¾ä¿¡æ¯
        if (labelWidth) {
            labelInfo.w = labelWidth; //æ ç­¾çå®½
        } else {
            return null;
        }

        labelInfo.h = style.fontSize; //ä¸è¡æ ç­¾çé«
        labelInfo.rows = labelRows.length; //æ ç­¾çè¡æ°

        return labelInfo;
    }

    /**
     * @function Label.prototype.rotationBounds
     * @description æè½¬ boundsã
     * @param {Bounds} bounds - è¦æè½¬ç boundsã
     * @param {Object} rotationCenterPoi - æè½¬ä¸­å¿ç¹å¯¹è±¡ï¼æ­¤å¯¹è±¡å«æå±æ§ xï¼æ¨ªåæ ï¼ï¼å±æ§ yï¼çºµåæ ï¼ã
     * @param {number} angle - æè½¬è§åº¦ï¼é¡ºæ¶éï¼ã
     * @returns {Array.<Object>} bounds æè½¬åå½¢æçå¤è¾¹å½¢èç¹æ°ç»ãæ¯ä¸ä¸ªåè¾¹å½¢ï¼å½¢å¦ï¼[{"x":1,"y":1},{"x":3,"y":1},{"x":6,"y":4},{"x":2,"y":10},{"x":1,"y":1}]ã
     */
    rotationBounds(bounds, rotationCenterPoi, angle) {
        var ltPoi = new (external_ol_geom_Point_default())([bounds.left, bounds.top]);
        var rtPoi = new (external_ol_geom_Point_default())([bounds.right, bounds.top]);
        var rbPoi = new (external_ol_geom_Point_default())([bounds.right, bounds.bottom]);
        var lbPoi = new (external_ol_geom_Point_default())([bounds.left, bounds.bottom]);

        var ver = [];
        ver.push(this.getRotatedLocation(ltPoi.getCoordinates()[0], ltPoi.getCoordinates()[1], rotationCenterPoi.x, rotationCenterPoi.y, angle));
        ver.push(this.getRotatedLocation(rtPoi.getCoordinates()[0], rtPoi.getCoordinates()[1], rotationCenterPoi.x, rotationCenterPoi.y, angle));
        ver.push(this.getRotatedLocation(rbPoi.getCoordinates()[0], rbPoi.getCoordinates()[1], rotationCenterPoi.x, rotationCenterPoi.y, angle));
        ver.push(this.getRotatedLocation(lbPoi.getCoordinates()[0], lbPoi.getCoordinates()[1], rotationCenterPoi.x, rotationCenterPoi.y, angle));

        //boundsæè½¬åå½¢æçå¤è¾¹å½¢èç¹æ°ç»
        var quad = [];

        for (var i = 0; i < ver.length; i++) {
            quad.push({
                "x": ver[i].x,
                "y": ver[i].y
            });
        }
        quad.push({
            "x": ver[0].x,
            "y": ver[0].y
        });
        return quad;
    }

    /**
     * @function Label.prototype.getRotatedLocation
     * @description è·åä¸ä¸ªç¹ç»æè½¬ä¸­å¿é¡ºæ¶éæè½¬åçä½ç½®ãï¼æ­¤æ¹æ³ç¨äºå±å¹åæ ï¼ã
     * @param {number} x - æè½¬ç¹æ¨ªåæ ã
     * @param {number} y - æè½¬ç¹çºµåæ ã
     * @param {number} rx - æè½¬ä¸­å¿ç¹æ¨ªåæ ã
     * @param {number} ry - æè½¬ä¸­å¿ç¹çºµåæ ã
     * @param {number} angle - æè½¬è§åº¦
     * @returns {Object} æè½¬åçåæ ä½ç½®å¯¹è±¡ï¼è¯¥å¯¹è±¡å«æå±æ§ xï¼æ¨ªåæ ï¼ï¼å±æ§ yï¼çºµåæ ï¼ã
     */
    getRotatedLocation(x, y, rx, ry, angle) {
        var loc = {},
            x0, y0;

        y = -y;
        ry = -ry;
        angle = -angle; //é¡ºæ¶éæè½¬
        x0 = (x - rx) * Math.cos((angle / 180) * Math.PI) - (y - ry) * Math.sin((angle / 180) * Math.PI) + rx;
        y0 = (x - rx) * Math.sin((angle / 180) * Math.PI) + (y - ry) * Math.cos((angle / 180) * Math.PI) + ry;

        loc.x = x0;
        loc.y = -y0;

        return loc;
    }

    /**
     * @function Label.prototype.getAvoidInfo
     * @description è·åé¿è®©çä¿¡æ¯ã
     * @param {Bounds} bounds - å°å¾åç´ èå´ã
     * @param {Array.<Object>} quadrilateral - åè¾¹å½¢èç¹æ°ç»ãä¾å¦ï¼[{"x":1,"y":1},{"x":3,"y":1},{"x":6,"y":4},{"x":2,"y":10},{"x":1,"y":1}]ã
     * @returns {Object} é¿è®©çä¿¡æ¯ã
     */
    getAvoidInfo(bounds, quadrilateral) {
        if (quadrilateral.length !== 5) {
            return null;
        } //ä¸æ¯åè¾¹å½¢

        //å°boundåºååä¸ºç¹æ°ç»å½¢å¼
        var bounddQuad = [{
                "x": bounds.left,
                "y": bounds.top
            },
            {
                "x": bounds.right,
                "y": bounds.top
            },
            {
                "x": bounds.right,
                "y": bounds.bottom
            },
            {
                "x": bounds.left,
                "y": bounds.bottom
            },
            {
                "x": bounds.left,
                "y": bounds.top
            }
        ];

        var isIntersection = false,
            bqLen = bounddQuad.length,
            quadLen = quadrilateral.length;

        var offsetX = 0,
            offsetY = 0,
            aspectH = "",
            aspectW = "";
        for (var i = 0; i < bqLen - 1; i++) {
            for (var j = 0; j < quadLen - 1; j++) {
                var isLineIn = Util.lineIntersection(bounddQuad[i], bounddQuad[i + 1], quadrilateral[j], quadrilateral[j + 1]);
                if (isLineIn.CLASS_NAME === "SuperMap.Geometry.Point") {
                    //è®¾ç½®é¿è®©ä¿¡æ¯
                    setInfo(quadrilateral[j]);
                    setInfo(quadrilateral[j + 1]);
                    isIntersection = true;
                }
            }
        }

        if (isIntersection) {
            //ç»ç»é¿è®©æä½æéçä¿¡æ¯
            return {
                "aspectW": aspectW,
                "aspectH": aspectH,
                "offsetX": offsetX,
                "offsetY": offsetY
            };
        } else {
            return null;
        }


        //åé¨å½æ°ï¼è®¾ç½®é¿è®©ä¿¡æ¯
        //åæ°ï¼vec-{Object}  quadrilateralåè¾¹å½¢åä¸ªèç¹ãå¦ï¼{"x":1,"y":1}ã
        function setInfo(vec) {
            //åè¾¹å½¢ä¸å¨boundsåçèç¹
            if (!bounds.contains(vec.x, vec.y)) {
                //boundsçTopè¾¹
                if (vec.y < bounds.top) {
                    let oY = Math.abs(bounds.top - vec.y);
                    if (oY > offsetY) {
                        offsetY = oY;
                        aspectH = "top";
                    }
                }

                //boundsçBottomè¾¹
                if (vec.y > bounds.bottom) {
                    let oY = Math.abs(vec.y - bounds.bottom);
                    if (oY > offsetY) {
                        offsetY = oY;
                        aspectH = "bottom";
                    }
                }

                //boundsçleftè¾¹
                if (vec.x < bounds.left) {
                    let oX = Math.abs(bounds.left - vec.x);
                    if (oX > offsetX) {
                        offsetX = oX;
                        aspectW = "left";
                    }
                }

                //boundsçrightè¾¹
                if (vec.x > bounds.right) {
                    let oX = Math.abs(vec.x - bounds.right);
                    if (oX > offsetX) {
                        offsetX = oX;
                        aspectW = "right";
                    }
                }
            }
        }

    }


    /**
     * @function Label.prototype.isQuadrilateralOverLap
     * @description å¤æ­ä¸¤ä¸ªåè¾¹å½¢æ¯å¦æåçã
     * @param {Array.<Object>} quadrilateral - åè¾¹å½¢èç¹æ°ç»ãä¾å¦ï¼[{"x":1,"y":1},{"x":3,"y":1},{"x":6,"y":4},{"x":2,"y":10},{"x":1,"y":1}]ã
     * @param {Array.<Object>} quadrilateral2 - ç¬¬äºä¸ªåè¾¹å½¢èç¹æ°ç»ã
     * @returns {boolean} æ¯å¦åçï¼true è¡¨ç¤ºåçã
     */
    isQuadrilateralOverLap(quadrilateral, quadrilateral2) {
        var quadLen = quadrilateral.length,
            quad2Len = quadrilateral2.length;
        if (quadLen !== 5 || quad2Len !== 5) {
            return null;
        } //ä¸æ¯åè¾¹å½¢

        var OverLap = false;
        //å¦æä¸¤åè¾¹å½¢äºä¸åå«å¯¹æ¹çèç¹ï¼åä¸¤ä¸ªåè¾¹å½¢ä¸ç¸äº¤
        for (let i = 0; i < quadLen; i++) {
            if (this.isPointInPoly(quadrilateral[i], quadrilateral2)) {
                OverLap = true;
                break;
            }
        }
        for (let i = 0; i < quad2Len; i++) {
            if (this.isPointInPoly(quadrilateral2[i], quadrilateral)) {
                OverLap = true;
                break;
            }
        }
        //å ä¸ä¸¤ç©å½¢åå­ç¸äº¤çæåµ
        for (let i = 0; i < quadLen - 1; i++) {
            if (OverLap) {
                break;
            }
            for (var j = 0; j < quad2Len - 1; j++) {
                var isLineIn = Util.lineIntersection(quadrilateral[i], quadrilateral[i + 1], quadrilateral2[j], quadrilateral2[j + 1]);
                if (isLineIn.CLASS_NAME === "SuperMap.Geometry.Point") {
                    OverLap = true;
                    break;
                }
            }
        }

        return OverLap;
    }

    /**
     * @function Label.prototype.isPointInPoly
     * @description å¤æ­ä¸ä¸ªç¹æ¯å¦å¨å¤è¾¹å½¢éé¢ï¼å°çº¿æ³ï¼ã
     * @param {Object} pt - éè¦å¤å®çç¹å¯¹è±¡ï¼è¯¥å¯¹è±¡å«æå±æ§ xï¼æ¨ªåæ ï¼ï¼å±æ§ yï¼çºµåæ ï¼ã
     * @param {Array.<Object>} poly - å¤è¾¹å½¢èç¹æ°ç»ãä¾å¦ä¸ä¸ªåè¾¹å½¢ï¼[{"x":1,"y":1},{"x":3,"y":1},{"x":6,"y":4},{"x":2,"y":10},{"x":1,"y":1}]ã
     * @returns {boolean} ç¹æ¯å¦å¨å¤è¾¹å½¢åã
     */
    isPointInPoly(pt, poly) {
        for (var isIn = false, i = -1, l = poly.length, j = l - 1; ++i < l; j = i) {
            ((poly[i].y <= pt.y && pt.y < poly[j].y) || (poly[j].y <= pt.y && pt.y < poly[i].y)) &&
            (pt.x < (poly[j].x - poly[i].x) * (pt.y - poly[i].y) / (poly[j].y - poly[i].y) + poly[i].x) &&
            (isIn = !isIn);
        }
        return isIn;
    }


    canvasFunctionInternal_(extent, resolution, pixelRatio, size, projection) { // eslint-disable-line no-unused-vars
        return super.canvasFunctionInternal_.apply(this, arguments);
    }
}

;// CONCATENATED MODULE: ./src/openlayers/overlay/mapv/MapvCanvasLayer.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
/**
 * @class MapvCanvasLayer
 * @classdesc Mapv æ¸²æå¨ã
 * @private
 * @param {Object} options - åæ°ã
 * @param {number} options.width - ç»å¸å®½ã
 * @param {number} options.height - ç»å¸é«ã
 * @param {string} [options.paneName='mapPane'] - çªå£åã
 * @param {string} [options.context='2d'] - åå®¹ã
 * @param {number} [options.zIndex=2] - å±çº§ã
 * @param {string} [options.mixBlendMode] - æå°æ··åæ¨¡å¼ã
 */
class MapvCanvasLayer {

    constructor(options) {
        this.options = options || {};
        this.enableMassClear = this.options.enableMassClear;
        this._map = options.map;
        this.paneName = this.options.paneName || 'mapPane';
        this.context = this.options.context || '2d';
        this.zIndex = this.options.zIndex || 2;
        this.mixBlendMode = this.options.mixBlendMode || null;
        this.width = options.width;
        this.height = options.height;
        this.initialize();
    }

    initialize() {
        var canvas = this.canvas = document.createElement("canvas");
        canvas.style.cssText = "position:absolute;" + "left:0;" + "top:0;" + "z-index:" + this.zIndex + ";user-select:none;";
        canvas.style.mixBlendMode = this.mixBlendMode;
        canvas.className = "mapvClass";
        var global$2 = typeof window === 'undefined' ? {} : window;
        var devicePixelRatio = this.devicePixelRatio = global$2.devicePixelRatio || 1;
        canvas.width = parseInt(this.width) * devicePixelRatio;
        canvas.height = parseInt(this.height) * devicePixelRatio;
        if (this.context === '2d') {
            canvas.getContext(this.context).scale(devicePixelRatio, devicePixelRatio);
        }
        canvas.style.width = this.width + "px";
        canvas.style.height = this.height + "px";
        if (this.context === 'webgl') {
            this.canvas.getContext(this.context).viewport(0, 0, canvas.width, canvas.height)
        }
    }

    /**
     * @function MapvCanvasLayer.prototype.draw
     * @description çæå°å¾ã
     */
    draw() {
        this.options.update && this.options.update.call(this);
    }

    /**
     * @function MapvCanvasLayer.prototype.resize
     * @param {number} mapWidth - å°å¾å®½åº¦ã
     * @param {number} mapHeight - å°å¾é«åº¦ã
     * @description è°æ´å°å¾å¤§å°ã
     */
    resize(mapWidth, mapHeight) {
        var global$2 = typeof window === 'undefined' ? {} : window;
        var devicePixelRatio = this.devicePixelRatio = global$2.devicePixelRatio || 1;
        this.canvas.width = mapWidth * devicePixelRatio;
        this.canvas.height = mapHeight * devicePixelRatio;
        if (this.context === '2d') {
            this.canvas.getContext('2d').scale(devicePixelRatio, devicePixelRatio);
        }
        this.canvas.style.width = mapWidth + "px";
        this.canvas.style.height = mapHeight + "px";
        if (this.context === 'webgl') {
            this.canvas.getContext(this.context).viewport(0, 0, this.canvas.width, this.canvas.height)
        }
    }

    /**
     * @function MapvCanvasLayer.prototype.getContainer
     * @description è·åå®¹å¨ã
     * @returns {HTMLElement} åå« Mapv å¾å±ç DOM å¯¹è±¡ã
     */
    getContainer() {
        return this.canvas;
    }

    /**
     * @function MapvCanvasLayer.prototype.setZIndex
     * @param {number} zIndex - å±çº§åæ°ã
     * @description è®¾ç½®å¾å±å±çº§ã
     */
    setZIndex(zIndex) {
        this.canvas.style.zIndex = zIndex;
    }

    /**
     * @function MapvCanvasLayer.prototype.getZIndex
     * @description è·åå¾å±å±çº§ã
     */
    getZIndex() {
        return this.zIndex;
    }
}

;// CONCATENATED MODULE: external "function(){try{return mapv}catch(e){return {}}}()"
const external_function_try_return_mapv_catch_e_return_namespaceObject = function(){try{return mapv}catch(e){return {}}}();
;// CONCATENATED MODULE: external "ol.interaction.Pointer"
const external_ol_interaction_Pointer_namespaceObject = ol.interaction.Pointer;
var external_ol_interaction_Pointer_default = /*#__PURE__*/__webpack_require__.n(external_ol_interaction_Pointer_namespaceObject);
;// CONCATENATED MODULE: ./src/openlayers/overlay/mapv/MapvLayer.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




var BaiduMapLayer = external_function_try_return_mapv_catch_e_return_namespaceObject.baiduMapLayer ? external_function_try_return_mapv_catch_e_return_namespaceObject.baiduMapLayer.__proto__ : Function;

/**
 * @class MapvLayer
 * @classdesc MapV å¾å±ç±»ã
 * @private
 * @param {Object} map - å°å¾ã
 * @param {Mapv.DataSet} [dataSet] - æ°æ®éã
 * @param {Object} options - åæ°ã
 * @param {number} mapWidth - å°å¾å®½åº¦ã
 * @param {number} mapHeight - å°å¾é«åº¦ã
 * @param {Object} source - èµæºã
 * @param {number} options.width - ç»å¸å®½ã
 * @param {number} options.height - ç»å¸é«ã
 * @param {string} [options.paneName='mapPane'] - çªå£åã
 * @param {string} [options.context] - åå®¹ã
 * @param {number} [options.zIndex] - å±çº§ã
 * @param {string} [options.mixBlendMode] - æå°æ··åæ¨¡å¼ã
 
 * @extends {Mapv.BaiduMapLayer}
 */
class MapvLayer extends BaiduMapLayer {

    constructor(map, dataSet, options, mapWidth, mapHeight, source) {
        super(map, dataSet, options);
        this.dataSet = dataSet;
        this.mapWidth = mapWidth;
        this.mapHeight = mapHeight;
        var self = this;
        options = options || {};
        this.source = source;
        self.animator = null;
        self.map = map;
        self.init(options);
        self.argCheck(options);
        this.canvasLayer = new MapvCanvasLayer({
            map: map,
            context: this.context,
            paneName: options.paneName,
            mixBlendMode: options.mixBlendMode,
            enableMassClear: options.enableMassClear,
            zIndex: options.zIndex,
            width: mapWidth,
            height: mapHeight,
            update: function update() {
                self._canvasUpdate();
            }
        });
        this.clickEvent = this.clickEvent.bind(this);
        this.mousemoveEvent = this.mousemoveEvent.bind(this);
        map.on('movestart', this.moveStartEvent.bind(this));
        map.on('moveend', this.moveEndEvent.bind(this));
        map.getView().on('change:center', this.zoomEvent.bind(this));
        map.getView().on('change:size', this.sizeEvent.bind(this));
        map.on('pointerdrag', this.dragEvent.bind(this));
        this.bindEvent();
    }

    /**
     * @function MapvLayer.prototype.init
     * @param {Object} options - åæ°ã
     * @description åå§ååæ°ã
     */
    init(options) {
        var self = this;
        self.options = options;
        this.initDataRange(options);
        this.context = self.options.context || '2d';
        if (self.options.zIndex) {
            this.canvasLayer && this.canvasLayer.setZIndex(self.options.zIndex);
        }
        this.initAnimator();
    }

    /**
     * @function MapvLayer.prototype.clickEvent
     * @param {Object} e - äºä»¶åæ°ã
     * @description ç¹å»äºä»¶ã
     */
    clickEvent(e) {
        var pixel = e.pixel;
        super.clickEvent({
            x: pixel[0] + this.offset[0],
            y: pixel[1] + this.offset[1]
        }, e);
    }

    /**
     * @function MapvLayer.prototype.mousemoveEvent
     * @param {Object} e - äºä»¶åæ°ã
     * @description é¼ æ ç§»å¨äºä»¶ã
     */
    mousemoveEvent(e) {
        var pixel = e.pixel;
        super.mousemoveEvent({
            x: pixel[0],
            y: pixel[1]
        }, e);
    }

    /**
     * @function MapvLayer.prototype.dragEvent
     * @description é¼ æ æå¨äºä»¶ã
     */
    dragEvent() {
        this.clear(this.getContext());
    }

    /**
     * @function MapvLayer.prototype.zoomEvent
     * @description ç¼©æ¾äºä»¶ã
     */
    zoomEvent() {
        this.clear(this.getContext());
    }
    /**
     * @function MapvLayer.prototype.sizeEvent
     * @description å°å¾çªå£å¤§å°åçååæ¶è§¦åã
     */
    sizeEvent() {
        this.canvasLayer.resize();
    }


    /**
     * @function MapvLayer.prototype.moveStartEvent
     * @description å¼å§ç§»å¨äºä»¶ã
     */
    moveStartEvent() {
        var animationOptions = this.options.animation;
        if (this.isEnabledTime() && this.animator) {
            this.steps.step = animationOptions.stepsRange.start;
        }
    }

    /**
     * @function MapvLayer.prototype.moveEndEvent
     * @description ç»æç§»å¨äºä»¶ã
     */
    moveEndEvent() {
        this.canvasLayer.draw();
    }

    /**
     * @function MapvLayer.prototype.bindEvent
     * @description ç»å®äºä»¶ã
     */
    bindEvent() {
        var me = this;
        var map = me.map;
        if (me.options.methods) {
            if (me.options.methods.click) {
                map.on('click', me.clickEvent);
            }
            if (me.options.methods.mousemove) {
                me.pointerInteraction = new (external_ol_interaction_Pointer_default())();
                me.pointerInteraction.handleMoveEvent_ = function (event) {
                    me.mousemoveEvent(event);
                };
                map.addInteraction(me.pointerInteraction);
            }
        }
    }

    /**
     * @function MapvLayer.prototype.unbindEvent
     * @description è§£é¤ç»å®äºä»¶ã
     */
    unbindEvent() {
        var map = this.map;
        if (this.options.methods) {
            if (this.options.methods.click) {
                map.un('click', this.clickEvent);
            }
            if (this.options.methods.mousemove) {
                map.removeInteraction(this.pointerInteraction)
            }
        }
    }

    /**
     * @function MapvLayer.prototype.addData
     * @description æ·»å æ°æ®ã
     * @param {Object} data - å¾æ·»å çæ°æ®ã
     * @param {Object} options - å¾æ·»å çæ°æ®ä¿¡æ¯ã
     */
    addData(data, options) {
        var _data = data;
        if (data && data.get) {
            _data = data.get();
        }
        this.dataSet.add(_data);
        this.update({
            options: options
        });
    }

    /**
     * @function MapvLayer.prototype.update
     * @description æ´æ°å¾å±ã
     * @param {Object} opt - å¾æ´æ°çæ°æ®ã
     * @param {Object} opt.data - mapv æ°æ®éã
     */
    update(opt) {
        var update = opt || {};
        var _data = update.data;
        if (_data && _data.get) {
            _data = _data.get();
        }
        if (_data != undefined) {
            this.dataSet.set(_data);
        }
        super.update({
            options: update.options
        });
    }

    draw() {
        this.canvasLayer.draw();
    }

    /**
     * @function MapvLayer.prototype.getData
     * @description è·åæ°æ®ã
     */
    getData() {
        return this.dataSet;
    }

    /**
     * @function MapvLayer.prototype.removeData
     * @description å é¤ç¬¦åè¿æ»¤æ¡ä»¶çæ°æ®ã
     * @param {function} filter - è¿æ»¤æ¡ä»¶ãæ¡ä»¶åæ°ä¸ºæ°æ®é¡¹ï¼è¿åå¼ä¸º trueï¼è¡¨ç¤ºå é¤è¯¥åç´ ï¼å¦åè¡¨ç¤ºä¸å é¤ã
     */
    removeData(filter) {
        if (!this.dataSet) {
            return;
        }
        var newData = this.dataSet.get({
            filter: function (data) {
                return (filter != null && typeof filter === "function") ? !filter(data) : true;
            }
        });
        this.dataSet.set(newData);
        this.update({
            options: null
        });
    }

    /**
     * @function MapvLayer.prototype.clearData
     * @description æ¸é¤æ°æ®ã
     */
    clearData() {
        this.dataSet && this.dataSet.clear();
        this.update({
            options: null
        });
    }

    _canvasUpdate(time) {
        if (!this.canvasLayer) {
            return;
        }
        var self = this;
        var animationOptions = self.options.animation;
        var map = self.map;
        var context = self.canvasLayer.canvas.getContext(self.context);
        if (self.isEnabledTime()) {
            if (time === undefined) {
                self.clear(context);
                return;
            }
            if (!self.context || self.context === '2d') {
                context.save();
                context.globalCompositeOperation = 'destination-out';
                context.fillStyle = 'rgba(0, 0, 0, .1)';
                context.fillRect(0, 0, context.canvas.width, context.canvas.height);
                context.restore();
            }
        } else {
            this.clear(context);
        }
        if (!self.context || self.context === '2d') {
            for (var key in self.options) {
                context[key] = self.options[key];
            }
        } else {
            context.clear(context.COLOR_BUFFER_BIT);
        }
        var ext = map.getView().calculateExtent();
        var topLeftPx = map.getPixelFromCoordinate([ext[0], ext[3]]);

        self._mapCenter = map.getView().getCenter();
        self._mapCenterPx = map.getPixelFromCoordinate(self._mapCenter);
        self._reselutions = map.getView().getResolution();
        self._rotation = -map.getView().getRotation();
        var zoomUnit = self._reselutions;
        var scaleRatio = 1;
        if (this.context != '2d') {
            var global$2 = typeof window === 'undefined' ? {} : window;
            var devicePixelRatio = global$2.devicePixelRatio || 1;
            scaleRatio = devicePixelRatio;
        }
        var dataGetOptions = {
            transferCoordinate: function (coordinate) {
                var x = (coordinate[0] - self._mapCenter[0]) / self._reselutions,
                    y = (self._mapCenter[1] - coordinate[1]) / self._reselutions;
                var scaledP = [x + self._mapCenterPx[0], y + self._mapCenterPx[1]];
                scaledP = scale(scaledP, self._mapCenterPx, 1);
                /*//ææè½¬éçæ¶åå¤çæè½¬
                if (self._rotation !== 0) {
                    var rotatedP = rotate(scaledP, self._rotation, self._mapCenterPx);
                    return [rotatedP[0] + self.offset[0], rotatedP[1] + self.offset[1]];
                }
                //å¤çæ¾å¤§æç¼©å°çº§å«*/
                return [(scaledP[0] + self.offset[0]) * scaleRatio, (scaledP[1] + self.offset[1]) * scaleRatio];
            }
        };

        // //è·åæåç´ åæ ç¹pixelPç»ä¸­å¿centeréæ¶éæè½¬rotationå¼§åº¦åçåç´ ç¹åæ ã
        // function rotate(pixelP, rotation, center) {
        //     var x = Math.cos(rotation) * (pixelP[0] - center[0]) - Math.sin(rotation) * (pixelP[1] - center[1]) + center[0];
        //     var y = Math.sin(rotation) * (pixelP[0] - center[0]) + Math.cos(rotation) * (pixelP[1] - center[1]) + center[1];
        //     return [x, y];
        // }

        //è·åæåç´ åæ ç¹pixelPç¸å¯¹äºä¸­å¿centerè¿è¡ç¼©æ¾scaleRatioååçåç´ ç¹åæ ã
        function scale(pixelP, center, scaleRatio) {
            var x = (pixelP[0] - center[0]) * scaleRatio + center[0];
            var y = (pixelP[1] - center[1]) * scaleRatio + center[1];
            return [x, y];
        }

        if (time !== undefined) {
            dataGetOptions.filter = function (item) {
                var trails = animationOptions.trails || 10;
                return (time && item.time > (time - trails) && item.time < time);
            };
        }
        if (self.isEnabledTime() && !self.notFirst) {
            self.canvasLayer.resize(self.mapWidth, self.mapHeight);
            self.notFirst = true;
        }
        var data = self.dataSet.get(dataGetOptions);
        self.processData(data);
        // å¼å®¹unitä¸º'm'çæåµ
        if (self.options.unit === 'm') {
            if (self.options.size) {
                self.options._size = self.options.size / zoomUnit;
            }
            if (self.options.width) {
                self.options._width = self.options.width / zoomUnit;
            }
            if (self.options.height) {
                self.options._height = self.options.height / zoomUnit;
            }
        } else {
            self.options._size = self.options.size;
            self.options._height = self.options.height;
            self.options._width = self.options.width;
        }

        var pixel = map.getPixelFromCoordinate([0, 0]);
        pixel = [pixel[0] - topLeftPx[0], pixel[1] - topLeftPx[1]];
        this.drawContext(context, data, self.options, {
            x: pixel[0],
            y: pixel[1]
        });
        if (self.isEnabledTime()) {
            this.source.changed();
        }
        self.options.updateCallback && self.options.updateCallback(time);
    }


    isEnabledTime() {
        var animationOptions = this.options.animation;
        return animationOptions && !(animationOptions.enabled === false);
    }


    argCheck(options) {
        if (options.draw === 'heatmap') {
            if (options.strokeStyle) {
                console.warn('[heatmap] options.strokeStyle is discard, pleause use options.strength [eg: options.strength = 0.1]');
            }
        }
    }

    getContext() {
        return this.canvasLayer.canvas.getContext(this.context);
    }


    clear(context) {
        context && context.clearRect && context.clearRect(0, 0, context.canvas.width, context.canvas.height);
    }
}
;// CONCATENATED MODULE: ./src/openlayers/overlay/Mapv.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/




/**
 * @class Mapv
 * @browsernamespace ol.source
 * @category  Visualization MapV
 * @classdesc MapV å¾å±æºã
 * @param {Object} opt_options - åæ°ã
 * @param {ol.Map} opt_options.map - å½å Map å¯¹è±¡ã
 * @param {Mapv.DataSet} opt_options.dataSet - MapV çæ°æ®éã
 * @param {Object} opt_options.mapvOptions - MapV çéç½®å¯¹è±¡ã
 * @param {string} [opt_options.logo] - Logoï¼openLayers 5.0.0 åæ´é«çæ¬ä¸åæ¯ææ­¤åæ°ï¼ã
 * @param {ol.proj.Projection} [opt_options.projection] - æå½±ä¿¡æ¯ã
 * @param {number} [opt_options.ratio=1.5] - è§å¾æ¯ï¼1 è¡¨ç¤ºç»å¸æ¯å°å¾è§å£çå¤§å°ï¼2 è¡¨ç¤ºå°å¾è§å£çå®½åº¦åé«åº¦çä¸¤åï¼ä¾æ­¤ç±»æ¨ã å¿é¡»æ¯ 1 ææ´é«ã
 * @param {Array} [opt_options.resolutions] - åè¾¨çæ°ç»ã
 * @param {ol.source.State} [opt_options.state] - èµæºç¶æã
 * @param {(string|Object)} [opt_options.attributions='Â© 2018 ç¾åº¦ MapV with <span>Â© <a href='https://iclient.supermap.io' target='_blank'>SuperMap iClient</a></span>'] - çæä¿¡æ¯ã
 * @extends {ol.source.ImageCanvas}
 * @usage
 */
class Mapv extends (external_ol_source_ImageCanvas_default()) {

    constructor(opt_options) {
        var options = opt_options ? opt_options : {};
        super({
            attributions: options.attributions || "Â© 2018 ç¾åº¦ MapV with <span>Â© <a href='https://iclient.supermap.io' target='_blank'>SuperMap iClient</a></span>",
            canvasFunction: canvasFunctionInternal_,
            logo: core_Util_Util.getOlVersion() === '4' ? options.logo : null,
            projection: options.projection,
            ratio: options.ratio,
            resolutions: options.resolutions,
            state: options.state
        });
        this.map = opt_options.map;
        this.dataSet = opt_options.dataSet;
        this.mapvOptions = opt_options.mapvOptions;

        function canvasFunctionInternal_(extent, resolution, pixelRatio, size, projection) { // eslint-disable-line no-unused-vars
            var mapWidth = size[0] / pixelRatio;
            var mapHeight = size[1] / pixelRatio;
            var width = this.map.getSize()[0];
            var height = this.map.getSize()[1];
            if (!this.layer) {
                this.layer = new MapvLayer(this.map, this.dataSet, this.mapvOptions, mapWidth, mapHeight, this);
            }
            this.layer.pixelRatio = pixelRatio;
            this.layer.offset = [(mapWidth - width) / 2 , (mapHeight - height) / 2 ];
            if (!this.rotate) {
                this.rotate = this.map.getView().getRotation();
            } else {
                if (this.rotate !== this.map.getView().getRotation()) {
                    this.layer.canvasLayer.resize(mapWidth, mapHeight);
                    this.rotate = this.map.getView().getRotation()
                }
            }
            var canvas = this.layer.canvasLayer.canvas;
            if (!this.layer.isEnabledTime()) {
                this.layer.canvasLayer.resize(mapWidth, mapHeight);
                this.layer.canvasLayer.draw();
            }
            if (!this.context) {
                this.context = core_Util_Util.createCanvasContext2D(mapWidth, mapHeight);
            }
            var canvas2 = this.context.canvas;
            this.context.clearRect(0, 0, canvas2.width, canvas2.height);
            canvas2.width = size[0];
            canvas2.height = size[1];
            canvas2.style.width = size[0] + "px";
            canvas2.style.height = size[1] + "px";
            this.context.drawImage(canvas, 0, 0);
            if (this.resolution !== resolution || JSON.stringify(this.extent) !== JSON.stringify(extent)) {
                this.resolution = resolution;
                this.extent = extent;
            }
            return this.context.canvas;
        }
    }

    /**
     * @function Mapv.prototype.addData
     * @description è¿½å æ°æ®ã
     * @param {Object} data - è¦è¿½å çæ°æ®ã
     * @param {Object} options - è¦è¿½å çå¼ã
     */
    addData(data, options) {
        this.layer.addData(data, options);
    }

    /**
     * @function Mapv.prototype.getData
     * @description è·åæ°æ®ã
     * @returns {Mapv.DataSet} MapV æ°æ®éã
     */
    getData() {
        if (this.layer) {
            this.dataSet = this.layer.getData();
        }
        return this.dataSet;
    }

    /**
     * @function Mapv.prototype.removeData
     * @description å é¤ç¬¦åè¿æ»¤æ¡ä»¶çæ°æ®ã
     * @param {function} filter - è¿æ»¤æ¡ä»¶ãæ¡ä»¶åæ°ä¸ºæ°æ®é¡¹ï¼è¿åå¼ä¸º trueï¼è¡¨ç¤ºå é¤è¯¥åç´ ï¼å¦åè¡¨ç¤ºä¸å é¤ã
     * @example
     *  filter=function(data){
     *    if(data.id=="1"){
     *      return true
     *    }
     *    return false;
     *  }
     */
    removeData(filter) {
        this.layer && this.layer.removeData(filter);
    }

    /**
     * @function Mapv.prototype.clearData
     * @description æ¸é¤æ°æ®ã
     */
    clearData() {
        this.layer.clearData();
    }


    /**
     * @function Mapv.prototype.update
     * @description æ´æ°æ°æ®ã
     * @param {Object} options - å¾æ´æ°çæ°æ®ã
     * @param {Object} options.data - mapv æ°æ®éã
     */
    update(options) {
        this.layer.update(options);
        this.changed();
    }
}

;// CONCATENATED MODULE: ./src/openlayers/overlay/Range.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class Range
 * @browsernamespace ol.source
 * @category  Visualization Theme
 * @classdesc åæ®µä¸é¢å¾å¾å±æºã
 * @param {string} name - åç§°
 * @param {Object} opt_options - åæ°ã
 * @param {ol.Map} opt_options.map - å½åmapå¯¹è±¡ã
 * @param {string} opt_options.themeField - æå®åå»ºä¸é¢å¾å­æ®µã
 * @param {string} [opt_options.id] - ä¸é¢å¾å± IDãé»è®¤ä½¿ç¨ CommonUtil.createUniqueID("themeLayer_") åå»ºä¸é¢å¾å± IDã
 * @param {number} [opt_options.opacity = 1] - å¾å±éæåº¦ã
 * @param {string} [opt_options.logo] - Logoï¼openLayers 5.0.0 åæ´é«çæ¬ä¸åæ¯ææ­¤åæ°ï¼ã
 * @param {ol.proj.Projection} [opt_options.projection] - æå½±ä¿¡æ¯ã
 * @param {number} [opt_options.ratio=1.5] - è§å¾æ¯ï¼1 è¡¨ç¤ºç»å¸æ¯å°å¾è§å£çå¤§å°ï¼2 è¡¨ç¤ºå°å¾è§å£çå®½åº¦åé«åº¦çä¸¤åï¼ä¾æ­¤ç±»æ¨ãå¿é¡»æ¯ 1 ææ´é«ã
 * @param {Array} [opt_options.resolutions] - åè¾¨çæ°ç»ã
 * @param {ol.source.State} [opt_options.state] - èµæºç¶æã
 * @param {Object} [opt_options.style] - ä¸é¢å¾æ ·å¼ã
 * @param {Object} [opt_options.styleGroups] - åä¸é¢ç±»åæ ·å¼ç»ã
 * @param {boolean} [opt_options.isHoverAble = false] - æ¯å¦å¼å¯ hover äºä»¶ã
 * @param {Object} [opt_options.highlightStyle] - å¼å¯ hover äºä»¶åï¼è§¦åçæ ·å¼é£æ ¼ã
 * @param {(string|Object)} [opt_options.attributions='Map Data <span>Â© <a href='http://support.supermap.com.cn/product/iServer.aspx' target='_blank'>SuperMap iServer</a></span> with <span>Â© <a href='https://iclient.supermap.io' target='_blank'>SuperMap iClient</a></span>'] - çæä¿¡æ¯ã
 * @extends {GeoFeature}
 * @usage
 */
class Range extends GeoFeature {

    constructor(name, opt_options) {
        super(name, opt_options);
        this.style = opt_options.style;
        this.isHoverAble = opt_options.isHoverAble;
        this.highlightStyle = opt_options.highlightStyle;
        this.themeField = opt_options.themeField;
        this.styleGroups = opt_options.styleGroups;
    }

    /**
     * @function Range.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        this.style = null;
        this.themeField = null;
        this.styleGroups = null;
        GeoFeature.prototype.destroy.apply(this, arguments);
    }

    /**
     * @private
     * @function Range.prototype.createThematicFeature
     * @description åå»ºä¸é¢å¾è¦ç´ ã
     * @param {Object} feature - è¦åå»ºçä¸é¢å¾å½¢è¦ç´ ã
     */
    createThematicFeature(feature) {
        //èµ style
        var style = this.getStyleByData(feature);
        //åå»ºä¸é¢è¦ç´ æ¶çå¯éåæ°
        var options = {};
        options.nodesClipPixel = this.nodesClipPixel;
        options.isHoverAble = this.isHoverAble;
        options.isMultiHover = this.isMultiHover;
        options.isClickAble = this.isClickAble;
        options.highlightStyle = ShapeFactory.transformStyle(this.highlightStyle);

        //å°æ°æ®è½¬ä¸ºä¸é¢è¦ç´ ï¼ThemeVectorï¼
        var thematicFeature = new ThemeVector(feature, this, ShapeFactory.transformStyle(style), options);

        //ç´æ¥æ·»å å¾å½¢å°æ¸²æå¨
        for (var m = 0; m < thematicFeature.shapes.length; m++) {
            this.renderer.addShape(thematicFeature.shapes[m]);
        }

        return thematicFeature;
    }

    /**
     * @private
     * @function Range.prototype.getStyleByData
     * @description éè¿æ°æ®è·å styleã
     * @param {Object} fea - è¦ç´ æ°æ®ã
     */
    getStyleByData(fea) {
        var style = {};
        var feature = fea;
        style = Util.copyAttributesWithClip(style, this.style);
        if (this.themeField && this.styleGroups && this.styleGroups.length > 0 && feature.attributes) {
            var Sf = this.themeField;
            var Attrs = feature.attributes;
            var Gro = this.styleGroups;
            var isSfInAttrs = false; //æå®ç themeField æ¯å¦æ¯ feature çå±æ§å­æ®µä¹ä¸
            var attr = null; //å±æ§å¼

            for (var property in Attrs) {
                if (Sf === property) {
                    isSfInAttrs = true;
                    attr = Attrs[property];
                    break;
                }
            }
            //å¤æ­å±æ§å¼æ¯å¦å±äºstyleGroupsçæä¸ä¸ªèå´ï¼ä»¥ä¾¿å¯¹è·ååç» style
            if (isSfInAttrs) {
                for (var i = 0, len = Gro.length; i < len; i++) {
                    if ((attr >= Gro[i].start) && (attr < Gro[i].end)) {
                        //feature.style = Util.copyAttributes(feature.style, this.defaultStyle);
                        var sty1 = Gro[i].style;
                        style = Util.copyAttributesWithClip(style, sty1);
                    }
                }
            }
        }
        if (feature.style && this.isAllowFeatureStyle === true) {
            style = Util.copyAttributesWithClip(feature.style);
        }
        return style;
    }

    canvasFunctionInternal_(extent, resolution, pixelRatio, size, projection) { // eslint-disable-line no-unused-vars
        return GeoFeature.prototype.canvasFunctionInternal_.apply(this, arguments);
    }
}

;// CONCATENATED MODULE: ./src/openlayers/overlay/RankSymbol.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class RankSymbol
 * @browsernamespace ol.source
 * @category  Visualization Theme
 * @classdesc ç­çº§ç¬¦å·ä¸é¢å¾å¾å±æºã
 * @param {string} name - ä¸é¢å¾å±åã
 * @param {string} symbolType - æ å¿ç±»åã
 * @param {Object} opt_options - åæ°ã
 * @param {ol.Map} opt_options.map - å½å Map å¯¹è±¡ã
 * @param {string} opt_options.themeFields - æå®åå»ºä¸é¢å¾å­æ®µã
 * @param {Object} opt_options.symbolSetting - ç¬¦å· Circle éç½®å¯¹è±¡ symbolSettingï¼<{@link SuperMap.Layer.RankSymbol}>ï¼ã
 * @param {Array.<number>} opt_options.symbolSetting.codomain - å¾è¡¨åè®¸å±ç¤ºçæ°æ®å¼åï¼é¿åº¦ä¸º 2 çä¸ç»´æ°ç»ï¼ç¬¬ä¸ä¸ªåç´ è¡¨ç¤ºå¼åä¸éï¼ç¬¬äºä¸ªåç´ è¡¨ç¤ºå¼åä¸éã
 * @param {number} [opt_options.symbolSetting.maxR] - åå½¢çæå¤§åå¾ã
 * @param {number} [opt_options.symbolSetting.minR] - åå½¢çæå°åå¾ã
 * @param {string} [opt_options.symbolSetting.fillColor] - åå½¢çå¡«åè²ï¼å¦ï¼fillColor: "#FFB980"ã
 * @param {Object} [opt_options.symbolSetting.circleStyle] - åå½¢çåºç¡ styleï¼æ­¤åæ°æ§å¶åå½¢åºç¡æ ·å¼ï¼ä¼åçº§ä½äº circleStyleByFields å circleStyleByCodomainã
 * @param {number} [opt_options.symbolSetting.decimalNumber] - æ°æ®å¼æ°ç» dataValues åç´ å¼å°æ°ä½æ°ï¼æ°æ®çå°æ°ä½å¤çåæ°ï¼åå¼èå´ï¼[0, 16]ãå¦æä¸è®¾ç½®æ­¤åæ°ï¼å¨åæ°æ®å¼æ¶ä¸å¯¹æ°æ®åå°æ°ä½å¤çã
 * @param {Object} [opt_options.symbolSetting.circleHoverStyle] - åå½¢ hover ç¶ææ¶çæ ·å¼ï¼circleHoverAble ä¸º true æ¶ææã
 * @param {boolean} [opt_options.symbolSetting.circleHoverAble=true] - æ¯å¦åè®¸åå½¢ä½¿ç¨ hover ç¶æãåæ¶è®¾ç½® circleHoverAble å circleClickAble ä¸º falseï¼å¯ä»¥ç´æ¥å±è½å¾å½¢å¯¹ä¸é¢å¾å±äºä»¶çååºã
 * @param {boolean} [opt_options.symbolSetting.circleClickAble=true] - æ¯å¦åè®¸åå½¢è¢«ç¹å»ãåæ¶è®¾ç½® circleHoverAble å circleClickAble ä¸º falseï¼å¯ä»¥ç´æ¥å±è½å¾å½¢å¯¹ä¸é¢å¾å±äºä»¶çååºã
 * @param {string} [opt_options.id] - ä¸é¢å¾å± IDãé»è®¤ä½¿ç¨ CommonUtil.createUniqueID("themeLayer_") åå»ºä¸é¢å¾å± IDã
 * @param {number} [opt_options.opacity=1] - å¾å±éæåº¦ã
 * @param {string} [opt_options.logo] - Logoï¼openLayers 5.0.0 åæ´é«çæ¬ä¸åæ¯ææ­¤åæ°ï¼ã
 * @param {ol.proj.Projection} [opt_options.projection] - æå½±ä¿¡æ¯ã
 * @param {number} [opt_options.ratio=1.5] - è§å¾æ¯ï¼1 è¡¨ç¤ºç»å¸æ¯å°å¾è§å£çå¤§å°ï¼2 è¡¨ç¤ºå°å¾è§å£çå®½åº¦åé«åº¦çä¸¤åï¼ä¾æ­¤ç±»æ¨ã å¿é¡»æ¯ 1 ææ´é«ã
 * @param {Array} [opt_options.resolutions] - åè¾¨çæ°ç»ã
 * @param {ol.source.State} [opt_options.state] - èµæºç¶æã
 * @param {boolean} [opt_options.isOverLay=true] - æ¯å¦è¿è¡åçå¤çï¼å¦æè®¾ä¸º trueï¼å¾è¡¨ç»å¶è¿ç¨ä¸­å°éèå¯¹å·²å¨å¾å±ä¸­ç»å¶çå¾è¡¨äº§çåççå¾è¡¨ã
 * @param {(string|Object)} [opt_options.attributions='Map Data <span>Â© <a href='http://support.supermap.com.cn/product/iServer.aspx' target='_blank'>SuperMap iServer</a></span> with <span>Â© <a href='https://iclient.supermap.io' target='_blank'>SuperMap iClient</a></span>'] - çæä¿¡æ¯ã
 * @extends {Graph}
 * @usage
 */
class RankSymbol_RankSymbol extends Graph_Graph {

    constructor(name, symbolType, opt_options) {
        super(name, symbolType, opt_options);
        this.symbolType = symbolType;
        this.symbolSetting = opt_options.symbolSetting;
        this.themeField = opt_options.themeField;
    }

    /**
     * @function RankSymbol.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        this.symbolType = null;
        this.symbolSetting = null;
        this.themeField = null;
        Graph_Graph.prototype.destroy.apply(this, arguments);
    }

    /**
     * @function RankSymbol.prototype.setSymbolType
     * @description è®¾ç½®æ å¿ç¬¦å·ã
     * @param {string} symbolType - ç¬¦å·ç±»åã
     */
    setSymbolType(symbolType) {
        this.symbolType = symbolType;
        this.redraw();
    }

    /**
     * @private
     * @function RankSymbol.prototype.createThematicFeature
     * @description åå»ºä¸é¢å¾å½¢è¦ç´ ã
     * @param {Object} feature - è¦åå»ºçä¸é¢å¾å½¢è¦ç´ ã
     */
    createThematicFeature(feature) {
        var thematicFeature;
        // æ£æ¥å¾å½¢åå»ºæ¡ä»¶å¹¶åå»ºå¾å½¢
        if (Theme_Theme[this.symbolType] && this.themeField && this.symbolSetting) {
            thematicFeature = new Theme_Theme[this.symbolType](feature, this, [this.themeField], this.symbolSetting);
        }
        // thematicFeature æ¯å¦åå»ºæå
        if (!thematicFeature) {
            return false;
        }
        // å¯¹ä¸é¢è¦ç´ æ§è¡å¾å½¢è£è½½
        thematicFeature.assembleShapes();
        return thematicFeature;
    }

    canvasFunctionInternal_(extent, resolution, pixelRatio, size, projection) { // eslint-disable-line no-unused-vars
        return Graph_Graph.prototype.canvasFunctionInternal_.apply(this, arguments);
    }
}

;// CONCATENATED MODULE: external "function(){try{return turf}catch(e){return {}}}()"
const external_function_try_return_turf_catch_e_return_namespaceObject = function(){try{return turf}catch(e){return {}}}();
;// CONCATENATED MODULE: ./src/openlayers/overlay/Turf.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class Turf
 * @browsernamespace ol.source
 * @category  Visualization Turf
 * @classdesc Turf.js å¾å±æºã
 * @param {Object} opt_options - åæ°ã
 * @extends {ol.source.Vector}
 * @usage
 */
class Turf extends (external_ol_source_Vector_default()) {

    constructor(opt_options) {
        var options = opt_options ? opt_options : {};

        super({
            attributions: options.attributions || "<span>Â© <a href='https://turfjs.org/' target='_blank'>turfjs</a></span> with <span>Â© <a href='https://iclient.supermap.io' target='_blank'>SuperMap iClient</a></span>",
            features: options.features,
            format: options.format,
            extent: options.extent,
            logo: core_Util_Util.getOlVersion() === '4' ? options.logo : null,
            projection: options.projection,
            wrapX: options.wrapX
        });
        this.turfMap = {
            "Measurement.along": ["line", "distance", "units"],
            "Measurement.area": ["geojson"],
            "Measurement.bbox": ["geojson"],
            "Measurement.bboxPolygon": ["bbox"],
            "Measurement.bearing": ["start", "end", "final"],
            "Measurement.center": ["geojson", "properties"],
            "Measurement.centerOfMass": ["geojson", "properties"],
            "Measurement.centroid": ["geojson", "properties"],
            "Measurement.destination": ["origin", "distance", "bearing", "units"],
            "Measurement.distance": ["from", "to", "units"],
            "Measurement.envelope": ["geojson"],
            "Measurement.length": ["geojson", "units"],
            "Measurement.midpoint": ["point1", "point2"],
            "Measurement.pointOnFeature": ["geojson"],
            "Measurement.polygonTangents": ["point", "polygon"],
            "Measurement.rhumbBearing": ["start", "end", "final"],
            "Measurement.rhumbDestination": ["origin", "distance", "bearing", "units"],
            "Measurement.rhumbDistance": ["from", "to", "units"],
            "Measurement.square": ["bbox"],
            "Measurement.greatCircle": ["start", "end", "properties", "npoints", "offset"],
            "CoordinateMutation.cleanCoords":["geojson","mutate"],
            "CoordinateMutation.flip": ["geojson", "mutate"],
            "CoordinateMutation.rewind": ["geojson", "reverse", "mutate"],
            "CoordinateMutation.round": ["num", "precision"],
            "CoordinateMutation.truncate": ["geojson", "precision", "coordinates", "mutate"],
            "Transformation.bboxClip": ["feature", "bbox"],
            "Transformation.bezierSpline": ["line", "resolution", "sharpness"],
            "Transformation.buffer": ["geojson", "radius", "units", "steps"],
            "Transformation.circle": ["center", "radius", "steps", "units", "properties"],
            "Transformation.clone": ["geojson"],
            "Transformation.concave": ["points", "maxEdge", "units"],
            "Transformation.convex": ["geojson","concavity"],
            "Transformation.difference": ["polygon1", "polygon2"],
            "Transformation.dissolve": ["featureCollection", "propertyName"],
            "Transformation.intersect": ["poly1", "poly2"],
            "Transformation.lineOffset": ["geojson", "distance", "units"],
            "Transformation.simplify": ["feature", "tolerance", "highQuality"],
            "Transformation.tesselate": ["poly"],
            "Transformation.transformRotate": ["geojson", "angle", "pivot", "mutate"],
            "Transformation.transformTranslate": ["geojson", "distance", "direction", "units", "zTranslation", "mutate"],
            "Transformation.transformScale": ["geojson", "factor", "origin", "mutate"],
            "Transformation.union": ["A"],
            "Transformation.voronoi": ["points","bbox"],
            "featureConversion.combine": ["fc"],
            "featureConversion.explode": ["geojson"],
            "featureConversion.flatten": ["geojson"],
            "featureConversion.lineStringToPolygon": ["lines", "properties", "autoComplete", "orderCoords"],
            "featureConversion.polygonize": ["geojson"],
            "featureConversion.polygonToLineString": ["polygon", "properties"],
            "Misc.kinks": ["featureIn"],
            "Misc.lineArc": ["center", "radius", "bearing1", "bearing2", "steps", "units"],
            "Misc.lineChunk": ["geojson", "segmentLength", "units", "reverse"],
            "Misc.lineIntersect": ["line1", "line2"],
            "Misc.lineOverlap": ["line1", "line2"],
            "Misc.lineSegment": ["geojson"],
            "Misc.lineSlice": ["startPt", "stopPt", "line"],
            "Misc.lineSliceAlong": ["line", "startDist", "stopDist", "units"],
            "Misc.lineSplit": ["line", "splitter"],
            "Misc.mask": ["polygon", "mask"],
            "Misc.pointOnLine": ["lines", "pt", "units"],
            "Misc.sector": ["center", "radius", "bearing1", "bearing2", "steps", "units"],
            "Misc.shortestPath": ["start", "end", "obstacles", "units","resolution"],
            "Misc.unkinkPolygon": ["geojson"],
            "Helper.featureCollection": ["features","bbox","id"],
            "Helper.feature": ["geometry", "properties","bbox","id"],
            "Helper.geometryCollection": ["geometries", "properties","bbox","id"],
            "Helper.lineString": ["coordinates", "properties","bbox","id"],
            "Helper.multiLineString": ["coordinates", "properties","bbox","id"],
            "Helper.multiPoint": ["coordinates", "properties","bbox","id"],
            "Helper.multiPolygon": ["coordinates", "properties","bbox","id"],
            "Helper.point": ["coordinates", "properties","bbox","id"],
            "Helper.polygon": ["coordinates", "properties","bbox","id"],
            "Data.sample": ["featurecollection", "num"],
            "Interpolation.interpolate": ["points", "cellSize", "gridType", "property", "units", "weight"],
            "Interpolation.isobands": ["pointGrid", "breaks", "zProperty", "commonProperties","breaksProperties"],
            "Interpolation.isolines": ["pointGrid", "breaks", "zProperty", "commonProperties", "breaksProperties"],
            "Interpolation.planepoint": ["point", "triangle"],
            "Interpolation.tin": ["points", "z"],
            "Joins.pointsWithinPolygon": ["points", "polygons"],
            "Joins.tag": ["points", "polygons", "field", "outField","mask","properties"],
            "Grids.hexGrid": ["bbox", "cellSide", "units", "triangles"],
            "Grids.pointGrid": ["bbox", "cellSide", "units", "mask","properties"],
            "Grids.squareGrid": ["bbox", "cellSide", "units", "mask","properties"],
            "Grids.triangleGrid": ["bbox", "cellSide", "units", "mask","properties"],
            "Classification.nearestPoint": ["targetPoint", "points"],
            "Aggregation.collect": ["polygons", "points", "inProperty", "outProperty"],
            "Aggregation.clustersDbscan": ["points", "maxDistance", "units", "minPoints","mutate"],
            "Aggregation.clustersKmeans": ["points", "numberOfClusters", "mutate"],
            "Meta.coordAll": ["geojson"],
            "Meta.coordEach": ["geojson", "callback", "excludeWrapCoord"],
            "Meta.coordReduce": ["geojson", "callback", "initialValue", "excludeWrapCoord"],
            "Meta.featureEach": ["geojson", "callback"],
            "Meta.featureReduce": ["geojson", "callback", "initialValue"],
            "Meta.flattenEach": ["geojson", "callback"],
            "Meta.flattenReduce": ["geojson", "callback", "initialValue"],
            "Meta.getCoord": ["coord"],
            "Meta.getCoords": ["coords"],
            "Meta.getGeom": ["geojson"],
            "Meta.getGeomType": ["geojson","name"],
            "Meta.geomEach": ["geojson", "callback"],
            "Meta.geomReduce": ["geojson", "callback", "initialValue"],
            "Meta.propEach": ["geojson", "callback"],
            "Meta.propReduce": ["geojson", "callback", "initialValue"],
            "Meta.segmentEach": ["geojson", "callback"],
            "Meta.segmentReduce": ["geojson", "callback", "initialValue"],
            "Meta.getCluster": ["geojson", "filter"],
            "Meta.clusterEach": ["geojson", "property", "callback"],
            "Meta.clusterReduce": ["geojson", "property", "callback", "initialValue"],
            "Assertions.collectionOf": ["featureCollection", "type", "name"],
            "Assertions.containsNumber": ["coordinates"],
            "Assertions.geojsonType": ["value", "type", "name"],
            "Assertions.featureOf": ["feature", "type", "name"],
            "Booleans.booleanClockwise": ["line"],
            "Booleans.booleanContains": ["feature1", "feature2"],
            "Booleans.booleanCrosses": ["feature1", "feature2"],
            "Booleans.booleanDisjoint": ["feature1", "feature2"],
            "Booleans.booleanEqual": ["feature1", "feature2"],
            "Booleans.booleanOverlap": ["feature1", "feature2"],
            "Booleans.booleanParallel": ["feature1", "feature2"],
            "Booleans.booleanPointInPolygon": ["point", "polygon", "ignoreBoundary"],
            "Booleans.booleanPointOnLine": ["point", "linestring", "ignoreEndVertices"],
            "UnitConversion.bearingToAngle": ["bearing"],
            "UnitConversion.convertArea": ["area", "originalUnit", "finalUnit"],
            "UnitConversion.convertLength": ["length", "originalUnit", "finalUnit"],
            "UnitConversion.degreesToradians": ["degrees"],
            "UnitConversion.lengthToRadians": ["distance", "units"],
            "UnitConversion.lengthToDegrees": ["distance", "units"],
            "UnitConversion.radiansToLength": ["radians", "units"],
            "UnitConversion.radiansToDegrees": ["radians"],
            "UnitConversion.toMercator": ["geojson","mutate"],
            "UnitConversion.toWgs84": ["geojson","mutate"]
        };

        // 5.0.0 åä»¥ä¸çæ¬åæ°éç½®
        this.turfOptionMap={
            "Measurement.along": ["line", "distance", {units:""}],
            "Measurement.bboxPolygon": ["bbox",{properties:"",id:""}],
            "Measurement.bearing": ["start", "end", {final:""}],
            "Measurement.center": ["geojson", {properties:""}],
            "Measurement.destination": ["origin", "distance", "bearing", {units:"",properties:""}],
            "Measurement.distance": ["from", "to", {units:""}],
            "Measurement.length": ["geojson", {units:""}],
            "Measurement.rhumbBearing": ["start", "end", {final:""}],
            "Measurement.rhumbDestination": ["origin", "distance", "bearing", {units:"",properties:""}],
            "Measurement.rhumbDistance": ["from", "to", {units:""}],
            "Measurement.greatCircle": ["start", "end", {properties:"", npoints:"", offset:""}],
            "CoordinateMutation.cleanCoords":["geojson",{mutate:""}],
            "CoordinateMutation.flip": ["geojson", {mutate:""}],
            "CoordinateMutation.rewind": ["geojson",{mutate:"",reverse:""}],
            "CoordinateMutation.truncate": ["geojson", {precision:"", coordinates:"", mutate:""}],
            "Transformation.bezierSpline": ["line", {resolution:"", sharpness:""}],
            "Transformation.buffer": ["geojson", "radius", {units:"", steps:""}],
            "Transformation.circle": ["center", "radius",  {units:"", steps:"",properties:""}],
            "Transformation.concave": ["points", {maxEdge:"", units:""}],
            "Transformation.convex": ["geojson",{concavity:""}],
            "Transformation.dissolve": ["featureCollection", {propertyName:""}],
            "Transformation.lineOffset": ["geojson", "distance", {units:""}],
            "Transformation.simplify": ["geojson", {tolerance:"", highQuality:""}],
            "Transformation.transformRotate": ["geojson", "angle", {pivot:"", mutate:""}],
            "Transformation.transformTranslate": ["geojson", "distance", "direction", {units:"", zTranslation:"", mutate:""}],
            "Transformation.transformScale": ["geojson", "factor", {origin:"", mutate:""}],
            "Transformation.voronoi": ["points",{bbox:""}],
            "featureConversion.lineStringToPolygon": ["lines",{properties:"", autoComplete:"", orderCoords:""}],
            "featureConversion.polygonToLineString": ["polygon", {properties:""}],
            "Misc.lineArc": ["center", "radius", "bearing1", "bearing2", {steps:"", units:""}],
            "Misc.lineChunk": ["geojson", "segmentLength", {units:"", reverse:""}],
            "Misc.lineOverlap": ["line1", "line2",{tolerance:""}],
            "Misc.lineSliceAlong": ["line", "startDist", "stopDist", {units:""}],
            "Misc.pointOnLine": ["lines", "pt",  {units:""}],
            "Misc.sector": ["center", "radius", "bearing1", "bearing2", {units:"",steps:"",properties:""}],
            "Misc.shortestPath": ["start", "end", {obstacles:"", units:"",resolution:""}],
            "Helper.feature": ["geometry", "properties",{bbox:"",id:""}],
            "Helper.geometryCollection": ["geometries", "properties",{bbox:"",id:""}],
            "Helper.lineString": ["coordinates", "properties",{bbox:"",id:""}],
            "Helper.multiLineString": ["coordinates", "properties",{bbox:"",id:""}],
            "Helper.multiPoint": ["coordinates", "properties",{bbox:"",id:""}],
            "Helper.multiPolygon": ["coordinates", "properties",{bbox:"",id:""}],
            "Helper.point": ["coordinates", "properties",{bbox:"",id:""}],
            "Helper.polygon": ["coordinates", "properties",{bbox:"",id:""}],
            "Interpolation.interpolate": ["points", "cellSize", {gridType:"", property:"", units:"", weight:""}],
            "Interpolation.isobands": ["pointGrid", "breaks", {zProperty:"", commonProperties:"",breaksProperties:""}],
            "Interpolation.isolines": ["pointGrid", "breaks", {zProperty:"", commonProperties:"", breaksProperties:""}],
            "Grids.hexGrid": ["bbox", "cellSide", {units:"", triangles:"",properties:"",mask:""}],
            "Grids.pointGrid": ["bbox", "cellSide", {units:"", mask:"",properties:""}],
            "Grids.squareGrid": ["bbox", "cellSide", {units:"", mask:"",properties:""}],
            "Grids.triangleGrid": ["bbox", "cellSide", {units:"", mask:"",properties:""}],
            "Aggregation.clustersDbscan": ["points", "maxDistance", {units:"", minPoints:"",mutate:""}],
            "Aggregation.clustersKmeans": ["points", {numberOfClusters:"", mutate:""}],
            "Booleans.booleanPointInPolygon": ["point", "polygon", {ignoreBoundary:""}],
            "Booleans.booleanPointOnLine": ["point", "linestring", {ignoreEndVertices:""}],
            "UnitConversion.toMercator": ["geojson",{mutate:""}],
            "UnitConversion.toWgs84": ["geojson",{mutate:""}]
        }

    }

    /**
     * @function Turf.prototype.process
     * @description æ§è¡ Turf.js æä¾çç¸å³ç©ºé´åææ¹æ³ã
     * @param {string} type - Turf.js æä¾çç©ºé´åææ¹æ³åã
     * @param {Object} args - Turf.js æä¾çç©ºé´åææ¹æ³å¯¹åºçåæ°å¯¹è±¡ã
     * @param {function} callback - ç©ºé´åæå®ææ§è¡çåè°å½æ°ï¼è¿åæ§è¡çç»æã
     * @param {boolean} addFeaturesToMap - æ¯å¦æ·»å å° Mapã
     */
    process(type, args, callback, addFeaturesToMap) {
        var result;
        // å¼å®¹çæ¬4å°5
        try{
            result = external_function_try_return_turf_catch_e_return_namespaceObject[type.split('.')[1]].apply(this, this.parse(type, args));
        }catch(e){
            result = external_function_try_return_turf_catch_e_return_namespaceObject[type.split('.')[1]].apply(this, this.parseOption(type, args));
        }
        
        var features = null;
        try {
            features = (new (external_ol_format_GeoJSON_default())()).readFeatures(result);
        } catch (e) {
            if (callback) {
                callback(result);
            }
            return;
        }
        addFeaturesToMap = addFeaturesToMap == null ? true : addFeaturesToMap;
        if (addFeaturesToMap) {
            this.addFeatures(features);
        }
        if (callback) {
            callback(result);
        }
    }

    parse(type, args) {
        if (type === 'Transformation.union') {
            return args['A'];
        }
        var result = [];
        var tempArgs = this.turfMap[type];
        if (tempArgs) {
            tempArgs.map(function (key) {
                result.push(args[key]);
                return args[key];
            });
        }
        return result;
    }

    parseOption(type,args){
        var result = [];
        var tempArgs = this.turfOptionMap[type];
        tempArgs.map(function(key){
            if(key instanceof Object){
                var options = key;
                Object.keys(options).forEach(function(k){
                    options[k]=args[k]
                })
                result.push(options);
            }else{
                result.push(args[key])
            }
            return args;
        })
        return result;
    }

}
;// CONCATENATED MODULE: ./src/openlayers/overlay/Unique.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class Unique
 * @browsernamespace ol.source
 * @category  Visualization Theme
 * @classdesc åå¼ä¸é¢å¾å¾å±æºã
 * @param {string} name - å¾å±åç§°
 * @param {Object} opt_options - åæ°ã
 * @param {ol.Map} opt_options.map - å½å Map å¯¹è±¡ã
 * @param {string} [opt_options.id] - ä¸é¢å¾å± IDãé»è®¤ä½¿ç¨ CommonUtil.createUniqueID("themeLayer_") åå»ºä¸é¢å¾å±IDã
 * @param {number} [opt_options.opacity=1] - å¾å±éæåº¦ã
 * @param {string} [opt_options.logo] - Logoï¼openLayers 5.0.0 åæ´é«çæ¬ä¸åæ¯ææ­¤åæ°ï¼ã
 * @param {ol.proj.Projection} [opt_options.projection] - æå½±ä¿¡æ¯ã
 * @param {number} [opt_options.ratio=1.5] - è§å¾æ¯ï¼1 è¡¨ç¤ºç»å¸æ¯å°å¾è§å£çå¤§å°ï¼2 è¡¨ç¤ºå°å¾è§å£çå®½åº¦åé«åº¦çä¸¤åï¼ä¾æ­¤ç±»æ¨ãå¿é¡»æ¯1 ææ´é«ã
 * @param {Array} [opt_options.resolutions] - åè¾¨çæ°ç»ã
 * @param {ol.source.State} [opt_options.state] - èµæºç¶æã
 * @param {string} [opt_options.themeField] - æå®åå»ºä¸é¢å¾å­æ®µã
 * @param {Object} [opt_options.style] - ä¸é¢å¾æ ·å¼ã
 * @param {Object} [opt_options.styleGroups] - åä¸é¢ç±»åæ ·å¼ç»ã
 * @param {boolean} [opt_options.isHoverAble=false] - æ¯å¦å¼å¯ hover äºä»¶ã
 * @param {Object} [opt_options.highlightStyle] - å¼å¯ hover äºä»¶åï¼è§¦åçæ ·å¼é£æ ¼ã
 * @param {(string|Object)} [opt_options.attributions='Map Data <span>Â© <a href='http://support.supermap.com.cn/product/iServer.aspx' target='_blank'>SuperMap iServer</a></span> with <span>Â© <a href='https://iclient.supermap.io' target='_blank'>SuperMap iClient</a></span>'] - çæä¿¡æ¯ã
 * @extends {GeoFeature}
 * @usage
 */
class Unique extends GeoFeature {

    constructor(name, opt_options) {
        super(name, opt_options);
        this.themeField = opt_options.themeField;
        this.style = opt_options.style;
        this.styleGroups = opt_options.styleGroups;
        this.isHoverAble = opt_options.isHoverAble;
        this.highlightStyle = opt_options.highlightStyle;
    }

    /**
     * @function Unique.prototype.destroy
     * @description éæ¾èµæºï¼å°å¼ç¨èµæºçå±æ§ç½®ç©ºã
     */
    destroy() {
        this.style = null;
        this.themeField = null;
        this.styleGroups = null;
        GeoFeature.prototype.destroy.apply(this, arguments);
    }

    /**
     * @private
     * @function Unique.prototype.createThematicFeature
     * @description åå»ºä¸é¢è¦ç´ ã
     * @param {Object} feature - è¦ç´ ã
     */
    createThematicFeature(feature) {
        var style = this.getStyleByData(feature);
        //åå»ºä¸é¢è¦ç´ æ¶çå¯éåæ°
        var options = {};
        options.nodesClipPixel = this.nodesClipPixel;
        options.isHoverAble = this.isHoverAble;
        options.isMultiHover = this.isMultiHover;
        options.isClickAble = this.isClickAble;
        options.highlightStyle = ShapeFactory.transformStyle(this.highlightStyle);
        //å°æ°æ®è½¬ä¸ºä¸é¢è¦ç´ ï¼ThemeVectorï¼
        var thematicFeature = new ThemeVector(feature, this, ShapeFactory.transformStyle(style), options);
        //ç´æ¥æ·»å å¾å½¢å°æ¸²æå¨
        for (var m = 0; m < thematicFeature.shapes.length; m++) {
            this.renderer.addShape(thematicFeature.shapes[m]);
        }
        return thematicFeature;
    }

    /**
     * @private
     * @function Unique.prototype.getStyleByData
     * @description æ ¹æ®ç¨æ·æ°æ®ï¼featureï¼è®¾ç½®ä¸é¢è¦ç´ ç Styleã
     * @param {Object} fea - ç¨æ·è¦ç´ æ°æ®ã
     */
    getStyleByData(fea) {
        var style = {};
        var feature = fea;
        style = Util.copyAttributesWithClip(style, this.style);
        if (this.themeField && this.styleGroups && this.styleGroups.length > 0 && feature.attributes) {
            var tf = this.themeField;
            var Attrs = feature.attributes;
            var Gro = this.styleGroups;
            var isSfInAttrs = false; //æå®ç themeField æ¯å¦æ¯ feature çå±æ§å­æ®µä¹ä¸
            var attr = null; //å±æ§å¼
            for (var property in Attrs) {
                if (tf === property) {
                    isSfInAttrs = true;
                    attr = Attrs[property];
                    break;
                }
            }
            //å¤æ­å±æ§å¼æ¯å¦å±äºstyleGroupsçæä¸ä¸ªèå´ï¼ä»¥ä¾¿å¯¹è·ååç» style
            if (isSfInAttrs) {
                for (var i = 0, len = Gro.length; i < len; i++) {
                    if ((attr).toString() === ( Gro[i].value).toString()) {
                        //feature.style = CommonUtil.copyAttributes(feature.style, this.defaultStyle);
                        var sty1 = Gro[i].style;
                        style = Util.copyAttributesWithClip(style, sty1);
                    }
                }
            }
        }
        if (feature.style && this.isAllowFeatureStyle === true) {
            style = Util.copyAttributesWithClip(feature.style);
        }
        return style;
    }

    canvasFunctionInternal_(extent, resolution, pixelRatio, size, projection) { // eslint-disable-line no-unused-vars
        return GeoFeature.prototype.canvasFunctionInternal_.apply(this, arguments);
    }
}

;// CONCATENATED MODULE: ./src/openlayers/overlay/vectortile/VectorTileStyles.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/












/**
 * @class VectorTileStyles
 * @classdesc ç¢éç¦çé£æ ¼ã
 * @category  Visualization VectorTile
 * @param {Object} options - äº¤äºæ¶æéå¯éåæ°ã
 * @extends {ol.Observable}
 * @usage
 */
class VectorTileStyles extends (external_ol_Observable_default()) {

    constructor(options) {
        super();
        if (!options) {
            return;
        }
        var donotNeedServerCartoCss = false;
        if (options.donotNeedServerCartoCss !== undefined) {
            donotNeedServerCartoCss = options.donotNeedServerCartoCss
        }
        VectorTileStyles.setDonotNeedServerCartoCss(donotNeedServerCartoCss);
        if (options.view) {
            VectorTileStyles.setView(options.view);
        }
        if (options.url) {
            VectorTileStyles.setUrl(options.url);
        }
        if (options.cartoCss) {
            VectorTileStyles.setCartoCss(options.cartoCss);
        }
        var selectedPointStyle = getDefaultSelectedPointStyle();
        if (options.selectedPointStyle) {
            selectedPointStyle = options.selectedPointStyle;
        }
        VectorTileStyles.setSelectedPointStyle(selectedPointStyle);
        var selectedLineStyle = getDefaultSelectedLineStyle();
        if (options.selectedLineStyle) {
            selectedLineStyle = options.selectedLineStyle;
        }
        VectorTileStyles.setSelectedLineStyle(selectedLineStyle);
        var selectedRegionStyle = getDefaultSelectedRegionStyle();
        if (options.selectedRegionStyle) {
            selectedRegionStyle = options.selectedRegionStyle;
        }
        VectorTileStyles.setSelectedRegionStyle(selectedRegionStyle);
        var selectedTextStyle = getDefaultSelectedTextStyle();
        if (options.selectedTextStyle) {
            selectedTextStyle = options.selectedTextStyle;
        }
        VectorTileStyles.setSelectedTextStyle(selectedTextStyle);
        var layersXHR = new XMLHttpRequest();
        layersXHR.onreadystatechange = function () {
            if (layersXHR.readyState == 4) {
                var result = JSON.parse(layersXHR.responseText);
                var layersInfo = {};
                for (var i = 0, len = result.length; i < len; i++) {
                    var layers = result[i].subLayers.layers;
                    for (var j = 0, len1 = layers.length; j < len1; j++) {
                        layers[j].layerIndex = len1 - j;
                        layersInfo[layers[j].name] = layers[j];
                    }
                }
                VectorTileStyles.setLayersInfo(layersInfo);
                if (!VectorTileStyles.getDonotNeedServerCartoCss()) {
                    var vectorStylesXHR = new XMLHttpRequest();
                    vectorStylesXHR.open("GET", Util.urlPathAppend(VectorTileStyles.getUrl(), "tileFeature/vectorstyles.json"), false);
                    vectorStylesXHR.onreadystatechange = function () {
                        if (vectorStylesXHR.readyState == 4) {
                            var vectorStyles = new JSONFormat().read(vectorStylesXHR.responseText);
                            var cartoCss;
                            if (vectorStyles.style && vectorStyles.type === 'cartoCSS') {
                                cartoCss = vectorStyles.style;
                                cartoCss = cartoCss.replace(/[@]/gi, "___");
                                cartoCss = cartoCss.replace(/\\#/gi, "___");
                                //æ¿æ¢ä¸äºå³é®ç¬¦å·
                                var cachedLayer = {};
                                layersInfo && Object.keys(layersInfo).sort().forEach(function (attr) {
                                    var newAttr = attr.replace(/[@#\s]/gi, "___");
                                    var to = attr;
                                    var keys = Object.keys(cachedLayer);
                                    for (let index = keys.length; index > -1; index--) {
                                        if (attr.indexOf(keys[index]) > -1) {
                                            to = attr.replace(keys[index], cachedLayer[keys[index]]);
                                            break;
                                        }
                                    }
                                    to = to.replace(/[#]/gi, "\#");
                                    cachedLayer[attr] = newAttr;
                                    cartoCss = cartoCss.replace(new RegExp(to, "g"), newAttr);
                                })
                                cartoCss = cartoCss.replace(/[#]/gi, "\n#");
                                //å°zoomè½¬åä¸ºscaleï¼ä»¥åå¼èµ·æ··æ·
                                cartoCss = cartoCss.replace(/\[zoom/gi, "[scale");
                            }
                            var cartoShadersArray = new CartoCSS(cartoCss).getShaders();
                            var cartoShaders = {};
                            cartoShadersArray.forEach(function (cartoShader) {
                                cartoShaders[cartoShader.elements[0].clean] = cartoShaders[cartoShader.elements[0].clean] || {};
                                cartoShaders[cartoShader.elements[0].clean][cartoShader.attachment] = cartoShaders[cartoShader.elements[0].clean][cartoShader.attachment] || [];
                                cartoShaders[cartoShader.elements[0].clean][cartoShader.attachment].push(cartoShader);
                                return cartoShader;
                            });
                            VectorTileStyles.setCartoShaders(cartoShaders);
                        }
                    };
                    vectorStylesXHR.send(null);
                }
                if (VectorTileStyles.getCartoCss()) {
                    var clientCartoShadersArray = new CartoCSS(VectorTileStyles.getCartoCss()).getShaders();
                    var clientCartoShaders = {};
                    clientCartoShadersArray.forEach(function (cartoShader) {
                        clientCartoShaders[cartoShader.elements[0].clean] = clientCartoShaders[cartoShader.elements[0].clean] || {};
                        clientCartoShaders[cartoShader.elements[0].clean][cartoShader.attachment] = clientCartoShaders[cartoShader.elements[0].clean][cartoShader.attachment] || [];
                        clientCartoShaders[cartoShader.elements[0].clean][cartoShader.attachment].push(cartoShader);
                        return cartoShader;
                    });
                    VectorTileStyles.setClientCartoShaders(clientCartoShaders);
                }
            }
        };
        layersXHR.open("GET", Util.urlPathAppend(VectorTileStyles.getUrl(), "layers.json"), false);
        layersXHR.send(null);
        this.on('featureSelected', function (e) {
            VectorTileStyles.setSelectedId(e.selectedId);
            VectorTileStyles.setLayerName(e.layerName);
        });

        /**
         * @function VectorTileStyles.prototype.getDefaultSelectedPointStyle
         * @description è®¾ç½®é»è®¤éæ©åçç¹æ ·å¼ã
         */
        function getDefaultSelectedPointStyle() {
            return new (external_ol_style_Style_default())({
                image: new (external_ol_style_Circle_default())({
                    radius: 5,
                    fill: new (external_ol_style_Fill_default())({
                        color: 'blue'
                    })
                })
            })
        }

        /**
         * @function VectorTileStyles.prototype.getDefaultSelectedLineStyle
         * @description è®¾ç½®é»è®¤éæ©åççº¿æ ·å¼ã
         */
        function getDefaultSelectedLineStyle() {
            return new (external_ol_style_Style_default())({
                stroke: new (external_ol_style_Stroke_default())({
                    color: 'blue',
                    width: 3
                })
            })
        }

        /**
         * @function VectorTileStyles.prototype.getDefaultSelectedRegionStyle
         * @description è®¾ç½®é»è®¤éæ©åçé¢æ ·å¼ã
         */
        function getDefaultSelectedRegionStyle() {
            return new (external_ol_style_Style_default())({
                fill: new (external_ol_style_Fill_default())({
                    color: [0, 0, 255, 0.5]
                }),
                stroke: new (external_ol_style_Stroke_default())({
                    color: 'blue',
                    width: 3
                })
            })
        }

        /**
         * @function VectorTileStyles.prototype.getDefaultSelectedTextStyle
         * @description è®¾ç½®é»è®¤éæ©åçææ¬æ ·å¼ã
         */
        function getDefaultSelectedTextStyle() {
            return new (external_ol_style_Style_default())({
                text: new (external_ol_style_Text_default())({
                    font: '15px Microsoft YaHei',
                    fill: new (external_ol_style_Fill_default())({
                        color: 'blue'
                    }),
                    stroke: new (external_ol_style_Stroke_default())({
                        color: 'white',
                        width: 1
                    })
                })
            });
        }
    }

    /**
     * @function VectorTileStyles.setCartoShaders
     * @description è®¾ç½®æå¡ç«¯ Carto çé´å½±ã
     * @param {Array} cartoShaders - æå¡ç«¯ Carto é´å½±ã
     */
    static setCartoShaders(cartoShaders) {
        this.cartoShaders = cartoShaders;
    }

    /**
     * @function VectorTileStyles.getCartoShaders
     * @description è·åæå¡ç«¯ Carto çé´å½±ã
     */
    static getCartoShaders() {
        return this.cartoShaders;
    }

    /**
     * @function VectorTileStyles.setClientCartoShaders
     * @description è®¾ç½®å®¢æ·ç«¯ Carto çé´å½±ã
     * @param {Array} clientCartoShaders - å®¢æ·ç«¯ Carto é´å½±ã
     */
    static setClientCartoShaders(clientCartoShaders) {
        this.clientCartoShaders = clientCartoShaders;
    }

    /**
     * @function VectorTileStyles.getClientCartoShaders
     * @description è·åå®¢æ·ç«¯ Carto çé´å½±ã
     */
    static getClientCartoShaders() {
        return this.clientCartoShaders;
    }

    /**
     * @function VectorTileStyles.setCartoCss
     * @description è®¾ç½® cartoCss çæ ·å¼ã
     * @param {Object} cartoCss - cartoCss çæ ·å¼ã
     */
    static setCartoCss(cartoCss) {
        this.cartoCss = cartoCss;
    }

    /**
     * @function VectorTileStyles.getCartoCss
     * @description è·å cartoCss çæ ·å¼ã
     */
    static getCartoCss() {
        return this.cartoCss;
    }

    /**
     * @function VectorTileStyles.setDonotNeedServerCartoCss
     * @description è®¾ç½®æ¯å¦éè¦ CartoCss æå¡ã
     * @param {Object} donotNeedServerCartoCss - æ¯å¦éè¦ CartoCss æå¡ã
     */
    static setDonotNeedServerCartoCss(donotNeedServerCartoCss) {
        this.donotNeedServerCartoCss = donotNeedServerCartoCss;
    }

    /**
     * @function VectorTileStyles.getDonotNeedServerCartoCss
     * @description è·åæ¯å¦éè¦ CartoCss æå¡ã
     */
    static getDonotNeedServerCartoCss() {
        return this.donotNeedServerCartoCss;
    }

    /**
     * @function VectorTileStyles.setLayersInfo
     * @description è®¾ç½®å¾å±ä¿¡æ¯æå¡ã
     * @param {Object} layersInfo - å¾å±ä¿¡æ¯ã
     */
    static setLayersInfo(layersInfo) {
        this.layersInfo = layersInfo;
    }

    /**
     * @function VectorTileStyles.getLayersInfo
     * @description è·åå¾å±ä¿¡æ¯æå¡ã
     */
    static getLayersInfo() {
        return this.layersInfo;
    }

    /**
     * @function VectorTileStyles.setUrl
     * @description è®¾ç½®å°åã
     * @param {string} url - å°åã
     */
    static setUrl(url) {
        this.url = url;
    }

    /**
     * @function VectorTileStyles.getUrl
     * @description è·åå°åã
     */
    static getUrl() {
        return this.url;
    }

    /**
     * @function VectorTileStyles.setView
     * @description è®¾ç½®è§å¾ã
     * @param {Object} view - è§å¾ã
     */
    static setView(view) {
        this.view = view;
    }

    /**
     * @function VectorTileStyles.getView
     * @description è·åè§å¾ã
     */
    static getView() {
        return this.view;
    }

    /**
     * @function VectorTileStyles.setSelectedId
     * @description è®¾ç½®éæ©åºå·ã
     * @param {number} selectedId - éæ©åºå·ã
     */
    static setSelectedId(selectedId) {
        this.selectedId = selectedId;
    }

    /**
     * @function VectorTileStyles.getSelectedId
     * @description è·åéæ©åºå·ã
     */
    static getSelectedId() {
        return this.selectedId;
    }

    /**
     * @function VectorTileStyles.setLayerName
     * @description è®¾ç½®å¾å±åç§°ã
     * @param {string} layerName - å¾å±åç§°ã
     */
    static setLayerName(layerName) {
        this.layerName = layerName;
    }

    /**
     * @function VectorTileStyles.getLayerName
     * @description è·åå¾å±åç§°ã
     */
    static getLayerName() {
        return this.layerName;
    }

    /**
     * @function VectorTileStyles.setSelectedPointStyle
     * @description è®¾ç½®éæ©åç¹æ ·å¼ã
     * @param {Object} selectedPointStyle - éæ©åç¹æ ·å¼ã
     */
    static setSelectedPointStyle(selectedPointStyle) {
        this.selectedPointStyle = selectedPointStyle;
    }

    /**
     * @function VectorTileStyles.setSelectedLineStyle
     * @description è®¾ç½®éæ©åçº¿æ ·å¼ã
     * @param {Object} selectedLineStyle - éæ©åçº¿æ ·å¼ã
     */
    static setSelectedLineStyle(selectedLineStyle) {
        this.selectedLineStyle = selectedLineStyle;
    }

    /**
     * @function VectorTileStyles.setSelectedRegionStyle
     * @description è®¾ç½®éæ©åé¢æ ·å¼ã
     * @param {Object} selectedRegionStyle - éæ©åé¢æ ·å¼ã
     */
    static setSelectedRegionStyle(selectedRegionStyle) {
        this.selectedRegionStyle = selectedRegionStyle;
    }

    /**
     * @function VectorTileStyles.setSelectedTextStyle
     * @description è®¾ç½®éæ©åææ¬æ ·å¼ã
     * @param {Object} selectedTextStyle - éæ©åææ¬æ ·å¼ã
     */
    static setSelectedTextStyle(selectedTextStyle) {
        this.selectedTextStyle = selectedTextStyle;
    }

    /**
     * @function VectorTileStyles.getSelectedStyle
     * @description è®¾ç½®éæ©åçæ ·å¼ã
     * @param {string} type - éæ©åçæ ·å¼ã
     */
    static getSelectedStyle(type) {
        if (type === 'POINT' || type === 'MULTIPOINT') {
            return this.selectedPointStyle;
        }
        if (type === 'LINESTRING' || type === 'MULTILINESTRING') {
            return this.selectedLineStyle;
        }
        if (type === 'POLYGON' || type === 'MULTIPOLYGON') {
            return this.selectedRegionStyle;
        }
        if (type === 'TEXT') {
            return this.selectedTextStyle;
        }
    }

    /**
     * @function VectorTileStyles.getLayerInfo
     * @description è·åå¾å±çä¿¡æ¯ã
     * @param {string} layerName - å¾å±åã
     */
    static getLayerInfo(layerName) {
        var layersInfo = VectorTileStyles.getLayersInfo();
        if (layersInfo === undefined) {
            return null;
        }
        var layerInfo = layersInfo[layerName];
        if (!layerInfo) {
            return null;
        }
        var layerInfo_simple = {layerIndex: layerInfo.layerIndex, ugcLayerType: layerInfo.ugcLayerType};
        switch (layerInfo.ugcLayerType) {
            case "VECTOR":
                layerInfo_simple.layerStyle = layerInfo.style ? layerInfo.style : null;
                break;
            case "THEME":
                var theme = layerInfo.theme;
                layerInfo_simple.layerStyle = theme ? theme.defaultStyle : null;
                if (theme && theme.type === "LABEL") {
                    layerInfo_simple.type = theme.type;
                    layerInfo_simple.textField = theme.labelExpression;
                }
                break;
            default :
                //SVTileåå¸åºæ¥çå°å¾æ²¡æugcLayerTypeå±æ§
                if (layerInfo.style) {
                    layerInfo_simple.layerStyle = layerInfo.style;
                }
                break;
        }
        return layerInfo_simple;
    }

    /**
     * @function VectorTileStyles.getStyle
     * @description è·åæ ·å¼ã
     * @param {string} originalLayerName - åå§å¾å±ä¿¡æ¯ã
     * @param {Object} feature - è¦ç´ å¯¹è±¡ã
     */
    static getStyle(originalLayerName, feature) {
        var url = VectorTileStyles.getUrl(),
            view = VectorTileStyles.getView(),
            zoom = view.getZoom(),
            dpi = 96,
            scale = core_Util_Util.resolutionToScale(view.getResolution(), dpi, Unit.METER),
            layerName = originalLayerName.replace(/(@)/gi, '___').replace(/(#)/gi, '___');
        // featureå¯¹è±¡æ ·å¼çéç½®éµå¾ªä»¥ä¸ä¼åçº§ï¼
        // å®¢æ·ç«¯CartoCSS > æå¡å¨ç«¯CartoCSS > æå¡å¨ç«¯layeræ ·å¼ > å®¢æ·ç«¯é»è®¤æ ·å¼ã
        if (VectorTileStyles.getCartoCss() && VectorTileStyles.getClientCartoShaders()[layerName]) {
            return getStyleArray(VectorTileStyles.getClientCartoShaders()[layerName]);
        }
        var layerInfo = VectorTileStyles.getLayerInfo(originalLayerName);
        if (!VectorTileStyles.getDonotNeedServerCartoCss() && VectorTileStyles.getCartoShaders()[layerName]) {
            //å¦ææ¯ææ¬ï¼è¿éç¹æ®å¤çã
            if (feature.getProperties().textStyle || feature.getProperties().TEXT_FEATURE_CONTENT || layerInfo.type == 'LABEL' && layerInfo.textField) {
                var featureStyle = StyleUtils.getValidStyleFromLayerInfo(layerInfo, feature, url);
                if (feature.getGeometry().getType().toUpperCase() === "POINT") {
                    featureStyle = mergeTextFeatureStyle(layerInfo, feature, url);
                }
                return featureStyle;
            }
            return getStyleArray(VectorTileStyles.getCartoShaders()[layerName]);
        }
        if (layerInfo) {
            return StyleUtils.getValidStyleFromLayerInfo(layerInfo, feature, url);
        }

        function getStyleArray(shaderAttachment) {
            var styleArray = [];
            for (var j in shaderAttachment) {
                shaderAttachment[j].map(function (shader) {
                    styleArray.push(StyleUtils.getStyleFromCarto(zoom, scale, shader, feature, true, url))
                    return shader;
                })
            }
            return styleArray;
        }

        /**
         * @function VectorTileStyles.prototype.mergeTextFeatureStyle
         * @description åå¹¶ææ¬è¦ç´ æ ·å¼ã
         * @param {string} layerInfo - å¾å±ä¿¡æ¯ã
         * @param {Object} feature - è·åçè¦ç´ ã
         * @param {string} url - æå¡å°åã
         */
        function mergeTextFeatureStyle(layerInfo, feature, url) {
            var textFeatureStyle = StyleUtils.getValidStyleFromLayerInfo(layerInfo, feature, url);
            if (layerInfo.type == 'LABEL') {
                feature.setProperties({type: "TEXT"});
                var cartoTextStyles = getStyleArray(VectorTileStyles.getCartoShaders()[layerName]);
                var textStyle = textFeatureStyle.getText();
                for (var i = 0; i < cartoTextStyles.length; i++) {
                    if (!textStyle) {
                        textStyle = cartoTextStyles[i].getText();
                    } else {
                        textStyle.setText(cartoTextStyles[i].getText().getText());
                    }
                }
                textFeatureStyle.setText(textStyle);
                return textFeatureStyle;
            }
            return textFeatureStyle;
        }

    }

    /**
     * @function VectorTileStyles.prototype.getFeatureStyle
     * @description è·åè¦ç´ æ ·å¼ã
     * @param {Object} feature - è¦ç´ ã
     */
    getFeatureStyle(feature) {
        var selectedStyle;
        var layerName = feature.getProperties().layerName || feature.getProperties().layer;
        var id = feature.getProperties().id || parseInt(feature.getProperties().SmID);
        if (feature.getProperties().type && feature.getProperties().type.toUpperCase() === 'TEXT') {
            selectedStyle = VectorTileStyles.getSelectedStyle(feature.getProperties().type.toUpperCase());
            if (feature.getProperties().texts) {
                selectedStyle.getText().text_ = feature.getProperties().texts[0];
            } else {
                selectedStyle.getText().text_ = "";
            }
        } else {
            selectedStyle = VectorTileStyles.getSelectedStyle(feature.getGeometry().getType().toUpperCase());
        }
        if (selectedStyle) {
            var selectedLayerName = VectorTileStyles.getLayerName();
            var selectedId = VectorTileStyles.getSelectedId();
            if (selectedLayerName === layerName && id === selectedId) {
                return selectedStyle;
            }
        }
        return VectorTileStyles.getStyle(layerName, feature);
    }
}

;// CONCATENATED MODULE: external "ol.source.VectorTile"
const external_ol_source_VectorTile_namespaceObject = ol.source.VectorTile;
var external_ol_source_VectorTile_default = /*#__PURE__*/__webpack_require__.n(external_ol_source_VectorTile_namespaceObject);
;// CONCATENATED MODULE: external "ol.format.MVT"
const external_ol_format_MVT_namespaceObject = ol.format.MVT;
var external_ol_format_MVT_default = /*#__PURE__*/__webpack_require__.n(external_ol_format_MVT_namespaceObject);
;// CONCATENATED MODULE: ./src/openlayers/overlay/VectorTileSuperMapRest.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
















/**
 * @class VectorTileSuperMapRest
 * @browsernamespace ol.source
 * @category  Visualization VectorTile
 * @classdesc ç¢éç¦çå¾å±æºã
 * @param {Object} options - åæ°ã
 * @param {(string|undefined)} options.url - æå¡å°åã
 * @param {(string|Object|undefined)} options.style - Mapbox Style JSON å¯¹è±¡æè·å Mapbox Style JSON å¯¹è±¡ç URLãå½ `options.format` ä¸º {@link ol.format.MVT} ä¸ `options.source` ä¸ä¸ºç©ºæ¶ææï¼ä¼åçº§é«äº `options.url`ã
 * @param {(string|undefined)} options.source - Mapbox Style JSON å¯¹è±¡ä¸­çsourceåç§°ãå½ `options.style` è®¾ç½®æ¶ææãå½ä¸éç½®æ¶ï¼é»è®¤ä¸º Mapbox Style JSON ç `sources` å¯¹è±¡ä¸­çç¬¬ä¸ä¸ªã
 * @param {(string|Object)} [options.attributions='Tile Data <span>Â© <a href='http://support.supermap.com.cn/product/iServer.aspx' target='_blank'>SuperMap iServer</a></span> with <span>Â© <a href='https://iclient.supermap.io' target='_blank'>SuperMap iClient</a></span>'] - çæä¿¡æ¯ã
 * @param {Object} [options.format] - ç¦ççè¦ç´ æ ¼å¼åã
 * @param {boolean} [options.withCredentials] - è¯·æ±æ¯å¦æºå¸¦ cookieã
 * @extends {ol.source.VectorTile}
 * @usage
 */
class VectorTileSuperMapRest extends (external_ol_source_VectorTile_default()) {
    constructor(options) {
        if (options.url === undefined && options.style === undefined) {
            console.error("one of 'options.style' or 'options.style' is required");
        }
        var zRegEx = /\{z\}/g;
        var xRegEx = /\{x\}/g;
        var yRegEx = /\{y\}/g;
        var dashYRegEx = /\{-y\}/g;

        options.attributions =
            options.attributions ||
            "Tile Data <span>Â© <a href='http://support.supermap.com.cn/product/iServer.aspx' target='_blank'>SuperMap iServer</a></span> with <span>Â© <a href='https://iclient.supermap.io' target='_blank'>SuperMap iClient</a></span>";
        if (['4', '5'].indexOf(core_Util_Util.getOlVersion()) < 0) {
            options.tileSize = options.format instanceof (external_ol_format_MVT_default()) && options.style ? 512 : 256;
        }
        super({
            attributions: options.attributions,
            cacheSize: options.cacheSize,
            format: options.format || new (external_ol_format_GeoJSON_default())(),
            logo: core_Util_Util.getOlVersion() === '4' ? options.logo : null,
            overlaps: options.overlaps,
            projection: options.projection,
            state:
                options.format instanceof (external_ol_format_MVT_default()) &&
                options.style &&
                Object.prototype.toString.call(options.style) == '[object String]'
                    ? 'loading'
                    : options.state,
            tileClass: options.tileClass,
            tileGrid: options.tileGrid,
            tilePixelRatio: options.tilePixelRatio,
            tileUrlFunction: options.tileUrlFunction || (options.format instanceof (external_ol_format_MVT_default()) && options.style ? zxyTileUrlFunction : tileUrlFunction),
            tileLoadFunction: options.tileLoadFunction || (options.format instanceof (external_ol_format_MVT_default()) ? mvtTileLoadFunction : tileLoadFunction),
            wrapX: options.wrapX !== undefined ? options.wrapX : false,
            tileSize: options.tileSize || null,
            zDirection: ['4', '5'].indexOf(core_Util_Util.getOlVersion()) > -1 ? null : 0
        });
        var me = this;
        me.withCredentials = options.withCredentials;
        me._tileType = options.tileType || 'ScaleXY';
        this.vectorTileStyles = new VectorTileStyles();
        if (options.format instanceof (external_ol_format_MVT_default()) && options.style) {
            if (Object.prototype.toString.call(options.style) == '[object String]') {
                var url = SecurityManager.appendCredential(options.style);
                FetchRequest.get(url, null, { withCredentials: options.withCredentials })
                    .then((response) => response.json())
                    .then((mbStyle) => {
                        this._fillByStyleJSON(mbStyle, options.source);
                        this.setState('ready');
                    });
            } else {
                this._fillByStyleJSON(options.style, options.source);
            }
        } else {
            this._fillByRestMapOptions(options.url, options);
        }

        function tileUrlFunction(tileCoord, pixelRatio, projection) {
            if (!me.tileGrid) {
                me.tileGrid = me.getTileGridForProjection(projection);
            }
            var z = tileCoord[0];
            var x = tileCoord[1];
            var y = ['4', '5'].indexOf(core_Util_Util.getOlVersion()) > -1 ? -tileCoord[2] - 1 : tileCoord[2];
            var tileSize = external_ol_size_namespaceObject.toSize(me.tileGrid.getTileSize(z, me.tmpSize));
            var params = '';
            if (me.tileType === 'ZXY') {
                params = '&width=' + tileSize[0] + '&height=' + tileSize[1] + '&x=' + x + '&y=' + y + '&z=' + z;
            } else if (me.tileType === 'ViewBounds') {
                var tileExtent = me.tileGrid.getTileCoordExtent(tileCoord);
                params =
                    '&width=' +
                    tileSize[0] +
                    '&height=' +
                    tileSize[1] +
                    '&viewBounds=' +
                    tileExtent[0] +
                    ',' +
                    tileExtent[1] +
                    ',' +
                    tileExtent[2] +
                    ',' +
                    tileExtent[3];
            } else {
                var origin = me.tileGrid.getOrigin(z);
                var resolution = me.tileGrid.getResolution(z);
                var dpi = 96;
                var unit = projection.getUnits() || 'degrees';
                if (unit === 'degrees') {
                    unit = Unit.DEGREE;
                }
                if (unit === 'm') {
                    unit = Unit.METER;
                }

                var scale = core_Util_Util.resolutionToScale(resolution, dpi, unit);
                params =
                    '&x=' +
                    x +
                    '&y=' +
                    y +
                    '&width=' +
                    tileSize[0] +
                    '&height=' +
                    tileSize[1] +
                    '&scale=' +
                    scale +
                    "&origin={'x':" +
                    origin[0] +
                    ",'y':" +
                    origin[1] +
                    '}';
            }
            return me._tileUrl + encodeURI(params);
        }

        function zxyTileUrlFunction(tileCoord) {
            if (!tileCoord) {
                return undefined;
            } else {
                return me._tileUrl
                    .replace(zRegEx, tileCoord[0].toString())
                    .replace(xRegEx, tileCoord[1].toString())
                    .replace(yRegEx, function () {
                        var y = ['4', '5'].indexOf(core_Util_Util.getOlVersion()) > -1 ? -tileCoord[2] - 1 : tileCoord[2];
                        return y.toString();
                    })
                    .replace(dashYRegEx, function () {
                        var z = tileCoord[0];
                        var range = me.tileGrid.getFullTileRange(z);
                        var y = range.getHeight() + tileCoord[2];
                        return y.toString();
                    });
            }
        }
        /**
         * @private
         * @function VectorTileSuperMapRest.prototype.tileLoadFunction
         * @description å è½½ç¦çã
         * @param {Object} tile -ç¦çç±»ã
         * @param {string} tileUrl - ç¦çå°åã
         */
        function tileLoadFunction(tile, tileUrl) {
            var regWidth = new RegExp('(^|\\?|&)' + 'width' + '=([^&]*)(\\s|&|$)');
            var regHeight = new RegExp('(^|\\?|&)' + 'height' + '=([^&]*)(\\s|&|$)');
            var width = Number(tileUrl.match(regWidth)[2]);
            var height = Number(tileUrl.match(regHeight)[2]);

            tile.setLoader(function (extent, resolution, projection) {
                FetchRequest.get(tileUrl)
                    .then(function (response) {
                        if (tile.getFormat() instanceof (external_ol_format_GeoJSON_default())) {
                            return response.json();
                        }
                    })
                    .then(function (tileFeatureJson) {
                        var features = [];
                        if (tile.getFormat() instanceof (external_ol_format_GeoJSON_default())) {
                            tileFeatureJson.recordsets.map(function (recordset) {
                                recordset.features.map(function (feature) {
                                    var points = [];
                                    var startIndex = 0;
                                    for (var i = 0; i < feature.geometry.parts.length; i++) {
                                        var partPointsLength = feature.geometry.parts[i] * 2;
                                        for (var j = 0, index = startIndex; j < partPointsLength; j += 2, index += 2) {
                                            points.push(
                                                new Point(
                                                    feature.geometry.points[index],
                                                    feature.geometry.points[index + 1]
                                                )
                                            );
                                        }
                                        startIndex += partPointsLength;
                                    }
                                    feature.geometry.points = points;
                                    return feature;
                                });
                                return recordset;
                            });
                            tileFeatureJson.recordsets.map(function (recordset) {
                                recordset.features.map(function (feature) {
                                    feature.layerName = recordset.layerName;
                                    feature.type = feature.geometry.type;
                                    features.push(feature);
                                    return feature;
                                });
                                return recordset;
                            });

                            let dataProjection = new (external_ol_proj_Projection_default())({
                                extent: [0, 0, 256, 256],
                                code: 'TILE_PIXELS',
                                units: 'tile-pixels'
                            });

                            if (['4', '5'].indexOf(core_Util_Util.getOlVersion()) > -1) {
                                tile.setExtent([0, 0, width, height]);
                                tile.setProjection(dataProjection);
                                features = tile.getFormat().readFeatures(core_Util_Util.toGeoJSON(features));
                            } else {
                                features = tile.getFormat().readFeatures(core_Util_Util.toGeoJSON(features), {
                                    extent,
                                    dataProjection,
                                    featureProjection: projection
                                });
                            }
                            tile.setFeatures(features);
                        }
                    });
            });
        }
        /**
         * @private
         * @function VectorTileSuperMapRest.prototype.tileLoadFunction
         * @description å è½½ç¦çã
         * @param {Object} tile -ç¦çç±»ã
         * @param {string} tileUrl - ç¦çå°åã
         */
        function mvtTileLoadFunction(tile, tileUrl) {
            const format = tile.getFormat();
            const success = tile.onLoad.bind(tile);
            const failure = tile.onError.bind(tile);
            tile.setLoader(function (extent, resolution, projection) {
                const xhr = new XMLHttpRequest();
                xhr.open(
                    'GET',
                    typeof tileUrl === 'function' ? tileUrl(extent, resolution, projection) : tileUrl,
                    true
                );
                if (format.getType() == 'arraybuffer') {
                    xhr.responseType = 'arraybuffer';
                }
                xhr.withCredentials = me.withCredentials;
                xhr.onload = function () {
                    if (!xhr.status || (xhr.status >= 200 && xhr.status < 300)) {
                        const type = format.getType();
                        let source = void 0;
                        if (type === 'json' || type === 'text') {
                            source = xhr.responseText;
                        } else if (type === 'xml') {
                            source = xhr.responseXML;
                            if (!source) {
                                source = new DOMParser().parseFromString(xhr.responseText, 'application/xml');
                            }
                        } else if (type === 'arraybuffer') {
                            source = xhr.response;
                        }
                        if (source) {
                            if (['4', '5'].indexOf(core_Util_Util.getOlVersion()) > -1) {
                                success.call(
                                    this,
                                    format.readFeatures(source, { featureProjection: projection }),
                                    format.readProjection(source),
                                    format.getLastExtent()
                                );
                            } else {
                                success.call(
                                    this,
                                    format.readFeatures(source, {
                                        extent: extent,
                                        featureProjection: projection
                                    }),
                                    format.readProjection(source)
                                );
                            }
                        } else {
                            failure.call(this);
                        }
                    } else {
                        failure.call(this);
                    }
                }.bind(this);
                xhr.onerror = function () {
                    failure.call(this);
                }.bind(this);
                xhr.send();
            });
        }
    }
    _fillByStyleJSON(style, source) {
        if (!source) {
            source = Object.keys(style.sources)[0];
        }
        if (style.sources && style.sources[source]) {
            //ToDo æ¯æå¤ä¸ªtileså°å
            this._tileUrl = SecurityManager.appendCredential(style.sources[source].tiles[0]);
        }
        if (style.metadata && style.metadata.indexbounds) {
            const indexbounds = style.metadata.indexbounds;
            var max = Math.max(indexbounds[2] - indexbounds[0], indexbounds[3] - indexbounds[1]);
            const defaultResolutions = [];
            for (let index = 0; index < 30; index++) {
                defaultResolutions.push(max / 512 / Math.pow(2, index));
            }
            this.tileGrid = new (external_ol_tilegrid_TileGrid_default())({
                extent: style.metadata.indexbounds,
                resolutions: defaultResolutions,
                tileSize: [512, 512]
            });
        }
    }
    _fillByRestMapOptions(url, options) {
        this._tileUrl = Util.urlPathAppend(options.url, 'tileFeature.json');
        if (options.format instanceof (external_ol_format_MVT_default())) {
            this._tileUrl = Util.urlPathAppend(options.url, 'tileFeature.mvt');
        }
        //ä¸ºurlæ·»å å®å¨è®¤è¯ä¿¡æ¯çæ®µ
        this._tileUrl = SecurityManager.appendCredential(this._tileUrl);

        var returnAttributes = true;
        if (options.returnAttributes !== undefined) {
            returnAttributes = options.returnAttributes;
        }
        var params = {};
        params['returnAttributes'] = returnAttributes;
        if (options._cache !== undefined) {
            params['_cache'] = options._cache;
        }
        if (options.layersID !== undefined) {
            params['layersID'] = options.layersID;
        }
        if (options.layerNames !== undefined) {
            params['layerNames'] = options.layerNames;
        }
        if (options.expands !== undefined) {
            params['expands'] = options.expands;
        }
        if (options.compressTolerance !== undefined) {
            params['compressTolerance'] = options.compressTolerance;
        }
        if (options.coordinateType !== undefined) {
            params['coordinateType'] = options.coordinateType;
        }
        if (options.returnCutEdges !== undefined) {
            params['returnCutEdges'] = options.returnCutEdges;
        }
        this._tileUrl = Util.urlAppend(this._tileUrl, Util.getParameterString(params));
    }

    /**
     * @function VectorTileSuperMapRest.optionsFromMapJSON
     * @param {string} url - å°åã
     * @param {Object} mapJSONObj - å°å¾ JSONã
     * @description è·åå°å¾ JSON ä¿¡æ¯ã
     */
    static optionsFromMapJSON(url, mapJSONObj) {
        var options = {};
        options.url = url;
        options.crossOrigin = 'anonymous';
        var extent = [mapJSONObj.bounds.left, mapJSONObj.bounds.bottom, mapJSONObj.bounds.right, mapJSONObj.bounds.top];
        var resolutions = getResolutions();

        function getResolutions() {
            var level = 17;
            var dpi = 96;
            var width = extent[2] - extent[0];
            var height = extent[3] - extent[1];
            var tileSize = width >= height ? width : height;
            var maxReolution;
            if (tileSize === width) {
                maxReolution = tileSize / mapJSONObj.viewer.width;
            } else {
                maxReolution = tileSize / mapJSONObj.viewer.height;
            }
            var resolutions = [];
            var unit = Unit.METER;
            if (mapJSONObj.coordUnit === Unit.DEGREE) {
                unit = Unit.DEGREE;
            }
            if (mapJSONObj.visibleScales.length > 0) {
                var scales = initScales(mapJSONObj);
                for (let i = 0; i < scales.length; i++) {
                    resolutions.push(core_Util_Util.scaleToResolution(scales[i], dpi, unit));
                }
            } else {
                for (let i = 0; i < level; i++) {
                    resolutions.push(maxReolution / Math.pow(2, i));
                }
            }
            return resolutions;
        }

        function initScales(mapJSONObj) {
            var scales = mapJSONObj.visibleScales;
            if (!scales) {
                return null;
            }
            var viewBounds = mapJSONObj.viewBounds,
                coordUnit = mapJSONObj.coordUnit,
                viewer = mapJSONObj.viewer,
                scale = mapJSONObj.scale,
                datumAxis = mapJSONObj.datumAxis;
            //å°jsonObjectè½¬åä¸ºSuperMap.Boundsï¼ç¨äºè®¡ç®dpiã
            viewBounds = new Bounds(viewBounds.left, viewBounds.bottom, viewBounds.right, viewBounds.top);
            viewer = new Size(viewer.rightBottom.x, viewer.rightBottom.y);
            coordUnit = coordUnit.toLowerCase();
            datumAxis = datumAxis || 6378137;
            var units = coordUnit;
            var dpi = Util.calculateDpi(viewBounds, viewer, scale, units, datumAxis);
            var resolutions = _resolutionsFromScales(scales);
            var len = resolutions.length;
            scales = [len];
            for (var i = 0; i < len; i++) {
                scales[i] = Util.getScaleFromResolutionDpi(resolutions[i], dpi, units, datumAxis);
            }

            function _resolutionsFromScales(scales) {
                if (scales === null) {
                    return;
                }
                var resolutions, len;
                len = scales.length;
                resolutions = [len];
                for (var i = 0; i < len; i++) {
                    resolutions[i] = Util.getResolutionFromScaleDpi(scales[i], dpi, units, datumAxis);
                }
                return resolutions;
            }

            return scales;
        }

        options.tileGrid = new (external_ol_tilegrid_TileGrid_default())({
            extent: extent,
            resolutions: resolutions
        });
        //options.projection = 'EPSG:' + mapJSONObj.prjCoordSys.epsgCode;
        return options;
    }
}

;// CONCATENATED MODULE: ./src/openlayers/overlay/HeatMap.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/












/**
 * @class HeatMap
 * @browsernamespace ol.source
 * @classdesc ç­åå¾å±ç±»ã
 * @category Visualization HeatMap
 * @param {string} name - å¾å±åç§°
 * @param {Object} options - åæ°ã
 * @param {ol.Map} options.map - openlayers ç map å¯¹è±¡ã
 * @param {string} [options.id] - ä¸é¢å¾å± IDï¼é»è®¤ä½¿ç¨ CommonUtil.createUniqueID("HeatMapSource_") åå»ºä¸é¢å¾å± IDã
 * @param {string} [options.featureWeight] - å¯¹åº feature å±æ§ä¸­çç­ç¹æéå­æ®µåç§°ï¼æéå¼ç±»åä¸º numberã
 * @param {number} [options.radius=50] - ç­ç¹æ¸²æçæå¤§åå¾ï¼ç­ç¹åç´ åå¾ï¼ï¼åä½ä¸º pxï¼å½ useGeoUnit åæ° ä¸º true æ¶ï¼åä½ä½¿ç¨å½åå¾å±å°çåæ åä½ãç­ç¹æ¾ç¤ºçæ¶åä»¥ç²¾ç¡®ç¹ä¸ºä¸­å¿ç¹å¼å§å¾åå¨è¾å°è¡°åï¼å¶è¡°ååå¾åæéå¼ææ¯åã
 * @param {number} [options.opacity=1] - å¾å±éæåº¦ã
 * @param {Array.<string>} [options.colors=['blue','cyan','lime','yellow','red']] - é¢è²çº¿æ§æ¸åæ°ç»ï¼é¢è²å¼å¿é¡»ä¸º canvas ææ¯æçã
 * @param {boolean} [options.useGeoUnit=false] - ä½¿ç¨å°çåä½ï¼false è¡¨ç¤ºé»è®¤ç­ç¹åå¾é»è®¤ä½¿ç¨åç´ åä½ãå½è®¾ç½®ä¸º true æ¶ï¼ç­ç¹åå¾åå¾å±å°çåæ ä¿æä¸è´ã
 * @extends {ol.source.ImageCanvas}
 * @usage
 */
class HeatMap extends (external_ol_source_ImageCanvas_default()) {

    constructor(name, opt_options) {
        var options = opt_options ? opt_options : {};
        super({
            attributions: options.attributions || "Map Data <span>Â© <a href='http://support.supermap.com.cn/product/iServer.aspx' target='_blank'>SuperMap iServer</a></span> with <span>Â© <a href='https://iclient.supermap.io' target='_blank'>SuperMap iClient</a></span>",
            canvasFunction: canvasFunctionInternal_,
            logo: core_Util_Util.getOlVersion() === '4' ? options.logo : null,
            projection: options.projection,
            ratio: options.ratio,
            resolutions: options.resolutions,
            state: options.state
        });

        function canvasFunctionInternal_(extent, resolution, pixelRatio, size, projection) { // eslint-disable-line no-unused-vars
            var mapWidth = size[0] * pixelRatio;
            var mapHeight = size[1] * pixelRatio;

            this.rootCanvas.width = this.maxWidth = mapWidth;
            this.rootCanvas.height = this.maxHeight = mapHeight;
            if (!this.features) {
                return this.rootCanvas;
            }
            this.pixelRatio = pixelRatio;

            //è®°å½åç§»é
            var width = this.map.getSize()[0] * pixelRatio;
            var height = this.map.getSize()[1] * pixelRatio;
            this.offset = [(mapWidth - width) / 2 / pixelRatio, (mapHeight - height) / 2 / pixelRatio];

            this.updateHeatPoints(resolution);

            return this.rootCanvas;
        }

        //åå§åæååé
        this.canvasFunctionInternal_ = canvasFunctionInternal_;
        this.features = [];
        this.name = name;
        if (!options.map) {
            throw new Error('options.map is not found.');
        }
        this.map = options.map;
        // this.TFEvents = options.TFEvents || [];
        this.id = options.id ? options.id : Util.createUniqueID("HeatMapSource_");
        this.opacity = options.opacity ? options.opacity : 1;
        this.colors = options.colors ? options.colors : ['blue', 'cyan', 'lime', 'yellow', 'red'];
        this.useGeoUnit = options.useGeoUnit ? options.useGeoUnit : false;
        this.radius = options.radius ? options.radius : 50;
        this.featureWeight = options.featureWeight ? options.featureWeight : null;
        this.maxWeight = null;
        this.minWeight = null;
        this.maxWidth = null;
        this.maxHeight = null;

        //åå»ºç­åå¾ç»å¶é¢æ¿
        this.rootCanvas = document.createElement("canvas");
        var mapSize = this.map.getSize();
        this.rootCanvas.width = this.maxWidth = parseInt(mapSize[0]);
        this.rootCanvas.height = this.maxHeight = parseInt(mapSize[1]);
        Util.modifyDOMElement(this.rootCanvas, null, null, null,
            null, null, null, this.opacity);
        this.canvasContext = this.rootCanvas.getContext('2d');
    }

    /**
     * @function HeatMap.prototype.addFeatures
     * @description æ·»å ç­ç¹ä¿¡æ¯ã
     * @param {(GeoJSONObject|Array.<ol.Feature>)} features - å¾æ·»å çè¦ç´ æ°ç»ã
     * @example
     * var geojson = {
     *      "type": "FeatureCollection",
     *      "features": [
     *          {
     *              "type": "feature",
     *              "geometry": {
     *                  "type": "Point",  //åªæ¯æpointç±»å
     *                  "coordinates": [0, 0]
     *              },
     *              "properties": {
     *                  "height": Math.random()*9,
     *              }
     *          }
     *      ]
     *   };
     * var heatMapSource = new HeatMap("heatMap",{"map": map});
     * heatMapSource.addFeatures(geojson);
     * map.addLayer(new ol.layer.Image({
     *       source: heatMapSource
     *   }));
     */
    addFeatures(features) {
        this.features = this.toiClientFeature(features);
        //æ¯ææ´æ°featuresï¼å·æ°åºå¾
        this.changed();
    }

    /**
     * @function HeatMap.prototype.setOpacity
     * @description è®¾ç½®å¾å±çä¸éæåº¦ï¼åå¼ [0-1] ä¹é´ã
     * @param {number} opacity - ä¸éæåº¦ã
     */
    setOpacity(opacity) {
        if (opacity !== this.opacity) {
            this.opacity = opacity;
            var element = this.rootCanvas;
            Util.modifyDOMElement(element, null, null, null,
                null, null, null, opacity);

            if (this.map !== null) {
                // this.dispatchEvent({type: 'changelayer', value: {layer: this, property: "opacity"}});
                this.changed();
            }
        }
    }

    /**
     * @function HeatMap.prototype.updateHeatPoints
     * @description å·æ°ç­ç¹å¾æ¾ç¤ºã
     * @param {ol.LngLatBounds} resolution - å½åæ¾ç¤ºèå´ã
     * @private
     */
    updateHeatPoints(resolution) {
        if (this.features && this.features.length > 0) {
            this.convertFastToPixelPoints(resolution);
        } else {
            this.canvasContext.clearRect(0, 0, this.maxWidth, this.maxWidth);
        }
    }

    /**
     * @function HeatMap.prototype.convertFastToPixelPoints
     * @description è¿æ»¤ä½äºå½åæ¾ç¤ºèå´åçç­ç¹ï¼å¹¶è½¬æ¢å¶ä¸ºå½ååè¾¨çä¸çåç´ åæ ã
     * @param {number} resolution - å½ååè¾¨çã
     * @private
     */
    convertFastToPixelPoints(resolution) {
        var data = [], x, y, k, maxTemp, minTemp, maxWeightTemp;

        //ç­ç¹åå¾
        this.useRadius = this.useGeoUnit ? parseInt(this.radius / resolution) : this.radius;

        for (var i = 0; i < this.features.length; i++) {
            var feature = this.features[i];
            var point = feature.geometry;
            //è¿æ»¤ï¼åªæ¾ç¤ºå½åèå´
            // if (mapBounds.contains(point.x, point.y)) {
            var pixelPoint = this.getLocalXY(new LonLat(point.x, point.y));
            if (this.featureWeight) {
                pixelPoint.weight = feature.attributes[this.featureWeight];//point.value;
                if (!this.maxWeight) {
                    //æ¾åºæå¤§æå°æéå¼
                    maxTemp = maxTemp ? maxTemp : pixelPoint.weight;
                    minTemp = minTemp ? minTemp : pixelPoint.weight;
                    maxTemp = Math.max(maxTemp, pixelPoint.weight);
                    minTemp = Math.min(minTemp, pixelPoint.weight);
                }
            } else {
                pixelPoint.weight = 1;
            }

            x = Math.floor(pixelPoint[0]);
            y = Math.floor(pixelPoint[1]);
            k = pixelPoint.weight;

            data.push([x, y, k]);
            // }
        }

        //æ æå¤§æéè®¾ç½®
        if (!this.maxWeight) {
            if (maxTemp && minTemp) {
                maxWeightTemp = (maxTemp + minTemp) / 2;
            } else {
                maxWeightTemp = 1;
            }
            this.draw(data, maxWeightTemp);
        } else {
            this.draw(data, this.maxWeight);
        }

    }

    /**
     * @function HeatMap.prototype.draw
     * @description ç»å¶ç­ç¹å¾ã
     * @param {Array} data - convertToPixelPoints æ¹æ³è®¡ç®åºçç¹ã
     * @param {number} maxWeight -æå¤§æéã
     * @private
     */
    draw(data, maxWeight) {
        if (this.maxHeight > 0 && this.maxWidth > 0) {
            //æ¸ç©º
            var ctx = this.canvasContext;
            this.canvasContext.clearRect(0, 0, this.maxWidth, this.maxHeight);
            this.drawCircle(this.useRadius);
            this.createGradient();

            for (var i = 0; i < data.length; i++) {
                var p = data[i];
                this.canvasContext.globalAlpha = Math.max(p[2] / maxWeight, 0.05);
                this.canvasContext.drawImage(this.circle, p[0] - this.useRadius, p[1] - this.useRadius);
            }

            var colored = ctx.getImageData(0, 0, this.maxWidth, this.maxHeight);
            this.colorize(colored.data, this.grad);
            ctx.putImageData(colored, 0, 0);
        } else {
            return false;
        }

    }

    /**
     * @function HeatMap.prototype.colorize
     * @description æ ¹æ®æ¸åè²éç½®ç­ç¹å¾ rgb å¼ã
     * @param {Object} pixels - åç´  rgba å¼ã
     * @param {Array} gradient - æ¸å canvas.getImageData.dataã
     * @private
     */
    colorize(pixels, gradient) {
        for (var i = 0, j; i < pixels.length; i += 4) {
            j = pixels[i + 3] * 4;
            if (j) {
                pixels[i] = gradient[j];
                pixels[i + 1] = gradient[j + 1];
                pixels[i + 2] = gradient[j + 2];
            }
        }
    }

    /**
     * @function HeatMap.drawCircle
     * @description ç»å¶ç­ç¹åå¾åã
     * @param {number} r - ç­ç¹åå¾ã
     * @private
     */
    drawCircle(r) {
        var blur = r / 2;

        var circle = this.circle = document.createElement('canvas'),
            ctx = circle.getContext("2d");

        circle.height = 2 * r;
        circle.width = 2 * r;
        ctx.shadowOffsetX = ctx.shadowOffsetY = 2 * r;
        ctx.shadowBlur = blur;
        ctx.shadowColor = "#000000";

        ctx.beginPath();
        ctx.arc(-r, -r, r / 2, 0, Math.PI * 2, true);
        ctx.closePath();
        ctx.fill();
    }

    /**
     * @function HeatMap.createGradient
     * @description æ ¹æ® this.canvasColors è®¾ç½®æ¸åå¹¶ getImageDataã
     * @private
     */
    createGradient() {
        var colors = this.colors;
        var canvas = document.createElement('canvas'),
            ctx = canvas.getContext("2d"),
            gradient = ctx.createLinearGradient(0, 0, 0, 256);
        canvas.height = 256;
        canvas.width = 1;

        var index = 1;
        for (var i = 0, len = colors.length; i < len; i++) {
            gradient.addColorStop(index / len, colors[i]);
            index++;
        }

        ctx.fillStyle = gradient;
        ctx.fillRect(0, 0, 1, 256);

        this.grad = ctx.getImageData(0, 0, 1, 256).data;
    }

    /**
     * @function HeatMap.prototype.getLocalXY
     * @description è·ååæ ç³»ç»ã
     * @param {Object} coordinate - åæ ä½ç½®ã
     */
    getLocalXY(coordinate) {
        var pixelP, map = this.map;
        if (coordinate instanceof Point || coordinate instanceof GeoText) {
            pixelP = map.getPixelFromCoordinate([coordinate.x, coordinate.y]);
        }
        if (coordinate instanceof LonLat) {
            pixelP = map.getPixelFromCoordinate([coordinate.lon, coordinate.lat]);
        }
        var rotation = -map.getView().getRotation();
        var center = map.getPixelFromCoordinate(map.getView().getCenter());
        var rotatedP = pixelP;
        if (this.pixelRatio) {
            rotatedP = this.scale(pixelP, center, this.pixelRatio);
        }
        if (pixelP && center) {
            rotatedP = this.rotate(rotatedP, rotation, center);
        }
        if (this.offset && rotatedP) {
            return [rotatedP[0] + this.offset[0], rotatedP[1] + this.offset[1]];
        }
        return rotatedP;
    }

    /**
     * @function HeatMap.prototype.rotate
     * @description è·åæåç´ åæ ç¹ pixelP ç»ä¸­å¿ center éæ¶éæè½¬ rotation å¼§åº¦åçåç´ ç¹åæ ã
     * @param {number} pixelP - åç´ åæ ç¹ä½ç½®ã
     * @param {number} rotation - æè½¬è§åº¦ã
     * @param {number} center - ä¸­å¿ä½ç½®ã
     */
    rotate(pixelP, rotation, center) {
        var x = Math.cos(rotation) * (pixelP[0] - center[0]) - Math.sin(rotation) * (pixelP[1] - center[1]) + center[0];
        var y = Math.sin(rotation) * (pixelP[0] - center[0]) + Math.cos(rotation) * (pixelP[1] - center[1]) + center[1];
        return [x, y];
    }

    /**
     * @function HeatMap.prototype.scale
     * @description è·åæåç´ åæ ç¹ pixelP ç¸å¯¹äºä¸­å¿ center è¿è¡ç¼©æ¾ scaleRatio ååçåç´ ç¹åæ ã
     * @param {Object} pixelP - åç´ ç¹ã
     * @param {Object} center - ä¸­å¿ç¹ã
     * @param {number} scaleRatio - ç¼©æ¾åæ°ã
     * @returns {Array.<number>} è¿åæ°ç»å½¢æ¯ä¾
     */
    scale(pixelP, center, scaleRatio) {
        var x = (pixelP[0] - center[0]) * scaleRatio + center[0];
        var y = (pixelP[1] - center[1]) * scaleRatio + center[1];
        return [x, y];
    }

    /**
     * @function HeatMap.prototype.removeFeatures
     * @description ç§»é¤æå®çç­ç¹ä¿¡æ¯ã
     * @param {Array.<FeatureVector>|FeatureVector} features - ç­ç¹ä¿¡æ¯æ°ç»ã
     */
    removeFeatures(features) {
        if (!features || features.length === 0 || !this.features || this.features.length === 0) {
            return;
        }
        if (features === this.features) {
            return this.removeAllFeatures();
        }
        if (!(Util.isArray(features))) {
            features = [features];
        }
        var heatPoint, index, heatPointsFailedRemoved = [];
        for (var i = 0, len = features.length; i < len; i++) {
            heatPoint = features[i];
            index = Util.indexOf(this.features, heatPoint);
            //æ¾ä¸å°è§ä¸ºå é¤å¤±è´¥
            if (index === -1) {
                heatPointsFailedRemoved.push(heatPoint);
                continue;
            }
            //å é¤ç­ç¹
            this.features.splice(index, 1);
        }
        var succeed = heatPointsFailedRemoved.length == 0 ? true : false;
        //æ´¾åå é¤featuresæåçäºä»¶
        this.dispatchEvent({type: 'featuresremoved', value: {features: heatPointsFailedRemoved, succeed: succeed}});
        this.changed();
    }

    /**
     * @function HeatMap.prototype.removeAllFeatures
     * @description ç§»é¤å¨é¨çç­ç¹ä¿¡æ¯ã
     */
    removeAllFeatures() {
        this.features = [];
        this.changed();
    }

    /**
     * @function HeatMap.prototype.toiClientFeature
     * @description è½¬ä¸º iClient è¦ç´ ã
     * @param {GeoJSONObject|Array.<ol.Feature>} features - å¾æ·»å çè¦ç´ æ°ç»ã
     * @returns {FeatureVector} è½¬æ¢åç iClient è¦ç´ 
     */
    toiClientFeature(features) {
        if (!core_Util_Util.isArray(features)) {
            features = [features];
        }
        let featuresTemp = [], geometry, attributes;
        for (let i = 0, len = features.length; i < len; i++) {
            if (features[i] instanceof (external_ol_Feature_default())) {
                //ç­ç¹å¾æ¯æ¯æä¼ å¥ç¹å¯¹è±¡è¦ç´ 
                if (features[i].getGeometry() instanceof (external_ol_geom_Point_default())) {
                    geometry = new Point(features[i].getGeometry().getCoordinates()[0], features[i].getGeometry().getCoordinates()[1]);
                    //åºå®å±æ§å­æ®µä¸º "Properties"
                    attributes = features[i].getProperties()["Properties"] ? features[i].getProperties()["Properties"] : {};
                    featuresTemp.push(new Vector(geometry, attributes));
                }
            } else if (["FeatureCollection", "Feature", "Geometry"].indexOf(features[i].type) != -1) {
                let format = new GeoJSON();
                featuresTemp = featuresTemp.concat(format.read(features[i]));
            } else if (features[i].geometry && features[i].geometry.parts) {
                //iServeræå¡å¨è¿åæ°æ®æ ¼å¼
                featuresTemp.push(ServerFeature.fromJson(features[i]).toFeature());
            } else {
                throw new Error(`Features[${i}]'s type does not match, please check.`);
            }
        }
        return featuresTemp;
    }

}

;// CONCATENATED MODULE: ./src/openlayers/overlay/graphic/index.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/






;// CONCATENATED MODULE: ./src/openlayers/overlay/mapv/index.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


;// CONCATENATED MODULE: ./src/openlayers/overlay/theme/index.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



;// CONCATENATED MODULE: external "ol.geom.LineString"
const external_ol_geom_LineString_namespaceObject = ol.geom.LineString;
var external_ol_geom_LineString_default = /*#__PURE__*/__webpack_require__.n(external_ol_geom_LineString_namespaceObject);
;// CONCATENATED MODULE: ./src/openlayers/overlay/vectortile/olExtends.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
 
 
 
 var olExtends = function(targetMap) {
     //è§£å³olms.jsæä»¶ï¼å¨ä½¿ç¨ol.jsæ¶æ²¿çº¿æ æ³¨ä¸æ¾ç¤ºçé®é¢ï¼å ä¸ºol.geom.LineString.getFlatMidpointæªéå¬å¼æ¹æ³
     if (!(external_ol_geom_LineString_default()).prototype.getFlatMidpoint) {
         (external_ol_geom_LineString_default()).prototype.getFlatMidpoint = function() {
             return this.getCoordinateAt(0.5);
         };
     }
     
     if (core_Util_Util.getOlVersion() === '4' && window && window.ol && window.ol.geom.flat) {
         // for ol4-debug
         window.targetMapCache = targetMap;
         let ol = window.ol;
         //è§£å³ new ol.format.MVT({featureClass: ol.Feature})æ¶ï¼é3857æ¾ç¤ºå¼å¸¸çé®é¢ãolå³å°åå¸ç5.0çæ¬å·²è§£å³ã
         // eslint-disable-next-line no-unused-vars
         ol.format.MVT.prototype.readProjection = function(source) {
             return new ol.proj.Projection({
                 code: '',
                 units: ol.proj.Units.TILE_PIXELS
             });
         };
         //è§£å³ new ol.format.MVT({featureClass: ol.Feature})æ¶ï¼é3857æ¾ç¤ºå¼å¸¸çé®é¢ãolå³å°åå¸ç5.0çæ¬å·²è§£å³ã
         // eslint-disable-next-line no-unused-vars
         ol.format.MVT.prototype.readProjection = function(source) {
             return new ol.proj.Projection({
                 code: '',
                 units: ol.proj.Units.TILE_PIXELS
             });
         };
         //è§£å³é¢å¡«åæ¶ä¸è½æ´çå¡«åçé®é¢ãolå³å°åå¸ç5.0çæ¬å·²è§£å³ã
         // eslint-disable-next-line no-unused-vars
         ol.render.canvas.Replay.prototype.applyFill = function(state, geometry) {
             var fillStyle = state.fillStyle;
             var fillInstruction = [ol.render.canvas.Instruction.SET_FILL_STYLE, fillStyle];
             if (typeof fillStyle !== 'string') {
                 var viewExtent = window.targetMapCache
                     .getView()
                     .getProjection()
                     .getExtent();
                 fillInstruction.push([viewExtent[0], viewExtent[3]]);
             }
             this.instructions.push(fillInstruction);
         };
         //è§£å³é¢å¡«åæ¶ä¸è½æ´çå¡«åçé®é¢ãolå³å°åå¸ç5.0çæ¬å·²è§£å³ã
         // eslint-disable-next-line no-unused-vars
         ol.render.canvas.Replay.prototype.applyFill = function(state, geometry) {
             var fillStyle = state.fillStyle;
             var fillInstruction = [ol.render.canvas.Instruction.SET_FILL_STYLE, fillStyle];
             if (typeof fillStyle !== 'string') {
                 var viewExtent = window.targetMapCache
                     .getView()
                     .getProjection()
                     .getExtent();
                 fillInstruction.push([viewExtent[0], viewExtent[3]]);
             }
             this.instructions.push(fillInstruction);
         };
         //è§£å³å¨å¤é¢æ¶ï¼ç¬¬ä¸ä¸ªé¢æ¯éæ¶éæ¶æ æ³æ¾ç¤ºçé®é¢ãè¯¥é®é¢ç±ç»ä»¶ä¿®å¤ã
         ol.format.MVT.prototype.createFeature_ = function(pbf, rawFeature, opt_options) {
             var type = rawFeature.type;
             if (type === 0) {
                 return null;
             }
 
             var feature;
             var id = rawFeature.id;
             var values = rawFeature.properties;
             values[this.layerName_] = rawFeature.layer.name;
 
             var flatCoordinates = [];
             var ends = [];
             ol.format.MVT.readRawGeometry_(pbf, rawFeature, flatCoordinates, ends);
 
             var geometryType = ol.format.MVT.getGeometryType_(type, ends.length);
 
             if (this.featureClass_ === ol.render.Feature) {
                 feature = new this.featureClass_(geometryType, flatCoordinates, ends, values, id);
             } else {
                 var geom;
                 if (geometryType == ol.geom.GeometryType.POLYGON) {
                     var endss = [];
                     var offset = 0;
                     var prevEndIndex = 0;
                     for (var i = 0, ii = ends.length; i < ii; ++i) {
                         var end = ends[i];
                         if (!ol.geom.flat.orient.linearRingIsClockwise(flatCoordinates, offset, end, 2)) {
                             endss.push(ends.slice(prevEndIndex, i + 1));
                             prevEndIndex = i + 1;
                         }
                         offset = end;
                     }
                     if (endss.length > 1) {
                         ends = endss;
                         geom = new ol.geom.MultiPolygon(null);
                     } else {
                         geom = new ol.geom.Polygon(null);
                     }
                 } else {
                     geom =
                         geometryType === ol.geom.GeometryType.POINT
                             ? new ol.geom.Point(null)
                             : geometryType === ol.geom.GeometryType.LINE_STRING
                             ? new ol.geom.LineString(null)
                             : geometryType === ol.geom.GeometryType.POLYGON
                             ? new ol.geom.Polygon(null)
                             : geometryType === ol.geom.GeometryType.MULTI_POINT
                             ? new ol.geom.MultiPoint(null)
                             : geometryType === ol.geom.GeometryType.MULTI_LINE_STRING
                             ? new ol.geom.MultiLineString(null)
                             : null;
                 }
                 if (geom) {
                     geom.setFlatCoordinates(ol.geom.GeometryLayout.XY, flatCoordinates, ends);
                     feature = new this.featureClass_();
                     if (this.geometryName_) {
                         feature.setGeometryName(this.geometryName_);
                     }
                     var geometry = ol.format.Feature.transformWithOptions(geom, false, this.adaptOptions(opt_options));
                     feature.setGeometry(geometry);
                     feature.setId(id);
                     feature.setProperties(values);
                 }
             }
 
             return feature;
         };
         //è§£å³ä¸­ææ²¿çº¿è¡¨è¿°æ¾ç¤ºä¸ç¬¦åä¸­æéè¯»ä¹ æ¯çé®é¢
         ol.geom.flat.textpath.lineString = function(
             flatCoordinates,
             offset,
             end,
             stride,
             text,
             measure,
             startM,
             maxAngle
         ) {
             var result = [];
 
             // Keep text upright
             var anglereverse = Math.atan2(
                 flatCoordinates[end - stride + 1] - flatCoordinates[offset + 1],
                 flatCoordinates[end - stride] - flatCoordinates[offset]
             );
             var reverse = anglereverse < -0.785 || anglereverse > 2.356; //0.785//2.356
             var isRotateUp =
                 (anglereverse < -0.785 && anglereverse > -2.356) || (anglereverse > 0.785 && anglereverse < 2.356);
 
             var numChars = text.length;
 
             var x1 = flatCoordinates[offset];
             var y1 = flatCoordinates[offset + 1];
             offset += stride;
             var x2 = flatCoordinates[offset];
             var y2 = flatCoordinates[offset + 1];
             var segmentM = 0;
             var segmentLength = Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));
 
             while (offset < end - stride && segmentM + segmentLength < startM) {
                 x1 = x2;
                 y1 = y2;
                 offset += stride;
                 x2 = flatCoordinates[offset];
                 y2 = flatCoordinates[offset + 1];
                 segmentM += segmentLength;
                 segmentLength = Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));
             }
             var interpolate = (startM - segmentM) / segmentLength;
             var x0 = ol.math.lerp(x1, x2, interpolate); //èµ·å§ç¹
             var y0 = ol.math.lerp(y1, y2, interpolate); //èµ·å§ç¹
 
             var chunk = '';
             var chunkLength = 0;
             var data, index, previousAngle, previousLang;
             for (var i = 0; i < numChars; ++i) {
                 index = reverse ? numChars - i - 1 : i;
                 var char = text.charAt(index);
                 var charcode = char.charCodeAt(0);
                 var ischinese = charcode >= 19968 && charcode <= 40907;
                 chunk = reverse ? char + chunk : chunk + char;
                 var charLength = measure(chunk) - chunkLength;
                 chunkLength += charLength;
                 //var charM = startM + charLength / 2;
                 while (
                     offset < end - stride &&
                     Math.sqrt(Math.pow(x2 - x0, 2) + Math.pow(y2 - y0, 2)) < charLength / 2
                 ) {
                     x1 = x2;
                     y1 = y2;
                     offset += stride;
                     x2 = flatCoordinates[offset];
                     y2 = flatCoordinates[offset + 1];
                 }
                 var a = Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2);
                 var b = 2 * (x2 - x1) * (x1 - x0) + 2 * (y2 - y1) * (y1 - y0);
                 var c = Math.pow(x1 - x0, 2) + Math.pow(y1 - y0, 2) - Math.pow(charLength / 2, 2);
                 var scale1 = (-b + Math.sqrt(b * b - 4 * a * c)) / (2 * a);
                 var scale2 = (-b - Math.sqrt(b * b - 4 * a * c)) / (2 * a);
                 interpolate =
                     scale1 < 0 || scale1 > 1
                         ? scale2
                         : scale2 < 0 || scale2 > 1
                         ? scale1
                         : scale1 < scale2
                         ? scale2
                         : scale1;
                 var x = ol.math.lerp(x1, x2, interpolate);
                 var y = ol.math.lerp(y1, y2, interpolate);
 
                 while (offset < end - stride && Math.sqrt(Math.pow(x2 - x, 2) + Math.pow(y2 - y, 2)) < charLength / 2) {
                     x1 = x2;
                     y1 = y2;
                     offset += stride;
                     x2 = flatCoordinates[offset];
                     y2 = flatCoordinates[offset + 1];
                 }
                 a = Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2);
                 b = 2 * (x2 - x1) * (x1 - x) + 2 * (y2 - y1) * (y1 - y);
                 c = Math.pow(x1 - x, 2) + Math.pow(y1 - y, 2) - Math.pow(charLength / 2, 2);
                 scale1 = (-b + Math.sqrt(b * b - 4 * a * c)) / (2 * a);
                 scale2 = (-b - Math.sqrt(b * b - 4 * a * c)) / (2 * a);
                 interpolate =
                     scale1 < 0 || scale1 > 1
                         ? scale2
                         : scale2 < 0 || scale2 > 1
                         ? scale1
                         : scale1 < scale2
                         ? scale2
                         : scale1;
                 var x3 = ol.math.lerp(x1, x2, interpolate);
                 var y3 = ol.math.lerp(y1, y2, interpolate);
                 var angle = Math.atan2(y3 - y0, x3 - x0);
 
                 if (reverse) {
                     angle += angle > 0 ? -Math.PI : Math.PI;
                 }
                 if (ischinese && isRotateUp) {
                     angle += angle > 0 ? -Math.PI / 2 : Math.PI / 2;
                 }
                 if (previousAngle !== undefined) {
                     var delta = angle - previousAngle;
                     delta += delta > Math.PI ? -2 * Math.PI : delta < -Math.PI ? 2 * Math.PI : 0;
                     if (
                         ischinese === previousLang
                             ? Math.abs(delta) > maxAngle
                             : Math.abs(delta) > maxAngle + Math.PI / 2
                     ) {
                         return null;
                     }
                 }
 
                 if (previousAngle == angle && !isRotateUp) {
                     if (reverse) {
                         data[0] = x;
                         data[1] = y;
                         data[2] = charLength / 2;
                     }
                     data[4] = chunk;
                 } else {
                     chunk = char;
                     chunkLength = charLength;
                     data = [x, y, charLength / 2, angle, chunk];
                     if (reverse) {
                         result.unshift(data);
                     } else {
                         result.push(data);
                     }
                     previousAngle = angle;
                     previousLang = ischinese;
                 }
                 x0 = x3;
                 y0 = y3;
                 startM += charLength;
             }
             return result;
         };
         //ä»¥ä¸ä¸¤ä¸ªæ¹æ³è§£å³å¨å¤§æ°æ®éå¾ææ¶ï¼åå­ç¯é¿çé®é¢ãè¯¥æ¹æ³å¼åæ°é®é¢:æ æ³ç¹éè¦ç´ 
         ol.layer.VectorTile.prototype.setFastRender = function(fastRender) {
             return (this.fastRender = fastRender);
         };
         ol.renderer.canvas.VectorTileLayer.prototype.postCompose = function(context, frameState, layerState) {
             var layer = this.getLayer();
             var declutterReplays = layer.getDeclutter() ? {} : null;
             var source = /** @type {ol.source.VectorTile} */ (layer.getSource());
             var renderMode = layer.getRenderMode();
             var replayTypes = ol.renderer.canvas.VectorTileLayer.VECTOR_REPLAYS[renderMode];
             var pixelRatio = frameState.pixelRatio;
             var rotation = frameState.viewState.rotation;
             var size = frameState.size;
             var offsetX, offsetY;
             if (rotation) {
                 offsetX = Math.round((pixelRatio * size[0]) / 2);
                 offsetY = Math.round((pixelRatio * size[1]) / 2);
                 ol.render.canvas.rotateAtOffset(context, -rotation, offsetX, offsetY);
             }
             if (declutterReplays) {
                 this.declutterTree_.clear();
             }
             var tiles = this.renderedTiles;
             var tileGrid = source.getTileGridForProjection(frameState.viewState.projection);
             var clips = [];
             var zs = [];
             for (var i = tiles.length - 1; i >= 0; --i) {
                 var tile = /** @type {ol.VectorImageTile} */ (tiles[i]);
                 if (tile.getState() == ol.TileState.ABORT) {
                     continue;
                 }
                 var tileCoord = tile.tileCoord;
                 var worldOffset =
                     tileGrid.getTileCoordExtent(tileCoord)[0] - tileGrid.getTileCoordExtent(tile.wrappedTileCoord)[0];
                 var transform = undefined;
                 for (var t = 0, tt = tile.tileKeys.length; t < tt; ++t) {
                     var sourceTile = tile.getTile(tile.tileKeys[t]);
                     if (sourceTile.getState() == ol.TileState.ERROR) {
                         continue;
                     }
                     var replayGroup = sourceTile.getReplayGroup(layer, tileCoord.toString());
                     if (
                         renderMode != ol.layer.VectorTileRenderType.VECTOR &&
                         (!replayGroup || !replayGroup.hasReplays(replayTypes))
                     ) {
                         if (layer.fastRender === true) {
                             sourceTile.replayGroups_ = {};
                             sourceTile.features_ = [];
                         }
                         continue;
                     }
                     if (!transform) {
                         transform = this.getTransform(frameState, worldOffset);
                     }
                     var currentZ = sourceTile.tileCoord[0];
                     var currentClip = replayGroup.getClipCoords(transform);
                     context.save();
                     context.globalAlpha = layerState.opacity;
                     // Create a clip mask for regions in this low resolution tile that are
                     // already filled by a higher resolution tile
                     for (var j = 0, jj = clips.length; j < jj; ++j) {
                         var clip = clips[j];
                         if (currentZ < zs[j]) {
                             context.beginPath();
                             // counter-clockwise (outer ring) for current tile
                             context.moveTo(currentClip[0], currentClip[1]);
                             context.lineTo(currentClip[2], currentClip[3]);
                             context.lineTo(currentClip[4], currentClip[5]);
                             context.lineTo(currentClip[6], currentClip[7]);
                             // clockwise (inner ring) for higher resolution tile
                             context.moveTo(clip[6], clip[7]);
                             context.lineTo(clip[4], clip[5]);
                             context.lineTo(clip[2], clip[3]);
                             context.lineTo(clip[0], clip[1]);
                             context.clip();
                         }
                     }
                     replayGroup.replay(context, transform, rotation, {}, replayTypes, declutterReplays);
                     context.restore();
                     clips.push(currentClip);
                     zs.push(currentZ);
                 }
             }
             if (declutterReplays) {
                 ol.render.canvas.ReplayGroup.replayDeclutter(declutterReplays, context, rotation);
             }
             if (rotation) {
                 ol.render.canvas.rotateAtOffset(
                     context,
                     rotation,
                     /** @type {number} */
                     (offsetX),
                     /** @type {number} */ (offsetY)
                 );
             }
             ol.renderer.canvas.TileLayer.prototype.postCompose.apply(this, arguments);
         };
     }
 };
 window.olExtends = olExtends;
 
// EXTERNAL MODULE: ./node_modules/lodash.remove/index.js
var lodash_remove = __webpack_require__(794);
var lodash_remove_default = /*#__PURE__*/__webpack_require__.n(lodash_remove);
;// CONCATENATED MODULE: ./src/openlayers/overlay/vectortile/MapboxStyles.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/











/**
 * @class MapboxStyles
 * @classdesc Mapbox ç¢éç¦çé£æ ¼ã
 * <div style="padding: 20px;border: 1px solid #eee;border-left-width: 5px;border-radius: 3px;border-left-color: #ce4844;">
 *      <p style="color: #ce4844">Notice</p>
 *      <p style="font-size: 13px">è¯¥åè½ä¾èµ <a href='https://github.com/boundlessgeo/ol-mapbox-style'>ol-mapbox-style</a> æä»¶ï¼è¯·ç¡®è®¤å¼å¥è¯¥æä»¶ã</p>
 *      `<script type="text/javascript" src="https://rawgit.com/boundlessgeo/ol-mapbox-style/v2.11.2-1/dist/olms.js"></script>`
 * </div>
 * @category  Visualization VectorTile
 * @param {Object} options - åæ°ã
 * @param {(string|undefined)} [options.url] - SuperMap iServer å°å¾æå¡å°åï¼ä¾å¦'http://localhost:8090/iserver/services/map-mvt-test/rest/maps/test'ï¼ä¸options.styleäºæ¥ï¼ä¼åçº§ä½äºoptions.styleã
 * @param {(Object|string|undefined)} [options.style] - Mapbox Style JSON å¯¹è±¡æè·å Mapbox Style JSON å¯¹è±¡ç URLãä¸ options.url äºæ¥ï¼ä¼åçº§é«äº options.urlã
 * @param {Array.<number>} [options.resolutions] - å°å¾åè¾¨çæ°ç»ï¼ç¨äºæ å° zoom å¼ãéå¸¸ææ³ä¸å°å¾ç {@link ol.View} çåè¾¨çä¸è´ã</br>
 * é»è®¤å¼ä¸ºï¼[78271.51696402048,39135.75848201024, 19567.87924100512,9783.93962050256,4891.96981025128,2445.98490512564, 1222.99245256282,611.49622628141,305.748113140705,152.8740565703525, 76.43702828517625,38.21851414258813,19.109257071294063,9.554628535647032, 4.777314267823516,2.388657133911758,1.194328566955879,0.5971642834779395, 0.29858214173896974,0.14929107086948487,0.07464553543474244]ã
 * @param {(string|Array.<string>|undefined)} [options.source] - Mapbox Style 'source'ç key å¼æè 'layer' ç ID æ°ç»ã
 * å½éç½® 'source' ç key å¼æ¶ï¼source ä¸ºè¯¥å¼ç layer ä¼è¢«å è½½ï¼
 * å½éç½®ä¸º 'layer' ç ID æ°ç»æ¶ï¼æå®ç layer ä¼è¢«å è½½ï¼æ³¨æè¢«æå®ç layer éè¦æç¸åç sourceã
 * å½ä¸éç½®æ¶ï¼é»è®¤ä¸º Mapbox Style JSON ç `sources` å¯¹è±¡ä¸­çç¬¬ä¸ä¸ªã
 * @param {ol.Map} [options.map] - Openlayers å°å¾å¯¹è±¡ï¼ä»ç¨äºé¢å¡«åæ ·å¼ï¼è¥æ²¡æé¢å¡«åæ ·å¼å¯ä¸å¡«ã
 * @param {ol.StyleFunction} [options.selectedStyle] -éä¸­æ ·å¼Functionã
 * @param {boolean} [options.withCredentials] - è¯·æ±æ¯å¦æºå¸¦ cookieã
 * @example
 *  var mbStyle = new MapboxStyles({
            url: url,
            source: 'California',
            resolutions: [78271.51696402048,39135.75848201024, 19567.87924100512,9783.93962050256,4891.96981025128,2445.98490512564]
    })
    mbStyle.on('styleLoaded', function () {
           var vectorLayer = new ol.layer.VectorTile({
                //è®¾ç½®é¿è®©åæ°
                declutter: true,
                source: new ol.source.VectorTileSuperMapRest({
                    url: url,
                    format: new ol.format.MVT({
                        featureClass: ol.Feature
                    }),
                    tileType: 'ScaleXY'
                }),
                style: mbStyle.featureStyleFuntion
            });
            map.addLayer(vectorLayer);
        })
 * @usage
 */
class MapboxStyles extends (external_ol_Observable_default()) {
    constructor(options) {
        super();
        options = options || {};
        this.spriteRegEx = /^(.*)(\?.*)$/;
        this.defaultFont = ['DIN Offc Pro Medium', 'Arial Unicode MS Regular'];
        this.map = options.map;
        this.source = options.source;
        this.styleTarget =
            options.style ||
            Util.urlAppend(
                Util.urlPathAppend(options.url, 'tileFeature/vectorstyles'),
                'type=MapBox_GL&styleonly=true'
            );
        this.resolutions = options.resolutions;
        this.withCredentials = options.withCredentials;
        this.selectedObjects = [];
        this.selectedStyle =
            options.selectedStyle ||
            function() {
                return new (external_ol_style_Style_default())({
                    fill: new (external_ol_style_Fill_default())({
                        color: 'rgba(255, 0, 0, 1)'
                    }),
                    stroke: new (external_ol_style_Stroke_default())({
                        color: 'rgba(255, 0, 0, 1)',
                        width: 10
                    }),
                    text: new (external_ol_style_Text_default())({
                        font: 'normal 400 11.19px "Microsoft YaHei"',
                        placement: 'point',
                        fill: new (external_ol_style_Fill_default())({
                            color: 'blue'
                        })
                    }),
                    image: new (external_ol_style_Circle_default())({
                        radius: 5,
                        fill: new (external_ol_style_Fill_default())({
                            color: 'blue'
                        })
                    })
                });
            };
        this.layersBySourceLayer = {};
        olExtends(this.map);
        this._loadStyle(this.styleTarget);
    }
    /**
     * @function MapboxStyles.prototype.getStyleFunction
     * @description è·å ol.StyleFunctionã
     * @returns {ol.StyleFunction} è¿å ol.StyleFunction
     */
    getStyleFunction() {
        return this.featureStyleFuntion;
    }
    /**
     * @function MapboxStyles.prototype.getStylesBySourceLayer
     * @description æ ¹æ®å¾å±åç§°è·åæ ·å¼ã
     * @param {string} sourceLayer - æ°æ®å¾å±åç§°ã
     */
    getStylesBySourceLayer(sourceLayer) {
        if (this.layersBySourceLayer[sourceLayer]) {
            return this.layersBySourceLayer[sourceLayer];
        }
        const layers = [];
        for (let index = 0; index < this._mbStyle.layers.length; index++) {
            const layer = this._mbStyle.layers[index];
            if (layer['source-layer'] !== sourceLayer) {
                continue;
            }
            layers.push(layer);
        }
        this.layersBySourceLayer[sourceLayer] = layers;
        return layers;
    }
    /**
     * @function MapboxStyles.prototype.setSelectedId
     * @description è®¾ç½®éä¸­è¦ç´ ï¼è¯¥è¦ç´ å°ä¼ç¨ `selectedStyle` æ ·å¼ç»å¶ãè°ç¨è¯¥æ¹æ³åéè¦è°ç¨ {@link ol.layer.VectorTile} ç `changed`,æè½çæã
     * @param {number} selectedId - è¦ç´ IDã
     * @param {string} sourceLayer - è¦ç´ æå¨å¾å±åç§°ã
     */
    setSelectedId(selectedId, sourceLayer) {
        this.selectedObjects = [];
        this.selectedObjects.push({
            id: selectedId,
            sourceLayer: sourceLayer
        });
    }
    /**
     * @typedef {Object} MapboxStyles.selectedObject
     * @description è¦éæ©çè¦ç´ å¯¹è±¡ã
     * @property {number} selectedId - è¦ç´ IDã
     * @property {string} sourceLayer - è¦ç´ æå¨å¾å±åç§°ã
     */

    /**
     * @function MapboxStyles.prototype.setSelectedObjects
     * @version 10.0.0
     * @description è®¾ç½®éä¸­è¦ç´ æè¦ç´ æ°ç»ï¼è¯¥è¦ç´ å°ä¼ç¨ `selectedStyle` æ ·å¼ç»å¶ãè°ç¨è¯¥æ¹æ³åéè¦è°ç¨ {@link ol.layer.VectorTile} ç `changed`,æè½çæã
     * @param {MapboxStyles.selectedObject|Array.<MapboxStyles.selectedObject>} addSelectedObjects - éæ©çè¦ç´ æè¦ç´ æ°ç»ã
     */
    setSelectedObjects(selectedObjects) {
        if (!Array.isArray(selectedObjects)) {
            selectedObjects = [selectedObjects];
        }
        this.selectedObjects = [];
        this.selectedObjects = selectedObjects;
    }
    /**
     * @function MapboxStyles.prototype.addSelectedObjects
     * @version 10.0.0
     * @description å¢å éä¸­çè¦ç´ æè¦ç´ æ°ç»ï¼è¯¥è¦ç´ å°ä¼ç¨ `selectedStyle` æ ·å¼ç»å¶ãè°ç¨è¯¥æ¹æ³åéè¦è°ç¨ {@link ol.layer.VectorTile} ç `changed` æè½çæã
     * @param {MapboxStyles.selectedObject|Array.<MapboxStyles.selectedObject>} addSelectedObjects - éæ©çè¦ç´ æè¦ç´ æ°ç»ã
     */
    addSelectedObjects(selectedObjects) {
        if (!Array.isArray(selectedObjects)) {
            selectedObjects = [selectedObjects];
        }
        this.selectedObjects.push(...selectedObjects);
    }
    /**
     * @function MapboxStyles.prototype.removeSelectedObjects
     * @version 10.0.0
     * @description æ¸ç©ºéä¸­ç¶æãè°ç¨è¯¥æ¹æ³åéè¦è°ç¨ {@link ol.layer.VectorTile} ç `changed` æè½çæã
     */
    removeSelectedObjects(selectedObjects) {
        if (!Array.isArray(selectedObjects)) {
            selectedObjects = [selectedObjects];
        }
        selectedObjects.forEach(element => {
            lodash_remove_default()(this.selectedObjects, obj => {
                return element.id === obj.id && element.sourceLayer === obj.sourceLayer;
            });
        });
    }
    /**
     * @function MapboxStyles.prototype.clearSelectedObjects
     * @version 10.0.0
     * @description æ¸ç©ºéä¸­ç¶æãè°ç¨è¯¥æ¹æ³åéè¦è°ç¨ {@link ol.layer.VectorTile} ç `changed`,æè½çæã
     */
    clearSelectedObjects() {
        this.selectedObjects = [];
    }
    /**
     * @function MapboxStyles.prototype.updateStyles
     * @description æ´æ°å¾å±æ ·å¼ã
     * @param {Object} layerStyles - å¾å±æ ·å¼æå¾å±æ ·å¼æ°ç»ã
     */
    updateStyles(layerStyles) {
        if (Object.prototype.toString.call(layerStyles) !== '[object Array]') {
            layerStyles = [layerStyles];
        }
        const layerObj = {};
        layerStyles.forEach(layerStyle => {
            layerObj[layerStyle.id] = layerStyle;
        });
        let count = 0;
        for (const key in this._mbStyle.layers) {
            const oldLayerStyle = this._mbStyle.layers[key];
            if (count >= layerStyles.length) {
                break;
            }
            if (!layerObj[oldLayerStyle.id]) {
                continue;
            }
            const newLayerStyle = JSON.parse(JSON.stringify(layerObj[oldLayerStyle.id]));
            if (newLayerStyle.paint) {
                newLayerStyle.paint = Object.assign({}, oldLayerStyle.paint, newLayerStyle.paint);
            }
            if (newLayerStyle.layout) {
                newLayerStyle.layout = Object.assign({}, oldLayerStyle.layout, newLayerStyle.layout);
            }
            Object.assign(oldLayerStyle, newLayerStyle);
            count++;
        }
        this._createStyleFunction();
    }
    /**
     * @function MapboxStyles.prototype.setStyle
     * @version 9.1.1
     * @description è®¾ç½® Mapbox style å¯¹è±¡ã
     * @param {Object} style - Mapbox style å¯¹è±¡ã
     */
    setStyle(style) {
        this.layersBySourceLayer = {};
        this._loadStyle(style);
    }
    _loadStyle(style) {
        if (Object.prototype.toString.call(style) == '[object Object]') {
            this._mbStyle = style;
            this._resolve();
        } else {
            var url = SecurityManager.appendCredential(style);
            FetchRequest.get(url, null, { withCredentials: this.withCredentials })
                .then(response => response.json())
                .then(mbStyle => {
                    this._mbStyle = mbStyle;
                    this._resolve();
                });
        }
    }
    _resolve() {
        if (!this.source) {
            this.source = Object.keys(this._mbStyle.sources)[0];
        }
        if (this._mbStyle.sprite) {
            const spriteScale = window.devicePixelRatio >= 1.5 ? 0.5 : 1;
            const sizeFactor = spriteScale == 0.5 ? '@2x' : '';
            //å¼å®¹ä¸ä¸iServer ç­iServerä¿®æ¹
            this._mbStyle.sprite = this._mbStyle.sprite.replace('@2x', '');
            const spriteUrl = this._toSpriteUrl(this._mbStyle.sprite, this.path, sizeFactor + '.json');
            FetchRequest.get(SecurityManager.appendCredential(spriteUrl), null, {
                withCredentials: this.withCredentials
            })
                .then(response => response.json())
                .then(spritesJson => {
                    this._spriteData = spritesJson;
                    this._spriteImageUrl = SecurityManager.appendCredential(
                        this._toSpriteUrl(this._mbStyle.sprite, this.path, sizeFactor + '.png')
                    );
                    this._spriteImage = null;
                    const img = new Image();
                    img.crossOrigin = this.withCredentials ? 'use-credentials' : 'anonymous';
                    img.onload = () => {
                        this._spriteImage = img;
                        this._initStyleFunction();
                    };
                    img.onerror = () => {
                        this._spriteImage = null;
                        this._initStyleFunction();
                    };
                    img.src = this._spriteImageUrl;
                });
        } else {
            this._initStyleFunction();
        }
    }
    _initStyleFunction() {
        if (!this.resolutions && this._mbStyle.metadata && this._mbStyle.metadata.indexbounds) {
            const indexbounds = this._mbStyle.metadata.indexbounds;
            var max = Math.max(indexbounds[2] - indexbounds[0], indexbounds[3] - indexbounds[1]);
            const defaultResolutions = [];
            for (let index = 0; index < 30; index++) {
                defaultResolutions.push(max / 512 / Math.pow(2, index));
            }
            this.resolutions = defaultResolutions;
        }
        this._createStyleFunction();
        /**
         * @event MapboxStyles#styleloaded
         * @description æ ·å¼å è½½æååè§¦åã
         */
        this.dispatchEvent('styleloaded');
    }
    _createStyleFunction() {
        if (this.map) {
            window.olms.applyBackground(this.map, this._mbStyle);
        }
        this.featureStyleFuntion = this._getStyleFunction();
    }
    _getStyleFunction() {
        this.fun = window.olms.stylefunction(
            { setStyle: function() {}, set: function() {}, changed: function() {} },
            this._mbStyle,
            this.source,
            this.resolutions,
            this._spriteData,
            '',
            this._spriteImage
        );
        return (feature, resolution) => {
            const style = this.fun(feature, resolution);
            if (
                this.selectedObjects.length > 0 &&
                this.selectedObjects.find(element => {
                    return element.id === feature.getId() && element.sourceLayer === feature.get('layer');
                })
            ) {
                const styleIndex = style && style[0] ? style[0].getZIndex() : 99999;
                let selectStyles = this.selectedStyle(feature, resolution);
                if (!Array.isArray(selectStyles)) {
                    selectStyles = [selectStyles];
                }
                for (let index = 0; index < selectStyles.length; index++) {
                    const selectStyle = selectStyles[index];
                    if (feature.getGeometry().getType() === 'Point' && style[0].getText() && selectStyle.getText()) {
                        selectStyle.setFill(null);
                        selectStyle.setStroke(null);
                        selectStyle.setImage();
                        selectStyle.getText().setText(style[0].getText().getText());
                    }
                    selectStyle.setZIndex(styleIndex);
                }
                return selectStyles;
            }
            return style;
        };
    }
    _withPath(url, path) {
        if (path && url.indexOf('http') != 0) {
            url = path + url;
        }
        return url;
    }

    _toSpriteUrl(url, path, extension) {
        url = this._withPath(url, path);
        const parts = url.match(this.spriteRegEx);
        return parts ? parts[1] + extension + (parts.length > 2 ? parts[2] : '') : url + extension;
    }
}

;// CONCATENATED MODULE: ./src/openlayers/overlay/vectortile/index.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





;// CONCATENATED MODULE: ./src/openlayers/overlay/index.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/















;// CONCATENATED MODULE: ./src/openlayers/services/AddressMatchService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class AddressMatchService
 * @category  iServer AddressMatch
 * @classdesc å°åå¹éæå¡ã
 * @example
 *      new AddressMatchService(url,options)
 *      .code(function(result){
 *          //doSomething
 *      })
 * @param {string} url - æå¡å°åã
 * @param {Object} options - åæ°ã
 * @param {string} [options.proxy] - æå¡ä»£çå°åã
 * @param {boolean} [options.withCredentials=false] - è¯·æ±æ¯å¦æºå¸¦ cookieã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @extends {ServiceBase}
 * @usage
 */
class AddressMatchService extends ServiceBase {

    constructor(url, options) {
        super(url, options);
    }

    /**
     * @function AddressMatchService.prototype.code
     * @description è·åæ­£åå°åå¹éç»æã
     * @param {GeoCodingParameter} params - æ­£åå¹éåæ°ã
     * @param {RequestCallback} callback åè°å½æ°ã
     */
    code(params, callback) {
        var me = this;
        var addressMatchService = new AddressMatchService_AddressMatchService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            }
        });
        addressMatchService.code(Util.urlPathAppend(me.url, 'geocoding'), params);
    }

    /**
     * @function AddressMatchService.prototype.decode
     * @description è·åååå°åå¹éç»æã
     * @param {GeoDecodingParameter} params - ååå¹éåæ°ã
     * @param {RequestCallback} callback åè°å½æ°ã
     */
    decode(params, callback) {
        var me = this;
        var addressMatchService = new AddressMatchService_AddressMatchService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            }
        });
        addressMatchService.decode(Util.urlPathAppend(me.url, 'geodecoding'), params);
    }

}

;// CONCATENATED MODULE: ./src/openlayers/services/ChartService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/








/**
 * @class ChartService
 * @category  iServer Map Chart
 * @classdesc æµ·å¾æå¡ã
 * @extends {ServiceBase}
 * @example
 *      new ChartService(url).queryChart(param,function(result){
 *          //doSomething
 *      })
 * @param {string} url - æå¡å°åã
 * @param {Object} options - åæ°ã
 * @param {string} [options.proxy] - æå¡ä»£çå°åã
 * @param {boolean} [options.withCredentials=false] - è¯·æ±æ¯å¦æºå¸¦ cookieã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class ChartService extends ServiceBase {

    constructor(url, options) {
        super(url, options);
    }

    /**
     * @function ChartService.prototype.queryChart
     * @description æ¥è¯¢æµ·å¾æå¡ã
     * @param {ChartQueryParameters} params - æµ·å¾æ¥è¯¢æéåæ°ç±»ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     * @param {DataFormat} resultFormat - è¿åç»æç±»åã
     */
    queryChart(params, callback, resultFormat) {
        var me = this,
            param = me._processParams(params),
            format = me._processFormat(resultFormat);
        var chartQueryService = new ChartQueryService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            },
            format: format
        });

        chartQueryService.processAsync(param);
    }

    /**
     * @function ChartService.prototype.getChartFeatureInfo
     * @description è·åæµ·å¾ç©æ ä¿¡æ¯æå¡ã
     * @param {RequestCallback} callback åè°å½æ°ã
     */
    getChartFeatureInfo(callback) {
        var me = this;
        var url = Util.urlPathAppend(me.url, 'chartFeatureInfoSpecs');
        var chartFeatureInfoSpecsService = new ChartFeatureInfoSpecsService(url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            }
        });
        chartFeatureInfoSpecsService.processAsync();
    }

    _processParams(params) {
        if (!params) {
            return {};
        }
        params.returnContent = (params.returnContent == null) ? true : params.returnContent;
        if (params.filter) {
            params.chartQueryFilterParameters = core_Util_Util.isArray(params.filter) ? params.filter : [params.filter];
        }
        if (params.bounds) {
            params.bounds = new Bounds(
                params.bounds[0],
                params.bounds[1],
                params.bounds[2],
                params.bounds[3]
            );
        }
    }

    _processFormat(resultFormat) {
        return (resultFormat) ? resultFormat : DataFormat.GEOJSON;
    }
}

;// CONCATENATED MODULE: ./src/openlayers/services/FieldService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class FieldService
 * @category  iServer Data Field
 * @classdesc å­æ®µæå¡ç±»ã
 * @example
 *      new FieldService(url).getFields(function(result){
 *           //doSomething
 *      });
 * @param {string} url - æå¡å°åã
 * @param {Object} options - åæ°ã
 * @param {string} [options.proxy] - æå¡ä»£çå°åã
 * @param {boolean} [options.withCredentials=false] - è¯·æ±æ¯å¦æºå¸¦ cookieã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @extends {ServiceBase}
 * @usage
 */
class FieldService extends ServiceBase {

    constructor(url, options) {
        super(url, options);
    }

    /**
     * @function FieldService.prototype.getFields
     * @description å­æ®µæ¥è¯¢æå¡ã
     * @param {FieldParameters} params - å­æ®µä¿¡æ¯æ¥è¯¢åæ°ç±»ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     */
    getFields(params, callback) {
        var me = this;
        var getFieldsService = new GetFieldsService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,
            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            },
            datasource: params.datasource,
            dataset: params.dataset
        });
        getFieldsService.processAsync();
    }

    /**
     * @function FieldService.prototype.getFieldStatisticsInfo
     * @description å­æ®µç»è®¡æå¡ã
     * @param {FieldStatisticsParameters} params - å­æ®µç»è®¡ä¿¡æ¯æ¥è¯¢åæ°ç±»ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     */
    getFieldStatisticsInfo(params, callback) {
        var me = this,
            fieldName = params.fieldName,
            modes = params.statisticMode;
        if (modes && !core_Util_Util.isArray(modes)) {
            modes = [modes];
        }
        me.currentStatisticResult = {fieldName: fieldName};
        me._statisticsCallback = callback;
        //éå¯¹æ¯ç§ç»è®¡æ¹å¼åå«è¿è¡è¯·æ±
        modes.forEach(mode => {
            me.currentStatisticResult[mode] = null;
            me._fieldStatisticRequest(params.datasource, params.dataset, fieldName, mode);
        })
    }

    _fieldStatisticRequest(datasource, dataset, fieldName, statisticMode) {
        var me = this;
        var statisticService = new FieldStatisticService(me.url, {
            eventListeners: {
                scope: me,
                processCompleted: me._processCompleted,
                processFailed: me._statisticsCallback
            },
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,
            datasource: datasource,
            dataset: dataset,
            field: fieldName,
            statisticMode: statisticMode
        });
        statisticService.processAsync();
    }

    _processCompleted(fieldStatisticResult) {
        var me = this;
        var getAll = true,
            result = fieldStatisticResult.result;
        if (this.currentStatisticResult) {
            if (null == me.currentStatisticResult[result.mode]) {
                this.currentStatisticResult[result.mode] = result.result;
            }
        }
        for (var mode in me.currentStatisticResult) {
            if (null == me.currentStatisticResult[mode]) {
                getAll = false;
                break;
            }
        }
        if (getAll) {
            me._statisticsCallback({result: me.currentStatisticResult});
        }
    }
}

;// CONCATENATED MODULE: ./src/openlayers/services/DatasetService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/






/**
 * @class DatasetService
 * @category  iServer Data Dataset
 * @classdesc æ°æ®éæå¡ç±»ã
 * @param {string} url - æå¡å°åã
 * @param {Object} options - åæ°ã
 * @param {string} [options.proxy] - æå¡ä»£çå°åã
 * @param {boolean} [options.withCredentials=false] - è¯·æ±æ¯å¦æºå¸¦ cookieã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @extends {ServiceBase}
 * @usage
 */
class DatasetService extends ServiceBase {

    constructor(url, options) {
        super(url, options);
    }

    /**
     * @function DatasetService.prototype.getDatasets
     * @description æ°æ®éæ¥è¯¢æå¡ã
     * @param {string} datasourceName - æ°æ®æºåç§°ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     */
    getDatasets(datasourceName, callback) {
        if (!datasourceName) {
            return;
        }
        const me = this;
        const datasetService = new DatasetService_DatasetService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            }
        });
        datasetService.getDatasetsService(datasourceName);
    }

    /**
     * @function DatasetService.prototype.getDataset
     * @description æ°æ®éæ¥è¯¢æå¡ã
     * @param {string} datasourceName - æ°æ®æºåç§°ã
     * @param {string} datasetName - æ°æ®éåç§°ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     */
    getDataset(datasourceName, datasetName, callback) {
        if (!datasourceName || !datasetName) {
            return;
        }
        const me = this;
        const datasetService = new DatasetService_DatasetService(me.url, {
            proxy: me.proxy,
            withCredentials: me.withCredentials,
            crossOrigin: me.crossOrigin,
            headers: me.headers,
            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            }
        });
        datasetService.getDatasetService(datasourceName, datasetName);
    }

    /**
     * @function DatasetService.prototype.setDataset
     * @description æ°æ®éä¿¡æ¯è®¾ç½®æå¡ãå¯å®ç°ä¿®æ¹å·²å­å¨æ°æ®éï¼æ°å¢ä¸å­å¨æ°æ®éã
     * @param {CreateDatasetParameters | UpdateDatasetParameters } params - æ°æ®éåå»ºåæ°ç±»ææ°æ®éä¿¡æ¯æ´æ¹åæ°ç±»ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     */
    setDataset(params, callback) {
        if(!(params instanceof CreateDatasetParameters) && !(params instanceof UpdateDatasetParameters)){
            return;
        }else if (params instanceof CreateDatasetParameters) {
            var datasetParams = {
                "datasetType": params.datasetType,
                "datasetName": params.datasetName
            }
        }else if(params instanceof UpdateDatasetParameters){
             datasetParams = {
                    "datasetName": params.datasetName,
                    "isFileCache": params.isFileCache,
                    "description": params.description,
                    "prjCoordSys": params.prjCoordSys,
                    "charset": params.charset
                }
        }
        const me = this;
        const url = Util.urlPathAppend(me.url, `datasources/name/${params.datasourceName}/datasets/name/${params.datasetName}`);
        const datasetService = new DatasetService_DatasetService(url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                processCompleted: callback,
                processFailed: callback
            }
        });
        datasetService.setDatasetService(datasetParams);
    }

    /**
     * @function DatasetService.prototype.deleteDataset
     * @description æå®æ°æ®æºä¸çæ°æ®éå é¤æå¡ã
     * @param {string} datasourceName - æ°æ®æºåç§°ã
     * @param {string} datasetName - æ°æ®éåç§°ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     */
    deleteDataset(datasourceName, datasetName, callback) {
        const me = this;
        const url = Util.urlPathAppend(me.url, `datasources/name/${datasourceName}/datasets/name/${datasetName}`);
        const datasetService = new DatasetService_DatasetService(url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                processCompleted: callback,
                processFailed: callback
            }
        });
        datasetService.deleteDatasetService();
    }
}

;// CONCATENATED MODULE: ./src/openlayers/services/DatasourceService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class DatasourceService
 * @category  iServer Data Datasource
 * @classdesc æ°æ®æºæå¡ç±»ã
 * @param {string} url - æå¡å°åã
 * @param {Object} options - åæ°ã
 * @param {string} [options.proxy] - æå¡ä»£çå°åã
 * @param {boolean} [options.withCredentials=false] - è¯·æ±æ¯å¦æºå¸¦ cookieã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @extends {ServiceBase}
 * @usage
 */
class DatasourceService extends ServiceBase {

    constructor(url, options) {
        super(url, options);
    }

    /**
     * @function DatasourceService.prototype.getDatasources
     * @description æ°æ®æºéæ¥è¯¢æå¡ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     */
    getDatasources(callback) {
        const me = this;
        const datasourceService = new DatasourceService_DatasourceService(me.url, {
            proxy: me.proxy,
            withCredentials: me.withCredentials,
            crossOrigin: me.crossOrigin,
            headers: me.headers,
            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            }
        });
        datasourceService.getDatasourcesService();
    }

    /**
     * @function DatasourceService.prototype.getDatasource
     * @description æ°æ®æºä¿¡æ¯æ¥è¯¢æå¡ã
     * @param {string} datasourceName - æ°æ®æºåç§°ã
     * @param {RequestCallback} callback åè°å½æ°ã
     */
    getDatasource(datasourceName, callback) {
        if (!datasourceName) {
            return;
        }
        const me = this;
        const datasourceService = new DatasourceService_DatasourceService(me.url, {
            proxy: me.proxy,
            withCredentials: me.withCredentials,
            crossOrigin: me.crossOrigin,
            headers: me.headers,
            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            }
        });
        datasourceService.getDatasourceService(datasourceName);
    }

   /**
     * @function DatasourceService.prototype.setDatasource
     * @description æ°æ®æºä¿¡æ¯è®¾ç½®æå¡ãå¯å®ç°æ´æ¹å½åæ°æ®æºä¿¡æ¯ã
     * @param {SetDatasourceParameters} params - æ°æ®æºä¿¡æ¯è®¾ç½®åæ°ç±»ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     */
    setDatasource(params, callback) {
        if (!(params instanceof SetDatasourceParameters)) {
            return;
        }
        const datasourceParams = {
            description: params.description ,
            coordUnit: params.coordUnit,
            distanceUnit: params.distanceUnit
        };
        const me = this;
        const url = Util.urlPathAppend(me.url,`datasources/name/${params.datasourceName}`);
        const datasourceService = new DatasourceService_DatasourceService(url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                processCompleted: callback,
                processFailed: callback
            }
        });
        datasourceService.setDatasourceService(datasourceParams);
    }
}

;// CONCATENATED MODULE: ./src/openlayers/services/GridCellInfosService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
/**
 * @class GridCellInfosService
 * @category  iServer Data Grid
 * @classdesc æ°æ®æ æ ¼æ¥è¯¢æå¡ã
 * @extends {ServiceBase}
 * @example
 *      new GridCellInfosService(url)
 *      .getGridCellInfos(param,function(result){
 *           //doSomething
 *      })
 * @param {string} url - æå¡å°åãè¯·æ±å°å¾æå¡ï¼URL åºä¸ºï¼
 *                       http://{æå¡å¨å°å}:{æå¡ç«¯å£å·}/iserver/services/{å°å¾æå¡å}/rest/maps/{å°å¾å}/tempLayersSet/{tempLayerID}/Rivers@World@@World"ã
 * @param {Object} options - åæ°ã
 * @param {string} [options.proxy] - æå¡ä»£çå°åã
 * @param {boolean} [options.withCredentials=false] - è¯·æ±æ¯å¦æºå¸¦ cookieã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class GridCellInfosService extends ServiceBase {

    constructor(url, options) {
        super(url, options);
    }

    /**
     * @function GridCellInfosService.prototype.getGridCellInfos
     * @param {GetGridCellInfosParameters} params - æ°æ®æå¡æ æ ¼æ¥è¯¢åæ°ç±»ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     */
    getGridCellInfos(params, callback) {
        if (!params) {
            return null;
        }
        var me = this;
        var gridCellQueryService = new GetGridCellInfosService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,
            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            }
        });
        gridCellQueryService.processAsync(params);
    }
}

;// CONCATENATED MODULE: ./src/openlayers/services/GeoprocessingService.js



/**
 * @class GeoprocessingService
 * @classdesc å¤çèªå¨åæå¡æ¥å£ç±»ã
 * @version 10.1.0
 * @category  iServer ProcessingAutomationService
 * @extends  {ServiceBase}
 * @example
 *  //ä¸ºäºå®å¨è®¿é®åä¿æ¤çå¤çèªå¨åæå¡ï¼å¿é¡»éè¿ä¼ éiserverä»¤ç(token)ï¼æè½æ­£ç¡®è®¿é®ç¸å³èµæºã
 * SecurityManager.registerToken(serviceUrl, token);
 * var geoprocessingService = new geoprocessingService("http://localhost:8090/iserver/services/geoprocessing/restjsr/gp/v2")
   geoprocessingService.submitJob(identifier,params, environments, function(serverResult) {
     console.log(serverResult.result);
     var jobID = serverResult.result.jobID;
     var options = {
       interval: 5000,
       statusCallback: function(state) {
         console.log("Job Status: ", state);
       }
     };
     geoprocessingService.waitForJobCompletion(jobID, identifier, options, function(serverResult) {
       console.log(serverResult);
     });
   })
 * @param {string} url - æå¡å°åã
 * @param {Object} options - åæ°ã
 * @usage
 */
class GeoprocessingService extends ServiceBase {
    constructor(url, options) {
        super(url, options);
        this.headers = true;
        this.crossOrigin = true;
        this.withCredentials = true;
        this.proxy = true;
    }

    /**
     * @function GeoprocessingService.prototype.getTools
     * @description è·åå¤çèªå¨åå·¥å·åè¡¨ã
     * @param {RequestCallback} callback åè°å½æ°ã
     */
    getTools(callback) {
        const geoprocessingJobsService = new GeoprocessingService_GeoprocessingService(this.url, {
            proxy: this.options.proxy,
            withCredentials: this.options.withCredentials,
            crossOrigin: this.options.crossOrigin,
            headers: this.options.headers,

            eventListeners: {
                scope: this,
                processCompleted: callback,
                processFailed: callback
            }
        });
        geoprocessingJobsService.getTools();
    }

    /**
     * @function GeoprocessingService.prototype.getTool
     * @description è·åå¤çèªå¨åå·¥å·çIDãåç§°ãæè¿°ãè¾å¥åæ°ãç¯å¢åæ°åè¾åºç»æç­ç¸å³åæ°ã
     * @param {string} identifier - å¤çèªå¨åå·¥å·IDã
     * @param {RequestCallback} callback åè°å½æ°ã
     */
    getTool(identifier, callback) {
        const geoprocessingJobsService = new GeoprocessingService_GeoprocessingService(this.url, {
            proxy: this.options.proxy,
            withCredentials: this.options.withCredentials,
            crossOrigin: this.options.crossOrigin,
            headers: this.options.headers,

            eventListeners: {
                scope: this,
                processCompleted: callback,
                processFailed: callback
            }
        });
        geoprocessingJobsService.getTool(identifier);
    }

    /**
     * @function GeoprocessingService.prototype.execute
     * @description åæ­¥æ§è¡å¤çèªå¨åå·¥å·ã
     * @param {string} identifier - å¤çèªå¨åå·¥å·IDã
     * @param {Object} parameter - å¤çèªå¨åå·¥å·çè¾å¥åæ°ã
     * @param {Object} environment - å¤çèªå¨åå·¥å·çç¯å¢åæ°ã
     * @param {RequestCallback} callback åè°å½æ°ã
     */
    execute(identifier, parameter, environment, callback) {
        const geoprocessingJobsService = new GeoprocessingService_GeoprocessingService(this.url, {
            proxy: this.options.proxy,
            withCredentials: this.options.withCredentials,
            crossOrigin: this.options.crossOrigin,
            headers: this.options.headers,

            eventListeners: {
                scope: this,
                processCompleted: callback,
                processFailed: callback
            }
        });
        geoprocessingJobsService.execute(identifier, parameter, environment);
    }

    /**
     * @function GeoprocessingService.prototype.submitJob
     * @description å¼æ­¥æ§è¡å¤çèªå¨åå·¥å·ã
     * @param {string} identifier - å¤çèªå¨åå·¥å·IDã
     * @param {Object} parameter - å¤çèªå¨åå·¥å·çè¾å¥åæ°ã
     * @param {Object} environment - å¤çèªå¨åå·¥å·çç¯å¢åæ°ã
     * @param {RequestCallback} callback åè°å½æ°ã
     */
    submitJob(identifier, parameter, environment, callback) {
        const geoprocessingJobsService = new GeoprocessingService_GeoprocessingService(this.url, {
            proxy: this.options.proxy,
            withCredentials: this.options.withCredentials,
            crossOrigin: this.options.crossOrigin,
            headers: this.options.headers,

            eventListeners: {
                scope: this,
                processCompleted: callback,
                processFailed: callback
            }
        });
        geoprocessingJobsService.submitJob(identifier, parameter, environment);
    }

    /**
     * @function GeoprocessingService.prototype.waitForJobCompletion
     * @description è·åå¤çèªå¨åå¼æ­¥æ§è¡ç¶æä¿¡æ¯ã
     * @param {string} jobId - å¤çèªå¨åä»»å¡IDã
     * @param {string} identifier - å¤çèªå¨åå·¥å·IDã
     * @param {Object} options - ç¶æä¿¡æ¯åæ°ã
     * @param {number} options.interval - å®æ¶å¨æ¶é´é´éã
     * @param {function} options.statusCallback - åè°å½æ°ã
     * @param {RequestCallback} callback åè°å½æ°ã
     */
    waitForJobCompletion(jobId, identifier, options, callback) {
        const geoprocessingJobsService = new GeoprocessingService_GeoprocessingService(this.url, {
            proxy: this.options.proxy,
            withCredentials: this.options.withCredentials,
            crossOrigin: this.options.crossOrigin,
            headers: this.options.headers,

            eventListeners: {
                scope: this,
                processCompleted: callback,
                processFailed: callback
            }
        });
        geoprocessingJobsService.waitForJobCompletion(jobId, identifier, options);
    }

    /**
     * @function GeoprocessingService.prototype.getJobInfo
     * @description è·åå¤çèªå¨åä»»å¡çæ§è¡ä¿¡æ¯ã
     * @param {string} identifier - å¤çèªå¨åå·¥å·IDã
     * @param {string} jobId - å¤çèªå¨åä»»å¡IDã
     * @param {RequestCallback} callback åè°å½æ°ã
     */
    getJobInfo(identifier, jobId, callback) {
        const geoprocessingJobsService = new GeoprocessingService_GeoprocessingService(this.url, {
            proxy: this.options.proxy,
            withCredentials: this.options.withCredentials,
            crossOrigin: this.options.crossOrigin,
            headers: this.options.headers,

            eventListeners: {
                scope: this,
                processCompleted: callback,
                processFailed: callback
            }
        });
        geoprocessingJobsService.getJobInfo(identifier, jobId);
    }

    /**
     * @function GeoprocessingService.prototype.cancelJob
     * @description åæ¶å¤çèªå¨åä»»å¡çå¼æ­¥æ§è¡ã
     * @param {string} identifier - å¤çèªå¨åå·¥å·IDã
     * @param {string} jobId - å¤çèªå¨åä»»å¡IDã
     * @param {RequestCallback} callback åè°å½æ°ã
     */
    cancelJob(identifier, jobId, callback) {
        const geoprocessingJobsService = new GeoprocessingService_GeoprocessingService(this.url, {
            proxy: this.options.proxy,
            withCredentials: this.options.withCredentials,
            crossOrigin: this.options.crossOrigin,
            headers: this.options.headers,

            eventListeners: {
                scope: this,
                processCompleted: callback,
                processFailed: callback
            }
        });
        geoprocessingJobsService.cancelJob(identifier, jobId);
    }

    /**
     * @function GeoprocessingService.prototype.getJobs
     * @description è·åå¤çèªå¨åæå¡ä»»å¡åè¡¨ã
     * @param {string} identifier - å¤çèªå¨åå·¥å·IDã(å¯éï¼ä¼ åä»£è¡¨identifierç®å­çä»»å¡åè¡¨ï¼ä¸ä¼ åä»£è¡¨ææä»»å¡çåè¡¨)
     * @param {RequestCallback} callback åè°å½æ°ã
     */
    getJobs(identifier, callback) {
        const geoprocessingJobsService = new GeoprocessingService_GeoprocessingService(this.url, {
            proxy: this.options.proxy,
            withCredentials: this.options.withCredentials,
            crossOrigin: this.options.crossOrigin,
            headers: this.options.headers,

            eventListeners: {
                scope: this,
                processCompleted: callback,
                processFailed: callback
            }
        });
        geoprocessingJobsService.getJobs(identifier);
    }

    /**
     * @function GeoprocessingService.prototype.getResults
     * @description å¤çèªå¨åå·¥å·å¼æ­¥æ§è¡çç»æ,æ¯æç»æè¿æ»¤ã
     * @param {string} identifier - å¤çèªå¨åå·¥å·IDã
     * @param {string} jobId - å¤çèªå¨åä»»å¡IDã
     * @param {string} filter - è¾åºå¼æ­¥ç»æçidã(å¯éï¼ä¼ å¥filteråæ°æ¶å¯¹è¯¥å¤çèªå¨åå·¥å·æ§è¡çç»æè¿è¡è¿æ»¤è·åï¼ä¸å¡«åæ¶æ¾ç¤ºææçæ§è¡ç»æ)
     * @param {RequestCallback} callback åè°å½æ°ã
     */
    getResults(identifier, jobId, filter, callback) {
        const geoprocessingJobsService = new GeoprocessingService_GeoprocessingService(this.url, {
            proxy: this.options.proxy,
            withCredentials: this.options.withCredentials,
            crossOrigin: this.options.crossOrigin,
            headers: this.options.headers,

            eventListeners: {
                scope: this,
                processCompleted: callback,
                processFailed: callback
            }
        });
        geoprocessingJobsService.getResults(identifier, jobId, filter);
    }
}

;// CONCATENATED MODULE: ./src/openlayers/services/LayerInfoService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/







/**
 * @class LayerInfoService
 * @category  iServer Map Layer
 * @classdesc å¾å±ä¿¡æ¯æå¡ç±»ã
 * @extends {ServiceBase}
 * @example
 *      new LayerInfoService(url).getLayersInfo(function(result){
 *           //doSomething
 *      })
 * @param {string} url - æå¡å°åãè¯·æ±å°å¾æå¡ï¼URL åºä¸ºï¼
 *                       http://{æå¡å¨å°å}:{æå¡ç«¯å£å·}/iserver/services/{å°å¾æå¡å}/rest/maps/{å°å¾å}/tempLayersSet/{tempLayerID}/Rivers@World@@World"ã
 * @param {Object} options - åæ°ã
 * @param {string} [options.proxy] - æå¡ä»£çå°åã
 * @param {boolean} [options.withCredentials=false] - è¯·æ±æ¯å¦æºå¸¦cookieã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class LayerInfoService extends ServiceBase {

    constructor(url, options) {
        super(url, options);
    }

    /**
     * @function LayerInfoService.prototype.getLayersInfo
     * @description è·åå¾å±ä¿¡æ¯æå¡ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     */
    getLayersInfo(callback) {
        var me = this;
        var getLayersInfoService = new GetLayersInfoService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,
            eventListeners: {
                processCompleted: callback,
                processFailed: callback
            }
        });
        getLayersInfoService.processAsync();
    }

    /**
     * @function LayerInfoService.prototype.setLayerInfo
     * @description è®¾ç½®å¾å±ä¿¡æ¯æå¡ãå¯ä»¥å®ç°ä¸´æ¶å¾å±ä¸­å­å¾å±çä¿®æ¹ã
     * @param {SetLayerInfoParameters} params - è®¾ç½®å¾å±ä¿¡æ¯åæ°ç±»ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     */
    setLayerInfo(params, callback) {
        if (!params) {
            return;
        }
        var me = this,
            resourceID = params.resourceID,
            tempLayerName = params.tempLayerName,
            layerInfoParams = params.layerInfo;
        if (!resourceID || !tempLayerName) {
            return;
        }
        var url = Util.urlPathAppend(me.url, "tempLayersSet/" + resourceID + "/" + tempLayerName);
        var setLayerInfoService = new SetLayerInfoService(url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,
            eventListeners: {
                processCompleted: callback,
                processFailed: callback
            }
        });
        setLayerInfoService.processAsync(layerInfoParams);
    }

    /**
     * @function LayerInfoService.prototype.setLayersInfo
     * @description è®¾ç½®å¾å±ä¿¡æ¯æå¡ãå¯ä»¥åå»ºæ°çä¸´æ¶å¾å±åä¿®æ¹ç°æçä¸´æ¶å¾å±ã
     * @param {SetLayersInfoParameters} params - è®¾ç½®å¾å±ä¿¡æ¯åæ°ç±»ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     */
    setLayersInfo(params, callback) {
        if (!params) {
            return;
        }
        var me = this,
            resourceID = params.resourceID,
            isTempLayers = params.isTempLayers ? params.isTempLayers : false,
            layersInfo = params.layersInfo;
        if ((isTempLayers && !resourceID) || !layersInfo) {
            return;
        }
        var setLayersInfoService = new SetLayersInfoService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,
            eventListeners: {
                processCompleted: callback,
                processFailed: callback
            },
            resourceID: resourceID,
            isTempLayers: isTempLayers
        });
        setLayersInfoService.processAsync(layersInfo);
    }

    /**
     * @function LayerInfoService.prototype.setLayerStatus
     * @description å­å¾å±æ¾ç¤ºæ§å¶æå¡ãè´è´£å°å­å¾å±æ¾ç¤ºæ§å¶åæ°ä¼ éå°æå¡ç«¯ï¼å¹¶è·åæå¡ç«¯è¿åçå¾å±æ¾ç¤ºç¶æã
     * @param {SetLayerStatusParameters} params - å­å¾å±æ¾ç¤ºæ§å¶åæ°ç±»ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     */
    setLayerStatus(params, callback) {
        if (!params) {
            return;
        }
        var me = this;
        var setLayerStatusService = new SetLayerStatusService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,
            eventListeners: {
                processCompleted: callback,
                processFailed: callback
            }
        });
        setLayerStatusService.processAsync(params);
    }
}

;// CONCATENATED MODULE: ./src/openlayers/services/MeasureService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class MeasureService
 * @category  iServer Map Measure
 * @classdesc éç®æå¡ã
 * @extends {ServiceBase}
 * @param {string} url -  æå¡å°åãå¦ï¼http://localhost:8090/iserver/services/map-world/rest/maps/World+Map ã
 * @param {Object} options -  åæ°ã
 * @param {string} [options.proxy] - æå¡ä»£çå°åã
 * @param {boolean} [options.withCredentials=false] - è¯·æ±æ¯å¦æºå¸¦ cookieã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class MeasureService extends ServiceBase {

    constructor(url, options) {
        super(url, options);
    }

    /**
     * @function MeasureService.prototype.measureDistance
     * @description æµè·ã
     * @param {MeasureParameters} params - éç®åæ°ç±»ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     */
    measureDistance(params, callback) {
        this.measure(params, 'DISTANCE', callback);
    }

    /**
     * @function MeasureService.prototype.measureArea
     * @description æµé¢ç§¯ã
     * @param {MeasureParameters} params - éç®åæ°ç±»ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     */
    measureArea(params, callback) {
        this.measure(params, 'AREA', callback);
    }

    /**
     * @function MeasureService.prototype.measure
     * @description æµéã
     * @param {MeasureParameters} params - éç®åæ°ç±»ã
     * @param {string} type - ç±»åã
     * @param {RequestCallback} callback - åè°å½æ°ã
     * @returns {MeasureService} éç®æå¡ã
     */
    measure(params, type, callback) {
        var me = this;
        var measureService = new MeasureService_MeasureService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,
            measureMode: type,
            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            }
        });
        measureService.processAsync(me._processParam(params));
    }

    _processParam(params) {
        if (params && params.geometry) {
            params.geometry = core_Util_Util.toSuperMapGeometry(JSON.parse((new (external_ol_format_GeoJSON_default())()).writeGeometry(params.geometry)));
        }
        return params;
    }
}

;// CONCATENATED MODULE: ./src/openlayers/services/NetworkAnalyst3DService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/







/**
 * @class NetworkAnalyst3DService
 * @category  iServer FacilityAnalyst3D
 * @classdesc 3D ç½ç»åææå¡ç±»ã
 * @extends {ServiceBase}
 * @example
 *      new NetworkAnalyst3DService(url).sinksFacilityAnalyst(params,function(result){
 *           //doSomething
 *      })
 * @param {string} url - ç½ç»åææå¡å°åãè¯·æ±ç½ç»åææå¡ï¼URL åºä¸ºï¼
 *                       http://{æå¡å¨å°å}:{æå¡ç«¯å£å·}/iserver/services/{ç½ç»åææå¡å}/rest/networkanalyst/{ç½ç»æ°æ®é@æ°æ®æº}ï¼
 *                       ä¾å¦:"http://localhost:8090/iserver/services/components-rest/rest/networkanalyst/RoadNet@Changchun"ã
 * @param {Object} options - åæ°ã
 * @param {string} [options.proxy] - æå¡ä»£çå°åã
 * @param {boolean} [options.withCredentials=false] - è¯·æ±æ¯å¦æºå¸¦ cookieã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class NetworkAnalyst3DService extends ServiceBase {

    constructor(url, options) {
        super(url, options);
    }

    /**
     * @function NetworkAnalyst3DService.prototype.sinksFacilityAnalyst
     * @description æ±æ¥æ¾æå¡
     * @param {FacilityAnalystSinks3DParameters} params- æè¿è®¾æ½åæåæ°ç±»ï¼æ±æ¥æ¾èµæºï¼ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     * @returns {NetworkAnalyst3DService} 3D ç½ç»åææå¡ã
     */
    sinksFacilityAnalyst(params, callback) {
        var me = this;
        var facilityAnalystSinks3DService = new FacilityAnalystSinks3DService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            }
        });
        facilityAnalystSinks3DService.processAsync(params);
    }

    /**
     * @function NetworkAnalyst3DService.prototype.sourcesFacilityAnalyst
     * @description æºæ¥æ¾æå¡ã
     * @param {FacilityAnalystSources3DParameters} params - æè¿è®¾æ½åæåæ°ç±»ï¼æºæ¥æ¾æå¡ï¼ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     * @returns {NetworkAnalyst3DService} 3D ç½ç»åææå¡ã
     */
    sourcesFacilityAnalyst(params, callback) {
        var me = this;
        var facilityAnalystSources3DService = new FacilityAnalystSources3DService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            }
        });
        facilityAnalystSources3DService.processAsync(params);
    }

    /**
     * @function NetworkAnalyst3DService.prototype.traceUpFacilityAnalyst
     * @description ä¸æ¸¸è¿½è¸ªèµæºæå¡ã
     * @param {FacilityAnalystTraceup3DParameters} params - ä¸æ¸¸è¿½è¸ªèµæºåæ°ç±»ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     * @returns {NetworkAnalyst3DService} 3D ç½ç»åææå¡ã
     */

    traceUpFacilityAnalyst(params, callback) {
        var me = this;
        var facilityAnalystTraceup3DService = new FacilityAnalystTraceup3DService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            }
        });
        facilityAnalystTraceup3DService.processAsync(params);
    }

    /**
     * @function NetworkAnalyst3DService.prototype.traceDownFacilityAnalyst
     * @description ä¸æ¸¸è¿½è¸ªèµæºæå¡ã
     * @param {FacilityAnalystTracedown3DParameters} params - ä¸æ¸¸è¿½è¸ªèµæºæå¡åæ°ç±»ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     * @returns {NetworkAnalyst3DService} 3D ç½ç»åææå¡ã
     */
    traceDownFacilityAnalyst(params, callback) {
        var me = this;
        var facilityAnalystTracedown3DService = new FacilityAnalystTracedown3DService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            }
        });
        facilityAnalystTracedown3DService.processAsync(params);
    }

    /**
     * @function NetworkAnalyst3DService.prototype.upstreamFacilityAnalyst
     * @description ä¸æ¸¸å³é®è®¾æ½æ¥æ¾æå¡ã
     * @param {FacilityAnalystUpstream3DParameters} params - ä¸æ¸¸å³é®è®¾æ½æ¥æ¾æå¡åæ°ç±»ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     * @returns {NetworkAnalyst3DService} 3D ç½ç»åææå¡ã
     */
    upstreamFacilityAnalyst(params, callback) {
        var me = this;
        var facilityAnalystUpstream3DService = new FacilityAnalystUpstream3DService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            }
        });
        facilityAnalystUpstream3DService.processAsync(params);
    }
}

;// CONCATENATED MODULE: ./src/openlayers/services/NetworkAnalystService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/
















/**
 * @class NetworkAnalystService
 * @category  iServer NetworkAnalyst
 * @classdesc ç½ç»åææå¡ç±»ã
 * @extends {ServiceBase}
 * @example
 *      new NetworkAnalystService(url).findPath(params,function(result){
 *           //doSomething
 *      })
 * @param {string} url - ç½ç»åææå¡å°åãè¯·æ±ç½ç»åææå¡ï¼URL åºä¸º:
 *                       http://{æå¡å¨å°å}:{æå¡ç«¯å£å·}/iserver/services/{ç½ç»åææå¡å}/rest/networkanalyst/{ç½ç»æ°æ®é@æ°æ®æº}ï¼<br>
 *                       ä¾å¦: "http://localhost:8090/iserver/services/test/rest/networkanalyst/WaterNet@FacilityNet"ã
 * @param {Object} options - åæ°ã
 * @param {string} [options.proxy] - æå¡ä»£çå°åã
 * @param {boolean} [options.withCredentials=false] - è¯·æ±æ¯å¦æºå¸¦ cookieã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class NetworkAnalystService extends ServiceBase {

    constructor(url, options) {
        super(url, options);
    }

    /**
     * @function NetworkAnalystService.prototype.burstPipelineAnalyst
     * @description çç®¡åææå¡ï¼å³å°ç»å®å¼§æ®µæèç¹ä½ä¸ºçç®¡ç¹æ¥è¿è¡åæï¼è¿åå³é®ç»ç¹ ID æ°ç»ï¼æ®éç»ç¹ ID æ°ç»åå¶ä¸ä¸æ¸¸å¼§æ®µ ID æ°ç»ã
     * @param {BurstPipelineAnalystParameters} params - çç®¡åææå¡åæ°ç±»ã
     * @param {RequestCallback} callback åè°å½æ°ã
     */
    burstPipelineAnalyst(params, callback) {
        var me = this;
        var burstPipelineAnalystService = new BurstPipelineAnalystService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            }
        });
        burstPipelineAnalystService.processAsync(me._processParams(params));
    }

    /**
     * @function NetworkAnalystService.prototype.computeWeightMatrix
     * @description èè´¹ç©éµåææå¡ï¼æ ¹æ®äº¤éç½ç»åæåæ°ä¸­çèè´¹å­æ®µè¿åä¸ä¸ªèè´¹ç©éµãè¯¥ç©éµæ¯ä¸ä¸ªäºç»´æ°ç»ï¼ç¨æ¥å­å¨ä»»æä¸¤ç¹é´çèµæºæ¶èã
     * @param {ComputeWeightMatrixParameters} params - èè´¹ç©éµåææå¡åæ°ç±»ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     */
    computeWeightMatrix(params, callback) {
        var me = this;
        var computeWeightMatrixService = new ComputeWeightMatrixService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            }
        });
        computeWeightMatrixService.processAsync(me._processParams(params));
    }

    /**
     * @function NetworkAnalystService.prototype.findClosestFacilities
     * @description æè¿è®¾æ½åææå¡ï¼æå¨ç½ç»ä¸ç»å®ä¸ä¸ªäºä»¶ç¹åä¸ç»è®¾æ½ç¹ï¼æ¥æ¾ä»äºä»¶ç¹å°è®¾æ½ç¹(æä»è®¾æ½ç¹å°äºä»¶ç¹)ä»¥æå°èè´¹è½å°è¾¾çæä½³è·¯å¾ã
     * @param {FindClosestFacilitiesParameters} params - æè¿è®¾æ½åææå¡åæ°ç±»ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åçç»æç±»åã
     */
    findClosestFacilities(params, callback, resultFormat) {
        var me = this;
        var findClosestFacilitiesService = new FindClosestFacilitiesService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            },
            format: me._processFormat(resultFormat)
        });
        findClosestFacilitiesService.processAsync(me._processParams(params));
    }

    /**
     * @function NetworkAnalystService.prototype.streamFacilityAnalyst
     * @description ä¸æ¸¸/ä¸æ¸¸ å³é®è®¾æ½æ¥æ¾èµæºæå¡:æ¥æ¾ç»å®å¼§æ®µæèç¹çä¸æ¸¸/ä¸æ¸¸ä¸­çå³é®è®¾æ½ç»ç¹ï¼è¿åå³é®ç»ç¹ ID æ°ç»åå¶ä¸æ¸¸å¼§æ®µ ID æ°ç»ã
     * @param {FacilityAnalystStreamParameters} params - ä¸æ¸¸/ä¸æ¸¸ å³é®è®¾æ½æ¥æ¾èµæºæå¡åæ°ç±»ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åçç»æç±»åã
     */
    streamFacilityAnalyst(params, callback, resultFormat) {
        var me = this;
        var facilityAnalystStreamService = new FacilityAnalystStreamService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            },
            format: me._processFormat(resultFormat)
        });
        facilityAnalystStreamService.processAsync(me._processParams(params));
    }

    /**
     * @function NetworkAnalystService.prototype.findLocation
     * @description éåååºåææå¡ï¼ç¡®å®ä¸ä¸ªæå¤ä¸ªå¾å»ºè®¾æ½çæä½³ææä¼ä½ç½®ã
     * @param {FindLocationParameters} params - éåååºåææå¡åæ°ç±»ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åçç»æç±»åã
     */
    findLocation(params, callback, resultFormat) {
        var me = this;
        var findLocationService = new FindLocationService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            },
            format: me._processFormat(resultFormat)
        });
        findLocationService.processAsync(me._processParams(params));
    }

    /**
     * @function NetworkAnalystService.prototype.findPath
     * @description æä½³è·¯å¾åææå¡ï¼å¨ç½ç»æ°æ®éä¸­æå®ä¸äºèç¹ï¼æç§èç¹çéæ©é¡ºåºï¼é¡ºåºè®¿é®è¿äºèç¹ä»èæ±è§£èµ·æ­¢ç¹ä¹é´é»ææå°çè·¯ç»ã
     * @param {FindPathParameters} params - æä½³è·¯å¾åææå¡åæ°ç±»ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åçç»æç±»åã
     */
    findPath(params, callback, resultFormat) {
        var me = this;
        var findPathService = new FindPathService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            },
            format: me._processFormat(resultFormat)
        });
        findPathService.processAsync(me._processParams(params));
    }

    /**
     * @function NetworkAnalystService.prototype.findTSPPaths
     * @description æè¡ååææå¡ï¼è·¯å¾åæçä¸ç§ï¼å®ä»èµ·ç¹å¼å§ï¼é»è®¤ä¸ºç¨æ·æå®çç¬¬ä¸ç¹ï¼æ¥æ¾è½å¤éåææéç»ç¹ä¸è±è´¹æå°çè·¯å¾ã
     * @param {FindTSPPathsParameters} params - æè¡ååææå¡åæ°ç±»ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åçç»æç±»åã
     */
    findTSPPaths(params, callback, resultFormat) {
        var me = this;
        var findTSPPathsService = new FindTSPPathsService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            },
            format: me._processFormat(resultFormat)
        });
        findTSPPathsService.processAsync(me._processParams(params));
    }

    /**
     * @function NetworkAnalystService.prototype.findMTSPPaths
     * @description å¤æè¡ååææå¡ï¼ä¹ç§°ä¸ºç©æµééï¼æ¯æå¨ç½ç»æ°æ®éä¸­ï¼ç»å® M ä¸ªééä¸­å¿ç¹å N ä¸ªééç®çå°ï¼Mï¼N ä¸ºå¤§äºé¶çæ´æ°ï¼ãæ¥æ¾ç»æµææçééè·¯å¾ï¼å¹¶ç»åºç¸åºçè¡èµ°è·¯çº¿ã
     * @param {FindMTSPPathsParameters} params - å¤æè¡ååææå¡åæ°ç±»ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åçç»æç±»åã
     */
    findMTSPPaths(params, callback, resultFormat) {
        var me = this;
        var findMTSPPathsService = new FindMTSPPathsService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            },
            format: me._processFormat(resultFormat)
        });
        findMTSPPathsService.processAsync(me._processParams(params));
    }

    /**
     * @function NetworkAnalystService.prototype.findServiceAreas
     * @description æå¡åºåææå¡ï¼ä»¥æå®æå¡ç«ç¹ä¸ºä¸­å¿ï¼å¨ä¸å®æå¡èå´åæ¥æ¾ç½ç»ä¸æå¡ç«ç¹è½å¤æä¾æå¡çåºåèå´ã
     * @param {FindServiceAreasParameters} params - æå¡åºåææå¡åæ°ç±»ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åçç»æç±»åã
     */
    findServiceAreas(params, callback, resultFormat) {
        var me = this;
        var findServiceAreasService = new FindServiceAreasService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            },
            format: me._processFormat(resultFormat)
        });
        findServiceAreasService.processAsync(me._processParams(params));
    }

    /**
     * @function NetworkAnalystService.prototype.updateEdgeWeight
     * @description æ´æ°è¾¹çèè´¹æéæå¡ã
     * @param {UpdateEdgeWeightParameters} params - æ´æ°è¾¹çèè´¹æéæå¡åæ°ç±»ã
     * @param {RequestCallback} callback åè°å½æ°ã
     */
    updateEdgeWeight(params, callback) {
        var me = this;
        var updateEdgeWeightService = new UpdateEdgeWeightService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            }
        });
        updateEdgeWeightService.processAsync(params);
    }

    /**
     * @function NetworkAnalystService.prototype.updateTurnNodeWeight
     * @description è½¬åèè´¹æéæ´æ°æå¡ã
     * @param {UpdateTurnNodeWeightParameters} params - è½¬åèè´¹æéæ´æ°æå¡åæ°ç±»ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     */
    updateTurnNodeWeight(params, callback) {
        var me = this;
        var updateTurnNodeWeightService = new UpdateTurnNodeWeightService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            }
        });
        updateTurnNodeWeightService.processAsync(params);
    }

    _processParams(params) {
        if (!params) {
            return {};
        }
        if (params.centers && core_Util_Util.isArray(params.centers)) {
            params.centers.map(function (point, key) {
                params.centers[key] = (point instanceof (external_ol_geom_Point_default())) ? {
                    x: point.getCoordinates()[0],
                    y: point.getCoordinates()[1]
                } : point;
                return params.centers[key];
            });
        }

        if (params.nodes && core_Util_Util.isArray(params.nodes)) {
            params.nodes.map(function (point, key) {
                params.nodes[key] = (point instanceof (external_ol_geom_Point_default())) ? {
                    x: point.getCoordinates()[0],
                    y: point.getCoordinates()[1]
                } : point;
                return params.nodes[key];
            });
        }

        if (params.event && params.event instanceof (external_ol_geom_Point_default())) {
            params.event = {x: params.event.getCoordinates()[0], y: params.event.getCoordinates()[1]};
        }

        if (params.facilities && core_Util_Util.isArray(params.facilities)) {
            params.facilities.map(function (point, key) {
                params.facilities[key] = (point instanceof (external_ol_geom_Point_default())) ? {
                    x: point.getCoordinates()[0],
                    y: point.getCoordinates()[1]
                } : point;
                return params.facilities[key];
            });
        }
        if (params.parameter && params.parameter.barrierPoints) {
            var barrierPoints = params.parameter.barrierPoints;
            if (core_Util_Util.isArray(barrierPoints)) {
                barrierPoints.map(function (point, key) {
                    params.parameter.barrierPoints[key] = (point instanceof (external_ol_geom_Point_default())) ? {
                        x: point.getCoordinates()[0],
                        y: point.getCoordinates()[1]
                    } : point;
                    return params.parameter.barrierPoints[key];
                });
            } else {
                params.parameter.barrierPoints = [(barrierPoints instanceof (external_ol_geom_Point_default())) ? {
                    x: barrierPoints.getCoordinates()[0],
                    y: barrierPoints.getCoordinates()[1]
                } : barrierPoints];
            }
        }
        return params;

    }

    _processFormat(resultFormat) {
        return (resultFormat) ? resultFormat : DataFormat.GEOJSON;
    }
}

;// CONCATENATED MODULE: ./src/openlayers/services/ProcessingService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/













/**
 * @class ProcessingService
 * @category  iServer ProcessingService
 * @classdesc åå¸å¼åæç¸å³æå¡ç±»ã
 * @extends {ServiceBase}
 * @example
 *      new ProcessingService(url,options).getKernelDensityJobs(function(result){
 *          //doSomething
 *      })
 * @param {string} url - æå¡å°åã
 * @param {Object} options - åæ°ã
 * @param {string} [options.proxy] - æå¡ä»£çå°åã
 * @param {boolean} [options.withCredentials=false] - è¯·æ±æ¯å¦æºå¸¦ cookieã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class ProcessingService extends ServiceBase {

    constructor(url, options) {
        super(url, options);
        this.kernelDensityJobs = {};
        this.summaryMeshJobs = {};
        this.queryJobs = {};
        this.summaryRegionJobs = {};
        this.vectorClipJobs = {};
        this.overlayGeoJobs = {};
        this.buffersJobs = {};
        this.topologyValidatorJobs = {};
        this.summaryAttributesJobs = {};
    }

    /**
     * @function ProcessingService.prototype.getKernelDensityJobs
     * @description è·åå¯åº¦åæçåè¡¨ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åç»æç±»åã
     */
    getKernelDensityJobs(callback, resultFormat) {
        var me = this,
            format = me._processFormat(resultFormat);
        var kernelDensityJobsService = new KernelDensityJobsService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            },
            format: format
        });
        kernelDensityJobsService.getKernelDensityJobs();
    }

    /**
     * @function ProcessingService.prototype.getKernelDensityJob
     * @description è·åå¯åº¦åæã
     * @param {string} id - ç©ºé´åæç IDã
     * @param {RequestCallback} callback - åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åç»æç±»åã
     */
    getKernelDensityJob(id, callback, resultFormat) {
        var me = this,
            format = me._processFormat(resultFormat);
        var kernelDensityJobsService = new KernelDensityJobsService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            },
            format: format
        });
        kernelDensityJobsService.getKernelDensityJob(id);
    }

    /**
     * @function ProcessingService.prototype.addKernelDensityJob
     * @description å¯åº¦åæã
     * @param {KernelDensityJobParameter} params - æ ¸å¯åº¦åææå¡åæ°ç±»ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     * @param {number} [seconds=1000] - è·ååå»ºæåç»æçæ¶é´é´éã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åç»æç±»åã
     */
    addKernelDensityJob(params, callback, seconds, resultFormat) {
        var me = this,
            param = me._processParams(params),
            format = me._processFormat(resultFormat);
        var kernelDensityJobsService = new KernelDensityJobsService(me.url, {
            proxy: me.proxy,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,
            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback,
                processRunning: function (job) {
                    me.kernelDensityJobs[job.id] = job.state;
                }
            },
            format: format
        });
        kernelDensityJobsService.addKernelDensityJob(param, seconds);
    }

    /**
     * @function ProcessingService.prototype.getKernelDensityJobState
     * @description è·åå¯åº¦åæçç¶æã
     * @param {string} id - å¯åº¦åæç IDã
     * @returns {Object} å¯åº¦åæçç¶æ
     */
    getKernelDensityJobState(id) {
        return this.kernelDensityJobs[id];
    }

    /**
     * @function ProcessingService.prototype.getSummaryMeshJobs
     * @description è·åç¹èååæçåè¡¨ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åç»æç±»åã
     */
    getSummaryMeshJobs(callback, resultFormat) {
        var me = this,
            format = me._processFormat(resultFormat);
        var summaryMeshJobsService = new SummaryMeshJobsService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            },
            format: format
        });
        summaryMeshJobsService.getSummaryMeshJobs();
    }

    /**
     * @function ProcessingService.prototype.getSummaryMeshJob
     * @description è·åç¹èååæã
     * @param {string} id - ç©ºé´åæç IDã
     * @param {RequestCallback} callback - åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åç»æç±»åã
     */
    getSummaryMeshJob(id, callback, resultFormat) {
        var me = this,
            format = me._processFormat(resultFormat);
        var summaryMeshJobsService = new SummaryMeshJobsService(me.url, {
            proxy: me.options.proxy,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,
            withCredentials: me.options.withCredentials,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            },
            format: format
        });
        summaryMeshJobsService.getSummaryMeshJob(id);
    }

    /**
     * @function ProcessingService.prototype.addSummaryMeshJob
     * @description ç¹èååæã
     * @param {SummaryMeshJobParameter} params - ç¹èååæä»»å¡åæ°ç±»ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     * @param {number} [seconds=1000] - è·ååå»ºæåç»æçæ¶é´é´éã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åç»æç±»åã
     */
    addSummaryMeshJob(params, callback, seconds, resultFormat) {
        var me = this,
            param = me._processParams(params),
            format = me._processFormat(resultFormat);
        var summaryMeshJobsService = new SummaryMeshJobsService(me.url, {
            proxy: me.proxy,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,
            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback,
                processRunning: function (job) {
                    me.summaryMeshJobs[job.id] = job.state;
                }
            },
            format: format
        });
        summaryMeshJobsService.addSummaryMeshJob(param, seconds);
    }

    /**
     * @function ProcessingService.prototype.getSummaryMeshJobState
     * @description è·åç¹èååæçç¶æã
     * @param {string} id - ç¹èååæç IDã
     * @returns {Object} ç¹èååæçç¶æ
     */
    getSummaryMeshJobState(id) {
        return this.summaryMeshJobs[id];
    }

    /**
     * @function ProcessingService.prototype.getQueryJobs
     * @description è·ååå¯¹è±¡æ¥è¯¢åæçåè¡¨ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åç»æç±»åã
     */
    getQueryJobs(callback, resultFormat) {
        var me = this,
            format = me._processFormat(resultFormat);
        var singleObjectQueryJobsService = new SingleObjectQueryJobsService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            },
            format: format
        });
        singleObjectQueryJobsService.getQueryJobs();
    }

    /**
     * @function ProcessingService.prototype.getQueryJob
     * @description è·ååå¯¹è±¡æ¥è¯¢åæã
     * @param {string} id - ç©ºé´åæç IDã
     * @param {RequestCallback} callback - åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åç»æç±»åã
     */
    getQueryJob(id, callback, resultFormat) {
        var me = this,
            format = me._processFormat(resultFormat);
        var singleObjectQueryJobsService = new SingleObjectQueryJobsService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            },
            format: format
        });
        singleObjectQueryJobsService.getQueryJob(id);
    }

    /**
     * @function ProcessingService.prototype.addQueryJob
     * @description åå¯¹è±¡æ¥è¯¢åæã
     * @param {SingleObjectQueryJobsParameter} params - åå¯¹è±¡ç©ºé´æ¥è¯¢åæä»»å¡åæ°ç±»ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     * @param {number} [seconds=1000] - è·ååå»ºæåç»æçæ¶é´é´éã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åç»æç±»åã
     */
    addQueryJob(params, callback, seconds, resultFormat) {
        var me = this,
            param = me._processParams(params),
            format = me._processFormat(resultFormat);
        var singleObjectQueryJobsService = new SingleObjectQueryJobsService(me.url, {
            proxy: me.proxy,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,
            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback,
                processRunning: function (job) {
                    me.queryJobs[job.id] = job.state;
                }
            },
            format: format
        });
        singleObjectQueryJobsService.addQueryJob(param, seconds);
    }

    /**
     * @function ProcessingService.prototype.getQueryJobState
     * @description è·ååå¯¹è±¡æ¥è¯¢åæçç¶æã
     * @param {string} id - åå¯¹è±¡æ¥è¯¢åæç IDã
     * @returns {Object} åå¯¹è±¡æ¥è¯¢åæçç¶æ
     */
    getQueryJobState(id) {
        return this.queryJobs[id];
    }

    /**
     * @function ProcessingService.prototype.getSummaryRegionJobs
     * @description è·ååºåæ±æ»åæçåè¡¨ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åç»æç±»åã
     */
    getSummaryRegionJobs(callback, resultFormat) {
        var me = this,
            format = me._processFormat(resultFormat);
        var summaryRegionJobsService = new SummaryRegionJobsService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            },
            format: format
        });
        summaryRegionJobsService.getSummaryRegionJobs();
    }

    /**
     * @function ProcessingService.prototype.getSummaryRegionJob
     * @description è·ååºåæ±æ»åæã
     * @param {string} id - åºåæ±æ»åæç IDã
     * @param {RequestCallback} callback - åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åç»æç±»åã
     */
    getSummaryRegionJob(id, callback, resultFormat) {
        var me = this,
            format = me._processFormat(resultFormat);
        var summaryRegionJobsService = new SummaryRegionJobsService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            },
            format: format
        });
        summaryRegionJobsService.getSummaryRegionJob(id);
    }

    /**
     * @function ProcessingService.prototype.addSummaryRegionJob
     * @description åºåæ±æ»åæã
     * @param {SummaryRegionJobParameter} params - åºåæ±æ»åæä»»å¡åæ°ç±»ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     * @param {number} [seconds=1000] - è·ååå»ºæåç»æçæ¶é´é´éã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åç»æç±»åã
     */
    addSummaryRegionJob(params, callback, seconds, resultFormat) {
        var me = this,
            param = me._processParams(params),
            format = me._processFormat(resultFormat);
        var summaryRegionJobsService = new SummaryRegionJobsService(me.url, {
            proxy: me.proxy,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,
            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback,
                processRunning: function (job) {
                    me.summaryRegionJobs[job.id] = job.state;
                }
            },
            format: format
        });
        summaryRegionJobsService.addSummaryRegionJob(param, seconds);
    }

    /**
     * @function ProcessingService.prototype.getSummaryRegionJobState
     * @description è·ååºåæ±æ»åæçç¶æã
     * @param {string} id - çæåºåæ±æ»åæç IDã
     * @returns {Object} åºåæ±æ»åæçç¶æã
     */
    getSummaryRegionJobState(id) {
        return this.summaryRegionJobs[id];
    }

    /**
     * @function ProcessingService.prototype.getVectorClipJobs
     * @description è·åç¢éè£åªåæçåè¡¨ã
     * @param {RequestCallback} callback åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åç»æç±»åã
     */
    getVectorClipJobs(callback, resultFormat) {
        var me = this,
            format = me._processFormat(resultFormat);
        var vectorClipJobsService = new VectorClipJobsService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            },
            format: format
        });
        vectorClipJobsService.getVectorClipJobs();
    }

    /**
     * @function ProcessingService.prototype.getVectorClipJob
     * @description è·åç¢éè£åªåæã
     * @param {string} id - ç©ºé´åæç IDã
     * @param {RequestCallback} callback åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åç»æç±»åã
     */
    getVectorClipJob(id, callback, resultFormat) {
        var me = this,
            format = me._processFormat(resultFormat);
        var vectorClipJobsService = new VectorClipJobsService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            },
            format: format
        });
        vectorClipJobsService.getVectorClipJob(id);
    }

    /**
     * @function ProcessingService.prototype.addVectorClipJob
     * @description ç¢éè£åªåæã
     * @param {VectorClipJobsParameter} params - ç¢éè£åªåæä»»å¡åæ°ç±»ã
     * @param {RequestCallback} callback åè°å½æ°ã
     * @param {number} [seconds=1000] - è·ååå»ºæåç»æçæ¶é´é´éã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åç»æç±»åã
     */
    addVectorClipJob(params, callback, seconds, resultFormat) {
        var me = this,
            param = me._processParams(params),
            format = me._processFormat(resultFormat);
        var vectorClipJobsService = new VectorClipJobsService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback,
                processRunning: function (job) {
                    me.vectorClipJobs[job.id] = job.state;
                }
            },
            format: format
        });
        vectorClipJobsService.addVectorClipJob(param, seconds);
    }

    /**
     * @function ProcessingService.prototype.getVectorClipJobState
     * @description è·åç¢éè£åªåæçç¶æã
     * @param {number} id - ç¢éè£åªåæç IDã
     * @returns {Object} ç¢éè£åªåæçç¶æ
     */
    getVectorClipJobState(id) {
        return this.vectorClipJobs[id];
    }

    /**
     * @function ProcessingService.prototype.getOverlayGeoJobs
     * @description è·åå å åæçåè¡¨ã
     * @param {RequestCallback} callback åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åç»æç±»åã
     */
    getOverlayGeoJobs(callback, resultFormat) {
        var me = this,
            format = me._processFormat(resultFormat);
        var overlayGeoJobsService = new OverlayGeoJobsService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            },
            format: format
        });
        overlayGeoJobsService.getOverlayGeoJobs();
    }

    /**
     * @function ProcessingService.prototype.getOverlayGeoJob
     * @description è·åå å åæã
     * @param {string} id - ç©ºé´åæç IDã
     * @param {RequestCallback} callback åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åç»æç±»åã
     */
    getOverlayGeoJob(id, callback, resultFormat) {
        var me = this,
            format = me._processFormat(resultFormat);
        var overlayGeoJobsService = new OverlayGeoJobsService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            },
            format: format
        });
        overlayGeoJobsService.getOverlayGeoJob(id);
    }

    /**
     * @function ProcessingService.prototype.addOverlayGeoJob
     * @description å å åæã
     * @param {OverlayGeoJobParameter} params - å å åæä»»å¡åæ°ç±»ã
     * @param {RequestCallback} callback åè°å½æ°ã
     * @param {number} [seconds=1000] - è·ååå»ºæåç»æçæ¶é´é´éã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åç»æç±»åã
     */
    addOverlayGeoJob(params, callback, seconds, resultFormat) {
        var me = this,
            param = me._processParams(params),
            format = me._processFormat(resultFormat);
        var overlayGeoJobsService = new OverlayGeoJobsService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,

            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,
            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback,
                processRunning: function (job) {
                    me.overlayGeoJobs[job.id] = job.state;
                }
            },
            format: format
        });
        overlayGeoJobsService.addOverlayGeoJob(param, seconds);
    }

    /**
     * @function ProcessingService.prototype.getoverlayGeoJobState
     * @description è·åå å åæçç¶æã
     * @param {string} id - å å åæç IDã
     * @returns {Object} å å åæçç¶æ
     */
    getoverlayGeoJobState(id) {
        return this.overlayGeoJobs[id];
    }

    /**
     * @function ProcessingService.prototype.getBuffersJobs
     * @description è·åç¼å²åºåæçåè¡¨ã
     * @param {RequestCallback} callback åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åç»æç±»åã
     */
    getBuffersJobs(callback, resultFormat) {
        var me = this,
            format = me._processFormat(resultFormat);
        var buffersAnalystJobsService = new BuffersAnalystJobsService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            },
            format: format
        });
        buffersAnalystJobsService.getBuffersJobs();
    }

    /**
     * @function ProcessingService.prototype.getBuffersJob
     * @description è·åç¼å²åºåæã
     * @param {string} id - ç©ºé´åæç IDã
     * @param {RequestCallback} callback åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åç»æç±»åã
     */
    getBuffersJob(id, callback, resultFormat) {
        var me = this,
            format = me._processFormat(resultFormat);
        var buffersAnalystJobsService = new BuffersAnalystJobsService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            },
            format: format
        });
        buffersAnalystJobsService.getBuffersJob(id);
    }

    /**
     * @function ProcessingService.prototype.addBuffersJob
     * @description ç¼å²åºåæã
     * @param {BuffersAnalystJobsParameter} params - ç¼å²åºåæä»»å¡åæ°ç±»ã
     * @param {RequestCallback} callback åè°å½æ°ã
     * @param {number} [seconds=1000] - è·ååå»ºæåç»æçæ¶é´é´éã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åç»æç±»åã
     */
    addBuffersJob(params, callback, seconds, resultFormat) {
        var me = this,
            param = me._processParams(params),
            format = me._processFormat(resultFormat);
        var buffersAnalystJobsService = new BuffersAnalystJobsService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback,
                processRunning: function (job) {
                    me.buffersJobs[job.id] = job.state;
                }
            },
            format: format
        });
        buffersAnalystJobsService.addBuffersJob(param, seconds);
    }

    /**
     * @function ProcessingService.prototype.getBuffersJobState
     * @description è·åç¼å²åºåæçç¶æã
     * @param {string} id - ç¼å²åºåæç IDã
     * @returns {Object} ç¼å²åºåæçç¶æã
     */
    getBuffersJobState(id) {
        return this.buffersJobs[id];
    }

    /**
     * @function ProcessingService.prototype.getTopologyValidatorJobs
     * @description è·åæææ£æ¥åæçåè¡¨ã
     * @param {RequestCallback} callback åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åç»æç±»åã
     */
    getTopologyValidatorJobs(callback, resultFormat) {
        var me = this,
            format = me._processFormat(resultFormat);
        var topologyValidatorJobsService = new TopologyValidatorJobsService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            },
            format: format
        });
        topologyValidatorJobsService.getTopologyValidatorJobs();
    }

    /**
     * @function ProcessingService.prototype.getTopologyValidatorJob
     * @description è·åæææ£æ¥åæã
     * @param {string} id - ç©ºé´åæç IDã
     * @param {RequestCallback} callback - åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åç»æç±»åã
     */
    getTopologyValidatorJob(id, callback, resultFormat) {
        var me = this,
            format = me._processFormat(resultFormat);
        var topologyValidatorJobsService = new TopologyValidatorJobsService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            },
            format: format
        });
        topologyValidatorJobsService.getTopologyValidatorJob(id);
    }

    /**
     * @function ProcessingService.prototype.addTopologyValidatorJob
     * @description æææ£æ¥åæã
     * @param {TopologyValidatorJobsParameter} params - æææ£æ¥åæä»»å¡åæ°ç±»ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     * @param {number} [seconds=1000] - è·ååå»ºæåç»æçæ¶é´é´éã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åç»æç±»åã
     */
    addTopologyValidatorJob(params, callback, seconds, resultFormat) {
        var me = this,
            param = me._processParams(params),
            format = me._processFormat(resultFormat);
        var topologyValidatorJobsService = new TopologyValidatorJobsService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback,
                processRunning: function (job) {
                    me.topologyValidatorJobs[job.id] = job.state;
                }
            },
            format: format
        });
        topologyValidatorJobsService.addTopologyValidatorJob(param, seconds);
    }

    /**
     * @function ProcessingService.prototype.getTopologyValidatorJobState
     * @description è·åæææ£æ¥åæçç¶æã
     * @param {string} id - æææ£æ¥åæç IDã
     * @returns {Object} æææ£æ¥åæçç¶æ
     */
    getTopologyValidatorJobState(id) {
        return this.topologyValidatorJobs[id];
    }

    /**
     * @function ProcessingService.prototype.getSummaryAttributesJobs
     * @description è·åæææ£æ¥å±æ§æ±æ»åæçåè¡¨ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åç»æç±»åã
     */
    getSummaryAttributesJobs(callback, resultFormat) {
        var me = this,
            format = me._processFormat(resultFormat);
        var summaryAttributesJobsService = new SummaryAttributesJobsService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            },
            format: format
        });
        summaryAttributesJobsService.getSummaryAttributesJobs();
    }

    /**
     * @function ProcessingService.prototype.getSummaryAttributesJob
     * @description è·åå±æ§æ±æ»åæã
     * @param {string} id - ç©ºé´åæç IDã
     * @param {RequestCallback} callback - åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åç»æç±»åã
     */
    getSummaryAttributesJob(id, callback, resultFormat) {
        var me = this,
            format = me._processFormat(resultFormat);
        var summaryAttributesJobsService = new SummaryAttributesJobsService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            },
            format: format
        });
        summaryAttributesJobsService.getSummaryAttributesJob(id);
    }

    /**
     * @function ProcessingService.prototype.addSummaryAttributesJob
     * @description å±æ§æ±æ»åæã
     * @param {SummaryAttributesJobsParameter} params - å±æ§æ±æ»åæä»»å¡åæ°ç±»ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     * @param {number} [seconds=1000] - è·ååå»ºæåç»æçæ¶é´é´éã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åç»æç±»åã
     */
    addSummaryAttributesJob(params, callback, seconds, resultFormat) {
        var me = this,
            param = me._processParams(params),
            format = me._processFormat(resultFormat);
        var summaryAttributesJobsService = new SummaryAttributesJobsService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback,
                processRunning: function (job) {
                    me.summaryAttributesJobs[job.id] = job.state;
                }
            },
            format: format
        });
        summaryAttributesJobsService.addSummaryAttributesJob(param, seconds);
    }

    /**
     * @function ProcessingService.prototype.getSummaryAttributesJobState
     * @description è·åå±æ§æ±æ»åæçç¶æã
     * @param {string} id - å±æ§æ±æ»åæç IDã
     * @returns {Object} å±æ§æ±æ»åæçç¶æã
     */
    getSummaryAttributesJobState(id) {
        return this.summaryAttributesJobs[id];
    }

    _processFormat(resultFormat) {
        return (resultFormat) ? resultFormat : DataFormat.GEOJSON;
    }

    _processParams(params) {
        if (!params) {
            return {};
        }
        if (params.bounds) {
            params.bounds = core_Util_Util.toSuperMapBounds(params.bounds);
        }
        if (params.query) {
            params.query = core_Util_Util.toSuperMapBounds(params.query);
        }
        if (params.geometryQuery) {
            params.geometryQuery = core_Util_Util.toProcessingParam(params.geometryQuery);
        }
        if (params.geometryClip) {
            params.geometryClip = core_Util_Util.toProcessingParam(params.geometryClip);
        }
        return params;
    }
}

;// CONCATENATED MODULE: ./src/openlayers/services/SpatialAnalystService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/






















/**
 * @class SpatialAnalystService
 * @extends {ServiceBase}
 * @category  iServer SpatialAnalyst
 * @classdesc ç©ºé´åææå¡ç±»ãæä¾ï¼å°åºå¤ªé³è¾å°ãç¼å²åºåæãç¹å¯åº¦åæãå¨æåæ®µåæãç©ºé´å³ç³»åæãæå¼åæãæ æ ¼ä»£æ°è¿ç®ãå å åæãè·¯ç±å®ä½ãè·¯ç±æµéè®¡ç®ãè¡¨é¢åæãå°å½¢æ²çè®¡ç®ãæ³°æ£®å¤è¾¹å½¢åæã
 * @example
 *      new SpatialAnalystService(url).bufferAnalysis(params,function(result){
 *          //doSomething
 *      })
 * @param {string} url - æå¡å°åã
 * @param {Object} options - åæ°ã
 * @param {string} [options.proxy] - æå¡ä»£çå°åã
 * @param {boolean} [options.withCredentials=false] - è¯·æ±æ¯å¦æºå¸¦ cookieã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class SpatialAnalystService extends ServiceBase {

    constructor(url, options) {
        super(url, options);
    }

    /**
     * @function SpatialAnalystService.prototype.getAreaSolarRadiationResult
     * @description å°åºå¤ªé³è¾å°ã
     * @param {AreaSolarRadiationParameters} params - å°åºå¤ªé³è¾å°åæ°ç±»ã
     * @param {RequestCallback} callback åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åçç»æç±»åã
     */
    getAreaSolarRadiationResult(params, callback, resultFormat) {
        var me = this;
        var areaSolarRadiationService = new AreaSolarRadiationService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            },
            format: me._processFormat(resultFormat)
        });
        areaSolarRadiationService.processAsync(params);
    }

    /**
     * @function SpatialAnalystService.prototype.bufferAnalysis
     * @description ç¼å²åºåæã
     * @param {DatasetBufferAnalystParameters} params - æ°æ®éç¼å²åºåæåæ°ç±»ã
     * @param {RequestCallback} callback åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åçç»æç±»åã
     */
    bufferAnalysis(params, callback, resultFormat) {
        var me = this;
        var bufferAnalystService = new BufferAnalystService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            },
            format: me._processFormat(resultFormat)
        });
        bufferAnalystService.processAsync(me._processParams(params));
    }

    /**
     * @function SpatialAnalystService.prototype.densityAnalysis
     * @description ç¹å¯åº¦åæã
     * @param {DensityKernelAnalystParameters} params - æ ¸å¯åº¦åæåæ°ç±»ã
     * @param {RequestCallback} callback åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åçç»æç±»åã
     */
    densityAnalysis(params, callback, resultFormat) {
        var me = this;
        var densityAnalystService = new DensityAnalystService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            },
            format: me._processFormat(resultFormat)
        });
        densityAnalystService.processAsync(me._processParams(params));
    }

    /**
     * @function SpatialAnalystService.prototype.generateSpatialData
     * @description å¨æåæ®µåæã
     * @param {GenerateSpatialDataParameters} params - å¨æåæ®µæä½åæ°ç±»ã
     * @param {RequestCallback} callback åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åçç»æç±»åã
     */
    generateSpatialData(params, callback, resultFormat) {
        var me = this;
        var generateSpatialDataService = new GenerateSpatialDataService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            },
            format: me._processFormat(resultFormat)
        });
        generateSpatialDataService.processAsync(params);
    }

    /**
     * @function SpatialAnalystService.prototype.geoRelationAnalysis
     * @description ç©ºé´å³ç³»åæã
     * @param {GeoRelationAnalystParameters} params - ç©ºé´å³ç³»åææå¡åæ°ç±»ã
     * @param {RequestCallback} callback åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åçç»æç±»åã
     */
    geoRelationAnalysis(params, callback, resultFormat) {
        var me = this;
        var geoRelationAnalystService = new GeoRelationAnalystService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            },
            format: me._processFormat(resultFormat)
        });
        geoRelationAnalystService.processAsync(params);
    }

    /**
     * @function SpatialAnalystService.prototype.interpolationAnalysis
     * @description æå¼åæã
     * @param {InterpolationRBFAnalystParameters|InterpolationDensityAnalystParameters|InterpolationIDWAnalystParameters|InterpolationKrigingAnalystParameters} params - æ ·æ¡æå¼åæåæ°ç±»ã
     * @param {RequestCallback} callback åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åçç»æç±»åã
     */
    interpolationAnalysis(params, callback, resultFormat) {
        var me = this;
        var interpolationAnalystService = new InterpolationAnalystService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            },
            format: me._processFormat(resultFormat)
        });
        interpolationAnalystService.processAsync(me._processParams(params));
    }
    /**
     * @function SpatialAnalystService.prototype.mathExpressionAnalysis
     * @description æ æ ¼ä»£æ°è¿ç®ã
     * @param {MathExpressionAnalysisParameters} params - æ æ ¼ä»£æ°è¿ç®åæ°ç±»ã
     * @param {RequestCallback} callback åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åçç»æç±»åã
     */
    mathExpressionAnalysis(params, callback, resultFormat) {
        var me = this;
        var mathExpressionAnalysisService = new MathExpressionAnalysisService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            },
            format: me._processFormat(resultFormat)
        });
        mathExpressionAnalysisService.processAsync(me._processParams(params));
    }

    /**
     * @function SpatialAnalystService.prototype.overlayAnalysis
     * @description å å åæã
     * @param {DatasetOverlayAnalystParameters|GeometryOverlayAnalystParameters} params - æ°æ®éå å åæåæ°ç±»æå ä½å¯¹è±¡å å åæåæ°ç±»ã
     * @param {RequestCallback} callback åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åçç»æç±»åã
     */
    overlayAnalysis(params, callback, resultFormat) {
        var me = this;
        var overlayAnalystService = new OverlayAnalystService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            },
            format: me._processFormat(resultFormat)
        });
        overlayAnalystService.processAsync(me._processParams(params));
    }

    /**
     * @function SpatialAnalystService.prototype.routeCalculateMeasure
     * @description è·¯ç±æµéè®¡ç®ã
     * @param {RouteCalculateMeasureParameters} params - åºäºè·¯ç±å¯¹è±¡è®¡ç®æå®ç¹ M å¼æä½çåæ°ç±»ã
     * @param {RequestCallback} callback åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åçç»æç±»åã
     */
    routeCalculateMeasure(params, callback, resultFormat) {
        var me = this;
        var routeCalculateMeasureService = new RouteCalculateMeasureService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            },
            format: me._processFormat(resultFormat)
        });
        routeCalculateMeasureService.processAsync(me._processParams(params));
    }

    /**
     * @function SpatialAnalystService.prototype.routeLocate
     * @description è·¯ç±å®ä½ã
     * @param {RouteLocatorParameters} params - è·¯ç±å¯¹è±¡å®ä½ç©ºé´å¯¹è±¡çåæ°ç±»ã
     * @param {RequestCallback} callback åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åçç»æç±»åã
     */
    routeLocate(params, callback, resultFormat) {
        var me = this;
        var routeLocatorService = new RouteLocatorService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            },
            format: me._processFormat(resultFormat)
        });
        routeLocatorService.processAsync(me._processParams(params));
    }

    /**
     * @function SpatialAnalystService.prototype.surfaceAnalysis
     * @description è¡¨é¢åæã
     * @param {SurfaceAnalystParameters} params - è¡¨é¢åææåæä½åæ°ç±»ã
     * @param {RequestCallback} callback åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åçç»æç±»åã
     */
    surfaceAnalysis(params, callback, resultFormat) {
        var me = this;
        var surfaceAnalystService = new SurfaceAnalystService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            },
            format: me._processFormat(resultFormat)
        });
        surfaceAnalystService.processAsync(me._processParams(params));
    }

    /**
     * @function SpatialAnalystService.prototype.terrainCurvatureCalculate
     * @description å°å½¢æ²çè®¡ç®ã
     * @param {TerrainCurvatureCalculationParameters} params - å°å½¢æ²çè®¡ç®åæ°ç±»ã
     * @param {RequestCallback} callback åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åçç»æç±»åã
     */
    terrainCurvatureCalculate(params, callback, resultFormat) {
        var me = this;
        var terrainCurvatureCalculationService = new TerrainCurvatureCalculationService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            },
            format: me._processFormat(resultFormat)
        });
        terrainCurvatureCalculationService.processAsync(params);
    }

    /**
     * @function SpatialAnalystService.prototype.thiessenAnalysis
     * @description æ³°æ£®å¤è¾¹å½¢åæã
     * @param {DatasetThiessenAnalystParameters|GeometryThiessenAnalystParameters} params - æ°æ®éæ³°æ£®å¤è¾¹å½¢åæåæ°ç±»ã
     * @param {RequestCallback} callback åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åçç»æç±»åã
     */
    thiessenAnalysis(params, callback, resultFormat) {
        var me = this;
        var thiessenAnalystService = new ThiessenAnalystService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            },
            format: me._processFormat(resultFormat)
        });
        thiessenAnalystService.processAsync(me._processParams(params));
    }

    /**
     * @function SpatialAnalystService.prototype.geometrybatchAnalysis
     * @description æ¹éç©ºé´åæã
     * @param {Array.<Object>} params - æ¹éåæåæ°å¯¹è±¡æ°ç»ã
     * @param {Array.<Object>} params.analystName - ç©ºé´åææ¹æ³çåç§°ãåæ¬ï¼</br>
     *                                              "buffer"ï¼"overlay"ï¼"interpolationDensity"ï¼"interpolationidw"ï¼"interpolationRBF"ï¼"interpolationKriging"ï¼"isoregion"ï¼"isoline"ã
     * @param {Object} params.param - ç©ºé´åæç±»åå¯¹åºçè¯·æ±åæ°ï¼åæ¬ï¼</br>
     *                                {@link GeometryBufferAnalystParameters} ç¼å²åºåæåæ°ç±»ã</br>
     *                                {@link GeometryOverlayAnalystParameters} å å åæåæ°ç±»ã</br>
     *                                {@link InterpolationAnalystParameters} æå¼åæåæ°ç±»ã</br>
     *                                {@link SurfaceAnalystParameters} è¡¨é¢åæåæ°ç±»ã</br>
     * @param {RequestCallback} callback - åè°å½æ°ã
     * @param {DataFormat} [resultFormat=DataFormat.GEOJSON] - è¿åçç»æç±»åã
     */
    geometrybatchAnalysis(params, callback, resultFormat) {
        var me = this;
        var geometryBatchAnalystService = new GeometryBatchAnalystService(me.url, {

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            },
            format: me._processFormat(resultFormat)
        });

        //å¤çæ¹éåæä¸­åä¸ªåç±»ç±»åçåæ°ï¼
        var analystParameters = [];
        for (var i = 0; i < params.length; i++) {
            var tempParameter = params[i];
            analystParameters.push({
                analystName: tempParameter.analystName,
                param: me._processParams(tempParameter.param)
            })
        }

        geometryBatchAnalystService.processAsync(analystParameters);
    }

    _processParams(params) {
        if (!params) {
            return {};
        }
        if (params.bounds) {
            params.bounds = core_Util_Util.toSuperMapBounds(params.bounds);
        }
        if (params.inputPoints) {
            for (let i = 0; i < params.inputPoints.length; i++) {
                var inputPoint = params.inputPoints[i];
                if (core_Util_Util.isArray(inputPoint)) {
                    params.inputPoints[i] = {x: inputPoint[0], y: inputPoint[1], tag: inputPoint[2]};
                } else {
                    params.inputPoints[i] = {
                        x: inputPoint.getCoordinates()[0],
                        y: inputPoint.getCoordinates()[1],
                        tag: inputPoint.tag
                    };
                }

            }
        }
        if (params.points) {
            for (let i = 0; i < params.points.length; i++) {
                let point = params.points[i];
                if (core_Util_Util.isArray(point)) {
                    point.setCoordinates(point);
                }
                params.points[i] = new Point(point.getCoordinates()[0], point.getCoordinates()[1]);
            }
        }
        if (params.point) {
            let point = params.point;
            if (core_Util_Util.isArray(point)) {
                point.setCoordinates(point);
            }
            params.point = new Point(point.getCoordinates()[0], point.getCoordinates()[1]);
        }
        if (params.extractRegion) {
            params.extractRegion = this.convertGeometry(params.extractRegion);
        }
        if (params.extractParameter && params.extractParameter.clipRegion) {
            params.extractParameter.clipRegion = this.convertGeometry(params.extractParameter.clipRegion);
        }
        if (params.clipParam && params.clipParam.clipRegion) {
            params.clipParam.clipRegion = this.convertGeometry(params.clipParam.clipRegion);
        }
        //æ¯ææ ¼å¼ï¼Vector Layers; GeoJson
        if (params.sourceGeometry) {
            var SRID = null;
            if (params.sourceGeometrySRID) {
                SRID = params.sourceGeometrySRID;
            }
            params.sourceGeometry = this.convertGeometry(params.sourceGeometry);
            if (SRID) {
                params.sourceGeometry.SRID = SRID;
            }
            delete params.sourceGeometry.sourceGeometrySRID;
        }
        if (params.operateGeometry) {
            params.operateGeometry = this.convertGeometry(params.operateGeometry);
        }
        //æ¯æä¼ å¥å¤ä¸ªå ä½è¦ç´ è¿è¡å å åæï¼
        if (params.sourceGeometries) {
            var sourceGeometries = [];
            for (var k = 0; k < params.sourceGeometries.length; k++) {
                sourceGeometries.push(this.convertGeometry(params.sourceGeometries[k]));
            }
            params.sourceGeometries = sourceGeometries;
        }
        //æ¯æä¼ å¥å¤ä¸ªå ä½è¦ç´ è¿è¡å å åæï¼
        if (params.operateGeometries) {
            var operateGeometries = [];
            for (var j = 0; j < params.operateGeometries.length; j++) {
                operateGeometries.push(this.convertGeometry(params.operateGeometries[j]));
            }
            params.operateGeometries = operateGeometries;
        }

        if (params.sourceRoute) {
            if (params.sourceRoute instanceof (external_ol_geom_LineString_default()) && params.sourceRoute.getCoordinates()) {
                var target = {};
                target.type = "LINEM";
                target.parts = [params.sourceRoute.getCoordinates()[0].length];
                target.points = [];
                for (let i = 0; i < params.sourceRoute.getCoordinates()[0].length; i++) {
                    let point = params.sourceRoute.getCoordinates()[0][i];
                    target.points = target.points.concat({x: point[0], y: point[1], measure: point[2]})
                }
                params.sourceRoute = target;
            }

        }
        var me = this;
        if (params.operateRegions && core_Util_Util.isArray(params.operateRegions)) {
            params.operateRegions.map(function (geometry, key) {
                params.operateRegions[key] = me.convertGeometry(geometry);
                return params.operateRegions[key];
            });
        }
        if (params.sourceRoute && params.sourceRoute.components && core_Util_Util.isArray(params.sourceRoute.components)) {
            params.sourceRoute.components.map(function (geometry, key) {
                params.sourceRoute.components[key] = me.convertGeometry(geometry);
                return params.sourceRoute.components[key];
            });
        }
        return params;
    }

    _processFormat(resultFormat) {
        return (resultFormat) ? resultFormat : DataFormat.GEOJSON;
    }

    /**
     * @private
     * @function SpatialAnalystService.prototype.convertGeometry
     * @description è½¬æ¢å ä½å¯¹è±¡ã
     * @param {Object} ol3Geometry - å¾è½¬æ¢çå ä½å¯¹è±¡ã
     */

    convertGeometry(ol3Geometry) {
        //å¤æ­æ¯å¦ä¼ å¥çæ¯geojson å¹¶ä½ç¸åºå¤ç
        if(["FeatureCollection", "Feature", "Geometry"].indexOf(ol3Geometry.type) != -1){
            return core_Util_Util.toSuperMapGeometry(ol3Geometry);
        }
        return core_Util_Util.toSuperMapGeometry(JSON.parse((new (external_ol_format_GeoJSON_default())()).writeGeometry(ol3Geometry)));
    }
}

;// CONCATENATED MODULE: ./src/openlayers/services/ThemeService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class ThemeService
 * @category  iServer Map Theme
 * @classdesc ä¸é¢å¾æå¡ç±»ã
 * @extends {ServiceBase}
 * @example
 *      new ThemeService(url,{
 *            projection:projection
 *      }).getThemeInfo(params,function(result){
 *           //doSomething
 *      });
 * @param {string} url - æå¡å°åã
 * @param {Object} options - åæ°ã
 * @param {string} [options.proxy] - æå¡ä»£çå°åã
 * @param {boolean} [options.withCredentials=false] - è¯·æ±æ¯å¦æºå¸¦ cookieã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class ThemeService extends ServiceBase {

    constructor(url, options) {
        super(url, options);
    }

    /**
     * @function ThemeService.prototype.getThemeInfo
     * @description è·åä¸é¢å¾ä¿¡æ¯ã
     * @param {ThemeParameters} params - ä¸é¢å¾åæ°ç±»ã
     * @param {RequestCallback} callback åè°å½æ°ã
     */
    getThemeInfo(params, callback) {
        var me = this;
        var themeService = new ThemeService_ThemeService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,
            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            }
        });
        themeService.processAsync(params);
    }
}

;// CONCATENATED MODULE: ./src/openlayers/services/TrafficTransferAnalystService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/







/**
 * @class TrafficTransferAnalystService
 * @extends {ServiceBase}
 * @category  iServer TrafficTransferAnalyst
 * @classdesc äº¤éæ¢ä¹åææå¡ç±»ã
 * @example
 *      new TrafficTransferAnalystService(url).queryStop(params,function(result){
 *           //doSomething
 *      })
 * @param {string} url - æå¡å°åã
 * @param {Object} options - åæ°ã
 * @param {string} [options.proxy] - æå¡ä»£çå°åã
 * @param {boolean} [options.withCredentials=false] - è¯·æ±æ¯å¦æºå¸¦ cookieã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class TrafficTransferAnalystService extends ServiceBase {

    constructor(url, options) {
        super(url, options);
    }

    /**
     * @function TrafficTransferAnalystService.prototype.queryStop
     * @description ç«ç¹æ¥è¯¢æå¡ã
     * @param {StopQueryParameters} params - æ¥è¯¢ç¸å³åæ°ç±»ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     */
    queryStop(params, callback) {
        var me = this;
        var stopQueryService = new StopQueryService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            }
        });
        stopQueryService.processAsync(params);
    }

    /**
     * @function TrafficTransferAnalystService.prototype.analysisTransferPath
     * @description äº¤éæ¢ä¹çº¿è·¯æ¥è¯¢æå¡ã
     * @param {TransferPathParameters} params - æ¥è¯¢ç¸å³åæ°ç±»ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     */
    analysisTransferPath(params, callback) {
        var me = this;
        var transferPathService = new TransferPathService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            }
        });
        transferPathService.processAsync(me._processParams(params));
    }

    /**
     * @function TrafficTransferAnalystService.prototype.analysisTransferSolution
     * @description äº¤éæ¢ä¹æ¹æ¡æ¥è¯¢æå¡ã
     * @param {TransferSolutionParameters} params - æ¥è¯¢ç¸å³åæ°ç±»ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     */
    analysisTransferSolution(params, callback) {
        var me = this;
        var transferSolutionService = new TransferSolutionService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            }
        });
        transferSolutionService.processAsync(me._processParams(params));
    }

    _processParams(params) {
        if (!params) {
            return {};
        }
        if (params.transferLines && !core_Util_Util.isArray(params.transferLines)) {
            params.transferLines = [params.transferLines];
        }
        if (params.points && core_Util_Util.isArray(params.points)) {
            params.points.map(function (point, key) {
                params.points[key] = (point instanceof (external_ol_geom_Point_default())) ? {
                    x: point.getCoordinates()[0],
                    y: point.getCoordinates()[1]
                } : point;
                return params.points[key];
            });
        }
        return params;
    }

}

;// CONCATENATED MODULE: ./src/openlayers/services/WebPrintingJobService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/






/**
 * @class WebPrintingJobService
 * @category  iServer WebPrintingJob
 * @version 10.1.0
 * @classdesc Web æå°æå¡ç±»ã
 *            æä¾ï¼åå»º Web æå°ä»»å¡ï¼è·å Web æå°ä»»å¡åå®¹ï¼è·å Web æå°è¾åºææ¡£æµï¼è·å Web æå°æå¡çå¸å±æ¨¡æ¿ä¿¡æ¯ã
 * @extends {ServiceBase}
 * @param {string} url - æå¡å°åãè¯·æ±æå°å°å¾æå¡ç URL åºä¸ºï¼http://{æå¡å¨å°å}:{æå¡ç«¯å£å·}/iserver/services/webprinting/rest/webprinting/v1ã
 * @param {Object} options - æå¡äº¤äºæ¶æéçå¯éåæ°ã
 * @param {string} [options.proxy] - æå¡ä»£çå°åã
 * @param {boolean} [options.withCredentials=false] - è¯·æ±æ¯å¦æºå¸¦ cookieã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @example
 * new WebPrintingJobService(url).createWebPrintingJob(param,function(result){
 *     //doSomething
 * })
 * @usage
 */
class WebPrintingJobService extends ServiceBase {
    constructor(url, options) {
        super(url, options);
    }

    /**
     * @function WebPrintingJobService.prototype.createWebPrintingJob
     * @description åå»º Web æå°ä»»å¡ã
     * @param {WebPrintingJobParameters} params - Web æå°åæ°ç±»ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     */
    createWebPrintingJob(params, callback) {
        if (!params) {
            return;
        }
        var me = this;
        var webPrintingService = new WebPrintingService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            }
        });

        webPrintingService.createWebPrintingJob(me._processParams(params));
    }

    /**
     * @function WebPrintingJobService.prototype.getPrintingJob
     * @description è·å Web æå°è¾åºææ¡£ä»»å¡ã
     * @param {string} jobId - Web æå°è¾å¥ææ¡£ä»»å¡ Idã
     * @param {RequestCallback} callback - åè°å½æ°ã
     */
    getPrintingJob(jobId, callback) {
        var me = this;
        var webPrintingService = new WebPrintingService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            }
        });

        webPrintingService.getPrintingJob(jobId);
    }

    /**
     * @function WebPrintingJobService.prototype.getPrintingJobResult
     * @description è·å Web æå°ä»»å¡çè¾åºææ¡£ã
     * @param {string} jobId - Web æå°è¾å¥ææ¡£ä»»å¡ Idã
     * @param {RequestCallback} callback - åè°å½æ°ã
     */
    getPrintingJobResult(jobId, callback) {
        var me = this;
        var webPrintingService = new WebPrintingService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            }
        });

        webPrintingService.getPrintingJobResult(jobId);
    }

    /**
     * @function WebPrintingJobService.prototype.getLayoutTemplates
     * @description æ¥è¯¢ Web æå°æå¡ææå¯ç¨çæ¨¡æ¿ä¿¡æ¯ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     */
    getLayoutTemplates(callback) {
        var me = this;
        var webPrintingService = new WebPrintingService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,

            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            }
        });

        webPrintingService.getLayoutTemplates();
    }

    _processParams(params) {
        if (params.layoutOptions && params.layoutOptions.littleMapOptions) {
            params.layoutOptions.littleMapOptions.center = this._toPointObject(
                params.layoutOptions.littleMapOptions.center
            );
        }
        if (params.exportOptions) {
            params.exportOptions.center = this._toPointObject(params.exportOptions.center);
        }
        return params;
    }

    _toPointObject(point) {
        if (core_Util_Util.isArray(point)) {
            return {
                x: point[0],
                y: point[1]
            };
        } else if (point instanceof Point || point instanceof (external_ol_geom_Point_default())) {
            return {
                x: point.x,
                y: point.y
            };
        }
        return point;
    }
}

;// CONCATENATED MODULE: ./src/openlayers/services/ImageService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class ImageService
 * @version 10.2.0
 * @constructs ImageService
 * @classdesc å½±åæå¡ç±»
 * @category  iServer Image
 * @extends {ServiceBase}
 * @example
 *      ImageService(url,options).getCollections(function(result){
 *          //doSomething
 *      })
 * @param {string} url - æå¡å°åãä¾å¦: http://{ip}:{port}/iserver/{imageservice-imageserviceName}/restjsr/
 * @param {Object} options - åæ°ã
 * @param {string} [options.proxy] - æå¡ä»£çå°åã
 * @param {boolean} [options.withCredentials=false] - è¯·æ±æ¯å¦æºå¸¦ cookieã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class ImageService extends ServiceBase {
    constructor(url, options) {
        super(url, options);
    }

    /**
     * @function ImageService.prototype.getCollections
     * @description è¿åå½åå½±åæå¡ä¸­çå½±åéååè¡¨ï¼Collectionsï¼ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     */
    getCollections(callback) {
        var me = this;
        var ImageService = new ImageService_ImageService(this.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,
            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            }
        });
        ImageService.getCollections();
    }

    /**
     * @function ImageService.prototype.getCollectionByID
     * @description IDå¼ç­äº`collectionId`åæ°å¼çå½±åéåï¼Collectionï¼ã IDå¼ç¨äºå¨æå¡ä¸­å¯ä¸æ è¯è¯¥å½±åéåã
     * @param {string} collectionId å½±åéåï¼Collectionï¼çIDï¼å¨ä¸ä¸ªå½±åæå¡ä¸­å¯ä¸æ è¯å½±åéåã
     * @param {RequestCallback} callback - åè°å½æ°ã
     */
    getCollectionByID(collectionId, callback) {
        var me = this;
        var ImageService = new ImageService_ImageService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,
            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            }
        });
        ImageService.getCollectionByID(collectionId);
    }

    /**
     * @function ImageService.prototype.search
     * @description æ¥è¯¢ä¸è¿æ»¤æ¡ä»¶å¹éçå½±åæ°æ®ã
     * @param {ImageSearchParameter} [itemSearch] æ¥è¯¢åæ°
     * @param {RequestCallback} callback - åè°å½æ°ã
     */
    search(itemSearch, callback) {
        var me = this;
        var ImageService = new ImageService_ImageService(me.url, {
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,
            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            }
        });
        ImageService.search(itemSearch);
    }
}

;// CONCATENATED MODULE: ./src/openlayers/services/ImageCollectionService.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/



/**
 * @class ImageCollectionService
 * @version 10.2.0
 * @constructs ImageCollectionService
 * @classdesc å½±åéåæå¡ç±»
 * @category  iServer Image
 * @extends {ServiceBase}
 * @example
 *      new ImageCollectionService(url,options).getLegend(queryParams,function(result){
 *          //doSomething
 *      })
 * @param {string} url - æå¡å°åãä¾å¦: http://{ip}:{port}/iserver/{imageservice-imageserviceName}/restjsr/
 * @param {Object} options - åæ°ã
 * @param {string} options.collectionId å½±åéåï¼Collectionï¼çIDï¼å¨ä¸ä¸ªå½±åæå¡ä¸­å¯ä¸æ è¯å½±åéåã
 * @param {string} [options.proxy] - æå¡ä»£çå°åã
 * @param {boolean} [options.withCredentials=false] - è¯·æ±æ¯å¦æºå¸¦ cookieã
 * @param {boolean} [options.crossOrigin] - æ¯å¦åè®¸è·¨åè¯·æ±ã
 * @param {Object} [options.headers] - è¯·æ±å¤´ã
 * @usage
 */
class ImageCollectionService extends ServiceBase {
    constructor(url, options) {
        super(url, options);
    }

    /**
     * @function ImageCollectionService.prototype.getLegend
     * @param {Object} queryParams queryåæ°
     * @param {ImageRenderingRule} [queryParams.renderingRule] æå®å½±åæ¾ç¤ºçé£æ ¼ï¼åå«æä¼¸æ¾ç¤ºæ¹å¼ãé¢è²è¡¨ãæ³¢æ®µç»åä»¥ååºç¨æ æ ¼å½æ°è¿è¡å¿«éå¤çç­ãä¸æå®æ¶ï¼ä½¿ç¨åå¸æå¡æ¶æéç½®çé£æ ¼ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     */
    getLegend(queryParams, callback) {
        var me = this;
        var ImageCollectionService = new ImageCollectionService_ImageCollectionService(this.url, {
            collectionId: me.options.collectionId,
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,
            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            }
        });
        ImageCollectionService.getLegend(queryParams);
    }

    /**
     * @function ImageCollectionService.prototype.getStatistics
     * @description è¿åå½åå½±åéåçç»è®¡ä¿¡æ¯ãåæ¬æä»¶æ°éï¼æä»¶å¤§å°ç­ä¿¡æ¯ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     */
    getStatistics(callback) {
        var me = this;
        var ImageCollectionService = new ImageCollectionService_ImageCollectionService(me.url, {
            collectionId: me.options.collectionId,
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,
            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            }
        });
        ImageCollectionService.getStatistics();
    }

    /**
     * @function ImageCollectionService.prototype.getTileInfo
     * @description è¿åå½±åéåææä¾çæå¡ç¦ççä¿¡æ¯ï¼åæ¬ï¼æ¯å±ç¦ççåè¾¨çï¼æ¯ä¾å°ºç­ä¿¡æ¯ï¼æ¹ä¾¿åç«¯è¿è¡å¾å±å å ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     */
    getTileInfo(callback) {
        var me = this;
        var ImageCollectionService = new ImageCollectionService_ImageCollectionService(me.url, {
            collectionId: me.options.collectionId,
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,
            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            }
        });
        ImageCollectionService.getTileInfo();
    }

    /**
     * @function ImageCollectionService.prototype.deleteItemByID
     * @description å é¤å½±åéåä¸­çæå®IDï¼`featureId`ï¼çItemå¯¹è±¡ï¼å³ä»å½±åéåä¸­å é¤æå®çå½±åã
     * @param {string} featureId Feature çæ¬å°æ è¯ç¬¦ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     */
    deleteItemByID(featureId, callback) {
        var me = this;
        var ImageCollectionService = new ImageCollectionService_ImageCollectionService(this.url, {
            collectionId: me.options.collectionId,
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,
            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            }
        });
        ImageCollectionService.deleteItemByID(featureId);
    }

    /**
     * @function ImageCollectionService.prototype.getItemByID
     * @description è¿åå½±åéåä¸­çæå®IDï¼`featureId`ï¼çItemå¯¹è±¡ï¼å³è¿åå½±åéåä¸­æå®çå½±åã
     * @param {string} featureId Feature çæ¬å°æ è¯ç¬¦ã
     * @param {RequestCallback} callback - åè°å½æ°ã
     */
    getItemByID(featureId, callback) {
        var me = this;
        var ImageCollectionService = new ImageCollectionService_ImageCollectionService(me.url, {
            collectionId: me.options.collectionId,
            proxy: me.options.proxy,
            withCredentials: me.options.withCredentials,
            crossOrigin: me.options.crossOrigin,
            headers: me.options.headers,
            eventListeners: {
                scope: me,
                processCompleted: callback,
                processFailed: callback
            }
        });
        ImageCollectionService.getItemByID(featureId);
    }
}

;// CONCATENATED MODULE: ./src/openlayers/services/index.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/























;// CONCATENATED MODULE: ./src/openlayers/mapping/webmap/config/ProvinceCenter.json
const ProvinceCenter_namespaceObject = JSON.parse('[{"name":"é»é¾æ±ç","coord":[127.64559817675396,48.48668098449708]},{"name":"åèå¤èªæ²»åº","coord":[118.34519572208615,45.370218276977525]},{"name":"æ°çç»´å¾å°èªæ²»åº","coord":[87.13479065593184,41.75497055053711]},{"name":"åæç","coord":[126.12985278813787,43.57983207702637]},{"name":"è¾½å®ç","coord":[124.02494773936439,41.105743408203125]},{"name":"çèç","coord":[102.87785725633012,37.69582366943361]},{"name":"æ²³åç","coord":[115.66327227481898,39.33383178710938]},{"name":"åäº¬å¸","coord":[116.62199343603638,40.25053787231445]},{"name":"å±±è¥¿ç","coord":[112.45180235808988,37.666561126708984]},{"name":"å¤©æ´¥å¸","coord":[117.35711842642581,39.406789779663086]},{"name":"éè¥¿ç","coord":[109.56294003056632,35.64754199981689]},{"name":"å®å¤åæèªæ²»åº","coord":[105.96110877640074,37.3081169128418]},{"name":"éæµ·ç","coord":[96.07301048277901,35.44417190551758]},{"name":"å±±ä¸ç","coord":[118.03833752951093,36.29800605773925]},{"name":"è¥¿èèªæ²»åº","coord":[87.47361520439412,31.6703872680664]},{"name":"æ²³åç","coord":[113.07832397097275,33.87751102447509]},{"name":"æ±èç","coord":[119.93926538201052,32.945452690124505]},{"name":"å®å¾½ç","coord":[117.15146765881019,32.024482727050774]},{"name":"åå·ç","coord":[102.28998890142759,30.182161331176758]},{"name":"æ¹åç","coord":[112.87798261431585,31.157071113586426]},{"name":"éåºå¸","coord":[107.870126637831,30.188085556030266]},{"name":"ä¸æµ·å¸","coord":[121.42561166015514,31.276043891906745]},{"name":"æµæ±ç","coord":[119.75337092707514,29.175934791564945]},{"name":"æ¹åç","coord":[111.52770282777405,27.38110256195069]},{"name":"æ±è¥¿ç","coord":[115.51091280655628,27.283511161804206]},{"name":"äºåç","coord":[101.27053825991308,25.19783210754396]},{"name":"è´µå·ç","coord":[106.49672346773299,26.92267990112305]},{"name":"ç¦å»ºç","coord":[117.9976766946587,25.939599990844727]},{"name":"å¹¿è¥¿å£®æèªæ²»åº","coord":[108.98706831086302,23.891559600830078]},{"name":"å°æ¹¾ç","coord":[120.82468432537434,23.602651596069336]},{"name":"é¦æ¸¯ç¹å«è¡æ¿åº","coord":[114.21036850371561,22.374858856201172]},{"name":"æµ·åç","coord":[109.62792940960824,19.163116455078125]},{"name":"å¹¿ä¸ç","coord":[113.32127888266032,22.873867034912106]},{"name":"æ¾³é¨ç¹å«è¡æ¿åº","coord":[113.56819996291901,22.160347992976]}]');
;// CONCATENATED MODULE: ./src/openlayers/mapping/webmap/config/MunicipalCenter.json
const MunicipalCenter_namespaceObject = JSON.parse('[{"name":"åæçä¾å¸","coord":[85.01486759299489,45.406422237230046]},{"name":"æååæèªæ²»å·","coord":[88.7154624754753,44.26991024636568]},{"name":"ç³æ²³å­å¸","coord":[86.0208600035924,44.239045558096805]},{"name":"éæé­åå¸","coord":[114.73479243733115,44.16058374713977]},{"name":"æ¬æºªå¸","coord":[124.64357865201586,41.177197783134275]},{"name":"åå³ªå³å¸","coord":[98.16891560537093,39.76279786284264]},{"name":"è±èå¸","coord":[117.65723565456207,36.27916499211527]},{"name":"ç¥åæ¶æåº","coord":[110.48296222218153,31.581260143666697]},{"name":"å¤©é¨å¸","coord":[113.00615321481195,30.64105781887143]},{"name":"éå·å¸","coord":[114.94764081970385,30.325634953844585]},{"name":"æ½æ±å¸","coord":[112.70703817700621,30.349210666019893]},{"name":"ä»æ¡å¸","coord":[113.34688900729822,30.315951161935402]},{"name":"èä¹¡å¸","coord":[113.88072263074415,27.47193090553213]},{"name":"å°æ¹¾ç","coord":[120.14338943402045,23.596002465926095]},{"name":"ä¸èå¸","coord":[113.89443658529342,22.897826158636448]},{"name":"ä¸­å±±å¸","coord":[113.37118387764659,22.501478858616522]},{"name":"ç æµ·å¸","coord":[113.21799258934986,22.23782602992192]},{"name":"åæµ·å¸","coord":[109.18248083043899,21.695773689750148]},{"name":"é¦æ¸¯","coord":[114.20689279508653,22.36016760139811]},{"name":"èå±±å¸","coord":[122.22514712841459,30.338633120695956]},{"name":"åå­åèæ¯å°åå­","coord":[74.62910472637343,39.59886016069875]},{"name":"åä»å°åº","coord":[77.19899922143753,37.85462871211595]},{"name":"é¿åèå°åº","coord":[81.43930290016381,41.067304799230456]},{"name":"åç°å°åº","coord":[80.69780509160952,36.95287032287055]},{"name":"é¿éå°åº","coord":[82.536487505389,32.69566569631762]},{"name":"æ¥ååå°åº","coord":[86.5996831353606,29.54861754814263]},{"name":"é£æ²å°åº","coord":[88.32523292667608,33.20600450932715]},{"name":"çæ èæèªæ²»å·","coord":[95.2107128446203,33.90320387919257]},{"name":"è¿ªåºèæèªæ²»å·","coord":[99.42465312188943,28.052797714348895]},{"name":"ææ±ååæèªæ²»å·","coord":[98.85737910439825,26.98345757528851]},{"name":"å¤§çç½æèªæ²»å·","coord":[99.93934374816013,25.684737357453045]},{"name":"å¾·å®å£ææ¯é¢æèª","coord":[98.13830877778075,24.593421919561205]},{"name":"ä¿å±±å¸","coord":[99.19031013453166,24.979380341662]},{"name":"ä¸´æ²§å¸","coord":[99.62483778975081,24.058807858948214]},{"name":"æ®æ´±å¸","coord":[100.94440267992684,23.44121660743221]},{"name":"è¥¿åççº³å£æèªæ²»","coord":[100.86105801845994,21.882475641324206]},{"name":"æè¨å¸","coord":[91.3684790613129,30.14176592960237]},{"name":"å±±åå°åº","coord":[92.11665242621062,28.33000201578789]},{"name":"æèå°åº","coord":[94.9307847458166,29.125110156601963]},{"name":"æé½å°åº","coord":[97.33912235873476,30.48520825551814]},{"name":"ä¸½æ±å¸","coord":[100.65713436205135,26.96190318191959]},{"name":"ææè±å¸","coord":[101.73355913301131,26.714486678752795]},{"name":"åå±±å½æèªæ²»å·","coord":[102.08678551422615,27.683020519860396]},{"name":"æ¥éå½æèªæ²»å·","coord":[101.68264761198458,25.369603845264024]},{"name":"çº¢æ²³åå°¼æå½æèª","coord":[102.95101719613119,23.624860095239875]},{"name":"æå±±å£®æèæèªæ²»","coord":[104.8708359910614,23.579587266862504]},{"name":"ç¾è²å¸","coord":[106.69546907589859,23.98220841166522]},{"name":"å´å·¦å¸","coord":[107.3277087317123,22.49769755349952]},{"name":"é²åæ¸¯å¸","coord":[107.88939931155171,21.94550204069006]},{"name":"åå®å¸","coord":[108.67078983716917,23.12207641861882]},{"name":"é¦å·å¸","coord":[108.8532307305186,22.157690108421384]},{"name":"çæå¸","coord":[110.26918466489103,22.391823643610415]},{"name":"æ¹æ±å¸","coord":[109.93033457863683,21.086751055633457]},{"name":"èåå¸","coord":[110.80336192333934,22.069184739040775]},{"name":"é³æ±å¸","coord":[111.70471342186183,22.108751366417575]},{"name":"æ±é¨å¸","coord":[112.53715618649149,22.297368082806777]},{"name":"å¹¿å·å¸","coord":[113.4949302208309,23.28359314707863]},{"name":"æ¸è¿å¸","coord":[113.10957368131268,24.334444053233856]},{"name":"èåºå¸","coord":[112.11117530204233,23.60241158796112]},{"name":"æ¢§å·å¸","coord":[111.01709510772797,23.518132876753846]},{"name":"è´ºå·å¸","coord":[111.50423061842756,24.4095096817199]},{"name":"æ¡æå¸","coord":[110.44046163393094,25.353966673735407]},{"name":"æ³å·å¸","coord":[109.34854449214147,24.972408051485047]},{"name":"æ²³æ± å¸","coord":[107.81191841865586,24.649291651298164]},{"name":"é»ä¸åèæä¾æèª","coord":[108.39952601614591,26.429286420465576]},{"name":"è´µé³å¸","coord":[106.59784062851153,26.797907456479816]},{"name":"å®é¡ºå¸","coord":[105.76161265300635,25.988644902171018]},{"name":"é»è¥¿åå¸ä¾æèæ","coord":[105.5954078788574,25.404850939549405]},{"name":"æ²éå¸","coord":[103.9164335632742,25.697243690315265]},{"name":"å­çæ°´å¸","coord":[104.77723228072432,26.15402255629164]},{"name":"æ¯èå°åº","coord":[105.03867422931839,27.077913968069666]},{"name":"æ­éå¸","coord":[104.29730513046874,27.62418247971078]},{"name":"å®å®¾å¸","coord":[104.76748901448207,28.553501804266475]},{"name":"ä¹å±±å¸","coord":[103.56027669102787,29.160754519210577]},{"name":"èªè´¡å¸","coord":[104.63272827056402,29.273152614922402]},{"name":"åæ±å¸","coord":[104.82644562304716,29.61272653799929]},{"name":"éµä¹å¸","coord":[106.82413636302059,28.191847588570702]},{"name":"è¾¾å·å¸","coord":[107.59704170009518,31.32138258839703]},{"name":"éå®å¸","coord":[105.48979445433736,30.677687821242678]},{"name":"å¹¿å®å¸","coord":[106.56708164098042,30.43500706741521]},{"name":"æ³¸å·å¸","coord":[105.42591761727707,28.50277238478137]},{"name":"èµé³å¸","coord":[104.97995126874034,30.154251886139654]},{"name":"éå®å¸","coord":[102.69931299964517,29.892630706195035]},{"name":"çå±±å¸","coord":[104.07052881858888,29.894202166560405]},{"name":"çå­èæèªæ²»å·","coord":[100.50721042614238,30.975216556269658]},{"name":"ææ´èæèªæ²»å·","coord":[99.30775565051923,34.03539865224808]},{"name":"æµ·åèæèªæ²»å·","coord":[100.39969108016373,35.90048272566899]},{"name":"é»åèæèªæ²»å·","coord":[101.5360706381689,35.10286360841902]},{"name":"èµ£åèæèªæ²»å·","coord":[102.97083885806067,34.326752803339026]},{"name":"éåå¸","coord":[105.24780098912132,33.57031117443431]},{"name":"å¤©æ°´å¸","coord":[105.53503634660417,34.62320421368087]},{"name":"å®è¥¿å¸","coord":[104.58787768541339,35.08900966621695]},{"name":"ä¸´å¤åæèªæ²»å·","coord":[103.2612870434902,35.591577124455235]},{"name":"è¥¿å®å¸","coord":[101.57680657999033,36.84800271717157]},{"name":"æµ·ä¸å°åº","coord":[102.30909850729282,36.287400615025646]},{"name":"æµ·åèæèªæ²»å·","coord":[100.27122484450717,37.892557516083826]},{"name":"éæå¸","coord":[102.02244049169511,38.497330414886164]},{"name":"éæ³å¸","coord":[95.94486678270127,40.56891536586272]},{"name":"æµ·è¥¿èå¤æèæèª","coord":[94.67143298050689,36.022725148503724]},{"name":"å·´é³é­æ¥èå¤èªæ²»","coord":[88.18116214759745,39.556478810319916]},{"name":"åå¯å°åº","coord":[93.84302392518026,42.95015211178875]},{"name":"å¶é²çªå°åº","coord":[89.82035217277885,42.399368632283505]},{"name":"ä¹é²æ¨é½å¸","coord":[88.00048109561487,43.549986370786]},{"name":"é¿åæ³°å°åº","coord":[88.11213933257655,47.05593413019629]},{"name":"åå°å¡æèå¤èªæ²»","coord":[82.26402238163408,44.671135542630864]},{"name":"ä¼çåè¨åèªæ²»å·","coord":[82.80778717477179,43.53783381365267]},{"name":"é¿æåç","coord":[103.29923966842289,40.10955801781495]},{"name":"æ­¦å¨å¸","coord":[102.73362058791429,37.94211141321436]},{"name":"å°å·å¸","coord":[103.73793563506032,36.27379827886003]},{"name":"ä¸­å«å¸","coord":[105.6943786030716,37.20654236148948]},{"name":"é¶å·å¸","coord":[106.20022174140034,38.52103167597483]},{"name":"ç³å´å±±å¸","coord":[106.41544011793628,38.84054137571417]},{"name":"ä¹æµ·å¸","coord":[106.8984175998405,39.54616572239788]},{"name":"éå°å¤æ¯å¸","coord":[108.43285571424619,39.24036799350715]},{"name":"å·´å½¦æ·å°å¸","coord":[107.45840392808307,41.30159860424196]},{"name":"åå¤´å¸","coord":[110.46472193224272,41.48017783644221]},{"name":"å¼åæµ©ç¹å¸","coord":[111.48365173603975,40.498363056149884]},{"name":"ä¹å°å¯å¸å¸","coord":[112.61568977597707,41.75789561273154]},{"name":"å¤§åå¸","coord":[113.7107192749083,39.898956799744184]},{"name":"æå·å¸","coord":[112.65428748167508,39.681772914701924]},{"name":"å¿»å·å¸","coord":[112.36127575589583,38.88990233614568]},{"name":"æ¦æå¸","coord":[109.68473112169593,38.19921027134876]},{"name":"å»¶å®å¸","coord":[109.52425222161318,36.406522726136814]},{"name":"åºé³å¸","coord":[107.73052193155061,36.183821532624464]},{"name":"åºåå¸","coord":[106.20191575442442,36.11634909496382]},{"name":"ç½é¶å¸","coord":[104.68634478137065,36.51582865625868]},{"name":"å®é¸¡å¸","coord":[107.33534779230747,34.3387216485855]},{"name":"æ±ä¸­å¸","coord":[107.03534754266246,33.00142998064871]},{"name":"å¹¿åå¸","coord":[105.92928137563939,32.21872447205537]},{"name":"å·´ä¸­å¸","coord":[107.03422410306194,31.99874720836291]},{"name":"ååå¸","coord":[106.32964805032347,31.156657700184095]},{"name":"ç»µé³å¸","coord":[104.58949560201106,31.88628780630976]},{"name":"å¾·é³å¸","coord":[104.41542984932845,31.110558133718676]},{"name":"æé½å¸","coord":[103.8852290010473,30.777258040348634]},{"name":"é¿åèæç¾æèªæ²»","coord":[102.26209319552814,32.45725845387284]},{"name":"å®åº·å¸","coord":[109.14236501848015,32.77467694678074]},{"name":"åå °å¸","coord":[110.39934083416314,32.376209039347906]},{"name":"è¥é³å¸","coord":[111.97539147094662,31.93399822417465]},{"name":"å®æå¸","coord":[111.22204852395754,30.772457669035354]},{"name":"æ©æ½å¸","coord":[109.42158366502872,30.260366574390105]},{"name":"å¼ å®¶çå¸","coord":[110.59760006538717,29.330107409240718]},{"name":"åé¦å¸","coord":[109.72176899848378,28.681903937242495]},{"name":"éä»å°åº","coord":[108.54247523485463,28.11736237519646]},{"name":"éåºå¸","coord":[107.86007108564992,30.186253395053196]},{"name":"æåå¸","coord":[109.94325166787243,27.43919084801186]},{"name":"çé³å¸","coord":[112.43060358108062,28.75127294553697]},{"name":"å¨åºå¸","coord":[111.41891416951897,27.696312460064604]},{"name":"å¸¸å¾·å¸","coord":[111.72571610131646,29.27189463838195]},{"name":"èå·å¸","coord":[112.65896596965268,30.05161542755362]},{"name":"èé¨å¸","coord":[112.6586855902184,31.01267124474617]},{"name":"å²³é³å¸","coord":[113.2595036144316,29.106247116930163]},{"name":"é¿æ²å¸","coord":[113.15415586456598,28.222934680488425]},{"name":"æ¹æ½­å¸","coord":[112.51092596317824,27.69881544105668]},{"name":"æ ªå·å¸","coord":[113.49665538546823,27.03993794610501]},{"name":"è¡¡é³å¸","coord":[112.48849636578527,26.783613569970782]},{"name":"éµé³å¸","coord":[110.6723832117475,26.81652287086792]},{"name":"æ°¸å·å¸","coord":[111.8565364154186,25.768488267811968]},{"name":"é¶å³å¸","coord":[113.53420325850979,24.69848878771937]},{"name":"æ å·å¸","coord":[114.32029589634925,23.25504544231892]},{"name":"ä½å±±å¸","coord":[112.95925897403649,23.10116677189257]},{"name":"äºæµ®å¸","coord":[111.78042514904234,22.840400494105687]},{"name":"æ·±å³å¸","coord":[114.13138648919008,22.649563063468342]},{"name":"æ±å°¾å¸","coord":[115.57412892884373,23.06989642104901]},{"name":"æ²³æºå¸","coord":[114.89746229844398,23.97971937124767]},{"name":"æ­é³å¸","coord":[116.04290004239446,23.304802704715357]},{"name":"æ±å¤´å¸","coord":[116.7008461897183,23.35898625947344]},{"name":"æ½®å·å¸","coord":[116.75405548481658,23.854381508863064]},{"name":"æ¢å·å¸","coord":[116.13719397345734,24.15633544812716]},{"name":"æ¼³å·å¸","coord":[117.38279760543345,24.41111215459575]},{"name":"å¦é¨å¸","coord":[118.04275971554665,24.675908246507944]},{"name":"é¾å²©å¸","coord":[116.69341144552507,25.20284542644492]},{"name":"æ³å·å¸","coord":[118.12035864630246,25.22984144365049]},{"name":"èç°å¸","coord":[118.82439690138142,25.439653480972687]},{"name":"ç¦å·å¸","coord":[119.1608285845262,25.99117532466728]},{"name":"ä¸æå¸","coord":[117.51188176216434,26.318292906961602]},{"name":"åå¹³å¸","coord":[118.16153136678187,27.306303151805437]},{"name":"æå·å¸","coord":[116.3455359885574,27.487043655935366]},{"name":"é¹°æ½­å¸","coord":[117.01082360702333,28.241253742969946]},{"name":"åå®å¸","coord":[114.91377151807418,26.957486660664525]},{"name":"èµ£å·å¸","coord":[115.046455717572,25.81565075681663]},{"name":"é´å·å¸","coord":[113.1544526703492,25.871927095452524]},{"name":"æ°ä½å¸","coord":[114.94161795877827,27.79044654578371]},{"name":"å®æ¥å¸","coord":[115.04574494880995,28.306428044943356]},{"name":"åæå¸","coord":[115.9963824234495,28.664803351584705]},{"name":"ä¹æ±å¸","coord":[115.53225905704193,29.362905920276297]},{"name":"ä¸é¥¶å¸","coord":[117.8595355766598,28.765755150094634]},{"name":"æ¯å¾·éå¸","coord":[117.25387030721845,29.33426823662448]},{"name":"é»å±±å¸","coord":[117.85476357809696,29.969632034273722]},{"name":"æ± å·å¸","coord":[117.34517113140791,30.208089337922335]},{"name":"ééµå¸","coord":[117.93160431300694,30.926442655001676]},{"name":"å®åºå¸","coord":[116.54307680610799,30.524265461641296]},{"name":"é»ç³å¸","coord":[115.02354597728443,29.924060229331015]},{"name":"å¸å®å¸","coord":[114.26967602231792,29.652174021136048]},{"name":"é»åå¸","coord":[115.2859016705373,30.65856897065683]},{"name":"æ­¦æ±å¸","coord":[114.34552076948799,30.68836237966767]},{"name":"éå·å¸","coord":[113.3850627838818,31.87891659924412]},{"name":"ä¿¡é³å¸","coord":[114.81374730587638,32.0309685135914]},{"name":"é©»é©¬åºå¸","coord":[114.07756451509235,32.896720987266114]},{"name":"åæ´å¸","coord":[109.82044421310393,33.77403373563189]},{"name":"è¥¿å®å¸","coord":[109.11839808451401,34.225257215515896]},{"name":"æ¸­åå¸","coord":[109.75732444226935,35.025913644359306]},{"name":"éå·å¸","coord":[108.98695328111377,35.19235092947735]},{"name":"å¸é³å¸","coord":[108.36398776446165,34.84311348287181]},{"name":"ä¸é¨å³¡å¸","coord":[110.80049688104964,34.31818709571671]},{"name":"è¿åå¸","coord":[111.1736679525165,35.19010372283576]},{"name":"æ´é³å¸","coord":[111.87577573098216,34.33379926109848]},{"name":"å¹³é¡¶å±±å¸","coord":[112.80931281928427,33.759895800153096]},{"name":"æ¼¯æ²³å¸","coord":[113.83505724178012,33.70034266174508]},{"name":"è®¸æå¸","coord":[113.78762484088509,34.051835688452435]},{"name":"éå·å¸","coord":[113.49619951867594,34.61181797865449]},{"name":"ç¦ä½å¸","coord":[113.13404280173008,35.134167097471625]},{"name":"æåå¸","coord":[112.7495732073233,35.63186423091449]},{"name":"é¿æ²»å¸","coord":[112.85900842873183,36.45872910742828]},{"name":"ä¸´æ±¾å¸","coord":[111.49379787924448,36.22810800777857]},{"name":"å¤ªåå¸","coord":[112.15628804033796,37.91704444063036]},{"name":"åæ¢å¸","coord":[111.31901105774872,37.712740463356496]},{"name":"æä¸­å¸","coord":[113.08199599739676,37.36532613794343]},{"name":"é¯é¸å¸","coord":[114.41824047234618,36.530119932543315]},{"name":"å®é³å¸","coord":[113.88883283163116,35.7797611183252]},{"name":"é¹¤å£å¸","coord":[114.3654094911545,35.75770487428472]},{"name":"æ°ä¹¡å¸","coord":[113.9184107718167,35.348471214026716]},{"name":"å¼å°å¸","coord":[114.52801677500626,34.61371216679872]},{"name":"å¨å£å¸","coord":[114.88509782391864,33.69999759722657]},{"name":"éé³å¸","coord":[115.44595951398213,32.98060371610532]},{"name":"æ·®åå¸","coord":[116.68941991880993,32.79972275772595]},{"name":"èå å¸","coord":[117.38594715783302,33.106729536033896]},{"name":"æ·®åå¸","coord":[116.69651711889378,33.69527529383458]},{"name":"å®¿å·å¸","coord":[117.30175405886838,33.943330421260015]},{"name":"äº³å·å¸","coord":[116.12410804185097,33.46769392946132]},{"name":"åä¸å¸","coord":[115.59575176872548,34.28339840831147]},{"name":"èæ³½å¸","coord":[115.53631974831816,35.197319393220624]},{"name":"æ¿®é³å¸","coord":[115.3070485514902,35.775883510964334]},{"name":"èåå¸","coord":[115.8870069012884,36.40529594548765]},{"name":"é¢å°å¸","coord":[114.74259008644859,37.251396750084155]},{"name":"ç³å®¶åºå¸","coord":[114.56923838363613,38.13141710980106]},{"name":"é³æ³å¸","coord":[113.39216149668508,38.09075470547468]},{"name":"ä¿å®å¸","coord":[115.261524468934,39.09118520781398]},{"name":"è¡¡æ°´å¸","coord":[115.8182936677897,37.715661598187154]},{"name":"å¾·å·å¸","coord":[116.4582273790399,37.19372347888644]},{"name":"æ²§å·å¸","coord":[116.76192710911863,38.20240042039232]},{"name":"å»åå¸","coord":[116.50410772133856,39.27896741763884]},{"name":"å¤©æ´¥å¸","coord":[117.31988934444873,39.37154482470619]},{"name":"åäº¬å¸","coord":[116.59734730757869,40.237112944270976]},{"name":"å¼ å®¶å£å¸","coord":[115.1823606483226,40.83732566607167]},{"name":"åå±±å¸","coord":[117.8693184261954,39.71862889477249]},{"name":"ç§¦çå²å¸","coord":[119.30467355367742,39.990574652162564]},{"name":"æ¿å¾·å¸","coord":[117.16275671911026,41.36623845548547]},{"name":"è«è¦å²å¸","coord":[119.9342336210531,40.5628822626519]},{"name":"æé³å¸","coord":[120.11853493535794,41.471852354885755]},{"name":"èµ¤å³°å¸","coord":[118.50943546234379,43.25452976059767]},{"name":"é¦å·å¸","coord":[121.5167549323861,41.45933087433065]},{"name":"è¥å£å¸","coord":[122.58571915054674,40.42093503997384]},{"name":"ä¸¹ä¸å¸","coord":[124.33549382902183,40.46369290272115]},{"name":"è¾½é³å¸","coord":[123.34064798039414,41.152331397771356]},{"name":"çé¦å¸","coord":[122.06718005354679,41.05573599862555]},{"name":"éæ°å¸","coord":[121.93889757908204,42.27641773244204]},{"name":"éå±±å¸","coord":[122.78904432242356,40.77781183142038]},{"name":"æ²é³å¸","coord":[122.99508899709724,42.1162195010079]},{"name":"éå²­å¸","coord":[124.23100515588399,42.72666083611828]},{"name":"æ¶é¡ºå¸","coord":[124.46027188217573,41.82955407638859]},{"name":"éè¾½å¸","coord":[122.0729370657937,43.90889130864869]},{"name":"å´å®ç","coord":[120.79456431092532,45.92003249442161]},{"name":"ç½åå¸","coord":[123.10619907715235,45.25475749267784]},{"name":"é½é½åå°å¸","coord":[124.5462214659102,47.55395009317394]},{"name":"å¤§å´å®å²­å°åº","coord":[124.50992855161529,52.18438447846694]},{"name":"é»æ²³å¸","coord":[127.14721400335922,49.25080134026901]},{"name":"å¤§åºå¸","coord":[124.40329830095243,46.401048760966745]},{"name":"ç»¥åå¸","coord":[126.5214484055605,46.76992452194825]},{"name":"æ¾åå¸","coord":[124.21244334807682,44.75779381338502]},{"name":"åå¹³å¸","coord":[124.27839350328821,43.52139065090318]},{"name":"éåå¸","coord":[125.67392830706305,41.91771808663852]},{"name":"è¾½æºå¸","coord":[125.33529527643432,42.758340204944986]},{"name":"åæå¸","coord":[126.83350281902375,43.60730120049175]},{"name":"é¿æ¥å¸","coord":[125.53597875970374,44.24624314701737]},{"name":"ç½å±±å¸","coord":[127.16780160322108,42.093893880305075]},{"name":"åå°æ»¨å¸","coord":[127.39125008786029,45.36200668820575]},{"name":"é¹¤å²å¸","coord":[130.4703811258197,47.66520688940109]},{"name":"ä¼æ¥å¸","coord":[128.91240831703635,47.93833794565277]},{"name":"ä¸å°æ²³å¸","coord":[131.2677920224311,45.945099776108584]},{"name":"é¸¡è¥¿å¸","coord":[132.38059153660274,45.722934218318535]},{"name":"åé¸­å±±å¸","coord":[132.3184817002743,46.65813679030265]},{"name":"ä½³æ¨æ¯å¸","coord":[132.26174446608726,47.17569713691394]},{"name":"å¼ä¼¦è´å°å¸","coord":[122.3210739998419,50.18176996070858]},{"name":"å­æå¸","coord":[113.83749892135485,31.11757234692128]},{"name":"è´µæ¸¯å¸","coord":[110.07354588052804,23.380735604767374]},{"name":"é»åå¸ä¾æèæèª","coord":[107.30931767543106,26.2976919432269]},{"name":"å®å¾·å¸","coord":[119.52482556634342,27.013151692716413]},{"name":"æ¸©å·å¸","coord":[120.30037042732202,27.8699145504001]},{"name":"å°å·å¸","coord":[120.88886782713843,28.670799172772313]},{"name":"ä¸½æ°´å¸","coord":[119.56796851966463,28.170268394477755]},{"name":"è¡¢å·å¸","coord":[118.79479802644406,28.865874397158763]},{"name":"éåå¸","coord":[119.99381920686633,29.093455548185744]},{"name":"ç»å´å¸","coord":[120.46546691682343,29.69382513836818]},{"name":"å®æ³¢å¸","coord":[121.42142987830871,29.70001162878972]},{"name":"æ­å·å¸","coord":[119.4405685790891,29.87218307296989]},{"name":"å®£åå¸","coord":[118.68748382914703,30.628143499626418]},{"name":"æ¹å·å¸","coord":[119.98261306633574,30.7945175862809]},{"name":"åå´å¸","coord":[120.83889215988998,30.67538495499343]},{"name":"ä¸æµ·å¸","coord":[121.37534147322967,31.25628247908459]},{"name":"èå·å¸","coord":[120.6906182622391,31.381280695137775]},{"name":"æ é¡å¸","coord":[120.32182300914366,31.54113306724517]},{"name":"å¸¸å·å¸","coord":[119.61953292830165,31.611878565375576]},{"name":"åäº¬å¸","coord":[118.71890548838064,31.910863187910323]},{"name":"éæ±å¸","coord":[119.42349332902813,31.97942313430778]},{"name":"åè¥å¸","coord":[117.30651975617157,31.79407863049138]},{"name":"å­å®å¸","coord":[116.24668220575353,31.820846193819513]},{"name":"æ»å·å¸","coord":[117.88422385307969,32.51792621904418]},{"name":"æ³°å·å¸","coord":[120.03124303305091,32.56503102346783]},{"name":"åéå¸","coord":[120.85599446760912,32.18496706099728]},{"name":"çåå¸","coord":[120.01812490612667,33.54219948734023]},{"name":"æ·®å®å¸","coord":[119.0749424205415,33.39203631772854]},{"name":"å®¿è¿å¸","coord":[118.45404943216346,33.666258719120265]},{"name":"å¾å·å¸","coord":[117.77482249295966,34.30847766157078]},{"name":"æµå®å¸","coord":[116.74147276546373,35.27488504351119]},{"name":"æ£åºå¸","coord":[117.43359942491492,34.884162021736]},{"name":"è¿äºæ¸¯å¸","coord":[119.01553213785074,34.54316517587849]},{"name":"ä¸´æ²å¸","coord":[118.31478835349617,35.28173079028279]},{"name":"æ¥ç§å¸","coord":[119.14265350444272,35.54479073199592]},{"name":"éå²å¸","coord":[120.27779044405756,36.3464117375903]},{"name":"å¨æµ·å¸","coord":[122.12963327195605,37.13879077904251]},{"name":"çå°å¸","coord":[120.7689567423966,37.19772002195597]},{"name":"æ½åå¸","coord":[119.02178548592039,36.49292234053931]},{"name":"æ·åå¸","coord":[117.92936024367185,36.60871347163638]},{"name":"æ³°å®å¸","coord":[116.93810893944303,36.0423330118612]},{"name":"æµåå¸","coord":[117.34560282551296,36.769574973846304]},{"name":"ä¸è¥å¸","coord":[118.4915054457184,37.52194690335787]},{"name":"æ»¨å·å¸","coord":[117.67610299757533,37.4439597758601]},{"name":"ææå¸","coord":[102.93100245594789,25.481300763922075]},{"name":"çæºªå¸","coord":[102.23080854291823,24.156168324611663]},{"name":"å¡åå°åº","coord":[83.60908162840168,45.3721852373893]},{"name":"å¼ æå¸","coord":[100.47710030600572,38.704239320458385]},{"name":"åé³å¸","coord":[112.1400670951149,33.03033276715801]},{"name":"æ¬å·å¸","coord":[119.48949608990988,32.80956776339646]},{"name":"å»¶è¾¹æé²æèªæ²»å·","coord":[129.3577692895626,43.24968794080283]},{"name":"ç¡ä¸¹æ±å¸","coord":[129.87240796405672,44.7073040108322]},{"name":"æ¾³é¨","coord":[113.56289691515346,22.14602596262204]},{"name":"å´å¿ å¸","coord":[106.76894508116403,37.72566765880316]},{"name":"æ¥å®¾å¸","coord":[109.25592217010114,23.86346274681084]},{"name":"å¹³åå¸","coord":[107.0708132782897,35.30329631658711]},{"name":"é©¬éå±±å¸","coord":[118.27245878467022,31.657727937739004]},{"name":"èæ¹å¸","coord":[118.32992684415504,31.081688223101658]},{"name":"æ¾è¿å¿","coord":[110.04198076060266,19.694955078668105]},{"name":"ä¿äº­é»æèæèªæ²»","coord":[109.6055304964257,18.6101488675304]},{"name":"ä¹ä¸é»æèªæ²»å¿","coord":[109.04051999525574,18.643137437909203]},{"name":"åå·å¸","coord":[109.3431358337404,19.550974957403195]},{"name":"å®å®å¿","coord":[110.38744429685676,19.47557074114284]},{"name":"å±¯æå¿","coord":[110.00574767630334,19.367175093044388]},{"name":"ç½æ²é»æèªæ²»å¿","coord":[109.36860737761768,19.214416393082217]},{"name":"ç¼ä¸­é»æèæèªæ²»","coord":[109.86691465937548,19.073671135862682]},{"name":"ä¸æ¹å¸","coord":[108.86903802405428,19.017352815445214]},{"name":"ææ±é»æèªæ²»å¿","coord":[108.9686431884767,19.182594167127824]},{"name":"æµ·å£å¸","coord":[110.420654296875,19.806565564640795]},{"name":"æµæºå¸","coord":[112.38051465474433,35.07958362422394]},{"name":"äºæå±±å¸","coord":[109.53595187364496,18.832908264613966]},{"name":"å¤§è¿å¸","coord":[121.96662235866603,39.444150542439914]},{"name":"ææå¸ä¸æ²å¸","coord":[110.81828537536748,19.756501444162936]},{"name":"ä¸äºå¸","coord":[109.38424600793707,18.39186315877128]},{"name":"ä¸å®å¸","coord":[110.28485046979574,18.860240588635115]},{"name":"éµæ°´é»æèªæ²»å¿","coord":[109.95577603229562,18.594712684620465]},{"name":"ä¸´é«å¿","coord":[109.71915395436967,19.79420403032508]},{"name":"ç¼æµ·å¸","coord":[110.41650700703043,19.22315873149372]}]');
;// CONCATENATED MODULE: ./src/openlayers/mapping/webmap/config/SampleDataInfo.json
const SampleDataInfo_namespaceObject = JSON.parse('[{"id":"SalesJan2009","fileName":"SalesJan2009","xField":"Longitude","yField":"Latitude","type":"POINT"},{"id":"Sacramentorealestatetransactions","fileName":"Ealestate transactions","xField":"longitude","yField":"latitude","type":"POINT"},{"id":"BeijingResidentialDistrict","fileName":"åäº¬å¸ä½å®å°åº","xField":"SmX","yField":"SmY","type":"POINT"},{"id":"GlobalRecordOfOver7Earthquakes","fileName":"å¨çåå²7çº§ä»¥ä¸å°éè®°å½","xField":"ç»åº¦","yField":"çº¬åº¦","type":"POINT"},{"id":"ChinaRecordOfOver6Earthquakes","fileName":"ä¸­å½åå²6çº§ä»¥ä¸å°éè®°å½","xField":"ç»åº¦","yField":"çº¬åº¦","type":"POINT"},{"id":"ChinaMeteorologicalObservationStation","fileName":"ä¸­å½æ°è±¡è§æµç«","xField":"ç»åº¦","yField":"çº¬åº¦","type":"POINT"},{"id":"BeijingSubwayLine","fileName":"åäº¬å¸å°éäº¤éçº¿è·¯","type":"LINE"},{"id":"ChinaEarthquakeIntensityZone","fileName":"ä¸­å½å°éçåº¦åºåé¢","type":"POLYGON"}]');
;// CONCATENATED MODULE: external "ol.View"
const external_ol_View_namespaceObject = ol.View;
var external_ol_View_default = /*#__PURE__*/__webpack_require__.n(external_ol_View_namespaceObject);
;// CONCATENATED MODULE: external "ol.interaction.MouseWheelZoom"
const external_ol_interaction_MouseWheelZoom_namespaceObject = ol.interaction.MouseWheelZoom;
var external_ol_interaction_MouseWheelZoom_default = /*#__PURE__*/__webpack_require__.n(external_ol_interaction_MouseWheelZoom_namespaceObject);
;// CONCATENATED MODULE: external "ol.proj.proj4"
const external_ol_proj_proj4_namespaceObject = ol.proj.proj4;
;// CONCATENATED MODULE: external "ol.proj.Units"
const external_ol_proj_Units_namespaceObject = ol.proj.Units;
var external_ol_proj_Units_default = /*#__PURE__*/__webpack_require__.n(external_ol_proj_Units_namespaceObject);
;// CONCATENATED MODULE: external "ol.layer"
const external_ol_layer_namespaceObject = ol.layer;
;// CONCATENATED MODULE: external "ol.format.WMTSCapabilities"
const external_ol_format_WMTSCapabilities_namespaceObject = ol.format.WMTSCapabilities;
var external_ol_format_WMTSCapabilities_default = /*#__PURE__*/__webpack_require__.n(external_ol_format_WMTSCapabilities_namespaceObject);
;// CONCATENATED MODULE: external "ol.format.WMSCapabilities"
const external_ol_format_WMSCapabilities_namespaceObject = ol.format.WMSCapabilities;
var external_ol_format_WMSCapabilities_default = /*#__PURE__*/__webpack_require__.n(external_ol_format_WMSCapabilities_namespaceObject);
;// CONCATENATED MODULE: external "ol.geom"
const external_ol_geom_namespaceObject = ol.geom;
;// CONCATENATED MODULE: external "ol.source.TileWMS"
const external_ol_source_TileWMS_namespaceObject = ol.source.TileWMS;
var external_ol_source_TileWMS_default = /*#__PURE__*/__webpack_require__.n(external_ol_source_TileWMS_namespaceObject);
;// CONCATENATED MODULE: external "ol.render.Feature"
const external_ol_render_Feature_namespaceObject = ol.render.Feature;
var external_ol_render_Feature_default = /*#__PURE__*/__webpack_require__.n(external_ol_render_Feature_namespaceObject);
;// CONCATENATED MODULE: external "ol.Collection"
const external_ol_Collection_namespaceObject = ol.Collection;
var external_ol_Collection_default = /*#__PURE__*/__webpack_require__.n(external_ol_Collection_namespaceObject);
;// CONCATENATED MODULE: ./src/openlayers/mapping/WebMap.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/














// eslint-disable-line import/extensions
// eslint-disable-line import/extensions
// eslint-disable-line import/extensions





























window.proj4 = lib;
window.Proj4js = lib;
//æ°æ®è½¬æ¢å·¥å·
const transformTools = new (external_ol_format_GeoJSON_default())();
// è¿å¾å¾æå¤§æ¯æè¦ç´ æ°é
const MAX_MIGRATION_ANIMATION_COUNT = 1000;
//ä¸ååæ ç³»åä½ãè®¡ç®å¬å¼ä¸­çå¼
const metersPerUnit = {
    DEGREES: 2 * Math.PI * 6370997 / 360,
    DEGREE: 2 * Math.PI * 6370997 / 360,
    FEET: 0.3048,
    METERS: 1,
    METER: 1,
    M: 1,
    USFEET: 1200 / 3937
};
const dpiConfig = {
    default: 96, // å¸¸ç¨dpi
    iServerWMTS: 90.7142857142857 // iserverä½¿ç¨çwmtså¾å±dpi
}
/**
 * @class WebMap
 * @category  iPortal/Online Resources Map
 * @classdesc å¯¹æ¥ iPortal/Online å°å¾ç±»
 * @param {Object} options - åæ°
 * @param {string} [options.target='map'] - å°å¾å®¹å¨id
 * @param {Object | string} [options.webMap] - webMapå¯¹è±¡ï¼æèæ¯è·åwebMapçurlå°åãå­å¨webMapï¼ä¼åä½¿ç¨webMap, idçéé¡¹åä¼è¢«å¿½ç¥
 * @param {number} [options.id] - å°å¾çid
 * @param {string} [options.server="https://www.supermapol.com"] - å°å¾çå°åï¼å¦æä½¿ç¨ä¼ å¥idï¼serveråä¼åidæ¼æ¥æwebMapè¯·æ±å°å
 * @param {function} [options.successCallback] - æåå è½½å°å¾åè°ç¨çå½æ°
 * @param {function} [options.errorCallback] - å è½½å°å¾å¤±è´¥è°ç¨çå½æ°
 * @param {string} [options.credentialKey] - å­è¯å¯é¥ãä¾å¦ä¸º"key"ã"token"ï¼æèç¨æ·èªå®ä¹çå¯é¥ãç¨æ·ç³è¯·äºå¯é¥ï¼æ­¤åæ°å¿å¡«
 * @param {string} [options.credentialValue] - å­è¯å¯é¥å¯¹åºçå¼ï¼credentialKeyåcredentialValueå¿é¡»ä¸èµ·ä½¿ç¨
 * @param {boolean} [options.withCredentials=false] - è¯·æ±æ¯å¦æºå¸¦ cookie
 * @param {boolean} [options.excludePortalProxyUrl] - serverä¼ éè¿æ¥çurlæ¯å¦å¸¦æä»£ç
 * @param {Object} [options.serviceProxy] - iportalåç½®ä»£çä¿¡æ¯, ä»ç¢éç¦çå¾å±ä¸å¾æä¼ä½¿ç¨
 * @param {string} [options.tiandituKey] - å¤©å°å¾çkey
 * @param {string} [options.googleMapsAPIKey] - è°·æ­åºå¾éè¦çkey
 * @param {string} [options.proxy] - ä»£çå°åï¼å½ååä¸ä¸è´ï¼è¯·æ±ä¼å ä¸ä»£çãé¿åè·¨å
 * @param {string} [options.tileFormat] - å°å¾ç¦çåºå¾æ ¼å¼ï¼png/webp
 * @param {Object} [options.mapSetting] - å°å¾å¯éåæ°
 * @param {function} [options.mapSetting.mapClickCallback] - å°å¾è¢«ç¹å»çåè°å½æ°
 * @param {function} [options.mapSetting.overlays] - å°å¾çoverlays
 * @param {function} [options.mapSetting.controls] - å°å¾çæ§ä»¶
 * @param {function} [options.mapSetting.interactions] - å°å¾æ§å¶çåæ°
 * @extends {ol.Observable}
 * @usage
 */
class WebMap extends (external_ol_Observable_default()) {

    constructor(id, options) {
        super();
        if (core_Util_Util.isObject(id)) {
            options = id;
            this.mapId = options.id;
        } else {
            this.mapId = id;
        }
        options = options || {};
        this.server = options.server;
        this.successCallback = options.successCallback;
        this.errorCallback = options.errorCallback;
        this.credentialKey = options.credentialKey;
        this.credentialValue = options.credentialValue;
        this.withCredentials = options.withCredentials || false;
        this.target = options.target || "map";
        this.excludePortalProxyUrl = options.excludePortalProxyUrl || false;
        this.serviceProxy = options.serviceProxy || null;
        this.tiandituKey = options.tiandituKey;
        this.googleMapsAPIKey = options.googleMapsAPIKey || '';
        this.proxy = options.proxy;
        //è®¡æ°å å å¾å±ï¼å¤çè¿çæ°éï¼æååå¤±è´¥é½ä¼è®¡æ°ï¼
        this.layerAdded = 0;
        this.layers = [];
        this.events = new Events(this, null, ["updateDataflowFeature"], true);
        this.webMap = options.webMap;
        this.tileFormat = options.tileFormat && options.tileFormat.toLowerCase();
        this.createMap(options.mapSetting);
        if (this.webMap) {
            // webmapæå¯è½æ¯urlå°åï¼æå¯è½æ¯webmapå¯¹è±¡
            core_Util_Util.isString(this.webMap) ? this.createWebmap(this.webMap) : this.getMapInfoSuccess(options.webMap);
        } else {
            if (!this.server) {
                this.server = 'https://www.supermapol.com';
            }
            this.createWebmap();
        }
    }

    /**
     * @private
     * @function WebMap.prototype._removeBaseLayer
     * @description ç§»é¤åºå¾
     */
    _removeBaseLayer() {
        const map = this.map;
        const {layer, labelLayer} = this.baseLayer;
        // ç§»é¤å¤©å°å¾æ ç­¾å¾å±
        labelLayer && map.removeLayer(labelLayer);
        // ç§»é¤å¾å±
        layer && map.removeLayer(layer);
        this.baseLayer = null;
    }

    /**
     * @private
     * @function WebMap.prototype._removeLayers
     * @description ç§»é¤å å å¾å±
     */
    _removeLayers() {
        const map = this.map;
        this.layers.forEach(({layerType, layer, labelLayer, pathLayer, dataflowService}) => {
            if (!layer) {
                return;
            }
            if (layerType === 'MIGRATION') {
                layer.remove();
                return;
            }
            if (layerType === 'DATAFLOW_POINT_TRACK' || layerType === 'DATAFLOW_HEAT') {
                // ç§»é¤è½¨è¿¹å¾å±
                pathLayer && map.removeLayer(pathLayer);
                // åæ¶è®¢é
                dataflowService && dataflowService.unSubscribe();
            }
            // ç§»é¤æ ç­¾å¾å±
            labelLayer && map.removeLayer(labelLayer);
            // ç§»é¤å¾å±
            map.removeLayer(layer)
        });
        this.layers = [];
    }

    /**
     * @private
     * @function WebMap.prototype.clear
     * @description æ¸ç©ºå°å¾
     */
    _clear() {
        // æ¯ä¾å°º
        this.scales = [];
        // åè¾¨ç
        this.resolutionArray = [];
        // æ¯ä¾å°º-åè¾¨ç {scale: resolution}
        this.resolutions = {};
        // è®¡æ°å å å¾å±ï¼å¤çè¿çæ°éï¼æååå¤±è´¥é½ä¼è®¡æ°ï¼
        this.layerAdded = 0;

        this._removeBaseLayer();
        this._removeLayers();
    }

    /**
     * @function WebMap.prototype.refresh
     * @version 10.1.0
     * @description éæ°æ¸²æå°å¾
     */
    refresh() {
        this._clear();
        this.createWebmap();
    }

    /**
     * @private
     * @function WebMap.prototype.createMap
     * @description åå»ºå°å¾å¯¹è±¡ä»¥åæ³¨åå°å¾äºä»¶
     * @param {Object} mapSetting - å³äºå°å¾çè®¾ç½®ä»¥åéè¦æ³¨åçäºä»¶
     */
    createMap(mapSetting) {
        let overlays, controls, interactions;
        if (mapSetting) {
            interactions = mapSetting.interactions;
            overlays = mapSetting.overlays;
            controls = mapSetting.controls;
        }
        this.map = new (external_ol_Map_default())({
            interactions: interactions,
            overlays: overlays,
            controls: controls,
            target: this.target
        });
        mapSetting && this.registerMapEvent({
            mapClickCallback: mapSetting.mapClickCallback
        });
    }
    /**
     * @private
     * @function WebMap.prototype.registerMapEvent
     * @description æ³¨åå°å¾äºä»¶
     * @param {Object} mapSetting - å³äºå°å¾çè®¾ç½®ä»¥åéè¦æ³¨åçäºä»¶
     */
    registerMapEvent(mapSetting) {
        let map = this.map;
        map.on("click", function (evt) {
            mapSetting.mapClickCallback && mapSetting.mapClickCallback(evt);
        });
    }
    /**
     * @private
     * @function WebMap.prototype.createWebmap
     * @description åå»ºwebmap
     * @param {string} webMapUrl - è¯·æ±webMapçå°å
     */
    createWebmap(webMapUrl) {
        let mapUrl;
        if (webMapUrl) {
            mapUrl = webMapUrl;
        } else {
            let urlArr = this.server.split('');
            if (urlArr[urlArr.length - 1] !== '/') {
                this.server += '/';
            }
            mapUrl = this.server + 'web/maps/' + this.mapId + '/map';
            let filter = 'getUrlResource.json?url=';
            if (this.excludePortalProxyUrl && this.server.indexOf(filter) > -1) {
                //å¤§å±éæ±,æèæå ä¸ä»£çç
                let urlArray = this.server.split(filter);
                if (urlArray.length > 1) {
                    mapUrl = urlArray[0] + filter + this.server + 'web/maps/' + this.mapId + '/map.json';
                }
            }
        }
        this.getMapInfo(mapUrl);
    }

    /**
     * @private
     * @function WebMap.prototype.getMapInfo
     * @description è·åå°å¾çjsonä¿¡æ¯
     * @param {string} url - è¯·æ±å°å¾çurl
     */
    getMapInfo(url) {
        let that = this,
            mapUrl = url;
        if (url.indexOf('.json') === -1) {
            //ä¼ éè¿æ¥çurl,æ²¡æåæ¬.json,å¨è¿éå ä¸ã
            mapUrl = `${url}.json`
        }
        FetchRequest.get(that.getRequestUrl(mapUrl), null, {
            withCredentials: this.withCredentials
        }).then(function (response) {
            return response.json();
        }).then(function (mapInfo) {
            that.getMapInfoSuccess(mapInfo);
        }).catch(function (error) {
            that.errorCallback && that.errorCallback(error, 'getMapFaild', that.map);
        });
    }

    /**
     * @private
     * @function WebMap.prototype.getMapInfoSuccess
     * @description è·åå°å¾çjsonä¿¡æ¯
     * @param {Object} mapInfo - webMapå¯¹è±¡
     */
    async getMapInfoSuccess(mapInfo) {
        let that = this;
        if (mapInfo.succeed === false) {
            that.errorCallback && that.errorCallback(mapInfo.error, 'getMapFaild', that.map);
            return;
        }
        let handleResult = await that.handleCRS(mapInfo.projection, mapInfo.baseLayer.url);

        //å­å¨å°å¾çåç§°ä»¥åæè¿°ç­ä¿¡æ¯ï¼è¿åç»ç¨æ·
        that.mapParams = {
            title: mapInfo.title,
            description: mapInfo.description
        };

        if (handleResult.action === "BrowseMap") {
            that.createSpecLayer(mapInfo);
        } else if (handleResult.action === "OpenMap") {
            that.baseProjection = handleResult.newCrs || mapInfo.projection;
            that.webMapVersion = mapInfo.version;
            that.baseLayer = mapInfo.baseLayer;
            // that.mapParams = {
            //     title: mapInfo.title,
            //     description: mapInfo.description
            // }; //å­å¨å°å¾çåç§°ä»¥åæè¿°ç­ä¿¡æ¯ï¼è¿åç»ç¨æ·
            that.isHaveGraticule = mapInfo.grid && mapInfo.grid.graticule;

            if (mapInfo.baseLayer && mapInfo.baseLayer.layerType === 'MAPBOXSTYLE') {
                // æ·»å ç¢éç¦çæå¡ä½ä¸ºåºå¾
                that.addMVTMapLayer(mapInfo, mapInfo.baseLayer, 0).then(() => {
                    that.createView(mapInfo);
                    if (!mapInfo.layers || mapInfo.layers.length === 0) {
                        that.sendMapToUser(0);
                    } else {
                        that.addLayers(mapInfo);
                    }
                    that.addGraticule(mapInfo);
                }).catch(function (error) {
                    that.errorCallback && that.errorCallback(error, 'getMapFaild', that.map);
                });
            } else {
                await that.addBaseMap(mapInfo);
                if (!mapInfo.layers || mapInfo.layers.length === 0) {
                    that.sendMapToUser(0);
                } else {
                    that.addLayers(mapInfo);
                }
                that.addGraticule(mapInfo);
            }
        } else {
            // ä¸æ¯æçåæ ç³»
            that.errorCallback && that.errorCallback({type: "Not support CS", errorMsg: `Not support CS: ${mapInfo.projection}`}, 'getMapFaild', that.map);
            return;
        }
    }

    /**
    * å¤çåæ ç³»(åºå¾)
    * @private
    * @param {string} crs å¿ä¼ åæ°ï¼å¼æ¯webmap2ä¸­å®ä¹çåæ ç³»ï¼å¯è½æ¯ 1ãEGSG:xxx 2ãWKT string
    * @param {string} baseLayerUrl  å¯éåæ°ï¼å°å¾çæå¡å°åï¼ç¨äºEPSGï¼-1 çæ¶åï¼ç¨äºè¯·æ±iServeræä¾çwkt
    * @return {Object}
    */
    async handleCRS(crs, baseLayerUrl) {
        let that = this, handleResult = {};
        let newCrs = crs, action = "OpenMap";

        if (this.isCustomProjection(crs)) {
            // å»iServerè¯·æ±wkt  å¦ååªè½é¢è§åºå¾
            await FetchRequest.get(that.getRequestUrl(`${baseLayerUrl}/prjCoordSys.wkt`), null, {
                withCredentials: that.withCredentials,
                withoutFormatSuffix: true
            }).then(function (response) {
                return response.text();
            }).then(async function (result) {
                if(result.indexOf("<!doctype html>") === -1) {
                    that.addProjctionFromWKT(result, crs);
                    handleResult = {action, newCrs};
                } else {
                    throw 'ERROR';
                }
            }).catch(function () {
                action = "BrowseMap";
                handleResult = {action, newCrs}
            });
        } else {
            if (crs.indexOf("EPSG") === 0 && crs.split(":")[1] <= 0) {
                // èªå®ä¹åæ ç³» rest map EPSG:-1(èªå®ä¹åæ ç³») æ¯æç¼è¾
                // æªç¥åæ ç³»æåµç¹æ®å¤çï¼åªæ¯æé¢è§ 1ãrest map EPSG:-1000(æ²¡å®ä¹åæ ç³»)  2ãwms/wmts EPSG:0 ï¼èªå®ä¹åæ ç³»ï¼
                action = "BrowseMap";
            } else if (crs === 'EPSG:910111' || crs === 'EPSG:910112') {
                // æ©ææ°æ®å­å¨çèªå®ä¹åæ ç³»  "EPSG:910111": "GCJ02MERCATOR"ï¼ "EPSG:910112": "BDMERCATOR"
                newCrs = "EPSG:3857";
            } else if (crs === 'EPSG:910101' || crs === 'EPSG:910102') {
                // æ©ææ°æ®å­å¨çèªå®ä¹åæ ç³» "EPSG:910101": "GCJ02", "EPSG:910102": "BD",
                newCrs = "EPSG:4326";
            } else if (crs.indexOf("EPSG") !== 0) {
                // wkt
                that.addProjctionFromWKT(newCrs);
                newCrs = that.getEpsgInfoFromWKT(crs);
            }
            handleResult = {action, newCrs};
        }
        return handleResult;
    }

    /**
     * @private
     * @function WebMap.prototype.getScales
     * @description æ ¹æ®çº§å«è·åæ¯ä¸ªçº§å«å¯¹åºçåè¾¨ç
     * @param {Object} baseLayerInfo - åºå¾çå¾å±ä¿¡æ¯
     */
    getScales(baseLayerInfo) {
        let scales = [], resolutions = {}, res, scale, resolutionArray = [],
            coordUnit = baseLayerInfo.coordUnit || external_ol_proj_namespaceObject.get(baseLayerInfo.projection).getUnits();
        if (!coordUnit) {
            coordUnit = this.baseProjection == "EPSG:3857" ? "m" : "degree";
        }
        if (baseLayerInfo.visibleScales && baseLayerInfo.visibleScales.length > 0) {
            //åºé¨è®¾ç½®è¿åºå®æ¯ä¾å°ºï¼åä½¿ç¨è®¾ç½®ç
            baseLayerInfo.visibleScales.forEach(scale => {
                let value = 1 / scale;
                res = this.getResFromScale(value, coordUnit);
                scale = `1:${value}`;
                //å¤æ­¤ä¸ä¸¾è½¬æ¢ï¼å ä¸ºtoLocalStringä¼èªå¨ä¿çå°æ°ç¹åä¸ä½ï¼andå½ç¬¬äºä½å°æ°æ¯0å°±ä¼ä¿å­å°æ°ç¹åä¸¤ä½ãææä¸ºäºç»ä¸ã
                resolutions[this.formatScale(scale)] = res;
                resolutionArray.push(res);
                scales.push(scale);
            }, this)
        } else if (baseLayerInfo.layerType === 'WMTS') {
            baseLayerInfo.scales.forEach(scale => {
                res = this.getResFromScale(scale, coordUnit, 90.7);
                scale = `1:${scale}`;
                //å¤æ­¤ä¸ä¸¾è½¬æ¢ï¼å ä¸ºtoLocalStringä¼èªå¨ä¿çå°æ°ç¹åä¸ä½ï¼andå½ç¬¬äºä½å°æ°æ¯0å°±ä¼ä¿å­å°æ°ç¹åä¸¤ä½ãææä¸ºäºç»ä¸ã
                resolutions[this.formatScale(scale)] = res;
                resolutionArray.push(res);
                scales.push(scale);
            }, this)
        } else {
            let {minZoom = 0, maxZoom = 22} = baseLayerInfo, view = this.map.getView();
            for (let i = minZoom; i <= maxZoom; i++) {
                res = view.getResolutionForZoom(i);
                scale = this.getScaleFromRes(res, coordUnit);
                if (scales.indexOf(scale) === -1) {
                    //ä¸æ·»å éå¤çæ¯ä¾å°º
                    scales.push(scale);
                    let attr = scale.replace(/,/g, "");
                    resolutions[attr] = res;
                    resolutionArray.push(res);
                }
            }
        }
        this.scales = scales;
        this.resolutions = resolutions;
        this.resolutionArray = resolutionArray;
    }
    /**
     * @private
     * @function WebMap.prototype.getResFromScale
     * @description å°æ¯ä¾å°ºè½¬æ¢ä¸ºåè¾¨ç
     * @param {number} scale - æ¯ä¾å°º
     * @param {string} coordUnit - æ¯ä¾å°ºåä½
     * @param {number} dpi
     */
    getResFromScale(scale, coordUnit = "DEGREE", dpi = 96) {
        let mpu = metersPerUnit[coordUnit.toUpperCase()];
        return scale * .0254 / dpi / mpu;
    }
    /**
     * @private
     * @function WebMap.prototype.getScaleFromRes
     * @description å°åè¾¨çè½¬æ¢ä¸ºæ¯ä¾å°º
     * @param {number} resolution - åè¾¨ç
     * @param {string} coordUnit - æ¯ä¾å°ºåä½
     * @param {number} dpi
     */
    getScaleFromRes(resolution, coordUnit = "DEGREE", dpi = 96) {
        let scale, mpu = metersPerUnit[coordUnit.toUpperCase()];
        scale = resolution * dpi * mpu / .0254;
        return '1:' + scale;
    }
    /**
    * @private
    * @function WebMap.prototype.formatScale
    * @description å°æåä½ç¬¦çæ°å­è½¬ä¸ºæ®éæ°å­ãä¾å¦ï¼1,234 => 1234
    * @param {number} scale - æ¯ä¾å°ºåæ¯
    */
    formatScale(scale) {
        return scale.replace(/,/g, "");
    }
    /**
     * @private
     * @function WebMap.prototype.createSpecLayer
     * @description åå»ºåæ ç³»ä¸º0å-1000çå¾å±
     * @param {Object} mapInfo - å°å¾ä¿¡æ¯
     */
    createSpecLayer(mapInfo) {
        let me = this,
            baseLayerInfo = mapInfo.baseLayer,
            url = baseLayerInfo.url,
            baseLayerType = baseLayerInfo.layerType;
        let extent = [mapInfo.extent.leftBottom.x, mapInfo.extent.leftBottom.y, mapInfo.extent.rightTop.x, mapInfo.extent.rightTop.y];
        let proj = new external_ol_proj_namespaceObject.Projection({
            extent,
            units: 'm',
            code: 'EPSG:0'
        });
        external_ol_proj_namespaceObject.addProjection(proj);
        let options = {
            center: mapInfo.center,
            level: 0
        }
        //æ·»å view
        me.baseProjection = proj;
        let viewOptions = {
            center: options.center ? [options.center.x, options.center.y] : [0, 0],
            zoom: 0,
            projection: proj
        }
        if (['4', '5'].indexOf(core_Util_Util.getOlVersion()) < 0) { // å¼å®¹ ol 4ï¼5ï¼6
            viewOptions.multiWorld = true;
        }
        let view = new (external_ol_View_default())(viewOptions);
        me.map.setView(view);
        if (me.mapParams) {
            me.mapParams.extent = extent;
            me.mapParams.projection = mapInfo.projection;
        }
        if (url && url.indexOf("?token=") > -1) {
            //å¼å®¹iserverå°åætokençæåµ
            me.credentialKey = 'token';
            me.credentialValue = mapInfo.baseLayer.credential = url.split("?token=")[1];
            url = url.split("?token=")[0];
        }

        let source;
        if (baseLayerType === "TILE") {
            FetchRequest.get(me.getRequestUrl(`${url}.json`), null, {
                withCredentials: this.withCredentials
            }).then(function (response) {
                return response.json();
            }).then(function (result) {
                baseLayerInfo.originResult = result;
                let serverType = "IPORTAL", credential = baseLayerInfo.credential, keyfix = 'Token', keyParams = baseLayerInfo.url;
                if (baseLayerInfo.url.indexOf("www.supermapol.com") > -1 || baseLayerInfo.url.indexOf("itest.supermapol.com") > -1) {
                    keyfix = 'Key';
                    keyParams = [keyParams];
                    serverType = "ONLINE";
                }
                if (credential) {
                    SecurityManager[`register${keyfix}`](keyParams, credential);
                }
                let options = {
                    serverType,
                    url,
                    tileGrid: TileSuperMapRest.optionsFromMapJSON(url, result).tileGrid
                }
                if (url && !me.isSameDomain(url)) {
                    options.tileProxy = me.server + 'apps/viewer/getUrlResource.png?url=';
                }
                source = new TileSuperMapRest(options);
                me.addSpecToMap(source);
            }).catch(function (error) {
                me.errorCallback && me.errorCallback(error, 'getMapFaild', me.map);
            });
        } else if (baseLayerType === "WMS") {
            source = me.createWMSSource(baseLayerInfo);
            me.addSpecToMap(source);
        } else if (baseLayerType === "WMTS") {
            FetchRequest.get(me.getRequestUrl(url, true), null, {
                withCredentials: this.withCredentials
            }).then(function (response) {
                return response.text();
            }).then(function (capabilitiesText) {
                baseLayerInfo.extent = [mapInfo.extent.leftBottom.x, mapInfo.extent.leftBottom.y, mapInfo.extent.rightTop.x, mapInfo.extent.rightTop.y];
                baseLayerInfo.scales = me.getWMTSScales(baseLayerInfo.tileMatrixSet, capabilitiesText);
                baseLayerInfo.dpi = dpiConfig.iServerWMTS;
                source = me.createWMTSSource(baseLayerInfo);
                me.addSpecToMap(source);
            }).catch(function (error) {
                me.errorCallback && me.errorCallback(error, 'getMapFaild', me.map);
            })
        } else {
            me.errorCallback && me.errorCallback({type: "Not support CS", errorMsg: `Not support CS: ${baseLayerType}`}, 'getMapFaild', me.map);
        }
        view && view.fit(extent);
    }

    /**
     * @private
     * @function WebMap.prototype.addSpecToMap
     * @description å°åæ ç³»ä¸º0å-1000çå¾å±æ·»å å°å°å¾ä¸
     * @param {Object} mapInfo - å°å¾ä¿¡æ¯
     */
    addSpecToMap(source) {
        let layer = new external_ol_layer_namespaceObject.Tile({
            source: source,
            zIndex: 0
        });
        this.map.addLayer(layer);
        this.sendMapToUser(0);
    }
    /**
     * @private
     * @function WebMap.prototype.getWMTSScales
     * @description è·åwmtsçæ¯ä¾å°º
     * @param {Object} identifier - å¾å±å­å¨çæ è¯ä¿¡æ¯
     * @param {Object} capabilitiesText - wmtsä¿¡æ¯
     */
    getWMTSScales(identifier, capabilitiesText) {
        const format = new (external_ol_format_WMTSCapabilities_default())();
        let capabilities = format.read(capabilitiesText);

        let content = capabilities.Contents,
            tileMatrixSet = content.TileMatrixSet;
        let scales = [];
        for (let i = 0; i < tileMatrixSet.length; i++) {
            if (tileMatrixSet[i].Identifier === identifier) {
                for (let h = 0; h < tileMatrixSet[i].TileMatrix.length; h++) {
                    scales.push(tileMatrixSet[i].TileMatrix[h].ScaleDenominator)
                }
                break;
            }
        }
        return scales;
    }

    /**
     * @private
     * @function WebMap.prototype.addBaseMap
     * @description æ·»å åºå¾
     * @param {string} mapInfo - è¯·æ±å°å¾çurl
     */
    async addBaseMap(mapInfo) {
        let {baseLayer} = mapInfo, layerType = baseLayer.layerType;
        //åºå¾ï¼ä½¿ç¨é»è®¤çéç½®ï¼ä¸ç¨å­å¨ç
        if (layerType !== 'TILE' && layerType !== 'WMS' && layerType !== 'WMTS') {
            this.getInternetMapInfo(baseLayer);
        } else if (layerType === 'WMTS') {
            // éè¿è¯·æ±å®åä¿¡æ¯
            await this.getWmtsInfo(baseLayer);
        } else if (layerType === 'TILE') {
            await this.getTileInfo(baseLayer);
        } else if(layerType === 'WMS') {
            await this.getWmsInfo(baseLayer);
        }
        baseLayer.projection = mapInfo.projection;
        if (!baseLayer.extent) {
            baseLayer.extent = [mapInfo.extent.leftBottom.x, mapInfo.extent.leftBottom.y, mapInfo.extent.rightTop.x, mapInfo.extent.rightTop.y];
        }
        this.createView(mapInfo);
        let layer = this.createBaseLayer(baseLayer, 0, null, null, true);
        //åºå¾å¢å å¾å±ç±»åï¼DVåäº«éè¦ç¨å®æ¥è¯å«çæä¿¡æ¯
        layer.setProperties({
            layerType: layerType
        });
        this.map.addLayer(layer);

        if (this.mapParams) {
            this.mapParams.extent = baseLayer.extent;
            this.mapParams.projection = mapInfo.projection;
        }
        if (baseLayer.labelLayerVisible) {
            //å­å¨å¤©å°å¾è·¯ç½
            let labelLayer = new external_ol_layer_namespaceObject.Tile({
                source: this.createTiandituSource(baseLayer.layerType, mapInfo.projection, true),
                zIndex: baseLayer.zIndex || 1,
                visible: baseLayer.visible
            });
            this.map.addLayer(labelLayer);
            // æè½½å¸¦baseLayerä¸ï¼ä¾¿äºå é¤
            baseLayer.labelLayer = labelLayer;
        }
        this.limitScale(mapInfo, baseLayer);
    }

    validScale(scale) {
      if (!scale) {
          return false;
      }
      const scaleNum = scale.split(':')[1];
      if (!scaleNum) {
          return false;
      }
      const res = 1 / +scaleNum;
      if (res === Infinity || res >= 1) {
          return false;
      }
      return true;
  }

  limitScale(mapInfo, baseLayer) {
      if (this.validScale(mapInfo.minScale) && this.validScale(mapInfo.maxScale)) {
          let visibleScales, minScale, maxScale;
          if (baseLayer.layerType === 'WMTS') {
              visibleScales = baseLayer.scales;
              minScale = +mapInfo.minScale.split(':')[1];
              maxScale = +mapInfo.maxScale.split(':')[1];
          } else {
              const scales = this.scales.map((scale) => {
                  return 1 / scale.split(':')[1];
              });
              if (Array.isArray(baseLayer.visibleScales) && baseLayer.visibleScales.length && baseLayer.visibleScales) {
                visibleScales = baseLayer.visibleScales;
              } else {
                visibleScales = scales;
              }
              minScale = 1 / +mapInfo.minScale.split(':')[1];
              maxScale = 1 / +mapInfo.maxScale.split(':')[1];
          }
          const minVisibleScale = this.findNearest(visibleScales, minScale);
          const maxVisibleScale = this.findNearest(visibleScales, maxScale);
          let minZoom = visibleScales.indexOf(minVisibleScale);
          let maxZoom = visibleScales.indexOf(maxVisibleScale);
          if (minZoom > maxZoom) {
              [minZoom, maxZoom] = [maxZoom, minZoom];
          }
          if (minZoom !== 0 || maxZoom !== visibleScales.length - 1) {
              this.map.setView(
                  new (external_ol_View_default())(
                      Object.assign({}, this.map.getView().options_, {
                          maxResolution: undefined,
                          minResolution: undefined,
                          minZoom,
                          maxZoom,
                          constrainResolution: false
                      })
                  )
              );
              this.map.addInteraction(
                  new (external_ol_interaction_MouseWheelZoom_default())({
                      constrainResolution: true
                  })
              );
          }
      }
  }

  parseNumber(scaleStr) {
    return Number(scaleStr.split(":")[1])
  }

  findNearest(scales, target) {
    let resultIndex = 0
    let targetScaleD = target;
    for (let i = 1, len = scales.length; i < len; i++) {
      if (
        Math.abs(scales[i] - targetScaleD) <
        Math.abs(scales[resultIndex] - targetScaleD)
      ) {
        resultIndex = i
      }
    }
    return scales[resultIndex]
  }

    /**
     * @private
     * @function WebMap.prototype.addMVTMapLayer
     * @description æ·»å å°å¾æå¡mapboxstyleå¾å±
     * @param {Object} mapInfo - å°å¾ä¿¡æ¯
     * @param {Object} layerInfo - mapboxstyleå¾å±ä¿¡æ¯
     */
    addMVTMapLayer(mapInfo, layerInfo, zIndex) {
        layerInfo.zIndex = zIndex;
        // è·åå°å¾è¯¦ç»ä¿¡æ¯
        return this.getMapboxStyleLayerInfo(mapInfo, layerInfo).then((msLayerInfo) => {
            // åå»ºå¾å±
            return this.createMVTLayer(msLayerInfo).then(layer => {
                let layerID = core_Util_Util.newGuid(8);
                if (layerInfo.name) {
                    layer.setProperties({
                        name: layerInfo.name,
                        layerID: layerID,
                        layerType: 'VECTOR_TILE'
                    });
                }
                layerInfo.visibleScale && this.setVisibleScales(layer, layerInfo.visibleScale);
                //å¦åæ²¡æIDï¼å¯¹ä¸ä¸å·
                layerInfo.layer = layer;
                layerInfo.layerID = layerID;

                this.map.addLayer(layer);
            });
        }).catch(function (error){
            throw error;
        });
    }
    /**
     * @private
     * @function WebMap.prototype.createView
     * @description åå»ºå°å¾è§å¾
     * @param {Object} options - å³äºå°å¾çä¿¡æ¯
     */
    createView(options) {
        let oldcenter = options.center,
            zoom = options.level !== undefined ? options.level : 1,
            maxZoom = options.maxZoom || 22,
            extent,
            projection = this.baseProjection;
        let center = [];
        for (let key in oldcenter) {
            center.push(oldcenter[key]);
        }
        if (center.length === 0) {
            //å¼å®¹wms
            center = [0, 0];
        }
        //ä¸DVä¸è´ç¨åºå¾çé»è®¤èå´ï¼ä¸ç¨å­å¨çèå´ãå¦åä¼å¯¼è´å°å¾æä¸å¨
        this.baseLayerExtent = extent = options.baseLayer && options.baseLayer.extent;
        if (this.mapParams) {
            this.mapParams.extent = extent;
            this.mapParams.projection = projection;
        }
        //å½åä¸­å¿ç¹ä¸å¨extentå,å°±ç¨extentçä¸­å¿ç¹ todo
        !(0,external_ol_extent_namespaceObject.containsCoordinate)(extent, center) && (center = (0,external_ol_extent_namespaceObject.getCenter)(extent));

        // è®¡ç®å½åæå¤§åè¾¨ç
        let baseLayer = options.baseLayer;
        let maxResolution;
        if ((baseLayer.visibleScales && baseLayer.visibleScales.length > 0) || (baseLayer.scales && baseLayer.scales.length > 0)) {
            //åºå¾æåºå®æ¯ä¾å°ºï¼å°±ç´æ¥è·åãä¸ç¨viewè®¡ç®
            this.getScales(baseLayer);
        } else if (options.baseLayer && extent && extent.length === 4) {
            let width = extent[2] - extent[0];
            let height = extent[3] - extent[1];
            let maxResolution1 = width / 512;
            let maxResolution2 = height / 512;
            maxResolution = Math.max(maxResolution1, maxResolution2);
        }

        // if(options.baseLayer.visibleScales && options.baseLayer.visibleScales.length > 0){
        //     maxZoom = options.baseLayer.visibleScales.length;
        // }
        this.map.setView(new (external_ol_View_default())({ zoom, center, projection, maxZoom, maxResolution }));
        let viewOptions = {};

        if (baseLayer.scales && baseLayer.scales.length > 0 && baseLayer.layerType === "WMTS" ||
            this.resolutionArray && this.resolutionArray.length > 0) {
            viewOptions = { zoom, center, projection, resolutions: this.resolutionArray, maxZoom };
        } else if (baseLayer.layerType === "WMTS") {
            viewOptions = { zoom, center, projection, maxZoom };
            this.getScales(baseLayer);
        } else {
            viewOptions = { zoom, center, projection, maxResolution, maxZoom };
            this.getScales(baseLayer);
        }
        if (['4', '5'].indexOf(core_Util_Util.getOlVersion()) < 0) { // å¼å®¹ ol 4ï¼5ï¼6
            viewOptions.multiWorld = true;
            viewOptions.showFullExtent = true;
            viewOptions.enableRotation = false;
            viewOptions.constrainResolution = true; //è®¾ç½®æ­¤åæ°ï¼æ¯å ä¸ºéè¦æ¾ç¤ºæ´æ°çº§å«ãä¸ºäºå¯è§æ¯ä¾å°ºä¸­åå«å½åæ¯ä¾å°º
        }
        this.map.setView(new (external_ol_View_default())(viewOptions));

        if (options.visibleExtent) {
            const view = this.map.getView();
            const resolution = view.getResolutionForExtent(options.visibleExtent, this.map.getSize());
            view.setResolution(resolution);
            view.setCenter((0,external_ol_extent_namespaceObject.getCenter)(options.visibleExtent));
        }
    }
    /**
     * @private
     * @function WebMap.prototype.createBaseLayer
     * @description åå»ºç¢éå¾å±ï¼åæ¬åºå¾åå¶å å çç¢éå¾å±
     * @param {Object} layerInfo - å³äºå°å¾çä¿¡æ¯
     * @param {number} index - å½åå¾å±å¨å°å¾ä¸­çindex
     * @param {boolean} isCallBack - æ¯å¦è°ç¨åè°å½æ°
     * @param {scope} {Object} thiså¯¹è±¡
     */
    createBaseLayer(layerInfo, index, isCallBack, scope, isBaseLayer) {
        let source, that = this;

        if (scope) {
            // è§£å³å¼æ­¥åè°
            that = scope;
        }
        let layerType = layerInfo.layerType; //åºå¾årestå°å¾å¼å®¹
        if (layerType.indexOf('TIANDITU_VEC') > -1 || layerType.indexOf('TIANDITU_IMG') > -1 ||
            layerType.indexOf('TIANDITU_TER') > -1) {
            layerType = layerType.substr(0, 12);
        }
        switch (layerType) {
            case "TIANDITU_VEC":
            case "TIANDITU_IMG":
            case "TIANDITU_TER":
                source = this.createTiandituSource(layerType, layerInfo.projection);
                break;
            case "BAIDU":
                source = this.createBaiduSource();
                break;
            case 'BING':
                source = this.createBingSource(layerInfo, layerInfo.projection);
                break;
            case "WMS":
                source = this.createWMSSource(layerInfo);
                break;
            case "WMTS":
                source = that.createWMTSSource(layerInfo);
                break;
            case 'TILE':
            case 'SUPERMAP_REST':
                source = that.createDynamicTiledSource(layerInfo, isBaseLayer);
                break;
            case 'CLOUD':
            case 'CLOUD_BLACK':
            case 'OSM':
            case 'JAPAN_ORT':
            case 'JAPAN_RELIEF':
            case 'JAPAN_PALE':
            case 'JAPAN_STD':
            case 'GOOGLE_CN':
            case 'GOOGLE':
                source = this.createXYZSource(layerInfo);
                break;
            default:
                break;
        }
        var layer = new external_ol_layer_namespaceObject.Tile({
            source: source,
            zIndex: layerInfo.zIndex || 1,
            visible: layerInfo.visible
        });
        var layerID = core_Util_Util.newGuid(8);
        if (layerInfo.name) {
            layer.setProperties({
                name: layerInfo.name,
                layerID: layerID
            });
        }
        if (layerInfo.visible === undefined || layerInfo.visible === null) {
            layerInfo.visible = true;
        }
        layer.setVisible(layerInfo.visible);
        layerInfo.opacity && layer.setOpacity(layerInfo.opacity);
        //layerInfoæ²¡æå­å¨indexå±æ§
        index && layer.setZIndex(index);

        //å¦åæ²¡æIDï¼å¯¹ä¸ä¸å·
        layerInfo.layer = layer;
        layerInfo.layerID = layerID;

        let {visibleScale, autoUpdateTime} = layerInfo, minResolution, maxResolution;
        if (visibleScale) {
            maxResolution = this.resolutions[visibleScale.minScale];
            minResolution = this.resolutions[visibleScale.maxScale];
            //æ¯ä¾å°ºååå«çæ¯åæ¯çå³ç³»
            maxResolution > 1 ? layer.setMaxResolution(Math.ceil(maxResolution)) : layer.setMaxResolution(maxResolution * 1.1);
            layer.setMinResolution(minResolution);
        }
        if (autoUpdateTime && !layerInfo.autoUpdateInterval) {
            //èªå¨æ´æ°
            layerInfo.autoUpdateInterval = setInterval(() => {
                that.updateTileToMap(layerInfo, index);
            }, autoUpdateTime);
        }

        if (isCallBack) {
            layer.setZIndex(0); // wmts
            that.map.addLayer(layer);
        }

        return layer;
    }

    /**
     * @private
     * @function WebMap.prototype.updateTileToMap
     * @description è·ååºå¾å¯¹åºçå¾å±ä¿¡æ¯ï¼ä¸æ¯ç¨è¯·æ±åæ¥çåºå¾ä¿¡æ¯
     * @param {Object} layerInfo - å¾å±ä¿¡æ¯
     * @param {number} layerIndex - å¾å±index
     */
    updateTileToMap(layerInfo, layerIndex) {
        this.map.removeLayer(layerInfo.layer);
        this.map.addLayer(this.createBaseLayer(layerInfo, layerIndex));
    }

    /**
     * @private
     * @function WebMap.prototype.getInternetMapInfo
     * @description è·ååºå¾å¯¹åºçå¾å±ä¿¡æ¯ï¼ä¸æ¯ç¨è¯·æ±åæ¥çåºå¾ä¿¡æ¯
     * @param {Object} baseLayerInfo - åºå¾ä¿¡æ¯
     * @returns {Object} åºå¾çå·ä½ä¿¡æ¯
     */
    getInternetMapInfo(baseLayerInfo) {
        const baiduBounds = [-20037508.3427892, -20037508.3427892, 20037508.3427892, 20037508.3427892];
        const bounds_4326 = [-180, -90, 180, 90];
        const osmBounds = [-20037508.34, -20037508.34, 20037508.34, 20037508.34];
        const japanReliefBounds = [12555667.53929, 1281852.98656, 17525908.86651, 7484870.70596];
        const japanOrtBounds = [-19741117.14519, -10003921.36848, 19981677.71404, 19660983.56089];

        baseLayerInfo.units = "m";
        switch (baseLayerInfo.layerType) {
            case ('BAIDU'):
                baseLayerInfo.iServerUrl = 'https://map.baidu.com/';
                baseLayerInfo.epsgCode = 'EPSG:3857';
                baseLayerInfo.minZoom = 1;
                baseLayerInfo.maxZoom = 19;
                baseLayerInfo.level = 1;
                baseLayerInfo.extent = baiduBounds;
                // thumbnail: this.getImagePath('bmap.png') ææ¶ä¸ç¨å°ç¼©ç¥å¾
                break;
            case ('CLOUD'):
                baseLayerInfo.url = 'http://t2.dituhui.com/FileService/image?map=quanguo&type=web&x={x}&y={y}&z={z}';
                baseLayerInfo.epsgCode = 'EPSG:3857';
                baseLayerInfo.minZoom = 1;
                baseLayerInfo.maxZoom = 18;
                baseLayerInfo.level = 1;
                baseLayerInfo.extent = baiduBounds;
                break;
            case ('CLOUD_BLACK'):
                baseLayerInfo.url = 'http://t3.dituhui.com/MapService/getGdp?x={x}&y={y}&z={z}';
                baseLayerInfo.epsgCode = 'EPSG:3857';
                baseLayerInfo.minZoom = 1;
                baseLayerInfo.maxZoom = 18;
                baseLayerInfo.level = 1;
                baseLayerInfo.extent = baiduBounds;
                break;
            case ('tencent'):
                baseLayerInfo.epsgCode = 'EPSG:3857';
                baseLayerInfo.minZoom = 1;
                baseLayerInfo.maxZoom = 18;
                baseLayerInfo.level = 1;
                baseLayerInfo.extent = baiduBounds;
                break;
            case ('TIANDITU_VEC_3857'):
            case ('TIANDITU_IMG_3857'):
            case ('TIANDITU_TER_3857'):
                baseLayerInfo.iserverUrl = 'https://map.tianditu.gov.cn/';
                baseLayerInfo.epsgCode = 'EPSG:3857';
                baseLayerInfo.minZoom = 0;
                baseLayerInfo.maxZoom = 19;
                baseLayerInfo.level = 1;
                baseLayerInfo.extent = baiduBounds;
                if (baseLayerInfo.layerType === "TIANDITU_TER_3857") {
                    baseLayerInfo.maxZoom = 14;
                }
                break;
            case ('TIANDITU_VEC_4326'):
            case ('TIANDITU_IMG_4326'):
            case ('TIANDITU_TER_4326'):
                baseLayerInfo.iserverUrl = 'https://map.tianditu.gov.cn/';
                baseLayerInfo.epsgCode = 'EPSG:4326';
                baseLayerInfo.minZoom = 0;
                baseLayerInfo.maxZoom = 19;
                baseLayerInfo.level = 1;
                baseLayerInfo.extent = bounds_4326;
                if (baseLayerInfo.layerType === "TIANDITU_TER_4326") {
                    baseLayerInfo.maxZoom = 14;
                }
                break;
            case ('OSM'):
                baseLayerInfo.url = 'http://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png';
                baseLayerInfo.epsgCode = 'EPSG:3857';
                baseLayerInfo.minZoom = 1;
                baseLayerInfo.maxZoom = 19;
                baseLayerInfo.level = 1;
                baseLayerInfo.extent = osmBounds;
                baseLayerInfo.iserverUrl = 'https://www.openstreetmap.org';
                break;
            case ('GOOGLE'):
                baseLayerInfo.url = `https://maps.googleapis.com/maps/vt?pb=!1m5!1m4!1i{z}!2i{x}!3i{y}!4i256!2m3!1e0!2sm!3i540264686!3m12!2s${this.getLang()}!3sUS!5e18!12m4!1e68!2m2!1sset!2sRoadmap!12m3!1e37!2m1!1ssmartmaps!4e0&key=${this.googleMapsAPIKey}`;
                baseLayerInfo.epsgCode = 'EPSG:3857';
                baseLayerInfo.minZoom = 1;
                baseLayerInfo.maxZoom = 22;
                baseLayerInfo.level = 1;
                baseLayerInfo.extent = osmBounds;
                baseLayerInfo.iserverUrl = 'https://www.google.cn/maps';
                break;
            case ('JAPAN_STD'):
                baseLayerInfo.url = 'https://cyberjapandata.gsi.go.jp/xyz/std/{z}/{x}/{y}.png';
                baseLayerInfo.epsgCode = 'EPSG:3857';
                baseLayerInfo.minZoom = 1;
                baseLayerInfo.maxZoom = 19;
                baseLayerInfo.level = 0;
                baseLayerInfo.extent = osmBounds;
                break;
            case ('JAPAN_PALE'):
                baseLayerInfo.url = 'https://cyberjapandata.gsi.go.jp/xyz/pale/{z}/{x}/{y}.png';
                baseLayerInfo.epsgCode = 'EPSG:3857';
                baseLayerInfo.minZoom = 2;
                baseLayerInfo.maxZoom = 19;
                baseLayerInfo.level = 2;
                baseLayerInfo.extent = osmBounds;
                break;
            case ('JAPAN_RELIEF'):
                baseLayerInfo.url = 'https://cyberjapandata.gsi.go.jp/xyz/relief/{z}/{x}/{y}.png';
                baseLayerInfo.epsgCode = 'EPSG:3857';
                baseLayerInfo.minZoom = 5;
                baseLayerInfo.maxZoom = 14;
                baseLayerInfo.level = 5;
                baseLayerInfo.extent = japanReliefBounds;
                break;
            case ('JAPAN_ORT'):
                baseLayerInfo.url = 'https://cyberjapandata.gsi.go.jp/xyz/ort/{z}/{x}/{y}.jpg';
                baseLayerInfo.epsgCode = 'EPSG:3857';
                baseLayerInfo.minZoom = 2;
                baseLayerInfo.maxZoom = 12;
                baseLayerInfo.level = 2;
                baseLayerInfo.extent = japanOrtBounds;
                break;
        }
    }
    /**
     * @private
     * @function WebMap.prototype.createDynamicTiledSource
     * @description è·åsupermap iServerç±»åçå°å¾çsourceã
     * @param {Object} layerInfo
     * @param {boolean} isBaseLayer æ¯å¦æ¯åºå¾
     */
    createDynamicTiledSource(layerInfo, isBaseLayer) {
        let serverType = "IPORTAL",
            credential = layerInfo.credential ? layerInfo.credential.token : undefined,
            keyfix = 'Token',
            keyParams = layerInfo.url;

        if (layerInfo.url.indexOf("www.supermapol.com") > -1 || layerInfo.url.indexOf("itest.supermapol.com") > -1) {
            keyfix = 'Key';
            keyParams = [keyParams];
            serverType = "ONLINE";
        }
        if (credential) {
            SecurityManager[`register${keyfix}`](keyParams, credential);
        }
        // extent: isBaseLayer ? layerInfo.extent : ol.proj.transformExtent(layerInfo.extent, layerInfo.projection, this.baseProjection),
        let options = {
            transparent: true,
            url: layerInfo.url,
            wrapX: false,
            serverType: serverType,
            // crossOrigin: 'anonymous', //å¨IE11.0.9600çæ¬ï¼ä¼å½±åéè¿æ³¨åæå¡æå¼çiserverå°å¾ï¼ä¸åºå¾ãå ä¸ºæ²¡ææºå¸¦cookieä¼æ¥è·¨åé®é¢
            // extent: this.baseLayerExtent,
            // prjCoordSys: {epsgCode: isBaseLayer ? layerInfo.projection.split(':')[1] : this.baseProjection.split(':')[1]},
            format: layerInfo.format
        };
        if(!isBaseLayer && !this.isCustomProjection(this.baseProjection )){
            options.prjCoordSys = { epsgCode : this.baseProjection.split(':')[1]};
        }
        if (layerInfo.visibleScales && layerInfo.visibleScales.length > 0) {
            let visibleResolutions = [];
            for (let i in layerInfo.visibleScales) {
                let resolution = core_Util_Util.scaleToResolution(layerInfo.visibleScales[i], dpiConfig.default, layerInfo.coordUnit);
                visibleResolutions.push(resolution);
            }
            layerInfo.visibleResolutions = visibleResolutions;
            let tileGrid = new (external_ol_tilegrid_TileGrid_default())({
                extent: layerInfo.extent,
                resolutions: visibleResolutions
            });
            options.tileGrid = tileGrid;
        } else {
            options.extent = this.baseLayerExtent;
            //bug:ISVJ-2412,ä¸æ·»å ä¸åä»£ç åºä¸äºå¾ãåç§iserver ol3åºå¾æ¹å¼
            let tileGrid = new (external_ol_tilegrid_TileGrid_default())({
                extent: layerInfo.extent,
                resolutions: this.getResolutionsFromBounds(layerInfo.extent)
            });
            options.tileGrid = tileGrid;
        }
        //ä¸»æºåç¸åæ¶ä¸æ·»å ä»£ç,iportal geturlResourceä¸æ¯æwebpä»£ç
        if (layerInfo.url && !this.isSameDomain(layerInfo.url) && layerInfo.format !== 'webp') {
            options.tileProxy = this.server + 'apps/viewer/getUrlResource.png?url=';
        }
        let source = new TileSuperMapRest(options);
        SecurityManager[`register${keyfix}`](layerInfo.url);
        return source;
    }

    /**
    * @private
    * @function WebMap.prototype.getResolutionsFromBounds
    * @description è·åæ¯ä¾å°ºæ°ç»
    * @param {Array.<number>} bounds èå´æ°ç»
    * @returns {styleResolutions} æ¯ä¾å°ºæ°ç»
    */
    getResolutionsFromBounds(bounds) {
        let styleResolutions = [];
        let temp = Math.abs(bounds[0] - bounds[2]) / 512;
        for (let i = 0; i < 22; i++) {
            if (i === 0) {
                styleResolutions[i] = temp;
                continue;
            }
            temp = temp / 2;
            styleResolutions[i] = temp;
        }
        return styleResolutions;
    }

    /**
     * @private
     * @function WebMap.prototype.createTiandituSource
     * @description åå»ºå¤©å°å¾çsourceã
     * @param layerType å¾å±ç±»å
     * @param projection å°çåæ ç³»
     * @param isLabel  æ¯å¦æè·¯ç½å¾å±
     * @returns {Tianditu} å¤©å°å¾çsource
     */
    createTiandituSource(layerType, projection, isLabel) {
        let options = {
            layerType: layerType.split('_')[1].toLowerCase(),
            isLabel: isLabel || false,
            projection: projection,
            url: `https://t{0-7}.tianditu.gov.cn/{layer}_{proj}/wmts?tk=${this.tiandituKey}`
        };
        return new Tianditu(options);
    }
    /**
     * @private
     * @function WebMap.prototype.createBaiduSource
     * @description åå»ºç¾åº¦å°å¾çsourceã
     * @returns {BaiduMap} baiduå°å¾çsource
     */
    createBaiduSource() {
        return new BaiduMap()
    }
    /**
     * @private
     * @function WebMap.prototype.createBingSource
     * @description åå»ºbingå°å¾çsourceã
     * @returns {ol.source.XYZ} bingå°å¾çsource
     */
    createBingSource(layerInfo, projection) {
        let url = 'https://dynamic.t0.tiles.ditu.live.com/comp/ch/{quadKey}?it=G,TW,L,LA&mkt=zh-cn&og=109&cstl=w4c&ur=CN&n=z';
        return new (external_ol_source_XYZ_default())({
            wrapX: false,
            projection: projection,
            crossOrigin: 'anonymous',
            tileUrlFunction: function (coordinates) {
                let /*quadDigits = '', */[z, x, y] = [...coordinates];
                y = y > 0 ? y - 1 : -y - 1;
                let index = '';
                for (let i = z; i > 0; i--) {
                    let b = 0;
                    let mask = 1 << (i - 1);
                    if ((x & mask) !== 0) {
                        b++;
                    }
                    if ((y & mask) !== 0) {
                        b += 2;
                    }
                    index += b.toString()
                }
                return url.replace('{quadKey}', index);
            }
        })
    }

    /**
     * @private
     * @function WebMap.prototype.createXYZSource
     * @description åå»ºå¾å±çXYZsourceã
     * @param {Object} layerInfo - å¾å±ä¿¡æ¯
     * @returns {ol.source.XYZ} xyzçsource
     */
    createXYZSource(layerInfo) {
        return new (external_ol_source_XYZ_default())({
            url: layerInfo.url,
            wrapX: false,
            crossOrigin: 'anonymous'
        })
    }

    /**
     * @private
     * @function WebMap.prototype.createWMSSource
     * @description åå»ºwmså°å¾sourceã
     * @param {Object} layerInfo - å¾å±ä¿¡æ¯ã
     * @returns {ol.source.TileWMS} wmsçsource
     */
    createWMSSource(layerInfo) {
        let that = this;
        return new (external_ol_source_TileWMS_default())({
            url: layerInfo.url,
            wrapX: false,
            params: {
                LAYERS: layerInfo.layers ? layerInfo.layers[0] : "0",
                FORMAT: 'image/png',
                VERSION: layerInfo.version || "1.3.0"
            },
            projection: layerInfo.projection || that.baseProjection,
            tileLoadFunction: function (imageTile, src) {
                imageTile.getImage().src = src
            }
        })
    }

    /**
     * @private
     * @function WebMap.prototype.getTileLayerExtent
     * @description è·å(Supermap RestMap)çå¾å±åæ°ã
     * @param {Object} layerInfo - å¾å±ä¿¡æ¯ã
     * @param {function} callback - è·å¾tileå¾å±åæ°æ§è¡çåè°å½æ°
     * @param {function} failedCallback - å¤±è´¥åè°å½æ°
     */
    async getTileLayerExtent(layerInfo, callback, failedCallback) {
        let that = this;
        // é»è®¤ä½¿ç¨å¨ææå½±æ¹å¼è¯·æ±æ°æ®
        let dynamicLayerInfo = await that.getTileLayerExtentInfo(layerInfo)
        if (dynamicLayerInfo.succeed === false) {
            if (dynamicLayerInfo.error.code === 400) {
                // dynamicLayerInfo.error.code === 400 ä¸æ¯æå¨ææå½±ï¼è¯·æ±restmapåå§ä¿¡æ¯
                let originLayerInfo = await that.getTileLayerExtentInfo(layerInfo, false);
                if (originLayerInfo.succeed === false) {
                    failedCallback();
                } else {
                    Object.assign(layerInfo, originLayerInfo);
                    callback(layerInfo);
                }
            } else {
                failedCallback();
            }
        } else {
            Object.assign(layerInfo, dynamicLayerInfo);
            callback(layerInfo);
        }
    }

    /**
     * @private
     * @function WebMap.prototype.getTileLayerExtentInfo
     * @description è·årest mapçå¾å±åæ°ã
     * @param {Object} layerInfo - å¾å±ä¿¡æ¯ã
     * @param {boolean} isDynamic - æ¯å¦è¯·æ±å¨ææå½±ä¿¡æ¯
     */
    getTileLayerExtentInfo(layerInfo, isDynamic = true) {
        let that = this,
            token,
            url = layerInfo.url.trim(),
            credential = layerInfo.credential,
            options = {
                withCredentials: this.withCredentials,
                withoutFormatSuffix: true
            };
        if (isDynamic) {
            let projection = {
                epsgCode: that.baseProjection.split(":")[1]
            }
            if (!that.isCustomProjection(that.baseProjection)) {
                // bug IE11 ä¸ä¼èªå¨ç¼ç 
                url += '.json?prjCoordSys=' + encodeURI(JSON.stringify(projection));
            }
        }
        if (credential) {
            url = `${url}&token=${encodeURI(credential.token)}`;
            token = credential.token;
        }
        return FetchRequest.get(that.getRequestUrl(`${url}.json`), null, options).then(function (response) {
            return response.json();
        }).then(async (result) => {
            if (result.succeed === false) {
                return result
            }
            let format = 'png';
            if(that.tileFormat === 'webp') {
                const isSupportWebp = await that.isSupportWebp(layerInfo.url, token);
                format = isSupportWebp ? 'webp' : 'png';
            }
            return {
                units: result.coordUnit && result.coordUnit.toLowerCase(),
                coordUnit: result.coordUnit,
                visibleScales: result.visibleScales,
                extent: [result.bounds.left, result.bounds.bottom, result.bounds.right, result.bounds.top],
                projection: `EPSG:${result.prjCoordSys.epsgCode}`,
                format
            }
        }).catch((error) => {
            return {
                succeed: false,
                error: error
            }
        });
    }

    /**
     * @private
     * @function WebMap.prototype.getTileInfo
     * @description è·årest mapçå¾å±åæ°ã
     * @param {Object} layerInfo - å¾å±ä¿¡æ¯ã
     * @param {function} callback - è·å¾wmtså¾å±åæ°æ§è¡çåè°å½æ°
     */
    getTileInfo(layerInfo, callback, mapInfo) {
        let that = this;
        let options = {
            withCredentials: this.withCredentials,
            withoutFormatSuffix: true
        };
        if (layerInfo.url.indexOf("?token=") > -1) {
            that.credentialKey = 'token';
            that.credentialValue = layerInfo.credential = layerInfo.url.split("?token=")[1];
            layerInfo.url = layerInfo.url.split("?token=")[0];
        }
        return FetchRequest.get(that.getRequestUrl(`${layerInfo.url}.json`), null, options).then(function (response) {
            return response.json();
        }).then(async function (result) {
            // layerInfo.projection = mapInfo.projection;
            // layerInfo.extent = [mapInfo.extent.leftBottom.x, mapInfo.extent.leftBottom.y, mapInfo.extent.rightTop.x, mapInfo.extent.rightTop.y];
            // æ¯ä¾å°º åä½
            if(result && result.code && result.code !== 200) {
                throw result;
            }
            if (result.visibleScales) {
                layerInfo.visibleScales = result.visibleScales;
                layerInfo.coordUnit = result.coordUnit;
            }
            layerInfo.maxZoom = result.maxZoom;
            layerInfo.maxZoom = result.minZoom;
            let token = layerInfo.credential ? layerInfo.credential.token : undefined;
            layerInfo.format = 'png';
            // china_darkä¸ºé»è®¤åºå¾ï¼è¿æ¯ç¨pngåºå¾
            if(that.tileFormat === 'webp' && layerInfo.url !== 'https://maptiles.supermapol.com/iserver/services/map_China/rest/maps/China_Dark') {
                const isSupprtWebp = await that.isSupportWebp(layerInfo.url, token);
                layerInfo.format = isSupprtWebp ? 'webp' : 'png';
            }
            // è¯·æ±ç»æå®æ ç»§ç»­æ·»å å¾å±
            if (mapInfo) {
                //todo è¿ä¸ªè²ä¼¼æ²¡æç¨å°ï¼ä¸æ¬¡ä¼å
                callback && callback(mapInfo, null, true, that);
            } else {
                callback && callback(layerInfo);
            }

        }).catch(function (error) {
            that.errorCallback && that.errorCallback(error, 'getTileInfo', that.map)
        });
    }
    /**
     * @private
     * @function WebMap.prototype.getWMTSUrl
     * @description è·åwmtsè¯·æ±ææ¡£çurl
     * @param {string} url - å¾å±ä¿¡æ¯ã
     * @param {boolean} isKvp - æ¯å¦ä¸ºkvpæ¨¡å¼
     */
    getWMTSUrl(url, isKvp) {
        let splitStr = '?';
        if (url.indexOf('?') > -1) {
            splitStr = '&'
        }
        if (isKvp) {
            url += splitStr + 'SERVICE=WMTS&VERSION=1.0.0&REQUEST=GetCapabilities';
        } else {
            url += splitStr + '/1.0.0/WMTSCapabilities.xml';
        }
        return this.getRequestUrl(url, true);
    }

    /**
     * @private
     * @function WebMap.prototype.getWmtsInfo
     * @description è·åwmtsçå¾å±åæ°ã
     * @param {Object} layerInfo - å¾å±ä¿¡æ¯ã
     * @param {function} callback - è·å¾wmtså¾å±åæ°æ§è¡çåè°å½æ°
     */
    getWmtsInfo(layerInfo, callback) {
        let that = this;
        let options = {
            withCredentials: that.withCredentials,
            withoutFormatSuffix: true
        };
        const isKvp = !layerInfo.requestEncoding || layerInfo.requestEncoding === 'KVP';
        return FetchRequest.get(that.getWMTSUrl(layerInfo.url, isKvp), null, options).then(function (response) {
            return response.text();
        }).then(function (capabilitiesText) {
            const format = new (external_ol_format_WMTSCapabilities_default())();
            let capabilities = format.read(capabilitiesText);
            if (that.isValidResponse(capabilities)) {
                let content = capabilities.Contents,
                    tileMatrixSet = content.TileMatrixSet,
                    layers = content.Layer,
                    layer, idx, layerFormat, style = 'default';

                for (let n = 0; n < layers.length; n++) {
                    if (layers[n].Identifier === layerInfo.layer) {
                        idx = n;
                        layer = layers[idx];
                        layerFormat = layer.Format[0];
                        var layerBounds = layer.WGS84BoundingBox;
                        // tileMatrixSetLink = layer.TileMatrixSetLink;
                        break;
                    }
                }
                layer && layer.Style && layer.Style.forEach(value => {
                    if (value.isDefault) {
                        style = value.Identifier;
                    }
                });
                let scales = [], matrixIds = [];
                for (let i = 0; i < tileMatrixSet.length; i++) {
                    if (tileMatrixSet[i].Identifier === layerInfo.tileMatrixSet) {
                        let wmtsLayerEpsg = `EPSG:${tileMatrixSet[i].SupportedCRS.split('::')[1]}`;
                        for (let h = 0; h < tileMatrixSet[i].TileMatrix.length; h++) {
                            scales.push(tileMatrixSet[i].TileMatrix[h].ScaleDenominator);
                            matrixIds.push(tileMatrixSet[i].TileMatrix[h].Identifier);
                        }
                        //bug wmtsåºå¾éè¦å ä¸originï¼å¦åä¼åºç°åºå¾ä¸æ­£ç¡®çæåµãåç§»æèç¦çåºä¸äº
                        let origin = tileMatrixSet[i].TileMatrix[0].TopLeftCorner;
                        layerInfo.origin = ["EPSG:4326", "EPSG:4490"].indexOf(wmtsLayerEpsg) > -1 ? [origin[1], origin[0]] : origin;
                        break;
                    }
                }
                let name = layerInfo.name, extent;
                if (layerBounds) {
                    if (layerBounds[0] < -180) {
                        layerBounds[0] = -180;
                    }
                    if (layerBounds[1] < -90) {
                        layerBounds[1] = -90;
                    }
                    if (layerBounds[2] > 180) {
                        layerBounds[2] = 180;
                    }
                    if (layerBounds[3] > 90) {
                        layerBounds[3] = 90;
                    }
                    extent = external_ol_proj_namespaceObject.transformExtent(layerBounds, 'EPSG:4326', that.baseProjection);
                } else {
                    extent = external_ol_proj_namespaceObject.get(that.baseProjection).getExtent()
                }
                layerInfo.tileUrl = that.getTileUrl(capabilities.OperationsMetadata.GetTile.DCP.HTTP.Get, layer, layerFormat, isKvp);
                //å°éè¦çåæ°è¡¥ä¸
                layerInfo.extent = extent;
                layerInfo.name = name;
                layerInfo.orginEpsgCode = layerInfo.projection;
                layerInfo.overLayer = true;
                layerInfo.scales = scales;
                layerInfo.style = style;
                layerInfo.title = name;
                layerInfo.unit = "m";
                layerInfo.layerFormat = layerFormat;
                layerInfo.matrixIds = matrixIds;
                callback && callback(layerInfo);
            }
        }).catch(function (error) {
            that.errorCallback && that.errorCallback(error, 'getWmtsFaild', that.map)
        });
    }
    /**
     * @private
     * @function WebMap.prototype.getWmsInfo
     * @description è·åwmsçå¾å±åæ°ã
     * @param {Object} layerInfo - å¾å±ä¿¡æ¯ã
     */
    getWmsInfo(layerInfo) {
        let that = this;
        let url = layerInfo.url.trim();
        url += (url.indexOf('?') > -1 ? '&SERVICE=WMS&REQUEST=GetCapabilities' : '?SERVICE=WMS&REQUEST=GetCapabilities');
        let options = {
            withCredentials: that.withCredentials,
            withoutFormatSuffix: true
        };

        let promise = new Promise(function (resolve) {
            return FetchRequest.get(that.getRequestUrl(url, true), null, options).then(function (response) {
                return response.text();
            }).then(async function (capabilitiesText) {
                const format = new (external_ol_format_WMSCapabilities_default())();
                let capabilities = format.read(capabilitiesText);
                if (capabilities) {
                    let layers = capabilities.Capability.Layer.Layer, proj = layerInfo.projection;
                    layerInfo.subLayers = layerInfo.layers[0];
                    layerInfo.version = capabilities.version;
                    for (let i = 0; i < layers.length; i++) {
                        // å¾å±åæ¯å¯¹
                        if (layerInfo.layers[0] === layers[i].name) {
                            let layer = layers[i];
                            if (layer.bbox[proj]) {
                                let bbox = layer.bbox[proj].bbox;
                                // wmts 130 åæ è½´æ¯å¦ååï¼ç®åè¿æ æ³å¤æ­
                                // åç»­è¿éç»§ç»­å®åWKT å¢å åæ è½´æ¹åå¼
                                // ç®åwktä¿¡æ¯ æ¥èªhttps://epsg.io/
                                // æä¾åæ æ¹åå¼çç½ç«  å¦ï¼https://www.epsg-registry.org/export.htm?wkt=urn:ogc:def:crs:EPSG::4490
                                if ((layerInfo.version === "1.3.0" && layerInfo.projection === "EPSG:4326") || (layerInfo.version === "1.3.0" && layerInfo.projection === "EPSG:4490")) {
                                    layerInfo.extent = [bbox[1], bbox[0], bbox[3], bbox[2]];
                                } else {
                                    layerInfo.extent = bbox;
                                }
                                break;
                            }
                        }
                    }
                }
                resolve();
            }).catch(function (error) {
                that.errorCallback && that.errorCallback(error, 'getWMSFaild', that.map)
                resolve();
            })
        });
        return promise;
    }
    /**
     * @private
     * @function WebMap.prototype.getTileUrl
     * @description è·åwmtsçå¾å±åæ°ã
     * @param {Object} getTileArray - å¾å±ä¿¡æ¯ã
     * @param {string} layer - éæ©çå¾å±
     * @param {string} format - éæ©çåºå¾æ¹å¼
     * @param {boolean} isKvp - æ¯å¦æ¯kvpæ¹å¼
     */
    getTileUrl(getTileArray, layer, format, isKvp) {
        let url;
        if (isKvp) {
            getTileArray.forEach(data => {
                if (data.Constraint[0].AllowedValues.Value[0].toUpperCase() === 'KVP') {
                    url = data.href;
                }
            })
        } else {
            const reuslt = layer.ResourceURL.filter(resource => {
                return resource.format === format;
            })
            url = reuslt[0].template;
        }
        return url;
    }

    /**
     * @private
     * @function WebMap.prototype.createWMTSSource
     * @description è·åWMTSç±»åå¾å±çsourceã
     * @param {Object} layerInfo - å¾å±ä¿¡æ¯ã
     * @returns {ol.source.WMTS} wmtsçsouce
     */
    createWMTSSource(layerInfo) {
        let extent = layerInfo.extent || external_ol_proj_namespaceObject.get(layerInfo.projection).getExtent();

        // åä½éè¿åæ ç³»è·å ï¼PS: ä»¥åä»£ç é4326 é½é»è®¤æ¯ç±³ï¼
        let unit = external_ol_proj_namespaceObject.get(this.baseProjection).getUnits();
        return new (external_ol_source_WMTS_default())({
            url: layerInfo.tileUrl || layerInfo.url,
            layer: layerInfo.layer,
            format: layerInfo.layerFormat,
            style: layerInfo.style,
            matrixSet: layerInfo.tileMatrixSet,
            requestEncoding: layerInfo.requestEncoding || 'KVP',
            tileGrid: this.getWMTSTileGrid(extent, layerInfo.scales, unit, layerInfo.dpi, layerInfo.origin, layerInfo.matrixIds),
            tileLoadFunction: function (imageTile, src) {
                if (src.indexOf('tianditu.gov.cn') >= 0) {
                    imageTile.getImage().src = `${src}&tk=${Util.getParameters(layerInfo.url)['tk']}`;
                    return;
                }
                imageTile.getImage().src = src
            }
        })
    }

    /**
     * @private
     * @function WebMap.prototype.getWMTSTileGrid
     * @description è·åwmtsçç¦çã
     * @param {Object} extent - å¾å±èå´ã
     * @param {number} scales - å¾å±æ¯ä¾å°º
     * @param {string} unit - åä½
     * @param {number} dpi - dpi
     * @param {Array} origin ç¦ççåç¹
     * @returns {ol.tilegrid.WMTS} wmtsçç¦ç
     */
    getWMTSTileGrid(extent, scales, unit, dpi, origin, matrixIds) {
        let resolutionsInfo = this.getReslutionsFromScales(scales, dpi || dpiConfig.iServerWMTS, unit);
        return new (external_ol_tilegrid_WMTS_default())({
            origin,
            extent: extent,
            resolutions: resolutionsInfo.res,
            matrixIds: matrixIds || resolutionsInfo.matrixIds
        });
    }

    /**
     * @private
     * @function WebMap.prototype.getReslutionsFromScales
     * @description æ ¹æ®æ¯ä¾å°ºï¼æ¯ä¾å°ºåæ¯ï¼ãå°å¾åä½ãdpiãè·åä¸ä¸ªåè¾¨çæ°ç»
     * @param {Array.<number>} scales - æ¯ä¾å°ºï¼æ¯ä¾å°ºåæ¯ï¼
     * @param {number} dpi - å°å¾dpi
     * @param {string} unit - åä½
     * @param {number} datumAxis
     * @returns {{res: Array, matrixIds: Array}}
     */
    getReslutionsFromScales(scales, dpi, unit, datumAxis) {
        unit = (unit && unit.toLowerCase()) || 'degrees';
        dpi = dpi || dpiConfig.iServerWMTS;
        datumAxis = datumAxis || 6378137;
        let res = [],
            matrixIds = [];
        //ç»ä¸ªé»è®¤ç
        if (core_Util_Util.isArray(scales)) {
            scales && scales.forEach(function (scale, idx) {
                if (scale > 1.0) {
                    matrixIds.push(idx);
                    res.push(this.getResolutionFromScale(scale, dpi, unit, datumAxis));
                }
            }, this);
        } else {
            let tileMatrixSet = scales['TileMatrix'];
            tileMatrixSet && tileMatrixSet.forEach(function (tileMatrix) {
                matrixIds.push(tileMatrix['Identifier']);
                res.push(this.getResolutionFromScale(tileMatrix['ScaleDenominator'], dpi, unit, datumAxis));
            }, this);
        }
        return {
            res: res,
            matrixIds: matrixIds
        };
    }

    /**
     * @private
     * @function WebMap.prototype.getResolutionFromScale
     * @description è·åä¸ä¸ªWMTS sourceéè¦çtileGrid
     * @param {number} scale - æ¯ä¾å°ºï¼æ¯ä¾å°ºåæ¯ï¼
     * @param {number} dpi - å°å¾dpi
     * @param {string} unit - åä½
     * @param {number} datumAxis
     * @returns {{res: Array, matrixIds: Array}}
     */
    getResolutionFromScale(scale, dpi = dpiConfig.default, unit, datumAxis) {
        //radio = 10000;
        let res;
        scale = +scale;
        scale = (scale > 1.0) ? (1.0 / scale) : scale;
        if (unit === 'degrees' || unit === 'dd' || unit === 'degree') {
            res = 0.0254 * 10000 / dpi / scale / ((Math.PI * 2 * datumAxis) / 360) / 10000;
        } else {
            res = 0.0254 * 10000 / dpi / scale / 10000;
        }
        return res;

    }

    /**
     * @private
     * @function WebMap.prototype.isValidResponse
     * @description è¿åä¿¡æ¯æ¯å¦ç¬¦åå¯¹åºç±»åçæ å
     * @param {Object} response - è¿åçä¿¡æ¯
     * @returns {boolean}
     */
    isValidResponse(response) {
        let responseEnum = ['Contents', 'OperationsMetadata'],
            valid = true;
        for (let i = 0; i < responseEnum.length; i++) {
            if (!response[responseEnum[i]] || response.error) {
                valid = false;
                break;
            }
        }
        return valid;
    }

    /**
     * @private
     * @function WebMap.prototype.addLayers
     * @description æ·»å å å å¾å±
     * @param {Object} mapInfo - å°å¾ä¿¡æ¯
     */
    addLayers(mapInfo) {
        let layers = mapInfo.layers,
            that = this;
        let features = [],
            len = layers.length;
        if (len > 0) {
            //å­å¨å°å¾ä¸ææçå¾å±å¯¹è±¡
            this.layers = layers;
            layers.forEach(function (layer, index) {
                //å ä¸åºå¾çindex
                let layerIndex = index + 1,
                    dataSource = layer.dataSource,
                    isSampleData = dataSource && dataSource.type === "SAMPLE_DATA" && !!dataSource.name; //SAMPLE_DATAæ¯æ¬å°ç¤ºä¾æ°æ®
                if (layer.layerType === "MAPBOXSTYLE") {
                    that.addMVTMapLayer(mapInfo, layer, layerIndex).then(() => {
                        that.layerAdded++;
                        that.sendMapToUser(len);
                    }).catch(function (error) {
                        that.layerAdded++;
                        that.sendMapToUser(len);
                        that.errorCallback && that.errorCallback(error, 'getLayerFaild', that.map);
                    });
                } else if ((dataSource && dataSource.serverId) || layer.layerType === "MARKER" || layer.layerType === 'HOSTED_TILE' || isSampleData) {
                    //æ°æ®å­å¨å°iportalä¸äº
                    let dataSource = layer.dataSource,
                        serverId = dataSource ? dataSource.serverId : layer.serverId;
                    if (!serverId && !isSampleData) {
                        that.addLayer(layer, null, layerIndex);
                        that.layerAdded++;
                        that.sendMapToUser(len);
                        return;
                    }
                    if ((layer.layerType === "MARKER") || (dataSource && (!dataSource.accessType || dataSource.accessType === 'DIRECT')) || isSampleData) {
                        //åæ¥äºè¿å¶æä»¶
                        let url = isSampleData ? `${that.server}apps/dataviz/libs/sample-datas/${dataSource.name}.json` : `${that.server}web/datas/${serverId}/content.json?pageSize=9999999&currentPage=1`;
                        url = that.getRequestUrl(url);
                        FetchRequest.get(url, null, {
                            withCredentials: this.withCredentials
                        }).then(function (response) {
                            return response.json()
                        }).then(async function (data) {
                            if (data.succeed === false) {
                                //è¯·æ±å¤±è´¥
                                that.layerAdded++;
                                that.sendMapToUser(len);
                                that.errorCallback && that.errorCallback(data.error, 'getLayerFaild', that.map);
                                return;
                            }
                            if (data && data.type) {
                                if (data.type === "JSON" || data.type === "GEOJSON") {
                                    data.content = data.content.type ? data.content : JSON.parse(data.content);
                                    features = that.geojsonToFeature(data.content, layer);
                                } else if (data.type === 'EXCEL' || data.type === 'CSV') {
                                    if (layer.dataSource && layer.dataSource.administrativeInfo) {
                                        //è¡æ¿è§åä¿¡æ¯
                                        data.content.rows.unshift(data.content.colTitles);
                                        let {divisionType, divisionField} = layer.dataSource.administrativeInfo;
                                        let geojson = that.excelData2FeatureByDivision(data.content, divisionType, divisionField);
                                        features = that._parseGeoJsonData2Feature({allDatas: {features: geojson.features}, fileCode: layer.projection});
                                    } else {
                                        features = await that.excelData2Feature(data.content, layer);
                                    }
                                } else if (data.type === 'SHP') {
                                    let content = JSON.parse(data.content);
                                    data.content = content.layers[0];
                                    features = that.geojsonToFeature(data.content, layer);
                                }
                                that.addLayer(layer, features, layerIndex);
                                that.layerAdded++;
                                that.sendMapToUser(len);
                            }
                        }).catch(function (error) {
                            that.layerAdded++;
                            that.sendMapToUser(len);
                            that.errorCallback && that.errorCallback(error, 'getLayerFaild', that.map);
                        })
                    } else {
                        //å³ç³»åæä»¶
                        let isMapService = layer.layerType === 'HOSTED_TILE',
                            serverId = dataSource ? dataSource.serverId : layer.serverId;
                        that.checkUploadToRelationship(serverId).then(function (result) {
                            if (result && result.length > 0) {
                                let datasetName = result[0].name,
                                    featureType = result[0].type.toUpperCase();
                                that.getDataService(serverId, datasetName).then(function (data) {
                                    let dataItemServices = data.dataItemServices;
                                    if (dataItemServices.length === 0) {
                                        that.layerAdded++;
                                        that.sendMapToUser(len);
                                        that.errorCallback && that.errorCallback(null, 'getLayerFaild', that.map);
                                        return;
                                    }
                                    if (isMapService) {
                                        //éè¦å¤æ­æ¯ä½¿ç¨tileè¿æ¯mvtæå¡
                                        let dataService = that.getService(dataItemServices, 'RESTDATA');
                                        that.isMvt(dataService.address, datasetName).then(info => {
                                            that.getServiceInfoFromLayer(layerIndex, len, layer, dataItemServices, datasetName, featureType, info);
                                        }).catch(() => {
                                            //å¤æ­å¤±è´¥å°±èµ°ä¹åé»è¾ï¼>æ°æ®éç¨tile
                                            that.getServiceInfoFromLayer(layerIndex, len, layer, dataItemServices, datasetName, featureType);
                                        })
                                    } else {
                                        that.getServiceInfoFromLayer(layerIndex, len, layer, dataItemServices, datasetName, featureType);
                                    }
                                });
                            } else {
                                that.layerAdded++;
                                that.sendMapToUser(len);
                                that.errorCallback && that.errorCallback(null, 'getLayerFaild', that.map);
                            }
                        }).catch(function (error) {
                            that.layerAdded++;
                            that.sendMapToUser(len);
                            that.errorCallback && that.errorCallback(error, 'getLayerFaild', that.map);
                        })
                    }
                } else if (dataSource && dataSource.type === "USER_DATA") {
                    that.addGeojsonFromUrl(layer, len, layerIndex, false);
                } else if (layer.layerType === "TILE"){
                    that.getTileLayerExtent(layer, function (layerInfo) {
                        that.map.addLayer(that.createBaseLayer(layerInfo, layerIndex));
                        that.layerAdded++;
                        that.sendMapToUser(len);
                    }, function (e) {
                        that.layerAdded++;
                        that.sendMapToUser(len);
                        that.errorCallback && that.errorCallback(e, 'getLayerFaild', that.map);
                    })
                } else if (layer.layerType === 'SUPERMAP_REST' ||
                    layer.layerType === "WMS" ||
                    layer.layerType === "WMTS") {
                    if (layer.layerType === "WMTS") {
                        that.getWmtsInfo(layer, function (layerInfo) {
                            that.map.addLayer(that.createBaseLayer(layerInfo, layerIndex));
                            that.layerAdded++;
                            that.sendMapToUser(len);
                        })
                    } else if(layer.layerType === "WMS") {
                        that.getWmsInfo(layer).then(() => {
                            that.map.addLayer(that.createBaseLayer(layer, layerIndex));
                            that.layerAdded++;
                            that.sendMapToUser(len);
                        })
                    } else {
                        layer.projection = that.baseProjection;
                        that.map.addLayer(that.createBaseLayer(layer, layerIndex));
                        that.layerAdded++;
                        that.sendMapToUser(len);
                    }
                } else if (dataSource && dataSource.type === "REST_DATA") {
                    //ä»restDataè·åæ°æ®
                    that.getFeaturesFromRestData(layer, layerIndex, len);
                } else if (dataSource && dataSource.type === "REST_MAP" && dataSource.url) {
                    //ç¤ºä¾æ°æ®
                    queryFeatureBySQL(dataSource.url, dataSource.layerName, 'smid=1', null, null, function (result) {
                        var recordsets = result && result.result.recordsets;
                        var recordset = recordsets && recordsets[0];
                        var attributes = recordset.fields;
                        if (recordset && attributes) {
                            let fileterAttrs = [];
                            for (var i in attributes) {
                                var value = attributes[i];
                                if (value.indexOf('Sm') !== 0 || value === "SmID") {
                                    fileterAttrs.push(value);
                                }
                            }
                            that.getFeatures(fileterAttrs, layer, function (features) {
                                that.addLayer(layer, features, layerIndex);
                                that.layerAdded++;
                                that.sendMapToUser(len);
                            }, function (e) {
                                that.layerAdded++;
                                that.errorCallback && that.errorCallback(e, 'getFeatureFaild', that.map);
                            });
                        }
                    }, function (e) {
                        that.errorCallback && that.errorCallback(e, 'getFeatureFaild', that.map);
                    })
                } else if (layer.layerType === "DATAFLOW_POINT_TRACK" || layer.layerType === "DATAFLOW_HEAT") {
                    that.getDataflowInfo(layer, function () {
                        that.addLayer(layer, features, layerIndex);
                        that.layerAdded++;
                        that.sendMapToUser(len);
                    }, function (e) {
                        that.layerAdded++;
                        that.errorCallback && that.errorCallback(e, 'getFeatureFaild', that.map);
                    })
                }
            }, this);
        }
    }
    /**
     * @private
     * @function WebMap.prototype.addGeojsonFromUrl
     * @description ä»webæå¡è¾å¥geojsonå°åçå¾å±
     * @param {Object} layerInfo - å¾å±ä¿¡æ¯
     * @param {number} len - æ»çå¾å±æ°é
     * @param {number} layerIndex - å½åå¾å±index
     * @param {boolean} withCredentials - æ¯å¦æºå¸¦cookie
     */
    addGeojsonFromUrl(layerInfo, len, layerIndex, withCredentials = this.withCredentials) {
        // éè¿webæ·»å geojsonä¸éè¦æºå¸¦cookie
        let {dataSource} = layerInfo, {url} = dataSource, that = this;
        FetchRequest.get(url, null, {
            withCredentials,
            withoutFormatSuffix: true
        }).then(function (response) {
            return response.json()
        }).then(async function (data) {
            if (!data || data.succeed === false) {
                //è¯·æ±å¤±è´¥
                if (len) {
                    that.errorCallback && that.errorCallback(data.error, 'autoUpdateFaild', that.map)
                } else {
                    that.layerAdded++;
                    that.sendMapToUser(len);
                    that.errorCallback && that.errorCallback(data.error, 'getLayerFaild', that.map);
                }
                return;
            }
            var features;
            if (data.type === 'CSV' || data.type === 'EXCEL') {
                if (layerInfo.dataSource && layerInfo.dataSource.administrativeInfo) {
                    //è¡æ¿è§åä¿¡æ¯
                    data.content.rows.unshift(data.content.colTitles);
                    let {divisionType, divisionField} = layerInfo.dataSource.administrativeInfo;
                    let geojson = that.excelData2FeatureByDivision(data.content, divisionType, divisionField);
                    features = that._parseGeoJsonData2Feature({allDatas: {features: geojson.features}, fileCode: layerInfo.projection});
                } else {
                    features = await that.excelData2Feature(data.content, layerInfo);
                }
            } else {
                var geoJson = data.content ? JSON.parse(data.content) : data;
                features = that.geojsonToFeature(geoJson, layerInfo);
            }
            if (len) {
                //ä¸å¾
                that.addLayer(layerInfo, features, layerIndex);
                that.layerAdded++;
                that.sendMapToUser(len);
            } else {
                //èªå¨æ´æ°
                that.map.removeLayer(layerInfo.layer);
                layerInfo.labelLayer && that.map.removeLayer(layerInfo.labelLayer);
                that.addLayer(layerInfo, features, layerIndex);
            }
        }).catch(function (error) {
            that.layerAdded++;
            that.sendMapToUser(len);
            that.errorCallback && that.errorCallback(error, 'getLayerFaild', that.map);
        })
    }
    /**
     * @private
     * @function WebMap.prototype.getServiceInfoFromLayer
     * @description å¤æ­ä½¿ç¨åªç§æå¡ä¸å¾
     * @param {number} layerIndex - å¾å±å¯¹åºçindex
     * @param {number} len - æåæ·»å çå¾å±ä¸ªæ°
     * @param {Object} layer - å¾å±ä¿¡æ¯
     * @param {Array.<Object>} dataItemServices - æ°æ®åå¸çæå¡
     * @param {string} datasetName - æ°æ®æå¡çæ°æ®éåç§°
     * @param {string} featureType - featureç±»å
     * @param {Object} info - æ°æ®æå¡çä¿¡æ¯
     */
    getServiceInfoFromLayer(layerIndex, len, layer, dataItemServices, datasetName, featureType, info) {
        let that = this;
        let isMapService = info ? !info.isMvt : layer.layerType === 'HOSTED_TILE',
            isAdded = false;
        dataItemServices.forEach(function (service) {
            if (isAdded) {
                return;
            }
            //ææå¡äºï¼å°±ä¸éè¦å¾ªç¯
            if (service && isMapService && service.serviceType === 'RESTMAP') {
                isAdded = true;
                //å°å¾æå¡,å¤æ­ä½¿ç¨mvtè¿æ¯tile
                that.getTileLayerInfo(service.address).then(function (restMaps) {
                    restMaps.forEach(function (restMapInfo) {
                        let bounds = restMapInfo.bounds;
                        layer.layerType = 'TILE';
                        layer.orginEpsgCode = that.baseProjection;
                        layer.units = restMapInfo.coordUnit && restMapInfo.coordUnit.toLowerCase();
                        layer.extent = [bounds.left, bounds.bottom, bounds.right, bounds.top];
                        layer.visibleScales = restMapInfo.visibleScales;
                        layer.url = restMapInfo.url;
                        layer.sourceType = 'TILE';
                        that.map.addLayer(that.createBaseLayer(layer, layerIndex));
                        that.layerAdded++;
                        that.sendMapToUser(len);
                    })
                })
            } else if (service && !isMapService && service.serviceType === 'RESTDATA') {
                isAdded = true;
                if (info && info.isMvt) {
                    let bounds = info.bounds;
                    layer = Object.assign(layer, {
                        layerType: "VECTOR_TILE",
                        epsgCode: info.epsgCode,
                        projection: `EPSG:${info.epsgCode}`,
                        bounds: bounds,
                        extent: [bounds.left, bounds.bottom, bounds.right, bounds.top],
                        name: layer.name,
                        url: info.url,
                        visible: layer.visible,
                        featureType: featureType,
                        serverId: layer.serverId.toString()
                    });
                    that.map.addLayer(that.addVectorTileLayer(layer, layerIndex, 'RESTDATA'));
                    that.layerAdded++;
                    that.sendMapToUser(len);

                } else {
                    //æ°æ®æå¡
                    isAdded = true;
                    //å³ç³»åæä»¶åå¸çæ°æ®æå¡
                    that.getDatasources(service.address).then(function (datasourceName) {
                        layer.dataSource.dataSourceName = datasourceName + ":" + datasetName;
                        layer.dataSource.url = `${service.address}/data`;
                        that.getFeaturesFromRestData(layer, layerIndex, len);
                    });
                }
            }
        });
        if (!isAdded) {
            //å¾ªç¯å®æäºï¼ä¹æ²¡ææ¾å°åéçæå¡ãæå¯è½æå¡è¢«å é¤
            that.layerAdded++;
            that.sendMapToUser(len);
            that.errorCallback && that.errorCallback(null, 'getLayerFaild', that.map);
        }
    }

    /**
     * @private
     * @function WebMap.prototype.getDataflowInfo
     * @description è·åæ°æ®æµæå¡çåæ°
     * @param {Object} layerInfo - å¾å±ä¿¡æ¯
     * @param {function} success - æååè°å½æ°
     * @param {function} faild - å¤±è´¥åè°å½æ°
     */
    getDataflowInfo(layerInfo, success, faild) {
        let that = this;
        let url = layerInfo.url, token;
        let requestUrl = that.getRequestUrl(`${url}.json`, false);
        if (layerInfo.credential && layerInfo.credential.token) {
            token = layerInfo.credential.token;
            requestUrl += `?token=${token}`;
        }
        FetchRequest.get(requestUrl, null, {
            withCredentials: this.withCredentials
        }).then(function (response) {
            return response.json()
        }).then(function (result) {
            layerInfo.featureType = "POINT";
            if (result && result.featureMetaData) {
                layerInfo.featureType = result.featureMetaData.featureType.toUpperCase();
            }
            layerInfo.wsUrl = result.urls[0].url;
            success();
        }).catch(function () {
            faild();
        });
    }

    /**
     * @private
     * @function WebMap.prototype.getFeaturesFromRestData
     * @description ä»æ°æ®æå¡ä¸­è·åfeature
     * @param {Object} layer - å¾å±ä¿¡æ¯
     * @param {number} layerIndex - å¾å±index
     * @param {number} layerLength - å¾å±æ°é
     */
    getFeaturesFromRestData(layer, layerIndex, layerLength) {
        let that = this, dataSource = layer.dataSource,
            url = layer.dataSource.url,
            dataSourceName = dataSource.dataSourceName || layer.name;
        let requestUrl = that.formatUrlWithCredential(url), serviceOptions = {};
        serviceOptions.withCredentials = this.withCredentials;
        if (!this.excludePortalProxyUrl && !Util.isInTheSameDomain(requestUrl)) {
            serviceOptions.proxy = this.getProxy();
        }
        if(['EPSG:0'].includes(layer.projection)) {
            // ä¸æ¯æå¨ææå½±restDataæå¡
            that.layerAdded++;
            that.sendMapToUser(layerLength);
            that.errorCallback && that.errorCallback({}, 'getFeatureFaild', that.map);
            return;
        }
        //å ä¸ºitestä¸ä½¿ç¨çhttpsï¼iserveræ¯httpï¼æä»¥è¦å ä¸ä»£ç
        getFeatureBySQL(requestUrl, [dataSourceName], serviceOptions, function (result) {
            let features = that.parseGeoJsonData2Feature({
                allDatas: {
                    features: result.result.features.features
                },
                fileCode: that.baseProjection, //å ä¸ºè·årestDataç¨äºå¨ææå½±ï¼ä¸éè¦åè¿è¡åæ è½¬æ¢ãæä»¥æ­¤å¤filecodeååºå¾åæ ç³»ä¸è´
                featureProjection: that.baseProjection
            });
            that.addLayer(layer, features, layerIndex);
            that.layerAdded++;
            that.sendMapToUser(layerLength);
        }, function (err) {
            that.layerAdded++;
            that.sendMapToUser(layerLength);
            that.errorCallback && that.errorCallback(err, 'getFeatureFaild', that.map)
        }, that.baseProjection.split("EPSG:")[1]);
    }

    /**
     * @private
     * @function WebMap.prototype.getFeatures
     * @description ä»å°å¾ä¸­è·åfeature
     * @param {Object} fields - å¾å±ä¿¡æ¯
     * @param {number} layerInfo - å¾å±index
     * @param {number} success - æååè°
     * @param {number} faild - å¤±è´¥åè°
     */
    getFeatures(fields, layerInfo, success, faild) {
        var that = this;
        var source = layerInfo.dataSource;
        var fileCode = layerInfo.projection;
        queryFeatureBySQL(source.url, source.layerName, null, fields, null, function (result) {
            var recordsets = result.result.recordsets[0];
            var features = recordsets.features.features;

            var featuresObj = that.parseGeoJsonData2Feature({
                allDatas: {
                    features
                },
                fileCode: fileCode,
                featureProjection: that.baseProjection
            }, 'JSON');
            success(featuresObj);
        }, function (err) {
            faild(err);
        });
    }

    /**
     * @private
     * @function WebMap.prototype.sendMapToUser
     * @description å°ææå å å¾å±å å åï¼è¿åæç»çmapå¯¹è±¡ç»ç¨æ·ï¼ä¾ä»ä»¬æä½ä½¿ç¨
     * @param {number} layersLen - å å å¾å±æ»æ°
     */
    sendMapToUser(layersLen) {
        const lens = this.isHaveGraticule ? layersLen + 1 : layersLen;
        if (this.layerAdded === lens && this.successCallback) {
            this.successCallback(this.map, this.mapParams, this.layers, this.baseLayer);
        }
    }

    /**
     * @private
     * @function WebMap.prototype.excelData2Feature
     * @description å°csvåxlsæä»¶åå®¹è½¬æ¢æol.feature
     * @param {Object} content - æä»¶åå®¹
     * @param {Object} layerInfo - å¾å±ä¿¡æ¯
     * @returns {Array}  ol.featureçæ°ç»éå
     */
    async excelData2Feature(content, layerInfo) {
        let rows = content.rows,
            colTitles = content.colTitles;
        // è§£å³V2æ¢å¤çæ°æ®ä¸­å«æç©ºæ ¼
        for (let i in colTitles) {
            if (core_Util_Util.isString(colTitles[i])) {
                colTitles[i] = core_Util_Util.trim(colTitles[i]);
            }
        }
        let fileCode = layerInfo.projection,
            dataSource = layerInfo.dataSource,
            baseLayerEpsgCode = this.baseProjection,
            features = [],
            xField = core_Util_Util.trim((layerInfo.xyField && layerInfo.xyField.xField) || (layerInfo.from && layerInfo.from.xField)),
            yField = core_Util_Util.trim((layerInfo.xyField && layerInfo.xyField.yField) || (layerInfo.from && layerInfo.from.yField)),
            xIdx = colTitles.indexOf(xField),
            yIdx = colTitles.indexOf(yField);

        // todo ä¼å ææ¶è¿æ ·å¤ç
        if (layerInfo.layerType === 'MIGRATION') {
            try {
                if (dataSource.type === 'PORTAL_DATA') {
                    const {dataMetaInfo} = await FetchRequest.get(`${this.server}web/datas/${dataSource.serverId}.json`, null, {
                        withCredentials: this.withCredentials
                    }).then(res => res.json());
                    // eslint-disable-next-line require-atomic-updates
                    layerInfo.xyField = {
                        xField: dataMetaInfo.xField,
                        yField: dataMetaInfo.yField
                    }
                    if (!dataMetaInfo.xIndex) {
                        xIdx = colTitles.indexOf(dataMetaInfo.xField);
                        yIdx = colTitles.indexOf(dataMetaInfo.yField);
                    } else {
                        xIdx = dataMetaInfo.xIndex;
                        yIdx = dataMetaInfo.yIndex;
                    }
                } else if (dataSource.type === 'SAMPLE_DATA') {
                    // ç¤ºä¾æ°æ®ä»æ¬å°æ¿xyField
                    const sampleData = SampleDataInfo_namespaceObject.find(item => item.id === dataSource.name) || {};
                    xField = sampleData.xField;
                    yField = sampleData.yField
                    layerInfo.xyField = {
                        xField,
                        yField
                    }
                    xIdx = colTitles.findIndex(item => item === xField);
                    yIdx = colTitles.findIndex(item => item === yField);
                }
            } catch (error) {
                console.error(error);
            }
        }

        for (let i = 0, len = rows.length; i < len; i++) {
            let rowDatas = rows[i],
                attributes = {},
                geomX = rows[i][xIdx],
                geomY = rows[i][yIdx];
            // ä½ç½®å­æ®µä¿¡æ¯ä¸å­å¨ è¿æ»¤æ°æ®
            if (geomX !== '' && geomY !== '') {
                let olGeom = new external_ol_geom_namespaceObject.Point([+geomX, +geomY]);
                if (fileCode !== baseLayerEpsgCode) {
                    olGeom.transform(fileCode, baseLayerEpsgCode);
                }
                for (let j = 0, leng = rowDatas.length; j < leng; j++) {
                    let field = colTitles[j];
                    if (field === undefined || field === null) {continue;}
                    field = field.trim();
                    if (Object.keys(attributes).indexOf(field) > -1) {
                        //è¯´æåé¢æä¸ªä¸æ¨¡ä¸æ ·çå­æ®µ
                        const newField = field + '_1';
                        attributes[newField] = rowDatas[j];
                    } else {
                        attributes[field] = rowDatas[j];
                    }

                }
                let feature = new (external_ol_Feature_default())({
                    geometry: olGeom,
                    attributes
                });
                features.push(feature);
            }
        }
        return Promise.resolve(features);
    }
    /**
     * @private
     * @function WebMap.prototype.excelData2FeatureByDivision
     * @description è¡æ¿åºåæ°æ®å¤ç
     * @param {Object} content - æä»¶åå®¹
     * @param {Object} layerInfo - å¾å±ä¿¡æ¯
     * @returns {Object}  geojsonå¯¹è±¡
     */
    excelData2FeatureByDivision(content, divisionType, divisionField) {
        let me = this;
        let asyncInport;
        if (divisionType === 'Province') {
            asyncInport = window.ProvinceData;
        } else if (divisionType === 'City') {
            asyncInport = window.MunicipalData;
        } else if (divisionType === 'GB-T_2260') {
            // let geojso;
            asyncInport = window.AdministrativeArea;
        }
        if (asyncInport) {
            let geojson = me.changeExcel2Geojson(asyncInport.features, content.rows, divisionType, divisionField);
            return geojson;
        }
    }

    /**
     * @private
     * @function WebMap.prototype._parseGeoJsonData2Feature
     * @description å°geojsonçæ°æ®è½¬æ¢æol.Feature
     * @param {Object} metaData - æä»¶åå®¹
     * @returns {Array.<ol.Feature>} features
     */
    _parseGeoJsonData2Feature(metaData) {
        let allFeatures = metaData.allDatas.features,
            features = [];
        for (let i = 0, len = allFeatures.length; i < len; i++) {
            //ä¸å é¤propertiesè½¬æ¢åï¼å±æ§å¨é½å¨featureä¸
            let properties = Object.assign({}, allFeatures[i].properties);
            delete allFeatures[i].properties;
            let feature = transformTools.readFeature(allFeatures[i], {
                dataProjection: metaData.fileCode,
                featureProjection: this.baseProjection || 'ESPG:4326'
            });
            feature.setProperties({attributes: properties});
            features.push(feature);
        }
        return features;
    }
    /**
     * @private
     * @function WebMap.prototype.changeExcel2Geojson
     * @description å°excelåcsvæ°æ®è½¬æ¢ææ ågeojsonæ°æ®
     * @param {Array} features - featureå¯¹è±¡
     * @param {Array} datas - æ°æ®åå®¹
     * @param {string} divisionType - è¡æ¿åºåç±»å
     * @param {string} divisionField - è¡æ¿åºåå­æ®µ
     * @returns {Object} geojsonå¯¹è±¡
     */
    changeExcel2Geojson(features, datas, divisionType, divisionField) {
        let geojson = {
            type: 'FeatureCollection',
            features: []
        };
        if (datas.length < 2) {
            return geojson; //åªæä¸è¡æ°æ®æ¶ä¸ºæ é¢
        }
        let titles = datas[0],
            rows = datas.slice(1),
            fieldIndex = titles.findIndex(title => title === divisionField);
        rows.forEach(row => {
            let feature;
            if (divisionType === 'GB-T_2260') {
                feature = features.find(item => item.properties.GB === row[fieldIndex])
            } else {
                feature = core_Util_Util.getHighestMatchAdministration(features, row[fieldIndex]);
            }
            //todo éæç¤ºå¿½ç¥æ ææ°æ®
            if (feature) {
                let newFeature = window.cloneDeep(feature);
                newFeature.properties = {};
                row.forEach((item, idx) => {
                    //ç©ºæ ¼é®é¢ï¼çè§DVå¤å¤å¤çç©ºæ ¼é®é¢ï¼TODOç»ä¸æ´ç
                    let key = titles[idx].trim();
                    newFeature.properties[key] = item;
                });
                geojson.features.push(newFeature);
            }
        });
        return geojson;
    }

    /**
     * @private
     * @function WebMap.prototype.geojsonToFeature
     * @description geojson è½¬æ¢ä¸º feature
     * @param {Object} layerInfo - å¾å±ä¿¡æ¯
     * @returns {Array}  ol.featureçæ°ç»éå
     */
    geojsonToFeature(geojson, layerInfo) {
        let allFeatures = geojson.features,
            features = [];
        for (let i = 0, len = allFeatures.length; i < len; i++) {
            //è½¬æ¢åå é¤properties,è¿æ ·è½¬æ¢åå±æ§ä¸ä¼éå¤å­å¨
            let featureAttr = allFeatures[i].properties || {};
            delete allFeatures[i].properties;
            let feature = transformTools.readFeature(allFeatures[i], {
                dataProjection: layerInfo.projection || 'EPSG:4326',
                featureProjection: this.baseProjection || 'ESPG:4326'
            });
            //geojsonæ ¼å¼çfeatureå±æ§æ²¡æåæ ç³»å­æ®µï¼ä¸ºäºç»ä¸ï¼åæ¬¡å ä¸
            let coordinate = feature.getGeometry().getCoordinates();
            if (allFeatures[i].geometry.type === 'Point') {
                // æ æ³¨å¾å± è¿æ²¡æå±æ§å¼æ¶åä¸å 
                if (allFeatures[i].properties) {
                    allFeatures[i].properties.lon = coordinate[0];
                    allFeatures[i].properties.lat = coordinate[1];
                }
            }

            // æ æ³¨å¾å±ç¹æ®å¤ç
            let isMarker = false;
            let attributes;
            let useStyle;
            if (allFeatures[i].dv_v5_markerInfo) {
                //å ä¸ºä¼åä»£ç ä¹åï¼å±æ§å­æ®µé½å­å¨å¨propertiseä¸ï¼markerInfoæ²¡æ
                attributes = Object.assign({}, allFeatures[i].dv_v5_markerInfo, featureAttr);
                if (attributes.lon) {
                    //æ æ³¨å¾å±ä¸éè¦
                    delete attributes.lon;
                    delete attributes.lat;
                }
            }
            if (allFeatures[i].dv_v5_markerStyle) {
                useStyle = allFeatures[i].dv_v5_markerStyle;
                isMarker = true;
            }
            let properties;
            if (isMarker) {
                properties = Object.assign({}, {
                    attributes
                }, {
                    useStyle
                });
                //featureä¸æ·»å å¾å±çidï¼ä¸ºäºå¯¹åºå¾å±
                feature.layerId = layerInfo.timeId;
            } else if (layerInfo.featureStyles) {
                //V4 çæ¬æ æ³¨å¾å±å¤ç
                let style = JSON.parse(layerInfo.featureStyles[i].style);
                let attr = featureAttr;
                let imgUrl;
                if (attr._smiportal_imgLinkUrl.indexOf('http://') > -1 || attr._smiportal_imgLinkUrl.indexOf('https://') > -1) {
                    imgUrl = attr._smiportal_imgLinkUrl;
                } else if (attr._smiportal_imgLinkUrl !== undefined && attr._smiportal_imgLinkUrl !== null &&
                    attr._smiportal_imgLinkUrl !== '') {
                    //ä¸ä¼ çå¾çï¼å ä¸å½åå°å
                    imgUrl = `${core_Util_Util.getIPortalUrl()}resources/markerIcon/${attr._smiportal_imgLinkUrl}`
                }
                attributes = {
                    dataViz_description: attr._smiportal_description,
                    dataViz_imgUrl: imgUrl,
                    dataViz_title: attr._smiportal_title,
                    dataViz_url: attr._smiportal_otherLinkUrl
                };
                style.anchor = [0.5, 1];
                style.src = style.externalGraphic;

                useStyle = style;
                properties = Object.assign({}, {
                    attributes
                }, {
                    useStyle
                });
                delete attr._smiportal_description;
                delete attr._smiportal_imgLinkUrl;
                delete attr._smiportal_title;
                delete attr._smiportal_otherLinkUrl;
            } else {
                properties = {attributes: featureAttr};
            }

            feature.setProperties(properties);
            features.push(feature);
        }
        return features;
    }

    /**
     * @private
     * @function WebMap.prototype.parseGeoJsonData2Feature
     * @description å°ä»restDataå°åä¸è·åçjsonè½¬æ¢æfeatureï¼ä»iserverä¸­è·åçjsonè½¬æ¢æfeatureï¼
     * @param {Object} metaData - jsonåå®¹
     * @returns {Array}  ol.featureçæ°ç»éå
     */
    parseGeoJsonData2Feature(metaData) {
        let allFeatures = metaData.allDatas.features,
            features = [];
        for (let i = 0, len = allFeatures.length; i < len; i++) {
            let properties = allFeatures[i].properties;
            delete allFeatures[i].properties;
            let feature = transformTools.readFeature(allFeatures[i], {
                dataProjection: metaData.fileCode || 'EPSG:4326',
                featureProjection: metaData.featureProjection || this.baseProjection || 'EPSG:4326'
            });
            //geojsonæ ¼å¼çfeatureå±æ§æ²¡æåæ ç³»å­æ®µï¼ä¸ºäºç»ä¸ï¼åæ¬¡å ä¸
            let geometry = feature.getGeometry();
            // å¦æä¸å­å¨geometryï¼ä¹ä¸éè¦ç»è£feature
            if(!geometry) {continue;}
            let coordinate = geometry.getCoordinates();
            if (allFeatures[i].geometry.type === 'Point') {
                properties.lon = coordinate[0];
                properties.lat = coordinate[1];
            }
            feature.setProperties({
                attributes: properties
            });
            features.push(feature);
        }
        return features;
    }

    /**
     * @private
     * @function WebMap.prototype.addLayer
     * @description å°å å å¾å±æ·»å å°å°å¾ä¸
     * @param {Object} layerInfo - å¾å±ä¿¡æ¯
     * @param {Array} features - å¾å±ä¸çfeatureéå
     * @param {number} index å¾å±çé¡ºåº
     */
    addLayer(layerInfo, features, index) {
        let layer, that = this;
        if (layerInfo.layerType === "VECTOR") {
            if (layerInfo.featureType === "POINT") {
                if (layerInfo.style.type === 'SYMBOL_POINT') {
                    layer = this.createSymbolLayer(layerInfo, features);
                } else {
                    layer = this.createGraphicLayer(layerInfo, features);
                }
            } else {
                //çº¿åé¢
                layer = this.createVectorLayer(layerInfo, features)
            }
        } else if (layerInfo.layerType === "UNIQUE") {
            layer = this.createUniqueLayer(layerInfo, features);
        } else if (layerInfo.layerType === "RANGE") {
            layer = this.createRangeLayer(layerInfo, features);
        } else if (layerInfo.layerType === "HEAT") {
            layer = this.createHeatLayer(layerInfo, features);
        } else if (layerInfo.layerType === "MARKER") {
            layer = this.createMarkerLayer(features);
        } else if (layerInfo.layerType === "DATAFLOW_POINT_TRACK") {
            layer = this.createDataflowLayer(layerInfo, index);
        } else if (layerInfo.layerType === "DATAFLOW_HEAT") {
            layer = this.createDataflowHeatLayer(layerInfo);
        } else if (layerInfo.layerType === "RANK_SYMBOL") {
            layer = this.createRankSymbolLayer(layerInfo, features);
        } else if (layerInfo.layerType === "MIGRATION") {
            layer = this.createMigrationLayer(layerInfo, features);
        }
        let layerID = core_Util_Util.newGuid(8);
        if (layer) {
            layerInfo.name && layer.setProperties({
                name: layerInfo.name,
                layerID: layerID,
                layerType: layerInfo.layerType
            });

            //å·æ°ä¸å¾å±ï¼å¦åfeatureæ ·å¼åºä¸æ¥
            if (layerInfo && layerInfo.style && layerInfo.style.imageInfo) {
                let img = new Image();
                img.src = layerInfo.style.imageInfo.url;
                img.onload = function () {
                    layer.getSource().changed();
                };
            }
            if (layerInfo.layerType === 'MIGRATION') {
                layer.appendTo(this.map);
                // å¨è¿éæ¢å¤å¾å±å¯è§æ§ç¶æ
                layer.setVisible(layerInfo.visible);
                // è®¾ç½®é¼ æ æ ·å¼ä¸ºé»è®¤
                layer.setCursor();
            } else {
                layerInfo.opacity != undefined && layer.setOpacity(layerInfo.opacity);
                layer.setVisible(layerInfo.visible);
                this.map.addLayer(layer);
            }
            layer.setZIndex(index);
            const {visibleScale, autoUpdateTime} = layerInfo;
            visibleScale && this.setVisibleScales(layer, visibleScale);
            if (autoUpdateTime && !layerInfo.autoUpdateInterval) {
                //èªå¨æ´æ°æ°æ®
                let dataSource = layerInfo.dataSource;
                if (dataSource.accessType === "DIRECT" && !dataSource.url) {
                    // äºè¿å¶æ°æ®æ´æ°feautreæéçurl
                    dataSource.url = `${this.server}web/datas/${dataSource.serverId}/content.json?pageSize=9999999&currentPage=1`
                }
                layerInfo.autoUpdateInterval = setInterval(() => {
                    that.updateFeaturesToMap(layerInfo, index, true);
                }, autoUpdateTime);
            }
        }
        layerInfo.layer = layer;
        layerInfo.layerID = layerID;
        if (layerInfo.labelStyle && layerInfo.labelStyle.labelField && layerInfo.layerType !== "DATAFLOW_POINT_TRACK") {
            //å­å¨æ ç­¾ä¸é¢å¾
            //è¿æ»¤æ¡ä»¶è¿æ»¤feature
            features = layerInfo.filterCondition ? this.getFiterFeatures(layerInfo.filterCondition, features) : features;
            this.addLabelLayer(layerInfo, features);
        }
    }
    /**
     * @private
     * @function WebMap.prototype.updateFeaturesToMap
     * @description æ´æ°å°å¾ä¸çfeature,éç¨äºä¸é¢å¾
     * @param {Object} layerInfo - å¾å±ä¿¡æ¯
     * @param {number} index å¾å±çé¡ºåº
     */
    updateFeaturesToMap(layerInfo, layerIndex) {
        let that = this, dataSource = layerInfo.dataSource, url = layerInfo.dataSource.url,
            dataSourceName = dataSource.dataSourceName || layerInfo.name;

        if (dataSource.type === "USER_DATA" || dataSource.accessType === "DIRECT") {
            that.addGeojsonFromUrl(layerInfo, null, layerIndex)
        } else {
            let requestUrl = that.formatUrlWithCredential(url), serviceOptions = {};
            serviceOptions.withCredentials = this.withCredentials;
            if (!this.excludePortalProxyUrl && !Util.isInTheSameDomain(requestUrl)) {
                serviceOptions.proxy = this.getProxy();
            }
            //å ä¸ºitestä¸ä½¿ç¨çhttpsï¼iserveræ¯httpï¼æä»¥è¦å ä¸ä»£ç
            getFeatureBySQL(requestUrl, [dataSourceName], serviceOptions, function (result) {
                let features = that.parseGeoJsonData2Feature({
                    allDatas: {
                        features: result.result.features.features
                    },
                    fileCode: layerInfo.projection,
                    featureProjection: that.baseProjection
                });
                //å é¤ä¹åçå¾å±åæ ç­¾å¾å±
                that.map.removeLayer(layerInfo.layer);
                layerInfo.labelLayer && that.map.removeLayer(layerInfo.labelLayer);
                that.addLayer(layerInfo, features, layerIndex);
            }, function (err) {
                that.errorCallback && that.errorCallback(err, 'autoUpdateFaild', that.map);
            });
        }
    }

    /**
     * @private
     * @function WebMap.prototype.addVectorTileLayer
     * @description æ·»å vectorTILEå¾å±
     * @param {Object} layerInfo - å¾å±ä¿¡æ¯
     * @param {number} index å¾å±çé¡ºåº
     * @param {string} type åå»ºçå¾å±ç±»åï¼restDataä¸ºåå»ºæ°æ®æå¡çmvt, restMapä¸ºåå»ºå°å¾æå¡çmvt
     * @returns {ol.layer.VectorTile}  å¾å±å¯¹è±¡
     */
    addVectorTileLayer(layerInfo, index, type) {
        let layer;
        if (type === 'RESTDATA') {
            //ç¨çæ¯restdataæå¡çmvt
            layer = this.createDataVectorTileLayer(layerInfo)
        }
        let layerID = core_Util_Util.newGuid(8);
        if (layer) {
            layerInfo.name && layer.setProperties({
                name: layerInfo.name,
                layerID: layerID
            });
            layerInfo.opacity != undefined && layer.setOpacity(layerInfo.opacity);
            layer.setVisible(layerInfo.visible);
            layer.setZIndex(index);
        }
        layerInfo.layer = layer;
        layerInfo.layerID = layerID;
        return layer;
    }
    /**
     * @private
     * @function WebMap.prototype.createDataVectorTileLayer
     * @description åå»ºvectorTILEå¾å±
     * @param {Object} layerInfo - å¾å±ä¿¡æ¯
     * @returns {ol.layer.VectorTile} å¾å±å¯¹è±¡
     */
    createDataVectorTileLayer(layerInfo) {
        //åå»ºå¾å±
        var format = new (external_ol_format_MVT_default())({
            featureClass: (external_ol_Feature_default())
        });
        //è¦å ä¸è¿ä¸å¥ï¼å¦ååæ ï¼é»è®¤é½æ¯3857
        (external_ol_format_MVT_default()).prototype.readProjection = function () {
            return new external_ol_proj_namespaceObject.Projection({
                code: '',
                units: (external_ol_proj_Units_default()).TILE_PIXELS
            });
        };
        let featureType = layerInfo.featureType;
        let style = StyleUtils.toOpenLayersStyle(this.getDataVectorTileStyle(featureType), featureType);
        return new external_ol_layer_namespaceObject.VectorTile({
            //è®¾ç½®é¿è®©åæ°
            source: new VectorTileSuperMapRest({
                url: layerInfo.url,
                projection: layerInfo.projection,
                tileType: "ScaleXY",
                format: format
            }),
            style: style
        });
    }
    /**
     * @private
     * @function WebMap.prototype.getDataVectorTileStyle
     * @description è·åæ°æ®æå¡çmvtä¸å¾çé»è®¤æ ·å¼
     * @param {string} featureType - è¦ç´ ç±»å
     * @returns {Object} æ ·å¼åæ°
     */
    getDataVectorTileStyle(featureType) {
        let styleParameters = {
            radius: 8, //åç¹åå¾
            fillColor: '#EE4D5A', //å¡«åè²
            fillOpacity: 0.9,
            strokeColor: '#ffffff', //è¾¹æ¡é¢è²
            strokeWidth: 1,
            strokeOpacity: 1,
            lineDash: 'solid',
            type: "BASIC_POINT"
        };
        if (["LINE", "LINESTRING", "MULTILINESTRING"].indexOf(featureType) > -1) {
            styleParameters.strokeColor = '#4CC8A3';
            styleParameters.strokeWidth = 2;
        } else if (["REGION", "POLYGON", "MULTIPOLYGON"].indexOf(featureType) > -1) {
            styleParameters.fillColor = '#826DBA';
        }
        return styleParameters;
    }

    /**
     * @private
     * @function WebMap.prototype.getFiterFeatures
     * @description éè¿è¿æ»¤æ¡ä»¶æ¥è¯¢æ»¡è¶³çfeature
     * @param {string} filterCondition - è¿æ»¤æ¡ä»¶
     * @param {Array} allFeatures - å¾å±ä¸çfeatureéå
     */
    getFiterFeatures(filterCondition, allFeatures) {
        let condition = this.parseFilterCondition(filterCondition);
        let sql = "select * from json where (" + condition + ")";
        let filterFeatures = [];
        for (let i = 0; i < allFeatures.length; i++) {
            let feature = allFeatures[i];
            let filterResult = false;
            try {
                filterResult = window.jsonsql.query(sql, {
                    attributes: feature.get('attributes')
                });
            } catch (err) {
                //å¿é¡»æè¦è¿æ»¤å¾åå®¹å°è£æä¸ä¸ªå¯¹è±¡,ä¸»è¦æ¯å¤çjsonsql(line : 62)ä¸­ç±äºwithè¯­å¥éåå¯¹è±¡é æçé®é¢
                continue;
            }
            if (filterResult && filterResult.length > 0) {
                //afterFilterFeatureIdx.push(i);
                filterFeatures.push(feature);
            }
        }
        return filterFeatures;
    }

    /**
     * @private
     * @function WebMap.prototype.parseFilterCondition
     * @description 1ãæ¿æ¢æ¥è¯¢è¯­å¥ ä¸­ç and / AND / or / OR / = / !=
     *              2ãå¹é Name in ('', '')ï¼å¤æ¡ä»¶éç¨()åè£¹
     * @param {string} filterCondition - è¿æ»¤æ¡ä»¶
     * @return {string} æ¢æç»ä»¶è½è¯å«çå­ç¬¦ä¸²
     */
    parseFilterCondition(filterCondition) {
        return filterCondition
            .replace(/=/g, "==")
            .replace(/AND|and/g, "&&")
            .replace(/or|OR/g, "||")
            .replace(/<==/g, "<=")
            .replace(/>==/g, ">=")
            .replace(/\(?[^\(]+?\s*in\s*\([^\)]+?\)\)?/gi, (res) => {
                // resæ ¼å¼ï¼(çä»½ in ('åå·', 'æ²³å'))
                const data = res.match(/([^(]+?)\s*in\s*\(([^)]+?)\)/i);
                return data.length === 3
                    ? `(${data[2]
                        .split(",")
                        .map((c) => `${data[1]} == ${c.trim()}`)
                        .join(" || ")})`
                    : res;
            });
    }

    /**
     * @private
     * @function WebMap.prototype.createGraphicLayer
     * @description æ·»å å¤§æ°æ®å¾å±å°å°å¾ä¸
     * @param {Object} layerInfo - å¾å±ä¿¡æ¯
     * @param {Array} features - featureçéå
     * @return {ol.layer.image} å¤§æ°æ®å¾å±
     */
    createGraphicLayer(layerInfo, features) {
        features = layerInfo.filterCondition ? this.getFiterFeatures(layerInfo.filterCondition, features) : features;
        let graphics = this.getGraphicsFromFeatures(features, layerInfo.style, layerInfo.featureType);
        let source = new Graphic({
            graphics: graphics,
            render: 'canvas',
            map: this.map,
            isHighLight: false
        });
        return new external_ol_layer_namespaceObject.Image({
            source: source
        });
    }

    /**
     * @private
     * @function WebMap.prototype.getGraphicsFromFeatures
     * @description å°featureè½¬æ¢æå¤§æ°æ®å¾å±å¯¹åºçGraphicsè¦ç´ 
     * @param {Array} features - featureçéå
     * @param {Object} style - å¾å±æ ·å¼
     * @param {string} featureType - featureçç±»å
     * @return {Array} å¤§æ°æ®å¾å±è¦ç´ æ°ç»
     */
    getGraphicsFromFeatures(features, style, featureType) {
        let olStyle = StyleUtils.getOpenlayersStyle(style, featureType),
            shape = olStyle.getImage();
        let graphics = [];
        //æå»ºgraphic
        for (let i in features) {
            let graphic = new Graphic_Graphic(features[i].getGeometry());
            graphic.setStyle(shape);
            graphic.setProperties({attributes: features[i].get('attributes')})
            graphics.push(graphic);
        }
        return graphics;
    }

    /**
     * @private
     * @function WebMap.prototype.createSymbolLayer
     * @description æ·»å ç¬¦å·å¾å±
     * @param {Object} layerInfo - å¾å±ä¿¡æ¯
     * @param {Array} features - featureçéå
     * @return {ol.layer.Vector} ç¬¦å·å¾å±
     */
    createSymbolLayer(layerInfo, features) {
        let style = StyleUtils.getSymbolStyle(layerInfo.style);
        return new external_ol_layer_namespaceObject.Vector({
            style: style,
            source: new (external_ol_source_Vector_default())({
                features: layerInfo.filterCondition ? this.getFiterFeatures(layerInfo.filterCondition, features) : features,
                wrapX: false
            }),
            renderMode: 'image'
        });
    }

    /**
     * @private
     * @function WebMap.prototype.addLabelLayer
     * @description æ·»å æ ç­¾å¾å±
     * @param {Object} layerInfo - å¾å±ä¿¡æ¯
     * @param {Array} features -featureçéå
     * @returns {ol.layer.Vector} å¾å±å¯¹è±¡
     */
    addLabelLayer(layerInfo, features) {
        let labelStyle = layerInfo.labelStyle;
        let style = this.getLabelStyle(labelStyle, layerInfo);
        let layer = layerInfo.labelLayer = new external_ol_layer_namespaceObject.Vector({
            declutter: true,
            styleOL: style,
            labelField: labelStyle.labelField,
            source: new (external_ol_source_Vector_default())({
                features: features,
                wrapX: false
            })
        });
        layer.setStyle(features => {
            let labelField = labelStyle.labelField;
            let label = features.get('attributes')[labelField.trim()] + "";
            if (label === "undefined") {
                return null;
            }
            let styleOL = layer.get('styleOL');
            let text = styleOL.getText();
            if (text && text.setText) {
                text.setText(label);
            }
            return styleOL;
        });
        this.map.addLayer(layer);
        layer.setVisible(layerInfo.visible);
        layer.setZIndex(1000);
        const {visibleScale} = layerInfo;
        visibleScale && this.setVisibleScales(layer, visibleScale);
        return layer;
    }

    /**
     * @private
     * @function WebMap.prototype.setVisibleScales
     * @description æ¹åå¾å±å¯è§èå´
     * @param {Object} layer - å¾å±å¯¹è±¡ãol.Layer
     * @param {Object} visibleScale - å¾å±æ ·å¼åæ°
     */
    setVisibleScales(layer, visibleScale) {
        let maxResolution = this.resolutions[visibleScale.minScale],
            minResolution = this.resolutions[visibleScale.maxScale];
        //æ¯ä¾å°ºååå«çæ¯åæ¯çå³ç³»
        maxResolution > 1 ? layer.setMaxResolution(Math.ceil(maxResolution)) : layer.setMaxResolution(maxResolution * 1.1);
        layer.setMinResolution(minResolution);
    }

    /**
     * @private
     * @function WebMap.prototype.getLabelStyle
     * @description è·åæ ç­¾æ ·å¼
     * @param {Object} parameters - æ ç­¾å¾å±æ ·å¼åæ°
     * @param {Object} layerInfo - å¾å±æ ·å¼åæ°
     * @returns {ol.style.Style} æ ç­¾æ ·å¼
     */
    getLabelStyle(parameters, layerInfo) {
        let style = layerInfo.style || layerInfo.pointStyle;
        const {radius = 0, strokeWidth = 0} = style,
            beforeOffsetY = -(radius + strokeWidth);
        const {
            fontSize = '14px',
            fontFamily,
            fill,
            backgroundFill,
            offsetX = 0,
            offsetY = beforeOffsetY,
            placement = "point",
            textBaseline = "bottom",
            textAlign = 'center',
            outlineColor = "#000000",
            outlineWidth = 0
        } = parameters;
        const option = {
            font: `${fontSize} ${fontFamily}`,
            placement,
            textBaseline,
            fill: new (external_ol_style_Fill_default())({color: fill}),
            backgroundFill: new (external_ol_style_Fill_default())({color: backgroundFill}),
            padding: [3, 3, 3, 3],
            offsetX: layerInfo.featureType === 'POINT' ? offsetX : 0,
            offsetY: layerInfo.featureType === 'POINT' ? offsetY : 0,
            overflow: true,
            maxAngle: 0
        };
        if (layerInfo.featureType === 'POINT') {
            //çº¿é¢ä¸éè¦æ­¤åæ°ï¼å¦åè¶åºçº¿é¢overflow:trueï¼ä¹ä¸ä¼æ¾ç¤ºæ ç­¾
            option.textAlign = textAlign;
        }
        if (outlineWidth > 0) {
            option.stroke = new (external_ol_style_Stroke_default())({
                color: outlineColor,
                width: outlineWidth
            });
        }

        return new (external_ol_style_Style_default())({
            text: new (external_ol_style_Text_default())(option)
        });
    }

    /**
     * @private
     * @function WebMap.prototype.createVectorLayer
     * @description åå»ºvectorå¾å±
     * @param {Object} layerInfo - å¾å±ä¿¡æ¯
     * @param {Array} features -featureçéå
     * @returns {ol.layer.Vector} ç¢éå¾å±
     */
    createVectorLayer(layerInfo, features) {
        const {featureType, style} = layerInfo;
        let newStyle;
        if (featureType === 'LINE' && core_Util_Util.isArray(style)) {
            const [outlineStyle, strokeStyle] = style;
            newStyle = strokeStyle.lineDash === 'solid' ? StyleUtils.getRoadPath(strokeStyle, outlineStyle)
                : StyleUtils.getPathway(strokeStyle, outlineStyle);
        } else {
            newStyle = StyleUtils.toOpenLayersStyle(layerInfo.style, layerInfo.featureType);
        }
        return new external_ol_layer_namespaceObject.Vector({
            style: newStyle,
            source: new (external_ol_source_Vector_default())({
                features: layerInfo.filterCondition ? this.getFiterFeatures(layerInfo.filterCondition, features) : features,
                wrapX: false
            })
        });
    }

    /**
     * @private
     * @function WebMap.prototype.createHeatLayer
     * @description åå»ºç­åå¾å¾å±
     * @param {Object} layerInfo - å¾å±ä¿¡æ¯
     * @param {Array} features -featureçéå
     * @returns {ol.layer.Heatmap} ç­åå¾å¾å±
     */
    createHeatLayer(layerInfo, features) {
        //å ä¸ºç­åå¾ï¼éçè¿æ»¤ï¼éè¦éæ°è®¡ç®æé
        features = layerInfo.filterCondition ? this.getFiterFeatures(layerInfo.filterCondition, features) : features;
        let source = new (external_ol_source_Vector_default())({
            features: features,
            wrapX: false
        });
        let layerOptions = {
            source: source
        };
        let themeSetting = layerInfo.themeSetting;
        layerOptions.gradient = themeSetting.colors.slice();
        layerOptions.radius = parseInt(themeSetting.radius);
        //èªå®ä¹é¢è²
        let customSettings = themeSetting.customSettings;
        for (let i in customSettings) {
            layerOptions.gradient[i] = customSettings[i];
        }
        // æéå­æ®µæ¢å¤
        if (themeSetting.weight) {
            this.changeWeight(features, themeSetting.weight);
        }
        return new external_ol_layer_namespaceObject.Heatmap(layerOptions);
    }

    /**
     * @private
     * @function WebMap.prototype.changeWeight
     * @description æ¹åå½åæéå­æ®µ
     * @param {Array} features - featureçéå
     * @param {string} weightFeild - æéå­æ®µ
     */
    changeWeight(features, weightFeild) {
        let that = this;
        this.fieldMaxValue = {};
        this.getMaxValue(features, weightFeild);
        let maxValue = this.fieldMaxValue[weightFeild];
        features.forEach(function (feature) {
            let attributes = feature.get('attributes');
            try {
                let value = attributes[weightFeild];
                feature.set('weight', value / maxValue);
            } catch (e) {
                that.errorCallback && that.errorCallback(e);
            }
        })
    }

    /**
     * @private
     * @function WebMap.prototype.getMaxValue
     * @description è·åå½åå­æ®µå¯¹åºçæå¤§å¼ï¼ç¨äºè®¡ç®æé
     * @param {Array} features - feature æ°ç»
     * @param {string} weightField - æéå­æ®µ
     */
    getMaxValue(features, weightField) {
        let values = [], that = this, attributes;
        let field = weightField;
        if (this.fieldMaxValue[field]) {
            return;
        }
        features.forEach(function (feature) {
            //æ¶éå½åæéå­æ®µå¯¹åºçææå¼
            attributes = feature.get('attributes');
            try {
                values.push(parseFloat(attributes[field]));
            } catch (e) {
                that.errorCallback && that.errorCallback(e);
            }
        });
        this.fieldMaxValue[field] = ArrayStatistic.getArrayStatistic(values, 'Maximum');
    }

    /**
     * @private
     * @function WebMap.prototype.createUniqueLayer
     * @description è·åå½åå­æ®µå¯¹åºçæå¤§å¼ï¼ç¨äºè®¡ç®æé
     * @param {Object} layerInfo - å¾å±ä¿¡æ¯
     * @param {Array} features - ææfeatureç»å
     */
    createUniqueLayer(layerInfo, features) {
        let styleSource = this.createUniqueSource(layerInfo, features);
        let layer = new external_ol_layer_namespaceObject.Vector({
            styleSource: styleSource,
            source: new (external_ol_source_Vector_default())({
                features: layerInfo.filterCondition ? this.getFiterFeatures(layerInfo.filterCondition, features) : features,
                wrapX: false
            })
        });
        layer.setStyle(feature => {
            let styleSource = layer.get('styleSource');
            let labelField = styleSource.themeField;
            let label = feature.get('attributes')[labelField];
            let styleGroup = styleSource.styleGroups.find(item => {
                return item.value === label;
            })
            return styleGroup.olStyle;
        });

        return layer;
    }

    /**
     * @private
     * @function WebMap.prototype.createUniqueSource
     * @description åå»ºåå¼å¾å±çsource
     * @param {Object} parameters- å¾å±ä¿¡æ¯
     * @param {Array} features - feature æ°ç»
     * @returns {{map: *, style: *, isHoverAble: *, highlightStyle: *, themeField: *, styleGroups: Array}}
     */
    createUniqueSource(parameters, features) {
        //æ¾å°åéçä¸é¢å­æ®µ
        let styleGroup = this.getUniqueStyleGroup(parameters, features);
        return {
            map: this.map, //å¿ä¼ åæ° APIå±ç¶ä¸æç¤º
            style: parameters.style,
            isHoverAble: parameters.isHoverAble,
            highlightStyle: parameters.highlightStyle,
            themeField: parameters.themeSetting.themeField,
            styleGroups: styleGroup
        };
    }

    /**
     * @private
     * @function WebMap.prototype.getUniqueStyleGroup
     * @description è·ååå¼ä¸é¢å¾çstyleGroup
     * @param {Object} parameters- å¾å±ä¿¡æ¯
     * @param {Array} features - feature æ°ç»
     * @returns {Array} åå¼æ ·å¼
     */
    getUniqueStyleGroup(parameters, features) {
        // æ¾åºææçåå¼
        let featureType = parameters.featureType,
            style = parameters.style,
            themeSetting = parameters.themeSetting;
        let fieldName = themeSetting.themeField;

        let names = [],
            customSettings = themeSetting.customSettings;
        for (let i in features) {
            let attributes = features[i].get('attributes');
            let name = attributes[fieldName];
            let isSaved = false;
            for (let j in names) {
                if (names[j] === name) {
                    isSaved = true;
                    break;
                }
            }
            if (!isSaved) {
                names.push(name);
            }
        }


        //çæstyleGroup
        let styleGroup = [];
        names.forEach(function (name, index) {
            //å¼å®¹ä¹åèªå®ä¹æ¯ç¨keyï¼ç°å¨å ä¸ºæ°æ®æ¯æç¼è¾ï¼éè¦ç¨å±æ§å¼ã
            let key = this.webMapVersion === "1.0" ? index : name;
            let custom = customSettings[key];
            if(core_Util_Util.isString(custom)) {
                //å¼å®¹ä¹åèªå®ä¹åªå­å¨ä¸ä¸ªcolor
                custom = this.getCustomSetting(style, custom, featureType);
                customSettings[key] = custom;
            }

            // è½¬åæ ol æ ·å¼
            let olStyle, type = custom.type;
            if(type === 'SYMBOL_POINT') {
                olStyle = StyleUtils.getSymbolStyle(custom);
            } else if(type === 'SVG_POINT') {
                olStyle = StyleUtils.getSVGStyle(custom);
            } else if(type === 'IMAGE_POINT') {
                olStyle = StyleUtils.getImageStyle(custom);
            } else {
                olStyle = StyleUtils.toOpenLayersStyle(custom, featureType);
            }
            styleGroup.push({
                olStyle: olStyle,
                style: customSettings[key],
                value: name
            });
        }, this);

        return styleGroup;
    }

    /**
     * @description è·ååå¼ä¸é¢å¾èªå®ä¹æ ·å¼å¯¹è±¡
     * @param {Object} style - å¾å±ä¸çæ ·å¼
     * @param {string} color - åå¼å¯¹åºçé¢è²
     * @param {string} featureType - è¦ç´ ç±»å
     */
    getCustomSetting(style, color, featureType) {
        let newProps = {};
        if (featureType === "LINE") {
            newProps.strokeColor = color;
        } else {
            newProps.fillColor = color;
        }
        let customSetting = Object.assign(style, newProps)
        return customSetting;
    }

    /**
     * @private
     * @function WebMap.prototype.createRangeLayer
     * @description åå»ºåæ®µå¾å±
     * @param {Object} layerInfo- å¾å±ä¿¡æ¯
     * @param {Array} features - ææfeatureç»å
     * @returns {ol.layer.Vector} åå¼å¾å±
     */
    createRangeLayer(layerInfo, features) {
        //è¿éè·åstyleGroupè¦ç¨æä»¥çfeature
        let styleSource = this.createRangeSource(layerInfo, features);
        let layer = new external_ol_layer_namespaceObject.Vector({
            styleSource: styleSource,
            source: new (external_ol_source_Vector_default())({
                features: layerInfo.filterCondition ? this.getFiterFeatures(layerInfo.filterCondition, features) : features,
                wrapX: false
            })
        });

        layer.setStyle(feature => {
            let styleSource = layer.get('styleSource');
            if (styleSource) {
                let labelField = styleSource.themeField;
                let value = Number(feature.get('attributes')[labelField.trim()]);
                let styleGroups = styleSource.styleGroups;
                for (let i = 0; i < styleGroups.length; i++) {
                    if (i === 0) {
                        if (value >= styleGroups[i].start && value <= styleGroups[i].end) {
                            return styleGroups[i].olStyle;
                        }
                    } else {
                        if (value > styleGroups[i].start && value <= styleGroups[i].end) {
                            return styleGroups[i].olStyle;
                        }
                    }
                }
            }
        });

        return layer;
    }

    /**
     * @private
     * @function WebMap.prototype.createRangeSource
     * @description åå»ºåæ®µä¸é¢å¾çå¾å±source
     * @param {Object} parameters- å¾å±ä¿¡æ¯
     * @param {Array} features - æä»¥çfeatureéå
     * @returns {Object} å¾å±source
     */
    createRangeSource(parameters, features) {
        //æ¾å°åéçä¸é¢å­æ®µ
        let styleGroup = this.getRangeStyleGroup(parameters, features);
        if (styleGroup) {
            return {
                style: parameters.style,
                themeField: parameters.themeSetting.themeField,
                styleGroups: styleGroup
            };
        } else {
            return false;
        }
    }

    /**
     * @private
     * @function WebMap.prototype.getRangeStyleGroup
     * @description è·ååæ®µä¸é¢å¾çstyleGroupæ ·å¼
     * @param {Object} parameters- å¾å±ä¿¡æ¯
     * @param {Array} features - æä»¥çfeatureéå
     * @returns {Array} styleGroups
     */
    getRangeStyleGroup(parameters, features) {
        // æ¾åºåæ®µå¼
        let featureType = parameters.featureType,
            themeSetting = parameters.themeSetting,
            style = parameters.style;
        let count = themeSetting.segmentCount,
            method = themeSetting.segmentMethod,
            colors = themeSetting.colors,
            customSettings = themeSetting.customSettings,
            fieldName = themeSetting.themeField;
        let values = [],
            attributes;
        let segmentCount = count;
        let segmentMethod = method;
        let that = this;
        features.forEach(function (feature) {
            attributes = feature.get("attributes");
            try {
                if (attributes) {
                    //è¿æ»¤æéæ°å¼çæ°æ®
                    let value = attributes[fieldName.trim()];
                    if (value !== undefined && value !== null && core_Util_Util.isNumber(value)) {
                        values.push(parseFloat(value));
                    }
                } else if (feature.get(fieldName) && core_Util_Util.isNumber(feature.get(fieldName))) {
                    if (feature.get(fieldName)) {
                        values.push(parseFloat(feature.get(fieldName)));
                    }
                }
            } catch (e) {
                that.errorCallback && that.errorCallback(e);
            }

        });

        let segements;
        try {
            segements = ArrayStatistic.getArraySegments(values, segmentMethod, segmentCount);
        } catch (e) {
            that.errorCallback && that.errorCallback(e);
        }
        if (segements) {
            let itemNum = segmentCount;
            if (attributes && segements[0] === segements[attributes.length - 1]) {
                itemNum = 1;
                segements.length = 2;
            }

            //ä¿çä¸¤ä½æææ°
            for (let key in segements) {
                let value = segements[key];
                if (Number(key) === 0) {
                    // æå°çå¼ä¸èå¥,è¦ç¨ä¸¤ä¸ªç­äºå·ãå¦åæäºå¼å¤æ­ä¸å¯¹
                    value = Math.floor(value * 100) / 100;
                } else {
                    // å¶ä½ä¸èå¥
                    value = Math.ceil(value * 100) / 100 + 0.1; // å 0.1 è§£å³æå¤§å¼æ²¡ææ ·å¼é®é¢
                }

                segements[key] = Number(value.toFixed(2));
            }

            //è·åä¸å®éçé¢è²
            let curentColors = colors;
            curentColors = ColorsPickerUtil.getGradientColors(curentColors, itemNum, 'RANGE');

            for (let index = 0; index < itemNum; index++) {
                if (index in customSettings) {
                    if (customSettings[index]["segment"]["start"]) {
                        segements[index] = customSettings[index]["segment"]["start"];
                    }
                    if (customSettings[index]["segment"]["end"]) {
                        segements[index + 1] = customSettings[index]["segment"]["end"];
                    }
                }
            }
            //çæstyleGroup
            let styleGroups = [];
            for (let i = 0; i < itemNum; i++) {
                let color = curentColors[i];
                if (i in customSettings) {
                    if (customSettings[i].color) {
                        color = customSettings[i].color;
                    }
                }
                if (featureType === "LINE") {
                    style.strokeColor = color;
                } else {
                    style.fillColor = color;
                }

                // è½¬åæ ol æ ·å¼
                let olStyle = StyleUtils.toOpenLayersStyle(style, featureType);

                let start = segements[i];
                let end = segements[i + 1];

                styleGroups.push({
                    olStyle: olStyle,
                    color: color,
                    start: start,
                    end: end
                });
            }

            return styleGroups;
        } else {
            return false;
        }
    }

    /**
     * @private
     * @function WebMap.prototype.createMarkerLayer
     * @description åå»ºæ æ³¨å¾å±
     * @param {Array} features - æä»¥çfeatureéå
     * @returns {ol.layer.Vector} ç¢éå¾å±
     */
    createMarkerLayer(features) {
        features && this.setEachFeatureDefaultStyle(features);
        return new external_ol_layer_namespaceObject.Vector({
            source: new (external_ol_source_Vector_default())({
                features: features,
                wrapX: false
            })
        });
    }

    /**
     * @private
     * @function WebMap.prototype.createDataflowLayer
     * @description åå»ºæ°æ®æµå¾å±
     * @param {Object} layerInfo- å¾å±ä¿¡æ¯
     * @param {number} layerIndex - å¾å±çzindex
     * @returns {ol.layer.Vector} æ°æ®æµå¾å±
     */
    createDataflowLayer(layerInfo, layerIndex) {
        let layerStyle = layerInfo.pointStyle, style;
        //è·åæ ·å¼
        style = StyleUtils.getOpenlayersStyle(layerStyle, layerInfo.featureType);

        let source = new (external_ol_source_Vector_default())({
            wrapX: false
        }), labelLayer, labelSource, pathLayer, pathSource;
        let layer = new external_ol_layer_namespaceObject.Vector({
            styleOL: style,
            source: source
        });
        if (layerInfo.labelStyle && layerInfo.visible) {
            //ææ ç­¾å¾å±
            labelLayer = this.addLabelLayer(layerInfo);
            //åç¼è¾é¡µé¢ä¿æä¸è´
            labelLayer.setZIndex(1000);
            labelSource = labelLayer.getSource();
        }
        const {visibleScale} = layerInfo;
        if (layerInfo.lineStyle && layerInfo.visible) {
            pathLayer = this.createVectorLayer({style: layerInfo.lineStyle, featureType: "LINE"});
            pathSource = pathLayer.getSource();
            pathLayer.setZIndex(layerIndex);
            this.map.addLayer(pathLayer);
            visibleScale && this.setVisibleScales(pathLayer, visibleScale);
            // æè½½å°layerInfoä¸ï¼ä¾¿äºå é¤
            layerInfo.pathLayer = pathLayer;
        }
        let featureCache = {}, labelFeatureCache = {}, pathFeatureCache = {}, that = this;
        this.createDataflowService(layerInfo, function (featureCache, labelFeatureCache, pathFeatureCache) {
            return function (feature) {
                that.events.triggerEvent('updateDataflowFeature', {
                    feature: feature,
                    identifyField: layerInfo.identifyField,
                    layerID: layerInfo.layerID
                });
                if (layerInfo.filterCondition) {
                    //è¿æ»¤æ¡ä»¶
                    let condition = that.parseFilterCondition(layerInfo.filterCondition);
                    let sql = "select * from json where (" + condition + ")";
                    let filterResult = window.jsonsql.query(sql, {
                        attributes: feature.get('attributes')
                    });
                    if (filterResult && filterResult.length > 0) {
                        that.addDataflowFeature(feature, layerInfo.identifyField, {
                            dataflowSource: source,
                            featureCache: featureCache,
                            labelSource: labelSource,
                            labelFeatureCache: labelFeatureCache,
                            pathSource: pathSource,
                            pathFeatureCache: pathFeatureCache,
                            maxPointCount: layerInfo.maxPointCount
                        });
                    }
                } else {
                    that.addDataflowFeature(feature, layerInfo.identifyField, {
                        dataflowSource: source,
                        featureCache: featureCache,
                        labelSource: labelSource,
                        labelFeatureCache: labelFeatureCache,
                        pathSource: pathSource,
                        pathFeatureCache: pathFeatureCache,
                        maxPointCount: layerInfo.maxPointCount
                    });
                }
            }
        }(featureCache, labelFeatureCache, pathFeatureCache));
        this.setFeatureStyle(layer, layerInfo.directionField, layerStyle.type);
        return layer;
    }

    /**
     * @private
     * @function WebMap.prototype.addDataflowFeature
     * @description æ·»å æ°æ®æµçfeature
     * @param {Object} feature - æå¡å¨æ´æ°çfeature
     * @param {string} identifyField - æ è¯featureçå­æ®µ
     * @param {Object} options - å¶ä»åæ°
     */
    addDataflowFeature(feature, identifyField, options) {
        options.dataflowSource && this.addFeatureFromDataflowService(options.dataflowSource, feature, identifyField, options.featureCache);
        options.labelSource && this.addFeatureFromDataflowService(options.labelSource, feature, identifyField, options.labelFeatureCache);
        options.pathSource && this.addPathFeature(options.pathSource, feature, identifyField, options.pathFeatureCache, options.maxPointCount);
    }
    /**
     * @private
     * @function WebMap.prototype.addPathFeature
     * @description æ·»å æ°æ®æµå¾å±ä¸­è½¨è¿¹çº¿çfeature
     * @param {Object} source - è½¨è¿¹çº¿å¾å±çsource
     * @param {Object} feature - è½¨è¿¹çº¿feature
     * @param {string} identifyField - æ è¯featureçå­æ®µ
     * @param {Object} featureCache - å­å¨feature
     * @param {number} maxPointCount - è½¨è¿¹çº¿æå¤ç¹ä¸ªæ°æ°é
     */
    addPathFeature(source, feature, identifyField, featureCache, maxPointCount) {
        let coordinates = [];
        var geoID = feature.get(identifyField);
        if (featureCache[geoID]) {
            //å è¿feautre
            coordinates = featureCache[geoID].getGeometry().getCoordinates();
            coordinates.push(feature.getGeometry().getCoordinates());
            if (maxPointCount && coordinates.length > maxPointCount) {
                coordinates.splice(0, coordinates.length - maxPointCount);
            }
            featureCache[geoID].getGeometry().setCoordinates(coordinates);
        } else {
            coordinates.push(feature.getGeometry().getCoordinates());
            featureCache[geoID] = new (external_ol_Feature_default())({
                geometry: new external_ol_geom_namespaceObject.LineString(coordinates)
            });
            source.addFeature(featureCache[geoID]);
        }
    }

    /**
     * @private
     * @function WebMap.prototype.setFeatureStyle
     * @description è®¾ç½®featureæ ·å¼
     * @param {Object} layer - å¾å±å¯¹è±¡
     * @param {string} directionField - æ¹åå­æ®µ
     * @param {string} styleType - æ ·å¼çç±»å
     */
    setFeatureStyle(layer, directionField, styleType) {
        let layerStyle = layer.get('styleOL');
        layer.setStyle(feature => {
            //æè½¬åå­æ®µ
            let value, image;
            if (directionField !== undefined && directionField !== "æªè®¾ç½®" && directionField !== "None") {
                value = feature.get('attributes')[directionField];
            } else {
                value = 0;
            }
            if (value > 360 || value < 0) {
                return null;
            }
            if (styleType === "SYMBOL_POINT") {
                image = layerStyle.getText();
            } else {
                image = layerStyle.getImage();
            }
            //é»è®¤ç¨æ·ä½¿ç¨çæ¯è§åº¦ï¼æ¢ç®æå¼§åº¦
            let rotate = (Math.PI * value) / 180;
            image && image.setRotation(rotate);
            return layerStyle;
        });
    }

    /**
     * @private
     * @function WebMap.prototype.createDataflowHeatLayer
     * @description åå»ºæ°æ®æµæå¡çç­åå¾å¾å±
     * @param {Object} layerInfo - å¾å±åæ°
     * @returns {ol.layer.Heatmap} ç­åå¾å¾å±å¯¹è±¡
     */
    createDataflowHeatLayer(layerInfo) {
        let source = this.createDataflowHeatSource(layerInfo);
        let layerOptions = {
            source: source
        };
        layerOptions.gradient = layerInfo.themeSetting.colors.slice();
        layerOptions.radius = parseInt(layerInfo.themeSetting.radius);

        if (layerInfo.themeSetting.customSettings) {
            let customSettings = layerInfo.themeSetting.customSettings;
            for (let i in customSettings) {
                layerOptions.gradient[i] = customSettings[i];
            }
        }
        return new external_ol_layer_namespaceObject.Heatmap(layerOptions);
    }

    /**
     * @private
     * @function WebMap.prototype.createDataflowHeatSource
     * @description åå»ºæ°æ®æµæå¡çç­åå¾çsource
     * @param {Object} layerInfo - å¾å±åæ°
     * @returns {ol.souce.Vector} ç­åå¾sourceå¯¹è±¡
     */
    createDataflowHeatSource(layerInfo) {
        let that = this,
            source = new (external_ol_source_Vector_default())({
                wrapX: false
            });
        let featureCache = {};
        this.createDataflowService(layerInfo, function (featureCache) {
            return function (feature) {
                if (layerInfo.filterCondition) {
                    //è¿æ»¤æ¡ä»¶
                    let condition = that.parseFilterCondition(layerInfo.filterCondition);
                    let sql = "select * from json where (" + condition + ")";
                    let filterResult = window.jsonsql.query(sql, {
                        attributes: feature.get('attributes')
                    });
                    if (filterResult && filterResult.length > 0) {
                        that.addDataflowFeature(feature, layerInfo.identifyField, {
                            dataflowSource: source,
                            featureCache: featureCache
                        });
                    }
                } else {
                    that.addDataflowFeature(feature, layerInfo.identifyField, {
                        dataflowSource: source,
                        featureCache: featureCache
                    });
                }
                // æéå­æ®µæ¢å¤
                if (layerInfo.themeSetting.weight) {
                    that.changeWeight(source.getFeatures(), layerInfo.themeSetting.weight);
                }
            }
        }(featureCache));
        return source;
    }

    /**
     * @private
     * @function WebMap.prototype.addFeatureFromDataflowService
     * @description å°featureæ·»å å°æ°æ®æµå¾å±
     * @param {Object} source - å¾å±å¯¹åºçsource
     * @param {Object} feature - éè¦æ·»å å°å¾å±çfeature
     * @param {Object} identifyField - featureçæ è¯å­æ®µ
     * @param {Object} featureCache - å­å¨å·²æ·»å å°å¾å±çfeatureå¯¹è±¡
     */
    addFeatureFromDataflowService(source, feature, identifyField, featureCache) {
        //å¤æ­æ¯å¦æè¿ä¸ªfeatureï¼å­å¨featureå°±æ´æ°ä½ç½®ã
        var geoID = feature.get(identifyField);
        if (geoID !== undefined && featureCache[geoID]) {
            /*if(that.addFeatureFinish) {
                //featureå¨é½å ä¸å¾å±ï¼å°±ç¼©æ¾èå´
                MapManager.zoomToExtent(LayerUtil.getBoundsFromFeatures(source.getFeatures()));
                that.addFeatureFinish = false;
            }*/
            featureCache[geoID].setGeometry(feature.getGeometry());
            featureCache[geoID].setProperties(feature.getProperties());
            source.changed();
        } else {
            source.addFeature(feature);
            featureCache[geoID] = feature;
        }
    }
    /**
     * @private
     * @function WebMap.prototype.createDataflowService
     * @description å°featureæ·»å å°æ°æ®æµå¾å±
     * @param {Object} layerInfo - å¾å±åæ°
     * @param {Object} callback - åè°å½æ°
     */
    createDataflowService(layerInfo, callback) {
        let that = this;
        let dataflowService = new DataFlowService(layerInfo.wsUrl).initSubscribe();
        dataflowService.on('messageSucceeded', function (e) {
            let geojson = JSON.parse(e.value.data);
            let feature = transformTools.readFeature(geojson, {
                dataProjection: layerInfo.projection || "EPSG:4326",
                featureProjection: that.baseProjection || 'EPSG:4326'
            });
            feature.setProperties({attributes: geojson.properties});
            callback(feature);
        });
        layerInfo.dataflowService = dataflowService;
    }

    /**
     * @private
     * @function WebMap.prototype.setEachFeatureDefaultStyle
     * @description ä¸ºæ æ³¨å¾å±ä¸çfeatureè®¾ç½®æ ·å¼
     * @param {Array} features - æä»¥çfeatureéå
     */
    setEachFeatureDefaultStyle(features) {
        let that = this;
        features = (core_Util_Util.isArray(features) || features instanceof (external_ol_Collection_default())) ? features : [features];
        features.forEach(function (feature) {
            let geomType = feature.getGeometry().getType().toUpperCase();
            // let styleType = geomType === "POINT" ? 'MARKER' : geomType;
            let defaultStyle = feature.getProperties().useStyle;
            if (defaultStyle) {
                if (geomType === 'POINT' && defaultStyle.text) {
                    //è¯´ææ¯æå­çfeatureç±»å
                    geomType = "TEXT";
                }
                let attributes = that.setFeatureInfo(feature);
                feature.setProperties({
                    useStyle: defaultStyle,
                    attributes
                });
                //æ æ³¨å¾å±çfeatureä¸éè¦å­ä¸ä¸ªlayerIdï¼ä¸ºäºä¹åæ ·å¼åºç¨å°å¾å±ä¸ä½¿ç¨
                // feature.layerId = timeId;
                if (geomType === 'POINT' && defaultStyle.src &&
                    defaultStyle.src.indexOf('http://') === -1 && defaultStyle.src.indexOf('https://') === -1) {
                    //è¯´æå°åä¸å®æ´
                    defaultStyle.src = that.server + defaultStyle.src;
                }
            } else {
                defaultStyle = StyleUtils.getMarkerDefaultStyle(geomType, that.server);
            }
            feature.setStyle(StyleUtils.toOpenLayersStyle(defaultStyle, geomType))
        }, this)
    }

    /**
     * @private
     * @function WebMap.prototype.setFeatureInfo
     * @description ä¸ºfeatureè®¾ç½®å±æ§
     * @param {Array} feature - åä¸ªfeature
     * @returns {Object} å±æ§
     */
    setFeatureInfo(feature) {
        let attributes = feature.get('attributes'),
            defaultAttr = {
                dataViz_title: '',
                dataViz_description: '',
                dataViz_imgUrl: '',
                dataViz_url: ''
            },
            newAttribute = Object.assign(defaultAttr, attributes);
        let properties = feature.getProperties();
        for (let key in newAttribute) {
            if (properties[key]) {
                newAttribute[key] = properties[key];
                delete properties[key];
            }
        }
        return newAttribute;
    }

    /**
     * @private
     * @function WebMap.prototype.createRankSymbolLayer
     * @description åå»ºç­çº§ç¬¦å·å¾å±
     * @param {Object} layerInfo - å¾å±ä¿¡æ¯
     * @param {Array} features - æ·»å å°å¾å±ä¸çfeatures
     * @returns {ol.layer.Vector} ç¢éå¾å±
     */
    createRankSymbolLayer(layerInfo, features) {
        let styleSource = this.createRankStyleSource(layerInfo, features, layerInfo.featureType);
        let layer = new external_ol_layer_namespaceObject.Vector({
            styleSource,
            source: new (external_ol_source_Vector_default())({
                features: layerInfo.filterCondition ? this.getFiterFeatures(layerInfo.filterCondition, features) : features,
                wrapX: false
            }),
            renderMode: 'image'
        });
        layer.setStyle(feature => {
            let styleSource = layer.get('styleSource');
            let themeField = styleSource.parameters.themeSetting.themeField;
            let value = Number(feature.get('attributes')[themeField]);
            let styleGroups = styleSource.styleGroups;
            for (let i = 0, len = styleGroups.length; i < len; i++) {
                if (value >= styleGroups[i].start && value < styleGroups[i].end) {
                    return styleSource.styleGroups[i].olStyle;
                }
            }
        });
        return layer;
    }
    /**
     * @private
     * @function WebMap.prototype.createRankSymbolLayer
     * @description åå»ºç­çº§ç¬¦å·å¾å±çsource
     * @param {Object} parameters - å¾å±ä¿¡æ¯
     * @param {Array} features - æ·»å å°å¾å±ä¸çfeatures
     * @param {string} featureType - featureçç±»å
     * @returns {Object} styleGroups
     */
    createRankStyleSource(parameters, features, featureType) {
        let themeSetting = parameters.themeSetting,
            themeField = themeSetting.themeField;
        let styleGroups = this.getRankStyleGroup(themeField, features, parameters, featureType);
        return styleGroups ? {parameters, styleGroups} : false
    }
    /**
     * @private
     * @function WebMap.prototype.getRankStyleGroup
     * @description è·åç­çº§ç¬¦å·çstyle
     * @param {string} themeField - åæ®µå­æ®µ
     * @param {Array} features - æ·»å å°å¾å±ä¸çfeatures
     * @param {Object} parameters - å¾å±åæ°
     * @param {string} featureType - featureçç±»å
     * @returns {Array} stylegroup
     */
    getRankStyleGroup(themeField, features, parameters, featureType) {
        // æ¾åºææçåå¼
        let values = [],
            segements = [],
            style = parameters.style,
            themeSetting = parameters.themeSetting,
            segmentMethod = themeSetting.segmentMethod || this.defaultParameters.themeSetting.segmentMethod,
            segmentCount = themeSetting.segmentCount || this.defaultParameters.themeSetting.segmentCount,
            customSettings = themeSetting.customSettings,
            minR = parameters.themeSetting.minRadius,
            maxR = parameters.themeSetting.maxRadius,
            fillColor = style.fillColor,
            colors = parameters.themeSetting.colors;
        features.forEach(feature => {
            let attributes = feature.get('attributes'),
                value = attributes[themeField];
            // è¿æ»¤æç©ºå¼åéæ°å¼
            if (value == null || !core_Util_Util.isNumber(value)) {
                return;
            }
            values.push(Number(value));
        });
        try {
            segements = ArrayStatistic.getArraySegments(values, segmentMethod, segmentCount);
        } catch (error) {
            console.error(error);
        }

        // å¤çèªå®ä¹ åæ®µ
        for (let i = 0; i < segmentCount; i++) {
            if (i in customSettings) {
                let startValue = customSettings[i]['segment']['start'],
                    endValue = customSettings[i]['segment']['end'];
                startValue != null && (segements[i] = startValue);
                endValue != null && (segements[i + 1] = endValue);
            }
        }

        //çæstyleGroup
        let styleGroup = [];
        if (segements && segements.length) {
            let len = segements.length,
                incrementR = (maxR - minR) / (len - 1), // åå¾å¢é
                start, end, radius = Number(((maxR + minR) / 2).toFixed(2));
            // è·åé¢è²
            let rangeColors = colors ? ColorsPickerUtil.getGradientColors(colors, len, 'RANGE') : [];
            for (let j = 0; j < len - 1; j++) {
                start = Number(segements[j].toFixed(2));
                end = Number(segements[j + 1].toFixed(2));
                // è¿éç¹æ®å¤çä»¥ä¸åæ®µå¼ç¸åçæåµï¼å³ææå­æ®µå¼ç¸åï¼
                radius = start === end ? radius : minR + Math.round(incrementR * j);
                // æåä¸ä¸ªåæ®µæ¶å°end+0.01ï¼é¿ååä¸å°æå¤§å¼
                end = j === len - 2 ? end + 0.01 : end;
                // å¤çèªå®ä¹ åå¾
                radius = customSettings[j] && customSettings[j].radius ? customSettings[j].radius : radius;
                // è½¬åæ ol æ ·å¼
                style.radius = radius;
                style.fillColor = customSettings[j] && customSettings[j].color ? customSettings[j].color : rangeColors[j] || fillColor;
                let olStyle = StyleUtils.getOpenlayersStyle(style, featureType, true);
                styleGroup.push({olStyle: olStyle, radius, start, end, fillColor: style.fillColor});
            }
            return styleGroup;
        } else {
            return false;
        }
    }

    /**
     * @private
     * @function WebMap.prototype.checkUploadToRelationship
     * @description æ£æ¥æ¯å¦ä¸ä¼ å°å³ç³»å
     * @param {string} fileId - æä»¶çid
     * @returns {Promise<T | never>} å³ç³»åæä»¶ä¸äºåæ°
     */
    checkUploadToRelationship(fileId) {
        let url = this.getRequestUrl(`${this.server}web/datas/${fileId}/datasets.json`);
        return FetchRequest.get(url, null, {
            withCredentials: this.withCredentials
        }).then(function (response) {
            return response.json()
        }).then(function (result) {
            return result;
        });
    }
    /**
     * @private
     * @function WebMap.prototype.getDatasources
     * @description è·åå³ç³»åæä»¶åå¸çæ°æ®æå¡ä¸­æ°æ®æºçåç§°
     * @param {string} url - è·åæ°æ®æºä¿¡æ¯çurl
     *  @returns {Promise<T | never>} æ°æ®æºåç§°
     */
    getDatasources(url) {
        let requestUrl = this.getRequestUrl(`${url}/data/datasources.json`);
        return FetchRequest.get(requestUrl, null, {
            withCredentials: this.withCredentials
        }).then(function (response) {
            return response.json()
        }).then(function (datasource) {
            let datasourceNames = datasource.datasourceNames;
            return datasourceNames[0];
        });

    }
    /**
     * @private
     * @function WebMap.prototype.getDataService
     * @description è·åä¸ä¼ çæ°æ®ä¿¡æ¯
     * @param {string} fileId - æä»¶id
     * @param {string} datasetName æ°æ®æå¡çæ°æ®éåç§°
     *  @returns {Promise<T | never>} æ°æ®çä¿¡æ¯
     */
    getDataService(fileId, datasetName) {
        let url = this.getRequestUrl(`${this.server}web/datas/${fileId}.json`);
        return FetchRequest.get(url, null, {
            withCredentials: this.withCredentials
        }).then(function (response) {
            return response.json()
        }).then(function (result) {
            result.fileId = fileId;
            result.datasetName = datasetName;
            return result;
        });
    }

    /**
     * @private
     * @function WebMap.prototype.getRootUrl
     * @description è·åè¯·æ±å°å
     * @param {string} url è¯·æ±çå°å
     * @param {boolean} è¯·æ±æ¯å¦å¸¦ä¸Credential.
     * @returns {Promise<T | never>} è¯·æ±å°å
     */
    getRequestUrl(url, excludeCreditial) {
        url = excludeCreditial ? url : this.formatUrlWithCredential(url);
        //å¦æä¼ å¥è¿æ¥çurlå¸¦äºä»£çåä¸éè¦å¤ç
        if (this.excludePortalProxyUrl) {
            return;
        }
        return Util.isInTheSameDomain(url) ? url : `${this.getProxy()}${encodeURIComponent(url)}`;
    }

    /**
     * @description ç»urlå¸¦ä¸å­è¯å¯é¥
     * @param {string} url - å°å
     */
    formatUrlWithCredential(url) {
        if (this.credentialValue) {
            //ætokenä¹ç±»çéç½®é¡¹
            url = url.indexOf("?") === -1 ? `${url}?${this.credentialKey}=${this.credentialValue}` :
                `${url}&${this.credentialKey}=${this.credentialValue}`;
        }
        return url;
    }

    /**
     * @private
     * @function WebMap.prototype.getProxy
     * @description è·åä»£çå°å
     * @returns {Promise<T | never>} ä»£çå°å
     */
    getProxy(type) {
        if (!type) {
            type = 'json';
        }
        return this.proxy || this.server + `apps/viewer/getUrlResource.${type}?url=`;
    }

    /**
     * @private
     * @function WebMap.prototype.getTileLayerInfo
     * @description è·åå°å¾æå¡çä¿¡æ¯
     * @param {string} url å°å¾æå¡çurlï¼æ²¡æå°å¾åå­ï¼
     * @returns {Promise<T | never>} å°å¾æå¡ä¿¡æ¯
     */
    getTileLayerInfo(url) {
        let that = this, epsgCode = that.baseProjection.split('EPSG:')[1];
        let requestUrl = that.getRequestUrl(`${url}/maps.json`);
        return FetchRequest.get(requestUrl, null, {
            withCredentials: this.withCredentials
        }).then(function (response) {
            return response.json()
        }).then(function (mapInfo) {
            let promises = [];
            if (mapInfo) {
                mapInfo.forEach(function (info) {
                    let mapUrl = that.getRequestUrl(`${info.path}.json?prjCoordSys=${encodeURI(JSON.stringify({epsgCode: epsgCode}))}`)
                    let promise = FetchRequest.get(mapUrl, null, {
                        withCredentials: that.withCredentials
                    }).then(function (response) {
                        return response.json()
                    }).then(function (restMapInfo) {
                        restMapInfo.url = info.path;
                        return restMapInfo
                    });
                    promises.push(promise);
                });
            }
            return Promise.all(promises).then(function (allRestMaps) {
                return allRestMaps
            })
        });
    }

    /**
     * éè¿wktåæ°æ©å±æ¯æå¤åæ ç³»
     *
     * @param {string} wkt å­ç¬¦ä¸²
     * @param {string} crsCode epsgä¿¡æ¯ï¼å¦ï¼ "EPSG:4490"
     *
     * @returns {boolean} åæ ç³»æ¯å¦æ·»å æå
     */
    addProjctionFromWKT(wkt, crsCode) {
        if (typeof (wkt) !== 'string') {
            //åæ°ç±»åéè¯¯
            return false;
        } else {
            if (wkt === "EPSG:4326" || wkt === "EPSG:3857") {
                return true;
            } else {
                let epsgCode = crsCode || this.getEpsgInfoFromWKT(wkt);
                if (epsgCode) {
                    lib.defs(epsgCode, wkt);
                    // éæ°æ³¨åproj4å°ol.projï¼ä¸ç¶ä¸ä¼çæ
                    if (external_ol_proj_proj4_namespaceObject && external_ol_proj_proj4_namespaceObject.register) {
                        external_ol_proj_proj4_namespaceObject.register(lib);
                    } else if (window.ol.proj && window.ol.proj.setProj4) {
                        window.ol.proj.setProj4(lib)
                    }
                    return true;
                } else {
                    // åæ°ç±»åéwktæ å
                    return false;
                }
            }
        }
    }

    /**
     * éè¿wktåæ°è·ååæ ä¿¡æ¯
     *
     * @param {string} wkt å­ç¬¦ä¸²
     * @returns {string} epsg å¦ï¼"EPSG:4326"
     */
    getEpsgInfoFromWKT(wkt) {
        if (typeof (wkt) !== 'string') {
            return false;
        } else if (wkt.indexOf("EPSG") === 0) {
            return wkt;
        } else {
            let lastAuthority = wkt.lastIndexOf("AUTHORITY") + 10,
                endString = wkt.indexOf("]", lastAuthority) - 1;
            if (lastAuthority > 0 && endString > 0) {
                return `EPSG:${wkt.substring(lastAuthority, endString).split(",")[1].substr(1)}`;
            } else {
                return false;
            }
        }
    }

    /**
     * @private
     * @function WebMap.prototype.createMigrationLayer
     * @description åå»ºè¿å¾å¾
     * @param {Object} layerInfo å¾å±ä¿¡æ¯
     * @param {Array} features è¦ç´ æ°ç»
     * @returns {ol.layer} å¾å±
     */
    createMigrationLayer(layerInfo, features) {
        // è·åå¾å±å¤åDOM
        if (!window.EChartsLayer.prototype.getContainer) {
            window.EChartsLayer.prototype.getContainer = function () {
                return this.$container;
            };
        }
        // è®¾ç½®å¾å±å¯è§æ§
        if (!window.EChartsLayer.prototype.setVisible) {
            window.EChartsLayer.prototype.setVisible = function (visible) {
                if (visible) {
                    let options = this.get('options');
                    if (options) {
                        this.setChartOptions(options);
                        this.unset('options');
                    }
                } else {
                    let options = this.getChartOptions();
                    this.set('options', options);
                    this.clear();
                    this.setChartOptions({});
                }
            };
        }
        // è®¾ç½®å¾å±å±çº§
        if (!window.EChartsLayer.prototype.setZIndex) {
            window.EChartsLayer.prototype.setZIndex = function (zIndex) {
                let container = this.getContainer();
                if (container) {
                    container.style.zIndex = zIndex;
                }
            };
        }
        /**
         * è®¾ç½®é¼ æ æ ·å¼
         * .cursor-default > div {
         *     cursor: default !important;
         * }
         */
        if (!window.EChartsLayer.prototype.setCursor) {
            window.EChartsLayer.prototype.setCursor = function (cursor = 'default') {
                let container = this.getContainer();
                if (container && cursor === 'default') {
                    container.classList.add('cursor-default');
                }
            }
        }
        let properties = getFeatureProperties(features);
        let lineData = this.createLinesData(layerInfo, properties);
        let pointData = this.createPointsData(lineData, layerInfo, properties);
        let options = this.createOptions(layerInfo, lineData, pointData);
        let layer = new window.EChartsLayer(options, {
            // hideOnMoving: true,
            // hideOnZooming: true
            //ä»¥ä¸ä¸ä¸ªåæ°ï¼å¦æä¸æç§è¿æ ·è®¾ç½®ï¼ä¼é æä¸å¯è§å¾å±æ¶ï¼ç¼©æ¾è¿ä¼åºç°å¾å±
            hideOnMoving: false,
            hideOnZooming: false,
            forcedPrecomposeRerender: true
        });
        layer.type = 'ECHARTS';
        return layer;
    }

    /**
     * @private
     * @function WebMap.prototype.createOptions
     * @description åå»ºechartsçoptions
     * @param {Object} layerInfo å¾å±ä¿¡æ¯
     * @param {Array} lineData çº¿æ°æ®
     * @param {Array} pointData ç¹æ°æ®
     * @returns {Object} echartsåæ°
     */
    createOptions(layerInfo, lineData, pointData) {
        let series;
        let lineSeries = this.createLineSeries(layerInfo, lineData);
        if (pointData && pointData.length) {
            let pointSeries = this.createPointSeries(layerInfo, pointData);
            series = lineSeries.concat(pointSeries);
        } else {
            series = lineSeries.slice();
        }
        let options = {
            series
        }
        return options;
    }

    /**
     * @private
     * @function WebMap.prototype.createLineSeries
     * @description åå»ºçº¿ç³»å
     * @param {Object} layerInfo å¾å±åæ°
     * @param {Array} lineData çº¿æ°æ®
     * @returns {Object} çº¿ç³»å
     */
    createLineSeries(layerInfo, lineData) {
        let lineSetting = layerInfo.lineSetting;
        let animationSetting = layerInfo.animationSetting;
        let linesSeries = [
            // è½¨è¿¹çº¿æ ·å¼
            {
                name: 'line-series',
                type: 'lines',
                zlevel: 1,
                silent: true,
                effect: {
                    show: animationSetting.show,
                    constantSpeed: animationSetting.constantSpeed,
                    trailLength: 0,
                    symbol: animationSetting.symbol,
                    symbolSize: animationSetting.symbolSize
                },
                lineStyle: {
                    normal: {
                        color: lineSetting.color,
                        type: lineSetting.type,
                        width: lineSetting.width,
                        opacity: lineSetting.opacity,
                        curveness: lineSetting.curveness
                    }
                },
                data: lineData
            }
        ];

        if (lineData.length > MAX_MIGRATION_ANIMATION_COUNT) {
            // linesSeries[0].large = true;
            // linesSeries[0].largeThreshold = 100;
            linesSeries[0].blendMode = 'lighter';
        }

        return linesSeries;
    }

    /**
     * @private
     * @function WebMap.prototype.createPointSeries
     * @description åå»ºç¹ç³»å
     * @param {Object} layerInfo å¾å±åæ°
     * @param {Array} pointData ç¹æ°æ®
     * @returns {Object} ç¹ç³»å
     */
    createPointSeries(layerInfo, pointData) {
        let lineSetting = layerInfo.lineSetting;
        let animationSetting = layerInfo.animationSetting;
        let labelSetting = layerInfo.labelSetting;
        let pointSeries = [{
            name: 'point-series',
            coordinateSystem: 'geo',
            zlevel: 2,
            silent: true,
            label: {
                normal: {
                    show: labelSetting.show,
                    position: 'right',
                    formatter: '{b}',
                    color: labelSetting.color,
                    fontFamily: labelSetting.fontFamily
                }
            },
            itemStyle: {
                normal: {
                    color: lineSetting.color || labelSetting.color
                }
            },
            data: pointData
        }]

        if (animationSetting.show) {
            // å¼å¯å¨ç»
            pointSeries[0].type = 'effectScatter';
            pointSeries[0].rippleEffect = {
                brushType: 'stroke'
            }
        } else {
            // å³é­å¨ç»
            pointSeries[0].type = 'scatter';
        }

        return pointSeries;
    }

    /**
     * @private
     * @function WebMap.prototype.createPointsData
     * @param {Array} lineData çº¿æ°æ®
     * @param {Object} layerInfo å¾å±ä¿¡æ¯
     * @param {Array} properties å±æ§
     * @returns {Array} ç¹æ°æ®
     */
    createPointsData(lineData, layerInfo, properties) {
        let data = [],
            labelSetting = layerInfo.labelSetting;
        // æ ç­¾éèåç´æ¥è¿å
        if (!labelSetting.show || !lineData.length) {
            return data;
        }
        let fromData = [], toData = [];
        lineData.forEach((item, idx) => {
            let coords = item.coords,
                fromCoord = coords[0],
                toCoord = coords[1],
                fromProperty = properties[idx][labelSetting.from],
                toProperty = properties[idx][labelSetting.to];
            // èµ·å§å­æ®µå»é
            let f = fromData.find(d => {
                return d.value[0] === fromCoord[0] && d.value[1] === fromCoord[1]
            });
            !f && fromData.push({
                name: fromProperty,
                value: fromCoord
            })
            // ç»ç¹å­æ®µå»é
            let t = toData.find(d => {
                return d.value[0] === toCoord[0] && d.value[1] === toCoord[1]
            });
            !t && toData.push({
                name: toProperty,
                value: toCoord
            })
        });
        data = fromData.concat(toData);
        return data;
    }

    /**
     * @private
     * @function WebMap.prototype.createLinesData
     * @param {Object} layerInfo å¾å±ä¿¡æ¯
     * @param {Array} properties å±æ§
     * @returns {Array} çº¿æ°æ®
     */
    createLinesData(layerInfo, properties) {
        let data = [];
        if (properties && properties.length) {
            // éæ°è·åæ°æ®
            let from = layerInfo.from,
                to = layerInfo.to,
                fromCoord, toCoord;
            if (from.type === 'XY_FIELD' && from['xField'] && from['yField'] && to['xField'] && to['yField']) {
                properties.forEach(property => {
                    let fromX = property[from['xField']],
                        fromY = property[from['yField']],
                        toX = property[to['xField']],
                        toY = property[to['yField']];
                    if (!fromX || !fromY || !toX || !toY) {
                        return;
                    }

                    fromCoord = [property[from['xField']], property[from['yField']]];
                    toCoord = [property[to['xField']], property[to['yField']]];
                    data.push({
                        coords: [fromCoord, toCoord]
                    })
                });
            } else if (from.type === 'PLACE_FIELD' && from['field'] && to['field']) {
                const centerDatas = ProvinceCenter_namespaceObject.concat(MunicipalCenter_namespaceObject);

                properties.forEach(property => {
                    let fromField = property[from['field']],
                        toField = property[to['field']];
                    fromCoord = centerDatas.find(item => {
                        return core_Util_Util.isMatchAdministrativeName(item.name, fromField);
                    })
                    toCoord = centerDatas.find(item => {
                        return core_Util_Util.isMatchAdministrativeName(item.name, toField);
                    })
                    if (!fromCoord || !toCoord) {
                        return;
                    }
                    data.push({
                        coords: [fromCoord.coord, toCoord.coord]
                    })
                });
            }
        }
        return data;
    }

    /**
     * @private
     * @function WebMap.prototype.getService
     * @description è·åå½åæ°æ®åå¸çæå¡ä¸­çæç§ç±»åæå¡
     * @param {Array.<Object>} services æå¡éå
     * @param {string} type æå¡ç±»åï¼RESTDATA, RESTMAP
     * @returns {Object} æå¡
     */
    getService(services, type) {
        let service = services.filter((info) => {
            return info && info.serviceType === type;
        });
        return service[0];
    }

    /**
     * @private
     * @function WebMap.prototype.isMvt
     * @description å¤æ­å½åè½å¦ä½¿ç¨æ°æ®æå¡çmvtä¸å¾æ¹å¼
     * @param {string} serviceUrl æ°æ®æå¡çå°å
     * @param {string} datasetName æ°æ®æå¡çæ°æ®éåç§°
     * @returns {Object} æ°æ®æå¡çä¿¡æ¯
     */
    isMvt(serviceUrl, datasetName) {
        let that = this;
        return this.getDatasetsInfo(serviceUrl, datasetName).then((info) => {
            //å¤æ­æ¯å¦ååºå¾åæ ç³»ä¸ç´
            if (info.epsgCode == that.baseProjection.split('EPSG:')[1]) {
                return FetchRequest.get(that.getRequestUrl(`${info.url}/tilefeature.mvt`), null, {
                    withCredentials: that.withCredentials
                }).then(function (response) {
                    return response.json()
                }).then(function (result) {
                    info.isMvt = result.error && result.error.code === 400;
                    return info;
                }).catch(() => {
                    return info;
                });
            }
            return info;
        })
    }

    /**
     * @private
     * @function WebMap.prototype.getDatasetsInfo
     * @description è·åæ°æ®éä¿¡æ¯
     * @param {string} serviceUrl æ°æ®æå¡çå°å
     * @param {string} datasetName æ°æ®æå¡çæ°æ®éåç§°
     * @returns {Object} æ°æ®æå¡çä¿¡æ¯
     */
    getDatasetsInfo(serviceUrl, datasetName) {
        let that = this;
        return that.getDatasources(serviceUrl).then(function (datasourceName) {
            //å¤æ­mvtæå¡æ¯å¦å¯ç¨
            let url = `${serviceUrl}/data/datasources/${datasourceName}/datasets/${datasetName}.json`;
            return FetchRequest.get(that.getRequestUrl(url), null, {
                withCredentials: that.withCredentials
            }).then(function (response) {
                return response.json()
            }).then(function (datasetsInfo) {
                return {
                    epsgCode: datasetsInfo.datasetInfo.prjCoordSys.epsgCode,
                    bounds: datasetsInfo.datasetInfo.bounds,
                    url //è¿åçæ¯åå§urlï¼æ²¡æä»£çãå ä¸ºç¨äºè¯·æ±mvt
                };
            });
        })
    }

    /**
    * @private
    * @function WebMap.prototype.isRestMapMapboxStyle
    * @description ä»å¤æ­æ¯å¦ä¸ºrestmap mvtå°å¾æå¡ rest-mapæå¡çMapbox Styleèµæºå°åæ¯è¿æ ·çï¼ .../iserver/services/map-Population/rest/maps/PopulationDistribution/tileFeature/vectorstyles.json?type=MapBox_GL&styleonly=true
    * @param {Object} layerInfo webmapä¸­çMapStylerLayer
    * @returns {boolean} æ¯å¦ä¸ºrestmap mvtå°å¾æå¡
    */
    isRestMapMapboxStyle(layerInfo) {
        const restMapMVTStr = '/tileFeature/vectorstyles.json?type=MapBox_GL&styleonly=true&tileURLTemplate=ZXY'
        let dataSource = layerInfo.dataSource;
        let layerType = layerInfo.layerType;
        if (dataSource && dataSource.type === "EXTERNAL"
            && dataSource.url.indexOf(restMapMVTStr) > -1
            && (layerType === "MAPBOXSTYLE" || layerType === "VECTOR_TILE")) {
            return true
        }
        return false
    }
    /**
     * @private
     * @function WebMap.prototype.getMapboxStyleLayerInfo
     * @description è·åmapboxstyleå¾å±ä¿¡æ¯
     * @param {Object} layerInfo å¾å±ä¿¡æ¯
     * @returns {Object}  å¾å±ä¿¡æ¯
     */
    getMapboxStyleLayerInfo(mapInfo, layerInfo) {
        let _this = this;
        return new Promise((resolve, reject) => {
            return _this.getMapLayerExtent(layerInfo).then(layer => {
                return _this.getMapboxStyle(mapInfo, layer).then(styleLayer => {
                    Object.assign(layer, styleLayer);
                    resolve(layer)
                }).catch(error => {
                    reject(error);
                })
            }).catch(error => {
                reject(error);
            })
        })
    }
    /**
     * @private
     * @function WebMap.prototype.getMapLayerExtent
     * @description è·åmapboxstyleå¾å±ä¿¡æ¯
     * @param {Object} layerInfo å¾å±ä¿¡æ¯
     * @returns {Object}  å¾å±ä¿¡æ¯
     */
    getMapLayerExtent(layerInfo) {
        const restMapMVTStr = '/tileFeature/vectorstyles.json?type=MapBox_GL&styleonly=true&tileURLTemplate=ZXY'
        let dataSource = layerInfo.dataSource;
        let url = dataSource.url;
        if (this.isRestMapMapboxStyle(layerInfo)) {
            url = url.replace(restMapMVTStr, '')
        }
        url = this.getRequestUrl(url + '.json')

        let credential = layerInfo.credential;
        let credentialValue,keyfix;
        //æºå¸¦ä»¤ç(restmapç¨çé¦å­æ¯å¤§åï¼ä½æ¯è¿éè¦ç¨å°å)
        if (credential) {
            keyfix = Object.keys(credential)[0]
            credentialValue = credential[keyfix];
            url = `${url}?${keyfix}=${credentialValue}`;
        }

        return FetchRequest.get(url, null, {
            withCredentials: this.withCredentials,
            withoutFormatSuffix: true,
            headers: {
                'Content-Type': 'application/json;chartset=uft-8'
            }
        }).then(function (response) {
            return response.json();
        }).then((result) => {
            layerInfo.visibleScales = result.visibleScales;
            layerInfo.coordUnit = result.coordUnit;
            layerInfo.scale = result.scale;
            layerInfo.epsgCode = result.prjCoordSys.epsgCode;
            layerInfo.bounds = result.bounds;
            return layerInfo;
        }).catch(error => {
            throw error;
        })
    }

    /**
     * @private
     * @function WebMap.prototype.getMapboxStyle
     * @description è·åmapboxstyle --- iptä¸­èªå®ä¹åºå¾è¯·æ±mapboxstyleç®åæä¸¤ç§urlæ ¼å¼
     * rest-mapæå¡çMapbox Styleèµæºå°åæ¯è¿æ ·çï¼ .../iserver/services/map-Population/rest/maps/PopulationDistribution/tileFeature/vectorstyles.json?type=MapBox_GL&styleonly=true
     * restjsrçæå¡çMapbox Styleèµæºå°åæ¯è¿æ ·çï¼.../iserver/services/map-china400/restjsr/v1/vectortile/maps/China/style.json
     * @param {Object} mapboxstyleå¾å±ä¿¡æ¯
     * @returns {Object} å¾å±ä¿¡æ¯
     */
    getMapboxStyle(mapInfo, layerInfo) {
        let _this = this;
        let url = layerInfo.url || layerInfo.dataSource.url;
        let styleUrl = url;
        if (styleUrl.indexOf('/restjsr/') > -1) {
            styleUrl = `${styleUrl}/style.json`;
        }
        styleUrl = this.getRequestUrl(styleUrl)
        let credential = layerInfo.credential;
        //æºå¸¦ä»¤ç(restmapç¨çé¦å­æ¯å¤§åï¼ä½æ¯è¿éè¦ç¨å°å)
        let credentialValue, keyfix;
        if (credential) {
            keyfix = Object.keys(credential)[0]
            credentialValue = credential[keyfix];
            styleUrl = `${styleUrl}?${keyfix}=${credentialValue}`;
        }

        return FetchRequest.get(styleUrl, null, {
            withCredentials: this.withCredentials,
            withoutFormatSuffix: true,
            headers: {
                'Content-Type': 'application/json;chartset=uft-8'
            }
        }).then(function (response) {
            return response.json();
        }).then(styles => {
            _this._matchStyleObject(styles);
            let bounds = layerInfo.bounds;
            // å¤çæºå¸¦ä»¤ççæåµ
            if (credentialValue) {
                styles.sprite = `${styles.sprite}?${keyfix}=${credentialValue}`;
                let sources = styles.sources;
                let sourcesNames = Object.keys(sources);
                sourcesNames.forEach(function (sourceName) {
                    styles.sources[sourceName].tiles.forEach(function (tiles, i) {
                        styles.sources[sourceName].tiles[i] = `${tiles}?${keyfix}=${credentialValue}`
                    })
                })
            }

            let newLayerInfo = {
                url: url,
                sourceType: 'VECTOR_TILE',
                layerType: 'VECTOR_TILE',
                styles: styles,
                extent: bounds && [bounds.left, bounds.bottom, bounds.right, bounds.top],
                bounds: layerInfo.bounds,
                projection: "EPSG:" + layerInfo.epsgCode,
                epsgCode: layerInfo.epsgCode,
                name: layerInfo.name
            }
            Object.assign(layerInfo, newLayerInfo)
            if (layerInfo.zIndex > 0) {
                // è¿æ»¤styles  éåºå¾mapboxstyleå¾å±æéæ­¤å¤ç
                _this.modifyMapboxstyleLayer(mapInfo, layerInfo);
            }
            return layerInfo;
        }).catch(error => {
            return error;
        })
    }

    /**
     * @private
     * @function WebMap.prototype.modifyMapboxstyleLayer
     * @description mapboxstyleå¾å±ï¼1. layer idéå¤é®é¢  2.å å å¾å±èæ¯è²é®é¢
     * @param {Object} mapInfo å°å¾ä¿¡æ¯
     * @param {Object} layerInfo å½åè¦æ·»å å°å°å¾çå¾å±
     */
    modifyMapboxstyleLayer(mapInfo, layerInfo) {
        let that = this;
        if (mapInfo.layers && mapInfo.layers.length === 0) {return;}
        let curLayers = layerInfo.styles.layers;
        if (!curLayers) {return;}
        // éåºå¾ï¼åç§»é¤"background"å¾å±
        curLayers = curLayers.filter(layer => layer.type !== "background");
        layerInfo.styles.layers = curLayers;
        // å¤çmapboxstyleå¾å±layer idéå¤çæåµ
        let addedLayersArr = mapInfo.layers.filter(layer => layer.layerType === 'VECTOR_TILE' && layer.zIndex !== layerInfo.zIndex)
            .map(addLayer => addLayer.styles && addLayer.styles.layers);
        if (!addedLayersArr || addedLayersArr && addedLayersArr.length === 0) {return;}
        addedLayersArr.forEach(layers => {
            curLayers.forEach(curLayer => {
                that.renameLayerId(layers, curLayer);
            })
        })
    }
    /**
     * @private
     * @function  WebMap.prototype.renameLayerId
     * @description  mapboxstyleå¾å± idéå¤çlayeræ·»å åç¼ç¼ç  (n)[åèmapstudio]
     * @param {mapboxgl.Layer[]} layers å·²æ·»å å°å°å¾çå¾å±ç»
     * @param {mapboxgl.Layer} curLayer å½åå¾å±
     */
    renameLayerId(layers, curLayer) {
        if (layers.find((l) => l.id === curLayer.id)) {

            const result = curLayer.id.match(/(.+)\((\w)\)$/);
            if (result) {
                curLayer.id = `${result[1]}(${+result[2] + 1})`;
            } else {
                curLayer.id += '(1)';
            }
            if (layers.find((l) => l.id === curLayer.id)) {
                this.renameLayerId(layers, curLayer);
            }
        }
    }
    /**
	 * @private
	 * @function mapboxgl.supermap.WebMap.prototype._matchStyleObject
	 * @description æ¢å¤ style ä¸ºæ åæ ¼å¼ã
	 * @param {Object} style - mapbox æ ·å¼ã
	 */
    _matchStyleObject(style) {
        let {sprite, glyphs} = style;
        if (sprite && typeof sprite === 'object') {
            style.sprite = Object.values(sprite)[0];
        }
        if (glyphs && typeof glyphs === 'object') {
            style.glyphs = Object.values(glyphs)[0];
        }
    }

    /**
     * @private
     * @function  WebMap.prototype.renameLayerId
     * @description å¤æ­urlæ¯å¦æ¯iportalçä»£çå°å
     * @param {*} serviceUrl
     */
    isIportalProxyServiceUrl(serviceUrl) {
        if (this.serviceProxy && this.serviceProxy.enable && serviceUrl) {
            let proxyStr = '';
            if (this.serviceProxy.proxyServerRootUrl) {
                proxyStr = `${this.serviceProxy.proxyServerRootUrl}/`;
            } else if (this.serviceProxy.rootUrlPostfix) {
                proxyStr = `${this.serviceProxy.port}/${this.serviceProxy.rootUrlPostfix}/`;
            } else if (!this.serviceProxy.rootUrlPostfix) {
                proxyStr = `${this.serviceProxy.port}/`;
            }
            if (this.serviceProxy.port !== 80) {
                return serviceUrl.indexOf(proxyStr) >= 0;
            } else {
                // ä»£çç«¯å£ä¸º80ï¼urlä¸­ä¸ä¸å®æç«¯å£ï¼æ»¡è¶³ä¸ç§æåµå³å¯
                return serviceUrl.indexOf(proxyStr) >= 0 || serviceUrl.indexOf(proxyStr.replace(':80', '')) >= 0;
            }
        } else {
            return false
        }
    }
    /**
     * @private
     * @function  WebMap.prototype.getStyleResolutions
     * @description åå»ºå¾å±åè¾¨ç
     * @param {Object} bounds  å¾å±ä¸ä¸å·¦å³èå´
     * @returns {Array} styleResolutions æ ·å¼åè¾¨ç
     */
    getStyleResolutions(bounds, minZoom = 0, maxZoom = 22) {
        let styleResolutions = [];
        const TILE_SIZE = 512
        let temp = Math.abs(bounds.left - bounds.right) / TILE_SIZE;
        for (let i = minZoom; i <= maxZoom; i++) {
            if (i === 0) {
                styleResolutions[i] = temp;
                continue;
            }
            temp = temp / 2;
            styleResolutions[i] = temp;
        }
        return styleResolutions;
    }


    /**
     * @private
     * @function  WebMap.prototype.createVisibleResolution
     * @description åå»ºå¾å±å¯è§åè¾¨ç
     * @param {Array.<number>} visibleScales å¯è§æ¯ä¾å°ºèå´
     * @param {Array} indexbounds
     * @param {Object} bounds  å¾å±ä¸ä¸å·¦å³èå´
     * @param {string} coordUnit
     * @returns {Array} visibleResolution
     */
    createVisibleResolution(visibleScales, indexbounds, bounds, coordUnit) {
        let visibleResolution = [];
        // 1 è®¾ç½®äºå°å¾visibleScalesçæåµ
        if (visibleScales && visibleScales.length > 0) {
            visibleResolution = visibleScales.map(scale => {
                let value = 1 / scale;
                let res = this.getResFromScale(value, coordUnit);
                return res;
            })
        } else {
            // 2 å°å¾çbounds
            let envelope = this.getEnvelope(indexbounds, bounds);
            visibleResolution = this.getStyleResolutions(envelope);
        }
        return visibleResolution
    }

    /**
     * @private
     * @function  WebMap.prototype.createVisibleResolution
     * @description å¾å±è¾¹çèå´
     * @param {Array} indexbounds
     * @param {Object} bounds  å¾å±ä¸ä¸å·¦å³èå´
     * @returns {Object} envelope
     */
    getEnvelope(indexbounds, bounds) {
        let envelope = {};
        if (indexbounds && indexbounds.length === 4) {
            envelope.left = indexbounds[0];
            envelope.bottom = indexbounds[1];
            envelope.right = indexbounds[2];
            envelope.top = indexbounds[3];
        } else {
            envelope = bounds;
        }
        return envelope
    }
    /**
     * @private
     * @function WebMap.prototype.createMVTLayer
     * @description åå»ºç¢éç¦çå¾å±
     * @param {Object} layerInfo - å¾å±ä¿¡æ¯
     */
    createMVTLayer(layerInfo) {
        // let that = this;
        let styles = layerInfo.styles;
        const indexbounds = styles && styles.metadata && styles.metadata.indexbounds;
        const visibleResolution = this.createVisibleResolution(layerInfo.visibleScales, indexbounds, layerInfo.bounds, layerInfo.coordUnit);
        const envelope = this.getEnvelope(indexbounds, layerInfo.bounds);
        const styleResolutions = this.getStyleResolutions(envelope);
        // const origin = [envelope.left, envelope.top];
        let withCredentials = this.isIportalProxyServiceUrl(styles.sprite);
        // åå»ºMapBoxStyleæ ·å¼
        let mapboxStyles = new MapboxStyles({
            style: styles,
            source: styles.name,
            resolutions: styleResolutions,
            map: this.map,
            withCredentials
        });
        return new Promise((resolve) => {
            mapboxStyles.on('styleloaded', function () {
                let minResolution = visibleResolution[visibleResolution.length - 1];
                let maxResolution = visibleResolution[0];
                let layer = new external_ol_layer_namespaceObject.VectorTile({
                    //è®¾ç½®é¿è®©åæ°
                    declutter: true,
                    source: new VectorTileSuperMapRest({
                        style: styles,
                        withCredentials,
                        projection: layerInfo.projection,
                        format: new (external_ol_format_MVT_default())({
                            featureClass: (external_ol_render_Feature_default())
                        }),
                        wrapX: false
                    }),
                    style: mapboxStyles.featureStyleFuntion,
                    visible: layerInfo.visible,
                    zIndex: layerInfo.zIndex,
                    opacity: layerInfo.opacity,
                    minResolution,
                    // The maximum resolution (exclusive) below which this layer will be visible.
                    maxResolution: maxResolution > 1 ? Math.ceil(maxResolution) : maxResolution * 1.1
                });
                resolve(layer);
            })
        })
    }

    /**
     * @private
     * @function WebMap.prototype.isSameDomain
     * @description å¤æ­æ¯å¦åååï¼å¦ææ¯ååï¼åªå¤æ­åé¨ä¸¤çº§ååæ¯å¦ç¸åï¼ç¬¬ä¸çº§å¿½ç¥ï¼ï¼å¦ææ¯ipå°ååéè¦å®å¨ç¸åã
     * @param {*} url
     */
    isSameDomain(url) {
        let documentUrlArray = url.split("://"), substring = documentUrlArray[1];
        let domainIndex = substring.indexOf("/"), domain = substring.substring(0, domainIndex);

        let documentUrl = document.location.toString();
        let docUrlArray = documentUrl.split("://"), documentSubstring = docUrlArray[1];
        let docuDomainIndex = documentSubstring.indexOf("/"), docDomain = documentSubstring.substring(0, docuDomainIndex);

        if (domain.indexOf(':') > -1 || window.location.port !== "") {
            //è¯´æç¨çæ¯ipå°åï¼å¤æ­å®æ´ååå¤æ­
            return domain === docDomain;
        } else {
            let domainArray = domain.split('.'), docDomainArray = docDomain.split('.');
            return domainArray[1] === docDomainArray[1] && domainArray[2] === docDomainArray[2];
        }
    }
    /**
     * @private
     * @function WebMap.prototype.isSupportWebp
     * @description å¤æ­æ¯å¦æ¯æwebP
     * @param {*} url æå¡å°å
     * @param {*} token æå¡token
     * @returns {boolean}
     */
    isSupportWebp(url, token) {
        // è¿éè¦å¤æ­æµè§å¨
        let isIE = this.isIE();
        if (isIE || (this.isFirefox() && this.getFirefoxVersion() < 65) ||
            (this.isChrome() && this.getChromeVersion() < 32)) {
            return false;
        }
        url = token ? `${url}/tileImage.webp?token=${token}` : `${url}/tileImage.webp`;
        let isSameDomain = Util.isInTheSameDomain(url), excledeCreditial;
        if (isSameDomain && !token) {
            // onlineä¸æå¡ååä¸ç´ï¼è¦ç¨tokenå¼
            excledeCreditial = false;
        } else {
            excledeCreditial = true;
        }
        url = this.getRequestUrl(url, excledeCreditial);
        return FetchRequest.get(url, null, {
            withCredentials: this.withCredentials,
            withoutFormatSuffix: true
        }).then(function (response) {
            if (response.status !== 200) {
                throw response.status;
            }
            return response;
        }).then(() => {
            return true;
        }).catch(() => {
            return false;
        })
    }
    /**
    * @private
    * @function WebMap.prototype.isIE
    * @description å¤æ­å½åæµè§å¨æ¯å¦ä¸ºIE
    * @returns {boolean}
    */
    isIE() {
        if (!!window.ActiveXObject || "ActiveXObject" in window) {
            return true;
        }
        return false;
    }

    /**
     * @private
     * @function WebMap.prototype.isFirefox
     * @description  å¤æ­å½åæµè§å¨æ¯å¦ä¸º firefox
     * @returns {boolean}
     */
    isFirefox() {
        let userAgent = navigator.userAgent;
        return userAgent.indexOf("Firefox") > -1;
    }

    /**
     * @private
     * @function WebMap.prototype.isChrome
     * @description  å¤æ­å½åæµè§å¨æ¯å¦ä¸ºè°·æ­
     * @returns {boolean}
     */
    isChrome() {
        let userAgent = navigator.userAgent;
        return userAgent.indexOf("Chrome") > -1;
    }

    /**
     * @private
     * @function WebMap.prototype.getFirefoxVersion
     * @description è·åç«çæµè§å¨ççæ¬å·
     * @returns {number}
     */
    getFirefoxVersion() {
        let userAgent = navigator.userAgent.toLowerCase(),
            version = userAgent.match(/firefox\/([\d.]+)/);
        return +version[1];
    }

    /**
     * @private
     * @function WebMap.prototype.getChromeVersion
     * @description è·åè°·æ­æµè§å¨çæ¬å·
     * @returns {number}
     */
    getChromeVersion() {
        let userAgent = navigator.userAgent.toLowerCase(),
            version = userAgent.match(/chrome\/([\d.]+)/);
        return +version[1];
    }

    /**
     * @private
     * @function WebMap.prototype.addGraticule
     * @description åå»ºç»çº¬ç½
     * @param {Object} mapInfo - å°å¾ä¿¡æ¯
     */
    addGraticule(mapInfo) {
        if(this.isHaveGraticule) {
            this.createGraticuleLayer(mapInfo.grid.graticule);
            this.layerAdded++;
            const lens = mapInfo.layers ? mapInfo.layers.length : 0;
            this.sendMapToUser(lens);
        }
    }

    /**
     * @private
     * @function WebMap.prototype.createGraticuleLayer
     * @description åå»ºç»çº¬ç½å¾å±
     * @param {Object} layerInfo - å¾å±ä¿¡æ¯
     * @returns {ol.layer.Vector} ç¢éå¾å±
     */
    createGraticuleLayer(layerInfo) {
        const { strokeColor, strokeWidth, lineDash, extent, visible, interval, lonLabelStyle, latLabelStyle } = layerInfo;
        const epsgCode = this.baseProjection;
        // æ·»å ç»çº¬ç½éè¦è®¾ç½®extentãworldExtent
        let projection = new external_ol_proj_namespaceObject.get(epsgCode);
        projection.setExtent(extent);
        projection.setWorldExtent(external_ol_proj_namespaceObject.transformExtent(extent, epsgCode, 'EPSG:4326'));

        let graticuleOptions = {
            layerID: 'graticule_layer',
            strokeStyle: new (external_ol_style_Stroke_default())({
                color: strokeColor,
                width: strokeWidth,
                lineDash
            }),
            extent,
            visible: visible,
            intervals: interval,
            showLabels: true,
            zIndex: 9999,
            wrapX: false,
            targetSize: 0
        };
        lonLabelStyle && (graticuleOptions.lonLabelStyle = new (external_ol_style_Text_default())({
            font: `${lonLabelStyle.fontSize} ${lonLabelStyle.fontFamily}`,
            textBaseline: lonLabelStyle.textBaseline,
            fill: new (external_ol_style_Fill_default())({
                color: lonLabelStyle.fill
            }),
            stroke: new (external_ol_style_Stroke_default())({
                color: lonLabelStyle.outlineColor,
                width: lonLabelStyle.outlineWidth
            })
        }))
        latLabelStyle && (graticuleOptions.latLabelStyle = new (external_ol_style_Text_default())({
            font: `${latLabelStyle.fontSize} ${latLabelStyle.fontFamily}`,
            textBaseline: latLabelStyle.textBaseline,
            fill: new (external_ol_style_Fill_default())({
                color: latLabelStyle.fill
            }),
            stroke: new (external_ol_style_Stroke_default())({
                color: latLabelStyle.outlineColor,
                width: latLabelStyle.outlineWidth
            })
        }))
        const layer = new external_ol_layer_namespaceObject.Graticule(graticuleOptions);
        this.map.addLayer(layer);
    }
    /**
     * @private
     * @function WebMap.prototype.getLang
     * @description æ£æµå½åcookieä¸­çè¯­è¨æèæµè§å¨æç¨è¯­è¨
     * @returns {string} è¯­è¨åç§°ï¼å¦zh-CN
     */
    getLang() {
        if(this.getCookie('language')) {
            const cookieLang = this.getCookie('language');
            return this.formatCookieLang(cookieLang);
        } else {
            const browerLang = navigator.language || navigator.browserLanguage;
            return browerLang;
        }
    }
    /**
     * @private
     * @function WebMap.prototype.getCookie
     * @description è·åcookieä¸­æä¸ªkeyå¯¹åºçå¼
     * @returns {string} æä¸ªkeyå¯¹åºçå¼
     */
    getCookie(key) {
        key = key.toLowerCase();
        let value = null;
        let cookies = document.cookie.split(';');
        cookies.forEach(function (cookie) {
            const arr = cookie.split('=');
            if (arr[0].toLowerCase().trim() === key) {
                value = arr[1].trim();
                return;
            }
        });
        return value;
    }
    /**
     * @private
     * @function WebMap.prototype.formatCookieLang
     * @description å°ä»cookieä¸­è·åçlang,è½¬æ¢æå¨ç§°ï¼å¦zh=>zh-CN
     * @returns {string} è½¬æ¢åçè¯­è¨åç§°
     */
    formatCookieLang(cookieLang) {
        let lang;
        switch(cookieLang) {
            case 'zh':
                lang = 'zh-CN';
                break;
            case 'ar':
                lang = 'ar-EG';
                break;
            case 'bg':
                lang = 'bg-BG';
                break;
            case 'ca':
                lang = 'ca-ES';
                break;
            case 'cs':
                lang = 'cs-CZ';
                break;
            case 'da':
                lang = 'da-DK';
                break;
            case 'de':
                lang = 'de-DE';
                break;
            case 'el':
                lang = 'el-GR';
                break;
            case 'es':
                lang = 'es-ES';
                break;
            case 'et':
                lang = 'et-EE';
                break;
            case 'fa':
                lang = 'fa-IR';
                break;
            case 'fl':
                lang = 'fi-FI';
                break;
            case 'fr':
                lang = 'fr-FR';
                break;
            case 'he':
                lang = 'he-IL';
                break;
            case 'hu':
                lang = 'hu-HU';
                break;
            case 'id':
                lang = 'id-ID';
                break;
            case 'is':
                lang = 'is-IS';
                break;
            case 'it':
                lang = 'it-IT';
                break;
            case 'ja':
                lang = 'ja-JP';
                break;
            case 'ko':
                lang = 'ko-KR';
                break;
            case 'ku':
                lang = 'ku-IQ';
                break;
            case 'mn':
                lang = 'mn-MN';
                break;
            case 'nb':
                lang = 'nb-NO';
                break;
            case 'ne':
                lang = 'ne-NP';
                break;
            case 'nl':
                lang = 'nl-NL';
                break;
            case 'pl':
                lang = 'pl-PL';
                break;
            case 'pt':
                lang = 'pt-PT';
                break;
            case 'ru':
                lang = 'ru-RU';
                break;
            case 'sk':
                lang = 'sk-SK';
                break;
            case 'sl':
                lang = 'sl-SI';
                break;
            case 'sr':
                lang = 'sr-RS';
                break;
            case 'sv':
                lang = 'sv-SE';
                break;
            case 'th':
                lang = 'th-TH';
                break;
            case 'tr':
                lang = 'tr-TR';
                break;
            case 'uk':
                lang = 'uk-UA';
                break;
            case 'vi':
                lang = 'vi-VN';
                break;
            default:
                lang = 'en-US';
                break;
        }
        return lang;
    }
    isCustomProjection(projection) {
        if(core_Util_Util.isNumber(projection)){
            return [-1000,-1].includes(+projection)
        }
        return ['EPSG:-1000','EPSG:-1'].includes(projection);
    }
}

;// CONCATENATED MODULE: ./src/openlayers/mapping/ImageTileSuperMapRest.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/





/**
 * @class ImageTileSuperMapRest
 * @browsernamespace ol.source
 * @version 10.2.0
 * @category  iServer Image
 * @classdesc iServerå½±åæå¡å¾å±æºãæ ¹æ®æå®çè¯·æ±åæ°ï¼è¿åå½±åæ°æ®æ æ ¼ç¦çå¹¶æ¸²æã
 * @param {Object} options - åæ°ã
 * @param {string} options.url - æå¡å°åãä¾å¦: http://{ip}:{port}/iserver/{imageservice-imageserviceName}/restjsr/
 * @param {string} options.collectionId - å½±åéåï¼Collectionï¼çIDï¼å¨ä¸ä¸ªå½±åæå¡ä¸­å¯ä¸æ è¯å½±åéåã
 * @param {string} [options.sqlFilter] æ¾ç¤ºå½±åçè¿æ»¤æ¡ä»¶ãç¸å½äºsqlæ¥è¯¢ä¸­çwhereå­å¥ãæ¯æst_geometryç©ºé´å½æ°è¿æ»¤ã11.0çæ¬æä¸æ¯æéè¿ECQLè¿è¡è¿æ»¤ã
 * @param {ImageRenderingRule} [options.renderingRule] æå®å½±åæ¾ç¤ºçé£æ ¼ï¼åå«æä¼¸æ¾ç¤ºæ¹å¼ãé¢è²è¡¨ãæ³¢æ®µç»åä»¥ååºç¨æ æ ¼å½æ°è¿è¡å¿«éå¤çç­ãä¸æå®æ¶ï¼ä½¿ç¨åå¸æå¡æ¶æéç½®çé£æ ¼ã
 * @param {Array.<number>} [options.ids] è¿åå½±åéåä¸­æå®IDçå½±åï¼è¯¥idä¸ºç³»ç»ç»´æ¤çä¸ä¸ªèªå¢idï¼ä¸ºSuperMap SDXå¼æçSmIDå­æ®µåå®¹ã
 * @param {Array.<string>} [options.names] è¿åå½±åéåä¸­æå®åç§°å½±åçç¦çèµæºãå½±ååç§°åå«æä»¶åç¼ï¼å¦S-60-45.tifã
 * @param {string} [options.format='png'] - ç¦çè¡¨è¿°ç±»åï¼ç¦çæ ¼å¼ç®åæ¯æpngãjpgåwebpä¸ç§æ ¼å¼ã
 * @param {boolean} [options.transparent=true] - ç¦çæ¯å¦éæãé»è®¤éæã
 * @param {boolean} [options.cacheEnabled=true] - å¯ç¨ç¼å­ã
 * @param {string} [options.tileProxy] -  ä»£çå°å
 * @param {string} [options.attribution='Map Data <span>Â© <a href='http://support.supermap.com.cn/product/iServer.aspx' title='SuperMap iServer' target='_blank'>SuperMap iServer</a></span>'] - çæä¿¡æ¯ã
 * @extends {ol.source.XYZ}
 * @usage
 */
class ImageTileSuperMapRest extends (external_ol_source_XYZ_default()) {
    constructor(options) {
        options = options || {};
        options.format = options.format || 'png';
        options.transparent = options.transparent === undefined ? true : options.transparent === true;
        options.cacheEnabled = options.cacheEnabled === undefined ? true : options.cacheEnabled === true;
        var attributions = options.attributions || "Map Data <span>Â© <a href='http://support.supermap.com.cn/product/iServer.aspx' title='SuperMap iServer' target='_blank'>SuperMap iServer</a></span>";
        var url = _createLayerUrl(options.url, options);
        var superOptions = {
            ...options,
            attributions: attributions,
            url: url
        };
        //éè¦ä»£çæ¶èµ°èªå®ä¹ tileLoadFunctionï¼å¦åèµ°é»è®¤çtileLoadFunction
        if (!options.tileLoadFunction && options.tileProxy) {
            superOptions.tileLoadFunction = tileLoadFunction;
        }
        super(superOptions);
        var me = this;
        this.options = options;
        if (options.tileProxy) {
            this.tileProxy = options.tileProxy;
        }
        function tileLoadFunction(imageTile, src) {
            imageTile.getImage().src = me.tileProxy + encodeURIComponent(src);
        }

        function _createLayerUrl(url, options) {
            var layerUrl = Util.urlPathAppend(
                url,
                `/collections/${options.collectionId}/tile.${options.format}?x={x}&y={y}&z={z}`
            );
            var requestParams = _getAllRequestParams(options);
            layerUrl = Util.urlAppend(layerUrl, _getParamString(requestParams));
            layerUrl = SecurityManager.appendCredential(layerUrl);

            if (!options.cacheEnabled) {
                layerUrl += '&_t=' + new Date().getTime();
            }
            return layerUrl;
        }

        function _getAllRequestParams(options) {
            var params = {};
            params['transparent'] = options.transparent;
            params['cacheEnabled'] = !(options.cacheEnabled === false);
            if (options.sqlFilter) {
                params['sqlFilter'] = options.sqlFilter;
            }
            if (options.renderingRule) {
                params['renderingRule'] = JSON.stringify(options.renderingRule);
            }
            if (options.ids) {
                params['ids'] = options.ids.join(',');
            }
            if (options.names) {
                params['names'] = options.names.join(',');
            }
            return params;
        }

        function _getParamString(obj) {
            var params = [];
            for (var i in obj) {
                params.push(encodeURIComponent(i) + '=' + encodeURIComponent(obj[i]));
            }
            return params.join('&');
        }
    }
}

;// CONCATENATED MODULE: external "ol.layer.Tile"
const external_ol_layer_Tile_namespaceObject = ol.layer.Tile;
var external_ol_layer_Tile_default = /*#__PURE__*/__webpack_require__.n(external_ol_layer_Tile_namespaceObject);
;// CONCATENATED MODULE: ./src/openlayers/mapping/InitMap.js










window.proj4 = lib;

/**
 * @function initMap
 * @description æ ¹æ® SuperMap iServer æå¡åæ°ï¼åå»ºå°å¾ä¸å¾å±ãç®åä»æ¯æSuperMap iServer å°å¾æå¡ï¼åå»ºçå¾å±ä¸º ol.Tileã
 * @category BaseTypes Util 
 * @version 11.0.1
 * @param {number} url - æå¡å°å,ä¾å¦: http://{ip}:{port}/iserver/services/map-world/rest/maps/Worldã
 * @param {Object} options - åæ°ã
 * @param {Object} [options.mapOptions] - å°å¾éç½®ï¼åæ°è®¾ç½®åè {@link https://openlayers.org/en/v6.15.1/apidoc/module-ol_Map-Map.html}ã
 * @param {Object} [options.viewOptions] - è§å¾éç½®ï¼åæ°è®¾ç½®åè {@link https://openlayers.org/en/v6.15.1/apidoc/module-ol_View-View.html} ï¼æªè®¾ç½®çæåµä¸ï¼é»è®¤ä½¿ç¨ SuperMap iServer æå¡åæ°è¿è¡è®¾ç½®ã
 * @param {Object} [options.layerOptions] - å¾å±éç½®ï¼åæ°è®¾ç½®åè {@link https://openlayers.org/en/v6.15.1/apidoc/module-ol_layer_Tile-TileLayer.html} ï¼æªè®¾ç½®çæåµä¸ï¼é»è®¤ä½¿ç¨ SuperMap iServer æå¡åæ°è¿è¡è®¾ç½®ã
 * @param {Object} [options.sourceOptions] - æ°æ®æºéç½®ï¼åæ°è®¾ç½®åè {@link TileSuperMapRest} ï¼æªè®¾ç½®çæåµä¸ï¼é»è®¤ä½¿ç¨ SuperMap iServer æå¡åæ°è¿è¡è®¾ç½®ã
 * @returns {Object} å®ä¾å¯¹è±¡ï¼å¯¹è±¡åæ¬å°å¾å®ä¾ï¼å¾å±å®ä¾ï¼æ°æ®æºå®ä¾ã
 * @usage
 * ```
 * // æµè§å¨
 * <script type="text/javascript" src="{cdn}"></script>
 * <script>
 *   const initMap = {namespace}.initMap;
 *
 * </script>
 * // ES6 Import
 * import { initMap } from '{npm}';
 *
 * initMap(url, { mapOptions, viewOptions, layerOptions, sourceOptions })
 * ```
 * */
function initMap(url, options = {}) {
  const { mapOptions, viewOptions, layerOptions, sourceOptions } = options;
  return new Promise((resolve, reject) => {
    new MapService(url).getMapInfo(async function (serviceResult) {
      if (!serviceResult || !serviceResult.result) {
        reject('service is not work!');
      }
      let { prjCoordSys, bounds } = serviceResult.result;
      if (!(0,external_ol_proj_namespaceObject.get)(`EPSG:${prjCoordSys.epsgCode}`) && prjCoordSys.type !== 'PCS_NON_EARTH') {
        const wkt = await getWkt(url);
        registerProj(prjCoordSys.epsgCode, wkt, bounds);
      }

      let map = createMap(serviceResult.result, mapOptions, viewOptions);
      let { layer, source } = createLayer(url, serviceResult.result, sourceOptions, layerOptions);
      map.addLayer(layer);
      resolve({
        map,
        source,
        layer
      });
    });
  });
}

/**
 * @function  viewOptionsFromMapJSON
 * @category BaseTypes Util
 * @version 11.0.1
 * @description éè¿ iServer REST å°å¾åæ°æé  ol è§å¾å¯¹è±¡ã
 * @param {Object} mapJSONObj - å°å¾ JSON å¯¹è±¡ã
 * @param {number} [level=22] - å°å¾æå¤§çº§å«ã
 * @returns {Object} olè§å¾åæ°ï¼åæ¬ä¸­å¿ç¹ãæå½±ãçº§å«ãåè¾¨çæ°ç»ã
 */

function viewOptionsFromMapJSON(mapJSONObj, level = 22) {
  let { bounds, dpi, center, visibleScales, scale, coordUnit, prjCoordSys } = mapJSONObj;
  const mapCenter =
    center.x && center.y ? [center.x, center.y] : [(bounds.left + bounds.right) / 2, (bounds.bottom + bounds.top) / 2];
  const extent = [bounds.left, bounds.bottom, bounds.right, bounds.top];
  let projection = core_Util_Util.getProjection(prjCoordSys, extent);
  var resolutions = core_Util_Util.scalesToResolutions(visibleScales, bounds, dpi, coordUnit, level);
  const zoom = core_Util_Util.getZoomByResolution(core_Util_Util.scaleToResolution(scale, dpi, coordUnit), resolutions);
  return {
    center: mapCenter,
    projection,
    zoom,
    resolutions
  };
}

function createMap(result, mapOptions, viewOptions) {
  let view = viewOptionsFromMapJSON(result);
  var map = new (external_ol_Map_default())({
    target: 'map',
    view: new (external_ol_View_default())({ ...view, ...viewOptions }),
    ...mapOptions
  });
  return map;
}

function registerProj(epsgCode, wkt, bounds) {
  const extent = [bounds.left, bounds.bottom, bounds.right, bounds.top];
  let epsgCodeStr = `EPSG:${epsgCode}`;
  !(0,external_ol_proj_namespaceObject.get)(epsgCodeStr) && lib.defs(epsgCodeStr, wkt);
  if (external_ol_proj_proj4_namespaceObject && external_ol_proj_proj4_namespaceObject.register) {
    external_ol_proj_proj4_namespaceObject.register(lib);
    var prj = (0,external_ol_proj_namespaceObject.get)(epsgCodeStr);
    prj.setExtent(extent);
  }
}

function createLayer(url, result, sourceOptions, layerOptions) {
  let options = TileSuperMapRest.optionsFromMapJSON(url, result, true);
  options = { ...options, ...sourceOptions };
  var source = new TileSuperMapRest(options);
  var layer = new (external_ol_layer_Tile_default())({
    source,
    ...layerOptions
  });
  return { layer, source };
}

function getWkt(url) {
  return new Promise((resolve) => {
    new MapService(url).getWkt(function (res) {
      let wkt = res.result.data;
      resolve(wkt);
    });
  });
}

;// CONCATENATED MODULE: ./src/openlayers/mapping/index.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/








;// CONCATENATED MODULE: ./src/openlayers/index.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/







;// CONCATENATED MODULE: ./src/openlayers/namespace.js
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


/* control */


/* core */


/* mapping */


/* overlay */


/* service */


if (window && window.ol) {
  let ol = window.ol;
  ol.supermap = { ...SuperMap, ...ol.supermap };
  ol.supermap.control = ol.supermap.control || {};
  // control
  ol.supermap.control.ChangeTileVersion = ChangeTileVersion;
  ol.supermap.control.Logo = Logo;
  ol.supermap.control.ScaleLine = ScaleLine;
  // core
  ol.supermap.StyleUtils = StyleUtils;
  ol.supermap.Util = core_Util_Util;
  // mapping
  ol.source.BaiduMap = BaiduMap;
  ol.source.ImageSuperMapRest = ImageSuperMapRest;
  ol.source.SuperMapCloud = SuperMapCloud;
  ol.source.ImageTileSuperMapRest = ImageTileSuperMapRest;
  ol.source.Tianditu = Tianditu;
  ol.source.TileSuperMapRest = TileSuperMapRest;
  ol.supermap.WebMap = WebMap;
  // overlay
  ol.style.CloverShape = CloverShape;
  ol.Graphic = Graphic_Graphic;
  ol.style.HitCloverShape = HitCloverShape;
  ol.source.GeoFeature = GeoFeature;
  ol.source.Theme = theme_Theme_Theme;
  ol.supermap.ThemeFeature = ThemeFeature;
  ol.supermap.MapboxStyles = MapboxStyles;
  ol.supermap.VectorTileStyles = VectorTileStyles;
  ol.source.DataFlow = DataFlow;
  ol.source.Graph = Graph_Graph;
  ol.source.Graphic = Graphic;
  ol.source.HeatMap = HeatMap;
  ol.source.Label = Label_Label;
  ol.source.Mapv = Mapv;
  ol.source.Range = Range;
  ol.source.RankSymbol = RankSymbol_RankSymbol;
  ol.source.Turf = Turf;
  ol.source.Unique = Unique;
  ol.source.VectorTileSuperMapRest = VectorTileSuperMapRest;
  // service
  ol.supermap.AddressMatchService = AddressMatchService;
  ol.supermap.ChartService = ChartService;
  ol.supermap.DataFlowService = DataFlowService;
  ol.supermap.DatasetService = DatasetService;
  ol.supermap.DatasourceService = DatasourceService;
  ol.supermap.FeatureService = FeatureService;
  ol.supermap.FieldService = FieldService;
  ol.supermap.GridCellInfosService = GridCellInfosService;
  ol.supermap.GeoprocessingService = GeoprocessingService;
  ol.supermap.LayerInfoService = LayerInfoService;
  ol.supermap.MapService = MapService;
  ol.supermap.MeasureService = MeasureService;
  ol.supermap.NetworkAnalyst3DService = NetworkAnalyst3DService;
  ol.supermap.NetworkAnalystService = NetworkAnalystService;
  ol.supermap.ProcessingService = ProcessingService;
  ol.supermap.QueryService = QueryService_QueryService;
  ol.supermap.ServiceBase = ServiceBase;
  ol.supermap.SpatialAnalystService = SpatialAnalystService;
  ol.supermap.ThemeService = ThemeService;
  ol.supermap.TrafficTransferAnalystService = TrafficTransferAnalystService;
  ol.supermap.WebPrintingJobService = WebPrintingJobService;
  ol.supermap.ImageService = ImageService;
  ol.supermap.ImageCollectionService = ImageCollectionService;
  ol.supermap.initMap = initMap;
  ol.supermap.viewOptionsFromMapJSON = viewOptionsFromMapJSON;

  // å¤çå½åç©ºé´éåé®é¢
  ol.supermap.CommonUtil = Util;
}



})();

// This entry need to be wrapped in an IIFE because it need to be in strict mode.
(() => {
"use strict";
/* CopyrightÂ© 2000 - 2022 SuperMap Software Co.Ltd. All rights reserved.
 * This program are made available under the terms of the Apache License, Version 2.0
 * which accompanies this distribution and is available at http://www.apache.org/licenses/LICENSE-2.0.html.*/


})();

/******/ })()
;